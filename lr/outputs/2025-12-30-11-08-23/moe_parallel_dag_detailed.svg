<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="2033pt"
 viewBox="0.00 0.00 1440.00 2032.58" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.27 0.27) rotate(0) translate(4 7593.98)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7593.98 5378.87,-7593.98 5378.87,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="119.5" cy="-7548.98" rx="119.5" ry="28.98"/>
<text text-anchor="middle" x="119.5" y="-7557.48" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="119.5" y="-7546.48" font-family="Arial" font-size="10.00">Batch Size=128, Seq Len=Variable</text>
<text text-anchor="middle" x="119.5" y="-7535.48" font-family="Arial" font-size="10.00">Token Dim=512</text>
</g>
<!-- distribute_0 -->
<g id="node2" class="node">
<title>distribute_0</title>
<polygon fill="lightyellow" stroke="black" points="559.73,-7589.98 319.16,-7589.98 257.27,-7507.98 497.85,-7507.98 559.73,-7589.98"/>
<text text-anchor="middle" x="408.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_0</text>
<text text-anchor="middle" x="408.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="408.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_0 -->
<g id="node3" class="node">
<title>attention_0_0</title>
<polygon fill="lightgreen" stroke="black" points="492.5,-7471.98 324.5,-7471.98 324.5,-7419.98 492.5,-7419.98 492.5,-7471.98"/>
<text text-anchor="middle" x="408.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_0_L0</text>
<text text-anchor="middle" x="408.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="408.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="408.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_0&#45;&gt;attention_0_0 -->
<g id="edge1" class="edge">
<title>distribute_0&#45;&gt;attention_0_0</title>
<path fill="none" stroke="black" d="M408.5,-7507.77C408.5,-7499.34 408.5,-7490.51 408.5,-7482.27"/>
<polygon fill="black" stroke="black" points="412,-7482.23 408.5,-7472.23 405,-7482.23 412,-7482.23"/>
</g>
<!-- gate_0_0 -->
<g id="node4" class="node">
<title>gate_0_0</title>
<polygon fill="lightyellow" stroke="black" points="556.51,-7383.98 321.06,-7383.98 260.49,-7279.98 495.94,-7279.98 556.51,-7383.98"/>
<text text-anchor="middle" x="408.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_0_L0</text>
<text text-anchor="middle" x="408.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="408.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="408.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_0&#45;&gt;gate_0_0 -->
<g id="edge2" class="edge">
<title>attention_0_0&#45;&gt;gate_0_0</title>
<path fill="none" stroke="black" d="M408.5,-7419.85C408.5,-7412.16 408.5,-7403.35 408.5,-7394.35"/>
<polygon fill="black" stroke="black" points="412,-7394.16 408.5,-7384.16 405,-7394.16 412,-7394.16"/>
</g>
<!-- expert_0_0 -->
<g id="node5" class="node">
<title>expert_0_0</title>
<polygon fill="lightgreen" stroke="black" points="483,-7243.98 334,-7243.98 334,-7191.98 483,-7191.98 483,-7243.98"/>
<text text-anchor="middle" x="408.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_0_L0</text>
<text text-anchor="middle" x="408.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="408.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="408.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_0&#45;&gt;expert_0_0 -->
<g id="edge3" class="edge">
<title>gate_0_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" d="M401.77,-7279.9C401.69,-7271.23 401.83,-7262.41 402.18,-7254.27"/>
<polygon fill="black" stroke="black" points="405.69,-7254.21 402.77,-7244.03 398.7,-7253.81 405.69,-7254.21"/>
</g>
<!-- gate_0_0&#45;&gt;expert_0_0 -->
<g id="edge1057" class="edge">
<title>gate_0_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M415.23,-7279.9C415.31,-7271.23 415.17,-7262.41 414.82,-7254.27"/>
<polygon fill="red" stroke="red" points="418.3,-7253.81 414.23,-7244.03 411.31,-7254.21 418.3,-7253.81"/>
</g>
<!-- aggregate_0_0 -->
<g id="node6" class="node">
<title>aggregate_0_0</title>
<polygon fill="lightyellow" stroke="black" points="556.51,-7155.98 321.06,-7155.98 260.49,-7051.98 495.94,-7051.98 556.51,-7155.98"/>
<text text-anchor="middle" x="408.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L0</text>
<text text-anchor="middle" x="408.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="408.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="408.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_0&#45;&gt;aggregate_0_0 -->
<g id="edge4" class="edge">
<title>expert_0_0&#45;&gt;aggregate_0_0</title>
<path fill="none" stroke="black" d="M408.5,-7191.85C408.5,-7184.16 408.5,-7175.35 408.5,-7166.35"/>
<polygon fill="black" stroke="black" points="412,-7166.16 408.5,-7156.16 405,-7166.16 412,-7166.16"/>
</g>
<!-- attention_0_1 -->
<g id="node7" class="node">
<title>attention_0_1</title>
<polygon fill="lightgreen" stroke="black" points="492.5,-7015.98 324.5,-7015.98 324.5,-6963.98 492.5,-6963.98 492.5,-7015.98"/>
<text text-anchor="middle" x="408.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_0_L1</text>
<text text-anchor="middle" x="408.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="408.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="408.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_0&#45;&gt;attention_0_1 -->
<g id="edge5" class="edge">
<title>aggregate_0_0&#45;&gt;attention_0_1</title>
<path fill="none" stroke="black" d="M408.5,-7051.9C408.5,-7043.23 408.5,-7034.41 408.5,-7026.27"/>
<polygon fill="black" stroke="black" points="412,-7026.03 408.5,-7016.03 405,-7026.03 412,-7026.03"/>
</g>
<!-- gate_0_1 -->
<g id="node8" class="node">
<title>gate_0_1</title>
<polygon fill="lightyellow" stroke="black" points="556.51,-6927.98 321.06,-6927.98 260.49,-6823.98 495.94,-6823.98 556.51,-6927.98"/>
<text text-anchor="middle" x="408.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_0_L1</text>
<text text-anchor="middle" x="408.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="408.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="408.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_1&#45;&gt;gate_0_1 -->
<g id="edge6" class="edge">
<title>attention_0_1&#45;&gt;gate_0_1</title>
<path fill="none" stroke="black" d="M408.5,-6963.85C408.5,-6956.16 408.5,-6947.35 408.5,-6938.35"/>
<polygon fill="black" stroke="black" points="412,-6938.16 408.5,-6928.16 405,-6938.16 412,-6938.16"/>
</g>
<!-- expert_0_1 -->
<g id="node9" class="node">
<title>expert_0_1</title>
<polygon fill="lightgreen" stroke="black" points="483,-6787.98 334,-6787.98 334,-6735.98 483,-6735.98 483,-6787.98"/>
<text text-anchor="middle" x="408.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_0_L1</text>
<text text-anchor="middle" x="408.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="408.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="408.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_1&#45;&gt;expert_0_1 -->
<g id="edge7" class="edge">
<title>gate_0_1&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M401.77,-6823.9C401.69,-6815.23 401.83,-6806.41 402.18,-6798.27"/>
<polygon fill="black" stroke="black" points="405.69,-6798.21 402.77,-6788.03 398.7,-6797.81 405.69,-6798.21"/>
</g>
<!-- gate_0_1&#45;&gt;expert_0_1 -->
<g id="edge1058" class="edge">
<title>gate_0_1&#45;&gt;expert_0_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M415.23,-6823.9C415.31,-6815.23 415.17,-6806.41 414.82,-6798.27"/>
<polygon fill="red" stroke="red" points="418.3,-6797.81 414.23,-6788.03 411.31,-6798.21 418.3,-6797.81"/>
</g>
<!-- aggregate_0_1 -->
<g id="node10" class="node">
<title>aggregate_0_1</title>
<polygon fill="lightyellow" stroke="black" points="556.51,-6699.98 321.06,-6699.98 260.49,-6595.98 495.94,-6595.98 556.51,-6699.98"/>
<text text-anchor="middle" x="408.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L1</text>
<text text-anchor="middle" x="408.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="408.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="408.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_1&#45;&gt;aggregate_0_1 -->
<g id="edge8" class="edge">
<title>expert_0_1&#45;&gt;aggregate_0_1</title>
<path fill="none" stroke="black" d="M408.5,-6735.85C408.5,-6728.16 408.5,-6719.35 408.5,-6710.35"/>
<polygon fill="black" stroke="black" points="412,-6710.16 408.5,-6700.16 405,-6710.16 412,-6710.16"/>
</g>
<!-- attention_0_2 -->
<g id="node11" class="node">
<title>attention_0_2</title>
<polygon fill="lightgreen" stroke="black" points="493.5,-6559.98 325.5,-6559.98 325.5,-6507.98 493.5,-6507.98 493.5,-6559.98"/>
<text text-anchor="middle" x="409.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_0_L2</text>
<text text-anchor="middle" x="409.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="409.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="409.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_1&#45;&gt;attention_0_2 -->
<g id="edge9" class="edge">
<title>aggregate_0_1&#45;&gt;attention_0_2</title>
<path fill="none" stroke="black" d="M408.96,-6595.9C409.03,-6587.23 409.11,-6578.41 409.19,-6570.27"/>
<polygon fill="black" stroke="black" points="412.69,-6570.06 409.28,-6560.03 405.69,-6569.99 412.69,-6570.06"/>
</g>
<!-- gate_0_2 -->
<g id="node12" class="node">
<title>gate_0_2</title>
<polygon fill="lightyellow" stroke="black" points="558.51,-6471.98 323.06,-6471.98 262.49,-6367.98 497.94,-6367.98 558.51,-6471.98"/>
<text text-anchor="middle" x="410.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_0_L2</text>
<text text-anchor="middle" x="410.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="410.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="410.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_2&#45;&gt;gate_0_2 -->
<g id="edge10" class="edge">
<title>attention_0_2&#45;&gt;gate_0_2</title>
<path fill="none" stroke="black" d="M409.73,-6507.85C409.79,-6500.16 409.87,-6491.35 409.95,-6482.35"/>
<polygon fill="black" stroke="black" points="413.45,-6482.19 410.04,-6472.16 406.45,-6482.13 413.45,-6482.19"/>
</g>
<!-- expert_0_2 -->
<g id="node13" class="node">
<title>expert_0_2</title>
<polygon fill="lightgreen" stroke="black" points="487,-6331.98 338,-6331.98 338,-6279.98 487,-6279.98 487,-6331.98"/>
<text text-anchor="middle" x="412.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_0_L2</text>
<text text-anchor="middle" x="412.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="412.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="412.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_2&#45;&gt;expert_0_2 -->
<g id="edge11" class="edge">
<title>gate_0_2&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" d="M404.69,-6367.9C404.76,-6359.23 405.05,-6350.41 405.55,-6342.27"/>
<polygon fill="black" stroke="black" points="409.06,-6342.26 406.32,-6332.03 402.08,-6341.74 409.06,-6342.26"/>
</g>
<!-- gate_0_2&#45;&gt;expert_0_2 -->
<g id="edge1059" class="edge">
<title>gate_0_2&#45;&gt;expert_0_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M418.14,-6367.9C418.38,-6359.23 418.4,-6350.41 418.19,-6342.27"/>
<polygon fill="red" stroke="red" points="421.68,-6341.88 417.79,-6332.03 414.69,-6342.16 421.68,-6341.88"/>
</g>
<!-- aggregate_0_2 -->
<g id="node14" class="node">
<title>aggregate_0_2</title>
<polygon fill="lightyellow" stroke="black" points="564.51,-6243.98 329.06,-6243.98 268.49,-6139.98 503.94,-6139.98 564.51,-6243.98"/>
<text text-anchor="middle" x="416.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L2</text>
<text text-anchor="middle" x="416.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="416.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="416.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_2&#45;&gt;aggregate_0_2 -->
<g id="edge12" class="edge">
<title>expert_0_2&#45;&gt;aggregate_0_2</title>
<path fill="none" stroke="black" d="M413.4,-6279.85C413.67,-6272.16 413.99,-6263.35 414.31,-6254.35"/>
<polygon fill="black" stroke="black" points="417.81,-6254.28 414.67,-6244.16 410.82,-6254.03 417.81,-6254.28"/>
</g>
<!-- attention_0_3 -->
<g id="node15" class="node">
<title>attention_0_3</title>
<polygon fill="lightgreen" stroke="black" points="509.5,-6103.98 341.5,-6103.98 341.5,-6051.98 509.5,-6051.98 509.5,-6103.98"/>
<text text-anchor="middle" x="425.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_0_L3</text>
<text text-anchor="middle" x="425.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="425.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="425.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_2&#45;&gt;attention_0_3 -->
<g id="edge13" class="edge">
<title>aggregate_0_2&#45;&gt;attention_0_3</title>
<path fill="none" stroke="black" d="M420.61,-6139.9C421.31,-6131.14 422.03,-6122.21 422.69,-6113.99"/>
<polygon fill="black" stroke="black" points="426.18,-6114.27 423.49,-6104.03 419.2,-6113.71 426.18,-6114.27"/>
</g>
<!-- gate_0_3 -->
<g id="node16" class="node">
<title>gate_0_3</title>
<polygon fill="lightyellow" stroke="black" points="575.51,-6015.98 340.06,-6015.98 279.49,-5911.98 514.94,-5911.98 575.51,-6015.98"/>
<text text-anchor="middle" x="427.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_0_L3</text>
<text text-anchor="middle" x="427.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="427.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="427.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_3&#45;&gt;gate_0_3 -->
<g id="edge14" class="edge">
<title>attention_0_3&#45;&gt;gate_0_3</title>
<path fill="none" stroke="black" d="M425.95,-6051.85C426.09,-6044.16 426.24,-6035.35 426.41,-6026.35"/>
<polygon fill="black" stroke="black" points="429.91,-6026.22 426.59,-6016.16 422.91,-6026.1 429.91,-6026.22"/>
</g>
<!-- expert_0_3 -->
<g id="node17" class="node">
<title>expert_0_3</title>
<polygon fill="lightgreen" stroke="black" points="502,-5875.98 353,-5875.98 353,-5823.98 502,-5823.98 502,-5875.98"/>
<text text-anchor="middle" x="427.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_0_L3</text>
<text text-anchor="middle" x="427.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="427.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="427.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_3&#45;&gt;expert_0_3 -->
<g id="edge15" class="edge">
<title>gate_0_3&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" d="M420.77,-5911.9C420.69,-5903.23 420.83,-5894.41 421.18,-5886.27"/>
<polygon fill="black" stroke="black" points="424.69,-5886.21 421.77,-5876.03 417.7,-5885.81 424.69,-5886.21"/>
</g>
<!-- gate_0_3&#45;&gt;expert_0_3 -->
<g id="edge1060" class="edge">
<title>gate_0_3&#45;&gt;expert_0_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M434.23,-5911.9C434.31,-5903.23 434.17,-5894.41 433.82,-5886.27"/>
<polygon fill="red" stroke="red" points="437.3,-5885.81 433.23,-5876.03 430.31,-5886.21 437.3,-5885.81"/>
</g>
<!-- aggregate_0_3 -->
<g id="node18" class="node">
<title>aggregate_0_3</title>
<polygon fill="lightyellow" stroke="black" points="576.51,-5787.98 341.06,-5787.98 280.49,-5683.98 515.94,-5683.98 576.51,-5787.98"/>
<text text-anchor="middle" x="428.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L3</text>
<text text-anchor="middle" x="428.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="428.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="428.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_3&#45;&gt;aggregate_0_3 -->
<g id="edge16" class="edge">
<title>expert_0_3&#45;&gt;aggregate_0_3</title>
<path fill="none" stroke="black" d="M427.73,-5823.85C427.79,-5816.16 427.87,-5807.35 427.95,-5798.35"/>
<polygon fill="black" stroke="black" points="431.45,-5798.19 428.04,-5788.16 424.45,-5798.13 431.45,-5798.19"/>
</g>
<!-- attention_0_4 -->
<g id="node19" class="node">
<title>attention_0_4</title>
<polygon fill="lightgreen" stroke="black" points="513.5,-5647.98 345.5,-5647.98 345.5,-5595.98 513.5,-5595.98 513.5,-5647.98"/>
<text text-anchor="middle" x="429.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_0_L4</text>
<text text-anchor="middle" x="429.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="429.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="429.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_3&#45;&gt;attention_0_4 -->
<g id="edge17" class="edge">
<title>aggregate_0_3&#45;&gt;attention_0_4</title>
<path fill="none" stroke="black" d="M428.96,-5683.9C429.03,-5675.23 429.11,-5666.41 429.19,-5658.27"/>
<polygon fill="black" stroke="black" points="432.69,-5658.06 429.28,-5648.03 425.69,-5657.99 432.69,-5658.06"/>
</g>
<!-- gate_0_4 -->
<g id="node20" class="node">
<title>gate_0_4</title>
<polygon fill="lightyellow" stroke="black" points="578.51,-5559.98 343.06,-5559.98 282.49,-5455.98 517.94,-5455.98 578.51,-5559.98"/>
<text text-anchor="middle" x="430.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_0_L4</text>
<text text-anchor="middle" x="430.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="430.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="430.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_4&#45;&gt;gate_0_4 -->
<g id="edge18" class="edge">
<title>attention_0_4&#45;&gt;gate_0_4</title>
<path fill="none" stroke="black" d="M429.73,-5595.85C429.79,-5588.16 429.87,-5579.35 429.95,-5570.35"/>
<polygon fill="black" stroke="black" points="433.45,-5570.19 430.04,-5560.16 426.45,-5570.13 433.45,-5570.19"/>
</g>
<!-- expert_0_4 -->
<g id="node21" class="node">
<title>expert_0_4</title>
<polygon fill="lightgreen" stroke="black" points="505,-5419.98 356,-5419.98 356,-5367.98 505,-5367.98 505,-5419.98"/>
<text text-anchor="middle" x="430.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_0_L4</text>
<text text-anchor="middle" x="430.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="430.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="430.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_4&#45;&gt;expert_0_4 -->
<g id="edge19" class="edge">
<title>gate_0_4&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" d="M423.77,-5455.9C423.69,-5447.23 423.83,-5438.41 424.18,-5430.27"/>
<polygon fill="black" stroke="black" points="427.69,-5430.21 424.77,-5420.03 420.7,-5429.81 427.69,-5430.21"/>
</g>
<!-- gate_0_4&#45;&gt;expert_0_4 -->
<g id="edge1061" class="edge">
<title>gate_0_4&#45;&gt;expert_0_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M437.23,-5455.9C437.31,-5447.23 437.17,-5438.41 436.82,-5430.27"/>
<polygon fill="red" stroke="red" points="440.3,-5429.81 436.23,-5420.03 433.31,-5430.21 440.3,-5429.81"/>
</g>
<!-- aggregate_0_4 -->
<g id="node22" class="node">
<title>aggregate_0_4</title>
<polygon fill="lightyellow" stroke="black" points="578.51,-5331.98 343.06,-5331.98 282.49,-5227.98 517.94,-5227.98 578.51,-5331.98"/>
<text text-anchor="middle" x="430.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L4</text>
<text text-anchor="middle" x="430.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="430.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="430.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_4&#45;&gt;aggregate_0_4 -->
<g id="edge20" class="edge">
<title>expert_0_4&#45;&gt;aggregate_0_4</title>
<path fill="none" stroke="black" d="M430.5,-5367.85C430.5,-5360.16 430.5,-5351.35 430.5,-5342.35"/>
<polygon fill="black" stroke="black" points="434,-5342.16 430.5,-5332.16 427,-5342.16 434,-5342.16"/>
</g>
<!-- attention_0_5 -->
<g id="node23" class="node">
<title>attention_0_5</title>
<polygon fill="lightgreen" stroke="black" points="517.5,-5191.98 349.5,-5191.98 349.5,-5139.98 517.5,-5139.98 517.5,-5191.98"/>
<text text-anchor="middle" x="433.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_0_L5</text>
<text text-anchor="middle" x="433.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="433.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="433.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_4&#45;&gt;attention_0_5 -->
<g id="edge21" class="edge">
<title>aggregate_0_4&#45;&gt;attention_0_5</title>
<path fill="none" stroke="black" d="M431.87,-5227.9C432.1,-5219.23 432.34,-5210.41 432.56,-5202.27"/>
<polygon fill="black" stroke="black" points="436.06,-5202.12 432.83,-5192.03 429.06,-5201.93 436.06,-5202.12"/>
</g>
<!-- gate_0_5 -->
<g id="node24" class="node">
<title>gate_0_5</title>
<polygon fill="lightyellow" stroke="black" points="581.51,-5103.98 346.06,-5103.98 285.49,-4999.98 520.94,-4999.98 581.51,-5103.98"/>
<text text-anchor="middle" x="433.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_0_L5</text>
<text text-anchor="middle" x="433.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="433.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="433.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_5&#45;&gt;gate_0_5 -->
<g id="edge22" class="edge">
<title>attention_0_5&#45;&gt;gate_0_5</title>
<path fill="none" stroke="black" d="M433.5,-5139.85C433.5,-5132.16 433.5,-5123.35 433.5,-5114.35"/>
<polygon fill="black" stroke="black" points="437,-5114.16 433.5,-5104.16 430,-5114.16 437,-5114.16"/>
</g>
<!-- expert_0_5 -->
<g id="node25" class="node">
<title>expert_0_5</title>
<polygon fill="lightgreen" stroke="black" points="508,-4963.98 359,-4963.98 359,-4911.98 508,-4911.98 508,-4963.98"/>
<text text-anchor="middle" x="433.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_0_L5</text>
<text text-anchor="middle" x="433.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="433.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="433.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_5&#45;&gt;expert_0_5 -->
<g id="edge23" class="edge">
<title>gate_0_5&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" d="M426.77,-4999.9C426.69,-4991.23 426.83,-4982.41 427.18,-4974.27"/>
<polygon fill="black" stroke="black" points="430.69,-4974.21 427.77,-4964.03 423.7,-4973.81 430.69,-4974.21"/>
</g>
<!-- gate_0_5&#45;&gt;expert_0_5 -->
<g id="edge1062" class="edge">
<title>gate_0_5&#45;&gt;expert_0_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M440.23,-4999.9C440.31,-4991.23 440.17,-4982.41 439.82,-4974.27"/>
<polygon fill="red" stroke="red" points="443.3,-4973.81 439.23,-4964.03 436.31,-4974.21 443.3,-4973.81"/>
</g>
<!-- aggregate_0_5 -->
<g id="node26" class="node">
<title>aggregate_0_5</title>
<polygon fill="lightyellow" stroke="black" points="581.51,-4875.98 346.06,-4875.98 285.49,-4771.98 520.94,-4771.98 581.51,-4875.98"/>
<text text-anchor="middle" x="433.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L5</text>
<text text-anchor="middle" x="433.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="433.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="433.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_5&#45;&gt;aggregate_0_5 -->
<g id="edge24" class="edge">
<title>expert_0_5&#45;&gt;aggregate_0_5</title>
<path fill="none" stroke="black" d="M433.5,-4911.85C433.5,-4904.16 433.5,-4895.35 433.5,-4886.35"/>
<polygon fill="black" stroke="black" points="437,-4886.16 433.5,-4876.16 430,-4886.16 437,-4886.16"/>
</g>
<!-- attention_0_6 -->
<g id="node27" class="node">
<title>attention_0_6</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-4735.98 355.5,-4735.98 355.5,-4683.98 523.5,-4683.98 523.5,-4735.98"/>
<text text-anchor="middle" x="439.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_0_L6</text>
<text text-anchor="middle" x="439.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_5&#45;&gt;attention_0_6 -->
<g id="edge25" class="edge">
<title>aggregate_0_5&#45;&gt;attention_0_6</title>
<path fill="none" stroke="black" d="M436.24,-4771.9C436.7,-4763.23 437.17,-4754.41 437.61,-4746.27"/>
<polygon fill="black" stroke="black" points="441.12,-4746.2 438.16,-4736.03 434.13,-4745.82 441.12,-4746.2"/>
</g>
<!-- gate_0_6 -->
<g id="node28" class="node">
<title>gate_0_6</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-4647.98 352.06,-4647.98 291.49,-4543.98 526.94,-4543.98 587.51,-4647.98"/>
<text text-anchor="middle" x="439.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_0_L6</text>
<text text-anchor="middle" x="439.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_6&#45;&gt;gate_0_6 -->
<g id="edge26" class="edge">
<title>attention_0_6&#45;&gt;gate_0_6</title>
<path fill="none" stroke="black" d="M439.5,-4683.85C439.5,-4676.16 439.5,-4667.35 439.5,-4658.35"/>
<polygon fill="black" stroke="black" points="443,-4658.16 439.5,-4648.16 436,-4658.16 443,-4658.16"/>
</g>
<!-- expert_0_6 -->
<g id="node29" class="node">
<title>expert_0_6</title>
<polygon fill="lightgreen" stroke="black" points="514,-4507.98 365,-4507.98 365,-4455.98 514,-4455.98 514,-4507.98"/>
<text text-anchor="middle" x="439.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_0_L6</text>
<text text-anchor="middle" x="439.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_6&#45;&gt;expert_0_6 -->
<g id="edge27" class="edge">
<title>gate_0_6&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" d="M432.77,-4543.9C432.69,-4535.23 432.83,-4526.41 433.18,-4518.27"/>
<polygon fill="black" stroke="black" points="436.69,-4518.21 433.77,-4508.03 429.7,-4517.81 436.69,-4518.21"/>
</g>
<!-- gate_0_6&#45;&gt;expert_0_6 -->
<g id="edge1063" class="edge">
<title>gate_0_6&#45;&gt;expert_0_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-4543.9C446.31,-4535.23 446.17,-4526.41 445.82,-4518.27"/>
<polygon fill="red" stroke="red" points="449.3,-4517.81 445.23,-4508.03 442.31,-4518.21 449.3,-4517.81"/>
</g>
<!-- aggregate_0_6 -->
<g id="node30" class="node">
<title>aggregate_0_6</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-4419.98 352.06,-4419.98 291.49,-4315.98 526.94,-4315.98 587.51,-4419.98"/>
<text text-anchor="middle" x="439.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L6</text>
<text text-anchor="middle" x="439.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_6&#45;&gt;aggregate_0_6 -->
<g id="edge28" class="edge">
<title>expert_0_6&#45;&gt;aggregate_0_6</title>
<path fill="none" stroke="black" d="M439.5,-4455.85C439.5,-4448.16 439.5,-4439.35 439.5,-4430.35"/>
<polygon fill="black" stroke="black" points="443,-4430.16 439.5,-4420.16 436,-4430.16 443,-4430.16"/>
</g>
<!-- attention_0_7 -->
<g id="node31" class="node">
<title>attention_0_7</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-4279.98 355.5,-4279.98 355.5,-4227.98 523.5,-4227.98 523.5,-4279.98"/>
<text text-anchor="middle" x="439.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_0_L7</text>
<text text-anchor="middle" x="439.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_6&#45;&gt;attention_0_7 -->
<g id="edge29" class="edge">
<title>aggregate_0_6&#45;&gt;attention_0_7</title>
<path fill="none" stroke="black" d="M439.5,-4315.9C439.5,-4307.23 439.5,-4298.41 439.5,-4290.27"/>
<polygon fill="black" stroke="black" points="443,-4290.03 439.5,-4280.03 436,-4290.03 443,-4290.03"/>
</g>
<!-- gate_0_7 -->
<g id="node32" class="node">
<title>gate_0_7</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-4191.98 352.06,-4191.98 291.49,-4087.98 526.94,-4087.98 587.51,-4191.98"/>
<text text-anchor="middle" x="439.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_0_L7</text>
<text text-anchor="middle" x="439.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_7&#45;&gt;gate_0_7 -->
<g id="edge30" class="edge">
<title>attention_0_7&#45;&gt;gate_0_7</title>
<path fill="none" stroke="black" d="M439.5,-4227.85C439.5,-4220.16 439.5,-4211.35 439.5,-4202.35"/>
<polygon fill="black" stroke="black" points="443,-4202.16 439.5,-4192.16 436,-4202.16 443,-4202.16"/>
</g>
<!-- expert_0_7 -->
<g id="node33" class="node">
<title>expert_0_7</title>
<polygon fill="lightgreen" stroke="black" points="514,-4051.98 365,-4051.98 365,-3999.98 514,-3999.98 514,-4051.98"/>
<text text-anchor="middle" x="439.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_0_L7</text>
<text text-anchor="middle" x="439.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_7&#45;&gt;expert_0_7 -->
<g id="edge31" class="edge">
<title>gate_0_7&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" d="M432.77,-4087.9C432.69,-4079.23 432.83,-4070.41 433.18,-4062.27"/>
<polygon fill="black" stroke="black" points="436.69,-4062.21 433.77,-4052.03 429.7,-4061.81 436.69,-4062.21"/>
</g>
<!-- gate_0_7&#45;&gt;expert_0_7 -->
<g id="edge1064" class="edge">
<title>gate_0_7&#45;&gt;expert_0_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-4087.9C446.31,-4079.23 446.17,-4070.41 445.82,-4062.27"/>
<polygon fill="red" stroke="red" points="449.3,-4061.81 445.23,-4052.03 442.31,-4062.21 449.3,-4061.81"/>
</g>
<!-- aggregate_0_7 -->
<g id="node34" class="node">
<title>aggregate_0_7</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-3963.98 352.06,-3963.98 291.49,-3859.98 526.94,-3859.98 587.51,-3963.98"/>
<text text-anchor="middle" x="439.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L7</text>
<text text-anchor="middle" x="439.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_7&#45;&gt;aggregate_0_7 -->
<g id="edge32" class="edge">
<title>expert_0_7&#45;&gt;aggregate_0_7</title>
<path fill="none" stroke="black" d="M439.5,-3999.85C439.5,-3992.16 439.5,-3983.35 439.5,-3974.35"/>
<polygon fill="black" stroke="black" points="443,-3974.16 439.5,-3964.16 436,-3974.16 443,-3974.16"/>
</g>
<!-- attention_0_8 -->
<g id="node35" class="node">
<title>attention_0_8</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-3823.98 355.5,-3823.98 355.5,-3771.98 523.5,-3771.98 523.5,-3823.98"/>
<text text-anchor="middle" x="439.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_0_L8</text>
<text text-anchor="middle" x="439.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_7&#45;&gt;attention_0_8 -->
<g id="edge33" class="edge">
<title>aggregate_0_7&#45;&gt;attention_0_8</title>
<path fill="none" stroke="black" d="M439.5,-3859.9C439.5,-3851.23 439.5,-3842.41 439.5,-3834.27"/>
<polygon fill="black" stroke="black" points="443,-3834.03 439.5,-3824.03 436,-3834.03 443,-3834.03"/>
</g>
<!-- gate_0_8 -->
<g id="node36" class="node">
<title>gate_0_8</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-3735.98 352.06,-3735.98 291.49,-3631.98 526.94,-3631.98 587.51,-3735.98"/>
<text text-anchor="middle" x="439.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_0_L8</text>
<text text-anchor="middle" x="439.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_8&#45;&gt;gate_0_8 -->
<g id="edge34" class="edge">
<title>attention_0_8&#45;&gt;gate_0_8</title>
<path fill="none" stroke="black" d="M439.5,-3771.85C439.5,-3764.16 439.5,-3755.35 439.5,-3746.35"/>
<polygon fill="black" stroke="black" points="443,-3746.16 439.5,-3736.16 436,-3746.16 443,-3746.16"/>
</g>
<!-- expert_0_8 -->
<g id="node37" class="node">
<title>expert_0_8</title>
<polygon fill="lightgreen" stroke="black" points="514,-3595.98 365,-3595.98 365,-3543.98 514,-3543.98 514,-3595.98"/>
<text text-anchor="middle" x="439.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_0_L8</text>
<text text-anchor="middle" x="439.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_8&#45;&gt;expert_0_8 -->
<g id="edge35" class="edge">
<title>gate_0_8&#45;&gt;expert_0_8</title>
<path fill="none" stroke="black" d="M432.77,-3631.9C432.69,-3623.23 432.83,-3614.41 433.18,-3606.27"/>
<polygon fill="black" stroke="black" points="436.69,-3606.21 433.77,-3596.03 429.7,-3605.81 436.69,-3606.21"/>
</g>
<!-- gate_0_8&#45;&gt;expert_0_8 -->
<g id="edge1065" class="edge">
<title>gate_0_8&#45;&gt;expert_0_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-3631.9C446.31,-3623.23 446.17,-3614.41 445.82,-3606.27"/>
<polygon fill="red" stroke="red" points="449.3,-3605.81 445.23,-3596.03 442.31,-3606.21 449.3,-3605.81"/>
</g>
<!-- aggregate_0_8 -->
<g id="node38" class="node">
<title>aggregate_0_8</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-3507.98 352.06,-3507.98 291.49,-3403.98 526.94,-3403.98 587.51,-3507.98"/>
<text text-anchor="middle" x="439.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L8</text>
<text text-anchor="middle" x="439.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_8&#45;&gt;aggregate_0_8 -->
<g id="edge36" class="edge">
<title>expert_0_8&#45;&gt;aggregate_0_8</title>
<path fill="none" stroke="black" d="M439.5,-3543.85C439.5,-3536.16 439.5,-3527.35 439.5,-3518.35"/>
<polygon fill="black" stroke="black" points="443,-3518.16 439.5,-3508.16 436,-3518.16 443,-3518.16"/>
</g>
<!-- attention_0_9 -->
<g id="node39" class="node">
<title>attention_0_9</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-3367.98 355.5,-3367.98 355.5,-3315.98 523.5,-3315.98 523.5,-3367.98"/>
<text text-anchor="middle" x="439.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_0_L9</text>
<text text-anchor="middle" x="439.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_8&#45;&gt;attention_0_9 -->
<g id="edge37" class="edge">
<title>aggregate_0_8&#45;&gt;attention_0_9</title>
<path fill="none" stroke="black" d="M439.5,-3403.9C439.5,-3395.23 439.5,-3386.41 439.5,-3378.27"/>
<polygon fill="black" stroke="black" points="443,-3378.03 439.5,-3368.03 436,-3378.03 443,-3378.03"/>
</g>
<!-- gate_0_9 -->
<g id="node40" class="node">
<title>gate_0_9</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-3279.98 352.06,-3279.98 291.49,-3175.98 526.94,-3175.98 587.51,-3279.98"/>
<text text-anchor="middle" x="439.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_0_L9</text>
<text text-anchor="middle" x="439.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_9&#45;&gt;gate_0_9 -->
<g id="edge38" class="edge">
<title>attention_0_9&#45;&gt;gate_0_9</title>
<path fill="none" stroke="black" d="M439.5,-3315.85C439.5,-3308.16 439.5,-3299.35 439.5,-3290.35"/>
<polygon fill="black" stroke="black" points="443,-3290.16 439.5,-3280.16 436,-3290.16 443,-3290.16"/>
</g>
<!-- expert_0_9 -->
<g id="node41" class="node">
<title>expert_0_9</title>
<polygon fill="lightgreen" stroke="black" points="514,-3139.98 365,-3139.98 365,-3087.98 514,-3087.98 514,-3139.98"/>
<text text-anchor="middle" x="439.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_0_L9</text>
<text text-anchor="middle" x="439.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_9&#45;&gt;expert_0_9 -->
<g id="edge39" class="edge">
<title>gate_0_9&#45;&gt;expert_0_9</title>
<path fill="none" stroke="black" d="M432.77,-3175.9C432.69,-3167.23 432.83,-3158.41 433.18,-3150.27"/>
<polygon fill="black" stroke="black" points="436.69,-3150.21 433.77,-3140.03 429.7,-3149.81 436.69,-3150.21"/>
</g>
<!-- gate_0_9&#45;&gt;expert_0_9 -->
<g id="edge1066" class="edge">
<title>gate_0_9&#45;&gt;expert_0_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-3175.9C446.31,-3167.23 446.17,-3158.41 445.82,-3150.27"/>
<polygon fill="red" stroke="red" points="449.3,-3149.81 445.23,-3140.03 442.31,-3150.21 449.3,-3149.81"/>
</g>
<!-- aggregate_0_9 -->
<g id="node42" class="node">
<title>aggregate_0_9</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-3051.98 352.06,-3051.98 291.49,-2947.98 526.94,-2947.98 587.51,-3051.98"/>
<text text-anchor="middle" x="439.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L9</text>
<text text-anchor="middle" x="439.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_9&#45;&gt;aggregate_0_9 -->
<g id="edge40" class="edge">
<title>expert_0_9&#45;&gt;aggregate_0_9</title>
<path fill="none" stroke="black" d="M439.5,-3087.85C439.5,-3080.16 439.5,-3071.35 439.5,-3062.35"/>
<polygon fill="black" stroke="black" points="443,-3062.16 439.5,-3052.16 436,-3062.16 443,-3062.16"/>
</g>
<!-- attention_0_10 -->
<g id="node43" class="node">
<title>attention_0_10</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-2911.98 355.5,-2911.98 355.5,-2859.98 523.5,-2859.98 523.5,-2911.98"/>
<text text-anchor="middle" x="439.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_0_L10</text>
<text text-anchor="middle" x="439.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_9&#45;&gt;attention_0_10 -->
<g id="edge41" class="edge">
<title>aggregate_0_9&#45;&gt;attention_0_10</title>
<path fill="none" stroke="black" d="M439.5,-2947.9C439.5,-2939.23 439.5,-2930.41 439.5,-2922.27"/>
<polygon fill="black" stroke="black" points="443,-2922.03 439.5,-2912.03 436,-2922.03 443,-2922.03"/>
</g>
<!-- gate_0_10 -->
<g id="node44" class="node">
<title>gate_0_10</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-2823.98 352.06,-2823.98 291.49,-2719.98 526.94,-2719.98 587.51,-2823.98"/>
<text text-anchor="middle" x="439.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_0_L10</text>
<text text-anchor="middle" x="439.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_10&#45;&gt;gate_0_10 -->
<g id="edge42" class="edge">
<title>attention_0_10&#45;&gt;gate_0_10</title>
<path fill="none" stroke="black" d="M439.5,-2859.85C439.5,-2852.16 439.5,-2843.35 439.5,-2834.35"/>
<polygon fill="black" stroke="black" points="443,-2834.16 439.5,-2824.16 436,-2834.16 443,-2834.16"/>
</g>
<!-- expert_0_10 -->
<g id="node45" class="node">
<title>expert_0_10</title>
<polygon fill="lightgreen" stroke="black" points="514,-2683.98 365,-2683.98 365,-2631.98 514,-2631.98 514,-2683.98"/>
<text text-anchor="middle" x="439.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_0_L10</text>
<text text-anchor="middle" x="439.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_10&#45;&gt;expert_0_10 -->
<g id="edge43" class="edge">
<title>gate_0_10&#45;&gt;expert_0_10</title>
<path fill="none" stroke="black" d="M432.77,-2719.9C432.69,-2711.23 432.83,-2702.41 433.18,-2694.27"/>
<polygon fill="black" stroke="black" points="436.69,-2694.21 433.77,-2684.03 429.7,-2693.81 436.69,-2694.21"/>
</g>
<!-- gate_0_10&#45;&gt;expert_0_10 -->
<g id="edge1067" class="edge">
<title>gate_0_10&#45;&gt;expert_0_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-2719.9C446.31,-2711.23 446.17,-2702.41 445.82,-2694.27"/>
<polygon fill="red" stroke="red" points="449.3,-2693.81 445.23,-2684.03 442.31,-2694.21 449.3,-2693.81"/>
</g>
<!-- aggregate_0_10 -->
<g id="node46" class="node">
<title>aggregate_0_10</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-2595.98 352.06,-2595.98 291.49,-2491.98 526.94,-2491.98 587.51,-2595.98"/>
<text text-anchor="middle" x="439.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L10</text>
<text text-anchor="middle" x="439.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_10&#45;&gt;aggregate_0_10 -->
<g id="edge44" class="edge">
<title>expert_0_10&#45;&gt;aggregate_0_10</title>
<path fill="none" stroke="black" d="M439.5,-2631.85C439.5,-2624.16 439.5,-2615.35 439.5,-2606.35"/>
<polygon fill="black" stroke="black" points="443,-2606.16 439.5,-2596.16 436,-2606.16 443,-2606.16"/>
</g>
<!-- attention_0_11 -->
<g id="node47" class="node">
<title>attention_0_11</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-2455.98 355.5,-2455.98 355.5,-2403.98 523.5,-2403.98 523.5,-2455.98"/>
<text text-anchor="middle" x="439.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_0_L11</text>
<text text-anchor="middle" x="439.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_10&#45;&gt;attention_0_11 -->
<g id="edge45" class="edge">
<title>aggregate_0_10&#45;&gt;attention_0_11</title>
<path fill="none" stroke="black" d="M439.5,-2491.9C439.5,-2483.23 439.5,-2474.41 439.5,-2466.27"/>
<polygon fill="black" stroke="black" points="443,-2466.03 439.5,-2456.03 436,-2466.03 443,-2466.03"/>
</g>
<!-- gate_0_11 -->
<g id="node48" class="node">
<title>gate_0_11</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-2367.98 352.06,-2367.98 291.49,-2263.98 526.94,-2263.98 587.51,-2367.98"/>
<text text-anchor="middle" x="439.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_0_L11</text>
<text text-anchor="middle" x="439.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_11&#45;&gt;gate_0_11 -->
<g id="edge46" class="edge">
<title>attention_0_11&#45;&gt;gate_0_11</title>
<path fill="none" stroke="black" d="M439.5,-2403.85C439.5,-2396.16 439.5,-2387.35 439.5,-2378.35"/>
<polygon fill="black" stroke="black" points="443,-2378.16 439.5,-2368.16 436,-2378.16 443,-2378.16"/>
</g>
<!-- expert_0_11 -->
<g id="node49" class="node">
<title>expert_0_11</title>
<polygon fill="lightgreen" stroke="black" points="514,-2227.98 365,-2227.98 365,-2175.98 514,-2175.98 514,-2227.98"/>
<text text-anchor="middle" x="439.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_0_L11</text>
<text text-anchor="middle" x="439.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_11&#45;&gt;expert_0_11 -->
<g id="edge47" class="edge">
<title>gate_0_11&#45;&gt;expert_0_11</title>
<path fill="none" stroke="black" d="M432.77,-2263.9C432.69,-2255.23 432.83,-2246.41 433.18,-2238.27"/>
<polygon fill="black" stroke="black" points="436.69,-2238.21 433.77,-2228.03 429.7,-2237.81 436.69,-2238.21"/>
</g>
<!-- gate_0_11&#45;&gt;expert_0_11 -->
<g id="edge1068" class="edge">
<title>gate_0_11&#45;&gt;expert_0_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-2263.9C446.31,-2255.23 446.17,-2246.41 445.82,-2238.27"/>
<polygon fill="red" stroke="red" points="449.3,-2237.81 445.23,-2228.03 442.31,-2238.21 449.3,-2237.81"/>
</g>
<!-- aggregate_0_11 -->
<g id="node50" class="node">
<title>aggregate_0_11</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-2139.98 352.06,-2139.98 291.49,-2035.98 526.94,-2035.98 587.51,-2139.98"/>
<text text-anchor="middle" x="439.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L11</text>
<text text-anchor="middle" x="439.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_11&#45;&gt;aggregate_0_11 -->
<g id="edge48" class="edge">
<title>expert_0_11&#45;&gt;aggregate_0_11</title>
<path fill="none" stroke="black" d="M439.5,-2175.85C439.5,-2168.16 439.5,-2159.35 439.5,-2150.35"/>
<polygon fill="black" stroke="black" points="443,-2150.16 439.5,-2140.16 436,-2150.16 443,-2150.16"/>
</g>
<!-- attention_0_12 -->
<g id="node51" class="node">
<title>attention_0_12</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-1999.98 355.5,-1999.98 355.5,-1947.98 523.5,-1947.98 523.5,-1999.98"/>
<text text-anchor="middle" x="439.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_0_L12</text>
<text text-anchor="middle" x="439.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_11&#45;&gt;attention_0_12 -->
<g id="edge49" class="edge">
<title>aggregate_0_11&#45;&gt;attention_0_12</title>
<path fill="none" stroke="black" d="M439.5,-2035.9C439.5,-2027.23 439.5,-2018.41 439.5,-2010.27"/>
<polygon fill="black" stroke="black" points="443,-2010.03 439.5,-2000.03 436,-2010.03 443,-2010.03"/>
</g>
<!-- gate_0_12 -->
<g id="node52" class="node">
<title>gate_0_12</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-1911.98 352.06,-1911.98 291.49,-1807.98 526.94,-1807.98 587.51,-1911.98"/>
<text text-anchor="middle" x="439.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_0_L12</text>
<text text-anchor="middle" x="439.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_12&#45;&gt;gate_0_12 -->
<g id="edge50" class="edge">
<title>attention_0_12&#45;&gt;gate_0_12</title>
<path fill="none" stroke="black" d="M439.5,-1947.85C439.5,-1940.16 439.5,-1931.35 439.5,-1922.35"/>
<polygon fill="black" stroke="black" points="443,-1922.16 439.5,-1912.16 436,-1922.16 443,-1922.16"/>
</g>
<!-- expert_0_12 -->
<g id="node53" class="node">
<title>expert_0_12</title>
<polygon fill="lightgreen" stroke="black" points="514,-1771.98 365,-1771.98 365,-1719.98 514,-1719.98 514,-1771.98"/>
<text text-anchor="middle" x="439.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_0_L12</text>
<text text-anchor="middle" x="439.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_12&#45;&gt;expert_0_12 -->
<g id="edge51" class="edge">
<title>gate_0_12&#45;&gt;expert_0_12</title>
<path fill="none" stroke="black" d="M432.77,-1807.9C432.69,-1799.23 432.83,-1790.41 433.18,-1782.27"/>
<polygon fill="black" stroke="black" points="436.69,-1782.21 433.77,-1772.03 429.7,-1781.81 436.69,-1782.21"/>
</g>
<!-- gate_0_12&#45;&gt;expert_0_12 -->
<g id="edge1069" class="edge">
<title>gate_0_12&#45;&gt;expert_0_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-1807.9C446.31,-1799.23 446.17,-1790.41 445.82,-1782.27"/>
<polygon fill="red" stroke="red" points="449.3,-1781.81 445.23,-1772.03 442.31,-1782.21 449.3,-1781.81"/>
</g>
<!-- aggregate_0_12 -->
<g id="node54" class="node">
<title>aggregate_0_12</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-1683.98 352.06,-1683.98 291.49,-1579.98 526.94,-1579.98 587.51,-1683.98"/>
<text text-anchor="middle" x="439.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L12</text>
<text text-anchor="middle" x="439.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_12&#45;&gt;aggregate_0_12 -->
<g id="edge52" class="edge">
<title>expert_0_12&#45;&gt;aggregate_0_12</title>
<path fill="none" stroke="black" d="M439.5,-1719.85C439.5,-1712.16 439.5,-1703.35 439.5,-1694.35"/>
<polygon fill="black" stroke="black" points="443,-1694.16 439.5,-1684.16 436,-1694.16 443,-1694.16"/>
</g>
<!-- attention_0_13 -->
<g id="node55" class="node">
<title>attention_0_13</title>
<polygon fill="lightgreen" stroke="black" points="523.5,-1543.98 355.5,-1543.98 355.5,-1491.98 523.5,-1491.98 523.5,-1543.98"/>
<text text-anchor="middle" x="439.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_0_L13</text>
<text text-anchor="middle" x="439.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="439.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="439.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_12&#45;&gt;attention_0_13 -->
<g id="edge53" class="edge">
<title>aggregate_0_12&#45;&gt;attention_0_13</title>
<path fill="none" stroke="black" d="M439.5,-1579.9C439.5,-1571.23 439.5,-1562.41 439.5,-1554.27"/>
<polygon fill="black" stroke="black" points="443,-1554.03 439.5,-1544.03 436,-1554.03 443,-1554.03"/>
</g>
<!-- gate_0_13 -->
<g id="node56" class="node">
<title>gate_0_13</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-1455.98 352.06,-1455.98 291.49,-1351.98 526.94,-1351.98 587.51,-1455.98"/>
<text text-anchor="middle" x="439.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_0_L13</text>
<text text-anchor="middle" x="439.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="439.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_13&#45;&gt;gate_0_13 -->
<g id="edge54" class="edge">
<title>attention_0_13&#45;&gt;gate_0_13</title>
<path fill="none" stroke="black" d="M439.5,-1491.85C439.5,-1484.16 439.5,-1475.35 439.5,-1466.35"/>
<polygon fill="black" stroke="black" points="443,-1466.16 439.5,-1456.16 436,-1466.16 443,-1466.16"/>
</g>
<!-- expert_0_13 -->
<g id="node57" class="node">
<title>expert_0_13</title>
<polygon fill="lightgreen" stroke="black" points="514,-1315.98 365,-1315.98 365,-1263.98 514,-1263.98 514,-1315.98"/>
<text text-anchor="middle" x="439.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_0_L13</text>
<text text-anchor="middle" x="439.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="439.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="439.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_13&#45;&gt;expert_0_13 -->
<g id="edge55" class="edge">
<title>gate_0_13&#45;&gt;expert_0_13</title>
<path fill="none" stroke="black" d="M432.77,-1351.9C432.69,-1343.23 432.83,-1334.41 433.18,-1326.27"/>
<polygon fill="black" stroke="black" points="436.69,-1326.21 433.77,-1316.03 429.7,-1325.81 436.69,-1326.21"/>
</g>
<!-- gate_0_13&#45;&gt;expert_0_13 -->
<g id="edge1070" class="edge">
<title>gate_0_13&#45;&gt;expert_0_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M446.23,-1351.9C446.31,-1343.23 446.17,-1334.41 445.82,-1326.27"/>
<polygon fill="red" stroke="red" points="449.3,-1325.81 445.23,-1316.03 442.31,-1326.21 449.3,-1325.81"/>
</g>
<!-- aggregate_0_13 -->
<g id="node58" class="node">
<title>aggregate_0_13</title>
<polygon fill="lightyellow" stroke="black" points="587.51,-1227.98 352.06,-1227.98 291.49,-1123.98 526.94,-1123.98 587.51,-1227.98"/>
<text text-anchor="middle" x="439.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L13</text>
<text text-anchor="middle" x="439.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="439.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="439.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_13&#45;&gt;aggregate_0_13 -->
<g id="edge56" class="edge">
<title>expert_0_13&#45;&gt;aggregate_0_13</title>
<path fill="none" stroke="black" d="M439.5,-1263.85C439.5,-1256.16 439.5,-1247.35 439.5,-1238.35"/>
<polygon fill="black" stroke="black" points="443,-1238.16 439.5,-1228.16 436,-1238.16 443,-1238.16"/>
</g>
<!-- attention_0_14 -->
<g id="node59" class="node">
<title>attention_0_14</title>
<polygon fill="lightgreen" stroke="black" points="524.5,-1087.98 356.5,-1087.98 356.5,-1035.98 524.5,-1035.98 524.5,-1087.98"/>
<text text-anchor="middle" x="440.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_0_L14</text>
<text text-anchor="middle" x="440.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="440.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="440.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_13&#45;&gt;attention_0_14 -->
<g id="edge57" class="edge">
<title>aggregate_0_13&#45;&gt;attention_0_14</title>
<path fill="none" stroke="black" d="M439.96,-1123.9C440.03,-1115.23 440.11,-1106.41 440.19,-1098.27"/>
<polygon fill="black" stroke="black" points="443.69,-1098.06 440.28,-1088.03 436.69,-1097.99 443.69,-1098.06"/>
</g>
<!-- gate_0_14 -->
<g id="node60" class="node">
<title>gate_0_14</title>
<polygon fill="lightyellow" stroke="black" points="588.51,-999.98 353.06,-999.98 292.49,-895.98 527.94,-895.98 588.51,-999.98"/>
<text text-anchor="middle" x="440.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_0_L14</text>
<text text-anchor="middle" x="440.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="440.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="440.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_14&#45;&gt;gate_0_14 -->
<g id="edge58" class="edge">
<title>attention_0_14&#45;&gt;gate_0_14</title>
<path fill="none" stroke="black" d="M440.5,-1035.85C440.5,-1028.16 440.5,-1019.35 440.5,-1010.35"/>
<polygon fill="black" stroke="black" points="444,-1010.16 440.5,-1000.16 437,-1010.16 444,-1010.16"/>
</g>
<!-- expert_0_14 -->
<g id="node61" class="node">
<title>expert_0_14</title>
<polygon fill="lightgreen" stroke="black" points="515,-859.98 366,-859.98 366,-807.98 515,-807.98 515,-859.98"/>
<text text-anchor="middle" x="440.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_0_L14</text>
<text text-anchor="middle" x="440.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="440.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="440.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_14&#45;&gt;expert_0_14 -->
<g id="edge59" class="edge">
<title>gate_0_14&#45;&gt;expert_0_14</title>
<path fill="none" stroke="black" d="M433.77,-895.9C433.69,-887.23 433.83,-878.41 434.18,-870.27"/>
<polygon fill="black" stroke="black" points="437.69,-870.21 434.77,-860.03 430.7,-869.81 437.69,-870.21"/>
</g>
<!-- gate_0_14&#45;&gt;expert_0_14 -->
<g id="edge1071" class="edge">
<title>gate_0_14&#45;&gt;expert_0_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M447.23,-895.9C447.31,-887.23 447.17,-878.41 446.82,-870.27"/>
<polygon fill="red" stroke="red" points="450.3,-869.81 446.23,-860.03 443.31,-870.21 450.3,-869.81"/>
</g>
<!-- aggregate_0_14 -->
<g id="node62" class="node">
<title>aggregate_0_14</title>
<polygon fill="lightyellow" stroke="black" points="588.51,-771.98 353.06,-771.98 292.49,-667.98 527.94,-667.98 588.51,-771.98"/>
<text text-anchor="middle" x="440.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L14</text>
<text text-anchor="middle" x="440.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="440.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="440.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_14&#45;&gt;aggregate_0_14 -->
<g id="edge60" class="edge">
<title>expert_0_14&#45;&gt;aggregate_0_14</title>
<path fill="none" stroke="black" d="M440.5,-807.85C440.5,-800.16 440.5,-791.35 440.5,-782.35"/>
<polygon fill="black" stroke="black" points="444,-782.16 440.5,-772.16 437,-782.16 444,-782.16"/>
</g>
<!-- attention_0_15 -->
<g id="node63" class="node">
<title>attention_0_15</title>
<polygon fill="lightgreen" stroke="black" points="525.5,-631.98 357.5,-631.98 357.5,-579.98 525.5,-579.98 525.5,-631.98"/>
<text text-anchor="middle" x="441.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_0_L15</text>
<text text-anchor="middle" x="441.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="441.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="441.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_0_14&#45;&gt;attention_0_15 -->
<g id="edge61" class="edge">
<title>aggregate_0_14&#45;&gt;attention_0_15</title>
<path fill="none" stroke="black" d="M440.96,-667.9C441.03,-659.23 441.11,-650.41 441.19,-642.27"/>
<polygon fill="black" stroke="black" points="444.69,-642.06 441.28,-632.03 437.69,-641.99 444.69,-642.06"/>
</g>
<!-- gate_0_15 -->
<g id="node64" class="node">
<title>gate_0_15</title>
<polygon fill="lightyellow" stroke="black" points="592.51,-543.98 357.06,-543.98 296.49,-439.98 531.94,-439.98 592.51,-543.98"/>
<text text-anchor="middle" x="444.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_0_L15</text>
<text text-anchor="middle" x="444.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="444.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="444.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_0_15&#45;&gt;gate_0_15 -->
<g id="edge62" class="edge">
<title>attention_0_15&#45;&gt;gate_0_15</title>
<path fill="none" stroke="black" d="M442.17,-579.85C442.38,-572.16 442.62,-563.35 442.86,-554.35"/>
<polygon fill="black" stroke="black" points="446.36,-554.25 443.13,-544.16 439.36,-554.06 446.36,-554.25"/>
</g>
<!-- expert_0_15 -->
<g id="node65" class="node">
<title>expert_0_15</title>
<polygon fill="lightgreen" stroke="black" points="519,-403.98 370,-403.98 370,-351.98 519,-351.98 519,-403.98"/>
<text text-anchor="middle" x="444.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_0_L15</text>
<text text-anchor="middle" x="444.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=0</text>
<text text-anchor="middle" x="444.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="444.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_0_15&#45;&gt;expert_0_15 -->
<g id="edge63" class="edge">
<title>gate_0_15&#45;&gt;expert_0_15</title>
<path fill="none" stroke="black" d="M437.77,-439.9C437.69,-431.23 437.83,-422.41 438.18,-414.27"/>
<polygon fill="black" stroke="black" points="441.69,-414.21 438.77,-404.03 434.7,-413.81 441.69,-414.21"/>
</g>
<!-- gate_0_15&#45;&gt;expert_0_15 -->
<g id="edge1072" class="edge">
<title>gate_0_15&#45;&gt;expert_0_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M451.23,-439.9C451.31,-431.23 451.17,-422.41 450.82,-414.27"/>
<polygon fill="red" stroke="red" points="454.3,-413.81 450.23,-404.03 447.31,-414.21 454.3,-413.81"/>
</g>
<!-- aggregate_0_15 -->
<g id="node66" class="node">
<title>aggregate_0_15</title>
<polygon fill="lightyellow" stroke="black" points="593.51,-315.98 358.06,-315.98 297.49,-211.98 532.94,-211.98 593.51,-315.98"/>
<text text-anchor="middle" x="445.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_0_L15</text>
<text text-anchor="middle" x="445.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="445.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="445.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_0_15&#45;&gt;aggregate_0_15 -->
<g id="edge64" class="edge">
<title>expert_0_15&#45;&gt;aggregate_0_15</title>
<path fill="none" stroke="black" d="M444.73,-351.85C444.79,-344.16 444.87,-335.35 444.95,-326.35"/>
<polygon fill="black" stroke="black" points="448.45,-326.19 445.04,-316.16 441.45,-326.13 448.45,-326.19"/>
</g>
<!-- collect_0 -->
<g id="node67" class="node">
<title>collect_0</title>
<polygon fill="lightyellow" stroke="black" points="599.51,-175.98 364.06,-175.98 303.49,-93.98 538.94,-93.98 599.51,-175.98"/>
<text text-anchor="middle" x="451.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_0</text>
<text text-anchor="middle" x="451.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="451.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_0_15&#45;&gt;collect_0 -->
<g id="edge65" class="edge">
<title>aggregate_0_15&#45;&gt;collect_0</title>
<path fill="none" stroke="black" d="M447.92,-211.69C448.32,-203.27 448.73,-194.56 449.13,-186.17"/>
<polygon fill="black" stroke="black" points="452.63,-186.29 449.6,-176.14 445.64,-185.96 452.63,-186.29"/>
</g>
<!-- output -->
<g id="node1058" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="2813.5" cy="-28.99" rx="119.5" ry="28.98"/>
<text text-anchor="middle" x="2813.5" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="2813.5" y="-26.49" font-family="Arial" font-size="10.00">Batch Size=128, Seq Len=Variable</text>
<text text-anchor="middle" x="2813.5" y="-15.49" font-family="Arial" font-size="10.00">Token Dim=512</text>
</g>
<!-- collect_0&#45;&gt;output -->
<g id="edge1041" class="edge">
<title>collect_0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M548.19,-105.95C568.29,-101.13 589.46,-96.78 609.5,-93.98 1013.92,-37.61 2274.93,-30.75 2683.98,-30.03"/>
<polygon fill="black" stroke="black" points="2684.07,-33.53 2694.07,-30.02 2684.06,-26.53 2684.07,-33.53"/>
</g>
<!-- distribute_1 -->
<g id="node68" class="node">
<title>distribute_1</title>
<polygon fill="lightyellow" stroke="black" points="880.73,-7589.98 640.16,-7589.98 578.27,-7507.98 818.85,-7507.98 880.73,-7589.98"/>
<text text-anchor="middle" x="729.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_1</text>
<text text-anchor="middle" x="729.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="729.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_0 -->
<g id="node69" class="node">
<title>attention_1_0</title>
<polygon fill="lightgreen" stroke="black" points="815.5,-7471.98 647.5,-7471.98 647.5,-7419.98 815.5,-7419.98 815.5,-7471.98"/>
<text text-anchor="middle" x="731.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_1_L0</text>
<text text-anchor="middle" x="731.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="731.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="731.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_1&#45;&gt;attention_1_0 -->
<g id="edge66" class="edge">
<title>distribute_1&#45;&gt;attention_1_0</title>
<path fill="none" stroke="black" d="M730.3,-7507.77C730.46,-7499.34 730.64,-7490.51 730.8,-7482.27"/>
<polygon fill="black" stroke="black" points="734.3,-7482.3 731,-7472.23 727.3,-7482.16 734.3,-7482.3"/>
</g>
<!-- gate_1_0 -->
<g id="node70" class="node">
<title>gate_1_0</title>
<polygon fill="lightyellow" stroke="black" points="881.51,-7383.98 646.06,-7383.98 585.49,-7279.98 820.94,-7279.98 881.51,-7383.98"/>
<text text-anchor="middle" x="733.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_1_L0</text>
<text text-anchor="middle" x="733.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="733.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="733.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_0&#45;&gt;gate_1_0 -->
<g id="edge67" class="edge">
<title>attention_1_0&#45;&gt;gate_1_0</title>
<path fill="none" stroke="black" d="M731.95,-7419.85C732.09,-7412.16 732.24,-7403.35 732.41,-7394.35"/>
<polygon fill="black" stroke="black" points="735.91,-7394.22 732.59,-7384.16 728.91,-7394.1 735.91,-7394.22"/>
</g>
<!-- expert_1_0 -->
<g id="node71" class="node">
<title>expert_1_0</title>
<polygon fill="lightgreen" stroke="black" points="808,-7243.98 659,-7243.98 659,-7191.98 808,-7191.98 808,-7243.98"/>
<text text-anchor="middle" x="733.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_1_L0</text>
<text text-anchor="middle" x="733.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="733.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="733.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_0&#45;&gt;expert_1_0 -->
<g id="edge68" class="edge">
<title>gate_1_0&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M726.77,-7279.9C726.69,-7271.23 726.83,-7262.41 727.18,-7254.27"/>
<polygon fill="black" stroke="black" points="730.69,-7254.21 727.77,-7244.03 723.7,-7253.81 730.69,-7254.21"/>
</g>
<!-- gate_1_0&#45;&gt;expert_1_0 -->
<g id="edge1073" class="edge">
<title>gate_1_0&#45;&gt;expert_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M740.23,-7279.9C740.31,-7271.23 740.17,-7262.41 739.82,-7254.27"/>
<polygon fill="red" stroke="red" points="743.3,-7253.81 739.23,-7244.03 736.31,-7254.21 743.3,-7253.81"/>
</g>
<!-- aggregate_1_0 -->
<g id="node72" class="node">
<title>aggregate_1_0</title>
<polygon fill="lightyellow" stroke="black" points="885.51,-7155.98 650.06,-7155.98 589.49,-7051.98 824.94,-7051.98 885.51,-7155.98"/>
<text text-anchor="middle" x="737.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L0</text>
<text text-anchor="middle" x="737.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="737.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="737.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_0&#45;&gt;aggregate_1_0 -->
<g id="edge69" class="edge">
<title>expert_1_0&#45;&gt;aggregate_1_0</title>
<path fill="none" stroke="black" d="M734.4,-7191.85C734.67,-7184.16 734.99,-7175.35 735.31,-7166.35"/>
<polygon fill="black" stroke="black" points="738.81,-7166.28 735.67,-7156.16 731.82,-7166.03 738.81,-7166.28"/>
</g>
<!-- attention_1_1 -->
<g id="node73" class="node">
<title>attention_1_1</title>
<polygon fill="lightgreen" stroke="black" points="821.5,-7015.98 653.5,-7015.98 653.5,-6963.98 821.5,-6963.98 821.5,-7015.98"/>
<text text-anchor="middle" x="737.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_1_L1</text>
<text text-anchor="middle" x="737.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="737.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="737.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_0&#45;&gt;attention_1_1 -->
<g id="edge70" class="edge">
<title>aggregate_1_0&#45;&gt;attention_1_1</title>
<path fill="none" stroke="black" d="M737.5,-7051.9C737.5,-7043.23 737.5,-7034.41 737.5,-7026.27"/>
<polygon fill="black" stroke="black" points="741,-7026.03 737.5,-7016.03 734,-7026.03 741,-7026.03"/>
</g>
<!-- gate_1_1 -->
<g id="node74" class="node">
<title>gate_1_1</title>
<polygon fill="lightyellow" stroke="black" points="887.51,-6927.98 652.06,-6927.98 591.49,-6823.98 826.94,-6823.98 887.51,-6927.98"/>
<text text-anchor="middle" x="739.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_1_L1</text>
<text text-anchor="middle" x="739.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="739.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="739.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_1&#45;&gt;gate_1_1 -->
<g id="edge71" class="edge">
<title>attention_1_1&#45;&gt;gate_1_1</title>
<path fill="none" stroke="black" d="M737.95,-6963.85C738.09,-6956.16 738.24,-6947.35 738.41,-6938.35"/>
<polygon fill="black" stroke="black" points="741.91,-6938.22 738.59,-6928.16 734.91,-6938.1 741.91,-6938.22"/>
</g>
<!-- expert_1_1 -->
<g id="node75" class="node">
<title>expert_1_1</title>
<polygon fill="lightgreen" stroke="black" points="814,-6787.98 665,-6787.98 665,-6735.98 814,-6735.98 814,-6787.98"/>
<text text-anchor="middle" x="739.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_1_L1</text>
<text text-anchor="middle" x="739.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="739.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="739.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_1&#45;&gt;expert_1_1 -->
<g id="edge72" class="edge">
<title>gate_1_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M732.77,-6823.9C732.69,-6815.23 732.83,-6806.41 733.18,-6798.27"/>
<polygon fill="black" stroke="black" points="736.69,-6798.21 733.77,-6788.03 729.7,-6797.81 736.69,-6798.21"/>
</g>
<!-- gate_1_1&#45;&gt;expert_1_1 -->
<g id="edge1074" class="edge">
<title>gate_1_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M746.23,-6823.9C746.31,-6815.23 746.17,-6806.41 745.82,-6798.27"/>
<polygon fill="red" stroke="red" points="749.3,-6797.81 745.23,-6788.03 742.31,-6798.21 749.3,-6797.81"/>
</g>
<!-- aggregate_1_1 -->
<g id="node76" class="node">
<title>aggregate_1_1</title>
<polygon fill="lightyellow" stroke="black" points="889.51,-6699.98 654.06,-6699.98 593.49,-6595.98 828.94,-6595.98 889.51,-6699.98"/>
<text text-anchor="middle" x="741.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L1</text>
<text text-anchor="middle" x="741.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="741.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="741.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_1&#45;&gt;aggregate_1_1 -->
<g id="edge73" class="edge">
<title>expert_1_1&#45;&gt;aggregate_1_1</title>
<path fill="none" stroke="black" d="M739.95,-6735.85C740.09,-6728.16 740.24,-6719.35 740.41,-6710.35"/>
<polygon fill="black" stroke="black" points="743.91,-6710.22 740.59,-6700.16 736.91,-6710.1 743.91,-6710.22"/>
</g>
<!-- attention_1_2 -->
<g id="node77" class="node">
<title>attention_1_2</title>
<polygon fill="lightgreen" stroke="black" points="825.5,-6559.98 657.5,-6559.98 657.5,-6507.98 825.5,-6507.98 825.5,-6559.98"/>
<text text-anchor="middle" x="741.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_1_L2</text>
<text text-anchor="middle" x="741.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="741.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="741.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_1&#45;&gt;attention_1_2 -->
<g id="edge74" class="edge">
<title>aggregate_1_1&#45;&gt;attention_1_2</title>
<path fill="none" stroke="black" d="M741.5,-6595.9C741.5,-6587.23 741.5,-6578.41 741.5,-6570.27"/>
<polygon fill="black" stroke="black" points="745,-6570.03 741.5,-6560.03 738,-6570.03 745,-6570.03"/>
</g>
<!-- gate_1_2 -->
<g id="node78" class="node">
<title>gate_1_2</title>
<polygon fill="lightyellow" stroke="black" points="890.51,-6471.98 655.06,-6471.98 594.49,-6367.98 829.94,-6367.98 890.51,-6471.98"/>
<text text-anchor="middle" x="742.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_1_L2</text>
<text text-anchor="middle" x="742.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="742.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="742.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_2&#45;&gt;gate_1_2 -->
<g id="edge75" class="edge">
<title>attention_1_2&#45;&gt;gate_1_2</title>
<path fill="none" stroke="black" d="M741.73,-6507.85C741.79,-6500.16 741.87,-6491.35 741.95,-6482.35"/>
<polygon fill="black" stroke="black" points="745.45,-6482.19 742.04,-6472.16 738.45,-6482.13 745.45,-6482.19"/>
</g>
<!-- expert_1_2 -->
<g id="node79" class="node">
<title>expert_1_2</title>
<polygon fill="lightgreen" stroke="black" points="817,-6331.98 668,-6331.98 668,-6279.98 817,-6279.98 817,-6331.98"/>
<text text-anchor="middle" x="742.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_1_L2</text>
<text text-anchor="middle" x="742.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="742.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="742.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_2&#45;&gt;expert_1_2 -->
<g id="edge76" class="edge">
<title>gate_1_2&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M735.77,-6367.9C735.69,-6359.23 735.83,-6350.41 736.18,-6342.27"/>
<polygon fill="black" stroke="black" points="739.69,-6342.21 736.77,-6332.03 732.7,-6341.81 739.69,-6342.21"/>
</g>
<!-- gate_1_2&#45;&gt;expert_1_2 -->
<g id="edge1075" class="edge">
<title>gate_1_2&#45;&gt;expert_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M749.23,-6367.9C749.31,-6359.23 749.17,-6350.41 748.82,-6342.27"/>
<polygon fill="red" stroke="red" points="752.3,-6341.81 748.23,-6332.03 745.31,-6342.21 752.3,-6341.81"/>
</g>
<!-- aggregate_1_2 -->
<g id="node80" class="node">
<title>aggregate_1_2</title>
<polygon fill="lightyellow" stroke="black" points="890.51,-6243.98 655.06,-6243.98 594.49,-6139.98 829.94,-6139.98 890.51,-6243.98"/>
<text text-anchor="middle" x="742.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L2</text>
<text text-anchor="middle" x="742.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="742.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="742.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_2&#45;&gt;aggregate_1_2 -->
<g id="edge77" class="edge">
<title>expert_1_2&#45;&gt;aggregate_1_2</title>
<path fill="none" stroke="black" d="M742.5,-6279.85C742.5,-6272.16 742.5,-6263.35 742.5,-6254.35"/>
<polygon fill="black" stroke="black" points="746,-6254.16 742.5,-6244.16 739,-6254.16 746,-6254.16"/>
</g>
<!-- attention_1_3 -->
<g id="node81" class="node">
<title>attention_1_3</title>
<polygon fill="lightgreen" stroke="black" points="826.5,-6103.98 658.5,-6103.98 658.5,-6051.98 826.5,-6051.98 826.5,-6103.98"/>
<text text-anchor="middle" x="742.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_1_L3</text>
<text text-anchor="middle" x="742.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="742.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="742.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_2&#45;&gt;attention_1_3 -->
<g id="edge78" class="edge">
<title>aggregate_1_2&#45;&gt;attention_1_3</title>
<path fill="none" stroke="black" d="M742.5,-6139.9C742.5,-6131.23 742.5,-6122.41 742.5,-6114.27"/>
<polygon fill="black" stroke="black" points="746,-6114.03 742.5,-6104.03 739,-6114.03 746,-6114.03"/>
</g>
<!-- gate_1_3 -->
<g id="node82" class="node">
<title>gate_1_3</title>
<polygon fill="lightyellow" stroke="black" points="891.51,-6015.98 656.06,-6015.98 595.49,-5911.98 830.94,-5911.98 891.51,-6015.98"/>
<text text-anchor="middle" x="743.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_1_L3</text>
<text text-anchor="middle" x="743.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="743.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="743.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_3&#45;&gt;gate_1_3 -->
<g id="edge79" class="edge">
<title>attention_1_3&#45;&gt;gate_1_3</title>
<path fill="none" stroke="black" d="M742.73,-6051.85C742.79,-6044.16 742.87,-6035.35 742.95,-6026.35"/>
<polygon fill="black" stroke="black" points="746.45,-6026.19 743.04,-6016.16 739.45,-6026.13 746.45,-6026.19"/>
</g>
<!-- expert_1_3 -->
<g id="node83" class="node">
<title>expert_1_3</title>
<polygon fill="lightgreen" stroke="black" points="818,-5875.98 669,-5875.98 669,-5823.98 818,-5823.98 818,-5875.98"/>
<text text-anchor="middle" x="743.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_1_L3</text>
<text text-anchor="middle" x="743.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="743.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="743.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_3&#45;&gt;expert_1_3 -->
<g id="edge80" class="edge">
<title>gate_1_3&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M736.77,-5911.9C736.69,-5903.23 736.83,-5894.41 737.18,-5886.27"/>
<polygon fill="black" stroke="black" points="740.69,-5886.21 737.77,-5876.03 733.7,-5885.81 740.69,-5886.21"/>
</g>
<!-- gate_1_3&#45;&gt;expert_1_3 -->
<g id="edge1076" class="edge">
<title>gate_1_3&#45;&gt;expert_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M750.23,-5911.9C750.31,-5903.23 750.17,-5894.41 749.82,-5886.27"/>
<polygon fill="red" stroke="red" points="753.3,-5885.81 749.23,-5876.03 746.31,-5886.21 753.3,-5885.81"/>
</g>
<!-- aggregate_1_3 -->
<g id="node84" class="node">
<title>aggregate_1_3</title>
<polygon fill="lightyellow" stroke="black" points="891.51,-5787.98 656.06,-5787.98 595.49,-5683.98 830.94,-5683.98 891.51,-5787.98"/>
<text text-anchor="middle" x="743.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L3</text>
<text text-anchor="middle" x="743.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="743.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="743.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_3&#45;&gt;aggregate_1_3 -->
<g id="edge81" class="edge">
<title>expert_1_3&#45;&gt;aggregate_1_3</title>
<path fill="none" stroke="black" d="M743.5,-5823.85C743.5,-5816.16 743.5,-5807.35 743.5,-5798.35"/>
<polygon fill="black" stroke="black" points="747,-5798.16 743.5,-5788.16 740,-5798.16 747,-5798.16"/>
</g>
<!-- attention_1_4 -->
<g id="node85" class="node">
<title>attention_1_4</title>
<polygon fill="lightgreen" stroke="black" points="828.5,-5647.98 660.5,-5647.98 660.5,-5595.98 828.5,-5595.98 828.5,-5647.98"/>
<text text-anchor="middle" x="744.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_1_L4</text>
<text text-anchor="middle" x="744.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="744.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="744.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_3&#45;&gt;attention_1_4 -->
<g id="edge82" class="edge">
<title>aggregate_1_3&#45;&gt;attention_1_4</title>
<path fill="none" stroke="black" d="M743.96,-5683.9C744.03,-5675.23 744.11,-5666.41 744.19,-5658.27"/>
<polygon fill="black" stroke="black" points="747.69,-5658.06 744.28,-5648.03 740.69,-5657.99 747.69,-5658.06"/>
</g>
<!-- gate_1_4 -->
<g id="node86" class="node">
<title>gate_1_4</title>
<polygon fill="lightyellow" stroke="black" points="893.51,-5559.98 658.06,-5559.98 597.49,-5455.98 832.94,-5455.98 893.51,-5559.98"/>
<text text-anchor="middle" x="745.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_1_L4</text>
<text text-anchor="middle" x="745.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="745.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="745.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_4&#45;&gt;gate_1_4 -->
<g id="edge83" class="edge">
<title>attention_1_4&#45;&gt;gate_1_4</title>
<path fill="none" stroke="black" d="M744.73,-5595.85C744.79,-5588.16 744.87,-5579.35 744.95,-5570.35"/>
<polygon fill="black" stroke="black" points="748.45,-5570.19 745.04,-5560.16 741.45,-5570.13 748.45,-5570.19"/>
</g>
<!-- expert_1_4 -->
<g id="node87" class="node">
<title>expert_1_4</title>
<polygon fill="lightgreen" stroke="black" points="820,-5419.98 671,-5419.98 671,-5367.98 820,-5367.98 820,-5419.98"/>
<text text-anchor="middle" x="745.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_1_L4</text>
<text text-anchor="middle" x="745.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="745.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="745.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_4&#45;&gt;expert_1_4 -->
<g id="edge84" class="edge">
<title>gate_1_4&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M738.77,-5455.9C738.69,-5447.23 738.83,-5438.41 739.18,-5430.27"/>
<polygon fill="black" stroke="black" points="742.69,-5430.21 739.77,-5420.03 735.7,-5429.81 742.69,-5430.21"/>
</g>
<!-- gate_1_4&#45;&gt;expert_1_4 -->
<g id="edge1077" class="edge">
<title>gate_1_4&#45;&gt;expert_1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M752.23,-5455.9C752.31,-5447.23 752.17,-5438.41 751.82,-5430.27"/>
<polygon fill="red" stroke="red" points="755.3,-5429.81 751.23,-5420.03 748.31,-5430.21 755.3,-5429.81"/>
</g>
<!-- aggregate_1_4 -->
<g id="node88" class="node">
<title>aggregate_1_4</title>
<polygon fill="lightyellow" stroke="black" points="893.51,-5331.98 658.06,-5331.98 597.49,-5227.98 832.94,-5227.98 893.51,-5331.98"/>
<text text-anchor="middle" x="745.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L4</text>
<text text-anchor="middle" x="745.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="745.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="745.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_4&#45;&gt;aggregate_1_4 -->
<g id="edge85" class="edge">
<title>expert_1_4&#45;&gt;aggregate_1_4</title>
<path fill="none" stroke="black" d="M745.5,-5367.85C745.5,-5360.16 745.5,-5351.35 745.5,-5342.35"/>
<polygon fill="black" stroke="black" points="749,-5342.16 745.5,-5332.16 742,-5342.16 749,-5342.16"/>
</g>
<!-- attention_1_5 -->
<g id="node89" class="node">
<title>attention_1_5</title>
<polygon fill="lightgreen" stroke="black" points="830.5,-5191.98 662.5,-5191.98 662.5,-5139.98 830.5,-5139.98 830.5,-5191.98"/>
<text text-anchor="middle" x="746.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_1_L5</text>
<text text-anchor="middle" x="746.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="746.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="746.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_4&#45;&gt;attention_1_5 -->
<g id="edge86" class="edge">
<title>aggregate_1_4&#45;&gt;attention_1_5</title>
<path fill="none" stroke="black" d="M745.96,-5227.9C746.03,-5219.23 746.11,-5210.41 746.19,-5202.27"/>
<polygon fill="black" stroke="black" points="749.69,-5202.06 746.28,-5192.03 742.69,-5201.99 749.69,-5202.06"/>
</g>
<!-- gate_1_5 -->
<g id="node90" class="node">
<title>gate_1_5</title>
<polygon fill="lightyellow" stroke="black" points="896.51,-5103.98 661.06,-5103.98 600.49,-4999.98 835.94,-4999.98 896.51,-5103.98"/>
<text text-anchor="middle" x="748.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_1_L5</text>
<text text-anchor="middle" x="748.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="748.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="748.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_5&#45;&gt;gate_1_5 -->
<g id="edge87" class="edge">
<title>attention_1_5&#45;&gt;gate_1_5</title>
<path fill="none" stroke="black" d="M746.95,-5139.85C747.09,-5132.16 747.24,-5123.35 747.41,-5114.35"/>
<polygon fill="black" stroke="black" points="750.91,-5114.22 747.59,-5104.16 743.91,-5114.1 750.91,-5114.22"/>
</g>
<!-- expert_1_5 -->
<g id="node91" class="node">
<title>expert_1_5</title>
<polygon fill="lightgreen" stroke="black" points="823,-4963.98 674,-4963.98 674,-4911.98 823,-4911.98 823,-4963.98"/>
<text text-anchor="middle" x="748.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_1_L5</text>
<text text-anchor="middle" x="748.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="748.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="748.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_5&#45;&gt;expert_1_5 -->
<g id="edge88" class="edge">
<title>gate_1_5&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M741.77,-4999.9C741.69,-4991.23 741.83,-4982.41 742.18,-4974.27"/>
<polygon fill="black" stroke="black" points="745.69,-4974.21 742.77,-4964.03 738.7,-4973.81 745.69,-4974.21"/>
</g>
<!-- gate_1_5&#45;&gt;expert_1_5 -->
<g id="edge1078" class="edge">
<title>gate_1_5&#45;&gt;expert_1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M755.23,-4999.9C755.31,-4991.23 755.17,-4982.41 754.82,-4974.27"/>
<polygon fill="red" stroke="red" points="758.3,-4973.81 754.23,-4964.03 751.31,-4974.21 758.3,-4973.81"/>
</g>
<!-- aggregate_1_5 -->
<g id="node92" class="node">
<title>aggregate_1_5</title>
<polygon fill="lightyellow" stroke="black" points="896.51,-4875.98 661.06,-4875.98 600.49,-4771.98 835.94,-4771.98 896.51,-4875.98"/>
<text text-anchor="middle" x="748.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L5</text>
<text text-anchor="middle" x="748.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="748.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="748.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_5&#45;&gt;aggregate_1_5 -->
<g id="edge89" class="edge">
<title>expert_1_5&#45;&gt;aggregate_1_5</title>
<path fill="none" stroke="black" d="M748.5,-4911.85C748.5,-4904.16 748.5,-4895.35 748.5,-4886.35"/>
<polygon fill="black" stroke="black" points="752,-4886.16 748.5,-4876.16 745,-4886.16 752,-4886.16"/>
</g>
<!-- attention_1_6 -->
<g id="node93" class="node">
<title>attention_1_6</title>
<polygon fill="lightgreen" stroke="black" points="835.5,-4735.98 667.5,-4735.98 667.5,-4683.98 835.5,-4683.98 835.5,-4735.98"/>
<text text-anchor="middle" x="751.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_1_L6</text>
<text text-anchor="middle" x="751.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="751.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="751.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_5&#45;&gt;attention_1_6 -->
<g id="edge90" class="edge">
<title>aggregate_1_5&#45;&gt;attention_1_6</title>
<path fill="none" stroke="black" d="M749.87,-4771.9C750.1,-4763.23 750.34,-4754.41 750.56,-4746.27"/>
<polygon fill="black" stroke="black" points="754.06,-4746.12 750.83,-4736.03 747.06,-4745.93 754.06,-4746.12"/>
</g>
<!-- gate_1_6 -->
<g id="node94" class="node">
<title>gate_1_6</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-4647.98 667.06,-4647.98 606.49,-4543.98 841.94,-4543.98 902.51,-4647.98"/>
<text text-anchor="middle" x="754.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_1_L6</text>
<text text-anchor="middle" x="754.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_6&#45;&gt;gate_1_6 -->
<g id="edge91" class="edge">
<title>attention_1_6&#45;&gt;gate_1_6</title>
<path fill="none" stroke="black" d="M752.17,-4683.85C752.38,-4676.16 752.62,-4667.35 752.86,-4658.35"/>
<polygon fill="black" stroke="black" points="756.36,-4658.25 753.13,-4648.16 749.36,-4658.06 756.36,-4658.25"/>
</g>
<!-- expert_1_6 -->
<g id="node95" class="node">
<title>expert_1_6</title>
<polygon fill="lightgreen" stroke="black" points="829,-4507.98 680,-4507.98 680,-4455.98 829,-4455.98 829,-4507.98"/>
<text text-anchor="middle" x="754.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_1_L6</text>
<text text-anchor="middle" x="754.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_6&#45;&gt;expert_1_6 -->
<g id="edge92" class="edge">
<title>gate_1_6&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M747.77,-4543.9C747.69,-4535.23 747.83,-4526.41 748.18,-4518.27"/>
<polygon fill="black" stroke="black" points="751.69,-4518.21 748.77,-4508.03 744.7,-4517.81 751.69,-4518.21"/>
</g>
<!-- gate_1_6&#45;&gt;expert_1_6 -->
<g id="edge1079" class="edge">
<title>gate_1_6&#45;&gt;expert_1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-4543.9C761.31,-4535.23 761.17,-4526.41 760.82,-4518.27"/>
<polygon fill="red" stroke="red" points="764.3,-4517.81 760.23,-4508.03 757.31,-4518.21 764.3,-4517.81"/>
</g>
<!-- aggregate_1_6 -->
<g id="node96" class="node">
<title>aggregate_1_6</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-4419.98 667.06,-4419.98 606.49,-4315.98 841.94,-4315.98 902.51,-4419.98"/>
<text text-anchor="middle" x="754.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L6</text>
<text text-anchor="middle" x="754.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_6&#45;&gt;aggregate_1_6 -->
<g id="edge93" class="edge">
<title>expert_1_6&#45;&gt;aggregate_1_6</title>
<path fill="none" stroke="black" d="M754.5,-4455.85C754.5,-4448.16 754.5,-4439.35 754.5,-4430.35"/>
<polygon fill="black" stroke="black" points="758,-4430.16 754.5,-4420.16 751,-4430.16 758,-4430.16"/>
</g>
<!-- attention_1_7 -->
<g id="node97" class="node">
<title>attention_1_7</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-4279.98 670.5,-4279.98 670.5,-4227.98 838.5,-4227.98 838.5,-4279.98"/>
<text text-anchor="middle" x="754.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_1_L7</text>
<text text-anchor="middle" x="754.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_6&#45;&gt;attention_1_7 -->
<g id="edge94" class="edge">
<title>aggregate_1_6&#45;&gt;attention_1_7</title>
<path fill="none" stroke="black" d="M754.5,-4315.9C754.5,-4307.23 754.5,-4298.41 754.5,-4290.27"/>
<polygon fill="black" stroke="black" points="758,-4290.03 754.5,-4280.03 751,-4290.03 758,-4290.03"/>
</g>
<!-- gate_1_7 -->
<g id="node98" class="node">
<title>gate_1_7</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-4191.98 667.06,-4191.98 606.49,-4087.98 841.94,-4087.98 902.51,-4191.98"/>
<text text-anchor="middle" x="754.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_1_L7</text>
<text text-anchor="middle" x="754.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_7&#45;&gt;gate_1_7 -->
<g id="edge95" class="edge">
<title>attention_1_7&#45;&gt;gate_1_7</title>
<path fill="none" stroke="black" d="M754.5,-4227.85C754.5,-4220.16 754.5,-4211.35 754.5,-4202.35"/>
<polygon fill="black" stroke="black" points="758,-4202.16 754.5,-4192.16 751,-4202.16 758,-4202.16"/>
</g>
<!-- expert_1_7 -->
<g id="node99" class="node">
<title>expert_1_7</title>
<polygon fill="lightgreen" stroke="black" points="829,-4051.98 680,-4051.98 680,-3999.98 829,-3999.98 829,-4051.98"/>
<text text-anchor="middle" x="754.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_1_L7</text>
<text text-anchor="middle" x="754.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_7&#45;&gt;expert_1_7 -->
<g id="edge96" class="edge">
<title>gate_1_7&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M747.77,-4087.9C747.69,-4079.23 747.83,-4070.41 748.18,-4062.27"/>
<polygon fill="black" stroke="black" points="751.69,-4062.21 748.77,-4052.03 744.7,-4061.81 751.69,-4062.21"/>
</g>
<!-- gate_1_7&#45;&gt;expert_1_7 -->
<g id="edge1080" class="edge">
<title>gate_1_7&#45;&gt;expert_1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-4087.9C761.31,-4079.23 761.17,-4070.41 760.82,-4062.27"/>
<polygon fill="red" stroke="red" points="764.3,-4061.81 760.23,-4052.03 757.31,-4062.21 764.3,-4061.81"/>
</g>
<!-- aggregate_1_7 -->
<g id="node100" class="node">
<title>aggregate_1_7</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-3963.98 667.06,-3963.98 606.49,-3859.98 841.94,-3859.98 902.51,-3963.98"/>
<text text-anchor="middle" x="754.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L7</text>
<text text-anchor="middle" x="754.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_7&#45;&gt;aggregate_1_7 -->
<g id="edge97" class="edge">
<title>expert_1_7&#45;&gt;aggregate_1_7</title>
<path fill="none" stroke="black" d="M754.5,-3999.85C754.5,-3992.16 754.5,-3983.35 754.5,-3974.35"/>
<polygon fill="black" stroke="black" points="758,-3974.16 754.5,-3964.16 751,-3974.16 758,-3974.16"/>
</g>
<!-- attention_1_8 -->
<g id="node101" class="node">
<title>attention_1_8</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-3823.98 670.5,-3823.98 670.5,-3771.98 838.5,-3771.98 838.5,-3823.98"/>
<text text-anchor="middle" x="754.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_1_L8</text>
<text text-anchor="middle" x="754.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_7&#45;&gt;attention_1_8 -->
<g id="edge98" class="edge">
<title>aggregate_1_7&#45;&gt;attention_1_8</title>
<path fill="none" stroke="black" d="M754.5,-3859.9C754.5,-3851.23 754.5,-3842.41 754.5,-3834.27"/>
<polygon fill="black" stroke="black" points="758,-3834.03 754.5,-3824.03 751,-3834.03 758,-3834.03"/>
</g>
<!-- gate_1_8 -->
<g id="node102" class="node">
<title>gate_1_8</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-3735.98 667.06,-3735.98 606.49,-3631.98 841.94,-3631.98 902.51,-3735.98"/>
<text text-anchor="middle" x="754.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_1_L8</text>
<text text-anchor="middle" x="754.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_8&#45;&gt;gate_1_8 -->
<g id="edge99" class="edge">
<title>attention_1_8&#45;&gt;gate_1_8</title>
<path fill="none" stroke="black" d="M754.5,-3771.85C754.5,-3764.16 754.5,-3755.35 754.5,-3746.35"/>
<polygon fill="black" stroke="black" points="758,-3746.16 754.5,-3736.16 751,-3746.16 758,-3746.16"/>
</g>
<!-- expert_1_8 -->
<g id="node103" class="node">
<title>expert_1_8</title>
<polygon fill="lightgreen" stroke="black" points="829,-3595.98 680,-3595.98 680,-3543.98 829,-3543.98 829,-3595.98"/>
<text text-anchor="middle" x="754.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_1_L8</text>
<text text-anchor="middle" x="754.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_8&#45;&gt;expert_1_8 -->
<g id="edge100" class="edge">
<title>gate_1_8&#45;&gt;expert_1_8</title>
<path fill="none" stroke="black" d="M747.77,-3631.9C747.69,-3623.23 747.83,-3614.41 748.18,-3606.27"/>
<polygon fill="black" stroke="black" points="751.69,-3606.21 748.77,-3596.03 744.7,-3605.81 751.69,-3606.21"/>
</g>
<!-- gate_1_8&#45;&gt;expert_1_8 -->
<g id="edge1081" class="edge">
<title>gate_1_8&#45;&gt;expert_1_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-3631.9C761.31,-3623.23 761.17,-3614.41 760.82,-3606.27"/>
<polygon fill="red" stroke="red" points="764.3,-3605.81 760.23,-3596.03 757.31,-3606.21 764.3,-3605.81"/>
</g>
<!-- aggregate_1_8 -->
<g id="node104" class="node">
<title>aggregate_1_8</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-3507.98 667.06,-3507.98 606.49,-3403.98 841.94,-3403.98 902.51,-3507.98"/>
<text text-anchor="middle" x="754.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L8</text>
<text text-anchor="middle" x="754.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_8&#45;&gt;aggregate_1_8 -->
<g id="edge101" class="edge">
<title>expert_1_8&#45;&gt;aggregate_1_8</title>
<path fill="none" stroke="black" d="M754.5,-3543.85C754.5,-3536.16 754.5,-3527.35 754.5,-3518.35"/>
<polygon fill="black" stroke="black" points="758,-3518.16 754.5,-3508.16 751,-3518.16 758,-3518.16"/>
</g>
<!-- attention_1_9 -->
<g id="node105" class="node">
<title>attention_1_9</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-3367.98 670.5,-3367.98 670.5,-3315.98 838.5,-3315.98 838.5,-3367.98"/>
<text text-anchor="middle" x="754.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_1_L9</text>
<text text-anchor="middle" x="754.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_8&#45;&gt;attention_1_9 -->
<g id="edge102" class="edge">
<title>aggregate_1_8&#45;&gt;attention_1_9</title>
<path fill="none" stroke="black" d="M754.5,-3403.9C754.5,-3395.23 754.5,-3386.41 754.5,-3378.27"/>
<polygon fill="black" stroke="black" points="758,-3378.03 754.5,-3368.03 751,-3378.03 758,-3378.03"/>
</g>
<!-- gate_1_9 -->
<g id="node106" class="node">
<title>gate_1_9</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-3279.98 667.06,-3279.98 606.49,-3175.98 841.94,-3175.98 902.51,-3279.98"/>
<text text-anchor="middle" x="754.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_1_L9</text>
<text text-anchor="middle" x="754.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_9&#45;&gt;gate_1_9 -->
<g id="edge103" class="edge">
<title>attention_1_9&#45;&gt;gate_1_9</title>
<path fill="none" stroke="black" d="M754.5,-3315.85C754.5,-3308.16 754.5,-3299.35 754.5,-3290.35"/>
<polygon fill="black" stroke="black" points="758,-3290.16 754.5,-3280.16 751,-3290.16 758,-3290.16"/>
</g>
<!-- expert_1_9 -->
<g id="node107" class="node">
<title>expert_1_9</title>
<polygon fill="lightgreen" stroke="black" points="829,-3139.98 680,-3139.98 680,-3087.98 829,-3087.98 829,-3139.98"/>
<text text-anchor="middle" x="754.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_1_L9</text>
<text text-anchor="middle" x="754.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_9&#45;&gt;expert_1_9 -->
<g id="edge104" class="edge">
<title>gate_1_9&#45;&gt;expert_1_9</title>
<path fill="none" stroke="black" d="M747.77,-3175.9C747.69,-3167.23 747.83,-3158.41 748.18,-3150.27"/>
<polygon fill="black" stroke="black" points="751.69,-3150.21 748.77,-3140.03 744.7,-3149.81 751.69,-3150.21"/>
</g>
<!-- gate_1_9&#45;&gt;expert_1_9 -->
<g id="edge1082" class="edge">
<title>gate_1_9&#45;&gt;expert_1_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-3175.9C761.31,-3167.23 761.17,-3158.41 760.82,-3150.27"/>
<polygon fill="red" stroke="red" points="764.3,-3149.81 760.23,-3140.03 757.31,-3150.21 764.3,-3149.81"/>
</g>
<!-- aggregate_1_9 -->
<g id="node108" class="node">
<title>aggregate_1_9</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-3051.98 667.06,-3051.98 606.49,-2947.98 841.94,-2947.98 902.51,-3051.98"/>
<text text-anchor="middle" x="754.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L9</text>
<text text-anchor="middle" x="754.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_9&#45;&gt;aggregate_1_9 -->
<g id="edge105" class="edge">
<title>expert_1_9&#45;&gt;aggregate_1_9</title>
<path fill="none" stroke="black" d="M754.5,-3087.85C754.5,-3080.16 754.5,-3071.35 754.5,-3062.35"/>
<polygon fill="black" stroke="black" points="758,-3062.16 754.5,-3052.16 751,-3062.16 758,-3062.16"/>
</g>
<!-- attention_1_10 -->
<g id="node109" class="node">
<title>attention_1_10</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-2911.98 670.5,-2911.98 670.5,-2859.98 838.5,-2859.98 838.5,-2911.98"/>
<text text-anchor="middle" x="754.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_1_L10</text>
<text text-anchor="middle" x="754.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_9&#45;&gt;attention_1_10 -->
<g id="edge106" class="edge">
<title>aggregate_1_9&#45;&gt;attention_1_10</title>
<path fill="none" stroke="black" d="M754.5,-2947.9C754.5,-2939.23 754.5,-2930.41 754.5,-2922.27"/>
<polygon fill="black" stroke="black" points="758,-2922.03 754.5,-2912.03 751,-2922.03 758,-2922.03"/>
</g>
<!-- gate_1_10 -->
<g id="node110" class="node">
<title>gate_1_10</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-2823.98 667.06,-2823.98 606.49,-2719.98 841.94,-2719.98 902.51,-2823.98"/>
<text text-anchor="middle" x="754.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_1_L10</text>
<text text-anchor="middle" x="754.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_10&#45;&gt;gate_1_10 -->
<g id="edge107" class="edge">
<title>attention_1_10&#45;&gt;gate_1_10</title>
<path fill="none" stroke="black" d="M754.5,-2859.85C754.5,-2852.16 754.5,-2843.35 754.5,-2834.35"/>
<polygon fill="black" stroke="black" points="758,-2834.16 754.5,-2824.16 751,-2834.16 758,-2834.16"/>
</g>
<!-- expert_1_10 -->
<g id="node111" class="node">
<title>expert_1_10</title>
<polygon fill="lightgreen" stroke="black" points="829,-2683.98 680,-2683.98 680,-2631.98 829,-2631.98 829,-2683.98"/>
<text text-anchor="middle" x="754.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_1_L10</text>
<text text-anchor="middle" x="754.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_10&#45;&gt;expert_1_10 -->
<g id="edge108" class="edge">
<title>gate_1_10&#45;&gt;expert_1_10</title>
<path fill="none" stroke="black" d="M747.77,-2719.9C747.69,-2711.23 747.83,-2702.41 748.18,-2694.27"/>
<polygon fill="black" stroke="black" points="751.69,-2694.21 748.77,-2684.03 744.7,-2693.81 751.69,-2694.21"/>
</g>
<!-- gate_1_10&#45;&gt;expert_1_10 -->
<g id="edge1083" class="edge">
<title>gate_1_10&#45;&gt;expert_1_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-2719.9C761.31,-2711.23 761.17,-2702.41 760.82,-2694.27"/>
<polygon fill="red" stroke="red" points="764.3,-2693.81 760.23,-2684.03 757.31,-2694.21 764.3,-2693.81"/>
</g>
<!-- aggregate_1_10 -->
<g id="node112" class="node">
<title>aggregate_1_10</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-2595.98 667.06,-2595.98 606.49,-2491.98 841.94,-2491.98 902.51,-2595.98"/>
<text text-anchor="middle" x="754.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L10</text>
<text text-anchor="middle" x="754.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_10&#45;&gt;aggregate_1_10 -->
<g id="edge109" class="edge">
<title>expert_1_10&#45;&gt;aggregate_1_10</title>
<path fill="none" stroke="black" d="M754.5,-2631.85C754.5,-2624.16 754.5,-2615.35 754.5,-2606.35"/>
<polygon fill="black" stroke="black" points="758,-2606.16 754.5,-2596.16 751,-2606.16 758,-2606.16"/>
</g>
<!-- attention_1_11 -->
<g id="node113" class="node">
<title>attention_1_11</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-2455.98 670.5,-2455.98 670.5,-2403.98 838.5,-2403.98 838.5,-2455.98"/>
<text text-anchor="middle" x="754.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_1_L11</text>
<text text-anchor="middle" x="754.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_10&#45;&gt;attention_1_11 -->
<g id="edge110" class="edge">
<title>aggregate_1_10&#45;&gt;attention_1_11</title>
<path fill="none" stroke="black" d="M754.5,-2491.9C754.5,-2483.23 754.5,-2474.41 754.5,-2466.27"/>
<polygon fill="black" stroke="black" points="758,-2466.03 754.5,-2456.03 751,-2466.03 758,-2466.03"/>
</g>
<!-- gate_1_11 -->
<g id="node114" class="node">
<title>gate_1_11</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-2367.98 667.06,-2367.98 606.49,-2263.98 841.94,-2263.98 902.51,-2367.98"/>
<text text-anchor="middle" x="754.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_1_L11</text>
<text text-anchor="middle" x="754.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_11&#45;&gt;gate_1_11 -->
<g id="edge111" class="edge">
<title>attention_1_11&#45;&gt;gate_1_11</title>
<path fill="none" stroke="black" d="M754.5,-2403.85C754.5,-2396.16 754.5,-2387.35 754.5,-2378.35"/>
<polygon fill="black" stroke="black" points="758,-2378.16 754.5,-2368.16 751,-2378.16 758,-2378.16"/>
</g>
<!-- expert_1_11 -->
<g id="node115" class="node">
<title>expert_1_11</title>
<polygon fill="lightgreen" stroke="black" points="829,-2227.98 680,-2227.98 680,-2175.98 829,-2175.98 829,-2227.98"/>
<text text-anchor="middle" x="754.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_1_L11</text>
<text text-anchor="middle" x="754.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_11&#45;&gt;expert_1_11 -->
<g id="edge112" class="edge">
<title>gate_1_11&#45;&gt;expert_1_11</title>
<path fill="none" stroke="black" d="M747.77,-2263.9C747.69,-2255.23 747.83,-2246.41 748.18,-2238.27"/>
<polygon fill="black" stroke="black" points="751.69,-2238.21 748.77,-2228.03 744.7,-2237.81 751.69,-2238.21"/>
</g>
<!-- gate_1_11&#45;&gt;expert_1_11 -->
<g id="edge1084" class="edge">
<title>gate_1_11&#45;&gt;expert_1_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-2263.9C761.31,-2255.23 761.17,-2246.41 760.82,-2238.27"/>
<polygon fill="red" stroke="red" points="764.3,-2237.81 760.23,-2228.03 757.31,-2238.21 764.3,-2237.81"/>
</g>
<!-- aggregate_1_11 -->
<g id="node116" class="node">
<title>aggregate_1_11</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-2139.98 667.06,-2139.98 606.49,-2035.98 841.94,-2035.98 902.51,-2139.98"/>
<text text-anchor="middle" x="754.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L11</text>
<text text-anchor="middle" x="754.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_11&#45;&gt;aggregate_1_11 -->
<g id="edge113" class="edge">
<title>expert_1_11&#45;&gt;aggregate_1_11</title>
<path fill="none" stroke="black" d="M754.5,-2175.85C754.5,-2168.16 754.5,-2159.35 754.5,-2150.35"/>
<polygon fill="black" stroke="black" points="758,-2150.16 754.5,-2140.16 751,-2150.16 758,-2150.16"/>
</g>
<!-- attention_1_12 -->
<g id="node117" class="node">
<title>attention_1_12</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-1999.98 670.5,-1999.98 670.5,-1947.98 838.5,-1947.98 838.5,-1999.98"/>
<text text-anchor="middle" x="754.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_1_L12</text>
<text text-anchor="middle" x="754.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_11&#45;&gt;attention_1_12 -->
<g id="edge114" class="edge">
<title>aggregate_1_11&#45;&gt;attention_1_12</title>
<path fill="none" stroke="black" d="M754.5,-2035.9C754.5,-2027.23 754.5,-2018.41 754.5,-2010.27"/>
<polygon fill="black" stroke="black" points="758,-2010.03 754.5,-2000.03 751,-2010.03 758,-2010.03"/>
</g>
<!-- gate_1_12 -->
<g id="node118" class="node">
<title>gate_1_12</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-1911.98 667.06,-1911.98 606.49,-1807.98 841.94,-1807.98 902.51,-1911.98"/>
<text text-anchor="middle" x="754.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_1_L12</text>
<text text-anchor="middle" x="754.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_12&#45;&gt;gate_1_12 -->
<g id="edge115" class="edge">
<title>attention_1_12&#45;&gt;gate_1_12</title>
<path fill="none" stroke="black" d="M754.5,-1947.85C754.5,-1940.16 754.5,-1931.35 754.5,-1922.35"/>
<polygon fill="black" stroke="black" points="758,-1922.16 754.5,-1912.16 751,-1922.16 758,-1922.16"/>
</g>
<!-- expert_1_12 -->
<g id="node119" class="node">
<title>expert_1_12</title>
<polygon fill="lightgreen" stroke="black" points="829,-1771.98 680,-1771.98 680,-1719.98 829,-1719.98 829,-1771.98"/>
<text text-anchor="middle" x="754.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_1_L12</text>
<text text-anchor="middle" x="754.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_12&#45;&gt;expert_1_12 -->
<g id="edge116" class="edge">
<title>gate_1_12&#45;&gt;expert_1_12</title>
<path fill="none" stroke="black" d="M747.77,-1807.9C747.69,-1799.23 747.83,-1790.41 748.18,-1782.27"/>
<polygon fill="black" stroke="black" points="751.69,-1782.21 748.77,-1772.03 744.7,-1781.81 751.69,-1782.21"/>
</g>
<!-- gate_1_12&#45;&gt;expert_1_12 -->
<g id="edge1085" class="edge">
<title>gate_1_12&#45;&gt;expert_1_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-1807.9C761.31,-1799.23 761.17,-1790.41 760.82,-1782.27"/>
<polygon fill="red" stroke="red" points="764.3,-1781.81 760.23,-1772.03 757.31,-1782.21 764.3,-1781.81"/>
</g>
<!-- aggregate_1_12 -->
<g id="node120" class="node">
<title>aggregate_1_12</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-1683.98 667.06,-1683.98 606.49,-1579.98 841.94,-1579.98 902.51,-1683.98"/>
<text text-anchor="middle" x="754.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L12</text>
<text text-anchor="middle" x="754.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_12&#45;&gt;aggregate_1_12 -->
<g id="edge117" class="edge">
<title>expert_1_12&#45;&gt;aggregate_1_12</title>
<path fill="none" stroke="black" d="M754.5,-1719.85C754.5,-1712.16 754.5,-1703.35 754.5,-1694.35"/>
<polygon fill="black" stroke="black" points="758,-1694.16 754.5,-1684.16 751,-1694.16 758,-1694.16"/>
</g>
<!-- attention_1_13 -->
<g id="node121" class="node">
<title>attention_1_13</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-1543.98 670.5,-1543.98 670.5,-1491.98 838.5,-1491.98 838.5,-1543.98"/>
<text text-anchor="middle" x="754.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_1_L13</text>
<text text-anchor="middle" x="754.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_12&#45;&gt;attention_1_13 -->
<g id="edge118" class="edge">
<title>aggregate_1_12&#45;&gt;attention_1_13</title>
<path fill="none" stroke="black" d="M754.5,-1579.9C754.5,-1571.23 754.5,-1562.41 754.5,-1554.27"/>
<polygon fill="black" stroke="black" points="758,-1554.03 754.5,-1544.03 751,-1554.03 758,-1554.03"/>
</g>
<!-- gate_1_13 -->
<g id="node122" class="node">
<title>gate_1_13</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-1455.98 667.06,-1455.98 606.49,-1351.98 841.94,-1351.98 902.51,-1455.98"/>
<text text-anchor="middle" x="754.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_1_L13</text>
<text text-anchor="middle" x="754.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="754.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_13&#45;&gt;gate_1_13 -->
<g id="edge119" class="edge">
<title>attention_1_13&#45;&gt;gate_1_13</title>
<path fill="none" stroke="black" d="M754.5,-1491.85C754.5,-1484.16 754.5,-1475.35 754.5,-1466.35"/>
<polygon fill="black" stroke="black" points="758,-1466.16 754.5,-1456.16 751,-1466.16 758,-1466.16"/>
</g>
<!-- expert_1_13 -->
<g id="node123" class="node">
<title>expert_1_13</title>
<polygon fill="lightgreen" stroke="black" points="829,-1315.98 680,-1315.98 680,-1263.98 829,-1263.98 829,-1315.98"/>
<text text-anchor="middle" x="754.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_1_L13</text>
<text text-anchor="middle" x="754.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="754.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="754.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_13&#45;&gt;expert_1_13 -->
<g id="edge120" class="edge">
<title>gate_1_13&#45;&gt;expert_1_13</title>
<path fill="none" stroke="black" d="M747.77,-1351.9C747.69,-1343.23 747.83,-1334.41 748.18,-1326.27"/>
<polygon fill="black" stroke="black" points="751.69,-1326.21 748.77,-1316.03 744.7,-1325.81 751.69,-1326.21"/>
</g>
<!-- gate_1_13&#45;&gt;expert_1_13 -->
<g id="edge1086" class="edge">
<title>gate_1_13&#45;&gt;expert_1_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M761.23,-1351.9C761.31,-1343.23 761.17,-1334.41 760.82,-1326.27"/>
<polygon fill="red" stroke="red" points="764.3,-1325.81 760.23,-1316.03 757.31,-1326.21 764.3,-1325.81"/>
</g>
<!-- aggregate_1_13 -->
<g id="node124" class="node">
<title>aggregate_1_13</title>
<polygon fill="lightyellow" stroke="black" points="902.51,-1227.98 667.06,-1227.98 606.49,-1123.98 841.94,-1123.98 902.51,-1227.98"/>
<text text-anchor="middle" x="754.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L13</text>
<text text-anchor="middle" x="754.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="754.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="754.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_13&#45;&gt;aggregate_1_13 -->
<g id="edge121" class="edge">
<title>expert_1_13&#45;&gt;aggregate_1_13</title>
<path fill="none" stroke="black" d="M754.5,-1263.85C754.5,-1256.16 754.5,-1247.35 754.5,-1238.35"/>
<polygon fill="black" stroke="black" points="758,-1238.16 754.5,-1228.16 751,-1238.16 758,-1238.16"/>
</g>
<!-- attention_1_14 -->
<g id="node125" class="node">
<title>attention_1_14</title>
<polygon fill="lightgreen" stroke="black" points="838.5,-1087.98 670.5,-1087.98 670.5,-1035.98 838.5,-1035.98 838.5,-1087.98"/>
<text text-anchor="middle" x="754.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_1_L14</text>
<text text-anchor="middle" x="754.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="754.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="754.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_13&#45;&gt;attention_1_14 -->
<g id="edge122" class="edge">
<title>aggregate_1_13&#45;&gt;attention_1_14</title>
<path fill="none" stroke="black" d="M754.5,-1123.9C754.5,-1115.23 754.5,-1106.41 754.5,-1098.27"/>
<polygon fill="black" stroke="black" points="758,-1098.03 754.5,-1088.03 751,-1098.03 758,-1098.03"/>
</g>
<!-- gate_1_14 -->
<g id="node126" class="node">
<title>gate_1_14</title>
<polygon fill="lightyellow" stroke="black" points="903.51,-999.98 668.06,-999.98 607.49,-895.98 842.94,-895.98 903.51,-999.98"/>
<text text-anchor="middle" x="755.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_1_L14</text>
<text text-anchor="middle" x="755.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="755.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="755.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_14&#45;&gt;gate_1_14 -->
<g id="edge123" class="edge">
<title>attention_1_14&#45;&gt;gate_1_14</title>
<path fill="none" stroke="black" d="M754.73,-1035.85C754.79,-1028.16 754.87,-1019.35 754.95,-1010.35"/>
<polygon fill="black" stroke="black" points="758.45,-1010.19 755.04,-1000.16 751.45,-1010.13 758.45,-1010.19"/>
</g>
<!-- expert_1_14 -->
<g id="node127" class="node">
<title>expert_1_14</title>
<polygon fill="lightgreen" stroke="black" points="830,-859.98 681,-859.98 681,-807.98 830,-807.98 830,-859.98"/>
<text text-anchor="middle" x="755.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_1_L14</text>
<text text-anchor="middle" x="755.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="755.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="755.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_14&#45;&gt;expert_1_14 -->
<g id="edge124" class="edge">
<title>gate_1_14&#45;&gt;expert_1_14</title>
<path fill="none" stroke="black" d="M748.77,-895.9C748.69,-887.23 748.83,-878.41 749.18,-870.27"/>
<polygon fill="black" stroke="black" points="752.69,-870.21 749.77,-860.03 745.7,-869.81 752.69,-870.21"/>
</g>
<!-- gate_1_14&#45;&gt;expert_1_14 -->
<g id="edge1087" class="edge">
<title>gate_1_14&#45;&gt;expert_1_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M762.23,-895.9C762.31,-887.23 762.17,-878.41 761.82,-870.27"/>
<polygon fill="red" stroke="red" points="765.3,-869.81 761.23,-860.03 758.31,-870.21 765.3,-869.81"/>
</g>
<!-- aggregate_1_14 -->
<g id="node128" class="node">
<title>aggregate_1_14</title>
<polygon fill="lightyellow" stroke="black" points="903.51,-771.98 668.06,-771.98 607.49,-667.98 842.94,-667.98 903.51,-771.98"/>
<text text-anchor="middle" x="755.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L14</text>
<text text-anchor="middle" x="755.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="755.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="755.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_14&#45;&gt;aggregate_1_14 -->
<g id="edge125" class="edge">
<title>expert_1_14&#45;&gt;aggregate_1_14</title>
<path fill="none" stroke="black" d="M755.5,-807.85C755.5,-800.16 755.5,-791.35 755.5,-782.35"/>
<polygon fill="black" stroke="black" points="759,-782.16 755.5,-772.16 752,-782.16 759,-782.16"/>
</g>
<!-- attention_1_15 -->
<g id="node129" class="node">
<title>attention_1_15</title>
<polygon fill="lightgreen" stroke="black" points="841.5,-631.98 673.5,-631.98 673.5,-579.98 841.5,-579.98 841.5,-631.98"/>
<text text-anchor="middle" x="757.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_1_L15</text>
<text text-anchor="middle" x="757.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="757.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="757.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_1_14&#45;&gt;attention_1_15 -->
<g id="edge126" class="edge">
<title>aggregate_1_14&#45;&gt;attention_1_15</title>
<path fill="none" stroke="black" d="M756.41,-667.9C756.57,-659.23 756.73,-650.41 756.87,-642.27"/>
<polygon fill="black" stroke="black" points="760.37,-642.09 757.05,-632.03 753.38,-641.96 760.37,-642.09"/>
</g>
<!-- gate_1_15 -->
<g id="node130" class="node">
<title>gate_1_15</title>
<polygon fill="lightyellow" stroke="black" points="910.51,-543.98 675.06,-543.98 614.49,-439.98 849.94,-439.98 910.51,-543.98"/>
<text text-anchor="middle" x="762.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_1_L15</text>
<text text-anchor="middle" x="762.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="762.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="762.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_1_15&#45;&gt;gate_1_15 -->
<g id="edge127" class="edge">
<title>attention_1_15&#45;&gt;gate_1_15</title>
<path fill="none" stroke="black" d="M758.62,-579.85C758.97,-572.16 759.36,-563.35 759.76,-554.35"/>
<polygon fill="black" stroke="black" points="763.27,-554.31 760.22,-544.16 756.27,-553.99 763.27,-554.31"/>
</g>
<!-- expert_1_15 -->
<g id="node131" class="node">
<title>expert_1_15</title>
<polygon fill="lightgreen" stroke="black" points="838,-403.98 689,-403.98 689,-351.98 838,-351.98 838,-403.98"/>
<text text-anchor="middle" x="763.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_1_L15</text>
<text text-anchor="middle" x="763.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=1</text>
<text text-anchor="middle" x="763.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="763.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_1_15&#45;&gt;expert_1_15 -->
<g id="edge128" class="edge">
<title>gate_1_15&#45;&gt;expert_1_15</title>
<path fill="none" stroke="black" d="M756.23,-439.9C756.23,-431.23 756.44,-422.41 756.86,-414.27"/>
<polygon fill="black" stroke="black" points="760.37,-414.24 757.54,-404.03 753.39,-413.77 760.37,-414.24"/>
</g>
<!-- gate_1_15&#45;&gt;expert_1_15 -->
<g id="edge1088" class="edge">
<title>gate_1_15&#45;&gt;expert_1_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M769.68,-439.9C769.84,-431.23 769.79,-422.41 769.51,-414.27"/>
<polygon fill="red" stroke="red" points="772.99,-413.85 769.01,-404.03 766,-414.18 772.99,-413.85"/>
</g>
<!-- aggregate_1_15 -->
<g id="node132" class="node">
<title>aggregate_1_15</title>
<polygon fill="lightyellow" stroke="black" points="914.51,-315.98 679.06,-315.98 618.49,-211.98 853.94,-211.98 914.51,-315.98"/>
<text text-anchor="middle" x="766.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_1_L15</text>
<text text-anchor="middle" x="766.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="766.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="766.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_1_15&#45;&gt;aggregate_1_15 -->
<g id="edge129" class="edge">
<title>expert_1_15&#45;&gt;aggregate_1_15</title>
<path fill="none" stroke="black" d="M764.17,-351.85C764.38,-344.16 764.62,-335.35 764.86,-326.35"/>
<polygon fill="black" stroke="black" points="768.36,-326.25 765.13,-316.16 761.36,-326.06 768.36,-326.25"/>
</g>
<!-- collect_1 -->
<g id="node133" class="node">
<title>collect_1</title>
<polygon fill="lightyellow" stroke="black" points="914.51,-175.98 679.06,-175.98 618.49,-93.98 853.94,-93.98 914.51,-175.98"/>
<text text-anchor="middle" x="766.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_1</text>
<text text-anchor="middle" x="766.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="766.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_1_15&#45;&gt;collect_1 -->
<g id="edge130" class="edge">
<title>aggregate_1_15&#45;&gt;collect_1</title>
<path fill="none" stroke="black" d="M766.5,-211.69C766.5,-203.27 766.5,-194.56 766.5,-186.17"/>
<polygon fill="black" stroke="black" points="770,-186.14 766.5,-176.14 763,-186.14 770,-186.14"/>
</g>
<!-- collect_1&#45;&gt;output -->
<g id="edge1042" class="edge">
<title>collect_1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M863.2,-106.03C883.3,-101.2 904.47,-96.82 924.5,-93.98 1265.08,-45.67 2314.84,-33.57 2683.71,-30.77"/>
<polygon fill="black" stroke="black" points="2683.92,-34.27 2693.89,-30.7 2683.86,-27.27 2683.92,-34.27"/>
</g>
<!-- distribute_2 -->
<g id="node134" class="node">
<title>distribute_2</title>
<polygon fill="lightyellow" stroke="black" points="1201.73,-7589.98 961.16,-7589.98 899.27,-7507.98 1139.85,-7507.98 1201.73,-7589.98"/>
<text text-anchor="middle" x="1050.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_2</text>
<text text-anchor="middle" x="1050.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="1050.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_0 -->
<g id="node135" class="node">
<title>attention_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1136.5,-7471.98 968.5,-7471.98 968.5,-7419.98 1136.5,-7419.98 1136.5,-7471.98"/>
<text text-anchor="middle" x="1052.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_2_L0</text>
<text text-anchor="middle" x="1052.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1052.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1052.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_2&#45;&gt;attention_2_0 -->
<g id="edge131" class="edge">
<title>distribute_2&#45;&gt;attention_2_0</title>
<path fill="none" stroke="black" d="M1051.3,-7507.77C1051.46,-7499.34 1051.64,-7490.51 1051.8,-7482.27"/>
<polygon fill="black" stroke="black" points="1055.3,-7482.3 1052,-7472.23 1048.3,-7482.16 1055.3,-7482.3"/>
</g>
<!-- gate_2_0 -->
<g id="node136" class="node">
<title>gate_2_0</title>
<polygon fill="lightyellow" stroke="black" points="1202.51,-7383.98 967.06,-7383.98 906.49,-7279.98 1141.94,-7279.98 1202.51,-7383.98"/>
<text text-anchor="middle" x="1054.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_2_L0</text>
<text text-anchor="middle" x="1054.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1054.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1054.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_0&#45;&gt;gate_2_0 -->
<g id="edge132" class="edge">
<title>attention_2_0&#45;&gt;gate_2_0</title>
<path fill="none" stroke="black" d="M1052.95,-7419.85C1053.09,-7412.16 1053.24,-7403.35 1053.41,-7394.35"/>
<polygon fill="black" stroke="black" points="1056.91,-7394.22 1053.59,-7384.16 1049.91,-7394.1 1056.91,-7394.22"/>
</g>
<!-- expert_2_0 -->
<g id="node137" class="node">
<title>expert_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1130,-7243.98 981,-7243.98 981,-7191.98 1130,-7191.98 1130,-7243.98"/>
<text text-anchor="middle" x="1055.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_2_L0</text>
<text text-anchor="middle" x="1055.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1055.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1055.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_0&#45;&gt;expert_2_0 -->
<g id="edge133" class="edge">
<title>gate_2_0&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M1048.23,-7279.9C1048.23,-7271.23 1048.44,-7262.41 1048.86,-7254.27"/>
<polygon fill="black" stroke="black" points="1052.37,-7254.24 1049.54,-7244.03 1045.39,-7253.77 1052.37,-7254.24"/>
</g>
<!-- gate_2_0&#45;&gt;expert_2_0 -->
<g id="edge1089" class="edge">
<title>gate_2_0&#45;&gt;expert_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1061.68,-7279.9C1061.84,-7271.23 1061.79,-7262.41 1061.51,-7254.27"/>
<polygon fill="red" stroke="red" points="1064.99,-7253.85 1061.01,-7244.03 1058,-7254.18 1064.99,-7253.85"/>
</g>
<!-- aggregate_2_0 -->
<g id="node138" class="node">
<title>aggregate_2_0</title>
<polygon fill="lightyellow" stroke="black" points="1204.51,-7155.98 969.06,-7155.98 908.49,-7051.98 1143.94,-7051.98 1204.51,-7155.98"/>
<text text-anchor="middle" x="1056.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L0</text>
<text text-anchor="middle" x="1056.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1056.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1056.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_0&#45;&gt;aggregate_2_0 -->
<g id="edge134" class="edge">
<title>expert_2_0&#45;&gt;aggregate_2_0</title>
<path fill="none" stroke="black" d="M1055.73,-7191.85C1055.79,-7184.16 1055.87,-7175.35 1055.95,-7166.35"/>
<polygon fill="black" stroke="black" points="1059.45,-7166.19 1056.04,-7156.16 1052.45,-7166.13 1059.45,-7166.19"/>
</g>
<!-- attention_2_1 -->
<g id="node139" class="node">
<title>attention_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1141.5,-7015.98 973.5,-7015.98 973.5,-6963.98 1141.5,-6963.98 1141.5,-7015.98"/>
<text text-anchor="middle" x="1057.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_2_L1</text>
<text text-anchor="middle" x="1057.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1057.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1057.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_0&#45;&gt;attention_2_1 -->
<g id="edge135" class="edge">
<title>aggregate_2_0&#45;&gt;attention_2_1</title>
<path fill="none" stroke="black" d="M1056.96,-7051.9C1057.03,-7043.23 1057.11,-7034.41 1057.19,-7026.27"/>
<polygon fill="black" stroke="black" points="1060.69,-7026.06 1057.28,-7016.03 1053.69,-7025.99 1060.69,-7026.06"/>
</g>
<!-- gate_2_1 -->
<g id="node140" class="node">
<title>gate_2_1</title>
<polygon fill="lightyellow" stroke="black" points="1206.51,-6927.98 971.06,-6927.98 910.49,-6823.98 1145.94,-6823.98 1206.51,-6927.98"/>
<text text-anchor="middle" x="1058.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_2_L1</text>
<text text-anchor="middle" x="1058.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1058.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_1&#45;&gt;gate_2_1 -->
<g id="edge136" class="edge">
<title>attention_2_1&#45;&gt;gate_2_1</title>
<path fill="none" stroke="black" d="M1057.73,-6963.85C1057.79,-6956.16 1057.87,-6947.35 1057.95,-6938.35"/>
<polygon fill="black" stroke="black" points="1061.45,-6938.19 1058.04,-6928.16 1054.45,-6938.13 1061.45,-6938.19"/>
</g>
<!-- expert_2_1 -->
<g id="node141" class="node">
<title>expert_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1133,-6787.98 984,-6787.98 984,-6735.98 1133,-6735.98 1133,-6787.98"/>
<text text-anchor="middle" x="1058.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_2_L1</text>
<text text-anchor="middle" x="1058.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1058.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_1&#45;&gt;expert_2_1 -->
<g id="edge137" class="edge">
<title>gate_2_1&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M1051.77,-6823.9C1051.69,-6815.23 1051.83,-6806.41 1052.18,-6798.27"/>
<polygon fill="black" stroke="black" points="1055.69,-6798.21 1052.77,-6788.03 1048.7,-6797.81 1055.69,-6798.21"/>
</g>
<!-- gate_2_1&#45;&gt;expert_2_1 -->
<g id="edge1090" class="edge">
<title>gate_2_1&#45;&gt;expert_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1065.23,-6823.9C1065.31,-6815.23 1065.17,-6806.41 1064.82,-6798.27"/>
<polygon fill="red" stroke="red" points="1068.3,-6797.81 1064.23,-6788.03 1061.31,-6798.21 1068.3,-6797.81"/>
</g>
<!-- aggregate_2_1 -->
<g id="node142" class="node">
<title>aggregate_2_1</title>
<polygon fill="lightyellow" stroke="black" points="1206.51,-6699.98 971.06,-6699.98 910.49,-6595.98 1145.94,-6595.98 1206.51,-6699.98"/>
<text text-anchor="middle" x="1058.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L1</text>
<text text-anchor="middle" x="1058.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1058.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1058.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_1&#45;&gt;aggregate_2_1 -->
<g id="edge138" class="edge">
<title>expert_2_1&#45;&gt;aggregate_2_1</title>
<path fill="none" stroke="black" d="M1058.5,-6735.85C1058.5,-6728.16 1058.5,-6719.35 1058.5,-6710.35"/>
<polygon fill="black" stroke="black" points="1062,-6710.16 1058.5,-6700.16 1055,-6710.16 1062,-6710.16"/>
</g>
<!-- attention_2_2 -->
<g id="node143" class="node">
<title>attention_2_2</title>
<polygon fill="lightgreen" stroke="black" points="1142.5,-6559.98 974.5,-6559.98 974.5,-6507.98 1142.5,-6507.98 1142.5,-6559.98"/>
<text text-anchor="middle" x="1058.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_2_L2</text>
<text text-anchor="middle" x="1058.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1058.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1058.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_1&#45;&gt;attention_2_2 -->
<g id="edge139" class="edge">
<title>aggregate_2_1&#45;&gt;attention_2_2</title>
<path fill="none" stroke="black" d="M1058.5,-6595.9C1058.5,-6587.23 1058.5,-6578.41 1058.5,-6570.27"/>
<polygon fill="black" stroke="black" points="1062,-6570.03 1058.5,-6560.03 1055,-6570.03 1062,-6570.03"/>
</g>
<!-- gate_2_2 -->
<g id="node144" class="node">
<title>gate_2_2</title>
<polygon fill="lightyellow" stroke="black" points="1206.51,-6471.98 971.06,-6471.98 910.49,-6367.98 1145.94,-6367.98 1206.51,-6471.98"/>
<text text-anchor="middle" x="1058.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_2_L2</text>
<text text-anchor="middle" x="1058.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1058.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_2&#45;&gt;gate_2_2 -->
<g id="edge140" class="edge">
<title>attention_2_2&#45;&gt;gate_2_2</title>
<path fill="none" stroke="black" d="M1058.5,-6507.85C1058.5,-6500.16 1058.5,-6491.35 1058.5,-6482.35"/>
<polygon fill="black" stroke="black" points="1062,-6482.16 1058.5,-6472.16 1055,-6482.16 1062,-6482.16"/>
</g>
<!-- expert_2_2 -->
<g id="node145" class="node">
<title>expert_2_2</title>
<polygon fill="lightgreen" stroke="black" points="1133,-6331.98 984,-6331.98 984,-6279.98 1133,-6279.98 1133,-6331.98"/>
<text text-anchor="middle" x="1058.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_2_L2</text>
<text text-anchor="middle" x="1058.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1058.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_2&#45;&gt;expert_2_2 -->
<g id="edge141" class="edge">
<title>gate_2_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M1051.77,-6367.9C1051.69,-6359.23 1051.83,-6350.41 1052.18,-6342.27"/>
<polygon fill="black" stroke="black" points="1055.69,-6342.21 1052.77,-6332.03 1048.7,-6341.81 1055.69,-6342.21"/>
</g>
<!-- gate_2_2&#45;&gt;expert_2_2 -->
<g id="edge1091" class="edge">
<title>gate_2_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1065.23,-6367.9C1065.31,-6359.23 1065.17,-6350.41 1064.82,-6342.27"/>
<polygon fill="red" stroke="red" points="1068.3,-6341.81 1064.23,-6332.03 1061.31,-6342.21 1068.3,-6341.81"/>
</g>
<!-- aggregate_2_2 -->
<g id="node146" class="node">
<title>aggregate_2_2</title>
<polygon fill="lightyellow" stroke="black" points="1206.51,-6243.98 971.06,-6243.98 910.49,-6139.98 1145.94,-6139.98 1206.51,-6243.98"/>
<text text-anchor="middle" x="1058.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L2</text>
<text text-anchor="middle" x="1058.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1058.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1058.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_2&#45;&gt;aggregate_2_2 -->
<g id="edge142" class="edge">
<title>expert_2_2&#45;&gt;aggregate_2_2</title>
<path fill="none" stroke="black" d="M1058.5,-6279.85C1058.5,-6272.16 1058.5,-6263.35 1058.5,-6254.35"/>
<polygon fill="black" stroke="black" points="1062,-6254.16 1058.5,-6244.16 1055,-6254.16 1062,-6254.16"/>
</g>
<!-- attention_2_3 -->
<g id="node147" class="node">
<title>attention_2_3</title>
<polygon fill="lightgreen" stroke="black" points="1142.5,-6103.98 974.5,-6103.98 974.5,-6051.98 1142.5,-6051.98 1142.5,-6103.98"/>
<text text-anchor="middle" x="1058.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_2_L3</text>
<text text-anchor="middle" x="1058.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1058.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1058.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_2&#45;&gt;attention_2_3 -->
<g id="edge143" class="edge">
<title>aggregate_2_2&#45;&gt;attention_2_3</title>
<path fill="none" stroke="black" d="M1058.5,-6139.9C1058.5,-6131.23 1058.5,-6122.41 1058.5,-6114.27"/>
<polygon fill="black" stroke="black" points="1062,-6114.03 1058.5,-6104.03 1055,-6114.03 1062,-6114.03"/>
</g>
<!-- gate_2_3 -->
<g id="node148" class="node">
<title>gate_2_3</title>
<polygon fill="lightyellow" stroke="black" points="1206.51,-6015.98 971.06,-6015.98 910.49,-5911.98 1145.94,-5911.98 1206.51,-6015.98"/>
<text text-anchor="middle" x="1058.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_2_L3</text>
<text text-anchor="middle" x="1058.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1058.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_3&#45;&gt;gate_2_3 -->
<g id="edge144" class="edge">
<title>attention_2_3&#45;&gt;gate_2_3</title>
<path fill="none" stroke="black" d="M1058.5,-6051.85C1058.5,-6044.16 1058.5,-6035.35 1058.5,-6026.35"/>
<polygon fill="black" stroke="black" points="1062,-6026.16 1058.5,-6016.16 1055,-6026.16 1062,-6026.16"/>
</g>
<!-- expert_2_3 -->
<g id="node149" class="node">
<title>expert_2_3</title>
<polygon fill="lightgreen" stroke="black" points="1133,-5875.98 984,-5875.98 984,-5823.98 1133,-5823.98 1133,-5875.98"/>
<text text-anchor="middle" x="1058.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_2_L3</text>
<text text-anchor="middle" x="1058.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1058.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1058.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_3&#45;&gt;expert_2_3 -->
<g id="edge145" class="edge">
<title>gate_2_3&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M1051.77,-5911.9C1051.69,-5903.23 1051.83,-5894.41 1052.18,-5886.27"/>
<polygon fill="black" stroke="black" points="1055.69,-5886.21 1052.77,-5876.03 1048.7,-5885.81 1055.69,-5886.21"/>
</g>
<!-- gate_2_3&#45;&gt;expert_2_3 -->
<g id="edge1092" class="edge">
<title>gate_2_3&#45;&gt;expert_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1065.23,-5911.9C1065.31,-5903.23 1065.17,-5894.41 1064.82,-5886.27"/>
<polygon fill="red" stroke="red" points="1068.3,-5885.81 1064.23,-5876.03 1061.31,-5886.21 1068.3,-5885.81"/>
</g>
<!-- aggregate_2_3 -->
<g id="node150" class="node">
<title>aggregate_2_3</title>
<polygon fill="lightyellow" stroke="black" points="1208.51,-5787.98 973.06,-5787.98 912.49,-5683.98 1147.94,-5683.98 1208.51,-5787.98"/>
<text text-anchor="middle" x="1060.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L3</text>
<text text-anchor="middle" x="1060.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1060.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1060.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_3&#45;&gt;aggregate_2_3 -->
<g id="edge146" class="edge">
<title>expert_2_3&#45;&gt;aggregate_2_3</title>
<path fill="none" stroke="black" d="M1058.95,-5823.85C1059.09,-5816.16 1059.24,-5807.35 1059.41,-5798.35"/>
<polygon fill="black" stroke="black" points="1062.91,-5798.22 1059.59,-5788.16 1055.91,-5798.1 1062.91,-5798.22"/>
</g>
<!-- attention_2_4 -->
<g id="node151" class="node">
<title>attention_2_4</title>
<polygon fill="lightgreen" stroke="black" points="1146.5,-5647.98 978.5,-5647.98 978.5,-5595.98 1146.5,-5595.98 1146.5,-5647.98"/>
<text text-anchor="middle" x="1062.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_2_L4</text>
<text text-anchor="middle" x="1062.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1062.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1062.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_3&#45;&gt;attention_2_4 -->
<g id="edge147" class="edge">
<title>aggregate_2_3&#45;&gt;attention_2_4</title>
<path fill="none" stroke="black" d="M1061.41,-5683.9C1061.57,-5675.23 1061.73,-5666.41 1061.87,-5658.27"/>
<polygon fill="black" stroke="black" points="1065.37,-5658.09 1062.05,-5648.03 1058.38,-5657.96 1065.37,-5658.09"/>
</g>
<!-- gate_2_4 -->
<g id="node152" class="node">
<title>gate_2_4</title>
<polygon fill="lightyellow" stroke="black" points="1212.51,-5559.98 977.06,-5559.98 916.49,-5455.98 1151.94,-5455.98 1212.51,-5559.98"/>
<text text-anchor="middle" x="1064.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_2_L4</text>
<text text-anchor="middle" x="1064.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1064.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1064.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_4&#45;&gt;gate_2_4 -->
<g id="edge148" class="edge">
<title>attention_2_4&#45;&gt;gate_2_4</title>
<path fill="none" stroke="black" d="M1062.95,-5595.85C1063.09,-5588.16 1063.24,-5579.35 1063.41,-5570.35"/>
<polygon fill="black" stroke="black" points="1066.91,-5570.22 1063.59,-5560.16 1059.91,-5570.1 1066.91,-5570.22"/>
</g>
<!-- expert_2_4 -->
<g id="node153" class="node">
<title>expert_2_4</title>
<polygon fill="lightgreen" stroke="black" points="1140,-5419.98 991,-5419.98 991,-5367.98 1140,-5367.98 1140,-5419.98"/>
<text text-anchor="middle" x="1065.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_2_L4</text>
<text text-anchor="middle" x="1065.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1065.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1065.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_4&#45;&gt;expert_2_4 -->
<g id="edge149" class="edge">
<title>gate_2_4&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M1058.23,-5455.9C1058.23,-5447.23 1058.44,-5438.41 1058.86,-5430.27"/>
<polygon fill="black" stroke="black" points="1062.37,-5430.24 1059.54,-5420.03 1055.39,-5429.77 1062.37,-5430.24"/>
</g>
<!-- gate_2_4&#45;&gt;expert_2_4 -->
<g id="edge1093" class="edge">
<title>gate_2_4&#45;&gt;expert_2_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1071.68,-5455.9C1071.84,-5447.23 1071.79,-5438.41 1071.51,-5430.27"/>
<polygon fill="red" stroke="red" points="1074.99,-5429.85 1071.01,-5420.03 1068,-5430.18 1074.99,-5429.85"/>
</g>
<!-- aggregate_2_4 -->
<g id="node154" class="node">
<title>aggregate_2_4</title>
<polygon fill="lightyellow" stroke="black" points="1215.51,-5331.98 980.06,-5331.98 919.49,-5227.98 1154.94,-5227.98 1215.51,-5331.98"/>
<text text-anchor="middle" x="1067.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L4</text>
<text text-anchor="middle" x="1067.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1067.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1067.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_4&#45;&gt;aggregate_2_4 -->
<g id="edge150" class="edge">
<title>expert_2_4&#45;&gt;aggregate_2_4</title>
<path fill="none" stroke="black" d="M1065.95,-5367.85C1066.09,-5360.16 1066.24,-5351.35 1066.41,-5342.35"/>
<polygon fill="black" stroke="black" points="1069.91,-5342.22 1066.59,-5332.16 1062.91,-5342.1 1069.91,-5342.22"/>
</g>
<!-- attention_2_5 -->
<g id="node155" class="node">
<title>attention_2_5</title>
<polygon fill="lightgreen" stroke="black" points="1152.5,-5191.98 984.5,-5191.98 984.5,-5139.98 1152.5,-5139.98 1152.5,-5191.98"/>
<text text-anchor="middle" x="1068.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_2_L5</text>
<text text-anchor="middle" x="1068.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1068.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1068.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_4&#45;&gt;attention_2_5 -->
<g id="edge151" class="edge">
<title>aggregate_2_4&#45;&gt;attention_2_5</title>
<path fill="none" stroke="black" d="M1067.96,-5227.9C1068.03,-5219.23 1068.11,-5210.41 1068.19,-5202.27"/>
<polygon fill="black" stroke="black" points="1071.69,-5202.06 1068.28,-5192.03 1064.69,-5201.99 1071.69,-5202.06"/>
</g>
<!-- gate_2_5 -->
<g id="node156" class="node">
<title>gate_2_5</title>
<polygon fill="lightyellow" stroke="black" points="1216.51,-5103.98 981.06,-5103.98 920.49,-4999.98 1155.94,-4999.98 1216.51,-5103.98"/>
<text text-anchor="middle" x="1068.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_2_L5</text>
<text text-anchor="middle" x="1068.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1068.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1068.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_5&#45;&gt;gate_2_5 -->
<g id="edge152" class="edge">
<title>attention_2_5&#45;&gt;gate_2_5</title>
<path fill="none" stroke="black" d="M1068.5,-5139.85C1068.5,-5132.16 1068.5,-5123.35 1068.5,-5114.35"/>
<polygon fill="black" stroke="black" points="1072,-5114.16 1068.5,-5104.16 1065,-5114.16 1072,-5114.16"/>
</g>
<!-- expert_2_5 -->
<g id="node157" class="node">
<title>expert_2_5</title>
<polygon fill="lightgreen" stroke="black" points="1143,-4963.98 994,-4963.98 994,-4911.98 1143,-4911.98 1143,-4963.98"/>
<text text-anchor="middle" x="1068.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_2_L5</text>
<text text-anchor="middle" x="1068.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1068.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1068.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_5&#45;&gt;expert_2_5 -->
<g id="edge153" class="edge">
<title>gate_2_5&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M1061.77,-4999.9C1061.69,-4991.23 1061.83,-4982.41 1062.18,-4974.27"/>
<polygon fill="black" stroke="black" points="1065.69,-4974.21 1062.77,-4964.03 1058.7,-4973.81 1065.69,-4974.21"/>
</g>
<!-- gate_2_5&#45;&gt;expert_2_5 -->
<g id="edge1094" class="edge">
<title>gate_2_5&#45;&gt;expert_2_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1075.23,-4999.9C1075.31,-4991.23 1075.17,-4982.41 1074.82,-4974.27"/>
<polygon fill="red" stroke="red" points="1078.3,-4973.81 1074.23,-4964.03 1071.31,-4974.21 1078.3,-4973.81"/>
</g>
<!-- aggregate_2_5 -->
<g id="node158" class="node">
<title>aggregate_2_5</title>
<polygon fill="lightyellow" stroke="black" points="1216.51,-4875.98 981.06,-4875.98 920.49,-4771.98 1155.94,-4771.98 1216.51,-4875.98"/>
<text text-anchor="middle" x="1068.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L5</text>
<text text-anchor="middle" x="1068.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1068.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1068.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_5&#45;&gt;aggregate_2_5 -->
<g id="edge154" class="edge">
<title>expert_2_5&#45;&gt;aggregate_2_5</title>
<path fill="none" stroke="black" d="M1068.5,-4911.85C1068.5,-4904.16 1068.5,-4895.35 1068.5,-4886.35"/>
<polygon fill="black" stroke="black" points="1072,-4886.16 1068.5,-4876.16 1065,-4886.16 1072,-4886.16"/>
</g>
<!-- attention_2_6 -->
<g id="node159" class="node">
<title>attention_2_6</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-4735.98 985.5,-4735.98 985.5,-4683.98 1153.5,-4683.98 1153.5,-4735.98"/>
<text text-anchor="middle" x="1069.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_2_L6</text>
<text text-anchor="middle" x="1069.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_5&#45;&gt;attention_2_6 -->
<g id="edge155" class="edge">
<title>aggregate_2_5&#45;&gt;attention_2_6</title>
<path fill="none" stroke="black" d="M1068.96,-4771.9C1069.03,-4763.23 1069.11,-4754.41 1069.19,-4746.27"/>
<polygon fill="black" stroke="black" points="1072.69,-4746.06 1069.28,-4736.03 1065.69,-4745.99 1072.69,-4746.06"/>
</g>
<!-- gate_2_6 -->
<g id="node160" class="node">
<title>gate_2_6</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-4647.98 982.06,-4647.98 921.49,-4543.98 1156.94,-4543.98 1217.51,-4647.98"/>
<text text-anchor="middle" x="1069.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_2_L6</text>
<text text-anchor="middle" x="1069.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_6&#45;&gt;gate_2_6 -->
<g id="edge156" class="edge">
<title>attention_2_6&#45;&gt;gate_2_6</title>
<path fill="none" stroke="black" d="M1069.5,-4683.85C1069.5,-4676.16 1069.5,-4667.35 1069.5,-4658.35"/>
<polygon fill="black" stroke="black" points="1073,-4658.16 1069.5,-4648.16 1066,-4658.16 1073,-4658.16"/>
</g>
<!-- expert_2_6 -->
<g id="node161" class="node">
<title>expert_2_6</title>
<polygon fill="lightgreen" stroke="black" points="1144,-4507.98 995,-4507.98 995,-4455.98 1144,-4455.98 1144,-4507.98"/>
<text text-anchor="middle" x="1069.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_2_L6</text>
<text text-anchor="middle" x="1069.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_6&#45;&gt;expert_2_6 -->
<g id="edge157" class="edge">
<title>gate_2_6&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M1062.77,-4543.9C1062.69,-4535.23 1062.83,-4526.41 1063.18,-4518.27"/>
<polygon fill="black" stroke="black" points="1066.69,-4518.21 1063.77,-4508.03 1059.7,-4517.81 1066.69,-4518.21"/>
</g>
<!-- gate_2_6&#45;&gt;expert_2_6 -->
<g id="edge1095" class="edge">
<title>gate_2_6&#45;&gt;expert_2_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-4543.9C1076.31,-4535.23 1076.17,-4526.41 1075.82,-4518.27"/>
<polygon fill="red" stroke="red" points="1079.3,-4517.81 1075.23,-4508.03 1072.31,-4518.21 1079.3,-4517.81"/>
</g>
<!-- aggregate_2_6 -->
<g id="node162" class="node">
<title>aggregate_2_6</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-4419.98 982.06,-4419.98 921.49,-4315.98 1156.94,-4315.98 1217.51,-4419.98"/>
<text text-anchor="middle" x="1069.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L6</text>
<text text-anchor="middle" x="1069.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_6&#45;&gt;aggregate_2_6 -->
<g id="edge158" class="edge">
<title>expert_2_6&#45;&gt;aggregate_2_6</title>
<path fill="none" stroke="black" d="M1069.5,-4455.85C1069.5,-4448.16 1069.5,-4439.35 1069.5,-4430.35"/>
<polygon fill="black" stroke="black" points="1073,-4430.16 1069.5,-4420.16 1066,-4430.16 1073,-4430.16"/>
</g>
<!-- attention_2_7 -->
<g id="node163" class="node">
<title>attention_2_7</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-4279.98 985.5,-4279.98 985.5,-4227.98 1153.5,-4227.98 1153.5,-4279.98"/>
<text text-anchor="middle" x="1069.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_2_L7</text>
<text text-anchor="middle" x="1069.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_6&#45;&gt;attention_2_7 -->
<g id="edge159" class="edge">
<title>aggregate_2_6&#45;&gt;attention_2_7</title>
<path fill="none" stroke="black" d="M1069.5,-4315.9C1069.5,-4307.23 1069.5,-4298.41 1069.5,-4290.27"/>
<polygon fill="black" stroke="black" points="1073,-4290.03 1069.5,-4280.03 1066,-4290.03 1073,-4290.03"/>
</g>
<!-- gate_2_7 -->
<g id="node164" class="node">
<title>gate_2_7</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-4191.98 982.06,-4191.98 921.49,-4087.98 1156.94,-4087.98 1217.51,-4191.98"/>
<text text-anchor="middle" x="1069.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_2_L7</text>
<text text-anchor="middle" x="1069.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_7&#45;&gt;gate_2_7 -->
<g id="edge160" class="edge">
<title>attention_2_7&#45;&gt;gate_2_7</title>
<path fill="none" stroke="black" d="M1069.5,-4227.85C1069.5,-4220.16 1069.5,-4211.35 1069.5,-4202.35"/>
<polygon fill="black" stroke="black" points="1073,-4202.16 1069.5,-4192.16 1066,-4202.16 1073,-4202.16"/>
</g>
<!-- expert_2_7 -->
<g id="node165" class="node">
<title>expert_2_7</title>
<polygon fill="lightgreen" stroke="black" points="1144,-4051.98 995,-4051.98 995,-3999.98 1144,-3999.98 1144,-4051.98"/>
<text text-anchor="middle" x="1069.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_2_L7</text>
<text text-anchor="middle" x="1069.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_7&#45;&gt;expert_2_7 -->
<g id="edge161" class="edge">
<title>gate_2_7&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M1062.77,-4087.9C1062.69,-4079.23 1062.83,-4070.41 1063.18,-4062.27"/>
<polygon fill="black" stroke="black" points="1066.69,-4062.21 1063.77,-4052.03 1059.7,-4061.81 1066.69,-4062.21"/>
</g>
<!-- gate_2_7&#45;&gt;expert_2_7 -->
<g id="edge1096" class="edge">
<title>gate_2_7&#45;&gt;expert_2_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-4087.9C1076.31,-4079.23 1076.17,-4070.41 1075.82,-4062.27"/>
<polygon fill="red" stroke="red" points="1079.3,-4061.81 1075.23,-4052.03 1072.31,-4062.21 1079.3,-4061.81"/>
</g>
<!-- aggregate_2_7 -->
<g id="node166" class="node">
<title>aggregate_2_7</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-3963.98 982.06,-3963.98 921.49,-3859.98 1156.94,-3859.98 1217.51,-3963.98"/>
<text text-anchor="middle" x="1069.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L7</text>
<text text-anchor="middle" x="1069.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_7&#45;&gt;aggregate_2_7 -->
<g id="edge162" class="edge">
<title>expert_2_7&#45;&gt;aggregate_2_7</title>
<path fill="none" stroke="black" d="M1069.5,-3999.85C1069.5,-3992.16 1069.5,-3983.35 1069.5,-3974.35"/>
<polygon fill="black" stroke="black" points="1073,-3974.16 1069.5,-3964.16 1066,-3974.16 1073,-3974.16"/>
</g>
<!-- attention_2_8 -->
<g id="node167" class="node">
<title>attention_2_8</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-3823.98 985.5,-3823.98 985.5,-3771.98 1153.5,-3771.98 1153.5,-3823.98"/>
<text text-anchor="middle" x="1069.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_2_L8</text>
<text text-anchor="middle" x="1069.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_7&#45;&gt;attention_2_8 -->
<g id="edge163" class="edge">
<title>aggregate_2_7&#45;&gt;attention_2_8</title>
<path fill="none" stroke="black" d="M1069.5,-3859.9C1069.5,-3851.23 1069.5,-3842.41 1069.5,-3834.27"/>
<polygon fill="black" stroke="black" points="1073,-3834.03 1069.5,-3824.03 1066,-3834.03 1073,-3834.03"/>
</g>
<!-- gate_2_8 -->
<g id="node168" class="node">
<title>gate_2_8</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-3735.98 982.06,-3735.98 921.49,-3631.98 1156.94,-3631.98 1217.51,-3735.98"/>
<text text-anchor="middle" x="1069.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_2_L8</text>
<text text-anchor="middle" x="1069.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_8&#45;&gt;gate_2_8 -->
<g id="edge164" class="edge">
<title>attention_2_8&#45;&gt;gate_2_8</title>
<path fill="none" stroke="black" d="M1069.5,-3771.85C1069.5,-3764.16 1069.5,-3755.35 1069.5,-3746.35"/>
<polygon fill="black" stroke="black" points="1073,-3746.16 1069.5,-3736.16 1066,-3746.16 1073,-3746.16"/>
</g>
<!-- expert_2_8 -->
<g id="node169" class="node">
<title>expert_2_8</title>
<polygon fill="lightgreen" stroke="black" points="1144,-3595.98 995,-3595.98 995,-3543.98 1144,-3543.98 1144,-3595.98"/>
<text text-anchor="middle" x="1069.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_2_L8</text>
<text text-anchor="middle" x="1069.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_8&#45;&gt;expert_2_8 -->
<g id="edge165" class="edge">
<title>gate_2_8&#45;&gt;expert_2_8</title>
<path fill="none" stroke="black" d="M1062.77,-3631.9C1062.69,-3623.23 1062.83,-3614.41 1063.18,-3606.27"/>
<polygon fill="black" stroke="black" points="1066.69,-3606.21 1063.77,-3596.03 1059.7,-3605.81 1066.69,-3606.21"/>
</g>
<!-- gate_2_8&#45;&gt;expert_2_8 -->
<g id="edge1097" class="edge">
<title>gate_2_8&#45;&gt;expert_2_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-3631.9C1076.31,-3623.23 1076.17,-3614.41 1075.82,-3606.27"/>
<polygon fill="red" stroke="red" points="1079.3,-3605.81 1075.23,-3596.03 1072.31,-3606.21 1079.3,-3605.81"/>
</g>
<!-- aggregate_2_8 -->
<g id="node170" class="node">
<title>aggregate_2_8</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-3507.98 982.06,-3507.98 921.49,-3403.98 1156.94,-3403.98 1217.51,-3507.98"/>
<text text-anchor="middle" x="1069.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L8</text>
<text text-anchor="middle" x="1069.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_8&#45;&gt;aggregate_2_8 -->
<g id="edge166" class="edge">
<title>expert_2_8&#45;&gt;aggregate_2_8</title>
<path fill="none" stroke="black" d="M1069.5,-3543.85C1069.5,-3536.16 1069.5,-3527.35 1069.5,-3518.35"/>
<polygon fill="black" stroke="black" points="1073,-3518.16 1069.5,-3508.16 1066,-3518.16 1073,-3518.16"/>
</g>
<!-- attention_2_9 -->
<g id="node171" class="node">
<title>attention_2_9</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-3367.98 985.5,-3367.98 985.5,-3315.98 1153.5,-3315.98 1153.5,-3367.98"/>
<text text-anchor="middle" x="1069.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_2_L9</text>
<text text-anchor="middle" x="1069.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_8&#45;&gt;attention_2_9 -->
<g id="edge167" class="edge">
<title>aggregate_2_8&#45;&gt;attention_2_9</title>
<path fill="none" stroke="black" d="M1069.5,-3403.9C1069.5,-3395.23 1069.5,-3386.41 1069.5,-3378.27"/>
<polygon fill="black" stroke="black" points="1073,-3378.03 1069.5,-3368.03 1066,-3378.03 1073,-3378.03"/>
</g>
<!-- gate_2_9 -->
<g id="node172" class="node">
<title>gate_2_9</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-3279.98 982.06,-3279.98 921.49,-3175.98 1156.94,-3175.98 1217.51,-3279.98"/>
<text text-anchor="middle" x="1069.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_2_L9</text>
<text text-anchor="middle" x="1069.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_9&#45;&gt;gate_2_9 -->
<g id="edge168" class="edge">
<title>attention_2_9&#45;&gt;gate_2_9</title>
<path fill="none" stroke="black" d="M1069.5,-3315.85C1069.5,-3308.16 1069.5,-3299.35 1069.5,-3290.35"/>
<polygon fill="black" stroke="black" points="1073,-3290.16 1069.5,-3280.16 1066,-3290.16 1073,-3290.16"/>
</g>
<!-- expert_2_9 -->
<g id="node173" class="node">
<title>expert_2_9</title>
<polygon fill="lightgreen" stroke="black" points="1144,-3139.98 995,-3139.98 995,-3087.98 1144,-3087.98 1144,-3139.98"/>
<text text-anchor="middle" x="1069.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_2_L9</text>
<text text-anchor="middle" x="1069.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_9&#45;&gt;expert_2_9 -->
<g id="edge169" class="edge">
<title>gate_2_9&#45;&gt;expert_2_9</title>
<path fill="none" stroke="black" d="M1062.77,-3175.9C1062.69,-3167.23 1062.83,-3158.41 1063.18,-3150.27"/>
<polygon fill="black" stroke="black" points="1066.69,-3150.21 1063.77,-3140.03 1059.7,-3149.81 1066.69,-3150.21"/>
</g>
<!-- gate_2_9&#45;&gt;expert_2_9 -->
<g id="edge1098" class="edge">
<title>gate_2_9&#45;&gt;expert_2_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-3175.9C1076.31,-3167.23 1076.17,-3158.41 1075.82,-3150.27"/>
<polygon fill="red" stroke="red" points="1079.3,-3149.81 1075.23,-3140.03 1072.31,-3150.21 1079.3,-3149.81"/>
</g>
<!-- aggregate_2_9 -->
<g id="node174" class="node">
<title>aggregate_2_9</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-3051.98 982.06,-3051.98 921.49,-2947.98 1156.94,-2947.98 1217.51,-3051.98"/>
<text text-anchor="middle" x="1069.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L9</text>
<text text-anchor="middle" x="1069.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_9&#45;&gt;aggregate_2_9 -->
<g id="edge170" class="edge">
<title>expert_2_9&#45;&gt;aggregate_2_9</title>
<path fill="none" stroke="black" d="M1069.5,-3087.85C1069.5,-3080.16 1069.5,-3071.35 1069.5,-3062.35"/>
<polygon fill="black" stroke="black" points="1073,-3062.16 1069.5,-3052.16 1066,-3062.16 1073,-3062.16"/>
</g>
<!-- attention_2_10 -->
<g id="node175" class="node">
<title>attention_2_10</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-2911.98 985.5,-2911.98 985.5,-2859.98 1153.5,-2859.98 1153.5,-2911.98"/>
<text text-anchor="middle" x="1069.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_2_L10</text>
<text text-anchor="middle" x="1069.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_9&#45;&gt;attention_2_10 -->
<g id="edge171" class="edge">
<title>aggregate_2_9&#45;&gt;attention_2_10</title>
<path fill="none" stroke="black" d="M1069.5,-2947.9C1069.5,-2939.23 1069.5,-2930.41 1069.5,-2922.27"/>
<polygon fill="black" stroke="black" points="1073,-2922.03 1069.5,-2912.03 1066,-2922.03 1073,-2922.03"/>
</g>
<!-- gate_2_10 -->
<g id="node176" class="node">
<title>gate_2_10</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-2823.98 982.06,-2823.98 921.49,-2719.98 1156.94,-2719.98 1217.51,-2823.98"/>
<text text-anchor="middle" x="1069.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_2_L10</text>
<text text-anchor="middle" x="1069.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_10&#45;&gt;gate_2_10 -->
<g id="edge172" class="edge">
<title>attention_2_10&#45;&gt;gate_2_10</title>
<path fill="none" stroke="black" d="M1069.5,-2859.85C1069.5,-2852.16 1069.5,-2843.35 1069.5,-2834.35"/>
<polygon fill="black" stroke="black" points="1073,-2834.16 1069.5,-2824.16 1066,-2834.16 1073,-2834.16"/>
</g>
<!-- expert_2_10 -->
<g id="node177" class="node">
<title>expert_2_10</title>
<polygon fill="lightgreen" stroke="black" points="1144,-2683.98 995,-2683.98 995,-2631.98 1144,-2631.98 1144,-2683.98"/>
<text text-anchor="middle" x="1069.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_2_L10</text>
<text text-anchor="middle" x="1069.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_10&#45;&gt;expert_2_10 -->
<g id="edge173" class="edge">
<title>gate_2_10&#45;&gt;expert_2_10</title>
<path fill="none" stroke="black" d="M1062.77,-2719.9C1062.69,-2711.23 1062.83,-2702.41 1063.18,-2694.27"/>
<polygon fill="black" stroke="black" points="1066.69,-2694.21 1063.77,-2684.03 1059.7,-2693.81 1066.69,-2694.21"/>
</g>
<!-- gate_2_10&#45;&gt;expert_2_10 -->
<g id="edge1099" class="edge">
<title>gate_2_10&#45;&gt;expert_2_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-2719.9C1076.31,-2711.23 1076.17,-2702.41 1075.82,-2694.27"/>
<polygon fill="red" stroke="red" points="1079.3,-2693.81 1075.23,-2684.03 1072.31,-2694.21 1079.3,-2693.81"/>
</g>
<!-- aggregate_2_10 -->
<g id="node178" class="node">
<title>aggregate_2_10</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-2595.98 982.06,-2595.98 921.49,-2491.98 1156.94,-2491.98 1217.51,-2595.98"/>
<text text-anchor="middle" x="1069.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L10</text>
<text text-anchor="middle" x="1069.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_10&#45;&gt;aggregate_2_10 -->
<g id="edge174" class="edge">
<title>expert_2_10&#45;&gt;aggregate_2_10</title>
<path fill="none" stroke="black" d="M1069.5,-2631.85C1069.5,-2624.16 1069.5,-2615.35 1069.5,-2606.35"/>
<polygon fill="black" stroke="black" points="1073,-2606.16 1069.5,-2596.16 1066,-2606.16 1073,-2606.16"/>
</g>
<!-- attention_2_11 -->
<g id="node179" class="node">
<title>attention_2_11</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-2455.98 985.5,-2455.98 985.5,-2403.98 1153.5,-2403.98 1153.5,-2455.98"/>
<text text-anchor="middle" x="1069.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_2_L11</text>
<text text-anchor="middle" x="1069.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_10&#45;&gt;attention_2_11 -->
<g id="edge175" class="edge">
<title>aggregate_2_10&#45;&gt;attention_2_11</title>
<path fill="none" stroke="black" d="M1069.5,-2491.9C1069.5,-2483.23 1069.5,-2474.41 1069.5,-2466.27"/>
<polygon fill="black" stroke="black" points="1073,-2466.03 1069.5,-2456.03 1066,-2466.03 1073,-2466.03"/>
</g>
<!-- gate_2_11 -->
<g id="node180" class="node">
<title>gate_2_11</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-2367.98 982.06,-2367.98 921.49,-2263.98 1156.94,-2263.98 1217.51,-2367.98"/>
<text text-anchor="middle" x="1069.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_2_L11</text>
<text text-anchor="middle" x="1069.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_11&#45;&gt;gate_2_11 -->
<g id="edge176" class="edge">
<title>attention_2_11&#45;&gt;gate_2_11</title>
<path fill="none" stroke="black" d="M1069.5,-2403.85C1069.5,-2396.16 1069.5,-2387.35 1069.5,-2378.35"/>
<polygon fill="black" stroke="black" points="1073,-2378.16 1069.5,-2368.16 1066,-2378.16 1073,-2378.16"/>
</g>
<!-- expert_2_11 -->
<g id="node181" class="node">
<title>expert_2_11</title>
<polygon fill="lightgreen" stroke="black" points="1144,-2227.98 995,-2227.98 995,-2175.98 1144,-2175.98 1144,-2227.98"/>
<text text-anchor="middle" x="1069.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_2_L11</text>
<text text-anchor="middle" x="1069.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_11&#45;&gt;expert_2_11 -->
<g id="edge177" class="edge">
<title>gate_2_11&#45;&gt;expert_2_11</title>
<path fill="none" stroke="black" d="M1062.77,-2263.9C1062.69,-2255.23 1062.83,-2246.41 1063.18,-2238.27"/>
<polygon fill="black" stroke="black" points="1066.69,-2238.21 1063.77,-2228.03 1059.7,-2237.81 1066.69,-2238.21"/>
</g>
<!-- gate_2_11&#45;&gt;expert_2_11 -->
<g id="edge1100" class="edge">
<title>gate_2_11&#45;&gt;expert_2_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-2263.9C1076.31,-2255.23 1076.17,-2246.41 1075.82,-2238.27"/>
<polygon fill="red" stroke="red" points="1079.3,-2237.81 1075.23,-2228.03 1072.31,-2238.21 1079.3,-2237.81"/>
</g>
<!-- aggregate_2_11 -->
<g id="node182" class="node">
<title>aggregate_2_11</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-2139.98 982.06,-2139.98 921.49,-2035.98 1156.94,-2035.98 1217.51,-2139.98"/>
<text text-anchor="middle" x="1069.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L11</text>
<text text-anchor="middle" x="1069.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_11&#45;&gt;aggregate_2_11 -->
<g id="edge178" class="edge">
<title>expert_2_11&#45;&gt;aggregate_2_11</title>
<path fill="none" stroke="black" d="M1069.5,-2175.85C1069.5,-2168.16 1069.5,-2159.35 1069.5,-2150.35"/>
<polygon fill="black" stroke="black" points="1073,-2150.16 1069.5,-2140.16 1066,-2150.16 1073,-2150.16"/>
</g>
<!-- attention_2_12 -->
<g id="node183" class="node">
<title>attention_2_12</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-1999.98 985.5,-1999.98 985.5,-1947.98 1153.5,-1947.98 1153.5,-1999.98"/>
<text text-anchor="middle" x="1069.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_2_L12</text>
<text text-anchor="middle" x="1069.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_11&#45;&gt;attention_2_12 -->
<g id="edge179" class="edge">
<title>aggregate_2_11&#45;&gt;attention_2_12</title>
<path fill="none" stroke="black" d="M1069.5,-2035.9C1069.5,-2027.23 1069.5,-2018.41 1069.5,-2010.27"/>
<polygon fill="black" stroke="black" points="1073,-2010.03 1069.5,-2000.03 1066,-2010.03 1073,-2010.03"/>
</g>
<!-- gate_2_12 -->
<g id="node184" class="node">
<title>gate_2_12</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-1911.98 982.06,-1911.98 921.49,-1807.98 1156.94,-1807.98 1217.51,-1911.98"/>
<text text-anchor="middle" x="1069.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_2_L12</text>
<text text-anchor="middle" x="1069.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_12&#45;&gt;gate_2_12 -->
<g id="edge180" class="edge">
<title>attention_2_12&#45;&gt;gate_2_12</title>
<path fill="none" stroke="black" d="M1069.5,-1947.85C1069.5,-1940.16 1069.5,-1931.35 1069.5,-1922.35"/>
<polygon fill="black" stroke="black" points="1073,-1922.16 1069.5,-1912.16 1066,-1922.16 1073,-1922.16"/>
</g>
<!-- expert_2_12 -->
<g id="node185" class="node">
<title>expert_2_12</title>
<polygon fill="lightgreen" stroke="black" points="1144,-1771.98 995,-1771.98 995,-1719.98 1144,-1719.98 1144,-1771.98"/>
<text text-anchor="middle" x="1069.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_2_L12</text>
<text text-anchor="middle" x="1069.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_12&#45;&gt;expert_2_12 -->
<g id="edge181" class="edge">
<title>gate_2_12&#45;&gt;expert_2_12</title>
<path fill="none" stroke="black" d="M1062.77,-1807.9C1062.69,-1799.23 1062.83,-1790.41 1063.18,-1782.27"/>
<polygon fill="black" stroke="black" points="1066.69,-1782.21 1063.77,-1772.03 1059.7,-1781.81 1066.69,-1782.21"/>
</g>
<!-- gate_2_12&#45;&gt;expert_2_12 -->
<g id="edge1101" class="edge">
<title>gate_2_12&#45;&gt;expert_2_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-1807.9C1076.31,-1799.23 1076.17,-1790.41 1075.82,-1782.27"/>
<polygon fill="red" stroke="red" points="1079.3,-1781.81 1075.23,-1772.03 1072.31,-1782.21 1079.3,-1781.81"/>
</g>
<!-- aggregate_2_12 -->
<g id="node186" class="node">
<title>aggregate_2_12</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-1683.98 982.06,-1683.98 921.49,-1579.98 1156.94,-1579.98 1217.51,-1683.98"/>
<text text-anchor="middle" x="1069.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L12</text>
<text text-anchor="middle" x="1069.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_12&#45;&gt;aggregate_2_12 -->
<g id="edge182" class="edge">
<title>expert_2_12&#45;&gt;aggregate_2_12</title>
<path fill="none" stroke="black" d="M1069.5,-1719.85C1069.5,-1712.16 1069.5,-1703.35 1069.5,-1694.35"/>
<polygon fill="black" stroke="black" points="1073,-1694.16 1069.5,-1684.16 1066,-1694.16 1073,-1694.16"/>
</g>
<!-- attention_2_13 -->
<g id="node187" class="node">
<title>attention_2_13</title>
<polygon fill="lightgreen" stroke="black" points="1153.5,-1543.98 985.5,-1543.98 985.5,-1491.98 1153.5,-1491.98 1153.5,-1543.98"/>
<text text-anchor="middle" x="1069.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_2_L13</text>
<text text-anchor="middle" x="1069.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1069.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1069.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_12&#45;&gt;attention_2_13 -->
<g id="edge183" class="edge">
<title>aggregate_2_12&#45;&gt;attention_2_13</title>
<path fill="none" stroke="black" d="M1069.5,-1579.9C1069.5,-1571.23 1069.5,-1562.41 1069.5,-1554.27"/>
<polygon fill="black" stroke="black" points="1073,-1554.03 1069.5,-1544.03 1066,-1554.03 1073,-1554.03"/>
</g>
<!-- gate_2_13 -->
<g id="node188" class="node">
<title>gate_2_13</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-1455.98 982.06,-1455.98 921.49,-1351.98 1156.94,-1351.98 1217.51,-1455.98"/>
<text text-anchor="middle" x="1069.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_2_L13</text>
<text text-anchor="middle" x="1069.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1069.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_13&#45;&gt;gate_2_13 -->
<g id="edge184" class="edge">
<title>attention_2_13&#45;&gt;gate_2_13</title>
<path fill="none" stroke="black" d="M1069.5,-1491.85C1069.5,-1484.16 1069.5,-1475.35 1069.5,-1466.35"/>
<polygon fill="black" stroke="black" points="1073,-1466.16 1069.5,-1456.16 1066,-1466.16 1073,-1466.16"/>
</g>
<!-- expert_2_13 -->
<g id="node189" class="node">
<title>expert_2_13</title>
<polygon fill="lightgreen" stroke="black" points="1144,-1315.98 995,-1315.98 995,-1263.98 1144,-1263.98 1144,-1315.98"/>
<text text-anchor="middle" x="1069.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_2_L13</text>
<text text-anchor="middle" x="1069.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1069.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1069.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_13&#45;&gt;expert_2_13 -->
<g id="edge185" class="edge">
<title>gate_2_13&#45;&gt;expert_2_13</title>
<path fill="none" stroke="black" d="M1062.77,-1351.9C1062.69,-1343.23 1062.83,-1334.41 1063.18,-1326.27"/>
<polygon fill="black" stroke="black" points="1066.69,-1326.21 1063.77,-1316.03 1059.7,-1325.81 1066.69,-1326.21"/>
</g>
<!-- gate_2_13&#45;&gt;expert_2_13 -->
<g id="edge1102" class="edge">
<title>gate_2_13&#45;&gt;expert_2_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1076.23,-1351.9C1076.31,-1343.23 1076.17,-1334.41 1075.82,-1326.27"/>
<polygon fill="red" stroke="red" points="1079.3,-1325.81 1075.23,-1316.03 1072.31,-1326.21 1079.3,-1325.81"/>
</g>
<!-- aggregate_2_13 -->
<g id="node190" class="node">
<title>aggregate_2_13</title>
<polygon fill="lightyellow" stroke="black" points="1217.51,-1227.98 982.06,-1227.98 921.49,-1123.98 1156.94,-1123.98 1217.51,-1227.98"/>
<text text-anchor="middle" x="1069.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L13</text>
<text text-anchor="middle" x="1069.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1069.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1069.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_13&#45;&gt;aggregate_2_13 -->
<g id="edge186" class="edge">
<title>expert_2_13&#45;&gt;aggregate_2_13</title>
<path fill="none" stroke="black" d="M1069.5,-1263.85C1069.5,-1256.16 1069.5,-1247.35 1069.5,-1238.35"/>
<polygon fill="black" stroke="black" points="1073,-1238.16 1069.5,-1228.16 1066,-1238.16 1073,-1238.16"/>
</g>
<!-- attention_2_14 -->
<g id="node191" class="node">
<title>attention_2_14</title>
<polygon fill="lightgreen" stroke="black" points="1154.5,-1087.98 986.5,-1087.98 986.5,-1035.98 1154.5,-1035.98 1154.5,-1087.98"/>
<text text-anchor="middle" x="1070.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_2_L14</text>
<text text-anchor="middle" x="1070.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1070.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1070.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_13&#45;&gt;attention_2_14 -->
<g id="edge187" class="edge">
<title>aggregate_2_13&#45;&gt;attention_2_14</title>
<path fill="none" stroke="black" d="M1069.96,-1123.9C1070.03,-1115.23 1070.11,-1106.41 1070.19,-1098.27"/>
<polygon fill="black" stroke="black" points="1073.69,-1098.06 1070.28,-1088.03 1066.69,-1097.99 1073.69,-1098.06"/>
</g>
<!-- gate_2_14 -->
<g id="node192" class="node">
<title>gate_2_14</title>
<polygon fill="lightyellow" stroke="black" points="1218.51,-999.98 983.06,-999.98 922.49,-895.98 1157.94,-895.98 1218.51,-999.98"/>
<text text-anchor="middle" x="1070.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_2_L14</text>
<text text-anchor="middle" x="1070.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1070.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1070.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_14&#45;&gt;gate_2_14 -->
<g id="edge188" class="edge">
<title>attention_2_14&#45;&gt;gate_2_14</title>
<path fill="none" stroke="black" d="M1070.5,-1035.85C1070.5,-1028.16 1070.5,-1019.35 1070.5,-1010.35"/>
<polygon fill="black" stroke="black" points="1074,-1010.16 1070.5,-1000.16 1067,-1010.16 1074,-1010.16"/>
</g>
<!-- expert_2_14 -->
<g id="node193" class="node">
<title>expert_2_14</title>
<polygon fill="lightgreen" stroke="black" points="1145,-859.98 996,-859.98 996,-807.98 1145,-807.98 1145,-859.98"/>
<text text-anchor="middle" x="1070.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_2_L14</text>
<text text-anchor="middle" x="1070.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1070.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1070.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_14&#45;&gt;expert_2_14 -->
<g id="edge189" class="edge">
<title>gate_2_14&#45;&gt;expert_2_14</title>
<path fill="none" stroke="black" d="M1063.77,-895.9C1063.69,-887.23 1063.83,-878.41 1064.18,-870.27"/>
<polygon fill="black" stroke="black" points="1067.69,-870.21 1064.77,-860.03 1060.7,-869.81 1067.69,-870.21"/>
</g>
<!-- gate_2_14&#45;&gt;expert_2_14 -->
<g id="edge1103" class="edge">
<title>gate_2_14&#45;&gt;expert_2_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1077.23,-895.9C1077.31,-887.23 1077.17,-878.41 1076.82,-870.27"/>
<polygon fill="red" stroke="red" points="1080.3,-869.81 1076.23,-860.03 1073.31,-870.21 1080.3,-869.81"/>
</g>
<!-- aggregate_2_14 -->
<g id="node194" class="node">
<title>aggregate_2_14</title>
<polygon fill="lightyellow" stroke="black" points="1218.51,-771.98 983.06,-771.98 922.49,-667.98 1157.94,-667.98 1218.51,-771.98"/>
<text text-anchor="middle" x="1070.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L14</text>
<text text-anchor="middle" x="1070.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1070.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1070.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_14&#45;&gt;aggregate_2_14 -->
<g id="edge190" class="edge">
<title>expert_2_14&#45;&gt;aggregate_2_14</title>
<path fill="none" stroke="black" d="M1070.5,-807.85C1070.5,-800.16 1070.5,-791.35 1070.5,-782.35"/>
<polygon fill="black" stroke="black" points="1074,-782.16 1070.5,-772.16 1067,-782.16 1074,-782.16"/>
</g>
<!-- attention_2_15 -->
<g id="node195" class="node">
<title>attention_2_15</title>
<polygon fill="lightgreen" stroke="black" points="1158.5,-631.98 990.5,-631.98 990.5,-579.98 1158.5,-579.98 1158.5,-631.98"/>
<text text-anchor="middle" x="1074.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_2_L15</text>
<text text-anchor="middle" x="1074.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1074.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1074.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_2_14&#45;&gt;attention_2_15 -->
<g id="edge191" class="edge">
<title>aggregate_2_14&#45;&gt;attention_2_15</title>
<path fill="none" stroke="black" d="M1072.33,-667.9C1072.63,-659.23 1072.95,-650.41 1073.24,-642.27"/>
<polygon fill="black" stroke="black" points="1076.75,-642.14 1073.61,-632.03 1069.75,-641.89 1076.75,-642.14"/>
</g>
<!-- gate_2_15 -->
<g id="node196" class="node">
<title>gate_2_15</title>
<polygon fill="lightyellow" stroke="black" points="1226.51,-543.98 991.06,-543.98 930.49,-439.98 1165.94,-439.98 1226.51,-543.98"/>
<text text-anchor="middle" x="1078.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_2_L15</text>
<text text-anchor="middle" x="1078.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1078.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1078.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_2_15&#45;&gt;gate_2_15 -->
<g id="edge192" class="edge">
<title>attention_2_15&#45;&gt;gate_2_15</title>
<path fill="none" stroke="black" d="M1075.4,-579.85C1075.67,-572.16 1075.99,-563.35 1076.31,-554.35"/>
<polygon fill="black" stroke="black" points="1079.81,-554.28 1076.67,-544.16 1072.82,-554.03 1079.81,-554.28"/>
</g>
<!-- expert_2_15 -->
<g id="node197" class="node">
<title>expert_2_15</title>
<polygon fill="lightgreen" stroke="black" points="1153,-403.98 1004,-403.98 1004,-351.98 1153,-351.98 1153,-403.98"/>
<text text-anchor="middle" x="1078.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_2_L15</text>
<text text-anchor="middle" x="1078.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=2</text>
<text text-anchor="middle" x="1078.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1078.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_2_15&#45;&gt;expert_2_15 -->
<g id="edge193" class="edge">
<title>gate_2_15&#45;&gt;expert_2_15</title>
<path fill="none" stroke="black" d="M1071.77,-439.9C1071.69,-431.23 1071.83,-422.41 1072.18,-414.27"/>
<polygon fill="black" stroke="black" points="1075.69,-414.21 1072.77,-404.03 1068.7,-413.81 1075.69,-414.21"/>
</g>
<!-- gate_2_15&#45;&gt;expert_2_15 -->
<g id="edge1104" class="edge">
<title>gate_2_15&#45;&gt;expert_2_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1085.23,-439.9C1085.31,-431.23 1085.17,-422.41 1084.82,-414.27"/>
<polygon fill="red" stroke="red" points="1088.3,-413.81 1084.23,-404.03 1081.31,-414.21 1088.3,-413.81"/>
</g>
<!-- aggregate_2_15 -->
<g id="node198" class="node">
<title>aggregate_2_15</title>
<polygon fill="lightyellow" stroke="black" points="1229.51,-315.98 994.06,-315.98 933.49,-211.98 1168.94,-211.98 1229.51,-315.98"/>
<text text-anchor="middle" x="1081.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_2_L15</text>
<text text-anchor="middle" x="1081.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1081.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1081.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_2_15&#45;&gt;aggregate_2_15 -->
<g id="edge194" class="edge">
<title>expert_2_15&#45;&gt;aggregate_2_15</title>
<path fill="none" stroke="black" d="M1079.17,-351.85C1079.38,-344.16 1079.62,-335.35 1079.86,-326.35"/>
<polygon fill="black" stroke="black" points="1083.36,-326.25 1080.13,-316.16 1076.36,-326.06 1083.36,-326.25"/>
</g>
<!-- collect_2 -->
<g id="node199" class="node">
<title>collect_2</title>
<polygon fill="lightyellow" stroke="black" points="1229.51,-175.98 994.06,-175.98 933.49,-93.98 1168.94,-93.98 1229.51,-175.98"/>
<text text-anchor="middle" x="1081.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_2</text>
<text text-anchor="middle" x="1081.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1081.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_2_15&#45;&gt;collect_2 -->
<g id="edge195" class="edge">
<title>aggregate_2_15&#45;&gt;collect_2</title>
<path fill="none" stroke="black" d="M1081.5,-211.69C1081.5,-203.27 1081.5,-194.56 1081.5,-186.17"/>
<polygon fill="black" stroke="black" points="1085,-186.14 1081.5,-176.14 1078,-186.14 1085,-186.14"/>
</g>
<!-- collect_2&#45;&gt;output -->
<g id="edge1043" class="edge">
<title>collect_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1178.21,-106.13C1198.32,-101.3 1219.48,-96.89 1239.5,-93.98 1516.86,-53.68 2359.05,-36.89 2683.83,-31.8"/>
<polygon fill="black" stroke="black" points="2684.28,-35.3 2694.23,-31.64 2684.18,-28.3 2684.28,-35.3"/>
</g>
<!-- distribute_3 -->
<g id="node200" class="node">
<title>distribute_3</title>
<polygon fill="lightyellow" stroke="black" points="1522.73,-7589.98 1282.16,-7589.98 1220.27,-7507.98 1460.85,-7507.98 1522.73,-7589.98"/>
<text text-anchor="middle" x="1371.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_3</text>
<text text-anchor="middle" x="1371.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="1371.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_0 -->
<g id="node201" class="node">
<title>attention_3_0</title>
<polygon fill="lightgreen" stroke="black" points="1455.5,-7471.98 1287.5,-7471.98 1287.5,-7419.98 1455.5,-7419.98 1455.5,-7471.98"/>
<text text-anchor="middle" x="1371.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_3_L0</text>
<text text-anchor="middle" x="1371.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1371.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1371.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_3&#45;&gt;attention_3_0 -->
<g id="edge196" class="edge">
<title>distribute_3&#45;&gt;attention_3_0</title>
<path fill="none" stroke="black" d="M1371.5,-7507.77C1371.5,-7499.34 1371.5,-7490.51 1371.5,-7482.27"/>
<polygon fill="black" stroke="black" points="1375,-7482.23 1371.5,-7472.23 1368,-7482.23 1375,-7482.23"/>
</g>
<!-- gate_3_0 -->
<g id="node202" class="node">
<title>gate_3_0</title>
<polygon fill="lightyellow" stroke="black" points="1520.51,-7383.98 1285.06,-7383.98 1224.49,-7279.98 1459.94,-7279.98 1520.51,-7383.98"/>
<text text-anchor="middle" x="1372.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_3_L0</text>
<text text-anchor="middle" x="1372.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1372.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1372.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_0&#45;&gt;gate_3_0 -->
<g id="edge197" class="edge">
<title>attention_3_0&#45;&gt;gate_3_0</title>
<path fill="none" stroke="black" d="M1371.73,-7419.85C1371.79,-7412.16 1371.87,-7403.35 1371.95,-7394.35"/>
<polygon fill="black" stroke="black" points="1375.45,-7394.19 1372.04,-7384.16 1368.45,-7394.13 1375.45,-7394.19"/>
</g>
<!-- expert_3_0 -->
<g id="node203" class="node">
<title>expert_3_0</title>
<polygon fill="lightgreen" stroke="black" points="1447,-7243.98 1298,-7243.98 1298,-7191.98 1447,-7191.98 1447,-7243.98"/>
<text text-anchor="middle" x="1372.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_3_L0</text>
<text text-anchor="middle" x="1372.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1372.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1372.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_0&#45;&gt;expert_3_0 -->
<g id="edge198" class="edge">
<title>gate_3_0&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M1365.77,-7279.9C1365.69,-7271.23 1365.83,-7262.41 1366.18,-7254.27"/>
<polygon fill="black" stroke="black" points="1369.69,-7254.21 1366.77,-7244.03 1362.7,-7253.81 1369.69,-7254.21"/>
</g>
<!-- gate_3_0&#45;&gt;expert_3_0 -->
<g id="edge1105" class="edge">
<title>gate_3_0&#45;&gt;expert_3_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1379.23,-7279.9C1379.31,-7271.23 1379.17,-7262.41 1378.82,-7254.27"/>
<polygon fill="red" stroke="red" points="1382.3,-7253.81 1378.23,-7244.03 1375.31,-7254.21 1382.3,-7253.81"/>
</g>
<!-- aggregate_3_0 -->
<g id="node204" class="node">
<title>aggregate_3_0</title>
<polygon fill="lightyellow" stroke="black" points="1520.51,-7155.98 1285.06,-7155.98 1224.49,-7051.98 1459.94,-7051.98 1520.51,-7155.98"/>
<text text-anchor="middle" x="1372.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L0</text>
<text text-anchor="middle" x="1372.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1372.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1372.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_0&#45;&gt;aggregate_3_0 -->
<g id="edge199" class="edge">
<title>expert_3_0&#45;&gt;aggregate_3_0</title>
<path fill="none" stroke="black" d="M1372.5,-7191.85C1372.5,-7184.16 1372.5,-7175.35 1372.5,-7166.35"/>
<polygon fill="black" stroke="black" points="1376,-7166.16 1372.5,-7156.16 1369,-7166.16 1376,-7166.16"/>
</g>
<!-- attention_3_1 -->
<g id="node205" class="node">
<title>attention_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1456.5,-7015.98 1288.5,-7015.98 1288.5,-6963.98 1456.5,-6963.98 1456.5,-7015.98"/>
<text text-anchor="middle" x="1372.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_3_L1</text>
<text text-anchor="middle" x="1372.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1372.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1372.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_0&#45;&gt;attention_3_1 -->
<g id="edge200" class="edge">
<title>aggregate_3_0&#45;&gt;attention_3_1</title>
<path fill="none" stroke="black" d="M1372.5,-7051.9C1372.5,-7043.23 1372.5,-7034.41 1372.5,-7026.27"/>
<polygon fill="black" stroke="black" points="1376,-7026.03 1372.5,-7016.03 1369,-7026.03 1376,-7026.03"/>
</g>
<!-- gate_3_1 -->
<g id="node206" class="node">
<title>gate_3_1</title>
<polygon fill="lightyellow" stroke="black" points="1521.51,-6927.98 1286.06,-6927.98 1225.49,-6823.98 1460.94,-6823.98 1521.51,-6927.98"/>
<text text-anchor="middle" x="1373.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_3_L1</text>
<text text-anchor="middle" x="1373.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1373.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1373.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_1&#45;&gt;gate_3_1 -->
<g id="edge201" class="edge">
<title>attention_3_1&#45;&gt;gate_3_1</title>
<path fill="none" stroke="black" d="M1372.73,-6963.85C1372.79,-6956.16 1372.87,-6947.35 1372.95,-6938.35"/>
<polygon fill="black" stroke="black" points="1376.45,-6938.19 1373.04,-6928.16 1369.45,-6938.13 1376.45,-6938.19"/>
</g>
<!-- expert_3_1 -->
<g id="node207" class="node">
<title>expert_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1448,-6787.98 1299,-6787.98 1299,-6735.98 1448,-6735.98 1448,-6787.98"/>
<text text-anchor="middle" x="1373.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_3_L1</text>
<text text-anchor="middle" x="1373.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1373.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1373.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_1&#45;&gt;expert_3_1 -->
<g id="edge202" class="edge">
<title>gate_3_1&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M1366.77,-6823.9C1366.69,-6815.23 1366.83,-6806.41 1367.18,-6798.27"/>
<polygon fill="black" stroke="black" points="1370.69,-6798.21 1367.77,-6788.03 1363.7,-6797.81 1370.69,-6798.21"/>
</g>
<!-- gate_3_1&#45;&gt;expert_3_1 -->
<g id="edge1106" class="edge">
<title>gate_3_1&#45;&gt;expert_3_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1380.23,-6823.9C1380.31,-6815.23 1380.17,-6806.41 1379.82,-6798.27"/>
<polygon fill="red" stroke="red" points="1383.3,-6797.81 1379.23,-6788.03 1376.31,-6798.21 1383.3,-6797.81"/>
</g>
<!-- aggregate_3_1 -->
<g id="node208" class="node">
<title>aggregate_3_1</title>
<polygon fill="lightyellow" stroke="black" points="1521.51,-6699.98 1286.06,-6699.98 1225.49,-6595.98 1460.94,-6595.98 1521.51,-6699.98"/>
<text text-anchor="middle" x="1373.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L1</text>
<text text-anchor="middle" x="1373.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1373.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1373.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_1&#45;&gt;aggregate_3_1 -->
<g id="edge203" class="edge">
<title>expert_3_1&#45;&gt;aggregate_3_1</title>
<path fill="none" stroke="black" d="M1373.5,-6735.85C1373.5,-6728.16 1373.5,-6719.35 1373.5,-6710.35"/>
<polygon fill="black" stroke="black" points="1377,-6710.16 1373.5,-6700.16 1370,-6710.16 1377,-6710.16"/>
</g>
<!-- attention_3_2 -->
<g id="node209" class="node">
<title>attention_3_2</title>
<polygon fill="lightgreen" stroke="black" points="1457.5,-6559.98 1289.5,-6559.98 1289.5,-6507.98 1457.5,-6507.98 1457.5,-6559.98"/>
<text text-anchor="middle" x="1373.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_3_L2</text>
<text text-anchor="middle" x="1373.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1373.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1373.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_1&#45;&gt;attention_3_2 -->
<g id="edge204" class="edge">
<title>aggregate_3_1&#45;&gt;attention_3_2</title>
<path fill="none" stroke="black" d="M1373.5,-6595.9C1373.5,-6587.23 1373.5,-6578.41 1373.5,-6570.27"/>
<polygon fill="black" stroke="black" points="1377,-6570.03 1373.5,-6560.03 1370,-6570.03 1377,-6570.03"/>
</g>
<!-- gate_3_2 -->
<g id="node210" class="node">
<title>gate_3_2</title>
<polygon fill="lightyellow" stroke="black" points="1521.51,-6471.98 1286.06,-6471.98 1225.49,-6367.98 1460.94,-6367.98 1521.51,-6471.98"/>
<text text-anchor="middle" x="1373.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_3_L2</text>
<text text-anchor="middle" x="1373.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1373.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1373.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_2&#45;&gt;gate_3_2 -->
<g id="edge205" class="edge">
<title>attention_3_2&#45;&gt;gate_3_2</title>
<path fill="none" stroke="black" d="M1373.5,-6507.85C1373.5,-6500.16 1373.5,-6491.35 1373.5,-6482.35"/>
<polygon fill="black" stroke="black" points="1377,-6482.16 1373.5,-6472.16 1370,-6482.16 1377,-6482.16"/>
</g>
<!-- expert_3_2 -->
<g id="node211" class="node">
<title>expert_3_2</title>
<polygon fill="lightgreen" stroke="black" points="1448,-6331.98 1299,-6331.98 1299,-6279.98 1448,-6279.98 1448,-6331.98"/>
<text text-anchor="middle" x="1373.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_3_L2</text>
<text text-anchor="middle" x="1373.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1373.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1373.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_2&#45;&gt;expert_3_2 -->
<g id="edge206" class="edge">
<title>gate_3_2&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M1366.77,-6367.9C1366.69,-6359.23 1366.83,-6350.41 1367.18,-6342.27"/>
<polygon fill="black" stroke="black" points="1370.69,-6342.21 1367.77,-6332.03 1363.7,-6341.81 1370.69,-6342.21"/>
</g>
<!-- gate_3_2&#45;&gt;expert_3_2 -->
<g id="edge1107" class="edge">
<title>gate_3_2&#45;&gt;expert_3_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1380.23,-6367.9C1380.31,-6359.23 1380.17,-6350.41 1379.82,-6342.27"/>
<polygon fill="red" stroke="red" points="1383.3,-6341.81 1379.23,-6332.03 1376.31,-6342.21 1383.3,-6341.81"/>
</g>
<!-- aggregate_3_2 -->
<g id="node212" class="node">
<title>aggregate_3_2</title>
<polygon fill="lightyellow" stroke="black" points="1521.51,-6243.98 1286.06,-6243.98 1225.49,-6139.98 1460.94,-6139.98 1521.51,-6243.98"/>
<text text-anchor="middle" x="1373.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L2</text>
<text text-anchor="middle" x="1373.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1373.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1373.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_2&#45;&gt;aggregate_3_2 -->
<g id="edge207" class="edge">
<title>expert_3_2&#45;&gt;aggregate_3_2</title>
<path fill="none" stroke="black" d="M1373.5,-6279.85C1373.5,-6272.16 1373.5,-6263.35 1373.5,-6254.35"/>
<polygon fill="black" stroke="black" points="1377,-6254.16 1373.5,-6244.16 1370,-6254.16 1377,-6254.16"/>
</g>
<!-- attention_3_3 -->
<g id="node213" class="node">
<title>attention_3_3</title>
<polygon fill="lightgreen" stroke="black" points="1457.5,-6103.98 1289.5,-6103.98 1289.5,-6051.98 1457.5,-6051.98 1457.5,-6103.98"/>
<text text-anchor="middle" x="1373.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_3_L3</text>
<text text-anchor="middle" x="1373.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1373.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1373.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_2&#45;&gt;attention_3_3 -->
<g id="edge208" class="edge">
<title>aggregate_3_2&#45;&gt;attention_3_3</title>
<path fill="none" stroke="black" d="M1373.5,-6139.9C1373.5,-6131.23 1373.5,-6122.41 1373.5,-6114.27"/>
<polygon fill="black" stroke="black" points="1377,-6114.03 1373.5,-6104.03 1370,-6114.03 1377,-6114.03"/>
</g>
<!-- gate_3_3 -->
<g id="node214" class="node">
<title>gate_3_3</title>
<polygon fill="lightyellow" stroke="black" points="1521.51,-6015.98 1286.06,-6015.98 1225.49,-5911.98 1460.94,-5911.98 1521.51,-6015.98"/>
<text text-anchor="middle" x="1373.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_3_L3</text>
<text text-anchor="middle" x="1373.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1373.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1373.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_3&#45;&gt;gate_3_3 -->
<g id="edge209" class="edge">
<title>attention_3_3&#45;&gt;gate_3_3</title>
<path fill="none" stroke="black" d="M1373.5,-6051.85C1373.5,-6044.16 1373.5,-6035.35 1373.5,-6026.35"/>
<polygon fill="black" stroke="black" points="1377,-6026.16 1373.5,-6016.16 1370,-6026.16 1377,-6026.16"/>
</g>
<!-- expert_3_3 -->
<g id="node215" class="node">
<title>expert_3_3</title>
<polygon fill="lightgreen" stroke="black" points="1449,-5875.98 1300,-5875.98 1300,-5823.98 1449,-5823.98 1449,-5875.98"/>
<text text-anchor="middle" x="1374.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_3_L3</text>
<text text-anchor="middle" x="1374.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1374.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1374.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_3&#45;&gt;expert_3_3 -->
<g id="edge210" class="edge">
<title>gate_3_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M1367.23,-5911.9C1367.23,-5903.23 1367.44,-5894.41 1367.86,-5886.27"/>
<polygon fill="black" stroke="black" points="1371.37,-5886.24 1368.54,-5876.03 1364.39,-5885.77 1371.37,-5886.24"/>
</g>
<!-- gate_3_3&#45;&gt;expert_3_3 -->
<g id="edge1108" class="edge">
<title>gate_3_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1380.68,-5911.9C1380.84,-5903.23 1380.79,-5894.41 1380.51,-5886.27"/>
<polygon fill="red" stroke="red" points="1383.99,-5885.85 1380.01,-5876.03 1377,-5886.18 1383.99,-5885.85"/>
</g>
<!-- aggregate_3_3 -->
<g id="node216" class="node">
<title>aggregate_3_3</title>
<polygon fill="lightyellow" stroke="black" points="1523.51,-5787.98 1288.06,-5787.98 1227.49,-5683.98 1462.94,-5683.98 1523.51,-5787.98"/>
<text text-anchor="middle" x="1375.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L3</text>
<text text-anchor="middle" x="1375.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1375.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1375.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_3&#45;&gt;aggregate_3_3 -->
<g id="edge211" class="edge">
<title>expert_3_3&#45;&gt;aggregate_3_3</title>
<path fill="none" stroke="black" d="M1374.73,-5823.85C1374.79,-5816.16 1374.87,-5807.35 1374.95,-5798.35"/>
<polygon fill="black" stroke="black" points="1378.45,-5798.19 1375.04,-5788.16 1371.45,-5798.13 1378.45,-5798.19"/>
</g>
<!-- attention_3_4 -->
<g id="node217" class="node">
<title>attention_3_4</title>
<polygon fill="lightgreen" stroke="black" points="1462.5,-5647.98 1294.5,-5647.98 1294.5,-5595.98 1462.5,-5595.98 1462.5,-5647.98"/>
<text text-anchor="middle" x="1378.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_3_L4</text>
<text text-anchor="middle" x="1378.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1378.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1378.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_3&#45;&gt;attention_3_4 -->
<g id="edge212" class="edge">
<title>aggregate_3_3&#45;&gt;attention_3_4</title>
<path fill="none" stroke="black" d="M1376.87,-5683.9C1377.1,-5675.23 1377.34,-5666.41 1377.56,-5658.27"/>
<polygon fill="black" stroke="black" points="1381.06,-5658.12 1377.83,-5648.03 1374.06,-5657.93 1381.06,-5658.12"/>
</g>
<!-- gate_3_4 -->
<g id="node218" class="node">
<title>gate_3_4</title>
<polygon fill="lightyellow" stroke="black" points="1528.51,-5559.98 1293.06,-5559.98 1232.49,-5455.98 1467.94,-5455.98 1528.51,-5559.98"/>
<text text-anchor="middle" x="1380.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_3_L4</text>
<text text-anchor="middle" x="1380.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1380.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1380.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_4&#45;&gt;gate_3_4 -->
<g id="edge213" class="edge">
<title>attention_3_4&#45;&gt;gate_3_4</title>
<path fill="none" stroke="black" d="M1378.95,-5595.85C1379.09,-5588.16 1379.24,-5579.35 1379.41,-5570.35"/>
<polygon fill="black" stroke="black" points="1382.91,-5570.22 1379.59,-5560.16 1375.91,-5570.1 1382.91,-5570.22"/>
</g>
<!-- expert_3_4 -->
<g id="node219" class="node">
<title>expert_3_4</title>
<polygon fill="lightgreen" stroke="black" points="1456,-5419.98 1307,-5419.98 1307,-5367.98 1456,-5367.98 1456,-5419.98"/>
<text text-anchor="middle" x="1381.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_3_L4</text>
<text text-anchor="middle" x="1381.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1381.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1381.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_4&#45;&gt;expert_3_4 -->
<g id="edge214" class="edge">
<title>gate_3_4&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M1374.23,-5455.9C1374.23,-5447.23 1374.44,-5438.41 1374.86,-5430.27"/>
<polygon fill="black" stroke="black" points="1378.37,-5430.24 1375.54,-5420.03 1371.39,-5429.77 1378.37,-5430.24"/>
</g>
<!-- gate_3_4&#45;&gt;expert_3_4 -->
<g id="edge1109" class="edge">
<title>gate_3_4&#45;&gt;expert_3_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1387.68,-5455.9C1387.84,-5447.23 1387.79,-5438.41 1387.51,-5430.27"/>
<polygon fill="red" stroke="red" points="1390.99,-5429.85 1387.01,-5420.03 1384,-5430.18 1390.99,-5429.85"/>
</g>
<!-- aggregate_3_4 -->
<g id="node220" class="node">
<title>aggregate_3_4</title>
<polygon fill="lightyellow" stroke="black" points="1531.51,-5331.98 1296.06,-5331.98 1235.49,-5227.98 1470.94,-5227.98 1531.51,-5331.98"/>
<text text-anchor="middle" x="1383.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L4</text>
<text text-anchor="middle" x="1383.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1383.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1383.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_4&#45;&gt;aggregate_3_4 -->
<g id="edge215" class="edge">
<title>expert_3_4&#45;&gt;aggregate_3_4</title>
<path fill="none" stroke="black" d="M1381.95,-5367.85C1382.09,-5360.16 1382.24,-5351.35 1382.41,-5342.35"/>
<polygon fill="black" stroke="black" points="1385.91,-5342.22 1382.59,-5332.16 1378.91,-5342.1 1385.91,-5342.22"/>
</g>
<!-- attention_3_5 -->
<g id="node221" class="node">
<title>attention_3_5</title>
<polygon fill="lightgreen" stroke="black" points="1467.5,-5191.98 1299.5,-5191.98 1299.5,-5139.98 1467.5,-5139.98 1467.5,-5191.98"/>
<text text-anchor="middle" x="1383.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_3_L5</text>
<text text-anchor="middle" x="1383.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1383.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1383.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_4&#45;&gt;attention_3_5 -->
<g id="edge216" class="edge">
<title>aggregate_3_4&#45;&gt;attention_3_5</title>
<path fill="none" stroke="black" d="M1383.5,-5227.9C1383.5,-5219.23 1383.5,-5210.41 1383.5,-5202.27"/>
<polygon fill="black" stroke="black" points="1387,-5202.03 1383.5,-5192.03 1380,-5202.03 1387,-5202.03"/>
</g>
<!-- gate_3_5 -->
<g id="node222" class="node">
<title>gate_3_5</title>
<polygon fill="lightyellow" stroke="black" points="1531.51,-5103.98 1296.06,-5103.98 1235.49,-4999.98 1470.94,-4999.98 1531.51,-5103.98"/>
<text text-anchor="middle" x="1383.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_3_L5</text>
<text text-anchor="middle" x="1383.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1383.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1383.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_5&#45;&gt;gate_3_5 -->
<g id="edge217" class="edge">
<title>attention_3_5&#45;&gt;gate_3_5</title>
<path fill="none" stroke="black" d="M1383.5,-5139.85C1383.5,-5132.16 1383.5,-5123.35 1383.5,-5114.35"/>
<polygon fill="black" stroke="black" points="1387,-5114.16 1383.5,-5104.16 1380,-5114.16 1387,-5114.16"/>
</g>
<!-- expert_3_5 -->
<g id="node223" class="node">
<title>expert_3_5</title>
<polygon fill="lightgreen" stroke="black" points="1459,-4963.98 1310,-4963.98 1310,-4911.98 1459,-4911.98 1459,-4963.98"/>
<text text-anchor="middle" x="1384.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_3_L5</text>
<text text-anchor="middle" x="1384.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_5&#45;&gt;expert_3_5 -->
<g id="edge218" class="edge">
<title>gate_3_5&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M1377.23,-4999.9C1377.23,-4991.23 1377.44,-4982.41 1377.86,-4974.27"/>
<polygon fill="black" stroke="black" points="1381.37,-4974.24 1378.54,-4964.03 1374.39,-4973.77 1381.37,-4974.24"/>
</g>
<!-- gate_3_5&#45;&gt;expert_3_5 -->
<g id="edge1110" class="edge">
<title>gate_3_5&#45;&gt;expert_3_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1390.68,-4999.9C1390.84,-4991.23 1390.79,-4982.41 1390.51,-4974.27"/>
<polygon fill="red" stroke="red" points="1393.99,-4973.85 1390.01,-4964.03 1387,-4974.18 1393.99,-4973.85"/>
</g>
<!-- aggregate_3_5 -->
<g id="node224" class="node">
<title>aggregate_3_5</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-4875.98 1297.06,-4875.98 1236.49,-4771.98 1471.94,-4771.98 1532.51,-4875.98"/>
<text text-anchor="middle" x="1384.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L5</text>
<text text-anchor="middle" x="1384.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_5&#45;&gt;aggregate_3_5 -->
<g id="edge219" class="edge">
<title>expert_3_5&#45;&gt;aggregate_3_5</title>
<path fill="none" stroke="black" d="M1384.5,-4911.85C1384.5,-4904.16 1384.5,-4895.35 1384.5,-4886.35"/>
<polygon fill="black" stroke="black" points="1388,-4886.16 1384.5,-4876.16 1381,-4886.16 1388,-4886.16"/>
</g>
<!-- attention_3_6 -->
<g id="node225" class="node">
<title>attention_3_6</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-4735.98 1300.5,-4735.98 1300.5,-4683.98 1468.5,-4683.98 1468.5,-4735.98"/>
<text text-anchor="middle" x="1384.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_3_L6</text>
<text text-anchor="middle" x="1384.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_5&#45;&gt;attention_3_6 -->
<g id="edge220" class="edge">
<title>aggregate_3_5&#45;&gt;attention_3_6</title>
<path fill="none" stroke="black" d="M1384.5,-4771.9C1384.5,-4763.23 1384.5,-4754.41 1384.5,-4746.27"/>
<polygon fill="black" stroke="black" points="1388,-4746.03 1384.5,-4736.03 1381,-4746.03 1388,-4746.03"/>
</g>
<!-- gate_3_6 -->
<g id="node226" class="node">
<title>gate_3_6</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-4647.98 1297.06,-4647.98 1236.49,-4543.98 1471.94,-4543.98 1532.51,-4647.98"/>
<text text-anchor="middle" x="1384.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_3_L6</text>
<text text-anchor="middle" x="1384.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_6&#45;&gt;gate_3_6 -->
<g id="edge221" class="edge">
<title>attention_3_6&#45;&gt;gate_3_6</title>
<path fill="none" stroke="black" d="M1384.5,-4683.85C1384.5,-4676.16 1384.5,-4667.35 1384.5,-4658.35"/>
<polygon fill="black" stroke="black" points="1388,-4658.16 1384.5,-4648.16 1381,-4658.16 1388,-4658.16"/>
</g>
<!-- expert_3_6 -->
<g id="node227" class="node">
<title>expert_3_6</title>
<polygon fill="lightgreen" stroke="black" points="1459,-4507.98 1310,-4507.98 1310,-4455.98 1459,-4455.98 1459,-4507.98"/>
<text text-anchor="middle" x="1384.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_3_L6</text>
<text text-anchor="middle" x="1384.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_6&#45;&gt;expert_3_6 -->
<g id="edge222" class="edge">
<title>gate_3_6&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M1377.77,-4543.9C1377.69,-4535.23 1377.83,-4526.41 1378.18,-4518.27"/>
<polygon fill="black" stroke="black" points="1381.69,-4518.21 1378.77,-4508.03 1374.7,-4517.81 1381.69,-4518.21"/>
</g>
<!-- gate_3_6&#45;&gt;expert_3_6 -->
<g id="edge1111" class="edge">
<title>gate_3_6&#45;&gt;expert_3_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-4543.9C1391.31,-4535.23 1391.17,-4526.41 1390.82,-4518.27"/>
<polygon fill="red" stroke="red" points="1394.3,-4517.81 1390.23,-4508.03 1387.31,-4518.21 1394.3,-4517.81"/>
</g>
<!-- aggregate_3_6 -->
<g id="node228" class="node">
<title>aggregate_3_6</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-4419.98 1297.06,-4419.98 1236.49,-4315.98 1471.94,-4315.98 1532.51,-4419.98"/>
<text text-anchor="middle" x="1384.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L6</text>
<text text-anchor="middle" x="1384.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_6&#45;&gt;aggregate_3_6 -->
<g id="edge223" class="edge">
<title>expert_3_6&#45;&gt;aggregate_3_6</title>
<path fill="none" stroke="black" d="M1384.5,-4455.85C1384.5,-4448.16 1384.5,-4439.35 1384.5,-4430.35"/>
<polygon fill="black" stroke="black" points="1388,-4430.16 1384.5,-4420.16 1381,-4430.16 1388,-4430.16"/>
</g>
<!-- attention_3_7 -->
<g id="node229" class="node">
<title>attention_3_7</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-4279.98 1300.5,-4279.98 1300.5,-4227.98 1468.5,-4227.98 1468.5,-4279.98"/>
<text text-anchor="middle" x="1384.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_3_L7</text>
<text text-anchor="middle" x="1384.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_6&#45;&gt;attention_3_7 -->
<g id="edge224" class="edge">
<title>aggregate_3_6&#45;&gt;attention_3_7</title>
<path fill="none" stroke="black" d="M1384.5,-4315.9C1384.5,-4307.23 1384.5,-4298.41 1384.5,-4290.27"/>
<polygon fill="black" stroke="black" points="1388,-4290.03 1384.5,-4280.03 1381,-4290.03 1388,-4290.03"/>
</g>
<!-- gate_3_7 -->
<g id="node230" class="node">
<title>gate_3_7</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-4191.98 1297.06,-4191.98 1236.49,-4087.98 1471.94,-4087.98 1532.51,-4191.98"/>
<text text-anchor="middle" x="1384.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_3_L7</text>
<text text-anchor="middle" x="1384.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_7&#45;&gt;gate_3_7 -->
<g id="edge225" class="edge">
<title>attention_3_7&#45;&gt;gate_3_7</title>
<path fill="none" stroke="black" d="M1384.5,-4227.85C1384.5,-4220.16 1384.5,-4211.35 1384.5,-4202.35"/>
<polygon fill="black" stroke="black" points="1388,-4202.16 1384.5,-4192.16 1381,-4202.16 1388,-4202.16"/>
</g>
<!-- expert_3_7 -->
<g id="node231" class="node">
<title>expert_3_7</title>
<polygon fill="lightgreen" stroke="black" points="1459,-4051.98 1310,-4051.98 1310,-3999.98 1459,-3999.98 1459,-4051.98"/>
<text text-anchor="middle" x="1384.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_3_L7</text>
<text text-anchor="middle" x="1384.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_7&#45;&gt;expert_3_7 -->
<g id="edge226" class="edge">
<title>gate_3_7&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M1377.77,-4087.9C1377.69,-4079.23 1377.83,-4070.41 1378.18,-4062.27"/>
<polygon fill="black" stroke="black" points="1381.69,-4062.21 1378.77,-4052.03 1374.7,-4061.81 1381.69,-4062.21"/>
</g>
<!-- gate_3_7&#45;&gt;expert_3_7 -->
<g id="edge1112" class="edge">
<title>gate_3_7&#45;&gt;expert_3_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-4087.9C1391.31,-4079.23 1391.17,-4070.41 1390.82,-4062.27"/>
<polygon fill="red" stroke="red" points="1394.3,-4061.81 1390.23,-4052.03 1387.31,-4062.21 1394.3,-4061.81"/>
</g>
<!-- aggregate_3_7 -->
<g id="node232" class="node">
<title>aggregate_3_7</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-3963.98 1297.06,-3963.98 1236.49,-3859.98 1471.94,-3859.98 1532.51,-3963.98"/>
<text text-anchor="middle" x="1384.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L7</text>
<text text-anchor="middle" x="1384.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_7&#45;&gt;aggregate_3_7 -->
<g id="edge227" class="edge">
<title>expert_3_7&#45;&gt;aggregate_3_7</title>
<path fill="none" stroke="black" d="M1384.5,-3999.85C1384.5,-3992.16 1384.5,-3983.35 1384.5,-3974.35"/>
<polygon fill="black" stroke="black" points="1388,-3974.16 1384.5,-3964.16 1381,-3974.16 1388,-3974.16"/>
</g>
<!-- attention_3_8 -->
<g id="node233" class="node">
<title>attention_3_8</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-3823.98 1300.5,-3823.98 1300.5,-3771.98 1468.5,-3771.98 1468.5,-3823.98"/>
<text text-anchor="middle" x="1384.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_3_L8</text>
<text text-anchor="middle" x="1384.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_7&#45;&gt;attention_3_8 -->
<g id="edge228" class="edge">
<title>aggregate_3_7&#45;&gt;attention_3_8</title>
<path fill="none" stroke="black" d="M1384.5,-3859.9C1384.5,-3851.23 1384.5,-3842.41 1384.5,-3834.27"/>
<polygon fill="black" stroke="black" points="1388,-3834.03 1384.5,-3824.03 1381,-3834.03 1388,-3834.03"/>
</g>
<!-- gate_3_8 -->
<g id="node234" class="node">
<title>gate_3_8</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-3735.98 1297.06,-3735.98 1236.49,-3631.98 1471.94,-3631.98 1532.51,-3735.98"/>
<text text-anchor="middle" x="1384.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_3_L8</text>
<text text-anchor="middle" x="1384.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_8&#45;&gt;gate_3_8 -->
<g id="edge229" class="edge">
<title>attention_3_8&#45;&gt;gate_3_8</title>
<path fill="none" stroke="black" d="M1384.5,-3771.85C1384.5,-3764.16 1384.5,-3755.35 1384.5,-3746.35"/>
<polygon fill="black" stroke="black" points="1388,-3746.16 1384.5,-3736.16 1381,-3746.16 1388,-3746.16"/>
</g>
<!-- expert_3_8 -->
<g id="node235" class="node">
<title>expert_3_8</title>
<polygon fill="lightgreen" stroke="black" points="1459,-3595.98 1310,-3595.98 1310,-3543.98 1459,-3543.98 1459,-3595.98"/>
<text text-anchor="middle" x="1384.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_3_L8</text>
<text text-anchor="middle" x="1384.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_8&#45;&gt;expert_3_8 -->
<g id="edge230" class="edge">
<title>gate_3_8&#45;&gt;expert_3_8</title>
<path fill="none" stroke="black" d="M1377.77,-3631.9C1377.69,-3623.23 1377.83,-3614.41 1378.18,-3606.27"/>
<polygon fill="black" stroke="black" points="1381.69,-3606.21 1378.77,-3596.03 1374.7,-3605.81 1381.69,-3606.21"/>
</g>
<!-- gate_3_8&#45;&gt;expert_3_8 -->
<g id="edge1113" class="edge">
<title>gate_3_8&#45;&gt;expert_3_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-3631.9C1391.31,-3623.23 1391.17,-3614.41 1390.82,-3606.27"/>
<polygon fill="red" stroke="red" points="1394.3,-3605.81 1390.23,-3596.03 1387.31,-3606.21 1394.3,-3605.81"/>
</g>
<!-- aggregate_3_8 -->
<g id="node236" class="node">
<title>aggregate_3_8</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-3507.98 1297.06,-3507.98 1236.49,-3403.98 1471.94,-3403.98 1532.51,-3507.98"/>
<text text-anchor="middle" x="1384.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L8</text>
<text text-anchor="middle" x="1384.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_8&#45;&gt;aggregate_3_8 -->
<g id="edge231" class="edge">
<title>expert_3_8&#45;&gt;aggregate_3_8</title>
<path fill="none" stroke="black" d="M1384.5,-3543.85C1384.5,-3536.16 1384.5,-3527.35 1384.5,-3518.35"/>
<polygon fill="black" stroke="black" points="1388,-3518.16 1384.5,-3508.16 1381,-3518.16 1388,-3518.16"/>
</g>
<!-- attention_3_9 -->
<g id="node237" class="node">
<title>attention_3_9</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-3367.98 1300.5,-3367.98 1300.5,-3315.98 1468.5,-3315.98 1468.5,-3367.98"/>
<text text-anchor="middle" x="1384.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_3_L9</text>
<text text-anchor="middle" x="1384.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_8&#45;&gt;attention_3_9 -->
<g id="edge232" class="edge">
<title>aggregate_3_8&#45;&gt;attention_3_9</title>
<path fill="none" stroke="black" d="M1384.5,-3403.9C1384.5,-3395.23 1384.5,-3386.41 1384.5,-3378.27"/>
<polygon fill="black" stroke="black" points="1388,-3378.03 1384.5,-3368.03 1381,-3378.03 1388,-3378.03"/>
</g>
<!-- gate_3_9 -->
<g id="node238" class="node">
<title>gate_3_9</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-3279.98 1297.06,-3279.98 1236.49,-3175.98 1471.94,-3175.98 1532.51,-3279.98"/>
<text text-anchor="middle" x="1384.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_3_L9</text>
<text text-anchor="middle" x="1384.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_9&#45;&gt;gate_3_9 -->
<g id="edge233" class="edge">
<title>attention_3_9&#45;&gt;gate_3_9</title>
<path fill="none" stroke="black" d="M1384.5,-3315.85C1384.5,-3308.16 1384.5,-3299.35 1384.5,-3290.35"/>
<polygon fill="black" stroke="black" points="1388,-3290.16 1384.5,-3280.16 1381,-3290.16 1388,-3290.16"/>
</g>
<!-- expert_3_9 -->
<g id="node239" class="node">
<title>expert_3_9</title>
<polygon fill="lightgreen" stroke="black" points="1459,-3139.98 1310,-3139.98 1310,-3087.98 1459,-3087.98 1459,-3139.98"/>
<text text-anchor="middle" x="1384.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_3_L9</text>
<text text-anchor="middle" x="1384.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_9&#45;&gt;expert_3_9 -->
<g id="edge234" class="edge">
<title>gate_3_9&#45;&gt;expert_3_9</title>
<path fill="none" stroke="black" d="M1377.77,-3175.9C1377.69,-3167.23 1377.83,-3158.41 1378.18,-3150.27"/>
<polygon fill="black" stroke="black" points="1381.69,-3150.21 1378.77,-3140.03 1374.7,-3149.81 1381.69,-3150.21"/>
</g>
<!-- gate_3_9&#45;&gt;expert_3_9 -->
<g id="edge1114" class="edge">
<title>gate_3_9&#45;&gt;expert_3_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-3175.9C1391.31,-3167.23 1391.17,-3158.41 1390.82,-3150.27"/>
<polygon fill="red" stroke="red" points="1394.3,-3149.81 1390.23,-3140.03 1387.31,-3150.21 1394.3,-3149.81"/>
</g>
<!-- aggregate_3_9 -->
<g id="node240" class="node">
<title>aggregate_3_9</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-3051.98 1297.06,-3051.98 1236.49,-2947.98 1471.94,-2947.98 1532.51,-3051.98"/>
<text text-anchor="middle" x="1384.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L9</text>
<text text-anchor="middle" x="1384.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_9&#45;&gt;aggregate_3_9 -->
<g id="edge235" class="edge">
<title>expert_3_9&#45;&gt;aggregate_3_9</title>
<path fill="none" stroke="black" d="M1384.5,-3087.85C1384.5,-3080.16 1384.5,-3071.35 1384.5,-3062.35"/>
<polygon fill="black" stroke="black" points="1388,-3062.16 1384.5,-3052.16 1381,-3062.16 1388,-3062.16"/>
</g>
<!-- attention_3_10 -->
<g id="node241" class="node">
<title>attention_3_10</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-2911.98 1300.5,-2911.98 1300.5,-2859.98 1468.5,-2859.98 1468.5,-2911.98"/>
<text text-anchor="middle" x="1384.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_3_L10</text>
<text text-anchor="middle" x="1384.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_9&#45;&gt;attention_3_10 -->
<g id="edge236" class="edge">
<title>aggregate_3_9&#45;&gt;attention_3_10</title>
<path fill="none" stroke="black" d="M1384.5,-2947.9C1384.5,-2939.23 1384.5,-2930.41 1384.5,-2922.27"/>
<polygon fill="black" stroke="black" points="1388,-2922.03 1384.5,-2912.03 1381,-2922.03 1388,-2922.03"/>
</g>
<!-- gate_3_10 -->
<g id="node242" class="node">
<title>gate_3_10</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-2823.98 1297.06,-2823.98 1236.49,-2719.98 1471.94,-2719.98 1532.51,-2823.98"/>
<text text-anchor="middle" x="1384.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_3_L10</text>
<text text-anchor="middle" x="1384.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_10&#45;&gt;gate_3_10 -->
<g id="edge237" class="edge">
<title>attention_3_10&#45;&gt;gate_3_10</title>
<path fill="none" stroke="black" d="M1384.5,-2859.85C1384.5,-2852.16 1384.5,-2843.35 1384.5,-2834.35"/>
<polygon fill="black" stroke="black" points="1388,-2834.16 1384.5,-2824.16 1381,-2834.16 1388,-2834.16"/>
</g>
<!-- expert_3_10 -->
<g id="node243" class="node">
<title>expert_3_10</title>
<polygon fill="lightgreen" stroke="black" points="1459,-2683.98 1310,-2683.98 1310,-2631.98 1459,-2631.98 1459,-2683.98"/>
<text text-anchor="middle" x="1384.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_3_L10</text>
<text text-anchor="middle" x="1384.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_10&#45;&gt;expert_3_10 -->
<g id="edge238" class="edge">
<title>gate_3_10&#45;&gt;expert_3_10</title>
<path fill="none" stroke="black" d="M1377.77,-2719.9C1377.69,-2711.23 1377.83,-2702.41 1378.18,-2694.27"/>
<polygon fill="black" stroke="black" points="1381.69,-2694.21 1378.77,-2684.03 1374.7,-2693.81 1381.69,-2694.21"/>
</g>
<!-- gate_3_10&#45;&gt;expert_3_10 -->
<g id="edge1115" class="edge">
<title>gate_3_10&#45;&gt;expert_3_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-2719.9C1391.31,-2711.23 1391.17,-2702.41 1390.82,-2694.27"/>
<polygon fill="red" stroke="red" points="1394.3,-2693.81 1390.23,-2684.03 1387.31,-2694.21 1394.3,-2693.81"/>
</g>
<!-- aggregate_3_10 -->
<g id="node244" class="node">
<title>aggregate_3_10</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-2595.98 1297.06,-2595.98 1236.49,-2491.98 1471.94,-2491.98 1532.51,-2595.98"/>
<text text-anchor="middle" x="1384.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L10</text>
<text text-anchor="middle" x="1384.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_10&#45;&gt;aggregate_3_10 -->
<g id="edge239" class="edge">
<title>expert_3_10&#45;&gt;aggregate_3_10</title>
<path fill="none" stroke="black" d="M1384.5,-2631.85C1384.5,-2624.16 1384.5,-2615.35 1384.5,-2606.35"/>
<polygon fill="black" stroke="black" points="1388,-2606.16 1384.5,-2596.16 1381,-2606.16 1388,-2606.16"/>
</g>
<!-- attention_3_11 -->
<g id="node245" class="node">
<title>attention_3_11</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-2455.98 1300.5,-2455.98 1300.5,-2403.98 1468.5,-2403.98 1468.5,-2455.98"/>
<text text-anchor="middle" x="1384.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_3_L11</text>
<text text-anchor="middle" x="1384.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_10&#45;&gt;attention_3_11 -->
<g id="edge240" class="edge">
<title>aggregate_3_10&#45;&gt;attention_3_11</title>
<path fill="none" stroke="black" d="M1384.5,-2491.9C1384.5,-2483.23 1384.5,-2474.41 1384.5,-2466.27"/>
<polygon fill="black" stroke="black" points="1388,-2466.03 1384.5,-2456.03 1381,-2466.03 1388,-2466.03"/>
</g>
<!-- gate_3_11 -->
<g id="node246" class="node">
<title>gate_3_11</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-2367.98 1297.06,-2367.98 1236.49,-2263.98 1471.94,-2263.98 1532.51,-2367.98"/>
<text text-anchor="middle" x="1384.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_3_L11</text>
<text text-anchor="middle" x="1384.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1384.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_11&#45;&gt;gate_3_11 -->
<g id="edge241" class="edge">
<title>attention_3_11&#45;&gt;gate_3_11</title>
<path fill="none" stroke="black" d="M1384.5,-2403.85C1384.5,-2396.16 1384.5,-2387.35 1384.5,-2378.35"/>
<polygon fill="black" stroke="black" points="1388,-2378.16 1384.5,-2368.16 1381,-2378.16 1388,-2378.16"/>
</g>
<!-- expert_3_11 -->
<g id="node247" class="node">
<title>expert_3_11</title>
<polygon fill="lightgreen" stroke="black" points="1459,-2227.98 1310,-2227.98 1310,-2175.98 1459,-2175.98 1459,-2227.98"/>
<text text-anchor="middle" x="1384.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_3_L11</text>
<text text-anchor="middle" x="1384.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1384.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1384.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_11&#45;&gt;expert_3_11 -->
<g id="edge242" class="edge">
<title>gate_3_11&#45;&gt;expert_3_11</title>
<path fill="none" stroke="black" d="M1377.77,-2263.9C1377.69,-2255.23 1377.83,-2246.41 1378.18,-2238.27"/>
<polygon fill="black" stroke="black" points="1381.69,-2238.21 1378.77,-2228.03 1374.7,-2237.81 1381.69,-2238.21"/>
</g>
<!-- gate_3_11&#45;&gt;expert_3_11 -->
<g id="edge1116" class="edge">
<title>gate_3_11&#45;&gt;expert_3_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1391.23,-2263.9C1391.31,-2255.23 1391.17,-2246.41 1390.82,-2238.27"/>
<polygon fill="red" stroke="red" points="1394.3,-2237.81 1390.23,-2228.03 1387.31,-2238.21 1394.3,-2237.81"/>
</g>
<!-- aggregate_3_11 -->
<g id="node248" class="node">
<title>aggregate_3_11</title>
<polygon fill="lightyellow" stroke="black" points="1532.51,-2139.98 1297.06,-2139.98 1236.49,-2035.98 1471.94,-2035.98 1532.51,-2139.98"/>
<text text-anchor="middle" x="1384.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L11</text>
<text text-anchor="middle" x="1384.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1384.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1384.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_11&#45;&gt;aggregate_3_11 -->
<g id="edge243" class="edge">
<title>expert_3_11&#45;&gt;aggregate_3_11</title>
<path fill="none" stroke="black" d="M1384.5,-2175.85C1384.5,-2168.16 1384.5,-2159.35 1384.5,-2150.35"/>
<polygon fill="black" stroke="black" points="1388,-2150.16 1384.5,-2140.16 1381,-2150.16 1388,-2150.16"/>
</g>
<!-- attention_3_12 -->
<g id="node249" class="node">
<title>attention_3_12</title>
<polygon fill="lightgreen" stroke="black" points="1468.5,-1999.98 1300.5,-1999.98 1300.5,-1947.98 1468.5,-1947.98 1468.5,-1999.98"/>
<text text-anchor="middle" x="1384.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_3_L12</text>
<text text-anchor="middle" x="1384.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1384.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1384.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_11&#45;&gt;attention_3_12 -->
<g id="edge244" class="edge">
<title>aggregate_3_11&#45;&gt;attention_3_12</title>
<path fill="none" stroke="black" d="M1384.5,-2035.9C1384.5,-2027.23 1384.5,-2018.41 1384.5,-2010.27"/>
<polygon fill="black" stroke="black" points="1388,-2010.03 1384.5,-2000.03 1381,-2010.03 1388,-2010.03"/>
</g>
<!-- gate_3_12 -->
<g id="node250" class="node">
<title>gate_3_12</title>
<polygon fill="lightyellow" stroke="black" points="1537.51,-1911.98 1302.06,-1911.98 1241.49,-1807.98 1476.94,-1807.98 1537.51,-1911.98"/>
<text text-anchor="middle" x="1389.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_3_L12</text>
<text text-anchor="middle" x="1389.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1389.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1389.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_12&#45;&gt;gate_3_12 -->
<g id="edge245" class="edge">
<title>attention_3_12&#45;&gt;gate_3_12</title>
<path fill="none" stroke="black" d="M1385.62,-1947.85C1385.97,-1940.16 1386.36,-1931.35 1386.76,-1922.35"/>
<polygon fill="black" stroke="black" points="1390.27,-1922.31 1387.22,-1912.16 1383.27,-1921.99 1390.27,-1922.31"/>
</g>
<!-- expert_3_12 -->
<g id="node251" class="node">
<title>expert_3_12</title>
<polygon fill="lightgreen" stroke="black" points="1464,-1771.98 1315,-1771.98 1315,-1719.98 1464,-1719.98 1464,-1771.98"/>
<text text-anchor="middle" x="1389.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_3_L12</text>
<text text-anchor="middle" x="1389.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1389.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1389.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_12&#45;&gt;expert_3_12 -->
<g id="edge246" class="edge">
<title>gate_3_12&#45;&gt;expert_3_12</title>
<path fill="none" stroke="black" d="M1382.77,-1807.9C1382.69,-1799.23 1382.83,-1790.41 1383.18,-1782.27"/>
<polygon fill="black" stroke="black" points="1386.69,-1782.21 1383.77,-1772.03 1379.7,-1781.81 1386.69,-1782.21"/>
</g>
<!-- gate_3_12&#45;&gt;expert_3_12 -->
<g id="edge1117" class="edge">
<title>gate_3_12&#45;&gt;expert_3_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1396.23,-1807.9C1396.31,-1799.23 1396.17,-1790.41 1395.82,-1782.27"/>
<polygon fill="red" stroke="red" points="1399.3,-1781.81 1395.23,-1772.03 1392.31,-1782.21 1399.3,-1781.81"/>
</g>
<!-- aggregate_3_12 -->
<g id="node252" class="node">
<title>aggregate_3_12</title>
<polygon fill="lightyellow" stroke="black" points="1540.51,-1683.98 1305.06,-1683.98 1244.49,-1579.98 1479.94,-1579.98 1540.51,-1683.98"/>
<text text-anchor="middle" x="1392.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L12</text>
<text text-anchor="middle" x="1392.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1392.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1392.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_12&#45;&gt;aggregate_3_12 -->
<g id="edge247" class="edge">
<title>expert_3_12&#45;&gt;aggregate_3_12</title>
<path fill="none" stroke="black" d="M1390.17,-1719.85C1390.38,-1712.16 1390.62,-1703.35 1390.86,-1694.35"/>
<polygon fill="black" stroke="black" points="1394.36,-1694.25 1391.13,-1684.16 1387.36,-1694.06 1394.36,-1694.25"/>
</g>
<!-- attention_3_13 -->
<g id="node253" class="node">
<title>attention_3_13</title>
<polygon fill="lightgreen" stroke="black" points="1477.5,-1543.98 1309.5,-1543.98 1309.5,-1491.98 1477.5,-1491.98 1477.5,-1543.98"/>
<text text-anchor="middle" x="1393.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_3_L13</text>
<text text-anchor="middle" x="1393.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1393.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1393.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_12&#45;&gt;attention_3_13 -->
<g id="edge248" class="edge">
<title>aggregate_3_12&#45;&gt;attention_3_13</title>
<path fill="none" stroke="black" d="M1392.96,-1579.9C1393.03,-1571.23 1393.11,-1562.41 1393.19,-1554.27"/>
<polygon fill="black" stroke="black" points="1396.69,-1554.06 1393.28,-1544.03 1389.69,-1553.99 1396.69,-1554.06"/>
</g>
<!-- gate_3_13 -->
<g id="node254" class="node">
<title>gate_3_13</title>
<polygon fill="lightyellow" stroke="black" points="1542.51,-1455.98 1307.06,-1455.98 1246.49,-1351.98 1481.94,-1351.98 1542.51,-1455.98"/>
<text text-anchor="middle" x="1394.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_3_L13</text>
<text text-anchor="middle" x="1394.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1394.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1394.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_13&#45;&gt;gate_3_13 -->
<g id="edge249" class="edge">
<title>attention_3_13&#45;&gt;gate_3_13</title>
<path fill="none" stroke="black" d="M1393.73,-1491.85C1393.79,-1484.16 1393.87,-1475.35 1393.95,-1466.35"/>
<polygon fill="black" stroke="black" points="1397.45,-1466.19 1394.04,-1456.16 1390.45,-1466.13 1397.45,-1466.19"/>
</g>
<!-- expert_3_13 -->
<g id="node255" class="node">
<title>expert_3_13</title>
<polygon fill="lightgreen" stroke="black" points="1469,-1315.98 1320,-1315.98 1320,-1263.98 1469,-1263.98 1469,-1315.98"/>
<text text-anchor="middle" x="1394.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_3_L13</text>
<text text-anchor="middle" x="1394.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1394.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1394.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_13&#45;&gt;expert_3_13 -->
<g id="edge250" class="edge">
<title>gate_3_13&#45;&gt;expert_3_13</title>
<path fill="none" stroke="black" d="M1387.77,-1351.9C1387.69,-1343.23 1387.83,-1334.41 1388.18,-1326.27"/>
<polygon fill="black" stroke="black" points="1391.69,-1326.21 1388.77,-1316.03 1384.7,-1325.81 1391.69,-1326.21"/>
</g>
<!-- gate_3_13&#45;&gt;expert_3_13 -->
<g id="edge1118" class="edge">
<title>gate_3_13&#45;&gt;expert_3_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1401.23,-1351.9C1401.31,-1343.23 1401.17,-1334.41 1400.82,-1326.27"/>
<polygon fill="red" stroke="red" points="1404.3,-1325.81 1400.23,-1316.03 1397.31,-1326.21 1404.3,-1325.81"/>
</g>
<!-- aggregate_3_13 -->
<g id="node256" class="node">
<title>aggregate_3_13</title>
<polygon fill="lightyellow" stroke="black" points="1543.51,-1227.98 1308.06,-1227.98 1247.49,-1123.98 1482.94,-1123.98 1543.51,-1227.98"/>
<text text-anchor="middle" x="1395.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L13</text>
<text text-anchor="middle" x="1395.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1395.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1395.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_13&#45;&gt;aggregate_3_13 -->
<g id="edge251" class="edge">
<title>expert_3_13&#45;&gt;aggregate_3_13</title>
<path fill="none" stroke="black" d="M1394.73,-1263.85C1394.79,-1256.16 1394.87,-1247.35 1394.95,-1238.35"/>
<polygon fill="black" stroke="black" points="1398.45,-1238.19 1395.04,-1228.16 1391.45,-1238.13 1398.45,-1238.19"/>
</g>
<!-- attention_3_14 -->
<g id="node257" class="node">
<title>attention_3_14</title>
<polygon fill="lightgreen" stroke="black" points="1479.5,-1087.98 1311.5,-1087.98 1311.5,-1035.98 1479.5,-1035.98 1479.5,-1087.98"/>
<text text-anchor="middle" x="1395.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_3_L14</text>
<text text-anchor="middle" x="1395.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1395.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1395.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_13&#45;&gt;attention_3_14 -->
<g id="edge252" class="edge">
<title>aggregate_3_13&#45;&gt;attention_3_14</title>
<path fill="none" stroke="black" d="M1395.5,-1123.9C1395.5,-1115.23 1395.5,-1106.41 1395.5,-1098.27"/>
<polygon fill="black" stroke="black" points="1399,-1098.03 1395.5,-1088.03 1392,-1098.03 1399,-1098.03"/>
</g>
<!-- gate_3_14 -->
<g id="node258" class="node">
<title>gate_3_14</title>
<polygon fill="lightyellow" stroke="black" points="1543.51,-999.98 1308.06,-999.98 1247.49,-895.98 1482.94,-895.98 1543.51,-999.98"/>
<text text-anchor="middle" x="1395.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_3_L14</text>
<text text-anchor="middle" x="1395.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1395.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1395.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_14&#45;&gt;gate_3_14 -->
<g id="edge253" class="edge">
<title>attention_3_14&#45;&gt;gate_3_14</title>
<path fill="none" stroke="black" d="M1395.5,-1035.85C1395.5,-1028.16 1395.5,-1019.35 1395.5,-1010.35"/>
<polygon fill="black" stroke="black" points="1399,-1010.16 1395.5,-1000.16 1392,-1010.16 1399,-1010.16"/>
</g>
<!-- expert_3_14 -->
<g id="node259" class="node">
<title>expert_3_14</title>
<polygon fill="lightgreen" stroke="black" points="1470,-859.98 1321,-859.98 1321,-807.98 1470,-807.98 1470,-859.98"/>
<text text-anchor="middle" x="1395.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_3_L14</text>
<text text-anchor="middle" x="1395.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1395.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1395.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_14&#45;&gt;expert_3_14 -->
<g id="edge254" class="edge">
<title>gate_3_14&#45;&gt;expert_3_14</title>
<path fill="none" stroke="black" d="M1388.77,-895.9C1388.69,-887.23 1388.83,-878.41 1389.18,-870.27"/>
<polygon fill="black" stroke="black" points="1392.69,-870.21 1389.77,-860.03 1385.7,-869.81 1392.69,-870.21"/>
</g>
<!-- gate_3_14&#45;&gt;expert_3_14 -->
<g id="edge1119" class="edge">
<title>gate_3_14&#45;&gt;expert_3_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1402.23,-895.9C1402.31,-887.23 1402.17,-878.41 1401.82,-870.27"/>
<polygon fill="red" stroke="red" points="1405.3,-869.81 1401.23,-860.03 1398.31,-870.21 1405.3,-869.81"/>
</g>
<!-- aggregate_3_14 -->
<g id="node260" class="node">
<title>aggregate_3_14</title>
<polygon fill="lightyellow" stroke="black" points="1543.51,-771.98 1308.06,-771.98 1247.49,-667.98 1482.94,-667.98 1543.51,-771.98"/>
<text text-anchor="middle" x="1395.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L14</text>
<text text-anchor="middle" x="1395.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1395.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1395.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_14&#45;&gt;aggregate_3_14 -->
<g id="edge255" class="edge">
<title>expert_3_14&#45;&gt;aggregate_3_14</title>
<path fill="none" stroke="black" d="M1395.5,-807.85C1395.5,-800.16 1395.5,-791.35 1395.5,-782.35"/>
<polygon fill="black" stroke="black" points="1399,-782.16 1395.5,-772.16 1392,-782.16 1399,-782.16"/>
</g>
<!-- attention_3_15 -->
<g id="node261" class="node">
<title>attention_3_15</title>
<polygon fill="lightgreen" stroke="black" points="1480.5,-631.98 1312.5,-631.98 1312.5,-579.98 1480.5,-579.98 1480.5,-631.98"/>
<text text-anchor="middle" x="1396.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_3_L15</text>
<text text-anchor="middle" x="1396.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1396.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1396.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_3_14&#45;&gt;attention_3_15 -->
<g id="edge256" class="edge">
<title>aggregate_3_14&#45;&gt;attention_3_15</title>
<path fill="none" stroke="black" d="M1395.96,-667.9C1396.03,-659.23 1396.11,-650.41 1396.19,-642.27"/>
<polygon fill="black" stroke="black" points="1399.69,-642.06 1396.28,-632.03 1392.69,-641.99 1399.69,-642.06"/>
</g>
<!-- gate_3_15 -->
<g id="node262" class="node">
<title>gate_3_15</title>
<polygon fill="lightyellow" stroke="black" points="1544.51,-543.98 1309.06,-543.98 1248.49,-439.98 1483.94,-439.98 1544.51,-543.98"/>
<text text-anchor="middle" x="1396.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_3_L15</text>
<text text-anchor="middle" x="1396.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1396.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1396.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_3_15&#45;&gt;gate_3_15 -->
<g id="edge257" class="edge">
<title>attention_3_15&#45;&gt;gate_3_15</title>
<path fill="none" stroke="black" d="M1396.5,-579.85C1396.5,-572.16 1396.5,-563.35 1396.5,-554.35"/>
<polygon fill="black" stroke="black" points="1400,-554.16 1396.5,-544.16 1393,-554.16 1400,-554.16"/>
</g>
<!-- expert_3_15 -->
<g id="node263" class="node">
<title>expert_3_15</title>
<polygon fill="lightgreen" stroke="black" points="1471,-403.98 1322,-403.98 1322,-351.98 1471,-351.98 1471,-403.98"/>
<text text-anchor="middle" x="1396.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_3_L15</text>
<text text-anchor="middle" x="1396.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=3</text>
<text text-anchor="middle" x="1396.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1396.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_3_15&#45;&gt;expert_3_15 -->
<g id="edge258" class="edge">
<title>gate_3_15&#45;&gt;expert_3_15</title>
<path fill="none" stroke="black" d="M1389.77,-439.9C1389.69,-431.23 1389.83,-422.41 1390.18,-414.27"/>
<polygon fill="black" stroke="black" points="1393.69,-414.21 1390.77,-404.03 1386.7,-413.81 1393.69,-414.21"/>
</g>
<!-- gate_3_15&#45;&gt;expert_3_15 -->
<g id="edge1120" class="edge">
<title>gate_3_15&#45;&gt;expert_3_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1403.23,-439.9C1403.31,-431.23 1403.17,-422.41 1402.82,-414.27"/>
<polygon fill="red" stroke="red" points="1406.3,-413.81 1402.23,-404.03 1399.31,-414.21 1406.3,-413.81"/>
</g>
<!-- aggregate_3_15 -->
<g id="node264" class="node">
<title>aggregate_3_15</title>
<polygon fill="lightyellow" stroke="black" points="1544.51,-315.98 1309.06,-315.98 1248.49,-211.98 1483.94,-211.98 1544.51,-315.98"/>
<text text-anchor="middle" x="1396.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_3_L15</text>
<text text-anchor="middle" x="1396.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1396.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1396.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_3_15&#45;&gt;aggregate_3_15 -->
<g id="edge259" class="edge">
<title>expert_3_15&#45;&gt;aggregate_3_15</title>
<path fill="none" stroke="black" d="M1396.5,-351.85C1396.5,-344.16 1396.5,-335.35 1396.5,-326.35"/>
<polygon fill="black" stroke="black" points="1400,-326.16 1396.5,-316.16 1393,-326.16 1400,-326.16"/>
</g>
<!-- collect_3 -->
<g id="node265" class="node">
<title>collect_3</title>
<polygon fill="lightyellow" stroke="black" points="1544.51,-175.98 1309.06,-175.98 1248.49,-93.98 1483.94,-93.98 1544.51,-175.98"/>
<text text-anchor="middle" x="1396.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_3</text>
<text text-anchor="middle" x="1396.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1396.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_3_15&#45;&gt;collect_3 -->
<g id="edge260" class="edge">
<title>aggregate_3_15&#45;&gt;collect_3</title>
<path fill="none" stroke="black" d="M1396.5,-211.69C1396.5,-203.27 1396.5,-194.56 1396.5,-186.17"/>
<polygon fill="black" stroke="black" points="1400,-186.14 1396.5,-176.14 1393,-186.14 1400,-186.14"/>
</g>
<!-- collect_3&#45;&gt;output -->
<g id="edge1044" class="edge">
<title>collect_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1493.24,-106.29C1513.34,-101.44 1534.49,-96.99 1554.5,-93.98 1769.55,-61.62 2409.43,-40.94 2684.96,-33.31"/>
<polygon fill="black" stroke="black" points="2685.11,-36.8 2695.01,-33.03 2684.91,-29.81 2685.11,-36.8"/>
</g>
<!-- distribute_4 -->
<g id="node266" class="node">
<title>distribute_4</title>
<polygon fill="lightyellow" stroke="black" points="1843.73,-7589.98 1603.16,-7589.98 1541.27,-7507.98 1781.85,-7507.98 1843.73,-7589.98"/>
<text text-anchor="middle" x="1692.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_4</text>
<text text-anchor="middle" x="1692.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="1692.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_0 -->
<g id="node267" class="node">
<title>attention_4_0</title>
<polygon fill="lightgreen" stroke="black" points="1776.5,-7471.98 1608.5,-7471.98 1608.5,-7419.98 1776.5,-7419.98 1776.5,-7471.98"/>
<text text-anchor="middle" x="1692.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_4_L0</text>
<text text-anchor="middle" x="1692.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1692.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1692.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_4&#45;&gt;attention_4_0 -->
<g id="edge261" class="edge">
<title>distribute_4&#45;&gt;attention_4_0</title>
<path fill="none" stroke="black" d="M1692.5,-7507.77C1692.5,-7499.34 1692.5,-7490.51 1692.5,-7482.27"/>
<polygon fill="black" stroke="black" points="1696,-7482.23 1692.5,-7472.23 1689,-7482.23 1696,-7482.23"/>
</g>
<!-- gate_4_0 -->
<g id="node268" class="node">
<title>gate_4_0</title>
<polygon fill="lightyellow" stroke="black" points="1843.51,-7383.98 1608.06,-7383.98 1547.49,-7279.98 1782.94,-7279.98 1843.51,-7383.98"/>
<text text-anchor="middle" x="1695.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_4_L0</text>
<text text-anchor="middle" x="1695.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1695.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1695.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_0&#45;&gt;gate_4_0 -->
<g id="edge262" class="edge">
<title>attention_4_0&#45;&gt;gate_4_0</title>
<path fill="none" stroke="black" d="M1693.17,-7419.85C1693.38,-7412.16 1693.62,-7403.35 1693.86,-7394.35"/>
<polygon fill="black" stroke="black" points="1697.36,-7394.25 1694.13,-7384.16 1690.36,-7394.06 1697.36,-7394.25"/>
</g>
<!-- expert_4_0 -->
<g id="node269" class="node">
<title>expert_4_0</title>
<polygon fill="lightgreen" stroke="black" points="1770,-7243.98 1621,-7243.98 1621,-7191.98 1770,-7191.98 1770,-7243.98"/>
<text text-anchor="middle" x="1695.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_4_L0</text>
<text text-anchor="middle" x="1695.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1695.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1695.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_0&#45;&gt;expert_4_0 -->
<g id="edge263" class="edge">
<title>gate_4_0&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M1688.77,-7279.9C1688.69,-7271.23 1688.83,-7262.41 1689.18,-7254.27"/>
<polygon fill="black" stroke="black" points="1692.69,-7254.21 1689.77,-7244.03 1685.7,-7253.81 1692.69,-7254.21"/>
</g>
<!-- gate_4_0&#45;&gt;expert_4_0 -->
<g id="edge1121" class="edge">
<title>gate_4_0&#45;&gt;expert_4_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1702.23,-7279.9C1702.31,-7271.23 1702.17,-7262.41 1701.82,-7254.27"/>
<polygon fill="red" stroke="red" points="1705.3,-7253.81 1701.23,-7244.03 1698.31,-7254.21 1705.3,-7253.81"/>
</g>
<!-- aggregate_4_0 -->
<g id="node270" class="node">
<title>aggregate_4_0</title>
<polygon fill="lightyellow" stroke="black" points="1844.51,-7155.98 1609.06,-7155.98 1548.49,-7051.98 1783.94,-7051.98 1844.51,-7155.98"/>
<text text-anchor="middle" x="1696.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L0</text>
<text text-anchor="middle" x="1696.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1696.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1696.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_0&#45;&gt;aggregate_4_0 -->
<g id="edge264" class="edge">
<title>expert_4_0&#45;&gt;aggregate_4_0</title>
<path fill="none" stroke="black" d="M1695.73,-7191.85C1695.79,-7184.16 1695.87,-7175.35 1695.95,-7166.35"/>
<polygon fill="black" stroke="black" points="1699.45,-7166.19 1696.04,-7156.16 1692.45,-7166.13 1699.45,-7166.19"/>
</g>
<!-- attention_4_1 -->
<g id="node271" class="node">
<title>attention_4_1</title>
<polygon fill="lightgreen" stroke="black" points="1780.5,-7015.98 1612.5,-7015.98 1612.5,-6963.98 1780.5,-6963.98 1780.5,-7015.98"/>
<text text-anchor="middle" x="1696.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_4_L1</text>
<text text-anchor="middle" x="1696.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1696.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1696.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_0&#45;&gt;attention_4_1 -->
<g id="edge265" class="edge">
<title>aggregate_4_0&#45;&gt;attention_4_1</title>
<path fill="none" stroke="black" d="M1696.5,-7051.9C1696.5,-7043.23 1696.5,-7034.41 1696.5,-7026.27"/>
<polygon fill="black" stroke="black" points="1700,-7026.03 1696.5,-7016.03 1693,-7026.03 1700,-7026.03"/>
</g>
<!-- gate_4_1 -->
<g id="node272" class="node">
<title>gate_4_1</title>
<polygon fill="lightyellow" stroke="black" points="1845.51,-6927.98 1610.06,-6927.98 1549.49,-6823.98 1784.94,-6823.98 1845.51,-6927.98"/>
<text text-anchor="middle" x="1697.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_4_L1</text>
<text text-anchor="middle" x="1697.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1697.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1697.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_1&#45;&gt;gate_4_1 -->
<g id="edge266" class="edge">
<title>attention_4_1&#45;&gt;gate_4_1</title>
<path fill="none" stroke="black" d="M1696.73,-6963.85C1696.79,-6956.16 1696.87,-6947.35 1696.95,-6938.35"/>
<polygon fill="black" stroke="black" points="1700.45,-6938.19 1697.04,-6928.16 1693.45,-6938.13 1700.45,-6938.19"/>
</g>
<!-- expert_4_1 -->
<g id="node273" class="node">
<title>expert_4_1</title>
<polygon fill="lightgreen" stroke="black" points="1772,-6787.98 1623,-6787.98 1623,-6735.98 1772,-6735.98 1772,-6787.98"/>
<text text-anchor="middle" x="1697.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_4_L1</text>
<text text-anchor="middle" x="1697.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1697.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1697.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_1&#45;&gt;expert_4_1 -->
<g id="edge267" class="edge">
<title>gate_4_1&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M1690.77,-6823.9C1690.69,-6815.23 1690.83,-6806.41 1691.18,-6798.27"/>
<polygon fill="black" stroke="black" points="1694.69,-6798.21 1691.77,-6788.03 1687.7,-6797.81 1694.69,-6798.21"/>
</g>
<!-- gate_4_1&#45;&gt;expert_4_1 -->
<g id="edge1122" class="edge">
<title>gate_4_1&#45;&gt;expert_4_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1704.23,-6823.9C1704.31,-6815.23 1704.17,-6806.41 1703.82,-6798.27"/>
<polygon fill="red" stroke="red" points="1707.3,-6797.81 1703.23,-6788.03 1700.31,-6798.21 1707.3,-6797.81"/>
</g>
<!-- aggregate_4_1 -->
<g id="node274" class="node">
<title>aggregate_4_1</title>
<polygon fill="lightyellow" stroke="black" points="1846.51,-6699.98 1611.06,-6699.98 1550.49,-6595.98 1785.94,-6595.98 1846.51,-6699.98"/>
<text text-anchor="middle" x="1698.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L1</text>
<text text-anchor="middle" x="1698.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1698.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1698.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_1&#45;&gt;aggregate_4_1 -->
<g id="edge268" class="edge">
<title>expert_4_1&#45;&gt;aggregate_4_1</title>
<path fill="none" stroke="black" d="M1697.73,-6735.85C1697.79,-6728.16 1697.87,-6719.35 1697.95,-6710.35"/>
<polygon fill="black" stroke="black" points="1701.45,-6710.19 1698.04,-6700.16 1694.45,-6710.13 1701.45,-6710.19"/>
</g>
<!-- attention_4_2 -->
<g id="node275" class="node">
<title>attention_4_2</title>
<polygon fill="lightgreen" stroke="black" points="1782.5,-6559.98 1614.5,-6559.98 1614.5,-6507.98 1782.5,-6507.98 1782.5,-6559.98"/>
<text text-anchor="middle" x="1698.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_4_L2</text>
<text text-anchor="middle" x="1698.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1698.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1698.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_1&#45;&gt;attention_4_2 -->
<g id="edge269" class="edge">
<title>aggregate_4_1&#45;&gt;attention_4_2</title>
<path fill="none" stroke="black" d="M1698.5,-6595.9C1698.5,-6587.23 1698.5,-6578.41 1698.5,-6570.27"/>
<polygon fill="black" stroke="black" points="1702,-6570.03 1698.5,-6560.03 1695,-6570.03 1702,-6570.03"/>
</g>
<!-- gate_4_2 -->
<g id="node276" class="node">
<title>gate_4_2</title>
<polygon fill="lightyellow" stroke="black" points="1846.51,-6471.98 1611.06,-6471.98 1550.49,-6367.98 1785.94,-6367.98 1846.51,-6471.98"/>
<text text-anchor="middle" x="1698.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_4_L2</text>
<text text-anchor="middle" x="1698.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1698.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1698.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_2&#45;&gt;gate_4_2 -->
<g id="edge270" class="edge">
<title>attention_4_2&#45;&gt;gate_4_2</title>
<path fill="none" stroke="black" d="M1698.5,-6507.85C1698.5,-6500.16 1698.5,-6491.35 1698.5,-6482.35"/>
<polygon fill="black" stroke="black" points="1702,-6482.16 1698.5,-6472.16 1695,-6482.16 1702,-6482.16"/>
</g>
<!-- expert_4_2 -->
<g id="node277" class="node">
<title>expert_4_2</title>
<polygon fill="lightgreen" stroke="black" points="1773,-6331.98 1624,-6331.98 1624,-6279.98 1773,-6279.98 1773,-6331.98"/>
<text text-anchor="middle" x="1698.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_4_L2</text>
<text text-anchor="middle" x="1698.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1698.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1698.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_2&#45;&gt;expert_4_2 -->
<g id="edge271" class="edge">
<title>gate_4_2&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M1691.77,-6367.9C1691.69,-6359.23 1691.83,-6350.41 1692.18,-6342.27"/>
<polygon fill="black" stroke="black" points="1695.69,-6342.21 1692.77,-6332.03 1688.7,-6341.81 1695.69,-6342.21"/>
</g>
<!-- gate_4_2&#45;&gt;expert_4_2 -->
<g id="edge1123" class="edge">
<title>gate_4_2&#45;&gt;expert_4_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1705.23,-6367.9C1705.31,-6359.23 1705.17,-6350.41 1704.82,-6342.27"/>
<polygon fill="red" stroke="red" points="1708.3,-6341.81 1704.23,-6332.03 1701.31,-6342.21 1708.3,-6341.81"/>
</g>
<!-- aggregate_4_2 -->
<g id="node278" class="node">
<title>aggregate_4_2</title>
<polygon fill="lightyellow" stroke="black" points="1846.51,-6243.98 1611.06,-6243.98 1550.49,-6139.98 1785.94,-6139.98 1846.51,-6243.98"/>
<text text-anchor="middle" x="1698.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L2</text>
<text text-anchor="middle" x="1698.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1698.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1698.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_2&#45;&gt;aggregate_4_2 -->
<g id="edge272" class="edge">
<title>expert_4_2&#45;&gt;aggregate_4_2</title>
<path fill="none" stroke="black" d="M1698.5,-6279.85C1698.5,-6272.16 1698.5,-6263.35 1698.5,-6254.35"/>
<polygon fill="black" stroke="black" points="1702,-6254.16 1698.5,-6244.16 1695,-6254.16 1702,-6254.16"/>
</g>
<!-- attention_4_3 -->
<g id="node279" class="node">
<title>attention_4_3</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-6103.98 1615.5,-6103.98 1615.5,-6051.98 1783.5,-6051.98 1783.5,-6103.98"/>
<text text-anchor="middle" x="1699.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_4_L3</text>
<text text-anchor="middle" x="1699.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_2&#45;&gt;attention_4_3 -->
<g id="edge273" class="edge">
<title>aggregate_4_2&#45;&gt;attention_4_3</title>
<path fill="none" stroke="black" d="M1698.96,-6139.9C1699.03,-6131.23 1699.11,-6122.41 1699.19,-6114.27"/>
<polygon fill="black" stroke="black" points="1702.69,-6114.06 1699.28,-6104.03 1695.69,-6113.99 1702.69,-6114.06"/>
</g>
<!-- gate_4_3 -->
<g id="node280" class="node">
<title>gate_4_3</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-6015.98 1612.06,-6015.98 1551.49,-5911.98 1786.94,-5911.98 1847.51,-6015.98"/>
<text text-anchor="middle" x="1699.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_4_L3</text>
<text text-anchor="middle" x="1699.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_3&#45;&gt;gate_4_3 -->
<g id="edge274" class="edge">
<title>attention_4_3&#45;&gt;gate_4_3</title>
<path fill="none" stroke="black" d="M1699.5,-6051.85C1699.5,-6044.16 1699.5,-6035.35 1699.5,-6026.35"/>
<polygon fill="black" stroke="black" points="1703,-6026.16 1699.5,-6016.16 1696,-6026.16 1703,-6026.16"/>
</g>
<!-- expert_4_3 -->
<g id="node281" class="node">
<title>expert_4_3</title>
<polygon fill="lightgreen" stroke="black" points="1774,-5875.98 1625,-5875.98 1625,-5823.98 1774,-5823.98 1774,-5875.98"/>
<text text-anchor="middle" x="1699.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_4_L3</text>
<text text-anchor="middle" x="1699.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_3&#45;&gt;expert_4_3 -->
<g id="edge275" class="edge">
<title>gate_4_3&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M1692.77,-5911.9C1692.69,-5903.23 1692.83,-5894.41 1693.18,-5886.27"/>
<polygon fill="black" stroke="black" points="1696.69,-5886.21 1693.77,-5876.03 1689.7,-5885.81 1696.69,-5886.21"/>
</g>
<!-- gate_4_3&#45;&gt;expert_4_3 -->
<g id="edge1124" class="edge">
<title>gate_4_3&#45;&gt;expert_4_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-5911.9C1706.31,-5903.23 1706.17,-5894.41 1705.82,-5886.27"/>
<polygon fill="red" stroke="red" points="1709.3,-5885.81 1705.23,-5876.03 1702.31,-5886.21 1709.3,-5885.81"/>
</g>
<!-- aggregate_4_3 -->
<g id="node282" class="node">
<title>aggregate_4_3</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-5787.98 1612.06,-5787.98 1551.49,-5683.98 1786.94,-5683.98 1847.51,-5787.98"/>
<text text-anchor="middle" x="1699.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L3</text>
<text text-anchor="middle" x="1699.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_3&#45;&gt;aggregate_4_3 -->
<g id="edge276" class="edge">
<title>expert_4_3&#45;&gt;aggregate_4_3</title>
<path fill="none" stroke="black" d="M1699.5,-5823.85C1699.5,-5816.16 1699.5,-5807.35 1699.5,-5798.35"/>
<polygon fill="black" stroke="black" points="1703,-5798.16 1699.5,-5788.16 1696,-5798.16 1703,-5798.16"/>
</g>
<!-- attention_4_4 -->
<g id="node283" class="node">
<title>attention_4_4</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-5647.98 1615.5,-5647.98 1615.5,-5595.98 1783.5,-5595.98 1783.5,-5647.98"/>
<text text-anchor="middle" x="1699.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_4_L4</text>
<text text-anchor="middle" x="1699.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_3&#45;&gt;attention_4_4 -->
<g id="edge277" class="edge">
<title>aggregate_4_3&#45;&gt;attention_4_4</title>
<path fill="none" stroke="black" d="M1699.5,-5683.9C1699.5,-5675.23 1699.5,-5666.41 1699.5,-5658.27"/>
<polygon fill="black" stroke="black" points="1703,-5658.03 1699.5,-5648.03 1696,-5658.03 1703,-5658.03"/>
</g>
<!-- gate_4_4 -->
<g id="node284" class="node">
<title>gate_4_4</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-5559.98 1612.06,-5559.98 1551.49,-5455.98 1786.94,-5455.98 1847.51,-5559.98"/>
<text text-anchor="middle" x="1699.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_4_L4</text>
<text text-anchor="middle" x="1699.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_4&#45;&gt;gate_4_4 -->
<g id="edge278" class="edge">
<title>attention_4_4&#45;&gt;gate_4_4</title>
<path fill="none" stroke="black" d="M1699.5,-5595.85C1699.5,-5588.16 1699.5,-5579.35 1699.5,-5570.35"/>
<polygon fill="black" stroke="black" points="1703,-5570.16 1699.5,-5560.16 1696,-5570.16 1703,-5570.16"/>
</g>
<!-- expert_4_4 -->
<g id="node285" class="node">
<title>expert_4_4</title>
<polygon fill="lightgreen" stroke="black" points="1774,-5419.98 1625,-5419.98 1625,-5367.98 1774,-5367.98 1774,-5419.98"/>
<text text-anchor="middle" x="1699.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_4_L4</text>
<text text-anchor="middle" x="1699.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_4&#45;&gt;expert_4_4 -->
<g id="edge279" class="edge">
<title>gate_4_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M1692.77,-5455.9C1692.69,-5447.23 1692.83,-5438.41 1693.18,-5430.27"/>
<polygon fill="black" stroke="black" points="1696.69,-5430.21 1693.77,-5420.03 1689.7,-5429.81 1696.69,-5430.21"/>
</g>
<!-- gate_4_4&#45;&gt;expert_4_4 -->
<g id="edge1125" class="edge">
<title>gate_4_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-5455.9C1706.31,-5447.23 1706.17,-5438.41 1705.82,-5430.27"/>
<polygon fill="red" stroke="red" points="1709.3,-5429.81 1705.23,-5420.03 1702.31,-5430.21 1709.3,-5429.81"/>
</g>
<!-- aggregate_4_4 -->
<g id="node286" class="node">
<title>aggregate_4_4</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-5331.98 1612.06,-5331.98 1551.49,-5227.98 1786.94,-5227.98 1847.51,-5331.98"/>
<text text-anchor="middle" x="1699.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L4</text>
<text text-anchor="middle" x="1699.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_4&#45;&gt;aggregate_4_4 -->
<g id="edge280" class="edge">
<title>expert_4_4&#45;&gt;aggregate_4_4</title>
<path fill="none" stroke="black" d="M1699.5,-5367.85C1699.5,-5360.16 1699.5,-5351.35 1699.5,-5342.35"/>
<polygon fill="black" stroke="black" points="1703,-5342.16 1699.5,-5332.16 1696,-5342.16 1703,-5342.16"/>
</g>
<!-- attention_4_5 -->
<g id="node287" class="node">
<title>attention_4_5</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-5191.98 1615.5,-5191.98 1615.5,-5139.98 1783.5,-5139.98 1783.5,-5191.98"/>
<text text-anchor="middle" x="1699.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_4_L5</text>
<text text-anchor="middle" x="1699.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_4&#45;&gt;attention_4_5 -->
<g id="edge281" class="edge">
<title>aggregate_4_4&#45;&gt;attention_4_5</title>
<path fill="none" stroke="black" d="M1699.5,-5227.9C1699.5,-5219.23 1699.5,-5210.41 1699.5,-5202.27"/>
<polygon fill="black" stroke="black" points="1703,-5202.03 1699.5,-5192.03 1696,-5202.03 1703,-5202.03"/>
</g>
<!-- gate_4_5 -->
<g id="node288" class="node">
<title>gate_4_5</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-5103.98 1612.06,-5103.98 1551.49,-4999.98 1786.94,-4999.98 1847.51,-5103.98"/>
<text text-anchor="middle" x="1699.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_4_L5</text>
<text text-anchor="middle" x="1699.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_5&#45;&gt;gate_4_5 -->
<g id="edge282" class="edge">
<title>attention_4_5&#45;&gt;gate_4_5</title>
<path fill="none" stroke="black" d="M1699.5,-5139.85C1699.5,-5132.16 1699.5,-5123.35 1699.5,-5114.35"/>
<polygon fill="black" stroke="black" points="1703,-5114.16 1699.5,-5104.16 1696,-5114.16 1703,-5114.16"/>
</g>
<!-- expert_4_5 -->
<g id="node289" class="node">
<title>expert_4_5</title>
<polygon fill="lightgreen" stroke="black" points="1774,-4963.98 1625,-4963.98 1625,-4911.98 1774,-4911.98 1774,-4963.98"/>
<text text-anchor="middle" x="1699.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_4_L5</text>
<text text-anchor="middle" x="1699.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_5&#45;&gt;expert_4_5 -->
<g id="edge283" class="edge">
<title>gate_4_5&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M1692.77,-4999.9C1692.69,-4991.23 1692.83,-4982.41 1693.18,-4974.27"/>
<polygon fill="black" stroke="black" points="1696.69,-4974.21 1693.77,-4964.03 1689.7,-4973.81 1696.69,-4974.21"/>
</g>
<!-- gate_4_5&#45;&gt;expert_4_5 -->
<g id="edge1126" class="edge">
<title>gate_4_5&#45;&gt;expert_4_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-4999.9C1706.31,-4991.23 1706.17,-4982.41 1705.82,-4974.27"/>
<polygon fill="red" stroke="red" points="1709.3,-4973.81 1705.23,-4964.03 1702.31,-4974.21 1709.3,-4973.81"/>
</g>
<!-- aggregate_4_5 -->
<g id="node290" class="node">
<title>aggregate_4_5</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-4875.98 1612.06,-4875.98 1551.49,-4771.98 1786.94,-4771.98 1847.51,-4875.98"/>
<text text-anchor="middle" x="1699.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L5</text>
<text text-anchor="middle" x="1699.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_5&#45;&gt;aggregate_4_5 -->
<g id="edge284" class="edge">
<title>expert_4_5&#45;&gt;aggregate_4_5</title>
<path fill="none" stroke="black" d="M1699.5,-4911.85C1699.5,-4904.16 1699.5,-4895.35 1699.5,-4886.35"/>
<polygon fill="black" stroke="black" points="1703,-4886.16 1699.5,-4876.16 1696,-4886.16 1703,-4886.16"/>
</g>
<!-- attention_4_6 -->
<g id="node291" class="node">
<title>attention_4_6</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-4735.98 1615.5,-4735.98 1615.5,-4683.98 1783.5,-4683.98 1783.5,-4735.98"/>
<text text-anchor="middle" x="1699.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_4_L6</text>
<text text-anchor="middle" x="1699.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_5&#45;&gt;attention_4_6 -->
<g id="edge285" class="edge">
<title>aggregate_4_5&#45;&gt;attention_4_6</title>
<path fill="none" stroke="black" d="M1699.5,-4771.9C1699.5,-4763.23 1699.5,-4754.41 1699.5,-4746.27"/>
<polygon fill="black" stroke="black" points="1703,-4746.03 1699.5,-4736.03 1696,-4746.03 1703,-4746.03"/>
</g>
<!-- gate_4_6 -->
<g id="node292" class="node">
<title>gate_4_6</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-4647.98 1612.06,-4647.98 1551.49,-4543.98 1786.94,-4543.98 1847.51,-4647.98"/>
<text text-anchor="middle" x="1699.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_4_L6</text>
<text text-anchor="middle" x="1699.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_6&#45;&gt;gate_4_6 -->
<g id="edge286" class="edge">
<title>attention_4_6&#45;&gt;gate_4_6</title>
<path fill="none" stroke="black" d="M1699.5,-4683.85C1699.5,-4676.16 1699.5,-4667.35 1699.5,-4658.35"/>
<polygon fill="black" stroke="black" points="1703,-4658.16 1699.5,-4648.16 1696,-4658.16 1703,-4658.16"/>
</g>
<!-- expert_4_6 -->
<g id="node293" class="node">
<title>expert_4_6</title>
<polygon fill="lightgreen" stroke="black" points="1774,-4507.98 1625,-4507.98 1625,-4455.98 1774,-4455.98 1774,-4507.98"/>
<text text-anchor="middle" x="1699.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_4_L6</text>
<text text-anchor="middle" x="1699.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_6&#45;&gt;expert_4_6 -->
<g id="edge287" class="edge">
<title>gate_4_6&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M1692.77,-4543.9C1692.69,-4535.23 1692.83,-4526.41 1693.18,-4518.27"/>
<polygon fill="black" stroke="black" points="1696.69,-4518.21 1693.77,-4508.03 1689.7,-4517.81 1696.69,-4518.21"/>
</g>
<!-- gate_4_6&#45;&gt;expert_4_6 -->
<g id="edge1127" class="edge">
<title>gate_4_6&#45;&gt;expert_4_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-4543.9C1706.31,-4535.23 1706.17,-4526.41 1705.82,-4518.27"/>
<polygon fill="red" stroke="red" points="1709.3,-4517.81 1705.23,-4508.03 1702.31,-4518.21 1709.3,-4517.81"/>
</g>
<!-- aggregate_4_6 -->
<g id="node294" class="node">
<title>aggregate_4_6</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-4419.98 1612.06,-4419.98 1551.49,-4315.98 1786.94,-4315.98 1847.51,-4419.98"/>
<text text-anchor="middle" x="1699.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L6</text>
<text text-anchor="middle" x="1699.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_6&#45;&gt;aggregate_4_6 -->
<g id="edge288" class="edge">
<title>expert_4_6&#45;&gt;aggregate_4_6</title>
<path fill="none" stroke="black" d="M1699.5,-4455.85C1699.5,-4448.16 1699.5,-4439.35 1699.5,-4430.35"/>
<polygon fill="black" stroke="black" points="1703,-4430.16 1699.5,-4420.16 1696,-4430.16 1703,-4430.16"/>
</g>
<!-- attention_4_7 -->
<g id="node295" class="node">
<title>attention_4_7</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-4279.98 1615.5,-4279.98 1615.5,-4227.98 1783.5,-4227.98 1783.5,-4279.98"/>
<text text-anchor="middle" x="1699.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_4_L7</text>
<text text-anchor="middle" x="1699.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_6&#45;&gt;attention_4_7 -->
<g id="edge289" class="edge">
<title>aggregate_4_6&#45;&gt;attention_4_7</title>
<path fill="none" stroke="black" d="M1699.5,-4315.9C1699.5,-4307.23 1699.5,-4298.41 1699.5,-4290.27"/>
<polygon fill="black" stroke="black" points="1703,-4290.03 1699.5,-4280.03 1696,-4290.03 1703,-4290.03"/>
</g>
<!-- gate_4_7 -->
<g id="node296" class="node">
<title>gate_4_7</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-4191.98 1612.06,-4191.98 1551.49,-4087.98 1786.94,-4087.98 1847.51,-4191.98"/>
<text text-anchor="middle" x="1699.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_4_L7</text>
<text text-anchor="middle" x="1699.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_7&#45;&gt;gate_4_7 -->
<g id="edge290" class="edge">
<title>attention_4_7&#45;&gt;gate_4_7</title>
<path fill="none" stroke="black" d="M1699.5,-4227.85C1699.5,-4220.16 1699.5,-4211.35 1699.5,-4202.35"/>
<polygon fill="black" stroke="black" points="1703,-4202.16 1699.5,-4192.16 1696,-4202.16 1703,-4202.16"/>
</g>
<!-- expert_4_7 -->
<g id="node297" class="node">
<title>expert_4_7</title>
<polygon fill="lightgreen" stroke="black" points="1774,-4051.98 1625,-4051.98 1625,-3999.98 1774,-3999.98 1774,-4051.98"/>
<text text-anchor="middle" x="1699.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_4_L7</text>
<text text-anchor="middle" x="1699.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_7&#45;&gt;expert_4_7 -->
<g id="edge291" class="edge">
<title>gate_4_7&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M1692.77,-4087.9C1692.69,-4079.23 1692.83,-4070.41 1693.18,-4062.27"/>
<polygon fill="black" stroke="black" points="1696.69,-4062.21 1693.77,-4052.03 1689.7,-4061.81 1696.69,-4062.21"/>
</g>
<!-- gate_4_7&#45;&gt;expert_4_7 -->
<g id="edge1128" class="edge">
<title>gate_4_7&#45;&gt;expert_4_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-4087.9C1706.31,-4079.23 1706.17,-4070.41 1705.82,-4062.27"/>
<polygon fill="red" stroke="red" points="1709.3,-4061.81 1705.23,-4052.03 1702.31,-4062.21 1709.3,-4061.81"/>
</g>
<!-- aggregate_4_7 -->
<g id="node298" class="node">
<title>aggregate_4_7</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-3963.98 1612.06,-3963.98 1551.49,-3859.98 1786.94,-3859.98 1847.51,-3963.98"/>
<text text-anchor="middle" x="1699.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L7</text>
<text text-anchor="middle" x="1699.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_7&#45;&gt;aggregate_4_7 -->
<g id="edge292" class="edge">
<title>expert_4_7&#45;&gt;aggregate_4_7</title>
<path fill="none" stroke="black" d="M1699.5,-3999.85C1699.5,-3992.16 1699.5,-3983.35 1699.5,-3974.35"/>
<polygon fill="black" stroke="black" points="1703,-3974.16 1699.5,-3964.16 1696,-3974.16 1703,-3974.16"/>
</g>
<!-- attention_4_8 -->
<g id="node299" class="node">
<title>attention_4_8</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-3823.98 1615.5,-3823.98 1615.5,-3771.98 1783.5,-3771.98 1783.5,-3823.98"/>
<text text-anchor="middle" x="1699.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_4_L8</text>
<text text-anchor="middle" x="1699.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_7&#45;&gt;attention_4_8 -->
<g id="edge293" class="edge">
<title>aggregate_4_7&#45;&gt;attention_4_8</title>
<path fill="none" stroke="black" d="M1699.5,-3859.9C1699.5,-3851.23 1699.5,-3842.41 1699.5,-3834.27"/>
<polygon fill="black" stroke="black" points="1703,-3834.03 1699.5,-3824.03 1696,-3834.03 1703,-3834.03"/>
</g>
<!-- gate_4_8 -->
<g id="node300" class="node">
<title>gate_4_8</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-3735.98 1612.06,-3735.98 1551.49,-3631.98 1786.94,-3631.98 1847.51,-3735.98"/>
<text text-anchor="middle" x="1699.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_4_L8</text>
<text text-anchor="middle" x="1699.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_8&#45;&gt;gate_4_8 -->
<g id="edge294" class="edge">
<title>attention_4_8&#45;&gt;gate_4_8</title>
<path fill="none" stroke="black" d="M1699.5,-3771.85C1699.5,-3764.16 1699.5,-3755.35 1699.5,-3746.35"/>
<polygon fill="black" stroke="black" points="1703,-3746.16 1699.5,-3736.16 1696,-3746.16 1703,-3746.16"/>
</g>
<!-- expert_4_8 -->
<g id="node301" class="node">
<title>expert_4_8</title>
<polygon fill="lightgreen" stroke="black" points="1774,-3595.98 1625,-3595.98 1625,-3543.98 1774,-3543.98 1774,-3595.98"/>
<text text-anchor="middle" x="1699.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_4_L8</text>
<text text-anchor="middle" x="1699.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_8&#45;&gt;expert_4_8 -->
<g id="edge295" class="edge">
<title>gate_4_8&#45;&gt;expert_4_8</title>
<path fill="none" stroke="black" d="M1692.77,-3631.9C1692.69,-3623.23 1692.83,-3614.41 1693.18,-3606.27"/>
<polygon fill="black" stroke="black" points="1696.69,-3606.21 1693.77,-3596.03 1689.7,-3605.81 1696.69,-3606.21"/>
</g>
<!-- gate_4_8&#45;&gt;expert_4_8 -->
<g id="edge1129" class="edge">
<title>gate_4_8&#45;&gt;expert_4_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-3631.9C1706.31,-3623.23 1706.17,-3614.41 1705.82,-3606.27"/>
<polygon fill="red" stroke="red" points="1709.3,-3605.81 1705.23,-3596.03 1702.31,-3606.21 1709.3,-3605.81"/>
</g>
<!-- aggregate_4_8 -->
<g id="node302" class="node">
<title>aggregate_4_8</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-3507.98 1612.06,-3507.98 1551.49,-3403.98 1786.94,-3403.98 1847.51,-3507.98"/>
<text text-anchor="middle" x="1699.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L8</text>
<text text-anchor="middle" x="1699.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_8&#45;&gt;aggregate_4_8 -->
<g id="edge296" class="edge">
<title>expert_4_8&#45;&gt;aggregate_4_8</title>
<path fill="none" stroke="black" d="M1699.5,-3543.85C1699.5,-3536.16 1699.5,-3527.35 1699.5,-3518.35"/>
<polygon fill="black" stroke="black" points="1703,-3518.16 1699.5,-3508.16 1696,-3518.16 1703,-3518.16"/>
</g>
<!-- attention_4_9 -->
<g id="node303" class="node">
<title>attention_4_9</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-3367.98 1615.5,-3367.98 1615.5,-3315.98 1783.5,-3315.98 1783.5,-3367.98"/>
<text text-anchor="middle" x="1699.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_4_L9</text>
<text text-anchor="middle" x="1699.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_8&#45;&gt;attention_4_9 -->
<g id="edge297" class="edge">
<title>aggregate_4_8&#45;&gt;attention_4_9</title>
<path fill="none" stroke="black" d="M1699.5,-3403.9C1699.5,-3395.23 1699.5,-3386.41 1699.5,-3378.27"/>
<polygon fill="black" stroke="black" points="1703,-3378.03 1699.5,-3368.03 1696,-3378.03 1703,-3378.03"/>
</g>
<!-- gate_4_9 -->
<g id="node304" class="node">
<title>gate_4_9</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-3279.98 1612.06,-3279.98 1551.49,-3175.98 1786.94,-3175.98 1847.51,-3279.98"/>
<text text-anchor="middle" x="1699.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_4_L9</text>
<text text-anchor="middle" x="1699.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_9&#45;&gt;gate_4_9 -->
<g id="edge298" class="edge">
<title>attention_4_9&#45;&gt;gate_4_9</title>
<path fill="none" stroke="black" d="M1699.5,-3315.85C1699.5,-3308.16 1699.5,-3299.35 1699.5,-3290.35"/>
<polygon fill="black" stroke="black" points="1703,-3290.16 1699.5,-3280.16 1696,-3290.16 1703,-3290.16"/>
</g>
<!-- expert_4_9 -->
<g id="node305" class="node">
<title>expert_4_9</title>
<polygon fill="lightgreen" stroke="black" points="1774,-3139.98 1625,-3139.98 1625,-3087.98 1774,-3087.98 1774,-3139.98"/>
<text text-anchor="middle" x="1699.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_4_L9</text>
<text text-anchor="middle" x="1699.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_9&#45;&gt;expert_4_9 -->
<g id="edge299" class="edge">
<title>gate_4_9&#45;&gt;expert_4_9</title>
<path fill="none" stroke="black" d="M1692.77,-3175.9C1692.69,-3167.23 1692.83,-3158.41 1693.18,-3150.27"/>
<polygon fill="black" stroke="black" points="1696.69,-3150.21 1693.77,-3140.03 1689.7,-3149.81 1696.69,-3150.21"/>
</g>
<!-- gate_4_9&#45;&gt;expert_4_9 -->
<g id="edge1130" class="edge">
<title>gate_4_9&#45;&gt;expert_4_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-3175.9C1706.31,-3167.23 1706.17,-3158.41 1705.82,-3150.27"/>
<polygon fill="red" stroke="red" points="1709.3,-3149.81 1705.23,-3140.03 1702.31,-3150.21 1709.3,-3149.81"/>
</g>
<!-- aggregate_4_9 -->
<g id="node306" class="node">
<title>aggregate_4_9</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-3051.98 1612.06,-3051.98 1551.49,-2947.98 1786.94,-2947.98 1847.51,-3051.98"/>
<text text-anchor="middle" x="1699.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L9</text>
<text text-anchor="middle" x="1699.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_9&#45;&gt;aggregate_4_9 -->
<g id="edge300" class="edge">
<title>expert_4_9&#45;&gt;aggregate_4_9</title>
<path fill="none" stroke="black" d="M1699.5,-3087.85C1699.5,-3080.16 1699.5,-3071.35 1699.5,-3062.35"/>
<polygon fill="black" stroke="black" points="1703,-3062.16 1699.5,-3052.16 1696,-3062.16 1703,-3062.16"/>
</g>
<!-- attention_4_10 -->
<g id="node307" class="node">
<title>attention_4_10</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-2911.98 1615.5,-2911.98 1615.5,-2859.98 1783.5,-2859.98 1783.5,-2911.98"/>
<text text-anchor="middle" x="1699.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_4_L10</text>
<text text-anchor="middle" x="1699.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_9&#45;&gt;attention_4_10 -->
<g id="edge301" class="edge">
<title>aggregate_4_9&#45;&gt;attention_4_10</title>
<path fill="none" stroke="black" d="M1699.5,-2947.9C1699.5,-2939.23 1699.5,-2930.41 1699.5,-2922.27"/>
<polygon fill="black" stroke="black" points="1703,-2922.03 1699.5,-2912.03 1696,-2922.03 1703,-2922.03"/>
</g>
<!-- gate_4_10 -->
<g id="node308" class="node">
<title>gate_4_10</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-2823.98 1612.06,-2823.98 1551.49,-2719.98 1786.94,-2719.98 1847.51,-2823.98"/>
<text text-anchor="middle" x="1699.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_4_L10</text>
<text text-anchor="middle" x="1699.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_10&#45;&gt;gate_4_10 -->
<g id="edge302" class="edge">
<title>attention_4_10&#45;&gt;gate_4_10</title>
<path fill="none" stroke="black" d="M1699.5,-2859.85C1699.5,-2852.16 1699.5,-2843.35 1699.5,-2834.35"/>
<polygon fill="black" stroke="black" points="1703,-2834.16 1699.5,-2824.16 1696,-2834.16 1703,-2834.16"/>
</g>
<!-- expert_4_10 -->
<g id="node309" class="node">
<title>expert_4_10</title>
<polygon fill="lightgreen" stroke="black" points="1774,-2683.98 1625,-2683.98 1625,-2631.98 1774,-2631.98 1774,-2683.98"/>
<text text-anchor="middle" x="1699.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_4_L10</text>
<text text-anchor="middle" x="1699.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_10&#45;&gt;expert_4_10 -->
<g id="edge303" class="edge">
<title>gate_4_10&#45;&gt;expert_4_10</title>
<path fill="none" stroke="black" d="M1692.77,-2719.9C1692.69,-2711.23 1692.83,-2702.41 1693.18,-2694.27"/>
<polygon fill="black" stroke="black" points="1696.69,-2694.21 1693.77,-2684.03 1689.7,-2693.81 1696.69,-2694.21"/>
</g>
<!-- gate_4_10&#45;&gt;expert_4_10 -->
<g id="edge1131" class="edge">
<title>gate_4_10&#45;&gt;expert_4_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-2719.9C1706.31,-2711.23 1706.17,-2702.41 1705.82,-2694.27"/>
<polygon fill="red" stroke="red" points="1709.3,-2693.81 1705.23,-2684.03 1702.31,-2694.21 1709.3,-2693.81"/>
</g>
<!-- aggregate_4_10 -->
<g id="node310" class="node">
<title>aggregate_4_10</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-2595.98 1612.06,-2595.98 1551.49,-2491.98 1786.94,-2491.98 1847.51,-2595.98"/>
<text text-anchor="middle" x="1699.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L10</text>
<text text-anchor="middle" x="1699.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_10&#45;&gt;aggregate_4_10 -->
<g id="edge304" class="edge">
<title>expert_4_10&#45;&gt;aggregate_4_10</title>
<path fill="none" stroke="black" d="M1699.5,-2631.85C1699.5,-2624.16 1699.5,-2615.35 1699.5,-2606.35"/>
<polygon fill="black" stroke="black" points="1703,-2606.16 1699.5,-2596.16 1696,-2606.16 1703,-2606.16"/>
</g>
<!-- attention_4_11 -->
<g id="node311" class="node">
<title>attention_4_11</title>
<polygon fill="lightgreen" stroke="black" points="1783.5,-2455.98 1615.5,-2455.98 1615.5,-2403.98 1783.5,-2403.98 1783.5,-2455.98"/>
<text text-anchor="middle" x="1699.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_4_L11</text>
<text text-anchor="middle" x="1699.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1699.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1699.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_10&#45;&gt;attention_4_11 -->
<g id="edge305" class="edge">
<title>aggregate_4_10&#45;&gt;attention_4_11</title>
<path fill="none" stroke="black" d="M1699.5,-2491.9C1699.5,-2483.23 1699.5,-2474.41 1699.5,-2466.27"/>
<polygon fill="black" stroke="black" points="1703,-2466.03 1699.5,-2456.03 1696,-2466.03 1703,-2466.03"/>
</g>
<!-- gate_4_11 -->
<g id="node312" class="node">
<title>gate_4_11</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-2367.98 1612.06,-2367.98 1551.49,-2263.98 1786.94,-2263.98 1847.51,-2367.98"/>
<text text-anchor="middle" x="1699.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_4_L11</text>
<text text-anchor="middle" x="1699.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1699.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_11&#45;&gt;gate_4_11 -->
<g id="edge306" class="edge">
<title>attention_4_11&#45;&gt;gate_4_11</title>
<path fill="none" stroke="black" d="M1699.5,-2403.85C1699.5,-2396.16 1699.5,-2387.35 1699.5,-2378.35"/>
<polygon fill="black" stroke="black" points="1703,-2378.16 1699.5,-2368.16 1696,-2378.16 1703,-2378.16"/>
</g>
<!-- expert_4_11 -->
<g id="node313" class="node">
<title>expert_4_11</title>
<polygon fill="lightgreen" stroke="black" points="1774,-2227.98 1625,-2227.98 1625,-2175.98 1774,-2175.98 1774,-2227.98"/>
<text text-anchor="middle" x="1699.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_4_L11</text>
<text text-anchor="middle" x="1699.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1699.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1699.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_11&#45;&gt;expert_4_11 -->
<g id="edge307" class="edge">
<title>gate_4_11&#45;&gt;expert_4_11</title>
<path fill="none" stroke="black" d="M1692.77,-2263.9C1692.69,-2255.23 1692.83,-2246.41 1693.18,-2238.27"/>
<polygon fill="black" stroke="black" points="1696.69,-2238.21 1693.77,-2228.03 1689.7,-2237.81 1696.69,-2238.21"/>
</g>
<!-- gate_4_11&#45;&gt;expert_4_11 -->
<g id="edge1132" class="edge">
<title>gate_4_11&#45;&gt;expert_4_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1706.23,-2263.9C1706.31,-2255.23 1706.17,-2246.41 1705.82,-2238.27"/>
<polygon fill="red" stroke="red" points="1709.3,-2237.81 1705.23,-2228.03 1702.31,-2238.21 1709.3,-2237.81"/>
</g>
<!-- aggregate_4_11 -->
<g id="node314" class="node">
<title>aggregate_4_11</title>
<polygon fill="lightyellow" stroke="black" points="1847.51,-2139.98 1612.06,-2139.98 1551.49,-2035.98 1786.94,-2035.98 1847.51,-2139.98"/>
<text text-anchor="middle" x="1699.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L11</text>
<text text-anchor="middle" x="1699.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1699.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1699.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_11&#45;&gt;aggregate_4_11 -->
<g id="edge308" class="edge">
<title>expert_4_11&#45;&gt;aggregate_4_11</title>
<path fill="none" stroke="black" d="M1699.5,-2175.85C1699.5,-2168.16 1699.5,-2159.35 1699.5,-2150.35"/>
<polygon fill="black" stroke="black" points="1703,-2150.16 1699.5,-2140.16 1696,-2150.16 1703,-2150.16"/>
</g>
<!-- attention_4_12 -->
<g id="node315" class="node">
<title>attention_4_12</title>
<polygon fill="lightgreen" stroke="black" points="1786.5,-1999.98 1618.5,-1999.98 1618.5,-1947.98 1786.5,-1947.98 1786.5,-1999.98"/>
<text text-anchor="middle" x="1702.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_4_L12</text>
<text text-anchor="middle" x="1702.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1702.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1702.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_11&#45;&gt;attention_4_12 -->
<g id="edge309" class="edge">
<title>aggregate_4_11&#45;&gt;attention_4_12</title>
<path fill="none" stroke="black" d="M1700.87,-2035.9C1701.1,-2027.23 1701.34,-2018.41 1701.56,-2010.27"/>
<polygon fill="black" stroke="black" points="1705.06,-2010.12 1701.83,-2000.03 1698.06,-2009.93 1705.06,-2010.12"/>
</g>
<!-- gate_4_12 -->
<g id="node316" class="node">
<title>gate_4_12</title>
<polygon fill="lightyellow" stroke="black" points="1853.51,-1911.98 1618.06,-1911.98 1557.49,-1807.98 1792.94,-1807.98 1853.51,-1911.98"/>
<text text-anchor="middle" x="1705.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_4_L12</text>
<text text-anchor="middle" x="1705.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1705.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1705.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_12&#45;&gt;gate_4_12 -->
<g id="edge310" class="edge">
<title>attention_4_12&#45;&gt;gate_4_12</title>
<path fill="none" stroke="black" d="M1703.17,-1947.85C1703.38,-1940.16 1703.62,-1931.35 1703.86,-1922.35"/>
<polygon fill="black" stroke="black" points="1707.36,-1922.25 1704.13,-1912.16 1700.36,-1922.06 1707.36,-1922.25"/>
</g>
<!-- expert_4_12 -->
<g id="node317" class="node">
<title>expert_4_12</title>
<polygon fill="lightgreen" stroke="black" points="1780,-1771.98 1631,-1771.98 1631,-1719.98 1780,-1719.98 1780,-1771.98"/>
<text text-anchor="middle" x="1705.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_4_L12</text>
<text text-anchor="middle" x="1705.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1705.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1705.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_12&#45;&gt;expert_4_12 -->
<g id="edge311" class="edge">
<title>gate_4_12&#45;&gt;expert_4_12</title>
<path fill="none" stroke="black" d="M1698.77,-1807.9C1698.69,-1799.23 1698.83,-1790.41 1699.18,-1782.27"/>
<polygon fill="black" stroke="black" points="1702.69,-1782.21 1699.77,-1772.03 1695.7,-1781.81 1702.69,-1782.21"/>
</g>
<!-- gate_4_12&#45;&gt;expert_4_12 -->
<g id="edge1133" class="edge">
<title>gate_4_12&#45;&gt;expert_4_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1712.23,-1807.9C1712.31,-1799.23 1712.17,-1790.41 1711.82,-1782.27"/>
<polygon fill="red" stroke="red" points="1715.3,-1781.81 1711.23,-1772.03 1708.31,-1782.21 1715.3,-1781.81"/>
</g>
<!-- aggregate_4_12 -->
<g id="node318" class="node">
<title>aggregate_4_12</title>
<polygon fill="lightyellow" stroke="black" points="1856.51,-1683.98 1621.06,-1683.98 1560.49,-1579.98 1795.94,-1579.98 1856.51,-1683.98"/>
<text text-anchor="middle" x="1708.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L12</text>
<text text-anchor="middle" x="1708.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1708.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1708.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_12&#45;&gt;aggregate_4_12 -->
<g id="edge312" class="edge">
<title>expert_4_12&#45;&gt;aggregate_4_12</title>
<path fill="none" stroke="black" d="M1706.17,-1719.85C1706.38,-1712.16 1706.62,-1703.35 1706.86,-1694.35"/>
<polygon fill="black" stroke="black" points="1710.36,-1694.25 1707.13,-1684.16 1703.36,-1694.06 1710.36,-1694.25"/>
</g>
<!-- attention_4_13 -->
<g id="node319" class="node">
<title>attention_4_13</title>
<polygon fill="lightgreen" stroke="black" points="1793.5,-1543.98 1625.5,-1543.98 1625.5,-1491.98 1793.5,-1491.98 1793.5,-1543.98"/>
<text text-anchor="middle" x="1709.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_4_L13</text>
<text text-anchor="middle" x="1709.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1709.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1709.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_12&#45;&gt;attention_4_13 -->
<g id="edge313" class="edge">
<title>aggregate_4_12&#45;&gt;attention_4_13</title>
<path fill="none" stroke="black" d="M1708.96,-1579.9C1709.03,-1571.23 1709.11,-1562.41 1709.19,-1554.27"/>
<polygon fill="black" stroke="black" points="1712.69,-1554.06 1709.28,-1544.03 1705.69,-1553.99 1712.69,-1554.06"/>
</g>
<!-- gate_4_13 -->
<g id="node320" class="node">
<title>gate_4_13</title>
<polygon fill="lightyellow" stroke="black" points="1858.51,-1455.98 1623.06,-1455.98 1562.49,-1351.98 1797.94,-1351.98 1858.51,-1455.98"/>
<text text-anchor="middle" x="1710.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_4_L13</text>
<text text-anchor="middle" x="1710.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1710.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1710.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_13&#45;&gt;gate_4_13 -->
<g id="edge314" class="edge">
<title>attention_4_13&#45;&gt;gate_4_13</title>
<path fill="none" stroke="black" d="M1709.73,-1491.85C1709.79,-1484.16 1709.87,-1475.35 1709.95,-1466.35"/>
<polygon fill="black" stroke="black" points="1713.45,-1466.19 1710.04,-1456.16 1706.45,-1466.13 1713.45,-1466.19"/>
</g>
<!-- expert_4_13 -->
<g id="node321" class="node">
<title>expert_4_13</title>
<polygon fill="lightgreen" stroke="black" points="1785,-1315.98 1636,-1315.98 1636,-1263.98 1785,-1263.98 1785,-1315.98"/>
<text text-anchor="middle" x="1710.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_4_L13</text>
<text text-anchor="middle" x="1710.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1710.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1710.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_13&#45;&gt;expert_4_13 -->
<g id="edge315" class="edge">
<title>gate_4_13&#45;&gt;expert_4_13</title>
<path fill="none" stroke="black" d="M1703.77,-1351.9C1703.69,-1343.23 1703.83,-1334.41 1704.18,-1326.27"/>
<polygon fill="black" stroke="black" points="1707.69,-1326.21 1704.77,-1316.03 1700.7,-1325.81 1707.69,-1326.21"/>
</g>
<!-- gate_4_13&#45;&gt;expert_4_13 -->
<g id="edge1134" class="edge">
<title>gate_4_13&#45;&gt;expert_4_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1717.23,-1351.9C1717.31,-1343.23 1717.17,-1334.41 1716.82,-1326.27"/>
<polygon fill="red" stroke="red" points="1720.3,-1325.81 1716.23,-1316.03 1713.31,-1326.21 1720.3,-1325.81"/>
</g>
<!-- aggregate_4_13 -->
<g id="node322" class="node">
<title>aggregate_4_13</title>
<polygon fill="lightyellow" stroke="black" points="1858.51,-1227.98 1623.06,-1227.98 1562.49,-1123.98 1797.94,-1123.98 1858.51,-1227.98"/>
<text text-anchor="middle" x="1710.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L13</text>
<text text-anchor="middle" x="1710.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1710.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1710.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_13&#45;&gt;aggregate_4_13 -->
<g id="edge316" class="edge">
<title>expert_4_13&#45;&gt;aggregate_4_13</title>
<path fill="none" stroke="black" d="M1710.5,-1263.85C1710.5,-1256.16 1710.5,-1247.35 1710.5,-1238.35"/>
<polygon fill="black" stroke="black" points="1714,-1238.16 1710.5,-1228.16 1707,-1238.16 1714,-1238.16"/>
</g>
<!-- attention_4_14 -->
<g id="node323" class="node">
<title>attention_4_14</title>
<polygon fill="lightgreen" stroke="black" points="1794.5,-1087.98 1626.5,-1087.98 1626.5,-1035.98 1794.5,-1035.98 1794.5,-1087.98"/>
<text text-anchor="middle" x="1710.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_4_L14</text>
<text text-anchor="middle" x="1710.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1710.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1710.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_13&#45;&gt;attention_4_14 -->
<g id="edge317" class="edge">
<title>aggregate_4_13&#45;&gt;attention_4_14</title>
<path fill="none" stroke="black" d="M1710.5,-1123.9C1710.5,-1115.23 1710.5,-1106.41 1710.5,-1098.27"/>
<polygon fill="black" stroke="black" points="1714,-1098.03 1710.5,-1088.03 1707,-1098.03 1714,-1098.03"/>
</g>
<!-- gate_4_14 -->
<g id="node324" class="node">
<title>gate_4_14</title>
<polygon fill="lightyellow" stroke="black" points="1858.51,-999.98 1623.06,-999.98 1562.49,-895.98 1797.94,-895.98 1858.51,-999.98"/>
<text text-anchor="middle" x="1710.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_4_L14</text>
<text text-anchor="middle" x="1710.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1710.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1710.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_14&#45;&gt;gate_4_14 -->
<g id="edge318" class="edge">
<title>attention_4_14&#45;&gt;gate_4_14</title>
<path fill="none" stroke="black" d="M1710.5,-1035.85C1710.5,-1028.16 1710.5,-1019.35 1710.5,-1010.35"/>
<polygon fill="black" stroke="black" points="1714,-1010.16 1710.5,-1000.16 1707,-1010.16 1714,-1010.16"/>
</g>
<!-- expert_4_14 -->
<g id="node325" class="node">
<title>expert_4_14</title>
<polygon fill="lightgreen" stroke="black" points="1785,-859.98 1636,-859.98 1636,-807.98 1785,-807.98 1785,-859.98"/>
<text text-anchor="middle" x="1710.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_4_L14</text>
<text text-anchor="middle" x="1710.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1710.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1710.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_14&#45;&gt;expert_4_14 -->
<g id="edge319" class="edge">
<title>gate_4_14&#45;&gt;expert_4_14</title>
<path fill="none" stroke="black" d="M1703.77,-895.9C1703.69,-887.23 1703.83,-878.41 1704.18,-870.27"/>
<polygon fill="black" stroke="black" points="1707.69,-870.21 1704.77,-860.03 1700.7,-869.81 1707.69,-870.21"/>
</g>
<!-- gate_4_14&#45;&gt;expert_4_14 -->
<g id="edge1135" class="edge">
<title>gate_4_14&#45;&gt;expert_4_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1717.23,-895.9C1717.31,-887.23 1717.17,-878.41 1716.82,-870.27"/>
<polygon fill="red" stroke="red" points="1720.3,-869.81 1716.23,-860.03 1713.31,-870.21 1720.3,-869.81"/>
</g>
<!-- aggregate_4_14 -->
<g id="node326" class="node">
<title>aggregate_4_14</title>
<polygon fill="lightyellow" stroke="black" points="1858.51,-771.98 1623.06,-771.98 1562.49,-667.98 1797.94,-667.98 1858.51,-771.98"/>
<text text-anchor="middle" x="1710.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L14</text>
<text text-anchor="middle" x="1710.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1710.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1710.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_14&#45;&gt;aggregate_4_14 -->
<g id="edge320" class="edge">
<title>expert_4_14&#45;&gt;aggregate_4_14</title>
<path fill="none" stroke="black" d="M1710.5,-807.85C1710.5,-800.16 1710.5,-791.35 1710.5,-782.35"/>
<polygon fill="black" stroke="black" points="1714,-782.16 1710.5,-772.16 1707,-782.16 1714,-782.16"/>
</g>
<!-- attention_4_15 -->
<g id="node327" class="node">
<title>attention_4_15</title>
<polygon fill="lightgreen" stroke="black" points="1794.5,-631.98 1626.5,-631.98 1626.5,-579.98 1794.5,-579.98 1794.5,-631.98"/>
<text text-anchor="middle" x="1710.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_4_L15</text>
<text text-anchor="middle" x="1710.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="1710.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="1710.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_4_14&#45;&gt;attention_4_15 -->
<g id="edge321" class="edge">
<title>aggregate_4_14&#45;&gt;attention_4_15</title>
<path fill="none" stroke="black" d="M1710.5,-667.9C1710.5,-659.23 1710.5,-650.41 1710.5,-642.27"/>
<polygon fill="black" stroke="black" points="1714,-642.03 1710.5,-632.03 1707,-642.03 1714,-642.03"/>
</g>
<!-- gate_4_15 -->
<g id="node328" class="node">
<title>gate_4_15</title>
<polygon fill="lightyellow" stroke="black" points="1859.51,-543.98 1624.06,-543.98 1563.49,-439.98 1798.94,-439.98 1859.51,-543.98"/>
<text text-anchor="middle" x="1711.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_4_L15</text>
<text text-anchor="middle" x="1711.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="1711.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1711.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_4_15&#45;&gt;gate_4_15 -->
<g id="edge322" class="edge">
<title>attention_4_15&#45;&gt;gate_4_15</title>
<path fill="none" stroke="black" d="M1710.73,-579.85C1710.79,-572.16 1710.87,-563.35 1710.95,-554.35"/>
<polygon fill="black" stroke="black" points="1714.45,-554.19 1711.04,-544.16 1707.45,-554.13 1714.45,-554.19"/>
</g>
<!-- expert_4_15 -->
<g id="node329" class="node">
<title>expert_4_15</title>
<polygon fill="lightgreen" stroke="black" points="1786,-403.98 1637,-403.98 1637,-351.98 1786,-351.98 1786,-403.98"/>
<text text-anchor="middle" x="1711.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_4_L15</text>
<text text-anchor="middle" x="1711.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=4</text>
<text text-anchor="middle" x="1711.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1711.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_4_15&#45;&gt;expert_4_15 -->
<g id="edge323" class="edge">
<title>gate_4_15&#45;&gt;expert_4_15</title>
<path fill="none" stroke="black" d="M1704.77,-439.9C1704.69,-431.23 1704.83,-422.41 1705.18,-414.27"/>
<polygon fill="black" stroke="black" points="1708.69,-414.21 1705.77,-404.03 1701.7,-413.81 1708.69,-414.21"/>
</g>
<!-- gate_4_15&#45;&gt;expert_4_15 -->
<g id="edge1136" class="edge">
<title>gate_4_15&#45;&gt;expert_4_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1718.23,-439.9C1718.31,-431.23 1718.17,-422.41 1717.82,-414.27"/>
<polygon fill="red" stroke="red" points="1721.3,-413.81 1717.23,-404.03 1714.31,-414.21 1721.3,-413.81"/>
</g>
<!-- aggregate_4_15 -->
<g id="node330" class="node">
<title>aggregate_4_15</title>
<polygon fill="lightyellow" stroke="black" points="1859.51,-315.98 1624.06,-315.98 1563.49,-211.98 1798.94,-211.98 1859.51,-315.98"/>
<text text-anchor="middle" x="1711.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_4_L15</text>
<text text-anchor="middle" x="1711.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="1711.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="1711.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_4_15&#45;&gt;aggregate_4_15 -->
<g id="edge324" class="edge">
<title>expert_4_15&#45;&gt;aggregate_4_15</title>
<path fill="none" stroke="black" d="M1711.5,-351.85C1711.5,-344.16 1711.5,-335.35 1711.5,-326.35"/>
<polygon fill="black" stroke="black" points="1715,-326.16 1711.5,-316.16 1708,-326.16 1715,-326.16"/>
</g>
<!-- collect_4 -->
<g id="node331" class="node">
<title>collect_4</title>
<polygon fill="lightyellow" stroke="black" points="1859.51,-175.98 1624.06,-175.98 1563.49,-93.98 1798.94,-93.98 1859.51,-175.98"/>
<text text-anchor="middle" x="1711.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_4</text>
<text text-anchor="middle" x="1711.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="1711.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_4_15&#45;&gt;collect_4 -->
<g id="edge325" class="edge">
<title>aggregate_4_15&#45;&gt;collect_4</title>
<path fill="none" stroke="black" d="M1711.5,-211.69C1711.5,-203.27 1711.5,-194.56 1711.5,-186.17"/>
<polygon fill="black" stroke="black" points="1715,-186.14 1711.5,-176.14 1708,-186.14 1715,-186.14"/>
</g>
<!-- collect_4&#45;&gt;output -->
<g id="edge1045" class="edge">
<title>collect_4&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1808.28,-106.56C1828.38,-101.69 1849.52,-97.16 1869.5,-93.98 2158.08,-48.06 2501.41,-35.06 2684.07,-31.4"/>
<polygon fill="black" stroke="black" points="2684.32,-34.9 2694.25,-31.2 2684.19,-27.9 2684.32,-34.9"/>
</g>
<!-- distribute_5 -->
<g id="node332" class="node">
<title>distribute_5</title>
<polygon fill="lightyellow" stroke="black" points="2164.73,-7589.98 1924.16,-7589.98 1862.27,-7507.98 2102.85,-7507.98 2164.73,-7589.98"/>
<text text-anchor="middle" x="2013.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_5</text>
<text text-anchor="middle" x="2013.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="2013.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_0 -->
<g id="node333" class="node">
<title>attention_5_0</title>
<polygon fill="lightgreen" stroke="black" points="2097.5,-7471.98 1929.5,-7471.98 1929.5,-7419.98 2097.5,-7419.98 2097.5,-7471.98"/>
<text text-anchor="middle" x="2013.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_5_L0</text>
<text text-anchor="middle" x="2013.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2013.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2013.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_5&#45;&gt;attention_5_0 -->
<g id="edge326" class="edge">
<title>distribute_5&#45;&gt;attention_5_0</title>
<path fill="none" stroke="black" d="M2013.5,-7507.77C2013.5,-7499.34 2013.5,-7490.51 2013.5,-7482.27"/>
<polygon fill="black" stroke="black" points="2017,-7482.23 2013.5,-7472.23 2010,-7482.23 2017,-7482.23"/>
</g>
<!-- gate_5_0 -->
<g id="node334" class="node">
<title>gate_5_0</title>
<polygon fill="lightyellow" stroke="black" points="2161.51,-7383.98 1926.06,-7383.98 1865.49,-7279.98 2100.94,-7279.98 2161.51,-7383.98"/>
<text text-anchor="middle" x="2013.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_5_L0</text>
<text text-anchor="middle" x="2013.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2013.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2013.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_0&#45;&gt;gate_5_0 -->
<g id="edge327" class="edge">
<title>attention_5_0&#45;&gt;gate_5_0</title>
<path fill="none" stroke="black" d="M2013.5,-7419.85C2013.5,-7412.16 2013.5,-7403.35 2013.5,-7394.35"/>
<polygon fill="black" stroke="black" points="2017,-7394.16 2013.5,-7384.16 2010,-7394.16 2017,-7394.16"/>
</g>
<!-- expert_5_0 -->
<g id="node335" class="node">
<title>expert_5_0</title>
<polygon fill="lightgreen" stroke="black" points="2088,-7243.98 1939,-7243.98 1939,-7191.98 2088,-7191.98 2088,-7243.98"/>
<text text-anchor="middle" x="2013.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_5_L0</text>
<text text-anchor="middle" x="2013.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2013.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2013.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_0&#45;&gt;expert_5_0 -->
<g id="edge328" class="edge">
<title>gate_5_0&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" d="M2006.77,-7279.9C2006.69,-7271.23 2006.83,-7262.41 2007.18,-7254.27"/>
<polygon fill="black" stroke="black" points="2010.69,-7254.21 2007.77,-7244.03 2003.7,-7253.81 2010.69,-7254.21"/>
</g>
<!-- gate_5_0&#45;&gt;expert_5_0 -->
<g id="edge1137" class="edge">
<title>gate_5_0&#45;&gt;expert_5_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2020.23,-7279.9C2020.31,-7271.23 2020.17,-7262.41 2019.82,-7254.27"/>
<polygon fill="red" stroke="red" points="2023.3,-7253.81 2019.23,-7244.03 2016.31,-7254.21 2023.3,-7253.81"/>
</g>
<!-- aggregate_5_0 -->
<g id="node336" class="node">
<title>aggregate_5_0</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-7155.98 1927.06,-7155.98 1866.49,-7051.98 2101.94,-7051.98 2162.51,-7155.98"/>
<text text-anchor="middle" x="2014.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L0</text>
<text text-anchor="middle" x="2014.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_0&#45;&gt;aggregate_5_0 -->
<g id="edge329" class="edge">
<title>expert_5_0&#45;&gt;aggregate_5_0</title>
<path fill="none" stroke="black" d="M2013.73,-7191.85C2013.79,-7184.16 2013.87,-7175.35 2013.95,-7166.35"/>
<polygon fill="black" stroke="black" points="2017.45,-7166.19 2014.04,-7156.16 2010.45,-7166.13 2017.45,-7166.19"/>
</g>
<!-- attention_5_1 -->
<g id="node337" class="node">
<title>attention_5_1</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-7015.98 1930.5,-7015.98 1930.5,-6963.98 2098.5,-6963.98 2098.5,-7015.98"/>
<text text-anchor="middle" x="2014.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_5_L1</text>
<text text-anchor="middle" x="2014.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_0&#45;&gt;attention_5_1 -->
<g id="edge330" class="edge">
<title>aggregate_5_0&#45;&gt;attention_5_1</title>
<path fill="none" stroke="black" d="M2014.5,-7051.9C2014.5,-7043.23 2014.5,-7034.41 2014.5,-7026.27"/>
<polygon fill="black" stroke="black" points="2018,-7026.03 2014.5,-7016.03 2011,-7026.03 2018,-7026.03"/>
</g>
<!-- gate_5_1 -->
<g id="node338" class="node">
<title>gate_5_1</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-6927.98 1927.06,-6927.98 1866.49,-6823.98 2101.94,-6823.98 2162.51,-6927.98"/>
<text text-anchor="middle" x="2014.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_5_L1</text>
<text text-anchor="middle" x="2014.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_1&#45;&gt;gate_5_1 -->
<g id="edge331" class="edge">
<title>attention_5_1&#45;&gt;gate_5_1</title>
<path fill="none" stroke="black" d="M2014.5,-6963.85C2014.5,-6956.16 2014.5,-6947.35 2014.5,-6938.35"/>
<polygon fill="black" stroke="black" points="2018,-6938.16 2014.5,-6928.16 2011,-6938.16 2018,-6938.16"/>
</g>
<!-- expert_5_1 -->
<g id="node339" class="node">
<title>expert_5_1</title>
<polygon fill="lightgreen" stroke="black" points="2089,-6787.98 1940,-6787.98 1940,-6735.98 2089,-6735.98 2089,-6787.98"/>
<text text-anchor="middle" x="2014.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_5_L1</text>
<text text-anchor="middle" x="2014.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_1&#45;&gt;expert_5_1 -->
<g id="edge332" class="edge">
<title>gate_5_1&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" d="M2007.77,-6823.9C2007.69,-6815.23 2007.83,-6806.41 2008.18,-6798.27"/>
<polygon fill="black" stroke="black" points="2011.69,-6798.21 2008.77,-6788.03 2004.7,-6797.81 2011.69,-6798.21"/>
</g>
<!-- gate_5_1&#45;&gt;expert_5_1 -->
<g id="edge1138" class="edge">
<title>gate_5_1&#45;&gt;expert_5_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-6823.9C2021.31,-6815.23 2021.17,-6806.41 2020.82,-6798.27"/>
<polygon fill="red" stroke="red" points="2024.3,-6797.81 2020.23,-6788.03 2017.31,-6798.21 2024.3,-6797.81"/>
</g>
<!-- aggregate_5_1 -->
<g id="node340" class="node">
<title>aggregate_5_1</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-6699.98 1927.06,-6699.98 1866.49,-6595.98 2101.94,-6595.98 2162.51,-6699.98"/>
<text text-anchor="middle" x="2014.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L1</text>
<text text-anchor="middle" x="2014.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_1&#45;&gt;aggregate_5_1 -->
<g id="edge333" class="edge">
<title>expert_5_1&#45;&gt;aggregate_5_1</title>
<path fill="none" stroke="black" d="M2014.5,-6735.85C2014.5,-6728.16 2014.5,-6719.35 2014.5,-6710.35"/>
<polygon fill="black" stroke="black" points="2018,-6710.16 2014.5,-6700.16 2011,-6710.16 2018,-6710.16"/>
</g>
<!-- attention_5_2 -->
<g id="node341" class="node">
<title>attention_5_2</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-6559.98 1930.5,-6559.98 1930.5,-6507.98 2098.5,-6507.98 2098.5,-6559.98"/>
<text text-anchor="middle" x="2014.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_5_L2</text>
<text text-anchor="middle" x="2014.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_1&#45;&gt;attention_5_2 -->
<g id="edge334" class="edge">
<title>aggregate_5_1&#45;&gt;attention_5_2</title>
<path fill="none" stroke="black" d="M2014.5,-6595.9C2014.5,-6587.23 2014.5,-6578.41 2014.5,-6570.27"/>
<polygon fill="black" stroke="black" points="2018,-6570.03 2014.5,-6560.03 2011,-6570.03 2018,-6570.03"/>
</g>
<!-- gate_5_2 -->
<g id="node342" class="node">
<title>gate_5_2</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-6471.98 1927.06,-6471.98 1866.49,-6367.98 2101.94,-6367.98 2162.51,-6471.98"/>
<text text-anchor="middle" x="2014.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_5_L2</text>
<text text-anchor="middle" x="2014.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_2&#45;&gt;gate_5_2 -->
<g id="edge335" class="edge">
<title>attention_5_2&#45;&gt;gate_5_2</title>
<path fill="none" stroke="black" d="M2014.5,-6507.85C2014.5,-6500.16 2014.5,-6491.35 2014.5,-6482.35"/>
<polygon fill="black" stroke="black" points="2018,-6482.16 2014.5,-6472.16 2011,-6482.16 2018,-6482.16"/>
</g>
<!-- expert_5_2 -->
<g id="node343" class="node">
<title>expert_5_2</title>
<polygon fill="lightgreen" stroke="black" points="2089,-6331.98 1940,-6331.98 1940,-6279.98 2089,-6279.98 2089,-6331.98"/>
<text text-anchor="middle" x="2014.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_5_L2</text>
<text text-anchor="middle" x="2014.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_2&#45;&gt;expert_5_2 -->
<g id="edge336" class="edge">
<title>gate_5_2&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" d="M2007.77,-6367.9C2007.69,-6359.23 2007.83,-6350.41 2008.18,-6342.27"/>
<polygon fill="black" stroke="black" points="2011.69,-6342.21 2008.77,-6332.03 2004.7,-6341.81 2011.69,-6342.21"/>
</g>
<!-- gate_5_2&#45;&gt;expert_5_2 -->
<g id="edge1139" class="edge">
<title>gate_5_2&#45;&gt;expert_5_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-6367.9C2021.31,-6359.23 2021.17,-6350.41 2020.82,-6342.27"/>
<polygon fill="red" stroke="red" points="2024.3,-6341.81 2020.23,-6332.03 2017.31,-6342.21 2024.3,-6341.81"/>
</g>
<!-- aggregate_5_2 -->
<g id="node344" class="node">
<title>aggregate_5_2</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-6243.98 1927.06,-6243.98 1866.49,-6139.98 2101.94,-6139.98 2162.51,-6243.98"/>
<text text-anchor="middle" x="2014.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L2</text>
<text text-anchor="middle" x="2014.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_2&#45;&gt;aggregate_5_2 -->
<g id="edge337" class="edge">
<title>expert_5_2&#45;&gt;aggregate_5_2</title>
<path fill="none" stroke="black" d="M2014.5,-6279.85C2014.5,-6272.16 2014.5,-6263.35 2014.5,-6254.35"/>
<polygon fill="black" stroke="black" points="2018,-6254.16 2014.5,-6244.16 2011,-6254.16 2018,-6254.16"/>
</g>
<!-- attention_5_3 -->
<g id="node345" class="node">
<title>attention_5_3</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-6103.98 1930.5,-6103.98 1930.5,-6051.98 2098.5,-6051.98 2098.5,-6103.98"/>
<text text-anchor="middle" x="2014.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_5_L3</text>
<text text-anchor="middle" x="2014.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_2&#45;&gt;attention_5_3 -->
<g id="edge338" class="edge">
<title>aggregate_5_2&#45;&gt;attention_5_3</title>
<path fill="none" stroke="black" d="M2014.5,-6139.9C2014.5,-6131.23 2014.5,-6122.41 2014.5,-6114.27"/>
<polygon fill="black" stroke="black" points="2018,-6114.03 2014.5,-6104.03 2011,-6114.03 2018,-6114.03"/>
</g>
<!-- gate_5_3 -->
<g id="node346" class="node">
<title>gate_5_3</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-6015.98 1927.06,-6015.98 1866.49,-5911.98 2101.94,-5911.98 2162.51,-6015.98"/>
<text text-anchor="middle" x="2014.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_5_L3</text>
<text text-anchor="middle" x="2014.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_3&#45;&gt;gate_5_3 -->
<g id="edge339" class="edge">
<title>attention_5_3&#45;&gt;gate_5_3</title>
<path fill="none" stroke="black" d="M2014.5,-6051.85C2014.5,-6044.16 2014.5,-6035.35 2014.5,-6026.35"/>
<polygon fill="black" stroke="black" points="2018,-6026.16 2014.5,-6016.16 2011,-6026.16 2018,-6026.16"/>
</g>
<!-- expert_5_3 -->
<g id="node347" class="node">
<title>expert_5_3</title>
<polygon fill="lightgreen" stroke="black" points="2089,-5875.98 1940,-5875.98 1940,-5823.98 2089,-5823.98 2089,-5875.98"/>
<text text-anchor="middle" x="2014.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_5_L3</text>
<text text-anchor="middle" x="2014.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_3&#45;&gt;expert_5_3 -->
<g id="edge340" class="edge">
<title>gate_5_3&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" d="M2007.77,-5911.9C2007.69,-5903.23 2007.83,-5894.41 2008.18,-5886.27"/>
<polygon fill="black" stroke="black" points="2011.69,-5886.21 2008.77,-5876.03 2004.7,-5885.81 2011.69,-5886.21"/>
</g>
<!-- gate_5_3&#45;&gt;expert_5_3 -->
<g id="edge1140" class="edge">
<title>gate_5_3&#45;&gt;expert_5_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-5911.9C2021.31,-5903.23 2021.17,-5894.41 2020.82,-5886.27"/>
<polygon fill="red" stroke="red" points="2024.3,-5885.81 2020.23,-5876.03 2017.31,-5886.21 2024.3,-5885.81"/>
</g>
<!-- aggregate_5_3 -->
<g id="node348" class="node">
<title>aggregate_5_3</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-5787.98 1927.06,-5787.98 1866.49,-5683.98 2101.94,-5683.98 2162.51,-5787.98"/>
<text text-anchor="middle" x="2014.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L3</text>
<text text-anchor="middle" x="2014.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_3&#45;&gt;aggregate_5_3 -->
<g id="edge341" class="edge">
<title>expert_5_3&#45;&gt;aggregate_5_3</title>
<path fill="none" stroke="black" d="M2014.5,-5823.85C2014.5,-5816.16 2014.5,-5807.35 2014.5,-5798.35"/>
<polygon fill="black" stroke="black" points="2018,-5798.16 2014.5,-5788.16 2011,-5798.16 2018,-5798.16"/>
</g>
<!-- attention_5_4 -->
<g id="node349" class="node">
<title>attention_5_4</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-5647.98 1930.5,-5647.98 1930.5,-5595.98 2098.5,-5595.98 2098.5,-5647.98"/>
<text text-anchor="middle" x="2014.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_5_L4</text>
<text text-anchor="middle" x="2014.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_3&#45;&gt;attention_5_4 -->
<g id="edge342" class="edge">
<title>aggregate_5_3&#45;&gt;attention_5_4</title>
<path fill="none" stroke="black" d="M2014.5,-5683.9C2014.5,-5675.23 2014.5,-5666.41 2014.5,-5658.27"/>
<polygon fill="black" stroke="black" points="2018,-5658.03 2014.5,-5648.03 2011,-5658.03 2018,-5658.03"/>
</g>
<!-- gate_5_4 -->
<g id="node350" class="node">
<title>gate_5_4</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-5559.98 1927.06,-5559.98 1866.49,-5455.98 2101.94,-5455.98 2162.51,-5559.98"/>
<text text-anchor="middle" x="2014.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_5_L4</text>
<text text-anchor="middle" x="2014.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_4&#45;&gt;gate_5_4 -->
<g id="edge343" class="edge">
<title>attention_5_4&#45;&gt;gate_5_4</title>
<path fill="none" stroke="black" d="M2014.5,-5595.85C2014.5,-5588.16 2014.5,-5579.35 2014.5,-5570.35"/>
<polygon fill="black" stroke="black" points="2018,-5570.16 2014.5,-5560.16 2011,-5570.16 2018,-5570.16"/>
</g>
<!-- expert_5_4 -->
<g id="node351" class="node">
<title>expert_5_4</title>
<polygon fill="lightgreen" stroke="black" points="2089,-5419.98 1940,-5419.98 1940,-5367.98 2089,-5367.98 2089,-5419.98"/>
<text text-anchor="middle" x="2014.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_5_L4</text>
<text text-anchor="middle" x="2014.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_4&#45;&gt;expert_5_4 -->
<g id="edge344" class="edge">
<title>gate_5_4&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" d="M2007.77,-5455.9C2007.69,-5447.23 2007.83,-5438.41 2008.18,-5430.27"/>
<polygon fill="black" stroke="black" points="2011.69,-5430.21 2008.77,-5420.03 2004.7,-5429.81 2011.69,-5430.21"/>
</g>
<!-- gate_5_4&#45;&gt;expert_5_4 -->
<g id="edge1141" class="edge">
<title>gate_5_4&#45;&gt;expert_5_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-5455.9C2021.31,-5447.23 2021.17,-5438.41 2020.82,-5430.27"/>
<polygon fill="red" stroke="red" points="2024.3,-5429.81 2020.23,-5420.03 2017.31,-5430.21 2024.3,-5429.81"/>
</g>
<!-- aggregate_5_4 -->
<g id="node352" class="node">
<title>aggregate_5_4</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-5331.98 1927.06,-5331.98 1866.49,-5227.98 2101.94,-5227.98 2162.51,-5331.98"/>
<text text-anchor="middle" x="2014.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L4</text>
<text text-anchor="middle" x="2014.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_4&#45;&gt;aggregate_5_4 -->
<g id="edge345" class="edge">
<title>expert_5_4&#45;&gt;aggregate_5_4</title>
<path fill="none" stroke="black" d="M2014.5,-5367.85C2014.5,-5360.16 2014.5,-5351.35 2014.5,-5342.35"/>
<polygon fill="black" stroke="black" points="2018,-5342.16 2014.5,-5332.16 2011,-5342.16 2018,-5342.16"/>
</g>
<!-- attention_5_5 -->
<g id="node353" class="node">
<title>attention_5_5</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-5191.98 1930.5,-5191.98 1930.5,-5139.98 2098.5,-5139.98 2098.5,-5191.98"/>
<text text-anchor="middle" x="2014.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_5_L5</text>
<text text-anchor="middle" x="2014.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_4&#45;&gt;attention_5_5 -->
<g id="edge346" class="edge">
<title>aggregate_5_4&#45;&gt;attention_5_5</title>
<path fill="none" stroke="black" d="M2014.5,-5227.9C2014.5,-5219.23 2014.5,-5210.41 2014.5,-5202.27"/>
<polygon fill="black" stroke="black" points="2018,-5202.03 2014.5,-5192.03 2011,-5202.03 2018,-5202.03"/>
</g>
<!-- gate_5_5 -->
<g id="node354" class="node">
<title>gate_5_5</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-5103.98 1927.06,-5103.98 1866.49,-4999.98 2101.94,-4999.98 2162.51,-5103.98"/>
<text text-anchor="middle" x="2014.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_5_L5</text>
<text text-anchor="middle" x="2014.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_5&#45;&gt;gate_5_5 -->
<g id="edge347" class="edge">
<title>attention_5_5&#45;&gt;gate_5_5</title>
<path fill="none" stroke="black" d="M2014.5,-5139.85C2014.5,-5132.16 2014.5,-5123.35 2014.5,-5114.35"/>
<polygon fill="black" stroke="black" points="2018,-5114.16 2014.5,-5104.16 2011,-5114.16 2018,-5114.16"/>
</g>
<!-- expert_5_5 -->
<g id="node355" class="node">
<title>expert_5_5</title>
<polygon fill="lightgreen" stroke="black" points="2089,-4963.98 1940,-4963.98 1940,-4911.98 2089,-4911.98 2089,-4963.98"/>
<text text-anchor="middle" x="2014.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_5_L5</text>
<text text-anchor="middle" x="2014.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_5&#45;&gt;expert_5_5 -->
<g id="edge348" class="edge">
<title>gate_5_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" d="M2007.77,-4999.9C2007.69,-4991.23 2007.83,-4982.41 2008.18,-4974.27"/>
<polygon fill="black" stroke="black" points="2011.69,-4974.21 2008.77,-4964.03 2004.7,-4973.81 2011.69,-4974.21"/>
</g>
<!-- gate_5_5&#45;&gt;expert_5_5 -->
<g id="edge1142" class="edge">
<title>gate_5_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-4999.9C2021.31,-4991.23 2021.17,-4982.41 2020.82,-4974.27"/>
<polygon fill="red" stroke="red" points="2024.3,-4973.81 2020.23,-4964.03 2017.31,-4974.21 2024.3,-4973.81"/>
</g>
<!-- aggregate_5_5 -->
<g id="node356" class="node">
<title>aggregate_5_5</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-4875.98 1927.06,-4875.98 1866.49,-4771.98 2101.94,-4771.98 2162.51,-4875.98"/>
<text text-anchor="middle" x="2014.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L5</text>
<text text-anchor="middle" x="2014.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_5&#45;&gt;aggregate_5_5 -->
<g id="edge349" class="edge">
<title>expert_5_5&#45;&gt;aggregate_5_5</title>
<path fill="none" stroke="black" d="M2014.5,-4911.85C2014.5,-4904.16 2014.5,-4895.35 2014.5,-4886.35"/>
<polygon fill="black" stroke="black" points="2018,-4886.16 2014.5,-4876.16 2011,-4886.16 2018,-4886.16"/>
</g>
<!-- attention_5_6 -->
<g id="node357" class="node">
<title>attention_5_6</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-4735.98 1930.5,-4735.98 1930.5,-4683.98 2098.5,-4683.98 2098.5,-4735.98"/>
<text text-anchor="middle" x="2014.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_5_L6</text>
<text text-anchor="middle" x="2014.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_5&#45;&gt;attention_5_6 -->
<g id="edge350" class="edge">
<title>aggregate_5_5&#45;&gt;attention_5_6</title>
<path fill="none" stroke="black" d="M2014.5,-4771.9C2014.5,-4763.23 2014.5,-4754.41 2014.5,-4746.27"/>
<polygon fill="black" stroke="black" points="2018,-4746.03 2014.5,-4736.03 2011,-4746.03 2018,-4746.03"/>
</g>
<!-- gate_5_6 -->
<g id="node358" class="node">
<title>gate_5_6</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-4647.98 1927.06,-4647.98 1866.49,-4543.98 2101.94,-4543.98 2162.51,-4647.98"/>
<text text-anchor="middle" x="2014.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_5_L6</text>
<text text-anchor="middle" x="2014.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_6&#45;&gt;gate_5_6 -->
<g id="edge351" class="edge">
<title>attention_5_6&#45;&gt;gate_5_6</title>
<path fill="none" stroke="black" d="M2014.5,-4683.85C2014.5,-4676.16 2014.5,-4667.35 2014.5,-4658.35"/>
<polygon fill="black" stroke="black" points="2018,-4658.16 2014.5,-4648.16 2011,-4658.16 2018,-4658.16"/>
</g>
<!-- expert_5_6 -->
<g id="node359" class="node">
<title>expert_5_6</title>
<polygon fill="lightgreen" stroke="black" points="2089,-4507.98 1940,-4507.98 1940,-4455.98 2089,-4455.98 2089,-4507.98"/>
<text text-anchor="middle" x="2014.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_5_L6</text>
<text text-anchor="middle" x="2014.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_6&#45;&gt;expert_5_6 -->
<g id="edge352" class="edge">
<title>gate_5_6&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" d="M2007.77,-4543.9C2007.69,-4535.23 2007.83,-4526.41 2008.18,-4518.27"/>
<polygon fill="black" stroke="black" points="2011.69,-4518.21 2008.77,-4508.03 2004.7,-4517.81 2011.69,-4518.21"/>
</g>
<!-- gate_5_6&#45;&gt;expert_5_6 -->
<g id="edge1143" class="edge">
<title>gate_5_6&#45;&gt;expert_5_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-4543.9C2021.31,-4535.23 2021.17,-4526.41 2020.82,-4518.27"/>
<polygon fill="red" stroke="red" points="2024.3,-4517.81 2020.23,-4508.03 2017.31,-4518.21 2024.3,-4517.81"/>
</g>
<!-- aggregate_5_6 -->
<g id="node360" class="node">
<title>aggregate_5_6</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-4419.98 1927.06,-4419.98 1866.49,-4315.98 2101.94,-4315.98 2162.51,-4419.98"/>
<text text-anchor="middle" x="2014.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L6</text>
<text text-anchor="middle" x="2014.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2014.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2014.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_6&#45;&gt;aggregate_5_6 -->
<g id="edge353" class="edge">
<title>expert_5_6&#45;&gt;aggregate_5_6</title>
<path fill="none" stroke="black" d="M2014.5,-4455.85C2014.5,-4448.16 2014.5,-4439.35 2014.5,-4430.35"/>
<polygon fill="black" stroke="black" points="2018,-4430.16 2014.5,-4420.16 2011,-4430.16 2018,-4430.16"/>
</g>
<!-- attention_5_7 -->
<g id="node361" class="node">
<title>attention_5_7</title>
<polygon fill="lightgreen" stroke="black" points="2098.5,-4279.98 1930.5,-4279.98 1930.5,-4227.98 2098.5,-4227.98 2098.5,-4279.98"/>
<text text-anchor="middle" x="2014.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_5_L7</text>
<text text-anchor="middle" x="2014.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2014.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2014.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_6&#45;&gt;attention_5_7 -->
<g id="edge354" class="edge">
<title>aggregate_5_6&#45;&gt;attention_5_7</title>
<path fill="none" stroke="black" d="M2014.5,-4315.9C2014.5,-4307.23 2014.5,-4298.41 2014.5,-4290.27"/>
<polygon fill="black" stroke="black" points="2018,-4290.03 2014.5,-4280.03 2011,-4290.03 2018,-4290.03"/>
</g>
<!-- gate_5_7 -->
<g id="node362" class="node">
<title>gate_5_7</title>
<polygon fill="lightyellow" stroke="black" points="2162.51,-4191.98 1927.06,-4191.98 1866.49,-4087.98 2101.94,-4087.98 2162.51,-4191.98"/>
<text text-anchor="middle" x="2014.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_5_L7</text>
<text text-anchor="middle" x="2014.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2014.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_7&#45;&gt;gate_5_7 -->
<g id="edge355" class="edge">
<title>attention_5_7&#45;&gt;gate_5_7</title>
<path fill="none" stroke="black" d="M2014.5,-4227.85C2014.5,-4220.16 2014.5,-4211.35 2014.5,-4202.35"/>
<polygon fill="black" stroke="black" points="2018,-4202.16 2014.5,-4192.16 2011,-4202.16 2018,-4202.16"/>
</g>
<!-- expert_5_7 -->
<g id="node363" class="node">
<title>expert_5_7</title>
<polygon fill="lightgreen" stroke="black" points="2089,-4051.98 1940,-4051.98 1940,-3999.98 2089,-3999.98 2089,-4051.98"/>
<text text-anchor="middle" x="2014.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_5_L7</text>
<text text-anchor="middle" x="2014.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2014.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2014.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_7&#45;&gt;expert_5_7 -->
<g id="edge356" class="edge">
<title>gate_5_7&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" d="M2007.77,-4087.9C2007.69,-4079.23 2007.83,-4070.41 2008.18,-4062.27"/>
<polygon fill="black" stroke="black" points="2011.69,-4062.21 2008.77,-4052.03 2004.7,-4061.81 2011.69,-4062.21"/>
</g>
<!-- gate_5_7&#45;&gt;expert_5_7 -->
<g id="edge1144" class="edge">
<title>gate_5_7&#45;&gt;expert_5_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2021.23,-4087.9C2021.31,-4079.23 2021.17,-4070.41 2020.82,-4062.27"/>
<polygon fill="red" stroke="red" points="2024.3,-4061.81 2020.23,-4052.03 2017.31,-4062.21 2024.3,-4061.81"/>
</g>
<!-- aggregate_5_7 -->
<g id="node364" class="node">
<title>aggregate_5_7</title>
<polygon fill="lightyellow" stroke="black" points="2163.51,-3963.98 1928.06,-3963.98 1867.49,-3859.98 2102.94,-3859.98 2163.51,-3963.98"/>
<text text-anchor="middle" x="2015.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L7</text>
<text text-anchor="middle" x="2015.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2015.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2015.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_7&#45;&gt;aggregate_5_7 -->
<g id="edge357" class="edge">
<title>expert_5_7&#45;&gt;aggregate_5_7</title>
<path fill="none" stroke="black" d="M2014.73,-3999.85C2014.79,-3992.16 2014.87,-3983.35 2014.95,-3974.35"/>
<polygon fill="black" stroke="black" points="2018.45,-3974.19 2015.04,-3964.16 2011.45,-3974.13 2018.45,-3974.19"/>
</g>
<!-- attention_5_8 -->
<g id="node365" class="node">
<title>attention_5_8</title>
<polygon fill="lightgreen" stroke="black" points="2099.5,-3823.98 1931.5,-3823.98 1931.5,-3771.98 2099.5,-3771.98 2099.5,-3823.98"/>
<text text-anchor="middle" x="2015.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_5_L8</text>
<text text-anchor="middle" x="2015.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2015.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2015.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_7&#45;&gt;attention_5_8 -->
<g id="edge358" class="edge">
<title>aggregate_5_7&#45;&gt;attention_5_8</title>
<path fill="none" stroke="black" d="M2015.5,-3859.9C2015.5,-3851.23 2015.5,-3842.41 2015.5,-3834.27"/>
<polygon fill="black" stroke="black" points="2019,-3834.03 2015.5,-3824.03 2012,-3834.03 2019,-3834.03"/>
</g>
<!-- gate_5_8 -->
<g id="node366" class="node">
<title>gate_5_8</title>
<polygon fill="lightyellow" stroke="black" points="2163.51,-3735.98 1928.06,-3735.98 1867.49,-3631.98 2102.94,-3631.98 2163.51,-3735.98"/>
<text text-anchor="middle" x="2015.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_5_L8</text>
<text text-anchor="middle" x="2015.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2015.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2015.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_8&#45;&gt;gate_5_8 -->
<g id="edge359" class="edge">
<title>attention_5_8&#45;&gt;gate_5_8</title>
<path fill="none" stroke="black" d="M2015.5,-3771.85C2015.5,-3764.16 2015.5,-3755.35 2015.5,-3746.35"/>
<polygon fill="black" stroke="black" points="2019,-3746.16 2015.5,-3736.16 2012,-3746.16 2019,-3746.16"/>
</g>
<!-- expert_5_8 -->
<g id="node367" class="node">
<title>expert_5_8</title>
<polygon fill="lightgreen" stroke="black" points="2090,-3595.98 1941,-3595.98 1941,-3543.98 2090,-3543.98 2090,-3595.98"/>
<text text-anchor="middle" x="2015.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_5_L8</text>
<text text-anchor="middle" x="2015.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2015.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2015.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_8&#45;&gt;expert_5_8 -->
<g id="edge360" class="edge">
<title>gate_5_8&#45;&gt;expert_5_8</title>
<path fill="none" stroke="black" d="M2008.77,-3631.9C2008.69,-3623.23 2008.83,-3614.41 2009.18,-3606.27"/>
<polygon fill="black" stroke="black" points="2012.69,-3606.21 2009.77,-3596.03 2005.7,-3605.81 2012.69,-3606.21"/>
</g>
<!-- gate_5_8&#45;&gt;expert_5_8 -->
<g id="edge1145" class="edge">
<title>gate_5_8&#45;&gt;expert_5_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2022.23,-3631.9C2022.31,-3623.23 2022.17,-3614.41 2021.82,-3606.27"/>
<polygon fill="red" stroke="red" points="2025.3,-3605.81 2021.23,-3596.03 2018.31,-3606.21 2025.3,-3605.81"/>
</g>
<!-- aggregate_5_8 -->
<g id="node368" class="node">
<title>aggregate_5_8</title>
<polygon fill="lightyellow" stroke="black" points="2163.51,-3507.98 1928.06,-3507.98 1867.49,-3403.98 2102.94,-3403.98 2163.51,-3507.98"/>
<text text-anchor="middle" x="2015.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L8</text>
<text text-anchor="middle" x="2015.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2015.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2015.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_8&#45;&gt;aggregate_5_8 -->
<g id="edge361" class="edge">
<title>expert_5_8&#45;&gt;aggregate_5_8</title>
<path fill="none" stroke="black" d="M2015.5,-3543.85C2015.5,-3536.16 2015.5,-3527.35 2015.5,-3518.35"/>
<polygon fill="black" stroke="black" points="2019,-3518.16 2015.5,-3508.16 2012,-3518.16 2019,-3518.16"/>
</g>
<!-- attention_5_9 -->
<g id="node369" class="node">
<title>attention_5_9</title>
<polygon fill="lightgreen" stroke="black" points="2100.5,-3367.98 1932.5,-3367.98 1932.5,-3315.98 2100.5,-3315.98 2100.5,-3367.98"/>
<text text-anchor="middle" x="2016.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_5_L9</text>
<text text-anchor="middle" x="2016.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2016.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2016.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_8&#45;&gt;attention_5_9 -->
<g id="edge362" class="edge">
<title>aggregate_5_8&#45;&gt;attention_5_9</title>
<path fill="none" stroke="black" d="M2015.96,-3403.9C2016.03,-3395.23 2016.11,-3386.41 2016.19,-3378.27"/>
<polygon fill="black" stroke="black" points="2019.69,-3378.06 2016.28,-3368.03 2012.69,-3377.99 2019.69,-3378.06"/>
</g>
<!-- gate_5_9 -->
<g id="node370" class="node">
<title>gate_5_9</title>
<polygon fill="lightyellow" stroke="black" points="2164.51,-3279.98 1929.06,-3279.98 1868.49,-3175.98 2103.94,-3175.98 2164.51,-3279.98"/>
<text text-anchor="middle" x="2016.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_5_L9</text>
<text text-anchor="middle" x="2016.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2016.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2016.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_9&#45;&gt;gate_5_9 -->
<g id="edge363" class="edge">
<title>attention_5_9&#45;&gt;gate_5_9</title>
<path fill="none" stroke="black" d="M2016.5,-3315.85C2016.5,-3308.16 2016.5,-3299.35 2016.5,-3290.35"/>
<polygon fill="black" stroke="black" points="2020,-3290.16 2016.5,-3280.16 2013,-3290.16 2020,-3290.16"/>
</g>
<!-- expert_5_9 -->
<g id="node371" class="node">
<title>expert_5_9</title>
<polygon fill="lightgreen" stroke="black" points="2094,-3139.98 1945,-3139.98 1945,-3087.98 2094,-3087.98 2094,-3139.98"/>
<text text-anchor="middle" x="2019.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_5_L9</text>
<text text-anchor="middle" x="2019.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2019.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2019.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_9&#45;&gt;expert_5_9 -->
<g id="edge364" class="edge">
<title>gate_5_9&#45;&gt;expert_5_9</title>
<path fill="none" stroke="black" d="M2011.14,-3175.9C2011.29,-3167.14 2011.67,-3158.21 2012.25,-3149.99"/>
<polygon fill="black" stroke="black" points="2015.74,-3150.29 2013.1,-3140.03 2008.77,-3149.7 2015.74,-3150.29"/>
</g>
<!-- gate_5_9&#45;&gt;expert_5_9 -->
<g id="edge1146" class="edge">
<title>gate_5_9&#45;&gt;expert_5_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2024.6,-3175.9C2024.91,-3167.23 2025.01,-3158.41 2024.88,-3150.27"/>
<polygon fill="red" stroke="red" points="2028.37,-3149.91 2024.56,-3140.03 2021.37,-3150.13 2028.37,-3149.91"/>
</g>
<!-- aggregate_5_9 -->
<g id="node372" class="node">
<title>aggregate_5_9</title>
<polygon fill="lightyellow" stroke="black" points="2167.51,-3051.98 1932.06,-3051.98 1871.49,-2947.98 2106.94,-2947.98 2167.51,-3051.98"/>
<text text-anchor="middle" x="2019.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L9</text>
<text text-anchor="middle" x="2019.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2019.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2019.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_9&#45;&gt;aggregate_5_9 -->
<g id="edge365" class="edge">
<title>expert_5_9&#45;&gt;aggregate_5_9</title>
<path fill="none" stroke="black" d="M2019.5,-3087.85C2019.5,-3080.16 2019.5,-3071.35 2019.5,-3062.35"/>
<polygon fill="black" stroke="black" points="2023,-3062.16 2019.5,-3052.16 2016,-3062.16 2023,-3062.16"/>
</g>
<!-- attention_5_10 -->
<g id="node373" class="node">
<title>attention_5_10</title>
<polygon fill="lightgreen" stroke="black" points="2103.5,-2911.98 1935.5,-2911.98 1935.5,-2859.98 2103.5,-2859.98 2103.5,-2911.98"/>
<text text-anchor="middle" x="2019.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_5_L10</text>
<text text-anchor="middle" x="2019.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2019.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2019.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_9&#45;&gt;attention_5_10 -->
<g id="edge366" class="edge">
<title>aggregate_5_9&#45;&gt;attention_5_10</title>
<path fill="none" stroke="black" d="M2019.5,-2947.9C2019.5,-2939.23 2019.5,-2930.41 2019.5,-2922.27"/>
<polygon fill="black" stroke="black" points="2023,-2922.03 2019.5,-2912.03 2016,-2922.03 2023,-2922.03"/>
</g>
<!-- gate_5_10 -->
<g id="node374" class="node">
<title>gate_5_10</title>
<polygon fill="lightyellow" stroke="black" points="2170.51,-2823.98 1935.06,-2823.98 1874.49,-2719.98 2109.94,-2719.98 2170.51,-2823.98"/>
<text text-anchor="middle" x="2022.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_5_L10</text>
<text text-anchor="middle" x="2022.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2022.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2022.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_10&#45;&gt;gate_5_10 -->
<g id="edge367" class="edge">
<title>attention_5_10&#45;&gt;gate_5_10</title>
<path fill="none" stroke="black" d="M2020.17,-2859.85C2020.38,-2852.16 2020.62,-2843.35 2020.86,-2834.35"/>
<polygon fill="black" stroke="black" points="2024.36,-2834.25 2021.13,-2824.16 2017.36,-2834.06 2024.36,-2834.25"/>
</g>
<!-- expert_5_10 -->
<g id="node375" class="node">
<title>expert_5_10</title>
<polygon fill="lightgreen" stroke="black" points="2098,-2683.98 1949,-2683.98 1949,-2631.98 2098,-2631.98 2098,-2683.98"/>
<text text-anchor="middle" x="2023.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_5_L10</text>
<text text-anchor="middle" x="2023.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2023.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2023.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_10&#45;&gt;expert_5_10 -->
<g id="edge368" class="edge">
<title>gate_5_10&#45;&gt;expert_5_10</title>
<path fill="none" stroke="black" d="M2016.23,-2719.9C2016.23,-2711.23 2016.44,-2702.41 2016.86,-2694.27"/>
<polygon fill="black" stroke="black" points="2020.37,-2694.24 2017.54,-2684.03 2013.39,-2693.77 2020.37,-2694.24"/>
</g>
<!-- gate_5_10&#45;&gt;expert_5_10 -->
<g id="edge1147" class="edge">
<title>gate_5_10&#45;&gt;expert_5_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2029.68,-2719.9C2029.84,-2711.23 2029.79,-2702.41 2029.51,-2694.27"/>
<polygon fill="red" stroke="red" points="2032.99,-2693.85 2029.01,-2684.03 2026,-2694.18 2032.99,-2693.85"/>
</g>
<!-- aggregate_5_10 -->
<g id="node376" class="node">
<title>aggregate_5_10</title>
<polygon fill="lightyellow" stroke="black" points="2172.51,-2595.98 1937.06,-2595.98 1876.49,-2491.98 2111.94,-2491.98 2172.51,-2595.98"/>
<text text-anchor="middle" x="2024.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L10</text>
<text text-anchor="middle" x="2024.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2024.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2024.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_10&#45;&gt;aggregate_5_10 -->
<g id="edge369" class="edge">
<title>expert_5_10&#45;&gt;aggregate_5_10</title>
<path fill="none" stroke="black" d="M2023.73,-2631.85C2023.79,-2624.16 2023.87,-2615.35 2023.95,-2606.35"/>
<polygon fill="black" stroke="black" points="2027.45,-2606.19 2024.04,-2596.16 2020.45,-2606.13 2027.45,-2606.19"/>
</g>
<!-- attention_5_11 -->
<g id="node377" class="node">
<title>attention_5_11</title>
<polygon fill="lightgreen" stroke="black" points="2109.5,-2455.98 1941.5,-2455.98 1941.5,-2403.98 2109.5,-2403.98 2109.5,-2455.98"/>
<text text-anchor="middle" x="2025.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_5_L11</text>
<text text-anchor="middle" x="2025.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2025.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2025.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_10&#45;&gt;attention_5_11 -->
<g id="edge370" class="edge">
<title>aggregate_5_10&#45;&gt;attention_5_11</title>
<path fill="none" stroke="black" d="M2024.96,-2491.9C2025.03,-2483.23 2025.11,-2474.41 2025.19,-2466.27"/>
<polygon fill="black" stroke="black" points="2028.69,-2466.06 2025.28,-2456.03 2021.69,-2465.99 2028.69,-2466.06"/>
</g>
<!-- gate_5_11 -->
<g id="node378" class="node">
<title>gate_5_11</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-2367.98 1938.06,-2367.98 1877.49,-2263.98 2112.94,-2263.98 2173.51,-2367.98"/>
<text text-anchor="middle" x="2025.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_5_L11</text>
<text text-anchor="middle" x="2025.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2025.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_11&#45;&gt;gate_5_11 -->
<g id="edge371" class="edge">
<title>attention_5_11&#45;&gt;gate_5_11</title>
<path fill="none" stroke="black" d="M2025.5,-2403.85C2025.5,-2396.16 2025.5,-2387.35 2025.5,-2378.35"/>
<polygon fill="black" stroke="black" points="2029,-2378.16 2025.5,-2368.16 2022,-2378.16 2029,-2378.16"/>
</g>
<!-- expert_5_11 -->
<g id="node379" class="node">
<title>expert_5_11</title>
<polygon fill="lightgreen" stroke="black" points="2100,-2227.98 1951,-2227.98 1951,-2175.98 2100,-2175.98 2100,-2227.98"/>
<text text-anchor="middle" x="2025.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_5_L11</text>
<text text-anchor="middle" x="2025.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2025.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_11&#45;&gt;expert_5_11 -->
<g id="edge372" class="edge">
<title>gate_5_11&#45;&gt;expert_5_11</title>
<path fill="none" stroke="black" d="M2018.77,-2263.9C2018.69,-2255.23 2018.83,-2246.41 2019.18,-2238.27"/>
<polygon fill="black" stroke="black" points="2022.69,-2238.21 2019.77,-2228.03 2015.7,-2237.81 2022.69,-2238.21"/>
</g>
<!-- gate_5_11&#45;&gt;expert_5_11 -->
<g id="edge1148" class="edge">
<title>gate_5_11&#45;&gt;expert_5_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2032.23,-2263.9C2032.31,-2255.23 2032.17,-2246.41 2031.82,-2238.27"/>
<polygon fill="red" stroke="red" points="2035.3,-2237.81 2031.23,-2228.03 2028.31,-2238.21 2035.3,-2237.81"/>
</g>
<!-- aggregate_5_11 -->
<g id="node380" class="node">
<title>aggregate_5_11</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-2139.98 1938.06,-2139.98 1877.49,-2035.98 2112.94,-2035.98 2173.51,-2139.98"/>
<text text-anchor="middle" x="2025.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L11</text>
<text text-anchor="middle" x="2025.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2025.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2025.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_11&#45;&gt;aggregate_5_11 -->
<g id="edge373" class="edge">
<title>expert_5_11&#45;&gt;aggregate_5_11</title>
<path fill="none" stroke="black" d="M2025.5,-2175.85C2025.5,-2168.16 2025.5,-2159.35 2025.5,-2150.35"/>
<polygon fill="black" stroke="black" points="2029,-2150.16 2025.5,-2140.16 2022,-2150.16 2029,-2150.16"/>
</g>
<!-- attention_5_12 -->
<g id="node381" class="node">
<title>attention_5_12</title>
<polygon fill="lightgreen" stroke="black" points="2109.5,-1999.98 1941.5,-1999.98 1941.5,-1947.98 2109.5,-1947.98 2109.5,-1999.98"/>
<text text-anchor="middle" x="2025.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_5_L12</text>
<text text-anchor="middle" x="2025.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2025.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2025.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_11&#45;&gt;attention_5_12 -->
<g id="edge374" class="edge">
<title>aggregate_5_11&#45;&gt;attention_5_12</title>
<path fill="none" stroke="black" d="M2025.5,-2035.9C2025.5,-2027.23 2025.5,-2018.41 2025.5,-2010.27"/>
<polygon fill="black" stroke="black" points="2029,-2010.03 2025.5,-2000.03 2022,-2010.03 2029,-2010.03"/>
</g>
<!-- gate_5_12 -->
<g id="node382" class="node">
<title>gate_5_12</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-1911.98 1938.06,-1911.98 1877.49,-1807.98 2112.94,-1807.98 2173.51,-1911.98"/>
<text text-anchor="middle" x="2025.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_5_L12</text>
<text text-anchor="middle" x="2025.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2025.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_12&#45;&gt;gate_5_12 -->
<g id="edge375" class="edge">
<title>attention_5_12&#45;&gt;gate_5_12</title>
<path fill="none" stroke="black" d="M2025.5,-1947.85C2025.5,-1940.16 2025.5,-1931.35 2025.5,-1922.35"/>
<polygon fill="black" stroke="black" points="2029,-1922.16 2025.5,-1912.16 2022,-1922.16 2029,-1922.16"/>
</g>
<!-- expert_5_12 -->
<g id="node383" class="node">
<title>expert_5_12</title>
<polygon fill="lightgreen" stroke="black" points="2100,-1771.98 1951,-1771.98 1951,-1719.98 2100,-1719.98 2100,-1771.98"/>
<text text-anchor="middle" x="2025.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_5_L12</text>
<text text-anchor="middle" x="2025.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2025.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_12&#45;&gt;expert_5_12 -->
<g id="edge376" class="edge">
<title>gate_5_12&#45;&gt;expert_5_12</title>
<path fill="none" stroke="black" d="M2018.77,-1807.9C2018.69,-1799.23 2018.83,-1790.41 2019.18,-1782.27"/>
<polygon fill="black" stroke="black" points="2022.69,-1782.21 2019.77,-1772.03 2015.7,-1781.81 2022.69,-1782.21"/>
</g>
<!-- gate_5_12&#45;&gt;expert_5_12 -->
<g id="edge1149" class="edge">
<title>gate_5_12&#45;&gt;expert_5_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2032.23,-1807.9C2032.31,-1799.23 2032.17,-1790.41 2031.82,-1782.27"/>
<polygon fill="red" stroke="red" points="2035.3,-1781.81 2031.23,-1772.03 2028.31,-1782.21 2035.3,-1781.81"/>
</g>
<!-- aggregate_5_12 -->
<g id="node384" class="node">
<title>aggregate_5_12</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-1683.98 1938.06,-1683.98 1877.49,-1579.98 2112.94,-1579.98 2173.51,-1683.98"/>
<text text-anchor="middle" x="2025.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L12</text>
<text text-anchor="middle" x="2025.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2025.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2025.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_12&#45;&gt;aggregate_5_12 -->
<g id="edge377" class="edge">
<title>expert_5_12&#45;&gt;aggregate_5_12</title>
<path fill="none" stroke="black" d="M2025.5,-1719.85C2025.5,-1712.16 2025.5,-1703.35 2025.5,-1694.35"/>
<polygon fill="black" stroke="black" points="2029,-1694.16 2025.5,-1684.16 2022,-1694.16 2029,-1694.16"/>
</g>
<!-- attention_5_13 -->
<g id="node385" class="node">
<title>attention_5_13</title>
<polygon fill="lightgreen" stroke="black" points="2109.5,-1543.98 1941.5,-1543.98 1941.5,-1491.98 2109.5,-1491.98 2109.5,-1543.98"/>
<text text-anchor="middle" x="2025.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_5_L13</text>
<text text-anchor="middle" x="2025.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2025.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2025.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_12&#45;&gt;attention_5_13 -->
<g id="edge378" class="edge">
<title>aggregate_5_12&#45;&gt;attention_5_13</title>
<path fill="none" stroke="black" d="M2025.5,-1579.9C2025.5,-1571.23 2025.5,-1562.41 2025.5,-1554.27"/>
<polygon fill="black" stroke="black" points="2029,-1554.03 2025.5,-1544.03 2022,-1554.03 2029,-1554.03"/>
</g>
<!-- gate_5_13 -->
<g id="node386" class="node">
<title>gate_5_13</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-1455.98 1938.06,-1455.98 1877.49,-1351.98 2112.94,-1351.98 2173.51,-1455.98"/>
<text text-anchor="middle" x="2025.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_5_L13</text>
<text text-anchor="middle" x="2025.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2025.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_13&#45;&gt;gate_5_13 -->
<g id="edge379" class="edge">
<title>attention_5_13&#45;&gt;gate_5_13</title>
<path fill="none" stroke="black" d="M2025.5,-1491.85C2025.5,-1484.16 2025.5,-1475.35 2025.5,-1466.35"/>
<polygon fill="black" stroke="black" points="2029,-1466.16 2025.5,-1456.16 2022,-1466.16 2029,-1466.16"/>
</g>
<!-- expert_5_13 -->
<g id="node387" class="node">
<title>expert_5_13</title>
<polygon fill="lightgreen" stroke="black" points="2100,-1315.98 1951,-1315.98 1951,-1263.98 2100,-1263.98 2100,-1315.98"/>
<text text-anchor="middle" x="2025.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_5_L13</text>
<text text-anchor="middle" x="2025.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2025.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_13&#45;&gt;expert_5_13 -->
<g id="edge380" class="edge">
<title>gate_5_13&#45;&gt;expert_5_13</title>
<path fill="none" stroke="black" d="M2018.77,-1351.9C2018.69,-1343.23 2018.83,-1334.41 2019.18,-1326.27"/>
<polygon fill="black" stroke="black" points="2022.69,-1326.21 2019.77,-1316.03 2015.7,-1325.81 2022.69,-1326.21"/>
</g>
<!-- gate_5_13&#45;&gt;expert_5_13 -->
<g id="edge1150" class="edge">
<title>gate_5_13&#45;&gt;expert_5_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2032.23,-1351.9C2032.31,-1343.23 2032.17,-1334.41 2031.82,-1326.27"/>
<polygon fill="red" stroke="red" points="2035.3,-1325.81 2031.23,-1316.03 2028.31,-1326.21 2035.3,-1325.81"/>
</g>
<!-- aggregate_5_13 -->
<g id="node388" class="node">
<title>aggregate_5_13</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-1227.98 1938.06,-1227.98 1877.49,-1123.98 2112.94,-1123.98 2173.51,-1227.98"/>
<text text-anchor="middle" x="2025.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L13</text>
<text text-anchor="middle" x="2025.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2025.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2025.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_13&#45;&gt;aggregate_5_13 -->
<g id="edge381" class="edge">
<title>expert_5_13&#45;&gt;aggregate_5_13</title>
<path fill="none" stroke="black" d="M2025.5,-1263.85C2025.5,-1256.16 2025.5,-1247.35 2025.5,-1238.35"/>
<polygon fill="black" stroke="black" points="2029,-1238.16 2025.5,-1228.16 2022,-1238.16 2029,-1238.16"/>
</g>
<!-- attention_5_14 -->
<g id="node389" class="node">
<title>attention_5_14</title>
<polygon fill="lightgreen" stroke="black" points="2109.5,-1087.98 1941.5,-1087.98 1941.5,-1035.98 2109.5,-1035.98 2109.5,-1087.98"/>
<text text-anchor="middle" x="2025.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_5_L14</text>
<text text-anchor="middle" x="2025.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2025.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2025.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_13&#45;&gt;attention_5_14 -->
<g id="edge382" class="edge">
<title>aggregate_5_13&#45;&gt;attention_5_14</title>
<path fill="none" stroke="black" d="M2025.5,-1123.9C2025.5,-1115.23 2025.5,-1106.41 2025.5,-1098.27"/>
<polygon fill="black" stroke="black" points="2029,-1098.03 2025.5,-1088.03 2022,-1098.03 2029,-1098.03"/>
</g>
<!-- gate_5_14 -->
<g id="node390" class="node">
<title>gate_5_14</title>
<polygon fill="lightyellow" stroke="black" points="2173.51,-999.98 1938.06,-999.98 1877.49,-895.98 2112.94,-895.98 2173.51,-999.98"/>
<text text-anchor="middle" x="2025.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_5_L14</text>
<text text-anchor="middle" x="2025.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2025.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_14&#45;&gt;gate_5_14 -->
<g id="edge383" class="edge">
<title>attention_5_14&#45;&gt;gate_5_14</title>
<path fill="none" stroke="black" d="M2025.5,-1035.85C2025.5,-1028.16 2025.5,-1019.35 2025.5,-1010.35"/>
<polygon fill="black" stroke="black" points="2029,-1010.16 2025.5,-1000.16 2022,-1010.16 2029,-1010.16"/>
</g>
<!-- expert_5_14 -->
<g id="node391" class="node">
<title>expert_5_14</title>
<polygon fill="lightgreen" stroke="black" points="2100,-859.98 1951,-859.98 1951,-807.98 2100,-807.98 2100,-859.98"/>
<text text-anchor="middle" x="2025.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_5_L14</text>
<text text-anchor="middle" x="2025.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2025.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2025.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_14&#45;&gt;expert_5_14 -->
<g id="edge384" class="edge">
<title>gate_5_14&#45;&gt;expert_5_14</title>
<path fill="none" stroke="black" d="M2018.77,-895.9C2018.69,-887.23 2018.83,-878.41 2019.18,-870.27"/>
<polygon fill="black" stroke="black" points="2022.69,-870.21 2019.77,-860.03 2015.7,-869.81 2022.69,-870.21"/>
</g>
<!-- gate_5_14&#45;&gt;expert_5_14 -->
<g id="edge1151" class="edge">
<title>gate_5_14&#45;&gt;expert_5_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2032.23,-895.9C2032.31,-887.23 2032.17,-878.41 2031.82,-870.27"/>
<polygon fill="red" stroke="red" points="2035.3,-869.81 2031.23,-860.03 2028.31,-870.21 2035.3,-869.81"/>
</g>
<!-- aggregate_5_14 -->
<g id="node392" class="node">
<title>aggregate_5_14</title>
<polygon fill="lightyellow" stroke="black" points="2174.51,-771.98 1939.06,-771.98 1878.49,-667.98 2113.94,-667.98 2174.51,-771.98"/>
<text text-anchor="middle" x="2026.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L14</text>
<text text-anchor="middle" x="2026.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2026.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2026.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_14&#45;&gt;aggregate_5_14 -->
<g id="edge385" class="edge">
<title>expert_5_14&#45;&gt;aggregate_5_14</title>
<path fill="none" stroke="black" d="M2025.73,-807.85C2025.79,-800.16 2025.87,-791.35 2025.95,-782.35"/>
<polygon fill="black" stroke="black" points="2029.45,-782.19 2026.04,-772.16 2022.45,-782.13 2029.45,-782.19"/>
</g>
<!-- attention_5_15 -->
<g id="node393" class="node">
<title>attention_5_15</title>
<polygon fill="lightgreen" stroke="black" points="2110.5,-631.98 1942.5,-631.98 1942.5,-579.98 2110.5,-579.98 2110.5,-631.98"/>
<text text-anchor="middle" x="2026.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_5_L15</text>
<text text-anchor="middle" x="2026.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2026.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2026.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_5_14&#45;&gt;attention_5_15 -->
<g id="edge386" class="edge">
<title>aggregate_5_14&#45;&gt;attention_5_15</title>
<path fill="none" stroke="black" d="M2026.5,-667.9C2026.5,-659.23 2026.5,-650.41 2026.5,-642.27"/>
<polygon fill="black" stroke="black" points="2030,-642.03 2026.5,-632.03 2023,-642.03 2030,-642.03"/>
</g>
<!-- gate_5_15 -->
<g id="node394" class="node">
<title>gate_5_15</title>
<polygon fill="lightyellow" stroke="black" points="2174.51,-543.98 1939.06,-543.98 1878.49,-439.98 2113.94,-439.98 2174.51,-543.98"/>
<text text-anchor="middle" x="2026.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_5_L15</text>
<text text-anchor="middle" x="2026.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2026.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2026.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_5_15&#45;&gt;gate_5_15 -->
<g id="edge387" class="edge">
<title>attention_5_15&#45;&gt;gate_5_15</title>
<path fill="none" stroke="black" d="M2026.5,-579.85C2026.5,-572.16 2026.5,-563.35 2026.5,-554.35"/>
<polygon fill="black" stroke="black" points="2030,-554.16 2026.5,-544.16 2023,-554.16 2030,-554.16"/>
</g>
<!-- expert_5_15 -->
<g id="node395" class="node">
<title>expert_5_15</title>
<polygon fill="lightgreen" stroke="black" points="2101,-403.98 1952,-403.98 1952,-351.98 2101,-351.98 2101,-403.98"/>
<text text-anchor="middle" x="2026.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_5_L15</text>
<text text-anchor="middle" x="2026.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=5</text>
<text text-anchor="middle" x="2026.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2026.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_5_15&#45;&gt;expert_5_15 -->
<g id="edge388" class="edge">
<title>gate_5_15&#45;&gt;expert_5_15</title>
<path fill="none" stroke="black" d="M2019.77,-439.9C2019.69,-431.23 2019.83,-422.41 2020.18,-414.27"/>
<polygon fill="black" stroke="black" points="2023.69,-414.21 2020.77,-404.03 2016.7,-413.81 2023.69,-414.21"/>
</g>
<!-- gate_5_15&#45;&gt;expert_5_15 -->
<g id="edge1152" class="edge">
<title>gate_5_15&#45;&gt;expert_5_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2033.23,-439.9C2033.31,-431.23 2033.17,-422.41 2032.82,-414.27"/>
<polygon fill="red" stroke="red" points="2036.3,-413.81 2032.23,-404.03 2029.31,-414.21 2036.3,-413.81"/>
</g>
<!-- aggregate_5_15 -->
<g id="node396" class="node">
<title>aggregate_5_15</title>
<polygon fill="lightyellow" stroke="black" points="2174.51,-315.98 1939.06,-315.98 1878.49,-211.98 2113.94,-211.98 2174.51,-315.98"/>
<text text-anchor="middle" x="2026.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_5_L15</text>
<text text-anchor="middle" x="2026.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2026.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2026.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_5_15&#45;&gt;aggregate_5_15 -->
<g id="edge389" class="edge">
<title>expert_5_15&#45;&gt;aggregate_5_15</title>
<path fill="none" stroke="black" d="M2026.5,-351.85C2026.5,-344.16 2026.5,-335.35 2026.5,-326.35"/>
<polygon fill="black" stroke="black" points="2030,-326.16 2026.5,-316.16 2023,-326.16 2030,-326.16"/>
</g>
<!-- collect_5 -->
<g id="node397" class="node">
<title>collect_5</title>
<polygon fill="lightyellow" stroke="black" points="2174.51,-175.98 1939.06,-175.98 1878.49,-93.98 2113.94,-93.98 2174.51,-175.98"/>
<text text-anchor="middle" x="2026.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_5</text>
<text text-anchor="middle" x="2026.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2026.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_5_15&#45;&gt;collect_5 -->
<g id="edge390" class="edge">
<title>aggregate_5_15&#45;&gt;collect_5</title>
<path fill="none" stroke="black" d="M2026.5,-211.69C2026.5,-203.27 2026.5,-194.56 2026.5,-186.17"/>
<polygon fill="black" stroke="black" points="2030,-186.14 2026.5,-176.14 2023,-186.14 2030,-186.14"/>
</g>
<!-- collect_5&#45;&gt;output -->
<g id="edge1046" class="edge">
<title>collect_5&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2123.79,-106.98C2143.75,-102.11 2164.72,-97.47 2184.5,-93.98 2357.63,-63.43 2560.33,-46.06 2687.83,-37.34"/>
<polygon fill="black" stroke="black" points="2688.28,-40.81 2698.03,-36.65 2687.81,-33.83 2688.28,-40.81"/>
</g>
<!-- distribute_6 -->
<g id="node398" class="node">
<title>distribute_6</title>
<polygon fill="lightyellow" stroke="black" points="2485.73,-7589.98 2245.16,-7589.98 2183.27,-7507.98 2423.85,-7507.98 2485.73,-7589.98"/>
<text text-anchor="middle" x="2334.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_6</text>
<text text-anchor="middle" x="2334.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="2334.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_0 -->
<g id="node399" class="node">
<title>attention_6_0</title>
<polygon fill="lightgreen" stroke="black" points="2418.5,-7471.98 2250.5,-7471.98 2250.5,-7419.98 2418.5,-7419.98 2418.5,-7471.98"/>
<text text-anchor="middle" x="2334.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_6_L0</text>
<text text-anchor="middle" x="2334.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2334.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2334.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_6&#45;&gt;attention_6_0 -->
<g id="edge391" class="edge">
<title>distribute_6&#45;&gt;attention_6_0</title>
<path fill="none" stroke="black" d="M2334.5,-7507.77C2334.5,-7499.34 2334.5,-7490.51 2334.5,-7482.27"/>
<polygon fill="black" stroke="black" points="2338,-7482.23 2334.5,-7472.23 2331,-7482.23 2338,-7482.23"/>
</g>
<!-- gate_6_0 -->
<g id="node400" class="node">
<title>gate_6_0</title>
<polygon fill="lightyellow" stroke="black" points="2485.51,-7383.98 2250.06,-7383.98 2189.49,-7279.98 2424.94,-7279.98 2485.51,-7383.98"/>
<text text-anchor="middle" x="2337.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_6_L0</text>
<text text-anchor="middle" x="2337.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2337.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2337.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_0&#45;&gt;gate_6_0 -->
<g id="edge392" class="edge">
<title>attention_6_0&#45;&gt;gate_6_0</title>
<path fill="none" stroke="black" d="M2335.17,-7419.85C2335.38,-7412.16 2335.62,-7403.35 2335.86,-7394.35"/>
<polygon fill="black" stroke="black" points="2339.36,-7394.25 2336.13,-7384.16 2332.36,-7394.06 2339.36,-7394.25"/>
</g>
<!-- expert_6_0 -->
<g id="node401" class="node">
<title>expert_6_0</title>
<polygon fill="lightgreen" stroke="black" points="2413,-7243.98 2264,-7243.98 2264,-7191.98 2413,-7191.98 2413,-7243.98"/>
<text text-anchor="middle" x="2338.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_6_L0</text>
<text text-anchor="middle" x="2338.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2338.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2338.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_0&#45;&gt;expert_6_0 -->
<g id="edge393" class="edge">
<title>gate_6_0&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" d="M2331.23,-7279.9C2331.23,-7271.23 2331.44,-7262.41 2331.86,-7254.27"/>
<polygon fill="black" stroke="black" points="2335.37,-7254.24 2332.54,-7244.03 2328.39,-7253.77 2335.37,-7254.24"/>
</g>
<!-- gate_6_0&#45;&gt;expert_6_0 -->
<g id="edge1153" class="edge">
<title>gate_6_0&#45;&gt;expert_6_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2344.68,-7279.9C2344.84,-7271.23 2344.79,-7262.41 2344.51,-7254.27"/>
<polygon fill="red" stroke="red" points="2347.99,-7253.85 2344.01,-7244.03 2341,-7254.18 2347.99,-7253.85"/>
</g>
<!-- aggregate_6_0 -->
<g id="node402" class="node">
<title>aggregate_6_0</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-7155.98 2253.06,-7155.98 2192.49,-7051.98 2427.94,-7051.98 2488.51,-7155.98"/>
<text text-anchor="middle" x="2340.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L0</text>
<text text-anchor="middle" x="2340.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_0&#45;&gt;aggregate_6_0 -->
<g id="edge394" class="edge">
<title>expert_6_0&#45;&gt;aggregate_6_0</title>
<path fill="none" stroke="black" d="M2338.95,-7191.85C2339.09,-7184.16 2339.24,-7175.35 2339.41,-7166.35"/>
<polygon fill="black" stroke="black" points="2342.91,-7166.22 2339.59,-7156.16 2335.91,-7166.1 2342.91,-7166.22"/>
</g>
<!-- attention_6_1 -->
<g id="node403" class="node">
<title>attention_6_1</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-7015.98 2256.5,-7015.98 2256.5,-6963.98 2424.5,-6963.98 2424.5,-7015.98"/>
<text text-anchor="middle" x="2340.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_6_L1</text>
<text text-anchor="middle" x="2340.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_0&#45;&gt;attention_6_1 -->
<g id="edge395" class="edge">
<title>aggregate_6_0&#45;&gt;attention_6_1</title>
<path fill="none" stroke="black" d="M2340.5,-7051.9C2340.5,-7043.23 2340.5,-7034.41 2340.5,-7026.27"/>
<polygon fill="black" stroke="black" points="2344,-7026.03 2340.5,-7016.03 2337,-7026.03 2344,-7026.03"/>
</g>
<!-- gate_6_1 -->
<g id="node404" class="node">
<title>gate_6_1</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-6927.98 2253.06,-6927.98 2192.49,-6823.98 2427.94,-6823.98 2488.51,-6927.98"/>
<text text-anchor="middle" x="2340.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_6_L1</text>
<text text-anchor="middle" x="2340.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_1&#45;&gt;gate_6_1 -->
<g id="edge396" class="edge">
<title>attention_6_1&#45;&gt;gate_6_1</title>
<path fill="none" stroke="black" d="M2340.5,-6963.85C2340.5,-6956.16 2340.5,-6947.35 2340.5,-6938.35"/>
<polygon fill="black" stroke="black" points="2344,-6938.16 2340.5,-6928.16 2337,-6938.16 2344,-6938.16"/>
</g>
<!-- expert_6_1 -->
<g id="node405" class="node">
<title>expert_6_1</title>
<polygon fill="lightgreen" stroke="black" points="2415,-6787.98 2266,-6787.98 2266,-6735.98 2415,-6735.98 2415,-6787.98"/>
<text text-anchor="middle" x="2340.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_6_L1</text>
<text text-anchor="middle" x="2340.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_1&#45;&gt;expert_6_1 -->
<g id="edge397" class="edge">
<title>gate_6_1&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" d="M2333.77,-6823.9C2333.69,-6815.23 2333.83,-6806.41 2334.18,-6798.27"/>
<polygon fill="black" stroke="black" points="2337.69,-6798.21 2334.77,-6788.03 2330.7,-6797.81 2337.69,-6798.21"/>
</g>
<!-- gate_6_1&#45;&gt;expert_6_1 -->
<g id="edge1154" class="edge">
<title>gate_6_1&#45;&gt;expert_6_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-6823.9C2347.31,-6815.23 2347.17,-6806.41 2346.82,-6798.27"/>
<polygon fill="red" stroke="red" points="2350.3,-6797.81 2346.23,-6788.03 2343.31,-6798.21 2350.3,-6797.81"/>
</g>
<!-- aggregate_6_1 -->
<g id="node406" class="node">
<title>aggregate_6_1</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-6699.98 2253.06,-6699.98 2192.49,-6595.98 2427.94,-6595.98 2488.51,-6699.98"/>
<text text-anchor="middle" x="2340.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L1</text>
<text text-anchor="middle" x="2340.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_1&#45;&gt;aggregate_6_1 -->
<g id="edge398" class="edge">
<title>expert_6_1&#45;&gt;aggregate_6_1</title>
<path fill="none" stroke="black" d="M2340.5,-6735.85C2340.5,-6728.16 2340.5,-6719.35 2340.5,-6710.35"/>
<polygon fill="black" stroke="black" points="2344,-6710.16 2340.5,-6700.16 2337,-6710.16 2344,-6710.16"/>
</g>
<!-- attention_6_2 -->
<g id="node407" class="node">
<title>attention_6_2</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-6559.98 2256.5,-6559.98 2256.5,-6507.98 2424.5,-6507.98 2424.5,-6559.98"/>
<text text-anchor="middle" x="2340.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_6_L2</text>
<text text-anchor="middle" x="2340.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_1&#45;&gt;attention_6_2 -->
<g id="edge399" class="edge">
<title>aggregate_6_1&#45;&gt;attention_6_2</title>
<path fill="none" stroke="black" d="M2340.5,-6595.9C2340.5,-6587.23 2340.5,-6578.41 2340.5,-6570.27"/>
<polygon fill="black" stroke="black" points="2344,-6570.03 2340.5,-6560.03 2337,-6570.03 2344,-6570.03"/>
</g>
<!-- gate_6_2 -->
<g id="node408" class="node">
<title>gate_6_2</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-6471.98 2253.06,-6471.98 2192.49,-6367.98 2427.94,-6367.98 2488.51,-6471.98"/>
<text text-anchor="middle" x="2340.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_6_L2</text>
<text text-anchor="middle" x="2340.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_2&#45;&gt;gate_6_2 -->
<g id="edge400" class="edge">
<title>attention_6_2&#45;&gt;gate_6_2</title>
<path fill="none" stroke="black" d="M2340.5,-6507.85C2340.5,-6500.16 2340.5,-6491.35 2340.5,-6482.35"/>
<polygon fill="black" stroke="black" points="2344,-6482.16 2340.5,-6472.16 2337,-6482.16 2344,-6482.16"/>
</g>
<!-- expert_6_2 -->
<g id="node409" class="node">
<title>expert_6_2</title>
<polygon fill="lightgreen" stroke="black" points="2415,-6331.98 2266,-6331.98 2266,-6279.98 2415,-6279.98 2415,-6331.98"/>
<text text-anchor="middle" x="2340.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_6_L2</text>
<text text-anchor="middle" x="2340.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_2&#45;&gt;expert_6_2 -->
<g id="edge401" class="edge">
<title>gate_6_2&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" d="M2333.77,-6367.9C2333.69,-6359.23 2333.83,-6350.41 2334.18,-6342.27"/>
<polygon fill="black" stroke="black" points="2337.69,-6342.21 2334.77,-6332.03 2330.7,-6341.81 2337.69,-6342.21"/>
</g>
<!-- gate_6_2&#45;&gt;expert_6_2 -->
<g id="edge1155" class="edge">
<title>gate_6_2&#45;&gt;expert_6_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-6367.9C2347.31,-6359.23 2347.17,-6350.41 2346.82,-6342.27"/>
<polygon fill="red" stroke="red" points="2350.3,-6341.81 2346.23,-6332.03 2343.31,-6342.21 2350.3,-6341.81"/>
</g>
<!-- aggregate_6_2 -->
<g id="node410" class="node">
<title>aggregate_6_2</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-6243.98 2253.06,-6243.98 2192.49,-6139.98 2427.94,-6139.98 2488.51,-6243.98"/>
<text text-anchor="middle" x="2340.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L2</text>
<text text-anchor="middle" x="2340.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_2&#45;&gt;aggregate_6_2 -->
<g id="edge402" class="edge">
<title>expert_6_2&#45;&gt;aggregate_6_2</title>
<path fill="none" stroke="black" d="M2340.5,-6279.85C2340.5,-6272.16 2340.5,-6263.35 2340.5,-6254.35"/>
<polygon fill="black" stroke="black" points="2344,-6254.16 2340.5,-6244.16 2337,-6254.16 2344,-6254.16"/>
</g>
<!-- attention_6_3 -->
<g id="node411" class="node">
<title>attention_6_3</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-6103.98 2256.5,-6103.98 2256.5,-6051.98 2424.5,-6051.98 2424.5,-6103.98"/>
<text text-anchor="middle" x="2340.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_6_L3</text>
<text text-anchor="middle" x="2340.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_2&#45;&gt;attention_6_3 -->
<g id="edge403" class="edge">
<title>aggregate_6_2&#45;&gt;attention_6_3</title>
<path fill="none" stroke="black" d="M2340.5,-6139.9C2340.5,-6131.23 2340.5,-6122.41 2340.5,-6114.27"/>
<polygon fill="black" stroke="black" points="2344,-6114.03 2340.5,-6104.03 2337,-6114.03 2344,-6114.03"/>
</g>
<!-- gate_6_3 -->
<g id="node412" class="node">
<title>gate_6_3</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-6015.98 2253.06,-6015.98 2192.49,-5911.98 2427.94,-5911.98 2488.51,-6015.98"/>
<text text-anchor="middle" x="2340.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_6_L3</text>
<text text-anchor="middle" x="2340.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_3&#45;&gt;gate_6_3 -->
<g id="edge404" class="edge">
<title>attention_6_3&#45;&gt;gate_6_3</title>
<path fill="none" stroke="black" d="M2340.5,-6051.85C2340.5,-6044.16 2340.5,-6035.35 2340.5,-6026.35"/>
<polygon fill="black" stroke="black" points="2344,-6026.16 2340.5,-6016.16 2337,-6026.16 2344,-6026.16"/>
</g>
<!-- expert_6_3 -->
<g id="node413" class="node">
<title>expert_6_3</title>
<polygon fill="lightgreen" stroke="black" points="2415,-5875.98 2266,-5875.98 2266,-5823.98 2415,-5823.98 2415,-5875.98"/>
<text text-anchor="middle" x="2340.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_6_L3</text>
<text text-anchor="middle" x="2340.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_3&#45;&gt;expert_6_3 -->
<g id="edge405" class="edge">
<title>gate_6_3&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" d="M2333.77,-5911.9C2333.69,-5903.23 2333.83,-5894.41 2334.18,-5886.27"/>
<polygon fill="black" stroke="black" points="2337.69,-5886.21 2334.77,-5876.03 2330.7,-5885.81 2337.69,-5886.21"/>
</g>
<!-- gate_6_3&#45;&gt;expert_6_3 -->
<g id="edge1156" class="edge">
<title>gate_6_3&#45;&gt;expert_6_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-5911.9C2347.31,-5903.23 2347.17,-5894.41 2346.82,-5886.27"/>
<polygon fill="red" stroke="red" points="2350.3,-5885.81 2346.23,-5876.03 2343.31,-5886.21 2350.3,-5885.81"/>
</g>
<!-- aggregate_6_3 -->
<g id="node414" class="node">
<title>aggregate_6_3</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-5787.98 2253.06,-5787.98 2192.49,-5683.98 2427.94,-5683.98 2488.51,-5787.98"/>
<text text-anchor="middle" x="2340.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L3</text>
<text text-anchor="middle" x="2340.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_3&#45;&gt;aggregate_6_3 -->
<g id="edge406" class="edge">
<title>expert_6_3&#45;&gt;aggregate_6_3</title>
<path fill="none" stroke="black" d="M2340.5,-5823.85C2340.5,-5816.16 2340.5,-5807.35 2340.5,-5798.35"/>
<polygon fill="black" stroke="black" points="2344,-5798.16 2340.5,-5788.16 2337,-5798.16 2344,-5798.16"/>
</g>
<!-- attention_6_4 -->
<g id="node415" class="node">
<title>attention_6_4</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-5647.98 2256.5,-5647.98 2256.5,-5595.98 2424.5,-5595.98 2424.5,-5647.98"/>
<text text-anchor="middle" x="2340.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_6_L4</text>
<text text-anchor="middle" x="2340.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_3&#45;&gt;attention_6_4 -->
<g id="edge407" class="edge">
<title>aggregate_6_3&#45;&gt;attention_6_4</title>
<path fill="none" stroke="black" d="M2340.5,-5683.9C2340.5,-5675.23 2340.5,-5666.41 2340.5,-5658.27"/>
<polygon fill="black" stroke="black" points="2344,-5658.03 2340.5,-5648.03 2337,-5658.03 2344,-5658.03"/>
</g>
<!-- gate_6_4 -->
<g id="node416" class="node">
<title>gate_6_4</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-5559.98 2253.06,-5559.98 2192.49,-5455.98 2427.94,-5455.98 2488.51,-5559.98"/>
<text text-anchor="middle" x="2340.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_6_L4</text>
<text text-anchor="middle" x="2340.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_4&#45;&gt;gate_6_4 -->
<g id="edge408" class="edge">
<title>attention_6_4&#45;&gt;gate_6_4</title>
<path fill="none" stroke="black" d="M2340.5,-5595.85C2340.5,-5588.16 2340.5,-5579.35 2340.5,-5570.35"/>
<polygon fill="black" stroke="black" points="2344,-5570.16 2340.5,-5560.16 2337,-5570.16 2344,-5570.16"/>
</g>
<!-- expert_6_4 -->
<g id="node417" class="node">
<title>expert_6_4</title>
<polygon fill="lightgreen" stroke="black" points="2415,-5419.98 2266,-5419.98 2266,-5367.98 2415,-5367.98 2415,-5419.98"/>
<text text-anchor="middle" x="2340.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_6_L4</text>
<text text-anchor="middle" x="2340.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_4&#45;&gt;expert_6_4 -->
<g id="edge409" class="edge">
<title>gate_6_4&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" d="M2333.77,-5455.9C2333.69,-5447.23 2333.83,-5438.41 2334.18,-5430.27"/>
<polygon fill="black" stroke="black" points="2337.69,-5430.21 2334.77,-5420.03 2330.7,-5429.81 2337.69,-5430.21"/>
</g>
<!-- gate_6_4&#45;&gt;expert_6_4 -->
<g id="edge1157" class="edge">
<title>gate_6_4&#45;&gt;expert_6_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-5455.9C2347.31,-5447.23 2347.17,-5438.41 2346.82,-5430.27"/>
<polygon fill="red" stroke="red" points="2350.3,-5429.81 2346.23,-5420.03 2343.31,-5430.21 2350.3,-5429.81"/>
</g>
<!-- aggregate_6_4 -->
<g id="node418" class="node">
<title>aggregate_6_4</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-5331.98 2253.06,-5331.98 2192.49,-5227.98 2427.94,-5227.98 2488.51,-5331.98"/>
<text text-anchor="middle" x="2340.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L4</text>
<text text-anchor="middle" x="2340.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_4&#45;&gt;aggregate_6_4 -->
<g id="edge410" class="edge">
<title>expert_6_4&#45;&gt;aggregate_6_4</title>
<path fill="none" stroke="black" d="M2340.5,-5367.85C2340.5,-5360.16 2340.5,-5351.35 2340.5,-5342.35"/>
<polygon fill="black" stroke="black" points="2344,-5342.16 2340.5,-5332.16 2337,-5342.16 2344,-5342.16"/>
</g>
<!-- attention_6_5 -->
<g id="node419" class="node">
<title>attention_6_5</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-5191.98 2256.5,-5191.98 2256.5,-5139.98 2424.5,-5139.98 2424.5,-5191.98"/>
<text text-anchor="middle" x="2340.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_6_L5</text>
<text text-anchor="middle" x="2340.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_4&#45;&gt;attention_6_5 -->
<g id="edge411" class="edge">
<title>aggregate_6_4&#45;&gt;attention_6_5</title>
<path fill="none" stroke="black" d="M2340.5,-5227.9C2340.5,-5219.23 2340.5,-5210.41 2340.5,-5202.27"/>
<polygon fill="black" stroke="black" points="2344,-5202.03 2340.5,-5192.03 2337,-5202.03 2344,-5202.03"/>
</g>
<!-- gate_6_5 -->
<g id="node420" class="node">
<title>gate_6_5</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-5103.98 2253.06,-5103.98 2192.49,-4999.98 2427.94,-4999.98 2488.51,-5103.98"/>
<text text-anchor="middle" x="2340.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_6_L5</text>
<text text-anchor="middle" x="2340.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_5&#45;&gt;gate_6_5 -->
<g id="edge412" class="edge">
<title>attention_6_5&#45;&gt;gate_6_5</title>
<path fill="none" stroke="black" d="M2340.5,-5139.85C2340.5,-5132.16 2340.5,-5123.35 2340.5,-5114.35"/>
<polygon fill="black" stroke="black" points="2344,-5114.16 2340.5,-5104.16 2337,-5114.16 2344,-5114.16"/>
</g>
<!-- expert_6_5 -->
<g id="node421" class="node">
<title>expert_6_5</title>
<polygon fill="lightgreen" stroke="black" points="2415,-4963.98 2266,-4963.98 2266,-4911.98 2415,-4911.98 2415,-4963.98"/>
<text text-anchor="middle" x="2340.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_6_L5</text>
<text text-anchor="middle" x="2340.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_5&#45;&gt;expert_6_5 -->
<g id="edge413" class="edge">
<title>gate_6_5&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" d="M2333.77,-4999.9C2333.69,-4991.23 2333.83,-4982.41 2334.18,-4974.27"/>
<polygon fill="black" stroke="black" points="2337.69,-4974.21 2334.77,-4964.03 2330.7,-4973.81 2337.69,-4974.21"/>
</g>
<!-- gate_6_5&#45;&gt;expert_6_5 -->
<g id="edge1158" class="edge">
<title>gate_6_5&#45;&gt;expert_6_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-4999.9C2347.31,-4991.23 2347.17,-4982.41 2346.82,-4974.27"/>
<polygon fill="red" stroke="red" points="2350.3,-4973.81 2346.23,-4964.03 2343.31,-4974.21 2350.3,-4973.81"/>
</g>
<!-- aggregate_6_5 -->
<g id="node422" class="node">
<title>aggregate_6_5</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-4875.98 2253.06,-4875.98 2192.49,-4771.98 2427.94,-4771.98 2488.51,-4875.98"/>
<text text-anchor="middle" x="2340.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L5</text>
<text text-anchor="middle" x="2340.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_5&#45;&gt;aggregate_6_5 -->
<g id="edge414" class="edge">
<title>expert_6_5&#45;&gt;aggregate_6_5</title>
<path fill="none" stroke="black" d="M2340.5,-4911.85C2340.5,-4904.16 2340.5,-4895.35 2340.5,-4886.35"/>
<polygon fill="black" stroke="black" points="2344,-4886.16 2340.5,-4876.16 2337,-4886.16 2344,-4886.16"/>
</g>
<!-- attention_6_6 -->
<g id="node423" class="node">
<title>attention_6_6</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-4735.98 2256.5,-4735.98 2256.5,-4683.98 2424.5,-4683.98 2424.5,-4735.98"/>
<text text-anchor="middle" x="2340.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_6_L6</text>
<text text-anchor="middle" x="2340.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_5&#45;&gt;attention_6_6 -->
<g id="edge415" class="edge">
<title>aggregate_6_5&#45;&gt;attention_6_6</title>
<path fill="none" stroke="black" d="M2340.5,-4771.9C2340.5,-4763.23 2340.5,-4754.41 2340.5,-4746.27"/>
<polygon fill="black" stroke="black" points="2344,-4746.03 2340.5,-4736.03 2337,-4746.03 2344,-4746.03"/>
</g>
<!-- gate_6_6 -->
<g id="node424" class="node">
<title>gate_6_6</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-4647.98 2253.06,-4647.98 2192.49,-4543.98 2427.94,-4543.98 2488.51,-4647.98"/>
<text text-anchor="middle" x="2340.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_6_L6</text>
<text text-anchor="middle" x="2340.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_6&#45;&gt;gate_6_6 -->
<g id="edge416" class="edge">
<title>attention_6_6&#45;&gt;gate_6_6</title>
<path fill="none" stroke="black" d="M2340.5,-4683.85C2340.5,-4676.16 2340.5,-4667.35 2340.5,-4658.35"/>
<polygon fill="black" stroke="black" points="2344,-4658.16 2340.5,-4648.16 2337,-4658.16 2344,-4658.16"/>
</g>
<!-- expert_6_6 -->
<g id="node425" class="node">
<title>expert_6_6</title>
<polygon fill="lightgreen" stroke="black" points="2415,-4507.98 2266,-4507.98 2266,-4455.98 2415,-4455.98 2415,-4507.98"/>
<text text-anchor="middle" x="2340.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_6_L6</text>
<text text-anchor="middle" x="2340.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_6&#45;&gt;expert_6_6 -->
<g id="edge417" class="edge">
<title>gate_6_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" d="M2333.77,-4543.9C2333.69,-4535.23 2333.83,-4526.41 2334.18,-4518.27"/>
<polygon fill="black" stroke="black" points="2337.69,-4518.21 2334.77,-4508.03 2330.7,-4517.81 2337.69,-4518.21"/>
</g>
<!-- gate_6_6&#45;&gt;expert_6_6 -->
<g id="edge1159" class="edge">
<title>gate_6_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-4543.9C2347.31,-4535.23 2347.17,-4526.41 2346.82,-4518.27"/>
<polygon fill="red" stroke="red" points="2350.3,-4517.81 2346.23,-4508.03 2343.31,-4518.21 2350.3,-4517.81"/>
</g>
<!-- aggregate_6_6 -->
<g id="node426" class="node">
<title>aggregate_6_6</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-4419.98 2253.06,-4419.98 2192.49,-4315.98 2427.94,-4315.98 2488.51,-4419.98"/>
<text text-anchor="middle" x="2340.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L6</text>
<text text-anchor="middle" x="2340.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_6&#45;&gt;aggregate_6_6 -->
<g id="edge418" class="edge">
<title>expert_6_6&#45;&gt;aggregate_6_6</title>
<path fill="none" stroke="black" d="M2340.5,-4455.85C2340.5,-4448.16 2340.5,-4439.35 2340.5,-4430.35"/>
<polygon fill="black" stroke="black" points="2344,-4430.16 2340.5,-4420.16 2337,-4430.16 2344,-4430.16"/>
</g>
<!-- attention_6_7 -->
<g id="node427" class="node">
<title>attention_6_7</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-4279.98 2256.5,-4279.98 2256.5,-4227.98 2424.5,-4227.98 2424.5,-4279.98"/>
<text text-anchor="middle" x="2340.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_6_L7</text>
<text text-anchor="middle" x="2340.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_6&#45;&gt;attention_6_7 -->
<g id="edge419" class="edge">
<title>aggregate_6_6&#45;&gt;attention_6_7</title>
<path fill="none" stroke="black" d="M2340.5,-4315.9C2340.5,-4307.23 2340.5,-4298.41 2340.5,-4290.27"/>
<polygon fill="black" stroke="black" points="2344,-4290.03 2340.5,-4280.03 2337,-4290.03 2344,-4290.03"/>
</g>
<!-- gate_6_7 -->
<g id="node428" class="node">
<title>gate_6_7</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-4191.98 2253.06,-4191.98 2192.49,-4087.98 2427.94,-4087.98 2488.51,-4191.98"/>
<text text-anchor="middle" x="2340.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_6_L7</text>
<text text-anchor="middle" x="2340.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_7&#45;&gt;gate_6_7 -->
<g id="edge420" class="edge">
<title>attention_6_7&#45;&gt;gate_6_7</title>
<path fill="none" stroke="black" d="M2340.5,-4227.85C2340.5,-4220.16 2340.5,-4211.35 2340.5,-4202.35"/>
<polygon fill="black" stroke="black" points="2344,-4202.16 2340.5,-4192.16 2337,-4202.16 2344,-4202.16"/>
</g>
<!-- expert_6_7 -->
<g id="node429" class="node">
<title>expert_6_7</title>
<polygon fill="lightgreen" stroke="black" points="2415,-4051.98 2266,-4051.98 2266,-3999.98 2415,-3999.98 2415,-4051.98"/>
<text text-anchor="middle" x="2340.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_6_L7</text>
<text text-anchor="middle" x="2340.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_7&#45;&gt;expert_6_7 -->
<g id="edge421" class="edge">
<title>gate_6_7&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" d="M2333.77,-4087.9C2333.69,-4079.23 2333.83,-4070.41 2334.18,-4062.27"/>
<polygon fill="black" stroke="black" points="2337.69,-4062.21 2334.77,-4052.03 2330.7,-4061.81 2337.69,-4062.21"/>
</g>
<!-- gate_6_7&#45;&gt;expert_6_7 -->
<g id="edge1160" class="edge">
<title>gate_6_7&#45;&gt;expert_6_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-4087.9C2347.31,-4079.23 2347.17,-4070.41 2346.82,-4062.27"/>
<polygon fill="red" stroke="red" points="2350.3,-4061.81 2346.23,-4052.03 2343.31,-4062.21 2350.3,-4061.81"/>
</g>
<!-- aggregate_6_7 -->
<g id="node430" class="node">
<title>aggregate_6_7</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-3963.98 2253.06,-3963.98 2192.49,-3859.98 2427.94,-3859.98 2488.51,-3963.98"/>
<text text-anchor="middle" x="2340.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L7</text>
<text text-anchor="middle" x="2340.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_7&#45;&gt;aggregate_6_7 -->
<g id="edge422" class="edge">
<title>expert_6_7&#45;&gt;aggregate_6_7</title>
<path fill="none" stroke="black" d="M2340.5,-3999.85C2340.5,-3992.16 2340.5,-3983.35 2340.5,-3974.35"/>
<polygon fill="black" stroke="black" points="2344,-3974.16 2340.5,-3964.16 2337,-3974.16 2344,-3974.16"/>
</g>
<!-- attention_6_8 -->
<g id="node431" class="node">
<title>attention_6_8</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-3823.98 2256.5,-3823.98 2256.5,-3771.98 2424.5,-3771.98 2424.5,-3823.98"/>
<text text-anchor="middle" x="2340.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_6_L8</text>
<text text-anchor="middle" x="2340.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_7&#45;&gt;attention_6_8 -->
<g id="edge423" class="edge">
<title>aggregate_6_7&#45;&gt;attention_6_8</title>
<path fill="none" stroke="black" d="M2340.5,-3859.9C2340.5,-3851.23 2340.5,-3842.41 2340.5,-3834.27"/>
<polygon fill="black" stroke="black" points="2344,-3834.03 2340.5,-3824.03 2337,-3834.03 2344,-3834.03"/>
</g>
<!-- gate_6_8 -->
<g id="node432" class="node">
<title>gate_6_8</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-3735.98 2253.06,-3735.98 2192.49,-3631.98 2427.94,-3631.98 2488.51,-3735.98"/>
<text text-anchor="middle" x="2340.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_6_L8</text>
<text text-anchor="middle" x="2340.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_8&#45;&gt;gate_6_8 -->
<g id="edge424" class="edge">
<title>attention_6_8&#45;&gt;gate_6_8</title>
<path fill="none" stroke="black" d="M2340.5,-3771.85C2340.5,-3764.16 2340.5,-3755.35 2340.5,-3746.35"/>
<polygon fill="black" stroke="black" points="2344,-3746.16 2340.5,-3736.16 2337,-3746.16 2344,-3746.16"/>
</g>
<!-- expert_6_8 -->
<g id="node433" class="node">
<title>expert_6_8</title>
<polygon fill="lightgreen" stroke="black" points="2415,-3595.98 2266,-3595.98 2266,-3543.98 2415,-3543.98 2415,-3595.98"/>
<text text-anchor="middle" x="2340.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_6_L8</text>
<text text-anchor="middle" x="2340.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_8&#45;&gt;expert_6_8 -->
<g id="edge425" class="edge">
<title>gate_6_8&#45;&gt;expert_6_8</title>
<path fill="none" stroke="black" d="M2333.77,-3631.9C2333.69,-3623.23 2333.83,-3614.41 2334.18,-3606.27"/>
<polygon fill="black" stroke="black" points="2337.69,-3606.21 2334.77,-3596.03 2330.7,-3605.81 2337.69,-3606.21"/>
</g>
<!-- gate_6_8&#45;&gt;expert_6_8 -->
<g id="edge1161" class="edge">
<title>gate_6_8&#45;&gt;expert_6_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-3631.9C2347.31,-3623.23 2347.17,-3614.41 2346.82,-3606.27"/>
<polygon fill="red" stroke="red" points="2350.3,-3605.81 2346.23,-3596.03 2343.31,-3606.21 2350.3,-3605.81"/>
</g>
<!-- aggregate_6_8 -->
<g id="node434" class="node">
<title>aggregate_6_8</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-3507.98 2253.06,-3507.98 2192.49,-3403.98 2427.94,-3403.98 2488.51,-3507.98"/>
<text text-anchor="middle" x="2340.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L8</text>
<text text-anchor="middle" x="2340.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_8&#45;&gt;aggregate_6_8 -->
<g id="edge426" class="edge">
<title>expert_6_8&#45;&gt;aggregate_6_8</title>
<path fill="none" stroke="black" d="M2340.5,-3543.85C2340.5,-3536.16 2340.5,-3527.35 2340.5,-3518.35"/>
<polygon fill="black" stroke="black" points="2344,-3518.16 2340.5,-3508.16 2337,-3518.16 2344,-3518.16"/>
</g>
<!-- attention_6_9 -->
<g id="node435" class="node">
<title>attention_6_9</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-3367.98 2256.5,-3367.98 2256.5,-3315.98 2424.5,-3315.98 2424.5,-3367.98"/>
<text text-anchor="middle" x="2340.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_6_L9</text>
<text text-anchor="middle" x="2340.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_8&#45;&gt;attention_6_9 -->
<g id="edge427" class="edge">
<title>aggregate_6_8&#45;&gt;attention_6_9</title>
<path fill="none" stroke="black" d="M2340.5,-3403.9C2340.5,-3395.23 2340.5,-3386.41 2340.5,-3378.27"/>
<polygon fill="black" stroke="black" points="2344,-3378.03 2340.5,-3368.03 2337,-3378.03 2344,-3378.03"/>
</g>
<!-- gate_6_9 -->
<g id="node436" class="node">
<title>gate_6_9</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-3279.98 2253.06,-3279.98 2192.49,-3175.98 2427.94,-3175.98 2488.51,-3279.98"/>
<text text-anchor="middle" x="2340.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_6_L9</text>
<text text-anchor="middle" x="2340.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_9&#45;&gt;gate_6_9 -->
<g id="edge428" class="edge">
<title>attention_6_9&#45;&gt;gate_6_9</title>
<path fill="none" stroke="black" d="M2340.5,-3315.85C2340.5,-3308.16 2340.5,-3299.35 2340.5,-3290.35"/>
<polygon fill="black" stroke="black" points="2344,-3290.16 2340.5,-3280.16 2337,-3290.16 2344,-3290.16"/>
</g>
<!-- expert_6_9 -->
<g id="node437" class="node">
<title>expert_6_9</title>
<polygon fill="lightgreen" stroke="black" points="2415,-3139.98 2266,-3139.98 2266,-3087.98 2415,-3087.98 2415,-3139.98"/>
<text text-anchor="middle" x="2340.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_6_L9</text>
<text text-anchor="middle" x="2340.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_9&#45;&gt;expert_6_9 -->
<g id="edge429" class="edge">
<title>gate_6_9&#45;&gt;expert_6_9</title>
<path fill="none" stroke="black" d="M2333.77,-3175.9C2333.69,-3167.23 2333.83,-3158.41 2334.18,-3150.27"/>
<polygon fill="black" stroke="black" points="2337.69,-3150.21 2334.77,-3140.03 2330.7,-3149.81 2337.69,-3150.21"/>
</g>
<!-- gate_6_9&#45;&gt;expert_6_9 -->
<g id="edge1162" class="edge">
<title>gate_6_9&#45;&gt;expert_6_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-3175.9C2347.31,-3167.23 2347.17,-3158.41 2346.82,-3150.27"/>
<polygon fill="red" stroke="red" points="2350.3,-3149.81 2346.23,-3140.03 2343.31,-3150.21 2350.3,-3149.81"/>
</g>
<!-- aggregate_6_9 -->
<g id="node438" class="node">
<title>aggregate_6_9</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-3051.98 2253.06,-3051.98 2192.49,-2947.98 2427.94,-2947.98 2488.51,-3051.98"/>
<text text-anchor="middle" x="2340.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L9</text>
<text text-anchor="middle" x="2340.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_9&#45;&gt;aggregate_6_9 -->
<g id="edge430" class="edge">
<title>expert_6_9&#45;&gt;aggregate_6_9</title>
<path fill="none" stroke="black" d="M2340.5,-3087.85C2340.5,-3080.16 2340.5,-3071.35 2340.5,-3062.35"/>
<polygon fill="black" stroke="black" points="2344,-3062.16 2340.5,-3052.16 2337,-3062.16 2344,-3062.16"/>
</g>
<!-- attention_6_10 -->
<g id="node439" class="node">
<title>attention_6_10</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-2911.98 2256.5,-2911.98 2256.5,-2859.98 2424.5,-2859.98 2424.5,-2911.98"/>
<text text-anchor="middle" x="2340.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_6_L10</text>
<text text-anchor="middle" x="2340.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_9&#45;&gt;attention_6_10 -->
<g id="edge431" class="edge">
<title>aggregate_6_9&#45;&gt;attention_6_10</title>
<path fill="none" stroke="black" d="M2340.5,-2947.9C2340.5,-2939.23 2340.5,-2930.41 2340.5,-2922.27"/>
<polygon fill="black" stroke="black" points="2344,-2922.03 2340.5,-2912.03 2337,-2922.03 2344,-2922.03"/>
</g>
<!-- gate_6_10 -->
<g id="node440" class="node">
<title>gate_6_10</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-2823.98 2253.06,-2823.98 2192.49,-2719.98 2427.94,-2719.98 2488.51,-2823.98"/>
<text text-anchor="middle" x="2340.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_6_L10</text>
<text text-anchor="middle" x="2340.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_10&#45;&gt;gate_6_10 -->
<g id="edge432" class="edge">
<title>attention_6_10&#45;&gt;gate_6_10</title>
<path fill="none" stroke="black" d="M2340.5,-2859.85C2340.5,-2852.16 2340.5,-2843.35 2340.5,-2834.35"/>
<polygon fill="black" stroke="black" points="2344,-2834.16 2340.5,-2824.16 2337,-2834.16 2344,-2834.16"/>
</g>
<!-- expert_6_10 -->
<g id="node441" class="node">
<title>expert_6_10</title>
<polygon fill="lightgreen" stroke="black" points="2415,-2683.98 2266,-2683.98 2266,-2631.98 2415,-2631.98 2415,-2683.98"/>
<text text-anchor="middle" x="2340.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_6_L10</text>
<text text-anchor="middle" x="2340.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_10&#45;&gt;expert_6_10 -->
<g id="edge433" class="edge">
<title>gate_6_10&#45;&gt;expert_6_10</title>
<path fill="none" stroke="black" d="M2333.77,-2719.9C2333.69,-2711.23 2333.83,-2702.41 2334.18,-2694.27"/>
<polygon fill="black" stroke="black" points="2337.69,-2694.21 2334.77,-2684.03 2330.7,-2693.81 2337.69,-2694.21"/>
</g>
<!-- gate_6_10&#45;&gt;expert_6_10 -->
<g id="edge1163" class="edge">
<title>gate_6_10&#45;&gt;expert_6_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-2719.9C2347.31,-2711.23 2347.17,-2702.41 2346.82,-2694.27"/>
<polygon fill="red" stroke="red" points="2350.3,-2693.81 2346.23,-2684.03 2343.31,-2694.21 2350.3,-2693.81"/>
</g>
<!-- aggregate_6_10 -->
<g id="node442" class="node">
<title>aggregate_6_10</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-2595.98 2253.06,-2595.98 2192.49,-2491.98 2427.94,-2491.98 2488.51,-2595.98"/>
<text text-anchor="middle" x="2340.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L10</text>
<text text-anchor="middle" x="2340.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_10&#45;&gt;aggregate_6_10 -->
<g id="edge434" class="edge">
<title>expert_6_10&#45;&gt;aggregate_6_10</title>
<path fill="none" stroke="black" d="M2340.5,-2631.85C2340.5,-2624.16 2340.5,-2615.35 2340.5,-2606.35"/>
<polygon fill="black" stroke="black" points="2344,-2606.16 2340.5,-2596.16 2337,-2606.16 2344,-2606.16"/>
</g>
<!-- attention_6_11 -->
<g id="node443" class="node">
<title>attention_6_11</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-2455.98 2256.5,-2455.98 2256.5,-2403.98 2424.5,-2403.98 2424.5,-2455.98"/>
<text text-anchor="middle" x="2340.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_6_L11</text>
<text text-anchor="middle" x="2340.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_10&#45;&gt;attention_6_11 -->
<g id="edge435" class="edge">
<title>aggregate_6_10&#45;&gt;attention_6_11</title>
<path fill="none" stroke="black" d="M2340.5,-2491.9C2340.5,-2483.23 2340.5,-2474.41 2340.5,-2466.27"/>
<polygon fill="black" stroke="black" points="2344,-2466.03 2340.5,-2456.03 2337,-2466.03 2344,-2466.03"/>
</g>
<!-- gate_6_11 -->
<g id="node444" class="node">
<title>gate_6_11</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-2367.98 2253.06,-2367.98 2192.49,-2263.98 2427.94,-2263.98 2488.51,-2367.98"/>
<text text-anchor="middle" x="2340.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_6_L11</text>
<text text-anchor="middle" x="2340.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_11&#45;&gt;gate_6_11 -->
<g id="edge436" class="edge">
<title>attention_6_11&#45;&gt;gate_6_11</title>
<path fill="none" stroke="black" d="M2340.5,-2403.85C2340.5,-2396.16 2340.5,-2387.35 2340.5,-2378.35"/>
<polygon fill="black" stroke="black" points="2344,-2378.16 2340.5,-2368.16 2337,-2378.16 2344,-2378.16"/>
</g>
<!-- expert_6_11 -->
<g id="node445" class="node">
<title>expert_6_11</title>
<polygon fill="lightgreen" stroke="black" points="2415,-2227.98 2266,-2227.98 2266,-2175.98 2415,-2175.98 2415,-2227.98"/>
<text text-anchor="middle" x="2340.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_6_L11</text>
<text text-anchor="middle" x="2340.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_11&#45;&gt;expert_6_11 -->
<g id="edge437" class="edge">
<title>gate_6_11&#45;&gt;expert_6_11</title>
<path fill="none" stroke="black" d="M2333.77,-2263.9C2333.69,-2255.23 2333.83,-2246.41 2334.18,-2238.27"/>
<polygon fill="black" stroke="black" points="2337.69,-2238.21 2334.77,-2228.03 2330.7,-2237.81 2337.69,-2238.21"/>
</g>
<!-- gate_6_11&#45;&gt;expert_6_11 -->
<g id="edge1164" class="edge">
<title>gate_6_11&#45;&gt;expert_6_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-2263.9C2347.31,-2255.23 2347.17,-2246.41 2346.82,-2238.27"/>
<polygon fill="red" stroke="red" points="2350.3,-2237.81 2346.23,-2228.03 2343.31,-2238.21 2350.3,-2237.81"/>
</g>
<!-- aggregate_6_11 -->
<g id="node446" class="node">
<title>aggregate_6_11</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-2139.98 2253.06,-2139.98 2192.49,-2035.98 2427.94,-2035.98 2488.51,-2139.98"/>
<text text-anchor="middle" x="2340.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L11</text>
<text text-anchor="middle" x="2340.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_11&#45;&gt;aggregate_6_11 -->
<g id="edge438" class="edge">
<title>expert_6_11&#45;&gt;aggregate_6_11</title>
<path fill="none" stroke="black" d="M2340.5,-2175.85C2340.5,-2168.16 2340.5,-2159.35 2340.5,-2150.35"/>
<polygon fill="black" stroke="black" points="2344,-2150.16 2340.5,-2140.16 2337,-2150.16 2344,-2150.16"/>
</g>
<!-- attention_6_12 -->
<g id="node447" class="node">
<title>attention_6_12</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-1999.98 2256.5,-1999.98 2256.5,-1947.98 2424.5,-1947.98 2424.5,-1999.98"/>
<text text-anchor="middle" x="2340.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_6_L12</text>
<text text-anchor="middle" x="2340.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_11&#45;&gt;attention_6_12 -->
<g id="edge439" class="edge">
<title>aggregate_6_11&#45;&gt;attention_6_12</title>
<path fill="none" stroke="black" d="M2340.5,-2035.9C2340.5,-2027.23 2340.5,-2018.41 2340.5,-2010.27"/>
<polygon fill="black" stroke="black" points="2344,-2010.03 2340.5,-2000.03 2337,-2010.03 2344,-2010.03"/>
</g>
<!-- gate_6_12 -->
<g id="node448" class="node">
<title>gate_6_12</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-1911.98 2253.06,-1911.98 2192.49,-1807.98 2427.94,-1807.98 2488.51,-1911.98"/>
<text text-anchor="middle" x="2340.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_6_L12</text>
<text text-anchor="middle" x="2340.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_12&#45;&gt;gate_6_12 -->
<g id="edge440" class="edge">
<title>attention_6_12&#45;&gt;gate_6_12</title>
<path fill="none" stroke="black" d="M2340.5,-1947.85C2340.5,-1940.16 2340.5,-1931.35 2340.5,-1922.35"/>
<polygon fill="black" stroke="black" points="2344,-1922.16 2340.5,-1912.16 2337,-1922.16 2344,-1922.16"/>
</g>
<!-- expert_6_12 -->
<g id="node449" class="node">
<title>expert_6_12</title>
<polygon fill="lightgreen" stroke="black" points="2415,-1771.98 2266,-1771.98 2266,-1719.98 2415,-1719.98 2415,-1771.98"/>
<text text-anchor="middle" x="2340.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_6_L12</text>
<text text-anchor="middle" x="2340.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_12&#45;&gt;expert_6_12 -->
<g id="edge441" class="edge">
<title>gate_6_12&#45;&gt;expert_6_12</title>
<path fill="none" stroke="black" d="M2333.77,-1807.9C2333.69,-1799.23 2333.83,-1790.41 2334.18,-1782.27"/>
<polygon fill="black" stroke="black" points="2337.69,-1782.21 2334.77,-1772.03 2330.7,-1781.81 2337.69,-1782.21"/>
</g>
<!-- gate_6_12&#45;&gt;expert_6_12 -->
<g id="edge1165" class="edge">
<title>gate_6_12&#45;&gt;expert_6_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-1807.9C2347.31,-1799.23 2347.17,-1790.41 2346.82,-1782.27"/>
<polygon fill="red" stroke="red" points="2350.3,-1781.81 2346.23,-1772.03 2343.31,-1782.21 2350.3,-1781.81"/>
</g>
<!-- aggregate_6_12 -->
<g id="node450" class="node">
<title>aggregate_6_12</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-1683.98 2253.06,-1683.98 2192.49,-1579.98 2427.94,-1579.98 2488.51,-1683.98"/>
<text text-anchor="middle" x="2340.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L12</text>
<text text-anchor="middle" x="2340.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_12&#45;&gt;aggregate_6_12 -->
<g id="edge442" class="edge">
<title>expert_6_12&#45;&gt;aggregate_6_12</title>
<path fill="none" stroke="black" d="M2340.5,-1719.85C2340.5,-1712.16 2340.5,-1703.35 2340.5,-1694.35"/>
<polygon fill="black" stroke="black" points="2344,-1694.16 2340.5,-1684.16 2337,-1694.16 2344,-1694.16"/>
</g>
<!-- attention_6_13 -->
<g id="node451" class="node">
<title>attention_6_13</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-1543.98 2256.5,-1543.98 2256.5,-1491.98 2424.5,-1491.98 2424.5,-1543.98"/>
<text text-anchor="middle" x="2340.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_6_L13</text>
<text text-anchor="middle" x="2340.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_12&#45;&gt;attention_6_13 -->
<g id="edge443" class="edge">
<title>aggregate_6_12&#45;&gt;attention_6_13</title>
<path fill="none" stroke="black" d="M2340.5,-1579.9C2340.5,-1571.23 2340.5,-1562.41 2340.5,-1554.27"/>
<polygon fill="black" stroke="black" points="2344,-1554.03 2340.5,-1544.03 2337,-1554.03 2344,-1554.03"/>
</g>
<!-- gate_6_13 -->
<g id="node452" class="node">
<title>gate_6_13</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-1455.98 2253.06,-1455.98 2192.49,-1351.98 2427.94,-1351.98 2488.51,-1455.98"/>
<text text-anchor="middle" x="2340.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_6_L13</text>
<text text-anchor="middle" x="2340.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_13&#45;&gt;gate_6_13 -->
<g id="edge444" class="edge">
<title>attention_6_13&#45;&gt;gate_6_13</title>
<path fill="none" stroke="black" d="M2340.5,-1491.85C2340.5,-1484.16 2340.5,-1475.35 2340.5,-1466.35"/>
<polygon fill="black" stroke="black" points="2344,-1466.16 2340.5,-1456.16 2337,-1466.16 2344,-1466.16"/>
</g>
<!-- expert_6_13 -->
<g id="node453" class="node">
<title>expert_6_13</title>
<polygon fill="lightgreen" stroke="black" points="2415,-1315.98 2266,-1315.98 2266,-1263.98 2415,-1263.98 2415,-1315.98"/>
<text text-anchor="middle" x="2340.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_6_L13</text>
<text text-anchor="middle" x="2340.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2340.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_13&#45;&gt;expert_6_13 -->
<g id="edge445" class="edge">
<title>gate_6_13&#45;&gt;expert_6_13</title>
<path fill="none" stroke="black" d="M2333.77,-1351.9C2333.69,-1343.23 2333.83,-1334.41 2334.18,-1326.27"/>
<polygon fill="black" stroke="black" points="2337.69,-1326.21 2334.77,-1316.03 2330.7,-1325.81 2337.69,-1326.21"/>
</g>
<!-- gate_6_13&#45;&gt;expert_6_13 -->
<g id="edge1166" class="edge">
<title>gate_6_13&#45;&gt;expert_6_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.23,-1351.9C2347.31,-1343.23 2347.17,-1334.41 2346.82,-1326.27"/>
<polygon fill="red" stroke="red" points="2350.3,-1325.81 2346.23,-1316.03 2343.31,-1326.21 2350.3,-1325.81"/>
</g>
<!-- aggregate_6_13 -->
<g id="node454" class="node">
<title>aggregate_6_13</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-1227.98 2253.06,-1227.98 2192.49,-1123.98 2427.94,-1123.98 2488.51,-1227.98"/>
<text text-anchor="middle" x="2340.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L13</text>
<text text-anchor="middle" x="2340.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2340.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2340.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_13&#45;&gt;aggregate_6_13 -->
<g id="edge446" class="edge">
<title>expert_6_13&#45;&gt;aggregate_6_13</title>
<path fill="none" stroke="black" d="M2340.5,-1263.85C2340.5,-1256.16 2340.5,-1247.35 2340.5,-1238.35"/>
<polygon fill="black" stroke="black" points="2344,-1238.16 2340.5,-1228.16 2337,-1238.16 2344,-1238.16"/>
</g>
<!-- attention_6_14 -->
<g id="node455" class="node">
<title>attention_6_14</title>
<polygon fill="lightgreen" stroke="black" points="2424.5,-1087.98 2256.5,-1087.98 2256.5,-1035.98 2424.5,-1035.98 2424.5,-1087.98"/>
<text text-anchor="middle" x="2340.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_6_L14</text>
<text text-anchor="middle" x="2340.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2340.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2340.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_13&#45;&gt;attention_6_14 -->
<g id="edge447" class="edge">
<title>aggregate_6_13&#45;&gt;attention_6_14</title>
<path fill="none" stroke="black" d="M2340.5,-1123.9C2340.5,-1115.23 2340.5,-1106.41 2340.5,-1098.27"/>
<polygon fill="black" stroke="black" points="2344,-1098.03 2340.5,-1088.03 2337,-1098.03 2344,-1098.03"/>
</g>
<!-- gate_6_14 -->
<g id="node456" class="node">
<title>gate_6_14</title>
<polygon fill="lightyellow" stroke="black" points="2488.51,-999.98 2253.06,-999.98 2192.49,-895.98 2427.94,-895.98 2488.51,-999.98"/>
<text text-anchor="middle" x="2340.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_6_L14</text>
<text text-anchor="middle" x="2340.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2340.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2340.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_14&#45;&gt;gate_6_14 -->
<g id="edge448" class="edge">
<title>attention_6_14&#45;&gt;gate_6_14</title>
<path fill="none" stroke="black" d="M2340.5,-1035.85C2340.5,-1028.16 2340.5,-1019.35 2340.5,-1010.35"/>
<polygon fill="black" stroke="black" points="2344,-1010.16 2340.5,-1000.16 2337,-1010.16 2344,-1010.16"/>
</g>
<!-- expert_6_14 -->
<g id="node457" class="node">
<title>expert_6_14</title>
<polygon fill="lightgreen" stroke="black" points="2416,-859.98 2267,-859.98 2267,-807.98 2416,-807.98 2416,-859.98"/>
<text text-anchor="middle" x="2341.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_6_L14</text>
<text text-anchor="middle" x="2341.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2341.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2341.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_14&#45;&gt;expert_6_14 -->
<g id="edge449" class="edge">
<title>gate_6_14&#45;&gt;expert_6_14</title>
<path fill="none" stroke="black" d="M2334.23,-895.9C2334.23,-887.23 2334.44,-878.41 2334.86,-870.27"/>
<polygon fill="black" stroke="black" points="2338.37,-870.24 2335.54,-860.03 2331.39,-869.77 2338.37,-870.24"/>
</g>
<!-- gate_6_14&#45;&gt;expert_6_14 -->
<g id="edge1167" class="edge">
<title>gate_6_14&#45;&gt;expert_6_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2347.68,-895.9C2347.84,-887.23 2347.79,-878.41 2347.51,-870.27"/>
<polygon fill="red" stroke="red" points="2350.99,-869.85 2347.01,-860.03 2344,-870.18 2350.99,-869.85"/>
</g>
<!-- aggregate_6_14 -->
<g id="node458" class="node">
<title>aggregate_6_14</title>
<polygon fill="lightyellow" stroke="black" points="2489.51,-771.98 2254.06,-771.98 2193.49,-667.98 2428.94,-667.98 2489.51,-771.98"/>
<text text-anchor="middle" x="2341.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L14</text>
<text text-anchor="middle" x="2341.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2341.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2341.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_14&#45;&gt;aggregate_6_14 -->
<g id="edge450" class="edge">
<title>expert_6_14&#45;&gt;aggregate_6_14</title>
<path fill="none" stroke="black" d="M2341.5,-807.85C2341.5,-800.16 2341.5,-791.35 2341.5,-782.35"/>
<polygon fill="black" stroke="black" points="2345,-782.16 2341.5,-772.16 2338,-782.16 2345,-782.16"/>
</g>
<!-- attention_6_15 -->
<g id="node459" class="node">
<title>attention_6_15</title>
<polygon fill="lightgreen" stroke="black" points="2425.5,-631.98 2257.5,-631.98 2257.5,-579.98 2425.5,-579.98 2425.5,-631.98"/>
<text text-anchor="middle" x="2341.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_6_L15</text>
<text text-anchor="middle" x="2341.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2341.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2341.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_6_14&#45;&gt;attention_6_15 -->
<g id="edge451" class="edge">
<title>aggregate_6_14&#45;&gt;attention_6_15</title>
<path fill="none" stroke="black" d="M2341.5,-667.9C2341.5,-659.23 2341.5,-650.41 2341.5,-642.27"/>
<polygon fill="black" stroke="black" points="2345,-642.03 2341.5,-632.03 2338,-642.03 2345,-642.03"/>
</g>
<!-- gate_6_15 -->
<g id="node460" class="node">
<title>gate_6_15</title>
<polygon fill="lightyellow" stroke="black" points="2489.51,-543.98 2254.06,-543.98 2193.49,-439.98 2428.94,-439.98 2489.51,-543.98"/>
<text text-anchor="middle" x="2341.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_6_L15</text>
<text text-anchor="middle" x="2341.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2341.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2341.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_6_15&#45;&gt;gate_6_15 -->
<g id="edge452" class="edge">
<title>attention_6_15&#45;&gt;gate_6_15</title>
<path fill="none" stroke="black" d="M2341.5,-579.85C2341.5,-572.16 2341.5,-563.35 2341.5,-554.35"/>
<polygon fill="black" stroke="black" points="2345,-554.16 2341.5,-544.16 2338,-554.16 2345,-554.16"/>
</g>
<!-- expert_6_15 -->
<g id="node461" class="node">
<title>expert_6_15</title>
<polygon fill="lightgreen" stroke="black" points="2416,-403.98 2267,-403.98 2267,-351.98 2416,-351.98 2416,-403.98"/>
<text text-anchor="middle" x="2341.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_6_L15</text>
<text text-anchor="middle" x="2341.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=6</text>
<text text-anchor="middle" x="2341.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2341.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_6_15&#45;&gt;expert_6_15 -->
<g id="edge453" class="edge">
<title>gate_6_15&#45;&gt;expert_6_15</title>
<path fill="none" stroke="black" d="M2334.77,-439.9C2334.69,-431.23 2334.83,-422.41 2335.18,-414.27"/>
<polygon fill="black" stroke="black" points="2338.69,-414.21 2335.77,-404.03 2331.7,-413.81 2338.69,-414.21"/>
</g>
<!-- gate_6_15&#45;&gt;expert_6_15 -->
<g id="edge1168" class="edge">
<title>gate_6_15&#45;&gt;expert_6_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2348.23,-439.9C2348.31,-431.23 2348.17,-422.41 2347.82,-414.27"/>
<polygon fill="red" stroke="red" points="2351.3,-413.81 2347.23,-404.03 2344.31,-414.21 2351.3,-413.81"/>
</g>
<!-- aggregate_6_15 -->
<g id="node462" class="node">
<title>aggregate_6_15</title>
<polygon fill="lightyellow" stroke="black" points="2489.51,-315.98 2254.06,-315.98 2193.49,-211.98 2428.94,-211.98 2489.51,-315.98"/>
<text text-anchor="middle" x="2341.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_6_L15</text>
<text text-anchor="middle" x="2341.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2341.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2341.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_6_15&#45;&gt;aggregate_6_15 -->
<g id="edge454" class="edge">
<title>expert_6_15&#45;&gt;aggregate_6_15</title>
<path fill="none" stroke="black" d="M2341.5,-351.85C2341.5,-344.16 2341.5,-335.35 2341.5,-326.35"/>
<polygon fill="black" stroke="black" points="2345,-326.16 2341.5,-316.16 2338,-326.16 2345,-326.16"/>
</g>
<!-- collect_6 -->
<g id="node463" class="node">
<title>collect_6</title>
<polygon fill="lightyellow" stroke="black" points="2489.51,-175.98 2254.06,-175.98 2193.49,-93.98 2428.94,-93.98 2489.51,-175.98"/>
<text text-anchor="middle" x="2341.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_6</text>
<text text-anchor="middle" x="2341.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2341.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_6_15&#45;&gt;collect_6 -->
<g id="edge455" class="edge">
<title>aggregate_6_15&#45;&gt;collect_6</title>
<path fill="none" stroke="black" d="M2341.5,-211.69C2341.5,-203.27 2341.5,-194.56 2341.5,-186.17"/>
<polygon fill="black" stroke="black" points="2345,-186.14 2341.5,-176.14 2338,-186.14 2345,-186.14"/>
</g>
<!-- collect_6&#45;&gt;output -->
<g id="edge1047" class="edge">
<title>collect_6&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2439.94,-108.3C2459.63,-103.38 2480.19,-98.39 2499.5,-93.98 2570.02,-77.88 2649.9,-61.63 2711.44,-49.53"/>
<polygon fill="black" stroke="black" points="2712.4,-52.91 2721.54,-47.55 2711.06,-46.04 2712.4,-52.91"/>
</g>
<!-- distribute_7 -->
<g id="node464" class="node">
<title>distribute_7</title>
<polygon fill="lightyellow" stroke="black" points="2806.73,-7589.98 2566.16,-7589.98 2504.27,-7507.98 2744.85,-7507.98 2806.73,-7589.98"/>
<text text-anchor="middle" x="2655.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_7</text>
<text text-anchor="middle" x="2655.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="2655.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_0 -->
<g id="node465" class="node">
<title>attention_7_0</title>
<polygon fill="lightgreen" stroke="black" points="2739.5,-7471.98 2571.5,-7471.98 2571.5,-7419.98 2739.5,-7419.98 2739.5,-7471.98"/>
<text text-anchor="middle" x="2655.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_7_L0</text>
<text text-anchor="middle" x="2655.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2655.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2655.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_7&#45;&gt;attention_7_0 -->
<g id="edge456" class="edge">
<title>distribute_7&#45;&gt;attention_7_0</title>
<path fill="none" stroke="black" d="M2655.5,-7507.77C2655.5,-7499.34 2655.5,-7490.51 2655.5,-7482.27"/>
<polygon fill="black" stroke="black" points="2659,-7482.23 2655.5,-7472.23 2652,-7482.23 2659,-7482.23"/>
</g>
<!-- gate_7_0 -->
<g id="node466" class="node">
<title>gate_7_0</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-7383.98 2569.06,-7383.98 2508.49,-7279.98 2743.94,-7279.98 2804.51,-7383.98"/>
<text text-anchor="middle" x="2656.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_7_L0</text>
<text text-anchor="middle" x="2656.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_0&#45;&gt;gate_7_0 -->
<g id="edge457" class="edge">
<title>attention_7_0&#45;&gt;gate_7_0</title>
<path fill="none" stroke="black" d="M2655.73,-7419.85C2655.79,-7412.16 2655.87,-7403.35 2655.95,-7394.35"/>
<polygon fill="black" stroke="black" points="2659.45,-7394.19 2656.04,-7384.16 2652.45,-7394.13 2659.45,-7394.19"/>
</g>
<!-- expert_7_0 -->
<g id="node467" class="node">
<title>expert_7_0</title>
<polygon fill="lightgreen" stroke="black" points="2731,-7243.98 2582,-7243.98 2582,-7191.98 2731,-7191.98 2731,-7243.98"/>
<text text-anchor="middle" x="2656.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_7_L0</text>
<text text-anchor="middle" x="2656.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_0&#45;&gt;expert_7_0 -->
<g id="edge458" class="edge">
<title>gate_7_0&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" d="M2649.77,-7279.9C2649.69,-7271.23 2649.83,-7262.41 2650.18,-7254.27"/>
<polygon fill="black" stroke="black" points="2653.69,-7254.21 2650.77,-7244.03 2646.7,-7253.81 2653.69,-7254.21"/>
</g>
<!-- gate_7_0&#45;&gt;expert_7_0 -->
<g id="edge1169" class="edge">
<title>gate_7_0&#45;&gt;expert_7_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-7279.9C2663.31,-7271.23 2663.17,-7262.41 2662.82,-7254.27"/>
<polygon fill="red" stroke="red" points="2666.3,-7253.81 2662.23,-7244.03 2659.31,-7254.21 2666.3,-7253.81"/>
</g>
<!-- aggregate_7_0 -->
<g id="node468" class="node">
<title>aggregate_7_0</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-7155.98 2569.06,-7155.98 2508.49,-7051.98 2743.94,-7051.98 2804.51,-7155.98"/>
<text text-anchor="middle" x="2656.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L0</text>
<text text-anchor="middle" x="2656.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_0&#45;&gt;aggregate_7_0 -->
<g id="edge459" class="edge">
<title>expert_7_0&#45;&gt;aggregate_7_0</title>
<path fill="none" stroke="black" d="M2656.5,-7191.85C2656.5,-7184.16 2656.5,-7175.35 2656.5,-7166.35"/>
<polygon fill="black" stroke="black" points="2660,-7166.16 2656.5,-7156.16 2653,-7166.16 2660,-7166.16"/>
</g>
<!-- attention_7_1 -->
<g id="node469" class="node">
<title>attention_7_1</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-7015.98 2572.5,-7015.98 2572.5,-6963.98 2740.5,-6963.98 2740.5,-7015.98"/>
<text text-anchor="middle" x="2656.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_7_L1</text>
<text text-anchor="middle" x="2656.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_0&#45;&gt;attention_7_1 -->
<g id="edge460" class="edge">
<title>aggregate_7_0&#45;&gt;attention_7_1</title>
<path fill="none" stroke="black" d="M2656.5,-7051.9C2656.5,-7043.23 2656.5,-7034.41 2656.5,-7026.27"/>
<polygon fill="black" stroke="black" points="2660,-7026.03 2656.5,-7016.03 2653,-7026.03 2660,-7026.03"/>
</g>
<!-- gate_7_1 -->
<g id="node470" class="node">
<title>gate_7_1</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-6927.98 2569.06,-6927.98 2508.49,-6823.98 2743.94,-6823.98 2804.51,-6927.98"/>
<text text-anchor="middle" x="2656.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_7_L1</text>
<text text-anchor="middle" x="2656.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_1&#45;&gt;gate_7_1 -->
<g id="edge461" class="edge">
<title>attention_7_1&#45;&gt;gate_7_1</title>
<path fill="none" stroke="black" d="M2656.5,-6963.85C2656.5,-6956.16 2656.5,-6947.35 2656.5,-6938.35"/>
<polygon fill="black" stroke="black" points="2660,-6938.16 2656.5,-6928.16 2653,-6938.16 2660,-6938.16"/>
</g>
<!-- expert_7_1 -->
<g id="node471" class="node">
<title>expert_7_1</title>
<polygon fill="lightgreen" stroke="black" points="2731,-6787.98 2582,-6787.98 2582,-6735.98 2731,-6735.98 2731,-6787.98"/>
<text text-anchor="middle" x="2656.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_7_L1</text>
<text text-anchor="middle" x="2656.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_1&#45;&gt;expert_7_1 -->
<g id="edge462" class="edge">
<title>gate_7_1&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" d="M2649.77,-6823.9C2649.69,-6815.23 2649.83,-6806.41 2650.18,-6798.27"/>
<polygon fill="black" stroke="black" points="2653.69,-6798.21 2650.77,-6788.03 2646.7,-6797.81 2653.69,-6798.21"/>
</g>
<!-- gate_7_1&#45;&gt;expert_7_1 -->
<g id="edge1170" class="edge">
<title>gate_7_1&#45;&gt;expert_7_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-6823.9C2663.31,-6815.23 2663.17,-6806.41 2662.82,-6798.27"/>
<polygon fill="red" stroke="red" points="2666.3,-6797.81 2662.23,-6788.03 2659.31,-6798.21 2666.3,-6797.81"/>
</g>
<!-- aggregate_7_1 -->
<g id="node472" class="node">
<title>aggregate_7_1</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-6699.98 2569.06,-6699.98 2508.49,-6595.98 2743.94,-6595.98 2804.51,-6699.98"/>
<text text-anchor="middle" x="2656.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L1</text>
<text text-anchor="middle" x="2656.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_1&#45;&gt;aggregate_7_1 -->
<g id="edge463" class="edge">
<title>expert_7_1&#45;&gt;aggregate_7_1</title>
<path fill="none" stroke="black" d="M2656.5,-6735.85C2656.5,-6728.16 2656.5,-6719.35 2656.5,-6710.35"/>
<polygon fill="black" stroke="black" points="2660,-6710.16 2656.5,-6700.16 2653,-6710.16 2660,-6710.16"/>
</g>
<!-- attention_7_2 -->
<g id="node473" class="node">
<title>attention_7_2</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-6559.98 2572.5,-6559.98 2572.5,-6507.98 2740.5,-6507.98 2740.5,-6559.98"/>
<text text-anchor="middle" x="2656.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_7_L2</text>
<text text-anchor="middle" x="2656.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_1&#45;&gt;attention_7_2 -->
<g id="edge464" class="edge">
<title>aggregate_7_1&#45;&gt;attention_7_2</title>
<path fill="none" stroke="black" d="M2656.5,-6595.9C2656.5,-6587.23 2656.5,-6578.41 2656.5,-6570.27"/>
<polygon fill="black" stroke="black" points="2660,-6570.03 2656.5,-6560.03 2653,-6570.03 2660,-6570.03"/>
</g>
<!-- gate_7_2 -->
<g id="node474" class="node">
<title>gate_7_2</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-6471.98 2569.06,-6471.98 2508.49,-6367.98 2743.94,-6367.98 2804.51,-6471.98"/>
<text text-anchor="middle" x="2656.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_7_L2</text>
<text text-anchor="middle" x="2656.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_2&#45;&gt;gate_7_2 -->
<g id="edge465" class="edge">
<title>attention_7_2&#45;&gt;gate_7_2</title>
<path fill="none" stroke="black" d="M2656.5,-6507.85C2656.5,-6500.16 2656.5,-6491.35 2656.5,-6482.35"/>
<polygon fill="black" stroke="black" points="2660,-6482.16 2656.5,-6472.16 2653,-6482.16 2660,-6482.16"/>
</g>
<!-- expert_7_2 -->
<g id="node475" class="node">
<title>expert_7_2</title>
<polygon fill="lightgreen" stroke="black" points="2731,-6331.98 2582,-6331.98 2582,-6279.98 2731,-6279.98 2731,-6331.98"/>
<text text-anchor="middle" x="2656.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_7_L2</text>
<text text-anchor="middle" x="2656.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_2&#45;&gt;expert_7_2 -->
<g id="edge466" class="edge">
<title>gate_7_2&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" d="M2649.77,-6367.9C2649.69,-6359.23 2649.83,-6350.41 2650.18,-6342.27"/>
<polygon fill="black" stroke="black" points="2653.69,-6342.21 2650.77,-6332.03 2646.7,-6341.81 2653.69,-6342.21"/>
</g>
<!-- gate_7_2&#45;&gt;expert_7_2 -->
<g id="edge1171" class="edge">
<title>gate_7_2&#45;&gt;expert_7_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-6367.9C2663.31,-6359.23 2663.17,-6350.41 2662.82,-6342.27"/>
<polygon fill="red" stroke="red" points="2666.3,-6341.81 2662.23,-6332.03 2659.31,-6342.21 2666.3,-6341.81"/>
</g>
<!-- aggregate_7_2 -->
<g id="node476" class="node">
<title>aggregate_7_2</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-6243.98 2569.06,-6243.98 2508.49,-6139.98 2743.94,-6139.98 2804.51,-6243.98"/>
<text text-anchor="middle" x="2656.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L2</text>
<text text-anchor="middle" x="2656.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_2&#45;&gt;aggregate_7_2 -->
<g id="edge467" class="edge">
<title>expert_7_2&#45;&gt;aggregate_7_2</title>
<path fill="none" stroke="black" d="M2656.5,-6279.85C2656.5,-6272.16 2656.5,-6263.35 2656.5,-6254.35"/>
<polygon fill="black" stroke="black" points="2660,-6254.16 2656.5,-6244.16 2653,-6254.16 2660,-6254.16"/>
</g>
<!-- attention_7_3 -->
<g id="node477" class="node">
<title>attention_7_3</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-6103.98 2572.5,-6103.98 2572.5,-6051.98 2740.5,-6051.98 2740.5,-6103.98"/>
<text text-anchor="middle" x="2656.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_7_L3</text>
<text text-anchor="middle" x="2656.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_2&#45;&gt;attention_7_3 -->
<g id="edge468" class="edge">
<title>aggregate_7_2&#45;&gt;attention_7_3</title>
<path fill="none" stroke="black" d="M2656.5,-6139.9C2656.5,-6131.23 2656.5,-6122.41 2656.5,-6114.27"/>
<polygon fill="black" stroke="black" points="2660,-6114.03 2656.5,-6104.03 2653,-6114.03 2660,-6114.03"/>
</g>
<!-- gate_7_3 -->
<g id="node478" class="node">
<title>gate_7_3</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-6015.98 2569.06,-6015.98 2508.49,-5911.98 2743.94,-5911.98 2804.51,-6015.98"/>
<text text-anchor="middle" x="2656.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_7_L3</text>
<text text-anchor="middle" x="2656.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_3&#45;&gt;gate_7_3 -->
<g id="edge469" class="edge">
<title>attention_7_3&#45;&gt;gate_7_3</title>
<path fill="none" stroke="black" d="M2656.5,-6051.85C2656.5,-6044.16 2656.5,-6035.35 2656.5,-6026.35"/>
<polygon fill="black" stroke="black" points="2660,-6026.16 2656.5,-6016.16 2653,-6026.16 2660,-6026.16"/>
</g>
<!-- expert_7_3 -->
<g id="node479" class="node">
<title>expert_7_3</title>
<polygon fill="lightgreen" stroke="black" points="2731,-5875.98 2582,-5875.98 2582,-5823.98 2731,-5823.98 2731,-5875.98"/>
<text text-anchor="middle" x="2656.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_7_L3</text>
<text text-anchor="middle" x="2656.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_3&#45;&gt;expert_7_3 -->
<g id="edge470" class="edge">
<title>gate_7_3&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" d="M2649.77,-5911.9C2649.69,-5903.23 2649.83,-5894.41 2650.18,-5886.27"/>
<polygon fill="black" stroke="black" points="2653.69,-5886.21 2650.77,-5876.03 2646.7,-5885.81 2653.69,-5886.21"/>
</g>
<!-- gate_7_3&#45;&gt;expert_7_3 -->
<g id="edge1172" class="edge">
<title>gate_7_3&#45;&gt;expert_7_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-5911.9C2663.31,-5903.23 2663.17,-5894.41 2662.82,-5886.27"/>
<polygon fill="red" stroke="red" points="2666.3,-5885.81 2662.23,-5876.03 2659.31,-5886.21 2666.3,-5885.81"/>
</g>
<!-- aggregate_7_3 -->
<g id="node480" class="node">
<title>aggregate_7_3</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-5787.98 2569.06,-5787.98 2508.49,-5683.98 2743.94,-5683.98 2804.51,-5787.98"/>
<text text-anchor="middle" x="2656.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L3</text>
<text text-anchor="middle" x="2656.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_3&#45;&gt;aggregate_7_3 -->
<g id="edge471" class="edge">
<title>expert_7_3&#45;&gt;aggregate_7_3</title>
<path fill="none" stroke="black" d="M2656.5,-5823.85C2656.5,-5816.16 2656.5,-5807.35 2656.5,-5798.35"/>
<polygon fill="black" stroke="black" points="2660,-5798.16 2656.5,-5788.16 2653,-5798.16 2660,-5798.16"/>
</g>
<!-- attention_7_4 -->
<g id="node481" class="node">
<title>attention_7_4</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-5647.98 2572.5,-5647.98 2572.5,-5595.98 2740.5,-5595.98 2740.5,-5647.98"/>
<text text-anchor="middle" x="2656.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_7_L4</text>
<text text-anchor="middle" x="2656.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_3&#45;&gt;attention_7_4 -->
<g id="edge472" class="edge">
<title>aggregate_7_3&#45;&gt;attention_7_4</title>
<path fill="none" stroke="black" d="M2656.5,-5683.9C2656.5,-5675.23 2656.5,-5666.41 2656.5,-5658.27"/>
<polygon fill="black" stroke="black" points="2660,-5658.03 2656.5,-5648.03 2653,-5658.03 2660,-5658.03"/>
</g>
<!-- gate_7_4 -->
<g id="node482" class="node">
<title>gate_7_4</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-5559.98 2569.06,-5559.98 2508.49,-5455.98 2743.94,-5455.98 2804.51,-5559.98"/>
<text text-anchor="middle" x="2656.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_7_L4</text>
<text text-anchor="middle" x="2656.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_4&#45;&gt;gate_7_4 -->
<g id="edge473" class="edge">
<title>attention_7_4&#45;&gt;gate_7_4</title>
<path fill="none" stroke="black" d="M2656.5,-5595.85C2656.5,-5588.16 2656.5,-5579.35 2656.5,-5570.35"/>
<polygon fill="black" stroke="black" points="2660,-5570.16 2656.5,-5560.16 2653,-5570.16 2660,-5570.16"/>
</g>
<!-- expert_7_4 -->
<g id="node483" class="node">
<title>expert_7_4</title>
<polygon fill="lightgreen" stroke="black" points="2731,-5419.98 2582,-5419.98 2582,-5367.98 2731,-5367.98 2731,-5419.98"/>
<text text-anchor="middle" x="2656.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_7_L4</text>
<text text-anchor="middle" x="2656.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_4&#45;&gt;expert_7_4 -->
<g id="edge474" class="edge">
<title>gate_7_4&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" d="M2649.77,-5455.9C2649.69,-5447.23 2649.83,-5438.41 2650.18,-5430.27"/>
<polygon fill="black" stroke="black" points="2653.69,-5430.21 2650.77,-5420.03 2646.7,-5429.81 2653.69,-5430.21"/>
</g>
<!-- gate_7_4&#45;&gt;expert_7_4 -->
<g id="edge1173" class="edge">
<title>gate_7_4&#45;&gt;expert_7_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-5455.9C2663.31,-5447.23 2663.17,-5438.41 2662.82,-5430.27"/>
<polygon fill="red" stroke="red" points="2666.3,-5429.81 2662.23,-5420.03 2659.31,-5430.21 2666.3,-5429.81"/>
</g>
<!-- aggregate_7_4 -->
<g id="node484" class="node">
<title>aggregate_7_4</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-5331.98 2569.06,-5331.98 2508.49,-5227.98 2743.94,-5227.98 2804.51,-5331.98"/>
<text text-anchor="middle" x="2656.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L4</text>
<text text-anchor="middle" x="2656.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_4&#45;&gt;aggregate_7_4 -->
<g id="edge475" class="edge">
<title>expert_7_4&#45;&gt;aggregate_7_4</title>
<path fill="none" stroke="black" d="M2656.5,-5367.85C2656.5,-5360.16 2656.5,-5351.35 2656.5,-5342.35"/>
<polygon fill="black" stroke="black" points="2660,-5342.16 2656.5,-5332.16 2653,-5342.16 2660,-5342.16"/>
</g>
<!-- attention_7_5 -->
<g id="node485" class="node">
<title>attention_7_5</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-5191.98 2572.5,-5191.98 2572.5,-5139.98 2740.5,-5139.98 2740.5,-5191.98"/>
<text text-anchor="middle" x="2656.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_7_L5</text>
<text text-anchor="middle" x="2656.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_4&#45;&gt;attention_7_5 -->
<g id="edge476" class="edge">
<title>aggregate_7_4&#45;&gt;attention_7_5</title>
<path fill="none" stroke="black" d="M2656.5,-5227.9C2656.5,-5219.23 2656.5,-5210.41 2656.5,-5202.27"/>
<polygon fill="black" stroke="black" points="2660,-5202.03 2656.5,-5192.03 2653,-5202.03 2660,-5202.03"/>
</g>
<!-- gate_7_5 -->
<g id="node486" class="node">
<title>gate_7_5</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-5103.98 2569.06,-5103.98 2508.49,-4999.98 2743.94,-4999.98 2804.51,-5103.98"/>
<text text-anchor="middle" x="2656.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_7_L5</text>
<text text-anchor="middle" x="2656.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_5&#45;&gt;gate_7_5 -->
<g id="edge477" class="edge">
<title>attention_7_5&#45;&gt;gate_7_5</title>
<path fill="none" stroke="black" d="M2656.5,-5139.85C2656.5,-5132.16 2656.5,-5123.35 2656.5,-5114.35"/>
<polygon fill="black" stroke="black" points="2660,-5114.16 2656.5,-5104.16 2653,-5114.16 2660,-5114.16"/>
</g>
<!-- expert_7_5 -->
<g id="node487" class="node">
<title>expert_7_5</title>
<polygon fill="lightgreen" stroke="black" points="2731,-4963.98 2582,-4963.98 2582,-4911.98 2731,-4911.98 2731,-4963.98"/>
<text text-anchor="middle" x="2656.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_7_L5</text>
<text text-anchor="middle" x="2656.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_5&#45;&gt;expert_7_5 -->
<g id="edge478" class="edge">
<title>gate_7_5&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" d="M2649.77,-4999.9C2649.69,-4991.23 2649.83,-4982.41 2650.18,-4974.27"/>
<polygon fill="black" stroke="black" points="2653.69,-4974.21 2650.77,-4964.03 2646.7,-4973.81 2653.69,-4974.21"/>
</g>
<!-- gate_7_5&#45;&gt;expert_7_5 -->
<g id="edge1174" class="edge">
<title>gate_7_5&#45;&gt;expert_7_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-4999.9C2663.31,-4991.23 2663.17,-4982.41 2662.82,-4974.27"/>
<polygon fill="red" stroke="red" points="2666.3,-4973.81 2662.23,-4964.03 2659.31,-4974.21 2666.3,-4973.81"/>
</g>
<!-- aggregate_7_5 -->
<g id="node488" class="node">
<title>aggregate_7_5</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-4875.98 2569.06,-4875.98 2508.49,-4771.98 2743.94,-4771.98 2804.51,-4875.98"/>
<text text-anchor="middle" x="2656.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L5</text>
<text text-anchor="middle" x="2656.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_5&#45;&gt;aggregate_7_5 -->
<g id="edge479" class="edge">
<title>expert_7_5&#45;&gt;aggregate_7_5</title>
<path fill="none" stroke="black" d="M2656.5,-4911.85C2656.5,-4904.16 2656.5,-4895.35 2656.5,-4886.35"/>
<polygon fill="black" stroke="black" points="2660,-4886.16 2656.5,-4876.16 2653,-4886.16 2660,-4886.16"/>
</g>
<!-- attention_7_6 -->
<g id="node489" class="node">
<title>attention_7_6</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-4735.98 2572.5,-4735.98 2572.5,-4683.98 2740.5,-4683.98 2740.5,-4735.98"/>
<text text-anchor="middle" x="2656.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_7_L6</text>
<text text-anchor="middle" x="2656.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_5&#45;&gt;attention_7_6 -->
<g id="edge480" class="edge">
<title>aggregate_7_5&#45;&gt;attention_7_6</title>
<path fill="none" stroke="black" d="M2656.5,-4771.9C2656.5,-4763.23 2656.5,-4754.41 2656.5,-4746.27"/>
<polygon fill="black" stroke="black" points="2660,-4746.03 2656.5,-4736.03 2653,-4746.03 2660,-4746.03"/>
</g>
<!-- gate_7_6 -->
<g id="node490" class="node">
<title>gate_7_6</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-4647.98 2569.06,-4647.98 2508.49,-4543.98 2743.94,-4543.98 2804.51,-4647.98"/>
<text text-anchor="middle" x="2656.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_7_L6</text>
<text text-anchor="middle" x="2656.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_6&#45;&gt;gate_7_6 -->
<g id="edge481" class="edge">
<title>attention_7_6&#45;&gt;gate_7_6</title>
<path fill="none" stroke="black" d="M2656.5,-4683.85C2656.5,-4676.16 2656.5,-4667.35 2656.5,-4658.35"/>
<polygon fill="black" stroke="black" points="2660,-4658.16 2656.5,-4648.16 2653,-4658.16 2660,-4658.16"/>
</g>
<!-- expert_7_6 -->
<g id="node491" class="node">
<title>expert_7_6</title>
<polygon fill="lightgreen" stroke="black" points="2731,-4507.98 2582,-4507.98 2582,-4455.98 2731,-4455.98 2731,-4507.98"/>
<text text-anchor="middle" x="2656.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_7_L6</text>
<text text-anchor="middle" x="2656.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_6&#45;&gt;expert_7_6 -->
<g id="edge482" class="edge">
<title>gate_7_6&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" d="M2649.77,-4543.9C2649.69,-4535.23 2649.83,-4526.41 2650.18,-4518.27"/>
<polygon fill="black" stroke="black" points="2653.69,-4518.21 2650.77,-4508.03 2646.7,-4517.81 2653.69,-4518.21"/>
</g>
<!-- gate_7_6&#45;&gt;expert_7_6 -->
<g id="edge1175" class="edge">
<title>gate_7_6&#45;&gt;expert_7_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-4543.9C2663.31,-4535.23 2663.17,-4526.41 2662.82,-4518.27"/>
<polygon fill="red" stroke="red" points="2666.3,-4517.81 2662.23,-4508.03 2659.31,-4518.21 2666.3,-4517.81"/>
</g>
<!-- aggregate_7_6 -->
<g id="node492" class="node">
<title>aggregate_7_6</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-4419.98 2569.06,-4419.98 2508.49,-4315.98 2743.94,-4315.98 2804.51,-4419.98"/>
<text text-anchor="middle" x="2656.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L6</text>
<text text-anchor="middle" x="2656.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_6&#45;&gt;aggregate_7_6 -->
<g id="edge483" class="edge">
<title>expert_7_6&#45;&gt;aggregate_7_6</title>
<path fill="none" stroke="black" d="M2656.5,-4455.85C2656.5,-4448.16 2656.5,-4439.35 2656.5,-4430.35"/>
<polygon fill="black" stroke="black" points="2660,-4430.16 2656.5,-4420.16 2653,-4430.16 2660,-4430.16"/>
</g>
<!-- attention_7_7 -->
<g id="node493" class="node">
<title>attention_7_7</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-4279.98 2572.5,-4279.98 2572.5,-4227.98 2740.5,-4227.98 2740.5,-4279.98"/>
<text text-anchor="middle" x="2656.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_7_L7</text>
<text text-anchor="middle" x="2656.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_6&#45;&gt;attention_7_7 -->
<g id="edge484" class="edge">
<title>aggregate_7_6&#45;&gt;attention_7_7</title>
<path fill="none" stroke="black" d="M2656.5,-4315.9C2656.5,-4307.23 2656.5,-4298.41 2656.5,-4290.27"/>
<polygon fill="black" stroke="black" points="2660,-4290.03 2656.5,-4280.03 2653,-4290.03 2660,-4290.03"/>
</g>
<!-- gate_7_7 -->
<g id="node494" class="node">
<title>gate_7_7</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-4191.98 2569.06,-4191.98 2508.49,-4087.98 2743.94,-4087.98 2804.51,-4191.98"/>
<text text-anchor="middle" x="2656.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_7_L7</text>
<text text-anchor="middle" x="2656.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_7&#45;&gt;gate_7_7 -->
<g id="edge485" class="edge">
<title>attention_7_7&#45;&gt;gate_7_7</title>
<path fill="none" stroke="black" d="M2656.5,-4227.85C2656.5,-4220.16 2656.5,-4211.35 2656.5,-4202.35"/>
<polygon fill="black" stroke="black" points="2660,-4202.16 2656.5,-4192.16 2653,-4202.16 2660,-4202.16"/>
</g>
<!-- expert_7_7 -->
<g id="node495" class="node">
<title>expert_7_7</title>
<polygon fill="lightgreen" stroke="black" points="2731,-4051.98 2582,-4051.98 2582,-3999.98 2731,-3999.98 2731,-4051.98"/>
<text text-anchor="middle" x="2656.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_7_L7</text>
<text text-anchor="middle" x="2656.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_7&#45;&gt;expert_7_7 -->
<g id="edge486" class="edge">
<title>gate_7_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" d="M2649.77,-4087.9C2649.69,-4079.23 2649.83,-4070.41 2650.18,-4062.27"/>
<polygon fill="black" stroke="black" points="2653.69,-4062.21 2650.77,-4052.03 2646.7,-4061.81 2653.69,-4062.21"/>
</g>
<!-- gate_7_7&#45;&gt;expert_7_7 -->
<g id="edge1176" class="edge">
<title>gate_7_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-4087.9C2663.31,-4079.23 2663.17,-4070.41 2662.82,-4062.27"/>
<polygon fill="red" stroke="red" points="2666.3,-4061.81 2662.23,-4052.03 2659.31,-4062.21 2666.3,-4061.81"/>
</g>
<!-- aggregate_7_7 -->
<g id="node496" class="node">
<title>aggregate_7_7</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-3963.98 2569.06,-3963.98 2508.49,-3859.98 2743.94,-3859.98 2804.51,-3963.98"/>
<text text-anchor="middle" x="2656.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L7</text>
<text text-anchor="middle" x="2656.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_7&#45;&gt;aggregate_7_7 -->
<g id="edge487" class="edge">
<title>expert_7_7&#45;&gt;aggregate_7_7</title>
<path fill="none" stroke="black" d="M2656.5,-3999.85C2656.5,-3992.16 2656.5,-3983.35 2656.5,-3974.35"/>
<polygon fill="black" stroke="black" points="2660,-3974.16 2656.5,-3964.16 2653,-3974.16 2660,-3974.16"/>
</g>
<!-- attention_7_8 -->
<g id="node497" class="node">
<title>attention_7_8</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-3823.98 2572.5,-3823.98 2572.5,-3771.98 2740.5,-3771.98 2740.5,-3823.98"/>
<text text-anchor="middle" x="2656.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_7_L8</text>
<text text-anchor="middle" x="2656.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_7&#45;&gt;attention_7_8 -->
<g id="edge488" class="edge">
<title>aggregate_7_7&#45;&gt;attention_7_8</title>
<path fill="none" stroke="black" d="M2656.5,-3859.9C2656.5,-3851.23 2656.5,-3842.41 2656.5,-3834.27"/>
<polygon fill="black" stroke="black" points="2660,-3834.03 2656.5,-3824.03 2653,-3834.03 2660,-3834.03"/>
</g>
<!-- gate_7_8 -->
<g id="node498" class="node">
<title>gate_7_8</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-3735.98 2569.06,-3735.98 2508.49,-3631.98 2743.94,-3631.98 2804.51,-3735.98"/>
<text text-anchor="middle" x="2656.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_7_L8</text>
<text text-anchor="middle" x="2656.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_8&#45;&gt;gate_7_8 -->
<g id="edge489" class="edge">
<title>attention_7_8&#45;&gt;gate_7_8</title>
<path fill="none" stroke="black" d="M2656.5,-3771.85C2656.5,-3764.16 2656.5,-3755.35 2656.5,-3746.35"/>
<polygon fill="black" stroke="black" points="2660,-3746.16 2656.5,-3736.16 2653,-3746.16 2660,-3746.16"/>
</g>
<!-- expert_7_8 -->
<g id="node499" class="node">
<title>expert_7_8</title>
<polygon fill="lightgreen" stroke="black" points="2731,-3595.98 2582,-3595.98 2582,-3543.98 2731,-3543.98 2731,-3595.98"/>
<text text-anchor="middle" x="2656.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_7_L8</text>
<text text-anchor="middle" x="2656.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_8&#45;&gt;expert_7_8 -->
<g id="edge490" class="edge">
<title>gate_7_8&#45;&gt;expert_7_8</title>
<path fill="none" stroke="black" d="M2649.77,-3631.9C2649.69,-3623.23 2649.83,-3614.41 2650.18,-3606.27"/>
<polygon fill="black" stroke="black" points="2653.69,-3606.21 2650.77,-3596.03 2646.7,-3605.81 2653.69,-3606.21"/>
</g>
<!-- gate_7_8&#45;&gt;expert_7_8 -->
<g id="edge1177" class="edge">
<title>gate_7_8&#45;&gt;expert_7_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-3631.9C2663.31,-3623.23 2663.17,-3614.41 2662.82,-3606.27"/>
<polygon fill="red" stroke="red" points="2666.3,-3605.81 2662.23,-3596.03 2659.31,-3606.21 2666.3,-3605.81"/>
</g>
<!-- aggregate_7_8 -->
<g id="node500" class="node">
<title>aggregate_7_8</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-3507.98 2569.06,-3507.98 2508.49,-3403.98 2743.94,-3403.98 2804.51,-3507.98"/>
<text text-anchor="middle" x="2656.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L8</text>
<text text-anchor="middle" x="2656.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_8&#45;&gt;aggregate_7_8 -->
<g id="edge491" class="edge">
<title>expert_7_8&#45;&gt;aggregate_7_8</title>
<path fill="none" stroke="black" d="M2656.5,-3543.85C2656.5,-3536.16 2656.5,-3527.35 2656.5,-3518.35"/>
<polygon fill="black" stroke="black" points="2660,-3518.16 2656.5,-3508.16 2653,-3518.16 2660,-3518.16"/>
</g>
<!-- attention_7_9 -->
<g id="node501" class="node">
<title>attention_7_9</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-3367.98 2572.5,-3367.98 2572.5,-3315.98 2740.5,-3315.98 2740.5,-3367.98"/>
<text text-anchor="middle" x="2656.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_7_L9</text>
<text text-anchor="middle" x="2656.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_8&#45;&gt;attention_7_9 -->
<g id="edge492" class="edge">
<title>aggregate_7_8&#45;&gt;attention_7_9</title>
<path fill="none" stroke="black" d="M2656.5,-3403.9C2656.5,-3395.23 2656.5,-3386.41 2656.5,-3378.27"/>
<polygon fill="black" stroke="black" points="2660,-3378.03 2656.5,-3368.03 2653,-3378.03 2660,-3378.03"/>
</g>
<!-- gate_7_9 -->
<g id="node502" class="node">
<title>gate_7_9</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-3279.98 2569.06,-3279.98 2508.49,-3175.98 2743.94,-3175.98 2804.51,-3279.98"/>
<text text-anchor="middle" x="2656.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_7_L9</text>
<text text-anchor="middle" x="2656.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_9&#45;&gt;gate_7_9 -->
<g id="edge493" class="edge">
<title>attention_7_9&#45;&gt;gate_7_9</title>
<path fill="none" stroke="black" d="M2656.5,-3315.85C2656.5,-3308.16 2656.5,-3299.35 2656.5,-3290.35"/>
<polygon fill="black" stroke="black" points="2660,-3290.16 2656.5,-3280.16 2653,-3290.16 2660,-3290.16"/>
</g>
<!-- expert_7_9 -->
<g id="node503" class="node">
<title>expert_7_9</title>
<polygon fill="lightgreen" stroke="black" points="2731,-3139.98 2582,-3139.98 2582,-3087.98 2731,-3087.98 2731,-3139.98"/>
<text text-anchor="middle" x="2656.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_7_L9</text>
<text text-anchor="middle" x="2656.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_9&#45;&gt;expert_7_9 -->
<g id="edge494" class="edge">
<title>gate_7_9&#45;&gt;expert_7_9</title>
<path fill="none" stroke="black" d="M2649.77,-3175.9C2649.69,-3167.23 2649.83,-3158.41 2650.18,-3150.27"/>
<polygon fill="black" stroke="black" points="2653.69,-3150.21 2650.77,-3140.03 2646.7,-3149.81 2653.69,-3150.21"/>
</g>
<!-- gate_7_9&#45;&gt;expert_7_9 -->
<g id="edge1178" class="edge">
<title>gate_7_9&#45;&gt;expert_7_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-3175.9C2663.31,-3167.23 2663.17,-3158.41 2662.82,-3150.27"/>
<polygon fill="red" stroke="red" points="2666.3,-3149.81 2662.23,-3140.03 2659.31,-3150.21 2666.3,-3149.81"/>
</g>
<!-- aggregate_7_9 -->
<g id="node504" class="node">
<title>aggregate_7_9</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-3051.98 2569.06,-3051.98 2508.49,-2947.98 2743.94,-2947.98 2804.51,-3051.98"/>
<text text-anchor="middle" x="2656.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L9</text>
<text text-anchor="middle" x="2656.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_9&#45;&gt;aggregate_7_9 -->
<g id="edge495" class="edge">
<title>expert_7_9&#45;&gt;aggregate_7_9</title>
<path fill="none" stroke="black" d="M2656.5,-3087.85C2656.5,-3080.16 2656.5,-3071.35 2656.5,-3062.35"/>
<polygon fill="black" stroke="black" points="2660,-3062.16 2656.5,-3052.16 2653,-3062.16 2660,-3062.16"/>
</g>
<!-- attention_7_10 -->
<g id="node505" class="node">
<title>attention_7_10</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-2911.98 2572.5,-2911.98 2572.5,-2859.98 2740.5,-2859.98 2740.5,-2911.98"/>
<text text-anchor="middle" x="2656.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_7_L10</text>
<text text-anchor="middle" x="2656.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_9&#45;&gt;attention_7_10 -->
<g id="edge496" class="edge">
<title>aggregate_7_9&#45;&gt;attention_7_10</title>
<path fill="none" stroke="black" d="M2656.5,-2947.9C2656.5,-2939.23 2656.5,-2930.41 2656.5,-2922.27"/>
<polygon fill="black" stroke="black" points="2660,-2922.03 2656.5,-2912.03 2653,-2922.03 2660,-2922.03"/>
</g>
<!-- gate_7_10 -->
<g id="node506" class="node">
<title>gate_7_10</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-2823.98 2569.06,-2823.98 2508.49,-2719.98 2743.94,-2719.98 2804.51,-2823.98"/>
<text text-anchor="middle" x="2656.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_7_L10</text>
<text text-anchor="middle" x="2656.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_10&#45;&gt;gate_7_10 -->
<g id="edge497" class="edge">
<title>attention_7_10&#45;&gt;gate_7_10</title>
<path fill="none" stroke="black" d="M2656.5,-2859.85C2656.5,-2852.16 2656.5,-2843.35 2656.5,-2834.35"/>
<polygon fill="black" stroke="black" points="2660,-2834.16 2656.5,-2824.16 2653,-2834.16 2660,-2834.16"/>
</g>
<!-- expert_7_10 -->
<g id="node507" class="node">
<title>expert_7_10</title>
<polygon fill="lightgreen" stroke="black" points="2731,-2683.98 2582,-2683.98 2582,-2631.98 2731,-2631.98 2731,-2683.98"/>
<text text-anchor="middle" x="2656.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_7_L10</text>
<text text-anchor="middle" x="2656.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_10&#45;&gt;expert_7_10 -->
<g id="edge498" class="edge">
<title>gate_7_10&#45;&gt;expert_7_10</title>
<path fill="none" stroke="black" d="M2649.77,-2719.9C2649.69,-2711.23 2649.83,-2702.41 2650.18,-2694.27"/>
<polygon fill="black" stroke="black" points="2653.69,-2694.21 2650.77,-2684.03 2646.7,-2693.81 2653.69,-2694.21"/>
</g>
<!-- gate_7_10&#45;&gt;expert_7_10 -->
<g id="edge1179" class="edge">
<title>gate_7_10&#45;&gt;expert_7_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-2719.9C2663.31,-2711.23 2663.17,-2702.41 2662.82,-2694.27"/>
<polygon fill="red" stroke="red" points="2666.3,-2693.81 2662.23,-2684.03 2659.31,-2694.21 2666.3,-2693.81"/>
</g>
<!-- aggregate_7_10 -->
<g id="node508" class="node">
<title>aggregate_7_10</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-2595.98 2569.06,-2595.98 2508.49,-2491.98 2743.94,-2491.98 2804.51,-2595.98"/>
<text text-anchor="middle" x="2656.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L10</text>
<text text-anchor="middle" x="2656.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_10&#45;&gt;aggregate_7_10 -->
<g id="edge499" class="edge">
<title>expert_7_10&#45;&gt;aggregate_7_10</title>
<path fill="none" stroke="black" d="M2656.5,-2631.85C2656.5,-2624.16 2656.5,-2615.35 2656.5,-2606.35"/>
<polygon fill="black" stroke="black" points="2660,-2606.16 2656.5,-2596.16 2653,-2606.16 2660,-2606.16"/>
</g>
<!-- attention_7_11 -->
<g id="node509" class="node">
<title>attention_7_11</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-2455.98 2572.5,-2455.98 2572.5,-2403.98 2740.5,-2403.98 2740.5,-2455.98"/>
<text text-anchor="middle" x="2656.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_7_L11</text>
<text text-anchor="middle" x="2656.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_10&#45;&gt;attention_7_11 -->
<g id="edge500" class="edge">
<title>aggregate_7_10&#45;&gt;attention_7_11</title>
<path fill="none" stroke="black" d="M2656.5,-2491.9C2656.5,-2483.23 2656.5,-2474.41 2656.5,-2466.27"/>
<polygon fill="black" stroke="black" points="2660,-2466.03 2656.5,-2456.03 2653,-2466.03 2660,-2466.03"/>
</g>
<!-- gate_7_11 -->
<g id="node510" class="node">
<title>gate_7_11</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-2367.98 2569.06,-2367.98 2508.49,-2263.98 2743.94,-2263.98 2804.51,-2367.98"/>
<text text-anchor="middle" x="2656.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_7_L11</text>
<text text-anchor="middle" x="2656.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_11&#45;&gt;gate_7_11 -->
<g id="edge501" class="edge">
<title>attention_7_11&#45;&gt;gate_7_11</title>
<path fill="none" stroke="black" d="M2656.5,-2403.85C2656.5,-2396.16 2656.5,-2387.35 2656.5,-2378.35"/>
<polygon fill="black" stroke="black" points="2660,-2378.16 2656.5,-2368.16 2653,-2378.16 2660,-2378.16"/>
</g>
<!-- expert_7_11 -->
<g id="node511" class="node">
<title>expert_7_11</title>
<polygon fill="lightgreen" stroke="black" points="2731,-2227.98 2582,-2227.98 2582,-2175.98 2731,-2175.98 2731,-2227.98"/>
<text text-anchor="middle" x="2656.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_7_L11</text>
<text text-anchor="middle" x="2656.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_11&#45;&gt;expert_7_11 -->
<g id="edge502" class="edge">
<title>gate_7_11&#45;&gt;expert_7_11</title>
<path fill="none" stroke="black" d="M2649.77,-2263.9C2649.69,-2255.23 2649.83,-2246.41 2650.18,-2238.27"/>
<polygon fill="black" stroke="black" points="2653.69,-2238.21 2650.77,-2228.03 2646.7,-2237.81 2653.69,-2238.21"/>
</g>
<!-- gate_7_11&#45;&gt;expert_7_11 -->
<g id="edge1180" class="edge">
<title>gate_7_11&#45;&gt;expert_7_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-2263.9C2663.31,-2255.23 2663.17,-2246.41 2662.82,-2238.27"/>
<polygon fill="red" stroke="red" points="2666.3,-2237.81 2662.23,-2228.03 2659.31,-2238.21 2666.3,-2237.81"/>
</g>
<!-- aggregate_7_11 -->
<g id="node512" class="node">
<title>aggregate_7_11</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-2139.98 2569.06,-2139.98 2508.49,-2035.98 2743.94,-2035.98 2804.51,-2139.98"/>
<text text-anchor="middle" x="2656.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L11</text>
<text text-anchor="middle" x="2656.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_11&#45;&gt;aggregate_7_11 -->
<g id="edge503" class="edge">
<title>expert_7_11&#45;&gt;aggregate_7_11</title>
<path fill="none" stroke="black" d="M2656.5,-2175.85C2656.5,-2168.16 2656.5,-2159.35 2656.5,-2150.35"/>
<polygon fill="black" stroke="black" points="2660,-2150.16 2656.5,-2140.16 2653,-2150.16 2660,-2150.16"/>
</g>
<!-- attention_7_12 -->
<g id="node513" class="node">
<title>attention_7_12</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-1999.98 2572.5,-1999.98 2572.5,-1947.98 2740.5,-1947.98 2740.5,-1999.98"/>
<text text-anchor="middle" x="2656.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_7_L12</text>
<text text-anchor="middle" x="2656.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_11&#45;&gt;attention_7_12 -->
<g id="edge504" class="edge">
<title>aggregate_7_11&#45;&gt;attention_7_12</title>
<path fill="none" stroke="black" d="M2656.5,-2035.9C2656.5,-2027.23 2656.5,-2018.41 2656.5,-2010.27"/>
<polygon fill="black" stroke="black" points="2660,-2010.03 2656.5,-2000.03 2653,-2010.03 2660,-2010.03"/>
</g>
<!-- gate_7_12 -->
<g id="node514" class="node">
<title>gate_7_12</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-1911.98 2569.06,-1911.98 2508.49,-1807.98 2743.94,-1807.98 2804.51,-1911.98"/>
<text text-anchor="middle" x="2656.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_7_L12</text>
<text text-anchor="middle" x="2656.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_12&#45;&gt;gate_7_12 -->
<g id="edge505" class="edge">
<title>attention_7_12&#45;&gt;gate_7_12</title>
<path fill="none" stroke="black" d="M2656.5,-1947.85C2656.5,-1940.16 2656.5,-1931.35 2656.5,-1922.35"/>
<polygon fill="black" stroke="black" points="2660,-1922.16 2656.5,-1912.16 2653,-1922.16 2660,-1922.16"/>
</g>
<!-- expert_7_12 -->
<g id="node515" class="node">
<title>expert_7_12</title>
<polygon fill="lightgreen" stroke="black" points="2731,-1771.98 2582,-1771.98 2582,-1719.98 2731,-1719.98 2731,-1771.98"/>
<text text-anchor="middle" x="2656.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_7_L12</text>
<text text-anchor="middle" x="2656.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_12&#45;&gt;expert_7_12 -->
<g id="edge506" class="edge">
<title>gate_7_12&#45;&gt;expert_7_12</title>
<path fill="none" stroke="black" d="M2649.77,-1807.9C2649.69,-1799.23 2649.83,-1790.41 2650.18,-1782.27"/>
<polygon fill="black" stroke="black" points="2653.69,-1782.21 2650.77,-1772.03 2646.7,-1781.81 2653.69,-1782.21"/>
</g>
<!-- gate_7_12&#45;&gt;expert_7_12 -->
<g id="edge1181" class="edge">
<title>gate_7_12&#45;&gt;expert_7_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-1807.9C2663.31,-1799.23 2663.17,-1790.41 2662.82,-1782.27"/>
<polygon fill="red" stroke="red" points="2666.3,-1781.81 2662.23,-1772.03 2659.31,-1782.21 2666.3,-1781.81"/>
</g>
<!-- aggregate_7_12 -->
<g id="node516" class="node">
<title>aggregate_7_12</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-1683.98 2569.06,-1683.98 2508.49,-1579.98 2743.94,-1579.98 2804.51,-1683.98"/>
<text text-anchor="middle" x="2656.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L12</text>
<text text-anchor="middle" x="2656.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_12&#45;&gt;aggregate_7_12 -->
<g id="edge507" class="edge">
<title>expert_7_12&#45;&gt;aggregate_7_12</title>
<path fill="none" stroke="black" d="M2656.5,-1719.85C2656.5,-1712.16 2656.5,-1703.35 2656.5,-1694.35"/>
<polygon fill="black" stroke="black" points="2660,-1694.16 2656.5,-1684.16 2653,-1694.16 2660,-1694.16"/>
</g>
<!-- attention_7_13 -->
<g id="node517" class="node">
<title>attention_7_13</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-1543.98 2572.5,-1543.98 2572.5,-1491.98 2740.5,-1491.98 2740.5,-1543.98"/>
<text text-anchor="middle" x="2656.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_7_L13</text>
<text text-anchor="middle" x="2656.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_12&#45;&gt;attention_7_13 -->
<g id="edge508" class="edge">
<title>aggregate_7_12&#45;&gt;attention_7_13</title>
<path fill="none" stroke="black" d="M2656.5,-1579.9C2656.5,-1571.23 2656.5,-1562.41 2656.5,-1554.27"/>
<polygon fill="black" stroke="black" points="2660,-1554.03 2656.5,-1544.03 2653,-1554.03 2660,-1554.03"/>
</g>
<!-- gate_7_13 -->
<g id="node518" class="node">
<title>gate_7_13</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-1455.98 2569.06,-1455.98 2508.49,-1351.98 2743.94,-1351.98 2804.51,-1455.98"/>
<text text-anchor="middle" x="2656.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_7_L13</text>
<text text-anchor="middle" x="2656.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_13&#45;&gt;gate_7_13 -->
<g id="edge509" class="edge">
<title>attention_7_13&#45;&gt;gate_7_13</title>
<path fill="none" stroke="black" d="M2656.5,-1491.85C2656.5,-1484.16 2656.5,-1475.35 2656.5,-1466.35"/>
<polygon fill="black" stroke="black" points="2660,-1466.16 2656.5,-1456.16 2653,-1466.16 2660,-1466.16"/>
</g>
<!-- expert_7_13 -->
<g id="node519" class="node">
<title>expert_7_13</title>
<polygon fill="lightgreen" stroke="black" points="2731,-1315.98 2582,-1315.98 2582,-1263.98 2731,-1263.98 2731,-1315.98"/>
<text text-anchor="middle" x="2656.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_7_L13</text>
<text text-anchor="middle" x="2656.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_13&#45;&gt;expert_7_13 -->
<g id="edge510" class="edge">
<title>gate_7_13&#45;&gt;expert_7_13</title>
<path fill="none" stroke="black" d="M2649.77,-1351.9C2649.69,-1343.23 2649.83,-1334.41 2650.18,-1326.27"/>
<polygon fill="black" stroke="black" points="2653.69,-1326.21 2650.77,-1316.03 2646.7,-1325.81 2653.69,-1326.21"/>
</g>
<!-- gate_7_13&#45;&gt;expert_7_13 -->
<g id="edge1182" class="edge">
<title>gate_7_13&#45;&gt;expert_7_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-1351.9C2663.31,-1343.23 2663.17,-1334.41 2662.82,-1326.27"/>
<polygon fill="red" stroke="red" points="2666.3,-1325.81 2662.23,-1316.03 2659.31,-1326.21 2666.3,-1325.81"/>
</g>
<!-- aggregate_7_13 -->
<g id="node520" class="node">
<title>aggregate_7_13</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-1227.98 2569.06,-1227.98 2508.49,-1123.98 2743.94,-1123.98 2804.51,-1227.98"/>
<text text-anchor="middle" x="2656.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L13</text>
<text text-anchor="middle" x="2656.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_13&#45;&gt;aggregate_7_13 -->
<g id="edge511" class="edge">
<title>expert_7_13&#45;&gt;aggregate_7_13</title>
<path fill="none" stroke="black" d="M2656.5,-1263.85C2656.5,-1256.16 2656.5,-1247.35 2656.5,-1238.35"/>
<polygon fill="black" stroke="black" points="2660,-1238.16 2656.5,-1228.16 2653,-1238.16 2660,-1238.16"/>
</g>
<!-- attention_7_14 -->
<g id="node521" class="node">
<title>attention_7_14</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-1087.98 2572.5,-1087.98 2572.5,-1035.98 2740.5,-1035.98 2740.5,-1087.98"/>
<text text-anchor="middle" x="2656.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_7_L14</text>
<text text-anchor="middle" x="2656.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_13&#45;&gt;attention_7_14 -->
<g id="edge512" class="edge">
<title>aggregate_7_13&#45;&gt;attention_7_14</title>
<path fill="none" stroke="black" d="M2656.5,-1123.9C2656.5,-1115.23 2656.5,-1106.41 2656.5,-1098.27"/>
<polygon fill="black" stroke="black" points="2660,-1098.03 2656.5,-1088.03 2653,-1098.03 2660,-1098.03"/>
</g>
<!-- gate_7_14 -->
<g id="node522" class="node">
<title>gate_7_14</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-999.98 2569.06,-999.98 2508.49,-895.98 2743.94,-895.98 2804.51,-999.98"/>
<text text-anchor="middle" x="2656.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_7_L14</text>
<text text-anchor="middle" x="2656.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_14&#45;&gt;gate_7_14 -->
<g id="edge513" class="edge">
<title>attention_7_14&#45;&gt;gate_7_14</title>
<path fill="none" stroke="black" d="M2656.5,-1035.85C2656.5,-1028.16 2656.5,-1019.35 2656.5,-1010.35"/>
<polygon fill="black" stroke="black" points="2660,-1010.16 2656.5,-1000.16 2653,-1010.16 2660,-1010.16"/>
</g>
<!-- expert_7_14 -->
<g id="node523" class="node">
<title>expert_7_14</title>
<polygon fill="lightgreen" stroke="black" points="2731,-859.98 2582,-859.98 2582,-807.98 2731,-807.98 2731,-859.98"/>
<text text-anchor="middle" x="2656.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_7_L14</text>
<text text-anchor="middle" x="2656.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_14&#45;&gt;expert_7_14 -->
<g id="edge514" class="edge">
<title>gate_7_14&#45;&gt;expert_7_14</title>
<path fill="none" stroke="black" d="M2649.77,-895.9C2649.69,-887.23 2649.83,-878.41 2650.18,-870.27"/>
<polygon fill="black" stroke="black" points="2653.69,-870.21 2650.77,-860.03 2646.7,-869.81 2653.69,-870.21"/>
</g>
<!-- gate_7_14&#45;&gt;expert_7_14 -->
<g id="edge1183" class="edge">
<title>gate_7_14&#45;&gt;expert_7_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-895.9C2663.31,-887.23 2663.17,-878.41 2662.82,-870.27"/>
<polygon fill="red" stroke="red" points="2666.3,-869.81 2662.23,-860.03 2659.31,-870.21 2666.3,-869.81"/>
</g>
<!-- aggregate_7_14 -->
<g id="node524" class="node">
<title>aggregate_7_14</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-771.98 2569.06,-771.98 2508.49,-667.98 2743.94,-667.98 2804.51,-771.98"/>
<text text-anchor="middle" x="2656.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L14</text>
<text text-anchor="middle" x="2656.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_14&#45;&gt;aggregate_7_14 -->
<g id="edge515" class="edge">
<title>expert_7_14&#45;&gt;aggregate_7_14</title>
<path fill="none" stroke="black" d="M2656.5,-807.85C2656.5,-800.16 2656.5,-791.35 2656.5,-782.35"/>
<polygon fill="black" stroke="black" points="2660,-782.16 2656.5,-772.16 2653,-782.16 2660,-782.16"/>
</g>
<!-- attention_7_15 -->
<g id="node525" class="node">
<title>attention_7_15</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-631.98 2572.5,-631.98 2572.5,-579.98 2740.5,-579.98 2740.5,-631.98"/>
<text text-anchor="middle" x="2656.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_7_L15</text>
<text text-anchor="middle" x="2656.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2656.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2656.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_7_14&#45;&gt;attention_7_15 -->
<g id="edge516" class="edge">
<title>aggregate_7_14&#45;&gt;attention_7_15</title>
<path fill="none" stroke="black" d="M2656.5,-667.9C2656.5,-659.23 2656.5,-650.41 2656.5,-642.27"/>
<polygon fill="black" stroke="black" points="2660,-642.03 2656.5,-632.03 2653,-642.03 2660,-642.03"/>
</g>
<!-- gate_7_15 -->
<g id="node526" class="node">
<title>gate_7_15</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-543.98 2569.06,-543.98 2508.49,-439.98 2743.94,-439.98 2804.51,-543.98"/>
<text text-anchor="middle" x="2656.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_7_L15</text>
<text text-anchor="middle" x="2656.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2656.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_7_15&#45;&gt;gate_7_15 -->
<g id="edge517" class="edge">
<title>attention_7_15&#45;&gt;gate_7_15</title>
<path fill="none" stroke="black" d="M2656.5,-579.85C2656.5,-572.16 2656.5,-563.35 2656.5,-554.35"/>
<polygon fill="black" stroke="black" points="2660,-554.16 2656.5,-544.16 2653,-554.16 2660,-554.16"/>
</g>
<!-- expert_7_15 -->
<g id="node527" class="node">
<title>expert_7_15</title>
<polygon fill="lightgreen" stroke="black" points="2731,-403.98 2582,-403.98 2582,-351.98 2731,-351.98 2731,-403.98"/>
<text text-anchor="middle" x="2656.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_7_L15</text>
<text text-anchor="middle" x="2656.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=7</text>
<text text-anchor="middle" x="2656.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_7_15&#45;&gt;expert_7_15 -->
<g id="edge518" class="edge">
<title>gate_7_15&#45;&gt;expert_7_15</title>
<path fill="none" stroke="black" d="M2649.77,-439.9C2649.69,-431.23 2649.83,-422.41 2650.18,-414.27"/>
<polygon fill="black" stroke="black" points="2653.69,-414.21 2650.77,-404.03 2646.7,-413.81 2653.69,-414.21"/>
</g>
<!-- gate_7_15&#45;&gt;expert_7_15 -->
<g id="edge1184" class="edge">
<title>gate_7_15&#45;&gt;expert_7_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2663.23,-439.9C2663.31,-431.23 2663.17,-422.41 2662.82,-414.27"/>
<polygon fill="red" stroke="red" points="2666.3,-413.81 2662.23,-404.03 2659.31,-414.21 2666.3,-413.81"/>
</g>
<!-- aggregate_7_15 -->
<g id="node528" class="node">
<title>aggregate_7_15</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-315.98 2569.06,-315.98 2508.49,-211.98 2743.94,-211.98 2804.51,-315.98"/>
<text text-anchor="middle" x="2656.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_7_L15</text>
<text text-anchor="middle" x="2656.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2656.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2656.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_7_15&#45;&gt;aggregate_7_15 -->
<g id="edge519" class="edge">
<title>expert_7_15&#45;&gt;aggregate_7_15</title>
<path fill="none" stroke="black" d="M2656.5,-351.85C2656.5,-344.16 2656.5,-335.35 2656.5,-326.35"/>
<polygon fill="black" stroke="black" points="2660,-326.16 2656.5,-316.16 2653,-326.16 2660,-326.16"/>
</g>
<!-- collect_7 -->
<g id="node529" class="node">
<title>collect_7</title>
<polygon fill="lightyellow" stroke="black" points="2804.51,-175.98 2569.06,-175.98 2508.49,-93.98 2743.94,-93.98 2804.51,-175.98"/>
<text text-anchor="middle" x="2656.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_7</text>
<text text-anchor="middle" x="2656.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2656.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_7_15&#45;&gt;collect_7 -->
<g id="edge520" class="edge">
<title>aggregate_7_15&#45;&gt;collect_7</title>
<path fill="none" stroke="black" d="M2656.5,-211.69C2656.5,-203.27 2656.5,-194.56 2656.5,-186.17"/>
<polygon fill="black" stroke="black" points="2660,-186.14 2656.5,-176.14 2653,-186.14 2660,-186.14"/>
</g>
<!-- collect_7&#45;&gt;output -->
<g id="edge1048" class="edge">
<title>collect_7&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2717.2,-93.78C2732.93,-83.36 2749.66,-72.28 2764.69,-62.33"/>
<polygon fill="black" stroke="black" points="2766.91,-65.05 2773.32,-56.61 2763.05,-59.21 2766.91,-65.05"/>
</g>
<!-- distribute_8 -->
<g id="node530" class="node">
<title>distribute_8</title>
<polygon fill="lightyellow" stroke="black" points="3127.73,-7589.98 2887.16,-7589.98 2825.27,-7507.98 3065.85,-7507.98 3127.73,-7589.98"/>
<text text-anchor="middle" x="2976.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_8</text>
<text text-anchor="middle" x="2976.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="2976.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_0 -->
<g id="node531" class="node">
<title>attention_8_0</title>
<polygon fill="lightgreen" stroke="black" points="3059.5,-7471.98 2891.5,-7471.98 2891.5,-7419.98 3059.5,-7419.98 3059.5,-7471.98"/>
<text text-anchor="middle" x="2975.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_8_L0</text>
<text text-anchor="middle" x="2975.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2975.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2975.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_8&#45;&gt;attention_8_0 -->
<g id="edge521" class="edge">
<title>distribute_8&#45;&gt;attention_8_0</title>
<path fill="none" stroke="black" d="M2976.1,-7507.77C2976.02,-7499.34 2975.93,-7490.51 2975.85,-7482.27"/>
<polygon fill="black" stroke="black" points="2979.35,-7482.2 2975.75,-7472.23 2972.35,-7482.27 2979.35,-7482.2"/>
</g>
<!-- gate_8_0 -->
<g id="node532" class="node">
<title>gate_8_0</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-7383.98 2888.06,-7383.98 2827.49,-7279.98 3062.94,-7279.98 3123.51,-7383.98"/>
<text text-anchor="middle" x="2975.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_8_L0</text>
<text text-anchor="middle" x="2975.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2975.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_0&#45;&gt;gate_8_0 -->
<g id="edge522" class="edge">
<title>attention_8_0&#45;&gt;gate_8_0</title>
<path fill="none" stroke="black" d="M2975.5,-7419.85C2975.5,-7412.16 2975.5,-7403.35 2975.5,-7394.35"/>
<polygon fill="black" stroke="black" points="2979,-7394.16 2975.5,-7384.16 2972,-7394.16 2979,-7394.16"/>
</g>
<!-- expert_8_0 -->
<g id="node533" class="node">
<title>expert_8_0</title>
<polygon fill="lightgreen" stroke="black" points="3050,-7243.98 2901,-7243.98 2901,-7191.98 3050,-7191.98 3050,-7243.98"/>
<text text-anchor="middle" x="2975.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_8_L0</text>
<text text-anchor="middle" x="2975.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2975.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_0&#45;&gt;expert_8_0 -->
<g id="edge523" class="edge">
<title>gate_8_0&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" d="M2968.77,-7279.9C2968.69,-7271.23 2968.83,-7262.41 2969.18,-7254.27"/>
<polygon fill="black" stroke="black" points="2972.69,-7254.21 2969.77,-7244.03 2965.7,-7253.81 2972.69,-7254.21"/>
</g>
<!-- gate_8_0&#45;&gt;expert_8_0 -->
<g id="edge1185" class="edge">
<title>gate_8_0&#45;&gt;expert_8_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.23,-7279.9C2982.31,-7271.23 2982.17,-7262.41 2981.82,-7254.27"/>
<polygon fill="red" stroke="red" points="2985.3,-7253.81 2981.23,-7244.03 2978.31,-7254.21 2985.3,-7253.81"/>
</g>
<!-- aggregate_8_0 -->
<g id="node534" class="node">
<title>aggregate_8_0</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-7155.98 2888.06,-7155.98 2827.49,-7051.98 3062.94,-7051.98 3123.51,-7155.98"/>
<text text-anchor="middle" x="2975.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L0</text>
<text text-anchor="middle" x="2975.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2975.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2975.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_0&#45;&gt;aggregate_8_0 -->
<g id="edge524" class="edge">
<title>expert_8_0&#45;&gt;aggregate_8_0</title>
<path fill="none" stroke="black" d="M2975.5,-7191.85C2975.5,-7184.16 2975.5,-7175.35 2975.5,-7166.35"/>
<polygon fill="black" stroke="black" points="2979,-7166.16 2975.5,-7156.16 2972,-7166.16 2979,-7166.16"/>
</g>
<!-- attention_8_1 -->
<g id="node535" class="node">
<title>attention_8_1</title>
<polygon fill="lightgreen" stroke="black" points="3059.5,-7015.98 2891.5,-7015.98 2891.5,-6963.98 3059.5,-6963.98 3059.5,-7015.98"/>
<text text-anchor="middle" x="2975.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_8_L1</text>
<text text-anchor="middle" x="2975.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2975.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2975.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_0&#45;&gt;attention_8_1 -->
<g id="edge525" class="edge">
<title>aggregate_8_0&#45;&gt;attention_8_1</title>
<path fill="none" stroke="black" d="M2975.5,-7051.9C2975.5,-7043.23 2975.5,-7034.41 2975.5,-7026.27"/>
<polygon fill="black" stroke="black" points="2979,-7026.03 2975.5,-7016.03 2972,-7026.03 2979,-7026.03"/>
</g>
<!-- gate_8_1 -->
<g id="node536" class="node">
<title>gate_8_1</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-6927.98 2888.06,-6927.98 2827.49,-6823.98 3062.94,-6823.98 3123.51,-6927.98"/>
<text text-anchor="middle" x="2975.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_8_L1</text>
<text text-anchor="middle" x="2975.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2975.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_1&#45;&gt;gate_8_1 -->
<g id="edge526" class="edge">
<title>attention_8_1&#45;&gt;gate_8_1</title>
<path fill="none" stroke="black" d="M2975.5,-6963.85C2975.5,-6956.16 2975.5,-6947.35 2975.5,-6938.35"/>
<polygon fill="black" stroke="black" points="2979,-6938.16 2975.5,-6928.16 2972,-6938.16 2979,-6938.16"/>
</g>
<!-- expert_8_1 -->
<g id="node537" class="node">
<title>expert_8_1</title>
<polygon fill="lightgreen" stroke="black" points="3050,-6787.98 2901,-6787.98 2901,-6735.98 3050,-6735.98 3050,-6787.98"/>
<text text-anchor="middle" x="2975.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_8_L1</text>
<text text-anchor="middle" x="2975.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2975.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_1&#45;&gt;expert_8_1 -->
<g id="edge527" class="edge">
<title>gate_8_1&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" d="M2968.77,-6823.9C2968.69,-6815.23 2968.83,-6806.41 2969.18,-6798.27"/>
<polygon fill="black" stroke="black" points="2972.69,-6798.21 2969.77,-6788.03 2965.7,-6797.81 2972.69,-6798.21"/>
</g>
<!-- gate_8_1&#45;&gt;expert_8_1 -->
<g id="edge1186" class="edge">
<title>gate_8_1&#45;&gt;expert_8_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.23,-6823.9C2982.31,-6815.23 2982.17,-6806.41 2981.82,-6798.27"/>
<polygon fill="red" stroke="red" points="2985.3,-6797.81 2981.23,-6788.03 2978.31,-6798.21 2985.3,-6797.81"/>
</g>
<!-- aggregate_8_1 -->
<g id="node538" class="node">
<title>aggregate_8_1</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-6699.98 2888.06,-6699.98 2827.49,-6595.98 3062.94,-6595.98 3123.51,-6699.98"/>
<text text-anchor="middle" x="2975.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L1</text>
<text text-anchor="middle" x="2975.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2975.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2975.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_1&#45;&gt;aggregate_8_1 -->
<g id="edge528" class="edge">
<title>expert_8_1&#45;&gt;aggregate_8_1</title>
<path fill="none" stroke="black" d="M2975.5,-6735.85C2975.5,-6728.16 2975.5,-6719.35 2975.5,-6710.35"/>
<polygon fill="black" stroke="black" points="2979,-6710.16 2975.5,-6700.16 2972,-6710.16 2979,-6710.16"/>
</g>
<!-- attention_8_2 -->
<g id="node539" class="node">
<title>attention_8_2</title>
<polygon fill="lightgreen" stroke="black" points="3059.5,-6559.98 2891.5,-6559.98 2891.5,-6507.98 3059.5,-6507.98 3059.5,-6559.98"/>
<text text-anchor="middle" x="2975.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_8_L2</text>
<text text-anchor="middle" x="2975.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2975.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2975.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_1&#45;&gt;attention_8_2 -->
<g id="edge529" class="edge">
<title>aggregate_8_1&#45;&gt;attention_8_2</title>
<path fill="none" stroke="black" d="M2975.5,-6595.9C2975.5,-6587.23 2975.5,-6578.41 2975.5,-6570.27"/>
<polygon fill="black" stroke="black" points="2979,-6570.03 2975.5,-6560.03 2972,-6570.03 2979,-6570.03"/>
</g>
<!-- gate_8_2 -->
<g id="node540" class="node">
<title>gate_8_2</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-6471.98 2888.06,-6471.98 2827.49,-6367.98 3062.94,-6367.98 3123.51,-6471.98"/>
<text text-anchor="middle" x="2975.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_8_L2</text>
<text text-anchor="middle" x="2975.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2975.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_2&#45;&gt;gate_8_2 -->
<g id="edge530" class="edge">
<title>attention_8_2&#45;&gt;gate_8_2</title>
<path fill="none" stroke="black" d="M2975.5,-6507.85C2975.5,-6500.16 2975.5,-6491.35 2975.5,-6482.35"/>
<polygon fill="black" stroke="black" points="2979,-6482.16 2975.5,-6472.16 2972,-6482.16 2979,-6482.16"/>
</g>
<!-- expert_8_2 -->
<g id="node541" class="node">
<title>expert_8_2</title>
<polygon fill="lightgreen" stroke="black" points="3050,-6331.98 2901,-6331.98 2901,-6279.98 3050,-6279.98 3050,-6331.98"/>
<text text-anchor="middle" x="2975.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_8_L2</text>
<text text-anchor="middle" x="2975.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2975.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2975.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_2&#45;&gt;expert_8_2 -->
<g id="edge531" class="edge">
<title>gate_8_2&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" d="M2968.77,-6367.9C2968.69,-6359.23 2968.83,-6350.41 2969.18,-6342.27"/>
<polygon fill="black" stroke="black" points="2972.69,-6342.21 2969.77,-6332.03 2965.7,-6341.81 2972.69,-6342.21"/>
</g>
<!-- gate_8_2&#45;&gt;expert_8_2 -->
<g id="edge1187" class="edge">
<title>gate_8_2&#45;&gt;expert_8_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2982.23,-6367.9C2982.31,-6359.23 2982.17,-6350.41 2981.82,-6342.27"/>
<polygon fill="red" stroke="red" points="2985.3,-6341.81 2981.23,-6332.03 2978.31,-6342.21 2985.3,-6341.81"/>
</g>
<!-- aggregate_8_2 -->
<g id="node542" class="node">
<title>aggregate_8_2</title>
<polygon fill="lightyellow" stroke="black" points="3123.51,-6243.98 2888.06,-6243.98 2827.49,-6139.98 3062.94,-6139.98 3123.51,-6243.98"/>
<text text-anchor="middle" x="2975.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L2</text>
<text text-anchor="middle" x="2975.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2975.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2975.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_2&#45;&gt;aggregate_8_2 -->
<g id="edge532" class="edge">
<title>expert_8_2&#45;&gt;aggregate_8_2</title>
<path fill="none" stroke="black" d="M2975.5,-6279.85C2975.5,-6272.16 2975.5,-6263.35 2975.5,-6254.35"/>
<polygon fill="black" stroke="black" points="2979,-6254.16 2975.5,-6244.16 2972,-6254.16 2979,-6254.16"/>
</g>
<!-- attention_8_3 -->
<g id="node543" class="node">
<title>attention_8_3</title>
<polygon fill="lightgreen" stroke="black" points="3058.5,-6103.98 2890.5,-6103.98 2890.5,-6051.98 3058.5,-6051.98 3058.5,-6103.98"/>
<text text-anchor="middle" x="2974.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_8_L3</text>
<text text-anchor="middle" x="2974.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2974.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2974.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_2&#45;&gt;attention_8_3 -->
<g id="edge533" class="edge">
<title>aggregate_8_2&#45;&gt;attention_8_3</title>
<path fill="none" stroke="black" d="M2975.04,-6139.9C2974.97,-6131.23 2974.89,-6122.41 2974.82,-6114.27"/>
<polygon fill="black" stroke="black" points="2978.31,-6113.99 2974.72,-6104.03 2971.31,-6114.06 2978.31,-6113.99"/>
</g>
<!-- gate_8_3 -->
<g id="node544" class="node">
<title>gate_8_3</title>
<polygon fill="lightyellow" stroke="black" points="3122.51,-6015.98 2887.06,-6015.98 2826.49,-5911.98 3061.94,-5911.98 3122.51,-6015.98"/>
<text text-anchor="middle" x="2974.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_8_L3</text>
<text text-anchor="middle" x="2974.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2974.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2974.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_3&#45;&gt;gate_8_3 -->
<g id="edge534" class="edge">
<title>attention_8_3&#45;&gt;gate_8_3</title>
<path fill="none" stroke="black" d="M2974.5,-6051.85C2974.5,-6044.16 2974.5,-6035.35 2974.5,-6026.35"/>
<polygon fill="black" stroke="black" points="2978,-6026.16 2974.5,-6016.16 2971,-6026.16 2978,-6026.16"/>
</g>
<!-- expert_8_3 -->
<g id="node545" class="node">
<title>expert_8_3</title>
<polygon fill="lightgreen" stroke="black" points="3046,-5875.98 2897,-5875.98 2897,-5823.98 3046,-5823.98 3046,-5875.98"/>
<text text-anchor="middle" x="2971.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_8_L3</text>
<text text-anchor="middle" x="2971.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_3&#45;&gt;expert_8_3 -->
<g id="edge535" class="edge">
<title>gate_8_3&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" d="M2966.41,-5911.9C2966.09,-5903.23 2965.99,-5894.41 2966.12,-5886.27"/>
<polygon fill="black" stroke="black" points="2969.63,-5886.13 2966.44,-5876.03 2962.63,-5885.91 2969.63,-5886.13"/>
</g>
<!-- gate_8_3&#45;&gt;expert_8_3 -->
<g id="edge1188" class="edge">
<title>gate_8_3&#45;&gt;expert_8_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2979.86,-5911.9C2979.71,-5903.14 2979.33,-5894.21 2978.75,-5885.99"/>
<polygon fill="red" stroke="red" points="2982.24,-5885.7 2977.91,-5876.03 2975.26,-5886.29 2982.24,-5885.7"/>
</g>
<!-- aggregate_8_3 -->
<g id="node546" class="node">
<title>aggregate_8_3</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-5787.98 2884.06,-5787.98 2823.49,-5683.98 3058.94,-5683.98 3119.51,-5787.98"/>
<text text-anchor="middle" x="2971.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L3</text>
<text text-anchor="middle" x="2971.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_3&#45;&gt;aggregate_8_3 -->
<g id="edge536" class="edge">
<title>expert_8_3&#45;&gt;aggregate_8_3</title>
<path fill="none" stroke="black" d="M2971.5,-5823.85C2971.5,-5816.16 2971.5,-5807.35 2971.5,-5798.35"/>
<polygon fill="black" stroke="black" points="2975,-5798.16 2971.5,-5788.16 2968,-5798.16 2975,-5798.16"/>
</g>
<!-- attention_8_4 -->
<g id="node547" class="node">
<title>attention_8_4</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-5647.98 2887.5,-5647.98 2887.5,-5595.98 3055.5,-5595.98 3055.5,-5647.98"/>
<text text-anchor="middle" x="2971.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_8_L4</text>
<text text-anchor="middle" x="2971.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_3&#45;&gt;attention_8_4 -->
<g id="edge537" class="edge">
<title>aggregate_8_3&#45;&gt;attention_8_4</title>
<path fill="none" stroke="black" d="M2971.5,-5683.9C2971.5,-5675.23 2971.5,-5666.41 2971.5,-5658.27"/>
<polygon fill="black" stroke="black" points="2975,-5658.03 2971.5,-5648.03 2968,-5658.03 2975,-5658.03"/>
</g>
<!-- gate_8_4 -->
<g id="node548" class="node">
<title>gate_8_4</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-5559.98 2884.06,-5559.98 2823.49,-5455.98 3058.94,-5455.98 3119.51,-5559.98"/>
<text text-anchor="middle" x="2971.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_8_L4</text>
<text text-anchor="middle" x="2971.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_4&#45;&gt;gate_8_4 -->
<g id="edge538" class="edge">
<title>attention_8_4&#45;&gt;gate_8_4</title>
<path fill="none" stroke="black" d="M2971.5,-5595.85C2971.5,-5588.16 2971.5,-5579.35 2971.5,-5570.35"/>
<polygon fill="black" stroke="black" points="2975,-5570.16 2971.5,-5560.16 2968,-5570.16 2975,-5570.16"/>
</g>
<!-- expert_8_4 -->
<g id="node549" class="node">
<title>expert_8_4</title>
<polygon fill="lightgreen" stroke="black" points="3046,-5419.98 2897,-5419.98 2897,-5367.98 3046,-5367.98 3046,-5419.98"/>
<text text-anchor="middle" x="2971.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_8_L4</text>
<text text-anchor="middle" x="2971.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_4&#45;&gt;expert_8_4 -->
<g id="edge539" class="edge">
<title>gate_8_4&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" d="M2964.77,-5455.9C2964.69,-5447.23 2964.83,-5438.41 2965.18,-5430.27"/>
<polygon fill="black" stroke="black" points="2968.69,-5430.21 2965.77,-5420.03 2961.7,-5429.81 2968.69,-5430.21"/>
</g>
<!-- gate_8_4&#45;&gt;expert_8_4 -->
<g id="edge1189" class="edge">
<title>gate_8_4&#45;&gt;expert_8_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-5455.9C2978.31,-5447.23 2978.17,-5438.41 2977.82,-5430.27"/>
<polygon fill="red" stroke="red" points="2981.3,-5429.81 2977.23,-5420.03 2974.31,-5430.21 2981.3,-5429.81"/>
</g>
<!-- aggregate_8_4 -->
<g id="node550" class="node">
<title>aggregate_8_4</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-5331.98 2884.06,-5331.98 2823.49,-5227.98 3058.94,-5227.98 3119.51,-5331.98"/>
<text text-anchor="middle" x="2971.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L4</text>
<text text-anchor="middle" x="2971.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_4&#45;&gt;aggregate_8_4 -->
<g id="edge540" class="edge">
<title>expert_8_4&#45;&gt;aggregate_8_4</title>
<path fill="none" stroke="black" d="M2971.5,-5367.85C2971.5,-5360.16 2971.5,-5351.35 2971.5,-5342.35"/>
<polygon fill="black" stroke="black" points="2975,-5342.16 2971.5,-5332.16 2968,-5342.16 2975,-5342.16"/>
</g>
<!-- attention_8_5 -->
<g id="node551" class="node">
<title>attention_8_5</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-5191.98 2887.5,-5191.98 2887.5,-5139.98 3055.5,-5139.98 3055.5,-5191.98"/>
<text text-anchor="middle" x="2971.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_8_L5</text>
<text text-anchor="middle" x="2971.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_4&#45;&gt;attention_8_5 -->
<g id="edge541" class="edge">
<title>aggregate_8_4&#45;&gt;attention_8_5</title>
<path fill="none" stroke="black" d="M2971.5,-5227.9C2971.5,-5219.23 2971.5,-5210.41 2971.5,-5202.27"/>
<polygon fill="black" stroke="black" points="2975,-5202.03 2971.5,-5192.03 2968,-5202.03 2975,-5202.03"/>
</g>
<!-- gate_8_5 -->
<g id="node552" class="node">
<title>gate_8_5</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-5103.98 2884.06,-5103.98 2823.49,-4999.98 3058.94,-4999.98 3119.51,-5103.98"/>
<text text-anchor="middle" x="2971.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_8_L5</text>
<text text-anchor="middle" x="2971.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_5&#45;&gt;gate_8_5 -->
<g id="edge542" class="edge">
<title>attention_8_5&#45;&gt;gate_8_5</title>
<path fill="none" stroke="black" d="M2971.5,-5139.85C2971.5,-5132.16 2971.5,-5123.35 2971.5,-5114.35"/>
<polygon fill="black" stroke="black" points="2975,-5114.16 2971.5,-5104.16 2968,-5114.16 2975,-5114.16"/>
</g>
<!-- expert_8_5 -->
<g id="node553" class="node">
<title>expert_8_5</title>
<polygon fill="lightgreen" stroke="black" points="3046,-4963.98 2897,-4963.98 2897,-4911.98 3046,-4911.98 3046,-4963.98"/>
<text text-anchor="middle" x="2971.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_8_L5</text>
<text text-anchor="middle" x="2971.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_5&#45;&gt;expert_8_5 -->
<g id="edge543" class="edge">
<title>gate_8_5&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" d="M2964.77,-4999.9C2964.69,-4991.23 2964.83,-4982.41 2965.18,-4974.27"/>
<polygon fill="black" stroke="black" points="2968.69,-4974.21 2965.77,-4964.03 2961.7,-4973.81 2968.69,-4974.21"/>
</g>
<!-- gate_8_5&#45;&gt;expert_8_5 -->
<g id="edge1190" class="edge">
<title>gate_8_5&#45;&gt;expert_8_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-4999.9C2978.31,-4991.23 2978.17,-4982.41 2977.82,-4974.27"/>
<polygon fill="red" stroke="red" points="2981.3,-4973.81 2977.23,-4964.03 2974.31,-4974.21 2981.3,-4973.81"/>
</g>
<!-- aggregate_8_5 -->
<g id="node554" class="node">
<title>aggregate_8_5</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-4875.98 2884.06,-4875.98 2823.49,-4771.98 3058.94,-4771.98 3119.51,-4875.98"/>
<text text-anchor="middle" x="2971.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L5</text>
<text text-anchor="middle" x="2971.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_5&#45;&gt;aggregate_8_5 -->
<g id="edge544" class="edge">
<title>expert_8_5&#45;&gt;aggregate_8_5</title>
<path fill="none" stroke="black" d="M2971.5,-4911.85C2971.5,-4904.16 2971.5,-4895.35 2971.5,-4886.35"/>
<polygon fill="black" stroke="black" points="2975,-4886.16 2971.5,-4876.16 2968,-4886.16 2975,-4886.16"/>
</g>
<!-- attention_8_6 -->
<g id="node555" class="node">
<title>attention_8_6</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-4735.98 2887.5,-4735.98 2887.5,-4683.98 3055.5,-4683.98 3055.5,-4735.98"/>
<text text-anchor="middle" x="2971.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_8_L6</text>
<text text-anchor="middle" x="2971.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_5&#45;&gt;attention_8_6 -->
<g id="edge545" class="edge">
<title>aggregate_8_5&#45;&gt;attention_8_6</title>
<path fill="none" stroke="black" d="M2971.5,-4771.9C2971.5,-4763.23 2971.5,-4754.41 2971.5,-4746.27"/>
<polygon fill="black" stroke="black" points="2975,-4746.03 2971.5,-4736.03 2968,-4746.03 2975,-4746.03"/>
</g>
<!-- gate_8_6 -->
<g id="node556" class="node">
<title>gate_8_6</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-4647.98 2884.06,-4647.98 2823.49,-4543.98 3058.94,-4543.98 3119.51,-4647.98"/>
<text text-anchor="middle" x="2971.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_8_L6</text>
<text text-anchor="middle" x="2971.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_6&#45;&gt;gate_8_6 -->
<g id="edge546" class="edge">
<title>attention_8_6&#45;&gt;gate_8_6</title>
<path fill="none" stroke="black" d="M2971.5,-4683.85C2971.5,-4676.16 2971.5,-4667.35 2971.5,-4658.35"/>
<polygon fill="black" stroke="black" points="2975,-4658.16 2971.5,-4648.16 2968,-4658.16 2975,-4658.16"/>
</g>
<!-- expert_8_6 -->
<g id="node557" class="node">
<title>expert_8_6</title>
<polygon fill="lightgreen" stroke="black" points="3046,-4507.98 2897,-4507.98 2897,-4455.98 3046,-4455.98 3046,-4507.98"/>
<text text-anchor="middle" x="2971.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_8_L6</text>
<text text-anchor="middle" x="2971.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_6&#45;&gt;expert_8_6 -->
<g id="edge547" class="edge">
<title>gate_8_6&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" d="M2964.77,-4543.9C2964.69,-4535.23 2964.83,-4526.41 2965.18,-4518.27"/>
<polygon fill="black" stroke="black" points="2968.69,-4518.21 2965.77,-4508.03 2961.7,-4517.81 2968.69,-4518.21"/>
</g>
<!-- gate_8_6&#45;&gt;expert_8_6 -->
<g id="edge1191" class="edge">
<title>gate_8_6&#45;&gt;expert_8_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-4543.9C2978.31,-4535.23 2978.17,-4526.41 2977.82,-4518.27"/>
<polygon fill="red" stroke="red" points="2981.3,-4517.81 2977.23,-4508.03 2974.31,-4518.21 2981.3,-4517.81"/>
</g>
<!-- aggregate_8_6 -->
<g id="node558" class="node">
<title>aggregate_8_6</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-4419.98 2884.06,-4419.98 2823.49,-4315.98 3058.94,-4315.98 3119.51,-4419.98"/>
<text text-anchor="middle" x="2971.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L6</text>
<text text-anchor="middle" x="2971.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_6&#45;&gt;aggregate_8_6 -->
<g id="edge548" class="edge">
<title>expert_8_6&#45;&gt;aggregate_8_6</title>
<path fill="none" stroke="black" d="M2971.5,-4455.85C2971.5,-4448.16 2971.5,-4439.35 2971.5,-4430.35"/>
<polygon fill="black" stroke="black" points="2975,-4430.16 2971.5,-4420.16 2968,-4430.16 2975,-4430.16"/>
</g>
<!-- attention_8_7 -->
<g id="node559" class="node">
<title>attention_8_7</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-4279.98 2887.5,-4279.98 2887.5,-4227.98 3055.5,-4227.98 3055.5,-4279.98"/>
<text text-anchor="middle" x="2971.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_8_L7</text>
<text text-anchor="middle" x="2971.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_6&#45;&gt;attention_8_7 -->
<g id="edge549" class="edge">
<title>aggregate_8_6&#45;&gt;attention_8_7</title>
<path fill="none" stroke="black" d="M2971.5,-4315.9C2971.5,-4307.23 2971.5,-4298.41 2971.5,-4290.27"/>
<polygon fill="black" stroke="black" points="2975,-4290.03 2971.5,-4280.03 2968,-4290.03 2975,-4290.03"/>
</g>
<!-- gate_8_7 -->
<g id="node560" class="node">
<title>gate_8_7</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-4191.98 2884.06,-4191.98 2823.49,-4087.98 3058.94,-4087.98 3119.51,-4191.98"/>
<text text-anchor="middle" x="2971.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_8_L7</text>
<text text-anchor="middle" x="2971.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_7&#45;&gt;gate_8_7 -->
<g id="edge550" class="edge">
<title>attention_8_7&#45;&gt;gate_8_7</title>
<path fill="none" stroke="black" d="M2971.5,-4227.85C2971.5,-4220.16 2971.5,-4211.35 2971.5,-4202.35"/>
<polygon fill="black" stroke="black" points="2975,-4202.16 2971.5,-4192.16 2968,-4202.16 2975,-4202.16"/>
</g>
<!-- expert_8_7 -->
<g id="node561" class="node">
<title>expert_8_7</title>
<polygon fill="lightgreen" stroke="black" points="3046,-4051.98 2897,-4051.98 2897,-3999.98 3046,-3999.98 3046,-4051.98"/>
<text text-anchor="middle" x="2971.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_8_L7</text>
<text text-anchor="middle" x="2971.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_7&#45;&gt;expert_8_7 -->
<g id="edge551" class="edge">
<title>gate_8_7&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" d="M2964.77,-4087.9C2964.69,-4079.23 2964.83,-4070.41 2965.18,-4062.27"/>
<polygon fill="black" stroke="black" points="2968.69,-4062.21 2965.77,-4052.03 2961.7,-4061.81 2968.69,-4062.21"/>
</g>
<!-- gate_8_7&#45;&gt;expert_8_7 -->
<g id="edge1192" class="edge">
<title>gate_8_7&#45;&gt;expert_8_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-4087.9C2978.31,-4079.23 2978.17,-4070.41 2977.82,-4062.27"/>
<polygon fill="red" stroke="red" points="2981.3,-4061.81 2977.23,-4052.03 2974.31,-4062.21 2981.3,-4061.81"/>
</g>
<!-- aggregate_8_7 -->
<g id="node562" class="node">
<title>aggregate_8_7</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-3963.98 2884.06,-3963.98 2823.49,-3859.98 3058.94,-3859.98 3119.51,-3963.98"/>
<text text-anchor="middle" x="2971.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L7</text>
<text text-anchor="middle" x="2971.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_7&#45;&gt;aggregate_8_7 -->
<g id="edge552" class="edge">
<title>expert_8_7&#45;&gt;aggregate_8_7</title>
<path fill="none" stroke="black" d="M2971.5,-3999.85C2971.5,-3992.16 2971.5,-3983.35 2971.5,-3974.35"/>
<polygon fill="black" stroke="black" points="2975,-3974.16 2971.5,-3964.16 2968,-3974.16 2975,-3974.16"/>
</g>
<!-- attention_8_8 -->
<g id="node563" class="node">
<title>attention_8_8</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-3823.98 2887.5,-3823.98 2887.5,-3771.98 3055.5,-3771.98 3055.5,-3823.98"/>
<text text-anchor="middle" x="2971.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_8_L8</text>
<text text-anchor="middle" x="2971.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_7&#45;&gt;attention_8_8 -->
<g id="edge553" class="edge">
<title>aggregate_8_7&#45;&gt;attention_8_8</title>
<path fill="none" stroke="black" d="M2971.5,-3859.9C2971.5,-3851.23 2971.5,-3842.41 2971.5,-3834.27"/>
<polygon fill="black" stroke="black" points="2975,-3834.03 2971.5,-3824.03 2968,-3834.03 2975,-3834.03"/>
</g>
<!-- gate_8_8 -->
<g id="node564" class="node">
<title>gate_8_8</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-3735.98 2884.06,-3735.98 2823.49,-3631.98 3058.94,-3631.98 3119.51,-3735.98"/>
<text text-anchor="middle" x="2971.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_8_L8</text>
<text text-anchor="middle" x="2971.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_8&#45;&gt;gate_8_8 -->
<g id="edge554" class="edge">
<title>attention_8_8&#45;&gt;gate_8_8</title>
<path fill="none" stroke="black" d="M2971.5,-3771.85C2971.5,-3764.16 2971.5,-3755.35 2971.5,-3746.35"/>
<polygon fill="black" stroke="black" points="2975,-3746.16 2971.5,-3736.16 2968,-3746.16 2975,-3746.16"/>
</g>
<!-- expert_8_8 -->
<g id="node565" class="node">
<title>expert_8_8</title>
<polygon fill="lightgreen" stroke="black" points="3046,-3595.98 2897,-3595.98 2897,-3543.98 3046,-3543.98 3046,-3595.98"/>
<text text-anchor="middle" x="2971.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_8_L8</text>
<text text-anchor="middle" x="2971.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_8&#45;&gt;expert_8_8 -->
<g id="edge555" class="edge">
<title>gate_8_8&#45;&gt;expert_8_8</title>
<path fill="none" stroke="black" d="M2964.77,-3631.9C2964.69,-3623.23 2964.83,-3614.41 2965.18,-3606.27"/>
<polygon fill="black" stroke="black" points="2968.69,-3606.21 2965.77,-3596.03 2961.7,-3605.81 2968.69,-3606.21"/>
</g>
<!-- gate_8_8&#45;&gt;expert_8_8 -->
<g id="edge1193" class="edge">
<title>gate_8_8&#45;&gt;expert_8_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-3631.9C2978.31,-3623.23 2978.17,-3614.41 2977.82,-3606.27"/>
<polygon fill="red" stroke="red" points="2981.3,-3605.81 2977.23,-3596.03 2974.31,-3606.21 2981.3,-3605.81"/>
</g>
<!-- aggregate_8_8 -->
<g id="node566" class="node">
<title>aggregate_8_8</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-3507.98 2884.06,-3507.98 2823.49,-3403.98 3058.94,-3403.98 3119.51,-3507.98"/>
<text text-anchor="middle" x="2971.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L8</text>
<text text-anchor="middle" x="2971.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_8&#45;&gt;aggregate_8_8 -->
<g id="edge556" class="edge">
<title>expert_8_8&#45;&gt;aggregate_8_8</title>
<path fill="none" stroke="black" d="M2971.5,-3543.85C2971.5,-3536.16 2971.5,-3527.35 2971.5,-3518.35"/>
<polygon fill="black" stroke="black" points="2975,-3518.16 2971.5,-3508.16 2968,-3518.16 2975,-3518.16"/>
</g>
<!-- attention_8_9 -->
<g id="node567" class="node">
<title>attention_8_9</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-3367.98 2887.5,-3367.98 2887.5,-3315.98 3055.5,-3315.98 3055.5,-3367.98"/>
<text text-anchor="middle" x="2971.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_8_L9</text>
<text text-anchor="middle" x="2971.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_8&#45;&gt;attention_8_9 -->
<g id="edge557" class="edge">
<title>aggregate_8_8&#45;&gt;attention_8_9</title>
<path fill="none" stroke="black" d="M2971.5,-3403.9C2971.5,-3395.23 2971.5,-3386.41 2971.5,-3378.27"/>
<polygon fill="black" stroke="black" points="2975,-3378.03 2971.5,-3368.03 2968,-3378.03 2975,-3378.03"/>
</g>
<!-- gate_8_9 -->
<g id="node568" class="node">
<title>gate_8_9</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-3279.98 2884.06,-3279.98 2823.49,-3175.98 3058.94,-3175.98 3119.51,-3279.98"/>
<text text-anchor="middle" x="2971.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_8_L9</text>
<text text-anchor="middle" x="2971.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_9&#45;&gt;gate_8_9 -->
<g id="edge558" class="edge">
<title>attention_8_9&#45;&gt;gate_8_9</title>
<path fill="none" stroke="black" d="M2971.5,-3315.85C2971.5,-3308.16 2971.5,-3299.35 2971.5,-3290.35"/>
<polygon fill="black" stroke="black" points="2975,-3290.16 2971.5,-3280.16 2968,-3290.16 2975,-3290.16"/>
</g>
<!-- expert_8_9 -->
<g id="node569" class="node">
<title>expert_8_9</title>
<polygon fill="lightgreen" stroke="black" points="3046,-3139.98 2897,-3139.98 2897,-3087.98 3046,-3087.98 3046,-3139.98"/>
<text text-anchor="middle" x="2971.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_8_L9</text>
<text text-anchor="middle" x="2971.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_9&#45;&gt;expert_8_9 -->
<g id="edge559" class="edge">
<title>gate_8_9&#45;&gt;expert_8_9</title>
<path fill="none" stroke="black" d="M2964.77,-3175.9C2964.69,-3167.23 2964.83,-3158.41 2965.18,-3150.27"/>
<polygon fill="black" stroke="black" points="2968.69,-3150.21 2965.77,-3140.03 2961.7,-3149.81 2968.69,-3150.21"/>
</g>
<!-- gate_8_9&#45;&gt;expert_8_9 -->
<g id="edge1194" class="edge">
<title>gate_8_9&#45;&gt;expert_8_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-3175.9C2978.31,-3167.23 2978.17,-3158.41 2977.82,-3150.27"/>
<polygon fill="red" stroke="red" points="2981.3,-3149.81 2977.23,-3140.03 2974.31,-3150.21 2981.3,-3149.81"/>
</g>
<!-- aggregate_8_9 -->
<g id="node570" class="node">
<title>aggregate_8_9</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-3051.98 2884.06,-3051.98 2823.49,-2947.98 3058.94,-2947.98 3119.51,-3051.98"/>
<text text-anchor="middle" x="2971.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L9</text>
<text text-anchor="middle" x="2971.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_9&#45;&gt;aggregate_8_9 -->
<g id="edge560" class="edge">
<title>expert_8_9&#45;&gt;aggregate_8_9</title>
<path fill="none" stroke="black" d="M2971.5,-3087.85C2971.5,-3080.16 2971.5,-3071.35 2971.5,-3062.35"/>
<polygon fill="black" stroke="black" points="2975,-3062.16 2971.5,-3052.16 2968,-3062.16 2975,-3062.16"/>
</g>
<!-- attention_8_10 -->
<g id="node571" class="node">
<title>attention_8_10</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-2911.98 2887.5,-2911.98 2887.5,-2859.98 3055.5,-2859.98 3055.5,-2911.98"/>
<text text-anchor="middle" x="2971.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_8_L10</text>
<text text-anchor="middle" x="2971.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_9&#45;&gt;attention_8_10 -->
<g id="edge561" class="edge">
<title>aggregate_8_9&#45;&gt;attention_8_10</title>
<path fill="none" stroke="black" d="M2971.5,-2947.9C2971.5,-2939.23 2971.5,-2930.41 2971.5,-2922.27"/>
<polygon fill="black" stroke="black" points="2975,-2922.03 2971.5,-2912.03 2968,-2922.03 2975,-2922.03"/>
</g>
<!-- gate_8_10 -->
<g id="node572" class="node">
<title>gate_8_10</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-2823.98 2884.06,-2823.98 2823.49,-2719.98 3058.94,-2719.98 3119.51,-2823.98"/>
<text text-anchor="middle" x="2971.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_8_L10</text>
<text text-anchor="middle" x="2971.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_10&#45;&gt;gate_8_10 -->
<g id="edge562" class="edge">
<title>attention_8_10&#45;&gt;gate_8_10</title>
<path fill="none" stroke="black" d="M2971.5,-2859.85C2971.5,-2852.16 2971.5,-2843.35 2971.5,-2834.35"/>
<polygon fill="black" stroke="black" points="2975,-2834.16 2971.5,-2824.16 2968,-2834.16 2975,-2834.16"/>
</g>
<!-- expert_8_10 -->
<g id="node573" class="node">
<title>expert_8_10</title>
<polygon fill="lightgreen" stroke="black" points="3046,-2683.98 2897,-2683.98 2897,-2631.98 3046,-2631.98 3046,-2683.98"/>
<text text-anchor="middle" x="2971.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_8_L10</text>
<text text-anchor="middle" x="2971.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_10&#45;&gt;expert_8_10 -->
<g id="edge563" class="edge">
<title>gate_8_10&#45;&gt;expert_8_10</title>
<path fill="none" stroke="black" d="M2964.77,-2719.9C2964.69,-2711.23 2964.83,-2702.41 2965.18,-2694.27"/>
<polygon fill="black" stroke="black" points="2968.69,-2694.21 2965.77,-2684.03 2961.7,-2693.81 2968.69,-2694.21"/>
</g>
<!-- gate_8_10&#45;&gt;expert_8_10 -->
<g id="edge1195" class="edge">
<title>gate_8_10&#45;&gt;expert_8_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-2719.9C2978.31,-2711.23 2978.17,-2702.41 2977.82,-2694.27"/>
<polygon fill="red" stroke="red" points="2981.3,-2693.81 2977.23,-2684.03 2974.31,-2694.21 2981.3,-2693.81"/>
</g>
<!-- aggregate_8_10 -->
<g id="node574" class="node">
<title>aggregate_8_10</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-2595.98 2884.06,-2595.98 2823.49,-2491.98 3058.94,-2491.98 3119.51,-2595.98"/>
<text text-anchor="middle" x="2971.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L10</text>
<text text-anchor="middle" x="2971.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_10&#45;&gt;aggregate_8_10 -->
<g id="edge564" class="edge">
<title>expert_8_10&#45;&gt;aggregate_8_10</title>
<path fill="none" stroke="black" d="M2971.5,-2631.85C2971.5,-2624.16 2971.5,-2615.35 2971.5,-2606.35"/>
<polygon fill="black" stroke="black" points="2975,-2606.16 2971.5,-2596.16 2968,-2606.16 2975,-2606.16"/>
</g>
<!-- attention_8_11 -->
<g id="node575" class="node">
<title>attention_8_11</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-2455.98 2887.5,-2455.98 2887.5,-2403.98 3055.5,-2403.98 3055.5,-2455.98"/>
<text text-anchor="middle" x="2971.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_8_L11</text>
<text text-anchor="middle" x="2971.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_10&#45;&gt;attention_8_11 -->
<g id="edge565" class="edge">
<title>aggregate_8_10&#45;&gt;attention_8_11</title>
<path fill="none" stroke="black" d="M2971.5,-2491.9C2971.5,-2483.23 2971.5,-2474.41 2971.5,-2466.27"/>
<polygon fill="black" stroke="black" points="2975,-2466.03 2971.5,-2456.03 2968,-2466.03 2975,-2466.03"/>
</g>
<!-- gate_8_11 -->
<g id="node576" class="node">
<title>gate_8_11</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-2367.98 2884.06,-2367.98 2823.49,-2263.98 3058.94,-2263.98 3119.51,-2367.98"/>
<text text-anchor="middle" x="2971.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_8_L11</text>
<text text-anchor="middle" x="2971.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_11&#45;&gt;gate_8_11 -->
<g id="edge566" class="edge">
<title>attention_8_11&#45;&gt;gate_8_11</title>
<path fill="none" stroke="black" d="M2971.5,-2403.85C2971.5,-2396.16 2971.5,-2387.35 2971.5,-2378.35"/>
<polygon fill="black" stroke="black" points="2975,-2378.16 2971.5,-2368.16 2968,-2378.16 2975,-2378.16"/>
</g>
<!-- expert_8_11 -->
<g id="node577" class="node">
<title>expert_8_11</title>
<polygon fill="lightgreen" stroke="black" points="3046,-2227.98 2897,-2227.98 2897,-2175.98 3046,-2175.98 3046,-2227.98"/>
<text text-anchor="middle" x="2971.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_8_L11</text>
<text text-anchor="middle" x="2971.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_11&#45;&gt;expert_8_11 -->
<g id="edge567" class="edge">
<title>gate_8_11&#45;&gt;expert_8_11</title>
<path fill="none" stroke="black" d="M2964.77,-2263.9C2964.69,-2255.23 2964.83,-2246.41 2965.18,-2238.27"/>
<polygon fill="black" stroke="black" points="2968.69,-2238.21 2965.77,-2228.03 2961.7,-2237.81 2968.69,-2238.21"/>
</g>
<!-- gate_8_11&#45;&gt;expert_8_11 -->
<g id="edge1196" class="edge">
<title>gate_8_11&#45;&gt;expert_8_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-2263.9C2978.31,-2255.23 2978.17,-2246.41 2977.82,-2238.27"/>
<polygon fill="red" stroke="red" points="2981.3,-2237.81 2977.23,-2228.03 2974.31,-2238.21 2981.3,-2237.81"/>
</g>
<!-- aggregate_8_11 -->
<g id="node578" class="node">
<title>aggregate_8_11</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-2139.98 2884.06,-2139.98 2823.49,-2035.98 3058.94,-2035.98 3119.51,-2139.98"/>
<text text-anchor="middle" x="2971.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L11</text>
<text text-anchor="middle" x="2971.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_11&#45;&gt;aggregate_8_11 -->
<g id="edge568" class="edge">
<title>expert_8_11&#45;&gt;aggregate_8_11</title>
<path fill="none" stroke="black" d="M2971.5,-2175.85C2971.5,-2168.16 2971.5,-2159.35 2971.5,-2150.35"/>
<polygon fill="black" stroke="black" points="2975,-2150.16 2971.5,-2140.16 2968,-2150.16 2975,-2150.16"/>
</g>
<!-- attention_8_12 -->
<g id="node579" class="node">
<title>attention_8_12</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-1999.98 2887.5,-1999.98 2887.5,-1947.98 3055.5,-1947.98 3055.5,-1999.98"/>
<text text-anchor="middle" x="2971.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_8_L12</text>
<text text-anchor="middle" x="2971.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_11&#45;&gt;attention_8_12 -->
<g id="edge569" class="edge">
<title>aggregate_8_11&#45;&gt;attention_8_12</title>
<path fill="none" stroke="black" d="M2971.5,-2035.9C2971.5,-2027.23 2971.5,-2018.41 2971.5,-2010.27"/>
<polygon fill="black" stroke="black" points="2975,-2010.03 2971.5,-2000.03 2968,-2010.03 2975,-2010.03"/>
</g>
<!-- gate_8_12 -->
<g id="node580" class="node">
<title>gate_8_12</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-1911.98 2884.06,-1911.98 2823.49,-1807.98 3058.94,-1807.98 3119.51,-1911.98"/>
<text text-anchor="middle" x="2971.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_8_L12</text>
<text text-anchor="middle" x="2971.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_12&#45;&gt;gate_8_12 -->
<g id="edge570" class="edge">
<title>attention_8_12&#45;&gt;gate_8_12</title>
<path fill="none" stroke="black" d="M2971.5,-1947.85C2971.5,-1940.16 2971.5,-1931.35 2971.5,-1922.35"/>
<polygon fill="black" stroke="black" points="2975,-1922.16 2971.5,-1912.16 2968,-1922.16 2975,-1922.16"/>
</g>
<!-- expert_8_12 -->
<g id="node581" class="node">
<title>expert_8_12</title>
<polygon fill="lightgreen" stroke="black" points="3046,-1771.98 2897,-1771.98 2897,-1719.98 3046,-1719.98 3046,-1771.98"/>
<text text-anchor="middle" x="2971.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_8_L12</text>
<text text-anchor="middle" x="2971.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_12&#45;&gt;expert_8_12 -->
<g id="edge571" class="edge">
<title>gate_8_12&#45;&gt;expert_8_12</title>
<path fill="none" stroke="black" d="M2964.77,-1807.9C2964.69,-1799.23 2964.83,-1790.41 2965.18,-1782.27"/>
<polygon fill="black" stroke="black" points="2968.69,-1782.21 2965.77,-1772.03 2961.7,-1781.81 2968.69,-1782.21"/>
</g>
<!-- gate_8_12&#45;&gt;expert_8_12 -->
<g id="edge1197" class="edge">
<title>gate_8_12&#45;&gt;expert_8_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-1807.9C2978.31,-1799.23 2978.17,-1790.41 2977.82,-1782.27"/>
<polygon fill="red" stroke="red" points="2981.3,-1781.81 2977.23,-1772.03 2974.31,-1782.21 2981.3,-1781.81"/>
</g>
<!-- aggregate_8_12 -->
<g id="node582" class="node">
<title>aggregate_8_12</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-1683.98 2884.06,-1683.98 2823.49,-1579.98 3058.94,-1579.98 3119.51,-1683.98"/>
<text text-anchor="middle" x="2971.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L12</text>
<text text-anchor="middle" x="2971.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_12&#45;&gt;aggregate_8_12 -->
<g id="edge572" class="edge">
<title>expert_8_12&#45;&gt;aggregate_8_12</title>
<path fill="none" stroke="black" d="M2971.5,-1719.85C2971.5,-1712.16 2971.5,-1703.35 2971.5,-1694.35"/>
<polygon fill="black" stroke="black" points="2975,-1694.16 2971.5,-1684.16 2968,-1694.16 2975,-1694.16"/>
</g>
<!-- attention_8_13 -->
<g id="node583" class="node">
<title>attention_8_13</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-1543.98 2887.5,-1543.98 2887.5,-1491.98 3055.5,-1491.98 3055.5,-1543.98"/>
<text text-anchor="middle" x="2971.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_8_L13</text>
<text text-anchor="middle" x="2971.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_12&#45;&gt;attention_8_13 -->
<g id="edge573" class="edge">
<title>aggregate_8_12&#45;&gt;attention_8_13</title>
<path fill="none" stroke="black" d="M2971.5,-1579.9C2971.5,-1571.23 2971.5,-1562.41 2971.5,-1554.27"/>
<polygon fill="black" stroke="black" points="2975,-1554.03 2971.5,-1544.03 2968,-1554.03 2975,-1554.03"/>
</g>
<!-- gate_8_13 -->
<g id="node584" class="node">
<title>gate_8_13</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-1455.98 2884.06,-1455.98 2823.49,-1351.98 3058.94,-1351.98 3119.51,-1455.98"/>
<text text-anchor="middle" x="2971.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_8_L13</text>
<text text-anchor="middle" x="2971.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_13&#45;&gt;gate_8_13 -->
<g id="edge574" class="edge">
<title>attention_8_13&#45;&gt;gate_8_13</title>
<path fill="none" stroke="black" d="M2971.5,-1491.85C2971.5,-1484.16 2971.5,-1475.35 2971.5,-1466.35"/>
<polygon fill="black" stroke="black" points="2975,-1466.16 2971.5,-1456.16 2968,-1466.16 2975,-1466.16"/>
</g>
<!-- expert_8_13 -->
<g id="node585" class="node">
<title>expert_8_13</title>
<polygon fill="lightgreen" stroke="black" points="3046,-1315.98 2897,-1315.98 2897,-1263.98 3046,-1263.98 3046,-1315.98"/>
<text text-anchor="middle" x="2971.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_8_L13</text>
<text text-anchor="middle" x="2971.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_13&#45;&gt;expert_8_13 -->
<g id="edge575" class="edge">
<title>gate_8_13&#45;&gt;expert_8_13</title>
<path fill="none" stroke="black" d="M2964.77,-1351.9C2964.69,-1343.23 2964.83,-1334.41 2965.18,-1326.27"/>
<polygon fill="black" stroke="black" points="2968.69,-1326.21 2965.77,-1316.03 2961.7,-1325.81 2968.69,-1326.21"/>
</g>
<!-- gate_8_13&#45;&gt;expert_8_13 -->
<g id="edge1198" class="edge">
<title>gate_8_13&#45;&gt;expert_8_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-1351.9C2978.31,-1343.23 2978.17,-1334.41 2977.82,-1326.27"/>
<polygon fill="red" stroke="red" points="2981.3,-1325.81 2977.23,-1316.03 2974.31,-1326.21 2981.3,-1325.81"/>
</g>
<!-- aggregate_8_13 -->
<g id="node586" class="node">
<title>aggregate_8_13</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-1227.98 2884.06,-1227.98 2823.49,-1123.98 3058.94,-1123.98 3119.51,-1227.98"/>
<text text-anchor="middle" x="2971.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L13</text>
<text text-anchor="middle" x="2971.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_13&#45;&gt;aggregate_8_13 -->
<g id="edge576" class="edge">
<title>expert_8_13&#45;&gt;aggregate_8_13</title>
<path fill="none" stroke="black" d="M2971.5,-1263.85C2971.5,-1256.16 2971.5,-1247.35 2971.5,-1238.35"/>
<polygon fill="black" stroke="black" points="2975,-1238.16 2971.5,-1228.16 2968,-1238.16 2975,-1238.16"/>
</g>
<!-- attention_8_14 -->
<g id="node587" class="node">
<title>attention_8_14</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-1087.98 2887.5,-1087.98 2887.5,-1035.98 3055.5,-1035.98 3055.5,-1087.98"/>
<text text-anchor="middle" x="2971.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_8_L14</text>
<text text-anchor="middle" x="2971.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_13&#45;&gt;attention_8_14 -->
<g id="edge577" class="edge">
<title>aggregate_8_13&#45;&gt;attention_8_14</title>
<path fill="none" stroke="black" d="M2971.5,-1123.9C2971.5,-1115.23 2971.5,-1106.41 2971.5,-1098.27"/>
<polygon fill="black" stroke="black" points="2975,-1098.03 2971.5,-1088.03 2968,-1098.03 2975,-1098.03"/>
</g>
<!-- gate_8_14 -->
<g id="node588" class="node">
<title>gate_8_14</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-999.98 2884.06,-999.98 2823.49,-895.98 3058.94,-895.98 3119.51,-999.98"/>
<text text-anchor="middle" x="2971.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_8_L14</text>
<text text-anchor="middle" x="2971.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_14&#45;&gt;gate_8_14 -->
<g id="edge578" class="edge">
<title>attention_8_14&#45;&gt;gate_8_14</title>
<path fill="none" stroke="black" d="M2971.5,-1035.85C2971.5,-1028.16 2971.5,-1019.35 2971.5,-1010.35"/>
<polygon fill="black" stroke="black" points="2975,-1010.16 2971.5,-1000.16 2968,-1010.16 2975,-1010.16"/>
</g>
<!-- expert_8_14 -->
<g id="node589" class="node">
<title>expert_8_14</title>
<polygon fill="lightgreen" stroke="black" points="3046,-859.98 2897,-859.98 2897,-807.98 3046,-807.98 3046,-859.98"/>
<text text-anchor="middle" x="2971.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_8_L14</text>
<text text-anchor="middle" x="2971.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_14&#45;&gt;expert_8_14 -->
<g id="edge579" class="edge">
<title>gate_8_14&#45;&gt;expert_8_14</title>
<path fill="none" stroke="black" d="M2964.77,-895.9C2964.69,-887.23 2964.83,-878.41 2965.18,-870.27"/>
<polygon fill="black" stroke="black" points="2968.69,-870.21 2965.77,-860.03 2961.7,-869.81 2968.69,-870.21"/>
</g>
<!-- gate_8_14&#45;&gt;expert_8_14 -->
<g id="edge1199" class="edge">
<title>gate_8_14&#45;&gt;expert_8_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-895.9C2978.31,-887.23 2978.17,-878.41 2977.82,-870.27"/>
<polygon fill="red" stroke="red" points="2981.3,-869.81 2977.23,-860.03 2974.31,-870.21 2981.3,-869.81"/>
</g>
<!-- aggregate_8_14 -->
<g id="node590" class="node">
<title>aggregate_8_14</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-771.98 2884.06,-771.98 2823.49,-667.98 3058.94,-667.98 3119.51,-771.98"/>
<text text-anchor="middle" x="2971.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L14</text>
<text text-anchor="middle" x="2971.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_14&#45;&gt;aggregate_8_14 -->
<g id="edge580" class="edge">
<title>expert_8_14&#45;&gt;aggregate_8_14</title>
<path fill="none" stroke="black" d="M2971.5,-807.85C2971.5,-800.16 2971.5,-791.35 2971.5,-782.35"/>
<polygon fill="black" stroke="black" points="2975,-782.16 2971.5,-772.16 2968,-782.16 2975,-782.16"/>
</g>
<!-- attention_8_15 -->
<g id="node591" class="node">
<title>attention_8_15</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-631.98 2887.5,-631.98 2887.5,-579.98 3055.5,-579.98 3055.5,-631.98"/>
<text text-anchor="middle" x="2971.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_8_L15</text>
<text text-anchor="middle" x="2971.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="2971.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="2971.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_8_14&#45;&gt;attention_8_15 -->
<g id="edge581" class="edge">
<title>aggregate_8_14&#45;&gt;attention_8_15</title>
<path fill="none" stroke="black" d="M2971.5,-667.9C2971.5,-659.23 2971.5,-650.41 2971.5,-642.27"/>
<polygon fill="black" stroke="black" points="2975,-642.03 2971.5,-632.03 2968,-642.03 2975,-642.03"/>
</g>
<!-- gate_8_15 -->
<g id="node592" class="node">
<title>gate_8_15</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-543.98 2884.06,-543.98 2823.49,-439.98 3058.94,-439.98 3119.51,-543.98"/>
<text text-anchor="middle" x="2971.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_8_L15</text>
<text text-anchor="middle" x="2971.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="2971.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_8_15&#45;&gt;gate_8_15 -->
<g id="edge582" class="edge">
<title>attention_8_15&#45;&gt;gate_8_15</title>
<path fill="none" stroke="black" d="M2971.5,-579.85C2971.5,-572.16 2971.5,-563.35 2971.5,-554.35"/>
<polygon fill="black" stroke="black" points="2975,-554.16 2971.5,-544.16 2968,-554.16 2975,-554.16"/>
</g>
<!-- expert_8_15 -->
<g id="node593" class="node">
<title>expert_8_15</title>
<polygon fill="lightgreen" stroke="black" points="3046,-403.98 2897,-403.98 2897,-351.98 3046,-351.98 3046,-403.98"/>
<text text-anchor="middle" x="2971.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_8_L15</text>
<text text-anchor="middle" x="2971.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=8</text>
<text text-anchor="middle" x="2971.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_8_15&#45;&gt;expert_8_15 -->
<g id="edge583" class="edge">
<title>gate_8_15&#45;&gt;expert_8_15</title>
<path fill="none" stroke="black" d="M2964.77,-439.9C2964.69,-431.23 2964.83,-422.41 2965.18,-414.27"/>
<polygon fill="black" stroke="black" points="2968.69,-414.21 2965.77,-404.03 2961.7,-413.81 2968.69,-414.21"/>
</g>
<!-- gate_8_15&#45;&gt;expert_8_15 -->
<g id="edge1200" class="edge">
<title>gate_8_15&#45;&gt;expert_8_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2978.23,-439.9C2978.31,-431.23 2978.17,-422.41 2977.82,-414.27"/>
<polygon fill="red" stroke="red" points="2981.3,-413.81 2977.23,-404.03 2974.31,-414.21 2981.3,-413.81"/>
</g>
<!-- aggregate_8_15 -->
<g id="node594" class="node">
<title>aggregate_8_15</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-315.98 2884.06,-315.98 2823.49,-211.98 3058.94,-211.98 3119.51,-315.98"/>
<text text-anchor="middle" x="2971.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_8_L15</text>
<text text-anchor="middle" x="2971.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="2971.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="2971.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_8_15&#45;&gt;aggregate_8_15 -->
<g id="edge584" class="edge">
<title>expert_8_15&#45;&gt;aggregate_8_15</title>
<path fill="none" stroke="black" d="M2971.5,-351.85C2971.5,-344.16 2971.5,-335.35 2971.5,-326.35"/>
<polygon fill="black" stroke="black" points="2975,-326.16 2971.5,-316.16 2968,-326.16 2975,-326.16"/>
</g>
<!-- collect_8 -->
<g id="node595" class="node">
<title>collect_8</title>
<polygon fill="lightyellow" stroke="black" points="3119.51,-175.98 2884.06,-175.98 2823.49,-93.98 3058.94,-93.98 3119.51,-175.98"/>
<text text-anchor="middle" x="2971.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_8</text>
<text text-anchor="middle" x="2971.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="2971.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_8_15&#45;&gt;collect_8 -->
<g id="edge585" class="edge">
<title>aggregate_8_15&#45;&gt;collect_8</title>
<path fill="none" stroke="black" d="M2971.5,-211.69C2971.5,-203.27 2971.5,-194.56 2971.5,-186.17"/>
<polygon fill="black" stroke="black" points="2975,-186.14 2971.5,-176.14 2968,-186.14 2975,-186.14"/>
</g>
<!-- collect_8&#45;&gt;output -->
<g id="edge1049" class="edge">
<title>collect_8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2910.41,-93.78C2894.59,-83.36 2877.75,-72.28 2862.63,-62.33"/>
<polygon fill="black" stroke="black" points="2864.22,-59.18 2853.94,-56.61 2860.37,-65.03 2864.22,-59.18"/>
</g>
<!-- distribute_9 -->
<g id="node596" class="node">
<title>distribute_9</title>
<polygon fill="lightyellow" stroke="black" points="3448.73,-7589.98 3208.16,-7589.98 3146.27,-7507.98 3386.85,-7507.98 3448.73,-7589.98"/>
<text text-anchor="middle" x="3297.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_9</text>
<text text-anchor="middle" x="3297.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="3297.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_0 -->
<g id="node597" class="node">
<title>attention_9_0</title>
<polygon fill="lightgreen" stroke="black" points="3380.5,-7471.98 3212.5,-7471.98 3212.5,-7419.98 3380.5,-7419.98 3380.5,-7471.98"/>
<text text-anchor="middle" x="3296.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_9_L0</text>
<text text-anchor="middle" x="3296.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3296.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3296.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_9&#45;&gt;attention_9_0 -->
<g id="edge586" class="edge">
<title>distribute_9&#45;&gt;attention_9_0</title>
<path fill="none" stroke="black" d="M3297.1,-7507.77C3297.02,-7499.34 3296.93,-7490.51 3296.85,-7482.27"/>
<polygon fill="black" stroke="black" points="3300.35,-7482.2 3296.75,-7472.23 3293.35,-7482.27 3300.35,-7482.2"/>
</g>
<!-- gate_9_0 -->
<g id="node598" class="node">
<title>gate_9_0</title>
<polygon fill="lightyellow" stroke="black" points="3444.51,-7383.98 3209.06,-7383.98 3148.49,-7279.98 3383.94,-7279.98 3444.51,-7383.98"/>
<text text-anchor="middle" x="3296.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_9_L0</text>
<text text-anchor="middle" x="3296.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3296.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3296.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_0&#45;&gt;gate_9_0 -->
<g id="edge587" class="edge">
<title>attention_9_0&#45;&gt;gate_9_0</title>
<path fill="none" stroke="black" d="M3296.5,-7419.85C3296.5,-7412.16 3296.5,-7403.35 3296.5,-7394.35"/>
<polygon fill="black" stroke="black" points="3300,-7394.16 3296.5,-7384.16 3293,-7394.16 3300,-7394.16"/>
</g>
<!-- expert_9_0 -->
<g id="node599" class="node">
<title>expert_9_0</title>
<polygon fill="lightgreen" stroke="black" points="3370,-7243.98 3221,-7243.98 3221,-7191.98 3370,-7191.98 3370,-7243.98"/>
<text text-anchor="middle" x="3295.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_9_L0</text>
<text text-anchor="middle" x="3295.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3295.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3295.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_0&#45;&gt;expert_9_0 -->
<g id="edge588" class="edge">
<title>gate_9_0&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" d="M3289.32,-7279.9C3289.16,-7271.23 3289.22,-7262.41 3289.49,-7254.27"/>
<polygon fill="black" stroke="black" points="3293,-7254.18 3289.99,-7244.03 3286.01,-7253.85 3293,-7254.18"/>
</g>
<!-- gate_9_0&#45;&gt;expert_9_0 -->
<g id="edge1201" class="edge">
<title>gate_9_0&#45;&gt;expert_9_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3302.77,-7279.9C3302.78,-7271.23 3302.56,-7262.41 3302.14,-7254.27"/>
<polygon fill="red" stroke="red" points="3305.61,-7253.77 3301.46,-7244.03 3298.63,-7254.24 3305.61,-7253.77"/>
</g>
<!-- aggregate_9_0 -->
<g id="node600" class="node">
<title>aggregate_9_0</title>
<polygon fill="lightyellow" stroke="black" points="3443.51,-7155.98 3208.06,-7155.98 3147.49,-7051.98 3382.94,-7051.98 3443.51,-7155.98"/>
<text text-anchor="middle" x="3295.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L0</text>
<text text-anchor="middle" x="3295.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3295.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3295.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_0&#45;&gt;aggregate_9_0 -->
<g id="edge589" class="edge">
<title>expert_9_0&#45;&gt;aggregate_9_0</title>
<path fill="none" stroke="black" d="M3295.5,-7191.85C3295.5,-7184.16 3295.5,-7175.35 3295.5,-7166.35"/>
<polygon fill="black" stroke="black" points="3299,-7166.16 3295.5,-7156.16 3292,-7166.16 3299,-7166.16"/>
</g>
<!-- attention_9_1 -->
<g id="node601" class="node">
<title>attention_9_1</title>
<polygon fill="lightgreen" stroke="black" points="3379.5,-7015.98 3211.5,-7015.98 3211.5,-6963.98 3379.5,-6963.98 3379.5,-7015.98"/>
<text text-anchor="middle" x="3295.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_9_L1</text>
<text text-anchor="middle" x="3295.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3295.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3295.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_0&#45;&gt;attention_9_1 -->
<g id="edge590" class="edge">
<title>aggregate_9_0&#45;&gt;attention_9_1</title>
<path fill="none" stroke="black" d="M3295.5,-7051.9C3295.5,-7043.23 3295.5,-7034.41 3295.5,-7026.27"/>
<polygon fill="black" stroke="black" points="3299,-7026.03 3295.5,-7016.03 3292,-7026.03 3299,-7026.03"/>
</g>
<!-- gate_9_1 -->
<g id="node602" class="node">
<title>gate_9_1</title>
<polygon fill="lightyellow" stroke="black" points="3443.51,-6927.98 3208.06,-6927.98 3147.49,-6823.98 3382.94,-6823.98 3443.51,-6927.98"/>
<text text-anchor="middle" x="3295.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_9_L1</text>
<text text-anchor="middle" x="3295.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3295.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3295.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_1&#45;&gt;gate_9_1 -->
<g id="edge591" class="edge">
<title>attention_9_1&#45;&gt;gate_9_1</title>
<path fill="none" stroke="black" d="M3295.5,-6963.85C3295.5,-6956.16 3295.5,-6947.35 3295.5,-6938.35"/>
<polygon fill="black" stroke="black" points="3299,-6938.16 3295.5,-6928.16 3292,-6938.16 3299,-6938.16"/>
</g>
<!-- expert_9_1 -->
<g id="node603" class="node">
<title>expert_9_1</title>
<polygon fill="lightgreen" stroke="black" points="3370,-6787.98 3221,-6787.98 3221,-6735.98 3370,-6735.98 3370,-6787.98"/>
<text text-anchor="middle" x="3295.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_9_L1</text>
<text text-anchor="middle" x="3295.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3295.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3295.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_1&#45;&gt;expert_9_1 -->
<g id="edge592" class="edge">
<title>gate_9_1&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" d="M3288.77,-6823.9C3288.69,-6815.23 3288.83,-6806.41 3289.18,-6798.27"/>
<polygon fill="black" stroke="black" points="3292.69,-6798.21 3289.77,-6788.03 3285.7,-6797.81 3292.69,-6798.21"/>
</g>
<!-- gate_9_1&#45;&gt;expert_9_1 -->
<g id="edge1202" class="edge">
<title>gate_9_1&#45;&gt;expert_9_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3302.23,-6823.9C3302.31,-6815.23 3302.17,-6806.41 3301.82,-6798.27"/>
<polygon fill="red" stroke="red" points="3305.3,-6797.81 3301.23,-6788.03 3298.31,-6798.21 3305.3,-6797.81"/>
</g>
<!-- aggregate_9_1 -->
<g id="node604" class="node">
<title>aggregate_9_1</title>
<polygon fill="lightyellow" stroke="black" points="3443.51,-6699.98 3208.06,-6699.98 3147.49,-6595.98 3382.94,-6595.98 3443.51,-6699.98"/>
<text text-anchor="middle" x="3295.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L1</text>
<text text-anchor="middle" x="3295.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3295.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3295.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_1&#45;&gt;aggregate_9_1 -->
<g id="edge593" class="edge">
<title>expert_9_1&#45;&gt;aggregate_9_1</title>
<path fill="none" stroke="black" d="M3295.5,-6735.85C3295.5,-6728.16 3295.5,-6719.35 3295.5,-6710.35"/>
<polygon fill="black" stroke="black" points="3299,-6710.16 3295.5,-6700.16 3292,-6710.16 3299,-6710.16"/>
</g>
<!-- attention_9_2 -->
<g id="node605" class="node">
<title>attention_9_2</title>
<polygon fill="lightgreen" stroke="black" points="3379.5,-6559.98 3211.5,-6559.98 3211.5,-6507.98 3379.5,-6507.98 3379.5,-6559.98"/>
<text text-anchor="middle" x="3295.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_9_L2</text>
<text text-anchor="middle" x="3295.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3295.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3295.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_1&#45;&gt;attention_9_2 -->
<g id="edge594" class="edge">
<title>aggregate_9_1&#45;&gt;attention_9_2</title>
<path fill="none" stroke="black" d="M3295.5,-6595.9C3295.5,-6587.23 3295.5,-6578.41 3295.5,-6570.27"/>
<polygon fill="black" stroke="black" points="3299,-6570.03 3295.5,-6560.03 3292,-6570.03 3299,-6570.03"/>
</g>
<!-- gate_9_2 -->
<g id="node606" class="node">
<title>gate_9_2</title>
<polygon fill="lightyellow" stroke="black" points="3443.51,-6471.98 3208.06,-6471.98 3147.49,-6367.98 3382.94,-6367.98 3443.51,-6471.98"/>
<text text-anchor="middle" x="3295.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_9_L2</text>
<text text-anchor="middle" x="3295.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3295.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3295.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_2&#45;&gt;gate_9_2 -->
<g id="edge595" class="edge">
<title>attention_9_2&#45;&gt;gate_9_2</title>
<path fill="none" stroke="black" d="M3295.5,-6507.85C3295.5,-6500.16 3295.5,-6491.35 3295.5,-6482.35"/>
<polygon fill="black" stroke="black" points="3299,-6482.16 3295.5,-6472.16 3292,-6482.16 3299,-6482.16"/>
</g>
<!-- expert_9_2 -->
<g id="node607" class="node">
<title>expert_9_2</title>
<polygon fill="lightgreen" stroke="black" points="3370,-6331.98 3221,-6331.98 3221,-6279.98 3370,-6279.98 3370,-6331.98"/>
<text text-anchor="middle" x="3295.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_9_L2</text>
<text text-anchor="middle" x="3295.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3295.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3295.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_2&#45;&gt;expert_9_2 -->
<g id="edge596" class="edge">
<title>gate_9_2&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" d="M3288.77,-6367.9C3288.69,-6359.23 3288.83,-6350.41 3289.18,-6342.27"/>
<polygon fill="black" stroke="black" points="3292.69,-6342.21 3289.77,-6332.03 3285.7,-6341.81 3292.69,-6342.21"/>
</g>
<!-- gate_9_2&#45;&gt;expert_9_2 -->
<g id="edge1203" class="edge">
<title>gate_9_2&#45;&gt;expert_9_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3302.23,-6367.9C3302.31,-6359.23 3302.17,-6350.41 3301.82,-6342.27"/>
<polygon fill="red" stroke="red" points="3305.3,-6341.81 3301.23,-6332.03 3298.31,-6342.21 3305.3,-6341.81"/>
</g>
<!-- aggregate_9_2 -->
<g id="node608" class="node">
<title>aggregate_9_2</title>
<polygon fill="lightyellow" stroke="black" points="3443.51,-6243.98 3208.06,-6243.98 3147.49,-6139.98 3382.94,-6139.98 3443.51,-6243.98"/>
<text text-anchor="middle" x="3295.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L2</text>
<text text-anchor="middle" x="3295.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3295.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3295.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_2&#45;&gt;aggregate_9_2 -->
<g id="edge597" class="edge">
<title>expert_9_2&#45;&gt;aggregate_9_2</title>
<path fill="none" stroke="black" d="M3295.5,-6279.85C3295.5,-6272.16 3295.5,-6263.35 3295.5,-6254.35"/>
<polygon fill="black" stroke="black" points="3299,-6254.16 3295.5,-6244.16 3292,-6254.16 3299,-6254.16"/>
</g>
<!-- attention_9_3 -->
<g id="node609" class="node">
<title>attention_9_3</title>
<polygon fill="lightgreen" stroke="black" points="3376.5,-6103.98 3208.5,-6103.98 3208.5,-6051.98 3376.5,-6051.98 3376.5,-6103.98"/>
<text text-anchor="middle" x="3292.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_9_L3</text>
<text text-anchor="middle" x="3292.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3292.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3292.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_2&#45;&gt;attention_9_3 -->
<g id="edge598" class="edge">
<title>aggregate_9_2&#45;&gt;attention_9_3</title>
<path fill="none" stroke="black" d="M3294.13,-6139.9C3293.9,-6131.23 3293.66,-6122.41 3293.45,-6114.27"/>
<polygon fill="black" stroke="black" points="3296.94,-6113.93 3293.17,-6104.03 3289.94,-6114.12 3296.94,-6113.93"/>
</g>
<!-- gate_9_3 -->
<g id="node610" class="node">
<title>gate_9_3</title>
<polygon fill="lightyellow" stroke="black" points="3439.51,-6015.98 3204.06,-6015.98 3143.49,-5911.98 3378.94,-5911.98 3439.51,-6015.98"/>
<text text-anchor="middle" x="3291.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_9_L3</text>
<text text-anchor="middle" x="3291.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3291.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3291.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_3&#45;&gt;gate_9_3 -->
<g id="edge599" class="edge">
<title>attention_9_3&#45;&gt;gate_9_3</title>
<path fill="none" stroke="black" d="M3292.28,-6051.85C3292.21,-6044.16 3292.13,-6035.35 3292.05,-6026.35"/>
<polygon fill="black" stroke="black" points="3295.55,-6026.13 3291.96,-6016.16 3288.55,-6026.19 3295.55,-6026.13"/>
</g>
<!-- expert_9_3 -->
<g id="node611" class="node">
<title>expert_9_3</title>
<polygon fill="lightgreen" stroke="black" points="3366,-5875.98 3217,-5875.98 3217,-5823.98 3366,-5823.98 3366,-5875.98"/>
<text text-anchor="middle" x="3291.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_9_L3</text>
<text text-anchor="middle" x="3291.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3291.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3291.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_3&#45;&gt;expert_9_3 -->
<g id="edge600" class="edge">
<title>gate_9_3&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" d="M3284.77,-5911.9C3284.69,-5903.23 3284.83,-5894.41 3285.18,-5886.27"/>
<polygon fill="black" stroke="black" points="3288.69,-5886.21 3285.77,-5876.03 3281.7,-5885.81 3288.69,-5886.21"/>
</g>
<!-- gate_9_3&#45;&gt;expert_9_3 -->
<g id="edge1204" class="edge">
<title>gate_9_3&#45;&gt;expert_9_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3298.23,-5911.9C3298.31,-5903.23 3298.17,-5894.41 3297.82,-5886.27"/>
<polygon fill="red" stroke="red" points="3301.3,-5885.81 3297.23,-5876.03 3294.31,-5886.21 3301.3,-5885.81"/>
</g>
<!-- aggregate_9_3 -->
<g id="node612" class="node">
<title>aggregate_9_3</title>
<polygon fill="lightyellow" stroke="black" points="3438.51,-5787.98 3203.06,-5787.98 3142.49,-5683.98 3377.94,-5683.98 3438.51,-5787.98"/>
<text text-anchor="middle" x="3290.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L3</text>
<text text-anchor="middle" x="3290.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3290.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3290.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_3&#45;&gt;aggregate_9_3 -->
<g id="edge601" class="edge">
<title>expert_9_3&#45;&gt;aggregate_9_3</title>
<path fill="none" stroke="black" d="M3291.28,-5823.85C3291.21,-5816.16 3291.13,-5807.35 3291.05,-5798.35"/>
<polygon fill="black" stroke="black" points="3294.55,-5798.13 3290.96,-5788.16 3287.55,-5798.19 3294.55,-5798.13"/>
</g>
<!-- attention_9_4 -->
<g id="node613" class="node">
<title>attention_9_4</title>
<polygon fill="lightgreen" stroke="black" points="3372.5,-5647.98 3204.5,-5647.98 3204.5,-5595.98 3372.5,-5595.98 3372.5,-5647.98"/>
<text text-anchor="middle" x="3288.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_9_L4</text>
<text text-anchor="middle" x="3288.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3288.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3288.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_3&#45;&gt;attention_9_4 -->
<g id="edge602" class="edge">
<title>aggregate_9_3&#45;&gt;attention_9_4</title>
<path fill="none" stroke="black" d="M3289.59,-5683.9C3289.43,-5675.23 3289.28,-5666.41 3289.13,-5658.27"/>
<polygon fill="black" stroke="black" points="3292.63,-5657.96 3288.95,-5648.03 3285.63,-5658.09 3292.63,-5657.96"/>
</g>
<!-- gate_9_4 -->
<g id="node614" class="node">
<title>gate_9_4</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-5559.98 3199.06,-5559.98 3138.49,-5455.98 3373.94,-5455.98 3434.51,-5559.98"/>
<text text-anchor="middle" x="3286.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_9_L4</text>
<text text-anchor="middle" x="3286.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_4&#45;&gt;gate_9_4 -->
<g id="edge603" class="edge">
<title>attention_9_4&#45;&gt;gate_9_4</title>
<path fill="none" stroke="black" d="M3288.05,-5595.85C3287.91,-5588.16 3287.76,-5579.35 3287.6,-5570.35"/>
<polygon fill="black" stroke="black" points="3291.09,-5570.1 3287.41,-5560.16 3284.09,-5570.22 3291.09,-5570.1"/>
</g>
<!-- expert_9_4 -->
<g id="node615" class="node">
<title>expert_9_4</title>
<polygon fill="lightgreen" stroke="black" points="3361,-5419.98 3212,-5419.98 3212,-5367.98 3361,-5367.98 3361,-5419.98"/>
<text text-anchor="middle" x="3286.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_9_L4</text>
<text text-anchor="middle" x="3286.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_4&#45;&gt;expert_9_4 -->
<g id="edge604" class="edge">
<title>gate_9_4&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" d="M3279.77,-5455.9C3279.69,-5447.23 3279.83,-5438.41 3280.18,-5430.27"/>
<polygon fill="black" stroke="black" points="3283.69,-5430.21 3280.77,-5420.03 3276.7,-5429.81 3283.69,-5430.21"/>
</g>
<!-- gate_9_4&#45;&gt;expert_9_4 -->
<g id="edge1205" class="edge">
<title>gate_9_4&#45;&gt;expert_9_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-5455.9C3293.31,-5447.23 3293.17,-5438.41 3292.82,-5430.27"/>
<polygon fill="red" stroke="red" points="3296.3,-5429.81 3292.23,-5420.03 3289.31,-5430.21 3296.3,-5429.81"/>
</g>
<!-- aggregate_9_4 -->
<g id="node616" class="node">
<title>aggregate_9_4</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-5331.98 3199.06,-5331.98 3138.49,-5227.98 3373.94,-5227.98 3434.51,-5331.98"/>
<text text-anchor="middle" x="3286.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L4</text>
<text text-anchor="middle" x="3286.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_4&#45;&gt;aggregate_9_4 -->
<g id="edge605" class="edge">
<title>expert_9_4&#45;&gt;aggregate_9_4</title>
<path fill="none" stroke="black" d="M3286.5,-5367.85C3286.5,-5360.16 3286.5,-5351.35 3286.5,-5342.35"/>
<polygon fill="black" stroke="black" points="3290,-5342.16 3286.5,-5332.16 3283,-5342.16 3290,-5342.16"/>
</g>
<!-- attention_9_5 -->
<g id="node617" class="node">
<title>attention_9_5</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-5191.98 3202.5,-5191.98 3202.5,-5139.98 3370.5,-5139.98 3370.5,-5191.98"/>
<text text-anchor="middle" x="3286.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_9_L5</text>
<text text-anchor="middle" x="3286.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_4&#45;&gt;attention_9_5 -->
<g id="edge606" class="edge">
<title>aggregate_9_4&#45;&gt;attention_9_5</title>
<path fill="none" stroke="black" d="M3286.5,-5227.9C3286.5,-5219.23 3286.5,-5210.41 3286.5,-5202.27"/>
<polygon fill="black" stroke="black" points="3290,-5202.03 3286.5,-5192.03 3283,-5202.03 3290,-5202.03"/>
</g>
<!-- gate_9_5 -->
<g id="node618" class="node">
<title>gate_9_5</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-5103.98 3199.06,-5103.98 3138.49,-4999.98 3373.94,-4999.98 3434.51,-5103.98"/>
<text text-anchor="middle" x="3286.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_9_L5</text>
<text text-anchor="middle" x="3286.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_5&#45;&gt;gate_9_5 -->
<g id="edge607" class="edge">
<title>attention_9_5&#45;&gt;gate_9_5</title>
<path fill="none" stroke="black" d="M3286.5,-5139.85C3286.5,-5132.16 3286.5,-5123.35 3286.5,-5114.35"/>
<polygon fill="black" stroke="black" points="3290,-5114.16 3286.5,-5104.16 3283,-5114.16 3290,-5114.16"/>
</g>
<!-- expert_9_5 -->
<g id="node619" class="node">
<title>expert_9_5</title>
<polygon fill="lightgreen" stroke="black" points="3361,-4963.98 3212,-4963.98 3212,-4911.98 3361,-4911.98 3361,-4963.98"/>
<text text-anchor="middle" x="3286.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_9_L5</text>
<text text-anchor="middle" x="3286.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_5&#45;&gt;expert_9_5 -->
<g id="edge608" class="edge">
<title>gate_9_5&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" d="M3279.77,-4999.9C3279.69,-4991.23 3279.83,-4982.41 3280.18,-4974.27"/>
<polygon fill="black" stroke="black" points="3283.69,-4974.21 3280.77,-4964.03 3276.7,-4973.81 3283.69,-4974.21"/>
</g>
<!-- gate_9_5&#45;&gt;expert_9_5 -->
<g id="edge1206" class="edge">
<title>gate_9_5&#45;&gt;expert_9_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-4999.9C3293.31,-4991.23 3293.17,-4982.41 3292.82,-4974.27"/>
<polygon fill="red" stroke="red" points="3296.3,-4973.81 3292.23,-4964.03 3289.31,-4974.21 3296.3,-4973.81"/>
</g>
<!-- aggregate_9_5 -->
<g id="node620" class="node">
<title>aggregate_9_5</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-4875.98 3199.06,-4875.98 3138.49,-4771.98 3373.94,-4771.98 3434.51,-4875.98"/>
<text text-anchor="middle" x="3286.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L5</text>
<text text-anchor="middle" x="3286.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_5&#45;&gt;aggregate_9_5 -->
<g id="edge609" class="edge">
<title>expert_9_5&#45;&gt;aggregate_9_5</title>
<path fill="none" stroke="black" d="M3286.5,-4911.85C3286.5,-4904.16 3286.5,-4895.35 3286.5,-4886.35"/>
<polygon fill="black" stroke="black" points="3290,-4886.16 3286.5,-4876.16 3283,-4886.16 3290,-4886.16"/>
</g>
<!-- attention_9_6 -->
<g id="node621" class="node">
<title>attention_9_6</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-4735.98 3202.5,-4735.98 3202.5,-4683.98 3370.5,-4683.98 3370.5,-4735.98"/>
<text text-anchor="middle" x="3286.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_9_L6</text>
<text text-anchor="middle" x="3286.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_5&#45;&gt;attention_9_6 -->
<g id="edge610" class="edge">
<title>aggregate_9_5&#45;&gt;attention_9_6</title>
<path fill="none" stroke="black" d="M3286.5,-4771.9C3286.5,-4763.23 3286.5,-4754.41 3286.5,-4746.27"/>
<polygon fill="black" stroke="black" points="3290,-4746.03 3286.5,-4736.03 3283,-4746.03 3290,-4746.03"/>
</g>
<!-- gate_9_6 -->
<g id="node622" class="node">
<title>gate_9_6</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-4647.98 3199.06,-4647.98 3138.49,-4543.98 3373.94,-4543.98 3434.51,-4647.98"/>
<text text-anchor="middle" x="3286.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_9_L6</text>
<text text-anchor="middle" x="3286.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_6&#45;&gt;gate_9_6 -->
<g id="edge611" class="edge">
<title>attention_9_6&#45;&gt;gate_9_6</title>
<path fill="none" stroke="black" d="M3286.5,-4683.85C3286.5,-4676.16 3286.5,-4667.35 3286.5,-4658.35"/>
<polygon fill="black" stroke="black" points="3290,-4658.16 3286.5,-4648.16 3283,-4658.16 3290,-4658.16"/>
</g>
<!-- expert_9_6 -->
<g id="node623" class="node">
<title>expert_9_6</title>
<polygon fill="lightgreen" stroke="black" points="3361,-4507.98 3212,-4507.98 3212,-4455.98 3361,-4455.98 3361,-4507.98"/>
<text text-anchor="middle" x="3286.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_9_L6</text>
<text text-anchor="middle" x="3286.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_6&#45;&gt;expert_9_6 -->
<g id="edge612" class="edge">
<title>gate_9_6&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" d="M3279.77,-4543.9C3279.69,-4535.23 3279.83,-4526.41 3280.18,-4518.27"/>
<polygon fill="black" stroke="black" points="3283.69,-4518.21 3280.77,-4508.03 3276.7,-4517.81 3283.69,-4518.21"/>
</g>
<!-- gate_9_6&#45;&gt;expert_9_6 -->
<g id="edge1207" class="edge">
<title>gate_9_6&#45;&gt;expert_9_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-4543.9C3293.31,-4535.23 3293.17,-4526.41 3292.82,-4518.27"/>
<polygon fill="red" stroke="red" points="3296.3,-4517.81 3292.23,-4508.03 3289.31,-4518.21 3296.3,-4517.81"/>
</g>
<!-- aggregate_9_6 -->
<g id="node624" class="node">
<title>aggregate_9_6</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-4419.98 3199.06,-4419.98 3138.49,-4315.98 3373.94,-4315.98 3434.51,-4419.98"/>
<text text-anchor="middle" x="3286.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L6</text>
<text text-anchor="middle" x="3286.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_6&#45;&gt;aggregate_9_6 -->
<g id="edge613" class="edge">
<title>expert_9_6&#45;&gt;aggregate_9_6</title>
<path fill="none" stroke="black" d="M3286.5,-4455.85C3286.5,-4448.16 3286.5,-4439.35 3286.5,-4430.35"/>
<polygon fill="black" stroke="black" points="3290,-4430.16 3286.5,-4420.16 3283,-4430.16 3290,-4430.16"/>
</g>
<!-- attention_9_7 -->
<g id="node625" class="node">
<title>attention_9_7</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-4279.98 3202.5,-4279.98 3202.5,-4227.98 3370.5,-4227.98 3370.5,-4279.98"/>
<text text-anchor="middle" x="3286.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_9_L7</text>
<text text-anchor="middle" x="3286.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_6&#45;&gt;attention_9_7 -->
<g id="edge614" class="edge">
<title>aggregate_9_6&#45;&gt;attention_9_7</title>
<path fill="none" stroke="black" d="M3286.5,-4315.9C3286.5,-4307.23 3286.5,-4298.41 3286.5,-4290.27"/>
<polygon fill="black" stroke="black" points="3290,-4290.03 3286.5,-4280.03 3283,-4290.03 3290,-4290.03"/>
</g>
<!-- gate_9_7 -->
<g id="node626" class="node">
<title>gate_9_7</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-4191.98 3199.06,-4191.98 3138.49,-4087.98 3373.94,-4087.98 3434.51,-4191.98"/>
<text text-anchor="middle" x="3286.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_9_L7</text>
<text text-anchor="middle" x="3286.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_7&#45;&gt;gate_9_7 -->
<g id="edge615" class="edge">
<title>attention_9_7&#45;&gt;gate_9_7</title>
<path fill="none" stroke="black" d="M3286.5,-4227.85C3286.5,-4220.16 3286.5,-4211.35 3286.5,-4202.35"/>
<polygon fill="black" stroke="black" points="3290,-4202.16 3286.5,-4192.16 3283,-4202.16 3290,-4202.16"/>
</g>
<!-- expert_9_7 -->
<g id="node627" class="node">
<title>expert_9_7</title>
<polygon fill="lightgreen" stroke="black" points="3361,-4051.98 3212,-4051.98 3212,-3999.98 3361,-3999.98 3361,-4051.98"/>
<text text-anchor="middle" x="3286.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_9_L7</text>
<text text-anchor="middle" x="3286.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_7&#45;&gt;expert_9_7 -->
<g id="edge616" class="edge">
<title>gate_9_7&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" d="M3279.77,-4087.9C3279.69,-4079.23 3279.83,-4070.41 3280.18,-4062.27"/>
<polygon fill="black" stroke="black" points="3283.69,-4062.21 3280.77,-4052.03 3276.7,-4061.81 3283.69,-4062.21"/>
</g>
<!-- gate_9_7&#45;&gt;expert_9_7 -->
<g id="edge1208" class="edge">
<title>gate_9_7&#45;&gt;expert_9_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-4087.9C3293.31,-4079.23 3293.17,-4070.41 3292.82,-4062.27"/>
<polygon fill="red" stroke="red" points="3296.3,-4061.81 3292.23,-4052.03 3289.31,-4062.21 3296.3,-4061.81"/>
</g>
<!-- aggregate_9_7 -->
<g id="node628" class="node">
<title>aggregate_9_7</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-3963.98 3199.06,-3963.98 3138.49,-3859.98 3373.94,-3859.98 3434.51,-3963.98"/>
<text text-anchor="middle" x="3286.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L7</text>
<text text-anchor="middle" x="3286.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_7&#45;&gt;aggregate_9_7 -->
<g id="edge617" class="edge">
<title>expert_9_7&#45;&gt;aggregate_9_7</title>
<path fill="none" stroke="black" d="M3286.5,-3999.85C3286.5,-3992.16 3286.5,-3983.35 3286.5,-3974.35"/>
<polygon fill="black" stroke="black" points="3290,-3974.16 3286.5,-3964.16 3283,-3974.16 3290,-3974.16"/>
</g>
<!-- attention_9_8 -->
<g id="node629" class="node">
<title>attention_9_8</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-3823.98 3202.5,-3823.98 3202.5,-3771.98 3370.5,-3771.98 3370.5,-3823.98"/>
<text text-anchor="middle" x="3286.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_9_L8</text>
<text text-anchor="middle" x="3286.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_7&#45;&gt;attention_9_8 -->
<g id="edge618" class="edge">
<title>aggregate_9_7&#45;&gt;attention_9_8</title>
<path fill="none" stroke="black" d="M3286.5,-3859.9C3286.5,-3851.23 3286.5,-3842.41 3286.5,-3834.27"/>
<polygon fill="black" stroke="black" points="3290,-3834.03 3286.5,-3824.03 3283,-3834.03 3290,-3834.03"/>
</g>
<!-- gate_9_8 -->
<g id="node630" class="node">
<title>gate_9_8</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-3735.98 3199.06,-3735.98 3138.49,-3631.98 3373.94,-3631.98 3434.51,-3735.98"/>
<text text-anchor="middle" x="3286.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_9_L8</text>
<text text-anchor="middle" x="3286.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_8&#45;&gt;gate_9_8 -->
<g id="edge619" class="edge">
<title>attention_9_8&#45;&gt;gate_9_8</title>
<path fill="none" stroke="black" d="M3286.5,-3771.85C3286.5,-3764.16 3286.5,-3755.35 3286.5,-3746.35"/>
<polygon fill="black" stroke="black" points="3290,-3746.16 3286.5,-3736.16 3283,-3746.16 3290,-3746.16"/>
</g>
<!-- expert_9_8 -->
<g id="node631" class="node">
<title>expert_9_8</title>
<polygon fill="lightgreen" stroke="black" points="3361,-3595.98 3212,-3595.98 3212,-3543.98 3361,-3543.98 3361,-3595.98"/>
<text text-anchor="middle" x="3286.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_9_L8</text>
<text text-anchor="middle" x="3286.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_8&#45;&gt;expert_9_8 -->
<g id="edge620" class="edge">
<title>gate_9_8&#45;&gt;expert_9_8</title>
<path fill="none" stroke="black" d="M3279.77,-3631.9C3279.69,-3623.23 3279.83,-3614.41 3280.18,-3606.27"/>
<polygon fill="black" stroke="black" points="3283.69,-3606.21 3280.77,-3596.03 3276.7,-3605.81 3283.69,-3606.21"/>
</g>
<!-- gate_9_8&#45;&gt;expert_9_8 -->
<g id="edge1209" class="edge">
<title>gate_9_8&#45;&gt;expert_9_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-3631.9C3293.31,-3623.23 3293.17,-3614.41 3292.82,-3606.27"/>
<polygon fill="red" stroke="red" points="3296.3,-3605.81 3292.23,-3596.03 3289.31,-3606.21 3296.3,-3605.81"/>
</g>
<!-- aggregate_9_8 -->
<g id="node632" class="node">
<title>aggregate_9_8</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-3507.98 3199.06,-3507.98 3138.49,-3403.98 3373.94,-3403.98 3434.51,-3507.98"/>
<text text-anchor="middle" x="3286.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L8</text>
<text text-anchor="middle" x="3286.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_8&#45;&gt;aggregate_9_8 -->
<g id="edge621" class="edge">
<title>expert_9_8&#45;&gt;aggregate_9_8</title>
<path fill="none" stroke="black" d="M3286.5,-3543.85C3286.5,-3536.16 3286.5,-3527.35 3286.5,-3518.35"/>
<polygon fill="black" stroke="black" points="3290,-3518.16 3286.5,-3508.16 3283,-3518.16 3290,-3518.16"/>
</g>
<!-- attention_9_9 -->
<g id="node633" class="node">
<title>attention_9_9</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-3367.98 3202.5,-3367.98 3202.5,-3315.98 3370.5,-3315.98 3370.5,-3367.98"/>
<text text-anchor="middle" x="3286.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_9_L9</text>
<text text-anchor="middle" x="3286.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_8&#45;&gt;attention_9_9 -->
<g id="edge622" class="edge">
<title>aggregate_9_8&#45;&gt;attention_9_9</title>
<path fill="none" stroke="black" d="M3286.5,-3403.9C3286.5,-3395.23 3286.5,-3386.41 3286.5,-3378.27"/>
<polygon fill="black" stroke="black" points="3290,-3378.03 3286.5,-3368.03 3283,-3378.03 3290,-3378.03"/>
</g>
<!-- gate_9_9 -->
<g id="node634" class="node">
<title>gate_9_9</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-3279.98 3199.06,-3279.98 3138.49,-3175.98 3373.94,-3175.98 3434.51,-3279.98"/>
<text text-anchor="middle" x="3286.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_9_L9</text>
<text text-anchor="middle" x="3286.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_9&#45;&gt;gate_9_9 -->
<g id="edge623" class="edge">
<title>attention_9_9&#45;&gt;gate_9_9</title>
<path fill="none" stroke="black" d="M3286.5,-3315.85C3286.5,-3308.16 3286.5,-3299.35 3286.5,-3290.35"/>
<polygon fill="black" stroke="black" points="3290,-3290.16 3286.5,-3280.16 3283,-3290.16 3290,-3290.16"/>
</g>
<!-- expert_9_9 -->
<g id="node635" class="node">
<title>expert_9_9</title>
<polygon fill="lightgreen" stroke="black" points="3361,-3139.98 3212,-3139.98 3212,-3087.98 3361,-3087.98 3361,-3139.98"/>
<text text-anchor="middle" x="3286.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_9_L9</text>
<text text-anchor="middle" x="3286.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_9&#45;&gt;expert_9_9 -->
<g id="edge624" class="edge">
<title>gate_9_9&#45;&gt;expert_9_9</title>
<path fill="none" stroke="black" d="M3279.77,-3175.9C3279.69,-3167.23 3279.83,-3158.41 3280.18,-3150.27"/>
<polygon fill="black" stroke="black" points="3283.69,-3150.21 3280.77,-3140.03 3276.7,-3149.81 3283.69,-3150.21"/>
</g>
<!-- gate_9_9&#45;&gt;expert_9_9 -->
<g id="edge1210" class="edge">
<title>gate_9_9&#45;&gt;expert_9_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-3175.9C3293.31,-3167.23 3293.17,-3158.41 3292.82,-3150.27"/>
<polygon fill="red" stroke="red" points="3296.3,-3149.81 3292.23,-3140.03 3289.31,-3150.21 3296.3,-3149.81"/>
</g>
<!-- aggregate_9_9 -->
<g id="node636" class="node">
<title>aggregate_9_9</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-3051.98 3199.06,-3051.98 3138.49,-2947.98 3373.94,-2947.98 3434.51,-3051.98"/>
<text text-anchor="middle" x="3286.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L9</text>
<text text-anchor="middle" x="3286.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_9&#45;&gt;aggregate_9_9 -->
<g id="edge625" class="edge">
<title>expert_9_9&#45;&gt;aggregate_9_9</title>
<path fill="none" stroke="black" d="M3286.5,-3087.85C3286.5,-3080.16 3286.5,-3071.35 3286.5,-3062.35"/>
<polygon fill="black" stroke="black" points="3290,-3062.16 3286.5,-3052.16 3283,-3062.16 3290,-3062.16"/>
</g>
<!-- attention_9_10 -->
<g id="node637" class="node">
<title>attention_9_10</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-2911.98 3202.5,-2911.98 3202.5,-2859.98 3370.5,-2859.98 3370.5,-2911.98"/>
<text text-anchor="middle" x="3286.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_9_L10</text>
<text text-anchor="middle" x="3286.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_9&#45;&gt;attention_9_10 -->
<g id="edge626" class="edge">
<title>aggregate_9_9&#45;&gt;attention_9_10</title>
<path fill="none" stroke="black" d="M3286.5,-2947.9C3286.5,-2939.23 3286.5,-2930.41 3286.5,-2922.27"/>
<polygon fill="black" stroke="black" points="3290,-2922.03 3286.5,-2912.03 3283,-2922.03 3290,-2922.03"/>
</g>
<!-- gate_9_10 -->
<g id="node638" class="node">
<title>gate_9_10</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-2823.98 3199.06,-2823.98 3138.49,-2719.98 3373.94,-2719.98 3434.51,-2823.98"/>
<text text-anchor="middle" x="3286.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_9_L10</text>
<text text-anchor="middle" x="3286.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_10&#45;&gt;gate_9_10 -->
<g id="edge627" class="edge">
<title>attention_9_10&#45;&gt;gate_9_10</title>
<path fill="none" stroke="black" d="M3286.5,-2859.85C3286.5,-2852.16 3286.5,-2843.35 3286.5,-2834.35"/>
<polygon fill="black" stroke="black" points="3290,-2834.16 3286.5,-2824.16 3283,-2834.16 3290,-2834.16"/>
</g>
<!-- expert_9_10 -->
<g id="node639" class="node">
<title>expert_9_10</title>
<polygon fill="lightgreen" stroke="black" points="3361,-2683.98 3212,-2683.98 3212,-2631.98 3361,-2631.98 3361,-2683.98"/>
<text text-anchor="middle" x="3286.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_9_L10</text>
<text text-anchor="middle" x="3286.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_10&#45;&gt;expert_9_10 -->
<g id="edge628" class="edge">
<title>gate_9_10&#45;&gt;expert_9_10</title>
<path fill="none" stroke="black" d="M3279.77,-2719.9C3279.69,-2711.23 3279.83,-2702.41 3280.18,-2694.27"/>
<polygon fill="black" stroke="black" points="3283.69,-2694.21 3280.77,-2684.03 3276.7,-2693.81 3283.69,-2694.21"/>
</g>
<!-- gate_9_10&#45;&gt;expert_9_10 -->
<g id="edge1211" class="edge">
<title>gate_9_10&#45;&gt;expert_9_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-2719.9C3293.31,-2711.23 3293.17,-2702.41 3292.82,-2694.27"/>
<polygon fill="red" stroke="red" points="3296.3,-2693.81 3292.23,-2684.03 3289.31,-2694.21 3296.3,-2693.81"/>
</g>
<!-- aggregate_9_10 -->
<g id="node640" class="node">
<title>aggregate_9_10</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-2595.98 3199.06,-2595.98 3138.49,-2491.98 3373.94,-2491.98 3434.51,-2595.98"/>
<text text-anchor="middle" x="3286.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L10</text>
<text text-anchor="middle" x="3286.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_10&#45;&gt;aggregate_9_10 -->
<g id="edge629" class="edge">
<title>expert_9_10&#45;&gt;aggregate_9_10</title>
<path fill="none" stroke="black" d="M3286.5,-2631.85C3286.5,-2624.16 3286.5,-2615.35 3286.5,-2606.35"/>
<polygon fill="black" stroke="black" points="3290,-2606.16 3286.5,-2596.16 3283,-2606.16 3290,-2606.16"/>
</g>
<!-- attention_9_11 -->
<g id="node641" class="node">
<title>attention_9_11</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-2455.98 3202.5,-2455.98 3202.5,-2403.98 3370.5,-2403.98 3370.5,-2455.98"/>
<text text-anchor="middle" x="3286.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_9_L11</text>
<text text-anchor="middle" x="3286.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_10&#45;&gt;attention_9_11 -->
<g id="edge630" class="edge">
<title>aggregate_9_10&#45;&gt;attention_9_11</title>
<path fill="none" stroke="black" d="M3286.5,-2491.9C3286.5,-2483.23 3286.5,-2474.41 3286.5,-2466.27"/>
<polygon fill="black" stroke="black" points="3290,-2466.03 3286.5,-2456.03 3283,-2466.03 3290,-2466.03"/>
</g>
<!-- gate_9_11 -->
<g id="node642" class="node">
<title>gate_9_11</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-2367.98 3199.06,-2367.98 3138.49,-2263.98 3373.94,-2263.98 3434.51,-2367.98"/>
<text text-anchor="middle" x="3286.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_9_L11</text>
<text text-anchor="middle" x="3286.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_11&#45;&gt;gate_9_11 -->
<g id="edge631" class="edge">
<title>attention_9_11&#45;&gt;gate_9_11</title>
<path fill="none" stroke="black" d="M3286.5,-2403.85C3286.5,-2396.16 3286.5,-2387.35 3286.5,-2378.35"/>
<polygon fill="black" stroke="black" points="3290,-2378.16 3286.5,-2368.16 3283,-2378.16 3290,-2378.16"/>
</g>
<!-- expert_9_11 -->
<g id="node643" class="node">
<title>expert_9_11</title>
<polygon fill="lightgreen" stroke="black" points="3361,-2227.98 3212,-2227.98 3212,-2175.98 3361,-2175.98 3361,-2227.98"/>
<text text-anchor="middle" x="3286.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_9_L11</text>
<text text-anchor="middle" x="3286.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_11&#45;&gt;expert_9_11 -->
<g id="edge632" class="edge">
<title>gate_9_11&#45;&gt;expert_9_11</title>
<path fill="none" stroke="black" d="M3279.77,-2263.9C3279.69,-2255.23 3279.83,-2246.41 3280.18,-2238.27"/>
<polygon fill="black" stroke="black" points="3283.69,-2238.21 3280.77,-2228.03 3276.7,-2237.81 3283.69,-2238.21"/>
</g>
<!-- gate_9_11&#45;&gt;expert_9_11 -->
<g id="edge1212" class="edge">
<title>gate_9_11&#45;&gt;expert_9_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-2263.9C3293.31,-2255.23 3293.17,-2246.41 3292.82,-2238.27"/>
<polygon fill="red" stroke="red" points="3296.3,-2237.81 3292.23,-2228.03 3289.31,-2238.21 3296.3,-2237.81"/>
</g>
<!-- aggregate_9_11 -->
<g id="node644" class="node">
<title>aggregate_9_11</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-2139.98 3199.06,-2139.98 3138.49,-2035.98 3373.94,-2035.98 3434.51,-2139.98"/>
<text text-anchor="middle" x="3286.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L11</text>
<text text-anchor="middle" x="3286.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_11&#45;&gt;aggregate_9_11 -->
<g id="edge633" class="edge">
<title>expert_9_11&#45;&gt;aggregate_9_11</title>
<path fill="none" stroke="black" d="M3286.5,-2175.85C3286.5,-2168.16 3286.5,-2159.35 3286.5,-2150.35"/>
<polygon fill="black" stroke="black" points="3290,-2150.16 3286.5,-2140.16 3283,-2150.16 3290,-2150.16"/>
</g>
<!-- attention_9_12 -->
<g id="node645" class="node">
<title>attention_9_12</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-1999.98 3202.5,-1999.98 3202.5,-1947.98 3370.5,-1947.98 3370.5,-1999.98"/>
<text text-anchor="middle" x="3286.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_9_L12</text>
<text text-anchor="middle" x="3286.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_11&#45;&gt;attention_9_12 -->
<g id="edge634" class="edge">
<title>aggregate_9_11&#45;&gt;attention_9_12</title>
<path fill="none" stroke="black" d="M3286.5,-2035.9C3286.5,-2027.23 3286.5,-2018.41 3286.5,-2010.27"/>
<polygon fill="black" stroke="black" points="3290,-2010.03 3286.5,-2000.03 3283,-2010.03 3290,-2010.03"/>
</g>
<!-- gate_9_12 -->
<g id="node646" class="node">
<title>gate_9_12</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-1911.98 3199.06,-1911.98 3138.49,-1807.98 3373.94,-1807.98 3434.51,-1911.98"/>
<text text-anchor="middle" x="3286.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_9_L12</text>
<text text-anchor="middle" x="3286.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_12&#45;&gt;gate_9_12 -->
<g id="edge635" class="edge">
<title>attention_9_12&#45;&gt;gate_9_12</title>
<path fill="none" stroke="black" d="M3286.5,-1947.85C3286.5,-1940.16 3286.5,-1931.35 3286.5,-1922.35"/>
<polygon fill="black" stroke="black" points="3290,-1922.16 3286.5,-1912.16 3283,-1922.16 3290,-1922.16"/>
</g>
<!-- expert_9_12 -->
<g id="node647" class="node">
<title>expert_9_12</title>
<polygon fill="lightgreen" stroke="black" points="3361,-1771.98 3212,-1771.98 3212,-1719.98 3361,-1719.98 3361,-1771.98"/>
<text text-anchor="middle" x="3286.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_9_L12</text>
<text text-anchor="middle" x="3286.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_12&#45;&gt;expert_9_12 -->
<g id="edge636" class="edge">
<title>gate_9_12&#45;&gt;expert_9_12</title>
<path fill="none" stroke="black" d="M3279.77,-1807.9C3279.69,-1799.23 3279.83,-1790.41 3280.18,-1782.27"/>
<polygon fill="black" stroke="black" points="3283.69,-1782.21 3280.77,-1772.03 3276.7,-1781.81 3283.69,-1782.21"/>
</g>
<!-- gate_9_12&#45;&gt;expert_9_12 -->
<g id="edge1213" class="edge">
<title>gate_9_12&#45;&gt;expert_9_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-1807.9C3293.31,-1799.23 3293.17,-1790.41 3292.82,-1782.27"/>
<polygon fill="red" stroke="red" points="3296.3,-1781.81 3292.23,-1772.03 3289.31,-1782.21 3296.3,-1781.81"/>
</g>
<!-- aggregate_9_12 -->
<g id="node648" class="node">
<title>aggregate_9_12</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-1683.98 3199.06,-1683.98 3138.49,-1579.98 3373.94,-1579.98 3434.51,-1683.98"/>
<text text-anchor="middle" x="3286.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L12</text>
<text text-anchor="middle" x="3286.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_12&#45;&gt;aggregate_9_12 -->
<g id="edge637" class="edge">
<title>expert_9_12&#45;&gt;aggregate_9_12</title>
<path fill="none" stroke="black" d="M3286.5,-1719.85C3286.5,-1712.16 3286.5,-1703.35 3286.5,-1694.35"/>
<polygon fill="black" stroke="black" points="3290,-1694.16 3286.5,-1684.16 3283,-1694.16 3290,-1694.16"/>
</g>
<!-- attention_9_13 -->
<g id="node649" class="node">
<title>attention_9_13</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-1543.98 3202.5,-1543.98 3202.5,-1491.98 3370.5,-1491.98 3370.5,-1543.98"/>
<text text-anchor="middle" x="3286.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_9_L13</text>
<text text-anchor="middle" x="3286.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_12&#45;&gt;attention_9_13 -->
<g id="edge638" class="edge">
<title>aggregate_9_12&#45;&gt;attention_9_13</title>
<path fill="none" stroke="black" d="M3286.5,-1579.9C3286.5,-1571.23 3286.5,-1562.41 3286.5,-1554.27"/>
<polygon fill="black" stroke="black" points="3290,-1554.03 3286.5,-1544.03 3283,-1554.03 3290,-1554.03"/>
</g>
<!-- gate_9_13 -->
<g id="node650" class="node">
<title>gate_9_13</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-1455.98 3199.06,-1455.98 3138.49,-1351.98 3373.94,-1351.98 3434.51,-1455.98"/>
<text text-anchor="middle" x="3286.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_9_L13</text>
<text text-anchor="middle" x="3286.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_13&#45;&gt;gate_9_13 -->
<g id="edge639" class="edge">
<title>attention_9_13&#45;&gt;gate_9_13</title>
<path fill="none" stroke="black" d="M3286.5,-1491.85C3286.5,-1484.16 3286.5,-1475.35 3286.5,-1466.35"/>
<polygon fill="black" stroke="black" points="3290,-1466.16 3286.5,-1456.16 3283,-1466.16 3290,-1466.16"/>
</g>
<!-- expert_9_13 -->
<g id="node651" class="node">
<title>expert_9_13</title>
<polygon fill="lightgreen" stroke="black" points="3361,-1315.98 3212,-1315.98 3212,-1263.98 3361,-1263.98 3361,-1315.98"/>
<text text-anchor="middle" x="3286.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_9_L13</text>
<text text-anchor="middle" x="3286.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_13&#45;&gt;expert_9_13 -->
<g id="edge640" class="edge">
<title>gate_9_13&#45;&gt;expert_9_13</title>
<path fill="none" stroke="black" d="M3279.77,-1351.9C3279.69,-1343.23 3279.83,-1334.41 3280.18,-1326.27"/>
<polygon fill="black" stroke="black" points="3283.69,-1326.21 3280.77,-1316.03 3276.7,-1325.81 3283.69,-1326.21"/>
</g>
<!-- gate_9_13&#45;&gt;expert_9_13 -->
<g id="edge1214" class="edge">
<title>gate_9_13&#45;&gt;expert_9_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-1351.9C3293.31,-1343.23 3293.17,-1334.41 3292.82,-1326.27"/>
<polygon fill="red" stroke="red" points="3296.3,-1325.81 3292.23,-1316.03 3289.31,-1326.21 3296.3,-1325.81"/>
</g>
<!-- aggregate_9_13 -->
<g id="node652" class="node">
<title>aggregate_9_13</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-1227.98 3199.06,-1227.98 3138.49,-1123.98 3373.94,-1123.98 3434.51,-1227.98"/>
<text text-anchor="middle" x="3286.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L13</text>
<text text-anchor="middle" x="3286.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_13&#45;&gt;aggregate_9_13 -->
<g id="edge641" class="edge">
<title>expert_9_13&#45;&gt;aggregate_9_13</title>
<path fill="none" stroke="black" d="M3286.5,-1263.85C3286.5,-1256.16 3286.5,-1247.35 3286.5,-1238.35"/>
<polygon fill="black" stroke="black" points="3290,-1238.16 3286.5,-1228.16 3283,-1238.16 3290,-1238.16"/>
</g>
<!-- attention_9_14 -->
<g id="node653" class="node">
<title>attention_9_14</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-1087.98 3202.5,-1087.98 3202.5,-1035.98 3370.5,-1035.98 3370.5,-1087.98"/>
<text text-anchor="middle" x="3286.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_9_L14</text>
<text text-anchor="middle" x="3286.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_13&#45;&gt;attention_9_14 -->
<g id="edge642" class="edge">
<title>aggregate_9_13&#45;&gt;attention_9_14</title>
<path fill="none" stroke="black" d="M3286.5,-1123.9C3286.5,-1115.23 3286.5,-1106.41 3286.5,-1098.27"/>
<polygon fill="black" stroke="black" points="3290,-1098.03 3286.5,-1088.03 3283,-1098.03 3290,-1098.03"/>
</g>
<!-- gate_9_14 -->
<g id="node654" class="node">
<title>gate_9_14</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-999.98 3199.06,-999.98 3138.49,-895.98 3373.94,-895.98 3434.51,-999.98"/>
<text text-anchor="middle" x="3286.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_9_L14</text>
<text text-anchor="middle" x="3286.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_14&#45;&gt;gate_9_14 -->
<g id="edge643" class="edge">
<title>attention_9_14&#45;&gt;gate_9_14</title>
<path fill="none" stroke="black" d="M3286.5,-1035.85C3286.5,-1028.16 3286.5,-1019.35 3286.5,-1010.35"/>
<polygon fill="black" stroke="black" points="3290,-1010.16 3286.5,-1000.16 3283,-1010.16 3290,-1010.16"/>
</g>
<!-- expert_9_14 -->
<g id="node655" class="node">
<title>expert_9_14</title>
<polygon fill="lightgreen" stroke="black" points="3361,-859.98 3212,-859.98 3212,-807.98 3361,-807.98 3361,-859.98"/>
<text text-anchor="middle" x="3286.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_9_L14</text>
<text text-anchor="middle" x="3286.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_14&#45;&gt;expert_9_14 -->
<g id="edge644" class="edge">
<title>gate_9_14&#45;&gt;expert_9_14</title>
<path fill="none" stroke="black" d="M3279.77,-895.9C3279.69,-887.23 3279.83,-878.41 3280.18,-870.27"/>
<polygon fill="black" stroke="black" points="3283.69,-870.21 3280.77,-860.03 3276.7,-869.81 3283.69,-870.21"/>
</g>
<!-- gate_9_14&#45;&gt;expert_9_14 -->
<g id="edge1215" class="edge">
<title>gate_9_14&#45;&gt;expert_9_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-895.9C3293.31,-887.23 3293.17,-878.41 3292.82,-870.27"/>
<polygon fill="red" stroke="red" points="3296.3,-869.81 3292.23,-860.03 3289.31,-870.21 3296.3,-869.81"/>
</g>
<!-- aggregate_9_14 -->
<g id="node656" class="node">
<title>aggregate_9_14</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-771.98 3199.06,-771.98 3138.49,-667.98 3373.94,-667.98 3434.51,-771.98"/>
<text text-anchor="middle" x="3286.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L14</text>
<text text-anchor="middle" x="3286.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_14&#45;&gt;aggregate_9_14 -->
<g id="edge645" class="edge">
<title>expert_9_14&#45;&gt;aggregate_9_14</title>
<path fill="none" stroke="black" d="M3286.5,-807.85C3286.5,-800.16 3286.5,-791.35 3286.5,-782.35"/>
<polygon fill="black" stroke="black" points="3290,-782.16 3286.5,-772.16 3283,-782.16 3290,-782.16"/>
</g>
<!-- attention_9_15 -->
<g id="node657" class="node">
<title>attention_9_15</title>
<polygon fill="lightgreen" stroke="black" points="3370.5,-631.98 3202.5,-631.98 3202.5,-579.98 3370.5,-579.98 3370.5,-631.98"/>
<text text-anchor="middle" x="3286.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_9_L15</text>
<text text-anchor="middle" x="3286.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3286.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3286.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_9_14&#45;&gt;attention_9_15 -->
<g id="edge646" class="edge">
<title>aggregate_9_14&#45;&gt;attention_9_15</title>
<path fill="none" stroke="black" d="M3286.5,-667.9C3286.5,-659.23 3286.5,-650.41 3286.5,-642.27"/>
<polygon fill="black" stroke="black" points="3290,-642.03 3286.5,-632.03 3283,-642.03 3290,-642.03"/>
</g>
<!-- gate_9_15 -->
<g id="node658" class="node">
<title>gate_9_15</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-543.98 3199.06,-543.98 3138.49,-439.98 3373.94,-439.98 3434.51,-543.98"/>
<text text-anchor="middle" x="3286.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_9_L15</text>
<text text-anchor="middle" x="3286.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3286.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_9_15&#45;&gt;gate_9_15 -->
<g id="edge647" class="edge">
<title>attention_9_15&#45;&gt;gate_9_15</title>
<path fill="none" stroke="black" d="M3286.5,-579.85C3286.5,-572.16 3286.5,-563.35 3286.5,-554.35"/>
<polygon fill="black" stroke="black" points="3290,-554.16 3286.5,-544.16 3283,-554.16 3290,-554.16"/>
</g>
<!-- expert_9_15 -->
<g id="node659" class="node">
<title>expert_9_15</title>
<polygon fill="lightgreen" stroke="black" points="3361,-403.98 3212,-403.98 3212,-351.98 3361,-351.98 3361,-403.98"/>
<text text-anchor="middle" x="3286.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_9_L15</text>
<text text-anchor="middle" x="3286.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=9</text>
<text text-anchor="middle" x="3286.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_9_15&#45;&gt;expert_9_15 -->
<g id="edge648" class="edge">
<title>gate_9_15&#45;&gt;expert_9_15</title>
<path fill="none" stroke="black" d="M3279.77,-439.9C3279.69,-431.23 3279.83,-422.41 3280.18,-414.27"/>
<polygon fill="black" stroke="black" points="3283.69,-414.21 3280.77,-404.03 3276.7,-413.81 3283.69,-414.21"/>
</g>
<!-- gate_9_15&#45;&gt;expert_9_15 -->
<g id="edge1216" class="edge">
<title>gate_9_15&#45;&gt;expert_9_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3293.23,-439.9C3293.31,-431.23 3293.17,-422.41 3292.82,-414.27"/>
<polygon fill="red" stroke="red" points="3296.3,-413.81 3292.23,-404.03 3289.31,-414.21 3296.3,-413.81"/>
</g>
<!-- aggregate_9_15 -->
<g id="node660" class="node">
<title>aggregate_9_15</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-315.98 3199.06,-315.98 3138.49,-211.98 3373.94,-211.98 3434.51,-315.98"/>
<text text-anchor="middle" x="3286.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_9_L15</text>
<text text-anchor="middle" x="3286.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3286.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3286.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_9_15&#45;&gt;aggregate_9_15 -->
<g id="edge649" class="edge">
<title>expert_9_15&#45;&gt;aggregate_9_15</title>
<path fill="none" stroke="black" d="M3286.5,-351.85C3286.5,-344.16 3286.5,-335.35 3286.5,-326.35"/>
<polygon fill="black" stroke="black" points="3290,-326.16 3286.5,-316.16 3283,-326.16 3290,-326.16"/>
</g>
<!-- collect_9 -->
<g id="node661" class="node">
<title>collect_9</title>
<polygon fill="lightyellow" stroke="black" points="3434.51,-175.98 3199.06,-175.98 3138.49,-93.98 3373.94,-93.98 3434.51,-175.98"/>
<text text-anchor="middle" x="3286.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_9</text>
<text text-anchor="middle" x="3286.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3286.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_9_15&#45;&gt;collect_9 -->
<g id="edge650" class="edge">
<title>aggregate_9_15&#45;&gt;collect_9</title>
<path fill="none" stroke="black" d="M3286.5,-211.69C3286.5,-203.27 3286.5,-194.56 3286.5,-186.17"/>
<polygon fill="black" stroke="black" points="3290,-186.14 3286.5,-176.14 3283,-186.14 3290,-186.14"/>
</g>
<!-- collect_9&#45;&gt;output -->
<g id="edge1050" class="edge">
<title>collect_9&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3140.22,-96.69C3136.28,-95.77 3132.36,-94.86 3128.5,-93.98 3057.76,-77.85 2977.63,-61.6 2915.89,-49.51"/>
<polygon fill="black" stroke="black" points="2916.24,-46.02 2905.75,-47.53 2914.9,-52.89 2916.24,-46.02"/>
</g>
<!-- distribute_10 -->
<g id="node662" class="node">
<title>distribute_10</title>
<polygon fill="lightyellow" stroke="black" points="3769.73,-7589.98 3529.16,-7589.98 3467.27,-7507.98 3707.85,-7507.98 3769.73,-7589.98"/>
<text text-anchor="middle" x="3618.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_10</text>
<text text-anchor="middle" x="3618.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="3618.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_0 -->
<g id="node663" class="node">
<title>attention_10_0</title>
<polygon fill="lightgreen" stroke="black" points="3699.5,-7471.98 3531.5,-7471.98 3531.5,-7419.98 3699.5,-7419.98 3699.5,-7471.98"/>
<text text-anchor="middle" x="3615.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_10_L0</text>
<text text-anchor="middle" x="3615.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3615.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3615.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_10&#45;&gt;attention_10_0 -->
<g id="edge651" class="edge">
<title>distribute_10&#45;&gt;attention_10_0</title>
<path fill="none" stroke="black" d="M3617.31,-7507.77C3617.06,-7499.34 3616.79,-7490.51 3616.55,-7482.27"/>
<polygon fill="black" stroke="black" points="3620.05,-7482.13 3616.25,-7472.23 3613.05,-7482.33 3620.05,-7482.13"/>
</g>
<!-- gate_10_0 -->
<g id="node664" class="node">
<title>gate_10_0</title>
<polygon fill="lightyellow" stroke="black" points="3763.51,-7383.98 3528.06,-7383.98 3467.49,-7279.98 3702.94,-7279.98 3763.51,-7383.98"/>
<text text-anchor="middle" x="3615.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_10_L0</text>
<text text-anchor="middle" x="3615.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3615.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3615.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_0&#45;&gt;gate_10_0 -->
<g id="edge652" class="edge">
<title>attention_10_0&#45;&gt;gate_10_0</title>
<path fill="none" stroke="black" d="M3615.5,-7419.85C3615.5,-7412.16 3615.5,-7403.35 3615.5,-7394.35"/>
<polygon fill="black" stroke="black" points="3619,-7394.16 3615.5,-7384.16 3612,-7394.16 3619,-7394.16"/>
</g>
<!-- expert_10_0 -->
<g id="node665" class="node">
<title>expert_10_0</title>
<polygon fill="lightgreen" stroke="black" points="3690,-7243.98 3541,-7243.98 3541,-7191.98 3690,-7191.98 3690,-7243.98"/>
<text text-anchor="middle" x="3615.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_10_L0</text>
<text text-anchor="middle" x="3615.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3615.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3615.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_0&#45;&gt;expert_10_0 -->
<g id="edge653" class="edge">
<title>gate_10_0&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" d="M3608.77,-7279.9C3608.69,-7271.23 3608.83,-7262.41 3609.18,-7254.27"/>
<polygon fill="black" stroke="black" points="3612.69,-7254.21 3609.77,-7244.03 3605.7,-7253.81 3612.69,-7254.21"/>
</g>
<!-- gate_10_0&#45;&gt;expert_10_0 -->
<g id="edge1217" class="edge">
<title>gate_10_0&#45;&gt;expert_10_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3622.23,-7279.9C3622.31,-7271.23 3622.17,-7262.41 3621.82,-7254.27"/>
<polygon fill="red" stroke="red" points="3625.3,-7253.81 3621.23,-7244.03 3618.31,-7254.21 3625.3,-7253.81"/>
</g>
<!-- aggregate_10_0 -->
<g id="node666" class="node">
<title>aggregate_10_0</title>
<polygon fill="lightyellow" stroke="black" points="3763.51,-7155.98 3528.06,-7155.98 3467.49,-7051.98 3702.94,-7051.98 3763.51,-7155.98"/>
<text text-anchor="middle" x="3615.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L0</text>
<text text-anchor="middle" x="3615.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3615.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3615.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_0&#45;&gt;aggregate_10_0 -->
<g id="edge654" class="edge">
<title>expert_10_0&#45;&gt;aggregate_10_0</title>
<path fill="none" stroke="black" d="M3615.5,-7191.85C3615.5,-7184.16 3615.5,-7175.35 3615.5,-7166.35"/>
<polygon fill="black" stroke="black" points="3619,-7166.16 3615.5,-7156.16 3612,-7166.16 3619,-7166.16"/>
</g>
<!-- attention_10_1 -->
<g id="node667" class="node">
<title>attention_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3698.5,-7015.98 3530.5,-7015.98 3530.5,-6963.98 3698.5,-6963.98 3698.5,-7015.98"/>
<text text-anchor="middle" x="3614.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_10_L1</text>
<text text-anchor="middle" x="3614.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3614.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3614.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_0&#45;&gt;attention_10_1 -->
<g id="edge655" class="edge">
<title>aggregate_10_0&#45;&gt;attention_10_1</title>
<path fill="none" stroke="black" d="M3615.04,-7051.9C3614.97,-7043.23 3614.89,-7034.41 3614.82,-7026.27"/>
<polygon fill="black" stroke="black" points="3618.31,-7025.99 3614.72,-7016.03 3611.31,-7026.06 3618.31,-7025.99"/>
</g>
<!-- gate_10_1 -->
<g id="node668" class="node">
<title>gate_10_1</title>
<polygon fill="lightyellow" stroke="black" points="3762.51,-6927.98 3527.06,-6927.98 3466.49,-6823.98 3701.94,-6823.98 3762.51,-6927.98"/>
<text text-anchor="middle" x="3614.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_10_L1</text>
<text text-anchor="middle" x="3614.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3614.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3614.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_1&#45;&gt;gate_10_1 -->
<g id="edge656" class="edge">
<title>attention_10_1&#45;&gt;gate_10_1</title>
<path fill="none" stroke="black" d="M3614.5,-6963.85C3614.5,-6956.16 3614.5,-6947.35 3614.5,-6938.35"/>
<polygon fill="black" stroke="black" points="3618,-6938.16 3614.5,-6928.16 3611,-6938.16 3618,-6938.16"/>
</g>
<!-- expert_10_1 -->
<g id="node669" class="node">
<title>expert_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3689,-6787.98 3540,-6787.98 3540,-6735.98 3689,-6735.98 3689,-6787.98"/>
<text text-anchor="middle" x="3614.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_10_L1</text>
<text text-anchor="middle" x="3614.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3614.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3614.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_1&#45;&gt;expert_10_1 -->
<g id="edge657" class="edge">
<title>gate_10_1&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" d="M3607.77,-6823.9C3607.69,-6815.23 3607.83,-6806.41 3608.18,-6798.27"/>
<polygon fill="black" stroke="black" points="3611.69,-6798.21 3608.77,-6788.03 3604.7,-6797.81 3611.69,-6798.21"/>
</g>
<!-- gate_10_1&#45;&gt;expert_10_1 -->
<g id="edge1218" class="edge">
<title>gate_10_1&#45;&gt;expert_10_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3621.23,-6823.9C3621.31,-6815.23 3621.17,-6806.41 3620.82,-6798.27"/>
<polygon fill="red" stroke="red" points="3624.3,-6797.81 3620.23,-6788.03 3617.31,-6798.21 3624.3,-6797.81"/>
</g>
<!-- aggregate_10_1 -->
<g id="node670" class="node">
<title>aggregate_10_1</title>
<polygon fill="lightyellow" stroke="black" points="3762.51,-6699.98 3527.06,-6699.98 3466.49,-6595.98 3701.94,-6595.98 3762.51,-6699.98"/>
<text text-anchor="middle" x="3614.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L1</text>
<text text-anchor="middle" x="3614.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3614.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3614.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_1&#45;&gt;aggregate_10_1 -->
<g id="edge658" class="edge">
<title>expert_10_1&#45;&gt;aggregate_10_1</title>
<path fill="none" stroke="black" d="M3614.5,-6735.85C3614.5,-6728.16 3614.5,-6719.35 3614.5,-6710.35"/>
<polygon fill="black" stroke="black" points="3618,-6710.16 3614.5,-6700.16 3611,-6710.16 3618,-6710.16"/>
</g>
<!-- attention_10_2 -->
<g id="node671" class="node">
<title>attention_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3698.5,-6559.98 3530.5,-6559.98 3530.5,-6507.98 3698.5,-6507.98 3698.5,-6559.98"/>
<text text-anchor="middle" x="3614.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_10_L2</text>
<text text-anchor="middle" x="3614.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3614.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3614.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_1&#45;&gt;attention_10_2 -->
<g id="edge659" class="edge">
<title>aggregate_10_1&#45;&gt;attention_10_2</title>
<path fill="none" stroke="black" d="M3614.5,-6595.9C3614.5,-6587.23 3614.5,-6578.41 3614.5,-6570.27"/>
<polygon fill="black" stroke="black" points="3618,-6570.03 3614.5,-6560.03 3611,-6570.03 3618,-6570.03"/>
</g>
<!-- gate_10_2 -->
<g id="node672" class="node">
<title>gate_10_2</title>
<polygon fill="lightyellow" stroke="black" points="3760.51,-6471.98 3525.06,-6471.98 3464.49,-6367.98 3699.94,-6367.98 3760.51,-6471.98"/>
<text text-anchor="middle" x="3612.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_10_L2</text>
<text text-anchor="middle" x="3612.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3612.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3612.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_2&#45;&gt;gate_10_2 -->
<g id="edge660" class="edge">
<title>attention_10_2&#45;&gt;gate_10_2</title>
<path fill="none" stroke="black" d="M3614.05,-6507.85C3613.91,-6500.16 3613.76,-6491.35 3613.6,-6482.35"/>
<polygon fill="black" stroke="black" points="3617.09,-6482.1 3613.41,-6472.16 3610.09,-6482.22 3617.09,-6482.1"/>
</g>
<!-- expert_10_2 -->
<g id="node673" class="node">
<title>expert_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3687,-6331.98 3538,-6331.98 3538,-6279.98 3687,-6279.98 3687,-6331.98"/>
<text text-anchor="middle" x="3612.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_10_L2</text>
<text text-anchor="middle" x="3612.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3612.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3612.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_2&#45;&gt;expert_10_2 -->
<g id="edge661" class="edge">
<title>gate_10_2&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" d="M3605.77,-6367.9C3605.69,-6359.23 3605.83,-6350.41 3606.18,-6342.27"/>
<polygon fill="black" stroke="black" points="3609.69,-6342.21 3606.77,-6332.03 3602.7,-6341.81 3609.69,-6342.21"/>
</g>
<!-- gate_10_2&#45;&gt;expert_10_2 -->
<g id="edge1219" class="edge">
<title>gate_10_2&#45;&gt;expert_10_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3619.23,-6367.9C3619.31,-6359.23 3619.17,-6350.41 3618.82,-6342.27"/>
<polygon fill="red" stroke="red" points="3622.3,-6341.81 3618.23,-6332.03 3615.31,-6342.21 3622.3,-6341.81"/>
</g>
<!-- aggregate_10_2 -->
<g id="node674" class="node">
<title>aggregate_10_2</title>
<polygon fill="lightyellow" stroke="black" points="3760.51,-6243.98 3525.06,-6243.98 3464.49,-6139.98 3699.94,-6139.98 3760.51,-6243.98"/>
<text text-anchor="middle" x="3612.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L2</text>
<text text-anchor="middle" x="3612.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3612.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3612.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_2&#45;&gt;aggregate_10_2 -->
<g id="edge662" class="edge">
<title>expert_10_2&#45;&gt;aggregate_10_2</title>
<path fill="none" stroke="black" d="M3612.5,-6279.85C3612.5,-6272.16 3612.5,-6263.35 3612.5,-6254.35"/>
<polygon fill="black" stroke="black" points="3616,-6254.16 3612.5,-6244.16 3609,-6254.16 3616,-6254.16"/>
</g>
<!-- attention_10_3 -->
<g id="node675" class="node">
<title>attention_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3694.5,-6103.98 3526.5,-6103.98 3526.5,-6051.98 3694.5,-6051.98 3694.5,-6103.98"/>
<text text-anchor="middle" x="3610.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_10_L3</text>
<text text-anchor="middle" x="3610.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3610.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3610.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_2&#45;&gt;attention_10_3 -->
<g id="edge663" class="edge">
<title>aggregate_10_2&#45;&gt;attention_10_3</title>
<path fill="none" stroke="black" d="M3611.59,-6139.9C3611.43,-6131.23 3611.28,-6122.41 3611.13,-6114.27"/>
<polygon fill="black" stroke="black" points="3614.63,-6113.96 3610.95,-6104.03 3607.63,-6114.09 3614.63,-6113.96"/>
</g>
<!-- gate_10_3 -->
<g id="node676" class="node">
<title>gate_10_3</title>
<polygon fill="lightyellow" stroke="black" points="3758.51,-6015.98 3523.06,-6015.98 3462.49,-5911.98 3697.94,-5911.98 3758.51,-6015.98"/>
<text text-anchor="middle" x="3610.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_10_L3</text>
<text text-anchor="middle" x="3610.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3610.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3610.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_3&#45;&gt;gate_10_3 -->
<g id="edge664" class="edge">
<title>attention_10_3&#45;&gt;gate_10_3</title>
<path fill="none" stroke="black" d="M3610.5,-6051.85C3610.5,-6044.16 3610.5,-6035.35 3610.5,-6026.35"/>
<polygon fill="black" stroke="black" points="3614,-6026.16 3610.5,-6016.16 3607,-6026.16 3614,-6026.16"/>
</g>
<!-- expert_10_3 -->
<g id="node677" class="node">
<title>expert_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3684,-5875.98 3535,-5875.98 3535,-5823.98 3684,-5823.98 3684,-5875.98"/>
<text text-anchor="middle" x="3609.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_10_L3</text>
<text text-anchor="middle" x="3609.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3609.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3609.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_3&#45;&gt;expert_10_3 -->
<g id="edge665" class="edge">
<title>gate_10_3&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" d="M3603.32,-5911.9C3603.16,-5903.23 3603.22,-5894.41 3603.49,-5886.27"/>
<polygon fill="black" stroke="black" points="3607,-5886.18 3603.99,-5876.03 3600.01,-5885.85 3607,-5886.18"/>
</g>
<!-- gate_10_3&#45;&gt;expert_10_3 -->
<g id="edge1220" class="edge">
<title>gate_10_3&#45;&gt;expert_10_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3616.77,-5911.9C3616.78,-5903.23 3616.56,-5894.41 3616.14,-5886.27"/>
<polygon fill="red" stroke="red" points="3619.61,-5885.77 3615.46,-5876.03 3612.63,-5886.24 3619.61,-5885.77"/>
</g>
<!-- aggregate_10_3 -->
<g id="node678" class="node">
<title>aggregate_10_3</title>
<polygon fill="lightyellow" stroke="black" points="3756.51,-5787.98 3521.06,-5787.98 3460.49,-5683.98 3695.94,-5683.98 3756.51,-5787.98"/>
<text text-anchor="middle" x="3608.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L3</text>
<text text-anchor="middle" x="3608.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3608.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3608.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_3&#45;&gt;aggregate_10_3 -->
<g id="edge666" class="edge">
<title>expert_10_3&#45;&gt;aggregate_10_3</title>
<path fill="none" stroke="black" d="M3609.28,-5823.85C3609.21,-5816.16 3609.13,-5807.35 3609.05,-5798.35"/>
<polygon fill="black" stroke="black" points="3612.55,-5798.13 3608.96,-5788.16 3605.55,-5798.19 3612.55,-5798.13"/>
</g>
<!-- attention_10_4 -->
<g id="node679" class="node">
<title>attention_10_4</title>
<polygon fill="lightgreen" stroke="black" points="3692.5,-5647.98 3524.5,-5647.98 3524.5,-5595.98 3692.5,-5595.98 3692.5,-5647.98"/>
<text text-anchor="middle" x="3608.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_10_L4</text>
<text text-anchor="middle" x="3608.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3608.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3608.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_3&#45;&gt;attention_10_4 -->
<g id="edge667" class="edge">
<title>aggregate_10_3&#45;&gt;attention_10_4</title>
<path fill="none" stroke="black" d="M3608.5,-5683.9C3608.5,-5675.23 3608.5,-5666.41 3608.5,-5658.27"/>
<polygon fill="black" stroke="black" points="3612,-5658.03 3608.5,-5648.03 3605,-5658.03 3612,-5658.03"/>
</g>
<!-- gate_10_4 -->
<g id="node680" class="node">
<title>gate_10_4</title>
<polygon fill="lightyellow" stroke="black" points="3755.51,-5559.98 3520.06,-5559.98 3459.49,-5455.98 3694.94,-5455.98 3755.51,-5559.98"/>
<text text-anchor="middle" x="3607.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_10_L4</text>
<text text-anchor="middle" x="3607.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3607.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3607.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_4&#45;&gt;gate_10_4 -->
<g id="edge668" class="edge">
<title>attention_10_4&#45;&gt;gate_10_4</title>
<path fill="none" stroke="black" d="M3608.28,-5595.85C3608.21,-5588.16 3608.13,-5579.35 3608.05,-5570.35"/>
<polygon fill="black" stroke="black" points="3611.55,-5570.13 3607.96,-5560.16 3604.55,-5570.19 3611.55,-5570.13"/>
</g>
<!-- expert_10_4 -->
<g id="node681" class="node">
<title>expert_10_4</title>
<polygon fill="lightgreen" stroke="black" points="3682,-5419.98 3533,-5419.98 3533,-5367.98 3682,-5367.98 3682,-5419.98"/>
<text text-anchor="middle" x="3607.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_10_L4</text>
<text text-anchor="middle" x="3607.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3607.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3607.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_4&#45;&gt;expert_10_4 -->
<g id="edge669" class="edge">
<title>gate_10_4&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" d="M3600.77,-5455.9C3600.69,-5447.23 3600.83,-5438.41 3601.18,-5430.27"/>
<polygon fill="black" stroke="black" points="3604.69,-5430.21 3601.77,-5420.03 3597.7,-5429.81 3604.69,-5430.21"/>
</g>
<!-- gate_10_4&#45;&gt;expert_10_4 -->
<g id="edge1221" class="edge">
<title>gate_10_4&#45;&gt;expert_10_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3614.23,-5455.9C3614.31,-5447.23 3614.17,-5438.41 3613.82,-5430.27"/>
<polygon fill="red" stroke="red" points="3617.3,-5429.81 3613.23,-5420.03 3610.31,-5430.21 3617.3,-5429.81"/>
</g>
<!-- aggregate_10_4 -->
<g id="node682" class="node">
<title>aggregate_10_4</title>
<polygon fill="lightyellow" stroke="black" points="3755.51,-5331.98 3520.06,-5331.98 3459.49,-5227.98 3694.94,-5227.98 3755.51,-5331.98"/>
<text text-anchor="middle" x="3607.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L4</text>
<text text-anchor="middle" x="3607.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3607.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3607.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_4&#45;&gt;aggregate_10_4 -->
<g id="edge670" class="edge">
<title>expert_10_4&#45;&gt;aggregate_10_4</title>
<path fill="none" stroke="black" d="M3607.5,-5367.85C3607.5,-5360.16 3607.5,-5351.35 3607.5,-5342.35"/>
<polygon fill="black" stroke="black" points="3611,-5342.16 3607.5,-5332.16 3604,-5342.16 3611,-5342.16"/>
</g>
<!-- attention_10_5 -->
<g id="node683" class="node">
<title>attention_10_5</title>
<polygon fill="lightgreen" stroke="black" points="3691.5,-5191.98 3523.5,-5191.98 3523.5,-5139.98 3691.5,-5139.98 3691.5,-5191.98"/>
<text text-anchor="middle" x="3607.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_10_L5</text>
<text text-anchor="middle" x="3607.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3607.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3607.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_4&#45;&gt;attention_10_5 -->
<g id="edge671" class="edge">
<title>aggregate_10_4&#45;&gt;attention_10_5</title>
<path fill="none" stroke="black" d="M3607.5,-5227.9C3607.5,-5219.23 3607.5,-5210.41 3607.5,-5202.27"/>
<polygon fill="black" stroke="black" points="3611,-5202.03 3607.5,-5192.03 3604,-5202.03 3611,-5202.03"/>
</g>
<!-- gate_10_5 -->
<g id="node684" class="node">
<title>gate_10_5</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-5103.98 3514.06,-5103.98 3453.49,-4999.98 3688.94,-4999.98 3749.51,-5103.98"/>
<text text-anchor="middle" x="3601.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_10_L5</text>
<text text-anchor="middle" x="3601.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_5&#45;&gt;gate_10_5 -->
<g id="edge672" class="edge">
<title>attention_10_5&#45;&gt;gate_10_5</title>
<path fill="none" stroke="black" d="M3606.15,-5139.85C3605.74,-5132.16 3605.27,-5123.35 3604.79,-5114.35"/>
<polygon fill="black" stroke="black" points="3608.27,-5113.96 3604.24,-5104.16 3601.28,-5114.33 3608.27,-5113.96"/>
</g>
<!-- expert_10_5 -->
<g id="node685" class="node">
<title>expert_10_5</title>
<polygon fill="lightgreen" stroke="black" points="3676,-4963.98 3527,-4963.98 3527,-4911.98 3676,-4911.98 3676,-4963.98"/>
<text text-anchor="middle" x="3601.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_10_L5</text>
<text text-anchor="middle" x="3601.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_5&#45;&gt;expert_10_5 -->
<g id="edge673" class="edge">
<title>gate_10_5&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" d="M3594.77,-4999.9C3594.69,-4991.23 3594.83,-4982.41 3595.18,-4974.27"/>
<polygon fill="black" stroke="black" points="3598.69,-4974.21 3595.77,-4964.03 3591.7,-4973.81 3598.69,-4974.21"/>
</g>
<!-- gate_10_5&#45;&gt;expert_10_5 -->
<g id="edge1222" class="edge">
<title>gate_10_5&#45;&gt;expert_10_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-4999.9C3608.31,-4991.23 3608.17,-4982.41 3607.82,-4974.27"/>
<polygon fill="red" stroke="red" points="3611.3,-4973.81 3607.23,-4964.03 3604.31,-4974.21 3611.3,-4973.81"/>
</g>
<!-- aggregate_10_5 -->
<g id="node686" class="node">
<title>aggregate_10_5</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-4875.98 3514.06,-4875.98 3453.49,-4771.98 3688.94,-4771.98 3749.51,-4875.98"/>
<text text-anchor="middle" x="3601.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L5</text>
<text text-anchor="middle" x="3601.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_5&#45;&gt;aggregate_10_5 -->
<g id="edge674" class="edge">
<title>expert_10_5&#45;&gt;aggregate_10_5</title>
<path fill="none" stroke="black" d="M3601.5,-4911.85C3601.5,-4904.16 3601.5,-4895.35 3601.5,-4886.35"/>
<polygon fill="black" stroke="black" points="3605,-4886.16 3601.5,-4876.16 3598,-4886.16 3605,-4886.16"/>
</g>
<!-- attention_10_6 -->
<g id="node687" class="node">
<title>attention_10_6</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-4735.98 3517.5,-4735.98 3517.5,-4683.98 3685.5,-4683.98 3685.5,-4735.98"/>
<text text-anchor="middle" x="3601.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_10_L6</text>
<text text-anchor="middle" x="3601.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_5&#45;&gt;attention_10_6 -->
<g id="edge675" class="edge">
<title>aggregate_10_5&#45;&gt;attention_10_6</title>
<path fill="none" stroke="black" d="M3601.5,-4771.9C3601.5,-4763.23 3601.5,-4754.41 3601.5,-4746.27"/>
<polygon fill="black" stroke="black" points="3605,-4746.03 3601.5,-4736.03 3598,-4746.03 3605,-4746.03"/>
</g>
<!-- gate_10_6 -->
<g id="node688" class="node">
<title>gate_10_6</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-4647.98 3514.06,-4647.98 3453.49,-4543.98 3688.94,-4543.98 3749.51,-4647.98"/>
<text text-anchor="middle" x="3601.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_10_L6</text>
<text text-anchor="middle" x="3601.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_6&#45;&gt;gate_10_6 -->
<g id="edge676" class="edge">
<title>attention_10_6&#45;&gt;gate_10_6</title>
<path fill="none" stroke="black" d="M3601.5,-4683.85C3601.5,-4676.16 3601.5,-4667.35 3601.5,-4658.35"/>
<polygon fill="black" stroke="black" points="3605,-4658.16 3601.5,-4648.16 3598,-4658.16 3605,-4658.16"/>
</g>
<!-- expert_10_6 -->
<g id="node689" class="node">
<title>expert_10_6</title>
<polygon fill="lightgreen" stroke="black" points="3676,-4507.98 3527,-4507.98 3527,-4455.98 3676,-4455.98 3676,-4507.98"/>
<text text-anchor="middle" x="3601.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_10_L6</text>
<text text-anchor="middle" x="3601.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_6&#45;&gt;expert_10_6 -->
<g id="edge677" class="edge">
<title>gate_10_6&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" d="M3594.77,-4543.9C3594.69,-4535.23 3594.83,-4526.41 3595.18,-4518.27"/>
<polygon fill="black" stroke="black" points="3598.69,-4518.21 3595.77,-4508.03 3591.7,-4517.81 3598.69,-4518.21"/>
</g>
<!-- gate_10_6&#45;&gt;expert_10_6 -->
<g id="edge1223" class="edge">
<title>gate_10_6&#45;&gt;expert_10_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-4543.9C3608.31,-4535.23 3608.17,-4526.41 3607.82,-4518.27"/>
<polygon fill="red" stroke="red" points="3611.3,-4517.81 3607.23,-4508.03 3604.31,-4518.21 3611.3,-4517.81"/>
</g>
<!-- aggregate_10_6 -->
<g id="node690" class="node">
<title>aggregate_10_6</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-4419.98 3514.06,-4419.98 3453.49,-4315.98 3688.94,-4315.98 3749.51,-4419.98"/>
<text text-anchor="middle" x="3601.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L6</text>
<text text-anchor="middle" x="3601.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_6&#45;&gt;aggregate_10_6 -->
<g id="edge678" class="edge">
<title>expert_10_6&#45;&gt;aggregate_10_6</title>
<path fill="none" stroke="black" d="M3601.5,-4455.85C3601.5,-4448.16 3601.5,-4439.35 3601.5,-4430.35"/>
<polygon fill="black" stroke="black" points="3605,-4430.16 3601.5,-4420.16 3598,-4430.16 3605,-4430.16"/>
</g>
<!-- attention_10_7 -->
<g id="node691" class="node">
<title>attention_10_7</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-4279.98 3517.5,-4279.98 3517.5,-4227.98 3685.5,-4227.98 3685.5,-4279.98"/>
<text text-anchor="middle" x="3601.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_10_L7</text>
<text text-anchor="middle" x="3601.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_6&#45;&gt;attention_10_7 -->
<g id="edge679" class="edge">
<title>aggregate_10_6&#45;&gt;attention_10_7</title>
<path fill="none" stroke="black" d="M3601.5,-4315.9C3601.5,-4307.23 3601.5,-4298.41 3601.5,-4290.27"/>
<polygon fill="black" stroke="black" points="3605,-4290.03 3601.5,-4280.03 3598,-4290.03 3605,-4290.03"/>
</g>
<!-- gate_10_7 -->
<g id="node692" class="node">
<title>gate_10_7</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-4191.98 3514.06,-4191.98 3453.49,-4087.98 3688.94,-4087.98 3749.51,-4191.98"/>
<text text-anchor="middle" x="3601.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_10_L7</text>
<text text-anchor="middle" x="3601.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_7&#45;&gt;gate_10_7 -->
<g id="edge680" class="edge">
<title>attention_10_7&#45;&gt;gate_10_7</title>
<path fill="none" stroke="black" d="M3601.5,-4227.85C3601.5,-4220.16 3601.5,-4211.35 3601.5,-4202.35"/>
<polygon fill="black" stroke="black" points="3605,-4202.16 3601.5,-4192.16 3598,-4202.16 3605,-4202.16"/>
</g>
<!-- expert_10_7 -->
<g id="node693" class="node">
<title>expert_10_7</title>
<polygon fill="lightgreen" stroke="black" points="3676,-4051.98 3527,-4051.98 3527,-3999.98 3676,-3999.98 3676,-4051.98"/>
<text text-anchor="middle" x="3601.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_10_L7</text>
<text text-anchor="middle" x="3601.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_7&#45;&gt;expert_10_7 -->
<g id="edge681" class="edge">
<title>gate_10_7&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" d="M3594.77,-4087.9C3594.69,-4079.23 3594.83,-4070.41 3595.18,-4062.27"/>
<polygon fill="black" stroke="black" points="3598.69,-4062.21 3595.77,-4052.03 3591.7,-4061.81 3598.69,-4062.21"/>
</g>
<!-- gate_10_7&#45;&gt;expert_10_7 -->
<g id="edge1224" class="edge">
<title>gate_10_7&#45;&gt;expert_10_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-4087.9C3608.31,-4079.23 3608.17,-4070.41 3607.82,-4062.27"/>
<polygon fill="red" stroke="red" points="3611.3,-4061.81 3607.23,-4052.03 3604.31,-4062.21 3611.3,-4061.81"/>
</g>
<!-- aggregate_10_7 -->
<g id="node694" class="node">
<title>aggregate_10_7</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-3963.98 3514.06,-3963.98 3453.49,-3859.98 3688.94,-3859.98 3749.51,-3963.98"/>
<text text-anchor="middle" x="3601.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L7</text>
<text text-anchor="middle" x="3601.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_7&#45;&gt;aggregate_10_7 -->
<g id="edge682" class="edge">
<title>expert_10_7&#45;&gt;aggregate_10_7</title>
<path fill="none" stroke="black" d="M3601.5,-3999.85C3601.5,-3992.16 3601.5,-3983.35 3601.5,-3974.35"/>
<polygon fill="black" stroke="black" points="3605,-3974.16 3601.5,-3964.16 3598,-3974.16 3605,-3974.16"/>
</g>
<!-- attention_10_8 -->
<g id="node695" class="node">
<title>attention_10_8</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-3823.98 3517.5,-3823.98 3517.5,-3771.98 3685.5,-3771.98 3685.5,-3823.98"/>
<text text-anchor="middle" x="3601.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_10_L8</text>
<text text-anchor="middle" x="3601.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_7&#45;&gt;attention_10_8 -->
<g id="edge683" class="edge">
<title>aggregate_10_7&#45;&gt;attention_10_8</title>
<path fill="none" stroke="black" d="M3601.5,-3859.9C3601.5,-3851.23 3601.5,-3842.41 3601.5,-3834.27"/>
<polygon fill="black" stroke="black" points="3605,-3834.03 3601.5,-3824.03 3598,-3834.03 3605,-3834.03"/>
</g>
<!-- gate_10_8 -->
<g id="node696" class="node">
<title>gate_10_8</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-3735.98 3514.06,-3735.98 3453.49,-3631.98 3688.94,-3631.98 3749.51,-3735.98"/>
<text text-anchor="middle" x="3601.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_10_L8</text>
<text text-anchor="middle" x="3601.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_8&#45;&gt;gate_10_8 -->
<g id="edge684" class="edge">
<title>attention_10_8&#45;&gt;gate_10_8</title>
<path fill="none" stroke="black" d="M3601.5,-3771.85C3601.5,-3764.16 3601.5,-3755.35 3601.5,-3746.35"/>
<polygon fill="black" stroke="black" points="3605,-3746.16 3601.5,-3736.16 3598,-3746.16 3605,-3746.16"/>
</g>
<!-- expert_10_8 -->
<g id="node697" class="node">
<title>expert_10_8</title>
<polygon fill="lightgreen" stroke="black" points="3676,-3595.98 3527,-3595.98 3527,-3543.98 3676,-3543.98 3676,-3595.98"/>
<text text-anchor="middle" x="3601.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_10_L8</text>
<text text-anchor="middle" x="3601.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_8&#45;&gt;expert_10_8 -->
<g id="edge685" class="edge">
<title>gate_10_8&#45;&gt;expert_10_8</title>
<path fill="none" stroke="black" d="M3594.77,-3631.9C3594.69,-3623.23 3594.83,-3614.41 3595.18,-3606.27"/>
<polygon fill="black" stroke="black" points="3598.69,-3606.21 3595.77,-3596.03 3591.7,-3605.81 3598.69,-3606.21"/>
</g>
<!-- gate_10_8&#45;&gt;expert_10_8 -->
<g id="edge1225" class="edge">
<title>gate_10_8&#45;&gt;expert_10_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-3631.9C3608.31,-3623.23 3608.17,-3614.41 3607.82,-3606.27"/>
<polygon fill="red" stroke="red" points="3611.3,-3605.81 3607.23,-3596.03 3604.31,-3606.21 3611.3,-3605.81"/>
</g>
<!-- aggregate_10_8 -->
<g id="node698" class="node">
<title>aggregate_10_8</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-3507.98 3514.06,-3507.98 3453.49,-3403.98 3688.94,-3403.98 3749.51,-3507.98"/>
<text text-anchor="middle" x="3601.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L8</text>
<text text-anchor="middle" x="3601.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_8&#45;&gt;aggregate_10_8 -->
<g id="edge686" class="edge">
<title>expert_10_8&#45;&gt;aggregate_10_8</title>
<path fill="none" stroke="black" d="M3601.5,-3543.85C3601.5,-3536.16 3601.5,-3527.35 3601.5,-3518.35"/>
<polygon fill="black" stroke="black" points="3605,-3518.16 3601.5,-3508.16 3598,-3518.16 3605,-3518.16"/>
</g>
<!-- attention_10_9 -->
<g id="node699" class="node">
<title>attention_10_9</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-3367.98 3517.5,-3367.98 3517.5,-3315.98 3685.5,-3315.98 3685.5,-3367.98"/>
<text text-anchor="middle" x="3601.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_10_L9</text>
<text text-anchor="middle" x="3601.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_8&#45;&gt;attention_10_9 -->
<g id="edge687" class="edge">
<title>aggregate_10_8&#45;&gt;attention_10_9</title>
<path fill="none" stroke="black" d="M3601.5,-3403.9C3601.5,-3395.23 3601.5,-3386.41 3601.5,-3378.27"/>
<polygon fill="black" stroke="black" points="3605,-3378.03 3601.5,-3368.03 3598,-3378.03 3605,-3378.03"/>
</g>
<!-- gate_10_9 -->
<g id="node700" class="node">
<title>gate_10_9</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-3279.98 3514.06,-3279.98 3453.49,-3175.98 3688.94,-3175.98 3749.51,-3279.98"/>
<text text-anchor="middle" x="3601.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_10_L9</text>
<text text-anchor="middle" x="3601.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_9&#45;&gt;gate_10_9 -->
<g id="edge688" class="edge">
<title>attention_10_9&#45;&gt;gate_10_9</title>
<path fill="none" stroke="black" d="M3601.5,-3315.85C3601.5,-3308.16 3601.5,-3299.35 3601.5,-3290.35"/>
<polygon fill="black" stroke="black" points="3605,-3290.16 3601.5,-3280.16 3598,-3290.16 3605,-3290.16"/>
</g>
<!-- expert_10_9 -->
<g id="node701" class="node">
<title>expert_10_9</title>
<polygon fill="lightgreen" stroke="black" points="3676,-3139.98 3527,-3139.98 3527,-3087.98 3676,-3087.98 3676,-3139.98"/>
<text text-anchor="middle" x="3601.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_10_L9</text>
<text text-anchor="middle" x="3601.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_9&#45;&gt;expert_10_9 -->
<g id="edge689" class="edge">
<title>gate_10_9&#45;&gt;expert_10_9</title>
<path fill="none" stroke="black" d="M3594.77,-3175.9C3594.69,-3167.23 3594.83,-3158.41 3595.18,-3150.27"/>
<polygon fill="black" stroke="black" points="3598.69,-3150.21 3595.77,-3140.03 3591.7,-3149.81 3598.69,-3150.21"/>
</g>
<!-- gate_10_9&#45;&gt;expert_10_9 -->
<g id="edge1226" class="edge">
<title>gate_10_9&#45;&gt;expert_10_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-3175.9C3608.31,-3167.23 3608.17,-3158.41 3607.82,-3150.27"/>
<polygon fill="red" stroke="red" points="3611.3,-3149.81 3607.23,-3140.03 3604.31,-3150.21 3611.3,-3149.81"/>
</g>
<!-- aggregate_10_9 -->
<g id="node702" class="node">
<title>aggregate_10_9</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-3051.98 3514.06,-3051.98 3453.49,-2947.98 3688.94,-2947.98 3749.51,-3051.98"/>
<text text-anchor="middle" x="3601.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L9</text>
<text text-anchor="middle" x="3601.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_9&#45;&gt;aggregate_10_9 -->
<g id="edge690" class="edge">
<title>expert_10_9&#45;&gt;aggregate_10_9</title>
<path fill="none" stroke="black" d="M3601.5,-3087.85C3601.5,-3080.16 3601.5,-3071.35 3601.5,-3062.35"/>
<polygon fill="black" stroke="black" points="3605,-3062.16 3601.5,-3052.16 3598,-3062.16 3605,-3062.16"/>
</g>
<!-- attention_10_10 -->
<g id="node703" class="node">
<title>attention_10_10</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-2911.98 3517.5,-2911.98 3517.5,-2859.98 3685.5,-2859.98 3685.5,-2911.98"/>
<text text-anchor="middle" x="3601.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_10_L10</text>
<text text-anchor="middle" x="3601.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_9&#45;&gt;attention_10_10 -->
<g id="edge691" class="edge">
<title>aggregate_10_9&#45;&gt;attention_10_10</title>
<path fill="none" stroke="black" d="M3601.5,-2947.9C3601.5,-2939.23 3601.5,-2930.41 3601.5,-2922.27"/>
<polygon fill="black" stroke="black" points="3605,-2922.03 3601.5,-2912.03 3598,-2922.03 3605,-2922.03"/>
</g>
<!-- gate_10_10 -->
<g id="node704" class="node">
<title>gate_10_10</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-2823.98 3514.06,-2823.98 3453.49,-2719.98 3688.94,-2719.98 3749.51,-2823.98"/>
<text text-anchor="middle" x="3601.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_10_L10</text>
<text text-anchor="middle" x="3601.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_10&#45;&gt;gate_10_10 -->
<g id="edge692" class="edge">
<title>attention_10_10&#45;&gt;gate_10_10</title>
<path fill="none" stroke="black" d="M3601.5,-2859.85C3601.5,-2852.16 3601.5,-2843.35 3601.5,-2834.35"/>
<polygon fill="black" stroke="black" points="3605,-2834.16 3601.5,-2824.16 3598,-2834.16 3605,-2834.16"/>
</g>
<!-- expert_10_10 -->
<g id="node705" class="node">
<title>expert_10_10</title>
<polygon fill="lightgreen" stroke="black" points="3676,-2683.98 3527,-2683.98 3527,-2631.98 3676,-2631.98 3676,-2683.98"/>
<text text-anchor="middle" x="3601.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_10_L10</text>
<text text-anchor="middle" x="3601.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_10&#45;&gt;expert_10_10 -->
<g id="edge693" class="edge">
<title>gate_10_10&#45;&gt;expert_10_10</title>
<path fill="none" stroke="black" d="M3594.77,-2719.9C3594.69,-2711.23 3594.83,-2702.41 3595.18,-2694.27"/>
<polygon fill="black" stroke="black" points="3598.69,-2694.21 3595.77,-2684.03 3591.7,-2693.81 3598.69,-2694.21"/>
</g>
<!-- gate_10_10&#45;&gt;expert_10_10 -->
<g id="edge1227" class="edge">
<title>gate_10_10&#45;&gt;expert_10_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-2719.9C3608.31,-2711.23 3608.17,-2702.41 3607.82,-2694.27"/>
<polygon fill="red" stroke="red" points="3611.3,-2693.81 3607.23,-2684.03 3604.31,-2694.21 3611.3,-2693.81"/>
</g>
<!-- aggregate_10_10 -->
<g id="node706" class="node">
<title>aggregate_10_10</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-2595.98 3514.06,-2595.98 3453.49,-2491.98 3688.94,-2491.98 3749.51,-2595.98"/>
<text text-anchor="middle" x="3601.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L10</text>
<text text-anchor="middle" x="3601.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_10&#45;&gt;aggregate_10_10 -->
<g id="edge694" class="edge">
<title>expert_10_10&#45;&gt;aggregate_10_10</title>
<path fill="none" stroke="black" d="M3601.5,-2631.85C3601.5,-2624.16 3601.5,-2615.35 3601.5,-2606.35"/>
<polygon fill="black" stroke="black" points="3605,-2606.16 3601.5,-2596.16 3598,-2606.16 3605,-2606.16"/>
</g>
<!-- attention_10_11 -->
<g id="node707" class="node">
<title>attention_10_11</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-2455.98 3517.5,-2455.98 3517.5,-2403.98 3685.5,-2403.98 3685.5,-2455.98"/>
<text text-anchor="middle" x="3601.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_10_L11</text>
<text text-anchor="middle" x="3601.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_10&#45;&gt;attention_10_11 -->
<g id="edge695" class="edge">
<title>aggregate_10_10&#45;&gt;attention_10_11</title>
<path fill="none" stroke="black" d="M3601.5,-2491.9C3601.5,-2483.23 3601.5,-2474.41 3601.5,-2466.27"/>
<polygon fill="black" stroke="black" points="3605,-2466.03 3601.5,-2456.03 3598,-2466.03 3605,-2466.03"/>
</g>
<!-- gate_10_11 -->
<g id="node708" class="node">
<title>gate_10_11</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-2367.98 3514.06,-2367.98 3453.49,-2263.98 3688.94,-2263.98 3749.51,-2367.98"/>
<text text-anchor="middle" x="3601.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_10_L11</text>
<text text-anchor="middle" x="3601.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_11&#45;&gt;gate_10_11 -->
<g id="edge696" class="edge">
<title>attention_10_11&#45;&gt;gate_10_11</title>
<path fill="none" stroke="black" d="M3601.5,-2403.85C3601.5,-2396.16 3601.5,-2387.35 3601.5,-2378.35"/>
<polygon fill="black" stroke="black" points="3605,-2378.16 3601.5,-2368.16 3598,-2378.16 3605,-2378.16"/>
</g>
<!-- expert_10_11 -->
<g id="node709" class="node">
<title>expert_10_11</title>
<polygon fill="lightgreen" stroke="black" points="3676,-2227.98 3527,-2227.98 3527,-2175.98 3676,-2175.98 3676,-2227.98"/>
<text text-anchor="middle" x="3601.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_10_L11</text>
<text text-anchor="middle" x="3601.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_11&#45;&gt;expert_10_11 -->
<g id="edge697" class="edge">
<title>gate_10_11&#45;&gt;expert_10_11</title>
<path fill="none" stroke="black" d="M3594.77,-2263.9C3594.69,-2255.23 3594.83,-2246.41 3595.18,-2238.27"/>
<polygon fill="black" stroke="black" points="3598.69,-2238.21 3595.77,-2228.03 3591.7,-2237.81 3598.69,-2238.21"/>
</g>
<!-- gate_10_11&#45;&gt;expert_10_11 -->
<g id="edge1228" class="edge">
<title>gate_10_11&#45;&gt;expert_10_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-2263.9C3608.31,-2255.23 3608.17,-2246.41 3607.82,-2238.27"/>
<polygon fill="red" stroke="red" points="3611.3,-2237.81 3607.23,-2228.03 3604.31,-2238.21 3611.3,-2237.81"/>
</g>
<!-- aggregate_10_11 -->
<g id="node710" class="node">
<title>aggregate_10_11</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-2139.98 3514.06,-2139.98 3453.49,-2035.98 3688.94,-2035.98 3749.51,-2139.98"/>
<text text-anchor="middle" x="3601.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L11</text>
<text text-anchor="middle" x="3601.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_11&#45;&gt;aggregate_10_11 -->
<g id="edge698" class="edge">
<title>expert_10_11&#45;&gt;aggregate_10_11</title>
<path fill="none" stroke="black" d="M3601.5,-2175.85C3601.5,-2168.16 3601.5,-2159.35 3601.5,-2150.35"/>
<polygon fill="black" stroke="black" points="3605,-2150.16 3601.5,-2140.16 3598,-2150.16 3605,-2150.16"/>
</g>
<!-- attention_10_12 -->
<g id="node711" class="node">
<title>attention_10_12</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-1999.98 3517.5,-1999.98 3517.5,-1947.98 3685.5,-1947.98 3685.5,-1999.98"/>
<text text-anchor="middle" x="3601.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_10_L12</text>
<text text-anchor="middle" x="3601.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_11&#45;&gt;attention_10_12 -->
<g id="edge699" class="edge">
<title>aggregate_10_11&#45;&gt;attention_10_12</title>
<path fill="none" stroke="black" d="M3601.5,-2035.9C3601.5,-2027.23 3601.5,-2018.41 3601.5,-2010.27"/>
<polygon fill="black" stroke="black" points="3605,-2010.03 3601.5,-2000.03 3598,-2010.03 3605,-2010.03"/>
</g>
<!-- gate_10_12 -->
<g id="node712" class="node">
<title>gate_10_12</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-1911.98 3514.06,-1911.98 3453.49,-1807.98 3688.94,-1807.98 3749.51,-1911.98"/>
<text text-anchor="middle" x="3601.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_10_L12</text>
<text text-anchor="middle" x="3601.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_12&#45;&gt;gate_10_12 -->
<g id="edge700" class="edge">
<title>attention_10_12&#45;&gt;gate_10_12</title>
<path fill="none" stroke="black" d="M3601.5,-1947.85C3601.5,-1940.16 3601.5,-1931.35 3601.5,-1922.35"/>
<polygon fill="black" stroke="black" points="3605,-1922.16 3601.5,-1912.16 3598,-1922.16 3605,-1922.16"/>
</g>
<!-- expert_10_12 -->
<g id="node713" class="node">
<title>expert_10_12</title>
<polygon fill="lightgreen" stroke="black" points="3676,-1771.98 3527,-1771.98 3527,-1719.98 3676,-1719.98 3676,-1771.98"/>
<text text-anchor="middle" x="3601.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_10_L12</text>
<text text-anchor="middle" x="3601.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_12&#45;&gt;expert_10_12 -->
<g id="edge701" class="edge">
<title>gate_10_12&#45;&gt;expert_10_12</title>
<path fill="none" stroke="black" d="M3594.77,-1807.9C3594.69,-1799.23 3594.83,-1790.41 3595.18,-1782.27"/>
<polygon fill="black" stroke="black" points="3598.69,-1782.21 3595.77,-1772.03 3591.7,-1781.81 3598.69,-1782.21"/>
</g>
<!-- gate_10_12&#45;&gt;expert_10_12 -->
<g id="edge1229" class="edge">
<title>gate_10_12&#45;&gt;expert_10_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-1807.9C3608.31,-1799.23 3608.17,-1790.41 3607.82,-1782.27"/>
<polygon fill="red" stroke="red" points="3611.3,-1781.81 3607.23,-1772.03 3604.31,-1782.21 3611.3,-1781.81"/>
</g>
<!-- aggregate_10_12 -->
<g id="node714" class="node">
<title>aggregate_10_12</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-1683.98 3514.06,-1683.98 3453.49,-1579.98 3688.94,-1579.98 3749.51,-1683.98"/>
<text text-anchor="middle" x="3601.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L12</text>
<text text-anchor="middle" x="3601.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_12&#45;&gt;aggregate_10_12 -->
<g id="edge702" class="edge">
<title>expert_10_12&#45;&gt;aggregate_10_12</title>
<path fill="none" stroke="black" d="M3601.5,-1719.85C3601.5,-1712.16 3601.5,-1703.35 3601.5,-1694.35"/>
<polygon fill="black" stroke="black" points="3605,-1694.16 3601.5,-1684.16 3598,-1694.16 3605,-1694.16"/>
</g>
<!-- attention_10_13 -->
<g id="node715" class="node">
<title>attention_10_13</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-1543.98 3517.5,-1543.98 3517.5,-1491.98 3685.5,-1491.98 3685.5,-1543.98"/>
<text text-anchor="middle" x="3601.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_10_L13</text>
<text text-anchor="middle" x="3601.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_12&#45;&gt;attention_10_13 -->
<g id="edge703" class="edge">
<title>aggregate_10_12&#45;&gt;attention_10_13</title>
<path fill="none" stroke="black" d="M3601.5,-1579.9C3601.5,-1571.23 3601.5,-1562.41 3601.5,-1554.27"/>
<polygon fill="black" stroke="black" points="3605,-1554.03 3601.5,-1544.03 3598,-1554.03 3605,-1554.03"/>
</g>
<!-- gate_10_13 -->
<g id="node716" class="node">
<title>gate_10_13</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-1455.98 3514.06,-1455.98 3453.49,-1351.98 3688.94,-1351.98 3749.51,-1455.98"/>
<text text-anchor="middle" x="3601.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_10_L13</text>
<text text-anchor="middle" x="3601.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_13&#45;&gt;gate_10_13 -->
<g id="edge704" class="edge">
<title>attention_10_13&#45;&gt;gate_10_13</title>
<path fill="none" stroke="black" d="M3601.5,-1491.85C3601.5,-1484.16 3601.5,-1475.35 3601.5,-1466.35"/>
<polygon fill="black" stroke="black" points="3605,-1466.16 3601.5,-1456.16 3598,-1466.16 3605,-1466.16"/>
</g>
<!-- expert_10_13 -->
<g id="node717" class="node">
<title>expert_10_13</title>
<polygon fill="lightgreen" stroke="black" points="3676,-1315.98 3527,-1315.98 3527,-1263.98 3676,-1263.98 3676,-1315.98"/>
<text text-anchor="middle" x="3601.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_10_L13</text>
<text text-anchor="middle" x="3601.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_13&#45;&gt;expert_10_13 -->
<g id="edge705" class="edge">
<title>gate_10_13&#45;&gt;expert_10_13</title>
<path fill="none" stroke="black" d="M3594.77,-1351.9C3594.69,-1343.23 3594.83,-1334.41 3595.18,-1326.27"/>
<polygon fill="black" stroke="black" points="3598.69,-1326.21 3595.77,-1316.03 3591.7,-1325.81 3598.69,-1326.21"/>
</g>
<!-- gate_10_13&#45;&gt;expert_10_13 -->
<g id="edge1230" class="edge">
<title>gate_10_13&#45;&gt;expert_10_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-1351.9C3608.31,-1343.23 3608.17,-1334.41 3607.82,-1326.27"/>
<polygon fill="red" stroke="red" points="3611.3,-1325.81 3607.23,-1316.03 3604.31,-1326.21 3611.3,-1325.81"/>
</g>
<!-- aggregate_10_13 -->
<g id="node718" class="node">
<title>aggregate_10_13</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-1227.98 3514.06,-1227.98 3453.49,-1123.98 3688.94,-1123.98 3749.51,-1227.98"/>
<text text-anchor="middle" x="3601.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L13</text>
<text text-anchor="middle" x="3601.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_13&#45;&gt;aggregate_10_13 -->
<g id="edge706" class="edge">
<title>expert_10_13&#45;&gt;aggregate_10_13</title>
<path fill="none" stroke="black" d="M3601.5,-1263.85C3601.5,-1256.16 3601.5,-1247.35 3601.5,-1238.35"/>
<polygon fill="black" stroke="black" points="3605,-1238.16 3601.5,-1228.16 3598,-1238.16 3605,-1238.16"/>
</g>
<!-- attention_10_14 -->
<g id="node719" class="node">
<title>attention_10_14</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-1087.98 3517.5,-1087.98 3517.5,-1035.98 3685.5,-1035.98 3685.5,-1087.98"/>
<text text-anchor="middle" x="3601.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_10_L14</text>
<text text-anchor="middle" x="3601.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_13&#45;&gt;attention_10_14 -->
<g id="edge707" class="edge">
<title>aggregate_10_13&#45;&gt;attention_10_14</title>
<path fill="none" stroke="black" d="M3601.5,-1123.9C3601.5,-1115.23 3601.5,-1106.41 3601.5,-1098.27"/>
<polygon fill="black" stroke="black" points="3605,-1098.03 3601.5,-1088.03 3598,-1098.03 3605,-1098.03"/>
</g>
<!-- gate_10_14 -->
<g id="node720" class="node">
<title>gate_10_14</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-999.98 3514.06,-999.98 3453.49,-895.98 3688.94,-895.98 3749.51,-999.98"/>
<text text-anchor="middle" x="3601.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_10_L14</text>
<text text-anchor="middle" x="3601.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_14&#45;&gt;gate_10_14 -->
<g id="edge708" class="edge">
<title>attention_10_14&#45;&gt;gate_10_14</title>
<path fill="none" stroke="black" d="M3601.5,-1035.85C3601.5,-1028.16 3601.5,-1019.35 3601.5,-1010.35"/>
<polygon fill="black" stroke="black" points="3605,-1010.16 3601.5,-1000.16 3598,-1010.16 3605,-1010.16"/>
</g>
<!-- expert_10_14 -->
<g id="node721" class="node">
<title>expert_10_14</title>
<polygon fill="lightgreen" stroke="black" points="3676,-859.98 3527,-859.98 3527,-807.98 3676,-807.98 3676,-859.98"/>
<text text-anchor="middle" x="3601.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_10_L14</text>
<text text-anchor="middle" x="3601.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_14&#45;&gt;expert_10_14 -->
<g id="edge709" class="edge">
<title>gate_10_14&#45;&gt;expert_10_14</title>
<path fill="none" stroke="black" d="M3594.77,-895.9C3594.69,-887.23 3594.83,-878.41 3595.18,-870.27"/>
<polygon fill="black" stroke="black" points="3598.69,-870.21 3595.77,-860.03 3591.7,-869.81 3598.69,-870.21"/>
</g>
<!-- gate_10_14&#45;&gt;expert_10_14 -->
<g id="edge1231" class="edge">
<title>gate_10_14&#45;&gt;expert_10_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-895.9C3608.31,-887.23 3608.17,-878.41 3607.82,-870.27"/>
<polygon fill="red" stroke="red" points="3611.3,-869.81 3607.23,-860.03 3604.31,-870.21 3611.3,-869.81"/>
</g>
<!-- aggregate_10_14 -->
<g id="node722" class="node">
<title>aggregate_10_14</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-771.98 3514.06,-771.98 3453.49,-667.98 3688.94,-667.98 3749.51,-771.98"/>
<text text-anchor="middle" x="3601.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L14</text>
<text text-anchor="middle" x="3601.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_14&#45;&gt;aggregate_10_14 -->
<g id="edge710" class="edge">
<title>expert_10_14&#45;&gt;aggregate_10_14</title>
<path fill="none" stroke="black" d="M3601.5,-807.85C3601.5,-800.16 3601.5,-791.35 3601.5,-782.35"/>
<polygon fill="black" stroke="black" points="3605,-782.16 3601.5,-772.16 3598,-782.16 3605,-782.16"/>
</g>
<!-- attention_10_15 -->
<g id="node723" class="node">
<title>attention_10_15</title>
<polygon fill="lightgreen" stroke="black" points="3685.5,-631.98 3517.5,-631.98 3517.5,-579.98 3685.5,-579.98 3685.5,-631.98"/>
<text text-anchor="middle" x="3601.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_10_L15</text>
<text text-anchor="middle" x="3601.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3601.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3601.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_10_14&#45;&gt;attention_10_15 -->
<g id="edge711" class="edge">
<title>aggregate_10_14&#45;&gt;attention_10_15</title>
<path fill="none" stroke="black" d="M3601.5,-667.9C3601.5,-659.23 3601.5,-650.41 3601.5,-642.27"/>
<polygon fill="black" stroke="black" points="3605,-642.03 3601.5,-632.03 3598,-642.03 3605,-642.03"/>
</g>
<!-- gate_10_15 -->
<g id="node724" class="node">
<title>gate_10_15</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-543.98 3514.06,-543.98 3453.49,-439.98 3688.94,-439.98 3749.51,-543.98"/>
<text text-anchor="middle" x="3601.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_10_L15</text>
<text text-anchor="middle" x="3601.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3601.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_10_15&#45;&gt;gate_10_15 -->
<g id="edge712" class="edge">
<title>attention_10_15&#45;&gt;gate_10_15</title>
<path fill="none" stroke="black" d="M3601.5,-579.85C3601.5,-572.16 3601.5,-563.35 3601.5,-554.35"/>
<polygon fill="black" stroke="black" points="3605,-554.16 3601.5,-544.16 3598,-554.16 3605,-554.16"/>
</g>
<!-- expert_10_15 -->
<g id="node725" class="node">
<title>expert_10_15</title>
<polygon fill="lightgreen" stroke="black" points="3676,-403.98 3527,-403.98 3527,-351.98 3676,-351.98 3676,-403.98"/>
<text text-anchor="middle" x="3601.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_10_L15</text>
<text text-anchor="middle" x="3601.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=10</text>
<text text-anchor="middle" x="3601.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_10_15&#45;&gt;expert_10_15 -->
<g id="edge713" class="edge">
<title>gate_10_15&#45;&gt;expert_10_15</title>
<path fill="none" stroke="black" d="M3594.77,-439.9C3594.69,-431.23 3594.83,-422.41 3595.18,-414.27"/>
<polygon fill="black" stroke="black" points="3598.69,-414.21 3595.77,-404.03 3591.7,-413.81 3598.69,-414.21"/>
</g>
<!-- gate_10_15&#45;&gt;expert_10_15 -->
<g id="edge1232" class="edge">
<title>gate_10_15&#45;&gt;expert_10_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3608.23,-439.9C3608.31,-431.23 3608.17,-422.41 3607.82,-414.27"/>
<polygon fill="red" stroke="red" points="3611.3,-413.81 3607.23,-404.03 3604.31,-414.21 3611.3,-413.81"/>
</g>
<!-- aggregate_10_15 -->
<g id="node726" class="node">
<title>aggregate_10_15</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-315.98 3514.06,-315.98 3453.49,-211.98 3688.94,-211.98 3749.51,-315.98"/>
<text text-anchor="middle" x="3601.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_10_L15</text>
<text text-anchor="middle" x="3601.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3601.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3601.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_10_15&#45;&gt;aggregate_10_15 -->
<g id="edge714" class="edge">
<title>expert_10_15&#45;&gt;aggregate_10_15</title>
<path fill="none" stroke="black" d="M3601.5,-351.85C3601.5,-344.16 3601.5,-335.35 3601.5,-326.35"/>
<polygon fill="black" stroke="black" points="3605,-326.16 3601.5,-316.16 3598,-326.16 3605,-326.16"/>
</g>
<!-- collect_10 -->
<g id="node727" class="node">
<title>collect_10</title>
<polygon fill="lightyellow" stroke="black" points="3749.51,-175.98 3514.06,-175.98 3453.49,-93.98 3688.94,-93.98 3749.51,-175.98"/>
<text text-anchor="middle" x="3601.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_10</text>
<text text-anchor="middle" x="3601.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3601.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_10_15&#45;&gt;collect_10 -->
<g id="edge715" class="edge">
<title>aggregate_10_15&#45;&gt;collect_10</title>
<path fill="none" stroke="black" d="M3601.5,-211.69C3601.5,-203.27 3601.5,-194.56 3601.5,-186.17"/>
<polygon fill="black" stroke="black" points="3605,-186.14 3601.5,-176.14 3598,-186.14 3605,-186.14"/>
</g>
<!-- collect_10&#45;&gt;output -->
<g id="edge1051" class="edge">
<title>collect_10&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3454.9,-96.09C3451.07,-95.35 3447.26,-94.65 3443.5,-93.98 3269.97,-63.37 3066.77,-46.01 2939.08,-37.3"/>
<polygon fill="black" stroke="black" points="2939.08,-33.79 2928.87,-36.61 2938.61,-40.78 2939.08,-33.79"/>
</g>
<!-- distribute_11 -->
<g id="node728" class="node">
<title>distribute_11</title>
<polygon fill="lightyellow" stroke="black" points="4090.73,-7589.98 3850.16,-7589.98 3788.27,-7507.98 4028.85,-7507.98 4090.73,-7589.98"/>
<text text-anchor="middle" x="3939.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_11</text>
<text text-anchor="middle" x="3939.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="3939.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_0 -->
<g id="node729" class="node">
<title>attention_11_0</title>
<polygon fill="lightgreen" stroke="black" points="4019.5,-7471.98 3851.5,-7471.98 3851.5,-7419.98 4019.5,-7419.98 4019.5,-7471.98"/>
<text text-anchor="middle" x="3935.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_11_L0</text>
<text text-anchor="middle" x="3935.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3935.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3935.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_11&#45;&gt;attention_11_0 -->
<g id="edge716" class="edge">
<title>distribute_11&#45;&gt;attention_11_0</title>
<path fill="none" stroke="black" d="M3937.91,-7507.77C3937.57,-7499.34 3937.22,-7490.51 3936.9,-7482.27"/>
<polygon fill="black" stroke="black" points="3940.39,-7482.09 3936.5,-7472.23 3933.4,-7482.36 3940.39,-7482.09"/>
</g>
<!-- gate_11_0 -->
<g id="node730" class="node">
<title>gate_11_0</title>
<polygon fill="lightyellow" stroke="black" points="4083.51,-7383.98 3848.06,-7383.98 3787.49,-7279.98 4022.94,-7279.98 4083.51,-7383.98"/>
<text text-anchor="middle" x="3935.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_11_L0</text>
<text text-anchor="middle" x="3935.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3935.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3935.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_0&#45;&gt;gate_11_0 -->
<g id="edge717" class="edge">
<title>attention_11_0&#45;&gt;gate_11_0</title>
<path fill="none" stroke="black" d="M3935.5,-7419.85C3935.5,-7412.16 3935.5,-7403.35 3935.5,-7394.35"/>
<polygon fill="black" stroke="black" points="3939,-7394.16 3935.5,-7384.16 3932,-7394.16 3939,-7394.16"/>
</g>
<!-- expert_11_0 -->
<g id="node731" class="node">
<title>expert_11_0</title>
<polygon fill="lightgreen" stroke="black" points="4009,-7243.98 3860,-7243.98 3860,-7191.98 4009,-7191.98 4009,-7243.98"/>
<text text-anchor="middle" x="3934.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_11_L0</text>
<text text-anchor="middle" x="3934.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3934.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3934.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_0&#45;&gt;expert_11_0 -->
<g id="edge718" class="edge">
<title>gate_11_0&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" d="M3928.32,-7279.9C3928.16,-7271.23 3928.22,-7262.41 3928.49,-7254.27"/>
<polygon fill="black" stroke="black" points="3932,-7254.18 3928.99,-7244.03 3925.01,-7253.85 3932,-7254.18"/>
</g>
<!-- gate_11_0&#45;&gt;expert_11_0 -->
<g id="edge1233" class="edge">
<title>gate_11_0&#45;&gt;expert_11_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3941.77,-7279.9C3941.78,-7271.23 3941.56,-7262.41 3941.14,-7254.27"/>
<polygon fill="red" stroke="red" points="3944.61,-7253.77 3940.46,-7244.03 3937.63,-7254.24 3944.61,-7253.77"/>
</g>
<!-- aggregate_11_0 -->
<g id="node732" class="node">
<title>aggregate_11_0</title>
<polygon fill="lightyellow" stroke="black" points="4082.51,-7155.98 3847.06,-7155.98 3786.49,-7051.98 4021.94,-7051.98 4082.51,-7155.98"/>
<text text-anchor="middle" x="3934.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L0</text>
<text text-anchor="middle" x="3934.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3934.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3934.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_0&#45;&gt;aggregate_11_0 -->
<g id="edge719" class="edge">
<title>expert_11_0&#45;&gt;aggregate_11_0</title>
<path fill="none" stroke="black" d="M3934.5,-7191.85C3934.5,-7184.16 3934.5,-7175.35 3934.5,-7166.35"/>
<polygon fill="black" stroke="black" points="3938,-7166.16 3934.5,-7156.16 3931,-7166.16 3938,-7166.16"/>
</g>
<!-- attention_11_1 -->
<g id="node733" class="node">
<title>attention_11_1</title>
<polygon fill="lightgreen" stroke="black" points="4018.5,-7015.98 3850.5,-7015.98 3850.5,-6963.98 4018.5,-6963.98 4018.5,-7015.98"/>
<text text-anchor="middle" x="3934.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_11_L1</text>
<text text-anchor="middle" x="3934.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3934.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3934.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_0&#45;&gt;attention_11_1 -->
<g id="edge720" class="edge">
<title>aggregate_11_0&#45;&gt;attention_11_1</title>
<path fill="none" stroke="black" d="M3934.5,-7051.9C3934.5,-7043.23 3934.5,-7034.41 3934.5,-7026.27"/>
<polygon fill="black" stroke="black" points="3938,-7026.03 3934.5,-7016.03 3931,-7026.03 3938,-7026.03"/>
</g>
<!-- gate_11_1 -->
<g id="node734" class="node">
<title>gate_11_1</title>
<polygon fill="lightyellow" stroke="black" points="4080.51,-6927.98 3845.06,-6927.98 3784.49,-6823.98 4019.94,-6823.98 4080.51,-6927.98"/>
<text text-anchor="middle" x="3932.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_11_L1</text>
<text text-anchor="middle" x="3932.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3932.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3932.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_1&#45;&gt;gate_11_1 -->
<g id="edge721" class="edge">
<title>attention_11_1&#45;&gt;gate_11_1</title>
<path fill="none" stroke="black" d="M3934.05,-6963.85C3933.91,-6956.16 3933.76,-6947.35 3933.6,-6938.35"/>
<polygon fill="black" stroke="black" points="3937.09,-6938.1 3933.41,-6928.16 3930.09,-6938.22 3937.09,-6938.1"/>
</g>
<!-- expert_11_1 -->
<g id="node735" class="node">
<title>expert_11_1</title>
<polygon fill="lightgreen" stroke="black" points="4006,-6787.98 3857,-6787.98 3857,-6735.98 4006,-6735.98 4006,-6787.98"/>
<text text-anchor="middle" x="3931.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_11_L1</text>
<text text-anchor="middle" x="3931.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3931.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3931.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_1&#45;&gt;expert_11_1 -->
<g id="edge722" class="edge">
<title>gate_11_1&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" d="M3925.32,-6823.9C3925.16,-6815.23 3925.22,-6806.41 3925.49,-6798.27"/>
<polygon fill="black" stroke="black" points="3929,-6798.18 3925.99,-6788.03 3922.01,-6797.85 3929,-6798.18"/>
</g>
<!-- gate_11_1&#45;&gt;expert_11_1 -->
<g id="edge1234" class="edge">
<title>gate_11_1&#45;&gt;expert_11_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3938.77,-6823.9C3938.78,-6815.23 3938.56,-6806.41 3938.14,-6798.27"/>
<polygon fill="red" stroke="red" points="3941.61,-6797.77 3937.46,-6788.03 3934.63,-6798.24 3941.61,-6797.77"/>
</g>
<!-- aggregate_11_1 -->
<g id="node736" class="node">
<title>aggregate_11_1</title>
<polygon fill="lightyellow" stroke="black" points="4079.51,-6699.98 3844.06,-6699.98 3783.49,-6595.98 4018.94,-6595.98 4079.51,-6699.98"/>
<text text-anchor="middle" x="3931.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L1</text>
<text text-anchor="middle" x="3931.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3931.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3931.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_1&#45;&gt;aggregate_11_1 -->
<g id="edge723" class="edge">
<title>expert_11_1&#45;&gt;aggregate_11_1</title>
<path fill="none" stroke="black" d="M3931.5,-6735.85C3931.5,-6728.16 3931.5,-6719.35 3931.5,-6710.35"/>
<polygon fill="black" stroke="black" points="3935,-6710.16 3931.5,-6700.16 3928,-6710.16 3935,-6710.16"/>
</g>
<!-- attention_11_2 -->
<g id="node737" class="node">
<title>attention_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4014.5,-6559.98 3846.5,-6559.98 3846.5,-6507.98 4014.5,-6507.98 4014.5,-6559.98"/>
<text text-anchor="middle" x="3930.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_11_L2</text>
<text text-anchor="middle" x="3930.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3930.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3930.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_1&#45;&gt;attention_11_2 -->
<g id="edge724" class="edge">
<title>aggregate_11_1&#45;&gt;attention_11_2</title>
<path fill="none" stroke="black" d="M3931.04,-6595.9C3930.97,-6587.23 3930.89,-6578.41 3930.82,-6570.27"/>
<polygon fill="black" stroke="black" points="3934.31,-6569.99 3930.72,-6560.03 3927.31,-6570.06 3934.31,-6569.99"/>
</g>
<!-- gate_11_2 -->
<g id="node738" class="node">
<title>gate_11_2</title>
<polygon fill="lightyellow" stroke="black" points="4076.51,-6471.98 3841.06,-6471.98 3780.49,-6367.98 4015.94,-6367.98 4076.51,-6471.98"/>
<text text-anchor="middle" x="3928.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_11_L2</text>
<text text-anchor="middle" x="3928.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3928.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3928.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_2&#45;&gt;gate_11_2 -->
<g id="edge725" class="edge">
<title>attention_11_2&#45;&gt;gate_11_2</title>
<path fill="none" stroke="black" d="M3930.05,-6507.85C3929.91,-6500.16 3929.76,-6491.35 3929.6,-6482.35"/>
<polygon fill="black" stroke="black" points="3933.09,-6482.1 3929.41,-6472.16 3926.09,-6482.22 3933.09,-6482.1"/>
</g>
<!-- expert_11_2 -->
<g id="node739" class="node">
<title>expert_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4003,-6331.98 3854,-6331.98 3854,-6279.98 4003,-6279.98 4003,-6331.98"/>
<text text-anchor="middle" x="3928.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_11_L2</text>
<text text-anchor="middle" x="3928.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3928.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3928.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_2&#45;&gt;expert_11_2 -->
<g id="edge726" class="edge">
<title>gate_11_2&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" d="M3921.77,-6367.9C3921.69,-6359.23 3921.83,-6350.41 3922.18,-6342.27"/>
<polygon fill="black" stroke="black" points="3925.69,-6342.21 3922.77,-6332.03 3918.7,-6341.81 3925.69,-6342.21"/>
</g>
<!-- gate_11_2&#45;&gt;expert_11_2 -->
<g id="edge1235" class="edge">
<title>gate_11_2&#45;&gt;expert_11_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3935.23,-6367.9C3935.31,-6359.23 3935.17,-6350.41 3934.82,-6342.27"/>
<polygon fill="red" stroke="red" points="3938.3,-6341.81 3934.23,-6332.03 3931.31,-6342.21 3938.3,-6341.81"/>
</g>
<!-- aggregate_11_2 -->
<g id="node740" class="node">
<title>aggregate_11_2</title>
<polygon fill="lightyellow" stroke="black" points="4076.51,-6243.98 3841.06,-6243.98 3780.49,-6139.98 4015.94,-6139.98 4076.51,-6243.98"/>
<text text-anchor="middle" x="3928.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L2</text>
<text text-anchor="middle" x="3928.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3928.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3928.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_2&#45;&gt;aggregate_11_2 -->
<g id="edge727" class="edge">
<title>expert_11_2&#45;&gt;aggregate_11_2</title>
<path fill="none" stroke="black" d="M3928.5,-6279.85C3928.5,-6272.16 3928.5,-6263.35 3928.5,-6254.35"/>
<polygon fill="black" stroke="black" points="3932,-6254.16 3928.5,-6244.16 3925,-6254.16 3932,-6254.16"/>
</g>
<!-- attention_11_3 -->
<g id="node741" class="node">
<title>attention_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4012.5,-6103.98 3844.5,-6103.98 3844.5,-6051.98 4012.5,-6051.98 4012.5,-6103.98"/>
<text text-anchor="middle" x="3928.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_11_L3</text>
<text text-anchor="middle" x="3928.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3928.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3928.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_2&#45;&gt;attention_11_3 -->
<g id="edge728" class="edge">
<title>aggregate_11_2&#45;&gt;attention_11_3</title>
<path fill="none" stroke="black" d="M3928.5,-6139.9C3928.5,-6131.23 3928.5,-6122.41 3928.5,-6114.27"/>
<polygon fill="black" stroke="black" points="3932,-6114.03 3928.5,-6104.03 3925,-6114.03 3932,-6114.03"/>
</g>
<!-- gate_11_3 -->
<g id="node742" class="node">
<title>gate_11_3</title>
<polygon fill="lightyellow" stroke="black" points="4076.51,-6015.98 3841.06,-6015.98 3780.49,-5911.98 4015.94,-5911.98 4076.51,-6015.98"/>
<text text-anchor="middle" x="3928.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_11_L3</text>
<text text-anchor="middle" x="3928.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3928.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3928.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_3&#45;&gt;gate_11_3 -->
<g id="edge729" class="edge">
<title>attention_11_3&#45;&gt;gate_11_3</title>
<path fill="none" stroke="black" d="M3928.5,-6051.85C3928.5,-6044.16 3928.5,-6035.35 3928.5,-6026.35"/>
<polygon fill="black" stroke="black" points="3932,-6026.16 3928.5,-6016.16 3925,-6026.16 3932,-6026.16"/>
</g>
<!-- expert_11_3 -->
<g id="node743" class="node">
<title>expert_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4000,-5875.98 3851,-5875.98 3851,-5823.98 4000,-5823.98 4000,-5875.98"/>
<text text-anchor="middle" x="3925.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_11_L3</text>
<text text-anchor="middle" x="3925.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3925.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3925.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_3&#45;&gt;expert_11_3 -->
<g id="edge730" class="edge">
<title>gate_11_3&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" d="M3920.41,-5911.9C3920.09,-5903.23 3919.99,-5894.41 3920.12,-5886.27"/>
<polygon fill="black" stroke="black" points="3923.63,-5886.13 3920.44,-5876.03 3916.63,-5885.91 3923.63,-5886.13"/>
</g>
<!-- gate_11_3&#45;&gt;expert_11_3 -->
<g id="edge1236" class="edge">
<title>gate_11_3&#45;&gt;expert_11_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3933.86,-5911.9C3933.71,-5903.14 3933.33,-5894.21 3932.75,-5885.99"/>
<polygon fill="red" stroke="red" points="3936.24,-5885.7 3931.91,-5876.03 3929.26,-5886.29 3936.24,-5885.7"/>
</g>
<!-- aggregate_11_3 -->
<g id="node744" class="node">
<title>aggregate_11_3</title>
<polygon fill="lightyellow" stroke="black" points="4073.51,-5787.98 3838.06,-5787.98 3777.49,-5683.98 4012.94,-5683.98 4073.51,-5787.98"/>
<text text-anchor="middle" x="3925.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L3</text>
<text text-anchor="middle" x="3925.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3925.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3925.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_3&#45;&gt;aggregate_11_3 -->
<g id="edge731" class="edge">
<title>expert_11_3&#45;&gt;aggregate_11_3</title>
<path fill="none" stroke="black" d="M3925.5,-5823.85C3925.5,-5816.16 3925.5,-5807.35 3925.5,-5798.35"/>
<polygon fill="black" stroke="black" points="3929,-5798.16 3925.5,-5788.16 3922,-5798.16 3929,-5798.16"/>
</g>
<!-- attention_11_4 -->
<g id="node745" class="node">
<title>attention_11_4</title>
<polygon fill="lightgreen" stroke="black" points="4008.5,-5647.98 3840.5,-5647.98 3840.5,-5595.98 4008.5,-5595.98 4008.5,-5647.98"/>
<text text-anchor="middle" x="3924.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_11_L4</text>
<text text-anchor="middle" x="3924.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3924.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3924.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_3&#45;&gt;attention_11_4 -->
<g id="edge732" class="edge">
<title>aggregate_11_3&#45;&gt;attention_11_4</title>
<path fill="none" stroke="black" d="M3925.04,-5683.9C3924.97,-5675.23 3924.89,-5666.41 3924.82,-5658.27"/>
<polygon fill="black" stroke="black" points="3928.31,-5657.99 3924.72,-5648.03 3921.31,-5658.06 3928.31,-5657.99"/>
</g>
<!-- gate_11_4 -->
<g id="node746" class="node">
<title>gate_11_4</title>
<polygon fill="lightyellow" stroke="black" points="4072.51,-5559.98 3837.06,-5559.98 3776.49,-5455.98 4011.94,-5455.98 4072.51,-5559.98"/>
<text text-anchor="middle" x="3924.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_11_L4</text>
<text text-anchor="middle" x="3924.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3924.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3924.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_4&#45;&gt;gate_11_4 -->
<g id="edge733" class="edge">
<title>attention_11_4&#45;&gt;gate_11_4</title>
<path fill="none" stroke="black" d="M3924.5,-5595.85C3924.5,-5588.16 3924.5,-5579.35 3924.5,-5570.35"/>
<polygon fill="black" stroke="black" points="3928,-5570.16 3924.5,-5560.16 3921,-5570.16 3928,-5570.16"/>
</g>
<!-- expert_11_4 -->
<g id="node747" class="node">
<title>expert_11_4</title>
<polygon fill="lightgreen" stroke="black" points="3998,-5419.98 3849,-5419.98 3849,-5367.98 3998,-5367.98 3998,-5419.98"/>
<text text-anchor="middle" x="3923.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_11_L4</text>
<text text-anchor="middle" x="3923.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3923.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3923.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_4&#45;&gt;expert_11_4 -->
<g id="edge734" class="edge">
<title>gate_11_4&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" d="M3917.32,-5455.9C3917.16,-5447.23 3917.22,-5438.41 3917.49,-5430.27"/>
<polygon fill="black" stroke="black" points="3921,-5430.18 3917.99,-5420.03 3914.01,-5429.85 3921,-5430.18"/>
</g>
<!-- gate_11_4&#45;&gt;expert_11_4 -->
<g id="edge1237" class="edge">
<title>gate_11_4&#45;&gt;expert_11_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3930.77,-5455.9C3930.78,-5447.23 3930.56,-5438.41 3930.14,-5430.27"/>
<polygon fill="red" stroke="red" points="3933.61,-5429.77 3929.46,-5420.03 3926.63,-5430.24 3933.61,-5429.77"/>
</g>
<!-- aggregate_11_4 -->
<g id="node748" class="node">
<title>aggregate_11_4</title>
<polygon fill="lightyellow" stroke="black" points="4071.51,-5331.98 3836.06,-5331.98 3775.49,-5227.98 4010.94,-5227.98 4071.51,-5331.98"/>
<text text-anchor="middle" x="3923.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L4</text>
<text text-anchor="middle" x="3923.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3923.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3923.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_4&#45;&gt;aggregate_11_4 -->
<g id="edge735" class="edge">
<title>expert_11_4&#45;&gt;aggregate_11_4</title>
<path fill="none" stroke="black" d="M3923.5,-5367.85C3923.5,-5360.16 3923.5,-5351.35 3923.5,-5342.35"/>
<polygon fill="black" stroke="black" points="3927,-5342.16 3923.5,-5332.16 3920,-5342.16 3927,-5342.16"/>
</g>
<!-- attention_11_5 -->
<g id="node749" class="node">
<title>attention_11_5</title>
<polygon fill="lightgreen" stroke="black" points="4004.5,-5191.98 3836.5,-5191.98 3836.5,-5139.98 4004.5,-5139.98 4004.5,-5191.98"/>
<text text-anchor="middle" x="3920.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_11_L5</text>
<text text-anchor="middle" x="3920.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3920.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3920.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_4&#45;&gt;attention_11_5 -->
<g id="edge736" class="edge">
<title>aggregate_11_4&#45;&gt;attention_11_5</title>
<path fill="none" stroke="black" d="M3922.13,-5227.9C3921.9,-5219.23 3921.66,-5210.41 3921.45,-5202.27"/>
<polygon fill="black" stroke="black" points="3924.94,-5201.93 3921.17,-5192.03 3917.94,-5202.12 3924.94,-5201.93"/>
</g>
<!-- gate_11_5 -->
<g id="node750" class="node">
<title>gate_11_5</title>
<polygon fill="lightyellow" stroke="black" points="4068.51,-5103.98 3833.06,-5103.98 3772.49,-4999.98 4007.94,-4999.98 4068.51,-5103.98"/>
<text text-anchor="middle" x="3920.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_11_L5</text>
<text text-anchor="middle" x="3920.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3920.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3920.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_5&#45;&gt;gate_11_5 -->
<g id="edge737" class="edge">
<title>attention_11_5&#45;&gt;gate_11_5</title>
<path fill="none" stroke="black" d="M3920.5,-5139.85C3920.5,-5132.16 3920.5,-5123.35 3920.5,-5114.35"/>
<polygon fill="black" stroke="black" points="3924,-5114.16 3920.5,-5104.16 3917,-5114.16 3924,-5114.16"/>
</g>
<!-- expert_11_5 -->
<g id="node751" class="node">
<title>expert_11_5</title>
<polygon fill="lightgreen" stroke="black" points="3994,-4963.98 3845,-4963.98 3845,-4911.98 3994,-4911.98 3994,-4963.98"/>
<text text-anchor="middle" x="3919.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_11_L5</text>
<text text-anchor="middle" x="3919.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3919.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3919.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_5&#45;&gt;expert_11_5 -->
<g id="edge738" class="edge">
<title>gate_11_5&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" d="M3913.32,-4999.9C3913.16,-4991.23 3913.22,-4982.41 3913.49,-4974.27"/>
<polygon fill="black" stroke="black" points="3917,-4974.18 3913.99,-4964.03 3910.01,-4973.85 3917,-4974.18"/>
</g>
<!-- gate_11_5&#45;&gt;expert_11_5 -->
<g id="edge1238" class="edge">
<title>gate_11_5&#45;&gt;expert_11_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3926.77,-4999.9C3926.78,-4991.23 3926.56,-4982.41 3926.14,-4974.27"/>
<polygon fill="red" stroke="red" points="3929.61,-4973.77 3925.46,-4964.03 3922.63,-4974.24 3929.61,-4973.77"/>
</g>
<!-- aggregate_11_5 -->
<g id="node752" class="node">
<title>aggregate_11_5</title>
<polygon fill="lightyellow" stroke="black" points="4067.51,-4875.98 3832.06,-4875.98 3771.49,-4771.98 4006.94,-4771.98 4067.51,-4875.98"/>
<text text-anchor="middle" x="3919.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L5</text>
<text text-anchor="middle" x="3919.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3919.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3919.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_5&#45;&gt;aggregate_11_5 -->
<g id="edge739" class="edge">
<title>expert_11_5&#45;&gt;aggregate_11_5</title>
<path fill="none" stroke="black" d="M3919.5,-4911.85C3919.5,-4904.16 3919.5,-4895.35 3919.5,-4886.35"/>
<polygon fill="black" stroke="black" points="3923,-4886.16 3919.5,-4876.16 3916,-4886.16 3923,-4886.16"/>
</g>
<!-- attention_11_6 -->
<g id="node753" class="node">
<title>attention_11_6</title>
<polygon fill="lightgreen" stroke="black" points="4002.5,-4735.98 3834.5,-4735.98 3834.5,-4683.98 4002.5,-4683.98 4002.5,-4735.98"/>
<text text-anchor="middle" x="3918.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_11_L6</text>
<text text-anchor="middle" x="3918.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3918.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3918.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_5&#45;&gt;attention_11_6 -->
<g id="edge740" class="edge">
<title>aggregate_11_5&#45;&gt;attention_11_6</title>
<path fill="none" stroke="black" d="M3919.04,-4771.9C3918.97,-4763.23 3918.89,-4754.41 3918.82,-4746.27"/>
<polygon fill="black" stroke="black" points="3922.31,-4745.99 3918.72,-4736.03 3915.31,-4746.06 3922.31,-4745.99"/>
</g>
<!-- gate_11_6 -->
<g id="node754" class="node">
<title>gate_11_6</title>
<polygon fill="lightyellow" stroke="black" points="4066.51,-4647.98 3831.06,-4647.98 3770.49,-4543.98 4005.94,-4543.98 4066.51,-4647.98"/>
<text text-anchor="middle" x="3918.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_11_L6</text>
<text text-anchor="middle" x="3918.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3918.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3918.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_6&#45;&gt;gate_11_6 -->
<g id="edge741" class="edge">
<title>attention_11_6&#45;&gt;gate_11_6</title>
<path fill="none" stroke="black" d="M3918.5,-4683.85C3918.5,-4676.16 3918.5,-4667.35 3918.5,-4658.35"/>
<polygon fill="black" stroke="black" points="3922,-4658.16 3918.5,-4648.16 3915,-4658.16 3922,-4658.16"/>
</g>
<!-- expert_11_6 -->
<g id="node755" class="node">
<title>expert_11_6</title>
<polygon fill="lightgreen" stroke="black" points="3992,-4507.98 3843,-4507.98 3843,-4455.98 3992,-4455.98 3992,-4507.98"/>
<text text-anchor="middle" x="3917.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_11_L6</text>
<text text-anchor="middle" x="3917.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3917.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3917.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_6&#45;&gt;expert_11_6 -->
<g id="edge742" class="edge">
<title>gate_11_6&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" d="M3911.32,-4543.9C3911.16,-4535.23 3911.22,-4526.41 3911.49,-4518.27"/>
<polygon fill="black" stroke="black" points="3915,-4518.18 3911.99,-4508.03 3908.01,-4517.85 3915,-4518.18"/>
</g>
<!-- gate_11_6&#45;&gt;expert_11_6 -->
<g id="edge1239" class="edge">
<title>gate_11_6&#45;&gt;expert_11_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3924.77,-4543.9C3924.78,-4535.23 3924.56,-4526.41 3924.14,-4518.27"/>
<polygon fill="red" stroke="red" points="3927.61,-4517.77 3923.46,-4508.03 3920.63,-4518.24 3927.61,-4517.77"/>
</g>
<!-- aggregate_11_6 -->
<g id="node756" class="node">
<title>aggregate_11_6</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-4419.98 3829.06,-4419.98 3768.49,-4315.98 4003.94,-4315.98 4064.51,-4419.98"/>
<text text-anchor="middle" x="3916.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L6</text>
<text text-anchor="middle" x="3916.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_6&#45;&gt;aggregate_11_6 -->
<g id="edge743" class="edge">
<title>expert_11_6&#45;&gt;aggregate_11_6</title>
<path fill="none" stroke="black" d="M3917.28,-4455.85C3917.21,-4448.16 3917.13,-4439.35 3917.05,-4430.35"/>
<polygon fill="black" stroke="black" points="3920.55,-4430.13 3916.96,-4420.16 3913.55,-4430.19 3920.55,-4430.13"/>
</g>
<!-- attention_11_7 -->
<g id="node757" class="node">
<title>attention_11_7</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-4279.98 3832.5,-4279.98 3832.5,-4227.98 4000.5,-4227.98 4000.5,-4279.98"/>
<text text-anchor="middle" x="3916.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_11_L7</text>
<text text-anchor="middle" x="3916.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_6&#45;&gt;attention_11_7 -->
<g id="edge744" class="edge">
<title>aggregate_11_6&#45;&gt;attention_11_7</title>
<path fill="none" stroke="black" d="M3916.5,-4315.9C3916.5,-4307.23 3916.5,-4298.41 3916.5,-4290.27"/>
<polygon fill="black" stroke="black" points="3920,-4290.03 3916.5,-4280.03 3913,-4290.03 3920,-4290.03"/>
</g>
<!-- gate_11_7 -->
<g id="node758" class="node">
<title>gate_11_7</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-4191.98 3829.06,-4191.98 3768.49,-4087.98 4003.94,-4087.98 4064.51,-4191.98"/>
<text text-anchor="middle" x="3916.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_11_L7</text>
<text text-anchor="middle" x="3916.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_7&#45;&gt;gate_11_7 -->
<g id="edge745" class="edge">
<title>attention_11_7&#45;&gt;gate_11_7</title>
<path fill="none" stroke="black" d="M3916.5,-4227.85C3916.5,-4220.16 3916.5,-4211.35 3916.5,-4202.35"/>
<polygon fill="black" stroke="black" points="3920,-4202.16 3916.5,-4192.16 3913,-4202.16 3920,-4202.16"/>
</g>
<!-- expert_11_7 -->
<g id="node759" class="node">
<title>expert_11_7</title>
<polygon fill="lightgreen" stroke="black" points="3991,-4051.98 3842,-4051.98 3842,-3999.98 3991,-3999.98 3991,-4051.98"/>
<text text-anchor="middle" x="3916.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_11_L7</text>
<text text-anchor="middle" x="3916.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_7&#45;&gt;expert_11_7 -->
<g id="edge746" class="edge">
<title>gate_11_7&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" d="M3909.77,-4087.9C3909.69,-4079.23 3909.83,-4070.41 3910.18,-4062.27"/>
<polygon fill="black" stroke="black" points="3913.69,-4062.21 3910.77,-4052.03 3906.7,-4061.81 3913.69,-4062.21"/>
</g>
<!-- gate_11_7&#45;&gt;expert_11_7 -->
<g id="edge1240" class="edge">
<title>gate_11_7&#45;&gt;expert_11_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-4087.9C3923.31,-4079.23 3923.17,-4070.41 3922.82,-4062.27"/>
<polygon fill="red" stroke="red" points="3926.3,-4061.81 3922.23,-4052.03 3919.31,-4062.21 3926.3,-4061.81"/>
</g>
<!-- aggregate_11_7 -->
<g id="node760" class="node">
<title>aggregate_11_7</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-3963.98 3829.06,-3963.98 3768.49,-3859.98 4003.94,-3859.98 4064.51,-3963.98"/>
<text text-anchor="middle" x="3916.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L7</text>
<text text-anchor="middle" x="3916.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_7&#45;&gt;aggregate_11_7 -->
<g id="edge747" class="edge">
<title>expert_11_7&#45;&gt;aggregate_11_7</title>
<path fill="none" stroke="black" d="M3916.5,-3999.85C3916.5,-3992.16 3916.5,-3983.35 3916.5,-3974.35"/>
<polygon fill="black" stroke="black" points="3920,-3974.16 3916.5,-3964.16 3913,-3974.16 3920,-3974.16"/>
</g>
<!-- attention_11_8 -->
<g id="node761" class="node">
<title>attention_11_8</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-3823.98 3832.5,-3823.98 3832.5,-3771.98 4000.5,-3771.98 4000.5,-3823.98"/>
<text text-anchor="middle" x="3916.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_11_L8</text>
<text text-anchor="middle" x="3916.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_7&#45;&gt;attention_11_8 -->
<g id="edge748" class="edge">
<title>aggregate_11_7&#45;&gt;attention_11_8</title>
<path fill="none" stroke="black" d="M3916.5,-3859.9C3916.5,-3851.23 3916.5,-3842.41 3916.5,-3834.27"/>
<polygon fill="black" stroke="black" points="3920,-3834.03 3916.5,-3824.03 3913,-3834.03 3920,-3834.03"/>
</g>
<!-- gate_11_8 -->
<g id="node762" class="node">
<title>gate_11_8</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-3735.98 3829.06,-3735.98 3768.49,-3631.98 4003.94,-3631.98 4064.51,-3735.98"/>
<text text-anchor="middle" x="3916.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_11_L8</text>
<text text-anchor="middle" x="3916.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_8&#45;&gt;gate_11_8 -->
<g id="edge749" class="edge">
<title>attention_11_8&#45;&gt;gate_11_8</title>
<path fill="none" stroke="black" d="M3916.5,-3771.85C3916.5,-3764.16 3916.5,-3755.35 3916.5,-3746.35"/>
<polygon fill="black" stroke="black" points="3920,-3746.16 3916.5,-3736.16 3913,-3746.16 3920,-3746.16"/>
</g>
<!-- expert_11_8 -->
<g id="node763" class="node">
<title>expert_11_8</title>
<polygon fill="lightgreen" stroke="black" points="3991,-3595.98 3842,-3595.98 3842,-3543.98 3991,-3543.98 3991,-3595.98"/>
<text text-anchor="middle" x="3916.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_11_L8</text>
<text text-anchor="middle" x="3916.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_8&#45;&gt;expert_11_8 -->
<g id="edge750" class="edge">
<title>gate_11_8&#45;&gt;expert_11_8</title>
<path fill="none" stroke="black" d="M3909.77,-3631.9C3909.69,-3623.23 3909.83,-3614.41 3910.18,-3606.27"/>
<polygon fill="black" stroke="black" points="3913.69,-3606.21 3910.77,-3596.03 3906.7,-3605.81 3913.69,-3606.21"/>
</g>
<!-- gate_11_8&#45;&gt;expert_11_8 -->
<g id="edge1241" class="edge">
<title>gate_11_8&#45;&gt;expert_11_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-3631.9C3923.31,-3623.23 3923.17,-3614.41 3922.82,-3606.27"/>
<polygon fill="red" stroke="red" points="3926.3,-3605.81 3922.23,-3596.03 3919.31,-3606.21 3926.3,-3605.81"/>
</g>
<!-- aggregate_11_8 -->
<g id="node764" class="node">
<title>aggregate_11_8</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-3507.98 3829.06,-3507.98 3768.49,-3403.98 4003.94,-3403.98 4064.51,-3507.98"/>
<text text-anchor="middle" x="3916.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L8</text>
<text text-anchor="middle" x="3916.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_8&#45;&gt;aggregate_11_8 -->
<g id="edge751" class="edge">
<title>expert_11_8&#45;&gt;aggregate_11_8</title>
<path fill="none" stroke="black" d="M3916.5,-3543.85C3916.5,-3536.16 3916.5,-3527.35 3916.5,-3518.35"/>
<polygon fill="black" stroke="black" points="3920,-3518.16 3916.5,-3508.16 3913,-3518.16 3920,-3518.16"/>
</g>
<!-- attention_11_9 -->
<g id="node765" class="node">
<title>attention_11_9</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-3367.98 3832.5,-3367.98 3832.5,-3315.98 4000.5,-3315.98 4000.5,-3367.98"/>
<text text-anchor="middle" x="3916.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_11_L9</text>
<text text-anchor="middle" x="3916.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_8&#45;&gt;attention_11_9 -->
<g id="edge752" class="edge">
<title>aggregate_11_8&#45;&gt;attention_11_9</title>
<path fill="none" stroke="black" d="M3916.5,-3403.9C3916.5,-3395.23 3916.5,-3386.41 3916.5,-3378.27"/>
<polygon fill="black" stroke="black" points="3920,-3378.03 3916.5,-3368.03 3913,-3378.03 3920,-3378.03"/>
</g>
<!-- gate_11_9 -->
<g id="node766" class="node">
<title>gate_11_9</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-3279.98 3829.06,-3279.98 3768.49,-3175.98 4003.94,-3175.98 4064.51,-3279.98"/>
<text text-anchor="middle" x="3916.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_11_L9</text>
<text text-anchor="middle" x="3916.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_9&#45;&gt;gate_11_9 -->
<g id="edge753" class="edge">
<title>attention_11_9&#45;&gt;gate_11_9</title>
<path fill="none" stroke="black" d="M3916.5,-3315.85C3916.5,-3308.16 3916.5,-3299.35 3916.5,-3290.35"/>
<polygon fill="black" stroke="black" points="3920,-3290.16 3916.5,-3280.16 3913,-3290.16 3920,-3290.16"/>
</g>
<!-- expert_11_9 -->
<g id="node767" class="node">
<title>expert_11_9</title>
<polygon fill="lightgreen" stroke="black" points="3991,-3139.98 3842,-3139.98 3842,-3087.98 3991,-3087.98 3991,-3139.98"/>
<text text-anchor="middle" x="3916.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_11_L9</text>
<text text-anchor="middle" x="3916.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_9&#45;&gt;expert_11_9 -->
<g id="edge754" class="edge">
<title>gate_11_9&#45;&gt;expert_11_9</title>
<path fill="none" stroke="black" d="M3909.77,-3175.9C3909.69,-3167.23 3909.83,-3158.41 3910.18,-3150.27"/>
<polygon fill="black" stroke="black" points="3913.69,-3150.21 3910.77,-3140.03 3906.7,-3149.81 3913.69,-3150.21"/>
</g>
<!-- gate_11_9&#45;&gt;expert_11_9 -->
<g id="edge1242" class="edge">
<title>gate_11_9&#45;&gt;expert_11_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-3175.9C3923.31,-3167.23 3923.17,-3158.41 3922.82,-3150.27"/>
<polygon fill="red" stroke="red" points="3926.3,-3149.81 3922.23,-3140.03 3919.31,-3150.21 3926.3,-3149.81"/>
</g>
<!-- aggregate_11_9 -->
<g id="node768" class="node">
<title>aggregate_11_9</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-3051.98 3829.06,-3051.98 3768.49,-2947.98 4003.94,-2947.98 4064.51,-3051.98"/>
<text text-anchor="middle" x="3916.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L9</text>
<text text-anchor="middle" x="3916.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_9&#45;&gt;aggregate_11_9 -->
<g id="edge755" class="edge">
<title>expert_11_9&#45;&gt;aggregate_11_9</title>
<path fill="none" stroke="black" d="M3916.5,-3087.85C3916.5,-3080.16 3916.5,-3071.35 3916.5,-3062.35"/>
<polygon fill="black" stroke="black" points="3920,-3062.16 3916.5,-3052.16 3913,-3062.16 3920,-3062.16"/>
</g>
<!-- attention_11_10 -->
<g id="node769" class="node">
<title>attention_11_10</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-2911.98 3832.5,-2911.98 3832.5,-2859.98 4000.5,-2859.98 4000.5,-2911.98"/>
<text text-anchor="middle" x="3916.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_11_L10</text>
<text text-anchor="middle" x="3916.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_9&#45;&gt;attention_11_10 -->
<g id="edge756" class="edge">
<title>aggregate_11_9&#45;&gt;attention_11_10</title>
<path fill="none" stroke="black" d="M3916.5,-2947.9C3916.5,-2939.23 3916.5,-2930.41 3916.5,-2922.27"/>
<polygon fill="black" stroke="black" points="3920,-2922.03 3916.5,-2912.03 3913,-2922.03 3920,-2922.03"/>
</g>
<!-- gate_11_10 -->
<g id="node770" class="node">
<title>gate_11_10</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-2823.98 3829.06,-2823.98 3768.49,-2719.98 4003.94,-2719.98 4064.51,-2823.98"/>
<text text-anchor="middle" x="3916.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_11_L10</text>
<text text-anchor="middle" x="3916.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_10&#45;&gt;gate_11_10 -->
<g id="edge757" class="edge">
<title>attention_11_10&#45;&gt;gate_11_10</title>
<path fill="none" stroke="black" d="M3916.5,-2859.85C3916.5,-2852.16 3916.5,-2843.35 3916.5,-2834.35"/>
<polygon fill="black" stroke="black" points="3920,-2834.16 3916.5,-2824.16 3913,-2834.16 3920,-2834.16"/>
</g>
<!-- expert_11_10 -->
<g id="node771" class="node">
<title>expert_11_10</title>
<polygon fill="lightgreen" stroke="black" points="3991,-2683.98 3842,-2683.98 3842,-2631.98 3991,-2631.98 3991,-2683.98"/>
<text text-anchor="middle" x="3916.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_11_L10</text>
<text text-anchor="middle" x="3916.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_10&#45;&gt;expert_11_10 -->
<g id="edge758" class="edge">
<title>gate_11_10&#45;&gt;expert_11_10</title>
<path fill="none" stroke="black" d="M3909.77,-2719.9C3909.69,-2711.23 3909.83,-2702.41 3910.18,-2694.27"/>
<polygon fill="black" stroke="black" points="3913.69,-2694.21 3910.77,-2684.03 3906.7,-2693.81 3913.69,-2694.21"/>
</g>
<!-- gate_11_10&#45;&gt;expert_11_10 -->
<g id="edge1243" class="edge">
<title>gate_11_10&#45;&gt;expert_11_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-2719.9C3923.31,-2711.23 3923.17,-2702.41 3922.82,-2694.27"/>
<polygon fill="red" stroke="red" points="3926.3,-2693.81 3922.23,-2684.03 3919.31,-2694.21 3926.3,-2693.81"/>
</g>
<!-- aggregate_11_10 -->
<g id="node772" class="node">
<title>aggregate_11_10</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-2595.98 3829.06,-2595.98 3768.49,-2491.98 4003.94,-2491.98 4064.51,-2595.98"/>
<text text-anchor="middle" x="3916.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L10</text>
<text text-anchor="middle" x="3916.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_10&#45;&gt;aggregate_11_10 -->
<g id="edge759" class="edge">
<title>expert_11_10&#45;&gt;aggregate_11_10</title>
<path fill="none" stroke="black" d="M3916.5,-2631.85C3916.5,-2624.16 3916.5,-2615.35 3916.5,-2606.35"/>
<polygon fill="black" stroke="black" points="3920,-2606.16 3916.5,-2596.16 3913,-2606.16 3920,-2606.16"/>
</g>
<!-- attention_11_11 -->
<g id="node773" class="node">
<title>attention_11_11</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-2455.98 3832.5,-2455.98 3832.5,-2403.98 4000.5,-2403.98 4000.5,-2455.98"/>
<text text-anchor="middle" x="3916.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_11_L11</text>
<text text-anchor="middle" x="3916.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_10&#45;&gt;attention_11_11 -->
<g id="edge760" class="edge">
<title>aggregate_11_10&#45;&gt;attention_11_11</title>
<path fill="none" stroke="black" d="M3916.5,-2491.9C3916.5,-2483.23 3916.5,-2474.41 3916.5,-2466.27"/>
<polygon fill="black" stroke="black" points="3920,-2466.03 3916.5,-2456.03 3913,-2466.03 3920,-2466.03"/>
</g>
<!-- gate_11_11 -->
<g id="node774" class="node">
<title>gate_11_11</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-2367.98 3829.06,-2367.98 3768.49,-2263.98 4003.94,-2263.98 4064.51,-2367.98"/>
<text text-anchor="middle" x="3916.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_11_L11</text>
<text text-anchor="middle" x="3916.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_11&#45;&gt;gate_11_11 -->
<g id="edge761" class="edge">
<title>attention_11_11&#45;&gt;gate_11_11</title>
<path fill="none" stroke="black" d="M3916.5,-2403.85C3916.5,-2396.16 3916.5,-2387.35 3916.5,-2378.35"/>
<polygon fill="black" stroke="black" points="3920,-2378.16 3916.5,-2368.16 3913,-2378.16 3920,-2378.16"/>
</g>
<!-- expert_11_11 -->
<g id="node775" class="node">
<title>expert_11_11</title>
<polygon fill="lightgreen" stroke="black" points="3991,-2227.98 3842,-2227.98 3842,-2175.98 3991,-2175.98 3991,-2227.98"/>
<text text-anchor="middle" x="3916.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_11_L11</text>
<text text-anchor="middle" x="3916.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_11&#45;&gt;expert_11_11 -->
<g id="edge762" class="edge">
<title>gate_11_11&#45;&gt;expert_11_11</title>
<path fill="none" stroke="black" d="M3909.77,-2263.9C3909.69,-2255.23 3909.83,-2246.41 3910.18,-2238.27"/>
<polygon fill="black" stroke="black" points="3913.69,-2238.21 3910.77,-2228.03 3906.7,-2237.81 3913.69,-2238.21"/>
</g>
<!-- gate_11_11&#45;&gt;expert_11_11 -->
<g id="edge1244" class="edge">
<title>gate_11_11&#45;&gt;expert_11_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-2263.9C3923.31,-2255.23 3923.17,-2246.41 3922.82,-2238.27"/>
<polygon fill="red" stroke="red" points="3926.3,-2237.81 3922.23,-2228.03 3919.31,-2238.21 3926.3,-2237.81"/>
</g>
<!-- aggregate_11_11 -->
<g id="node776" class="node">
<title>aggregate_11_11</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-2139.98 3829.06,-2139.98 3768.49,-2035.98 4003.94,-2035.98 4064.51,-2139.98"/>
<text text-anchor="middle" x="3916.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L11</text>
<text text-anchor="middle" x="3916.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_11&#45;&gt;aggregate_11_11 -->
<g id="edge763" class="edge">
<title>expert_11_11&#45;&gt;aggregate_11_11</title>
<path fill="none" stroke="black" d="M3916.5,-2175.85C3916.5,-2168.16 3916.5,-2159.35 3916.5,-2150.35"/>
<polygon fill="black" stroke="black" points="3920,-2150.16 3916.5,-2140.16 3913,-2150.16 3920,-2150.16"/>
</g>
<!-- attention_11_12 -->
<g id="node777" class="node">
<title>attention_11_12</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-1999.98 3832.5,-1999.98 3832.5,-1947.98 4000.5,-1947.98 4000.5,-1999.98"/>
<text text-anchor="middle" x="3916.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_11_L12</text>
<text text-anchor="middle" x="3916.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_11&#45;&gt;attention_11_12 -->
<g id="edge764" class="edge">
<title>aggregate_11_11&#45;&gt;attention_11_12</title>
<path fill="none" stroke="black" d="M3916.5,-2035.9C3916.5,-2027.23 3916.5,-2018.41 3916.5,-2010.27"/>
<polygon fill="black" stroke="black" points="3920,-2010.03 3916.5,-2000.03 3913,-2010.03 3920,-2010.03"/>
</g>
<!-- gate_11_12 -->
<g id="node778" class="node">
<title>gate_11_12</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-1911.98 3829.06,-1911.98 3768.49,-1807.98 4003.94,-1807.98 4064.51,-1911.98"/>
<text text-anchor="middle" x="3916.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_11_L12</text>
<text text-anchor="middle" x="3916.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_12&#45;&gt;gate_11_12 -->
<g id="edge765" class="edge">
<title>attention_11_12&#45;&gt;gate_11_12</title>
<path fill="none" stroke="black" d="M3916.5,-1947.85C3916.5,-1940.16 3916.5,-1931.35 3916.5,-1922.35"/>
<polygon fill="black" stroke="black" points="3920,-1922.16 3916.5,-1912.16 3913,-1922.16 3920,-1922.16"/>
</g>
<!-- expert_11_12 -->
<g id="node779" class="node">
<title>expert_11_12</title>
<polygon fill="lightgreen" stroke="black" points="3991,-1771.98 3842,-1771.98 3842,-1719.98 3991,-1719.98 3991,-1771.98"/>
<text text-anchor="middle" x="3916.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_11_L12</text>
<text text-anchor="middle" x="3916.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_12&#45;&gt;expert_11_12 -->
<g id="edge766" class="edge">
<title>gate_11_12&#45;&gt;expert_11_12</title>
<path fill="none" stroke="black" d="M3909.77,-1807.9C3909.69,-1799.23 3909.83,-1790.41 3910.18,-1782.27"/>
<polygon fill="black" stroke="black" points="3913.69,-1782.21 3910.77,-1772.03 3906.7,-1781.81 3913.69,-1782.21"/>
</g>
<!-- gate_11_12&#45;&gt;expert_11_12 -->
<g id="edge1245" class="edge">
<title>gate_11_12&#45;&gt;expert_11_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-1807.9C3923.31,-1799.23 3923.17,-1790.41 3922.82,-1782.27"/>
<polygon fill="red" stroke="red" points="3926.3,-1781.81 3922.23,-1772.03 3919.31,-1782.21 3926.3,-1781.81"/>
</g>
<!-- aggregate_11_12 -->
<g id="node780" class="node">
<title>aggregate_11_12</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-1683.98 3829.06,-1683.98 3768.49,-1579.98 4003.94,-1579.98 4064.51,-1683.98"/>
<text text-anchor="middle" x="3916.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L12</text>
<text text-anchor="middle" x="3916.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_12&#45;&gt;aggregate_11_12 -->
<g id="edge767" class="edge">
<title>expert_11_12&#45;&gt;aggregate_11_12</title>
<path fill="none" stroke="black" d="M3916.5,-1719.85C3916.5,-1712.16 3916.5,-1703.35 3916.5,-1694.35"/>
<polygon fill="black" stroke="black" points="3920,-1694.16 3916.5,-1684.16 3913,-1694.16 3920,-1694.16"/>
</g>
<!-- attention_11_13 -->
<g id="node781" class="node">
<title>attention_11_13</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-1543.98 3832.5,-1543.98 3832.5,-1491.98 4000.5,-1491.98 4000.5,-1543.98"/>
<text text-anchor="middle" x="3916.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_11_L13</text>
<text text-anchor="middle" x="3916.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_12&#45;&gt;attention_11_13 -->
<g id="edge768" class="edge">
<title>aggregate_11_12&#45;&gt;attention_11_13</title>
<path fill="none" stroke="black" d="M3916.5,-1579.9C3916.5,-1571.23 3916.5,-1562.41 3916.5,-1554.27"/>
<polygon fill="black" stroke="black" points="3920,-1554.03 3916.5,-1544.03 3913,-1554.03 3920,-1554.03"/>
</g>
<!-- gate_11_13 -->
<g id="node782" class="node">
<title>gate_11_13</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-1455.98 3829.06,-1455.98 3768.49,-1351.98 4003.94,-1351.98 4064.51,-1455.98"/>
<text text-anchor="middle" x="3916.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_11_L13</text>
<text text-anchor="middle" x="3916.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_13&#45;&gt;gate_11_13 -->
<g id="edge769" class="edge">
<title>attention_11_13&#45;&gt;gate_11_13</title>
<path fill="none" stroke="black" d="M3916.5,-1491.85C3916.5,-1484.16 3916.5,-1475.35 3916.5,-1466.35"/>
<polygon fill="black" stroke="black" points="3920,-1466.16 3916.5,-1456.16 3913,-1466.16 3920,-1466.16"/>
</g>
<!-- expert_11_13 -->
<g id="node783" class="node">
<title>expert_11_13</title>
<polygon fill="lightgreen" stroke="black" points="3991,-1315.98 3842,-1315.98 3842,-1263.98 3991,-1263.98 3991,-1315.98"/>
<text text-anchor="middle" x="3916.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_11_L13</text>
<text text-anchor="middle" x="3916.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_13&#45;&gt;expert_11_13 -->
<g id="edge770" class="edge">
<title>gate_11_13&#45;&gt;expert_11_13</title>
<path fill="none" stroke="black" d="M3909.77,-1351.9C3909.69,-1343.23 3909.83,-1334.41 3910.18,-1326.27"/>
<polygon fill="black" stroke="black" points="3913.69,-1326.21 3910.77,-1316.03 3906.7,-1325.81 3913.69,-1326.21"/>
</g>
<!-- gate_11_13&#45;&gt;expert_11_13 -->
<g id="edge1246" class="edge">
<title>gate_11_13&#45;&gt;expert_11_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-1351.9C3923.31,-1343.23 3923.17,-1334.41 3922.82,-1326.27"/>
<polygon fill="red" stroke="red" points="3926.3,-1325.81 3922.23,-1316.03 3919.31,-1326.21 3926.3,-1325.81"/>
</g>
<!-- aggregate_11_13 -->
<g id="node784" class="node">
<title>aggregate_11_13</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-1227.98 3829.06,-1227.98 3768.49,-1123.98 4003.94,-1123.98 4064.51,-1227.98"/>
<text text-anchor="middle" x="3916.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L13</text>
<text text-anchor="middle" x="3916.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_13&#45;&gt;aggregate_11_13 -->
<g id="edge771" class="edge">
<title>expert_11_13&#45;&gt;aggregate_11_13</title>
<path fill="none" stroke="black" d="M3916.5,-1263.85C3916.5,-1256.16 3916.5,-1247.35 3916.5,-1238.35"/>
<polygon fill="black" stroke="black" points="3920,-1238.16 3916.5,-1228.16 3913,-1238.16 3920,-1238.16"/>
</g>
<!-- attention_11_14 -->
<g id="node785" class="node">
<title>attention_11_14</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-1087.98 3832.5,-1087.98 3832.5,-1035.98 4000.5,-1035.98 4000.5,-1087.98"/>
<text text-anchor="middle" x="3916.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_11_L14</text>
<text text-anchor="middle" x="3916.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_13&#45;&gt;attention_11_14 -->
<g id="edge772" class="edge">
<title>aggregate_11_13&#45;&gt;attention_11_14</title>
<path fill="none" stroke="black" d="M3916.5,-1123.9C3916.5,-1115.23 3916.5,-1106.41 3916.5,-1098.27"/>
<polygon fill="black" stroke="black" points="3920,-1098.03 3916.5,-1088.03 3913,-1098.03 3920,-1098.03"/>
</g>
<!-- gate_11_14 -->
<g id="node786" class="node">
<title>gate_11_14</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-999.98 3829.06,-999.98 3768.49,-895.98 4003.94,-895.98 4064.51,-999.98"/>
<text text-anchor="middle" x="3916.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_11_L14</text>
<text text-anchor="middle" x="3916.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_14&#45;&gt;gate_11_14 -->
<g id="edge773" class="edge">
<title>attention_11_14&#45;&gt;gate_11_14</title>
<path fill="none" stroke="black" d="M3916.5,-1035.85C3916.5,-1028.16 3916.5,-1019.35 3916.5,-1010.35"/>
<polygon fill="black" stroke="black" points="3920,-1010.16 3916.5,-1000.16 3913,-1010.16 3920,-1010.16"/>
</g>
<!-- expert_11_14 -->
<g id="node787" class="node">
<title>expert_11_14</title>
<polygon fill="lightgreen" stroke="black" points="3991,-859.98 3842,-859.98 3842,-807.98 3991,-807.98 3991,-859.98"/>
<text text-anchor="middle" x="3916.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_11_L14</text>
<text text-anchor="middle" x="3916.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_14&#45;&gt;expert_11_14 -->
<g id="edge774" class="edge">
<title>gate_11_14&#45;&gt;expert_11_14</title>
<path fill="none" stroke="black" d="M3909.77,-895.9C3909.69,-887.23 3909.83,-878.41 3910.18,-870.27"/>
<polygon fill="black" stroke="black" points="3913.69,-870.21 3910.77,-860.03 3906.7,-869.81 3913.69,-870.21"/>
</g>
<!-- gate_11_14&#45;&gt;expert_11_14 -->
<g id="edge1247" class="edge">
<title>gate_11_14&#45;&gt;expert_11_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-895.9C3923.31,-887.23 3923.17,-878.41 3922.82,-870.27"/>
<polygon fill="red" stroke="red" points="3926.3,-869.81 3922.23,-860.03 3919.31,-870.21 3926.3,-869.81"/>
</g>
<!-- aggregate_11_14 -->
<g id="node788" class="node">
<title>aggregate_11_14</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-771.98 3829.06,-771.98 3768.49,-667.98 4003.94,-667.98 4064.51,-771.98"/>
<text text-anchor="middle" x="3916.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L14</text>
<text text-anchor="middle" x="3916.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_14&#45;&gt;aggregate_11_14 -->
<g id="edge775" class="edge">
<title>expert_11_14&#45;&gt;aggregate_11_14</title>
<path fill="none" stroke="black" d="M3916.5,-807.85C3916.5,-800.16 3916.5,-791.35 3916.5,-782.35"/>
<polygon fill="black" stroke="black" points="3920,-782.16 3916.5,-772.16 3913,-782.16 3920,-782.16"/>
</g>
<!-- attention_11_15 -->
<g id="node789" class="node">
<title>attention_11_15</title>
<polygon fill="lightgreen" stroke="black" points="4000.5,-631.98 3832.5,-631.98 3832.5,-579.98 4000.5,-579.98 4000.5,-631.98"/>
<text text-anchor="middle" x="3916.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_11_L15</text>
<text text-anchor="middle" x="3916.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="3916.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="3916.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_11_14&#45;&gt;attention_11_15 -->
<g id="edge776" class="edge">
<title>aggregate_11_14&#45;&gt;attention_11_15</title>
<path fill="none" stroke="black" d="M3916.5,-667.9C3916.5,-659.23 3916.5,-650.41 3916.5,-642.27"/>
<polygon fill="black" stroke="black" points="3920,-642.03 3916.5,-632.03 3913,-642.03 3920,-642.03"/>
</g>
<!-- gate_11_15 -->
<g id="node790" class="node">
<title>gate_11_15</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-543.98 3829.06,-543.98 3768.49,-439.98 4003.94,-439.98 4064.51,-543.98"/>
<text text-anchor="middle" x="3916.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_11_L15</text>
<text text-anchor="middle" x="3916.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="3916.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_11_15&#45;&gt;gate_11_15 -->
<g id="edge777" class="edge">
<title>attention_11_15&#45;&gt;gate_11_15</title>
<path fill="none" stroke="black" d="M3916.5,-579.85C3916.5,-572.16 3916.5,-563.35 3916.5,-554.35"/>
<polygon fill="black" stroke="black" points="3920,-554.16 3916.5,-544.16 3913,-554.16 3920,-554.16"/>
</g>
<!-- expert_11_15 -->
<g id="node791" class="node">
<title>expert_11_15</title>
<polygon fill="lightgreen" stroke="black" points="3991,-403.98 3842,-403.98 3842,-351.98 3991,-351.98 3991,-403.98"/>
<text text-anchor="middle" x="3916.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_11_L15</text>
<text text-anchor="middle" x="3916.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=11</text>
<text text-anchor="middle" x="3916.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_11_15&#45;&gt;expert_11_15 -->
<g id="edge778" class="edge">
<title>gate_11_15&#45;&gt;expert_11_15</title>
<path fill="none" stroke="black" d="M3909.77,-439.9C3909.69,-431.23 3909.83,-422.41 3910.18,-414.27"/>
<polygon fill="black" stroke="black" points="3913.69,-414.21 3910.77,-404.03 3906.7,-413.81 3913.69,-414.21"/>
</g>
<!-- gate_11_15&#45;&gt;expert_11_15 -->
<g id="edge1248" class="edge">
<title>gate_11_15&#45;&gt;expert_11_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3923.23,-439.9C3923.31,-431.23 3923.17,-422.41 3922.82,-414.27"/>
<polygon fill="red" stroke="red" points="3926.3,-413.81 3922.23,-404.03 3919.31,-414.21 3926.3,-413.81"/>
</g>
<!-- aggregate_11_15 -->
<g id="node792" class="node">
<title>aggregate_11_15</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-315.98 3829.06,-315.98 3768.49,-211.98 4003.94,-211.98 4064.51,-315.98"/>
<text text-anchor="middle" x="3916.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_11_L15</text>
<text text-anchor="middle" x="3916.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="3916.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="3916.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_11_15&#45;&gt;aggregate_11_15 -->
<g id="edge779" class="edge">
<title>expert_11_15&#45;&gt;aggregate_11_15</title>
<path fill="none" stroke="black" d="M3916.5,-351.85C3916.5,-344.16 3916.5,-335.35 3916.5,-326.35"/>
<polygon fill="black" stroke="black" points="3920,-326.16 3916.5,-316.16 3913,-326.16 3920,-326.16"/>
</g>
<!-- collect_11 -->
<g id="node793" class="node">
<title>collect_11</title>
<polygon fill="lightyellow" stroke="black" points="4064.51,-175.98 3829.06,-175.98 3768.49,-93.98 4003.94,-93.98 4064.51,-175.98"/>
<text text-anchor="middle" x="3916.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_11</text>
<text text-anchor="middle" x="3916.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="3916.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_11_15&#45;&gt;collect_11 -->
<g id="edge780" class="edge">
<title>aggregate_11_15&#45;&gt;collect_11</title>
<path fill="none" stroke="black" d="M3916.5,-211.69C3916.5,-203.27 3916.5,-194.56 3916.5,-186.17"/>
<polygon fill="black" stroke="black" points="3920,-186.14 3916.5,-176.14 3913,-186.14 3920,-186.14"/>
</g>
<!-- collect_11&#45;&gt;output -->
<g id="edge1052" class="edge">
<title>collect_11&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3769.5,-95.84C3765.81,-95.18 3762.13,-94.56 3758.5,-93.98 3469.62,-48.02 3125.92,-35.04 2943.07,-31.39"/>
<polygon fill="black" stroke="black" points="2942.94,-27.89 2932.87,-31.19 2942.8,-34.89 2942.94,-27.89"/>
</g>
<!-- distribute_12 -->
<g id="node794" class="node">
<title>distribute_12</title>
<polygon fill="lightyellow" stroke="black" points="4411.73,-7589.98 4171.16,-7589.98 4109.27,-7507.98 4349.85,-7507.98 4411.73,-7589.98"/>
<text text-anchor="middle" x="4260.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_12</text>
<text text-anchor="middle" x="4260.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="4260.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_0 -->
<g id="node795" class="node">
<title>attention_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4339.5,-7471.98 4171.5,-7471.98 4171.5,-7419.98 4339.5,-7419.98 4339.5,-7471.98"/>
<text text-anchor="middle" x="4255.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_12_L0</text>
<text text-anchor="middle" x="4255.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4255.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4255.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_12&#45;&gt;attention_12_0 -->
<g id="edge781" class="edge">
<title>distribute_12&#45;&gt;attention_12_0</title>
<path fill="none" stroke="black" d="M4258.51,-7507.77C4258.09,-7499.34 4257.66,-7490.51 4257.25,-7482.27"/>
<polygon fill="black" stroke="black" points="4260.74,-7482.05 4256.75,-7472.23 4253.75,-7482.4 4260.74,-7482.05"/>
</g>
<!-- gate_12_0 -->
<g id="node796" class="node">
<title>gate_12_0</title>
<polygon fill="lightyellow" stroke="black" points="4403.51,-7383.98 4168.06,-7383.98 4107.49,-7279.98 4342.94,-7279.98 4403.51,-7383.98"/>
<text text-anchor="middle" x="4255.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_12_L0</text>
<text text-anchor="middle" x="4255.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4255.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4255.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_0&#45;&gt;gate_12_0 -->
<g id="edge782" class="edge">
<title>attention_12_0&#45;&gt;gate_12_0</title>
<path fill="none" stroke="black" d="M4255.5,-7419.85C4255.5,-7412.16 4255.5,-7403.35 4255.5,-7394.35"/>
<polygon fill="black" stroke="black" points="4259,-7394.16 4255.5,-7384.16 4252,-7394.16 4259,-7394.16"/>
</g>
<!-- expert_12_0 -->
<g id="node797" class="node">
<title>expert_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4330,-7243.98 4181,-7243.98 4181,-7191.98 4330,-7191.98 4330,-7243.98"/>
<text text-anchor="middle" x="4255.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_12_L0</text>
<text text-anchor="middle" x="4255.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4255.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4255.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_0&#45;&gt;expert_12_0 -->
<g id="edge783" class="edge">
<title>gate_12_0&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" d="M4248.77,-7279.9C4248.69,-7271.23 4248.83,-7262.41 4249.18,-7254.27"/>
<polygon fill="black" stroke="black" points="4252.69,-7254.21 4249.77,-7244.03 4245.7,-7253.81 4252.69,-7254.21"/>
</g>
<!-- gate_12_0&#45;&gt;expert_12_0 -->
<g id="edge1249" class="edge">
<title>gate_12_0&#45;&gt;expert_12_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4262.23,-7279.9C4262.31,-7271.23 4262.17,-7262.41 4261.82,-7254.27"/>
<polygon fill="red" stroke="red" points="4265.3,-7253.81 4261.23,-7244.03 4258.31,-7254.21 4265.3,-7253.81"/>
</g>
<!-- aggregate_12_0 -->
<g id="node798" class="node">
<title>aggregate_12_0</title>
<polygon fill="lightyellow" stroke="black" points="4400.51,-7155.98 4165.06,-7155.98 4104.49,-7051.98 4339.94,-7051.98 4400.51,-7155.98"/>
<text text-anchor="middle" x="4252.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L0</text>
<text text-anchor="middle" x="4252.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4252.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4252.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_0&#45;&gt;aggregate_12_0 -->
<g id="edge784" class="edge">
<title>expert_12_0&#45;&gt;aggregate_12_0</title>
<path fill="none" stroke="black" d="M4254.83,-7191.85C4254.62,-7184.16 4254.39,-7175.35 4254.14,-7166.35"/>
<polygon fill="black" stroke="black" points="4257.64,-7166.06 4253.87,-7156.16 4250.64,-7166.25 4257.64,-7166.06"/>
</g>
<!-- attention_12_1 -->
<g id="node799" class="node">
<title>attention_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4336.5,-7015.98 4168.5,-7015.98 4168.5,-6963.98 4336.5,-6963.98 4336.5,-7015.98"/>
<text text-anchor="middle" x="4252.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_12_L1</text>
<text text-anchor="middle" x="4252.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4252.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4252.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_0&#45;&gt;attention_12_1 -->
<g id="edge785" class="edge">
<title>aggregate_12_0&#45;&gt;attention_12_1</title>
<path fill="none" stroke="black" d="M4252.5,-7051.9C4252.5,-7043.23 4252.5,-7034.41 4252.5,-7026.27"/>
<polygon fill="black" stroke="black" points="4256,-7026.03 4252.5,-7016.03 4249,-7026.03 4256,-7026.03"/>
</g>
<!-- gate_12_1 -->
<g id="node800" class="node">
<title>gate_12_1</title>
<polygon fill="lightyellow" stroke="black" points="4400.51,-6927.98 4165.06,-6927.98 4104.49,-6823.98 4339.94,-6823.98 4400.51,-6927.98"/>
<text text-anchor="middle" x="4252.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_12_L1</text>
<text text-anchor="middle" x="4252.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4252.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4252.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_1&#45;&gt;gate_12_1 -->
<g id="edge786" class="edge">
<title>attention_12_1&#45;&gt;gate_12_1</title>
<path fill="none" stroke="black" d="M4252.5,-6963.85C4252.5,-6956.16 4252.5,-6947.35 4252.5,-6938.35"/>
<polygon fill="black" stroke="black" points="4256,-6938.16 4252.5,-6928.16 4249,-6938.16 4256,-6938.16"/>
</g>
<!-- expert_12_1 -->
<g id="node801" class="node">
<title>expert_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4327,-6787.98 4178,-6787.98 4178,-6735.98 4327,-6735.98 4327,-6787.98"/>
<text text-anchor="middle" x="4252.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_12_L1</text>
<text text-anchor="middle" x="4252.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4252.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4252.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_1&#45;&gt;expert_12_1 -->
<g id="edge787" class="edge">
<title>gate_12_1&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" d="M4245.77,-6823.9C4245.69,-6815.23 4245.83,-6806.41 4246.18,-6798.27"/>
<polygon fill="black" stroke="black" points="4249.69,-6798.21 4246.77,-6788.03 4242.7,-6797.81 4249.69,-6798.21"/>
</g>
<!-- gate_12_1&#45;&gt;expert_12_1 -->
<g id="edge1250" class="edge">
<title>gate_12_1&#45;&gt;expert_12_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4259.23,-6823.9C4259.31,-6815.23 4259.17,-6806.41 4258.82,-6798.27"/>
<polygon fill="red" stroke="red" points="4262.3,-6797.81 4258.23,-6788.03 4255.31,-6798.21 4262.3,-6797.81"/>
</g>
<!-- aggregate_12_1 -->
<g id="node802" class="node">
<title>aggregate_12_1</title>
<polygon fill="lightyellow" stroke="black" points="4399.51,-6699.98 4164.06,-6699.98 4103.49,-6595.98 4338.94,-6595.98 4399.51,-6699.98"/>
<text text-anchor="middle" x="4251.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L1</text>
<text text-anchor="middle" x="4251.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4251.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4251.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_1&#45;&gt;aggregate_12_1 -->
<g id="edge788" class="edge">
<title>expert_12_1&#45;&gt;aggregate_12_1</title>
<path fill="none" stroke="black" d="M4252.28,-6735.85C4252.21,-6728.16 4252.13,-6719.35 4252.05,-6710.35"/>
<polygon fill="black" stroke="black" points="4255.55,-6710.13 4251.96,-6700.16 4248.55,-6710.19 4255.55,-6710.13"/>
</g>
<!-- attention_12_2 -->
<g id="node803" class="node">
<title>attention_12_2</title>
<polygon fill="lightgreen" stroke="black" points="4333.5,-6559.98 4165.5,-6559.98 4165.5,-6507.98 4333.5,-6507.98 4333.5,-6559.98"/>
<text text-anchor="middle" x="4249.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_12_L2</text>
<text text-anchor="middle" x="4249.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4249.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4249.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_1&#45;&gt;attention_12_2 -->
<g id="edge789" class="edge">
<title>aggregate_12_1&#45;&gt;attention_12_2</title>
<path fill="none" stroke="black" d="M4250.59,-6595.9C4250.43,-6587.23 4250.28,-6578.41 4250.13,-6570.27"/>
<polygon fill="black" stroke="black" points="4253.63,-6569.96 4249.95,-6560.03 4246.63,-6570.09 4253.63,-6569.96"/>
</g>
<!-- gate_12_2 -->
<g id="node804" class="node">
<title>gate_12_2</title>
<polygon fill="lightyellow" stroke="black" points="4397.51,-6471.98 4162.06,-6471.98 4101.49,-6367.98 4336.94,-6367.98 4397.51,-6471.98"/>
<text text-anchor="middle" x="4249.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_12_L2</text>
<text text-anchor="middle" x="4249.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4249.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4249.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_2&#45;&gt;gate_12_2 -->
<g id="edge790" class="edge">
<title>attention_12_2&#45;&gt;gate_12_2</title>
<path fill="none" stroke="black" d="M4249.5,-6507.85C4249.5,-6500.16 4249.5,-6491.35 4249.5,-6482.35"/>
<polygon fill="black" stroke="black" points="4253,-6482.16 4249.5,-6472.16 4246,-6482.16 4253,-6482.16"/>
</g>
<!-- expert_12_2 -->
<g id="node805" class="node">
<title>expert_12_2</title>
<polygon fill="lightgreen" stroke="black" points="4323,-6331.98 4174,-6331.98 4174,-6279.98 4323,-6279.98 4323,-6331.98"/>
<text text-anchor="middle" x="4248.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_12_L2</text>
<text text-anchor="middle" x="4248.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4248.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4248.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_2&#45;&gt;expert_12_2 -->
<g id="edge791" class="edge">
<title>gate_12_2&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" d="M4242.32,-6367.9C4242.16,-6359.23 4242.22,-6350.41 4242.49,-6342.27"/>
<polygon fill="black" stroke="black" points="4246,-6342.18 4242.99,-6332.03 4239.01,-6341.85 4246,-6342.18"/>
</g>
<!-- gate_12_2&#45;&gt;expert_12_2 -->
<g id="edge1251" class="edge">
<title>gate_12_2&#45;&gt;expert_12_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4255.77,-6367.9C4255.78,-6359.23 4255.56,-6350.41 4255.14,-6342.27"/>
<polygon fill="red" stroke="red" points="4258.61,-6341.77 4254.46,-6332.03 4251.63,-6342.24 4258.61,-6341.77"/>
</g>
<!-- aggregate_12_2 -->
<g id="node806" class="node">
<title>aggregate_12_2</title>
<polygon fill="lightyellow" stroke="black" points="4392.51,-6243.98 4157.06,-6243.98 4096.49,-6139.98 4331.94,-6139.98 4392.51,-6243.98"/>
<text text-anchor="middle" x="4244.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L2</text>
<text text-anchor="middle" x="4244.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4244.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4244.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_2&#45;&gt;aggregate_12_2 -->
<g id="edge792" class="edge">
<title>expert_12_2&#45;&gt;aggregate_12_2</title>
<path fill="none" stroke="black" d="M4247.6,-6279.85C4247.33,-6272.16 4247.01,-6263.35 4246.69,-6254.35"/>
<polygon fill="black" stroke="black" points="4250.18,-6254.03 4246.33,-6244.16 4243.19,-6254.28 4250.18,-6254.03"/>
</g>
<!-- attention_12_3 -->
<g id="node807" class="node">
<title>attention_12_3</title>
<polygon fill="lightgreen" stroke="black" points="4328.5,-6103.98 4160.5,-6103.98 4160.5,-6051.98 4328.5,-6051.98 4328.5,-6103.98"/>
<text text-anchor="middle" x="4244.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_12_L3</text>
<text text-anchor="middle" x="4244.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4244.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4244.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_2&#45;&gt;attention_12_3 -->
<g id="edge793" class="edge">
<title>aggregate_12_2&#45;&gt;attention_12_3</title>
<path fill="none" stroke="black" d="M4244.5,-6139.9C4244.5,-6131.23 4244.5,-6122.41 4244.5,-6114.27"/>
<polygon fill="black" stroke="black" points="4248,-6114.03 4244.5,-6104.03 4241,-6114.03 4248,-6114.03"/>
</g>
<!-- gate_12_3 -->
<g id="node808" class="node">
<title>gate_12_3</title>
<polygon fill="lightyellow" stroke="black" points="4392.51,-6015.98 4157.06,-6015.98 4096.49,-5911.98 4331.94,-5911.98 4392.51,-6015.98"/>
<text text-anchor="middle" x="4244.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_12_L3</text>
<text text-anchor="middle" x="4244.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4244.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4244.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_3&#45;&gt;gate_12_3 -->
<g id="edge794" class="edge">
<title>attention_12_3&#45;&gt;gate_12_3</title>
<path fill="none" stroke="black" d="M4244.5,-6051.85C4244.5,-6044.16 4244.5,-6035.35 4244.5,-6026.35"/>
<polygon fill="black" stroke="black" points="4248,-6026.16 4244.5,-6016.16 4241,-6026.16 4248,-6026.16"/>
</g>
<!-- expert_12_3 -->
<g id="node809" class="node">
<title>expert_12_3</title>
<polygon fill="lightgreen" stroke="black" points="4317,-5875.98 4168,-5875.98 4168,-5823.98 4317,-5823.98 4317,-5875.98"/>
<text text-anchor="middle" x="4242.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_12_L3</text>
<text text-anchor="middle" x="4242.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4242.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4242.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_3&#45;&gt;expert_12_3 -->
<g id="edge795" class="edge">
<title>gate_12_3&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" d="M4236.86,-5911.9C4236.63,-5903.23 4236.6,-5894.41 4236.81,-5886.27"/>
<polygon fill="black" stroke="black" points="4240.32,-5886.16 4237.21,-5876.03 4233.32,-5885.88 4240.32,-5886.16"/>
</g>
<!-- gate_12_3&#45;&gt;expert_12_3 -->
<g id="edge1252" class="edge">
<title>gate_12_3&#45;&gt;expert_12_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4250.32,-5911.9C4250.24,-5903.23 4249.95,-5894.41 4249.45,-5886.27"/>
<polygon fill="red" stroke="red" points="4252.92,-5885.74 4248.68,-5876.03 4245.94,-5886.26 4252.92,-5885.74"/>
</g>
<!-- aggregate_12_3 -->
<g id="node810" class="node">
<title>aggregate_12_3</title>
<polygon fill="lightyellow" stroke="black" points="4390.51,-5787.98 4155.06,-5787.98 4094.49,-5683.98 4329.94,-5683.98 4390.51,-5787.98"/>
<text text-anchor="middle" x="4242.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L3</text>
<text text-anchor="middle" x="4242.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4242.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4242.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_3&#45;&gt;aggregate_12_3 -->
<g id="edge796" class="edge">
<title>expert_12_3&#45;&gt;aggregate_12_3</title>
<path fill="none" stroke="black" d="M4242.5,-5823.85C4242.5,-5816.16 4242.5,-5807.35 4242.5,-5798.35"/>
<polygon fill="black" stroke="black" points="4246,-5798.16 4242.5,-5788.16 4239,-5798.16 4246,-5798.16"/>
</g>
<!-- attention_12_4 -->
<g id="node811" class="node">
<title>attention_12_4</title>
<polygon fill="lightgreen" stroke="black" points="4325.5,-5647.98 4157.5,-5647.98 4157.5,-5595.98 4325.5,-5595.98 4325.5,-5647.98"/>
<text text-anchor="middle" x="4241.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_12_L4</text>
<text text-anchor="middle" x="4241.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4241.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4241.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_3&#45;&gt;attention_12_4 -->
<g id="edge797" class="edge">
<title>aggregate_12_3&#45;&gt;attention_12_4</title>
<path fill="none" stroke="black" d="M4242.04,-5683.9C4241.97,-5675.23 4241.89,-5666.41 4241.82,-5658.27"/>
<polygon fill="black" stroke="black" points="4245.31,-5657.99 4241.72,-5648.03 4238.31,-5658.06 4245.31,-5657.99"/>
</g>
<!-- gate_12_4 -->
<g id="node812" class="node">
<title>gate_12_4</title>
<polygon fill="lightyellow" stroke="black" points="4388.51,-5559.98 4153.06,-5559.98 4092.49,-5455.98 4327.94,-5455.98 4388.51,-5559.98"/>
<text text-anchor="middle" x="4240.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_12_L4</text>
<text text-anchor="middle" x="4240.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4240.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4240.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_4&#45;&gt;gate_12_4 -->
<g id="edge798" class="edge">
<title>attention_12_4&#45;&gt;gate_12_4</title>
<path fill="none" stroke="black" d="M4241.28,-5595.85C4241.21,-5588.16 4241.13,-5579.35 4241.05,-5570.35"/>
<polygon fill="black" stroke="black" points="4244.55,-5570.13 4240.96,-5560.16 4237.55,-5570.19 4244.55,-5570.13"/>
</g>
<!-- expert_12_4 -->
<g id="node813" class="node">
<title>expert_12_4</title>
<polygon fill="lightgreen" stroke="black" points="4315,-5419.98 4166,-5419.98 4166,-5367.98 4315,-5367.98 4315,-5419.98"/>
<text text-anchor="middle" x="4240.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_12_L4</text>
<text text-anchor="middle" x="4240.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4240.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4240.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_4&#45;&gt;expert_12_4 -->
<g id="edge799" class="edge">
<title>gate_12_4&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" d="M4233.77,-5455.9C4233.69,-5447.23 4233.83,-5438.41 4234.18,-5430.27"/>
<polygon fill="black" stroke="black" points="4237.69,-5430.21 4234.77,-5420.03 4230.7,-5429.81 4237.69,-5430.21"/>
</g>
<!-- gate_12_4&#45;&gt;expert_12_4 -->
<g id="edge1253" class="edge">
<title>gate_12_4&#45;&gt;expert_12_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4247.23,-5455.9C4247.31,-5447.23 4247.17,-5438.41 4246.82,-5430.27"/>
<polygon fill="red" stroke="red" points="4250.3,-5429.81 4246.23,-5420.03 4243.31,-5430.21 4250.3,-5429.81"/>
</g>
<!-- aggregate_12_4 -->
<g id="node814" class="node">
<title>aggregate_12_4</title>
<polygon fill="lightyellow" stroke="black" points="4387.51,-5331.98 4152.06,-5331.98 4091.49,-5227.98 4326.94,-5227.98 4387.51,-5331.98"/>
<text text-anchor="middle" x="4239.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L4</text>
<text text-anchor="middle" x="4239.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4239.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4239.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_4&#45;&gt;aggregate_12_4 -->
<g id="edge800" class="edge">
<title>expert_12_4&#45;&gt;aggregate_12_4</title>
<path fill="none" stroke="black" d="M4240.28,-5367.85C4240.21,-5360.16 4240.13,-5351.35 4240.05,-5342.35"/>
<polygon fill="black" stroke="black" points="4243.55,-5342.13 4239.96,-5332.16 4236.55,-5342.19 4243.55,-5342.13"/>
</g>
<!-- attention_12_5 -->
<g id="node815" class="node">
<title>attention_12_5</title>
<polygon fill="lightgreen" stroke="black" points="4323.5,-5191.98 4155.5,-5191.98 4155.5,-5139.98 4323.5,-5139.98 4323.5,-5191.98"/>
<text text-anchor="middle" x="4239.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_12_L5</text>
<text text-anchor="middle" x="4239.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4239.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4239.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_4&#45;&gt;attention_12_5 -->
<g id="edge801" class="edge">
<title>aggregate_12_4&#45;&gt;attention_12_5</title>
<path fill="none" stroke="black" d="M4239.5,-5227.9C4239.5,-5219.23 4239.5,-5210.41 4239.5,-5202.27"/>
<polygon fill="black" stroke="black" points="4243,-5202.03 4239.5,-5192.03 4236,-5202.03 4243,-5202.03"/>
</g>
<!-- gate_12_5 -->
<g id="node816" class="node">
<title>gate_12_5</title>
<polygon fill="lightyellow" stroke="black" points="4387.51,-5103.98 4152.06,-5103.98 4091.49,-4999.98 4326.94,-4999.98 4387.51,-5103.98"/>
<text text-anchor="middle" x="4239.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_12_L5</text>
<text text-anchor="middle" x="4239.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4239.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4239.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_5&#45;&gt;gate_12_5 -->
<g id="edge802" class="edge">
<title>attention_12_5&#45;&gt;gate_12_5</title>
<path fill="none" stroke="black" d="M4239.5,-5139.85C4239.5,-5132.16 4239.5,-5123.35 4239.5,-5114.35"/>
<polygon fill="black" stroke="black" points="4243,-5114.16 4239.5,-5104.16 4236,-5114.16 4243,-5114.16"/>
</g>
<!-- expert_12_5 -->
<g id="node817" class="node">
<title>expert_12_5</title>
<polygon fill="lightgreen" stroke="black" points="4314,-4963.98 4165,-4963.98 4165,-4911.98 4314,-4911.98 4314,-4963.98"/>
<text text-anchor="middle" x="4239.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_12_L5</text>
<text text-anchor="middle" x="4239.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4239.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4239.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_5&#45;&gt;expert_12_5 -->
<g id="edge803" class="edge">
<title>gate_12_5&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" d="M4232.77,-4999.9C4232.69,-4991.23 4232.83,-4982.41 4233.18,-4974.27"/>
<polygon fill="black" stroke="black" points="4236.69,-4974.21 4233.77,-4964.03 4229.7,-4973.81 4236.69,-4974.21"/>
</g>
<!-- gate_12_5&#45;&gt;expert_12_5 -->
<g id="edge1254" class="edge">
<title>gate_12_5&#45;&gt;expert_12_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4246.23,-4999.9C4246.31,-4991.23 4246.17,-4982.41 4245.82,-4974.27"/>
<polygon fill="red" stroke="red" points="4249.3,-4973.81 4245.23,-4964.03 4242.31,-4974.21 4249.3,-4973.81"/>
</g>
<!-- aggregate_12_5 -->
<g id="node818" class="node">
<title>aggregate_12_5</title>
<polygon fill="lightyellow" stroke="black" points="4387.51,-4875.98 4152.06,-4875.98 4091.49,-4771.98 4326.94,-4771.98 4387.51,-4875.98"/>
<text text-anchor="middle" x="4239.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L5</text>
<text text-anchor="middle" x="4239.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4239.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4239.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_5&#45;&gt;aggregate_12_5 -->
<g id="edge804" class="edge">
<title>expert_12_5&#45;&gt;aggregate_12_5</title>
<path fill="none" stroke="black" d="M4239.5,-4911.85C4239.5,-4904.16 4239.5,-4895.35 4239.5,-4886.35"/>
<polygon fill="black" stroke="black" points="4243,-4886.16 4239.5,-4876.16 4236,-4886.16 4243,-4886.16"/>
</g>
<!-- attention_12_6 -->
<g id="node819" class="node">
<title>attention_12_6</title>
<polygon fill="lightgreen" stroke="black" points="4323.5,-4735.98 4155.5,-4735.98 4155.5,-4683.98 4323.5,-4683.98 4323.5,-4735.98"/>
<text text-anchor="middle" x="4239.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_12_L6</text>
<text text-anchor="middle" x="4239.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4239.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4239.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_5&#45;&gt;attention_12_6 -->
<g id="edge805" class="edge">
<title>aggregate_12_5&#45;&gt;attention_12_6</title>
<path fill="none" stroke="black" d="M4239.5,-4771.9C4239.5,-4763.23 4239.5,-4754.41 4239.5,-4746.27"/>
<polygon fill="black" stroke="black" points="4243,-4746.03 4239.5,-4736.03 4236,-4746.03 4243,-4746.03"/>
</g>
<!-- gate_12_6 -->
<g id="node820" class="node">
<title>gate_12_6</title>
<polygon fill="lightyellow" stroke="black" points="4384.51,-4647.98 4149.06,-4647.98 4088.49,-4543.98 4323.94,-4543.98 4384.51,-4647.98"/>
<text text-anchor="middle" x="4236.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_12_L6</text>
<text text-anchor="middle" x="4236.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4236.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4236.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_6&#45;&gt;gate_12_6 -->
<g id="edge806" class="edge">
<title>attention_12_6&#45;&gt;gate_12_6</title>
<path fill="none" stroke="black" d="M4238.83,-4683.85C4238.62,-4676.16 4238.39,-4667.35 4238.14,-4658.35"/>
<polygon fill="black" stroke="black" points="4241.64,-4658.06 4237.87,-4648.16 4234.64,-4658.25 4241.64,-4658.06"/>
</g>
<!-- expert_12_6 -->
<g id="node821" class="node">
<title>expert_12_6</title>
<polygon fill="lightgreen" stroke="black" points="4309,-4507.98 4160,-4507.98 4160,-4455.98 4309,-4455.98 4309,-4507.98"/>
<text text-anchor="middle" x="4234.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_12_L6</text>
<text text-anchor="middle" x="4234.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4234.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4234.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_6&#45;&gt;expert_12_6 -->
<g id="edge807" class="edge">
<title>gate_12_6&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" d="M4228.86,-4543.9C4228.63,-4535.23 4228.6,-4526.41 4228.81,-4518.27"/>
<polygon fill="black" stroke="black" points="4232.32,-4518.16 4229.21,-4508.03 4225.32,-4517.88 4232.32,-4518.16"/>
</g>
<!-- gate_12_6&#45;&gt;expert_12_6 -->
<g id="edge1255" class="edge">
<title>gate_12_6&#45;&gt;expert_12_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4242.32,-4543.9C4242.24,-4535.23 4241.95,-4526.41 4241.45,-4518.27"/>
<polygon fill="red" stroke="red" points="4244.92,-4517.74 4240.68,-4508.03 4237.94,-4518.26 4244.92,-4517.74"/>
</g>
<!-- aggregate_12_6 -->
<g id="node822" class="node">
<title>aggregate_12_6</title>
<polygon fill="lightyellow" stroke="black" points="4381.51,-4419.98 4146.06,-4419.98 4085.49,-4315.98 4320.94,-4315.98 4381.51,-4419.98"/>
<text text-anchor="middle" x="4233.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L6</text>
<text text-anchor="middle" x="4233.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4233.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4233.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_6&#45;&gt;aggregate_12_6 -->
<g id="edge808" class="edge">
<title>expert_12_6&#45;&gt;aggregate_12_6</title>
<path fill="none" stroke="black" d="M4234.28,-4455.85C4234.21,-4448.16 4234.13,-4439.35 4234.05,-4430.35"/>
<polygon fill="black" stroke="black" points="4237.55,-4430.13 4233.96,-4420.16 4230.55,-4430.19 4237.55,-4430.13"/>
</g>
<!-- attention_12_7 -->
<g id="node823" class="node">
<title>attention_12_7</title>
<polygon fill="lightgreen" stroke="black" points="4316.5,-4279.98 4148.5,-4279.98 4148.5,-4227.98 4316.5,-4227.98 4316.5,-4279.98"/>
<text text-anchor="middle" x="4232.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_12_L7</text>
<text text-anchor="middle" x="4232.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4232.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4232.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_6&#45;&gt;attention_12_7 -->
<g id="edge809" class="edge">
<title>aggregate_12_6&#45;&gt;attention_12_7</title>
<path fill="none" stroke="black" d="M4233.04,-4315.9C4232.97,-4307.23 4232.89,-4298.41 4232.82,-4290.27"/>
<polygon fill="black" stroke="black" points="4236.31,-4289.99 4232.72,-4280.03 4229.31,-4290.06 4236.31,-4289.99"/>
</g>
<!-- gate_12_7 -->
<g id="node824" class="node">
<title>gate_12_7</title>
<polygon fill="lightyellow" stroke="black" points="4380.51,-4191.98 4145.06,-4191.98 4084.49,-4087.98 4319.94,-4087.98 4380.51,-4191.98"/>
<text text-anchor="middle" x="4232.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_12_L7</text>
<text text-anchor="middle" x="4232.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4232.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4232.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_7&#45;&gt;gate_12_7 -->
<g id="edge810" class="edge">
<title>attention_12_7&#45;&gt;gate_12_7</title>
<path fill="none" stroke="black" d="M4232.5,-4227.85C4232.5,-4220.16 4232.5,-4211.35 4232.5,-4202.35"/>
<polygon fill="black" stroke="black" points="4236,-4202.16 4232.5,-4192.16 4229,-4202.16 4236,-4202.16"/>
</g>
<!-- expert_12_7 -->
<g id="node825" class="node">
<title>expert_12_7</title>
<polygon fill="lightgreen" stroke="black" points="4307,-4051.98 4158,-4051.98 4158,-3999.98 4307,-3999.98 4307,-4051.98"/>
<text text-anchor="middle" x="4232.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_12_L7</text>
<text text-anchor="middle" x="4232.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4232.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4232.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_7&#45;&gt;expert_12_7 -->
<g id="edge811" class="edge">
<title>gate_12_7&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" d="M4225.77,-4087.9C4225.69,-4079.23 4225.83,-4070.41 4226.18,-4062.27"/>
<polygon fill="black" stroke="black" points="4229.69,-4062.21 4226.77,-4052.03 4222.7,-4061.81 4229.69,-4062.21"/>
</g>
<!-- gate_12_7&#45;&gt;expert_12_7 -->
<g id="edge1256" class="edge">
<title>gate_12_7&#45;&gt;expert_12_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4239.23,-4087.9C4239.31,-4079.23 4239.17,-4070.41 4238.82,-4062.27"/>
<polygon fill="red" stroke="red" points="4242.3,-4061.81 4238.23,-4052.03 4235.31,-4062.21 4242.3,-4061.81"/>
</g>
<!-- aggregate_12_7 -->
<g id="node826" class="node">
<title>aggregate_12_7</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-3963.98 4144.06,-3963.98 4083.49,-3859.98 4318.94,-3859.98 4379.51,-3963.98"/>
<text text-anchor="middle" x="4231.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L7</text>
<text text-anchor="middle" x="4231.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_7&#45;&gt;aggregate_12_7 -->
<g id="edge812" class="edge">
<title>expert_12_7&#45;&gt;aggregate_12_7</title>
<path fill="none" stroke="black" d="M4232.28,-3999.85C4232.21,-3992.16 4232.13,-3983.35 4232.05,-3974.35"/>
<polygon fill="black" stroke="black" points="4235.55,-3974.13 4231.96,-3964.16 4228.55,-3974.19 4235.55,-3974.13"/>
</g>
<!-- attention_12_8 -->
<g id="node827" class="node">
<title>attention_12_8</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-3823.98 4147.5,-3823.98 4147.5,-3771.98 4315.5,-3771.98 4315.5,-3823.98"/>
<text text-anchor="middle" x="4231.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_12_L8</text>
<text text-anchor="middle" x="4231.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_7&#45;&gt;attention_12_8 -->
<g id="edge813" class="edge">
<title>aggregate_12_7&#45;&gt;attention_12_8</title>
<path fill="none" stroke="black" d="M4231.5,-3859.9C4231.5,-3851.23 4231.5,-3842.41 4231.5,-3834.27"/>
<polygon fill="black" stroke="black" points="4235,-3834.03 4231.5,-3824.03 4228,-3834.03 4235,-3834.03"/>
</g>
<!-- gate_12_8 -->
<g id="node828" class="node">
<title>gate_12_8</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-3735.98 4144.06,-3735.98 4083.49,-3631.98 4318.94,-3631.98 4379.51,-3735.98"/>
<text text-anchor="middle" x="4231.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_12_L8</text>
<text text-anchor="middle" x="4231.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_8&#45;&gt;gate_12_8 -->
<g id="edge814" class="edge">
<title>attention_12_8&#45;&gt;gate_12_8</title>
<path fill="none" stroke="black" d="M4231.5,-3771.85C4231.5,-3764.16 4231.5,-3755.35 4231.5,-3746.35"/>
<polygon fill="black" stroke="black" points="4235,-3746.16 4231.5,-3736.16 4228,-3746.16 4235,-3746.16"/>
</g>
<!-- expert_12_8 -->
<g id="node829" class="node">
<title>expert_12_8</title>
<polygon fill="lightgreen" stroke="black" points="4306,-3595.98 4157,-3595.98 4157,-3543.98 4306,-3543.98 4306,-3595.98"/>
<text text-anchor="middle" x="4231.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_12_L8</text>
<text text-anchor="middle" x="4231.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_8&#45;&gt;expert_12_8 -->
<g id="edge815" class="edge">
<title>gate_12_8&#45;&gt;expert_12_8</title>
<path fill="none" stroke="black" d="M4224.77,-3631.9C4224.69,-3623.23 4224.83,-3614.41 4225.18,-3606.27"/>
<polygon fill="black" stroke="black" points="4228.69,-3606.21 4225.77,-3596.03 4221.7,-3605.81 4228.69,-3606.21"/>
</g>
<!-- gate_12_8&#45;&gt;expert_12_8 -->
<g id="edge1257" class="edge">
<title>gate_12_8&#45;&gt;expert_12_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-3631.9C4238.31,-3623.23 4238.17,-3614.41 4237.82,-3606.27"/>
<polygon fill="red" stroke="red" points="4241.3,-3605.81 4237.23,-3596.03 4234.31,-3606.21 4241.3,-3605.81"/>
</g>
<!-- aggregate_12_8 -->
<g id="node830" class="node">
<title>aggregate_12_8</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-3507.98 4144.06,-3507.98 4083.49,-3403.98 4318.94,-3403.98 4379.51,-3507.98"/>
<text text-anchor="middle" x="4231.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L8</text>
<text text-anchor="middle" x="4231.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_8&#45;&gt;aggregate_12_8 -->
<g id="edge816" class="edge">
<title>expert_12_8&#45;&gt;aggregate_12_8</title>
<path fill="none" stroke="black" d="M4231.5,-3543.85C4231.5,-3536.16 4231.5,-3527.35 4231.5,-3518.35"/>
<polygon fill="black" stroke="black" points="4235,-3518.16 4231.5,-3508.16 4228,-3518.16 4235,-3518.16"/>
</g>
<!-- attention_12_9 -->
<g id="node831" class="node">
<title>attention_12_9</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-3367.98 4147.5,-3367.98 4147.5,-3315.98 4315.5,-3315.98 4315.5,-3367.98"/>
<text text-anchor="middle" x="4231.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_12_L9</text>
<text text-anchor="middle" x="4231.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_8&#45;&gt;attention_12_9 -->
<g id="edge817" class="edge">
<title>aggregate_12_8&#45;&gt;attention_12_9</title>
<path fill="none" stroke="black" d="M4231.5,-3403.9C4231.5,-3395.23 4231.5,-3386.41 4231.5,-3378.27"/>
<polygon fill="black" stroke="black" points="4235,-3378.03 4231.5,-3368.03 4228,-3378.03 4235,-3378.03"/>
</g>
<!-- gate_12_9 -->
<g id="node832" class="node">
<title>gate_12_9</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-3279.98 4144.06,-3279.98 4083.49,-3175.98 4318.94,-3175.98 4379.51,-3279.98"/>
<text text-anchor="middle" x="4231.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_12_L9</text>
<text text-anchor="middle" x="4231.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_9&#45;&gt;gate_12_9 -->
<g id="edge818" class="edge">
<title>attention_12_9&#45;&gt;gate_12_9</title>
<path fill="none" stroke="black" d="M4231.5,-3315.85C4231.5,-3308.16 4231.5,-3299.35 4231.5,-3290.35"/>
<polygon fill="black" stroke="black" points="4235,-3290.16 4231.5,-3280.16 4228,-3290.16 4235,-3290.16"/>
</g>
<!-- expert_12_9 -->
<g id="node833" class="node">
<title>expert_12_9</title>
<polygon fill="lightgreen" stroke="black" points="4306,-3139.98 4157,-3139.98 4157,-3087.98 4306,-3087.98 4306,-3139.98"/>
<text text-anchor="middle" x="4231.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_12_L9</text>
<text text-anchor="middle" x="4231.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_9&#45;&gt;expert_12_9 -->
<g id="edge819" class="edge">
<title>gate_12_9&#45;&gt;expert_12_9</title>
<path fill="none" stroke="black" d="M4224.77,-3175.9C4224.69,-3167.23 4224.83,-3158.41 4225.18,-3150.27"/>
<polygon fill="black" stroke="black" points="4228.69,-3150.21 4225.77,-3140.03 4221.7,-3149.81 4228.69,-3150.21"/>
</g>
<!-- gate_12_9&#45;&gt;expert_12_9 -->
<g id="edge1258" class="edge">
<title>gate_12_9&#45;&gt;expert_12_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-3175.9C4238.31,-3167.23 4238.17,-3158.41 4237.82,-3150.27"/>
<polygon fill="red" stroke="red" points="4241.3,-3149.81 4237.23,-3140.03 4234.31,-3150.21 4241.3,-3149.81"/>
</g>
<!-- aggregate_12_9 -->
<g id="node834" class="node">
<title>aggregate_12_9</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-3051.98 4144.06,-3051.98 4083.49,-2947.98 4318.94,-2947.98 4379.51,-3051.98"/>
<text text-anchor="middle" x="4231.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L9</text>
<text text-anchor="middle" x="4231.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_9&#45;&gt;aggregate_12_9 -->
<g id="edge820" class="edge">
<title>expert_12_9&#45;&gt;aggregate_12_9</title>
<path fill="none" stroke="black" d="M4231.5,-3087.85C4231.5,-3080.16 4231.5,-3071.35 4231.5,-3062.35"/>
<polygon fill="black" stroke="black" points="4235,-3062.16 4231.5,-3052.16 4228,-3062.16 4235,-3062.16"/>
</g>
<!-- attention_12_10 -->
<g id="node835" class="node">
<title>attention_12_10</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-2911.98 4147.5,-2911.98 4147.5,-2859.98 4315.5,-2859.98 4315.5,-2911.98"/>
<text text-anchor="middle" x="4231.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_12_L10</text>
<text text-anchor="middle" x="4231.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_9&#45;&gt;attention_12_10 -->
<g id="edge821" class="edge">
<title>aggregate_12_9&#45;&gt;attention_12_10</title>
<path fill="none" stroke="black" d="M4231.5,-2947.9C4231.5,-2939.23 4231.5,-2930.41 4231.5,-2922.27"/>
<polygon fill="black" stroke="black" points="4235,-2922.03 4231.5,-2912.03 4228,-2922.03 4235,-2922.03"/>
</g>
<!-- gate_12_10 -->
<g id="node836" class="node">
<title>gate_12_10</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-2823.98 4144.06,-2823.98 4083.49,-2719.98 4318.94,-2719.98 4379.51,-2823.98"/>
<text text-anchor="middle" x="4231.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_12_L10</text>
<text text-anchor="middle" x="4231.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_10&#45;&gt;gate_12_10 -->
<g id="edge822" class="edge">
<title>attention_12_10&#45;&gt;gate_12_10</title>
<path fill="none" stroke="black" d="M4231.5,-2859.85C4231.5,-2852.16 4231.5,-2843.35 4231.5,-2834.35"/>
<polygon fill="black" stroke="black" points="4235,-2834.16 4231.5,-2824.16 4228,-2834.16 4235,-2834.16"/>
</g>
<!-- expert_12_10 -->
<g id="node837" class="node">
<title>expert_12_10</title>
<polygon fill="lightgreen" stroke="black" points="4306,-2683.98 4157,-2683.98 4157,-2631.98 4306,-2631.98 4306,-2683.98"/>
<text text-anchor="middle" x="4231.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_12_L10</text>
<text text-anchor="middle" x="4231.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_10&#45;&gt;expert_12_10 -->
<g id="edge823" class="edge">
<title>gate_12_10&#45;&gt;expert_12_10</title>
<path fill="none" stroke="black" d="M4224.77,-2719.9C4224.69,-2711.23 4224.83,-2702.41 4225.18,-2694.27"/>
<polygon fill="black" stroke="black" points="4228.69,-2694.21 4225.77,-2684.03 4221.7,-2693.81 4228.69,-2694.21"/>
</g>
<!-- gate_12_10&#45;&gt;expert_12_10 -->
<g id="edge1259" class="edge">
<title>gate_12_10&#45;&gt;expert_12_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-2719.9C4238.31,-2711.23 4238.17,-2702.41 4237.82,-2694.27"/>
<polygon fill="red" stroke="red" points="4241.3,-2693.81 4237.23,-2684.03 4234.31,-2694.21 4241.3,-2693.81"/>
</g>
<!-- aggregate_12_10 -->
<g id="node838" class="node">
<title>aggregate_12_10</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-2595.98 4144.06,-2595.98 4083.49,-2491.98 4318.94,-2491.98 4379.51,-2595.98"/>
<text text-anchor="middle" x="4231.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L10</text>
<text text-anchor="middle" x="4231.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_10&#45;&gt;aggregate_12_10 -->
<g id="edge824" class="edge">
<title>expert_12_10&#45;&gt;aggregate_12_10</title>
<path fill="none" stroke="black" d="M4231.5,-2631.85C4231.5,-2624.16 4231.5,-2615.35 4231.5,-2606.35"/>
<polygon fill="black" stroke="black" points="4235,-2606.16 4231.5,-2596.16 4228,-2606.16 4235,-2606.16"/>
</g>
<!-- attention_12_11 -->
<g id="node839" class="node">
<title>attention_12_11</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-2455.98 4147.5,-2455.98 4147.5,-2403.98 4315.5,-2403.98 4315.5,-2455.98"/>
<text text-anchor="middle" x="4231.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_12_L11</text>
<text text-anchor="middle" x="4231.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_10&#45;&gt;attention_12_11 -->
<g id="edge825" class="edge">
<title>aggregate_12_10&#45;&gt;attention_12_11</title>
<path fill="none" stroke="black" d="M4231.5,-2491.9C4231.5,-2483.23 4231.5,-2474.41 4231.5,-2466.27"/>
<polygon fill="black" stroke="black" points="4235,-2466.03 4231.5,-2456.03 4228,-2466.03 4235,-2466.03"/>
</g>
<!-- gate_12_11 -->
<g id="node840" class="node">
<title>gate_12_11</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-2367.98 4144.06,-2367.98 4083.49,-2263.98 4318.94,-2263.98 4379.51,-2367.98"/>
<text text-anchor="middle" x="4231.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_12_L11</text>
<text text-anchor="middle" x="4231.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_11&#45;&gt;gate_12_11 -->
<g id="edge826" class="edge">
<title>attention_12_11&#45;&gt;gate_12_11</title>
<path fill="none" stroke="black" d="M4231.5,-2403.85C4231.5,-2396.16 4231.5,-2387.35 4231.5,-2378.35"/>
<polygon fill="black" stroke="black" points="4235,-2378.16 4231.5,-2368.16 4228,-2378.16 4235,-2378.16"/>
</g>
<!-- expert_12_11 -->
<g id="node841" class="node">
<title>expert_12_11</title>
<polygon fill="lightgreen" stroke="black" points="4306,-2227.98 4157,-2227.98 4157,-2175.98 4306,-2175.98 4306,-2227.98"/>
<text text-anchor="middle" x="4231.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_12_L11</text>
<text text-anchor="middle" x="4231.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_11&#45;&gt;expert_12_11 -->
<g id="edge827" class="edge">
<title>gate_12_11&#45;&gt;expert_12_11</title>
<path fill="none" stroke="black" d="M4224.77,-2263.9C4224.69,-2255.23 4224.83,-2246.41 4225.18,-2238.27"/>
<polygon fill="black" stroke="black" points="4228.69,-2238.21 4225.77,-2228.03 4221.7,-2237.81 4228.69,-2238.21"/>
</g>
<!-- gate_12_11&#45;&gt;expert_12_11 -->
<g id="edge1260" class="edge">
<title>gate_12_11&#45;&gt;expert_12_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-2263.9C4238.31,-2255.23 4238.17,-2246.41 4237.82,-2238.27"/>
<polygon fill="red" stroke="red" points="4241.3,-2237.81 4237.23,-2228.03 4234.31,-2238.21 4241.3,-2237.81"/>
</g>
<!-- aggregate_12_11 -->
<g id="node842" class="node">
<title>aggregate_12_11</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-2139.98 4144.06,-2139.98 4083.49,-2035.98 4318.94,-2035.98 4379.51,-2139.98"/>
<text text-anchor="middle" x="4231.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L11</text>
<text text-anchor="middle" x="4231.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_11&#45;&gt;aggregate_12_11 -->
<g id="edge828" class="edge">
<title>expert_12_11&#45;&gt;aggregate_12_11</title>
<path fill="none" stroke="black" d="M4231.5,-2175.85C4231.5,-2168.16 4231.5,-2159.35 4231.5,-2150.35"/>
<polygon fill="black" stroke="black" points="4235,-2150.16 4231.5,-2140.16 4228,-2150.16 4235,-2150.16"/>
</g>
<!-- attention_12_12 -->
<g id="node843" class="node">
<title>attention_12_12</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-1999.98 4147.5,-1999.98 4147.5,-1947.98 4315.5,-1947.98 4315.5,-1999.98"/>
<text text-anchor="middle" x="4231.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_12_L12</text>
<text text-anchor="middle" x="4231.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_11&#45;&gt;attention_12_12 -->
<g id="edge829" class="edge">
<title>aggregate_12_11&#45;&gt;attention_12_12</title>
<path fill="none" stroke="black" d="M4231.5,-2035.9C4231.5,-2027.23 4231.5,-2018.41 4231.5,-2010.27"/>
<polygon fill="black" stroke="black" points="4235,-2010.03 4231.5,-2000.03 4228,-2010.03 4235,-2010.03"/>
</g>
<!-- gate_12_12 -->
<g id="node844" class="node">
<title>gate_12_12</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-1911.98 4144.06,-1911.98 4083.49,-1807.98 4318.94,-1807.98 4379.51,-1911.98"/>
<text text-anchor="middle" x="4231.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_12_L12</text>
<text text-anchor="middle" x="4231.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_12&#45;&gt;gate_12_12 -->
<g id="edge830" class="edge">
<title>attention_12_12&#45;&gt;gate_12_12</title>
<path fill="none" stroke="black" d="M4231.5,-1947.85C4231.5,-1940.16 4231.5,-1931.35 4231.5,-1922.35"/>
<polygon fill="black" stroke="black" points="4235,-1922.16 4231.5,-1912.16 4228,-1922.16 4235,-1922.16"/>
</g>
<!-- expert_12_12 -->
<g id="node845" class="node">
<title>expert_12_12</title>
<polygon fill="lightgreen" stroke="black" points="4306,-1771.98 4157,-1771.98 4157,-1719.98 4306,-1719.98 4306,-1771.98"/>
<text text-anchor="middle" x="4231.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_12_L12</text>
<text text-anchor="middle" x="4231.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_12&#45;&gt;expert_12_12 -->
<g id="edge831" class="edge">
<title>gate_12_12&#45;&gt;expert_12_12</title>
<path fill="none" stroke="black" d="M4224.77,-1807.9C4224.69,-1799.23 4224.83,-1790.41 4225.18,-1782.27"/>
<polygon fill="black" stroke="black" points="4228.69,-1782.21 4225.77,-1772.03 4221.7,-1781.81 4228.69,-1782.21"/>
</g>
<!-- gate_12_12&#45;&gt;expert_12_12 -->
<g id="edge1261" class="edge">
<title>gate_12_12&#45;&gt;expert_12_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-1807.9C4238.31,-1799.23 4238.17,-1790.41 4237.82,-1782.27"/>
<polygon fill="red" stroke="red" points="4241.3,-1781.81 4237.23,-1772.03 4234.31,-1782.21 4241.3,-1781.81"/>
</g>
<!-- aggregate_12_12 -->
<g id="node846" class="node">
<title>aggregate_12_12</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-1683.98 4144.06,-1683.98 4083.49,-1579.98 4318.94,-1579.98 4379.51,-1683.98"/>
<text text-anchor="middle" x="4231.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L12</text>
<text text-anchor="middle" x="4231.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_12&#45;&gt;aggregate_12_12 -->
<g id="edge832" class="edge">
<title>expert_12_12&#45;&gt;aggregate_12_12</title>
<path fill="none" stroke="black" d="M4231.5,-1719.85C4231.5,-1712.16 4231.5,-1703.35 4231.5,-1694.35"/>
<polygon fill="black" stroke="black" points="4235,-1694.16 4231.5,-1684.16 4228,-1694.16 4235,-1694.16"/>
</g>
<!-- attention_12_13 -->
<g id="node847" class="node">
<title>attention_12_13</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-1543.98 4147.5,-1543.98 4147.5,-1491.98 4315.5,-1491.98 4315.5,-1543.98"/>
<text text-anchor="middle" x="4231.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_12_L13</text>
<text text-anchor="middle" x="4231.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_12&#45;&gt;attention_12_13 -->
<g id="edge833" class="edge">
<title>aggregate_12_12&#45;&gt;attention_12_13</title>
<path fill="none" stroke="black" d="M4231.5,-1579.9C4231.5,-1571.23 4231.5,-1562.41 4231.5,-1554.27"/>
<polygon fill="black" stroke="black" points="4235,-1554.03 4231.5,-1544.03 4228,-1554.03 4235,-1554.03"/>
</g>
<!-- gate_12_13 -->
<g id="node848" class="node">
<title>gate_12_13</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-1455.98 4144.06,-1455.98 4083.49,-1351.98 4318.94,-1351.98 4379.51,-1455.98"/>
<text text-anchor="middle" x="4231.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_12_L13</text>
<text text-anchor="middle" x="4231.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_13&#45;&gt;gate_12_13 -->
<g id="edge834" class="edge">
<title>attention_12_13&#45;&gt;gate_12_13</title>
<path fill="none" stroke="black" d="M4231.5,-1491.85C4231.5,-1484.16 4231.5,-1475.35 4231.5,-1466.35"/>
<polygon fill="black" stroke="black" points="4235,-1466.16 4231.5,-1456.16 4228,-1466.16 4235,-1466.16"/>
</g>
<!-- expert_12_13 -->
<g id="node849" class="node">
<title>expert_12_13</title>
<polygon fill="lightgreen" stroke="black" points="4306,-1315.98 4157,-1315.98 4157,-1263.98 4306,-1263.98 4306,-1315.98"/>
<text text-anchor="middle" x="4231.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_12_L13</text>
<text text-anchor="middle" x="4231.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_13&#45;&gt;expert_12_13 -->
<g id="edge835" class="edge">
<title>gate_12_13&#45;&gt;expert_12_13</title>
<path fill="none" stroke="black" d="M4224.77,-1351.9C4224.69,-1343.23 4224.83,-1334.41 4225.18,-1326.27"/>
<polygon fill="black" stroke="black" points="4228.69,-1326.21 4225.77,-1316.03 4221.7,-1325.81 4228.69,-1326.21"/>
</g>
<!-- gate_12_13&#45;&gt;expert_12_13 -->
<g id="edge1262" class="edge">
<title>gate_12_13&#45;&gt;expert_12_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-1351.9C4238.31,-1343.23 4238.17,-1334.41 4237.82,-1326.27"/>
<polygon fill="red" stroke="red" points="4241.3,-1325.81 4237.23,-1316.03 4234.31,-1326.21 4241.3,-1325.81"/>
</g>
<!-- aggregate_12_13 -->
<g id="node850" class="node">
<title>aggregate_12_13</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-1227.98 4144.06,-1227.98 4083.49,-1123.98 4318.94,-1123.98 4379.51,-1227.98"/>
<text text-anchor="middle" x="4231.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L13</text>
<text text-anchor="middle" x="4231.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_13&#45;&gt;aggregate_12_13 -->
<g id="edge836" class="edge">
<title>expert_12_13&#45;&gt;aggregate_12_13</title>
<path fill="none" stroke="black" d="M4231.5,-1263.85C4231.5,-1256.16 4231.5,-1247.35 4231.5,-1238.35"/>
<polygon fill="black" stroke="black" points="4235,-1238.16 4231.5,-1228.16 4228,-1238.16 4235,-1238.16"/>
</g>
<!-- attention_12_14 -->
<g id="node851" class="node">
<title>attention_12_14</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-1087.98 4147.5,-1087.98 4147.5,-1035.98 4315.5,-1035.98 4315.5,-1087.98"/>
<text text-anchor="middle" x="4231.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_12_L14</text>
<text text-anchor="middle" x="4231.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_13&#45;&gt;attention_12_14 -->
<g id="edge837" class="edge">
<title>aggregate_12_13&#45;&gt;attention_12_14</title>
<path fill="none" stroke="black" d="M4231.5,-1123.9C4231.5,-1115.23 4231.5,-1106.41 4231.5,-1098.27"/>
<polygon fill="black" stroke="black" points="4235,-1098.03 4231.5,-1088.03 4228,-1098.03 4235,-1098.03"/>
</g>
<!-- gate_12_14 -->
<g id="node852" class="node">
<title>gate_12_14</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-999.98 4144.06,-999.98 4083.49,-895.98 4318.94,-895.98 4379.51,-999.98"/>
<text text-anchor="middle" x="4231.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_12_L14</text>
<text text-anchor="middle" x="4231.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_14&#45;&gt;gate_12_14 -->
<g id="edge838" class="edge">
<title>attention_12_14&#45;&gt;gate_12_14</title>
<path fill="none" stroke="black" d="M4231.5,-1035.85C4231.5,-1028.16 4231.5,-1019.35 4231.5,-1010.35"/>
<polygon fill="black" stroke="black" points="4235,-1010.16 4231.5,-1000.16 4228,-1010.16 4235,-1010.16"/>
</g>
<!-- expert_12_14 -->
<g id="node853" class="node">
<title>expert_12_14</title>
<polygon fill="lightgreen" stroke="black" points="4306,-859.98 4157,-859.98 4157,-807.98 4306,-807.98 4306,-859.98"/>
<text text-anchor="middle" x="4231.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_12_L14</text>
<text text-anchor="middle" x="4231.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_14&#45;&gt;expert_12_14 -->
<g id="edge839" class="edge">
<title>gate_12_14&#45;&gt;expert_12_14</title>
<path fill="none" stroke="black" d="M4224.77,-895.9C4224.69,-887.23 4224.83,-878.41 4225.18,-870.27"/>
<polygon fill="black" stroke="black" points="4228.69,-870.21 4225.77,-860.03 4221.7,-869.81 4228.69,-870.21"/>
</g>
<!-- gate_12_14&#45;&gt;expert_12_14 -->
<g id="edge1263" class="edge">
<title>gate_12_14&#45;&gt;expert_12_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-895.9C4238.31,-887.23 4238.17,-878.41 4237.82,-870.27"/>
<polygon fill="red" stroke="red" points="4241.3,-869.81 4237.23,-860.03 4234.31,-870.21 4241.3,-869.81"/>
</g>
<!-- aggregate_12_14 -->
<g id="node854" class="node">
<title>aggregate_12_14</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-771.98 4144.06,-771.98 4083.49,-667.98 4318.94,-667.98 4379.51,-771.98"/>
<text text-anchor="middle" x="4231.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L14</text>
<text text-anchor="middle" x="4231.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_14&#45;&gt;aggregate_12_14 -->
<g id="edge840" class="edge">
<title>expert_12_14&#45;&gt;aggregate_12_14</title>
<path fill="none" stroke="black" d="M4231.5,-807.85C4231.5,-800.16 4231.5,-791.35 4231.5,-782.35"/>
<polygon fill="black" stroke="black" points="4235,-782.16 4231.5,-772.16 4228,-782.16 4235,-782.16"/>
</g>
<!-- attention_12_15 -->
<g id="node855" class="node">
<title>attention_12_15</title>
<polygon fill="lightgreen" stroke="black" points="4315.5,-631.98 4147.5,-631.98 4147.5,-579.98 4315.5,-579.98 4315.5,-631.98"/>
<text text-anchor="middle" x="4231.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_12_L15</text>
<text text-anchor="middle" x="4231.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4231.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4231.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_12_14&#45;&gt;attention_12_15 -->
<g id="edge841" class="edge">
<title>aggregate_12_14&#45;&gt;attention_12_15</title>
<path fill="none" stroke="black" d="M4231.5,-667.9C4231.5,-659.23 4231.5,-650.41 4231.5,-642.27"/>
<polygon fill="black" stroke="black" points="4235,-642.03 4231.5,-632.03 4228,-642.03 4235,-642.03"/>
</g>
<!-- gate_12_15 -->
<g id="node856" class="node">
<title>gate_12_15</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-543.98 4144.06,-543.98 4083.49,-439.98 4318.94,-439.98 4379.51,-543.98"/>
<text text-anchor="middle" x="4231.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_12_L15</text>
<text text-anchor="middle" x="4231.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4231.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_12_15&#45;&gt;gate_12_15 -->
<g id="edge842" class="edge">
<title>attention_12_15&#45;&gt;gate_12_15</title>
<path fill="none" stroke="black" d="M4231.5,-579.85C4231.5,-572.16 4231.5,-563.35 4231.5,-554.35"/>
<polygon fill="black" stroke="black" points="4235,-554.16 4231.5,-544.16 4228,-554.16 4235,-554.16"/>
</g>
<!-- expert_12_15 -->
<g id="node857" class="node">
<title>expert_12_15</title>
<polygon fill="lightgreen" stroke="black" points="4306,-403.98 4157,-403.98 4157,-351.98 4306,-351.98 4306,-403.98"/>
<text text-anchor="middle" x="4231.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_12_L15</text>
<text text-anchor="middle" x="4231.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=12</text>
<text text-anchor="middle" x="4231.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_12_15&#45;&gt;expert_12_15 -->
<g id="edge843" class="edge">
<title>gate_12_15&#45;&gt;expert_12_15</title>
<path fill="none" stroke="black" d="M4224.77,-439.9C4224.69,-431.23 4224.83,-422.41 4225.18,-414.27"/>
<polygon fill="black" stroke="black" points="4228.69,-414.21 4225.77,-404.03 4221.7,-413.81 4228.69,-414.21"/>
</g>
<!-- gate_12_15&#45;&gt;expert_12_15 -->
<g id="edge1264" class="edge">
<title>gate_12_15&#45;&gt;expert_12_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4238.23,-439.9C4238.31,-431.23 4238.17,-422.41 4237.82,-414.27"/>
<polygon fill="red" stroke="red" points="4241.3,-413.81 4237.23,-404.03 4234.31,-414.21 4241.3,-413.81"/>
</g>
<!-- aggregate_12_15 -->
<g id="node858" class="node">
<title>aggregate_12_15</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-315.98 4144.06,-315.98 4083.49,-211.98 4318.94,-211.98 4379.51,-315.98"/>
<text text-anchor="middle" x="4231.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_12_L15</text>
<text text-anchor="middle" x="4231.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4231.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4231.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_12_15&#45;&gt;aggregate_12_15 -->
<g id="edge844" class="edge">
<title>expert_12_15&#45;&gt;aggregate_12_15</title>
<path fill="none" stroke="black" d="M4231.5,-351.85C4231.5,-344.16 4231.5,-335.35 4231.5,-326.35"/>
<polygon fill="black" stroke="black" points="4235,-326.16 4231.5,-316.16 4228,-326.16 4235,-326.16"/>
</g>
<!-- collect_12 -->
<g id="node859" class="node">
<title>collect_12</title>
<polygon fill="lightyellow" stroke="black" points="4379.51,-175.98 4144.06,-175.98 4083.49,-93.98 4318.94,-93.98 4379.51,-175.98"/>
<text text-anchor="middle" x="4231.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_12</text>
<text text-anchor="middle" x="4231.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4231.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_12_15&#45;&gt;collect_12 -->
<g id="edge845" class="edge">
<title>aggregate_12_15&#45;&gt;collect_12</title>
<path fill="none" stroke="black" d="M4231.5,-211.69C4231.5,-203.27 4231.5,-194.56 4231.5,-186.17"/>
<polygon fill="black" stroke="black" points="4235,-186.14 4231.5,-176.14 4228,-186.14 4235,-186.14"/>
</g>
<!-- collect_12&#45;&gt;output -->
<g id="edge1053" class="edge">
<title>collect_12&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4084.51,-95.76C4080.81,-95.12 4077.14,-94.53 4073.5,-93.98 3858.28,-61.6 3217.89,-40.93 2942.14,-33.3"/>
<polygon fill="black" stroke="black" points="2942.18,-29.8 2932.09,-33.03 2941.99,-36.8 2942.18,-29.8"/>
</g>
<!-- distribute_13 -->
<g id="node860" class="node">
<title>distribute_13</title>
<polygon fill="lightyellow" stroke="black" points="4732.73,-7589.98 4492.16,-7589.98 4430.27,-7507.98 4670.85,-7507.98 4732.73,-7589.98"/>
<text text-anchor="middle" x="4581.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_13</text>
<text text-anchor="middle" x="4581.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="4581.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_0 -->
<g id="node861" class="node">
<title>attention_13_0</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-7471.98 4492.5,-7471.98 4492.5,-7419.98 4660.5,-7419.98 4660.5,-7471.98"/>
<text text-anchor="middle" x="4576.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_13_L0</text>
<text text-anchor="middle" x="4576.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_13&#45;&gt;attention_13_0 -->
<g id="edge846" class="edge">
<title>distribute_13&#45;&gt;attention_13_0</title>
<path fill="none" stroke="black" d="M4579.51,-7507.77C4579.09,-7499.34 4578.66,-7490.51 4578.25,-7482.27"/>
<polygon fill="black" stroke="black" points="4581.74,-7482.05 4577.75,-7472.23 4574.75,-7482.4 4581.74,-7482.05"/>
</g>
<!-- gate_13_0 -->
<g id="node862" class="node">
<title>gate_13_0</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-7383.98 4489.06,-7383.98 4428.49,-7279.98 4663.94,-7279.98 4724.51,-7383.98"/>
<text text-anchor="middle" x="4576.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_13_L0</text>
<text text-anchor="middle" x="4576.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4576.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_0&#45;&gt;gate_13_0 -->
<g id="edge847" class="edge">
<title>attention_13_0&#45;&gt;gate_13_0</title>
<path fill="none" stroke="black" d="M4576.5,-7419.85C4576.5,-7412.16 4576.5,-7403.35 4576.5,-7394.35"/>
<polygon fill="black" stroke="black" points="4580,-7394.16 4576.5,-7384.16 4573,-7394.16 4580,-7394.16"/>
</g>
<!-- expert_13_0 -->
<g id="node863" class="node">
<title>expert_13_0</title>
<polygon fill="lightgreen" stroke="black" points="4651,-7243.98 4502,-7243.98 4502,-7191.98 4651,-7191.98 4651,-7243.98"/>
<text text-anchor="middle" x="4576.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_13_L0</text>
<text text-anchor="middle" x="4576.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4576.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_0&#45;&gt;expert_13_0 -->
<g id="edge848" class="edge">
<title>gate_13_0&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" d="M4569.77,-7279.9C4569.69,-7271.23 4569.83,-7262.41 4570.18,-7254.27"/>
<polygon fill="black" stroke="black" points="4573.69,-7254.21 4570.77,-7244.03 4566.7,-7253.81 4573.69,-7254.21"/>
</g>
<!-- gate_13_0&#45;&gt;expert_13_0 -->
<g id="edge1265" class="edge">
<title>gate_13_0&#45;&gt;expert_13_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4583.23,-7279.9C4583.31,-7271.23 4583.17,-7262.41 4582.82,-7254.27"/>
<polygon fill="red" stroke="red" points="4586.3,-7253.81 4582.23,-7244.03 4579.31,-7254.21 4586.3,-7253.81"/>
</g>
<!-- aggregate_13_0 -->
<g id="node864" class="node">
<title>aggregate_13_0</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-7155.98 4489.06,-7155.98 4428.49,-7051.98 4663.94,-7051.98 4724.51,-7155.98"/>
<text text-anchor="middle" x="4576.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L0</text>
<text text-anchor="middle" x="4576.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4576.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4576.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_0&#45;&gt;aggregate_13_0 -->
<g id="edge849" class="edge">
<title>expert_13_0&#45;&gt;aggregate_13_0</title>
<path fill="none" stroke="black" d="M4576.5,-7191.85C4576.5,-7184.16 4576.5,-7175.35 4576.5,-7166.35"/>
<polygon fill="black" stroke="black" points="4580,-7166.16 4576.5,-7156.16 4573,-7166.16 4580,-7166.16"/>
</g>
<!-- attention_13_1 -->
<g id="node865" class="node">
<title>attention_13_1</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-7015.98 4492.5,-7015.98 4492.5,-6963.98 4660.5,-6963.98 4660.5,-7015.98"/>
<text text-anchor="middle" x="4576.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_13_L1</text>
<text text-anchor="middle" x="4576.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_0&#45;&gt;attention_13_1 -->
<g id="edge850" class="edge">
<title>aggregate_13_0&#45;&gt;attention_13_1</title>
<path fill="none" stroke="black" d="M4576.5,-7051.9C4576.5,-7043.23 4576.5,-7034.41 4576.5,-7026.27"/>
<polygon fill="black" stroke="black" points="4580,-7026.03 4576.5,-7016.03 4573,-7026.03 4580,-7026.03"/>
</g>
<!-- gate_13_1 -->
<g id="node866" class="node">
<title>gate_13_1</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-6927.98 4489.06,-6927.98 4428.49,-6823.98 4663.94,-6823.98 4724.51,-6927.98"/>
<text text-anchor="middle" x="4576.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_13_L1</text>
<text text-anchor="middle" x="4576.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4576.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_1&#45;&gt;gate_13_1 -->
<g id="edge851" class="edge">
<title>attention_13_1&#45;&gt;gate_13_1</title>
<path fill="none" stroke="black" d="M4576.5,-6963.85C4576.5,-6956.16 4576.5,-6947.35 4576.5,-6938.35"/>
<polygon fill="black" stroke="black" points="4580,-6938.16 4576.5,-6928.16 4573,-6938.16 4580,-6938.16"/>
</g>
<!-- expert_13_1 -->
<g id="node867" class="node">
<title>expert_13_1</title>
<polygon fill="lightgreen" stroke="black" points="4651,-6787.98 4502,-6787.98 4502,-6735.98 4651,-6735.98 4651,-6787.98"/>
<text text-anchor="middle" x="4576.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_13_L1</text>
<text text-anchor="middle" x="4576.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4576.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_1&#45;&gt;expert_13_1 -->
<g id="edge852" class="edge">
<title>gate_13_1&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" d="M4569.77,-6823.9C4569.69,-6815.23 4569.83,-6806.41 4570.18,-6798.27"/>
<polygon fill="black" stroke="black" points="4573.69,-6798.21 4570.77,-6788.03 4566.7,-6797.81 4573.69,-6798.21"/>
</g>
<!-- gate_13_1&#45;&gt;expert_13_1 -->
<g id="edge1266" class="edge">
<title>gate_13_1&#45;&gt;expert_13_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4583.23,-6823.9C4583.31,-6815.23 4583.17,-6806.41 4582.82,-6798.27"/>
<polygon fill="red" stroke="red" points="4586.3,-6797.81 4582.23,-6788.03 4579.31,-6798.21 4586.3,-6797.81"/>
</g>
<!-- aggregate_13_1 -->
<g id="node868" class="node">
<title>aggregate_13_1</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-6699.98 4489.06,-6699.98 4428.49,-6595.98 4663.94,-6595.98 4724.51,-6699.98"/>
<text text-anchor="middle" x="4576.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L1</text>
<text text-anchor="middle" x="4576.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4576.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4576.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_1&#45;&gt;aggregate_13_1 -->
<g id="edge853" class="edge">
<title>expert_13_1&#45;&gt;aggregate_13_1</title>
<path fill="none" stroke="black" d="M4576.5,-6735.85C4576.5,-6728.16 4576.5,-6719.35 4576.5,-6710.35"/>
<polygon fill="black" stroke="black" points="4580,-6710.16 4576.5,-6700.16 4573,-6710.16 4580,-6710.16"/>
</g>
<!-- attention_13_2 -->
<g id="node869" class="node">
<title>attention_13_2</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-6559.98 4492.5,-6559.98 4492.5,-6507.98 4660.5,-6507.98 4660.5,-6559.98"/>
<text text-anchor="middle" x="4576.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_13_L2</text>
<text text-anchor="middle" x="4576.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_1&#45;&gt;attention_13_2 -->
<g id="edge854" class="edge">
<title>aggregate_13_1&#45;&gt;attention_13_2</title>
<path fill="none" stroke="black" d="M4576.5,-6595.9C4576.5,-6587.23 4576.5,-6578.41 4576.5,-6570.27"/>
<polygon fill="black" stroke="black" points="4580,-6570.03 4576.5,-6560.03 4573,-6570.03 4580,-6570.03"/>
</g>
<!-- gate_13_2 -->
<g id="node870" class="node">
<title>gate_13_2</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-6471.98 4489.06,-6471.98 4428.49,-6367.98 4663.94,-6367.98 4724.51,-6471.98"/>
<text text-anchor="middle" x="4576.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_13_L2</text>
<text text-anchor="middle" x="4576.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4576.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_2&#45;&gt;gate_13_2 -->
<g id="edge855" class="edge">
<title>attention_13_2&#45;&gt;gate_13_2</title>
<path fill="none" stroke="black" d="M4576.5,-6507.85C4576.5,-6500.16 4576.5,-6491.35 4576.5,-6482.35"/>
<polygon fill="black" stroke="black" points="4580,-6482.16 4576.5,-6472.16 4573,-6482.16 4580,-6482.16"/>
</g>
<!-- expert_13_2 -->
<g id="node871" class="node">
<title>expert_13_2</title>
<polygon fill="lightgreen" stroke="black" points="4651,-6331.98 4502,-6331.98 4502,-6279.98 4651,-6279.98 4651,-6331.98"/>
<text text-anchor="middle" x="4576.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_13_L2</text>
<text text-anchor="middle" x="4576.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4576.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_2&#45;&gt;expert_13_2 -->
<g id="edge856" class="edge">
<title>gate_13_2&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" d="M4569.77,-6367.9C4569.69,-6359.23 4569.83,-6350.41 4570.18,-6342.27"/>
<polygon fill="black" stroke="black" points="4573.69,-6342.21 4570.77,-6332.03 4566.7,-6341.81 4573.69,-6342.21"/>
</g>
<!-- gate_13_2&#45;&gt;expert_13_2 -->
<g id="edge1267" class="edge">
<title>gate_13_2&#45;&gt;expert_13_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4583.23,-6367.9C4583.31,-6359.23 4583.17,-6350.41 4582.82,-6342.27"/>
<polygon fill="red" stroke="red" points="4586.3,-6341.81 4582.23,-6332.03 4579.31,-6342.21 4586.3,-6341.81"/>
</g>
<!-- aggregate_13_2 -->
<g id="node872" class="node">
<title>aggregate_13_2</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-6243.98 4489.06,-6243.98 4428.49,-6139.98 4663.94,-6139.98 4724.51,-6243.98"/>
<text text-anchor="middle" x="4576.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L2</text>
<text text-anchor="middle" x="4576.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4576.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4576.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_2&#45;&gt;aggregate_13_2 -->
<g id="edge857" class="edge">
<title>expert_13_2&#45;&gt;aggregate_13_2</title>
<path fill="none" stroke="black" d="M4576.5,-6279.85C4576.5,-6272.16 4576.5,-6263.35 4576.5,-6254.35"/>
<polygon fill="black" stroke="black" points="4580,-6254.16 4576.5,-6244.16 4573,-6254.16 4580,-6254.16"/>
</g>
<!-- attention_13_3 -->
<g id="node873" class="node">
<title>attention_13_3</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-6103.98 4492.5,-6103.98 4492.5,-6051.98 4660.5,-6051.98 4660.5,-6103.98"/>
<text text-anchor="middle" x="4576.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_13_L3</text>
<text text-anchor="middle" x="4576.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_2&#45;&gt;attention_13_3 -->
<g id="edge858" class="edge">
<title>aggregate_13_2&#45;&gt;attention_13_3</title>
<path fill="none" stroke="black" d="M4576.5,-6139.9C4576.5,-6131.23 4576.5,-6122.41 4576.5,-6114.27"/>
<polygon fill="black" stroke="black" points="4580,-6114.03 4576.5,-6104.03 4573,-6114.03 4580,-6114.03"/>
</g>
<!-- gate_13_3 -->
<g id="node874" class="node">
<title>gate_13_3</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-6015.98 4489.06,-6015.98 4428.49,-5911.98 4663.94,-5911.98 4724.51,-6015.98"/>
<text text-anchor="middle" x="4576.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_13_L3</text>
<text text-anchor="middle" x="4576.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4576.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_3&#45;&gt;gate_13_3 -->
<g id="edge859" class="edge">
<title>attention_13_3&#45;&gt;gate_13_3</title>
<path fill="none" stroke="black" d="M4576.5,-6051.85C4576.5,-6044.16 4576.5,-6035.35 4576.5,-6026.35"/>
<polygon fill="black" stroke="black" points="4580,-6026.16 4576.5,-6016.16 4573,-6026.16 4580,-6026.16"/>
</g>
<!-- expert_13_3 -->
<g id="node875" class="node">
<title>expert_13_3</title>
<polygon fill="lightgreen" stroke="black" points="4651,-5875.98 4502,-5875.98 4502,-5823.98 4651,-5823.98 4651,-5875.98"/>
<text text-anchor="middle" x="4576.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_13_L3</text>
<text text-anchor="middle" x="4576.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4576.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_3&#45;&gt;expert_13_3 -->
<g id="edge860" class="edge">
<title>gate_13_3&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" d="M4569.77,-5911.9C4569.69,-5903.23 4569.83,-5894.41 4570.18,-5886.27"/>
<polygon fill="black" stroke="black" points="4573.69,-5886.21 4570.77,-5876.03 4566.7,-5885.81 4573.69,-5886.21"/>
</g>
<!-- gate_13_3&#45;&gt;expert_13_3 -->
<g id="edge1268" class="edge">
<title>gate_13_3&#45;&gt;expert_13_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4583.23,-5911.9C4583.31,-5903.23 4583.17,-5894.41 4582.82,-5886.27"/>
<polygon fill="red" stroke="red" points="4586.3,-5885.81 4582.23,-5876.03 4579.31,-5886.21 4586.3,-5885.81"/>
</g>
<!-- aggregate_13_3 -->
<g id="node876" class="node">
<title>aggregate_13_3</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-5787.98 4489.06,-5787.98 4428.49,-5683.98 4663.94,-5683.98 4724.51,-5787.98"/>
<text text-anchor="middle" x="4576.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L3</text>
<text text-anchor="middle" x="4576.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4576.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4576.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_3&#45;&gt;aggregate_13_3 -->
<g id="edge861" class="edge">
<title>expert_13_3&#45;&gt;aggregate_13_3</title>
<path fill="none" stroke="black" d="M4576.5,-5823.85C4576.5,-5816.16 4576.5,-5807.35 4576.5,-5798.35"/>
<polygon fill="black" stroke="black" points="4580,-5798.16 4576.5,-5788.16 4573,-5798.16 4580,-5798.16"/>
</g>
<!-- attention_13_4 -->
<g id="node877" class="node">
<title>attention_13_4</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-5647.98 4492.5,-5647.98 4492.5,-5595.98 4660.5,-5595.98 4660.5,-5647.98"/>
<text text-anchor="middle" x="4576.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_13_L4</text>
<text text-anchor="middle" x="4576.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_3&#45;&gt;attention_13_4 -->
<g id="edge862" class="edge">
<title>aggregate_13_3&#45;&gt;attention_13_4</title>
<path fill="none" stroke="black" d="M4576.5,-5683.9C4576.5,-5675.23 4576.5,-5666.41 4576.5,-5658.27"/>
<polygon fill="black" stroke="black" points="4580,-5658.03 4576.5,-5648.03 4573,-5658.03 4580,-5658.03"/>
</g>
<!-- gate_13_4 -->
<g id="node878" class="node">
<title>gate_13_4</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-5559.98 4489.06,-5559.98 4428.49,-5455.98 4663.94,-5455.98 4724.51,-5559.98"/>
<text text-anchor="middle" x="4576.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_13_L4</text>
<text text-anchor="middle" x="4576.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4576.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_4&#45;&gt;gate_13_4 -->
<g id="edge863" class="edge">
<title>attention_13_4&#45;&gt;gate_13_4</title>
<path fill="none" stroke="black" d="M4576.5,-5595.85C4576.5,-5588.16 4576.5,-5579.35 4576.5,-5570.35"/>
<polygon fill="black" stroke="black" points="4580,-5570.16 4576.5,-5560.16 4573,-5570.16 4580,-5570.16"/>
</g>
<!-- expert_13_4 -->
<g id="node879" class="node">
<title>expert_13_4</title>
<polygon fill="lightgreen" stroke="black" points="4651,-5419.98 4502,-5419.98 4502,-5367.98 4651,-5367.98 4651,-5419.98"/>
<text text-anchor="middle" x="4576.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_13_L4</text>
<text text-anchor="middle" x="4576.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4576.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4576.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_4&#45;&gt;expert_13_4 -->
<g id="edge864" class="edge">
<title>gate_13_4&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" d="M4569.77,-5455.9C4569.69,-5447.23 4569.83,-5438.41 4570.18,-5430.27"/>
<polygon fill="black" stroke="black" points="4573.69,-5430.21 4570.77,-5420.03 4566.7,-5429.81 4573.69,-5430.21"/>
</g>
<!-- gate_13_4&#45;&gt;expert_13_4 -->
<g id="edge1269" class="edge">
<title>gate_13_4&#45;&gt;expert_13_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4583.23,-5455.9C4583.31,-5447.23 4583.17,-5438.41 4582.82,-5430.27"/>
<polygon fill="red" stroke="red" points="4586.3,-5429.81 4582.23,-5420.03 4579.31,-5430.21 4586.3,-5429.81"/>
</g>
<!-- aggregate_13_4 -->
<g id="node880" class="node">
<title>aggregate_13_4</title>
<polygon fill="lightyellow" stroke="black" points="4724.51,-5331.98 4489.06,-5331.98 4428.49,-5227.98 4663.94,-5227.98 4724.51,-5331.98"/>
<text text-anchor="middle" x="4576.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L4</text>
<text text-anchor="middle" x="4576.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4576.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4576.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_4&#45;&gt;aggregate_13_4 -->
<g id="edge865" class="edge">
<title>expert_13_4&#45;&gt;aggregate_13_4</title>
<path fill="none" stroke="black" d="M4576.5,-5367.85C4576.5,-5360.16 4576.5,-5351.35 4576.5,-5342.35"/>
<polygon fill="black" stroke="black" points="4580,-5342.16 4576.5,-5332.16 4573,-5342.16 4580,-5342.16"/>
</g>
<!-- attention_13_5 -->
<g id="node881" class="node">
<title>attention_13_5</title>
<polygon fill="lightgreen" stroke="black" points="4660.5,-5191.98 4492.5,-5191.98 4492.5,-5139.98 4660.5,-5139.98 4660.5,-5191.98"/>
<text text-anchor="middle" x="4576.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_13_L5</text>
<text text-anchor="middle" x="4576.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4576.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4576.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_4&#45;&gt;attention_13_5 -->
<g id="edge866" class="edge">
<title>aggregate_13_4&#45;&gt;attention_13_5</title>
<path fill="none" stroke="black" d="M4576.5,-5227.9C4576.5,-5219.23 4576.5,-5210.41 4576.5,-5202.27"/>
<polygon fill="black" stroke="black" points="4580,-5202.03 4576.5,-5192.03 4573,-5202.03 4580,-5202.03"/>
</g>
<!-- gate_13_5 -->
<g id="node882" class="node">
<title>gate_13_5</title>
<polygon fill="lightyellow" stroke="black" points="4723.51,-5103.98 4488.06,-5103.98 4427.49,-4999.98 4662.94,-4999.98 4723.51,-5103.98"/>
<text text-anchor="middle" x="4575.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_13_L5</text>
<text text-anchor="middle" x="4575.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4575.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4575.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_5&#45;&gt;gate_13_5 -->
<g id="edge867" class="edge">
<title>attention_13_5&#45;&gt;gate_13_5</title>
<path fill="none" stroke="black" d="M4576.28,-5139.85C4576.21,-5132.16 4576.13,-5123.35 4576.05,-5114.35"/>
<polygon fill="black" stroke="black" points="4579.55,-5114.13 4575.96,-5104.16 4572.55,-5114.19 4579.55,-5114.13"/>
</g>
<!-- expert_13_5 -->
<g id="node883" class="node">
<title>expert_13_5</title>
<polygon fill="lightgreen" stroke="black" points="4644,-4963.98 4495,-4963.98 4495,-4911.98 4644,-4911.98 4644,-4963.98"/>
<text text-anchor="middle" x="4569.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_13_L5</text>
<text text-anchor="middle" x="4569.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4569.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4569.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_5&#45;&gt;expert_13_5 -->
<g id="edge868" class="edge">
<title>gate_13_5&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" d="M4566.04,-4999.9C4565.49,-4991.23 4565.15,-4982.41 4565.07,-4974.27"/>
<polygon fill="black" stroke="black" points="4568.57,-4974.04 4565.11,-4964.03 4561.57,-4974.01 4568.57,-4974.04"/>
</g>
<!-- gate_13_5&#45;&gt;expert_13_5 -->
<g id="edge1270" class="edge">
<title>gate_13_5&#45;&gt;expert_13_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4579.49,-4999.9C4579.1,-4991.14 4578.49,-4982.21 4577.69,-4973.99"/>
<polygon fill="red" stroke="red" points="4581.16,-4973.58 4576.58,-4964.03 4574.2,-4974.35 4581.16,-4973.58"/>
</g>
<!-- aggregate_13_5 -->
<g id="node884" class="node">
<title>aggregate_13_5</title>
<polygon fill="lightyellow" stroke="black" points="4706.51,-4875.98 4471.06,-4875.98 4410.49,-4771.98 4645.94,-4771.98 4706.51,-4875.98"/>
<text text-anchor="middle" x="4558.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L5</text>
<text text-anchor="middle" x="4558.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4558.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4558.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_5&#45;&gt;aggregate_13_5 -->
<g id="edge869" class="edge">
<title>expert_13_5&#45;&gt;aggregate_13_5</title>
<path fill="none" stroke="black" d="M4567.03,-4911.85C4566.28,-4904.16 4565.41,-4895.35 4564.53,-4886.35"/>
<polygon fill="black" stroke="black" points="4567.99,-4885.77 4563.53,-4876.16 4561.02,-4886.46 4567.99,-4885.77"/>
</g>
<!-- attention_13_6 -->
<g id="node885" class="node">
<title>attention_13_6</title>
<polygon fill="lightgreen" stroke="black" points="4638.5,-4735.98 4470.5,-4735.98 4470.5,-4683.98 4638.5,-4683.98 4638.5,-4735.98"/>
<text text-anchor="middle" x="4554.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_13_L6</text>
<text text-anchor="middle" x="4554.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4554.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4554.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_5&#45;&gt;attention_13_6 -->
<g id="edge870" class="edge">
<title>aggregate_13_5&#45;&gt;attention_13_6</title>
<path fill="none" stroke="black" d="M4556.68,-4771.9C4556.37,-4763.23 4556.05,-4754.41 4555.76,-4746.27"/>
<polygon fill="black" stroke="black" points="4559.25,-4745.89 4555.4,-4736.03 4552.25,-4746.14 4559.25,-4745.89"/>
</g>
<!-- gate_13_6 -->
<g id="node886" class="node">
<title>gate_13_6</title>
<polygon fill="lightyellow" stroke="black" points="4702.51,-4647.98 4467.06,-4647.98 4406.49,-4543.98 4641.94,-4543.98 4702.51,-4647.98"/>
<text text-anchor="middle" x="4554.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_13_L6</text>
<text text-anchor="middle" x="4554.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4554.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4554.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_6&#45;&gt;gate_13_6 -->
<g id="edge871" class="edge">
<title>attention_13_6&#45;&gt;gate_13_6</title>
<path fill="none" stroke="black" d="M4554.5,-4683.85C4554.5,-4676.16 4554.5,-4667.35 4554.5,-4658.35"/>
<polygon fill="black" stroke="black" points="4558,-4658.16 4554.5,-4648.16 4551,-4658.16 4558,-4658.16"/>
</g>
<!-- expert_13_6 -->
<g id="node887" class="node">
<title>expert_13_6</title>
<polygon fill="lightgreen" stroke="black" points="4629,-4507.98 4480,-4507.98 4480,-4455.98 4629,-4455.98 4629,-4507.98"/>
<text text-anchor="middle" x="4554.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_13_L6</text>
<text text-anchor="middle" x="4554.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4554.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4554.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_6&#45;&gt;expert_13_6 -->
<g id="edge872" class="edge">
<title>gate_13_6&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" d="M4547.77,-4543.9C4547.69,-4535.23 4547.83,-4526.41 4548.18,-4518.27"/>
<polygon fill="black" stroke="black" points="4551.69,-4518.21 4548.77,-4508.03 4544.7,-4517.81 4551.69,-4518.21"/>
</g>
<!-- gate_13_6&#45;&gt;expert_13_6 -->
<g id="edge1271" class="edge">
<title>gate_13_6&#45;&gt;expert_13_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4561.23,-4543.9C4561.31,-4535.23 4561.17,-4526.41 4560.82,-4518.27"/>
<polygon fill="red" stroke="red" points="4564.3,-4517.81 4560.23,-4508.03 4557.31,-4518.21 4564.3,-4517.81"/>
</g>
<!-- aggregate_13_6 -->
<g id="node888" class="node">
<title>aggregate_13_6</title>
<polygon fill="lightyellow" stroke="black" points="4702.51,-4419.98 4467.06,-4419.98 4406.49,-4315.98 4641.94,-4315.98 4702.51,-4419.98"/>
<text text-anchor="middle" x="4554.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L6</text>
<text text-anchor="middle" x="4554.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4554.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4554.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_6&#45;&gt;aggregate_13_6 -->
<g id="edge873" class="edge">
<title>expert_13_6&#45;&gt;aggregate_13_6</title>
<path fill="none" stroke="black" d="M4554.5,-4455.85C4554.5,-4448.16 4554.5,-4439.35 4554.5,-4430.35"/>
<polygon fill="black" stroke="black" points="4558,-4430.16 4554.5,-4420.16 4551,-4430.16 4558,-4430.16"/>
</g>
<!-- attention_13_7 -->
<g id="node889" class="node">
<title>attention_13_7</title>
<polygon fill="lightgreen" stroke="black" points="4637.5,-4279.98 4469.5,-4279.98 4469.5,-4227.98 4637.5,-4227.98 4637.5,-4279.98"/>
<text text-anchor="middle" x="4553.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_13_L7</text>
<text text-anchor="middle" x="4553.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4553.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4553.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_6&#45;&gt;attention_13_7 -->
<g id="edge874" class="edge">
<title>aggregate_13_6&#45;&gt;attention_13_7</title>
<path fill="none" stroke="black" d="M4554.04,-4315.9C4553.97,-4307.23 4553.89,-4298.41 4553.82,-4290.27"/>
<polygon fill="black" stroke="black" points="4557.31,-4289.99 4553.72,-4280.03 4550.31,-4290.06 4557.31,-4289.99"/>
</g>
<!-- gate_13_7 -->
<g id="node890" class="node">
<title>gate_13_7</title>
<polygon fill="lightyellow" stroke="black" points="4701.51,-4191.98 4466.06,-4191.98 4405.49,-4087.98 4640.94,-4087.98 4701.51,-4191.98"/>
<text text-anchor="middle" x="4553.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_13_L7</text>
<text text-anchor="middle" x="4553.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4553.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4553.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_7&#45;&gt;gate_13_7 -->
<g id="edge875" class="edge">
<title>attention_13_7&#45;&gt;gate_13_7</title>
<path fill="none" stroke="black" d="M4553.5,-4227.85C4553.5,-4220.16 4553.5,-4211.35 4553.5,-4202.35"/>
<polygon fill="black" stroke="black" points="4557,-4202.16 4553.5,-4192.16 4550,-4202.16 4557,-4202.16"/>
</g>
<!-- expert_13_7 -->
<g id="node891" class="node">
<title>expert_13_7</title>
<polygon fill="lightgreen" stroke="black" points="4626,-4051.98 4477,-4051.98 4477,-3999.98 4626,-3999.98 4626,-4051.98"/>
<text text-anchor="middle" x="4551.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_13_L7</text>
<text text-anchor="middle" x="4551.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4551.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4551.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_7&#45;&gt;expert_13_7 -->
<g id="edge876" class="edge">
<title>gate_13_7&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" d="M4545.86,-4087.9C4545.63,-4079.23 4545.6,-4070.41 4545.81,-4062.27"/>
<polygon fill="black" stroke="black" points="4549.32,-4062.16 4546.21,-4052.03 4542.32,-4061.88 4549.32,-4062.16"/>
</g>
<!-- gate_13_7&#45;&gt;expert_13_7 -->
<g id="edge1272" class="edge">
<title>gate_13_7&#45;&gt;expert_13_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4559.32,-4087.9C4559.24,-4079.23 4558.95,-4070.41 4558.45,-4062.27"/>
<polygon fill="red" stroke="red" points="4561.92,-4061.74 4557.68,-4052.03 4554.94,-4062.26 4561.92,-4061.74"/>
</g>
<!-- aggregate_13_7 -->
<g id="node892" class="node">
<title>aggregate_13_7</title>
<polygon fill="lightyellow" stroke="black" points="4699.51,-3963.98 4464.06,-3963.98 4403.49,-3859.98 4638.94,-3859.98 4699.51,-3963.98"/>
<text text-anchor="middle" x="4551.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L7</text>
<text text-anchor="middle" x="4551.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4551.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4551.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_7&#45;&gt;aggregate_13_7 -->
<g id="edge877" class="edge">
<title>expert_13_7&#45;&gt;aggregate_13_7</title>
<path fill="none" stroke="black" d="M4551.5,-3999.85C4551.5,-3992.16 4551.5,-3983.35 4551.5,-3974.35"/>
<polygon fill="black" stroke="black" points="4555,-3974.16 4551.5,-3964.16 4548,-3974.16 4555,-3974.16"/>
</g>
<!-- attention_13_8 -->
<g id="node893" class="node">
<title>attention_13_8</title>
<polygon fill="lightgreen" stroke="black" points="4631.5,-3823.98 4463.5,-3823.98 4463.5,-3771.98 4631.5,-3771.98 4631.5,-3823.98"/>
<text text-anchor="middle" x="4547.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_13_L8</text>
<text text-anchor="middle" x="4547.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4547.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4547.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_7&#45;&gt;attention_13_8 -->
<g id="edge878" class="edge">
<title>aggregate_13_7&#45;&gt;attention_13_8</title>
<path fill="none" stroke="black" d="M4549.68,-3859.9C4549.37,-3851.23 4549.05,-3842.41 4548.76,-3834.27"/>
<polygon fill="black" stroke="black" points="4552.25,-3833.89 4548.4,-3824.03 4545.25,-3834.14 4552.25,-3833.89"/>
</g>
<!-- gate_13_8 -->
<g id="node894" class="node">
<title>gate_13_8</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-3735.98 4459.06,-3735.98 4398.49,-3631.98 4633.94,-3631.98 4694.51,-3735.98"/>
<text text-anchor="middle" x="4546.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_13_L8</text>
<text text-anchor="middle" x="4546.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_8&#45;&gt;gate_13_8 -->
<g id="edge879" class="edge">
<title>attention_13_8&#45;&gt;gate_13_8</title>
<path fill="none" stroke="black" d="M4547.28,-3771.85C4547.21,-3764.16 4547.13,-3755.35 4547.05,-3746.35"/>
<polygon fill="black" stroke="black" points="4550.55,-3746.13 4546.96,-3736.16 4543.55,-3746.19 4550.55,-3746.13"/>
</g>
<!-- expert_13_8 -->
<g id="node895" class="node">
<title>expert_13_8</title>
<polygon fill="lightgreen" stroke="black" points="4621,-3595.98 4472,-3595.98 4472,-3543.98 4621,-3543.98 4621,-3595.98"/>
<text text-anchor="middle" x="4546.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_13_L8</text>
<text text-anchor="middle" x="4546.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_8&#45;&gt;expert_13_8 -->
<g id="edge880" class="edge">
<title>gate_13_8&#45;&gt;expert_13_8</title>
<path fill="none" stroke="black" d="M4539.77,-3631.9C4539.69,-3623.23 4539.83,-3614.41 4540.18,-3606.27"/>
<polygon fill="black" stroke="black" points="4543.69,-3606.21 4540.77,-3596.03 4536.7,-3605.81 4543.69,-3606.21"/>
</g>
<!-- gate_13_8&#45;&gt;expert_13_8 -->
<g id="edge1273" class="edge">
<title>gate_13_8&#45;&gt;expert_13_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-3631.9C4553.31,-3623.23 4553.17,-3614.41 4552.82,-3606.27"/>
<polygon fill="red" stroke="red" points="4556.3,-3605.81 4552.23,-3596.03 4549.31,-3606.21 4556.3,-3605.81"/>
</g>
<!-- aggregate_13_8 -->
<g id="node896" class="node">
<title>aggregate_13_8</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-3507.98 4459.06,-3507.98 4398.49,-3403.98 4633.94,-3403.98 4694.51,-3507.98"/>
<text text-anchor="middle" x="4546.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L8</text>
<text text-anchor="middle" x="4546.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_8&#45;&gt;aggregate_13_8 -->
<g id="edge881" class="edge">
<title>expert_13_8&#45;&gt;aggregate_13_8</title>
<path fill="none" stroke="black" d="M4546.5,-3543.85C4546.5,-3536.16 4546.5,-3527.35 4546.5,-3518.35"/>
<polygon fill="black" stroke="black" points="4550,-3518.16 4546.5,-3508.16 4543,-3518.16 4550,-3518.16"/>
</g>
<!-- attention_13_9 -->
<g id="node897" class="node">
<title>attention_13_9</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-3367.98 4462.5,-3367.98 4462.5,-3315.98 4630.5,-3315.98 4630.5,-3367.98"/>
<text text-anchor="middle" x="4546.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_13_L9</text>
<text text-anchor="middle" x="4546.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_8&#45;&gt;attention_13_9 -->
<g id="edge882" class="edge">
<title>aggregate_13_8&#45;&gt;attention_13_9</title>
<path fill="none" stroke="black" d="M4546.5,-3403.9C4546.5,-3395.23 4546.5,-3386.41 4546.5,-3378.27"/>
<polygon fill="black" stroke="black" points="4550,-3378.03 4546.5,-3368.03 4543,-3378.03 4550,-3378.03"/>
</g>
<!-- gate_13_9 -->
<g id="node898" class="node">
<title>gate_13_9</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-3279.98 4459.06,-3279.98 4398.49,-3175.98 4633.94,-3175.98 4694.51,-3279.98"/>
<text text-anchor="middle" x="4546.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_13_L9</text>
<text text-anchor="middle" x="4546.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_9&#45;&gt;gate_13_9 -->
<g id="edge883" class="edge">
<title>attention_13_9&#45;&gt;gate_13_9</title>
<path fill="none" stroke="black" d="M4546.5,-3315.85C4546.5,-3308.16 4546.5,-3299.35 4546.5,-3290.35"/>
<polygon fill="black" stroke="black" points="4550,-3290.16 4546.5,-3280.16 4543,-3290.16 4550,-3290.16"/>
</g>
<!-- expert_13_9 -->
<g id="node899" class="node">
<title>expert_13_9</title>
<polygon fill="lightgreen" stroke="black" points="4621,-3139.98 4472,-3139.98 4472,-3087.98 4621,-3087.98 4621,-3139.98"/>
<text text-anchor="middle" x="4546.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_13_L9</text>
<text text-anchor="middle" x="4546.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_9&#45;&gt;expert_13_9 -->
<g id="edge884" class="edge">
<title>gate_13_9&#45;&gt;expert_13_9</title>
<path fill="none" stroke="black" d="M4539.77,-3175.9C4539.69,-3167.23 4539.83,-3158.41 4540.18,-3150.27"/>
<polygon fill="black" stroke="black" points="4543.69,-3150.21 4540.77,-3140.03 4536.7,-3149.81 4543.69,-3150.21"/>
</g>
<!-- gate_13_9&#45;&gt;expert_13_9 -->
<g id="edge1274" class="edge">
<title>gate_13_9&#45;&gt;expert_13_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-3175.9C4553.31,-3167.23 4553.17,-3158.41 4552.82,-3150.27"/>
<polygon fill="red" stroke="red" points="4556.3,-3149.81 4552.23,-3140.03 4549.31,-3150.21 4556.3,-3149.81"/>
</g>
<!-- aggregate_13_9 -->
<g id="node900" class="node">
<title>aggregate_13_9</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-3051.98 4459.06,-3051.98 4398.49,-2947.98 4633.94,-2947.98 4694.51,-3051.98"/>
<text text-anchor="middle" x="4546.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L9</text>
<text text-anchor="middle" x="4546.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_9&#45;&gt;aggregate_13_9 -->
<g id="edge885" class="edge">
<title>expert_13_9&#45;&gt;aggregate_13_9</title>
<path fill="none" stroke="black" d="M4546.5,-3087.85C4546.5,-3080.16 4546.5,-3071.35 4546.5,-3062.35"/>
<polygon fill="black" stroke="black" points="4550,-3062.16 4546.5,-3052.16 4543,-3062.16 4550,-3062.16"/>
</g>
<!-- attention_13_10 -->
<g id="node901" class="node">
<title>attention_13_10</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-2911.98 4462.5,-2911.98 4462.5,-2859.98 4630.5,-2859.98 4630.5,-2911.98"/>
<text text-anchor="middle" x="4546.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_13_L10</text>
<text text-anchor="middle" x="4546.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_9&#45;&gt;attention_13_10 -->
<g id="edge886" class="edge">
<title>aggregate_13_9&#45;&gt;attention_13_10</title>
<path fill="none" stroke="black" d="M4546.5,-2947.9C4546.5,-2939.23 4546.5,-2930.41 4546.5,-2922.27"/>
<polygon fill="black" stroke="black" points="4550,-2922.03 4546.5,-2912.03 4543,-2922.03 4550,-2922.03"/>
</g>
<!-- gate_13_10 -->
<g id="node902" class="node">
<title>gate_13_10</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-2823.98 4459.06,-2823.98 4398.49,-2719.98 4633.94,-2719.98 4694.51,-2823.98"/>
<text text-anchor="middle" x="4546.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_13_L10</text>
<text text-anchor="middle" x="4546.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_10&#45;&gt;gate_13_10 -->
<g id="edge887" class="edge">
<title>attention_13_10&#45;&gt;gate_13_10</title>
<path fill="none" stroke="black" d="M4546.5,-2859.85C4546.5,-2852.16 4546.5,-2843.35 4546.5,-2834.35"/>
<polygon fill="black" stroke="black" points="4550,-2834.16 4546.5,-2824.16 4543,-2834.16 4550,-2834.16"/>
</g>
<!-- expert_13_10 -->
<g id="node903" class="node">
<title>expert_13_10</title>
<polygon fill="lightgreen" stroke="black" points="4621,-2683.98 4472,-2683.98 4472,-2631.98 4621,-2631.98 4621,-2683.98"/>
<text text-anchor="middle" x="4546.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_13_L10</text>
<text text-anchor="middle" x="4546.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_10&#45;&gt;expert_13_10 -->
<g id="edge888" class="edge">
<title>gate_13_10&#45;&gt;expert_13_10</title>
<path fill="none" stroke="black" d="M4539.77,-2719.9C4539.69,-2711.23 4539.83,-2702.41 4540.18,-2694.27"/>
<polygon fill="black" stroke="black" points="4543.69,-2694.21 4540.77,-2684.03 4536.7,-2693.81 4543.69,-2694.21"/>
</g>
<!-- gate_13_10&#45;&gt;expert_13_10 -->
<g id="edge1275" class="edge">
<title>gate_13_10&#45;&gt;expert_13_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-2719.9C4553.31,-2711.23 4553.17,-2702.41 4552.82,-2694.27"/>
<polygon fill="red" stroke="red" points="4556.3,-2693.81 4552.23,-2684.03 4549.31,-2694.21 4556.3,-2693.81"/>
</g>
<!-- aggregate_13_10 -->
<g id="node904" class="node">
<title>aggregate_13_10</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-2595.98 4459.06,-2595.98 4398.49,-2491.98 4633.94,-2491.98 4694.51,-2595.98"/>
<text text-anchor="middle" x="4546.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L10</text>
<text text-anchor="middle" x="4546.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_10&#45;&gt;aggregate_13_10 -->
<g id="edge889" class="edge">
<title>expert_13_10&#45;&gt;aggregate_13_10</title>
<path fill="none" stroke="black" d="M4546.5,-2631.85C4546.5,-2624.16 4546.5,-2615.35 4546.5,-2606.35"/>
<polygon fill="black" stroke="black" points="4550,-2606.16 4546.5,-2596.16 4543,-2606.16 4550,-2606.16"/>
</g>
<!-- attention_13_11 -->
<g id="node905" class="node">
<title>attention_13_11</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-2455.98 4462.5,-2455.98 4462.5,-2403.98 4630.5,-2403.98 4630.5,-2455.98"/>
<text text-anchor="middle" x="4546.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_13_L11</text>
<text text-anchor="middle" x="4546.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_10&#45;&gt;attention_13_11 -->
<g id="edge890" class="edge">
<title>aggregate_13_10&#45;&gt;attention_13_11</title>
<path fill="none" stroke="black" d="M4546.5,-2491.9C4546.5,-2483.23 4546.5,-2474.41 4546.5,-2466.27"/>
<polygon fill="black" stroke="black" points="4550,-2466.03 4546.5,-2456.03 4543,-2466.03 4550,-2466.03"/>
</g>
<!-- gate_13_11 -->
<g id="node906" class="node">
<title>gate_13_11</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-2367.98 4459.06,-2367.98 4398.49,-2263.98 4633.94,-2263.98 4694.51,-2367.98"/>
<text text-anchor="middle" x="4546.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_13_L11</text>
<text text-anchor="middle" x="4546.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_11&#45;&gt;gate_13_11 -->
<g id="edge891" class="edge">
<title>attention_13_11&#45;&gt;gate_13_11</title>
<path fill="none" stroke="black" d="M4546.5,-2403.85C4546.5,-2396.16 4546.5,-2387.35 4546.5,-2378.35"/>
<polygon fill="black" stroke="black" points="4550,-2378.16 4546.5,-2368.16 4543,-2378.16 4550,-2378.16"/>
</g>
<!-- expert_13_11 -->
<g id="node907" class="node">
<title>expert_13_11</title>
<polygon fill="lightgreen" stroke="black" points="4621,-2227.98 4472,-2227.98 4472,-2175.98 4621,-2175.98 4621,-2227.98"/>
<text text-anchor="middle" x="4546.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_13_L11</text>
<text text-anchor="middle" x="4546.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_11&#45;&gt;expert_13_11 -->
<g id="edge892" class="edge">
<title>gate_13_11&#45;&gt;expert_13_11</title>
<path fill="none" stroke="black" d="M4539.77,-2263.9C4539.69,-2255.23 4539.83,-2246.41 4540.18,-2238.27"/>
<polygon fill="black" stroke="black" points="4543.69,-2238.21 4540.77,-2228.03 4536.7,-2237.81 4543.69,-2238.21"/>
</g>
<!-- gate_13_11&#45;&gt;expert_13_11 -->
<g id="edge1276" class="edge">
<title>gate_13_11&#45;&gt;expert_13_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-2263.9C4553.31,-2255.23 4553.17,-2246.41 4552.82,-2238.27"/>
<polygon fill="red" stroke="red" points="4556.3,-2237.81 4552.23,-2228.03 4549.31,-2238.21 4556.3,-2237.81"/>
</g>
<!-- aggregate_13_11 -->
<g id="node908" class="node">
<title>aggregate_13_11</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-2139.98 4459.06,-2139.98 4398.49,-2035.98 4633.94,-2035.98 4694.51,-2139.98"/>
<text text-anchor="middle" x="4546.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L11</text>
<text text-anchor="middle" x="4546.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_11&#45;&gt;aggregate_13_11 -->
<g id="edge893" class="edge">
<title>expert_13_11&#45;&gt;aggregate_13_11</title>
<path fill="none" stroke="black" d="M4546.5,-2175.85C4546.5,-2168.16 4546.5,-2159.35 4546.5,-2150.35"/>
<polygon fill="black" stroke="black" points="4550,-2150.16 4546.5,-2140.16 4543,-2150.16 4550,-2150.16"/>
</g>
<!-- attention_13_12 -->
<g id="node909" class="node">
<title>attention_13_12</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-1999.98 4462.5,-1999.98 4462.5,-1947.98 4630.5,-1947.98 4630.5,-1999.98"/>
<text text-anchor="middle" x="4546.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_13_L12</text>
<text text-anchor="middle" x="4546.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_11&#45;&gt;attention_13_12 -->
<g id="edge894" class="edge">
<title>aggregate_13_11&#45;&gt;attention_13_12</title>
<path fill="none" stroke="black" d="M4546.5,-2035.9C4546.5,-2027.23 4546.5,-2018.41 4546.5,-2010.27"/>
<polygon fill="black" stroke="black" points="4550,-2010.03 4546.5,-2000.03 4543,-2010.03 4550,-2010.03"/>
</g>
<!-- gate_13_12 -->
<g id="node910" class="node">
<title>gate_13_12</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-1911.98 4459.06,-1911.98 4398.49,-1807.98 4633.94,-1807.98 4694.51,-1911.98"/>
<text text-anchor="middle" x="4546.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_13_L12</text>
<text text-anchor="middle" x="4546.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_12&#45;&gt;gate_13_12 -->
<g id="edge895" class="edge">
<title>attention_13_12&#45;&gt;gate_13_12</title>
<path fill="none" stroke="black" d="M4546.5,-1947.85C4546.5,-1940.16 4546.5,-1931.35 4546.5,-1922.35"/>
<polygon fill="black" stroke="black" points="4550,-1922.16 4546.5,-1912.16 4543,-1922.16 4550,-1922.16"/>
</g>
<!-- expert_13_12 -->
<g id="node911" class="node">
<title>expert_13_12</title>
<polygon fill="lightgreen" stroke="black" points="4621,-1771.98 4472,-1771.98 4472,-1719.98 4621,-1719.98 4621,-1771.98"/>
<text text-anchor="middle" x="4546.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_13_L12</text>
<text text-anchor="middle" x="4546.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_12&#45;&gt;expert_13_12 -->
<g id="edge896" class="edge">
<title>gate_13_12&#45;&gt;expert_13_12</title>
<path fill="none" stroke="black" d="M4539.77,-1807.9C4539.69,-1799.23 4539.83,-1790.41 4540.18,-1782.27"/>
<polygon fill="black" stroke="black" points="4543.69,-1782.21 4540.77,-1772.03 4536.7,-1781.81 4543.69,-1782.21"/>
</g>
<!-- gate_13_12&#45;&gt;expert_13_12 -->
<g id="edge1277" class="edge">
<title>gate_13_12&#45;&gt;expert_13_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-1807.9C4553.31,-1799.23 4553.17,-1790.41 4552.82,-1782.27"/>
<polygon fill="red" stroke="red" points="4556.3,-1781.81 4552.23,-1772.03 4549.31,-1782.21 4556.3,-1781.81"/>
</g>
<!-- aggregate_13_12 -->
<g id="node912" class="node">
<title>aggregate_13_12</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-1683.98 4459.06,-1683.98 4398.49,-1579.98 4633.94,-1579.98 4694.51,-1683.98"/>
<text text-anchor="middle" x="4546.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L12</text>
<text text-anchor="middle" x="4546.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_12&#45;&gt;aggregate_13_12 -->
<g id="edge897" class="edge">
<title>expert_13_12&#45;&gt;aggregate_13_12</title>
<path fill="none" stroke="black" d="M4546.5,-1719.85C4546.5,-1712.16 4546.5,-1703.35 4546.5,-1694.35"/>
<polygon fill="black" stroke="black" points="4550,-1694.16 4546.5,-1684.16 4543,-1694.16 4550,-1694.16"/>
</g>
<!-- attention_13_13 -->
<g id="node913" class="node">
<title>attention_13_13</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-1543.98 4462.5,-1543.98 4462.5,-1491.98 4630.5,-1491.98 4630.5,-1543.98"/>
<text text-anchor="middle" x="4546.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_13_L13</text>
<text text-anchor="middle" x="4546.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_12&#45;&gt;attention_13_13 -->
<g id="edge898" class="edge">
<title>aggregate_13_12&#45;&gt;attention_13_13</title>
<path fill="none" stroke="black" d="M4546.5,-1579.9C4546.5,-1571.23 4546.5,-1562.41 4546.5,-1554.27"/>
<polygon fill="black" stroke="black" points="4550,-1554.03 4546.5,-1544.03 4543,-1554.03 4550,-1554.03"/>
</g>
<!-- gate_13_13 -->
<g id="node914" class="node">
<title>gate_13_13</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-1455.98 4459.06,-1455.98 4398.49,-1351.98 4633.94,-1351.98 4694.51,-1455.98"/>
<text text-anchor="middle" x="4546.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_13_L13</text>
<text text-anchor="middle" x="4546.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_13&#45;&gt;gate_13_13 -->
<g id="edge899" class="edge">
<title>attention_13_13&#45;&gt;gate_13_13</title>
<path fill="none" stroke="black" d="M4546.5,-1491.85C4546.5,-1484.16 4546.5,-1475.35 4546.5,-1466.35"/>
<polygon fill="black" stroke="black" points="4550,-1466.16 4546.5,-1456.16 4543,-1466.16 4550,-1466.16"/>
</g>
<!-- expert_13_13 -->
<g id="node915" class="node">
<title>expert_13_13</title>
<polygon fill="lightgreen" stroke="black" points="4621,-1315.98 4472,-1315.98 4472,-1263.98 4621,-1263.98 4621,-1315.98"/>
<text text-anchor="middle" x="4546.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_13_L13</text>
<text text-anchor="middle" x="4546.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_13&#45;&gt;expert_13_13 -->
<g id="edge900" class="edge">
<title>gate_13_13&#45;&gt;expert_13_13</title>
<path fill="none" stroke="black" d="M4539.77,-1351.9C4539.69,-1343.23 4539.83,-1334.41 4540.18,-1326.27"/>
<polygon fill="black" stroke="black" points="4543.69,-1326.21 4540.77,-1316.03 4536.7,-1325.81 4543.69,-1326.21"/>
</g>
<!-- gate_13_13&#45;&gt;expert_13_13 -->
<g id="edge1278" class="edge">
<title>gate_13_13&#45;&gt;expert_13_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-1351.9C4553.31,-1343.23 4553.17,-1334.41 4552.82,-1326.27"/>
<polygon fill="red" stroke="red" points="4556.3,-1325.81 4552.23,-1316.03 4549.31,-1326.21 4556.3,-1325.81"/>
</g>
<!-- aggregate_13_13 -->
<g id="node916" class="node">
<title>aggregate_13_13</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-1227.98 4459.06,-1227.98 4398.49,-1123.98 4633.94,-1123.98 4694.51,-1227.98"/>
<text text-anchor="middle" x="4546.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L13</text>
<text text-anchor="middle" x="4546.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_13&#45;&gt;aggregate_13_13 -->
<g id="edge901" class="edge">
<title>expert_13_13&#45;&gt;aggregate_13_13</title>
<path fill="none" stroke="black" d="M4546.5,-1263.85C4546.5,-1256.16 4546.5,-1247.35 4546.5,-1238.35"/>
<polygon fill="black" stroke="black" points="4550,-1238.16 4546.5,-1228.16 4543,-1238.16 4550,-1238.16"/>
</g>
<!-- attention_13_14 -->
<g id="node917" class="node">
<title>attention_13_14</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-1087.98 4462.5,-1087.98 4462.5,-1035.98 4630.5,-1035.98 4630.5,-1087.98"/>
<text text-anchor="middle" x="4546.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_13_L14</text>
<text text-anchor="middle" x="4546.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_13&#45;&gt;attention_13_14 -->
<g id="edge902" class="edge">
<title>aggregate_13_13&#45;&gt;attention_13_14</title>
<path fill="none" stroke="black" d="M4546.5,-1123.9C4546.5,-1115.23 4546.5,-1106.41 4546.5,-1098.27"/>
<polygon fill="black" stroke="black" points="4550,-1098.03 4546.5,-1088.03 4543,-1098.03 4550,-1098.03"/>
</g>
<!-- gate_13_14 -->
<g id="node918" class="node">
<title>gate_13_14</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-999.98 4459.06,-999.98 4398.49,-895.98 4633.94,-895.98 4694.51,-999.98"/>
<text text-anchor="middle" x="4546.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_13_L14</text>
<text text-anchor="middle" x="4546.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_14&#45;&gt;gate_13_14 -->
<g id="edge903" class="edge">
<title>attention_13_14&#45;&gt;gate_13_14</title>
<path fill="none" stroke="black" d="M4546.5,-1035.85C4546.5,-1028.16 4546.5,-1019.35 4546.5,-1010.35"/>
<polygon fill="black" stroke="black" points="4550,-1010.16 4546.5,-1000.16 4543,-1010.16 4550,-1010.16"/>
</g>
<!-- expert_13_14 -->
<g id="node919" class="node">
<title>expert_13_14</title>
<polygon fill="lightgreen" stroke="black" points="4621,-859.98 4472,-859.98 4472,-807.98 4621,-807.98 4621,-859.98"/>
<text text-anchor="middle" x="4546.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_13_L14</text>
<text text-anchor="middle" x="4546.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_14&#45;&gt;expert_13_14 -->
<g id="edge904" class="edge">
<title>gate_13_14&#45;&gt;expert_13_14</title>
<path fill="none" stroke="black" d="M4539.77,-895.9C4539.69,-887.23 4539.83,-878.41 4540.18,-870.27"/>
<polygon fill="black" stroke="black" points="4543.69,-870.21 4540.77,-860.03 4536.7,-869.81 4543.69,-870.21"/>
</g>
<!-- gate_13_14&#45;&gt;expert_13_14 -->
<g id="edge1279" class="edge">
<title>gate_13_14&#45;&gt;expert_13_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-895.9C4553.31,-887.23 4553.17,-878.41 4552.82,-870.27"/>
<polygon fill="red" stroke="red" points="4556.3,-869.81 4552.23,-860.03 4549.31,-870.21 4556.3,-869.81"/>
</g>
<!-- aggregate_13_14 -->
<g id="node920" class="node">
<title>aggregate_13_14</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-771.98 4459.06,-771.98 4398.49,-667.98 4633.94,-667.98 4694.51,-771.98"/>
<text text-anchor="middle" x="4546.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L14</text>
<text text-anchor="middle" x="4546.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_14&#45;&gt;aggregate_13_14 -->
<g id="edge905" class="edge">
<title>expert_13_14&#45;&gt;aggregate_13_14</title>
<path fill="none" stroke="black" d="M4546.5,-807.85C4546.5,-800.16 4546.5,-791.35 4546.5,-782.35"/>
<polygon fill="black" stroke="black" points="4550,-782.16 4546.5,-772.16 4543,-782.16 4550,-782.16"/>
</g>
<!-- attention_13_15 -->
<g id="node921" class="node">
<title>attention_13_15</title>
<polygon fill="lightgreen" stroke="black" points="4630.5,-631.98 4462.5,-631.98 4462.5,-579.98 4630.5,-579.98 4630.5,-631.98"/>
<text text-anchor="middle" x="4546.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_13_L15</text>
<text text-anchor="middle" x="4546.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4546.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4546.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_13_14&#45;&gt;attention_13_15 -->
<g id="edge906" class="edge">
<title>aggregate_13_14&#45;&gt;attention_13_15</title>
<path fill="none" stroke="black" d="M4546.5,-667.9C4546.5,-659.23 4546.5,-650.41 4546.5,-642.27"/>
<polygon fill="black" stroke="black" points="4550,-642.03 4546.5,-632.03 4543,-642.03 4550,-642.03"/>
</g>
<!-- gate_13_15 -->
<g id="node922" class="node">
<title>gate_13_15</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-543.98 4459.06,-543.98 4398.49,-439.98 4633.94,-439.98 4694.51,-543.98"/>
<text text-anchor="middle" x="4546.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_13_L15</text>
<text text-anchor="middle" x="4546.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4546.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_13_15&#45;&gt;gate_13_15 -->
<g id="edge907" class="edge">
<title>attention_13_15&#45;&gt;gate_13_15</title>
<path fill="none" stroke="black" d="M4546.5,-579.85C4546.5,-572.16 4546.5,-563.35 4546.5,-554.35"/>
<polygon fill="black" stroke="black" points="4550,-554.16 4546.5,-544.16 4543,-554.16 4550,-554.16"/>
</g>
<!-- expert_13_15 -->
<g id="node923" class="node">
<title>expert_13_15</title>
<polygon fill="lightgreen" stroke="black" points="4621,-403.98 4472,-403.98 4472,-351.98 4621,-351.98 4621,-403.98"/>
<text text-anchor="middle" x="4546.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_13_L15</text>
<text text-anchor="middle" x="4546.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=13</text>
<text text-anchor="middle" x="4546.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_13_15&#45;&gt;expert_13_15 -->
<g id="edge908" class="edge">
<title>gate_13_15&#45;&gt;expert_13_15</title>
<path fill="none" stroke="black" d="M4539.77,-439.9C4539.69,-431.23 4539.83,-422.41 4540.18,-414.27"/>
<polygon fill="black" stroke="black" points="4543.69,-414.21 4540.77,-404.03 4536.7,-413.81 4543.69,-414.21"/>
</g>
<!-- gate_13_15&#45;&gt;expert_13_15 -->
<g id="edge1280" class="edge">
<title>gate_13_15&#45;&gt;expert_13_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4553.23,-439.9C4553.31,-431.23 4553.17,-422.41 4552.82,-414.27"/>
<polygon fill="red" stroke="red" points="4556.3,-413.81 4552.23,-404.03 4549.31,-414.21 4556.3,-413.81"/>
</g>
<!-- aggregate_13_15 -->
<g id="node924" class="node">
<title>aggregate_13_15</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-315.98 4459.06,-315.98 4398.49,-211.98 4633.94,-211.98 4694.51,-315.98"/>
<text text-anchor="middle" x="4546.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_13_L15</text>
<text text-anchor="middle" x="4546.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4546.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4546.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_13_15&#45;&gt;aggregate_13_15 -->
<g id="edge909" class="edge">
<title>expert_13_15&#45;&gt;aggregate_13_15</title>
<path fill="none" stroke="black" d="M4546.5,-351.85C4546.5,-344.16 4546.5,-335.35 4546.5,-326.35"/>
<polygon fill="black" stroke="black" points="4550,-326.16 4546.5,-316.16 4543,-326.16 4550,-326.16"/>
</g>
<!-- collect_13 -->
<g id="node925" class="node">
<title>collect_13</title>
<polygon fill="lightyellow" stroke="black" points="4694.51,-175.98 4459.06,-175.98 4398.49,-93.98 4633.94,-93.98 4694.51,-175.98"/>
<text text-anchor="middle" x="4546.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_13</text>
<text text-anchor="middle" x="4546.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4546.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_13_15&#45;&gt;collect_13 -->
<g id="edge910" class="edge">
<title>aggregate_13_15&#45;&gt;collect_13</title>
<path fill="none" stroke="black" d="M4546.5,-211.69C4546.5,-203.27 4546.5,-194.56 4546.5,-186.17"/>
<polygon fill="black" stroke="black" points="4550,-186.14 4546.5,-176.14 4543,-186.14 4550,-186.14"/>
</g>
<!-- collect_13&#45;&gt;output -->
<g id="edge1054" class="edge">
<title>collect_13&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4399.52,-95.71C4395.82,-95.09 4392.14,-94.51 4388.5,-93.98 4110.88,-53.65 3267.73,-36.87 2942.96,-31.79"/>
<polygon fill="black" stroke="black" points="2942.62,-28.29 2932.56,-31.63 2942.51,-35.29 2942.62,-28.29"/>
</g>
<!-- distribute_14 -->
<g id="node926" class="node">
<title>distribute_14</title>
<polygon fill="lightyellow" stroke="black" points="5053.73,-7589.98 4813.16,-7589.98 4751.27,-7507.98 4991.85,-7507.98 5053.73,-7589.98"/>
<text text-anchor="middle" x="4902.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_14</text>
<text text-anchor="middle" x="4902.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="4902.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_0 -->
<g id="node927" class="node">
<title>attention_14_0</title>
<polygon fill="lightgreen" stroke="black" points="4981.5,-7471.98 4813.5,-7471.98 4813.5,-7419.98 4981.5,-7419.98 4981.5,-7471.98"/>
<text text-anchor="middle" x="4897.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_14_L0</text>
<text text-anchor="middle" x="4897.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4897.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4897.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_14&#45;&gt;attention_14_0 -->
<g id="edge911" class="edge">
<title>distribute_14&#45;&gt;attention_14_0</title>
<path fill="none" stroke="black" d="M4900.51,-7507.77C4900.09,-7499.34 4899.66,-7490.51 4899.25,-7482.27"/>
<polygon fill="black" stroke="black" points="4902.74,-7482.05 4898.75,-7472.23 4895.75,-7482.4 4902.74,-7482.05"/>
</g>
<!-- gate_14_0 -->
<g id="node928" class="node">
<title>gate_14_0</title>
<polygon fill="lightyellow" stroke="black" points="5045.51,-7383.98 4810.06,-7383.98 4749.49,-7279.98 4984.94,-7279.98 5045.51,-7383.98"/>
<text text-anchor="middle" x="4897.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_14_L0</text>
<text text-anchor="middle" x="4897.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4897.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4897.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_0&#45;&gt;gate_14_0 -->
<g id="edge912" class="edge">
<title>attention_14_0&#45;&gt;gate_14_0</title>
<path fill="none" stroke="black" d="M4897.5,-7419.85C4897.5,-7412.16 4897.5,-7403.35 4897.5,-7394.35"/>
<polygon fill="black" stroke="black" points="4901,-7394.16 4897.5,-7384.16 4894,-7394.16 4901,-7394.16"/>
</g>
<!-- expert_14_0 -->
<g id="node929" class="node">
<title>expert_14_0</title>
<polygon fill="lightgreen" stroke="black" points="4972,-7243.98 4823,-7243.98 4823,-7191.98 4972,-7191.98 4972,-7243.98"/>
<text text-anchor="middle" x="4897.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_14_L0</text>
<text text-anchor="middle" x="4897.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4897.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4897.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_0&#45;&gt;expert_14_0 -->
<g id="edge913" class="edge">
<title>gate_14_0&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" d="M4890.77,-7279.9C4890.69,-7271.23 4890.83,-7262.41 4891.18,-7254.27"/>
<polygon fill="black" stroke="black" points="4894.69,-7254.21 4891.77,-7244.03 4887.7,-7253.81 4894.69,-7254.21"/>
</g>
<!-- gate_14_0&#45;&gt;expert_14_0 -->
<g id="edge1281" class="edge">
<title>gate_14_0&#45;&gt;expert_14_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4904.23,-7279.9C4904.31,-7271.23 4904.17,-7262.41 4903.82,-7254.27"/>
<polygon fill="red" stroke="red" points="4907.3,-7253.81 4903.23,-7244.03 4900.31,-7254.21 4907.3,-7253.81"/>
</g>
<!-- aggregate_14_0 -->
<g id="node930" class="node">
<title>aggregate_14_0</title>
<polygon fill="lightyellow" stroke="black" points="5044.51,-7155.98 4809.06,-7155.98 4748.49,-7051.98 4983.94,-7051.98 5044.51,-7155.98"/>
<text text-anchor="middle" x="4896.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L0</text>
<text text-anchor="middle" x="4896.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4896.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4896.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_0&#45;&gt;aggregate_14_0 -->
<g id="edge914" class="edge">
<title>expert_14_0&#45;&gt;aggregate_14_0</title>
<path fill="none" stroke="black" d="M4897.28,-7191.85C4897.21,-7184.16 4897.13,-7175.35 4897.05,-7166.35"/>
<polygon fill="black" stroke="black" points="4900.55,-7166.13 4896.96,-7156.16 4893.55,-7166.19 4900.55,-7166.13"/>
</g>
<!-- attention_14_1 -->
<g id="node931" class="node">
<title>attention_14_1</title>
<polygon fill="lightgreen" stroke="black" points="4977.5,-7015.98 4809.5,-7015.98 4809.5,-6963.98 4977.5,-6963.98 4977.5,-7015.98"/>
<text text-anchor="middle" x="4893.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_14_L1</text>
<text text-anchor="middle" x="4893.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4893.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4893.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_0&#45;&gt;attention_14_1 -->
<g id="edge915" class="edge">
<title>aggregate_14_0&#45;&gt;attention_14_1</title>
<path fill="none" stroke="black" d="M4895.13,-7051.9C4894.9,-7043.23 4894.66,-7034.41 4894.45,-7026.27"/>
<polygon fill="black" stroke="black" points="4897.94,-7025.93 4894.17,-7016.03 4890.94,-7026.12 4897.94,-7025.93"/>
</g>
<!-- gate_14_1 -->
<g id="node932" class="node">
<title>gate_14_1</title>
<polygon fill="lightyellow" stroke="black" points="5041.51,-6927.98 4806.06,-6927.98 4745.49,-6823.98 4980.94,-6823.98 5041.51,-6927.98"/>
<text text-anchor="middle" x="4893.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_14_L1</text>
<text text-anchor="middle" x="4893.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4893.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4893.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_1&#45;&gt;gate_14_1 -->
<g id="edge916" class="edge">
<title>attention_14_1&#45;&gt;gate_14_1</title>
<path fill="none" stroke="black" d="M4893.5,-6963.85C4893.5,-6956.16 4893.5,-6947.35 4893.5,-6938.35"/>
<polygon fill="black" stroke="black" points="4897,-6938.16 4893.5,-6928.16 4890,-6938.16 4897,-6938.16"/>
</g>
<!-- expert_14_1 -->
<g id="node933" class="node">
<title>expert_14_1</title>
<polygon fill="lightgreen" stroke="black" points="4968,-6787.98 4819,-6787.98 4819,-6735.98 4968,-6735.98 4968,-6787.98"/>
<text text-anchor="middle" x="4893.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_14_L1</text>
<text text-anchor="middle" x="4893.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4893.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4893.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_1&#45;&gt;expert_14_1 -->
<g id="edge917" class="edge">
<title>gate_14_1&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" d="M4886.77,-6823.9C4886.69,-6815.23 4886.83,-6806.41 4887.18,-6798.27"/>
<polygon fill="black" stroke="black" points="4890.69,-6798.21 4887.77,-6788.03 4883.7,-6797.81 4890.69,-6798.21"/>
</g>
<!-- gate_14_1&#45;&gt;expert_14_1 -->
<g id="edge1282" class="edge">
<title>gate_14_1&#45;&gt;expert_14_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4900.23,-6823.9C4900.31,-6815.23 4900.17,-6806.41 4899.82,-6798.27"/>
<polygon fill="red" stroke="red" points="4903.3,-6797.81 4899.23,-6788.03 4896.31,-6798.21 4903.3,-6797.81"/>
</g>
<!-- aggregate_14_1 -->
<g id="node934" class="node">
<title>aggregate_14_1</title>
<polygon fill="lightyellow" stroke="black" points="5040.51,-6699.98 4805.06,-6699.98 4744.49,-6595.98 4979.94,-6595.98 5040.51,-6699.98"/>
<text text-anchor="middle" x="4892.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L1</text>
<text text-anchor="middle" x="4892.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4892.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4892.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_1&#45;&gt;aggregate_14_1 -->
<g id="edge918" class="edge">
<title>expert_14_1&#45;&gt;aggregate_14_1</title>
<path fill="none" stroke="black" d="M4893.28,-6735.85C4893.21,-6728.16 4893.13,-6719.35 4893.05,-6710.35"/>
<polygon fill="black" stroke="black" points="4896.55,-6710.13 4892.96,-6700.16 4889.55,-6710.19 4896.55,-6710.13"/>
</g>
<!-- attention_14_2 -->
<g id="node935" class="node">
<title>attention_14_2</title>
<polygon fill="lightgreen" stroke="black" points="4975.5,-6559.98 4807.5,-6559.98 4807.5,-6507.98 4975.5,-6507.98 4975.5,-6559.98"/>
<text text-anchor="middle" x="4891.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_14_L2</text>
<text text-anchor="middle" x="4891.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4891.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4891.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_1&#45;&gt;attention_14_2 -->
<g id="edge919" class="edge">
<title>aggregate_14_1&#45;&gt;attention_14_2</title>
<path fill="none" stroke="black" d="M4892.04,-6595.9C4891.97,-6587.23 4891.89,-6578.41 4891.82,-6570.27"/>
<polygon fill="black" stroke="black" points="4895.31,-6569.99 4891.72,-6560.03 4888.31,-6570.06 4895.31,-6569.99"/>
</g>
<!-- gate_14_2 -->
<g id="node936" class="node">
<title>gate_14_2</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-6471.98 4804.06,-6471.98 4743.49,-6367.98 4978.94,-6367.98 5039.51,-6471.98"/>
<text text-anchor="middle" x="4891.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_14_L2</text>
<text text-anchor="middle" x="4891.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4891.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_2&#45;&gt;gate_14_2 -->
<g id="edge920" class="edge">
<title>attention_14_2&#45;&gt;gate_14_2</title>
<path fill="none" stroke="black" d="M4891.5,-6507.85C4891.5,-6500.16 4891.5,-6491.35 4891.5,-6482.35"/>
<polygon fill="black" stroke="black" points="4895,-6482.16 4891.5,-6472.16 4888,-6482.16 4895,-6482.16"/>
</g>
<!-- expert_14_2 -->
<g id="node937" class="node">
<title>expert_14_2</title>
<polygon fill="lightgreen" stroke="black" points="4966,-6331.98 4817,-6331.98 4817,-6279.98 4966,-6279.98 4966,-6331.98"/>
<text text-anchor="middle" x="4891.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_14_L2</text>
<text text-anchor="middle" x="4891.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4891.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_2&#45;&gt;expert_14_2 -->
<g id="edge921" class="edge">
<title>gate_14_2&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" d="M4884.77,-6367.9C4884.69,-6359.23 4884.83,-6350.41 4885.18,-6342.27"/>
<polygon fill="black" stroke="black" points="4888.69,-6342.21 4885.77,-6332.03 4881.7,-6341.81 4888.69,-6342.21"/>
</g>
<!-- gate_14_2&#45;&gt;expert_14_2 -->
<g id="edge1283" class="edge">
<title>gate_14_2&#45;&gt;expert_14_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4898.23,-6367.9C4898.31,-6359.23 4898.17,-6350.41 4897.82,-6342.27"/>
<polygon fill="red" stroke="red" points="4901.3,-6341.81 4897.23,-6332.03 4894.31,-6342.21 4901.3,-6341.81"/>
</g>
<!-- aggregate_14_2 -->
<g id="node938" class="node">
<title>aggregate_14_2</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-6243.98 4804.06,-6243.98 4743.49,-6139.98 4978.94,-6139.98 5039.51,-6243.98"/>
<text text-anchor="middle" x="4891.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L2</text>
<text text-anchor="middle" x="4891.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4891.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4891.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_2&#45;&gt;aggregate_14_2 -->
<g id="edge922" class="edge">
<title>expert_14_2&#45;&gt;aggregate_14_2</title>
<path fill="none" stroke="black" d="M4891.5,-6279.85C4891.5,-6272.16 4891.5,-6263.35 4891.5,-6254.35"/>
<polygon fill="black" stroke="black" points="4895,-6254.16 4891.5,-6244.16 4888,-6254.16 4895,-6254.16"/>
</g>
<!-- attention_14_3 -->
<g id="node939" class="node">
<title>attention_14_3</title>
<polygon fill="lightgreen" stroke="black" points="4975.5,-6103.98 4807.5,-6103.98 4807.5,-6051.98 4975.5,-6051.98 4975.5,-6103.98"/>
<text text-anchor="middle" x="4891.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_14_L3</text>
<text text-anchor="middle" x="4891.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4891.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4891.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_2&#45;&gt;attention_14_3 -->
<g id="edge923" class="edge">
<title>aggregate_14_2&#45;&gt;attention_14_3</title>
<path fill="none" stroke="black" d="M4891.5,-6139.9C4891.5,-6131.23 4891.5,-6122.41 4891.5,-6114.27"/>
<polygon fill="black" stroke="black" points="4895,-6114.03 4891.5,-6104.03 4888,-6114.03 4895,-6114.03"/>
</g>
<!-- gate_14_3 -->
<g id="node940" class="node">
<title>gate_14_3</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-6015.98 4804.06,-6015.98 4743.49,-5911.98 4978.94,-5911.98 5039.51,-6015.98"/>
<text text-anchor="middle" x="4891.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_14_L3</text>
<text text-anchor="middle" x="4891.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4891.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_3&#45;&gt;gate_14_3 -->
<g id="edge924" class="edge">
<title>attention_14_3&#45;&gt;gate_14_3</title>
<path fill="none" stroke="black" d="M4891.5,-6051.85C4891.5,-6044.16 4891.5,-6035.35 4891.5,-6026.35"/>
<polygon fill="black" stroke="black" points="4895,-6026.16 4891.5,-6016.16 4888,-6026.16 4895,-6026.16"/>
</g>
<!-- expert_14_3 -->
<g id="node941" class="node">
<title>expert_14_3</title>
<polygon fill="lightgreen" stroke="black" points="4966,-5875.98 4817,-5875.98 4817,-5823.98 4966,-5823.98 4966,-5875.98"/>
<text text-anchor="middle" x="4891.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_14_L3</text>
<text text-anchor="middle" x="4891.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4891.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_3&#45;&gt;expert_14_3 -->
<g id="edge925" class="edge">
<title>gate_14_3&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" d="M4884.77,-5911.9C4884.69,-5903.23 4884.83,-5894.41 4885.18,-5886.27"/>
<polygon fill="black" stroke="black" points="4888.69,-5886.21 4885.77,-5876.03 4881.7,-5885.81 4888.69,-5886.21"/>
</g>
<!-- gate_14_3&#45;&gt;expert_14_3 -->
<g id="edge1284" class="edge">
<title>gate_14_3&#45;&gt;expert_14_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4898.23,-5911.9C4898.31,-5903.23 4898.17,-5894.41 4897.82,-5886.27"/>
<polygon fill="red" stroke="red" points="4901.3,-5885.81 4897.23,-5876.03 4894.31,-5886.21 4901.3,-5885.81"/>
</g>
<!-- aggregate_14_3 -->
<g id="node942" class="node">
<title>aggregate_14_3</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-5787.98 4804.06,-5787.98 4743.49,-5683.98 4978.94,-5683.98 5039.51,-5787.98"/>
<text text-anchor="middle" x="4891.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L3</text>
<text text-anchor="middle" x="4891.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4891.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4891.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_3&#45;&gt;aggregate_14_3 -->
<g id="edge926" class="edge">
<title>expert_14_3&#45;&gt;aggregate_14_3</title>
<path fill="none" stroke="black" d="M4891.5,-5823.85C4891.5,-5816.16 4891.5,-5807.35 4891.5,-5798.35"/>
<polygon fill="black" stroke="black" points="4895,-5798.16 4891.5,-5788.16 4888,-5798.16 4895,-5798.16"/>
</g>
<!-- attention_14_4 -->
<g id="node943" class="node">
<title>attention_14_4</title>
<polygon fill="lightgreen" stroke="black" points="4975.5,-5647.98 4807.5,-5647.98 4807.5,-5595.98 4975.5,-5595.98 4975.5,-5647.98"/>
<text text-anchor="middle" x="4891.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_14_L4</text>
<text text-anchor="middle" x="4891.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4891.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4891.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_3&#45;&gt;attention_14_4 -->
<g id="edge927" class="edge">
<title>aggregate_14_3&#45;&gt;attention_14_4</title>
<path fill="none" stroke="black" d="M4891.5,-5683.9C4891.5,-5675.23 4891.5,-5666.41 4891.5,-5658.27"/>
<polygon fill="black" stroke="black" points="4895,-5658.03 4891.5,-5648.03 4888,-5658.03 4895,-5658.03"/>
</g>
<!-- gate_14_4 -->
<g id="node944" class="node">
<title>gate_14_4</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-5559.98 4804.06,-5559.98 4743.49,-5455.98 4978.94,-5455.98 5039.51,-5559.98"/>
<text text-anchor="middle" x="4891.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_14_L4</text>
<text text-anchor="middle" x="4891.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4891.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_4&#45;&gt;gate_14_4 -->
<g id="edge928" class="edge">
<title>attention_14_4&#45;&gt;gate_14_4</title>
<path fill="none" stroke="black" d="M4891.5,-5595.85C4891.5,-5588.16 4891.5,-5579.35 4891.5,-5570.35"/>
<polygon fill="black" stroke="black" points="4895,-5570.16 4891.5,-5560.16 4888,-5570.16 4895,-5570.16"/>
</g>
<!-- expert_14_4 -->
<g id="node945" class="node">
<title>expert_14_4</title>
<polygon fill="lightgreen" stroke="black" points="4966,-5419.98 4817,-5419.98 4817,-5367.98 4966,-5367.98 4966,-5419.98"/>
<text text-anchor="middle" x="4891.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_14_L4</text>
<text text-anchor="middle" x="4891.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4891.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_4&#45;&gt;expert_14_4 -->
<g id="edge929" class="edge">
<title>gate_14_4&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" d="M4884.77,-5455.9C4884.69,-5447.23 4884.83,-5438.41 4885.18,-5430.27"/>
<polygon fill="black" stroke="black" points="4888.69,-5430.21 4885.77,-5420.03 4881.7,-5429.81 4888.69,-5430.21"/>
</g>
<!-- gate_14_4&#45;&gt;expert_14_4 -->
<g id="edge1285" class="edge">
<title>gate_14_4&#45;&gt;expert_14_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4898.23,-5455.9C4898.31,-5447.23 4898.17,-5438.41 4897.82,-5430.27"/>
<polygon fill="red" stroke="red" points="4901.3,-5429.81 4897.23,-5420.03 4894.31,-5430.21 4901.3,-5429.81"/>
</g>
<!-- aggregate_14_4 -->
<g id="node946" class="node">
<title>aggregate_14_4</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-5331.98 4804.06,-5331.98 4743.49,-5227.98 4978.94,-5227.98 5039.51,-5331.98"/>
<text text-anchor="middle" x="4891.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L4</text>
<text text-anchor="middle" x="4891.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4891.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4891.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_4&#45;&gt;aggregate_14_4 -->
<g id="edge930" class="edge">
<title>expert_14_4&#45;&gt;aggregate_14_4</title>
<path fill="none" stroke="black" d="M4891.5,-5367.85C4891.5,-5360.16 4891.5,-5351.35 4891.5,-5342.35"/>
<polygon fill="black" stroke="black" points="4895,-5342.16 4891.5,-5332.16 4888,-5342.16 4895,-5342.16"/>
</g>
<!-- attention_14_5 -->
<g id="node947" class="node">
<title>attention_14_5</title>
<polygon fill="lightgreen" stroke="black" points="4975.5,-5191.98 4807.5,-5191.98 4807.5,-5139.98 4975.5,-5139.98 4975.5,-5191.98"/>
<text text-anchor="middle" x="4891.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_14_L5</text>
<text text-anchor="middle" x="4891.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4891.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4891.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_4&#45;&gt;attention_14_5 -->
<g id="edge931" class="edge">
<title>aggregate_14_4&#45;&gt;attention_14_5</title>
<path fill="none" stroke="black" d="M4891.5,-5227.9C4891.5,-5219.23 4891.5,-5210.41 4891.5,-5202.27"/>
<polygon fill="black" stroke="black" points="4895,-5202.03 4891.5,-5192.03 4888,-5202.03 4895,-5202.03"/>
</g>
<!-- gate_14_5 -->
<g id="node948" class="node">
<title>gate_14_5</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-5103.98 4804.06,-5103.98 4743.49,-4999.98 4978.94,-4999.98 5039.51,-5103.98"/>
<text text-anchor="middle" x="4891.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_14_L5</text>
<text text-anchor="middle" x="4891.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4891.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_5&#45;&gt;gate_14_5 -->
<g id="edge932" class="edge">
<title>attention_14_5&#45;&gt;gate_14_5</title>
<path fill="none" stroke="black" d="M4891.5,-5139.85C4891.5,-5132.16 4891.5,-5123.35 4891.5,-5114.35"/>
<polygon fill="black" stroke="black" points="4895,-5114.16 4891.5,-5104.16 4888,-5114.16 4895,-5114.16"/>
</g>
<!-- expert_14_5 -->
<g id="node949" class="node">
<title>expert_14_5</title>
<polygon fill="lightgreen" stroke="black" points="4966,-4963.98 4817,-4963.98 4817,-4911.98 4966,-4911.98 4966,-4963.98"/>
<text text-anchor="middle" x="4891.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_14_L5</text>
<text text-anchor="middle" x="4891.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4891.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4891.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_5&#45;&gt;expert_14_5 -->
<g id="edge933" class="edge">
<title>gate_14_5&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" d="M4884.77,-4999.9C4884.69,-4991.23 4884.83,-4982.41 4885.18,-4974.27"/>
<polygon fill="black" stroke="black" points="4888.69,-4974.21 4885.77,-4964.03 4881.7,-4973.81 4888.69,-4974.21"/>
</g>
<!-- gate_14_5&#45;&gt;expert_14_5 -->
<g id="edge1286" class="edge">
<title>gate_14_5&#45;&gt;expert_14_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4898.23,-4999.9C4898.31,-4991.23 4898.17,-4982.41 4897.82,-4974.27"/>
<polygon fill="red" stroke="red" points="4901.3,-4973.81 4897.23,-4964.03 4894.31,-4974.21 4901.3,-4973.81"/>
</g>
<!-- aggregate_14_5 -->
<g id="node950" class="node">
<title>aggregate_14_5</title>
<polygon fill="lightyellow" stroke="black" points="5039.51,-4875.98 4804.06,-4875.98 4743.49,-4771.98 4978.94,-4771.98 5039.51,-4875.98"/>
<text text-anchor="middle" x="4891.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L5</text>
<text text-anchor="middle" x="4891.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4891.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4891.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_5&#45;&gt;aggregate_14_5 -->
<g id="edge934" class="edge">
<title>expert_14_5&#45;&gt;aggregate_14_5</title>
<path fill="none" stroke="black" d="M4891.5,-4911.85C4891.5,-4904.16 4891.5,-4895.35 4891.5,-4886.35"/>
<polygon fill="black" stroke="black" points="4895,-4886.16 4891.5,-4876.16 4888,-4886.16 4895,-4886.16"/>
</g>
<!-- attention_14_6 -->
<g id="node951" class="node">
<title>attention_14_6</title>
<polygon fill="lightgreen" stroke="black" points="4967.5,-4735.98 4799.5,-4735.98 4799.5,-4683.98 4967.5,-4683.98 4967.5,-4735.98"/>
<text text-anchor="middle" x="4883.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_14_L6</text>
<text text-anchor="middle" x="4883.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4883.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4883.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_5&#45;&gt;attention_14_6 -->
<g id="edge935" class="edge">
<title>aggregate_14_5&#45;&gt;attention_14_6</title>
<path fill="none" stroke="black" d="M4887.85,-4771.9C4887.23,-4763.23 4886.6,-4754.41 4886.02,-4746.27"/>
<polygon fill="black" stroke="black" points="4889.49,-4745.75 4885.29,-4736.03 4882.51,-4746.25 4889.49,-4745.75"/>
</g>
<!-- gate_14_6 -->
<g id="node952" class="node">
<title>gate_14_6</title>
<polygon fill="lightyellow" stroke="black" points="5031.51,-4647.98 4796.06,-4647.98 4735.49,-4543.98 4970.94,-4543.98 5031.51,-4647.98"/>
<text text-anchor="middle" x="4883.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_14_L6</text>
<text text-anchor="middle" x="4883.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4883.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4883.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_6&#45;&gt;gate_14_6 -->
<g id="edge936" class="edge">
<title>attention_14_6&#45;&gt;gate_14_6</title>
<path fill="none" stroke="black" d="M4883.5,-4683.85C4883.5,-4676.16 4883.5,-4667.35 4883.5,-4658.35"/>
<polygon fill="black" stroke="black" points="4887,-4658.16 4883.5,-4648.16 4880,-4658.16 4887,-4658.16"/>
</g>
<!-- expert_14_6 -->
<g id="node953" class="node">
<title>expert_14_6</title>
<polygon fill="lightgreen" stroke="black" points="4958,-4507.98 4809,-4507.98 4809,-4455.98 4958,-4455.98 4958,-4507.98"/>
<text text-anchor="middle" x="4883.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_14_L6</text>
<text text-anchor="middle" x="4883.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4883.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4883.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_6&#45;&gt;expert_14_6 -->
<g id="edge937" class="edge">
<title>gate_14_6&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" d="M4876.77,-4543.9C4876.69,-4535.23 4876.83,-4526.41 4877.18,-4518.27"/>
<polygon fill="black" stroke="black" points="4880.69,-4518.21 4877.77,-4508.03 4873.7,-4517.81 4880.69,-4518.21"/>
</g>
<!-- gate_14_6&#45;&gt;expert_14_6 -->
<g id="edge1287" class="edge">
<title>gate_14_6&#45;&gt;expert_14_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4890.23,-4543.9C4890.31,-4535.23 4890.17,-4526.41 4889.82,-4518.27"/>
<polygon fill="red" stroke="red" points="4893.3,-4517.81 4889.23,-4508.03 4886.31,-4518.21 4893.3,-4517.81"/>
</g>
<!-- aggregate_14_6 -->
<g id="node954" class="node">
<title>aggregate_14_6</title>
<polygon fill="lightyellow" stroke="black" points="5027.51,-4419.98 4792.06,-4419.98 4731.49,-4315.98 4966.94,-4315.98 5027.51,-4419.98"/>
<text text-anchor="middle" x="4879.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L6</text>
<text text-anchor="middle" x="4879.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4879.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4879.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_6&#45;&gt;aggregate_14_6 -->
<g id="edge938" class="edge">
<title>expert_14_6&#45;&gt;aggregate_14_6</title>
<path fill="none" stroke="black" d="M4882.6,-4455.85C4882.33,-4448.16 4882.01,-4439.35 4881.69,-4430.35"/>
<polygon fill="black" stroke="black" points="4885.18,-4430.03 4881.33,-4420.16 4878.19,-4430.28 4885.18,-4430.03"/>
</g>
<!-- attention_14_7 -->
<g id="node955" class="node">
<title>attention_14_7</title>
<polygon fill="lightgreen" stroke="black" points="4954.5,-4279.98 4786.5,-4279.98 4786.5,-4227.98 4954.5,-4227.98 4954.5,-4279.98"/>
<text text-anchor="middle" x="4870.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_14_L7</text>
<text text-anchor="middle" x="4870.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4870.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4870.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_6&#45;&gt;attention_14_7 -->
<g id="edge939" class="edge">
<title>aggregate_14_6&#45;&gt;attention_14_7</title>
<path fill="none" stroke="black" d="M4875.4,-4315.9C4874.69,-4307.14 4873.97,-4298.21 4873.31,-4289.99"/>
<polygon fill="black" stroke="black" points="4876.8,-4289.71 4872.51,-4280.03 4869.83,-4290.27 4876.8,-4289.71"/>
</g>
<!-- gate_14_7 -->
<g id="node956" class="node">
<title>gate_14_7</title>
<polygon fill="lightyellow" stroke="black" points="5018.51,-4191.98 4783.06,-4191.98 4722.49,-4087.98 4957.94,-4087.98 5018.51,-4191.98"/>
<text text-anchor="middle" x="4870.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_14_L7</text>
<text text-anchor="middle" x="4870.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4870.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4870.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_7&#45;&gt;gate_14_7 -->
<g id="edge940" class="edge">
<title>attention_14_7&#45;&gt;gate_14_7</title>
<path fill="none" stroke="black" d="M4870.5,-4227.85C4870.5,-4220.16 4870.5,-4211.35 4870.5,-4202.35"/>
<polygon fill="black" stroke="black" points="4874,-4202.16 4870.5,-4192.16 4867,-4202.16 4874,-4202.16"/>
</g>
<!-- expert_14_7 -->
<g id="node957" class="node">
<title>expert_14_7</title>
<polygon fill="lightgreen" stroke="black" points="4945,-4051.98 4796,-4051.98 4796,-3999.98 4945,-3999.98 4945,-4051.98"/>
<text text-anchor="middle" x="4870.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_14_L7</text>
<text text-anchor="middle" x="4870.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4870.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4870.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_7&#45;&gt;expert_14_7 -->
<g id="edge941" class="edge">
<title>gate_14_7&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" d="M4863.77,-4087.9C4863.69,-4079.23 4863.83,-4070.41 4864.18,-4062.27"/>
<polygon fill="black" stroke="black" points="4867.69,-4062.21 4864.77,-4052.03 4860.7,-4061.81 4867.69,-4062.21"/>
</g>
<!-- gate_14_7&#45;&gt;expert_14_7 -->
<g id="edge1288" class="edge">
<title>gate_14_7&#45;&gt;expert_14_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4877.23,-4087.9C4877.31,-4079.23 4877.17,-4070.41 4876.82,-4062.27"/>
<polygon fill="red" stroke="red" points="4880.3,-4061.81 4876.23,-4052.03 4873.31,-4062.21 4880.3,-4061.81"/>
</g>
<!-- aggregate_14_7 -->
<g id="node958" class="node">
<title>aggregate_14_7</title>
<polygon fill="lightyellow" stroke="black" points="5018.51,-3963.98 4783.06,-3963.98 4722.49,-3859.98 4957.94,-3859.98 5018.51,-3963.98"/>
<text text-anchor="middle" x="4870.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L7</text>
<text text-anchor="middle" x="4870.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4870.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4870.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_7&#45;&gt;aggregate_14_7 -->
<g id="edge942" class="edge">
<title>expert_14_7&#45;&gt;aggregate_14_7</title>
<path fill="none" stroke="black" d="M4870.5,-3999.85C4870.5,-3992.16 4870.5,-3983.35 4870.5,-3974.35"/>
<polygon fill="black" stroke="black" points="4874,-3974.16 4870.5,-3964.16 4867,-3974.16 4874,-3974.16"/>
</g>
<!-- attention_14_8 -->
<g id="node959" class="node">
<title>attention_14_8</title>
<polygon fill="lightgreen" stroke="black" points="4950.5,-3823.98 4782.5,-3823.98 4782.5,-3771.98 4950.5,-3771.98 4950.5,-3823.98"/>
<text text-anchor="middle" x="4866.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_14_L8</text>
<text text-anchor="middle" x="4866.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4866.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4866.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_7&#45;&gt;attention_14_8 -->
<g id="edge943" class="edge">
<title>aggregate_14_7&#45;&gt;attention_14_8</title>
<path fill="none" stroke="black" d="M4868.68,-3859.9C4868.37,-3851.23 4868.05,-3842.41 4867.76,-3834.27"/>
<polygon fill="black" stroke="black" points="4871.25,-3833.89 4867.4,-3824.03 4864.25,-3834.14 4871.25,-3833.89"/>
</g>
<!-- gate_14_8 -->
<g id="node960" class="node">
<title>gate_14_8</title>
<polygon fill="lightyellow" stroke="black" points="5013.51,-3735.98 4778.06,-3735.98 4717.49,-3631.98 4952.94,-3631.98 5013.51,-3735.98"/>
<text text-anchor="middle" x="4865.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_14_L8</text>
<text text-anchor="middle" x="4865.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4865.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4865.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_8&#45;&gt;gate_14_8 -->
<g id="edge944" class="edge">
<title>attention_14_8&#45;&gt;gate_14_8</title>
<path fill="none" stroke="black" d="M4866.28,-3771.85C4866.21,-3764.16 4866.13,-3755.35 4866.05,-3746.35"/>
<polygon fill="black" stroke="black" points="4869.55,-3746.13 4865.96,-3736.16 4862.55,-3746.19 4869.55,-3746.13"/>
</g>
<!-- expert_14_8 -->
<g id="node961" class="node">
<title>expert_14_8</title>
<polygon fill="lightgreen" stroke="black" points="4938,-3595.98 4789,-3595.98 4789,-3543.98 4938,-3543.98 4938,-3595.98"/>
<text text-anchor="middle" x="4863.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_14_L8</text>
<text text-anchor="middle" x="4863.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4863.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4863.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_8&#45;&gt;expert_14_8 -->
<g id="edge945" class="edge">
<title>gate_14_8&#45;&gt;expert_14_8</title>
<path fill="none" stroke="black" d="M4857.86,-3631.9C4857.63,-3623.23 4857.6,-3614.41 4857.81,-3606.27"/>
<polygon fill="black" stroke="black" points="4861.32,-3606.16 4858.21,-3596.03 4854.32,-3605.88 4861.32,-3606.16"/>
</g>
<!-- gate_14_8&#45;&gt;expert_14_8 -->
<g id="edge1289" class="edge">
<title>gate_14_8&#45;&gt;expert_14_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4871.32,-3631.9C4871.24,-3623.23 4870.95,-3614.41 4870.45,-3606.27"/>
<polygon fill="red" stroke="red" points="4873.92,-3605.74 4869.68,-3596.03 4866.94,-3606.26 4873.92,-3605.74"/>
</g>
<!-- aggregate_14_8 -->
<g id="node962" class="node">
<title>aggregate_14_8</title>
<polygon fill="lightyellow" stroke="black" points="5011.51,-3507.98 4776.06,-3507.98 4715.49,-3403.98 4950.94,-3403.98 5011.51,-3507.98"/>
<text text-anchor="middle" x="4863.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L8</text>
<text text-anchor="middle" x="4863.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4863.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4863.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_8&#45;&gt;aggregate_14_8 -->
<g id="edge946" class="edge">
<title>expert_14_8&#45;&gt;aggregate_14_8</title>
<path fill="none" stroke="black" d="M4863.5,-3543.85C4863.5,-3536.16 4863.5,-3527.35 4863.5,-3518.35"/>
<polygon fill="black" stroke="black" points="4867,-3518.16 4863.5,-3508.16 4860,-3518.16 4867,-3518.16"/>
</g>
<!-- attention_14_9 -->
<g id="node963" class="node">
<title>attention_14_9</title>
<polygon fill="lightgreen" stroke="black" points="4947.5,-3367.98 4779.5,-3367.98 4779.5,-3315.98 4947.5,-3315.98 4947.5,-3367.98"/>
<text text-anchor="middle" x="4863.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_14_L9</text>
<text text-anchor="middle" x="4863.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4863.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4863.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_8&#45;&gt;attention_14_9 -->
<g id="edge947" class="edge">
<title>aggregate_14_8&#45;&gt;attention_14_9</title>
<path fill="none" stroke="black" d="M4863.5,-3403.9C4863.5,-3395.23 4863.5,-3386.41 4863.5,-3378.27"/>
<polygon fill="black" stroke="black" points="4867,-3378.03 4863.5,-3368.03 4860,-3378.03 4867,-3378.03"/>
</g>
<!-- gate_14_9 -->
<g id="node964" class="node">
<title>gate_14_9</title>
<polygon fill="lightyellow" stroke="black" points="5010.51,-3279.98 4775.06,-3279.98 4714.49,-3175.98 4949.94,-3175.98 5010.51,-3279.98"/>
<text text-anchor="middle" x="4862.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_14_L9</text>
<text text-anchor="middle" x="4862.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4862.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4862.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_9&#45;&gt;gate_14_9 -->
<g id="edge948" class="edge">
<title>attention_14_9&#45;&gt;gate_14_9</title>
<path fill="none" stroke="black" d="M4863.28,-3315.85C4863.21,-3308.16 4863.13,-3299.35 4863.05,-3290.35"/>
<polygon fill="black" stroke="black" points="4866.55,-3290.13 4862.96,-3280.16 4859.55,-3290.19 4866.55,-3290.13"/>
</g>
<!-- expert_14_9 -->
<g id="node965" class="node">
<title>expert_14_9</title>
<polygon fill="lightgreen" stroke="black" points="4936,-3139.98 4787,-3139.98 4787,-3087.98 4936,-3087.98 4936,-3139.98"/>
<text text-anchor="middle" x="4861.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_14_L9</text>
<text text-anchor="middle" x="4861.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_9&#45;&gt;expert_14_9 -->
<g id="edge949" class="edge">
<title>gate_14_9&#45;&gt;expert_14_9</title>
<path fill="none" stroke="black" d="M4855.32,-3175.9C4855.16,-3167.23 4855.22,-3158.41 4855.49,-3150.27"/>
<polygon fill="black" stroke="black" points="4859,-3150.18 4855.99,-3140.03 4852.01,-3149.85 4859,-3150.18"/>
</g>
<!-- gate_14_9&#45;&gt;expert_14_9 -->
<g id="edge1290" class="edge">
<title>gate_14_9&#45;&gt;expert_14_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.77,-3175.9C4868.78,-3167.23 4868.56,-3158.41 4868.14,-3150.27"/>
<polygon fill="red" stroke="red" points="4871.61,-3149.77 4867.46,-3140.03 4864.63,-3150.24 4871.61,-3149.77"/>
</g>
<!-- aggregate_14_9 -->
<g id="node966" class="node">
<title>aggregate_14_9</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-3051.98 4774.06,-3051.98 4713.49,-2947.98 4948.94,-2947.98 5009.51,-3051.98"/>
<text text-anchor="middle" x="4861.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L9</text>
<text text-anchor="middle" x="4861.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_9&#45;&gt;aggregate_14_9 -->
<g id="edge950" class="edge">
<title>expert_14_9&#45;&gt;aggregate_14_9</title>
<path fill="none" stroke="black" d="M4861.5,-3087.85C4861.5,-3080.16 4861.5,-3071.35 4861.5,-3062.35"/>
<polygon fill="black" stroke="black" points="4865,-3062.16 4861.5,-3052.16 4858,-3062.16 4865,-3062.16"/>
</g>
<!-- attention_14_10 -->
<g id="node967" class="node">
<title>attention_14_10</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-2911.98 4777.5,-2911.98 4777.5,-2859.98 4945.5,-2859.98 4945.5,-2911.98"/>
<text text-anchor="middle" x="4861.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_14_L10</text>
<text text-anchor="middle" x="4861.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_9&#45;&gt;attention_14_10 -->
<g id="edge951" class="edge">
<title>aggregate_14_9&#45;&gt;attention_14_10</title>
<path fill="none" stroke="black" d="M4861.5,-2947.9C4861.5,-2939.23 4861.5,-2930.41 4861.5,-2922.27"/>
<polygon fill="black" stroke="black" points="4865,-2922.03 4861.5,-2912.03 4858,-2922.03 4865,-2922.03"/>
</g>
<!-- gate_14_10 -->
<g id="node968" class="node">
<title>gate_14_10</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-2823.98 4774.06,-2823.98 4713.49,-2719.98 4948.94,-2719.98 5009.51,-2823.98"/>
<text text-anchor="middle" x="4861.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_14_L10</text>
<text text-anchor="middle" x="4861.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_10&#45;&gt;gate_14_10 -->
<g id="edge952" class="edge">
<title>attention_14_10&#45;&gt;gate_14_10</title>
<path fill="none" stroke="black" d="M4861.5,-2859.85C4861.5,-2852.16 4861.5,-2843.35 4861.5,-2834.35"/>
<polygon fill="black" stroke="black" points="4865,-2834.16 4861.5,-2824.16 4858,-2834.16 4865,-2834.16"/>
</g>
<!-- expert_14_10 -->
<g id="node969" class="node">
<title>expert_14_10</title>
<polygon fill="lightgreen" stroke="black" points="4936,-2683.98 4787,-2683.98 4787,-2631.98 4936,-2631.98 4936,-2683.98"/>
<text text-anchor="middle" x="4861.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_14_L10</text>
<text text-anchor="middle" x="4861.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_10&#45;&gt;expert_14_10 -->
<g id="edge953" class="edge">
<title>gate_14_10&#45;&gt;expert_14_10</title>
<path fill="none" stroke="black" d="M4854.77,-2719.9C4854.69,-2711.23 4854.83,-2702.41 4855.18,-2694.27"/>
<polygon fill="black" stroke="black" points="4858.69,-2694.21 4855.77,-2684.03 4851.7,-2693.81 4858.69,-2694.21"/>
</g>
<!-- gate_14_10&#45;&gt;expert_14_10 -->
<g id="edge1291" class="edge">
<title>gate_14_10&#45;&gt;expert_14_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-2719.9C4868.31,-2711.23 4868.17,-2702.41 4867.82,-2694.27"/>
<polygon fill="red" stroke="red" points="4871.3,-2693.81 4867.23,-2684.03 4864.31,-2694.21 4871.3,-2693.81"/>
</g>
<!-- aggregate_14_10 -->
<g id="node970" class="node">
<title>aggregate_14_10</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-2595.98 4774.06,-2595.98 4713.49,-2491.98 4948.94,-2491.98 5009.51,-2595.98"/>
<text text-anchor="middle" x="4861.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L10</text>
<text text-anchor="middle" x="4861.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_10&#45;&gt;aggregate_14_10 -->
<g id="edge954" class="edge">
<title>expert_14_10&#45;&gt;aggregate_14_10</title>
<path fill="none" stroke="black" d="M4861.5,-2631.85C4861.5,-2624.16 4861.5,-2615.35 4861.5,-2606.35"/>
<polygon fill="black" stroke="black" points="4865,-2606.16 4861.5,-2596.16 4858,-2606.16 4865,-2606.16"/>
</g>
<!-- attention_14_11 -->
<g id="node971" class="node">
<title>attention_14_11</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-2455.98 4777.5,-2455.98 4777.5,-2403.98 4945.5,-2403.98 4945.5,-2455.98"/>
<text text-anchor="middle" x="4861.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_14_L11</text>
<text text-anchor="middle" x="4861.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_10&#45;&gt;attention_14_11 -->
<g id="edge955" class="edge">
<title>aggregate_14_10&#45;&gt;attention_14_11</title>
<path fill="none" stroke="black" d="M4861.5,-2491.9C4861.5,-2483.23 4861.5,-2474.41 4861.5,-2466.27"/>
<polygon fill="black" stroke="black" points="4865,-2466.03 4861.5,-2456.03 4858,-2466.03 4865,-2466.03"/>
</g>
<!-- gate_14_11 -->
<g id="node972" class="node">
<title>gate_14_11</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-2367.98 4774.06,-2367.98 4713.49,-2263.98 4948.94,-2263.98 5009.51,-2367.98"/>
<text text-anchor="middle" x="4861.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_14_L11</text>
<text text-anchor="middle" x="4861.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_11&#45;&gt;gate_14_11 -->
<g id="edge956" class="edge">
<title>attention_14_11&#45;&gt;gate_14_11</title>
<path fill="none" stroke="black" d="M4861.5,-2403.85C4861.5,-2396.16 4861.5,-2387.35 4861.5,-2378.35"/>
<polygon fill="black" stroke="black" points="4865,-2378.16 4861.5,-2368.16 4858,-2378.16 4865,-2378.16"/>
</g>
<!-- expert_14_11 -->
<g id="node973" class="node">
<title>expert_14_11</title>
<polygon fill="lightgreen" stroke="black" points="4936,-2227.98 4787,-2227.98 4787,-2175.98 4936,-2175.98 4936,-2227.98"/>
<text text-anchor="middle" x="4861.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_14_L11</text>
<text text-anchor="middle" x="4861.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_11&#45;&gt;expert_14_11 -->
<g id="edge957" class="edge">
<title>gate_14_11&#45;&gt;expert_14_11</title>
<path fill="none" stroke="black" d="M4854.77,-2263.9C4854.69,-2255.23 4854.83,-2246.41 4855.18,-2238.27"/>
<polygon fill="black" stroke="black" points="4858.69,-2238.21 4855.77,-2228.03 4851.7,-2237.81 4858.69,-2238.21"/>
</g>
<!-- gate_14_11&#45;&gt;expert_14_11 -->
<g id="edge1292" class="edge">
<title>gate_14_11&#45;&gt;expert_14_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-2263.9C4868.31,-2255.23 4868.17,-2246.41 4867.82,-2238.27"/>
<polygon fill="red" stroke="red" points="4871.3,-2237.81 4867.23,-2228.03 4864.31,-2238.21 4871.3,-2237.81"/>
</g>
<!-- aggregate_14_11 -->
<g id="node974" class="node">
<title>aggregate_14_11</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-2139.98 4774.06,-2139.98 4713.49,-2035.98 4948.94,-2035.98 5009.51,-2139.98"/>
<text text-anchor="middle" x="4861.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L11</text>
<text text-anchor="middle" x="4861.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_11&#45;&gt;aggregate_14_11 -->
<g id="edge958" class="edge">
<title>expert_14_11&#45;&gt;aggregate_14_11</title>
<path fill="none" stroke="black" d="M4861.5,-2175.85C4861.5,-2168.16 4861.5,-2159.35 4861.5,-2150.35"/>
<polygon fill="black" stroke="black" points="4865,-2150.16 4861.5,-2140.16 4858,-2150.16 4865,-2150.16"/>
</g>
<!-- attention_14_12 -->
<g id="node975" class="node">
<title>attention_14_12</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-1999.98 4777.5,-1999.98 4777.5,-1947.98 4945.5,-1947.98 4945.5,-1999.98"/>
<text text-anchor="middle" x="4861.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_14_L12</text>
<text text-anchor="middle" x="4861.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_11&#45;&gt;attention_14_12 -->
<g id="edge959" class="edge">
<title>aggregate_14_11&#45;&gt;attention_14_12</title>
<path fill="none" stroke="black" d="M4861.5,-2035.9C4861.5,-2027.23 4861.5,-2018.41 4861.5,-2010.27"/>
<polygon fill="black" stroke="black" points="4865,-2010.03 4861.5,-2000.03 4858,-2010.03 4865,-2010.03"/>
</g>
<!-- gate_14_12 -->
<g id="node976" class="node">
<title>gate_14_12</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-1911.98 4774.06,-1911.98 4713.49,-1807.98 4948.94,-1807.98 5009.51,-1911.98"/>
<text text-anchor="middle" x="4861.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_14_L12</text>
<text text-anchor="middle" x="4861.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_12&#45;&gt;gate_14_12 -->
<g id="edge960" class="edge">
<title>attention_14_12&#45;&gt;gate_14_12</title>
<path fill="none" stroke="black" d="M4861.5,-1947.85C4861.5,-1940.16 4861.5,-1931.35 4861.5,-1922.35"/>
<polygon fill="black" stroke="black" points="4865,-1922.16 4861.5,-1912.16 4858,-1922.16 4865,-1922.16"/>
</g>
<!-- expert_14_12 -->
<g id="node977" class="node">
<title>expert_14_12</title>
<polygon fill="lightgreen" stroke="black" points="4936,-1771.98 4787,-1771.98 4787,-1719.98 4936,-1719.98 4936,-1771.98"/>
<text text-anchor="middle" x="4861.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_14_L12</text>
<text text-anchor="middle" x="4861.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_12&#45;&gt;expert_14_12 -->
<g id="edge961" class="edge">
<title>gate_14_12&#45;&gt;expert_14_12</title>
<path fill="none" stroke="black" d="M4854.77,-1807.9C4854.69,-1799.23 4854.83,-1790.41 4855.18,-1782.27"/>
<polygon fill="black" stroke="black" points="4858.69,-1782.21 4855.77,-1772.03 4851.7,-1781.81 4858.69,-1782.21"/>
</g>
<!-- gate_14_12&#45;&gt;expert_14_12 -->
<g id="edge1293" class="edge">
<title>gate_14_12&#45;&gt;expert_14_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-1807.9C4868.31,-1799.23 4868.17,-1790.41 4867.82,-1782.27"/>
<polygon fill="red" stroke="red" points="4871.3,-1781.81 4867.23,-1772.03 4864.31,-1782.21 4871.3,-1781.81"/>
</g>
<!-- aggregate_14_12 -->
<g id="node978" class="node">
<title>aggregate_14_12</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-1683.98 4774.06,-1683.98 4713.49,-1579.98 4948.94,-1579.98 5009.51,-1683.98"/>
<text text-anchor="middle" x="4861.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L12</text>
<text text-anchor="middle" x="4861.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_12&#45;&gt;aggregate_14_12 -->
<g id="edge962" class="edge">
<title>expert_14_12&#45;&gt;aggregate_14_12</title>
<path fill="none" stroke="black" d="M4861.5,-1719.85C4861.5,-1712.16 4861.5,-1703.35 4861.5,-1694.35"/>
<polygon fill="black" stroke="black" points="4865,-1694.16 4861.5,-1684.16 4858,-1694.16 4865,-1694.16"/>
</g>
<!-- attention_14_13 -->
<g id="node979" class="node">
<title>attention_14_13</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-1543.98 4777.5,-1543.98 4777.5,-1491.98 4945.5,-1491.98 4945.5,-1543.98"/>
<text text-anchor="middle" x="4861.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_14_L13</text>
<text text-anchor="middle" x="4861.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_12&#45;&gt;attention_14_13 -->
<g id="edge963" class="edge">
<title>aggregate_14_12&#45;&gt;attention_14_13</title>
<path fill="none" stroke="black" d="M4861.5,-1579.9C4861.5,-1571.23 4861.5,-1562.41 4861.5,-1554.27"/>
<polygon fill="black" stroke="black" points="4865,-1554.03 4861.5,-1544.03 4858,-1554.03 4865,-1554.03"/>
</g>
<!-- gate_14_13 -->
<g id="node980" class="node">
<title>gate_14_13</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-1455.98 4774.06,-1455.98 4713.49,-1351.98 4948.94,-1351.98 5009.51,-1455.98"/>
<text text-anchor="middle" x="4861.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_14_L13</text>
<text text-anchor="middle" x="4861.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_13&#45;&gt;gate_14_13 -->
<g id="edge964" class="edge">
<title>attention_14_13&#45;&gt;gate_14_13</title>
<path fill="none" stroke="black" d="M4861.5,-1491.85C4861.5,-1484.16 4861.5,-1475.35 4861.5,-1466.35"/>
<polygon fill="black" stroke="black" points="4865,-1466.16 4861.5,-1456.16 4858,-1466.16 4865,-1466.16"/>
</g>
<!-- expert_14_13 -->
<g id="node981" class="node">
<title>expert_14_13</title>
<polygon fill="lightgreen" stroke="black" points="4936,-1315.98 4787,-1315.98 4787,-1263.98 4936,-1263.98 4936,-1315.98"/>
<text text-anchor="middle" x="4861.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_14_L13</text>
<text text-anchor="middle" x="4861.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_13&#45;&gt;expert_14_13 -->
<g id="edge965" class="edge">
<title>gate_14_13&#45;&gt;expert_14_13</title>
<path fill="none" stroke="black" d="M4854.77,-1351.9C4854.69,-1343.23 4854.83,-1334.41 4855.18,-1326.27"/>
<polygon fill="black" stroke="black" points="4858.69,-1326.21 4855.77,-1316.03 4851.7,-1325.81 4858.69,-1326.21"/>
</g>
<!-- gate_14_13&#45;&gt;expert_14_13 -->
<g id="edge1294" class="edge">
<title>gate_14_13&#45;&gt;expert_14_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-1351.9C4868.31,-1343.23 4868.17,-1334.41 4867.82,-1326.27"/>
<polygon fill="red" stroke="red" points="4871.3,-1325.81 4867.23,-1316.03 4864.31,-1326.21 4871.3,-1325.81"/>
</g>
<!-- aggregate_14_13 -->
<g id="node982" class="node">
<title>aggregate_14_13</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-1227.98 4774.06,-1227.98 4713.49,-1123.98 4948.94,-1123.98 5009.51,-1227.98"/>
<text text-anchor="middle" x="4861.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L13</text>
<text text-anchor="middle" x="4861.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_13&#45;&gt;aggregate_14_13 -->
<g id="edge966" class="edge">
<title>expert_14_13&#45;&gt;aggregate_14_13</title>
<path fill="none" stroke="black" d="M4861.5,-1263.85C4861.5,-1256.16 4861.5,-1247.35 4861.5,-1238.35"/>
<polygon fill="black" stroke="black" points="4865,-1238.16 4861.5,-1228.16 4858,-1238.16 4865,-1238.16"/>
</g>
<!-- attention_14_14 -->
<g id="node983" class="node">
<title>attention_14_14</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-1087.98 4777.5,-1087.98 4777.5,-1035.98 4945.5,-1035.98 4945.5,-1087.98"/>
<text text-anchor="middle" x="4861.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_14_L14</text>
<text text-anchor="middle" x="4861.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_13&#45;&gt;attention_14_14 -->
<g id="edge967" class="edge">
<title>aggregate_14_13&#45;&gt;attention_14_14</title>
<path fill="none" stroke="black" d="M4861.5,-1123.9C4861.5,-1115.23 4861.5,-1106.41 4861.5,-1098.27"/>
<polygon fill="black" stroke="black" points="4865,-1098.03 4861.5,-1088.03 4858,-1098.03 4865,-1098.03"/>
</g>
<!-- gate_14_14 -->
<g id="node984" class="node">
<title>gate_14_14</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-999.98 4774.06,-999.98 4713.49,-895.98 4948.94,-895.98 5009.51,-999.98"/>
<text text-anchor="middle" x="4861.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_14_L14</text>
<text text-anchor="middle" x="4861.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_14&#45;&gt;gate_14_14 -->
<g id="edge968" class="edge">
<title>attention_14_14&#45;&gt;gate_14_14</title>
<path fill="none" stroke="black" d="M4861.5,-1035.85C4861.5,-1028.16 4861.5,-1019.35 4861.5,-1010.35"/>
<polygon fill="black" stroke="black" points="4865,-1010.16 4861.5,-1000.16 4858,-1010.16 4865,-1010.16"/>
</g>
<!-- expert_14_14 -->
<g id="node985" class="node">
<title>expert_14_14</title>
<polygon fill="lightgreen" stroke="black" points="4936,-859.98 4787,-859.98 4787,-807.98 4936,-807.98 4936,-859.98"/>
<text text-anchor="middle" x="4861.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_14_L14</text>
<text text-anchor="middle" x="4861.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_14&#45;&gt;expert_14_14 -->
<g id="edge969" class="edge">
<title>gate_14_14&#45;&gt;expert_14_14</title>
<path fill="none" stroke="black" d="M4854.77,-895.9C4854.69,-887.23 4854.83,-878.41 4855.18,-870.27"/>
<polygon fill="black" stroke="black" points="4858.69,-870.21 4855.77,-860.03 4851.7,-869.81 4858.69,-870.21"/>
</g>
<!-- gate_14_14&#45;&gt;expert_14_14 -->
<g id="edge1295" class="edge">
<title>gate_14_14&#45;&gt;expert_14_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-895.9C4868.31,-887.23 4868.17,-878.41 4867.82,-870.27"/>
<polygon fill="red" stroke="red" points="4871.3,-869.81 4867.23,-860.03 4864.31,-870.21 4871.3,-869.81"/>
</g>
<!-- aggregate_14_14 -->
<g id="node986" class="node">
<title>aggregate_14_14</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-771.98 4774.06,-771.98 4713.49,-667.98 4948.94,-667.98 5009.51,-771.98"/>
<text text-anchor="middle" x="4861.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L14</text>
<text text-anchor="middle" x="4861.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_14&#45;&gt;aggregate_14_14 -->
<g id="edge970" class="edge">
<title>expert_14_14&#45;&gt;aggregate_14_14</title>
<path fill="none" stroke="black" d="M4861.5,-807.85C4861.5,-800.16 4861.5,-791.35 4861.5,-782.35"/>
<polygon fill="black" stroke="black" points="4865,-782.16 4861.5,-772.16 4858,-782.16 4865,-782.16"/>
</g>
<!-- attention_14_15 -->
<g id="node987" class="node">
<title>attention_14_15</title>
<polygon fill="lightgreen" stroke="black" points="4945.5,-631.98 4777.5,-631.98 4777.5,-579.98 4945.5,-579.98 4945.5,-631.98"/>
<text text-anchor="middle" x="4861.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_14_L15</text>
<text text-anchor="middle" x="4861.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="4861.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="4861.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_14_14&#45;&gt;attention_14_15 -->
<g id="edge971" class="edge">
<title>aggregate_14_14&#45;&gt;attention_14_15</title>
<path fill="none" stroke="black" d="M4861.5,-667.9C4861.5,-659.23 4861.5,-650.41 4861.5,-642.27"/>
<polygon fill="black" stroke="black" points="4865,-642.03 4861.5,-632.03 4858,-642.03 4865,-642.03"/>
</g>
<!-- gate_14_15 -->
<g id="node988" class="node">
<title>gate_14_15</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-543.98 4774.06,-543.98 4713.49,-439.98 4948.94,-439.98 5009.51,-543.98"/>
<text text-anchor="middle" x="4861.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_14_L15</text>
<text text-anchor="middle" x="4861.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="4861.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_14_15&#45;&gt;gate_14_15 -->
<g id="edge972" class="edge">
<title>attention_14_15&#45;&gt;gate_14_15</title>
<path fill="none" stroke="black" d="M4861.5,-579.85C4861.5,-572.16 4861.5,-563.35 4861.5,-554.35"/>
<polygon fill="black" stroke="black" points="4865,-554.16 4861.5,-544.16 4858,-554.16 4865,-554.16"/>
</g>
<!-- expert_14_15 -->
<g id="node989" class="node">
<title>expert_14_15</title>
<polygon fill="lightgreen" stroke="black" points="4936,-403.98 4787,-403.98 4787,-351.98 4936,-351.98 4936,-403.98"/>
<text text-anchor="middle" x="4861.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_14_L15</text>
<text text-anchor="middle" x="4861.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=14</text>
<text text-anchor="middle" x="4861.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_14_15&#45;&gt;expert_14_15 -->
<g id="edge973" class="edge">
<title>gate_14_15&#45;&gt;expert_14_15</title>
<path fill="none" stroke="black" d="M4854.77,-439.9C4854.69,-431.23 4854.83,-422.41 4855.18,-414.27"/>
<polygon fill="black" stroke="black" points="4858.69,-414.21 4855.77,-404.03 4851.7,-413.81 4858.69,-414.21"/>
</g>
<!-- gate_14_15&#45;&gt;expert_14_15 -->
<g id="edge1296" class="edge">
<title>gate_14_15&#45;&gt;expert_14_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4868.23,-439.9C4868.31,-431.23 4868.17,-422.41 4867.82,-414.27"/>
<polygon fill="red" stroke="red" points="4871.3,-413.81 4867.23,-404.03 4864.31,-414.21 4871.3,-413.81"/>
</g>
<!-- aggregate_14_15 -->
<g id="node990" class="node">
<title>aggregate_14_15</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-315.98 4774.06,-315.98 4713.49,-211.98 4948.94,-211.98 5009.51,-315.98"/>
<text text-anchor="middle" x="4861.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_14_L15</text>
<text text-anchor="middle" x="4861.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="4861.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="4861.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_14_15&#45;&gt;aggregate_14_15 -->
<g id="edge974" class="edge">
<title>expert_14_15&#45;&gt;aggregate_14_15</title>
<path fill="none" stroke="black" d="M4861.5,-351.85C4861.5,-344.16 4861.5,-335.35 4861.5,-326.35"/>
<polygon fill="black" stroke="black" points="4865,-326.16 4861.5,-316.16 4858,-326.16 4865,-326.16"/>
</g>
<!-- collect_14 -->
<g id="node991" class="node">
<title>collect_14</title>
<polygon fill="lightyellow" stroke="black" points="5009.51,-175.98 4774.06,-175.98 4713.49,-93.98 4948.94,-93.98 5009.51,-175.98"/>
<text text-anchor="middle" x="4861.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_14</text>
<text text-anchor="middle" x="4861.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="4861.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_14_15&#45;&gt;collect_14 -->
<g id="edge975" class="edge">
<title>aggregate_14_15&#45;&gt;collect_14</title>
<path fill="none" stroke="black" d="M4861.5,-211.69C4861.5,-203.27 4861.5,-194.56 4861.5,-186.17"/>
<polygon fill="black" stroke="black" points="4865,-186.14 4861.5,-176.14 4858,-186.14 4865,-186.14"/>
</g>
<!-- collect_14&#45;&gt;output -->
<g id="edge1055" class="edge">
<title>collect_14&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4714.53,-95.68C4710.82,-95.07 4707.14,-94.5 4703.5,-93.98 4362.64,-45.63 3311.81,-33.56 2943.04,-30.77"/>
<polygon fill="black" stroke="black" points="2942.88,-27.27 2932.86,-30.69 2942.83,-34.27 2942.88,-27.27"/>
</g>
<!-- distribute_15 -->
<g id="node992" class="node">
<title>distribute_15</title>
<polygon fill="lightyellow" stroke="black" points="5374.73,-7589.98 5134.16,-7589.98 5072.27,-7507.98 5312.85,-7507.98 5374.73,-7589.98"/>
<text text-anchor="middle" x="5223.5" y="-7557.48" font-family="Arial" font-size="10.00">Distribute to GPU_15</text>
<text text-anchor="middle" x="5223.5" y="-7546.48" font-family="Arial" font-size="10.00">Input: [B=128, S=var, D=512]</text>
<text text-anchor="middle" x="5223.5" y="-7535.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_0 -->
<g id="node993" class="node">
<title>attention_15_0</title>
<polygon fill="lightgreen" stroke="black" points="5304.5,-7471.98 5136.5,-7471.98 5136.5,-7419.98 5304.5,-7419.98 5304.5,-7471.98"/>
<text text-anchor="middle" x="5220.5" y="-7459.98" font-family="Arial" font-size="10.00">Attention GPU_15_L0</text>
<text text-anchor="middle" x="5220.5" y="-7448.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5220.5" y="-7437.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5220.5" y="-7426.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- distribute_15&#45;&gt;attention_15_0 -->
<g id="edge976" class="edge">
<title>distribute_15&#45;&gt;attention_15_0</title>
<path fill="none" stroke="black" d="M5222.31,-7507.77C5222.06,-7499.34 5221.79,-7490.51 5221.55,-7482.27"/>
<polygon fill="black" stroke="black" points="5225.05,-7482.13 5221.25,-7472.23 5218.05,-7482.33 5225.05,-7482.13"/>
</g>
<!-- gate_15_0 -->
<g id="node994" class="node">
<title>gate_15_0</title>
<polygon fill="lightyellow" stroke="black" points="5365.51,-7383.98 5130.06,-7383.98 5069.49,-7279.98 5304.94,-7279.98 5365.51,-7383.98"/>
<text text-anchor="middle" x="5217.5" y="-7345.98" font-family="Arial" font-size="10.00">Gate GPU_15_L0</text>
<text text-anchor="middle" x="5217.5" y="-7334.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5217.5" y="-7323.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5217.5" y="-7312.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_0&#45;&gt;gate_15_0 -->
<g id="edge977" class="edge">
<title>attention_15_0&#45;&gt;gate_15_0</title>
<path fill="none" stroke="black" d="M5219.83,-7419.85C5219.62,-7412.16 5219.39,-7403.35 5219.14,-7394.35"/>
<polygon fill="black" stroke="black" points="5222.64,-7394.06 5218.87,-7384.16 5215.64,-7394.25 5222.64,-7394.06"/>
</g>
<!-- expert_15_0 -->
<g id="node995" class="node">
<title>expert_15_0</title>
<polygon fill="lightgreen" stroke="black" points="5291,-7243.98 5142,-7243.98 5142,-7191.98 5291,-7191.98 5291,-7243.98"/>
<text text-anchor="middle" x="5216.5" y="-7231.98" font-family="Arial" font-size="10.00">Expert GPU_15_L0</text>
<text text-anchor="middle" x="5216.5" y="-7220.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5216.5" y="-7209.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5216.5" y="-7198.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_0&#45;&gt;expert_15_0 -->
<g id="edge978" class="edge">
<title>gate_15_0&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" d="M5210.32,-7279.9C5210.16,-7271.23 5210.22,-7262.41 5210.49,-7254.27"/>
<polygon fill="black" stroke="black" points="5214,-7254.18 5210.99,-7244.03 5207.01,-7253.85 5214,-7254.18"/>
</g>
<!-- gate_15_0&#45;&gt;expert_15_0 -->
<g id="edge1297" class="edge">
<title>gate_15_0&#45;&gt;expert_15_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5223.77,-7279.9C5223.78,-7271.23 5223.56,-7262.41 5223.14,-7254.27"/>
<polygon fill="red" stroke="red" points="5226.61,-7253.77 5222.46,-7244.03 5219.63,-7254.24 5226.61,-7253.77"/>
</g>
<!-- aggregate_15_0 -->
<g id="node996" class="node">
<title>aggregate_15_0</title>
<polygon fill="lightyellow" stroke="black" points="5364.51,-7155.98 5129.06,-7155.98 5068.49,-7051.98 5303.94,-7051.98 5364.51,-7155.98"/>
<text text-anchor="middle" x="5216.5" y="-7117.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L0</text>
<text text-anchor="middle" x="5216.5" y="-7106.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5216.5" y="-7095.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5216.5" y="-7084.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_0&#45;&gt;aggregate_15_0 -->
<g id="edge979" class="edge">
<title>expert_15_0&#45;&gt;aggregate_15_0</title>
<path fill="none" stroke="black" d="M5216.5,-7191.85C5216.5,-7184.16 5216.5,-7175.35 5216.5,-7166.35"/>
<polygon fill="black" stroke="black" points="5220,-7166.16 5216.5,-7156.16 5213,-7166.16 5220,-7166.16"/>
</g>
<!-- attention_15_1 -->
<g id="node997" class="node">
<title>attention_15_1</title>
<polygon fill="lightgreen" stroke="black" points="5298.5,-7015.98 5130.5,-7015.98 5130.5,-6963.98 5298.5,-6963.98 5298.5,-7015.98"/>
<text text-anchor="middle" x="5214.5" y="-7003.98" font-family="Arial" font-size="10.00">Attention GPU_15_L1</text>
<text text-anchor="middle" x="5214.5" y="-6992.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5214.5" y="-6981.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5214.5" y="-6970.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_0&#45;&gt;attention_15_1 -->
<g id="edge980" class="edge">
<title>aggregate_15_0&#45;&gt;attention_15_1</title>
<path fill="none" stroke="black" d="M5215.59,-7051.9C5215.43,-7043.23 5215.28,-7034.41 5215.13,-7026.27"/>
<polygon fill="black" stroke="black" points="5218.63,-7025.96 5214.95,-7016.03 5211.63,-7026.09 5218.63,-7025.96"/>
</g>
<!-- gate_15_1 -->
<g id="node998" class="node">
<title>gate_15_1</title>
<polygon fill="lightyellow" stroke="black" points="5360.51,-6927.98 5125.06,-6927.98 5064.49,-6823.98 5299.94,-6823.98 5360.51,-6927.98"/>
<text text-anchor="middle" x="5212.5" y="-6889.98" font-family="Arial" font-size="10.00">Gate GPU_15_L1</text>
<text text-anchor="middle" x="5212.5" y="-6878.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5212.5" y="-6867.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5212.5" y="-6856.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_1&#45;&gt;gate_15_1 -->
<g id="edge981" class="edge">
<title>attention_15_1&#45;&gt;gate_15_1</title>
<path fill="none" stroke="black" d="M5214.05,-6963.85C5213.91,-6956.16 5213.76,-6947.35 5213.6,-6938.35"/>
<polygon fill="black" stroke="black" points="5217.09,-6938.1 5213.41,-6928.16 5210.09,-6938.22 5217.09,-6938.1"/>
</g>
<!-- expert_15_1 -->
<g id="node999" class="node">
<title>expert_15_1</title>
<polygon fill="lightgreen" stroke="black" points="5284,-6787.98 5135,-6787.98 5135,-6735.98 5284,-6735.98 5284,-6787.98"/>
<text text-anchor="middle" x="5209.5" y="-6775.98" font-family="Arial" font-size="10.00">Expert GPU_15_L1</text>
<text text-anchor="middle" x="5209.5" y="-6764.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5209.5" y="-6753.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5209.5" y="-6742.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_1&#45;&gt;expert_15_1 -->
<g id="edge982" class="edge">
<title>gate_15_1&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" d="M5204.41,-6823.9C5204.09,-6815.23 5203.99,-6806.41 5204.12,-6798.27"/>
<polygon fill="black" stroke="black" points="5207.63,-6798.13 5204.44,-6788.03 5200.63,-6797.91 5207.63,-6798.13"/>
</g>
<!-- gate_15_1&#45;&gt;expert_15_1 -->
<g id="edge1298" class="edge">
<title>gate_15_1&#45;&gt;expert_15_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5217.86,-6823.9C5217.71,-6815.14 5217.33,-6806.21 5216.75,-6797.99"/>
<polygon fill="red" stroke="red" points="5220.24,-6797.7 5215.91,-6788.03 5213.26,-6798.29 5220.24,-6797.7"/>
</g>
<!-- aggregate_15_1 -->
<g id="node1000" class="node">
<title>aggregate_15_1</title>
<polygon fill="lightyellow" stroke="black" points="5355.51,-6699.98 5120.06,-6699.98 5059.49,-6595.98 5294.94,-6595.98 5355.51,-6699.98"/>
<text text-anchor="middle" x="5207.5" y="-6661.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L1</text>
<text text-anchor="middle" x="5207.5" y="-6650.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5207.5" y="-6639.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5207.5" y="-6628.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_1&#45;&gt;aggregate_15_1 -->
<g id="edge983" class="edge">
<title>expert_15_1&#45;&gt;aggregate_15_1</title>
<path fill="none" stroke="black" d="M5209.05,-6735.85C5208.91,-6728.16 5208.76,-6719.35 5208.6,-6710.35"/>
<polygon fill="black" stroke="black" points="5212.09,-6710.1 5208.41,-6700.16 5205.09,-6710.22 5212.09,-6710.1"/>
</g>
<!-- attention_15_2 -->
<g id="node1001" class="node">
<title>attention_15_2</title>
<polygon fill="lightgreen" stroke="black" points="5290.5,-6559.98 5122.5,-6559.98 5122.5,-6507.98 5290.5,-6507.98 5290.5,-6559.98"/>
<text text-anchor="middle" x="5206.5" y="-6547.98" font-family="Arial" font-size="10.00">Attention GPU_15_L2</text>
<text text-anchor="middle" x="5206.5" y="-6536.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5206.5" y="-6525.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5206.5" y="-6514.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_1&#45;&gt;attention_15_2 -->
<g id="edge984" class="edge">
<title>aggregate_15_1&#45;&gt;attention_15_2</title>
<path fill="none" stroke="black" d="M5207.04,-6595.9C5206.97,-6587.23 5206.89,-6578.41 5206.82,-6570.27"/>
<polygon fill="black" stroke="black" points="5210.31,-6569.99 5206.72,-6560.03 5203.31,-6570.06 5210.31,-6569.99"/>
</g>
<!-- gate_15_2 -->
<g id="node1002" class="node">
<title>gate_15_2</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-6471.98 5119.06,-6471.98 5058.49,-6367.98 5293.94,-6367.98 5354.51,-6471.98"/>
<text text-anchor="middle" x="5206.5" y="-6433.98" font-family="Arial" font-size="10.00">Gate GPU_15_L2</text>
<text text-anchor="middle" x="5206.5" y="-6422.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5206.5" y="-6411.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-6400.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_2&#45;&gt;gate_15_2 -->
<g id="edge985" class="edge">
<title>attention_15_2&#45;&gt;gate_15_2</title>
<path fill="none" stroke="black" d="M5206.5,-6507.85C5206.5,-6500.16 5206.5,-6491.35 5206.5,-6482.35"/>
<polygon fill="black" stroke="black" points="5210,-6482.16 5206.5,-6472.16 5203,-6482.16 5210,-6482.16"/>
</g>
<!-- expert_15_2 -->
<g id="node1003" class="node">
<title>expert_15_2</title>
<polygon fill="lightgreen" stroke="black" points="5281,-6331.98 5132,-6331.98 5132,-6279.98 5281,-6279.98 5281,-6331.98"/>
<text text-anchor="middle" x="5206.5" y="-6319.98" font-family="Arial" font-size="10.00">Expert GPU_15_L2</text>
<text text-anchor="middle" x="5206.5" y="-6308.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5206.5" y="-6297.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-6286.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_2&#45;&gt;expert_15_2 -->
<g id="edge986" class="edge">
<title>gate_15_2&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" d="M5199.77,-6367.9C5199.69,-6359.23 5199.83,-6350.41 5200.18,-6342.27"/>
<polygon fill="black" stroke="black" points="5203.69,-6342.21 5200.77,-6332.03 5196.7,-6341.81 5203.69,-6342.21"/>
</g>
<!-- gate_15_2&#45;&gt;expert_15_2 -->
<g id="edge1299" class="edge">
<title>gate_15_2&#45;&gt;expert_15_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5213.23,-6367.9C5213.31,-6359.23 5213.17,-6350.41 5212.82,-6342.27"/>
<polygon fill="red" stroke="red" points="5216.3,-6341.81 5212.23,-6332.03 5209.31,-6342.21 5216.3,-6341.81"/>
</g>
<!-- aggregate_15_2 -->
<g id="node1004" class="node">
<title>aggregate_15_2</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-6243.98 5119.06,-6243.98 5058.49,-6139.98 5293.94,-6139.98 5354.51,-6243.98"/>
<text text-anchor="middle" x="5206.5" y="-6205.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L2</text>
<text text-anchor="middle" x="5206.5" y="-6194.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5206.5" y="-6183.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5206.5" y="-6172.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_2&#45;&gt;aggregate_15_2 -->
<g id="edge987" class="edge">
<title>expert_15_2&#45;&gt;aggregate_15_2</title>
<path fill="none" stroke="black" d="M5206.5,-6279.85C5206.5,-6272.16 5206.5,-6263.35 5206.5,-6254.35"/>
<polygon fill="black" stroke="black" points="5210,-6254.16 5206.5,-6244.16 5203,-6254.16 5210,-6254.16"/>
</g>
<!-- attention_15_3 -->
<g id="node1005" class="node">
<title>attention_15_3</title>
<polygon fill="lightgreen" stroke="black" points="5290.5,-6103.98 5122.5,-6103.98 5122.5,-6051.98 5290.5,-6051.98 5290.5,-6103.98"/>
<text text-anchor="middle" x="5206.5" y="-6091.98" font-family="Arial" font-size="10.00">Attention GPU_15_L3</text>
<text text-anchor="middle" x="5206.5" y="-6080.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5206.5" y="-6069.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5206.5" y="-6058.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_2&#45;&gt;attention_15_3 -->
<g id="edge988" class="edge">
<title>aggregate_15_2&#45;&gt;attention_15_3</title>
<path fill="none" stroke="black" d="M5206.5,-6139.9C5206.5,-6131.23 5206.5,-6122.41 5206.5,-6114.27"/>
<polygon fill="black" stroke="black" points="5210,-6114.03 5206.5,-6104.03 5203,-6114.03 5210,-6114.03"/>
</g>
<!-- gate_15_3 -->
<g id="node1006" class="node">
<title>gate_15_3</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-6015.98 5119.06,-6015.98 5058.49,-5911.98 5293.94,-5911.98 5354.51,-6015.98"/>
<text text-anchor="middle" x="5206.5" y="-5977.98" font-family="Arial" font-size="10.00">Gate GPU_15_L3</text>
<text text-anchor="middle" x="5206.5" y="-5966.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5206.5" y="-5955.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-5944.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_3&#45;&gt;gate_15_3 -->
<g id="edge989" class="edge">
<title>attention_15_3&#45;&gt;gate_15_3</title>
<path fill="none" stroke="black" d="M5206.5,-6051.85C5206.5,-6044.16 5206.5,-6035.35 5206.5,-6026.35"/>
<polygon fill="black" stroke="black" points="5210,-6026.16 5206.5,-6016.16 5203,-6026.16 5210,-6026.16"/>
</g>
<!-- expert_15_3 -->
<g id="node1007" class="node">
<title>expert_15_3</title>
<polygon fill="lightgreen" stroke="black" points="5281,-5875.98 5132,-5875.98 5132,-5823.98 5281,-5823.98 5281,-5875.98"/>
<text text-anchor="middle" x="5206.5" y="-5863.98" font-family="Arial" font-size="10.00">Expert GPU_15_L3</text>
<text text-anchor="middle" x="5206.5" y="-5852.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5206.5" y="-5841.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-5830.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_3&#45;&gt;expert_15_3 -->
<g id="edge990" class="edge">
<title>gate_15_3&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" d="M5199.77,-5911.9C5199.69,-5903.23 5199.83,-5894.41 5200.18,-5886.27"/>
<polygon fill="black" stroke="black" points="5203.69,-5886.21 5200.77,-5876.03 5196.7,-5885.81 5203.69,-5886.21"/>
</g>
<!-- gate_15_3&#45;&gt;expert_15_3 -->
<g id="edge1300" class="edge">
<title>gate_15_3&#45;&gt;expert_15_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5213.23,-5911.9C5213.31,-5903.23 5213.17,-5894.41 5212.82,-5886.27"/>
<polygon fill="red" stroke="red" points="5216.3,-5885.81 5212.23,-5876.03 5209.31,-5886.21 5216.3,-5885.81"/>
</g>
<!-- aggregate_15_3 -->
<g id="node1008" class="node">
<title>aggregate_15_3</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-5787.98 5119.06,-5787.98 5058.49,-5683.98 5293.94,-5683.98 5354.51,-5787.98"/>
<text text-anchor="middle" x="5206.5" y="-5749.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L3</text>
<text text-anchor="middle" x="5206.5" y="-5738.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5206.5" y="-5727.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5206.5" y="-5716.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_3&#45;&gt;aggregate_15_3 -->
<g id="edge991" class="edge">
<title>expert_15_3&#45;&gt;aggregate_15_3</title>
<path fill="none" stroke="black" d="M5206.5,-5823.85C5206.5,-5816.16 5206.5,-5807.35 5206.5,-5798.35"/>
<polygon fill="black" stroke="black" points="5210,-5798.16 5206.5,-5788.16 5203,-5798.16 5210,-5798.16"/>
</g>
<!-- attention_15_4 -->
<g id="node1009" class="node">
<title>attention_15_4</title>
<polygon fill="lightgreen" stroke="black" points="5290.5,-5647.98 5122.5,-5647.98 5122.5,-5595.98 5290.5,-5595.98 5290.5,-5647.98"/>
<text text-anchor="middle" x="5206.5" y="-5635.98" font-family="Arial" font-size="10.00">Attention GPU_15_L4</text>
<text text-anchor="middle" x="5206.5" y="-5624.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5206.5" y="-5613.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5206.5" y="-5602.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_3&#45;&gt;attention_15_4 -->
<g id="edge992" class="edge">
<title>aggregate_15_3&#45;&gt;attention_15_4</title>
<path fill="none" stroke="black" d="M5206.5,-5683.9C5206.5,-5675.23 5206.5,-5666.41 5206.5,-5658.27"/>
<polygon fill="black" stroke="black" points="5210,-5658.03 5206.5,-5648.03 5203,-5658.03 5210,-5658.03"/>
</g>
<!-- gate_15_4 -->
<g id="node1010" class="node">
<title>gate_15_4</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-5559.98 5119.06,-5559.98 5058.49,-5455.98 5293.94,-5455.98 5354.51,-5559.98"/>
<text text-anchor="middle" x="5206.5" y="-5521.98" font-family="Arial" font-size="10.00">Gate GPU_15_L4</text>
<text text-anchor="middle" x="5206.5" y="-5510.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5206.5" y="-5499.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-5488.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_4&#45;&gt;gate_15_4 -->
<g id="edge993" class="edge">
<title>attention_15_4&#45;&gt;gate_15_4</title>
<path fill="none" stroke="black" d="M5206.5,-5595.85C5206.5,-5588.16 5206.5,-5579.35 5206.5,-5570.35"/>
<polygon fill="black" stroke="black" points="5210,-5570.16 5206.5,-5560.16 5203,-5570.16 5210,-5570.16"/>
</g>
<!-- expert_15_4 -->
<g id="node1011" class="node">
<title>expert_15_4</title>
<polygon fill="lightgreen" stroke="black" points="5281,-5419.98 5132,-5419.98 5132,-5367.98 5281,-5367.98 5281,-5419.98"/>
<text text-anchor="middle" x="5206.5" y="-5407.98" font-family="Arial" font-size="10.00">Expert GPU_15_L4</text>
<text text-anchor="middle" x="5206.5" y="-5396.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5206.5" y="-5385.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-5374.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_4&#45;&gt;expert_15_4 -->
<g id="edge994" class="edge">
<title>gate_15_4&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" d="M5199.77,-5455.9C5199.69,-5447.23 5199.83,-5438.41 5200.18,-5430.27"/>
<polygon fill="black" stroke="black" points="5203.69,-5430.21 5200.77,-5420.03 5196.7,-5429.81 5203.69,-5430.21"/>
</g>
<!-- gate_15_4&#45;&gt;expert_15_4 -->
<g id="edge1301" class="edge">
<title>gate_15_4&#45;&gt;expert_15_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5213.23,-5455.9C5213.31,-5447.23 5213.17,-5438.41 5212.82,-5430.27"/>
<polygon fill="red" stroke="red" points="5216.3,-5429.81 5212.23,-5420.03 5209.31,-5430.21 5216.3,-5429.81"/>
</g>
<!-- aggregate_15_4 -->
<g id="node1012" class="node">
<title>aggregate_15_4</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-5331.98 5119.06,-5331.98 5058.49,-5227.98 5293.94,-5227.98 5354.51,-5331.98"/>
<text text-anchor="middle" x="5206.5" y="-5293.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L4</text>
<text text-anchor="middle" x="5206.5" y="-5282.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5206.5" y="-5271.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5206.5" y="-5260.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_4&#45;&gt;aggregate_15_4 -->
<g id="edge995" class="edge">
<title>expert_15_4&#45;&gt;aggregate_15_4</title>
<path fill="none" stroke="black" d="M5206.5,-5367.85C5206.5,-5360.16 5206.5,-5351.35 5206.5,-5342.35"/>
<polygon fill="black" stroke="black" points="5210,-5342.16 5206.5,-5332.16 5203,-5342.16 5210,-5342.16"/>
</g>
<!-- attention_15_5 -->
<g id="node1013" class="node">
<title>attention_15_5</title>
<polygon fill="lightgreen" stroke="black" points="5290.5,-5191.98 5122.5,-5191.98 5122.5,-5139.98 5290.5,-5139.98 5290.5,-5191.98"/>
<text text-anchor="middle" x="5206.5" y="-5179.98" font-family="Arial" font-size="10.00">Attention GPU_15_L5</text>
<text text-anchor="middle" x="5206.5" y="-5168.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5206.5" y="-5157.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5206.5" y="-5146.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_4&#45;&gt;attention_15_5 -->
<g id="edge996" class="edge">
<title>aggregate_15_4&#45;&gt;attention_15_5</title>
<path fill="none" stroke="black" d="M5206.5,-5227.9C5206.5,-5219.23 5206.5,-5210.41 5206.5,-5202.27"/>
<polygon fill="black" stroke="black" points="5210,-5202.03 5206.5,-5192.03 5203,-5202.03 5210,-5202.03"/>
</g>
<!-- gate_15_5 -->
<g id="node1014" class="node">
<title>gate_15_5</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-5103.98 5119.06,-5103.98 5058.49,-4999.98 5293.94,-4999.98 5354.51,-5103.98"/>
<text text-anchor="middle" x="5206.5" y="-5065.98" font-family="Arial" font-size="10.00">Gate GPU_15_L5</text>
<text text-anchor="middle" x="5206.5" y="-5054.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5206.5" y="-5043.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-5032.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_5&#45;&gt;gate_15_5 -->
<g id="edge997" class="edge">
<title>attention_15_5&#45;&gt;gate_15_5</title>
<path fill="none" stroke="black" d="M5206.5,-5139.85C5206.5,-5132.16 5206.5,-5123.35 5206.5,-5114.35"/>
<polygon fill="black" stroke="black" points="5210,-5114.16 5206.5,-5104.16 5203,-5114.16 5210,-5114.16"/>
</g>
<!-- expert_15_5 -->
<g id="node1015" class="node">
<title>expert_15_5</title>
<polygon fill="lightgreen" stroke="black" points="5281,-4963.98 5132,-4963.98 5132,-4911.98 5281,-4911.98 5281,-4963.98"/>
<text text-anchor="middle" x="5206.5" y="-4951.98" font-family="Arial" font-size="10.00">Expert GPU_15_L5</text>
<text text-anchor="middle" x="5206.5" y="-4940.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5206.5" y="-4929.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5206.5" y="-4918.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_5&#45;&gt;expert_15_5 -->
<g id="edge998" class="edge">
<title>gate_15_5&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" d="M5199.77,-4999.9C5199.69,-4991.23 5199.83,-4982.41 5200.18,-4974.27"/>
<polygon fill="black" stroke="black" points="5203.69,-4974.21 5200.77,-4964.03 5196.7,-4973.81 5203.69,-4974.21"/>
</g>
<!-- gate_15_5&#45;&gt;expert_15_5 -->
<g id="edge1302" class="edge">
<title>gate_15_5&#45;&gt;expert_15_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5213.23,-4999.9C5213.31,-4991.23 5213.17,-4982.41 5212.82,-4974.27"/>
<polygon fill="red" stroke="red" points="5216.3,-4973.81 5212.23,-4964.03 5209.31,-4974.21 5216.3,-4973.81"/>
</g>
<!-- aggregate_15_5 -->
<g id="node1016" class="node">
<title>aggregate_15_5</title>
<polygon fill="lightyellow" stroke="black" points="5354.51,-4875.98 5119.06,-4875.98 5058.49,-4771.98 5293.94,-4771.98 5354.51,-4875.98"/>
<text text-anchor="middle" x="5206.5" y="-4837.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L5</text>
<text text-anchor="middle" x="5206.5" y="-4826.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5206.5" y="-4815.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5206.5" y="-4804.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_5&#45;&gt;aggregate_15_5 -->
<g id="edge999" class="edge">
<title>expert_15_5&#45;&gt;aggregate_15_5</title>
<path fill="none" stroke="black" d="M5206.5,-4911.85C5206.5,-4904.16 5206.5,-4895.35 5206.5,-4886.35"/>
<polygon fill="black" stroke="black" points="5210,-4886.16 5206.5,-4876.16 5203,-4886.16 5210,-4886.16"/>
</g>
<!-- attention_15_6 -->
<g id="node1017" class="node">
<title>attention_15_6</title>
<polygon fill="lightgreen" stroke="black" points="5288.5,-4735.98 5120.5,-4735.98 5120.5,-4683.98 5288.5,-4683.98 5288.5,-4735.98"/>
<text text-anchor="middle" x="5204.5" y="-4723.98" font-family="Arial" font-size="10.00">Attention GPU_15_L6</text>
<text text-anchor="middle" x="5204.5" y="-4712.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5204.5" y="-4701.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5204.5" y="-4690.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_5&#45;&gt;attention_15_6 -->
<g id="edge1000" class="edge">
<title>aggregate_15_5&#45;&gt;attention_15_6</title>
<path fill="none" stroke="black" d="M5205.59,-4771.9C5205.43,-4763.23 5205.28,-4754.41 5205.13,-4746.27"/>
<polygon fill="black" stroke="black" points="5208.63,-4745.96 5204.95,-4736.03 5201.63,-4746.09 5208.63,-4745.96"/>
</g>
<!-- gate_15_6 -->
<g id="node1018" class="node">
<title>gate_15_6</title>
<polygon fill="lightyellow" stroke="black" points="5350.51,-4647.98 5115.06,-4647.98 5054.49,-4543.98 5289.94,-4543.98 5350.51,-4647.98"/>
<text text-anchor="middle" x="5202.5" y="-4609.98" font-family="Arial" font-size="10.00">Gate GPU_15_L6</text>
<text text-anchor="middle" x="5202.5" y="-4598.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5202.5" y="-4587.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5202.5" y="-4576.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_6&#45;&gt;gate_15_6 -->
<g id="edge1001" class="edge">
<title>attention_15_6&#45;&gt;gate_15_6</title>
<path fill="none" stroke="black" d="M5204.05,-4683.85C5203.91,-4676.16 5203.76,-4667.35 5203.6,-4658.35"/>
<polygon fill="black" stroke="black" points="5207.09,-4658.1 5203.41,-4648.16 5200.09,-4658.22 5207.09,-4658.1"/>
</g>
<!-- expert_15_6 -->
<g id="node1019" class="node">
<title>expert_15_6</title>
<polygon fill="lightgreen" stroke="black" points="5275,-4507.98 5126,-4507.98 5126,-4455.98 5275,-4455.98 5275,-4507.98"/>
<text text-anchor="middle" x="5200.5" y="-4495.98" font-family="Arial" font-size="10.00">Expert GPU_15_L6</text>
<text text-anchor="middle" x="5200.5" y="-4484.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5200.5" y="-4473.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5200.5" y="-4462.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_6&#45;&gt;expert_15_6 -->
<g id="edge1002" class="edge">
<title>gate_15_6&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" d="M5194.86,-4543.9C5194.63,-4535.23 5194.6,-4526.41 5194.81,-4518.27"/>
<polygon fill="black" stroke="black" points="5198.32,-4518.16 5195.21,-4508.03 5191.32,-4517.88 5198.32,-4518.16"/>
</g>
<!-- gate_15_6&#45;&gt;expert_15_6 -->
<g id="edge1303" class="edge">
<title>gate_15_6&#45;&gt;expert_15_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5208.32,-4543.9C5208.24,-4535.23 5207.95,-4526.41 5207.45,-4518.27"/>
<polygon fill="red" stroke="red" points="5210.92,-4517.74 5206.68,-4508.03 5203.94,-4518.26 5210.92,-4517.74"/>
</g>
<!-- aggregate_15_6 -->
<g id="node1020" class="node">
<title>aggregate_15_6</title>
<polygon fill="lightyellow" stroke="black" points="5346.51,-4419.98 5111.06,-4419.98 5050.49,-4315.98 5285.94,-4315.98 5346.51,-4419.98"/>
<text text-anchor="middle" x="5198.5" y="-4381.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L6</text>
<text text-anchor="middle" x="5198.5" y="-4370.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5198.5" y="-4359.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5198.5" y="-4348.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_6&#45;&gt;aggregate_15_6 -->
<g id="edge1003" class="edge">
<title>expert_15_6&#45;&gt;aggregate_15_6</title>
<path fill="none" stroke="black" d="M5200.05,-4455.85C5199.91,-4448.16 5199.76,-4439.35 5199.6,-4430.35"/>
<polygon fill="black" stroke="black" points="5203.09,-4430.1 5199.41,-4420.16 5196.09,-4430.22 5203.09,-4430.1"/>
</g>
<!-- attention_15_7 -->
<g id="node1021" class="node">
<title>attention_15_7</title>
<polygon fill="lightgreen" stroke="black" points="5278.5,-4279.98 5110.5,-4279.98 5110.5,-4227.98 5278.5,-4227.98 5278.5,-4279.98"/>
<text text-anchor="middle" x="5194.5" y="-4267.98" font-family="Arial" font-size="10.00">Attention GPU_15_L7</text>
<text text-anchor="middle" x="5194.5" y="-4256.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5194.5" y="-4245.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5194.5" y="-4234.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_6&#45;&gt;attention_15_7 -->
<g id="edge1004" class="edge">
<title>aggregate_15_6&#45;&gt;attention_15_7</title>
<path fill="none" stroke="black" d="M5196.68,-4315.9C5196.37,-4307.23 5196.05,-4298.41 5195.76,-4290.27"/>
<polygon fill="black" stroke="black" points="5199.25,-4289.89 5195.4,-4280.03 5192.25,-4290.14 5199.25,-4289.89"/>
</g>
<!-- gate_15_7 -->
<g id="node1022" class="node">
<title>gate_15_7</title>
<polygon fill="lightyellow" stroke="black" points="5339.51,-4191.98 5104.06,-4191.98 5043.49,-4087.98 5278.94,-4087.98 5339.51,-4191.98"/>
<text text-anchor="middle" x="5191.5" y="-4153.98" font-family="Arial" font-size="10.00">Gate GPU_15_L7</text>
<text text-anchor="middle" x="5191.5" y="-4142.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5191.5" y="-4131.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5191.5" y="-4120.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_7&#45;&gt;gate_15_7 -->
<g id="edge1005" class="edge">
<title>attention_15_7&#45;&gt;gate_15_7</title>
<path fill="none" stroke="black" d="M5193.83,-4227.85C5193.62,-4220.16 5193.39,-4211.35 5193.14,-4202.35"/>
<polygon fill="black" stroke="black" points="5196.64,-4202.06 5192.87,-4192.16 5189.64,-4202.25 5196.64,-4202.06"/>
</g>
<!-- expert_15_7 -->
<g id="node1023" class="node">
<title>expert_15_7</title>
<polygon fill="lightgreen" stroke="black" points="5264,-4051.98 5115,-4051.98 5115,-3999.98 5264,-3999.98 5264,-4051.98"/>
<text text-anchor="middle" x="5189.5" y="-4039.98" font-family="Arial" font-size="10.00">Expert GPU_15_L7</text>
<text text-anchor="middle" x="5189.5" y="-4028.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5189.5" y="-4017.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5189.5" y="-4006.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_7&#45;&gt;expert_15_7 -->
<g id="edge1006" class="edge">
<title>gate_15_7&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" d="M5183.86,-4087.9C5183.63,-4079.23 5183.6,-4070.41 5183.81,-4062.27"/>
<polygon fill="black" stroke="black" points="5187.32,-4062.16 5184.21,-4052.03 5180.32,-4061.88 5187.32,-4062.16"/>
</g>
<!-- gate_15_7&#45;&gt;expert_15_7 -->
<g id="edge1304" class="edge">
<title>gate_15_7&#45;&gt;expert_15_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5197.32,-4087.9C5197.24,-4079.23 5196.95,-4070.41 5196.45,-4062.27"/>
<polygon fill="red" stroke="red" points="5199.92,-4061.74 5195.68,-4052.03 5192.94,-4062.26 5199.92,-4061.74"/>
</g>
<!-- aggregate_15_7 -->
<g id="node1024" class="node">
<title>aggregate_15_7</title>
<polygon fill="lightyellow" stroke="black" points="5336.51,-3963.98 5101.06,-3963.98 5040.49,-3859.98 5275.94,-3859.98 5336.51,-3963.98"/>
<text text-anchor="middle" x="5188.5" y="-3925.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L7</text>
<text text-anchor="middle" x="5188.5" y="-3914.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5188.5" y="-3903.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5188.5" y="-3892.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_7&#45;&gt;aggregate_15_7 -->
<g id="edge1007" class="edge">
<title>expert_15_7&#45;&gt;aggregate_15_7</title>
<path fill="none" stroke="black" d="M5189.28,-3999.85C5189.21,-3992.16 5189.13,-3983.35 5189.05,-3974.35"/>
<polygon fill="black" stroke="black" points="5192.55,-3974.13 5188.96,-3964.16 5185.55,-3974.19 5192.55,-3974.13"/>
</g>
<!-- attention_15_8 -->
<g id="node1025" class="node">
<title>attention_15_8</title>
<polygon fill="lightgreen" stroke="black" points="5271.5,-3823.98 5103.5,-3823.98 5103.5,-3771.98 5271.5,-3771.98 5271.5,-3823.98"/>
<text text-anchor="middle" x="5187.5" y="-3811.98" font-family="Arial" font-size="10.00">Attention GPU_15_L8</text>
<text text-anchor="middle" x="5187.5" y="-3800.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5187.5" y="-3789.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5187.5" y="-3778.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_7&#45;&gt;attention_15_8 -->
<g id="edge1008" class="edge">
<title>aggregate_15_7&#45;&gt;attention_15_8</title>
<path fill="none" stroke="black" d="M5188.04,-3859.9C5187.97,-3851.23 5187.89,-3842.41 5187.82,-3834.27"/>
<polygon fill="black" stroke="black" points="5191.31,-3833.99 5187.72,-3824.03 5184.31,-3834.06 5191.31,-3833.99"/>
</g>
<!-- gate_15_8 -->
<g id="node1026" class="node">
<title>gate_15_8</title>
<polygon fill="lightyellow" stroke="black" points="5335.51,-3735.98 5100.06,-3735.98 5039.49,-3631.98 5274.94,-3631.98 5335.51,-3735.98"/>
<text text-anchor="middle" x="5187.5" y="-3697.98" font-family="Arial" font-size="10.00">Gate GPU_15_L8</text>
<text text-anchor="middle" x="5187.5" y="-3686.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5187.5" y="-3675.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5187.5" y="-3664.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_8&#45;&gt;gate_15_8 -->
<g id="edge1009" class="edge">
<title>attention_15_8&#45;&gt;gate_15_8</title>
<path fill="none" stroke="black" d="M5187.5,-3771.85C5187.5,-3764.16 5187.5,-3755.35 5187.5,-3746.35"/>
<polygon fill="black" stroke="black" points="5191,-3746.16 5187.5,-3736.16 5184,-3746.16 5191,-3746.16"/>
</g>
<!-- expert_15_8 -->
<g id="node1027" class="node">
<title>expert_15_8</title>
<polygon fill="lightgreen" stroke="black" points="5256,-3595.98 5107,-3595.98 5107,-3543.98 5256,-3543.98 5256,-3595.98"/>
<text text-anchor="middle" x="5181.5" y="-3583.98" font-family="Arial" font-size="10.00">Expert GPU_15_L8</text>
<text text-anchor="middle" x="5181.5" y="-3572.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5181.5" y="-3561.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5181.5" y="-3550.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_8&#45;&gt;expert_15_8 -->
<g id="edge1010" class="edge">
<title>gate_15_8&#45;&gt;expert_15_8</title>
<path fill="none" stroke="black" d="M5178.04,-3631.9C5177.49,-3623.23 5177.15,-3614.41 5177.07,-3606.27"/>
<polygon fill="black" stroke="black" points="5180.57,-3606.04 5177.11,-3596.03 5173.57,-3606.01 5180.57,-3606.04"/>
</g>
<!-- gate_15_8&#45;&gt;expert_15_8 -->
<g id="edge1305" class="edge">
<title>gate_15_8&#45;&gt;expert_15_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5191.49,-3631.9C5191.1,-3623.14 5190.49,-3614.21 5189.69,-3605.99"/>
<polygon fill="red" stroke="red" points="5193.16,-3605.58 5188.58,-3596.03 5186.2,-3606.35 5193.16,-3605.58"/>
</g>
<!-- aggregate_15_8 -->
<g id="node1028" class="node">
<title>aggregate_15_8</title>
<polygon fill="lightyellow" stroke="black" points="5329.51,-3507.98 5094.06,-3507.98 5033.49,-3403.98 5268.94,-3403.98 5329.51,-3507.98"/>
<text text-anchor="middle" x="5181.5" y="-3469.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L8</text>
<text text-anchor="middle" x="5181.5" y="-3458.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5181.5" y="-3447.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5181.5" y="-3436.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_8&#45;&gt;aggregate_15_8 -->
<g id="edge1011" class="edge">
<title>expert_15_8&#45;&gt;aggregate_15_8</title>
<path fill="none" stroke="black" d="M5181.5,-3543.85C5181.5,-3536.16 5181.5,-3527.35 5181.5,-3518.35"/>
<polygon fill="black" stroke="black" points="5185,-3518.16 5181.5,-3508.16 5178,-3518.16 5185,-3518.16"/>
</g>
<!-- attention_15_9 -->
<g id="node1029" class="node">
<title>attention_15_9</title>
<polygon fill="lightgreen" stroke="black" points="5262.5,-3367.98 5094.5,-3367.98 5094.5,-3315.98 5262.5,-3315.98 5262.5,-3367.98"/>
<text text-anchor="middle" x="5178.5" y="-3355.98" font-family="Arial" font-size="10.00">Attention GPU_15_L9</text>
<text text-anchor="middle" x="5178.5" y="-3344.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5178.5" y="-3333.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5178.5" y="-3322.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_8&#45;&gt;attention_15_9 -->
<g id="edge1012" class="edge">
<title>aggregate_15_8&#45;&gt;attention_15_9</title>
<path fill="none" stroke="black" d="M5180.13,-3403.9C5179.9,-3395.23 5179.66,-3386.41 5179.45,-3378.27"/>
<polygon fill="black" stroke="black" points="5182.94,-3377.93 5179.17,-3368.03 5175.94,-3378.12 5182.94,-3377.93"/>
</g>
<!-- gate_15_9 -->
<g id="node1030" class="node">
<title>gate_15_9</title>
<polygon fill="lightyellow" stroke="black" points="5326.51,-3279.98 5091.06,-3279.98 5030.49,-3175.98 5265.94,-3175.98 5326.51,-3279.98"/>
<text text-anchor="middle" x="5178.5" y="-3241.98" font-family="Arial" font-size="10.00">Gate GPU_15_L9</text>
<text text-anchor="middle" x="5178.5" y="-3230.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5178.5" y="-3219.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5178.5" y="-3208.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_9&#45;&gt;gate_15_9 -->
<g id="edge1013" class="edge">
<title>attention_15_9&#45;&gt;gate_15_9</title>
<path fill="none" stroke="black" d="M5178.5,-3315.85C5178.5,-3308.16 5178.5,-3299.35 5178.5,-3290.35"/>
<polygon fill="black" stroke="black" points="5182,-3290.16 5178.5,-3280.16 5175,-3290.16 5182,-3290.16"/>
</g>
<!-- expert_15_9 -->
<g id="node1031" class="node">
<title>expert_15_9</title>
<polygon fill="lightgreen" stroke="black" points="5252,-3139.98 5103,-3139.98 5103,-3087.98 5252,-3087.98 5252,-3139.98"/>
<text text-anchor="middle" x="5177.5" y="-3127.98" font-family="Arial" font-size="10.00">Expert GPU_15_L9</text>
<text text-anchor="middle" x="5177.5" y="-3116.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5177.5" y="-3105.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5177.5" y="-3094.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_9&#45;&gt;expert_15_9 -->
<g id="edge1014" class="edge">
<title>gate_15_9&#45;&gt;expert_15_9</title>
<path fill="none" stroke="black" d="M5171.32,-3175.9C5171.16,-3167.23 5171.22,-3158.41 5171.49,-3150.27"/>
<polygon fill="black" stroke="black" points="5175,-3150.18 5171.99,-3140.03 5168.01,-3149.85 5175,-3150.18"/>
</g>
<!-- gate_15_9&#45;&gt;expert_15_9 -->
<g id="edge1306" class="edge">
<title>gate_15_9&#45;&gt;expert_15_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5184.77,-3175.9C5184.78,-3167.23 5184.56,-3158.41 5184.14,-3150.27"/>
<polygon fill="red" stroke="red" points="5187.61,-3149.77 5183.46,-3140.03 5180.63,-3150.24 5187.61,-3149.77"/>
</g>
<!-- aggregate_15_9 -->
<g id="node1032" class="node">
<title>aggregate_15_9</title>
<polygon fill="lightyellow" stroke="black" points="5325.51,-3051.98 5090.06,-3051.98 5029.49,-2947.98 5264.94,-2947.98 5325.51,-3051.98"/>
<text text-anchor="middle" x="5177.5" y="-3013.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L9</text>
<text text-anchor="middle" x="5177.5" y="-3002.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5177.5" y="-2991.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5177.5" y="-2980.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_9&#45;&gt;aggregate_15_9 -->
<g id="edge1015" class="edge">
<title>expert_15_9&#45;&gt;aggregate_15_9</title>
<path fill="none" stroke="black" d="M5177.5,-3087.85C5177.5,-3080.16 5177.5,-3071.35 5177.5,-3062.35"/>
<polygon fill="black" stroke="black" points="5181,-3062.16 5177.5,-3052.16 5174,-3062.16 5181,-3062.16"/>
</g>
<!-- attention_15_10 -->
<g id="node1033" class="node">
<title>attention_15_10</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-2911.98 5092.5,-2911.98 5092.5,-2859.98 5260.5,-2859.98 5260.5,-2911.98"/>
<text text-anchor="middle" x="5176.5" y="-2899.98" font-family="Arial" font-size="10.00">Attention GPU_15_L10</text>
<text text-anchor="middle" x="5176.5" y="-2888.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-2877.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-2866.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_9&#45;&gt;attention_15_10 -->
<g id="edge1016" class="edge">
<title>aggregate_15_9&#45;&gt;attention_15_10</title>
<path fill="none" stroke="black" d="M5177.04,-2947.9C5176.97,-2939.23 5176.89,-2930.41 5176.82,-2922.27"/>
<polygon fill="black" stroke="black" points="5180.31,-2921.99 5176.72,-2912.03 5173.31,-2922.06 5180.31,-2921.99"/>
</g>
<!-- gate_15_10 -->
<g id="node1034" class="node">
<title>gate_15_10</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-2823.98 5089.06,-2823.98 5028.49,-2719.98 5263.94,-2719.98 5324.51,-2823.98"/>
<text text-anchor="middle" x="5176.5" y="-2785.98" font-family="Arial" font-size="10.00">Gate GPU_15_L10</text>
<text text-anchor="middle" x="5176.5" y="-2774.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-2763.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-2752.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_10&#45;&gt;gate_15_10 -->
<g id="edge1017" class="edge">
<title>attention_15_10&#45;&gt;gate_15_10</title>
<path fill="none" stroke="black" d="M5176.5,-2859.85C5176.5,-2852.16 5176.5,-2843.35 5176.5,-2834.35"/>
<polygon fill="black" stroke="black" points="5180,-2834.16 5176.5,-2824.16 5173,-2834.16 5180,-2834.16"/>
</g>
<!-- expert_15_10 -->
<g id="node1035" class="node">
<title>expert_15_10</title>
<polygon fill="lightgreen" stroke="black" points="5251,-2683.98 5102,-2683.98 5102,-2631.98 5251,-2631.98 5251,-2683.98"/>
<text text-anchor="middle" x="5176.5" y="-2671.98" font-family="Arial" font-size="10.00">Expert GPU_15_L10</text>
<text text-anchor="middle" x="5176.5" y="-2660.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-2649.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-2638.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_10&#45;&gt;expert_15_10 -->
<g id="edge1018" class="edge">
<title>gate_15_10&#45;&gt;expert_15_10</title>
<path fill="none" stroke="black" d="M5169.77,-2719.9C5169.69,-2711.23 5169.83,-2702.41 5170.18,-2694.27"/>
<polygon fill="black" stroke="black" points="5173.69,-2694.21 5170.77,-2684.03 5166.7,-2693.81 5173.69,-2694.21"/>
</g>
<!-- gate_15_10&#45;&gt;expert_15_10 -->
<g id="edge1307" class="edge">
<title>gate_15_10&#45;&gt;expert_15_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-2719.9C5183.31,-2711.23 5183.17,-2702.41 5182.82,-2694.27"/>
<polygon fill="red" stroke="red" points="5186.3,-2693.81 5182.23,-2684.03 5179.31,-2694.21 5186.3,-2693.81"/>
</g>
<!-- aggregate_15_10 -->
<g id="node1036" class="node">
<title>aggregate_15_10</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-2595.98 5089.06,-2595.98 5028.49,-2491.98 5263.94,-2491.98 5324.51,-2595.98"/>
<text text-anchor="middle" x="5176.5" y="-2557.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L10</text>
<text text-anchor="middle" x="5176.5" y="-2546.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-2535.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-2524.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_10&#45;&gt;aggregate_15_10 -->
<g id="edge1019" class="edge">
<title>expert_15_10&#45;&gt;aggregate_15_10</title>
<path fill="none" stroke="black" d="M5176.5,-2631.85C5176.5,-2624.16 5176.5,-2615.35 5176.5,-2606.35"/>
<polygon fill="black" stroke="black" points="5180,-2606.16 5176.5,-2596.16 5173,-2606.16 5180,-2606.16"/>
</g>
<!-- attention_15_11 -->
<g id="node1037" class="node">
<title>attention_15_11</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-2455.98 5092.5,-2455.98 5092.5,-2403.98 5260.5,-2403.98 5260.5,-2455.98"/>
<text text-anchor="middle" x="5176.5" y="-2443.98" font-family="Arial" font-size="10.00">Attention GPU_15_L11</text>
<text text-anchor="middle" x="5176.5" y="-2432.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-2421.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-2410.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_10&#45;&gt;attention_15_11 -->
<g id="edge1020" class="edge">
<title>aggregate_15_10&#45;&gt;attention_15_11</title>
<path fill="none" stroke="black" d="M5176.5,-2491.9C5176.5,-2483.23 5176.5,-2474.41 5176.5,-2466.27"/>
<polygon fill="black" stroke="black" points="5180,-2466.03 5176.5,-2456.03 5173,-2466.03 5180,-2466.03"/>
</g>
<!-- gate_15_11 -->
<g id="node1038" class="node">
<title>gate_15_11</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-2367.98 5089.06,-2367.98 5028.49,-2263.98 5263.94,-2263.98 5324.51,-2367.98"/>
<text text-anchor="middle" x="5176.5" y="-2329.98" font-family="Arial" font-size="10.00">Gate GPU_15_L11</text>
<text text-anchor="middle" x="5176.5" y="-2318.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-2307.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-2296.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_11&#45;&gt;gate_15_11 -->
<g id="edge1021" class="edge">
<title>attention_15_11&#45;&gt;gate_15_11</title>
<path fill="none" stroke="black" d="M5176.5,-2403.85C5176.5,-2396.16 5176.5,-2387.35 5176.5,-2378.35"/>
<polygon fill="black" stroke="black" points="5180,-2378.16 5176.5,-2368.16 5173,-2378.16 5180,-2378.16"/>
</g>
<!-- expert_15_11 -->
<g id="node1039" class="node">
<title>expert_15_11</title>
<polygon fill="lightgreen" stroke="black" points="5251,-2227.98 5102,-2227.98 5102,-2175.98 5251,-2175.98 5251,-2227.98"/>
<text text-anchor="middle" x="5176.5" y="-2215.98" font-family="Arial" font-size="10.00">Expert GPU_15_L11</text>
<text text-anchor="middle" x="5176.5" y="-2204.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-2193.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-2182.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_11&#45;&gt;expert_15_11 -->
<g id="edge1022" class="edge">
<title>gate_15_11&#45;&gt;expert_15_11</title>
<path fill="none" stroke="black" d="M5169.77,-2263.9C5169.69,-2255.23 5169.83,-2246.41 5170.18,-2238.27"/>
<polygon fill="black" stroke="black" points="5173.69,-2238.21 5170.77,-2228.03 5166.7,-2237.81 5173.69,-2238.21"/>
</g>
<!-- gate_15_11&#45;&gt;expert_15_11 -->
<g id="edge1308" class="edge">
<title>gate_15_11&#45;&gt;expert_15_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-2263.9C5183.31,-2255.23 5183.17,-2246.41 5182.82,-2238.27"/>
<polygon fill="red" stroke="red" points="5186.3,-2237.81 5182.23,-2228.03 5179.31,-2238.21 5186.3,-2237.81"/>
</g>
<!-- aggregate_15_11 -->
<g id="node1040" class="node">
<title>aggregate_15_11</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-2139.98 5089.06,-2139.98 5028.49,-2035.98 5263.94,-2035.98 5324.51,-2139.98"/>
<text text-anchor="middle" x="5176.5" y="-2101.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L11</text>
<text text-anchor="middle" x="5176.5" y="-2090.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-2079.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-2068.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_11&#45;&gt;aggregate_15_11 -->
<g id="edge1023" class="edge">
<title>expert_15_11&#45;&gt;aggregate_15_11</title>
<path fill="none" stroke="black" d="M5176.5,-2175.85C5176.5,-2168.16 5176.5,-2159.35 5176.5,-2150.35"/>
<polygon fill="black" stroke="black" points="5180,-2150.16 5176.5,-2140.16 5173,-2150.16 5180,-2150.16"/>
</g>
<!-- attention_15_12 -->
<g id="node1041" class="node">
<title>attention_15_12</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-1999.98 5092.5,-1999.98 5092.5,-1947.98 5260.5,-1947.98 5260.5,-1999.98"/>
<text text-anchor="middle" x="5176.5" y="-1987.98" font-family="Arial" font-size="10.00">Attention GPU_15_L12</text>
<text text-anchor="middle" x="5176.5" y="-1976.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-1965.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-1954.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_11&#45;&gt;attention_15_12 -->
<g id="edge1024" class="edge">
<title>aggregate_15_11&#45;&gt;attention_15_12</title>
<path fill="none" stroke="black" d="M5176.5,-2035.9C5176.5,-2027.23 5176.5,-2018.41 5176.5,-2010.27"/>
<polygon fill="black" stroke="black" points="5180,-2010.03 5176.5,-2000.03 5173,-2010.03 5180,-2010.03"/>
</g>
<!-- gate_15_12 -->
<g id="node1042" class="node">
<title>gate_15_12</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-1911.98 5089.06,-1911.98 5028.49,-1807.98 5263.94,-1807.98 5324.51,-1911.98"/>
<text text-anchor="middle" x="5176.5" y="-1873.98" font-family="Arial" font-size="10.00">Gate GPU_15_L12</text>
<text text-anchor="middle" x="5176.5" y="-1862.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-1851.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-1840.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_12&#45;&gt;gate_15_12 -->
<g id="edge1025" class="edge">
<title>attention_15_12&#45;&gt;gate_15_12</title>
<path fill="none" stroke="black" d="M5176.5,-1947.85C5176.5,-1940.16 5176.5,-1931.35 5176.5,-1922.35"/>
<polygon fill="black" stroke="black" points="5180,-1922.16 5176.5,-1912.16 5173,-1922.16 5180,-1922.16"/>
</g>
<!-- expert_15_12 -->
<g id="node1043" class="node">
<title>expert_15_12</title>
<polygon fill="lightgreen" stroke="black" points="5251,-1771.98 5102,-1771.98 5102,-1719.98 5251,-1719.98 5251,-1771.98"/>
<text text-anchor="middle" x="5176.5" y="-1759.98" font-family="Arial" font-size="10.00">Expert GPU_15_L12</text>
<text text-anchor="middle" x="5176.5" y="-1748.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-1737.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-1726.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_12&#45;&gt;expert_15_12 -->
<g id="edge1026" class="edge">
<title>gate_15_12&#45;&gt;expert_15_12</title>
<path fill="none" stroke="black" d="M5169.77,-1807.9C5169.69,-1799.23 5169.83,-1790.41 5170.18,-1782.27"/>
<polygon fill="black" stroke="black" points="5173.69,-1782.21 5170.77,-1772.03 5166.7,-1781.81 5173.69,-1782.21"/>
</g>
<!-- gate_15_12&#45;&gt;expert_15_12 -->
<g id="edge1309" class="edge">
<title>gate_15_12&#45;&gt;expert_15_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-1807.9C5183.31,-1799.23 5183.17,-1790.41 5182.82,-1782.27"/>
<polygon fill="red" stroke="red" points="5186.3,-1781.81 5182.23,-1772.03 5179.31,-1782.21 5186.3,-1781.81"/>
</g>
<!-- aggregate_15_12 -->
<g id="node1044" class="node">
<title>aggregate_15_12</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-1683.98 5089.06,-1683.98 5028.49,-1579.98 5263.94,-1579.98 5324.51,-1683.98"/>
<text text-anchor="middle" x="5176.5" y="-1645.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L12</text>
<text text-anchor="middle" x="5176.5" y="-1634.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-1623.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-1612.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_12&#45;&gt;aggregate_15_12 -->
<g id="edge1027" class="edge">
<title>expert_15_12&#45;&gt;aggregate_15_12</title>
<path fill="none" stroke="black" d="M5176.5,-1719.85C5176.5,-1712.16 5176.5,-1703.35 5176.5,-1694.35"/>
<polygon fill="black" stroke="black" points="5180,-1694.16 5176.5,-1684.16 5173,-1694.16 5180,-1694.16"/>
</g>
<!-- attention_15_13 -->
<g id="node1045" class="node">
<title>attention_15_13</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-1543.98 5092.5,-1543.98 5092.5,-1491.98 5260.5,-1491.98 5260.5,-1543.98"/>
<text text-anchor="middle" x="5176.5" y="-1531.98" font-family="Arial" font-size="10.00">Attention GPU_15_L13</text>
<text text-anchor="middle" x="5176.5" y="-1520.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-1509.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-1498.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_12&#45;&gt;attention_15_13 -->
<g id="edge1028" class="edge">
<title>aggregate_15_12&#45;&gt;attention_15_13</title>
<path fill="none" stroke="black" d="M5176.5,-1579.9C5176.5,-1571.23 5176.5,-1562.41 5176.5,-1554.27"/>
<polygon fill="black" stroke="black" points="5180,-1554.03 5176.5,-1544.03 5173,-1554.03 5180,-1554.03"/>
</g>
<!-- gate_15_13 -->
<g id="node1046" class="node">
<title>gate_15_13</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-1455.98 5089.06,-1455.98 5028.49,-1351.98 5263.94,-1351.98 5324.51,-1455.98"/>
<text text-anchor="middle" x="5176.5" y="-1417.98" font-family="Arial" font-size="10.00">Gate GPU_15_L13</text>
<text text-anchor="middle" x="5176.5" y="-1406.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-1395.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-1384.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_13&#45;&gt;gate_15_13 -->
<g id="edge1029" class="edge">
<title>attention_15_13&#45;&gt;gate_15_13</title>
<path fill="none" stroke="black" d="M5176.5,-1491.85C5176.5,-1484.16 5176.5,-1475.35 5176.5,-1466.35"/>
<polygon fill="black" stroke="black" points="5180,-1466.16 5176.5,-1456.16 5173,-1466.16 5180,-1466.16"/>
</g>
<!-- expert_15_13 -->
<g id="node1047" class="node">
<title>expert_15_13</title>
<polygon fill="lightgreen" stroke="black" points="5251,-1315.98 5102,-1315.98 5102,-1263.98 5251,-1263.98 5251,-1315.98"/>
<text text-anchor="middle" x="5176.5" y="-1303.98" font-family="Arial" font-size="10.00">Expert GPU_15_L13</text>
<text text-anchor="middle" x="5176.5" y="-1292.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-1281.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-1270.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_13&#45;&gt;expert_15_13 -->
<g id="edge1030" class="edge">
<title>gate_15_13&#45;&gt;expert_15_13</title>
<path fill="none" stroke="black" d="M5169.77,-1351.9C5169.69,-1343.23 5169.83,-1334.41 5170.18,-1326.27"/>
<polygon fill="black" stroke="black" points="5173.69,-1326.21 5170.77,-1316.03 5166.7,-1325.81 5173.69,-1326.21"/>
</g>
<!-- gate_15_13&#45;&gt;expert_15_13 -->
<g id="edge1310" class="edge">
<title>gate_15_13&#45;&gt;expert_15_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-1351.9C5183.31,-1343.23 5183.17,-1334.41 5182.82,-1326.27"/>
<polygon fill="red" stroke="red" points="5186.3,-1325.81 5182.23,-1316.03 5179.31,-1326.21 5186.3,-1325.81"/>
</g>
<!-- aggregate_15_13 -->
<g id="node1048" class="node">
<title>aggregate_15_13</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-1227.98 5089.06,-1227.98 5028.49,-1123.98 5263.94,-1123.98 5324.51,-1227.98"/>
<text text-anchor="middle" x="5176.5" y="-1189.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L13</text>
<text text-anchor="middle" x="5176.5" y="-1178.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-1167.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-1156.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_13&#45;&gt;aggregate_15_13 -->
<g id="edge1031" class="edge">
<title>expert_15_13&#45;&gt;aggregate_15_13</title>
<path fill="none" stroke="black" d="M5176.5,-1263.85C5176.5,-1256.16 5176.5,-1247.35 5176.5,-1238.35"/>
<polygon fill="black" stroke="black" points="5180,-1238.16 5176.5,-1228.16 5173,-1238.16 5180,-1238.16"/>
</g>
<!-- attention_15_14 -->
<g id="node1049" class="node">
<title>attention_15_14</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-1087.98 5092.5,-1087.98 5092.5,-1035.98 5260.5,-1035.98 5260.5,-1087.98"/>
<text text-anchor="middle" x="5176.5" y="-1075.98" font-family="Arial" font-size="10.00">Attention GPU_15_L14</text>
<text text-anchor="middle" x="5176.5" y="-1064.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-1053.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-1042.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_13&#45;&gt;attention_15_14 -->
<g id="edge1032" class="edge">
<title>aggregate_15_13&#45;&gt;attention_15_14</title>
<path fill="none" stroke="black" d="M5176.5,-1123.9C5176.5,-1115.23 5176.5,-1106.41 5176.5,-1098.27"/>
<polygon fill="black" stroke="black" points="5180,-1098.03 5176.5,-1088.03 5173,-1098.03 5180,-1098.03"/>
</g>
<!-- gate_15_14 -->
<g id="node1050" class="node">
<title>gate_15_14</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-999.98 5089.06,-999.98 5028.49,-895.98 5263.94,-895.98 5324.51,-999.98"/>
<text text-anchor="middle" x="5176.5" y="-961.98" font-family="Arial" font-size="10.00">Gate GPU_15_L14</text>
<text text-anchor="middle" x="5176.5" y="-950.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-939.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-928.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_14&#45;&gt;gate_15_14 -->
<g id="edge1033" class="edge">
<title>attention_15_14&#45;&gt;gate_15_14</title>
<path fill="none" stroke="black" d="M5176.5,-1035.85C5176.5,-1028.16 5176.5,-1019.35 5176.5,-1010.35"/>
<polygon fill="black" stroke="black" points="5180,-1010.16 5176.5,-1000.16 5173,-1010.16 5180,-1010.16"/>
</g>
<!-- expert_15_14 -->
<g id="node1051" class="node">
<title>expert_15_14</title>
<polygon fill="lightgreen" stroke="black" points="5251,-859.98 5102,-859.98 5102,-807.98 5251,-807.98 5251,-859.98"/>
<text text-anchor="middle" x="5176.5" y="-847.98" font-family="Arial" font-size="10.00">Expert GPU_15_L14</text>
<text text-anchor="middle" x="5176.5" y="-836.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-825.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-814.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_14&#45;&gt;expert_15_14 -->
<g id="edge1034" class="edge">
<title>gate_15_14&#45;&gt;expert_15_14</title>
<path fill="none" stroke="black" d="M5169.77,-895.9C5169.69,-887.23 5169.83,-878.41 5170.18,-870.27"/>
<polygon fill="black" stroke="black" points="5173.69,-870.21 5170.77,-860.03 5166.7,-869.81 5173.69,-870.21"/>
</g>
<!-- gate_15_14&#45;&gt;expert_15_14 -->
<g id="edge1311" class="edge">
<title>gate_15_14&#45;&gt;expert_15_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-895.9C5183.31,-887.23 5183.17,-878.41 5182.82,-870.27"/>
<polygon fill="red" stroke="red" points="5186.3,-869.81 5182.23,-860.03 5179.31,-870.21 5186.3,-869.81"/>
</g>
<!-- aggregate_15_14 -->
<g id="node1052" class="node">
<title>aggregate_15_14</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-771.98 5089.06,-771.98 5028.49,-667.98 5263.94,-667.98 5324.51,-771.98"/>
<text text-anchor="middle" x="5176.5" y="-733.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L14</text>
<text text-anchor="middle" x="5176.5" y="-722.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-711.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-700.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_14&#45;&gt;aggregate_15_14 -->
<g id="edge1035" class="edge">
<title>expert_15_14&#45;&gt;aggregate_15_14</title>
<path fill="none" stroke="black" d="M5176.5,-807.85C5176.5,-800.16 5176.5,-791.35 5176.5,-782.35"/>
<polygon fill="black" stroke="black" points="5180,-782.16 5176.5,-772.16 5173,-782.16 5180,-782.16"/>
</g>
<!-- attention_15_15 -->
<g id="node1053" class="node">
<title>attention_15_15</title>
<polygon fill="lightgreen" stroke="black" points="5260.5,-631.98 5092.5,-631.98 5092.5,-579.98 5260.5,-579.98 5260.5,-631.98"/>
<text text-anchor="middle" x="5176.5" y="-619.98" font-family="Arial" font-size="10.00">Attention GPU_15_L15</text>
<text text-anchor="middle" x="5176.5" y="-608.98" font-family="Arial" font-size="10.00">TP=4</text>
<text text-anchor="middle" x="5176.5" y="-597.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, H=16, D=32]</text>
<text text-anchor="middle" x="5176.5" y="-586.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, H=16, D=32]</text>
</g>
<!-- aggregate_15_14&#45;&gt;attention_15_15 -->
<g id="edge1036" class="edge">
<title>aggregate_15_14&#45;&gt;attention_15_15</title>
<path fill="none" stroke="black" d="M5176.5,-667.9C5176.5,-659.23 5176.5,-650.41 5176.5,-642.27"/>
<polygon fill="black" stroke="black" points="5180,-642.03 5176.5,-632.03 5173,-642.03 5180,-642.03"/>
</g>
<!-- gate_15_15 -->
<g id="node1054" class="node">
<title>gate_15_15</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-543.98 5089.06,-543.98 5028.49,-439.98 5263.94,-439.98 5324.51,-543.98"/>
<text text-anchor="middle" x="5176.5" y="-505.98" font-family="Arial" font-size="10.00">Gate GPU_15_L15</text>
<text text-anchor="middle" x="5176.5" y="-494.98" font-family="Arial" font-size="10.00">Select Top&#45;2 Experts</text>
<text text-anchor="middle" x="5176.5" y="-483.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-472.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- attention_15_15&#45;&gt;gate_15_15 -->
<g id="edge1037" class="edge">
<title>attention_15_15&#45;&gt;gate_15_15</title>
<path fill="none" stroke="black" d="M5176.5,-579.85C5176.5,-572.16 5176.5,-563.35 5176.5,-554.35"/>
<polygon fill="black" stroke="black" points="5180,-554.16 5176.5,-544.16 5173,-554.16 5180,-554.16"/>
</g>
<!-- expert_15_15 -->
<g id="node1055" class="node">
<title>expert_15_15</title>
<polygon fill="lightgreen" stroke="black" points="5251,-403.98 5102,-403.98 5102,-351.98 5251,-351.98 5251,-403.98"/>
<text text-anchor="middle" x="5176.5" y="-391.98" font-family="Arial" font-size="10.00">Expert GPU_15_L15</text>
<text text-anchor="middle" x="5176.5" y="-380.98" font-family="Arial" font-size="10.00">Expert ID=15</text>
<text text-anchor="middle" x="5176.5" y="-369.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-358.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=1024]</text>
</g>
<!-- gate_15_15&#45;&gt;expert_15_15 -->
<g id="edge1038" class="edge">
<title>gate_15_15&#45;&gt;expert_15_15</title>
<path fill="none" stroke="black" d="M5169.77,-439.9C5169.69,-431.23 5169.83,-422.41 5170.18,-414.27"/>
<polygon fill="black" stroke="black" points="5173.69,-414.21 5170.77,-404.03 5166.7,-413.81 5173.69,-414.21"/>
</g>
<!-- gate_15_15&#45;&gt;expert_15_15 -->
<g id="edge1312" class="edge">
<title>gate_15_15&#45;&gt;expert_15_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M5183.23,-439.9C5183.31,-431.23 5183.17,-422.41 5182.82,-414.27"/>
<polygon fill="red" stroke="red" points="5186.3,-413.81 5182.23,-404.03 5179.31,-414.21 5186.3,-413.81"/>
</g>
<!-- aggregate_15_15 -->
<g id="node1056" class="node">
<title>aggregate_15_15</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-315.98 5089.06,-315.98 5028.49,-211.98 5263.94,-211.98 5324.51,-315.98"/>
<text text-anchor="middle" x="5176.5" y="-277.98" font-family="Arial" font-size="10.00">Aggregate GPU_15_L15</text>
<text text-anchor="middle" x="5176.5" y="-266.98" font-family="Arial" font-size="10.00">Combine Expert Outputs</text>
<text text-anchor="middle" x="5176.5" y="-255.98" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=1024]</text>
<text text-anchor="middle" x="5176.5" y="-244.98" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- expert_15_15&#45;&gt;aggregate_15_15 -->
<g id="edge1039" class="edge">
<title>expert_15_15&#45;&gt;aggregate_15_15</title>
<path fill="none" stroke="black" d="M5176.5,-351.85C5176.5,-344.16 5176.5,-335.35 5176.5,-326.35"/>
<polygon fill="black" stroke="black" points="5180,-326.16 5176.5,-316.16 5173,-326.16 5180,-326.16"/>
</g>
<!-- collect_15 -->
<g id="node1057" class="node">
<title>collect_15</title>
<polygon fill="lightyellow" stroke="black" points="5324.51,-175.98 5089.06,-175.98 5028.49,-93.98 5263.94,-93.98 5324.51,-175.98"/>
<text text-anchor="middle" x="5176.5" y="-143.48" font-family="Arial" font-size="10.00">Collect from GPU_15</text>
<text text-anchor="middle" x="5176.5" y="-132.48" font-family="Arial" font-size="10.00">Input: [B=8, S=var, D=512]</text>
<text text-anchor="middle" x="5176.5" y="-121.48" font-family="Arial" font-size="10.00">Output: [B=8, S=var, D=512]</text>
</g>
<!-- aggregate_15_15&#45;&gt;collect_15 -->
<g id="edge1040" class="edge">
<title>aggregate_15_15&#45;&gt;collect_15</title>
<path fill="none" stroke="black" d="M5176.5,-211.69C5176.5,-203.27 5176.5,-194.56 5176.5,-186.17"/>
<polygon fill="black" stroke="black" points="5180,-186.14 5176.5,-176.14 5173,-186.14 5180,-186.14"/>
</g>
<!-- collect_15&#45;&gt;output -->
<g id="edge1056" class="edge">
<title>collect_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5029.53,-95.65C5025.82,-95.05 5022.14,-94.49 5018.5,-93.98 4613.9,-37.59 3352.32,-30.75 2943.08,-30.03"/>
<polygon fill="black" stroke="black" points="2942.99,-26.53 2932.99,-30.02 2942.98,-33.53 2942.99,-26.53"/>
</g>
</g>
</svg>
