// MoE Parallel Strategy Deployment DAG
digraph {
	rankdir=TB size="20,30"
	node [fontname=Arial fontsize=10]
	edge [fontname=Arial fontsize=8]
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	input [label="Input\nBatch Size=128, Seq Len=Variable\nToken Dim=512" fillcolor=lightblue shape=ellipse]
	distribute_0 [label="Distribute to GPU_0\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_0_0 [label="Attention GPU_0_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_0 [label="Gate GPU_0_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_0 [label="Expert GPU_0_L0\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_0 [label="Aggregate GPU_0_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_0 -> attention_0_0
	attention_0_0 -> gate_0_0
	gate_0_0 -> expert_0_0
	expert_0_0 -> aggregate_0_0
	attention_0_1 [label="Attention GPU_0_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_1 [label="Gate GPU_0_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_1 [label="Expert GPU_0_L1\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_1 [label="Aggregate GPU_0_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_0 -> attention_0_1
	attention_0_1 -> gate_0_1
	gate_0_1 -> expert_0_1
	expert_0_1 -> aggregate_0_1
	attention_0_2 [label="Attention GPU_0_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_2 [label="Gate GPU_0_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_2 [label="Expert GPU_0_L2\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_2 [label="Aggregate GPU_0_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_1 -> attention_0_2
	attention_0_2 -> gate_0_2
	gate_0_2 -> expert_0_2
	expert_0_2 -> aggregate_0_2
	attention_0_3 [label="Attention GPU_0_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_3 [label="Gate GPU_0_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_3 [label="Expert GPU_0_L3\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_3 [label="Aggregate GPU_0_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_2 -> attention_0_3
	attention_0_3 -> gate_0_3
	gate_0_3 -> expert_0_3
	expert_0_3 -> aggregate_0_3
	attention_0_4 [label="Attention GPU_0_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_4 [label="Gate GPU_0_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_4 [label="Expert GPU_0_L4\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_4 [label="Aggregate GPU_0_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_3 -> attention_0_4
	attention_0_4 -> gate_0_4
	gate_0_4 -> expert_0_4
	expert_0_4 -> aggregate_0_4
	attention_0_5 [label="Attention GPU_0_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_5 [label="Gate GPU_0_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_5 [label="Expert GPU_0_L5\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_5 [label="Aggregate GPU_0_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_4 -> attention_0_5
	attention_0_5 -> gate_0_5
	gate_0_5 -> expert_0_5
	expert_0_5 -> aggregate_0_5
	attention_0_6 [label="Attention GPU_0_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_6 [label="Gate GPU_0_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_6 [label="Expert GPU_0_L6\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_6 [label="Aggregate GPU_0_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_5 -> attention_0_6
	attention_0_6 -> gate_0_6
	gate_0_6 -> expert_0_6
	expert_0_6 -> aggregate_0_6
	attention_0_7 [label="Attention GPU_0_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_7 [label="Gate GPU_0_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_7 [label="Expert GPU_0_L7\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_7 [label="Aggregate GPU_0_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_6 -> attention_0_7
	attention_0_7 -> gate_0_7
	gate_0_7 -> expert_0_7
	expert_0_7 -> aggregate_0_7
	attention_0_8 [label="Attention GPU_0_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_8 [label="Gate GPU_0_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_8 [label="Expert GPU_0_L8\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_8 [label="Aggregate GPU_0_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_7 -> attention_0_8
	attention_0_8 -> gate_0_8
	gate_0_8 -> expert_0_8
	expert_0_8 -> aggregate_0_8
	attention_0_9 [label="Attention GPU_0_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_9 [label="Gate GPU_0_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_9 [label="Expert GPU_0_L9\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_9 [label="Aggregate GPU_0_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_8 -> attention_0_9
	attention_0_9 -> gate_0_9
	gate_0_9 -> expert_0_9
	expert_0_9 -> aggregate_0_9
	attention_0_10 [label="Attention GPU_0_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_10 [label="Gate GPU_0_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_10 [label="Expert GPU_0_L10\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_10 [label="Aggregate GPU_0_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_9 -> attention_0_10
	attention_0_10 -> gate_0_10
	gate_0_10 -> expert_0_10
	expert_0_10 -> aggregate_0_10
	attention_0_11 [label="Attention GPU_0_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_11 [label="Gate GPU_0_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_11 [label="Expert GPU_0_L11\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_11 [label="Aggregate GPU_0_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_10 -> attention_0_11
	attention_0_11 -> gate_0_11
	gate_0_11 -> expert_0_11
	expert_0_11 -> aggregate_0_11
	attention_0_12 [label="Attention GPU_0_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_12 [label="Gate GPU_0_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_12 [label="Expert GPU_0_L12\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_12 [label="Aggregate GPU_0_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_11 -> attention_0_12
	attention_0_12 -> gate_0_12
	gate_0_12 -> expert_0_12
	expert_0_12 -> aggregate_0_12
	attention_0_13 [label="Attention GPU_0_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_13 [label="Gate GPU_0_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_13 [label="Expert GPU_0_L13\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_13 [label="Aggregate GPU_0_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_12 -> attention_0_13
	attention_0_13 -> gate_0_13
	gate_0_13 -> expert_0_13
	expert_0_13 -> aggregate_0_13
	attention_0_14 [label="Attention GPU_0_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_14 [label="Gate GPU_0_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_14 [label="Expert GPU_0_L14\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_14 [label="Aggregate GPU_0_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_13 -> attention_0_14
	attention_0_14 -> gate_0_14
	gate_0_14 -> expert_0_14
	expert_0_14 -> aggregate_0_14
	attention_0_15 [label="Attention GPU_0_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_0_15 [label="Gate GPU_0_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_0_15 [label="Expert GPU_0_L15\nExpert ID=0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_0_15 [label="Aggregate GPU_0_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_14 -> attention_0_15
	attention_0_15 -> gate_0_15
	gate_0_15 -> expert_0_15
	expert_0_15 -> aggregate_0_15
	collect_0 [label="Collect from GPU_0\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_0_15 -> collect_0
	distribute_1 [label="Distribute to GPU_1\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_1_0 [label="Attention GPU_1_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_0 [label="Gate GPU_1_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_0 [label="Expert GPU_1_L0\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_0 [label="Aggregate GPU_1_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_1 -> attention_1_0
	attention_1_0 -> gate_1_0
	gate_1_0 -> expert_1_0
	expert_1_0 -> aggregate_1_0
	attention_1_1 [label="Attention GPU_1_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_1 [label="Gate GPU_1_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_1 [label="Expert GPU_1_L1\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_1 [label="Aggregate GPU_1_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_0 -> attention_1_1
	attention_1_1 -> gate_1_1
	gate_1_1 -> expert_1_1
	expert_1_1 -> aggregate_1_1
	attention_1_2 [label="Attention GPU_1_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_2 [label="Gate GPU_1_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_2 [label="Expert GPU_1_L2\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_2 [label="Aggregate GPU_1_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_1 -> attention_1_2
	attention_1_2 -> gate_1_2
	gate_1_2 -> expert_1_2
	expert_1_2 -> aggregate_1_2
	attention_1_3 [label="Attention GPU_1_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_3 [label="Gate GPU_1_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_3 [label="Expert GPU_1_L3\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_3 [label="Aggregate GPU_1_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_2 -> attention_1_3
	attention_1_3 -> gate_1_3
	gate_1_3 -> expert_1_3
	expert_1_3 -> aggregate_1_3
	attention_1_4 [label="Attention GPU_1_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_4 [label="Gate GPU_1_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_4 [label="Expert GPU_1_L4\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_4 [label="Aggregate GPU_1_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_3 -> attention_1_4
	attention_1_4 -> gate_1_4
	gate_1_4 -> expert_1_4
	expert_1_4 -> aggregate_1_4
	attention_1_5 [label="Attention GPU_1_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_5 [label="Gate GPU_1_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_5 [label="Expert GPU_1_L5\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_5 [label="Aggregate GPU_1_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_4 -> attention_1_5
	attention_1_5 -> gate_1_5
	gate_1_5 -> expert_1_5
	expert_1_5 -> aggregate_1_5
	attention_1_6 [label="Attention GPU_1_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_6 [label="Gate GPU_1_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_6 [label="Expert GPU_1_L6\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_6 [label="Aggregate GPU_1_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_5 -> attention_1_6
	attention_1_6 -> gate_1_6
	gate_1_6 -> expert_1_6
	expert_1_6 -> aggregate_1_6
	attention_1_7 [label="Attention GPU_1_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_7 [label="Gate GPU_1_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_7 [label="Expert GPU_1_L7\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_7 [label="Aggregate GPU_1_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_6 -> attention_1_7
	attention_1_7 -> gate_1_7
	gate_1_7 -> expert_1_7
	expert_1_7 -> aggregate_1_7
	attention_1_8 [label="Attention GPU_1_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_8 [label="Gate GPU_1_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_8 [label="Expert GPU_1_L8\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_8 [label="Aggregate GPU_1_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_7 -> attention_1_8
	attention_1_8 -> gate_1_8
	gate_1_8 -> expert_1_8
	expert_1_8 -> aggregate_1_8
	attention_1_9 [label="Attention GPU_1_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_9 [label="Gate GPU_1_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_9 [label="Expert GPU_1_L9\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_9 [label="Aggregate GPU_1_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_8 -> attention_1_9
	attention_1_9 -> gate_1_9
	gate_1_9 -> expert_1_9
	expert_1_9 -> aggregate_1_9
	attention_1_10 [label="Attention GPU_1_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_10 [label="Gate GPU_1_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_10 [label="Expert GPU_1_L10\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_10 [label="Aggregate GPU_1_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_9 -> attention_1_10
	attention_1_10 -> gate_1_10
	gate_1_10 -> expert_1_10
	expert_1_10 -> aggregate_1_10
	attention_1_11 [label="Attention GPU_1_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_11 [label="Gate GPU_1_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_11 [label="Expert GPU_1_L11\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_11 [label="Aggregate GPU_1_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_10 -> attention_1_11
	attention_1_11 -> gate_1_11
	gate_1_11 -> expert_1_11
	expert_1_11 -> aggregate_1_11
	attention_1_12 [label="Attention GPU_1_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_12 [label="Gate GPU_1_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_12 [label="Expert GPU_1_L12\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_12 [label="Aggregate GPU_1_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_11 -> attention_1_12
	attention_1_12 -> gate_1_12
	gate_1_12 -> expert_1_12
	expert_1_12 -> aggregate_1_12
	attention_1_13 [label="Attention GPU_1_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_13 [label="Gate GPU_1_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_13 [label="Expert GPU_1_L13\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_13 [label="Aggregate GPU_1_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_12 -> attention_1_13
	attention_1_13 -> gate_1_13
	gate_1_13 -> expert_1_13
	expert_1_13 -> aggregate_1_13
	attention_1_14 [label="Attention GPU_1_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_14 [label="Gate GPU_1_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_14 [label="Expert GPU_1_L14\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_14 [label="Aggregate GPU_1_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_13 -> attention_1_14
	attention_1_14 -> gate_1_14
	gate_1_14 -> expert_1_14
	expert_1_14 -> aggregate_1_14
	attention_1_15 [label="Attention GPU_1_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_1_15 [label="Gate GPU_1_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_1_15 [label="Expert GPU_1_L15\nExpert ID=1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_1_15 [label="Aggregate GPU_1_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_14 -> attention_1_15
	attention_1_15 -> gate_1_15
	gate_1_15 -> expert_1_15
	expert_1_15 -> aggregate_1_15
	collect_1 [label="Collect from GPU_1\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_1_15 -> collect_1
	distribute_2 [label="Distribute to GPU_2\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_2_0 [label="Attention GPU_2_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_0 [label="Gate GPU_2_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_0 [label="Expert GPU_2_L0\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_0 [label="Aggregate GPU_2_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_2 -> attention_2_0
	attention_2_0 -> gate_2_0
	gate_2_0 -> expert_2_0
	expert_2_0 -> aggregate_2_0
	attention_2_1 [label="Attention GPU_2_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_1 [label="Gate GPU_2_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_1 [label="Expert GPU_2_L1\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_1 [label="Aggregate GPU_2_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_0 -> attention_2_1
	attention_2_1 -> gate_2_1
	gate_2_1 -> expert_2_1
	expert_2_1 -> aggregate_2_1
	attention_2_2 [label="Attention GPU_2_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_2 [label="Gate GPU_2_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_2 [label="Expert GPU_2_L2\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_2 [label="Aggregate GPU_2_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_1 -> attention_2_2
	attention_2_2 -> gate_2_2
	gate_2_2 -> expert_2_2
	expert_2_2 -> aggregate_2_2
	attention_2_3 [label="Attention GPU_2_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_3 [label="Gate GPU_2_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_3 [label="Expert GPU_2_L3\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_3 [label="Aggregate GPU_2_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_2 -> attention_2_3
	attention_2_3 -> gate_2_3
	gate_2_3 -> expert_2_3
	expert_2_3 -> aggregate_2_3
	attention_2_4 [label="Attention GPU_2_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_4 [label="Gate GPU_2_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_4 [label="Expert GPU_2_L4\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_4 [label="Aggregate GPU_2_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_3 -> attention_2_4
	attention_2_4 -> gate_2_4
	gate_2_4 -> expert_2_4
	expert_2_4 -> aggregate_2_4
	attention_2_5 [label="Attention GPU_2_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_5 [label="Gate GPU_2_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_5 [label="Expert GPU_2_L5\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_5 [label="Aggregate GPU_2_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_4 -> attention_2_5
	attention_2_5 -> gate_2_5
	gate_2_5 -> expert_2_5
	expert_2_5 -> aggregate_2_5
	attention_2_6 [label="Attention GPU_2_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_6 [label="Gate GPU_2_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_6 [label="Expert GPU_2_L6\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_6 [label="Aggregate GPU_2_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_5 -> attention_2_6
	attention_2_6 -> gate_2_6
	gate_2_6 -> expert_2_6
	expert_2_6 -> aggregate_2_6
	attention_2_7 [label="Attention GPU_2_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_7 [label="Gate GPU_2_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_7 [label="Expert GPU_2_L7\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_7 [label="Aggregate GPU_2_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_6 -> attention_2_7
	attention_2_7 -> gate_2_7
	gate_2_7 -> expert_2_7
	expert_2_7 -> aggregate_2_7
	attention_2_8 [label="Attention GPU_2_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_8 [label="Gate GPU_2_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_8 [label="Expert GPU_2_L8\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_8 [label="Aggregate GPU_2_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_7 -> attention_2_8
	attention_2_8 -> gate_2_8
	gate_2_8 -> expert_2_8
	expert_2_8 -> aggregate_2_8
	attention_2_9 [label="Attention GPU_2_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_9 [label="Gate GPU_2_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_9 [label="Expert GPU_2_L9\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_9 [label="Aggregate GPU_2_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_8 -> attention_2_9
	attention_2_9 -> gate_2_9
	gate_2_9 -> expert_2_9
	expert_2_9 -> aggregate_2_9
	attention_2_10 [label="Attention GPU_2_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_10 [label="Gate GPU_2_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_10 [label="Expert GPU_2_L10\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_10 [label="Aggregate GPU_2_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_9 -> attention_2_10
	attention_2_10 -> gate_2_10
	gate_2_10 -> expert_2_10
	expert_2_10 -> aggregate_2_10
	attention_2_11 [label="Attention GPU_2_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_11 [label="Gate GPU_2_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_11 [label="Expert GPU_2_L11\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_11 [label="Aggregate GPU_2_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_10 -> attention_2_11
	attention_2_11 -> gate_2_11
	gate_2_11 -> expert_2_11
	expert_2_11 -> aggregate_2_11
	attention_2_12 [label="Attention GPU_2_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_12 [label="Gate GPU_2_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_12 [label="Expert GPU_2_L12\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_12 [label="Aggregate GPU_2_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_11 -> attention_2_12
	attention_2_12 -> gate_2_12
	gate_2_12 -> expert_2_12
	expert_2_12 -> aggregate_2_12
	attention_2_13 [label="Attention GPU_2_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_13 [label="Gate GPU_2_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_13 [label="Expert GPU_2_L13\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_13 [label="Aggregate GPU_2_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_12 -> attention_2_13
	attention_2_13 -> gate_2_13
	gate_2_13 -> expert_2_13
	expert_2_13 -> aggregate_2_13
	attention_2_14 [label="Attention GPU_2_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_14 [label="Gate GPU_2_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_14 [label="Expert GPU_2_L14\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_14 [label="Aggregate GPU_2_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_13 -> attention_2_14
	attention_2_14 -> gate_2_14
	gate_2_14 -> expert_2_14
	expert_2_14 -> aggregate_2_14
	attention_2_15 [label="Attention GPU_2_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_2_15 [label="Gate GPU_2_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_2_15 [label="Expert GPU_2_L15\nExpert ID=2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_2_15 [label="Aggregate GPU_2_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_14 -> attention_2_15
	attention_2_15 -> gate_2_15
	gate_2_15 -> expert_2_15
	expert_2_15 -> aggregate_2_15
	collect_2 [label="Collect from GPU_2\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_2_15 -> collect_2
	distribute_3 [label="Distribute to GPU_3\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_3_0 [label="Attention GPU_3_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_0 [label="Gate GPU_3_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_0 [label="Expert GPU_3_L0\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_0 [label="Aggregate GPU_3_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_3 -> attention_3_0
	attention_3_0 -> gate_3_0
	gate_3_0 -> expert_3_0
	expert_3_0 -> aggregate_3_0
	attention_3_1 [label="Attention GPU_3_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_1 [label="Gate GPU_3_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_1 [label="Expert GPU_3_L1\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_1 [label="Aggregate GPU_3_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_0 -> attention_3_1
	attention_3_1 -> gate_3_1
	gate_3_1 -> expert_3_1
	expert_3_1 -> aggregate_3_1
	attention_3_2 [label="Attention GPU_3_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_2 [label="Gate GPU_3_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_2 [label="Expert GPU_3_L2\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_2 [label="Aggregate GPU_3_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_1 -> attention_3_2
	attention_3_2 -> gate_3_2
	gate_3_2 -> expert_3_2
	expert_3_2 -> aggregate_3_2
	attention_3_3 [label="Attention GPU_3_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_3 [label="Gate GPU_3_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_3 [label="Expert GPU_3_L3\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_3 [label="Aggregate GPU_3_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_2 -> attention_3_3
	attention_3_3 -> gate_3_3
	gate_3_3 -> expert_3_3
	expert_3_3 -> aggregate_3_3
	attention_3_4 [label="Attention GPU_3_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_4 [label="Gate GPU_3_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_4 [label="Expert GPU_3_L4\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_4 [label="Aggregate GPU_3_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_3 -> attention_3_4
	attention_3_4 -> gate_3_4
	gate_3_4 -> expert_3_4
	expert_3_4 -> aggregate_3_4
	attention_3_5 [label="Attention GPU_3_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_5 [label="Gate GPU_3_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_5 [label="Expert GPU_3_L5\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_5 [label="Aggregate GPU_3_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_4 -> attention_3_5
	attention_3_5 -> gate_3_5
	gate_3_5 -> expert_3_5
	expert_3_5 -> aggregate_3_5
	attention_3_6 [label="Attention GPU_3_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_6 [label="Gate GPU_3_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_6 [label="Expert GPU_3_L6\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_6 [label="Aggregate GPU_3_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_5 -> attention_3_6
	attention_3_6 -> gate_3_6
	gate_3_6 -> expert_3_6
	expert_3_6 -> aggregate_3_6
	attention_3_7 [label="Attention GPU_3_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_7 [label="Gate GPU_3_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_7 [label="Expert GPU_3_L7\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_7 [label="Aggregate GPU_3_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_6 -> attention_3_7
	attention_3_7 -> gate_3_7
	gate_3_7 -> expert_3_7
	expert_3_7 -> aggregate_3_7
	attention_3_8 [label="Attention GPU_3_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_8 [label="Gate GPU_3_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_8 [label="Expert GPU_3_L8\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_8 [label="Aggregate GPU_3_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_7 -> attention_3_8
	attention_3_8 -> gate_3_8
	gate_3_8 -> expert_3_8
	expert_3_8 -> aggregate_3_8
	attention_3_9 [label="Attention GPU_3_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_9 [label="Gate GPU_3_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_9 [label="Expert GPU_3_L9\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_9 [label="Aggregate GPU_3_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_8 -> attention_3_9
	attention_3_9 -> gate_3_9
	gate_3_9 -> expert_3_9
	expert_3_9 -> aggregate_3_9
	attention_3_10 [label="Attention GPU_3_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_10 [label="Gate GPU_3_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_10 [label="Expert GPU_3_L10\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_10 [label="Aggregate GPU_3_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_9 -> attention_3_10
	attention_3_10 -> gate_3_10
	gate_3_10 -> expert_3_10
	expert_3_10 -> aggregate_3_10
	attention_3_11 [label="Attention GPU_3_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_11 [label="Gate GPU_3_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_11 [label="Expert GPU_3_L11\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_11 [label="Aggregate GPU_3_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_10 -> attention_3_11
	attention_3_11 -> gate_3_11
	gate_3_11 -> expert_3_11
	expert_3_11 -> aggregate_3_11
	attention_3_12 [label="Attention GPU_3_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_12 [label="Gate GPU_3_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_12 [label="Expert GPU_3_L12\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_12 [label="Aggregate GPU_3_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_11 -> attention_3_12
	attention_3_12 -> gate_3_12
	gate_3_12 -> expert_3_12
	expert_3_12 -> aggregate_3_12
	attention_3_13 [label="Attention GPU_3_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_13 [label="Gate GPU_3_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_13 [label="Expert GPU_3_L13\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_13 [label="Aggregate GPU_3_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_12 -> attention_3_13
	attention_3_13 -> gate_3_13
	gate_3_13 -> expert_3_13
	expert_3_13 -> aggregate_3_13
	attention_3_14 [label="Attention GPU_3_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_14 [label="Gate GPU_3_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_14 [label="Expert GPU_3_L14\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_14 [label="Aggregate GPU_3_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_13 -> attention_3_14
	attention_3_14 -> gate_3_14
	gate_3_14 -> expert_3_14
	expert_3_14 -> aggregate_3_14
	attention_3_15 [label="Attention GPU_3_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_3_15 [label="Gate GPU_3_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_3_15 [label="Expert GPU_3_L15\nExpert ID=3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_3_15 [label="Aggregate GPU_3_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_14 -> attention_3_15
	attention_3_15 -> gate_3_15
	gate_3_15 -> expert_3_15
	expert_3_15 -> aggregate_3_15
	collect_3 [label="Collect from GPU_3\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_3_15 -> collect_3
	distribute_4 [label="Distribute to GPU_4\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_4_0 [label="Attention GPU_4_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_0 [label="Gate GPU_4_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_0 [label="Expert GPU_4_L0\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_0 [label="Aggregate GPU_4_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_4 -> attention_4_0
	attention_4_0 -> gate_4_0
	gate_4_0 -> expert_4_0
	expert_4_0 -> aggregate_4_0
	attention_4_1 [label="Attention GPU_4_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_1 [label="Gate GPU_4_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_1 [label="Expert GPU_4_L1\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_1 [label="Aggregate GPU_4_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_0 -> attention_4_1
	attention_4_1 -> gate_4_1
	gate_4_1 -> expert_4_1
	expert_4_1 -> aggregate_4_1
	attention_4_2 [label="Attention GPU_4_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_2 [label="Gate GPU_4_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_2 [label="Expert GPU_4_L2\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_2 [label="Aggregate GPU_4_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_1 -> attention_4_2
	attention_4_2 -> gate_4_2
	gate_4_2 -> expert_4_2
	expert_4_2 -> aggregate_4_2
	attention_4_3 [label="Attention GPU_4_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_3 [label="Gate GPU_4_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_3 [label="Expert GPU_4_L3\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_3 [label="Aggregate GPU_4_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_2 -> attention_4_3
	attention_4_3 -> gate_4_3
	gate_4_3 -> expert_4_3
	expert_4_3 -> aggregate_4_3
	attention_4_4 [label="Attention GPU_4_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_4 [label="Gate GPU_4_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_4 [label="Expert GPU_4_L4\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_4 [label="Aggregate GPU_4_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_3 -> attention_4_4
	attention_4_4 -> gate_4_4
	gate_4_4 -> expert_4_4
	expert_4_4 -> aggregate_4_4
	attention_4_5 [label="Attention GPU_4_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_5 [label="Gate GPU_4_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_5 [label="Expert GPU_4_L5\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_5 [label="Aggregate GPU_4_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_4 -> attention_4_5
	attention_4_5 -> gate_4_5
	gate_4_5 -> expert_4_5
	expert_4_5 -> aggregate_4_5
	attention_4_6 [label="Attention GPU_4_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_6 [label="Gate GPU_4_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_6 [label="Expert GPU_4_L6\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_6 [label="Aggregate GPU_4_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_5 -> attention_4_6
	attention_4_6 -> gate_4_6
	gate_4_6 -> expert_4_6
	expert_4_6 -> aggregate_4_6
	attention_4_7 [label="Attention GPU_4_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_7 [label="Gate GPU_4_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_7 [label="Expert GPU_4_L7\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_7 [label="Aggregate GPU_4_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_6 -> attention_4_7
	attention_4_7 -> gate_4_7
	gate_4_7 -> expert_4_7
	expert_4_7 -> aggregate_4_7
	attention_4_8 [label="Attention GPU_4_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_8 [label="Gate GPU_4_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_8 [label="Expert GPU_4_L8\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_8 [label="Aggregate GPU_4_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_7 -> attention_4_8
	attention_4_8 -> gate_4_8
	gate_4_8 -> expert_4_8
	expert_4_8 -> aggregate_4_8
	attention_4_9 [label="Attention GPU_4_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_9 [label="Gate GPU_4_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_9 [label="Expert GPU_4_L9\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_9 [label="Aggregate GPU_4_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_8 -> attention_4_9
	attention_4_9 -> gate_4_9
	gate_4_9 -> expert_4_9
	expert_4_9 -> aggregate_4_9
	attention_4_10 [label="Attention GPU_4_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_10 [label="Gate GPU_4_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_10 [label="Expert GPU_4_L10\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_10 [label="Aggregate GPU_4_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_9 -> attention_4_10
	attention_4_10 -> gate_4_10
	gate_4_10 -> expert_4_10
	expert_4_10 -> aggregate_4_10
	attention_4_11 [label="Attention GPU_4_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_11 [label="Gate GPU_4_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_11 [label="Expert GPU_4_L11\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_11 [label="Aggregate GPU_4_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_10 -> attention_4_11
	attention_4_11 -> gate_4_11
	gate_4_11 -> expert_4_11
	expert_4_11 -> aggregate_4_11
	attention_4_12 [label="Attention GPU_4_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_12 [label="Gate GPU_4_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_12 [label="Expert GPU_4_L12\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_12 [label="Aggregate GPU_4_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_11 -> attention_4_12
	attention_4_12 -> gate_4_12
	gate_4_12 -> expert_4_12
	expert_4_12 -> aggregate_4_12
	attention_4_13 [label="Attention GPU_4_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_13 [label="Gate GPU_4_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_13 [label="Expert GPU_4_L13\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_13 [label="Aggregate GPU_4_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_12 -> attention_4_13
	attention_4_13 -> gate_4_13
	gate_4_13 -> expert_4_13
	expert_4_13 -> aggregate_4_13
	attention_4_14 [label="Attention GPU_4_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_14 [label="Gate GPU_4_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_14 [label="Expert GPU_4_L14\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_14 [label="Aggregate GPU_4_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_13 -> attention_4_14
	attention_4_14 -> gate_4_14
	gate_4_14 -> expert_4_14
	expert_4_14 -> aggregate_4_14
	attention_4_15 [label="Attention GPU_4_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_4_15 [label="Gate GPU_4_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_4_15 [label="Expert GPU_4_L15\nExpert ID=4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_4_15 [label="Aggregate GPU_4_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_14 -> attention_4_15
	attention_4_15 -> gate_4_15
	gate_4_15 -> expert_4_15
	expert_4_15 -> aggregate_4_15
	collect_4 [label="Collect from GPU_4\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_4_15 -> collect_4
	distribute_5 [label="Distribute to GPU_5\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_5_0 [label="Attention GPU_5_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_0 [label="Gate GPU_5_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_0 [label="Expert GPU_5_L0\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_0 [label="Aggregate GPU_5_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_5 -> attention_5_0
	attention_5_0 -> gate_5_0
	gate_5_0 -> expert_5_0
	expert_5_0 -> aggregate_5_0
	attention_5_1 [label="Attention GPU_5_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_1 [label="Gate GPU_5_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_1 [label="Expert GPU_5_L1\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_1 [label="Aggregate GPU_5_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_0 -> attention_5_1
	attention_5_1 -> gate_5_1
	gate_5_1 -> expert_5_1
	expert_5_1 -> aggregate_5_1
	attention_5_2 [label="Attention GPU_5_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_2 [label="Gate GPU_5_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_2 [label="Expert GPU_5_L2\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_2 [label="Aggregate GPU_5_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_1 -> attention_5_2
	attention_5_2 -> gate_5_2
	gate_5_2 -> expert_5_2
	expert_5_2 -> aggregate_5_2
	attention_5_3 [label="Attention GPU_5_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_3 [label="Gate GPU_5_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_3 [label="Expert GPU_5_L3\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_3 [label="Aggregate GPU_5_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_2 -> attention_5_3
	attention_5_3 -> gate_5_3
	gate_5_3 -> expert_5_3
	expert_5_3 -> aggregate_5_3
	attention_5_4 [label="Attention GPU_5_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_4 [label="Gate GPU_5_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_4 [label="Expert GPU_5_L4\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_4 [label="Aggregate GPU_5_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_3 -> attention_5_4
	attention_5_4 -> gate_5_4
	gate_5_4 -> expert_5_4
	expert_5_4 -> aggregate_5_4
	attention_5_5 [label="Attention GPU_5_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_5 [label="Gate GPU_5_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_5 [label="Expert GPU_5_L5\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_5 [label="Aggregate GPU_5_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_4 -> attention_5_5
	attention_5_5 -> gate_5_5
	gate_5_5 -> expert_5_5
	expert_5_5 -> aggregate_5_5
	attention_5_6 [label="Attention GPU_5_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_6 [label="Gate GPU_5_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_6 [label="Expert GPU_5_L6\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_6 [label="Aggregate GPU_5_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_5 -> attention_5_6
	attention_5_6 -> gate_5_6
	gate_5_6 -> expert_5_6
	expert_5_6 -> aggregate_5_6
	attention_5_7 [label="Attention GPU_5_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_7 [label="Gate GPU_5_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_7 [label="Expert GPU_5_L7\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_7 [label="Aggregate GPU_5_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_6 -> attention_5_7
	attention_5_7 -> gate_5_7
	gate_5_7 -> expert_5_7
	expert_5_7 -> aggregate_5_7
	attention_5_8 [label="Attention GPU_5_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_8 [label="Gate GPU_5_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_8 [label="Expert GPU_5_L8\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_8 [label="Aggregate GPU_5_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_7 -> attention_5_8
	attention_5_8 -> gate_5_8
	gate_5_8 -> expert_5_8
	expert_5_8 -> aggregate_5_8
	attention_5_9 [label="Attention GPU_5_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_9 [label="Gate GPU_5_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_9 [label="Expert GPU_5_L9\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_9 [label="Aggregate GPU_5_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_8 -> attention_5_9
	attention_5_9 -> gate_5_9
	gate_5_9 -> expert_5_9
	expert_5_9 -> aggregate_5_9
	attention_5_10 [label="Attention GPU_5_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_10 [label="Gate GPU_5_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_10 [label="Expert GPU_5_L10\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_10 [label="Aggregate GPU_5_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_9 -> attention_5_10
	attention_5_10 -> gate_5_10
	gate_5_10 -> expert_5_10
	expert_5_10 -> aggregate_5_10
	attention_5_11 [label="Attention GPU_5_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_11 [label="Gate GPU_5_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_11 [label="Expert GPU_5_L11\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_11 [label="Aggregate GPU_5_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_10 -> attention_5_11
	attention_5_11 -> gate_5_11
	gate_5_11 -> expert_5_11
	expert_5_11 -> aggregate_5_11
	attention_5_12 [label="Attention GPU_5_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_12 [label="Gate GPU_5_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_12 [label="Expert GPU_5_L12\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_12 [label="Aggregate GPU_5_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_11 -> attention_5_12
	attention_5_12 -> gate_5_12
	gate_5_12 -> expert_5_12
	expert_5_12 -> aggregate_5_12
	attention_5_13 [label="Attention GPU_5_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_13 [label="Gate GPU_5_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_13 [label="Expert GPU_5_L13\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_13 [label="Aggregate GPU_5_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_12 -> attention_5_13
	attention_5_13 -> gate_5_13
	gate_5_13 -> expert_5_13
	expert_5_13 -> aggregate_5_13
	attention_5_14 [label="Attention GPU_5_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_14 [label="Gate GPU_5_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_14 [label="Expert GPU_5_L14\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_14 [label="Aggregate GPU_5_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_13 -> attention_5_14
	attention_5_14 -> gate_5_14
	gate_5_14 -> expert_5_14
	expert_5_14 -> aggregate_5_14
	attention_5_15 [label="Attention GPU_5_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_5_15 [label="Gate GPU_5_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_5_15 [label="Expert GPU_5_L15\nExpert ID=5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_5_15 [label="Aggregate GPU_5_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_14 -> attention_5_15
	attention_5_15 -> gate_5_15
	gate_5_15 -> expert_5_15
	expert_5_15 -> aggregate_5_15
	collect_5 [label="Collect from GPU_5\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_5_15 -> collect_5
	distribute_6 [label="Distribute to GPU_6\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_6_0 [label="Attention GPU_6_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_0 [label="Gate GPU_6_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_0 [label="Expert GPU_6_L0\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_0 [label="Aggregate GPU_6_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_6 -> attention_6_0
	attention_6_0 -> gate_6_0
	gate_6_0 -> expert_6_0
	expert_6_0 -> aggregate_6_0
	attention_6_1 [label="Attention GPU_6_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_1 [label="Gate GPU_6_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_1 [label="Expert GPU_6_L1\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_1 [label="Aggregate GPU_6_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_0 -> attention_6_1
	attention_6_1 -> gate_6_1
	gate_6_1 -> expert_6_1
	expert_6_1 -> aggregate_6_1
	attention_6_2 [label="Attention GPU_6_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_2 [label="Gate GPU_6_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_2 [label="Expert GPU_6_L2\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_2 [label="Aggregate GPU_6_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_1 -> attention_6_2
	attention_6_2 -> gate_6_2
	gate_6_2 -> expert_6_2
	expert_6_2 -> aggregate_6_2
	attention_6_3 [label="Attention GPU_6_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_3 [label="Gate GPU_6_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_3 [label="Expert GPU_6_L3\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_3 [label="Aggregate GPU_6_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_2 -> attention_6_3
	attention_6_3 -> gate_6_3
	gate_6_3 -> expert_6_3
	expert_6_3 -> aggregate_6_3
	attention_6_4 [label="Attention GPU_6_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_4 [label="Gate GPU_6_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_4 [label="Expert GPU_6_L4\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_4 [label="Aggregate GPU_6_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_3 -> attention_6_4
	attention_6_4 -> gate_6_4
	gate_6_4 -> expert_6_4
	expert_6_4 -> aggregate_6_4
	attention_6_5 [label="Attention GPU_6_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_5 [label="Gate GPU_6_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_5 [label="Expert GPU_6_L5\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_5 [label="Aggregate GPU_6_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_4 -> attention_6_5
	attention_6_5 -> gate_6_5
	gate_6_5 -> expert_6_5
	expert_6_5 -> aggregate_6_5
	attention_6_6 [label="Attention GPU_6_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_6 [label="Gate GPU_6_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_6 [label="Expert GPU_6_L6\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_6 [label="Aggregate GPU_6_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_5 -> attention_6_6
	attention_6_6 -> gate_6_6
	gate_6_6 -> expert_6_6
	expert_6_6 -> aggregate_6_6
	attention_6_7 [label="Attention GPU_6_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_7 [label="Gate GPU_6_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_7 [label="Expert GPU_6_L7\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_7 [label="Aggregate GPU_6_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_6 -> attention_6_7
	attention_6_7 -> gate_6_7
	gate_6_7 -> expert_6_7
	expert_6_7 -> aggregate_6_7
	attention_6_8 [label="Attention GPU_6_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_8 [label="Gate GPU_6_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_8 [label="Expert GPU_6_L8\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_8 [label="Aggregate GPU_6_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_7 -> attention_6_8
	attention_6_8 -> gate_6_8
	gate_6_8 -> expert_6_8
	expert_6_8 -> aggregate_6_8
	attention_6_9 [label="Attention GPU_6_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_9 [label="Gate GPU_6_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_9 [label="Expert GPU_6_L9\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_9 [label="Aggregate GPU_6_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_8 -> attention_6_9
	attention_6_9 -> gate_6_9
	gate_6_9 -> expert_6_9
	expert_6_9 -> aggregate_6_9
	attention_6_10 [label="Attention GPU_6_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_10 [label="Gate GPU_6_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_10 [label="Expert GPU_6_L10\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_10 [label="Aggregate GPU_6_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_9 -> attention_6_10
	attention_6_10 -> gate_6_10
	gate_6_10 -> expert_6_10
	expert_6_10 -> aggregate_6_10
	attention_6_11 [label="Attention GPU_6_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_11 [label="Gate GPU_6_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_11 [label="Expert GPU_6_L11\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_11 [label="Aggregate GPU_6_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_10 -> attention_6_11
	attention_6_11 -> gate_6_11
	gate_6_11 -> expert_6_11
	expert_6_11 -> aggregate_6_11
	attention_6_12 [label="Attention GPU_6_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_12 [label="Gate GPU_6_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_12 [label="Expert GPU_6_L12\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_12 [label="Aggregate GPU_6_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_11 -> attention_6_12
	attention_6_12 -> gate_6_12
	gate_6_12 -> expert_6_12
	expert_6_12 -> aggregate_6_12
	attention_6_13 [label="Attention GPU_6_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_13 [label="Gate GPU_6_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_13 [label="Expert GPU_6_L13\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_13 [label="Aggregate GPU_6_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_12 -> attention_6_13
	attention_6_13 -> gate_6_13
	gate_6_13 -> expert_6_13
	expert_6_13 -> aggregate_6_13
	attention_6_14 [label="Attention GPU_6_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_14 [label="Gate GPU_6_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_14 [label="Expert GPU_6_L14\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_14 [label="Aggregate GPU_6_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_13 -> attention_6_14
	attention_6_14 -> gate_6_14
	gate_6_14 -> expert_6_14
	expert_6_14 -> aggregate_6_14
	attention_6_15 [label="Attention GPU_6_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_6_15 [label="Gate GPU_6_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_6_15 [label="Expert GPU_6_L15\nExpert ID=6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_6_15 [label="Aggregate GPU_6_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_14 -> attention_6_15
	attention_6_15 -> gate_6_15
	gate_6_15 -> expert_6_15
	expert_6_15 -> aggregate_6_15
	collect_6 [label="Collect from GPU_6\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_6_15 -> collect_6
	distribute_7 [label="Distribute to GPU_7\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_7_0 [label="Attention GPU_7_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_0 [label="Gate GPU_7_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_0 [label="Expert GPU_7_L0\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_0 [label="Aggregate GPU_7_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_7 -> attention_7_0
	attention_7_0 -> gate_7_0
	gate_7_0 -> expert_7_0
	expert_7_0 -> aggregate_7_0
	attention_7_1 [label="Attention GPU_7_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_1 [label="Gate GPU_7_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_1 [label="Expert GPU_7_L1\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_1 [label="Aggregate GPU_7_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_0 -> attention_7_1
	attention_7_1 -> gate_7_1
	gate_7_1 -> expert_7_1
	expert_7_1 -> aggregate_7_1
	attention_7_2 [label="Attention GPU_7_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_2 [label="Gate GPU_7_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_2 [label="Expert GPU_7_L2\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_2 [label="Aggregate GPU_7_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_1 -> attention_7_2
	attention_7_2 -> gate_7_2
	gate_7_2 -> expert_7_2
	expert_7_2 -> aggregate_7_2
	attention_7_3 [label="Attention GPU_7_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_3 [label="Gate GPU_7_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_3 [label="Expert GPU_7_L3\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_3 [label="Aggregate GPU_7_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_2 -> attention_7_3
	attention_7_3 -> gate_7_3
	gate_7_3 -> expert_7_3
	expert_7_3 -> aggregate_7_3
	attention_7_4 [label="Attention GPU_7_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_4 [label="Gate GPU_7_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_4 [label="Expert GPU_7_L4\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_4 [label="Aggregate GPU_7_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_3 -> attention_7_4
	attention_7_4 -> gate_7_4
	gate_7_4 -> expert_7_4
	expert_7_4 -> aggregate_7_4
	attention_7_5 [label="Attention GPU_7_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_5 [label="Gate GPU_7_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_5 [label="Expert GPU_7_L5\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_5 [label="Aggregate GPU_7_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_4 -> attention_7_5
	attention_7_5 -> gate_7_5
	gate_7_5 -> expert_7_5
	expert_7_5 -> aggregate_7_5
	attention_7_6 [label="Attention GPU_7_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_6 [label="Gate GPU_7_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_6 [label="Expert GPU_7_L6\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_6 [label="Aggregate GPU_7_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_5 -> attention_7_6
	attention_7_6 -> gate_7_6
	gate_7_6 -> expert_7_6
	expert_7_6 -> aggregate_7_6
	attention_7_7 [label="Attention GPU_7_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_7 [label="Gate GPU_7_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_7 [label="Expert GPU_7_L7\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_7 [label="Aggregate GPU_7_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_6 -> attention_7_7
	attention_7_7 -> gate_7_7
	gate_7_7 -> expert_7_7
	expert_7_7 -> aggregate_7_7
	attention_7_8 [label="Attention GPU_7_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_8 [label="Gate GPU_7_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_8 [label="Expert GPU_7_L8\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_8 [label="Aggregate GPU_7_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_7 -> attention_7_8
	attention_7_8 -> gate_7_8
	gate_7_8 -> expert_7_8
	expert_7_8 -> aggregate_7_8
	attention_7_9 [label="Attention GPU_7_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_9 [label="Gate GPU_7_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_9 [label="Expert GPU_7_L9\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_9 [label="Aggregate GPU_7_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_8 -> attention_7_9
	attention_7_9 -> gate_7_9
	gate_7_9 -> expert_7_9
	expert_7_9 -> aggregate_7_9
	attention_7_10 [label="Attention GPU_7_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_10 [label="Gate GPU_7_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_10 [label="Expert GPU_7_L10\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_10 [label="Aggregate GPU_7_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_9 -> attention_7_10
	attention_7_10 -> gate_7_10
	gate_7_10 -> expert_7_10
	expert_7_10 -> aggregate_7_10
	attention_7_11 [label="Attention GPU_7_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_11 [label="Gate GPU_7_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_11 [label="Expert GPU_7_L11\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_11 [label="Aggregate GPU_7_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_10 -> attention_7_11
	attention_7_11 -> gate_7_11
	gate_7_11 -> expert_7_11
	expert_7_11 -> aggregate_7_11
	attention_7_12 [label="Attention GPU_7_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_12 [label="Gate GPU_7_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_12 [label="Expert GPU_7_L12\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_12 [label="Aggregate GPU_7_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_11 -> attention_7_12
	attention_7_12 -> gate_7_12
	gate_7_12 -> expert_7_12
	expert_7_12 -> aggregate_7_12
	attention_7_13 [label="Attention GPU_7_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_13 [label="Gate GPU_7_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_13 [label="Expert GPU_7_L13\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_13 [label="Aggregate GPU_7_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_12 -> attention_7_13
	attention_7_13 -> gate_7_13
	gate_7_13 -> expert_7_13
	expert_7_13 -> aggregate_7_13
	attention_7_14 [label="Attention GPU_7_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_14 [label="Gate GPU_7_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_14 [label="Expert GPU_7_L14\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_14 [label="Aggregate GPU_7_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_13 -> attention_7_14
	attention_7_14 -> gate_7_14
	gate_7_14 -> expert_7_14
	expert_7_14 -> aggregate_7_14
	attention_7_15 [label="Attention GPU_7_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_7_15 [label="Gate GPU_7_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_7_15 [label="Expert GPU_7_L15\nExpert ID=7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_7_15 [label="Aggregate GPU_7_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_14 -> attention_7_15
	attention_7_15 -> gate_7_15
	gate_7_15 -> expert_7_15
	expert_7_15 -> aggregate_7_15
	collect_7 [label="Collect from GPU_7\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_7_15 -> collect_7
	distribute_8 [label="Distribute to GPU_8\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_8_0 [label="Attention GPU_8_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_0 [label="Gate GPU_8_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_0 [label="Expert GPU_8_L0\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_0 [label="Aggregate GPU_8_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_8 -> attention_8_0
	attention_8_0 -> gate_8_0
	gate_8_0 -> expert_8_0
	expert_8_0 -> aggregate_8_0
	attention_8_1 [label="Attention GPU_8_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_1 [label="Gate GPU_8_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_1 [label="Expert GPU_8_L1\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_1 [label="Aggregate GPU_8_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_0 -> attention_8_1
	attention_8_1 -> gate_8_1
	gate_8_1 -> expert_8_1
	expert_8_1 -> aggregate_8_1
	attention_8_2 [label="Attention GPU_8_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_2 [label="Gate GPU_8_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_2 [label="Expert GPU_8_L2\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_2 [label="Aggregate GPU_8_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_1 -> attention_8_2
	attention_8_2 -> gate_8_2
	gate_8_2 -> expert_8_2
	expert_8_2 -> aggregate_8_2
	attention_8_3 [label="Attention GPU_8_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_3 [label="Gate GPU_8_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_3 [label="Expert GPU_8_L3\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_3 [label="Aggregate GPU_8_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_2 -> attention_8_3
	attention_8_3 -> gate_8_3
	gate_8_3 -> expert_8_3
	expert_8_3 -> aggregate_8_3
	attention_8_4 [label="Attention GPU_8_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_4 [label="Gate GPU_8_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_4 [label="Expert GPU_8_L4\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_4 [label="Aggregate GPU_8_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_3 -> attention_8_4
	attention_8_4 -> gate_8_4
	gate_8_4 -> expert_8_4
	expert_8_4 -> aggregate_8_4
	attention_8_5 [label="Attention GPU_8_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_5 [label="Gate GPU_8_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_5 [label="Expert GPU_8_L5\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_5 [label="Aggregate GPU_8_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_4 -> attention_8_5
	attention_8_5 -> gate_8_5
	gate_8_5 -> expert_8_5
	expert_8_5 -> aggregate_8_5
	attention_8_6 [label="Attention GPU_8_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_6 [label="Gate GPU_8_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_6 [label="Expert GPU_8_L6\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_6 [label="Aggregate GPU_8_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_5 -> attention_8_6
	attention_8_6 -> gate_8_6
	gate_8_6 -> expert_8_6
	expert_8_6 -> aggregate_8_6
	attention_8_7 [label="Attention GPU_8_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_7 [label="Gate GPU_8_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_7 [label="Expert GPU_8_L7\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_7 [label="Aggregate GPU_8_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_6 -> attention_8_7
	attention_8_7 -> gate_8_7
	gate_8_7 -> expert_8_7
	expert_8_7 -> aggregate_8_7
	attention_8_8 [label="Attention GPU_8_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_8 [label="Gate GPU_8_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_8 [label="Expert GPU_8_L8\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_8 [label="Aggregate GPU_8_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_7 -> attention_8_8
	attention_8_8 -> gate_8_8
	gate_8_8 -> expert_8_8
	expert_8_8 -> aggregate_8_8
	attention_8_9 [label="Attention GPU_8_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_9 [label="Gate GPU_8_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_9 [label="Expert GPU_8_L9\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_9 [label="Aggregate GPU_8_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_8 -> attention_8_9
	attention_8_9 -> gate_8_9
	gate_8_9 -> expert_8_9
	expert_8_9 -> aggregate_8_9
	attention_8_10 [label="Attention GPU_8_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_10 [label="Gate GPU_8_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_10 [label="Expert GPU_8_L10\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_10 [label="Aggregate GPU_8_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_9 -> attention_8_10
	attention_8_10 -> gate_8_10
	gate_8_10 -> expert_8_10
	expert_8_10 -> aggregate_8_10
	attention_8_11 [label="Attention GPU_8_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_11 [label="Gate GPU_8_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_11 [label="Expert GPU_8_L11\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_11 [label="Aggregate GPU_8_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_10 -> attention_8_11
	attention_8_11 -> gate_8_11
	gate_8_11 -> expert_8_11
	expert_8_11 -> aggregate_8_11
	attention_8_12 [label="Attention GPU_8_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_12 [label="Gate GPU_8_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_12 [label="Expert GPU_8_L12\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_12 [label="Aggregate GPU_8_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_11 -> attention_8_12
	attention_8_12 -> gate_8_12
	gate_8_12 -> expert_8_12
	expert_8_12 -> aggregate_8_12
	attention_8_13 [label="Attention GPU_8_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_13 [label="Gate GPU_8_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_13 [label="Expert GPU_8_L13\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_13 [label="Aggregate GPU_8_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_12 -> attention_8_13
	attention_8_13 -> gate_8_13
	gate_8_13 -> expert_8_13
	expert_8_13 -> aggregate_8_13
	attention_8_14 [label="Attention GPU_8_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_14 [label="Gate GPU_8_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_14 [label="Expert GPU_8_L14\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_14 [label="Aggregate GPU_8_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_13 -> attention_8_14
	attention_8_14 -> gate_8_14
	gate_8_14 -> expert_8_14
	expert_8_14 -> aggregate_8_14
	attention_8_15 [label="Attention GPU_8_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_8_15 [label="Gate GPU_8_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_8_15 [label="Expert GPU_8_L15\nExpert ID=8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_8_15 [label="Aggregate GPU_8_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_14 -> attention_8_15
	attention_8_15 -> gate_8_15
	gate_8_15 -> expert_8_15
	expert_8_15 -> aggregate_8_15
	collect_8 [label="Collect from GPU_8\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_8_15 -> collect_8
	distribute_9 [label="Distribute to GPU_9\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_9_0 [label="Attention GPU_9_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_0 [label="Gate GPU_9_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_0 [label="Expert GPU_9_L0\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_0 [label="Aggregate GPU_9_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_9 -> attention_9_0
	attention_9_0 -> gate_9_0
	gate_9_0 -> expert_9_0
	expert_9_0 -> aggregate_9_0
	attention_9_1 [label="Attention GPU_9_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_1 [label="Gate GPU_9_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_1 [label="Expert GPU_9_L1\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_1 [label="Aggregate GPU_9_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_0 -> attention_9_1
	attention_9_1 -> gate_9_1
	gate_9_1 -> expert_9_1
	expert_9_1 -> aggregate_9_1
	attention_9_2 [label="Attention GPU_9_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_2 [label="Gate GPU_9_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_2 [label="Expert GPU_9_L2\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_2 [label="Aggregate GPU_9_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_1 -> attention_9_2
	attention_9_2 -> gate_9_2
	gate_9_2 -> expert_9_2
	expert_9_2 -> aggregate_9_2
	attention_9_3 [label="Attention GPU_9_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_3 [label="Gate GPU_9_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_3 [label="Expert GPU_9_L3\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_3 [label="Aggregate GPU_9_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_2 -> attention_9_3
	attention_9_3 -> gate_9_3
	gate_9_3 -> expert_9_3
	expert_9_3 -> aggregate_9_3
	attention_9_4 [label="Attention GPU_9_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_4 [label="Gate GPU_9_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_4 [label="Expert GPU_9_L4\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_4 [label="Aggregate GPU_9_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_3 -> attention_9_4
	attention_9_4 -> gate_9_4
	gate_9_4 -> expert_9_4
	expert_9_4 -> aggregate_9_4
	attention_9_5 [label="Attention GPU_9_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_5 [label="Gate GPU_9_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_5 [label="Expert GPU_9_L5\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_5 [label="Aggregate GPU_9_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_4 -> attention_9_5
	attention_9_5 -> gate_9_5
	gate_9_5 -> expert_9_5
	expert_9_5 -> aggregate_9_5
	attention_9_6 [label="Attention GPU_9_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_6 [label="Gate GPU_9_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_6 [label="Expert GPU_9_L6\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_6 [label="Aggregate GPU_9_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_5 -> attention_9_6
	attention_9_6 -> gate_9_6
	gate_9_6 -> expert_9_6
	expert_9_6 -> aggregate_9_6
	attention_9_7 [label="Attention GPU_9_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_7 [label="Gate GPU_9_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_7 [label="Expert GPU_9_L7\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_7 [label="Aggregate GPU_9_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_6 -> attention_9_7
	attention_9_7 -> gate_9_7
	gate_9_7 -> expert_9_7
	expert_9_7 -> aggregate_9_7
	attention_9_8 [label="Attention GPU_9_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_8 [label="Gate GPU_9_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_8 [label="Expert GPU_9_L8\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_8 [label="Aggregate GPU_9_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_7 -> attention_9_8
	attention_9_8 -> gate_9_8
	gate_9_8 -> expert_9_8
	expert_9_8 -> aggregate_9_8
	attention_9_9 [label="Attention GPU_9_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_9 [label="Gate GPU_9_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_9 [label="Expert GPU_9_L9\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_9 [label="Aggregate GPU_9_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_8 -> attention_9_9
	attention_9_9 -> gate_9_9
	gate_9_9 -> expert_9_9
	expert_9_9 -> aggregate_9_9
	attention_9_10 [label="Attention GPU_9_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_10 [label="Gate GPU_9_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_10 [label="Expert GPU_9_L10\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_10 [label="Aggregate GPU_9_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_9 -> attention_9_10
	attention_9_10 -> gate_9_10
	gate_9_10 -> expert_9_10
	expert_9_10 -> aggregate_9_10
	attention_9_11 [label="Attention GPU_9_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_11 [label="Gate GPU_9_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_11 [label="Expert GPU_9_L11\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_11 [label="Aggregate GPU_9_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_10 -> attention_9_11
	attention_9_11 -> gate_9_11
	gate_9_11 -> expert_9_11
	expert_9_11 -> aggregate_9_11
	attention_9_12 [label="Attention GPU_9_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_12 [label="Gate GPU_9_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_12 [label="Expert GPU_9_L12\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_12 [label="Aggregate GPU_9_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_11 -> attention_9_12
	attention_9_12 -> gate_9_12
	gate_9_12 -> expert_9_12
	expert_9_12 -> aggregate_9_12
	attention_9_13 [label="Attention GPU_9_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_13 [label="Gate GPU_9_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_13 [label="Expert GPU_9_L13\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_13 [label="Aggregate GPU_9_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_12 -> attention_9_13
	attention_9_13 -> gate_9_13
	gate_9_13 -> expert_9_13
	expert_9_13 -> aggregate_9_13
	attention_9_14 [label="Attention GPU_9_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_14 [label="Gate GPU_9_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_14 [label="Expert GPU_9_L14\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_14 [label="Aggregate GPU_9_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_13 -> attention_9_14
	attention_9_14 -> gate_9_14
	gate_9_14 -> expert_9_14
	expert_9_14 -> aggregate_9_14
	attention_9_15 [label="Attention GPU_9_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_9_15 [label="Gate GPU_9_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_9_15 [label="Expert GPU_9_L15\nExpert ID=9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_9_15 [label="Aggregate GPU_9_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_14 -> attention_9_15
	attention_9_15 -> gate_9_15
	gate_9_15 -> expert_9_15
	expert_9_15 -> aggregate_9_15
	collect_9 [label="Collect from GPU_9\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_9_15 -> collect_9
	distribute_10 [label="Distribute to GPU_10\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_10_0 [label="Attention GPU_10_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_0 [label="Gate GPU_10_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_0 [label="Expert GPU_10_L0\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_0 [label="Aggregate GPU_10_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_10 -> attention_10_0
	attention_10_0 -> gate_10_0
	gate_10_0 -> expert_10_0
	expert_10_0 -> aggregate_10_0
	attention_10_1 [label="Attention GPU_10_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_1 [label="Gate GPU_10_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_1 [label="Expert GPU_10_L1\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_1 [label="Aggregate GPU_10_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_0 -> attention_10_1
	attention_10_1 -> gate_10_1
	gate_10_1 -> expert_10_1
	expert_10_1 -> aggregate_10_1
	attention_10_2 [label="Attention GPU_10_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_2 [label="Gate GPU_10_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_2 [label="Expert GPU_10_L2\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_2 [label="Aggregate GPU_10_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_1 -> attention_10_2
	attention_10_2 -> gate_10_2
	gate_10_2 -> expert_10_2
	expert_10_2 -> aggregate_10_2
	attention_10_3 [label="Attention GPU_10_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_3 [label="Gate GPU_10_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_3 [label="Expert GPU_10_L3\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_3 [label="Aggregate GPU_10_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_2 -> attention_10_3
	attention_10_3 -> gate_10_3
	gate_10_3 -> expert_10_3
	expert_10_3 -> aggregate_10_3
	attention_10_4 [label="Attention GPU_10_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_4 [label="Gate GPU_10_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_4 [label="Expert GPU_10_L4\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_4 [label="Aggregate GPU_10_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_3 -> attention_10_4
	attention_10_4 -> gate_10_4
	gate_10_4 -> expert_10_4
	expert_10_4 -> aggregate_10_4
	attention_10_5 [label="Attention GPU_10_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_5 [label="Gate GPU_10_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_5 [label="Expert GPU_10_L5\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_5 [label="Aggregate GPU_10_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_4 -> attention_10_5
	attention_10_5 -> gate_10_5
	gate_10_5 -> expert_10_5
	expert_10_5 -> aggregate_10_5
	attention_10_6 [label="Attention GPU_10_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_6 [label="Gate GPU_10_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_6 [label="Expert GPU_10_L6\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_6 [label="Aggregate GPU_10_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_5 -> attention_10_6
	attention_10_6 -> gate_10_6
	gate_10_6 -> expert_10_6
	expert_10_6 -> aggregate_10_6
	attention_10_7 [label="Attention GPU_10_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_7 [label="Gate GPU_10_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_7 [label="Expert GPU_10_L7\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_7 [label="Aggregate GPU_10_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_6 -> attention_10_7
	attention_10_7 -> gate_10_7
	gate_10_7 -> expert_10_7
	expert_10_7 -> aggregate_10_7
	attention_10_8 [label="Attention GPU_10_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_8 [label="Gate GPU_10_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_8 [label="Expert GPU_10_L8\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_8 [label="Aggregate GPU_10_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_7 -> attention_10_8
	attention_10_8 -> gate_10_8
	gate_10_8 -> expert_10_8
	expert_10_8 -> aggregate_10_8
	attention_10_9 [label="Attention GPU_10_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_9 [label="Gate GPU_10_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_9 [label="Expert GPU_10_L9\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_9 [label="Aggregate GPU_10_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_8 -> attention_10_9
	attention_10_9 -> gate_10_9
	gate_10_9 -> expert_10_9
	expert_10_9 -> aggregate_10_9
	attention_10_10 [label="Attention GPU_10_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_10 [label="Gate GPU_10_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_10 [label="Expert GPU_10_L10\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_10 [label="Aggregate GPU_10_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_9 -> attention_10_10
	attention_10_10 -> gate_10_10
	gate_10_10 -> expert_10_10
	expert_10_10 -> aggregate_10_10
	attention_10_11 [label="Attention GPU_10_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_11 [label="Gate GPU_10_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_11 [label="Expert GPU_10_L11\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_11 [label="Aggregate GPU_10_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_10 -> attention_10_11
	attention_10_11 -> gate_10_11
	gate_10_11 -> expert_10_11
	expert_10_11 -> aggregate_10_11
	attention_10_12 [label="Attention GPU_10_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_12 [label="Gate GPU_10_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_12 [label="Expert GPU_10_L12\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_12 [label="Aggregate GPU_10_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_11 -> attention_10_12
	attention_10_12 -> gate_10_12
	gate_10_12 -> expert_10_12
	expert_10_12 -> aggregate_10_12
	attention_10_13 [label="Attention GPU_10_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_13 [label="Gate GPU_10_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_13 [label="Expert GPU_10_L13\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_13 [label="Aggregate GPU_10_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_12 -> attention_10_13
	attention_10_13 -> gate_10_13
	gate_10_13 -> expert_10_13
	expert_10_13 -> aggregate_10_13
	attention_10_14 [label="Attention GPU_10_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_14 [label="Gate GPU_10_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_14 [label="Expert GPU_10_L14\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_14 [label="Aggregate GPU_10_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_13 -> attention_10_14
	attention_10_14 -> gate_10_14
	gate_10_14 -> expert_10_14
	expert_10_14 -> aggregate_10_14
	attention_10_15 [label="Attention GPU_10_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_10_15 [label="Gate GPU_10_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_10_15 [label="Expert GPU_10_L15\nExpert ID=10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_10_15 [label="Aggregate GPU_10_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_14 -> attention_10_15
	attention_10_15 -> gate_10_15
	gate_10_15 -> expert_10_15
	expert_10_15 -> aggregate_10_15
	collect_10 [label="Collect from GPU_10\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_10_15 -> collect_10
	distribute_11 [label="Distribute to GPU_11\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_11_0 [label="Attention GPU_11_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_0 [label="Gate GPU_11_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_0 [label="Expert GPU_11_L0\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_0 [label="Aggregate GPU_11_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_11 -> attention_11_0
	attention_11_0 -> gate_11_0
	gate_11_0 -> expert_11_0
	expert_11_0 -> aggregate_11_0
	attention_11_1 [label="Attention GPU_11_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_1 [label="Gate GPU_11_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_1 [label="Expert GPU_11_L1\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_1 [label="Aggregate GPU_11_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_0 -> attention_11_1
	attention_11_1 -> gate_11_1
	gate_11_1 -> expert_11_1
	expert_11_1 -> aggregate_11_1
	attention_11_2 [label="Attention GPU_11_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_2 [label="Gate GPU_11_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_2 [label="Expert GPU_11_L2\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_2 [label="Aggregate GPU_11_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_1 -> attention_11_2
	attention_11_2 -> gate_11_2
	gate_11_2 -> expert_11_2
	expert_11_2 -> aggregate_11_2
	attention_11_3 [label="Attention GPU_11_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_3 [label="Gate GPU_11_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_3 [label="Expert GPU_11_L3\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_3 [label="Aggregate GPU_11_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_2 -> attention_11_3
	attention_11_3 -> gate_11_3
	gate_11_3 -> expert_11_3
	expert_11_3 -> aggregate_11_3
	attention_11_4 [label="Attention GPU_11_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_4 [label="Gate GPU_11_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_4 [label="Expert GPU_11_L4\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_4 [label="Aggregate GPU_11_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_3 -> attention_11_4
	attention_11_4 -> gate_11_4
	gate_11_4 -> expert_11_4
	expert_11_4 -> aggregate_11_4
	attention_11_5 [label="Attention GPU_11_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_5 [label="Gate GPU_11_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_5 [label="Expert GPU_11_L5\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_5 [label="Aggregate GPU_11_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_4 -> attention_11_5
	attention_11_5 -> gate_11_5
	gate_11_5 -> expert_11_5
	expert_11_5 -> aggregate_11_5
	attention_11_6 [label="Attention GPU_11_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_6 [label="Gate GPU_11_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_6 [label="Expert GPU_11_L6\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_6 [label="Aggregate GPU_11_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_5 -> attention_11_6
	attention_11_6 -> gate_11_6
	gate_11_6 -> expert_11_6
	expert_11_6 -> aggregate_11_6
	attention_11_7 [label="Attention GPU_11_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_7 [label="Gate GPU_11_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_7 [label="Expert GPU_11_L7\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_7 [label="Aggregate GPU_11_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_6 -> attention_11_7
	attention_11_7 -> gate_11_7
	gate_11_7 -> expert_11_7
	expert_11_7 -> aggregate_11_7
	attention_11_8 [label="Attention GPU_11_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_8 [label="Gate GPU_11_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_8 [label="Expert GPU_11_L8\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_8 [label="Aggregate GPU_11_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_7 -> attention_11_8
	attention_11_8 -> gate_11_8
	gate_11_8 -> expert_11_8
	expert_11_8 -> aggregate_11_8
	attention_11_9 [label="Attention GPU_11_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_9 [label="Gate GPU_11_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_9 [label="Expert GPU_11_L9\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_9 [label="Aggregate GPU_11_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_8 -> attention_11_9
	attention_11_9 -> gate_11_9
	gate_11_9 -> expert_11_9
	expert_11_9 -> aggregate_11_9
	attention_11_10 [label="Attention GPU_11_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_10 [label="Gate GPU_11_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_10 [label="Expert GPU_11_L10\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_10 [label="Aggregate GPU_11_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_9 -> attention_11_10
	attention_11_10 -> gate_11_10
	gate_11_10 -> expert_11_10
	expert_11_10 -> aggregate_11_10
	attention_11_11 [label="Attention GPU_11_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_11 [label="Gate GPU_11_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_11 [label="Expert GPU_11_L11\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_11 [label="Aggregate GPU_11_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_10 -> attention_11_11
	attention_11_11 -> gate_11_11
	gate_11_11 -> expert_11_11
	expert_11_11 -> aggregate_11_11
	attention_11_12 [label="Attention GPU_11_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_12 [label="Gate GPU_11_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_12 [label="Expert GPU_11_L12\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_12 [label="Aggregate GPU_11_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_11 -> attention_11_12
	attention_11_12 -> gate_11_12
	gate_11_12 -> expert_11_12
	expert_11_12 -> aggregate_11_12
	attention_11_13 [label="Attention GPU_11_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_13 [label="Gate GPU_11_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_13 [label="Expert GPU_11_L13\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_13 [label="Aggregate GPU_11_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_12 -> attention_11_13
	attention_11_13 -> gate_11_13
	gate_11_13 -> expert_11_13
	expert_11_13 -> aggregate_11_13
	attention_11_14 [label="Attention GPU_11_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_14 [label="Gate GPU_11_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_14 [label="Expert GPU_11_L14\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_14 [label="Aggregate GPU_11_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_13 -> attention_11_14
	attention_11_14 -> gate_11_14
	gate_11_14 -> expert_11_14
	expert_11_14 -> aggregate_11_14
	attention_11_15 [label="Attention GPU_11_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_11_15 [label="Gate GPU_11_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_11_15 [label="Expert GPU_11_L15\nExpert ID=11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_11_15 [label="Aggregate GPU_11_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_14 -> attention_11_15
	attention_11_15 -> gate_11_15
	gate_11_15 -> expert_11_15
	expert_11_15 -> aggregate_11_15
	collect_11 [label="Collect from GPU_11\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_11_15 -> collect_11
	distribute_12 [label="Distribute to GPU_12\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_12_0 [label="Attention GPU_12_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_0 [label="Gate GPU_12_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_0 [label="Expert GPU_12_L0\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_0 [label="Aggregate GPU_12_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_12 -> attention_12_0
	attention_12_0 -> gate_12_0
	gate_12_0 -> expert_12_0
	expert_12_0 -> aggregate_12_0
	attention_12_1 [label="Attention GPU_12_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_1 [label="Gate GPU_12_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_1 [label="Expert GPU_12_L1\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_1 [label="Aggregate GPU_12_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_0 -> attention_12_1
	attention_12_1 -> gate_12_1
	gate_12_1 -> expert_12_1
	expert_12_1 -> aggregate_12_1
	attention_12_2 [label="Attention GPU_12_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_2 [label="Gate GPU_12_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_2 [label="Expert GPU_12_L2\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_2 [label="Aggregate GPU_12_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_1 -> attention_12_2
	attention_12_2 -> gate_12_2
	gate_12_2 -> expert_12_2
	expert_12_2 -> aggregate_12_2
	attention_12_3 [label="Attention GPU_12_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_3 [label="Gate GPU_12_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_3 [label="Expert GPU_12_L3\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_3 [label="Aggregate GPU_12_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_2 -> attention_12_3
	attention_12_3 -> gate_12_3
	gate_12_3 -> expert_12_3
	expert_12_3 -> aggregate_12_3
	attention_12_4 [label="Attention GPU_12_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_4 [label="Gate GPU_12_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_4 [label="Expert GPU_12_L4\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_4 [label="Aggregate GPU_12_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_3 -> attention_12_4
	attention_12_4 -> gate_12_4
	gate_12_4 -> expert_12_4
	expert_12_4 -> aggregate_12_4
	attention_12_5 [label="Attention GPU_12_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_5 [label="Gate GPU_12_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_5 [label="Expert GPU_12_L5\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_5 [label="Aggregate GPU_12_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_4 -> attention_12_5
	attention_12_5 -> gate_12_5
	gate_12_5 -> expert_12_5
	expert_12_5 -> aggregate_12_5
	attention_12_6 [label="Attention GPU_12_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_6 [label="Gate GPU_12_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_6 [label="Expert GPU_12_L6\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_6 [label="Aggregate GPU_12_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_5 -> attention_12_6
	attention_12_6 -> gate_12_6
	gate_12_6 -> expert_12_6
	expert_12_6 -> aggregate_12_6
	attention_12_7 [label="Attention GPU_12_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_7 [label="Gate GPU_12_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_7 [label="Expert GPU_12_L7\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_7 [label="Aggregate GPU_12_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_6 -> attention_12_7
	attention_12_7 -> gate_12_7
	gate_12_7 -> expert_12_7
	expert_12_7 -> aggregate_12_7
	attention_12_8 [label="Attention GPU_12_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_8 [label="Gate GPU_12_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_8 [label="Expert GPU_12_L8\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_8 [label="Aggregate GPU_12_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_7 -> attention_12_8
	attention_12_8 -> gate_12_8
	gate_12_8 -> expert_12_8
	expert_12_8 -> aggregate_12_8
	attention_12_9 [label="Attention GPU_12_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_9 [label="Gate GPU_12_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_9 [label="Expert GPU_12_L9\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_9 [label="Aggregate GPU_12_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_8 -> attention_12_9
	attention_12_9 -> gate_12_9
	gate_12_9 -> expert_12_9
	expert_12_9 -> aggregate_12_9
	attention_12_10 [label="Attention GPU_12_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_10 [label="Gate GPU_12_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_10 [label="Expert GPU_12_L10\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_10 [label="Aggregate GPU_12_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_9 -> attention_12_10
	attention_12_10 -> gate_12_10
	gate_12_10 -> expert_12_10
	expert_12_10 -> aggregate_12_10
	attention_12_11 [label="Attention GPU_12_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_11 [label="Gate GPU_12_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_11 [label="Expert GPU_12_L11\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_11 [label="Aggregate GPU_12_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_10 -> attention_12_11
	attention_12_11 -> gate_12_11
	gate_12_11 -> expert_12_11
	expert_12_11 -> aggregate_12_11
	attention_12_12 [label="Attention GPU_12_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_12 [label="Gate GPU_12_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_12 [label="Expert GPU_12_L12\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_12 [label="Aggregate GPU_12_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_11 -> attention_12_12
	attention_12_12 -> gate_12_12
	gate_12_12 -> expert_12_12
	expert_12_12 -> aggregate_12_12
	attention_12_13 [label="Attention GPU_12_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_13 [label="Gate GPU_12_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_13 [label="Expert GPU_12_L13\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_13 [label="Aggregate GPU_12_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_12 -> attention_12_13
	attention_12_13 -> gate_12_13
	gate_12_13 -> expert_12_13
	expert_12_13 -> aggregate_12_13
	attention_12_14 [label="Attention GPU_12_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_14 [label="Gate GPU_12_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_14 [label="Expert GPU_12_L14\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_14 [label="Aggregate GPU_12_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_13 -> attention_12_14
	attention_12_14 -> gate_12_14
	gate_12_14 -> expert_12_14
	expert_12_14 -> aggregate_12_14
	attention_12_15 [label="Attention GPU_12_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_12_15 [label="Gate GPU_12_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_12_15 [label="Expert GPU_12_L15\nExpert ID=12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_12_15 [label="Aggregate GPU_12_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_14 -> attention_12_15
	attention_12_15 -> gate_12_15
	gate_12_15 -> expert_12_15
	expert_12_15 -> aggregate_12_15
	collect_12 [label="Collect from GPU_12\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_12_15 -> collect_12
	distribute_13 [label="Distribute to GPU_13\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_13_0 [label="Attention GPU_13_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_0 [label="Gate GPU_13_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_0 [label="Expert GPU_13_L0\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_0 [label="Aggregate GPU_13_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_13 -> attention_13_0
	attention_13_0 -> gate_13_0
	gate_13_0 -> expert_13_0
	expert_13_0 -> aggregate_13_0
	attention_13_1 [label="Attention GPU_13_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_1 [label="Gate GPU_13_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_1 [label="Expert GPU_13_L1\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_1 [label="Aggregate GPU_13_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_0 -> attention_13_1
	attention_13_1 -> gate_13_1
	gate_13_1 -> expert_13_1
	expert_13_1 -> aggregate_13_1
	attention_13_2 [label="Attention GPU_13_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_2 [label="Gate GPU_13_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_2 [label="Expert GPU_13_L2\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_2 [label="Aggregate GPU_13_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_1 -> attention_13_2
	attention_13_2 -> gate_13_2
	gate_13_2 -> expert_13_2
	expert_13_2 -> aggregate_13_2
	attention_13_3 [label="Attention GPU_13_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_3 [label="Gate GPU_13_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_3 [label="Expert GPU_13_L3\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_3 [label="Aggregate GPU_13_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_2 -> attention_13_3
	attention_13_3 -> gate_13_3
	gate_13_3 -> expert_13_3
	expert_13_3 -> aggregate_13_3
	attention_13_4 [label="Attention GPU_13_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_4 [label="Gate GPU_13_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_4 [label="Expert GPU_13_L4\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_4 [label="Aggregate GPU_13_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_3 -> attention_13_4
	attention_13_4 -> gate_13_4
	gate_13_4 -> expert_13_4
	expert_13_4 -> aggregate_13_4
	attention_13_5 [label="Attention GPU_13_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_5 [label="Gate GPU_13_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_5 [label="Expert GPU_13_L5\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_5 [label="Aggregate GPU_13_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_4 -> attention_13_5
	attention_13_5 -> gate_13_5
	gate_13_5 -> expert_13_5
	expert_13_5 -> aggregate_13_5
	attention_13_6 [label="Attention GPU_13_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_6 [label="Gate GPU_13_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_6 [label="Expert GPU_13_L6\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_6 [label="Aggregate GPU_13_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_5 -> attention_13_6
	attention_13_6 -> gate_13_6
	gate_13_6 -> expert_13_6
	expert_13_6 -> aggregate_13_6
	attention_13_7 [label="Attention GPU_13_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_7 [label="Gate GPU_13_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_7 [label="Expert GPU_13_L7\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_7 [label="Aggregate GPU_13_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_6 -> attention_13_7
	attention_13_7 -> gate_13_7
	gate_13_7 -> expert_13_7
	expert_13_7 -> aggregate_13_7
	attention_13_8 [label="Attention GPU_13_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_8 [label="Gate GPU_13_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_8 [label="Expert GPU_13_L8\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_8 [label="Aggregate GPU_13_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_7 -> attention_13_8
	attention_13_8 -> gate_13_8
	gate_13_8 -> expert_13_8
	expert_13_8 -> aggregate_13_8
	attention_13_9 [label="Attention GPU_13_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_9 [label="Gate GPU_13_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_9 [label="Expert GPU_13_L9\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_9 [label="Aggregate GPU_13_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_8 -> attention_13_9
	attention_13_9 -> gate_13_9
	gate_13_9 -> expert_13_9
	expert_13_9 -> aggregate_13_9
	attention_13_10 [label="Attention GPU_13_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_10 [label="Gate GPU_13_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_10 [label="Expert GPU_13_L10\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_10 [label="Aggregate GPU_13_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_9 -> attention_13_10
	attention_13_10 -> gate_13_10
	gate_13_10 -> expert_13_10
	expert_13_10 -> aggregate_13_10
	attention_13_11 [label="Attention GPU_13_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_11 [label="Gate GPU_13_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_11 [label="Expert GPU_13_L11\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_11 [label="Aggregate GPU_13_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_10 -> attention_13_11
	attention_13_11 -> gate_13_11
	gate_13_11 -> expert_13_11
	expert_13_11 -> aggregate_13_11
	attention_13_12 [label="Attention GPU_13_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_12 [label="Gate GPU_13_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_12 [label="Expert GPU_13_L12\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_12 [label="Aggregate GPU_13_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_11 -> attention_13_12
	attention_13_12 -> gate_13_12
	gate_13_12 -> expert_13_12
	expert_13_12 -> aggregate_13_12
	attention_13_13 [label="Attention GPU_13_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_13 [label="Gate GPU_13_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_13 [label="Expert GPU_13_L13\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_13 [label="Aggregate GPU_13_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_12 -> attention_13_13
	attention_13_13 -> gate_13_13
	gate_13_13 -> expert_13_13
	expert_13_13 -> aggregate_13_13
	attention_13_14 [label="Attention GPU_13_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_14 [label="Gate GPU_13_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_14 [label="Expert GPU_13_L14\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_14 [label="Aggregate GPU_13_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_13 -> attention_13_14
	attention_13_14 -> gate_13_14
	gate_13_14 -> expert_13_14
	expert_13_14 -> aggregate_13_14
	attention_13_15 [label="Attention GPU_13_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_13_15 [label="Gate GPU_13_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_13_15 [label="Expert GPU_13_L15\nExpert ID=13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_13_15 [label="Aggregate GPU_13_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_14 -> attention_13_15
	attention_13_15 -> gate_13_15
	gate_13_15 -> expert_13_15
	expert_13_15 -> aggregate_13_15
	collect_13 [label="Collect from GPU_13\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_13_15 -> collect_13
	distribute_14 [label="Distribute to GPU_14\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_14_0 [label="Attention GPU_14_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_0 [label="Gate GPU_14_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_0 [label="Expert GPU_14_L0\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_0 [label="Aggregate GPU_14_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_14 -> attention_14_0
	attention_14_0 -> gate_14_0
	gate_14_0 -> expert_14_0
	expert_14_0 -> aggregate_14_0
	attention_14_1 [label="Attention GPU_14_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_1 [label="Gate GPU_14_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_1 [label="Expert GPU_14_L1\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_1 [label="Aggregate GPU_14_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_0 -> attention_14_1
	attention_14_1 -> gate_14_1
	gate_14_1 -> expert_14_1
	expert_14_1 -> aggregate_14_1
	attention_14_2 [label="Attention GPU_14_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_2 [label="Gate GPU_14_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_2 [label="Expert GPU_14_L2\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_2 [label="Aggregate GPU_14_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_1 -> attention_14_2
	attention_14_2 -> gate_14_2
	gate_14_2 -> expert_14_2
	expert_14_2 -> aggregate_14_2
	attention_14_3 [label="Attention GPU_14_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_3 [label="Gate GPU_14_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_3 [label="Expert GPU_14_L3\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_3 [label="Aggregate GPU_14_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_2 -> attention_14_3
	attention_14_3 -> gate_14_3
	gate_14_3 -> expert_14_3
	expert_14_3 -> aggregate_14_3
	attention_14_4 [label="Attention GPU_14_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_4 [label="Gate GPU_14_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_4 [label="Expert GPU_14_L4\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_4 [label="Aggregate GPU_14_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_3 -> attention_14_4
	attention_14_4 -> gate_14_4
	gate_14_4 -> expert_14_4
	expert_14_4 -> aggregate_14_4
	attention_14_5 [label="Attention GPU_14_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_5 [label="Gate GPU_14_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_5 [label="Expert GPU_14_L5\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_5 [label="Aggregate GPU_14_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_4 -> attention_14_5
	attention_14_5 -> gate_14_5
	gate_14_5 -> expert_14_5
	expert_14_5 -> aggregate_14_5
	attention_14_6 [label="Attention GPU_14_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_6 [label="Gate GPU_14_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_6 [label="Expert GPU_14_L6\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_6 [label="Aggregate GPU_14_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_5 -> attention_14_6
	attention_14_6 -> gate_14_6
	gate_14_6 -> expert_14_6
	expert_14_6 -> aggregate_14_6
	attention_14_7 [label="Attention GPU_14_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_7 [label="Gate GPU_14_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_7 [label="Expert GPU_14_L7\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_7 [label="Aggregate GPU_14_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_6 -> attention_14_7
	attention_14_7 -> gate_14_7
	gate_14_7 -> expert_14_7
	expert_14_7 -> aggregate_14_7
	attention_14_8 [label="Attention GPU_14_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_8 [label="Gate GPU_14_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_8 [label="Expert GPU_14_L8\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_8 [label="Aggregate GPU_14_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_7 -> attention_14_8
	attention_14_8 -> gate_14_8
	gate_14_8 -> expert_14_8
	expert_14_8 -> aggregate_14_8
	attention_14_9 [label="Attention GPU_14_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_9 [label="Gate GPU_14_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_9 [label="Expert GPU_14_L9\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_9 [label="Aggregate GPU_14_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_8 -> attention_14_9
	attention_14_9 -> gate_14_9
	gate_14_9 -> expert_14_9
	expert_14_9 -> aggregate_14_9
	attention_14_10 [label="Attention GPU_14_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_10 [label="Gate GPU_14_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_10 [label="Expert GPU_14_L10\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_10 [label="Aggregate GPU_14_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_9 -> attention_14_10
	attention_14_10 -> gate_14_10
	gate_14_10 -> expert_14_10
	expert_14_10 -> aggregate_14_10
	attention_14_11 [label="Attention GPU_14_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_11 [label="Gate GPU_14_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_11 [label="Expert GPU_14_L11\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_11 [label="Aggregate GPU_14_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_10 -> attention_14_11
	attention_14_11 -> gate_14_11
	gate_14_11 -> expert_14_11
	expert_14_11 -> aggregate_14_11
	attention_14_12 [label="Attention GPU_14_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_12 [label="Gate GPU_14_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_12 [label="Expert GPU_14_L12\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_12 [label="Aggregate GPU_14_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_11 -> attention_14_12
	attention_14_12 -> gate_14_12
	gate_14_12 -> expert_14_12
	expert_14_12 -> aggregate_14_12
	attention_14_13 [label="Attention GPU_14_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_13 [label="Gate GPU_14_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_13 [label="Expert GPU_14_L13\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_13 [label="Aggregate GPU_14_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_12 -> attention_14_13
	attention_14_13 -> gate_14_13
	gate_14_13 -> expert_14_13
	expert_14_13 -> aggregate_14_13
	attention_14_14 [label="Attention GPU_14_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_14 [label="Gate GPU_14_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_14 [label="Expert GPU_14_L14\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_14 [label="Aggregate GPU_14_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_13 -> attention_14_14
	attention_14_14 -> gate_14_14
	gate_14_14 -> expert_14_14
	expert_14_14 -> aggregate_14_14
	attention_14_15 [label="Attention GPU_14_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_14_15 [label="Gate GPU_14_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_14_15 [label="Expert GPU_14_L15\nExpert ID=14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_14_15 [label="Aggregate GPU_14_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_14 -> attention_14_15
	attention_14_15 -> gate_14_15
	gate_14_15 -> expert_14_15
	expert_14_15 -> aggregate_14_15
	collect_14 [label="Collect from GPU_14\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_14_15 -> collect_14
	distribute_15 [label="Distribute to GPU_15\nInput: [B=128, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	attention_15_0 [label="Attention GPU_15_L0\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_0 [label="Gate GPU_15_L0\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_0 [label="Expert GPU_15_L0\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_0 [label="Aggregate GPU_15_L0\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	distribute_15 -> attention_15_0
	attention_15_0 -> gate_15_0
	gate_15_0 -> expert_15_0
	expert_15_0 -> aggregate_15_0
	attention_15_1 [label="Attention GPU_15_L1\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_1 [label="Gate GPU_15_L1\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_1 [label="Expert GPU_15_L1\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_1 [label="Aggregate GPU_15_L1\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_0 -> attention_15_1
	attention_15_1 -> gate_15_1
	gate_15_1 -> expert_15_1
	expert_15_1 -> aggregate_15_1
	attention_15_2 [label="Attention GPU_15_L2\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_2 [label="Gate GPU_15_L2\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_2 [label="Expert GPU_15_L2\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_2 [label="Aggregate GPU_15_L2\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_1 -> attention_15_2
	attention_15_2 -> gate_15_2
	gate_15_2 -> expert_15_2
	expert_15_2 -> aggregate_15_2
	attention_15_3 [label="Attention GPU_15_L3\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_3 [label="Gate GPU_15_L3\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_3 [label="Expert GPU_15_L3\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_3 [label="Aggregate GPU_15_L3\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_2 -> attention_15_3
	attention_15_3 -> gate_15_3
	gate_15_3 -> expert_15_3
	expert_15_3 -> aggregate_15_3
	attention_15_4 [label="Attention GPU_15_L4\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_4 [label="Gate GPU_15_L4\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_4 [label="Expert GPU_15_L4\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_4 [label="Aggregate GPU_15_L4\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_3 -> attention_15_4
	attention_15_4 -> gate_15_4
	gate_15_4 -> expert_15_4
	expert_15_4 -> aggregate_15_4
	attention_15_5 [label="Attention GPU_15_L5\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_5 [label="Gate GPU_15_L5\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_5 [label="Expert GPU_15_L5\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_5 [label="Aggregate GPU_15_L5\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_4 -> attention_15_5
	attention_15_5 -> gate_15_5
	gate_15_5 -> expert_15_5
	expert_15_5 -> aggregate_15_5
	attention_15_6 [label="Attention GPU_15_L6\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_6 [label="Gate GPU_15_L6\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_6 [label="Expert GPU_15_L6\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_6 [label="Aggregate GPU_15_L6\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_5 -> attention_15_6
	attention_15_6 -> gate_15_6
	gate_15_6 -> expert_15_6
	expert_15_6 -> aggregate_15_6
	attention_15_7 [label="Attention GPU_15_L7\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_7 [label="Gate GPU_15_L7\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_7 [label="Expert GPU_15_L7\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_7 [label="Aggregate GPU_15_L7\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_6 -> attention_15_7
	attention_15_7 -> gate_15_7
	gate_15_7 -> expert_15_7
	expert_15_7 -> aggregate_15_7
	attention_15_8 [label="Attention GPU_15_L8\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_8 [label="Gate GPU_15_L8\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_8 [label="Expert GPU_15_L8\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_8 [label="Aggregate GPU_15_L8\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_7 -> attention_15_8
	attention_15_8 -> gate_15_8
	gate_15_8 -> expert_15_8
	expert_15_8 -> aggregate_15_8
	attention_15_9 [label="Attention GPU_15_L9\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_9 [label="Gate GPU_15_L9\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_9 [label="Expert GPU_15_L9\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_9 [label="Aggregate GPU_15_L9\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_8 -> attention_15_9
	attention_15_9 -> gate_15_9
	gate_15_9 -> expert_15_9
	expert_15_9 -> aggregate_15_9
	attention_15_10 [label="Attention GPU_15_L10\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_10 [label="Gate GPU_15_L10\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_10 [label="Expert GPU_15_L10\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_10 [label="Aggregate GPU_15_L10\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_9 -> attention_15_10
	attention_15_10 -> gate_15_10
	gate_15_10 -> expert_15_10
	expert_15_10 -> aggregate_15_10
	attention_15_11 [label="Attention GPU_15_L11\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_11 [label="Gate GPU_15_L11\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_11 [label="Expert GPU_15_L11\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_11 [label="Aggregate GPU_15_L11\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_10 -> attention_15_11
	attention_15_11 -> gate_15_11
	gate_15_11 -> expert_15_11
	expert_15_11 -> aggregate_15_11
	attention_15_12 [label="Attention GPU_15_L12\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_12 [label="Gate GPU_15_L12\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_12 [label="Expert GPU_15_L12\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_12 [label="Aggregate GPU_15_L12\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_11 -> attention_15_12
	attention_15_12 -> gate_15_12
	gate_15_12 -> expert_15_12
	expert_15_12 -> aggregate_15_12
	attention_15_13 [label="Attention GPU_15_L13\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_13 [label="Gate GPU_15_L13\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_13 [label="Expert GPU_15_L13\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_13 [label="Aggregate GPU_15_L13\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_12 -> attention_15_13
	attention_15_13 -> gate_15_13
	gate_15_13 -> expert_15_13
	expert_15_13 -> aggregate_15_13
	attention_15_14 [label="Attention GPU_15_L14\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_14 [label="Gate GPU_15_L14\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_14 [label="Expert GPU_15_L14\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_14 [label="Aggregate GPU_15_L14\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_13 -> attention_15_14
	attention_15_14 -> gate_15_14
	gate_15_14 -> expert_15_14
	expert_15_14 -> aggregate_15_14
	attention_15_15 [label="Attention GPU_15_L15\nTP=4\nInput: [B=8, S=var, H=16, D=32]\nOutput: [B=8, S=var, H=16, D=32]" fillcolor=lightgreen shape=rectangle]
	gate_15_15 [label="Gate GPU_15_L15\nSelect Top-2 Experts\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	expert_15_15 [label="Expert GPU_15_L15\nExpert ID=15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=1024]" fillcolor=lightgreen shape=rectangle]
	aggregate_15_15 [label="Aggregate GPU_15_L15\nCombine Expert Outputs\nInput: [B=8, S=var, D=1024]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_14 -> attention_15_15
	attention_15_15 -> gate_15_15
	gate_15_15 -> expert_15_15
	expert_15_15 -> aggregate_15_15
	collect_15 [label="Collect from GPU_15\nInput: [B=8, S=var, D=512]\nOutput: [B=8, S=var, D=512]" fillcolor=lightyellow shape=parallelogram]
	aggregate_15_15 -> collect_15
	output [label="Final Output\nBatch Size=128, Seq Len=Variable\nToken Dim=512" fillcolor=lightblue shape=ellipse]
	collect_0 -> output
	collect_1 -> output
	collect_2 -> output
	collect_3 -> output
	collect_4 -> output
	collect_5 -> output
	collect_6 -> output
	collect_7 -> output
	collect_8 -> output
	collect_9 -> output
	collect_10 -> output
	collect_11 -> output
	collect_12 -> output
	collect_13 -> output
	collect_14 -> output
	collect_15 -> output
	gate_0_0 -> expert_0_0 [color=red constraint=false style=dashed]
	gate_0_1 -> expert_0_1 [color=red constraint=false style=dashed]
	gate_0_2 -> expert_0_2 [color=red constraint=false style=dashed]
	gate_0_3 -> expert_0_3 [color=red constraint=false style=dashed]
	gate_0_4 -> expert_0_4 [color=red constraint=false style=dashed]
	gate_0_5 -> expert_0_5 [color=red constraint=false style=dashed]
	gate_0_6 -> expert_0_6 [color=red constraint=false style=dashed]
	gate_0_7 -> expert_0_7 [color=red constraint=false style=dashed]
	gate_0_8 -> expert_0_8 [color=red constraint=false style=dashed]
	gate_0_9 -> expert_0_9 [color=red constraint=false style=dashed]
	gate_0_10 -> expert_0_10 [color=red constraint=false style=dashed]
	gate_0_11 -> expert_0_11 [color=red constraint=false style=dashed]
	gate_0_12 -> expert_0_12 [color=red constraint=false style=dashed]
	gate_0_13 -> expert_0_13 [color=red constraint=false style=dashed]
	gate_0_14 -> expert_0_14 [color=red constraint=false style=dashed]
	gate_0_15 -> expert_0_15 [color=red constraint=false style=dashed]
	gate_1_0 -> expert_1_0 [color=red constraint=false style=dashed]
	gate_1_1 -> expert_1_1 [color=red constraint=false style=dashed]
	gate_1_2 -> expert_1_2 [color=red constraint=false style=dashed]
	gate_1_3 -> expert_1_3 [color=red constraint=false style=dashed]
	gate_1_4 -> expert_1_4 [color=red constraint=false style=dashed]
	gate_1_5 -> expert_1_5 [color=red constraint=false style=dashed]
	gate_1_6 -> expert_1_6 [color=red constraint=false style=dashed]
	gate_1_7 -> expert_1_7 [color=red constraint=false style=dashed]
	gate_1_8 -> expert_1_8 [color=red constraint=false style=dashed]
	gate_1_9 -> expert_1_9 [color=red constraint=false style=dashed]
	gate_1_10 -> expert_1_10 [color=red constraint=false style=dashed]
	gate_1_11 -> expert_1_11 [color=red constraint=false style=dashed]
	gate_1_12 -> expert_1_12 [color=red constraint=false style=dashed]
	gate_1_13 -> expert_1_13 [color=red constraint=false style=dashed]
	gate_1_14 -> expert_1_14 [color=red constraint=false style=dashed]
	gate_1_15 -> expert_1_15 [color=red constraint=false style=dashed]
	gate_2_0 -> expert_2_0 [color=red constraint=false style=dashed]
	gate_2_1 -> expert_2_1 [color=red constraint=false style=dashed]
	gate_2_2 -> expert_2_2 [color=red constraint=false style=dashed]
	gate_2_3 -> expert_2_3 [color=red constraint=false style=dashed]
	gate_2_4 -> expert_2_4 [color=red constraint=false style=dashed]
	gate_2_5 -> expert_2_5 [color=red constraint=false style=dashed]
	gate_2_6 -> expert_2_6 [color=red constraint=false style=dashed]
	gate_2_7 -> expert_2_7 [color=red constraint=false style=dashed]
	gate_2_8 -> expert_2_8 [color=red constraint=false style=dashed]
	gate_2_9 -> expert_2_9 [color=red constraint=false style=dashed]
	gate_2_10 -> expert_2_10 [color=red constraint=false style=dashed]
	gate_2_11 -> expert_2_11 [color=red constraint=false style=dashed]
	gate_2_12 -> expert_2_12 [color=red constraint=false style=dashed]
	gate_2_13 -> expert_2_13 [color=red constraint=false style=dashed]
	gate_2_14 -> expert_2_14 [color=red constraint=false style=dashed]
	gate_2_15 -> expert_2_15 [color=red constraint=false style=dashed]
	gate_3_0 -> expert_3_0 [color=red constraint=false style=dashed]
	gate_3_1 -> expert_3_1 [color=red constraint=false style=dashed]
	gate_3_2 -> expert_3_2 [color=red constraint=false style=dashed]
	gate_3_3 -> expert_3_3 [color=red constraint=false style=dashed]
	gate_3_4 -> expert_3_4 [color=red constraint=false style=dashed]
	gate_3_5 -> expert_3_5 [color=red constraint=false style=dashed]
	gate_3_6 -> expert_3_6 [color=red constraint=false style=dashed]
	gate_3_7 -> expert_3_7 [color=red constraint=false style=dashed]
	gate_3_8 -> expert_3_8 [color=red constraint=false style=dashed]
	gate_3_9 -> expert_3_9 [color=red constraint=false style=dashed]
	gate_3_10 -> expert_3_10 [color=red constraint=false style=dashed]
	gate_3_11 -> expert_3_11 [color=red constraint=false style=dashed]
	gate_3_12 -> expert_3_12 [color=red constraint=false style=dashed]
	gate_3_13 -> expert_3_13 [color=red constraint=false style=dashed]
	gate_3_14 -> expert_3_14 [color=red constraint=false style=dashed]
	gate_3_15 -> expert_3_15 [color=red constraint=false style=dashed]
	gate_4_0 -> expert_4_0 [color=red constraint=false style=dashed]
	gate_4_1 -> expert_4_1 [color=red constraint=false style=dashed]
	gate_4_2 -> expert_4_2 [color=red constraint=false style=dashed]
	gate_4_3 -> expert_4_3 [color=red constraint=false style=dashed]
	gate_4_4 -> expert_4_4 [color=red constraint=false style=dashed]
	gate_4_5 -> expert_4_5 [color=red constraint=false style=dashed]
	gate_4_6 -> expert_4_6 [color=red constraint=false style=dashed]
	gate_4_7 -> expert_4_7 [color=red constraint=false style=dashed]
	gate_4_8 -> expert_4_8 [color=red constraint=false style=dashed]
	gate_4_9 -> expert_4_9 [color=red constraint=false style=dashed]
	gate_4_10 -> expert_4_10 [color=red constraint=false style=dashed]
	gate_4_11 -> expert_4_11 [color=red constraint=false style=dashed]
	gate_4_12 -> expert_4_12 [color=red constraint=false style=dashed]
	gate_4_13 -> expert_4_13 [color=red constraint=false style=dashed]
	gate_4_14 -> expert_4_14 [color=red constraint=false style=dashed]
	gate_4_15 -> expert_4_15 [color=red constraint=false style=dashed]
	gate_5_0 -> expert_5_0 [color=red constraint=false style=dashed]
	gate_5_1 -> expert_5_1 [color=red constraint=false style=dashed]
	gate_5_2 -> expert_5_2 [color=red constraint=false style=dashed]
	gate_5_3 -> expert_5_3 [color=red constraint=false style=dashed]
	gate_5_4 -> expert_5_4 [color=red constraint=false style=dashed]
	gate_5_5 -> expert_5_5 [color=red constraint=false style=dashed]
	gate_5_6 -> expert_5_6 [color=red constraint=false style=dashed]
	gate_5_7 -> expert_5_7 [color=red constraint=false style=dashed]
	gate_5_8 -> expert_5_8 [color=red constraint=false style=dashed]
	gate_5_9 -> expert_5_9 [color=red constraint=false style=dashed]
	gate_5_10 -> expert_5_10 [color=red constraint=false style=dashed]
	gate_5_11 -> expert_5_11 [color=red constraint=false style=dashed]
	gate_5_12 -> expert_5_12 [color=red constraint=false style=dashed]
	gate_5_13 -> expert_5_13 [color=red constraint=false style=dashed]
	gate_5_14 -> expert_5_14 [color=red constraint=false style=dashed]
	gate_5_15 -> expert_5_15 [color=red constraint=false style=dashed]
	gate_6_0 -> expert_6_0 [color=red constraint=false style=dashed]
	gate_6_1 -> expert_6_1 [color=red constraint=false style=dashed]
	gate_6_2 -> expert_6_2 [color=red constraint=false style=dashed]
	gate_6_3 -> expert_6_3 [color=red constraint=false style=dashed]
	gate_6_4 -> expert_6_4 [color=red constraint=false style=dashed]
	gate_6_5 -> expert_6_5 [color=red constraint=false style=dashed]
	gate_6_6 -> expert_6_6 [color=red constraint=false style=dashed]
	gate_6_7 -> expert_6_7 [color=red constraint=false style=dashed]
	gate_6_8 -> expert_6_8 [color=red constraint=false style=dashed]
	gate_6_9 -> expert_6_9 [color=red constraint=false style=dashed]
	gate_6_10 -> expert_6_10 [color=red constraint=false style=dashed]
	gate_6_11 -> expert_6_11 [color=red constraint=false style=dashed]
	gate_6_12 -> expert_6_12 [color=red constraint=false style=dashed]
	gate_6_13 -> expert_6_13 [color=red constraint=false style=dashed]
	gate_6_14 -> expert_6_14 [color=red constraint=false style=dashed]
	gate_6_15 -> expert_6_15 [color=red constraint=false style=dashed]
	gate_7_0 -> expert_7_0 [color=red constraint=false style=dashed]
	gate_7_1 -> expert_7_1 [color=red constraint=false style=dashed]
	gate_7_2 -> expert_7_2 [color=red constraint=false style=dashed]
	gate_7_3 -> expert_7_3 [color=red constraint=false style=dashed]
	gate_7_4 -> expert_7_4 [color=red constraint=false style=dashed]
	gate_7_5 -> expert_7_5 [color=red constraint=false style=dashed]
	gate_7_6 -> expert_7_6 [color=red constraint=false style=dashed]
	gate_7_7 -> expert_7_7 [color=red constraint=false style=dashed]
	gate_7_8 -> expert_7_8 [color=red constraint=false style=dashed]
	gate_7_9 -> expert_7_9 [color=red constraint=false style=dashed]
	gate_7_10 -> expert_7_10 [color=red constraint=false style=dashed]
	gate_7_11 -> expert_7_11 [color=red constraint=false style=dashed]
	gate_7_12 -> expert_7_12 [color=red constraint=false style=dashed]
	gate_7_13 -> expert_7_13 [color=red constraint=false style=dashed]
	gate_7_14 -> expert_7_14 [color=red constraint=false style=dashed]
	gate_7_15 -> expert_7_15 [color=red constraint=false style=dashed]
	gate_8_0 -> expert_8_0 [color=red constraint=false style=dashed]
	gate_8_1 -> expert_8_1 [color=red constraint=false style=dashed]
	gate_8_2 -> expert_8_2 [color=red constraint=false style=dashed]
	gate_8_3 -> expert_8_3 [color=red constraint=false style=dashed]
	gate_8_4 -> expert_8_4 [color=red constraint=false style=dashed]
	gate_8_5 -> expert_8_5 [color=red constraint=false style=dashed]
	gate_8_6 -> expert_8_6 [color=red constraint=false style=dashed]
	gate_8_7 -> expert_8_7 [color=red constraint=false style=dashed]
	gate_8_8 -> expert_8_8 [color=red constraint=false style=dashed]
	gate_8_9 -> expert_8_9 [color=red constraint=false style=dashed]
	gate_8_10 -> expert_8_10 [color=red constraint=false style=dashed]
	gate_8_11 -> expert_8_11 [color=red constraint=false style=dashed]
	gate_8_12 -> expert_8_12 [color=red constraint=false style=dashed]
	gate_8_13 -> expert_8_13 [color=red constraint=false style=dashed]
	gate_8_14 -> expert_8_14 [color=red constraint=false style=dashed]
	gate_8_15 -> expert_8_15 [color=red constraint=false style=dashed]
	gate_9_0 -> expert_9_0 [color=red constraint=false style=dashed]
	gate_9_1 -> expert_9_1 [color=red constraint=false style=dashed]
	gate_9_2 -> expert_9_2 [color=red constraint=false style=dashed]
	gate_9_3 -> expert_9_3 [color=red constraint=false style=dashed]
	gate_9_4 -> expert_9_4 [color=red constraint=false style=dashed]
	gate_9_5 -> expert_9_5 [color=red constraint=false style=dashed]
	gate_9_6 -> expert_9_6 [color=red constraint=false style=dashed]
	gate_9_7 -> expert_9_7 [color=red constraint=false style=dashed]
	gate_9_8 -> expert_9_8 [color=red constraint=false style=dashed]
	gate_9_9 -> expert_9_9 [color=red constraint=false style=dashed]
	gate_9_10 -> expert_9_10 [color=red constraint=false style=dashed]
	gate_9_11 -> expert_9_11 [color=red constraint=false style=dashed]
	gate_9_12 -> expert_9_12 [color=red constraint=false style=dashed]
	gate_9_13 -> expert_9_13 [color=red constraint=false style=dashed]
	gate_9_14 -> expert_9_14 [color=red constraint=false style=dashed]
	gate_9_15 -> expert_9_15 [color=red constraint=false style=dashed]
	gate_10_0 -> expert_10_0 [color=red constraint=false style=dashed]
	gate_10_1 -> expert_10_1 [color=red constraint=false style=dashed]
	gate_10_2 -> expert_10_2 [color=red constraint=false style=dashed]
	gate_10_3 -> expert_10_3 [color=red constraint=false style=dashed]
	gate_10_4 -> expert_10_4 [color=red constraint=false style=dashed]
	gate_10_5 -> expert_10_5 [color=red constraint=false style=dashed]
	gate_10_6 -> expert_10_6 [color=red constraint=false style=dashed]
	gate_10_7 -> expert_10_7 [color=red constraint=false style=dashed]
	gate_10_8 -> expert_10_8 [color=red constraint=false style=dashed]
	gate_10_9 -> expert_10_9 [color=red constraint=false style=dashed]
	gate_10_10 -> expert_10_10 [color=red constraint=false style=dashed]
	gate_10_11 -> expert_10_11 [color=red constraint=false style=dashed]
	gate_10_12 -> expert_10_12 [color=red constraint=false style=dashed]
	gate_10_13 -> expert_10_13 [color=red constraint=false style=dashed]
	gate_10_14 -> expert_10_14 [color=red constraint=false style=dashed]
	gate_10_15 -> expert_10_15 [color=red constraint=false style=dashed]
	gate_11_0 -> expert_11_0 [color=red constraint=false style=dashed]
	gate_11_1 -> expert_11_1 [color=red constraint=false style=dashed]
	gate_11_2 -> expert_11_2 [color=red constraint=false style=dashed]
	gate_11_3 -> expert_11_3 [color=red constraint=false style=dashed]
	gate_11_4 -> expert_11_4 [color=red constraint=false style=dashed]
	gate_11_5 -> expert_11_5 [color=red constraint=false style=dashed]
	gate_11_6 -> expert_11_6 [color=red constraint=false style=dashed]
	gate_11_7 -> expert_11_7 [color=red constraint=false style=dashed]
	gate_11_8 -> expert_11_8 [color=red constraint=false style=dashed]
	gate_11_9 -> expert_11_9 [color=red constraint=false style=dashed]
	gate_11_10 -> expert_11_10 [color=red constraint=false style=dashed]
	gate_11_11 -> expert_11_11 [color=red constraint=false style=dashed]
	gate_11_12 -> expert_11_12 [color=red constraint=false style=dashed]
	gate_11_13 -> expert_11_13 [color=red constraint=false style=dashed]
	gate_11_14 -> expert_11_14 [color=red constraint=false style=dashed]
	gate_11_15 -> expert_11_15 [color=red constraint=false style=dashed]
	gate_12_0 -> expert_12_0 [color=red constraint=false style=dashed]
	gate_12_1 -> expert_12_1 [color=red constraint=false style=dashed]
	gate_12_2 -> expert_12_2 [color=red constraint=false style=dashed]
	gate_12_3 -> expert_12_3 [color=red constraint=false style=dashed]
	gate_12_4 -> expert_12_4 [color=red constraint=false style=dashed]
	gate_12_5 -> expert_12_5 [color=red constraint=false style=dashed]
	gate_12_6 -> expert_12_6 [color=red constraint=false style=dashed]
	gate_12_7 -> expert_12_7 [color=red constraint=false style=dashed]
	gate_12_8 -> expert_12_8 [color=red constraint=false style=dashed]
	gate_12_9 -> expert_12_9 [color=red constraint=false style=dashed]
	gate_12_10 -> expert_12_10 [color=red constraint=false style=dashed]
	gate_12_11 -> expert_12_11 [color=red constraint=false style=dashed]
	gate_12_12 -> expert_12_12 [color=red constraint=false style=dashed]
	gate_12_13 -> expert_12_13 [color=red constraint=false style=dashed]
	gate_12_14 -> expert_12_14 [color=red constraint=false style=dashed]
	gate_12_15 -> expert_12_15 [color=red constraint=false style=dashed]
	gate_13_0 -> expert_13_0 [color=red constraint=false style=dashed]
	gate_13_1 -> expert_13_1 [color=red constraint=false style=dashed]
	gate_13_2 -> expert_13_2 [color=red constraint=false style=dashed]
	gate_13_3 -> expert_13_3 [color=red constraint=false style=dashed]
	gate_13_4 -> expert_13_4 [color=red constraint=false style=dashed]
	gate_13_5 -> expert_13_5 [color=red constraint=false style=dashed]
	gate_13_6 -> expert_13_6 [color=red constraint=false style=dashed]
	gate_13_7 -> expert_13_7 [color=red constraint=false style=dashed]
	gate_13_8 -> expert_13_8 [color=red constraint=false style=dashed]
	gate_13_9 -> expert_13_9 [color=red constraint=false style=dashed]
	gate_13_10 -> expert_13_10 [color=red constraint=false style=dashed]
	gate_13_11 -> expert_13_11 [color=red constraint=false style=dashed]
	gate_13_12 -> expert_13_12 [color=red constraint=false style=dashed]
	gate_13_13 -> expert_13_13 [color=red constraint=false style=dashed]
	gate_13_14 -> expert_13_14 [color=red constraint=false style=dashed]
	gate_13_15 -> expert_13_15 [color=red constraint=false style=dashed]
	gate_14_0 -> expert_14_0 [color=red constraint=false style=dashed]
	gate_14_1 -> expert_14_1 [color=red constraint=false style=dashed]
	gate_14_2 -> expert_14_2 [color=red constraint=false style=dashed]
	gate_14_3 -> expert_14_3 [color=red constraint=false style=dashed]
	gate_14_4 -> expert_14_4 [color=red constraint=false style=dashed]
	gate_14_5 -> expert_14_5 [color=red constraint=false style=dashed]
	gate_14_6 -> expert_14_6 [color=red constraint=false style=dashed]
	gate_14_7 -> expert_14_7 [color=red constraint=false style=dashed]
	gate_14_8 -> expert_14_8 [color=red constraint=false style=dashed]
	gate_14_9 -> expert_14_9 [color=red constraint=false style=dashed]
	gate_14_10 -> expert_14_10 [color=red constraint=false style=dashed]
	gate_14_11 -> expert_14_11 [color=red constraint=false style=dashed]
	gate_14_12 -> expert_14_12 [color=red constraint=false style=dashed]
	gate_14_13 -> expert_14_13 [color=red constraint=false style=dashed]
	gate_14_14 -> expert_14_14 [color=red constraint=false style=dashed]
	gate_14_15 -> expert_14_15 [color=red constraint=false style=dashed]
	gate_15_0 -> expert_15_0 [color=red constraint=false style=dashed]
	gate_15_1 -> expert_15_1 [color=red constraint=false style=dashed]
	gate_15_2 -> expert_15_2 [color=red constraint=false style=dashed]
	gate_15_3 -> expert_15_3 [color=red constraint=false style=dashed]
	gate_15_4 -> expert_15_4 [color=red constraint=false style=dashed]
	gate_15_5 -> expert_15_5 [color=red constraint=false style=dashed]
	gate_15_6 -> expert_15_6 [color=red constraint=false style=dashed]
	gate_15_7 -> expert_15_7 [color=red constraint=false style=dashed]
	gate_15_8 -> expert_15_8 [color=red constraint=false style=dashed]
	gate_15_9 -> expert_15_9 [color=red constraint=false style=dashed]
	gate_15_10 -> expert_15_10 [color=red constraint=false style=dashed]
	gate_15_11 -> expert_15_11 [color=red constraint=false style=dashed]
	gate_15_12 -> expert_15_12 [color=red constraint=false style=dashed]
	gate_15_13 -> expert_15_13 [color=red constraint=false style=dashed]
	gate_15_14 -> expert_15_14 [color=red constraint=false style=dashed]
	gate_15_15 -> expert_15_15 [color=red constraint=false style=dashed]
}
