<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2160pt" height="51pt"
 viewBox="0.00 0.00 2160.00 51.22" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 916.43)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-916.43 38811.47,-916.43 38811.47,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="429.97" cy="-874.43" rx="234.52" ry="33.47"/>
<text text-anchor="middle" x="429.97" y="-884.33" font-family="Times,serif" font-size="12.00">Input</text>
<text text-anchor="middle" x="429.97" y="-871.33" font-family="Times,serif" font-size="12.00">[batch_size=512, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="429.97" y="-858.33" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="none" stroke="black" points="774.37,-767.43 226.5,-767.43 85.56,-673.43 633.43,-673.43 774.37,-767.43"/>
<text text-anchor="middle" x="429.97" y="-730.33" font-family="Times,serif" font-size="12.00">Data Parallel Split</text>
<text text-anchor="middle" x="429.97" y="-717.33" font-family="Times,serif" font-size="12.00">[batch_size=256, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="429.97" y="-704.33" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M429.97,-841.19C429.97,-822.77 429.97,-799.14 429.97,-777.75"/>
<polygon fill="black" stroke="black" points="433.47,-777.46 429.97,-767.46 426.47,-777.46 433.47,-777.46"/>
<text text-anchor="middle" x="442.97" y="-799.43" font-family="Arial" font-size="10.00">DP=2</text>
</g>
<!-- dp0_attn_s0_l0_tp0 -->
<g id="node3" class="node">
<title>dp0_attn_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="398.47,-600.19 135.47,-600.19 135.47,-562.19 398.47,-562.19 398.47,-600.19"/>
<text text-anchor="middle" x="266.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="266.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="266.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp_split&#45;&gt;dp0_attn_s0_l0_tp0 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;dp0_attn_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M375.24,-673.35C348.88,-651.16 318.32,-625.43 296.4,-606.97"/>
<polygon fill="black" stroke="black" points="298.64,-604.29 288.74,-600.52 294.14,-609.64 298.64,-604.29"/>
</g>
<!-- dp1_attn_s0_l0_tp0 -->
<g id="node101" class="node">
<title>dp1_attn_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="704.47,-600.19 441.47,-600.19 441.47,-562.19 704.47,-562.19 704.47,-600.19"/>
<text text-anchor="middle" x="572.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="572.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="572.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp_split&#45;&gt;dp1_attn_s0_l0_tp0 -->
<g id="edge86" class="edge">
<title>dp_split&#45;&gt;dp1_attn_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M477.98,-673.35C500.91,-651.35 527.45,-625.88 546.64,-607.46"/>
<polygon fill="black" stroke="black" points="549.08,-609.97 553.87,-600.52 544.23,-604.92 549.08,-609.97"/>
</g>
<!-- dp0_attn_s0_l0_ar0 -->
<g id="node7" class="node">
<title>dp0_attn_s0_l0_ar0</title>
<ellipse fill="none" stroke="black" cx="185.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="185.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="185.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="185.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l0_tp0&#45;&gt;dp0_attn_s0_l0_ar0 -->
<g id="edge3" class="edge">
<title>dp0_attn_s0_l0_tp0&#45;&gt;dp0_attn_s0_l0_ar0</title>
<path fill="none" stroke="black" d="M254.49,-562.15C242.63,-545.01 224.49,-518.78 209.85,-497.62"/>
<polygon fill="black" stroke="black" points="212.59,-495.43 204.03,-489.2 206.84,-499.41 212.59,-495.43"/>
</g>
<!-- dp0_attn_s0_l0_tp1 -->
<g id="node4" class="node">
<title>dp0_attn_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="317.47,-368.35 54.47,-368.35 54.47,-330.35 317.47,-330.35 317.47,-368.35"/>
<text text-anchor="middle" x="185.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="185.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="185.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_ar1 -->
<g id="node8" class="node">
<title>dp0_attn_s0_l0_ar1</title>
<ellipse fill="none" stroke="black" cx="185.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="185.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="185.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="185.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_tp1&#45;&gt;dp0_attn_s0_l0_ar1 -->
<g id="edge5" class="edge">
<title>dp0_attn_s0_l0_tp1&#45;&gt;dp0_attn_s0_l0_ar1</title>
<path fill="none" stroke="black" d="M185.97,-330.06C185.97,-314.82 185.97,-292.65 185.97,-273.84"/>
<polygon fill="black" stroke="black" points="189.47,-273.8 185.97,-263.8 182.47,-273.8 189.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l0_tp2 -->
<g id="node5" class="node">
<title>dp0_attn_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="317.47,-150.74 54.47,-150.74 54.47,-112.74 317.47,-112.74 317.47,-150.74"/>
<text text-anchor="middle" x="185.97" y="-139.54" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="185.97" y="-129.54" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="185.97" y="-119.54" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_ar2 -->
<g id="node9" class="node">
<title>dp0_attn_s0_l0_ar2</title>
<ellipse fill="none" stroke="black" cx="185.97" cy="-26.87" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="185.97" y="-34.67" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="185.97" y="-24.67" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="185.97" y="-14.67" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_tp2&#45;&gt;dp0_attn_s0_l0_ar2 -->
<g id="edge7" class="edge">
<title>dp0_attn_s0_l0_tp2&#45;&gt;dp0_attn_s0_l0_ar2</title>
<path fill="none" stroke="black" d="M185.97,-112.35C185.97,-98.98 185.97,-80.45 185.97,-64.14"/>
<polygon fill="black" stroke="black" points="189.47,-63.83 185.97,-53.83 182.47,-63.83 189.47,-63.83"/>
</g>
<!-- dp0_attn_s0_l0_tp3 -->
<g id="node6" class="node">
<title>dp0_attn_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="2197.47,-893.43 1934.47,-893.43 1934.47,-855.43 2197.47,-855.43 2197.47,-893.43"/>
<text text-anchor="middle" x="2065.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="2065.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2065.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l0_tp0 -->
<g id="node10" class="node">
<title>dp0_moe_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="1976.97,-739.43 1696.97,-739.43 1696.97,-701.43 1976.97,-701.43 1976.97,-739.43"/>
<text text-anchor="middle" x="1836.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="1836.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="1836.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp0 -->
<g id="edge8" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M2038.8,-855.4C1997.4,-827.91 1918.48,-775.53 1872.55,-745.05"/>
<polygon fill="black" stroke="black" points="1874.37,-742.05 1864.1,-739.44 1870.5,-747.88 1874.37,-742.05"/>
</g>
<!-- dp0_moe_s0_l0_tp1 -->
<g id="node12" class="node">
<title>dp0_moe_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="1284.97,-739.43 1004.97,-739.43 1004.97,-701.43 1284.97,-701.43 1284.97,-739.43"/>
<text text-anchor="middle" x="1144.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="1144.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="1144.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp1 -->
<g id="edge10" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M1998.69,-855.41C1972.94,-848.88 1943.2,-841.81 1915.97,-836.43 1701.77,-794.13 1451.34,-759.47 1295.41,-739.62"/>
<polygon fill="black" stroke="black" points="1295.64,-736.12 1285.28,-738.34 1294.76,-743.07 1295.64,-736.12"/>
</g>
<!-- dp0_moe_s0_l0_tp2 -->
<g id="node14" class="node">
<title>dp0_moe_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="2491.97,-739.43 2211.97,-739.43 2211.97,-701.43 2491.97,-701.43 2491.97,-739.43"/>
<text text-anchor="middle" x="2351.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="2351.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2351.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp2 -->
<g id="edge12" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M2099.9,-855.4C2152.04,-827.68 2251.81,-774.66 2308.95,-744.29"/>
<polygon fill="black" stroke="black" points="2310.89,-747.22 2318.08,-739.44 2307.61,-741.04 2310.89,-747.22"/>
</g>
<!-- dp0_moe_s0_l0_tp3 -->
<g id="node16" class="node">
<title>dp0_moe_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="3126.97,-739.43 2846.97,-739.43 2846.97,-701.43 3126.97,-701.43 3126.97,-739.43"/>
<text text-anchor="middle" x="2986.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="2986.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2986.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3 -->
<g id="edge14" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" d="M2133.25,-855.41C2159,-848.88 2188.73,-841.81 2215.97,-836.43 2430.17,-794.13 2680.6,-759.47 2836.52,-739.62"/>
<polygon fill="black" stroke="black" points="2837.18,-743.07 2846.66,-738.34 2836.3,-736.12 2837.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l0_ar0&#45;&gt;dp0_attn_s0_l0_tp1 -->
<g id="edge4" class="edge">
<title>dp0_attn_s0_l0_ar0&#45;&gt;dp0_attn_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M185.97,-435.13C185.97,-418.19 185.97,-396.07 185.97,-378.68"/>
<polygon fill="black" stroke="black" points="189.47,-378.54 185.97,-368.54 182.47,-378.54 189.47,-378.54"/>
</g>
<!-- dp0_attn_s0_l0_ar1&#45;&gt;dp0_attn_s0_l0_tp2 -->
<g id="edge6" class="edge">
<title>dp0_attn_s0_l0_ar1&#45;&gt;dp0_attn_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M185.97,-209.65C185.97,-194.9 185.97,-176.41 185.97,-161.25"/>
<polygon fill="black" stroke="black" points="189.47,-160.91 185.97,-150.91 182.47,-160.91 189.47,-160.91"/>
</g>
<!-- dp0_gate_s0_l0_tp0 -->
<g id="node11" class="node">
<title>dp0_gate_s0_l0_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1898.05,-912.43 1436.6,-912.43 1317.89,-836.43 1779.34,-836.43 1898.05,-912.43"/>
<text text-anchor="middle" x="1607.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="1607.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="1607.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l0_tp0&#45;&gt;dp0_moe_s0_l0_tp0 -->
<g id="edge9" class="edge">
<title>dp0_gate_s0_l0_tp0&#45;&gt;dp0_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1663.99,-836.25C1706.77,-807.85 1764.44,-769.57 1801.17,-745.19"/>
<polygon fill="black" stroke="black" points="1803.19,-748.05 1809.59,-739.6 1799.32,-742.22 1803.19,-748.05"/>
</g>
<!-- dp0_gate_s0_l0_tp1 -->
<g id="node13" class="node">
<title>dp0_gate_s0_l0_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1281.05,-912.43 819.6,-912.43 700.89,-836.43 1162.34,-836.43 1281.05,-912.43"/>
<text text-anchor="middle" x="990.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="990.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="990.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l0_tp1&#45;&gt;dp0_moe_s0_l0_tp1 -->
<g id="edge11" class="edge">
<title>dp0_gate_s0_l0_tp1&#45;&gt;dp0_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1028.64,-836.25C1056.72,-808.53 1094.35,-771.39 1119.1,-746.96"/>
<polygon fill="black" stroke="black" points="1121.69,-749.32 1126.35,-739.81 1116.77,-744.34 1121.69,-749.32"/>
</g>
<!-- dp0_gate_s0_l0_tp2 -->
<g id="node15" class="node">
<title>dp0_gate_s0_l0_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2814.05,-912.43 2352.6,-912.43 2233.89,-836.43 2695.34,-836.43 2814.05,-912.43"/>
<text text-anchor="middle" x="2523.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="2523.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2523.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l0_tp2&#45;&gt;dp0_moe_s0_l0_tp2 -->
<g id="edge13" class="edge">
<title>dp0_gate_s0_l0_tp2&#45;&gt;dp0_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2481.89,-836.25C2450.39,-808.41 2408.14,-771.07 2380.5,-746.64"/>
<polygon fill="black" stroke="black" points="2382.58,-743.81 2372.77,-739.81 2377.94,-749.05 2382.58,-743.81"/>
</g>
<!-- dp0_gate_s0_l0_tp3 -->
<g id="node17" class="node">
<title>dp0_gate_s0_l0_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3431.05,-912.43 2969.6,-912.43 2850.89,-836.43 3312.34,-836.43 3431.05,-912.43"/>
<text text-anchor="middle" x="3140.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="3140.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="3140.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3 -->
<g id="edge15" class="edge">
<title>dp0_gate_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3103.3,-836.25C3075.21,-808.53 3037.59,-771.39 3012.84,-746.96"/>
<polygon fill="black" stroke="black" points="3015.17,-744.34 3005.59,-739.81 3010.25,-749.32 3015.17,-744.34"/>
</g>
<!-- dp0_attn_s0_l1_tp0 -->
<g id="node18" class="node">
<title>dp0_attn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="3730.47,-893.43 3467.47,-893.43 3467.47,-855.43 3730.47,-855.43 3730.47,-893.43"/>
<text text-anchor="middle" x="3598.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="3598.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_ar0 -->
<g id="node22" class="node">
<title>dp0_attn_s0_l1_ar0</title>
<ellipse fill="none" stroke="black" cx="3598.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="3598.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="3598.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_tp0&#45;&gt;dp0_attn_s0_l1_ar0 -->
<g id="edge16" class="edge">
<title>dp0_attn_s0_l1_tp0&#45;&gt;dp0_attn_s0_l1_ar0</title>
<path fill="none" stroke="black" d="M3598.97,-855.4C3598.97,-831.41 3598.97,-788.45 3598.97,-757.64"/>
<polygon fill="black" stroke="black" points="3602.47,-757.3 3598.97,-747.3 3595.47,-757.3 3602.47,-757.3"/>
</g>
<!-- dp0_attn_s0_l1_tp1 -->
<g id="node19" class="node">
<title>dp0_attn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="3730.47,-600.19 3467.47,-600.19 3467.47,-562.19 3730.47,-562.19 3730.47,-600.19"/>
<text text-anchor="middle" x="3598.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="3598.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_ar1 -->
<g id="node23" class="node">
<title>dp0_attn_s0_l1_ar1</title>
<ellipse fill="none" stroke="black" cx="3598.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="3598.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="3598.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_tp1&#45;&gt;dp0_attn_s0_l1_ar1 -->
<g id="edge18" class="edge">
<title>dp0_attn_s0_l1_tp1&#45;&gt;dp0_attn_s0_l1_ar1</title>
<path fill="none" stroke="black" d="M3598.97,-562.15C3598.97,-545.47 3598.97,-520.18 3598.97,-499.32"/>
<polygon fill="black" stroke="black" points="3602.47,-499.2 3598.97,-489.2 3595.47,-499.2 3602.47,-499.2"/>
</g>
<!-- dp0_attn_s0_l1_tp2 -->
<g id="node20" class="node">
<title>dp0_attn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="3730.47,-368.35 3467.47,-368.35 3467.47,-330.35 3730.47,-330.35 3730.47,-368.35"/>
<text text-anchor="middle" x="3598.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="3598.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_ar2 -->
<g id="node24" class="node">
<title>dp0_attn_s0_l1_ar2</title>
<ellipse fill="none" stroke="black" cx="3598.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="3598.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="3598.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="3598.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_tp2&#45;&gt;dp0_attn_s0_l1_ar2 -->
<g id="edge20" class="edge">
<title>dp0_attn_s0_l1_tp2&#45;&gt;dp0_attn_s0_l1_ar2</title>
<path fill="none" stroke="black" d="M3598.97,-330.06C3598.97,-314.82 3598.97,-292.65 3598.97,-273.84"/>
<polygon fill="black" stroke="black" points="3602.47,-273.8 3598.97,-263.8 3595.47,-273.8 3602.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l1_tp3 -->
<g id="node21" class="node">
<title>dp0_attn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="5263.47,-893.43 5000.47,-893.43 5000.47,-855.43 5263.47,-855.43 5263.47,-893.43"/>
<text text-anchor="middle" x="5131.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="5131.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="5131.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l1_tp0 -->
<g id="node25" class="node">
<title>dp0_moe_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="4987.97,-739.43 4707.97,-739.43 4707.97,-701.43 4987.97,-701.43 4987.97,-739.43"/>
<text text-anchor="middle" x="4847.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="4847.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4847.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp0 -->
<g id="edge21" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M5098.28,-855.4C5046.5,-827.68 4947.43,-774.66 4890.69,-744.29"/>
<polygon fill="black" stroke="black" points="4892.09,-741.07 4881.62,-739.44 4888.78,-747.24 4892.09,-741.07"/>
</g>
<!-- dp0_moe_s0_l1_tp1 -->
<g id="node27" class="node">
<title>dp0_moe_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="4350.97,-739.43 4070.97,-739.43 4070.97,-701.43 4350.97,-701.43 4350.97,-739.43"/>
<text text-anchor="middle" x="4210.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="4210.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4210.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp1 -->
<g id="edge23" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M5064.69,-855.41C5038.94,-848.88 5009.2,-841.81 4981.97,-836.43 4767.77,-794.13 4517.34,-759.47 4361.41,-739.62"/>
<polygon fill="black" stroke="black" points="4361.64,-736.12 4351.28,-738.34 4360.76,-743.07 4361.64,-736.12"/>
</g>
<!-- dp0_moe_s0_l1_tp2 -->
<g id="node29" class="node">
<title>dp0_moe_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="5420.97,-739.43 5140.97,-739.43 5140.97,-701.43 5420.97,-701.43 5420.97,-739.43"/>
<text text-anchor="middle" x="5280.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="5280.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="5280.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp2 -->
<g id="edge25" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M5149.65,-855.4C5176.08,-828.43 5226.02,-777.48 5256.12,-746.78"/>
<polygon fill="black" stroke="black" points="5258.81,-749.03 5263.31,-739.44 5253.82,-744.13 5258.81,-749.03"/>
</g>
<!-- dp0_moe_s0_l1_tp3 -->
<g id="node31" class="node">
<title>dp0_moe_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="6192.97,-739.43 5912.97,-739.43 5912.97,-701.43 6192.97,-701.43 6192.97,-739.43"/>
<text text-anchor="middle" x="6052.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="6052.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6052.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3 -->
<g id="edge27" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M5199.25,-855.41C5225,-848.88 5254.73,-841.81 5281.97,-836.43 5496.17,-794.13 5746.6,-759.47 5902.52,-739.62"/>
<polygon fill="black" stroke="black" points="5903.18,-743.07 5912.66,-738.34 5902.3,-736.12 5903.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l1_ar0&#45;&gt;dp0_attn_s0_l1_tp1 -->
<g id="edge17" class="edge">
<title>dp0_attn_s0_l1_ar0&#45;&gt;dp0_attn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M3598.97,-693.29C3598.97,-669.58 3598.97,-634.72 3598.97,-610.39"/>
<polygon fill="black" stroke="black" points="3602.47,-610.35 3598.97,-600.35 3595.47,-610.35 3602.47,-610.35"/>
</g>
<!-- dp0_attn_s0_l1_ar1&#45;&gt;dp0_attn_s0_l1_tp2 -->
<g id="edge19" class="edge">
<title>dp0_attn_s0_l1_ar1&#45;&gt;dp0_attn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M3598.97,-435.13C3598.97,-418.19 3598.97,-396.07 3598.97,-378.68"/>
<polygon fill="black" stroke="black" points="3602.47,-378.54 3598.97,-368.54 3595.47,-378.54 3602.47,-378.54"/>
</g>
<!-- dp0_gate_s0_l1_tp0 -->
<g id="node26" class="node">
<title>dp0_gate_s0_l1_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4964.05,-912.43 4502.6,-912.43 4383.89,-836.43 4845.34,-836.43 4964.05,-912.43"/>
<text text-anchor="middle" x="4673.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="4673.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4673.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l1_tp0&#45;&gt;dp0_moe_s0_l1_tp0 -->
<g id="edge22" class="edge">
<title>dp0_gate_s0_l1_tp0&#45;&gt;dp0_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4716.53,-836.25C4748.4,-808.41 4791.14,-771.07 4819.1,-746.64"/>
<polygon fill="black" stroke="black" points="4821.7,-749.02 4826.93,-739.81 4817.1,-743.75 4821.7,-749.02"/>
</g>
<!-- dp0_gate_s0_l1_tp1 -->
<g id="node28" class="node">
<title>dp0_gate_s0_l1_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4347.05,-912.43 3885.6,-912.43 3766.89,-836.43 4228.34,-836.43 4347.05,-912.43"/>
<text text-anchor="middle" x="4056.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="4056.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4056.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l1_tp1&#45;&gt;dp0_moe_s0_l1_tp1 -->
<g id="edge24" class="edge">
<title>dp0_gate_s0_l1_tp1&#45;&gt;dp0_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4094.64,-836.25C4122.72,-808.53 4160.35,-771.39 4185.1,-746.96"/>
<polygon fill="black" stroke="black" points="4187.69,-749.32 4192.35,-739.81 4182.77,-744.34 4187.69,-749.32"/>
</g>
<!-- dp0_gate_s0_l1_tp2 -->
<g id="node30" class="node">
<title>dp0_gate_s0_l1_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5880.05,-912.43 5418.6,-912.43 5299.89,-836.43 5761.34,-836.43 5880.05,-912.43"/>
<text text-anchor="middle" x="5589.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="5589.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="5589.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l1_tp2&#45;&gt;dp0_moe_s0_l1_tp2 -->
<g id="edge26" class="edge">
<title>dp0_gate_s0_l1_tp2&#45;&gt;dp0_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5514.38,-836.25C5455.8,-807.43 5376.53,-768.44 5327.09,-744.12"/>
<polygon fill="black" stroke="black" points="5328.43,-740.88 5317.92,-739.6 5325.35,-747.16 5328.43,-740.88"/>
</g>
<!-- dp0_gate_s0_l1_tp3 -->
<g id="node32" class="node">
<title>dp0_gate_s0_l1_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6497.05,-912.43 6035.6,-912.43 5916.89,-836.43 6378.34,-836.43 6497.05,-912.43"/>
<text text-anchor="middle" x="6206.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="6206.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6206.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3 -->
<g id="edge28" class="edge">
<title>dp0_gate_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6169.3,-836.25C6141.21,-808.53 6103.59,-771.39 6078.84,-746.96"/>
<polygon fill="black" stroke="black" points="6081.17,-744.34 6071.59,-739.81 6076.25,-749.32 6081.17,-744.34"/>
</g>
<!-- dp0_attn_s0_l2_tp0 -->
<g id="node33" class="node">
<title>dp0_attn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="6796.47,-893.43 6533.47,-893.43 6533.47,-855.43 6796.47,-855.43 6796.47,-893.43"/>
<text text-anchor="middle" x="6664.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="6664.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_ar0 -->
<g id="node37" class="node">
<title>dp0_attn_s0_l2_ar0</title>
<ellipse fill="none" stroke="black" cx="6664.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="6664.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="6664.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_tp0&#45;&gt;dp0_attn_s0_l2_ar0 -->
<g id="edge29" class="edge">
<title>dp0_attn_s0_l2_tp0&#45;&gt;dp0_attn_s0_l2_ar0</title>
<path fill="none" stroke="black" d="M6664.97,-855.4C6664.97,-831.41 6664.97,-788.45 6664.97,-757.64"/>
<polygon fill="black" stroke="black" points="6668.47,-757.3 6664.97,-747.3 6661.47,-757.3 6668.47,-757.3"/>
</g>
<!-- dp0_attn_s0_l2_tp1 -->
<g id="node34" class="node">
<title>dp0_attn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="6796.47,-600.19 6533.47,-600.19 6533.47,-562.19 6796.47,-562.19 6796.47,-600.19"/>
<text text-anchor="middle" x="6664.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="6664.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_ar1 -->
<g id="node38" class="node">
<title>dp0_attn_s0_l2_ar1</title>
<ellipse fill="none" stroke="black" cx="6664.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="6664.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="6664.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_tp1&#45;&gt;dp0_attn_s0_l2_ar1 -->
<g id="edge31" class="edge">
<title>dp0_attn_s0_l2_tp1&#45;&gt;dp0_attn_s0_l2_ar1</title>
<path fill="none" stroke="black" d="M6664.97,-562.15C6664.97,-545.47 6664.97,-520.18 6664.97,-499.32"/>
<polygon fill="black" stroke="black" points="6668.47,-499.2 6664.97,-489.2 6661.47,-499.2 6668.47,-499.2"/>
</g>
<!-- dp0_attn_s0_l2_tp2 -->
<g id="node35" class="node">
<title>dp0_attn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="6796.47,-368.35 6533.47,-368.35 6533.47,-330.35 6796.47,-330.35 6796.47,-368.35"/>
<text text-anchor="middle" x="6664.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="6664.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_ar2 -->
<g id="node39" class="node">
<title>dp0_attn_s0_l2_ar2</title>
<ellipse fill="none" stroke="black" cx="6664.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="6664.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="6664.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="6664.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_tp2&#45;&gt;dp0_attn_s0_l2_ar2 -->
<g id="edge33" class="edge">
<title>dp0_attn_s0_l2_tp2&#45;&gt;dp0_attn_s0_l2_ar2</title>
<path fill="none" stroke="black" d="M6664.97,-330.06C6664.97,-314.82 6664.97,-292.65 6664.97,-273.84"/>
<polygon fill="black" stroke="black" points="6668.47,-273.8 6664.97,-263.8 6661.47,-273.8 6668.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l2_tp3 -->
<g id="node36" class="node">
<title>dp0_attn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8329.47,-893.43 8066.47,-893.43 8066.47,-855.43 8329.47,-855.43 8329.47,-893.43"/>
<text text-anchor="middle" x="8197.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="8197.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="8197.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l2_tp0 -->
<g id="node40" class="node">
<title>dp0_moe_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7958.97,-739.43 7678.97,-739.43 7678.97,-701.43 7958.97,-701.43 7958.97,-739.43"/>
<text text-anchor="middle" x="7818.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="7818.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7818.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp0 -->
<g id="edge34" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M8153,-855.4C8083.05,-827.34 7948.41,-773.34 7873.19,-743.17"/>
<polygon fill="black" stroke="black" points="7874.46,-739.91 7863.88,-739.44 7871.85,-746.41 7874.46,-739.91"/>
</g>
<!-- dp0_moe_s0_l2_tp1 -->
<g id="node42" class="node">
<title>dp0_moe_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7434.97,-739.43 7154.97,-739.43 7154.97,-701.43 7434.97,-701.43 7434.97,-739.43"/>
<text text-anchor="middle" x="7294.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="7294.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7294.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp1 -->
<g id="edge36" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M8130.31,-855.36C8104.64,-848.87 8075.06,-841.83 8047.97,-836.43 7840.36,-795.06 7597.98,-760.46 7445.47,-740.34"/>
<polygon fill="black" stroke="black" points="7445.48,-736.81 7435.1,-738.98 7444.56,-743.75 7445.48,-736.81"/>
</g>
<!-- dp0_moe_s0_l2_tp2 -->
<g id="node44" class="node">
<title>dp0_moe_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="8670.97,-739.43 8390.97,-739.43 8390.97,-701.43 8670.97,-701.43 8670.97,-739.43"/>
<text text-anchor="middle" x="8530.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="8530.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="8530.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp2 -->
<g id="edge38" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M8237.48,-855.4C8298.56,-827.51 8415.79,-774 8482.11,-743.73"/>
<polygon fill="black" stroke="black" points="8483.87,-746.77 8491.51,-739.44 8480.96,-740.41 8483.87,-746.77"/>
</g>
<!-- dp0_moe_s0_l2_tp3 -->
<g id="node46" class="node">
<title>dp0_moe_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9258.97,-739.43 8978.97,-739.43 8978.97,-701.43 9258.97,-701.43 9258.97,-739.43"/>
<text text-anchor="middle" x="9118.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="9118.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9118.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3 -->
<g id="edge40" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8265.25,-855.41C8291,-848.88 8320.73,-841.81 8347.97,-836.43 8562.17,-794.13 8812.6,-759.47 8968.52,-739.62"/>
<polygon fill="black" stroke="black" points="8969.18,-743.07 8978.66,-738.34 8968.3,-736.12 8969.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l2_ar0&#45;&gt;dp0_attn_s0_l2_tp1 -->
<g id="edge30" class="edge">
<title>dp0_attn_s0_l2_ar0&#45;&gt;dp0_attn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M6664.97,-693.29C6664.97,-669.58 6664.97,-634.72 6664.97,-610.39"/>
<polygon fill="black" stroke="black" points="6668.47,-610.35 6664.97,-600.35 6661.47,-610.35 6668.47,-610.35"/>
</g>
<!-- dp0_attn_s0_l2_ar1&#45;&gt;dp0_attn_s0_l2_tp2 -->
<g id="edge32" class="edge">
<title>dp0_attn_s0_l2_ar1&#45;&gt;dp0_attn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M6664.97,-435.13C6664.97,-418.19 6664.97,-396.07 6664.97,-378.68"/>
<polygon fill="black" stroke="black" points="6668.47,-378.54 6664.97,-368.54 6661.47,-378.54 6668.47,-378.54"/>
</g>
<!-- dp0_gate_s0_l2_tp0 -->
<g id="node41" class="node">
<title>dp0_gate_s0_l2_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8030.05,-912.43 7568.6,-912.43 7449.89,-836.43 7911.34,-836.43 8030.05,-912.43"/>
<text text-anchor="middle" x="7739.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="7739.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7739.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l2_tp0&#45;&gt;dp0_moe_s0_l2_tp0 -->
<g id="edge35" class="edge">
<title>dp0_gate_s0_l2_tp0&#45;&gt;dp0_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7759.29,-836.25C7773.33,-809.24 7792.01,-773.31 7804.7,-748.88"/>
<polygon fill="black" stroke="black" points="7807.91,-750.3 7809.42,-739.81 7801.7,-747.07 7807.91,-750.3"/>
</g>
<!-- dp0_gate_s0_l2_tp1 -->
<g id="node43" class="node">
<title>dp0_gate_s0_l2_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7413.05,-912.43 6951.6,-912.43 6832.89,-836.43 7294.34,-836.43 7413.05,-912.43"/>
<text text-anchor="middle" x="7122.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="7122.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7122.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l2_tp1&#45;&gt;dp0_moe_s0_l2_tp1 -->
<g id="edge37" class="edge">
<title>dp0_gate_s0_l2_tp1&#45;&gt;dp0_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7165.05,-836.25C7196.55,-808.41 7238.79,-771.07 7266.44,-746.64"/>
<polygon fill="black" stroke="black" points="7269,-749.05 7274.17,-739.81 7264.36,-743.81 7269,-749.05"/>
</g>
<!-- dp0_gate_s0_l2_tp2 -->
<g id="node45" class="node">
<title>dp0_gate_s0_l2_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8946.05,-912.43 8484.6,-912.43 8365.89,-836.43 8827.34,-836.43 8946.05,-912.43"/>
<text text-anchor="middle" x="8655.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="8655.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="8655.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l2_tp2&#45;&gt;dp0_moe_s0_l2_tp2 -->
<g id="edge39" class="edge">
<title>dp0_gate_s0_l2_tp2&#45;&gt;dp0_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8625.39,-836.25C8602.79,-808.77 8572.58,-772.03 8552.49,-747.59"/>
<polygon fill="black" stroke="black" points="8555.14,-745.31 8546.08,-739.81 8549.73,-749.76 8555.14,-745.31"/>
</g>
<!-- dp0_gate_s0_l2_tp3 -->
<g id="node47" class="node">
<title>dp0_gate_s0_l2_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9563.05,-912.43 9101.6,-912.43 8982.89,-836.43 9444.34,-836.43 9563.05,-912.43"/>
<text text-anchor="middle" x="9272.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="9272.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9272.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3 -->
<g id="edge41" class="edge">
<title>dp0_gate_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9235.3,-836.25C9207.21,-808.53 9169.59,-771.39 9144.84,-746.96"/>
<polygon fill="black" stroke="black" points="9147.17,-744.34 9137.59,-739.81 9142.25,-749.32 9147.17,-744.34"/>
</g>
<!-- dp0_attn_s0_l3_tp0 -->
<g id="node48" class="node">
<title>dp0_attn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="9862.47,-893.43 9599.47,-893.43 9599.47,-855.43 9862.47,-855.43 9862.47,-893.43"/>
<text text-anchor="middle" x="9730.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="9730.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_ar0 -->
<g id="node52" class="node">
<title>dp0_attn_s0_l3_ar0</title>
<ellipse fill="none" stroke="black" cx="9730.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="9730.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="9730.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_tp0&#45;&gt;dp0_attn_s0_l3_ar0 -->
<g id="edge42" class="edge">
<title>dp0_attn_s0_l3_tp0&#45;&gt;dp0_attn_s0_l3_ar0</title>
<path fill="none" stroke="black" d="M9730.97,-855.4C9730.97,-831.41 9730.97,-788.45 9730.97,-757.64"/>
<polygon fill="black" stroke="black" points="9734.47,-757.3 9730.97,-747.3 9727.47,-757.3 9734.47,-757.3"/>
</g>
<!-- dp0_attn_s0_l3_tp1 -->
<g id="node49" class="node">
<title>dp0_attn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="9862.47,-600.19 9599.47,-600.19 9599.47,-562.19 9862.47,-562.19 9862.47,-600.19"/>
<text text-anchor="middle" x="9730.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="9730.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_ar1 -->
<g id="node53" class="node">
<title>dp0_attn_s0_l3_ar1</title>
<ellipse fill="none" stroke="black" cx="9730.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="9730.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="9730.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_tp1&#45;&gt;dp0_attn_s0_l3_ar1 -->
<g id="edge44" class="edge">
<title>dp0_attn_s0_l3_tp1&#45;&gt;dp0_attn_s0_l3_ar1</title>
<path fill="none" stroke="black" d="M9730.97,-562.15C9730.97,-545.47 9730.97,-520.18 9730.97,-499.32"/>
<polygon fill="black" stroke="black" points="9734.47,-499.2 9730.97,-489.2 9727.47,-499.2 9734.47,-499.2"/>
</g>
<!-- dp0_attn_s0_l3_tp2 -->
<g id="node50" class="node">
<title>dp0_attn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="9862.47,-368.35 9599.47,-368.35 9599.47,-330.35 9862.47,-330.35 9862.47,-368.35"/>
<text text-anchor="middle" x="9730.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="9730.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_ar2 -->
<g id="node54" class="node">
<title>dp0_attn_s0_l3_ar2</title>
<ellipse fill="none" stroke="black" cx="9730.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="9730.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="9730.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="9730.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_tp2&#45;&gt;dp0_attn_s0_l3_ar2 -->
<g id="edge46" class="edge">
<title>dp0_attn_s0_l3_tp2&#45;&gt;dp0_attn_s0_l3_ar2</title>
<path fill="none" stroke="black" d="M9730.97,-330.06C9730.97,-314.82 9730.97,-292.65 9730.97,-273.84"/>
<polygon fill="black" stroke="black" points="9734.47,-273.8 9730.97,-263.8 9727.47,-273.8 9734.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l3_tp3 -->
<g id="node51" class="node">
<title>dp0_attn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="11395.47,-893.43 11132.47,-893.43 11132.47,-855.43 11395.47,-855.43 11395.47,-893.43"/>
<text text-anchor="middle" x="11263.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="11263.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="11263.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l3_tp0 -->
<g id="node55" class="node">
<title>dp0_moe_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="11070.97,-739.43 10790.97,-739.43 10790.97,-701.43 11070.97,-701.43 11070.97,-739.43"/>
<text text-anchor="middle" x="10930.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="10930.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10930.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp0 -->
<g id="edge47" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M11224.46,-855.4C11163.38,-827.51 11046.15,-774 10979.83,-743.73"/>
<polygon fill="black" stroke="black" points="10980.98,-740.41 10970.42,-739.44 10978.07,-746.77 10980.98,-740.41"/>
</g>
<!-- dp0_moe_s0_l3_tp1 -->
<g id="node57" class="node">
<title>dp0_moe_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="10482.97,-739.43 10202.97,-739.43 10202.97,-701.43 10482.97,-701.43 10482.97,-739.43"/>
<text text-anchor="middle" x="10342.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="10342.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10342.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp1 -->
<g id="edge49" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M11196.69,-855.41C11170.94,-848.88 11141.2,-841.81 11113.97,-836.43 10899.77,-794.13 10649.34,-759.47 10493.41,-739.62"/>
<polygon fill="black" stroke="black" points="10493.64,-736.12 10483.28,-738.34 10492.76,-743.07 10493.64,-736.12"/>
</g>
<!-- dp0_moe_s0_l3_tp2 -->
<g id="node59" class="node">
<title>dp0_moe_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="11746.97,-739.43 11466.97,-739.43 11466.97,-701.43 11746.97,-701.43 11746.97,-739.43"/>
<text text-anchor="middle" x="11606.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="11606.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="11606.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp2 -->
<g id="edge51" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M11304.66,-855.4C11367.71,-827.46 11488.83,-773.78 11557.06,-743.54"/>
<polygon fill="black" stroke="black" points="11558.6,-746.69 11566.33,-739.44 11555.77,-740.29 11558.6,-746.69"/>
</g>
<!-- dp0_moe_s0_l3_tp3 -->
<g id="node61" class="node">
<title>dp0_moe_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="12324.97,-739.43 12044.97,-739.43 12044.97,-701.43 12324.97,-701.43 12324.97,-739.43"/>
<text text-anchor="middle" x="12184.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="12184.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="12184.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3 -->
<g id="edge53" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M11331.25,-855.41C11357,-848.88 11386.73,-841.81 11413.97,-836.43 11628.17,-794.13 11878.6,-759.47 12034.52,-739.62"/>
<polygon fill="black" stroke="black" points="12035.18,-743.07 12044.66,-738.34 12034.3,-736.12 12035.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l3_ar0&#45;&gt;dp0_attn_s0_l3_tp1 -->
<g id="edge43" class="edge">
<title>dp0_attn_s0_l3_ar0&#45;&gt;dp0_attn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M9730.97,-693.29C9730.97,-669.58 9730.97,-634.72 9730.97,-610.39"/>
<polygon fill="black" stroke="black" points="9734.47,-610.35 9730.97,-600.35 9727.47,-610.35 9734.47,-610.35"/>
</g>
<!-- dp0_attn_s0_l3_ar1&#45;&gt;dp0_attn_s0_l3_tp2 -->
<g id="edge45" class="edge">
<title>dp0_attn_s0_l3_ar1&#45;&gt;dp0_attn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M9730.97,-435.13C9730.97,-418.19 9730.97,-396.07 9730.97,-378.68"/>
<polygon fill="black" stroke="black" points="9734.47,-378.54 9730.97,-368.54 9727.47,-378.54 9734.47,-378.54"/>
</g>
<!-- dp0_gate_s0_l3_tp0 -->
<g id="node56" class="node">
<title>dp0_gate_s0_l3_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11096.05,-912.43 10634.6,-912.43 10515.89,-836.43 10977.34,-836.43 11096.05,-912.43"/>
<text text-anchor="middle" x="10805.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="10805.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10805.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l3_tp0&#45;&gt;dp0_moe_s0_l3_tp0 -->
<g id="edge48" class="edge">
<title>dp0_gate_s0_l3_tp0&#45;&gt;dp0_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10836.55,-836.25C10859.15,-808.77 10889.35,-772.03 10909.45,-747.59"/>
<polygon fill="black" stroke="black" points="10912.21,-749.76 10915.85,-739.81 10906.8,-745.31 10912.21,-749.76"/>
</g>
<!-- dp0_gate_s0_l3_tp1 -->
<g id="node58" class="node">
<title>dp0_gate_s0_l3_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10479.05,-912.43 10017.6,-912.43 9898.89,-836.43 10360.34,-836.43 10479.05,-912.43"/>
<text text-anchor="middle" x="10188.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="10188.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10188.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l3_tp1&#45;&gt;dp0_moe_s0_l3_tp1 -->
<g id="edge50" class="edge">
<title>dp0_gate_s0_l3_tp1&#45;&gt;dp0_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10226.64,-836.25C10254.72,-808.53 10292.35,-771.39 10317.1,-746.96"/>
<polygon fill="black" stroke="black" points="10319.69,-749.32 10324.35,-739.81 10314.77,-744.34 10319.69,-749.32"/>
</g>
<!-- dp0_gate_s0_l3_tp2 -->
<g id="node60" class="node">
<title>dp0_gate_s0_l3_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12012.05,-912.43 11550.6,-912.43 11431.89,-836.43 11893.34,-836.43 12012.05,-912.43"/>
<text text-anchor="middle" x="11721.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="11721.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="11721.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l3_tp2&#45;&gt;dp0_moe_s0_l3_tp2 -->
<g id="edge52" class="edge">
<title>dp0_gate_s0_l3_tp2&#45;&gt;dp0_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11693.84,-836.25C11673.14,-808.89 11645.5,-772.35 11627.01,-747.91"/>
<polygon fill="black" stroke="black" points="11629.7,-745.67 11620.87,-739.81 11624.12,-749.89 11629.7,-745.67"/>
</g>
<!-- dp0_gate_s0_l3_tp3 -->
<g id="node62" class="node">
<title>dp0_gate_s0_l3_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12629.05,-912.43 12167.6,-912.43 12048.89,-836.43 12510.34,-836.43 12629.05,-912.43"/>
<text text-anchor="middle" x="12338.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="12338.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="12338.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3 -->
<g id="edge54" class="edge">
<title>dp0_gate_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12301.3,-836.25C12273.21,-808.53 12235.59,-771.39 12210.84,-746.96"/>
<polygon fill="black" stroke="black" points="12213.17,-744.34 12203.59,-739.81 12208.25,-749.32 12213.17,-744.34"/>
</g>
<!-- dp0_attn_s0_l4_tp0 -->
<g id="node63" class="node">
<title>dp0_attn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="12928.47,-893.43 12665.47,-893.43 12665.47,-855.43 12928.47,-855.43 12928.47,-893.43"/>
<text text-anchor="middle" x="12796.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="12796.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_ar0 -->
<g id="node67" class="node">
<title>dp0_attn_s0_l4_ar0</title>
<ellipse fill="none" stroke="black" cx="12796.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="12796.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="12796.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_tp0&#45;&gt;dp0_attn_s0_l4_ar0 -->
<g id="edge55" class="edge">
<title>dp0_attn_s0_l4_tp0&#45;&gt;dp0_attn_s0_l4_ar0</title>
<path fill="none" stroke="black" d="M12796.97,-855.4C12796.97,-831.41 12796.97,-788.45 12796.97,-757.64"/>
<polygon fill="black" stroke="black" points="12800.47,-757.3 12796.97,-747.3 12793.47,-757.3 12800.47,-757.3"/>
</g>
<!-- dp0_attn_s0_l4_tp1 -->
<g id="node64" class="node">
<title>dp0_attn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="12928.47,-600.19 12665.47,-600.19 12665.47,-562.19 12928.47,-562.19 12928.47,-600.19"/>
<text text-anchor="middle" x="12796.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="12796.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_ar1 -->
<g id="node68" class="node">
<title>dp0_attn_s0_l4_ar1</title>
<ellipse fill="none" stroke="black" cx="12796.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="12796.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="12796.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_tp1&#45;&gt;dp0_attn_s0_l4_ar1 -->
<g id="edge57" class="edge">
<title>dp0_attn_s0_l4_tp1&#45;&gt;dp0_attn_s0_l4_ar1</title>
<path fill="none" stroke="black" d="M12796.97,-562.15C12796.97,-545.47 12796.97,-520.18 12796.97,-499.32"/>
<polygon fill="black" stroke="black" points="12800.47,-499.2 12796.97,-489.2 12793.47,-499.2 12800.47,-499.2"/>
</g>
<!-- dp0_attn_s0_l4_tp2 -->
<g id="node65" class="node">
<title>dp0_attn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="12928.47,-368.35 12665.47,-368.35 12665.47,-330.35 12928.47,-330.35 12928.47,-368.35"/>
<text text-anchor="middle" x="12796.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="12796.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_ar2 -->
<g id="node69" class="node">
<title>dp0_attn_s0_l4_ar2</title>
<ellipse fill="none" stroke="black" cx="12796.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="12796.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="12796.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="12796.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_tp2&#45;&gt;dp0_attn_s0_l4_ar2 -->
<g id="edge59" class="edge">
<title>dp0_attn_s0_l4_tp2&#45;&gt;dp0_attn_s0_l4_ar2</title>
<path fill="none" stroke="black" d="M12796.97,-330.06C12796.97,-314.82 12796.97,-292.65 12796.97,-273.84"/>
<polygon fill="black" stroke="black" points="12800.47,-273.8 12796.97,-263.8 12793.47,-273.8 12800.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l4_tp3 -->
<g id="node66" class="node">
<title>dp0_attn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="14461.47,-893.43 14198.47,-893.43 14198.47,-855.43 14461.47,-855.43 14461.47,-893.43"/>
<text text-anchor="middle" x="14329.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="14329.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="14329.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l4_tp0 -->
<g id="node70" class="node">
<title>dp0_moe_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="14057.97,-739.43 13777.97,-739.43 13777.97,-701.43 14057.97,-701.43 14057.97,-739.43"/>
<text text-anchor="middle" x="13917.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="13917.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13917.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp0 -->
<g id="edge60" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M14281.09,-855.4C14204.89,-827.28 14058.09,-773.12 13976.41,-742.99"/>
<polygon fill="black" stroke="black" points="13977.38,-739.62 13966.79,-739.44 13974.96,-746.18 13977.38,-739.62"/>
</g>
<!-- dp0_moe_s0_l4_tp1 -->
<g id="node72" class="node">
<title>dp0_moe_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="13548.97,-739.43 13268.97,-739.43 13268.97,-701.43 13548.97,-701.43 13548.97,-739.43"/>
<text text-anchor="middle" x="13408.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="13408.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13408.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp1 -->
<g id="edge62" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M14262.69,-855.41C14236.94,-848.88 14207.2,-841.81 14179.97,-836.43 14062.41,-813.22 13738.58,-767.09 13550.09,-740.86"/>
<polygon fill="black" stroke="black" points="13550.49,-737.38 13540.11,-739.47 13549.53,-744.31 13550.49,-737.38"/>
</g>
<!-- dp0_moe_s0_l4_tp2 -->
<g id="node74" class="node">
<title>dp0_moe_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="14801.97,-739.43 14521.97,-739.43 14521.97,-701.43 14801.97,-701.43 14801.97,-739.43"/>
<text text-anchor="middle" x="14661.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="14661.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14661.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp2 -->
<g id="edge64" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M14369.36,-855.4C14430.26,-827.51 14547.14,-774 14613.26,-743.73"/>
<polygon fill="black" stroke="black" points="14615,-746.78 14622.63,-739.44 14612.08,-740.42 14615,-746.78"/>
</g>
<!-- dp0_moe_s0_l4_tp3 -->
<g id="node76" class="node">
<title>dp0_moe_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="15390.97,-739.43 15110.97,-739.43 15110.97,-701.43 15390.97,-701.43 15390.97,-739.43"/>
<text text-anchor="middle" x="15250.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="15250.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="15250.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3 -->
<g id="edge66" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M14397.25,-855.41C14423,-848.88 14452.73,-841.81 14479.97,-836.43 14694.17,-794.13 14944.6,-759.47 15100.52,-739.62"/>
<polygon fill="black" stroke="black" points="15101.18,-743.07 15110.66,-738.34 15100.3,-736.12 15101.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l4_ar0&#45;&gt;dp0_attn_s0_l4_tp1 -->
<g id="edge56" class="edge">
<title>dp0_attn_s0_l4_ar0&#45;&gt;dp0_attn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M12796.97,-693.29C12796.97,-669.58 12796.97,-634.72 12796.97,-610.39"/>
<polygon fill="black" stroke="black" points="12800.47,-610.35 12796.97,-600.35 12793.47,-610.35 12800.47,-610.35"/>
</g>
<!-- dp0_attn_s0_l4_ar1&#45;&gt;dp0_attn_s0_l4_tp2 -->
<g id="edge58" class="edge">
<title>dp0_attn_s0_l4_ar1&#45;&gt;dp0_attn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M12796.97,-435.13C12796.97,-418.19 12796.97,-396.07 12796.97,-378.68"/>
<polygon fill="black" stroke="black" points="12800.47,-378.54 12796.97,-368.54 12793.47,-378.54 12800.47,-378.54"/>
</g>
<!-- dp0_gate_s0_l4_tp0 -->
<g id="node71" class="node">
<title>dp0_gate_s0_l4_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="14162.05,-912.43 13700.6,-912.43 13581.89,-836.43 14043.34,-836.43 14162.05,-912.43"/>
<text text-anchor="middle" x="13871.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="13871.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13871.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l4_tp0&#45;&gt;dp0_moe_s0_l4_tp0 -->
<g id="edge61" class="edge">
<title>dp0_gate_s0_l4_tp0&#45;&gt;dp0_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13883.22,-836.25C13891.32,-809.48 13902.08,-773.94 13909.46,-749.53"/>
<polygon fill="black" stroke="black" points="13912.86,-750.39 13912.41,-739.81 13906.16,-748.37 13912.86,-750.39"/>
</g>
<!-- dp0_gate_s0_l4_tp1 -->
<g id="node73" class="node">
<title>dp0_gate_s0_l4_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="13545.05,-912.43 13083.6,-912.43 12964.89,-836.43 13426.34,-836.43 13545.05,-912.43"/>
<text text-anchor="middle" x="13254.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="13254.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13254.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l4_tp1&#45;&gt;dp0_moe_s0_l4_tp1 -->
<g id="edge63" class="edge">
<title>dp0_gate_s0_l4_tp1&#45;&gt;dp0_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13292.64,-836.25C13320.72,-808.53 13358.35,-771.39 13383.1,-746.96"/>
<polygon fill="black" stroke="black" points="13385.69,-749.32 13390.35,-739.81 13380.77,-744.34 13385.69,-749.32"/>
</g>
<!-- dp0_gate_s0_l4_tp2 -->
<g id="node75" class="node">
<title>dp0_gate_s0_l4_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15078.05,-912.43 14616.6,-912.43 14497.89,-836.43 14959.34,-836.43 15078.05,-912.43"/>
<text text-anchor="middle" x="14787.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="14787.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14787.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l4_tp2&#45;&gt;dp0_moe_s0_l4_tp2 -->
<g id="edge65" class="edge">
<title>dp0_gate_s0_l4_tp2&#45;&gt;dp0_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14757.15,-836.25C14734.37,-808.77 14703.92,-772.03 14683.66,-747.59"/>
<polygon fill="black" stroke="black" points="14686.28,-745.27 14677.2,-739.81 14680.89,-749.74 14686.28,-745.27"/>
</g>
<!-- dp0_gate_s0_l4_tp3 -->
<g id="node77" class="node">
<title>dp0_gate_s0_l4_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15695.05,-912.43 15233.6,-912.43 15114.89,-836.43 15576.34,-836.43 15695.05,-912.43"/>
<text text-anchor="middle" x="15404.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="15404.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="15404.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3 -->
<g id="edge67" class="edge">
<title>dp0_gate_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15367.3,-836.25C15339.21,-808.53 15301.59,-771.39 15276.84,-746.96"/>
<polygon fill="black" stroke="black" points="15279.17,-744.34 15269.59,-739.81 15274.25,-749.32 15279.17,-744.34"/>
</g>
<!-- dp0_attn_s0_l5_tp0 -->
<g id="node78" class="node">
<title>dp0_attn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="15994.47,-893.43 15731.47,-893.43 15731.47,-855.43 15994.47,-855.43 15994.47,-893.43"/>
<text text-anchor="middle" x="15862.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="15862.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_ar0 -->
<g id="node82" class="node">
<title>dp0_attn_s0_l5_ar0</title>
<ellipse fill="none" stroke="black" cx="15862.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="15862.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15862.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_tp0&#45;&gt;dp0_attn_s0_l5_ar0 -->
<g id="edge68" class="edge">
<title>dp0_attn_s0_l5_tp0&#45;&gt;dp0_attn_s0_l5_ar0</title>
<path fill="none" stroke="black" d="M15862.97,-855.4C15862.97,-831.41 15862.97,-788.45 15862.97,-757.64"/>
<polygon fill="black" stroke="black" points="15866.47,-757.3 15862.97,-747.3 15859.47,-757.3 15866.47,-757.3"/>
</g>
<!-- dp0_attn_s0_l5_tp1 -->
<g id="node79" class="node">
<title>dp0_attn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="15994.47,-600.19 15731.47,-600.19 15731.47,-562.19 15994.47,-562.19 15994.47,-600.19"/>
<text text-anchor="middle" x="15862.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="15862.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_ar1 -->
<g id="node83" class="node">
<title>dp0_attn_s0_l5_ar1</title>
<ellipse fill="none" stroke="black" cx="15862.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="15862.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15862.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_tp1&#45;&gt;dp0_attn_s0_l5_ar1 -->
<g id="edge70" class="edge">
<title>dp0_attn_s0_l5_tp1&#45;&gt;dp0_attn_s0_l5_ar1</title>
<path fill="none" stroke="black" d="M15862.97,-562.15C15862.97,-545.47 15862.97,-520.18 15862.97,-499.32"/>
<polygon fill="black" stroke="black" points="15866.47,-499.2 15862.97,-489.2 15859.47,-499.2 15866.47,-499.2"/>
</g>
<!-- dp0_attn_s0_l5_tp2 -->
<g id="node80" class="node">
<title>dp0_attn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="15994.47,-368.35 15731.47,-368.35 15731.47,-330.35 15994.47,-330.35 15994.47,-368.35"/>
<text text-anchor="middle" x="15862.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="15862.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_ar2 -->
<g id="node84" class="node">
<title>dp0_attn_s0_l5_ar2</title>
<ellipse fill="none" stroke="black" cx="15862.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="15862.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15862.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15862.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_tp2&#45;&gt;dp0_attn_s0_l5_ar2 -->
<g id="edge72" class="edge">
<title>dp0_attn_s0_l5_tp2&#45;&gt;dp0_attn_s0_l5_ar2</title>
<path fill="none" stroke="black" d="M15862.97,-330.06C15862.97,-314.82 15862.97,-292.65 15862.97,-273.84"/>
<polygon fill="black" stroke="black" points="15866.47,-273.8 15862.97,-263.8 15859.47,-273.8 15866.47,-273.8"/>
</g>
<!-- dp0_attn_s0_l5_tp3 -->
<g id="node81" class="node">
<title>dp0_attn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="17527.47,-893.43 17264.47,-893.43 17264.47,-855.43 17527.47,-855.43 17527.47,-893.43"/>
<text text-anchor="middle" x="17395.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="17395.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="17395.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l5_tp0 -->
<g id="node85" class="node">
<title>dp0_moe_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="17310.97,-739.43 17030.97,-739.43 17030.97,-701.43 17310.97,-701.43 17310.97,-739.43"/>
<text text-anchor="middle" x="17170.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="17170.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17170.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp0 -->
<g id="edge73" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M17369.28,-855.4C17328.59,-827.91 17251.06,-775.53 17205.93,-745.05"/>
<polygon fill="black" stroke="black" points="17207.87,-742.14 17197.63,-739.44 17203.96,-747.94 17207.87,-742.14"/>
</g>
<!-- dp0_moe_s0_l5_tp1 -->
<g id="node87" class="node">
<title>dp0_moe_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="16891.97,-739.43 16611.97,-739.43 16611.97,-701.43 16891.97,-701.43 16891.97,-739.43"/>
<text text-anchor="middle" x="16751.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="16751.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16751.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp1 -->
<g id="edge75" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M17323.54,-855.36C17298.93,-849.27 17271.27,-842.49 17245.97,-836.43 17104.4,-802.49 16939.66,-764.43 16840.72,-741.72"/>
<polygon fill="black" stroke="black" points="16841.29,-738.26 16830.76,-739.43 16839.72,-745.08 16841.29,-738.26"/>
</g>
<!-- dp0_moe_s0_l5_tp2 -->
<g id="node89" class="node">
<title>dp0_moe_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="17770.97,-739.43 17490.97,-739.43 17490.97,-701.43 17770.97,-701.43 17770.97,-739.43"/>
<text text-anchor="middle" x="17630.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="17630.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17630.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp2 -->
<g id="edge77" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M17423.85,-855.4C17466.34,-827.91 17547.32,-775.53 17594.45,-745.05"/>
<polygon fill="black" stroke="black" points="17596.63,-747.81 17603.12,-739.44 17592.83,-741.93 17596.63,-747.81"/>
</g>
<!-- dp0_moe_s0_l5_tp3 -->
<g id="node91" class="node">
<title>dp0_moe_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="18456.97,-739.43 18176.97,-739.43 18176.97,-701.43 18456.97,-701.43 18456.97,-739.43"/>
<text text-anchor="middle" x="18316.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="18316.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="18316.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3 -->
<g id="edge79" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M17463.25,-855.41C17489,-848.88 17518.73,-841.81 17545.97,-836.43 17760.17,-794.13 18010.6,-759.47 18166.52,-739.62"/>
<polygon fill="black" stroke="black" points="18167.18,-743.07 18176.66,-738.34 18166.3,-736.12 18167.18,-743.07"/>
</g>
<!-- dp0_attn_s0_l5_ar0&#45;&gt;dp0_attn_s0_l5_tp1 -->
<g id="edge69" class="edge">
<title>dp0_attn_s0_l5_ar0&#45;&gt;dp0_attn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M15862.97,-693.29C15862.97,-669.58 15862.97,-634.72 15862.97,-610.39"/>
<polygon fill="black" stroke="black" points="15866.47,-610.35 15862.97,-600.35 15859.47,-610.35 15866.47,-610.35"/>
</g>
<!-- dp0_attn_s0_l5_ar1&#45;&gt;dp0_attn_s0_l5_tp2 -->
<g id="edge71" class="edge">
<title>dp0_attn_s0_l5_ar1&#45;&gt;dp0_attn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M15862.97,-435.13C15862.97,-418.19 15862.97,-396.07 15862.97,-378.68"/>
<polygon fill="black" stroke="black" points="15866.47,-378.54 15862.97,-368.54 15859.47,-378.54 15866.47,-378.54"/>
</g>
<!-- dp0_gate_s0_l5_tp0 -->
<g id="node86" class="node">
<title>dp0_gate_s0_l5_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="17228.05,-912.43 16766.6,-912.43 16647.89,-836.43 17109.34,-836.43 17228.05,-912.43"/>
<text text-anchor="middle" x="16937.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="16937.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16937.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l5_tp0&#45;&gt;dp0_moe_s0_l5_tp0 -->
<g id="edge74" class="edge">
<title>dp0_gate_s0_l5_tp0&#45;&gt;dp0_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16994.97,-836.25C17038.5,-807.85 17097.18,-769.57 17134.55,-745.19"/>
<polygon fill="black" stroke="black" points="17136.65,-748 17143.11,-739.6 17132.82,-742.14 17136.65,-748"/>
</g>
<!-- dp0_gate_s0_l5_tp1 -->
<g id="node88" class="node">
<title>dp0_gate_s0_l5_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16611.05,-912.43 16149.6,-912.43 16030.89,-836.43 16492.34,-836.43 16611.05,-912.43"/>
<text text-anchor="middle" x="16320.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="16320.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16320.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l5_tp1&#45;&gt;dp0_moe_s0_l5_tp1 -->
<g id="edge76" class="edge">
<title>dp0_gate_s0_l5_tp1&#45;&gt;dp0_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16426.13,-836.34C16509.14,-807.07 16622.06,-767.24 16690.84,-742.99"/>
<polygon fill="black" stroke="black" points="16692.39,-746.15 16700.66,-739.53 16690.06,-739.55 16692.39,-746.15"/>
</g>
<!-- dp0_gate_s0_l5_tp2 -->
<g id="node90" class="node">
<title>dp0_gate_s0_l5_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18144.05,-912.43 17682.6,-912.43 17563.89,-836.43 18025.34,-836.43 18144.05,-912.43"/>
<text text-anchor="middle" x="17853.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="17853.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17853.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l5_tp2&#45;&gt;dp0_moe_s0_l5_tp2 -->
<g id="edge78" class="edge">
<title>dp0_gate_s0_l5_tp2&#45;&gt;dp0_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17799.42,-836.25C17757.93,-807.97 17702.07,-769.89 17666.28,-745.5"/>
<polygon fill="black" stroke="black" points="17667.87,-742.34 17657.63,-739.6 17663.93,-748.13 17667.87,-742.34"/>
</g>
<!-- dp0_pp_s0_to_s1 -->
<g id="node93" class="node">
<title>dp0_pp_s0_to_s1</title>
<ellipse fill="none" stroke="black" cx="18316.97" cy="-581.19" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="18316.97" y="-588.99" font-family="Times,serif" font-size="9.00">Pipeline Stage 01</text>
<text text-anchor="middle" x="18316.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="18316.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU7GPU8</text>
</g>
<!-- dp0_moe_s0_l5_tp3&#45;&gt;dp0_pp_s0_to_s1 -->
<g id="edge81" class="edge">
<title>dp0_moe_s0_l5_tp3&#45;&gt;dp0_pp_s0_to_s1</title>
<path fill="none" stroke="black" d="M18316.97,-701.2C18316.97,-680.16 18316.97,-645.01 18316.97,-618.35"/>
<polygon fill="black" stroke="black" points="18320.47,-618.24 18316.97,-608.24 18313.47,-618.24 18320.47,-618.24"/>
</g>
<!-- dp0_gate_s0_l5_tp3 -->
<g id="node92" class="node">
<title>dp0_gate_s0_l5_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18761.05,-912.43 18299.6,-912.43 18180.89,-836.43 18642.34,-836.43 18761.05,-912.43"/>
<text text-anchor="middle" x="18470.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="18470.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="18470.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3 -->
<g id="edge80" class="edge">
<title>dp0_gate_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18433.3,-836.25C18405.21,-808.53 18367.59,-771.39 18342.84,-746.96"/>
<polygon fill="black" stroke="black" points="18345.17,-744.34 18335.59,-739.81 18340.25,-749.32 18345.17,-744.34"/>
</g>
<!-- dp0_pp_s1_to_s2 -->
<g id="node94" class="node">
<title>dp0_pp_s1_to_s2</title>
<ellipse fill="none" stroke="black" cx="18316.97" cy="-462.09" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="18316.97" y="-469.89" font-family="Times,serif" font-size="9.00">Pipeline Stage 12</text>
<text text-anchor="middle" x="18316.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="18316.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU15GPU16</text>
</g>
<!-- dp0_pp_s0_to_s1&#45;&gt;dp0_pp_s1_to_s2 -->
<g id="edge82" class="edge">
<title>dp0_pp_s0_to_s1&#45;&gt;dp0_pp_s1_to_s2</title>
<path fill="none" stroke="black" d="M18316.97,-554.21C18316.97,-537.98 18316.97,-516.87 18316.97,-499.05"/>
<polygon fill="black" stroke="black" points="18320.47,-499.01 18316.97,-489.01 18313.47,-499.01 18320.47,-499.01"/>
</g>
<!-- dp0_pp_s2_to_s3 -->
<g id="node95" class="node">
<title>dp0_pp_s2_to_s3</title>
<ellipse fill="none" stroke="black" cx="18316.97" cy="-349.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="18316.97" y="-357.15" font-family="Times,serif" font-size="9.00">Pipeline Stage 23</text>
<text text-anchor="middle" x="18316.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="18316.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU23GPU24</text>
</g>
<!-- dp0_pp_s1_to_s2&#45;&gt;dp0_pp_s2_to_s3 -->
<g id="edge83" class="edge">
<title>dp0_pp_s1_to_s2&#45;&gt;dp0_pp_s2_to_s3</title>
<path fill="none" stroke="black" d="M18316.97,-435.13C18316.97,-420.65 18316.97,-402.4 18316.97,-386.55"/>
<polygon fill="black" stroke="black" points="18320.47,-386.53 18316.97,-376.53 18313.47,-386.53 18320.47,-386.53"/>
</g>
<!-- dp0_final_s3_tp0 -->
<g id="node96" class="node">
<title>dp0_final_s3_tp0</title>
<polygon fill="none" stroke="black" points="18439.47,-255.61 18194.47,-255.61 18194.47,-217.61 18439.47,-217.61 18439.47,-255.61"/>
<text text-anchor="middle" x="18316.97" y="-244.41" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="18316.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="18316.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU24</text>
</g>
<!-- dp0_pp_s2_to_s3&#45;&gt;dp0_final_s3_tp0 -->
<g id="edge84" class="edge">
<title>dp0_pp_s2_to_s3&#45;&gt;dp0_final_s3_tp0</title>
<path fill="none" stroke="black" d="M18316.97,-322.39C18316.97,-305.45 18316.97,-283.33 18316.97,-265.94"/>
<polygon fill="black" stroke="black" points="18320.47,-265.8 18316.97,-255.8 18313.47,-265.8 18320.47,-265.8"/>
</g>
<!-- dp0_final_s3_tp1 -->
<g id="node97" class="node">
<title>dp0_final_s3_tp1</title>
<polygon fill="none" stroke="black" points="19042.47,-893.43 18797.47,-893.43 18797.47,-855.43 19042.47,-855.43 19042.47,-893.43"/>
<text text-anchor="middle" x="18919.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="18919.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="18919.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU25</text>
</g>
<!-- dp0_final_s3_tp2 -->
<g id="node98" class="node">
<title>dp0_final_s3_tp2</title>
<polygon fill="none" stroke="black" points="19323.47,-893.43 19078.47,-893.43 19078.47,-855.43 19323.47,-855.43 19323.47,-893.43"/>
<text text-anchor="middle" x="19200.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="19200.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="19200.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU26</text>
</g>
<!-- dp0_final_s3_tp3 -->
<g id="node99" class="node">
<title>dp0_final_s3_tp3</title>
<polygon fill="none" stroke="black" points="19604.47,-893.43 19359.47,-893.43 19359.47,-855.43 19604.47,-855.43 19604.47,-893.43"/>
<text text-anchor="middle" x="19481.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="19481.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="19481.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU27</text>
</g>
<!-- dp0_dp_gather -->
<g id="node100" class="node">
<title>dp0_dp_gather</title>
<polygon fill="none" stroke="black" points="19735.98,-758.43 19331.91,-758.43 19227.96,-682.43 19632.03,-682.43 19735.98,-758.43"/>
<text text-anchor="middle" x="19481.97" y="-728.23" font-family="Times,serif" font-size="9.00">DP Gather 0</text>
<text text-anchor="middle" x="19481.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="19481.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: Host</text>
</g>
<!-- dp0_final_s3_tp3&#45;&gt;dp0_dp_gather -->
<g id="edge85" class="edge">
<title>dp0_final_s3_tp3&#45;&gt;dp0_dp_gather</title>
<path fill="none" stroke="black" d="M19481.97,-855.4C19481.97,-834.15 19481.97,-798.03 19481.97,-768.64"/>
<polygon fill="black" stroke="black" points="19485.47,-768.57 19481.97,-758.57 19478.47,-768.57 19485.47,-768.57"/>
</g>
<!-- output -->
<g id="node199" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="19752.97" cy="-581.19" rx="218.49" ry="33.47"/>
<text text-anchor="middle" x="19752.97" y="-591.09" font-family="Times,serif" font-size="12.00">Output</text>
<text text-anchor="middle" x="19752.97" y="-578.09" font-family="Times,serif" font-size="12.00">[batch_size=512, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="19752.97" y="-565.09" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- dp0_dp_gather&#45;&gt;output -->
<g id="edge170" class="edge">
<title>dp0_dp_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M19555.31,-682.29C19594.78,-662.3 19643.24,-637.76 19682.29,-617.98"/>
<polygon fill="black" stroke="black" points="19684.16,-620.96 19691.5,-613.32 19680.99,-614.72 19684.16,-620.96"/>
</g>
<!-- dp1_attn_s0_l0_ar0 -->
<g id="node105" class="node">
<title>dp1_attn_s0_l0_ar0</title>
<ellipse fill="none" stroke="black" cx="593.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="593.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="593.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="593.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l0_tp0&#45;&gt;dp1_attn_s0_l0_ar0 -->
<g id="edge87" class="edge">
<title>dp1_attn_s0_l0_tp0&#45;&gt;dp1_attn_s0_l0_ar0</title>
<path fill="none" stroke="black" d="M576.2,-562.15C579.2,-545.47 583.73,-520.18 587.47,-499.32"/>
<polygon fill="black" stroke="black" points="590.97,-499.66 589.29,-489.2 584.08,-498.42 590.97,-499.66"/>
</g>
<!-- dp1_attn_s0_l0_tp1 -->
<g id="node102" class="node">
<title>dp1_attn_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="725.47,-368.35 462.47,-368.35 462.47,-330.35 725.47,-330.35 725.47,-368.35"/>
<text text-anchor="middle" x="593.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="593.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="593.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_ar1 -->
<g id="node106" class="node">
<title>dp1_attn_s0_l0_ar1</title>
<ellipse fill="none" stroke="black" cx="593.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="593.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="593.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="593.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_tp1&#45;&gt;dp1_attn_s0_l0_ar1 -->
<g id="edge89" class="edge">
<title>dp1_attn_s0_l0_tp1&#45;&gt;dp1_attn_s0_l0_ar1</title>
<path fill="none" stroke="black" d="M593.97,-330.06C593.97,-314.82 593.97,-292.65 593.97,-273.84"/>
<polygon fill="black" stroke="black" points="597.47,-273.8 593.97,-263.8 590.47,-273.8 597.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l0_tp2 -->
<g id="node103" class="node">
<title>dp1_attn_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="725.47,-150.74 462.47,-150.74 462.47,-112.74 725.47,-112.74 725.47,-150.74"/>
<text text-anchor="middle" x="593.97" y="-139.54" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="593.97" y="-129.54" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="593.97" y="-119.54" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_ar2 -->
<g id="node107" class="node">
<title>dp1_attn_s0_l0_ar2</title>
<ellipse fill="none" stroke="black" cx="593.97" cy="-26.87" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="593.97" y="-34.67" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="593.97" y="-24.67" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="593.97" y="-14.67" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_tp2&#45;&gt;dp1_attn_s0_l0_ar2 -->
<g id="edge91" class="edge">
<title>dp1_attn_s0_l0_tp2&#45;&gt;dp1_attn_s0_l0_ar2</title>
<path fill="none" stroke="black" d="M593.97,-112.35C593.97,-98.98 593.97,-80.45 593.97,-64.14"/>
<polygon fill="black" stroke="black" points="597.47,-63.83 593.97,-53.83 590.47,-63.83 597.47,-63.83"/>
</g>
<!-- dp1_attn_s0_l0_tp3 -->
<g id="node104" class="node">
<title>dp1_attn_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="21681.47,-893.43 21418.47,-893.43 21418.47,-855.43 21681.47,-855.43 21681.47,-893.43"/>
<text text-anchor="middle" x="21549.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L0</text>
<text text-anchor="middle" x="21549.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="21549.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l0_tp0 -->
<g id="node108" class="node">
<title>dp1_moe_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="21345.97,-739.43 21065.97,-739.43 21065.97,-701.43 21345.97,-701.43 21345.97,-739.43"/>
<text text-anchor="middle" x="21205.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="21205.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21205.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp0 -->
<g id="edge92" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M21509.16,-855.4C21445.93,-827.46 21324.46,-773.78 21256.02,-743.54"/>
<polygon fill="black" stroke="black" points="21257.29,-740.28 21246.73,-739.44 21254.46,-746.68 21257.29,-740.28"/>
</g>
<!-- dp1_moe_s0_l0_tp1 -->
<g id="node110" class="node">
<title>dp1_moe_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="20700.97,-739.43 20420.97,-739.43 20420.97,-701.43 20700.97,-701.43 20700.97,-739.43"/>
<text text-anchor="middle" x="20560.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="20560.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="20560.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp1 -->
<g id="edge94" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M21483.47,-855.42C21457.55,-848.83 21427.5,-841.7 21399.97,-836.43 21160.81,-790.67 20879.95,-755.99 20711.44,-737.2"/>
<polygon fill="black" stroke="black" points="20711.58,-733.7 20701.25,-736.07 20710.8,-740.65 20711.58,-733.7"/>
</g>
<!-- dp1_moe_s0_l0_tp2 -->
<g id="node112" class="node">
<title>dp1_moe_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="22021.97,-739.43 21741.97,-739.43 21741.97,-701.43 22021.97,-701.43 22021.97,-739.43"/>
<text text-anchor="middle" x="21881.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="21881.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21881.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp2 -->
<g id="edge96" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M21589.36,-855.4C21650.26,-827.51 21767.14,-774 21833.26,-743.73"/>
<polygon fill="black" stroke="black" points="21835,-746.78 21842.63,-739.44 21832.08,-740.42 21835,-746.78"/>
</g>
<!-- dp1_moe_s0_l0_tp3 -->
<g id="node114" class="node">
<title>dp1_moe_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="22610.97,-739.43 22330.97,-739.43 22330.97,-701.43 22610.97,-701.43 22610.97,-739.43"/>
<text text-anchor="middle" x="22470.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 0</text>
<text text-anchor="middle" x="22470.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="22470.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3 -->
<g id="edge98" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" d="M21617.25,-855.41C21643,-848.88 21672.73,-841.81 21699.97,-836.43 21914.17,-794.13 22164.6,-759.47 22320.52,-739.62"/>
<polygon fill="black" stroke="black" points="22321.18,-743.07 22330.66,-738.34 22320.3,-736.12 22321.18,-743.07"/>
</g>
<!-- dp1_attn_s0_l0_ar0&#45;&gt;dp1_attn_s0_l0_tp1 -->
<g id="edge88" class="edge">
<title>dp1_attn_s0_l0_ar0&#45;&gt;dp1_attn_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M593.97,-435.13C593.97,-418.19 593.97,-396.07 593.97,-378.68"/>
<polygon fill="black" stroke="black" points="597.47,-378.54 593.97,-368.54 590.47,-378.54 597.47,-378.54"/>
</g>
<!-- dp1_attn_s0_l0_ar1&#45;&gt;dp1_attn_s0_l0_tp2 -->
<g id="edge90" class="edge">
<title>dp1_attn_s0_l0_ar1&#45;&gt;dp1_attn_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M593.97,-209.65C593.97,-194.9 593.97,-176.41 593.97,-161.25"/>
<polygon fill="black" stroke="black" points="597.47,-160.91 593.97,-150.91 590.47,-160.91 597.47,-160.91"/>
</g>
<!-- dp1_gate_s0_l0_tp0 -->
<g id="node109" class="node">
<title>dp1_gate_s0_l0_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="21382.05,-912.43 20920.6,-912.43 20801.89,-836.43 21263.34,-836.43 21382.05,-912.43"/>
<text text-anchor="middle" x="21091.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="21091.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21091.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l0_tp0&#45;&gt;dp1_moe_s0_l0_tp0 -->
<g id="edge93" class="edge">
<title>dp1_gate_s0_l0_tp0&#45;&gt;dp1_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21119.86,-836.25C21140.38,-808.89 21167.78,-772.35 21186.11,-747.91"/>
<polygon fill="black" stroke="black" points="21188.98,-749.91 21192.18,-739.81 21183.38,-745.71 21188.98,-749.91"/>
</g>
<!-- dp1_gate_s0_l0_tp1 -->
<g id="node111" class="node">
<title>dp1_gate_s0_l0_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="20765.05,-912.43 20303.6,-912.43 20184.89,-836.43 20646.34,-836.43 20765.05,-912.43"/>
<text text-anchor="middle" x="20474.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="20474.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="20474.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l0_tp1&#45;&gt;dp1_moe_s0_l0_tp1 -->
<g id="edge95" class="edge">
<title>dp1_gate_s0_l0_tp1&#45;&gt;dp1_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M20496.01,-836.25C20511.35,-809.12 20531.8,-772.99 20545.62,-748.56"/>
<polygon fill="black" stroke="black" points="20548.69,-750.24 20550.57,-739.81 20542.6,-746.79 20548.69,-750.24"/>
</g>
<!-- dp1_gate_s0_l0_tp2 -->
<g id="node113" class="node">
<title>dp1_gate_s0_l0_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22298.05,-912.43 21836.6,-912.43 21717.89,-836.43 22179.34,-836.43 22298.05,-912.43"/>
<text text-anchor="middle" x="22007.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="22007.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="22007.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l0_tp2&#45;&gt;dp1_moe_s0_l0_tp2 -->
<g id="edge97" class="edge">
<title>dp1_gate_s0_l0_tp2&#45;&gt;dp1_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21977.15,-836.25C21954.37,-808.77 21923.92,-772.03 21903.66,-747.59"/>
<polygon fill="black" stroke="black" points="21906.28,-745.27 21897.2,-739.81 21900.89,-749.74 21906.28,-745.27"/>
</g>
<!-- dp1_gate_s0_l0_tp3 -->
<g id="node115" class="node">
<title>dp1_gate_s0_l0_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22915.05,-912.43 22453.6,-912.43 22334.89,-836.43 22796.34,-836.43 22915.05,-912.43"/>
<text text-anchor="middle" x="22624.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L0</text>
<text text-anchor="middle" x="22624.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="22624.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3 -->
<g id="edge99" class="edge">
<title>dp1_gate_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22587.3,-836.25C22559.21,-808.53 22521.59,-771.39 22496.84,-746.96"/>
<polygon fill="black" stroke="black" points="22499.17,-744.34 22489.59,-739.81 22494.25,-749.32 22499.17,-744.34"/>
</g>
<!-- dp1_attn_s0_l1_tp0 -->
<g id="node116" class="node">
<title>dp1_attn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="23214.47,-893.43 22951.47,-893.43 22951.47,-855.43 23214.47,-855.43 23214.47,-893.43"/>
<text text-anchor="middle" x="23082.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="23082.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_ar0 -->
<g id="node120" class="node">
<title>dp1_attn_s0_l1_ar0</title>
<ellipse fill="none" stroke="black" cx="23082.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="23082.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23082.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_tp0&#45;&gt;dp1_attn_s0_l1_ar0 -->
<g id="edge100" class="edge">
<title>dp1_attn_s0_l1_tp0&#45;&gt;dp1_attn_s0_l1_ar0</title>
<path fill="none" stroke="black" d="M23082.97,-855.4C23082.97,-831.41 23082.97,-788.45 23082.97,-757.64"/>
<polygon fill="black" stroke="black" points="23086.47,-757.3 23082.97,-747.3 23079.47,-757.3 23086.47,-757.3"/>
</g>
<!-- dp1_attn_s0_l1_tp1 -->
<g id="node117" class="node">
<title>dp1_attn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="23214.47,-600.19 22951.47,-600.19 22951.47,-562.19 23214.47,-562.19 23214.47,-600.19"/>
<text text-anchor="middle" x="23082.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="23082.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_ar1 -->
<g id="node121" class="node">
<title>dp1_attn_s0_l1_ar1</title>
<ellipse fill="none" stroke="black" cx="23082.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="23082.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23082.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_tp1&#45;&gt;dp1_attn_s0_l1_ar1 -->
<g id="edge102" class="edge">
<title>dp1_attn_s0_l1_tp1&#45;&gt;dp1_attn_s0_l1_ar1</title>
<path fill="none" stroke="black" d="M23082.97,-562.15C23082.97,-545.47 23082.97,-520.18 23082.97,-499.32"/>
<polygon fill="black" stroke="black" points="23086.47,-499.2 23082.97,-489.2 23079.47,-499.2 23086.47,-499.2"/>
</g>
<!-- dp1_attn_s0_l1_tp2 -->
<g id="node118" class="node">
<title>dp1_attn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="23214.47,-368.35 22951.47,-368.35 22951.47,-330.35 23214.47,-330.35 23214.47,-368.35"/>
<text text-anchor="middle" x="23082.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="23082.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_ar2 -->
<g id="node122" class="node">
<title>dp1_attn_s0_l1_ar2</title>
<ellipse fill="none" stroke="black" cx="23082.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="23082.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23082.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23082.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_tp2&#45;&gt;dp1_attn_s0_l1_ar2 -->
<g id="edge104" class="edge">
<title>dp1_attn_s0_l1_tp2&#45;&gt;dp1_attn_s0_l1_ar2</title>
<path fill="none" stroke="black" d="M23082.97,-330.06C23082.97,-314.82 23082.97,-292.65 23082.97,-273.84"/>
<polygon fill="black" stroke="black" points="23086.47,-273.8 23082.97,-263.8 23079.47,-273.8 23086.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l1_tp3 -->
<g id="node119" class="node">
<title>dp1_attn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="24747.47,-893.43 24484.47,-893.43 24484.47,-855.43 24747.47,-855.43 24747.47,-893.43"/>
<text text-anchor="middle" x="24615.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L1</text>
<text text-anchor="middle" x="24615.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="24615.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l1_tp0 -->
<g id="node123" class="node">
<title>dp1_moe_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="24422.97,-739.43 24142.97,-739.43 24142.97,-701.43 24422.97,-701.43 24422.97,-739.43"/>
<text text-anchor="middle" x="24282.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="24282.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24282.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp0 -->
<g id="edge105" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M24576.46,-855.4C24515.38,-827.51 24398.15,-774 24331.83,-743.73"/>
<polygon fill="black" stroke="black" points="24332.98,-740.41 24322.42,-739.44 24330.07,-746.77 24332.98,-740.41"/>
</g>
<!-- dp1_moe_s0_l1_tp1 -->
<g id="node125" class="node">
<title>dp1_moe_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="23834.97,-739.43 23554.97,-739.43 23554.97,-701.43 23834.97,-701.43 23834.97,-739.43"/>
<text text-anchor="middle" x="23694.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="23694.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="23694.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp1 -->
<g id="edge107" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M24548.69,-855.41C24522.94,-848.88 24493.2,-841.81 24465.97,-836.43 24251.77,-794.13 24001.34,-759.47 23845.41,-739.62"/>
<polygon fill="black" stroke="black" points="23845.64,-736.12 23835.28,-738.34 23844.76,-743.07 23845.64,-736.12"/>
</g>
<!-- dp1_moe_s0_l1_tp2 -->
<g id="node127" class="node">
<title>dp1_moe_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="25098.97,-739.43 24818.97,-739.43 24818.97,-701.43 25098.97,-701.43 25098.97,-739.43"/>
<text text-anchor="middle" x="24958.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="24958.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24958.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp2 -->
<g id="edge109" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M24656.66,-855.4C24719.71,-827.46 24840.83,-773.78 24909.06,-743.54"/>
<polygon fill="black" stroke="black" points="24910.6,-746.69 24918.33,-739.44 24907.77,-740.29 24910.6,-746.69"/>
</g>
<!-- dp1_moe_s0_l1_tp3 -->
<g id="node129" class="node">
<title>dp1_moe_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="25676.97,-739.43 25396.97,-739.43 25396.97,-701.43 25676.97,-701.43 25676.97,-739.43"/>
<text text-anchor="middle" x="25536.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 1</text>
<text text-anchor="middle" x="25536.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="25536.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3 -->
<g id="edge111" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M24683.25,-855.41C24709,-848.88 24738.73,-841.81 24765.97,-836.43 24980.17,-794.13 25230.6,-759.47 25386.52,-739.62"/>
<polygon fill="black" stroke="black" points="25387.18,-743.07 25396.66,-738.34 25386.3,-736.12 25387.18,-743.07"/>
</g>
<!-- dp1_attn_s0_l1_ar0&#45;&gt;dp1_attn_s0_l1_tp1 -->
<g id="edge101" class="edge">
<title>dp1_attn_s0_l1_ar0&#45;&gt;dp1_attn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M23082.97,-693.29C23082.97,-669.58 23082.97,-634.72 23082.97,-610.39"/>
<polygon fill="black" stroke="black" points="23086.47,-610.35 23082.97,-600.35 23079.47,-610.35 23086.47,-610.35"/>
</g>
<!-- dp1_attn_s0_l1_ar1&#45;&gt;dp1_attn_s0_l1_tp2 -->
<g id="edge103" class="edge">
<title>dp1_attn_s0_l1_ar1&#45;&gt;dp1_attn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M23082.97,-435.13C23082.97,-418.19 23082.97,-396.07 23082.97,-378.68"/>
<polygon fill="black" stroke="black" points="23086.47,-378.54 23082.97,-368.54 23079.47,-378.54 23086.47,-378.54"/>
</g>
<!-- dp1_gate_s0_l1_tp0 -->
<g id="node124" class="node">
<title>dp1_gate_s0_l1_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24448.05,-912.43 23986.6,-912.43 23867.89,-836.43 24329.34,-836.43 24448.05,-912.43"/>
<text text-anchor="middle" x="24157.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="24157.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24157.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l1_tp0&#45;&gt;dp1_moe_s0_l1_tp0 -->
<g id="edge106" class="edge">
<title>dp1_gate_s0_l1_tp0&#45;&gt;dp1_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24188.55,-836.25C24211.15,-808.77 24241.35,-772.03 24261.45,-747.59"/>
<polygon fill="black" stroke="black" points="24264.21,-749.76 24267.85,-739.81 24258.8,-745.31 24264.21,-749.76"/>
</g>
<!-- dp1_gate_s0_l1_tp1 -->
<g id="node126" class="node">
<title>dp1_gate_s0_l1_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23831.05,-912.43 23369.6,-912.43 23250.89,-836.43 23712.34,-836.43 23831.05,-912.43"/>
<text text-anchor="middle" x="23540.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="23540.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="23540.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l1_tp1&#45;&gt;dp1_moe_s0_l1_tp1 -->
<g id="edge108" class="edge">
<title>dp1_gate_s0_l1_tp1&#45;&gt;dp1_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23578.64,-836.25C23606.72,-808.53 23644.35,-771.39 23669.1,-746.96"/>
<polygon fill="black" stroke="black" points="23671.69,-749.32 23676.35,-739.81 23666.77,-744.34 23671.69,-749.32"/>
</g>
<!-- dp1_gate_s0_l1_tp2 -->
<g id="node128" class="node">
<title>dp1_gate_s0_l1_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25364.05,-912.43 24902.6,-912.43 24783.89,-836.43 25245.34,-836.43 25364.05,-912.43"/>
<text text-anchor="middle" x="25073.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="25073.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="25073.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l1_tp2&#45;&gt;dp1_moe_s0_l1_tp2 -->
<g id="edge110" class="edge">
<title>dp1_gate_s0_l1_tp2&#45;&gt;dp1_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25045.84,-836.25C25025.14,-808.89 24997.5,-772.35 24979.01,-747.91"/>
<polygon fill="black" stroke="black" points="24981.7,-745.67 24972.87,-739.81 24976.12,-749.89 24981.7,-745.67"/>
</g>
<!-- dp1_gate_s0_l1_tp3 -->
<g id="node130" class="node">
<title>dp1_gate_s0_l1_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25981.05,-912.43 25519.6,-912.43 25400.89,-836.43 25862.34,-836.43 25981.05,-912.43"/>
<text text-anchor="middle" x="25690.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L1</text>
<text text-anchor="middle" x="25690.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="25690.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3 -->
<g id="edge112" class="edge">
<title>dp1_gate_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25653.3,-836.25C25625.21,-808.53 25587.59,-771.39 25562.84,-746.96"/>
<polygon fill="black" stroke="black" points="25565.17,-744.34 25555.59,-739.81 25560.25,-749.32 25565.17,-744.34"/>
</g>
<!-- dp1_attn_s0_l2_tp0 -->
<g id="node131" class="node">
<title>dp1_attn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="26280.47,-893.43 26017.47,-893.43 26017.47,-855.43 26280.47,-855.43 26280.47,-893.43"/>
<text text-anchor="middle" x="26148.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="26148.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_ar0 -->
<g id="node135" class="node">
<title>dp1_attn_s0_l2_ar0</title>
<ellipse fill="none" stroke="black" cx="26148.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="26148.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26148.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_tp0&#45;&gt;dp1_attn_s0_l2_ar0 -->
<g id="edge113" class="edge">
<title>dp1_attn_s0_l2_tp0&#45;&gt;dp1_attn_s0_l2_ar0</title>
<path fill="none" stroke="black" d="M26148.97,-855.4C26148.97,-831.41 26148.97,-788.45 26148.97,-757.64"/>
<polygon fill="black" stroke="black" points="26152.47,-757.3 26148.97,-747.3 26145.47,-757.3 26152.47,-757.3"/>
</g>
<!-- dp1_attn_s0_l2_tp1 -->
<g id="node132" class="node">
<title>dp1_attn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="26280.47,-600.19 26017.47,-600.19 26017.47,-562.19 26280.47,-562.19 26280.47,-600.19"/>
<text text-anchor="middle" x="26148.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="26148.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_ar1 -->
<g id="node136" class="node">
<title>dp1_attn_s0_l2_ar1</title>
<ellipse fill="none" stroke="black" cx="26148.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="26148.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26148.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_tp1&#45;&gt;dp1_attn_s0_l2_ar1 -->
<g id="edge115" class="edge">
<title>dp1_attn_s0_l2_tp1&#45;&gt;dp1_attn_s0_l2_ar1</title>
<path fill="none" stroke="black" d="M26148.97,-562.15C26148.97,-545.47 26148.97,-520.18 26148.97,-499.32"/>
<polygon fill="black" stroke="black" points="26152.47,-499.2 26148.97,-489.2 26145.47,-499.2 26152.47,-499.2"/>
</g>
<!-- dp1_attn_s0_l2_tp2 -->
<g id="node133" class="node">
<title>dp1_attn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="26280.47,-368.35 26017.47,-368.35 26017.47,-330.35 26280.47,-330.35 26280.47,-368.35"/>
<text text-anchor="middle" x="26148.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="26148.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_ar2 -->
<g id="node137" class="node">
<title>dp1_attn_s0_l2_ar2</title>
<ellipse fill="none" stroke="black" cx="26148.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="26148.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26148.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26148.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_tp2&#45;&gt;dp1_attn_s0_l2_ar2 -->
<g id="edge117" class="edge">
<title>dp1_attn_s0_l2_tp2&#45;&gt;dp1_attn_s0_l2_ar2</title>
<path fill="none" stroke="black" d="M26148.97,-330.06C26148.97,-314.82 26148.97,-292.65 26148.97,-273.84"/>
<polygon fill="black" stroke="black" points="26152.47,-273.8 26148.97,-263.8 26145.47,-273.8 26152.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l2_tp3 -->
<g id="node134" class="node">
<title>dp1_attn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="27813.47,-893.43 27550.47,-893.43 27550.47,-855.43 27813.47,-855.43 27813.47,-893.43"/>
<text text-anchor="middle" x="27681.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L2</text>
<text text-anchor="middle" x="27681.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="27681.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l2_tp0 -->
<g id="node138" class="node">
<title>dp1_moe_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="27488.97,-739.43 27208.97,-739.43 27208.97,-701.43 27488.97,-701.43 27488.97,-739.43"/>
<text text-anchor="middle" x="27348.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="27348.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27348.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp0 -->
<g id="edge118" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M27642.46,-855.4C27581.38,-827.51 27464.15,-774 27397.83,-743.73"/>
<polygon fill="black" stroke="black" points="27398.98,-740.41 27388.42,-739.44 27396.07,-746.77 27398.98,-740.41"/>
</g>
<!-- dp1_moe_s0_l2_tp1 -->
<g id="node140" class="node">
<title>dp1_moe_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="27022.97,-739.43 26742.97,-739.43 26742.97,-701.43 27022.97,-701.43 27022.97,-739.43"/>
<text text-anchor="middle" x="26882.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="26882.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="26882.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp1 -->
<g id="edge120" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M27613.11,-855.43C27587.7,-849.05 27558.6,-842.07 27531.97,-836.43 27350.72,-798.06 27139.14,-762.22 27008.09,-741.07"/>
<polygon fill="black" stroke="black" points="27008.44,-737.58 26998.01,-739.44 27007.33,-744.49 27008.44,-737.58"/>
</g>
<!-- dp1_moe_s0_l2_tp2 -->
<g id="node142" class="node">
<title>dp1_moe_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="28154.97,-739.43 27874.97,-739.43 27874.97,-701.43 28154.97,-701.43 28154.97,-739.43"/>
<text text-anchor="middle" x="28014.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="28014.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28014.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp2 -->
<g id="edge122" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M27721.48,-855.4C27782.56,-827.51 27899.79,-774 27966.11,-743.73"/>
<polygon fill="black" stroke="black" points="27967.87,-746.77 27975.51,-739.44 27964.96,-740.41 27967.87,-746.77"/>
</g>
<!-- dp1_moe_s0_l2_tp3 -->
<g id="node144" class="node">
<title>dp1_moe_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="28746.97,-739.43 28466.97,-739.43 28466.97,-701.43 28746.97,-701.43 28746.97,-739.43"/>
<text text-anchor="middle" x="28606.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 2</text>
<text text-anchor="middle" x="28606.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28606.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3 -->
<g id="edge124" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M27749.24,-855.4C27775,-848.87 27804.73,-841.8 27831.97,-836.43 28047.6,-793.93 28299.77,-759.27 28456.45,-739.48"/>
<polygon fill="black" stroke="black" points="28457.15,-742.92 28466.63,-738.2 28456.27,-735.97 28457.15,-742.92"/>
</g>
<!-- dp1_attn_s0_l2_ar0&#45;&gt;dp1_attn_s0_l2_tp1 -->
<g id="edge114" class="edge">
<title>dp1_attn_s0_l2_ar0&#45;&gt;dp1_attn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M26148.97,-693.29C26148.97,-669.58 26148.97,-634.72 26148.97,-610.39"/>
<polygon fill="black" stroke="black" points="26152.47,-610.35 26148.97,-600.35 26145.47,-610.35 26152.47,-610.35"/>
</g>
<!-- dp1_attn_s0_l2_ar1&#45;&gt;dp1_attn_s0_l2_tp2 -->
<g id="edge116" class="edge">
<title>dp1_attn_s0_l2_ar1&#45;&gt;dp1_attn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M26148.97,-435.13C26148.97,-418.19 26148.97,-396.07 26148.97,-378.68"/>
<polygon fill="black" stroke="black" points="26152.47,-378.54 26148.97,-368.54 26145.47,-378.54 26152.47,-378.54"/>
</g>
<!-- dp1_gate_s0_l2_tp0 -->
<g id="node139" class="node">
<title>dp1_gate_s0_l2_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="27514.05,-912.43 27052.6,-912.43 26933.89,-836.43 27395.34,-836.43 27514.05,-912.43"/>
<text text-anchor="middle" x="27223.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="27223.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27223.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l2_tp0&#45;&gt;dp1_moe_s0_l2_tp0 -->
<g id="edge119" class="edge">
<title>dp1_gate_s0_l2_tp0&#45;&gt;dp1_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27254.55,-836.25C27277.15,-808.77 27307.35,-772.03 27327.45,-747.59"/>
<polygon fill="black" stroke="black" points="27330.21,-749.76 27333.85,-739.81 27324.8,-745.31 27330.21,-749.76"/>
</g>
<!-- dp1_gate_s0_l2_tp1 -->
<g id="node141" class="node">
<title>dp1_gate_s0_l2_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26897.05,-912.43 26435.6,-912.43 26316.89,-836.43 26778.34,-836.43 26897.05,-912.43"/>
<text text-anchor="middle" x="26606.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="26606.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="26606.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l2_tp1&#45;&gt;dp1_moe_s0_l2_tp1 -->
<g id="edge121" class="edge">
<title>dp1_gate_s0_l2_tp1&#45;&gt;dp1_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26674.49,-836.25C26726.48,-807.61 26796.73,-768.92 26840.94,-744.57"/>
<polygon fill="black" stroke="black" points="26842.9,-747.49 26849.97,-739.6 26839.52,-741.36 26842.9,-747.49"/>
</g>
<!-- dp1_gate_s0_l2_tp2 -->
<g id="node143" class="node">
<title>dp1_gate_s0_l2_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="28430.05,-912.43 27968.6,-912.43 27849.89,-836.43 28311.34,-836.43 28430.05,-912.43"/>
<text text-anchor="middle" x="28139.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="28139.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28139.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l2_tp2&#45;&gt;dp1_moe_s0_l2_tp2 -->
<g id="edge123" class="edge">
<title>dp1_gate_s0_l2_tp2&#45;&gt;dp1_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28109.39,-836.25C28086.79,-808.77 28056.58,-772.03 28036.49,-747.59"/>
<polygon fill="black" stroke="black" points="28039.14,-745.31 28030.08,-739.81 28033.73,-749.76 28039.14,-745.31"/>
</g>
<!-- dp1_gate_s0_l2_tp3 -->
<g id="node145" class="node">
<title>dp1_gate_s0_l2_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29047.05,-912.43 28585.6,-912.43 28466.89,-836.43 28928.34,-836.43 29047.05,-912.43"/>
<text text-anchor="middle" x="28756.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L2</text>
<text text-anchor="middle" x="28756.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28756.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3 -->
<g id="edge125" class="edge">
<title>dp1_gate_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28720.27,-836.25C28692.92,-808.53 28656.28,-771.39 28632.16,-746.96"/>
<polygon fill="black" stroke="black" points="28634.62,-744.47 28625.11,-739.81 28629.64,-749.38 28634.62,-744.47"/>
</g>
<!-- dp1_attn_s0_l3_tp0 -->
<g id="node146" class="node">
<title>dp1_attn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="29346.47,-893.43 29083.47,-893.43 29083.47,-855.43 29346.47,-855.43 29346.47,-893.43"/>
<text text-anchor="middle" x="29214.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="29214.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_ar0 -->
<g id="node150" class="node">
<title>dp1_attn_s0_l3_ar0</title>
<ellipse fill="none" stroke="black" cx="29214.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="29214.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29214.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_tp0&#45;&gt;dp1_attn_s0_l3_ar0 -->
<g id="edge126" class="edge">
<title>dp1_attn_s0_l3_tp0&#45;&gt;dp1_attn_s0_l3_ar0</title>
<path fill="none" stroke="black" d="M29214.97,-855.4C29214.97,-831.41 29214.97,-788.45 29214.97,-757.64"/>
<polygon fill="black" stroke="black" points="29218.47,-757.3 29214.97,-747.3 29211.47,-757.3 29218.47,-757.3"/>
</g>
<!-- dp1_attn_s0_l3_tp1 -->
<g id="node147" class="node">
<title>dp1_attn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="29346.47,-600.19 29083.47,-600.19 29083.47,-562.19 29346.47,-562.19 29346.47,-600.19"/>
<text text-anchor="middle" x="29214.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="29214.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_ar1 -->
<g id="node151" class="node">
<title>dp1_attn_s0_l3_ar1</title>
<ellipse fill="none" stroke="black" cx="29214.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="29214.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29214.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_tp1&#45;&gt;dp1_attn_s0_l3_ar1 -->
<g id="edge128" class="edge">
<title>dp1_attn_s0_l3_tp1&#45;&gt;dp1_attn_s0_l3_ar1</title>
<path fill="none" stroke="black" d="M29214.97,-562.15C29214.97,-545.47 29214.97,-520.18 29214.97,-499.32"/>
<polygon fill="black" stroke="black" points="29218.47,-499.2 29214.97,-489.2 29211.47,-499.2 29218.47,-499.2"/>
</g>
<!-- dp1_attn_s0_l3_tp2 -->
<g id="node148" class="node">
<title>dp1_attn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="29346.47,-368.35 29083.47,-368.35 29083.47,-330.35 29346.47,-330.35 29346.47,-368.35"/>
<text text-anchor="middle" x="29214.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="29214.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_ar2 -->
<g id="node152" class="node">
<title>dp1_attn_s0_l3_ar2</title>
<ellipse fill="none" stroke="black" cx="29214.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="29214.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29214.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29214.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_tp2&#45;&gt;dp1_attn_s0_l3_ar2 -->
<g id="edge130" class="edge">
<title>dp1_attn_s0_l3_tp2&#45;&gt;dp1_attn_s0_l3_ar2</title>
<path fill="none" stroke="black" d="M29214.97,-330.06C29214.97,-314.82 29214.97,-292.65 29214.97,-273.84"/>
<polygon fill="black" stroke="black" points="29218.47,-273.8 29214.97,-263.8 29211.47,-273.8 29218.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l3_tp3 -->
<g id="node149" class="node">
<title>dp1_attn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="30879.47,-893.43 30616.47,-893.43 30616.47,-855.43 30879.47,-855.43 30879.47,-893.43"/>
<text text-anchor="middle" x="30747.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L3</text>
<text text-anchor="middle" x="30747.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="30747.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l3_tp0 -->
<g id="node153" class="node">
<title>dp1_moe_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="30600.97,-739.43 30320.97,-739.43 30320.97,-701.43 30600.97,-701.43 30600.97,-739.43"/>
<text text-anchor="middle" x="30460.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="30460.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="30460.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp0 -->
<g id="edge131" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M30713.92,-855.4C30661.6,-827.68 30561.48,-774.66 30504.14,-744.29"/>
<polygon fill="black" stroke="black" points="30505.45,-741.03 30494.97,-739.44 30502.17,-747.21 30505.45,-741.03"/>
</g>
<!-- dp1_moe_s0_l3_tp1 -->
<g id="node155" class="node">
<title>dp1_moe_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="29966.97,-739.43 29686.97,-739.43 29686.97,-701.43 29966.97,-701.43 29966.97,-739.43"/>
<text text-anchor="middle" x="29826.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="29826.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="29826.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp1 -->
<g id="edge133" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M30680.69,-855.41C30654.94,-848.88 30625.2,-841.81 30597.97,-836.43 30383.77,-794.13 30133.34,-759.47 29977.41,-739.62"/>
<polygon fill="black" stroke="black" points="29977.64,-736.12 29967.28,-738.34 29976.76,-743.07 29977.64,-736.12"/>
</g>
<!-- dp1_moe_s0_l3_tp2 -->
<g id="node157" class="node">
<title>dp1_moe_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="31173.97,-739.43 30893.97,-739.43 30893.97,-701.43 31173.97,-701.43 31173.97,-739.43"/>
<text text-anchor="middle" x="31033.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="31033.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31033.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp2 -->
<g id="edge135" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M30781.9,-855.4C30834.04,-827.68 30933.81,-774.66 30990.95,-744.29"/>
<polygon fill="black" stroke="black" points="30992.89,-747.22 31000.08,-739.44 30989.61,-741.04 30992.89,-747.22"/>
</g>
<!-- dp1_moe_s0_l3_tp3 -->
<g id="node159" class="node">
<title>dp1_moe_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="31812.97,-739.43 31532.97,-739.43 31532.97,-701.43 31812.97,-701.43 31812.97,-739.43"/>
<text text-anchor="middle" x="31672.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 3</text>
<text text-anchor="middle" x="31672.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31672.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3 -->
<g id="edge137" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M30815.24,-855.4C30841,-848.87 30870.73,-841.8 30897.97,-836.43 31113.6,-793.93 31365.77,-759.27 31522.45,-739.48"/>
<polygon fill="black" stroke="black" points="31523.15,-742.92 31532.63,-738.2 31522.27,-735.97 31523.15,-742.92"/>
</g>
<!-- dp1_attn_s0_l3_ar0&#45;&gt;dp1_attn_s0_l3_tp1 -->
<g id="edge127" class="edge">
<title>dp1_attn_s0_l3_ar0&#45;&gt;dp1_attn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M29214.97,-693.29C29214.97,-669.58 29214.97,-634.72 29214.97,-610.39"/>
<polygon fill="black" stroke="black" points="29218.47,-610.35 29214.97,-600.35 29211.47,-610.35 29218.47,-610.35"/>
</g>
<!-- dp1_attn_s0_l3_ar1&#45;&gt;dp1_attn_s0_l3_tp2 -->
<g id="edge129" class="edge">
<title>dp1_attn_s0_l3_ar1&#45;&gt;dp1_attn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M29214.97,-435.13C29214.97,-418.19 29214.97,-396.07 29214.97,-378.68"/>
<polygon fill="black" stroke="black" points="29218.47,-378.54 29214.97,-368.54 29211.47,-378.54 29218.47,-378.54"/>
</g>
<!-- dp1_gate_s0_l3_tp0 -->
<g id="node154" class="node">
<title>dp1_gate_s0_l3_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30580.05,-912.43 30118.6,-912.43 29999.89,-836.43 30461.34,-836.43 30580.05,-912.43"/>
<text text-anchor="middle" x="30289.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="30289.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="30289.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l3_tp0&#45;&gt;dp1_moe_s0_l3_tp0 -->
<g id="edge132" class="edge">
<title>dp1_gate_s0_l3_tp0&#45;&gt;dp1_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30331.8,-836.25C30363.12,-808.41 30405.12,-771.07 30432.6,-746.64"/>
<polygon fill="black" stroke="black" points="30435.14,-749.07 30440.29,-739.81 30430.49,-743.84 30435.14,-749.07"/>
</g>
<!-- dp1_gate_s0_l3_tp1 -->
<g id="node156" class="node">
<title>dp1_gate_s0_l3_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29963.05,-912.43 29501.6,-912.43 29382.89,-836.43 29844.34,-836.43 29963.05,-912.43"/>
<text text-anchor="middle" x="29672.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="29672.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="29672.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l3_tp1&#45;&gt;dp1_moe_s0_l3_tp1 -->
<g id="edge134" class="edge">
<title>dp1_gate_s0_l3_tp1&#45;&gt;dp1_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29710.64,-836.25C29738.72,-808.53 29776.35,-771.39 29801.1,-746.96"/>
<polygon fill="black" stroke="black" points="29803.69,-749.32 29808.35,-739.81 29798.77,-744.34 29803.69,-749.32"/>
</g>
<!-- dp1_gate_s0_l3_tp2 -->
<g id="node158" class="node">
<title>dp1_gate_s0_l3_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="31496.05,-912.43 31034.6,-912.43 30915.89,-836.43 31377.34,-836.43 31496.05,-912.43"/>
<text text-anchor="middle" x="31205.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="31205.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31205.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l3_tp2&#45;&gt;dp1_moe_s0_l3_tp2 -->
<g id="edge136" class="edge">
<title>dp1_gate_s0_l3_tp2&#45;&gt;dp1_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31163.89,-836.25C31132.39,-808.41 31090.14,-771.07 31062.5,-746.64"/>
<polygon fill="black" stroke="black" points="31064.58,-743.81 31054.77,-739.81 31059.94,-749.05 31064.58,-743.81"/>
</g>
<!-- dp1_gate_s0_l3_tp3 -->
<g id="node160" class="node">
<title>dp1_gate_s0_l3_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="32113.05,-912.43 31651.6,-912.43 31532.89,-836.43 31994.34,-836.43 32113.05,-912.43"/>
<text text-anchor="middle" x="31822.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L3</text>
<text text-anchor="middle" x="31822.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31822.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3 -->
<g id="edge138" class="edge">
<title>dp1_gate_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31786.27,-836.25C31758.92,-808.53 31722.28,-771.39 31698.16,-746.96"/>
<polygon fill="black" stroke="black" points="31700.62,-744.47 31691.11,-739.81 31695.64,-749.38 31700.62,-744.47"/>
</g>
<!-- dp1_attn_s0_l4_tp0 -->
<g id="node161" class="node">
<title>dp1_attn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="32412.47,-893.43 32149.47,-893.43 32149.47,-855.43 32412.47,-855.43 32412.47,-893.43"/>
<text text-anchor="middle" x="32280.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="32280.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_ar0 -->
<g id="node165" class="node">
<title>dp1_attn_s0_l4_ar0</title>
<ellipse fill="none" stroke="black" cx="32280.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="32280.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32280.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_tp0&#45;&gt;dp1_attn_s0_l4_ar0 -->
<g id="edge139" class="edge">
<title>dp1_attn_s0_l4_tp0&#45;&gt;dp1_attn_s0_l4_ar0</title>
<path fill="none" stroke="black" d="M32280.97,-855.4C32280.97,-831.41 32280.97,-788.45 32280.97,-757.64"/>
<polygon fill="black" stroke="black" points="32284.47,-757.3 32280.97,-747.3 32277.47,-757.3 32284.47,-757.3"/>
</g>
<!-- dp1_attn_s0_l4_tp1 -->
<g id="node162" class="node">
<title>dp1_attn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="32412.47,-600.19 32149.47,-600.19 32149.47,-562.19 32412.47,-562.19 32412.47,-600.19"/>
<text text-anchor="middle" x="32280.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="32280.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_ar1 -->
<g id="node166" class="node">
<title>dp1_attn_s0_l4_ar1</title>
<ellipse fill="none" stroke="black" cx="32280.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="32280.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32280.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_tp1&#45;&gt;dp1_attn_s0_l4_ar1 -->
<g id="edge141" class="edge">
<title>dp1_attn_s0_l4_tp1&#45;&gt;dp1_attn_s0_l4_ar1</title>
<path fill="none" stroke="black" d="M32280.97,-562.15C32280.97,-545.47 32280.97,-520.18 32280.97,-499.32"/>
<polygon fill="black" stroke="black" points="32284.47,-499.2 32280.97,-489.2 32277.47,-499.2 32284.47,-499.2"/>
</g>
<!-- dp1_attn_s0_l4_tp2 -->
<g id="node163" class="node">
<title>dp1_attn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="32412.47,-368.35 32149.47,-368.35 32149.47,-330.35 32412.47,-330.35 32412.47,-368.35"/>
<text text-anchor="middle" x="32280.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="32280.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_ar2 -->
<g id="node167" class="node">
<title>dp1_attn_s0_l4_ar2</title>
<ellipse fill="none" stroke="black" cx="32280.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="32280.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32280.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32280.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_tp2&#45;&gt;dp1_attn_s0_l4_ar2 -->
<g id="edge143" class="edge">
<title>dp1_attn_s0_l4_tp2&#45;&gt;dp1_attn_s0_l4_ar2</title>
<path fill="none" stroke="black" d="M32280.97,-330.06C32280.97,-314.82 32280.97,-292.65 32280.97,-273.84"/>
<polygon fill="black" stroke="black" points="32284.47,-273.8 32280.97,-263.8 32277.47,-273.8 32284.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l4_tp3 -->
<g id="node164" class="node">
<title>dp1_attn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="33945.47,-893.43 33682.47,-893.43 33682.47,-855.43 33945.47,-855.43 33945.47,-893.43"/>
<text text-anchor="middle" x="33813.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L4</text>
<text text-anchor="middle" x="33813.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="33813.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l4_tp0 -->
<g id="node168" class="node">
<title>dp1_moe_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="33666.97,-739.43 33386.97,-739.43 33386.97,-701.43 33666.97,-701.43 33666.97,-739.43"/>
<text text-anchor="middle" x="33526.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="33526.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="33526.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp0 -->
<g id="edge144" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M33779.92,-855.4C33727.6,-827.68 33627.48,-774.66 33570.14,-744.29"/>
<polygon fill="black" stroke="black" points="33571.45,-741.03 33560.97,-739.44 33568.17,-747.21 33571.45,-741.03"/>
</g>
<!-- dp1_moe_s0_l4_tp1 -->
<g id="node170" class="node">
<title>dp1_moe_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="33221.97,-739.43 32941.97,-739.43 32941.97,-701.43 33221.97,-701.43 33221.97,-739.43"/>
<text text-anchor="middle" x="33081.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="33081.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="33081.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp1 -->
<g id="edge146" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M33743.54,-855.34C33718.48,-849.09 33690.02,-842.21 33663.97,-836.43 33499.59,-799.94 33307.8,-763.15 33190.66,-741.33"/>
<polygon fill="black" stroke="black" points="33191.08,-737.85 33180.6,-739.46 33189.8,-744.73 33191.08,-737.85"/>
</g>
<!-- dp1_moe_s0_l4_tp2 -->
<g id="node172" class="node">
<title>dp1_moe_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="34239.97,-739.43 33959.97,-739.43 33959.97,-701.43 34239.97,-701.43 34239.97,-739.43"/>
<text text-anchor="middle" x="34099.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="34099.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34099.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp2 -->
<g id="edge148" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M33847.9,-855.4C33900.04,-827.68 33999.81,-774.66 34056.95,-744.29"/>
<polygon fill="black" stroke="black" points="34058.89,-747.22 34066.08,-739.44 34055.61,-741.04 34058.89,-747.22"/>
</g>
<!-- dp1_moe_s0_l4_tp3 -->
<g id="node174" class="node">
<title>dp1_moe_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="34684.97,-739.43 34404.97,-739.43 34404.97,-701.43 34684.97,-701.43 34684.97,-739.43"/>
<text text-anchor="middle" x="34544.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 4</text>
<text text-anchor="middle" x="34544.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34544.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3 -->
<g id="edge150" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M33884.39,-855.34C33909.46,-849.1 33937.92,-842.22 33963.97,-836.43 34128.07,-799.97 34319.53,-763.18 34436.47,-741.35"/>
<polygon fill="black" stroke="black" points="34437.32,-744.75 34446.5,-739.48 34436.03,-737.87 34437.32,-744.75"/>
</g>
<!-- dp1_attn_s0_l4_ar0&#45;&gt;dp1_attn_s0_l4_tp1 -->
<g id="edge140" class="edge">
<title>dp1_attn_s0_l4_ar0&#45;&gt;dp1_attn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M32280.97,-693.29C32280.97,-669.58 32280.97,-634.72 32280.97,-610.39"/>
<polygon fill="black" stroke="black" points="32284.47,-610.35 32280.97,-600.35 32277.47,-610.35 32284.47,-610.35"/>
</g>
<!-- dp1_attn_s0_l4_ar1&#45;&gt;dp1_attn_s0_l4_tp2 -->
<g id="edge142" class="edge">
<title>dp1_attn_s0_l4_ar1&#45;&gt;dp1_attn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M32280.97,-435.13C32280.97,-418.19 32280.97,-396.07 32280.97,-378.68"/>
<polygon fill="black" stroke="black" points="32284.47,-378.54 32280.97,-368.54 32277.47,-378.54 32284.47,-378.54"/>
</g>
<!-- dp1_gate_s0_l4_tp0 -->
<g id="node169" class="node">
<title>dp1_gate_s0_l4_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="33646.05,-912.43 33184.6,-912.43 33065.89,-836.43 33527.34,-836.43 33646.05,-912.43"/>
<text text-anchor="middle" x="33355.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="33355.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="33355.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l4_tp0&#45;&gt;dp1_moe_s0_l4_tp0 -->
<g id="edge145" class="edge">
<title>dp1_gate_s0_l4_tp0&#45;&gt;dp1_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33397.8,-836.25C33429.12,-808.41 33471.12,-771.07 33498.6,-746.64"/>
<polygon fill="black" stroke="black" points="33501.14,-749.07 33506.29,-739.81 33496.49,-743.84 33501.14,-749.07"/>
</g>
<!-- dp1_gate_s0_l4_tp1 -->
<g id="node171" class="node">
<title>dp1_gate_s0_l4_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="33029.05,-912.43 32567.6,-912.43 32448.89,-836.43 32910.34,-836.43 33029.05,-912.43"/>
<text text-anchor="middle" x="32738.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="32738.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="32738.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l4_tp1&#45;&gt;dp1_moe_s0_l4_tp1 -->
<g id="edge147" class="edge">
<title>dp1_gate_s0_l4_tp1&#45;&gt;dp1_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32822.88,-836.25C32888.31,-807.25 32976.99,-767.95 33031.8,-743.66"/>
<polygon fill="black" stroke="black" points="33033.23,-746.85 33040.96,-739.6 33030.4,-740.46 33033.23,-746.85"/>
</g>
<!-- dp1_gate_s0_l4_tp2 -->
<g id="node173" class="node">
<title>dp1_gate_s0_l4_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="34562.05,-912.43 34100.6,-912.43 33981.89,-836.43 34443.34,-836.43 34562.05,-912.43"/>
<text text-anchor="middle" x="34271.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="34271.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34271.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l4_tp2&#45;&gt;dp1_moe_s0_l4_tp2 -->
<g id="edge149" class="edge">
<title>dp1_gate_s0_l4_tp2&#45;&gt;dp1_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34229.89,-836.25C34198.39,-808.41 34156.14,-771.07 34128.5,-746.64"/>
<polygon fill="black" stroke="black" points="34130.58,-743.81 34120.77,-739.81 34125.94,-749.05 34130.58,-743.81"/>
</g>
<!-- dp1_gate_s0_l4_tp3 -->
<g id="node175" class="node">
<title>dp1_gate_s0_l4_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="35179.05,-912.43 34717.6,-912.43 34598.89,-836.43 35060.34,-836.43 35179.05,-912.43"/>
<text text-anchor="middle" x="34888.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L4</text>
<text text-anchor="middle" x="34888.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34888.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3 -->
<g id="edge151" class="edge">
<title>dp1_gate_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34804.82,-836.25C34739.19,-807.25 34650.25,-767.95 34595.29,-743.66"/>
<polygon fill="black" stroke="black" points="34596.66,-740.44 34586.1,-739.6 34593.83,-746.85 34596.66,-740.44"/>
</g>
<!-- dp1_attn_s0_l5_tp0 -->
<g id="node176" class="node">
<title>dp1_attn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="35478.47,-893.43 35215.47,-893.43 35215.47,-855.43 35478.47,-855.43 35478.47,-893.43"/>
<text text-anchor="middle" x="35346.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="35346.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_ar0 -->
<g id="node180" class="node">
<title>dp1_attn_s0_l5_ar0</title>
<ellipse fill="none" stroke="black" cx="35346.97" cy="-720.43" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="35346.97" y="-728.23" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35346.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_tp0&#45;&gt;dp1_attn_s0_l5_ar0 -->
<g id="edge152" class="edge">
<title>dp1_attn_s0_l5_tp0&#45;&gt;dp1_attn_s0_l5_ar0</title>
<path fill="none" stroke="black" d="M35346.97,-855.4C35346.97,-831.41 35346.97,-788.45 35346.97,-757.64"/>
<polygon fill="black" stroke="black" points="35350.47,-757.3 35346.97,-747.3 35343.47,-757.3 35350.47,-757.3"/>
</g>
<!-- dp1_attn_s0_l5_tp1 -->
<g id="node177" class="node">
<title>dp1_attn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="35478.47,-600.19 35215.47,-600.19 35215.47,-562.19 35478.47,-562.19 35478.47,-600.19"/>
<text text-anchor="middle" x="35346.97" y="-588.99" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="35346.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_ar1 -->
<g id="node181" class="node">
<title>dp1_attn_s0_l5_ar1</title>
<ellipse fill="none" stroke="black" cx="35346.97" cy="-462.09" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="35346.97" y="-469.89" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35346.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_tp1&#45;&gt;dp1_attn_s0_l5_ar1 -->
<g id="edge154" class="edge">
<title>dp1_attn_s0_l5_tp1&#45;&gt;dp1_attn_s0_l5_ar1</title>
<path fill="none" stroke="black" d="M35346.97,-562.15C35346.97,-545.47 35346.97,-520.18 35346.97,-499.32"/>
<polygon fill="black" stroke="black" points="35350.47,-499.2 35346.97,-489.2 35343.47,-499.2 35350.47,-499.2"/>
</g>
<!-- dp1_attn_s0_l5_tp2 -->
<g id="node178" class="node">
<title>dp1_attn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="35478.47,-368.35 35215.47,-368.35 35215.47,-330.35 35478.47,-330.35 35478.47,-368.35"/>
<text text-anchor="middle" x="35346.97" y="-357.15" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="35346.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_ar2 -->
<g id="node182" class="node">
<title>dp1_attn_s0_l5_ar2</title>
<ellipse fill="none" stroke="black" cx="35346.97" cy="-236.61" rx="185.94" ry="26.74"/>
<text text-anchor="middle" x="35346.97" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35346.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35346.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_tp2&#45;&gt;dp1_attn_s0_l5_ar2 -->
<g id="edge156" class="edge">
<title>dp1_attn_s0_l5_tp2&#45;&gt;dp1_attn_s0_l5_ar2</title>
<path fill="none" stroke="black" d="M35346.97,-330.06C35346.97,-314.82 35346.97,-292.65 35346.97,-273.84"/>
<polygon fill="black" stroke="black" points="35350.47,-273.8 35346.97,-263.8 35343.47,-273.8 35350.47,-273.8"/>
</g>
<!-- dp1_attn_s0_l5_tp3 -->
<g id="node179" class="node">
<title>dp1_attn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="37011.47,-893.43 36748.47,-893.43 36748.47,-855.43 37011.47,-855.43 37011.47,-893.43"/>
<text text-anchor="middle" x="36879.97" y="-882.23" font-family="Times,serif" font-size="9.00">Attention L5</text>
<text text-anchor="middle" x="36879.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, heads=16, d_k=64]</text>
<text text-anchor="middle" x="36879.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l5_tp0 -->
<g id="node183" class="node">
<title>dp1_moe_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="36865.97,-739.43 36585.97,-739.43 36585.97,-701.43 36865.97,-701.43 36865.97,-739.43"/>
<text text-anchor="middle" x="36725.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="36725.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36725.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp0 -->
<g id="edge157" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M36861.7,-855.4C36834.38,-828.43 36782.76,-777.48 36751.66,-746.78"/>
<polygon fill="black" stroke="black" points="36753.79,-743.97 36744.22,-739.44 36748.87,-748.95 36753.79,-743.97"/>
</g>
<!-- dp1_moe_s0_l5_tp1 -->
<g id="node185" class="node">
<title>dp1_moe_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="36098.97,-739.43 35818.97,-739.43 35818.97,-701.43 36098.97,-701.43 36098.97,-739.43"/>
<text text-anchor="middle" x="35958.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="35958.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="35958.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp1 -->
<g id="edge159" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M36812.69,-855.41C36786.94,-848.88 36757.2,-841.81 36729.97,-836.43 36515.77,-794.13 36265.34,-759.47 36109.41,-739.62"/>
<polygon fill="black" stroke="black" points="36109.64,-736.12 36099.28,-738.34 36108.76,-743.07 36109.64,-736.12"/>
</g>
<!-- dp1_moe_s0_l5_tp2 -->
<g id="node187" class="node">
<title>dp1_moe_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="37284.97,-739.43 37004.97,-739.43 37004.97,-701.43 37284.97,-701.43 37284.97,-739.43"/>
<text text-anchor="middle" x="37144.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="37144.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37144.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp2 -->
<g id="edge161" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M36911.41,-855.4C36959.62,-827.74 37051.78,-774.88 37104.78,-744.48"/>
<polygon fill="black" stroke="black" points="37106.64,-747.45 37113.57,-739.44 37103.15,-741.38 37106.64,-747.45"/>
</g>
<!-- dp1_moe_s0_l5_tp3 -->
<g id="node189" class="node">
<title>dp1_moe_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="37781.97,-739.43 37501.97,-739.43 37501.97,-701.43 37781.97,-701.43 37781.97,-739.43"/>
<text text-anchor="middle" x="37641.97" y="-728.23" font-family="Times,serif" font-size="9.00">MoE Layer 5</text>
<text text-anchor="middle" x="37641.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37641.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3 -->
<g id="edge163" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M36949.61,-855.39C36974.85,-849.08 37003.63,-842.15 37029.97,-836.43 37201.96,-799.09 37402.7,-762.73 37526.07,-741.21"/>
<polygon fill="black" stroke="black" points="37527.04,-744.59 37536.29,-739.43 37525.84,-737.7 37527.04,-744.59"/>
</g>
<!-- dp1_attn_s0_l5_ar0&#45;&gt;dp1_attn_s0_l5_tp1 -->
<g id="edge153" class="edge">
<title>dp1_attn_s0_l5_ar0&#45;&gt;dp1_attn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M35346.97,-693.29C35346.97,-669.58 35346.97,-634.72 35346.97,-610.39"/>
<polygon fill="black" stroke="black" points="35350.47,-610.35 35346.97,-600.35 35343.47,-610.35 35350.47,-610.35"/>
</g>
<!-- dp1_attn_s0_l5_ar1&#45;&gt;dp1_attn_s0_l5_tp2 -->
<g id="edge155" class="edge">
<title>dp1_attn_s0_l5_ar1&#45;&gt;dp1_attn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M35346.97,-435.13C35346.97,-418.19 35346.97,-396.07 35346.97,-378.68"/>
<polygon fill="black" stroke="black" points="35350.47,-378.54 35346.97,-368.54 35343.47,-378.54 35350.47,-378.54"/>
</g>
<!-- dp1_gate_s0_l5_tp0 -->
<g id="node184" class="node">
<title>dp1_gate_s0_l5_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="36712.05,-912.43 36250.6,-912.43 36131.89,-836.43 36593.34,-836.43 36712.05,-912.43"/>
<text text-anchor="middle" x="36421.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="36421.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36421.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l5_tp0&#45;&gt;dp1_moe_s0_l5_tp0 -->
<g id="edge158" class="edge">
<title>dp1_gate_s0_l5_tp0&#45;&gt;dp1_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36496.34,-836.25C36553.97,-807.43 36631.96,-768.44 36680.59,-744.12"/>
<polygon fill="black" stroke="black" points="36682.24,-747.21 36689.62,-739.6 36679.11,-740.95 36682.24,-747.21"/>
</g>
<!-- dp1_gate_s0_l5_tp1 -->
<g id="node186" class="node">
<title>dp1_gate_s0_l5_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="36095.05,-912.43 35633.6,-912.43 35514.89,-836.43 35976.34,-836.43 36095.05,-912.43"/>
<text text-anchor="middle" x="35804.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="35804.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="35804.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l5_tp1&#45;&gt;dp1_moe_s0_l5_tp1 -->
<g id="edge160" class="edge">
<title>dp1_gate_s0_l5_tp1&#45;&gt;dp1_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35842.64,-836.25C35870.72,-808.53 35908.35,-771.39 35933.1,-746.96"/>
<polygon fill="black" stroke="black" points="35935.69,-749.32 35940.35,-739.81 35930.77,-744.34 35935.69,-749.32"/>
</g>
<!-- dp1_gate_s0_l5_tp2 -->
<g id="node188" class="node">
<title>dp1_gate_s0_l5_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="37628.05,-912.43 37166.6,-912.43 37047.89,-836.43 37509.34,-836.43 37628.05,-912.43"/>
<text text-anchor="middle" x="37337.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="37337.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37337.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l5_tp2&#45;&gt;dp1_moe_s0_l5_tp2 -->
<g id="edge162" class="edge">
<title>dp1_gate_s0_l5_tp2&#45;&gt;dp1_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37290.76,-836.25C37255,-808.09 37206.91,-770.21 37175.92,-745.81"/>
<polygon fill="black" stroke="black" points="37178.07,-743.04 37168.05,-739.6 37173.74,-748.54 37178.07,-743.04"/>
</g>
<!-- dp1_pp_s0_to_s1 -->
<g id="node191" class="node">
<title>dp1_pp_s0_to_s1</title>
<ellipse fill="none" stroke="black" cx="37641.97" cy="-581.19" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="37641.97" y="-588.99" font-family="Times,serif" font-size="9.00">Pipeline Stage 01</text>
<text text-anchor="middle" x="37641.97" y="-578.99" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="37641.97" y="-568.99" font-family="Times,serif" font-size="9.00">GPU: GPU23GPU24</text>
</g>
<!-- dp1_moe_s0_l5_tp3&#45;&gt;dp1_pp_s0_to_s1 -->
<g id="edge165" class="edge">
<title>dp1_moe_s0_l5_tp3&#45;&gt;dp1_pp_s0_to_s1</title>
<path fill="none" stroke="black" d="M37641.97,-701.2C37641.97,-680.16 37641.97,-645.01 37641.97,-618.35"/>
<polygon fill="black" stroke="black" points="37645.47,-618.24 37641.97,-608.24 37638.47,-618.24 37645.47,-618.24"/>
</g>
<!-- dp1_gate_s0_l5_tp3 -->
<g id="node190" class="node">
<title>dp1_gate_s0_l5_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="38245.05,-912.43 37783.6,-912.43 37664.89,-836.43 38126.34,-836.43 38245.05,-912.43"/>
<text text-anchor="middle" x="37954.97" y="-882.23" font-family="Times,serif" font-size="9.00">Gate Selection L5</text>
<text text-anchor="middle" x="37954.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37954.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3 -->
<g id="edge164" class="edge">
<title>dp1_gate_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37878.4,-836.25C37819.06,-807.43 37738.77,-768.44 37688.69,-744.12"/>
<polygon fill="black" stroke="black" points="37689.92,-740.82 37679.4,-739.6 37686.86,-747.12 37689.92,-740.82"/>
</g>
<!-- dp1_pp_s1_to_s2 -->
<g id="node192" class="node">
<title>dp1_pp_s1_to_s2</title>
<ellipse fill="none" stroke="black" cx="37641.97" cy="-462.09" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="37641.97" y="-469.89" font-family="Times,serif" font-size="9.00">Pipeline Stage 12</text>
<text text-anchor="middle" x="37641.97" y="-459.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="37641.97" y="-449.89" font-family="Times,serif" font-size="9.00">GPU: GPU31GPU32</text>
</g>
<!-- dp1_pp_s0_to_s1&#45;&gt;dp1_pp_s1_to_s2 -->
<g id="edge166" class="edge">
<title>dp1_pp_s0_to_s1&#45;&gt;dp1_pp_s1_to_s2</title>
<path fill="none" stroke="black" d="M37641.97,-554.21C37641.97,-537.98 37641.97,-516.87 37641.97,-499.05"/>
<polygon fill="black" stroke="black" points="37645.47,-499.01 37641.97,-489.01 37638.47,-499.01 37645.47,-499.01"/>
</g>
<!-- dp1_pp_s2_to_s3 -->
<g id="node193" class="node">
<title>dp1_pp_s2_to_s3</title>
<ellipse fill="none" stroke="black" cx="37641.97" cy="-349.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="37641.97" y="-357.15" font-family="Times,serif" font-size="9.00">Pipeline Stage 23</text>
<text text-anchor="middle" x="37641.97" y="-347.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="37641.97" y="-337.15" font-family="Times,serif" font-size="9.00">GPU: GPU39GPU40</text>
</g>
<!-- dp1_pp_s1_to_s2&#45;&gt;dp1_pp_s2_to_s3 -->
<g id="edge167" class="edge">
<title>dp1_pp_s1_to_s2&#45;&gt;dp1_pp_s2_to_s3</title>
<path fill="none" stroke="black" d="M37641.97,-435.13C37641.97,-420.65 37641.97,-402.4 37641.97,-386.55"/>
<polygon fill="black" stroke="black" points="37645.47,-386.53 37641.97,-376.53 37638.47,-386.53 37645.47,-386.53"/>
</g>
<!-- dp1_final_s3_tp0 -->
<g id="node194" class="node">
<title>dp1_final_s3_tp0</title>
<polygon fill="none" stroke="black" points="37764.47,-255.61 37519.47,-255.61 37519.47,-217.61 37764.47,-217.61 37764.47,-255.61"/>
<text text-anchor="middle" x="37641.97" y="-244.41" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="37641.97" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="37641.97" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU40</text>
</g>
<!-- dp1_pp_s2_to_s3&#45;&gt;dp1_final_s3_tp0 -->
<g id="edge168" class="edge">
<title>dp1_pp_s2_to_s3&#45;&gt;dp1_final_s3_tp0</title>
<path fill="none" stroke="black" d="M37641.97,-322.39C37641.97,-305.45 37641.97,-283.33 37641.97,-265.94"/>
<polygon fill="black" stroke="black" points="37645.47,-265.8 37641.97,-255.8 37638.47,-265.8 37645.47,-265.8"/>
</g>
<!-- dp1_final_s3_tp1 -->
<g id="node195" class="node">
<title>dp1_final_s3_tp1</title>
<polygon fill="none" stroke="black" points="38526.47,-893.43 38281.47,-893.43 38281.47,-855.43 38526.47,-855.43 38526.47,-893.43"/>
<text text-anchor="middle" x="38403.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="38403.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="38403.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU41</text>
</g>
<!-- dp1_final_s3_tp2 -->
<g id="node196" class="node">
<title>dp1_final_s3_tp2</title>
<polygon fill="none" stroke="black" points="38807.47,-893.43 38562.47,-893.43 38562.47,-855.43 38807.47,-855.43 38807.47,-893.43"/>
<text text-anchor="middle" x="38684.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="38684.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="38684.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU42</text>
</g>
<!-- dp1_final_s3_tp3 -->
<g id="node197" class="node">
<title>dp1_final_s3_tp3</title>
<polygon fill="none" stroke="black" points="20148.47,-893.43 19903.47,-893.43 19903.47,-855.43 20148.47,-855.43 20148.47,-893.43"/>
<text text-anchor="middle" x="20025.97" y="-882.23" font-family="Times,serif" font-size="9.00">Final Layer Processing</text>
<text text-anchor="middle" x="20025.97" y="-872.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=1024]</text>
<text text-anchor="middle" x="20025.97" y="-862.23" font-family="Times,serif" font-size="9.00">GPU: GPU43</text>
</g>
<!-- dp1_dp_gather -->
<g id="node198" class="node">
<title>dp1_dp_gather</title>
<polygon fill="none" stroke="black" points="20279.98,-758.43 19875.91,-758.43 19771.96,-682.43 20176.03,-682.43 20279.98,-758.43"/>
<text text-anchor="middle" x="20025.97" y="-728.23" font-family="Times,serif" font-size="9.00">DP Gather 1</text>
<text text-anchor="middle" x="20025.97" y="-718.23" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="20025.97" y="-708.23" font-family="Times,serif" font-size="9.00">GPU: Host</text>
</g>
<!-- dp1_final_s3_tp3&#45;&gt;dp1_dp_gather -->
<g id="edge169" class="edge">
<title>dp1_final_s3_tp3&#45;&gt;dp1_dp_gather</title>
<path fill="none" stroke="black" d="M20025.97,-855.4C20025.97,-834.15 20025.97,-798.03 20025.97,-768.64"/>
<polygon fill="black" stroke="black" points="20029.47,-768.57 20025.97,-758.57 20022.47,-768.57 20029.47,-768.57"/>
</g>
<!-- dp1_dp_gather&#45;&gt;output -->
<g id="edge171" class="edge">
<title>dp1_dp_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M19952.09,-682.29C19912.18,-662.23 19863.15,-637.58 19823.73,-617.77"/>
<polygon fill="black" stroke="black" points="19824.95,-614.46 19814.45,-613.1 19821.81,-620.72 19824.95,-614.46"/>
</g>
</g>
</svg>
