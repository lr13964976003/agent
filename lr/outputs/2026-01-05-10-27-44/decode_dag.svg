<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2160pt" height="63pt"
 viewBox="0.00 0.00 2160.00 63.46" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 1126.17)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1126.17 38461.74,-1126.17 38461.74,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="416.24" cy="-1084.17" rx="219.41" ry="33.47"/>
<text text-anchor="middle" x="416.24" y="-1094.07" font-family="Times,serif" font-size="12.00">Input Token</text>
<text text-anchor="middle" x="416.24" y="-1081.07" font-family="Times,serif" font-size="12.00">[batch_size=512, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="416.24" y="-1068.07" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="none" stroke="black" points="737.53,-977.17 226.43,-977.17 94.95,-883.17 606.05,-883.17 737.53,-977.17"/>
<text text-anchor="middle" x="416.24" y="-940.07" font-family="Times,serif" font-size="12.00">Data Parallel Split</text>
<text text-anchor="middle" x="416.24" y="-927.07" font-family="Times,serif" font-size="12.00">[batch_size=256, seq_len=1, heads=64, d_k=64]</text>
<text text-anchor="middle" x="416.24" y="-914.07" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M416.24,-1050.93C416.24,-1032.51 416.24,-1008.88 416.24,-987.49"/>
<polygon fill="black" stroke="black" points="419.74,-987.2 416.24,-977.2 412.74,-987.2 419.74,-987.2"/>
<text text-anchor="middle" x="429.24" y="-1009.17" font-family="Arial" font-size="10.00">DP=2</text>
</g>
<!-- dp0_embed_s0_tp0 -->
<g id="node3" class="node">
<title>dp0_embed_s0_tp0</title>
<polygon fill="none" stroke="black" points="392.74,-809.93 165.74,-809.93 165.74,-771.93 392.74,-771.93 392.74,-809.93"/>
<text text-anchor="middle" x="279.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="279.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="279.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp_split&#45;&gt;dp0_embed_s0_tp0 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;dp0_embed_s0_tp0</title>
<path fill="none" stroke="black" d="M370.24,-883.09C348.48,-861.29 323.3,-836.07 304.95,-817.69"/>
<polygon fill="black" stroke="black" points="307.08,-814.87 297.54,-810.26 302.13,-819.81 307.08,-814.87"/>
</g>
<!-- dp1_embed_s0_tp0 -->
<g id="node109" class="node">
<title>dp1_embed_s0_tp0</title>
<polygon fill="none" stroke="black" points="656.74,-809.93 429.74,-809.93 429.74,-771.93 656.74,-771.93 656.74,-809.93"/>
<text text-anchor="middle" x="543.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="543.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="543.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp_split&#45;&gt;dp1_embed_s0_tp0 -->
<g id="edge91" class="edge">
<title>dp_split&#45;&gt;dp1_embed_s0_tp0</title>
<path fill="none" stroke="black" d="M458.88,-883.09C479.06,-861.29 502.4,-836.07 519.4,-817.69"/>
<polygon fill="black" stroke="black" points="522.05,-819.98 526.28,-810.26 516.92,-815.23 522.05,-819.98"/>
</g>
<!-- dp0_kv_cache_s0_tp0 -->
<g id="node7" class="node">
<title>dp0_kv_cache_s0_tp0</title>
<polygon fill="none" stroke="black" points="378.24,-690.83 106.24,-690.83 106.24,-652.83 378.24,-652.83 378.24,-690.83"/>
<text text-anchor="middle" x="242.24" y="-679.63" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="242.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="242.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_embed_s0_tp0&#45;&gt;dp0_kv_cache_s0_tp0 -->
<g id="edge3" class="edge">
<title>dp0_embed_s0_tp0&#45;&gt;dp0_kv_cache_s0_tp0</title>
<path fill="none" stroke="black" d="M273.54,-771.89C267.56,-752.95 258.07,-722.91 251.1,-700.88"/>
<polygon fill="black" stroke="black" points="254.36,-699.57 248.01,-691.08 247.68,-701.67 254.36,-699.57"/>
</g>
<!-- dp0_embed_s0_tp1 -->
<g id="node4" class="node">
<title>dp0_embed_s0_tp1</title>
<polygon fill="none" stroke="black" points="1022.74,-1103.17 795.74,-1103.17 795.74,-1065.17 1022.74,-1065.17 1022.74,-1103.17"/>
<text text-anchor="middle" x="909.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="909.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="909.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_kv_cache_s0_tp1 -->
<g id="node8" class="node">
<title>dp0_kv_cache_s0_tp1</title>
<polygon fill="none" stroke="black" points="1045.24,-949.17 773.24,-949.17 773.24,-911.17 1045.24,-911.17 1045.24,-949.17"/>
<text text-anchor="middle" x="909.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="909.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="909.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_embed_s0_tp1&#45;&gt;dp0_kv_cache_s0_tp1 -->
<g id="edge4" class="edge">
<title>dp0_embed_s0_tp1&#45;&gt;dp0_kv_cache_s0_tp1</title>
<path fill="none" stroke="black" d="M909.24,-1065.14C909.24,-1038.97 909.24,-990.22 909.24,-959.31"/>
<polygon fill="black" stroke="black" points="912.74,-959.18 909.24,-949.18 905.74,-959.18 912.74,-959.18"/>
</g>
<!-- dp0_embed_s0_tp2 -->
<g id="node5" class="node">
<title>dp0_embed_s0_tp2</title>
<polygon fill="none" stroke="black" points="1330.74,-1103.17 1103.74,-1103.17 1103.74,-1065.17 1330.74,-1065.17 1330.74,-1103.17"/>
<text text-anchor="middle" x="1217.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="1217.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="1217.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_kv_cache_s0_tp2 -->
<g id="node9" class="node">
<title>dp0_kv_cache_s0_tp2</title>
<polygon fill="none" stroke="black" points="1353.24,-949.17 1081.24,-949.17 1081.24,-911.17 1353.24,-911.17 1353.24,-949.17"/>
<text text-anchor="middle" x="1217.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="1217.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="1217.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_embed_s0_tp2&#45;&gt;dp0_kv_cache_s0_tp2 -->
<g id="edge5" class="edge">
<title>dp0_embed_s0_tp2&#45;&gt;dp0_kv_cache_s0_tp2</title>
<path fill="none" stroke="black" d="M1217.24,-1065.14C1217.24,-1038.97 1217.24,-990.22 1217.24,-959.31"/>
<polygon fill="black" stroke="black" points="1220.74,-959.18 1217.24,-949.18 1213.74,-959.18 1220.74,-959.18"/>
</g>
<!-- dp0_embed_s0_tp3 -->
<g id="node6" class="node">
<title>dp0_embed_s0_tp3</title>
<polygon fill="none" stroke="black" points="1638.74,-1103.17 1411.74,-1103.17 1411.74,-1065.17 1638.74,-1065.17 1638.74,-1103.17"/>
<text text-anchor="middle" x="1525.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="1525.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="1525.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_kv_cache_s0_tp3 -->
<g id="node10" class="node">
<title>dp0_kv_cache_s0_tp3</title>
<polygon fill="none" stroke="black" points="1661.24,-949.17 1389.24,-949.17 1389.24,-911.17 1661.24,-911.17 1661.24,-949.17"/>
<text text-anchor="middle" x="1525.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="1525.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="1525.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_embed_s0_tp3&#45;&gt;dp0_kv_cache_s0_tp3 -->
<g id="edge6" class="edge">
<title>dp0_embed_s0_tp3&#45;&gt;dp0_kv_cache_s0_tp3</title>
<path fill="none" stroke="black" d="M1525.24,-1065.14C1525.24,-1038.97 1525.24,-990.22 1525.24,-959.31"/>
<polygon fill="black" stroke="black" points="1528.74,-959.18 1525.24,-949.18 1521.74,-959.18 1528.74,-959.18"/>
</g>
<!-- dp0_attn_s0_l0_tp0 -->
<g id="node11" class="node">
<title>dp0_attn_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="350.74,-578.09 105.74,-578.09 105.74,-540.09 350.74,-540.09 350.74,-578.09"/>
<text text-anchor="middle" x="228.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="228.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="228.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_kv_cache_s0_tp0&#45;&gt;dp0_attn_s0_l0_tp0 -->
<g id="edge7" class="edge">
<title>dp0_kv_cache_s0_tp0&#45;&gt;dp0_attn_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M239.93,-652.54C237.73,-635.15 234.39,-608.72 231.84,-588.57"/>
<polygon fill="black" stroke="black" points="235.28,-587.89 230.56,-578.4 228.34,-588.76 235.28,-587.89"/>
</g>
<!-- dp0_attn_s0_l0_ar0 -->
<g id="node15" class="node">
<title>dp0_attn_s0_l0_ar0</title>
<ellipse fill="none" stroke="black" cx="173.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="173.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="173.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="173.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l0_tp0&#45;&gt;dp0_attn_s0_l0_ar0 -->
<g id="edge8" class="edge">
<title>dp0_attn_s0_l0_tp0&#45;&gt;dp0_attn_s0_l0_ar0</title>
<path fill="none" stroke="black" d="M219.16,-539.8C211.45,-524.28 200.17,-501.57 190.72,-482.54"/>
<polygon fill="black" stroke="black" points="193.83,-480.94 186.25,-473.54 187.56,-484.05 193.83,-480.94"/>
</g>
<!-- dp0_attn_s0_l0_tp1 -->
<g id="node12" class="node">
<title>dp0_attn_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="295.74,-360.48 50.74,-360.48 50.74,-322.48 295.74,-322.48 295.74,-360.48"/>
<text text-anchor="middle" x="173.24" y="-349.28" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="173.24" y="-339.28" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="173.24" y="-329.28" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_ar1 -->
<g id="node16" class="node">
<title>dp0_attn_s0_l0_ar1</title>
<ellipse fill="none" stroke="black" cx="173.24" cy="-236.61" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="173.24" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="173.24" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="173.24" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_tp1&#45;&gt;dp0_attn_s0_l0_ar1 -->
<g id="edge10" class="edge">
<title>dp0_attn_s0_l0_tp1&#45;&gt;dp0_attn_s0_l0_ar1</title>
<path fill="none" stroke="black" d="M173.24,-322.09C173.24,-308.72 173.24,-290.19 173.24,-273.88"/>
<polygon fill="black" stroke="black" points="176.74,-273.57 173.24,-263.57 169.74,-273.57 176.74,-273.57"/>
</g>
<!-- dp0_attn_s0_l0_tp2 -->
<g id="node13" class="node">
<title>dp0_attn_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="295.74,-150.74 50.74,-150.74 50.74,-112.74 295.74,-112.74 295.74,-150.74"/>
<text text-anchor="middle" x="173.24" y="-139.54" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="173.24" y="-129.54" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="173.24" y="-119.54" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_ar2 -->
<g id="node17" class="node">
<title>dp0_attn_s0_l0_ar2</title>
<ellipse fill="none" stroke="black" cx="173.24" cy="-26.87" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="173.24" y="-34.67" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="173.24" y="-24.67" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="173.24" y="-14.67" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_tp2&#45;&gt;dp0_attn_s0_l0_ar2 -->
<g id="edge12" class="edge">
<title>dp0_attn_s0_l0_tp2&#45;&gt;dp0_attn_s0_l0_ar2</title>
<path fill="none" stroke="black" d="M173.24,-112.35C173.24,-98.98 173.24,-80.45 173.24,-64.14"/>
<polygon fill="black" stroke="black" points="176.74,-63.83 173.24,-53.83 169.74,-63.83 176.74,-63.83"/>
</g>
<!-- dp0_attn_s0_l0_tp3 -->
<g id="node14" class="node">
<title>dp0_attn_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="3077.74,-1103.17 2832.74,-1103.17 2832.74,-1065.17 3077.74,-1065.17 3077.74,-1103.17"/>
<text text-anchor="middle" x="2955.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="2955.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="2955.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l0_tp0 -->
<g id="node18" class="node">
<title>dp0_moe_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="2764.24,-949.17 2502.24,-949.17 2502.24,-911.17 2764.24,-911.17 2764.24,-949.17"/>
<text text-anchor="middle" x="2633.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="2633.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2633.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp0 -->
<g id="edge13" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M2917.04,-1065.14C2857.97,-1037.25 2744.61,-983.74 2680.49,-953.47"/>
<polygon fill="black" stroke="black" points="2681.93,-950.28 2671.39,-949.18 2678.94,-956.61 2681.93,-950.28"/>
</g>
<!-- dp0_moe_s0_l0_tp1 -->
<g id="node20" class="node">
<title>dp0_moe_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="2221.24,-949.17 1959.24,-949.17 1959.24,-911.17 2221.24,-911.17 2221.24,-949.17"/>
<text text-anchor="middle" x="2090.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="2090.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2090.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp1 -->
<g id="edge15" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M2892.49,-1065.14C2868.46,-1058.61 2840.7,-1051.54 2815.24,-1046.17 2613.8,-1003.69 2377.91,-969.03 2231.25,-949.23"/>
<polygon fill="black" stroke="black" points="2231.66,-945.76 2221.28,-947.89 2230.73,-952.7 2231.66,-945.76"/>
</g>
<!-- dp0_moe_s0_l0_tp2 -->
<g id="node22" class="node">
<title>dp0_moe_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="3409.24,-949.17 3147.24,-949.17 3147.24,-911.17 3409.24,-911.17 3409.24,-949.17"/>
<text text-anchor="middle" x="3278.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="3278.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="3278.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp2 -->
<g id="edge17" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M2993.56,-1065.14C3052.81,-1037.25 3166.52,-983.74 3230.85,-953.47"/>
<polygon fill="black" stroke="black" points="3232.41,-956.6 3239.97,-949.18 3229.43,-950.27 3232.41,-956.6"/>
</g>
<!-- dp0_moe_s0_l0_tp3 -->
<g id="node24" class="node">
<title>dp0_moe_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="3950.24,-949.17 3688.24,-949.17 3688.24,-911.17 3950.24,-911.17 3950.24,-949.17"/>
<text text-anchor="middle" x="3819.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="3819.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="3819.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3 -->
<g id="edge19" class="edge">
<title>dp0_attn_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" d="M3017.99,-1065.14C3042.02,-1058.62 3069.78,-1051.54 3095.24,-1046.17 3296.25,-1003.76 3531.61,-969.11 3678.1,-949.29"/>
<polygon fill="black" stroke="black" points="3678.61,-952.76 3688.05,-947.95 3677.67,-945.82 3678.61,-952.76"/>
</g>
<!-- dp0_attn_s0_l0_ar0&#45;&gt;dp0_attn_s0_l0_tp1 -->
<g id="edge9" class="edge">
<title>dp0_attn_s0_l0_ar0&#45;&gt;dp0_attn_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M173.24,-419.39C173.24,-404.64 173.24,-386.15 173.24,-370.99"/>
<polygon fill="black" stroke="black" points="176.74,-370.65 173.24,-360.65 169.74,-370.65 176.74,-370.65"/>
</g>
<!-- dp0_attn_s0_l0_ar1&#45;&gt;dp0_attn_s0_l0_tp2 -->
<g id="edge11" class="edge">
<title>dp0_attn_s0_l0_ar1&#45;&gt;dp0_attn_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M173.24,-209.65C173.24,-194.9 173.24,-176.41 173.24,-161.25"/>
<polygon fill="black" stroke="black" points="176.74,-160.91 173.24,-150.91 169.74,-160.91 176.74,-160.91"/>
</g>
<!-- dp0_gate_s0_l0_tp0 -->
<g id="node19" class="node">
<title>dp0_gate_s0_l0_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2797,-1122.17 2364.69,-1122.17 2253.48,-1046.17 2685.79,-1046.17 2797,-1122.17"/>
<text text-anchor="middle" x="2525.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="2525.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="2525.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l0_tp0&#45;&gt;dp0_moe_s0_l0_tp0 -->
<g id="edge14" class="edge">
<title>dp0_gate_s0_l0_tp0&#45;&gt;dp0_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2551.66,-1045.99C2571.02,-1018.75 2596.83,-982.41 2614.2,-957.97"/>
<polygon fill="black" stroke="black" points="2617.24,-959.73 2620.18,-949.55 2611.54,-955.67 2617.24,-959.73"/>
</g>
<!-- dp0_gate_s0_l0_tp1 -->
<g id="node21" class="node">
<title>dp0_gate_s0_l0_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2218,-1122.17 1785.69,-1122.17 1674.48,-1046.17 2106.79,-1046.17 2218,-1122.17"/>
<text text-anchor="middle" x="1946.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="1946.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="1946.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l0_tp1&#45;&gt;dp0_moe_s0_l0_tp1 -->
<g id="edge16" class="edge">
<title>dp0_gate_s0_l0_tp1&#45;&gt;dp0_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1981.47,-1045.99C2007.61,-1018.39 2042.6,-981.45 2065.75,-957.02"/>
<polygon fill="black" stroke="black" points="2068.49,-959.21 2072.83,-949.55 2063.41,-954.4 2068.49,-959.21"/>
</g>
<!-- dp0_gate_s0_l0_tp2 -->
<g id="node23" class="node">
<title>dp0_gate_s0_l0_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3657,-1122.17 3224.69,-1122.17 3113.48,-1046.17 3545.79,-1046.17 3657,-1122.17"/>
<text text-anchor="middle" x="3385.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="3385.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="3385.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l0_tp2&#45;&gt;dp0_moe_s0_l0_tp2 -->
<g id="edge18" class="edge">
<title>dp0_gate_s0_l0_tp2&#45;&gt;dp0_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3359.07,-1045.99C3339.89,-1018.75 3314.31,-982.41 3297.11,-957.97"/>
<polygon fill="black" stroke="black" points="3299.8,-955.71 3291.18,-949.55 3294.07,-959.74 3299.8,-955.71"/>
</g>
<!-- dp0_gate_s0_l0_tp3 -->
<g id="node25" class="node">
<title>dp0_gate_s0_l0_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4236,-1122.17 3803.69,-1122.17 3692.48,-1046.17 4124.79,-1046.17 4236,-1122.17"/>
<text text-anchor="middle" x="3964.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="3964.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="3964.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3 -->
<g id="edge20" class="edge">
<title>dp0_gate_s0_l0_tp3&#45;&gt;dp0_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3928.77,-1045.99C3902.44,-1018.39 3867.21,-981.45 3843.9,-957.02"/>
<polygon fill="black" stroke="black" points="3846.21,-954.37 3836.77,-949.55 3841.14,-959.2 3846.21,-954.37"/>
</g>
<!-- dp0_attn_s0_l1_tp0 -->
<g id="node26" class="node">
<title>dp0_attn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="4516.74,-1103.17 4271.74,-1103.17 4271.74,-1065.17 4516.74,-1065.17 4516.74,-1103.17"/>
<text text-anchor="middle" x="4394.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="4394.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_ar0 -->
<g id="node30" class="node">
<title>dp0_attn_s0_l1_ar0</title>
<ellipse fill="none" stroke="black" cx="4394.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="4394.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="4394.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_tp0&#45;&gt;dp0_attn_s0_l1_ar0 -->
<g id="edge21" class="edge">
<title>dp0_attn_s0_l1_tp0&#45;&gt;dp0_attn_s0_l1_ar0</title>
<path fill="none" stroke="black" d="M4394.24,-1065.14C4394.24,-1041.15 4394.24,-998.19 4394.24,-967.38"/>
<polygon fill="black" stroke="black" points="4397.74,-967.04 4394.24,-957.04 4390.74,-967.04 4397.74,-967.04"/>
</g>
<!-- dp0_attn_s0_l1_tp1 -->
<g id="node27" class="node">
<title>dp0_attn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="4516.74,-809.93 4271.74,-809.93 4271.74,-771.93 4516.74,-771.93 4516.74,-809.93"/>
<text text-anchor="middle" x="4394.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="4394.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_ar1 -->
<g id="node31" class="node">
<title>dp0_attn_s0_l1_ar1</title>
<ellipse fill="none" stroke="black" cx="4394.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="4394.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="4394.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_tp1&#45;&gt;dp0_attn_s0_l1_ar1 -->
<g id="edge23" class="edge">
<title>dp0_attn_s0_l1_tp1&#45;&gt;dp0_attn_s0_l1_ar1</title>
<path fill="none" stroke="black" d="M4394.24,-771.89C4394.24,-755.21 4394.24,-729.92 4394.24,-709.06"/>
<polygon fill="black" stroke="black" points="4397.74,-708.94 4394.24,-698.94 4390.74,-708.94 4397.74,-708.94"/>
</g>
<!-- dp0_attn_s0_l1_tp2 -->
<g id="node28" class="node">
<title>dp0_attn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="4516.74,-578.09 4271.74,-578.09 4271.74,-540.09 4516.74,-540.09 4516.74,-578.09"/>
<text text-anchor="middle" x="4394.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="4394.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_ar2 -->
<g id="node32" class="node">
<title>dp0_attn_s0_l1_ar2</title>
<ellipse fill="none" stroke="black" cx="4394.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="4394.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="4394.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="4394.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_tp2&#45;&gt;dp0_attn_s0_l1_ar2 -->
<g id="edge25" class="edge">
<title>dp0_attn_s0_l1_tp2&#45;&gt;dp0_attn_s0_l1_ar2</title>
<path fill="none" stroke="black" d="M4394.24,-539.8C4394.24,-524.56 4394.24,-502.39 4394.24,-483.58"/>
<polygon fill="black" stroke="black" points="4397.74,-483.54 4394.24,-473.54 4390.74,-483.54 4397.74,-483.54"/>
</g>
<!-- dp0_attn_s0_l1_tp3 -->
<g id="node29" class="node">
<title>dp0_attn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="5955.74,-1103.17 5710.74,-1103.17 5710.74,-1065.17 5955.74,-1065.17 5955.74,-1103.17"/>
<text text-anchor="middle" x="5833.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="5833.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="5833.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l1_tp0 -->
<g id="node33" class="node">
<title>dp0_moe_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="5652.24,-949.17 5390.24,-949.17 5390.24,-911.17 5652.24,-911.17 5652.24,-949.17"/>
<text text-anchor="middle" x="5521.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="5521.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="5521.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp0 -->
<g id="edge26" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M5796.23,-1065.14C5739.11,-1037.31 5629.61,-983.96 5567.4,-953.66"/>
<polygon fill="black" stroke="black" points="5568.73,-950.41 5558.21,-949.18 5565.67,-956.7 5568.73,-950.41"/>
</g>
<!-- dp0_moe_s0_l1_tp1 -->
<g id="node35" class="node">
<title>dp0_moe_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="5099.24,-949.17 4837.24,-949.17 4837.24,-911.17 5099.24,-911.17 5099.24,-949.17"/>
<text text-anchor="middle" x="4968.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="4968.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4968.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp1 -->
<g id="edge28" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M5770.49,-1065.14C5746.46,-1058.61 5718.7,-1051.54 5693.24,-1046.17 5491.8,-1003.69 5255.91,-969.03 5109.25,-949.23"/>
<polygon fill="black" stroke="black" points="5109.66,-945.76 5099.28,-947.89 5108.73,-952.7 5109.66,-945.76"/>
</g>
<!-- dp0_moe_s0_l1_tp2 -->
<g id="node37" class="node">
<title>dp0_moe_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="6276.24,-949.17 6014.24,-949.17 6014.24,-911.17 6276.24,-911.17 6276.24,-949.17"/>
<text text-anchor="middle" x="6145.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="6145.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6145.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp2 -->
<g id="edge30" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M5870.26,-1065.14C5927.37,-1037.31 6036.88,-983.96 6099.08,-953.66"/>
<polygon fill="black" stroke="black" points="6100.82,-956.7 6108.27,-949.18 6097.75,-950.41 6100.82,-956.7"/>
</g>
<!-- dp0_moe_s0_l1_tp3 -->
<g id="node39" class="node">
<title>dp0_moe_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="6828.24,-949.17 6566.24,-949.17 6566.24,-911.17 6828.24,-911.17 6828.24,-949.17"/>
<text text-anchor="middle" x="6697.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="6697.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6697.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3 -->
<g id="edge32" class="edge">
<title>dp0_attn_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M5895.99,-1065.14C5920.02,-1058.62 5947.78,-1051.54 5973.24,-1046.17 6174.25,-1003.76 6409.61,-969.11 6556.1,-949.29"/>
<polygon fill="black" stroke="black" points="6556.61,-952.76 6566.05,-947.95 6555.67,-945.82 6556.61,-952.76"/>
</g>
<!-- dp0_attn_s0_l1_ar0&#45;&gt;dp0_attn_s0_l1_tp1 -->
<g id="edge22" class="edge">
<title>dp0_attn_s0_l1_ar0&#45;&gt;dp0_attn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M4394.24,-903.03C4394.24,-879.32 4394.24,-844.46 4394.24,-820.13"/>
<polygon fill="black" stroke="black" points="4397.74,-820.09 4394.24,-810.09 4390.74,-820.09 4397.74,-820.09"/>
</g>
<!-- dp0_attn_s0_l1_ar1&#45;&gt;dp0_attn_s0_l1_tp2 -->
<g id="edge24" class="edge">
<title>dp0_attn_s0_l1_ar1&#45;&gt;dp0_attn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M4394.24,-644.87C4394.24,-627.93 4394.24,-605.81 4394.24,-588.42"/>
<polygon fill="black" stroke="black" points="4397.74,-588.28 4394.24,-578.28 4390.74,-588.28 4397.74,-588.28"/>
</g>
<!-- dp0_gate_s0_l1_tp0 -->
<g id="node34" class="node">
<title>dp0_gate_s0_l1_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5675,-1122.17 5242.69,-1122.17 5131.48,-1046.17 5563.79,-1046.17 5675,-1122.17"/>
<text text-anchor="middle" x="5403.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="5403.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="5403.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l1_tp0&#45;&gt;dp0_moe_s0_l1_tp0 -->
<g id="edge27" class="edge">
<title>dp0_gate_s0_l1_tp0&#45;&gt;dp0_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5432.11,-1045.99C5453.35,-1018.63 5481.71,-982.09 5500.68,-957.65"/>
<polygon fill="black" stroke="black" points="5503.61,-959.59 5506.97,-949.55 5498.08,-955.3 5503.61,-959.59"/>
</g>
<!-- dp0_gate_s0_l1_tp1 -->
<g id="node36" class="node">
<title>dp0_gate_s0_l1_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5096,-1122.17 4663.69,-1122.17 4552.48,-1046.17 4984.79,-1046.17 5096,-1122.17"/>
<text text-anchor="middle" x="4824.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="4824.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="4824.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l1_tp1&#45;&gt;dp0_moe_s0_l1_tp1 -->
<g id="edge29" class="edge">
<title>dp0_gate_s0_l1_tp1&#45;&gt;dp0_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4859.47,-1045.99C4885.61,-1018.39 4920.6,-981.45 4943.75,-957.02"/>
<polygon fill="black" stroke="black" points="4946.49,-959.21 4950.83,-949.55 4941.41,-954.4 4946.49,-959.21"/>
</g>
<!-- dp0_gate_s0_l1_tp2 -->
<g id="node38" class="node">
<title>dp0_gate_s0_l1_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6535,-1122.17 6102.69,-1122.17 5991.48,-1046.17 6423.79,-1046.17 6535,-1122.17"/>
<text text-anchor="middle" x="6263.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="6263.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6263.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l1_tp2&#45;&gt;dp0_moe_s0_l1_tp2 -->
<g id="edge31" class="edge">
<title>dp0_gate_s0_l1_tp2&#45;&gt;dp0_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6234.38,-1045.99C6213.14,-1018.63 6184.77,-982.09 6165.8,-957.65"/>
<polygon fill="black" stroke="black" points="6168.41,-955.3 6159.51,-949.55 6162.88,-959.59 6168.41,-955.3"/>
</g>
<!-- dp0_gate_s0_l1_tp3 -->
<g id="node40" class="node">
<title>dp0_gate_s0_l1_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7114,-1122.17 6681.69,-1122.17 6570.48,-1046.17 7002.79,-1046.17 7114,-1122.17"/>
<text text-anchor="middle" x="6842.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="6842.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="6842.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3 -->
<g id="edge33" class="edge">
<title>dp0_gate_s0_l1_tp3&#45;&gt;dp0_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6806.77,-1045.99C6780.44,-1018.39 6745.21,-981.45 6721.9,-957.02"/>
<polygon fill="black" stroke="black" points="6724.21,-954.37 6714.77,-949.55 6719.14,-959.2 6724.21,-954.37"/>
</g>
<!-- dp0_attn_s0_l2_tp0 -->
<g id="node41" class="node">
<title>dp0_attn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="7394.74,-1103.17 7149.74,-1103.17 7149.74,-1065.17 7394.74,-1065.17 7394.74,-1103.17"/>
<text text-anchor="middle" x="7272.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="7272.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_ar0 -->
<g id="node45" class="node">
<title>dp0_attn_s0_l2_ar0</title>
<ellipse fill="none" stroke="black" cx="7272.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="7272.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="7272.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_tp0&#45;&gt;dp0_attn_s0_l2_ar0 -->
<g id="edge34" class="edge">
<title>dp0_attn_s0_l2_tp0&#45;&gt;dp0_attn_s0_l2_ar0</title>
<path fill="none" stroke="black" d="M7272.24,-1065.14C7272.24,-1041.15 7272.24,-998.19 7272.24,-967.38"/>
<polygon fill="black" stroke="black" points="7275.74,-967.04 7272.24,-957.04 7268.74,-967.04 7275.74,-967.04"/>
</g>
<!-- dp0_attn_s0_l2_tp1 -->
<g id="node42" class="node">
<title>dp0_attn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7394.74,-809.93 7149.74,-809.93 7149.74,-771.93 7394.74,-771.93 7394.74,-809.93"/>
<text text-anchor="middle" x="7272.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="7272.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_ar1 -->
<g id="node46" class="node">
<title>dp0_attn_s0_l2_ar1</title>
<ellipse fill="none" stroke="black" cx="7272.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="7272.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="7272.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_tp1&#45;&gt;dp0_attn_s0_l2_ar1 -->
<g id="edge36" class="edge">
<title>dp0_attn_s0_l2_tp1&#45;&gt;dp0_attn_s0_l2_ar1</title>
<path fill="none" stroke="black" d="M7272.24,-771.89C7272.24,-755.21 7272.24,-729.92 7272.24,-709.06"/>
<polygon fill="black" stroke="black" points="7275.74,-708.94 7272.24,-698.94 7268.74,-708.94 7275.74,-708.94"/>
</g>
<!-- dp0_attn_s0_l2_tp2 -->
<g id="node43" class="node">
<title>dp0_attn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="7394.74,-578.09 7149.74,-578.09 7149.74,-540.09 7394.74,-540.09 7394.74,-578.09"/>
<text text-anchor="middle" x="7272.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="7272.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_ar2 -->
<g id="node47" class="node">
<title>dp0_attn_s0_l2_ar2</title>
<ellipse fill="none" stroke="black" cx="7272.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="7272.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="7272.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="7272.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_tp2&#45;&gt;dp0_attn_s0_l2_ar2 -->
<g id="edge38" class="edge">
<title>dp0_attn_s0_l2_tp2&#45;&gt;dp0_attn_s0_l2_ar2</title>
<path fill="none" stroke="black" d="M7272.24,-539.8C7272.24,-524.56 7272.24,-502.39 7272.24,-483.58"/>
<polygon fill="black" stroke="black" points="7275.74,-483.54 7272.24,-473.54 7268.74,-483.54 7275.74,-483.54"/>
</g>
<!-- dp0_attn_s0_l2_tp3 -->
<g id="node44" class="node">
<title>dp0_attn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="8833.74,-1103.17 8588.74,-1103.17 8588.74,-1065.17 8833.74,-1065.17 8833.74,-1103.17"/>
<text text-anchor="middle" x="8711.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="8711.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="8711.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l2_tp0 -->
<g id="node48" class="node">
<title>dp0_moe_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="8456.24,-949.17 8194.24,-949.17 8194.24,-911.17 8456.24,-911.17 8456.24,-949.17"/>
<text text-anchor="middle" x="8325.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="8325.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="8325.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp0 -->
<g id="edge39" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M8665.45,-1065.14C8594.2,-1037.08 8457.08,-983.08 8380.46,-952.91"/>
<polygon fill="black" stroke="black" points="8381.56,-949.59 8370.98,-949.18 8379,-956.1 8381.56,-949.59"/>
</g>
<!-- dp0_moe_s0_l2_tp1 -->
<g id="node50" class="node">
<title>dp0_moe_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="7925.24,-949.17 7663.24,-949.17 7663.24,-911.17 7925.24,-911.17 7925.24,-949.17"/>
<text text-anchor="middle" x="7794.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="7794.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7794.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp1 -->
<g id="edge41" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M8648.87,-1065.09C8624.76,-1058.52 8596.85,-1051.43 8571.24,-1046.17 8350.84,-1000.88 8091.76,-966.2 7935.43,-947.26"/>
<polygon fill="black" stroke="black" points="7935.63,-943.76 7925.28,-946.04 7934.79,-950.71 7935.63,-943.76"/>
</g>
<!-- dp0_moe_s0_l2_tp2 -->
<g id="node52" class="node">
<title>dp0_moe_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="9149.24,-949.17 8887.24,-949.17 8887.24,-911.17 9149.24,-911.17 9149.24,-949.17"/>
<text text-anchor="middle" x="9018.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="9018.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9018.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp2 -->
<g id="edge43" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M8747.66,-1065.14C8803.86,-1037.31 8911.61,-983.96 8972.82,-953.66"/>
<polygon fill="black" stroke="black" points="8974.46,-956.75 8981.87,-949.18 8971.35,-950.48 8974.46,-956.75"/>
</g>
<!-- dp0_moe_s0_l2_tp3 -->
<g id="node54" class="node">
<title>dp0_moe_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="9706.24,-949.17 9444.24,-949.17 9444.24,-911.17 9706.24,-911.17 9706.24,-949.17"/>
<text text-anchor="middle" x="9575.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="9575.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9575.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3 -->
<g id="edge45" class="edge">
<title>dp0_attn_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M8773.99,-1065.14C8798.02,-1058.62 8825.78,-1051.54 8851.24,-1046.17 9052.25,-1003.76 9287.61,-969.11 9434.1,-949.29"/>
<polygon fill="black" stroke="black" points="9434.61,-952.76 9444.05,-947.95 9433.67,-945.82 9434.61,-952.76"/>
</g>
<!-- dp0_attn_s0_l2_ar0&#45;&gt;dp0_attn_s0_l2_tp1 -->
<g id="edge35" class="edge">
<title>dp0_attn_s0_l2_ar0&#45;&gt;dp0_attn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M7272.24,-903.03C7272.24,-879.32 7272.24,-844.46 7272.24,-820.13"/>
<polygon fill="black" stroke="black" points="7275.74,-820.09 7272.24,-810.09 7268.74,-820.09 7275.74,-820.09"/>
</g>
<!-- dp0_attn_s0_l2_ar1&#45;&gt;dp0_attn_s0_l2_tp2 -->
<g id="edge37" class="edge">
<title>dp0_attn_s0_l2_ar1&#45;&gt;dp0_attn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M7272.24,-644.87C7272.24,-627.93 7272.24,-605.81 7272.24,-588.42"/>
<polygon fill="black" stroke="black" points="7275.74,-588.28 7272.24,-578.28 7268.74,-588.28 7275.74,-588.28"/>
</g>
<!-- dp0_gate_s0_l2_tp0 -->
<g id="node49" class="node">
<title>dp0_gate_s0_l2_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8553,-1122.17 8120.69,-1122.17 8009.48,-1046.17 8441.79,-1046.17 8553,-1122.17"/>
<text text-anchor="middle" x="8281.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="8281.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="8281.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l2_tp0&#45;&gt;dp0_moe_s0_l2_tp0 -->
<g id="edge40" class="edge">
<title>dp0_gate_s0_l2_tp0&#45;&gt;dp0_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8292,-1045.99C8299.75,-1019.22 8310.04,-983.68 8317.11,-959.27"/>
<polygon fill="black" stroke="black" points="8320.5,-960.13 8319.92,-949.55 8313.78,-958.18 8320.5,-960.13"/>
</g>
<!-- dp0_gate_s0_l2_tp1 -->
<g id="node51" class="node">
<title>dp0_gate_s0_l2_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7974,-1122.17 7541.69,-1122.17 7430.48,-1046.17 7862.79,-1046.17 7974,-1122.17"/>
<text text-anchor="middle" x="7702.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="7702.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="7702.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l2_tp1&#45;&gt;dp0_moe_s0_l2_tp1 -->
<g id="edge42" class="edge">
<title>dp0_gate_s0_l2_tp1&#45;&gt;dp0_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7724.75,-1045.99C7741.16,-1018.86 7763.03,-982.73 7777.82,-958.3"/>
<polygon fill="black" stroke="black" points="7780.93,-959.92 7783.12,-949.55 7774.94,-956.29 7780.93,-959.92"/>
</g>
<!-- dp0_gate_s0_l2_tp2 -->
<g id="node53" class="node">
<title>dp0_gate_s0_l2_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9413,-1122.17 8980.69,-1122.17 8869.48,-1046.17 9301.79,-1046.17 9413,-1122.17"/>
<text text-anchor="middle" x="9141.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="9141.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9141.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l2_tp2&#45;&gt;dp0_moe_s0_l2_tp2 -->
<g id="edge44" class="edge">
<title>dp0_gate_s0_l2_tp2&#45;&gt;dp0_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9111.15,-1045.99C9088.92,-1018.51 9059.19,-981.77 9039.41,-957.33"/>
<polygon fill="black" stroke="black" points="9042.13,-955.12 9033.11,-949.55 9036.68,-959.52 9042.13,-955.12"/>
</g>
<!-- dp0_gate_s0_l2_tp3 -->
<g id="node55" class="node">
<title>dp0_gate_s0_l2_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9992,-1122.17 9559.69,-1122.17 9448.48,-1046.17 9880.79,-1046.17 9992,-1122.17"/>
<text text-anchor="middle" x="9720.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="9720.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="9720.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3 -->
<g id="edge46" class="edge">
<title>dp0_gate_s0_l2_tp3&#45;&gt;dp0_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9684.77,-1045.99C9658.44,-1018.39 9623.21,-981.45 9599.9,-957.02"/>
<polygon fill="black" stroke="black" points="9602.21,-954.37 9592.77,-949.55 9597.14,-959.2 9602.21,-954.37"/>
</g>
<!-- dp0_attn_s0_l3_tp0 -->
<g id="node56" class="node">
<title>dp0_attn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="10272.74,-1103.17 10027.74,-1103.17 10027.74,-1065.17 10272.74,-1065.17 10272.74,-1103.17"/>
<text text-anchor="middle" x="10150.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="10150.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_ar0 -->
<g id="node60" class="node">
<title>dp0_attn_s0_l3_ar0</title>
<ellipse fill="none" stroke="black" cx="10150.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="10150.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="10150.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_tp0&#45;&gt;dp0_attn_s0_l3_ar0 -->
<g id="edge47" class="edge">
<title>dp0_attn_s0_l3_tp0&#45;&gt;dp0_attn_s0_l3_ar0</title>
<path fill="none" stroke="black" d="M10150.24,-1065.14C10150.24,-1041.15 10150.24,-998.19 10150.24,-967.38"/>
<polygon fill="black" stroke="black" points="10153.74,-967.04 10150.24,-957.04 10146.74,-967.04 10153.74,-967.04"/>
</g>
<!-- dp0_attn_s0_l3_tp1 -->
<g id="node57" class="node">
<title>dp0_attn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="10272.74,-809.93 10027.74,-809.93 10027.74,-771.93 10272.74,-771.93 10272.74,-809.93"/>
<text text-anchor="middle" x="10150.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="10150.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_ar1 -->
<g id="node61" class="node">
<title>dp0_attn_s0_l3_ar1</title>
<ellipse fill="none" stroke="black" cx="10150.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="10150.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="10150.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_tp1&#45;&gt;dp0_attn_s0_l3_ar1 -->
<g id="edge49" class="edge">
<title>dp0_attn_s0_l3_tp1&#45;&gt;dp0_attn_s0_l3_ar1</title>
<path fill="none" stroke="black" d="M10150.24,-771.89C10150.24,-755.21 10150.24,-729.92 10150.24,-709.06"/>
<polygon fill="black" stroke="black" points="10153.74,-708.94 10150.24,-698.94 10146.74,-708.94 10153.74,-708.94"/>
</g>
<!-- dp0_attn_s0_l3_tp2 -->
<g id="node58" class="node">
<title>dp0_attn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="10272.74,-578.09 10027.74,-578.09 10027.74,-540.09 10272.74,-540.09 10272.74,-578.09"/>
<text text-anchor="middle" x="10150.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="10150.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_ar2 -->
<g id="node62" class="node">
<title>dp0_attn_s0_l3_ar2</title>
<ellipse fill="none" stroke="black" cx="10150.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="10150.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="10150.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="10150.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_tp2&#45;&gt;dp0_attn_s0_l3_ar2 -->
<g id="edge51" class="edge">
<title>dp0_attn_s0_l3_tp2&#45;&gt;dp0_attn_s0_l3_ar2</title>
<path fill="none" stroke="black" d="M10150.24,-539.8C10150.24,-524.56 10150.24,-502.39 10150.24,-483.58"/>
<polygon fill="black" stroke="black" points="10153.74,-483.54 10150.24,-473.54 10146.74,-483.54 10153.74,-483.54"/>
</g>
<!-- dp0_attn_s0_l3_tp3 -->
<g id="node59" class="node">
<title>dp0_attn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="11711.74,-1103.17 11466.74,-1103.17 11466.74,-1065.17 11711.74,-1065.17 11711.74,-1103.17"/>
<text text-anchor="middle" x="11589.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="11589.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="11589.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l3_tp0 -->
<g id="node63" class="node">
<title>dp0_moe_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="11408.24,-949.17 11146.24,-949.17 11146.24,-911.17 11408.24,-911.17 11408.24,-949.17"/>
<text text-anchor="middle" x="11277.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="11277.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="11277.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp0 -->
<g id="edge52" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M11552.23,-1065.14C11495.11,-1037.31 11385.61,-983.96 11323.4,-953.66"/>
<polygon fill="black" stroke="black" points="11324.73,-950.41 11314.21,-949.18 11321.67,-956.7 11324.73,-950.41"/>
</g>
<!-- dp0_moe_s0_l3_tp1 -->
<g id="node65" class="node">
<title>dp0_moe_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="10803.24,-949.17 10541.24,-949.17 10541.24,-911.17 10803.24,-911.17 10803.24,-949.17"/>
<text text-anchor="middle" x="10672.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="10672.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10672.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp1 -->
<g id="edge54" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M11526.87,-1065.09C11502.76,-1058.52 11474.85,-1051.43 11449.24,-1046.17 11228.84,-1000.88 10969.76,-966.2 10813.43,-947.26"/>
<polygon fill="black" stroke="black" points="10813.63,-943.76 10803.28,-946.04 10812.79,-950.71 10813.63,-943.76"/>
</g>
<!-- dp0_moe_s0_l3_tp2 -->
<g id="node67" class="node">
<title>dp0_moe_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="12058.24,-949.17 11796.24,-949.17 11796.24,-911.17 12058.24,-911.17 12058.24,-949.17"/>
<text text-anchor="middle" x="11927.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="11927.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="11927.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp2 -->
<g id="edge56" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M11629.34,-1065.14C11691.47,-1037.2 11810.82,-983.52 11878.06,-953.28"/>
<polygon fill="black" stroke="black" points="11879.51,-956.47 11887.19,-949.18 11876.64,-950.09 11879.51,-956.47"/>
</g>
<!-- dp0_moe_s0_l3_tp3 -->
<g id="node69" class="node">
<title>dp0_moe_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="12584.24,-949.17 12322.24,-949.17 12322.24,-911.17 12584.24,-911.17 12584.24,-949.17"/>
<text text-anchor="middle" x="12453.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="12453.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="12453.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3 -->
<g id="edge58" class="edge">
<title>dp0_attn_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M11651.99,-1065.14C11676.02,-1058.62 11703.78,-1051.54 11729.24,-1046.17 11930.25,-1003.76 12165.61,-969.11 12312.1,-949.29"/>
<polygon fill="black" stroke="black" points="12312.61,-952.76 12322.05,-947.95 12311.67,-945.82 12312.61,-952.76"/>
</g>
<!-- dp0_attn_s0_l3_ar0&#45;&gt;dp0_attn_s0_l3_tp1 -->
<g id="edge48" class="edge">
<title>dp0_attn_s0_l3_ar0&#45;&gt;dp0_attn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M10150.24,-903.03C10150.24,-879.32 10150.24,-844.46 10150.24,-820.13"/>
<polygon fill="black" stroke="black" points="10153.74,-820.09 10150.24,-810.09 10146.74,-820.09 10153.74,-820.09"/>
</g>
<!-- dp0_attn_s0_l3_ar1&#45;&gt;dp0_attn_s0_l3_tp2 -->
<g id="edge50" class="edge">
<title>dp0_attn_s0_l3_ar1&#45;&gt;dp0_attn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M10150.24,-644.87C10150.24,-627.93 10150.24,-605.81 10150.24,-588.42"/>
<polygon fill="black" stroke="black" points="10153.74,-588.28 10150.24,-578.28 10146.74,-588.28 10153.74,-588.28"/>
</g>
<!-- dp0_gate_s0_l3_tp0 -->
<g id="node64" class="node">
<title>dp0_gate_s0_l3_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="11431,-1122.17 10998.69,-1122.17 10887.48,-1046.17 11319.79,-1046.17 11431,-1122.17"/>
<text text-anchor="middle" x="11159.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="11159.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="11159.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l3_tp0&#45;&gt;dp0_moe_s0_l3_tp0 -->
<g id="edge53" class="edge">
<title>dp0_gate_s0_l3_tp0&#45;&gt;dp0_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11188.11,-1045.99C11209.35,-1018.63 11237.71,-982.09 11256.68,-957.65"/>
<polygon fill="black" stroke="black" points="11259.61,-959.59 11262.97,-949.55 11254.08,-955.3 11259.61,-959.59"/>
</g>
<!-- dp0_gate_s0_l3_tp1 -->
<g id="node66" class="node">
<title>dp0_gate_s0_l3_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="10852,-1122.17 10419.69,-1122.17 10308.48,-1046.17 10740.79,-1046.17 10852,-1122.17"/>
<text text-anchor="middle" x="10580.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="10580.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="10580.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l3_tp1&#45;&gt;dp0_moe_s0_l3_tp1 -->
<g id="edge55" class="edge">
<title>dp0_gate_s0_l3_tp1&#45;&gt;dp0_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10602.75,-1045.99C10619.16,-1018.86 10641.03,-982.73 10655.82,-958.3"/>
<polygon fill="black" stroke="black" points="10658.93,-959.92 10661.12,-949.55 10652.94,-956.29 10658.93,-959.92"/>
</g>
<!-- dp0_gate_s0_l3_tp2 -->
<g id="node68" class="node">
<title>dp0_gate_s0_l3_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12291,-1122.17 11858.69,-1122.17 11747.48,-1046.17 12179.79,-1046.17 12291,-1122.17"/>
<text text-anchor="middle" x="12019.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="12019.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="12019.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l3_tp2&#45;&gt;dp0_moe_s0_l3_tp2 -->
<g id="edge57" class="edge">
<title>dp0_gate_s0_l3_tp2&#45;&gt;dp0_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11996.74,-1045.99C11980.32,-1018.86 11958.45,-982.73 11943.66,-958.3"/>
<polygon fill="black" stroke="black" points="11946.54,-956.29 11938.37,-949.55 11940.55,-959.92 11946.54,-956.29"/>
</g>
<!-- dp0_gate_s0_l3_tp3 -->
<g id="node70" class="node">
<title>dp0_gate_s0_l3_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="12870,-1122.17 12437.69,-1122.17 12326.48,-1046.17 12758.79,-1046.17 12870,-1122.17"/>
<text text-anchor="middle" x="12598.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="12598.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="12598.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3 -->
<g id="edge59" class="edge">
<title>dp0_gate_s0_l3_tp3&#45;&gt;dp0_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12562.77,-1045.99C12536.44,-1018.39 12501.21,-981.45 12477.9,-957.02"/>
<polygon fill="black" stroke="black" points="12480.21,-954.37 12470.77,-949.55 12475.14,-959.2 12480.21,-954.37"/>
</g>
<!-- dp0_attn_s0_l4_tp0 -->
<g id="node71" class="node">
<title>dp0_attn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="13150.74,-1103.17 12905.74,-1103.17 12905.74,-1065.17 13150.74,-1065.17 13150.74,-1103.17"/>
<text text-anchor="middle" x="13028.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="13028.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_ar0 -->
<g id="node75" class="node">
<title>dp0_attn_s0_l4_ar0</title>
<ellipse fill="none" stroke="black" cx="13028.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="13028.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="13028.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_tp0&#45;&gt;dp0_attn_s0_l4_ar0 -->
<g id="edge60" class="edge">
<title>dp0_attn_s0_l4_tp0&#45;&gt;dp0_attn_s0_l4_ar0</title>
<path fill="none" stroke="black" d="M13028.24,-1065.14C13028.24,-1041.15 13028.24,-998.19 13028.24,-967.38"/>
<polygon fill="black" stroke="black" points="13031.74,-967.04 13028.24,-957.04 13024.74,-967.04 13031.74,-967.04"/>
</g>
<!-- dp0_attn_s0_l4_tp1 -->
<g id="node72" class="node">
<title>dp0_attn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="13150.74,-809.93 12905.74,-809.93 12905.74,-771.93 13150.74,-771.93 13150.74,-809.93"/>
<text text-anchor="middle" x="13028.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="13028.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_ar1 -->
<g id="node76" class="node">
<title>dp0_attn_s0_l4_ar1</title>
<ellipse fill="none" stroke="black" cx="13028.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="13028.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="13028.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_tp1&#45;&gt;dp0_attn_s0_l4_ar1 -->
<g id="edge62" class="edge">
<title>dp0_attn_s0_l4_tp1&#45;&gt;dp0_attn_s0_l4_ar1</title>
<path fill="none" stroke="black" d="M13028.24,-771.89C13028.24,-755.21 13028.24,-729.92 13028.24,-709.06"/>
<polygon fill="black" stroke="black" points="13031.74,-708.94 13028.24,-698.94 13024.74,-708.94 13031.74,-708.94"/>
</g>
<!-- dp0_attn_s0_l4_tp2 -->
<g id="node73" class="node">
<title>dp0_attn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="13150.74,-578.09 12905.74,-578.09 12905.74,-540.09 13150.74,-540.09 13150.74,-578.09"/>
<text text-anchor="middle" x="13028.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="13028.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_ar2 -->
<g id="node77" class="node">
<title>dp0_attn_s0_l4_ar2</title>
<ellipse fill="none" stroke="black" cx="13028.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="13028.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="13028.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="13028.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_tp2&#45;&gt;dp0_attn_s0_l4_ar2 -->
<g id="edge64" class="edge">
<title>dp0_attn_s0_l4_tp2&#45;&gt;dp0_attn_s0_l4_ar2</title>
<path fill="none" stroke="black" d="M13028.24,-539.8C13028.24,-524.56 13028.24,-502.39 13028.24,-483.58"/>
<polygon fill="black" stroke="black" points="13031.74,-483.54 13028.24,-473.54 13024.74,-483.54 13031.74,-483.54"/>
</g>
<!-- dp0_attn_s0_l4_tp3 -->
<g id="node74" class="node">
<title>dp0_attn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="14589.74,-1103.17 14344.74,-1103.17 14344.74,-1065.17 14589.74,-1065.17 14589.74,-1103.17"/>
<text text-anchor="middle" x="14467.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="14467.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="14467.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l4_tp0 -->
<g id="node78" class="node">
<title>dp0_moe_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="14212.24,-949.17 13950.24,-949.17 13950.24,-911.17 14212.24,-911.17 14212.24,-949.17"/>
<text text-anchor="middle" x="14081.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="14081.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14081.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp0 -->
<g id="edge65" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M14421.45,-1065.14C14350.2,-1037.08 14213.08,-983.08 14136.46,-952.91"/>
<polygon fill="black" stroke="black" points="14137.56,-949.59 14126.98,-949.18 14135,-956.1 14137.56,-949.59"/>
</g>
<!-- dp0_moe_s0_l4_tp1 -->
<g id="node80" class="node">
<title>dp0_moe_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="13734.24,-949.17 13472.24,-949.17 13472.24,-911.17 13734.24,-911.17 13734.24,-949.17"/>
<text text-anchor="middle" x="13603.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="13603.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13603.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp1 -->
<g id="edge67" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M14404.49,-1065.14C14380.46,-1058.62 14352.7,-1051.54 14327.24,-1046.17 14217.09,-1022.93 13913.44,-976.89 13736.33,-950.66"/>
<polygon fill="black" stroke="black" points="13736.82,-947.2 13726.42,-949.2 13735.8,-954.12 13736.82,-947.2"/>
</g>
<!-- dp0_moe_s0_l4_tp2 -->
<g id="node82" class="node">
<title>dp0_moe_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="14905.24,-949.17 14643.24,-949.17 14643.24,-911.17 14905.24,-911.17 14905.24,-949.17"/>
<text text-anchor="middle" x="14774.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="14774.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14774.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp2 -->
<g id="edge69" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M14503.66,-1065.14C14559.86,-1037.31 14667.61,-983.96 14728.82,-953.66"/>
<polygon fill="black" stroke="black" points="14730.46,-956.75 14737.87,-949.18 14727.35,-950.48 14730.46,-956.75"/>
</g>
<!-- dp0_moe_s0_l4_tp3 -->
<g id="node84" class="node">
<title>dp0_moe_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="15462.24,-949.17 15200.24,-949.17 15200.24,-911.17 15462.24,-911.17 15462.24,-949.17"/>
<text text-anchor="middle" x="15331.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="15331.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="15331.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3 -->
<g id="edge71" class="edge">
<title>dp0_attn_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M14529.99,-1065.14C14554.02,-1058.62 14581.78,-1051.54 14607.24,-1046.17 14808.25,-1003.76 15043.61,-969.11 15190.1,-949.29"/>
<polygon fill="black" stroke="black" points="15190.61,-952.76 15200.05,-947.95 15189.67,-945.82 15190.61,-952.76"/>
</g>
<!-- dp0_attn_s0_l4_ar0&#45;&gt;dp0_attn_s0_l4_tp1 -->
<g id="edge61" class="edge">
<title>dp0_attn_s0_l4_ar0&#45;&gt;dp0_attn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M13028.24,-903.03C13028.24,-879.32 13028.24,-844.46 13028.24,-820.13"/>
<polygon fill="black" stroke="black" points="13031.74,-820.09 13028.24,-810.09 13024.74,-820.09 13031.74,-820.09"/>
</g>
<!-- dp0_attn_s0_l4_ar1&#45;&gt;dp0_attn_s0_l4_tp2 -->
<g id="edge63" class="edge">
<title>dp0_attn_s0_l4_ar1&#45;&gt;dp0_attn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M13028.24,-644.87C13028.24,-627.93 13028.24,-605.81 13028.24,-588.42"/>
<polygon fill="black" stroke="black" points="13031.74,-588.28 13028.24,-578.28 13024.74,-588.28 13031.74,-588.28"/>
</g>
<!-- dp0_gate_s0_l4_tp0 -->
<g id="node79" class="node">
<title>dp0_gate_s0_l4_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="14309,-1122.17 13876.69,-1122.17 13765.48,-1046.17 14197.79,-1046.17 14309,-1122.17"/>
<text text-anchor="middle" x="14037.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="14037.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14037.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l4_tp0&#45;&gt;dp0_moe_s0_l4_tp0 -->
<g id="edge66" class="edge">
<title>dp0_gate_s0_l4_tp0&#45;&gt;dp0_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14048,-1045.99C14055.75,-1019.22 14066.04,-983.68 14073.11,-959.27"/>
<polygon fill="black" stroke="black" points="14076.5,-960.13 14075.92,-949.55 14069.78,-958.18 14076.5,-960.13"/>
</g>
<!-- dp0_gate_s0_l4_tp1 -->
<g id="node81" class="node">
<title>dp0_gate_s0_l4_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="13730,-1122.17 13297.69,-1122.17 13186.48,-1046.17 13618.79,-1046.17 13730,-1122.17"/>
<text text-anchor="middle" x="13458.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="13458.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="13458.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l4_tp1&#45;&gt;dp0_moe_s0_l4_tp1 -->
<g id="edge68" class="edge">
<title>dp0_gate_s0_l4_tp1&#45;&gt;dp0_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13493.71,-1045.99C13520.04,-1018.39 13555.27,-981.45 13578.58,-957.02"/>
<polygon fill="black" stroke="black" points="13581.34,-959.2 13585.71,-949.55 13576.27,-954.37 13581.34,-959.2"/>
</g>
<!-- dp0_gate_s0_l4_tp2 -->
<g id="node83" class="node">
<title>dp0_gate_s0_l4_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15169,-1122.17 14736.69,-1122.17 14625.48,-1046.17 15057.79,-1046.17 15169,-1122.17"/>
<text text-anchor="middle" x="14897.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="14897.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="14897.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l4_tp2&#45;&gt;dp0_moe_s0_l4_tp2 -->
<g id="edge70" class="edge">
<title>dp0_gate_s0_l4_tp2&#45;&gt;dp0_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14867.15,-1045.99C14844.92,-1018.51 14815.19,-981.77 14795.41,-957.33"/>
<polygon fill="black" stroke="black" points="14798.13,-955.12 14789.11,-949.55 14792.68,-959.52 14798.13,-955.12"/>
</g>
<!-- dp0_gate_s0_l4_tp3 -->
<g id="node85" class="node">
<title>dp0_gate_s0_l4_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="15748,-1122.17 15315.69,-1122.17 15204.48,-1046.17 15636.79,-1046.17 15748,-1122.17"/>
<text text-anchor="middle" x="15476.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="15476.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="15476.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3 -->
<g id="edge72" class="edge">
<title>dp0_gate_s0_l4_tp3&#45;&gt;dp0_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15440.77,-1045.99C15414.44,-1018.39 15379.21,-981.45 15355.9,-957.02"/>
<polygon fill="black" stroke="black" points="15358.21,-954.37 15348.77,-949.55 15353.14,-959.2 15358.21,-954.37"/>
</g>
<!-- dp0_attn_s0_l5_tp0 -->
<g id="node86" class="node">
<title>dp0_attn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="16028.74,-1103.17 15783.74,-1103.17 15783.74,-1065.17 16028.74,-1065.17 16028.74,-1103.17"/>
<text text-anchor="middle" x="15906.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="15906.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_ar0 -->
<g id="node90" class="node">
<title>dp0_attn_s0_l5_ar0</title>
<ellipse fill="none" stroke="black" cx="15906.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="15906.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15906.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_tp0&#45;&gt;dp0_attn_s0_l5_ar0 -->
<g id="edge73" class="edge">
<title>dp0_attn_s0_l5_tp0&#45;&gt;dp0_attn_s0_l5_ar0</title>
<path fill="none" stroke="black" d="M15906.24,-1065.14C15906.24,-1041.15 15906.24,-998.19 15906.24,-967.38"/>
<polygon fill="black" stroke="black" points="15909.74,-967.04 15906.24,-957.04 15902.74,-967.04 15909.74,-967.04"/>
</g>
<!-- dp0_attn_s0_l5_tp1 -->
<g id="node87" class="node">
<title>dp0_attn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="16028.74,-809.93 15783.74,-809.93 15783.74,-771.93 16028.74,-771.93 16028.74,-809.93"/>
<text text-anchor="middle" x="15906.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="15906.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_ar1 -->
<g id="node91" class="node">
<title>dp0_attn_s0_l5_ar1</title>
<ellipse fill="none" stroke="black" cx="15906.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="15906.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15906.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_tp1&#45;&gt;dp0_attn_s0_l5_ar1 -->
<g id="edge75" class="edge">
<title>dp0_attn_s0_l5_tp1&#45;&gt;dp0_attn_s0_l5_ar1</title>
<path fill="none" stroke="black" d="M15906.24,-771.89C15906.24,-755.21 15906.24,-729.92 15906.24,-709.06"/>
<polygon fill="black" stroke="black" points="15909.74,-708.94 15906.24,-698.94 15902.74,-708.94 15909.74,-708.94"/>
</g>
<!-- dp0_attn_s0_l5_tp2 -->
<g id="node88" class="node">
<title>dp0_attn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="16028.74,-578.09 15783.74,-578.09 15783.74,-540.09 16028.74,-540.09 16028.74,-578.09"/>
<text text-anchor="middle" x="15906.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="15906.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_ar2 -->
<g id="node92" class="node">
<title>dp0_attn_s0_l5_ar2</title>
<ellipse fill="none" stroke="black" cx="15906.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="15906.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="15906.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="15906.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_tp2&#45;&gt;dp0_attn_s0_l5_ar2 -->
<g id="edge77" class="edge">
<title>dp0_attn_s0_l5_tp2&#45;&gt;dp0_attn_s0_l5_ar2</title>
<path fill="none" stroke="black" d="M15906.24,-539.8C15906.24,-524.56 15906.24,-502.39 15906.24,-483.58"/>
<polygon fill="black" stroke="black" points="15909.74,-483.54 15906.24,-473.54 15902.74,-483.54 15909.74,-483.54"/>
</g>
<!-- dp0_attn_s0_l5_tp3 -->
<g id="node89" class="node">
<title>dp0_attn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="17467.74,-1103.17 17222.74,-1103.17 17222.74,-1065.17 17467.74,-1065.17 17467.74,-1103.17"/>
<text text-anchor="middle" x="17345.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="17345.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="17345.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_moe_s0_l5_tp0 -->
<g id="node93" class="node">
<title>dp0_moe_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="17202.24,-949.17 16940.24,-949.17 16940.24,-911.17 17202.24,-911.17 17202.24,-949.17"/>
<text text-anchor="middle" x="17071.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="17071.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17071.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp0 -->
<g id="edge78" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M17312.73,-1065.14C17262.78,-1037.42 17167.2,-984.4 17112.45,-954.03"/>
<polygon fill="black" stroke="black" points="17114.15,-950.97 17103.71,-949.18 17110.75,-957.09 17114.15,-950.97"/>
</g>
<!-- dp0_moe_s0_l5_tp1 -->
<g id="node95" class="node">
<title>dp0_moe_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="16612.24,-949.17 16350.24,-949.17 16350.24,-911.17 16612.24,-911.17 16612.24,-949.17"/>
<text text-anchor="middle" x="16481.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="16481.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16481.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp1 -->
<g id="edge80" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M17282.49,-1065.14C17258.46,-1058.62 17230.7,-1051.54 17205.24,-1046.17 17004.23,-1003.76 16768.87,-969.11 16622.39,-949.29"/>
<polygon fill="black" stroke="black" points="16622.81,-945.82 16612.43,-947.95 16621.87,-952.76 16622.81,-945.82"/>
</g>
<!-- dp0_moe_s0_l5_tp2 -->
<g id="node97" class="node">
<title>dp0_moe_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="17733.24,-949.17 17471.24,-949.17 17471.24,-911.17 17733.24,-911.17 17733.24,-949.17"/>
<text text-anchor="middle" x="17602.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="17602.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17602.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp2 -->
<g id="edge82" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M17375.73,-1065.14C17422.39,-1037.54 17511.5,-984.84 17562.95,-954.41"/>
<polygon fill="black" stroke="black" points="17564.96,-957.28 17571.79,-949.18 17561.4,-951.26 17564.96,-957.28"/>
</g>
<!-- dp0_moe_s0_l5_tp3 -->
<g id="node99" class="node">
<title>dp0_moe_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="18404.24,-949.17 18142.24,-949.17 18142.24,-911.17 18404.24,-911.17 18404.24,-949.17"/>
<text text-anchor="middle" x="18273.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="18273.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="18273.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3 -->
<g id="edge84" class="edge">
<title>dp0_attn_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M17407.26,-1065.16C17431.45,-1058.56 17459.5,-1051.43 17485.24,-1046.17 17709.57,-1000.31 17973.44,-965.66 18131.81,-946.9"/>
<polygon fill="black" stroke="black" points="18132.56,-950.34 18142.08,-945.69 18131.74,-943.39 18132.56,-950.34"/>
</g>
<!-- dp0_attn_s0_l5_ar0&#45;&gt;dp0_attn_s0_l5_tp1 -->
<g id="edge74" class="edge">
<title>dp0_attn_s0_l5_ar0&#45;&gt;dp0_attn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M15906.24,-903.03C15906.24,-879.32 15906.24,-844.46 15906.24,-820.13"/>
<polygon fill="black" stroke="black" points="15909.74,-820.09 15906.24,-810.09 15902.74,-820.09 15909.74,-820.09"/>
</g>
<!-- dp0_attn_s0_l5_ar1&#45;&gt;dp0_attn_s0_l5_tp2 -->
<g id="edge76" class="edge">
<title>dp0_attn_s0_l5_ar1&#45;&gt;dp0_attn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M15906.24,-644.87C15906.24,-627.93 15906.24,-605.81 15906.24,-588.42"/>
<polygon fill="black" stroke="black" points="15909.74,-588.28 15906.24,-578.28 15902.74,-588.28 15909.74,-588.28"/>
</g>
<!-- dp0_gate_s0_l5_tp0 -->
<g id="node94" class="node">
<title>dp0_gate_s0_l5_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="17187,-1122.17 16754.69,-1122.17 16643.48,-1046.17 17075.79,-1046.17 17187,-1122.17"/>
<text text-anchor="middle" x="16915.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="16915.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16915.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU0</text>
</g>
<!-- dp0_gate_s0_l5_tp0&#45;&gt;dp0_moe_s0_l5_tp0 -->
<g id="edge79" class="edge">
<title>dp0_gate_s0_l5_tp0&#45;&gt;dp0_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16953.4,-1045.99C16981.85,-1018.27 17019.96,-981.13 17045.04,-956.7"/>
<polygon fill="black" stroke="black" points="17047.66,-959.03 17052.38,-949.55 17042.77,-954.02 17047.66,-959.03"/>
</g>
<!-- dp0_gate_s0_l5_tp1 -->
<g id="node96" class="node">
<title>dp0_gate_s0_l5_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="16608,-1122.17 16175.69,-1122.17 16064.48,-1046.17 16496.79,-1046.17 16608,-1122.17"/>
<text text-anchor="middle" x="16336.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="16336.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="16336.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU1</text>
</g>
<!-- dp0_gate_s0_l5_tp1&#45;&gt;dp0_moe_s0_l5_tp1 -->
<g id="edge81" class="edge">
<title>dp0_gate_s0_l5_tp1&#45;&gt;dp0_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16371.71,-1045.99C16398.04,-1018.39 16433.27,-981.45 16456.58,-957.02"/>
<polygon fill="black" stroke="black" points="16459.34,-959.2 16463.71,-949.55 16454.27,-954.37 16459.34,-959.2"/>
</g>
<!-- dp0_gate_s0_l5_tp2 -->
<g id="node98" class="node">
<title>dp0_gate_s0_l5_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18047,-1122.17 17614.69,-1122.17 17503.48,-1046.17 17935.79,-1046.17 18047,-1122.17"/>
<text text-anchor="middle" x="17775.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="17775.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="17775.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU2</text>
</g>
<!-- dp0_gate_s0_l5_tp2&#45;&gt;dp0_moe_s0_l5_tp2 -->
<g id="edge83" class="edge">
<title>dp0_gate_s0_l5_tp2&#45;&gt;dp0_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17732.92,-1045.99C17701.24,-1018.15 17658.74,-980.81 17630.94,-956.38"/>
<polygon fill="black" stroke="black" points="17632.98,-953.52 17623.16,-949.55 17628.36,-958.78 17632.98,-953.52"/>
</g>
<!-- dp0_pp_s0_to_s1 -->
<g id="node101" class="node">
<title>dp0_pp_s0_to_s1</title>
<ellipse fill="none" stroke="black" cx="18273.24" cy="-790.93" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="18273.24" y="-798.73" font-family="Times,serif" font-size="9.00">Pipeline Stage 01</text>
<text text-anchor="middle" x="18273.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="18273.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU7GPU8</text>
</g>
<!-- dp0_moe_s0_l5_tp3&#45;&gt;dp0_pp_s0_to_s1 -->
<g id="edge86" class="edge">
<title>dp0_moe_s0_l5_tp3&#45;&gt;dp0_pp_s0_to_s1</title>
<path fill="none" stroke="black" d="M18273.24,-910.94C18273.24,-889.9 18273.24,-854.75 18273.24,-828.09"/>
<polygon fill="black" stroke="black" points="18276.74,-827.98 18273.24,-817.98 18269.74,-827.98 18276.74,-827.98"/>
</g>
<!-- dp0_gate_s0_l5_tp3 -->
<g id="node100" class="node">
<title>dp0_gate_s0_l5_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="18626,-1122.17 18193.69,-1122.17 18082.48,-1046.17 18514.79,-1046.17 18626,-1122.17"/>
<text text-anchor="middle" x="18354.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="18354.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="18354.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU3</text>
</g>
<!-- dp0_gate_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3 -->
<g id="edge85" class="edge">
<title>dp0_gate_s0_l5_tp3&#45;&gt;dp0_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18334.43,-1045.99C18320.04,-1018.98 18300.89,-983.05 18287.87,-958.62"/>
<polygon fill="black" stroke="black" points="18290.83,-956.73 18283.04,-949.55 18284.65,-960.02 18290.83,-956.73"/>
</g>
<!-- dp0_pp_s1_to_s2 -->
<g id="node102" class="node">
<title>dp0_pp_s1_to_s2</title>
<ellipse fill="none" stroke="black" cx="18273.24" cy="-671.83" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="18273.24" y="-679.63" font-family="Times,serif" font-size="9.00">Pipeline Stage 12</text>
<text text-anchor="middle" x="18273.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="18273.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU15GPU16</text>
</g>
<!-- dp0_pp_s0_to_s1&#45;&gt;dp0_pp_s1_to_s2 -->
<g id="edge87" class="edge">
<title>dp0_pp_s0_to_s1&#45;&gt;dp0_pp_s1_to_s2</title>
<path fill="none" stroke="black" d="M18273.24,-763.95C18273.24,-747.72 18273.24,-726.61 18273.24,-708.79"/>
<polygon fill="black" stroke="black" points="18276.74,-708.75 18273.24,-698.75 18269.74,-708.75 18276.74,-708.75"/>
</g>
<!-- dp0_pp_s2_to_s3 -->
<g id="node103" class="node">
<title>dp0_pp_s2_to_s3</title>
<ellipse fill="none" stroke="black" cx="18273.24" cy="-559.09" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="18273.24" y="-566.89" font-family="Times,serif" font-size="9.00">Pipeline Stage 23</text>
<text text-anchor="middle" x="18273.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="18273.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU23GPU24</text>
</g>
<!-- dp0_pp_s1_to_s2&#45;&gt;dp0_pp_s2_to_s3 -->
<g id="edge88" class="edge">
<title>dp0_pp_s1_to_s2&#45;&gt;dp0_pp_s2_to_s3</title>
<path fill="none" stroke="black" d="M18273.24,-644.87C18273.24,-630.39 18273.24,-612.14 18273.24,-596.29"/>
<polygon fill="black" stroke="black" points="18276.74,-596.28 18273.24,-586.28 18269.74,-596.28 18276.74,-596.28"/>
</g>
<!-- dp0_final_s3_tp0 -->
<g id="node104" class="node">
<title>dp0_final_s3_tp0</title>
<polygon fill="none" stroke="black" points="18386.74,-465.35 18159.74,-465.35 18159.74,-427.35 18386.74,-427.35 18386.74,-465.35"/>
<text text-anchor="middle" x="18273.24" y="-454.15" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="18273.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="18273.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU24</text>
</g>
<!-- dp0_pp_s2_to_s3&#45;&gt;dp0_final_s3_tp0 -->
<g id="edge89" class="edge">
<title>dp0_pp_s2_to_s3&#45;&gt;dp0_final_s3_tp0</title>
<path fill="none" stroke="black" d="M18273.24,-532.13C18273.24,-515.19 18273.24,-493.07 18273.24,-475.68"/>
<polygon fill="black" stroke="black" points="18276.74,-475.54 18273.24,-465.54 18269.74,-475.54 18276.74,-475.54"/>
</g>
<!-- dp0_final_s3_tp1 -->
<g id="node105" class="node">
<title>dp0_final_s3_tp1</title>
<polygon fill="none" stroke="black" points="18888.74,-1103.17 18661.74,-1103.17 18661.74,-1065.17 18888.74,-1065.17 18888.74,-1103.17"/>
<text text-anchor="middle" x="18775.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="18775.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="18775.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU25</text>
</g>
<!-- dp0_final_s3_tp2 -->
<g id="node106" class="node">
<title>dp0_final_s3_tp2</title>
<polygon fill="none" stroke="black" points="19151.74,-1103.17 18924.74,-1103.17 18924.74,-1065.17 19151.74,-1065.17 19151.74,-1103.17"/>
<text text-anchor="middle" x="19038.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="19038.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="19038.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU26</text>
</g>
<!-- dp0_final_s3_tp3 -->
<g id="node107" class="node">
<title>dp0_final_s3_tp3</title>
<polygon fill="none" stroke="black" points="19414.74,-1103.17 19187.74,-1103.17 19187.74,-1065.17 19414.74,-1065.17 19414.74,-1103.17"/>
<text text-anchor="middle" x="19301.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="19301.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="19301.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU27</text>
</g>
<!-- dp0_dp_gather -->
<g id="node108" class="node">
<title>dp0_dp_gather</title>
<polygon fill="none" stroke="black" points="19536.43,-968.17 19162.3,-968.17 19066.06,-892.17 19440.18,-892.17 19536.43,-968.17"/>
<text text-anchor="middle" x="19301.24" y="-937.97" font-family="Times,serif" font-size="9.00">DP Gather 0</text>
<text text-anchor="middle" x="19301.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="19301.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: Host</text>
</g>
<!-- dp0_final_s3_tp3&#45;&gt;dp0_dp_gather -->
<g id="edge90" class="edge">
<title>dp0_final_s3_tp3&#45;&gt;dp0_dp_gather</title>
<path fill="none" stroke="black" d="M19301.24,-1065.14C19301.24,-1043.89 19301.24,-1007.77 19301.24,-978.38"/>
<polygon fill="black" stroke="black" points="19304.74,-978.31 19301.24,-968.31 19297.74,-978.31 19304.74,-978.31"/>
</g>
<!-- output -->
<g id="node215" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="19555.24" cy="-790.93" rx="202.88" ry="33.47"/>
<text text-anchor="middle" x="19555.24" y="-800.83" font-family="Times,serif" font-size="12.00">Output Token</text>
<text text-anchor="middle" x="19555.24" y="-787.83" font-family="Times,serif" font-size="12.00">[batch_size=512, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="19555.24" y="-774.83" font-family="Times,serif" font-size="12.00">GPU: Host</text>
</g>
<!-- dp0_dp_gather&#45;&gt;output -->
<g id="edge180" class="edge">
<title>dp0_dp_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M19369.98,-892.03C19406.95,-872.05 19452.34,-847.53 19488.94,-827.76"/>
<polygon fill="black" stroke="black" points="19490.91,-830.67 19498.04,-822.84 19487.58,-824.51 19490.91,-830.67"/>
</g>
<!-- dp1_kv_cache_s0_tp0 -->
<g id="node113" class="node">
<title>dp1_kv_cache_s0_tp0</title>
<polygon fill="none" stroke="black" points="687.24,-690.83 415.24,-690.83 415.24,-652.83 687.24,-652.83 687.24,-690.83"/>
<text text-anchor="middle" x="551.24" y="-679.63" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="551.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="551.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_embed_s0_tp0&#45;&gt;dp1_kv_cache_s0_tp0 -->
<g id="edge92" class="edge">
<title>dp1_embed_s0_tp0&#45;&gt;dp1_kv_cache_s0_tp0</title>
<path fill="none" stroke="black" d="M544.47,-771.89C545.76,-753.04 547.8,-723.19 549.3,-701.18"/>
<polygon fill="black" stroke="black" points="552.8,-701.3 549.99,-691.08 545.82,-700.82 552.8,-701.3"/>
</g>
<!-- dp1_embed_s0_tp1 -->
<g id="node110" class="node">
<title>dp1_embed_s0_tp1</title>
<polygon fill="none" stroke="black" points="20328.74,-1103.17 20101.74,-1103.17 20101.74,-1065.17 20328.74,-1065.17 20328.74,-1103.17"/>
<text text-anchor="middle" x="20215.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="20215.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="20215.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_kv_cache_s0_tp1 -->
<g id="node114" class="node">
<title>dp1_kv_cache_s0_tp1</title>
<polygon fill="none" stroke="black" points="20351.24,-949.17 20079.24,-949.17 20079.24,-911.17 20351.24,-911.17 20351.24,-949.17"/>
<text text-anchor="middle" x="20215.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="20215.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="20215.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_embed_s0_tp1&#45;&gt;dp1_kv_cache_s0_tp1 -->
<g id="edge93" class="edge">
<title>dp1_embed_s0_tp1&#45;&gt;dp1_kv_cache_s0_tp1</title>
<path fill="none" stroke="black" d="M20215.24,-1065.14C20215.24,-1038.97 20215.24,-990.22 20215.24,-959.31"/>
<polygon fill="black" stroke="black" points="20218.74,-959.18 20215.24,-949.18 20211.74,-959.18 20218.74,-959.18"/>
</g>
<!-- dp1_embed_s0_tp2 -->
<g id="node111" class="node">
<title>dp1_embed_s0_tp2</title>
<polygon fill="none" stroke="black" points="20636.74,-1103.17 20409.74,-1103.17 20409.74,-1065.17 20636.74,-1065.17 20636.74,-1103.17"/>
<text text-anchor="middle" x="20523.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="20523.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="20523.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_kv_cache_s0_tp2 -->
<g id="node115" class="node">
<title>dp1_kv_cache_s0_tp2</title>
<polygon fill="none" stroke="black" points="20659.24,-949.17 20387.24,-949.17 20387.24,-911.17 20659.24,-911.17 20659.24,-949.17"/>
<text text-anchor="middle" x="20523.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="20523.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="20523.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_embed_s0_tp2&#45;&gt;dp1_kv_cache_s0_tp2 -->
<g id="edge94" class="edge">
<title>dp1_embed_s0_tp2&#45;&gt;dp1_kv_cache_s0_tp2</title>
<path fill="none" stroke="black" d="M20523.24,-1065.14C20523.24,-1038.97 20523.24,-990.22 20523.24,-959.31"/>
<polygon fill="black" stroke="black" points="20526.74,-959.18 20523.24,-949.18 20519.74,-959.18 20526.74,-959.18"/>
</g>
<!-- dp1_embed_s0_tp3 -->
<g id="node112" class="node">
<title>dp1_embed_s0_tp3</title>
<polygon fill="none" stroke="black" points="20944.74,-1103.17 20717.74,-1103.17 20717.74,-1065.17 20944.74,-1065.17 20944.74,-1103.17"/>
<text text-anchor="middle" x="20831.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Embedding</text>
<text text-anchor="middle" x="20831.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="20831.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_kv_cache_s0_tp3 -->
<g id="node116" class="node">
<title>dp1_kv_cache_s0_tp3</title>
<polygon fill="none" stroke="black" points="20967.24,-949.17 20695.24,-949.17 20695.24,-911.17 20967.24,-911.17 20967.24,-949.17"/>
<text text-anchor="middle" x="20831.24" y="-937.97" font-family="Times,serif" font-size="9.00">KV Cache Update</text>
<text text-anchor="middle" x="20831.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1+prev, heads=16, d_k=64]</text>
<text text-anchor="middle" x="20831.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_embed_s0_tp3&#45;&gt;dp1_kv_cache_s0_tp3 -->
<g id="edge95" class="edge">
<title>dp1_embed_s0_tp3&#45;&gt;dp1_kv_cache_s0_tp3</title>
<path fill="none" stroke="black" d="M20831.24,-1065.14C20831.24,-1038.97 20831.24,-990.22 20831.24,-959.31"/>
<polygon fill="black" stroke="black" points="20834.74,-959.18 20831.24,-949.18 20827.74,-959.18 20834.74,-959.18"/>
</g>
<!-- dp1_attn_s0_l0_tp0 -->
<g id="node117" class="node">
<title>dp1_attn_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="676.74,-578.09 431.74,-578.09 431.74,-540.09 676.74,-540.09 676.74,-578.09"/>
<text text-anchor="middle" x="554.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="554.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="554.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_kv_cache_s0_tp0&#45;&gt;dp1_attn_s0_l0_tp0 -->
<g id="edge96" class="edge">
<title>dp1_kv_cache_s0_tp0&#45;&gt;dp1_attn_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M551.74,-652.54C552.21,-635.15 552.92,-608.72 553.47,-588.57"/>
<polygon fill="black" stroke="black" points="556.97,-588.5 553.75,-578.4 549.98,-588.31 556.97,-588.5"/>
</g>
<!-- dp1_attn_s0_l0_ar0 -->
<g id="node121" class="node">
<title>dp1_attn_s0_l0_ar0</title>
<ellipse fill="none" stroke="black" cx="555.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="555.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="555.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="555.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l0_tp0&#45;&gt;dp1_attn_s0_l0_ar0 -->
<g id="edge97" class="edge">
<title>dp1_attn_s0_l0_tp0&#45;&gt;dp1_attn_s0_l0_ar0</title>
<path fill="none" stroke="black" d="M554.41,-539.8C554.54,-524.56 554.74,-502.39 554.91,-483.58"/>
<polygon fill="black" stroke="black" points="558.41,-483.57 555,-473.54 551.41,-483.51 558.41,-483.57"/>
</g>
<!-- dp1_attn_s0_l0_tp1 -->
<g id="node118" class="node">
<title>dp1_attn_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="677.74,-360.48 432.74,-360.48 432.74,-322.48 677.74,-322.48 677.74,-360.48"/>
<text text-anchor="middle" x="555.24" y="-349.28" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="555.24" y="-339.28" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="555.24" y="-329.28" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_ar1 -->
<g id="node122" class="node">
<title>dp1_attn_s0_l0_ar1</title>
<ellipse fill="none" stroke="black" cx="555.24" cy="-236.61" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="555.24" y="-244.41" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="555.24" y="-234.41" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="555.24" y="-224.41" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_tp1&#45;&gt;dp1_attn_s0_l0_ar1 -->
<g id="edge99" class="edge">
<title>dp1_attn_s0_l0_tp1&#45;&gt;dp1_attn_s0_l0_ar1</title>
<path fill="none" stroke="black" d="M555.24,-322.09C555.24,-308.72 555.24,-290.19 555.24,-273.88"/>
<polygon fill="black" stroke="black" points="558.74,-273.57 555.24,-263.57 551.74,-273.57 558.74,-273.57"/>
</g>
<!-- dp1_attn_s0_l0_tp2 -->
<g id="node119" class="node">
<title>dp1_attn_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="677.74,-150.74 432.74,-150.74 432.74,-112.74 677.74,-112.74 677.74,-150.74"/>
<text text-anchor="middle" x="555.24" y="-139.54" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="555.24" y="-129.54" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="555.24" y="-119.54" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_ar2 -->
<g id="node123" class="node">
<title>dp1_attn_s0_l0_ar2</title>
<ellipse fill="none" stroke="black" cx="555.24" cy="-26.87" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="555.24" y="-34.67" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L0</text>
<text text-anchor="middle" x="555.24" y="-24.67" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="555.24" y="-14.67" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_tp2&#45;&gt;dp1_attn_s0_l0_ar2 -->
<g id="edge101" class="edge">
<title>dp1_attn_s0_l0_tp2&#45;&gt;dp1_attn_s0_l0_ar2</title>
<path fill="none" stroke="black" d="M555.24,-112.35C555.24,-98.98 555.24,-80.45 555.24,-64.14"/>
<polygon fill="black" stroke="black" points="558.74,-63.83 555.24,-53.83 551.74,-63.83 558.74,-63.83"/>
</g>
<!-- dp1_attn_s0_l0_tp3 -->
<g id="node120" class="node">
<title>dp1_attn_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="22383.74,-1103.17 22138.74,-1103.17 22138.74,-1065.17 22383.74,-1065.17 22383.74,-1103.17"/>
<text text-anchor="middle" x="22261.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L0</text>
<text text-anchor="middle" x="22261.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="22261.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l0_tp0 -->
<g id="node124" class="node">
<title>dp1_moe_s0_l0_tp0</title>
<polygon fill="none" stroke="black" points="22037.24,-949.17 21775.24,-949.17 21775.24,-911.17 22037.24,-911.17 22037.24,-949.17"/>
<text text-anchor="middle" x="21906.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="21906.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21906.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp0 -->
<g id="edge102" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" d="M22219.12,-1065.14C22153.87,-1037.2 22028.52,-983.52 21957.89,-953.28"/>
<polygon fill="black" stroke="black" points="21958.87,-949.9 21948.3,-949.18 21956.12,-956.33 21958.87,-949.9"/>
</g>
<!-- dp1_moe_s0_l0_tp1 -->
<g id="node126" class="node">
<title>dp1_moe_s0_l0_tp1</title>
<polygon fill="none" stroke="black" points="21546.24,-949.17 21284.24,-949.17 21284.24,-911.17 21546.24,-911.17 21546.24,-949.17"/>
<text text-anchor="middle" x="21415.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="21415.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21415.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp1 -->
<g id="edge104" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M22198.13,-1065.1C22174.18,-1058.61 22146.57,-1051.56 22121.24,-1046.17 21926.87,-1004.75 21699.61,-970.18 21556.55,-950.07"/>
<polygon fill="black" stroke="black" points="21556.78,-946.57 21546.39,-948.65 21555.81,-953.51 21556.78,-946.57"/>
</g>
<!-- dp1_moe_s0_l0_tp2 -->
<g id="node128" class="node">
<title>dp1_moe_s0_l0_tp2</title>
<polygon fill="none" stroke="black" points="22704.24,-949.17 22442.24,-949.17 22442.24,-911.17 22704.24,-911.17 22704.24,-949.17"/>
<text text-anchor="middle" x="22573.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="22573.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="22573.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp2 -->
<g id="edge106" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M22298.26,-1065.14C22355.37,-1037.31 22464.88,-983.96 22527.08,-953.66"/>
<polygon fill="black" stroke="black" points="22528.82,-956.7 22536.27,-949.18 22525.75,-950.41 22528.82,-956.7"/>
</g>
<!-- dp1_moe_s0_l0_tp3 -->
<g id="node130" class="node">
<title>dp1_moe_s0_l0_tp3</title>
<polygon fill="none" stroke="black" points="23256.24,-949.17 22994.24,-949.17 22994.24,-911.17 23256.24,-911.17 23256.24,-949.17"/>
<text text-anchor="middle" x="23125.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L0</text>
<text text-anchor="middle" x="23125.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="23125.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3 -->
<g id="edge108" class="edge">
<title>dp1_attn_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" d="M22323.99,-1065.14C22348.02,-1058.62 22375.78,-1051.54 22401.24,-1046.17 22602.25,-1003.76 22837.61,-969.11 22984.1,-949.29"/>
<polygon fill="black" stroke="black" points="22984.61,-952.76 22994.05,-947.95 22983.67,-945.82 22984.61,-952.76"/>
</g>
<!-- dp1_attn_s0_l0_ar0&#45;&gt;dp1_attn_s0_l0_tp1 -->
<g id="edge98" class="edge">
<title>dp1_attn_s0_l0_ar0&#45;&gt;dp1_attn_s0_l0_tp1</title>
<path fill="none" stroke="black" d="M555.24,-419.39C555.24,-404.64 555.24,-386.15 555.24,-370.99"/>
<polygon fill="black" stroke="black" points="558.74,-370.65 555.24,-360.65 551.74,-370.65 558.74,-370.65"/>
</g>
<!-- dp1_attn_s0_l0_ar1&#45;&gt;dp1_attn_s0_l0_tp2 -->
<g id="edge100" class="edge">
<title>dp1_attn_s0_l0_ar1&#45;&gt;dp1_attn_s0_l0_tp2</title>
<path fill="none" stroke="black" d="M555.24,-209.65C555.24,-194.9 555.24,-176.41 555.24,-161.25"/>
<polygon fill="black" stroke="black" points="558.74,-160.91 555.24,-150.91 551.74,-160.91 558.74,-160.91"/>
</g>
<!-- dp1_gate_s0_l0_tp0 -->
<g id="node125" class="node">
<title>dp1_gate_s0_l0_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22103,-1122.17 21670.69,-1122.17 21559.48,-1046.17 21991.79,-1046.17 22103,-1122.17"/>
<text text-anchor="middle" x="21831.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="21831.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21831.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l0_tp0&#45;&gt;dp1_moe_s0_l0_tp0 -->
<g id="edge103" class="edge">
<title>dp1_gate_s0_l0_tp0&#45;&gt;dp1_moe_s0_l0_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21849.59,-1045.99C21862.91,-1018.98 21880.64,-983.05 21892.7,-958.62"/>
<polygon fill="black" stroke="black" points="21895.89,-960.06 21897.17,-949.55 21889.61,-956.97 21895.89,-960.06"/>
</g>
<!-- dp1_gate_s0_l0_tp1 -->
<g id="node127" class="node">
<title>dp1_gate_s0_l0_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="21524,-1122.17 21091.69,-1122.17 20980.48,-1046.17 21412.79,-1046.17 21524,-1122.17"/>
<text text-anchor="middle" x="21252.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="21252.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="21252.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l0_tp1&#45;&gt;dp1_moe_s0_l0_tp1 -->
<g id="edge105" class="edge">
<title>dp1_gate_s0_l0_tp1&#45;&gt;dp1_moe_s0_l0_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M21292.12,-1045.99C21321.97,-1018.15 21362,-980.81 21388.2,-956.38"/>
<polygon fill="black" stroke="black" points="21390.6,-958.93 21395.53,-949.55 21385.83,-953.81 21390.6,-958.93"/>
</g>
<!-- dp1_gate_s0_l0_tp2 -->
<g id="node129" class="node">
<title>dp1_gate_s0_l0_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22963,-1122.17 22530.69,-1122.17 22419.48,-1046.17 22851.79,-1046.17 22963,-1122.17"/>
<text text-anchor="middle" x="22691.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="22691.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="22691.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l0_tp2&#45;&gt;dp1_moe_s0_l0_tp2 -->
<g id="edge107" class="edge">
<title>dp1_gate_s0_l0_tp2&#45;&gt;dp1_moe_s0_l0_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22662.38,-1045.99C22641.14,-1018.63 22612.77,-982.09 22593.8,-957.65"/>
<polygon fill="black" stroke="black" points="22596.41,-955.3 22587.51,-949.55 22590.88,-959.59 22596.41,-955.3"/>
</g>
<!-- dp1_gate_s0_l0_tp3 -->
<g id="node131" class="node">
<title>dp1_gate_s0_l0_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="23542,-1122.17 23109.69,-1122.17 22998.48,-1046.17 23430.79,-1046.17 23542,-1122.17"/>
<text text-anchor="middle" x="23270.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L0</text>
<text text-anchor="middle" x="23270.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="23270.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3 -->
<g id="edge109" class="edge">
<title>dp1_gate_s0_l0_tp3&#45;&gt;dp1_moe_s0_l0_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23234.77,-1045.99C23208.44,-1018.39 23173.21,-981.45 23149.9,-957.02"/>
<polygon fill="black" stroke="black" points="23152.21,-954.37 23142.77,-949.55 23147.14,-959.2 23152.21,-954.37"/>
</g>
<!-- dp1_attn_s0_l1_tp0 -->
<g id="node132" class="node">
<title>dp1_attn_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="23822.74,-1103.17 23577.74,-1103.17 23577.74,-1065.17 23822.74,-1065.17 23822.74,-1103.17"/>
<text text-anchor="middle" x="23700.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="23700.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_ar0 -->
<g id="node136" class="node">
<title>dp1_attn_s0_l1_ar0</title>
<ellipse fill="none" stroke="black" cx="23700.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="23700.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23700.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_tp0&#45;&gt;dp1_attn_s0_l1_ar0 -->
<g id="edge110" class="edge">
<title>dp1_attn_s0_l1_tp0&#45;&gt;dp1_attn_s0_l1_ar0</title>
<path fill="none" stroke="black" d="M23700.24,-1065.14C23700.24,-1041.15 23700.24,-998.19 23700.24,-967.38"/>
<polygon fill="black" stroke="black" points="23703.74,-967.04 23700.24,-957.04 23696.74,-967.04 23703.74,-967.04"/>
</g>
<!-- dp1_attn_s0_l1_tp1 -->
<g id="node133" class="node">
<title>dp1_attn_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="23822.74,-809.93 23577.74,-809.93 23577.74,-771.93 23822.74,-771.93 23822.74,-809.93"/>
<text text-anchor="middle" x="23700.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="23700.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_ar1 -->
<g id="node137" class="node">
<title>dp1_attn_s0_l1_ar1</title>
<ellipse fill="none" stroke="black" cx="23700.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="23700.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23700.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_tp1&#45;&gt;dp1_attn_s0_l1_ar1 -->
<g id="edge112" class="edge">
<title>dp1_attn_s0_l1_tp1&#45;&gt;dp1_attn_s0_l1_ar1</title>
<path fill="none" stroke="black" d="M23700.24,-771.89C23700.24,-755.21 23700.24,-729.92 23700.24,-709.06"/>
<polygon fill="black" stroke="black" points="23703.74,-708.94 23700.24,-698.94 23696.74,-708.94 23703.74,-708.94"/>
</g>
<!-- dp1_attn_s0_l1_tp2 -->
<g id="node134" class="node">
<title>dp1_attn_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="23822.74,-578.09 23577.74,-578.09 23577.74,-540.09 23822.74,-540.09 23822.74,-578.09"/>
<text text-anchor="middle" x="23700.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="23700.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_ar2 -->
<g id="node138" class="node">
<title>dp1_attn_s0_l1_ar2</title>
<ellipse fill="none" stroke="black" cx="23700.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="23700.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L1</text>
<text text-anchor="middle" x="23700.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="23700.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_tp2&#45;&gt;dp1_attn_s0_l1_ar2 -->
<g id="edge114" class="edge">
<title>dp1_attn_s0_l1_tp2&#45;&gt;dp1_attn_s0_l1_ar2</title>
<path fill="none" stroke="black" d="M23700.24,-539.8C23700.24,-524.56 23700.24,-502.39 23700.24,-483.58"/>
<polygon fill="black" stroke="black" points="23703.74,-483.54 23700.24,-473.54 23696.74,-483.54 23703.74,-483.54"/>
</g>
<!-- dp1_attn_s0_l1_tp3 -->
<g id="node135" class="node">
<title>dp1_attn_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="25261.74,-1103.17 25016.74,-1103.17 25016.74,-1065.17 25261.74,-1065.17 25261.74,-1103.17"/>
<text text-anchor="middle" x="25139.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L1</text>
<text text-anchor="middle" x="25139.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="25139.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l1_tp0 -->
<g id="node139" class="node">
<title>dp1_moe_s0_l1_tp0</title>
<polygon fill="none" stroke="black" points="24948.24,-949.17 24686.24,-949.17 24686.24,-911.17 24948.24,-911.17 24948.24,-949.17"/>
<text text-anchor="middle" x="24817.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="24817.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24817.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp0 -->
<g id="edge115" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" d="M25101.04,-1065.14C25041.97,-1037.25 24928.61,-983.74 24864.49,-953.47"/>
<polygon fill="black" stroke="black" points="24865.93,-950.28 24855.39,-949.18 24862.94,-956.61 24865.93,-950.28"/>
</g>
<!-- dp1_moe_s0_l1_tp1 -->
<g id="node141" class="node">
<title>dp1_moe_s0_l1_tp1</title>
<polygon fill="none" stroke="black" points="24406.24,-949.17 24144.24,-949.17 24144.24,-911.17 24406.24,-911.17 24406.24,-949.17"/>
<text text-anchor="middle" x="24275.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="24275.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24275.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp1 -->
<g id="edge117" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M25076.49,-1065.14C25052.46,-1058.62 25024.7,-1051.54 24999.24,-1046.17 24798.23,-1003.76 24562.87,-969.11 24416.39,-949.29"/>
<polygon fill="black" stroke="black" points="24416.81,-945.82 24406.43,-947.95 24415.87,-952.76 24416.81,-945.82"/>
</g>
<!-- dp1_moe_s0_l1_tp2 -->
<g id="node143" class="node">
<title>dp1_moe_s0_l1_tp2</title>
<polygon fill="none" stroke="black" points="25593.24,-949.17 25331.24,-949.17 25331.24,-911.17 25593.24,-911.17 25593.24,-949.17"/>
<text text-anchor="middle" x="25462.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="25462.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="25462.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp2 -->
<g id="edge119" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M25177.56,-1065.14C25236.81,-1037.25 25350.52,-983.74 25414.85,-953.47"/>
<polygon fill="black" stroke="black" points="25416.41,-956.6 25423.97,-949.18 25413.43,-950.27 25416.41,-956.6"/>
</g>
<!-- dp1_moe_s0_l1_tp3 -->
<g id="node145" class="node">
<title>dp1_moe_s0_l1_tp3</title>
<polygon fill="none" stroke="black" points="26139.24,-949.17 25877.24,-949.17 25877.24,-911.17 26139.24,-911.17 26139.24,-949.17"/>
<text text-anchor="middle" x="26008.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L1</text>
<text text-anchor="middle" x="26008.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="26008.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3 -->
<g id="edge121" class="edge">
<title>dp1_attn_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" d="M25201.99,-1065.13C25226.02,-1058.6 25253.78,-1051.53 25279.24,-1046.17 25482.09,-1003.48 25719.7,-968.82 25867.12,-949.09"/>
<polygon fill="black" stroke="black" points="25867.69,-952.54 25877.14,-947.75 25866.76,-945.6 25867.69,-952.54"/>
</g>
<!-- dp1_attn_s0_l1_ar0&#45;&gt;dp1_attn_s0_l1_tp1 -->
<g id="edge111" class="edge">
<title>dp1_attn_s0_l1_ar0&#45;&gt;dp1_attn_s0_l1_tp1</title>
<path fill="none" stroke="black" d="M23700.24,-903.03C23700.24,-879.32 23700.24,-844.46 23700.24,-820.13"/>
<polygon fill="black" stroke="black" points="23703.74,-820.09 23700.24,-810.09 23696.74,-820.09 23703.74,-820.09"/>
</g>
<!-- dp1_attn_s0_l1_ar1&#45;&gt;dp1_attn_s0_l1_tp2 -->
<g id="edge113" class="edge">
<title>dp1_attn_s0_l1_ar1&#45;&gt;dp1_attn_s0_l1_tp2</title>
<path fill="none" stroke="black" d="M23700.24,-644.87C23700.24,-627.93 23700.24,-605.81 23700.24,-588.42"/>
<polygon fill="black" stroke="black" points="23703.74,-588.28 23700.24,-578.28 23696.74,-588.28 23703.74,-588.28"/>
</g>
<!-- dp1_gate_s0_l1_tp0 -->
<g id="node140" class="node">
<title>dp1_gate_s0_l1_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24981,-1122.17 24548.69,-1122.17 24437.48,-1046.17 24869.79,-1046.17 24981,-1122.17"/>
<text text-anchor="middle" x="24709.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="24709.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24709.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l1_tp0&#45;&gt;dp1_moe_s0_l1_tp0 -->
<g id="edge116" class="edge">
<title>dp1_gate_s0_l1_tp0&#45;&gt;dp1_moe_s0_l1_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24735.66,-1045.99C24755.02,-1018.75 24780.83,-982.41 24798.2,-957.97"/>
<polygon fill="black" stroke="black" points="24801.24,-959.73 24804.18,-949.55 24795.54,-955.67 24801.24,-959.73"/>
</g>
<!-- dp1_gate_s0_l1_tp1 -->
<g id="node142" class="node">
<title>dp1_gate_s0_l1_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24402,-1122.17 23969.69,-1122.17 23858.48,-1046.17 24290.79,-1046.17 24402,-1122.17"/>
<text text-anchor="middle" x="24130.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="24130.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="24130.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l1_tp1&#45;&gt;dp1_moe_s0_l1_tp1 -->
<g id="edge118" class="edge">
<title>dp1_gate_s0_l1_tp1&#45;&gt;dp1_moe_s0_l1_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24165.71,-1045.99C24192.04,-1018.39 24227.27,-981.45 24250.58,-957.02"/>
<polygon fill="black" stroke="black" points="24253.34,-959.2 24257.71,-949.55 24248.27,-954.37 24253.34,-959.2"/>
</g>
<!-- dp1_gate_s0_l1_tp2 -->
<g id="node144" class="node">
<title>dp1_gate_s0_l1_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="25841,-1122.17 25408.69,-1122.17 25297.48,-1046.17 25729.79,-1046.17 25841,-1122.17"/>
<text text-anchor="middle" x="25569.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="25569.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="25569.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l1_tp2&#45;&gt;dp1_moe_s0_l1_tp2 -->
<g id="edge120" class="edge">
<title>dp1_gate_s0_l1_tp2&#45;&gt;dp1_moe_s0_l1_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M25543.07,-1045.99C25523.89,-1018.75 25498.31,-982.41 25481.11,-957.97"/>
<polygon fill="black" stroke="black" points="25483.8,-955.71 25475.18,-949.55 25478.07,-959.74 25483.8,-955.71"/>
</g>
<!-- dp1_gate_s0_l1_tp3 -->
<g id="node146" class="node">
<title>dp1_gate_s0_l1_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="26420,-1122.17 25987.69,-1122.17 25876.48,-1046.17 26308.79,-1046.17 26420,-1122.17"/>
<text text-anchor="middle" x="26148.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L1</text>
<text text-anchor="middle" x="26148.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="26148.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3 -->
<g id="edge122" class="edge">
<title>dp1_gate_s0_l1_tp3&#45;&gt;dp1_moe_s0_l1_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26113.99,-1045.99C26088.57,-1018.39 26054.56,-981.45 26032.05,-957.02"/>
<polygon fill="black" stroke="black" points="26034.52,-954.53 26025.17,-949.55 26029.37,-959.27 26034.52,-954.53"/>
</g>
<!-- dp1_attn_s0_l2_tp0 -->
<g id="node147" class="node">
<title>dp1_attn_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="26700.74,-1103.17 26455.74,-1103.17 26455.74,-1065.17 26700.74,-1065.17 26700.74,-1103.17"/>
<text text-anchor="middle" x="26578.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="26578.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_ar0 -->
<g id="node151" class="node">
<title>dp1_attn_s0_l2_ar0</title>
<ellipse fill="none" stroke="black" cx="26578.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="26578.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26578.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_tp0&#45;&gt;dp1_attn_s0_l2_ar0 -->
<g id="edge123" class="edge">
<title>dp1_attn_s0_l2_tp0&#45;&gt;dp1_attn_s0_l2_ar0</title>
<path fill="none" stroke="black" d="M26578.24,-1065.14C26578.24,-1041.15 26578.24,-998.19 26578.24,-967.38"/>
<polygon fill="black" stroke="black" points="26581.74,-967.04 26578.24,-957.04 26574.74,-967.04 26581.74,-967.04"/>
</g>
<!-- dp1_attn_s0_l2_tp1 -->
<g id="node148" class="node">
<title>dp1_attn_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="26700.74,-809.93 26455.74,-809.93 26455.74,-771.93 26700.74,-771.93 26700.74,-809.93"/>
<text text-anchor="middle" x="26578.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="26578.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_ar1 -->
<g id="node152" class="node">
<title>dp1_attn_s0_l2_ar1</title>
<ellipse fill="none" stroke="black" cx="26578.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="26578.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26578.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_tp1&#45;&gt;dp1_attn_s0_l2_ar1 -->
<g id="edge125" class="edge">
<title>dp1_attn_s0_l2_tp1&#45;&gt;dp1_attn_s0_l2_ar1</title>
<path fill="none" stroke="black" d="M26578.24,-771.89C26578.24,-755.21 26578.24,-729.92 26578.24,-709.06"/>
<polygon fill="black" stroke="black" points="26581.74,-708.94 26578.24,-698.94 26574.74,-708.94 26581.74,-708.94"/>
</g>
<!-- dp1_attn_s0_l2_tp2 -->
<g id="node149" class="node">
<title>dp1_attn_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="26700.74,-578.09 26455.74,-578.09 26455.74,-540.09 26700.74,-540.09 26700.74,-578.09"/>
<text text-anchor="middle" x="26578.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="26578.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_ar2 -->
<g id="node153" class="node">
<title>dp1_attn_s0_l2_ar2</title>
<ellipse fill="none" stroke="black" cx="26578.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="26578.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L2</text>
<text text-anchor="middle" x="26578.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="26578.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_tp2&#45;&gt;dp1_attn_s0_l2_ar2 -->
<g id="edge127" class="edge">
<title>dp1_attn_s0_l2_tp2&#45;&gt;dp1_attn_s0_l2_ar2</title>
<path fill="none" stroke="black" d="M26578.24,-539.8C26578.24,-524.56 26578.24,-502.39 26578.24,-483.58"/>
<polygon fill="black" stroke="black" points="26581.74,-483.54 26578.24,-473.54 26574.74,-483.54 26581.74,-483.54"/>
</g>
<!-- dp1_attn_s0_l2_tp3 -->
<g id="node150" class="node">
<title>dp1_attn_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="28139.74,-1103.17 27894.74,-1103.17 27894.74,-1065.17 28139.74,-1065.17 28139.74,-1103.17"/>
<text text-anchor="middle" x="28017.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L2</text>
<text text-anchor="middle" x="28017.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="28017.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l2_tp0 -->
<g id="node154" class="node">
<title>dp1_moe_s0_l2_tp0</title>
<polygon fill="none" stroke="black" points="27838.24,-949.17 27576.24,-949.17 27576.24,-911.17 27838.24,-911.17 27838.24,-949.17"/>
<text text-anchor="middle" x="27707.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="27707.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27707.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp0 -->
<g id="edge128" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" d="M27980.46,-1065.14C27923.71,-1037.31 27814.91,-983.96 27753.11,-953.66"/>
<polygon fill="black" stroke="black" points="27754.49,-950.44 27743.97,-949.18 27751.41,-956.72 27754.49,-950.44"/>
</g>
<!-- dp1_moe_s0_l2_tp1 -->
<g id="node156" class="node">
<title>dp1_moe_s0_l2_tp1</title>
<polygon fill="none" stroke="black" points="27220.24,-949.17 26958.24,-949.17 26958.24,-911.17 27220.24,-911.17 27220.24,-949.17"/>
<text text-anchor="middle" x="27089.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="27089.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27089.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp1 -->
<g id="edge130" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M27955.22,-1065.16C27931.03,-1058.56 27902.98,-1051.43 27877.24,-1046.17 27652.91,-1000.31 27389.04,-965.66 27230.68,-946.9"/>
<polygon fill="black" stroke="black" points="27230.74,-943.39 27220.4,-945.69 27229.92,-950.34 27230.74,-943.39"/>
</g>
<!-- dp1_moe_s0_l2_tp2 -->
<g id="node158" class="node">
<title>dp1_moe_s0_l2_tp2</title>
<polygon fill="none" stroke="black" points="28417.24,-949.17 28155.24,-949.17 28155.24,-911.17 28417.24,-911.17 28417.24,-949.17"/>
<text text-anchor="middle" x="28286.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="28286.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28286.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp2 -->
<g id="edge132" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M28049.16,-1065.14C28098.1,-1037.48 28191.65,-984.62 28245.45,-954.22"/>
<polygon fill="black" stroke="black" points="28247.38,-957.15 28254.37,-949.18 28243.94,-951.05 28247.38,-957.15"/>
</g>
<!-- dp1_moe_s0_l2_tp3 -->
<g id="node160" class="node">
<title>dp1_moe_s0_l2_tp3</title>
<polygon fill="none" stroke="black" points="29012.24,-949.17 28750.24,-949.17 28750.24,-911.17 29012.24,-911.17 29012.24,-949.17"/>
<text text-anchor="middle" x="28881.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L2</text>
<text text-anchor="middle" x="28881.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28881.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3 -->
<g id="edge134" class="edge">
<title>dp1_attn_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" d="M28079.99,-1065.14C28104.02,-1058.62 28131.78,-1051.54 28157.24,-1046.17 28358.25,-1003.76 28593.61,-969.11 28740.1,-949.29"/>
<polygon fill="black" stroke="black" points="28740.61,-952.76 28750.05,-947.95 28739.67,-945.82 28740.61,-952.76"/>
</g>
<!-- dp1_attn_s0_l2_ar0&#45;&gt;dp1_attn_s0_l2_tp1 -->
<g id="edge124" class="edge">
<title>dp1_attn_s0_l2_ar0&#45;&gt;dp1_attn_s0_l2_tp1</title>
<path fill="none" stroke="black" d="M26578.24,-903.03C26578.24,-879.32 26578.24,-844.46 26578.24,-820.13"/>
<polygon fill="black" stroke="black" points="26581.74,-820.09 26578.24,-810.09 26574.74,-820.09 26581.74,-820.09"/>
</g>
<!-- dp1_attn_s0_l2_ar1&#45;&gt;dp1_attn_s0_l2_tp2 -->
<g id="edge126" class="edge">
<title>dp1_attn_s0_l2_ar1&#45;&gt;dp1_attn_s0_l2_tp2</title>
<path fill="none" stroke="black" d="M26578.24,-644.87C26578.24,-627.93 26578.24,-605.81 26578.24,-588.42"/>
<polygon fill="black" stroke="black" points="26581.74,-588.28 26578.24,-578.28 26574.74,-588.28 26581.74,-588.28"/>
</g>
<!-- dp1_gate_s0_l2_tp0 -->
<g id="node155" class="node">
<title>dp1_gate_s0_l2_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="27859,-1122.17 27426.69,-1122.17 27315.48,-1046.17 27747.79,-1046.17 27859,-1122.17"/>
<text text-anchor="middle" x="27587.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="27587.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27587.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l2_tp0&#45;&gt;dp1_moe_s0_l2_tp0 -->
<g id="edge129" class="edge">
<title>dp1_gate_s0_l2_tp0&#45;&gt;dp1_moe_s0_l2_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27616.6,-1045.99C27638.2,-1018.63 27667.04,-982.09 27686.33,-957.65"/>
<polygon fill="black" stroke="black" points="27689.28,-959.57 27692.73,-949.55 27683.79,-955.23 27689.28,-959.57"/>
</g>
<!-- dp1_gate_s0_l2_tp1 -->
<g id="node157" class="node">
<title>dp1_gate_s0_l2_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="27280,-1122.17 26847.69,-1122.17 26736.48,-1046.17 27168.79,-1046.17 27280,-1122.17"/>
<text text-anchor="middle" x="27008.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="27008.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="27008.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l2_tp1&#45;&gt;dp1_moe_s0_l2_tp1 -->
<g id="edge131" class="edge">
<title>dp1_gate_s0_l2_tp1&#45;&gt;dp1_moe_s0_l2_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M27028.06,-1045.99C27042.44,-1018.98 27061.6,-983.05 27074.61,-958.62"/>
<polygon fill="black" stroke="black" points="27077.83,-960.02 27079.45,-949.55 27071.66,-956.73 27077.83,-960.02"/>
</g>
<!-- dp1_gate_s0_l2_tp2 -->
<g id="node159" class="node">
<title>dp1_gate_s0_l2_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="28719,-1122.17 28286.69,-1122.17 28175.48,-1046.17 28607.79,-1046.17 28719,-1122.17"/>
<text text-anchor="middle" x="28447.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="28447.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="28447.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l2_tp2&#45;&gt;dp1_moe_s0_l2_tp2 -->
<g id="edge133" class="edge">
<title>dp1_gate_s0_l2_tp2&#45;&gt;dp1_moe_s0_l2_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28407.86,-1045.99C28378.5,-1018.27 28339.16,-981.13 28313.28,-956.7"/>
<polygon fill="black" stroke="black" points="28315.38,-953.87 28305.71,-949.55 28310.58,-958.96 28315.38,-953.87"/>
</g>
<!-- dp1_gate_s0_l2_tp3 -->
<g id="node161" class="node">
<title>dp1_gate_s0_l2_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="29298,-1122.17 28865.69,-1122.17 28754.48,-1046.17 29186.79,-1046.17 29298,-1122.17"/>
<text text-anchor="middle" x="29026.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L2</text>
<text text-anchor="middle" x="29026.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="29026.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3 -->
<g id="edge135" class="edge">
<title>dp1_gate_s0_l2_tp3&#45;&gt;dp1_moe_s0_l2_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28990.77,-1045.99C28964.44,-1018.39 28929.21,-981.45 28905.9,-957.02"/>
<polygon fill="black" stroke="black" points="28908.21,-954.37 28898.77,-949.55 28903.14,-959.2 28908.21,-954.37"/>
</g>
<!-- dp1_attn_s0_l3_tp0 -->
<g id="node162" class="node">
<title>dp1_attn_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="29578.74,-1103.17 29333.74,-1103.17 29333.74,-1065.17 29578.74,-1065.17 29578.74,-1103.17"/>
<text text-anchor="middle" x="29456.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="29456.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_ar0 -->
<g id="node166" class="node">
<title>dp1_attn_s0_l3_ar0</title>
<ellipse fill="none" stroke="black" cx="29456.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="29456.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29456.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_tp0&#45;&gt;dp1_attn_s0_l3_ar0 -->
<g id="edge136" class="edge">
<title>dp1_attn_s0_l3_tp0&#45;&gt;dp1_attn_s0_l3_ar0</title>
<path fill="none" stroke="black" d="M29456.24,-1065.14C29456.24,-1041.15 29456.24,-998.19 29456.24,-967.38"/>
<polygon fill="black" stroke="black" points="29459.74,-967.04 29456.24,-957.04 29452.74,-967.04 29459.74,-967.04"/>
</g>
<!-- dp1_attn_s0_l3_tp1 -->
<g id="node163" class="node">
<title>dp1_attn_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="29578.74,-809.93 29333.74,-809.93 29333.74,-771.93 29578.74,-771.93 29578.74,-809.93"/>
<text text-anchor="middle" x="29456.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="29456.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_ar1 -->
<g id="node167" class="node">
<title>dp1_attn_s0_l3_ar1</title>
<ellipse fill="none" stroke="black" cx="29456.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="29456.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29456.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_tp1&#45;&gt;dp1_attn_s0_l3_ar1 -->
<g id="edge138" class="edge">
<title>dp1_attn_s0_l3_tp1&#45;&gt;dp1_attn_s0_l3_ar1</title>
<path fill="none" stroke="black" d="M29456.24,-771.89C29456.24,-755.21 29456.24,-729.92 29456.24,-709.06"/>
<polygon fill="black" stroke="black" points="29459.74,-708.94 29456.24,-698.94 29452.74,-708.94 29459.74,-708.94"/>
</g>
<!-- dp1_attn_s0_l3_tp2 -->
<g id="node164" class="node">
<title>dp1_attn_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="29578.74,-578.09 29333.74,-578.09 29333.74,-540.09 29578.74,-540.09 29578.74,-578.09"/>
<text text-anchor="middle" x="29456.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="29456.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_ar2 -->
<g id="node168" class="node">
<title>dp1_attn_s0_l3_ar2</title>
<ellipse fill="none" stroke="black" cx="29456.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="29456.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L3</text>
<text text-anchor="middle" x="29456.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="29456.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_tp2&#45;&gt;dp1_attn_s0_l3_ar2 -->
<g id="edge140" class="edge">
<title>dp1_attn_s0_l3_tp2&#45;&gt;dp1_attn_s0_l3_ar2</title>
<path fill="none" stroke="black" d="M29456.24,-539.8C29456.24,-524.56 29456.24,-502.39 29456.24,-483.58"/>
<polygon fill="black" stroke="black" points="29459.74,-483.54 29456.24,-473.54 29452.74,-483.54 29459.74,-483.54"/>
</g>
<!-- dp1_attn_s0_l3_tp3 -->
<g id="node165" class="node">
<title>dp1_attn_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="31017.74,-1103.17 30772.74,-1103.17 30772.74,-1065.17 31017.74,-1065.17 31017.74,-1103.17"/>
<text text-anchor="middle" x="30895.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L3</text>
<text text-anchor="middle" x="30895.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="30895.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l3_tp0 -->
<g id="node169" class="node">
<title>dp1_moe_s0_l3_tp0</title>
<polygon fill="none" stroke="black" points="30671.24,-949.17 30409.24,-949.17 30409.24,-911.17 30671.24,-911.17 30671.24,-949.17"/>
<text text-anchor="middle" x="30540.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="30540.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="30540.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp0 -->
<g id="edge141" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" d="M30853.12,-1065.14C30787.87,-1037.2 30662.52,-983.52 30591.89,-953.28"/>
<polygon fill="black" stroke="black" points="30592.87,-949.9 30582.3,-949.18 30590.12,-956.33 30592.87,-949.9"/>
</g>
<!-- dp1_moe_s0_l3_tp1 -->
<g id="node171" class="node">
<title>dp1_moe_s0_l3_tp1</title>
<polygon fill="none" stroke="black" points="30180.24,-949.17 29918.24,-949.17 29918.24,-911.17 30180.24,-911.17 30180.24,-949.17"/>
<text text-anchor="middle" x="30049.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="30049.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="30049.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp1 -->
<g id="edge143" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M30832.13,-1065.1C30808.18,-1058.61 30780.57,-1051.56 30755.24,-1046.17 30560.87,-1004.75 30333.61,-970.18 30190.55,-950.07"/>
<polygon fill="black" stroke="black" points="30190.78,-946.57 30180.39,-948.65 30189.81,-953.51 30190.78,-946.57"/>
</g>
<!-- dp1_moe_s0_l3_tp2 -->
<g id="node173" class="node">
<title>dp1_moe_s0_l3_tp2</title>
<polygon fill="none" stroke="black" points="31338.24,-949.17 31076.24,-949.17 31076.24,-911.17 31338.24,-911.17 31338.24,-949.17"/>
<text text-anchor="middle" x="31207.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="31207.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31207.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp2 -->
<g id="edge145" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M30932.26,-1065.14C30989.37,-1037.31 31098.88,-983.96 31161.08,-953.66"/>
<polygon fill="black" stroke="black" points="31162.82,-956.7 31170.27,-949.18 31159.75,-950.41 31162.82,-956.7"/>
</g>
<!-- dp1_moe_s0_l3_tp3 -->
<g id="node175" class="node">
<title>dp1_moe_s0_l3_tp3</title>
<polygon fill="none" stroke="black" points="31755.24,-949.17 31493.24,-949.17 31493.24,-911.17 31755.24,-911.17 31755.24,-949.17"/>
<text text-anchor="middle" x="31624.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L3</text>
<text text-anchor="middle" x="31624.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31624.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3 -->
<g id="edge147" class="edge">
<title>dp1_attn_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" d="M30959.84,-1065.15C30983.48,-1058.81 31010.49,-1051.85 31035.24,-1046.17 31199.94,-1008.37 31392.37,-972.31 31511.28,-950.95"/>
<polygon fill="black" stroke="black" points="31511.91,-954.39 31521.13,-949.18 31510.67,-947.5 31511.91,-954.39"/>
</g>
<!-- dp1_attn_s0_l3_ar0&#45;&gt;dp1_attn_s0_l3_tp1 -->
<g id="edge137" class="edge">
<title>dp1_attn_s0_l3_ar0&#45;&gt;dp1_attn_s0_l3_tp1</title>
<path fill="none" stroke="black" d="M29456.24,-903.03C29456.24,-879.32 29456.24,-844.46 29456.24,-820.13"/>
<polygon fill="black" stroke="black" points="29459.74,-820.09 29456.24,-810.09 29452.74,-820.09 29459.74,-820.09"/>
</g>
<!-- dp1_attn_s0_l3_ar1&#45;&gt;dp1_attn_s0_l3_tp2 -->
<g id="edge139" class="edge">
<title>dp1_attn_s0_l3_ar1&#45;&gt;dp1_attn_s0_l3_tp2</title>
<path fill="none" stroke="black" d="M29456.24,-644.87C29456.24,-627.93 29456.24,-605.81 29456.24,-588.42"/>
<polygon fill="black" stroke="black" points="29459.74,-588.28 29456.24,-578.28 29452.74,-588.28 29459.74,-588.28"/>
</g>
<!-- dp1_gate_s0_l3_tp0 -->
<g id="node170" class="node">
<title>dp1_gate_s0_l3_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30737,-1122.17 30304.69,-1122.17 30193.48,-1046.17 30625.79,-1046.17 30737,-1122.17"/>
<text text-anchor="middle" x="30465.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="30465.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="30465.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l3_tp0&#45;&gt;dp1_moe_s0_l3_tp0 -->
<g id="edge142" class="edge">
<title>dp1_gate_s0_l3_tp0&#45;&gt;dp1_moe_s0_l3_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30483.59,-1045.99C30496.91,-1018.98 30514.64,-983.05 30526.7,-958.62"/>
<polygon fill="black" stroke="black" points="30529.89,-960.06 30531.17,-949.55 30523.61,-956.97 30529.89,-960.06"/>
</g>
<!-- dp1_gate_s0_l3_tp1 -->
<g id="node172" class="node">
<title>dp1_gate_s0_l3_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30158,-1122.17 29725.69,-1122.17 29614.48,-1046.17 30046.79,-1046.17 30158,-1122.17"/>
<text text-anchor="middle" x="29886.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="29886.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="29886.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l3_tp1&#45;&gt;dp1_moe_s0_l3_tp1 -->
<g id="edge144" class="edge">
<title>dp1_gate_s0_l3_tp1&#45;&gt;dp1_moe_s0_l3_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M29926.12,-1045.99C29955.97,-1018.15 29996,-980.81 30022.2,-956.38"/>
<polygon fill="black" stroke="black" points="30024.6,-958.93 30029.53,-949.55 30019.83,-953.81 30024.6,-958.93"/>
</g>
<!-- dp1_gate_s0_l3_tp2 -->
<g id="node174" class="node">
<title>dp1_gate_s0_l3_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="31597,-1122.17 31164.69,-1122.17 31053.48,-1046.17 31485.79,-1046.17 31597,-1122.17"/>
<text text-anchor="middle" x="31325.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="31325.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31325.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l3_tp2&#45;&gt;dp1_moe_s0_l3_tp2 -->
<g id="edge146" class="edge">
<title>dp1_gate_s0_l3_tp2&#45;&gt;dp1_moe_s0_l3_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31296.38,-1045.99C31275.14,-1018.63 31246.77,-982.09 31227.8,-957.65"/>
<polygon fill="black" stroke="black" points="31230.41,-955.3 31221.51,-949.55 31224.88,-959.59 31230.41,-955.3"/>
</g>
<!-- dp1_gate_s0_l3_tp3 -->
<g id="node176" class="node">
<title>dp1_gate_s0_l3_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="32176,-1122.17 31743.69,-1122.17 31632.48,-1046.17 32064.79,-1046.17 32176,-1122.17"/>
<text text-anchor="middle" x="31904.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L3</text>
<text text-anchor="middle" x="31904.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="31904.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3 -->
<g id="edge148" class="edge">
<title>dp1_gate_s0_l3_tp3&#45;&gt;dp1_moe_s0_l3_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M31835.75,-1045.99C31782.88,-1017.29 31711.43,-978.5 31666.59,-954.16"/>
<polygon fill="black" stroke="black" points="31668.18,-951.04 31657.72,-949.34 31664.84,-957.19 31668.18,-951.04"/>
</g>
<!-- dp1_attn_s0_l4_tp0 -->
<g id="node177" class="node">
<title>dp1_attn_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="32456.74,-1103.17 32211.74,-1103.17 32211.74,-1065.17 32456.74,-1065.17 32456.74,-1103.17"/>
<text text-anchor="middle" x="32334.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="32334.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_ar0 -->
<g id="node181" class="node">
<title>dp1_attn_s0_l4_ar0</title>
<ellipse fill="none" stroke="black" cx="32334.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="32334.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32334.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_tp0&#45;&gt;dp1_attn_s0_l4_ar0 -->
<g id="edge149" class="edge">
<title>dp1_attn_s0_l4_tp0&#45;&gt;dp1_attn_s0_l4_ar0</title>
<path fill="none" stroke="black" d="M32334.24,-1065.14C32334.24,-1041.15 32334.24,-998.19 32334.24,-967.38"/>
<polygon fill="black" stroke="black" points="32337.74,-967.04 32334.24,-957.04 32330.74,-967.04 32337.74,-967.04"/>
</g>
<!-- dp1_attn_s0_l4_tp1 -->
<g id="node178" class="node">
<title>dp1_attn_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="32456.74,-809.93 32211.74,-809.93 32211.74,-771.93 32456.74,-771.93 32456.74,-809.93"/>
<text text-anchor="middle" x="32334.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="32334.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_ar1 -->
<g id="node182" class="node">
<title>dp1_attn_s0_l4_ar1</title>
<ellipse fill="none" stroke="black" cx="32334.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="32334.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32334.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_tp1&#45;&gt;dp1_attn_s0_l4_ar1 -->
<g id="edge151" class="edge">
<title>dp1_attn_s0_l4_tp1&#45;&gt;dp1_attn_s0_l4_ar1</title>
<path fill="none" stroke="black" d="M32334.24,-771.89C32334.24,-755.21 32334.24,-729.92 32334.24,-709.06"/>
<polygon fill="black" stroke="black" points="32337.74,-708.94 32334.24,-698.94 32330.74,-708.94 32337.74,-708.94"/>
</g>
<!-- dp1_attn_s0_l4_tp2 -->
<g id="node179" class="node">
<title>dp1_attn_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="32456.74,-578.09 32211.74,-578.09 32211.74,-540.09 32456.74,-540.09 32456.74,-578.09"/>
<text text-anchor="middle" x="32334.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="32334.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_ar2 -->
<g id="node183" class="node">
<title>dp1_attn_s0_l4_ar2</title>
<ellipse fill="none" stroke="black" cx="32334.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="32334.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L4</text>
<text text-anchor="middle" x="32334.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="32334.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_tp2&#45;&gt;dp1_attn_s0_l4_ar2 -->
<g id="edge153" class="edge">
<title>dp1_attn_s0_l4_tp2&#45;&gt;dp1_attn_s0_l4_ar2</title>
<path fill="none" stroke="black" d="M32334.24,-539.8C32334.24,-524.56 32334.24,-502.39 32334.24,-483.58"/>
<polygon fill="black" stroke="black" points="32337.74,-483.54 32334.24,-473.54 32330.74,-483.54 32337.74,-483.54"/>
</g>
<!-- dp1_attn_s0_l4_tp3 -->
<g id="node180" class="node">
<title>dp1_attn_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="33895.74,-1103.17 33650.74,-1103.17 33650.74,-1065.17 33895.74,-1065.17 33895.74,-1103.17"/>
<text text-anchor="middle" x="33773.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L4</text>
<text text-anchor="middle" x="33773.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="33773.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l4_tp0 -->
<g id="node184" class="node">
<title>dp1_moe_s0_l4_tp0</title>
<polygon fill="none" stroke="black" points="33549.24,-949.17 33287.24,-949.17 33287.24,-911.17 33549.24,-911.17 33549.24,-949.17"/>
<text text-anchor="middle" x="33418.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="33418.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="33418.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp0 -->
<g id="edge154" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" d="M33731.12,-1065.14C33665.87,-1037.2 33540.52,-983.52 33469.89,-953.28"/>
<polygon fill="black" stroke="black" points="33470.87,-949.9 33460.3,-949.18 33468.12,-956.33 33470.87,-949.9"/>
</g>
<!-- dp1_moe_s0_l4_tp1 -->
<g id="node186" class="node">
<title>dp1_moe_s0_l4_tp1</title>
<polygon fill="none" stroke="black" points="33058.24,-949.17 32796.24,-949.17 32796.24,-911.17 33058.24,-911.17 33058.24,-949.17"/>
<text text-anchor="middle" x="32927.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="32927.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="32927.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp1 -->
<g id="edge156" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M33710.13,-1065.1C33686.18,-1058.61 33658.57,-1051.56 33633.24,-1046.17 33438.87,-1004.75 33211.61,-970.18 33068.55,-950.07"/>
<polygon fill="black" stroke="black" points="33068.78,-946.57 33058.39,-948.65 33067.81,-953.51 33068.78,-946.57"/>
</g>
<!-- dp1_moe_s0_l4_tp2 -->
<g id="node188" class="node">
<title>dp1_moe_s0_l4_tp2</title>
<polygon fill="none" stroke="black" points="34216.24,-949.17 33954.24,-949.17 33954.24,-911.17 34216.24,-911.17 34216.24,-949.17"/>
<text text-anchor="middle" x="34085.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="34085.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34085.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp2 -->
<g id="edge158" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M33810.26,-1065.14C33867.37,-1037.31 33976.88,-983.96 34039.08,-953.66"/>
<polygon fill="black" stroke="black" points="34040.82,-956.7 34048.27,-949.18 34037.75,-950.41 34040.82,-956.7"/>
</g>
<!-- dp1_moe_s0_l4_tp3 -->
<g id="node190" class="node">
<title>dp1_moe_s0_l4_tp3</title>
<polygon fill="none" stroke="black" points="34768.24,-949.17 34506.24,-949.17 34506.24,-911.17 34768.24,-911.17 34768.24,-949.17"/>
<text text-anchor="middle" x="34637.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L4</text>
<text text-anchor="middle" x="34637.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34637.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3 -->
<g id="edge160" class="edge">
<title>dp1_attn_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" d="M33835.99,-1065.14C33860.02,-1058.62 33887.78,-1051.54 33913.24,-1046.17 34114.25,-1003.76 34349.61,-969.11 34496.1,-949.29"/>
<polygon fill="black" stroke="black" points="34496.61,-952.76 34506.05,-947.95 34495.67,-945.82 34496.61,-952.76"/>
</g>
<!-- dp1_attn_s0_l4_ar0&#45;&gt;dp1_attn_s0_l4_tp1 -->
<g id="edge150" class="edge">
<title>dp1_attn_s0_l4_ar0&#45;&gt;dp1_attn_s0_l4_tp1</title>
<path fill="none" stroke="black" d="M32334.24,-903.03C32334.24,-879.32 32334.24,-844.46 32334.24,-820.13"/>
<polygon fill="black" stroke="black" points="32337.74,-820.09 32334.24,-810.09 32330.74,-820.09 32337.74,-820.09"/>
</g>
<!-- dp1_attn_s0_l4_ar1&#45;&gt;dp1_attn_s0_l4_tp2 -->
<g id="edge152" class="edge">
<title>dp1_attn_s0_l4_ar1&#45;&gt;dp1_attn_s0_l4_tp2</title>
<path fill="none" stroke="black" d="M32334.24,-644.87C32334.24,-627.93 32334.24,-605.81 32334.24,-588.42"/>
<polygon fill="black" stroke="black" points="32337.74,-588.28 32334.24,-578.28 32330.74,-588.28 32337.74,-588.28"/>
</g>
<!-- dp1_gate_s0_l4_tp0 -->
<g id="node185" class="node">
<title>dp1_gate_s0_l4_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="33615,-1122.17 33182.69,-1122.17 33071.48,-1046.17 33503.79,-1046.17 33615,-1122.17"/>
<text text-anchor="middle" x="33343.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="33343.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="33343.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l4_tp0&#45;&gt;dp1_moe_s0_l4_tp0 -->
<g id="edge155" class="edge">
<title>dp1_gate_s0_l4_tp0&#45;&gt;dp1_moe_s0_l4_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M33361.59,-1045.99C33374.91,-1018.98 33392.64,-983.05 33404.7,-958.62"/>
<polygon fill="black" stroke="black" points="33407.89,-960.06 33409.17,-949.55 33401.61,-956.97 33407.89,-960.06"/>
</g>
<!-- dp1_gate_s0_l4_tp1 -->
<g id="node187" class="node">
<title>dp1_gate_s0_l4_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="33036,-1122.17 32603.69,-1122.17 32492.48,-1046.17 32924.79,-1046.17 33036,-1122.17"/>
<text text-anchor="middle" x="32764.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="32764.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="32764.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l4_tp1&#45;&gt;dp1_moe_s0_l4_tp1 -->
<g id="edge157" class="edge">
<title>dp1_gate_s0_l4_tp1&#45;&gt;dp1_moe_s0_l4_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M32804.12,-1045.99C32833.97,-1018.15 32874,-980.81 32900.2,-956.38"/>
<polygon fill="black" stroke="black" points="32902.6,-958.93 32907.53,-949.55 32897.83,-953.81 32902.6,-958.93"/>
</g>
<!-- dp1_gate_s0_l4_tp2 -->
<g id="node189" class="node">
<title>dp1_gate_s0_l4_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="34475,-1122.17 34042.69,-1122.17 33931.48,-1046.17 34363.79,-1046.17 34475,-1122.17"/>
<text text-anchor="middle" x="34203.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="34203.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34203.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l4_tp2&#45;&gt;dp1_moe_s0_l4_tp2 -->
<g id="edge159" class="edge">
<title>dp1_gate_s0_l4_tp2&#45;&gt;dp1_moe_s0_l4_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34174.38,-1045.99C34153.14,-1018.63 34124.77,-982.09 34105.8,-957.65"/>
<polygon fill="black" stroke="black" points="34108.41,-955.3 34099.51,-949.55 34102.88,-959.59 34108.41,-955.3"/>
</g>
<!-- dp1_gate_s0_l4_tp3 -->
<g id="node191" class="node">
<title>dp1_gate_s0_l4_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="35054,-1122.17 34621.69,-1122.17 34510.48,-1046.17 34942.79,-1046.17 35054,-1122.17"/>
<text text-anchor="middle" x="34782.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L4</text>
<text text-anchor="middle" x="34782.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="34782.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3 -->
<g id="edge161" class="edge">
<title>dp1_gate_s0_l4_tp3&#45;&gt;dp1_moe_s0_l4_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34746.77,-1045.99C34720.44,-1018.39 34685.21,-981.45 34661.9,-957.02"/>
<polygon fill="black" stroke="black" points="34664.21,-954.37 34654.77,-949.55 34659.14,-959.2 34664.21,-954.37"/>
</g>
<!-- dp1_attn_s0_l5_tp0 -->
<g id="node192" class="node">
<title>dp1_attn_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="35334.74,-1103.17 35089.74,-1103.17 35089.74,-1065.17 35334.74,-1065.17 35334.74,-1103.17"/>
<text text-anchor="middle" x="35212.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="35212.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_ar0 -->
<g id="node196" class="node">
<title>dp1_attn_s0_l5_ar0</title>
<ellipse fill="none" stroke="black" cx="35212.24" cy="-930.17" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="35212.24" y="-937.97" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35212.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_tp0&#45;&gt;dp1_attn_s0_l5_ar0 -->
<g id="edge162" class="edge">
<title>dp1_attn_s0_l5_tp0&#45;&gt;dp1_attn_s0_l5_ar0</title>
<path fill="none" stroke="black" d="M35212.24,-1065.14C35212.24,-1041.15 35212.24,-998.19 35212.24,-967.38"/>
<polygon fill="black" stroke="black" points="35215.74,-967.04 35212.24,-957.04 35208.74,-967.04 35215.74,-967.04"/>
</g>
<!-- dp1_attn_s0_l5_tp1 -->
<g id="node193" class="node">
<title>dp1_attn_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="35334.74,-809.93 35089.74,-809.93 35089.74,-771.93 35334.74,-771.93 35334.74,-809.93"/>
<text text-anchor="middle" x="35212.24" y="-798.73" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="35212.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_ar1 -->
<g id="node197" class="node">
<title>dp1_attn_s0_l5_ar1</title>
<ellipse fill="none" stroke="black" cx="35212.24" cy="-671.83" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="35212.24" y="-679.63" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35212.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_tp1&#45;&gt;dp1_attn_s0_l5_ar1 -->
<g id="edge164" class="edge">
<title>dp1_attn_s0_l5_tp1&#45;&gt;dp1_attn_s0_l5_ar1</title>
<path fill="none" stroke="black" d="M35212.24,-771.89C35212.24,-755.21 35212.24,-729.92 35212.24,-709.06"/>
<polygon fill="black" stroke="black" points="35215.74,-708.94 35212.24,-698.94 35208.74,-708.94 35215.74,-708.94"/>
</g>
<!-- dp1_attn_s0_l5_tp2 -->
<g id="node194" class="node">
<title>dp1_attn_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="35334.74,-578.09 35089.74,-578.09 35089.74,-540.09 35334.74,-540.09 35334.74,-578.09"/>
<text text-anchor="middle" x="35212.24" y="-566.89" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="35212.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_ar2 -->
<g id="node198" class="node">
<title>dp1_attn_s0_l5_ar2</title>
<ellipse fill="none" stroke="black" cx="35212.24" cy="-446.35" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="35212.24" y="-454.15" font-family="Times,serif" font-size="9.00">Attention All&#45;Reduce L5</text>
<text text-anchor="middle" x="35212.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="35212.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_tp2&#45;&gt;dp1_attn_s0_l5_ar2 -->
<g id="edge166" class="edge">
<title>dp1_attn_s0_l5_tp2&#45;&gt;dp1_attn_s0_l5_ar2</title>
<path fill="none" stroke="black" d="M35212.24,-539.8C35212.24,-524.56 35212.24,-502.39 35212.24,-483.58"/>
<polygon fill="black" stroke="black" points="35215.74,-483.54 35212.24,-473.54 35208.74,-483.54 35215.74,-483.54"/>
</g>
<!-- dp1_attn_s0_l5_tp3 -->
<g id="node195" class="node">
<title>dp1_attn_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="36773.74,-1103.17 36528.74,-1103.17 36528.74,-1065.17 36773.74,-1065.17 36773.74,-1103.17"/>
<text text-anchor="middle" x="36651.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Attention L5</text>
<text text-anchor="middle" x="36651.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, heads=16, d_k=64]</text>
<text text-anchor="middle" x="36651.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_moe_s0_l5_tp0 -->
<g id="node199" class="node">
<title>dp1_moe_s0_l5_tp0</title>
<polygon fill="none" stroke="black" points="36642.24,-949.17 36380.24,-949.17 36380.24,-911.17 36642.24,-911.17 36642.24,-949.17"/>
<text text-anchor="middle" x="36511.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="36511.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36511.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp0 -->
<g id="edge167" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" d="M36634.63,-1065.14C36609.9,-1038.28 36563.27,-987.66 36534.95,-956.91"/>
<polygon fill="black" stroke="black" points="36537.18,-954.16 36527.83,-949.18 36532.03,-958.91 36537.18,-954.16"/>
</g>
<!-- dp1_moe_s0_l5_tp1 -->
<g id="node201" class="node">
<title>dp1_moe_s0_l5_tp1</title>
<polygon fill="none" stroke="black" points="36138.24,-949.17 35876.24,-949.17 35876.24,-911.17 36138.24,-911.17 36138.24,-949.17"/>
<text text-anchor="middle" x="36007.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="36007.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36007.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp1 -->
<g id="edge169" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M36584.77,-1065.11C36561.55,-1058.93 36535.29,-1052.09 36511.24,-1046.17 36368.29,-1010.98 36201.6,-973.67 36100.29,-951.4"/>
<polygon fill="black" stroke="black" points="36100.9,-947.96 36090.39,-949.23 36099.4,-954.79 36100.9,-947.96"/>
</g>
<!-- dp1_moe_s0_l5_tp2 -->
<g id="node203" class="node">
<title>dp1_moe_s0_l5_tp2</title>
<polygon fill="none" stroke="black" points="36984.24,-949.17 36722.24,-949.17 36722.24,-911.17 36984.24,-911.17 36984.24,-949.17"/>
<text text-anchor="middle" x="36853.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="36853.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36853.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp2 -->
<g id="edge171" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M36675.21,-1065.14C36711.5,-1037.82 36780.47,-985.92 36821.09,-955.36"/>
<polygon fill="black" stroke="black" points="36823.42,-957.99 36829.31,-949.18 36819.21,-952.39 36823.42,-957.99"/>
</g>
<!-- dp1_moe_s0_l5_tp3 -->
<g id="node205" class="node">
<title>dp1_moe_s0_l5_tp3</title>
<polygon fill="none" stroke="black" points="37646.24,-949.17 37384.24,-949.17 37384.24,-911.17 37646.24,-911.17 37646.24,-949.17"/>
<text text-anchor="middle" x="37515.24" y="-937.97" font-family="Times,serif" font-size="9.00">Token MoE L5</text>
<text text-anchor="middle" x="37515.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37515.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3 -->
<g id="edge173" class="edge">
<title>dp1_attn_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" d="M36713.99,-1065.14C36738.02,-1058.62 36765.78,-1051.54 36791.24,-1046.17 36992.25,-1003.76 37227.61,-969.11 37374.1,-949.29"/>
<polygon fill="black" stroke="black" points="37374.61,-952.76 37384.05,-947.95 37373.67,-945.82 37374.61,-952.76"/>
</g>
<!-- dp1_attn_s0_l5_ar0&#45;&gt;dp1_attn_s0_l5_tp1 -->
<g id="edge163" class="edge">
<title>dp1_attn_s0_l5_ar0&#45;&gt;dp1_attn_s0_l5_tp1</title>
<path fill="none" stroke="black" d="M35212.24,-903.03C35212.24,-879.32 35212.24,-844.46 35212.24,-820.13"/>
<polygon fill="black" stroke="black" points="35215.74,-820.09 35212.24,-810.09 35208.74,-820.09 35215.74,-820.09"/>
</g>
<!-- dp1_attn_s0_l5_ar1&#45;&gt;dp1_attn_s0_l5_tp2 -->
<g id="edge165" class="edge">
<title>dp1_attn_s0_l5_ar1&#45;&gt;dp1_attn_s0_l5_tp2</title>
<path fill="none" stroke="black" d="M35212.24,-644.87C35212.24,-627.93 35212.24,-605.81 35212.24,-588.42"/>
<polygon fill="black" stroke="black" points="35215.74,-588.28 35212.24,-578.28 35208.74,-588.28 35215.74,-588.28"/>
</g>
<!-- dp1_gate_s0_l5_tp0 -->
<g id="node200" class="node">
<title>dp1_gate_s0_l5_tp0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="36493,-1122.17 36060.69,-1122.17 35949.48,-1046.17 36381.79,-1046.17 36493,-1122.17"/>
<text text-anchor="middle" x="36221.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="36221.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="36221.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU16</text>
</g>
<!-- dp1_gate_s0_l5_tp0&#45;&gt;dp1_moe_s0_l5_tp0 -->
<g id="edge168" class="edge">
<title>dp1_gate_s0_l5_tp0&#45;&gt;dp1_moe_s0_l5_tp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M36292.18,-1045.99C36347.05,-1017.23 36421.25,-978.34 36467.67,-954.01"/>
<polygon fill="black" stroke="black" points="36469.33,-957.09 36476.57,-949.34 36466.08,-950.89 36469.33,-957.09"/>
</g>
<!-- dp1_gate_s0_l5_tp1 -->
<g id="node202" class="node">
<title>dp1_gate_s0_l5_tp1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="35914,-1122.17 35481.69,-1122.17 35370.48,-1046.17 35802.79,-1046.17 35914,-1122.17"/>
<text text-anchor="middle" x="35642.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="35642.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="35642.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU17</text>
</g>
<!-- dp1_gate_s0_l5_tp1&#45;&gt;dp1_moe_s0_l5_tp1 -->
<g id="edge170" class="edge">
<title>dp1_gate_s0_l5_tp1&#45;&gt;dp1_moe_s0_l5_tp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M35731.53,-1045.99C35801.3,-1016.93 35895.92,-977.53 35954.21,-953.25"/>
<polygon fill="black" stroke="black" points="35955.71,-956.42 35963.6,-949.34 35953.02,-949.96 35955.71,-956.42"/>
</g>
<!-- dp1_gate_s0_l5_tp2 -->
<g id="node204" class="node">
<title>dp1_gate_s0_l5_tp2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="37353,-1122.17 36920.69,-1122.17 36809.48,-1046.17 37241.79,-1046.17 37353,-1122.17"/>
<text text-anchor="middle" x="37081.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="37081.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37081.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU18</text>
</g>
<!-- dp1_gate_s0_l5_tp2&#45;&gt;dp1_moe_s0_l5_tp2 -->
<g id="edge172" class="edge">
<title>dp1_gate_s0_l5_tp2&#45;&gt;dp1_moe_s0_l5_tp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37025.47,-1045.99C36982.87,-1017.59 36925.45,-979.31 36888.88,-954.93"/>
<polygon fill="black" stroke="black" points="36890.77,-951.98 36880.5,-949.34 36886.88,-957.8 36890.77,-951.98"/>
</g>
<!-- dp1_pp_s0_to_s1 -->
<g id="node207" class="node">
<title>dp1_pp_s0_to_s1</title>
<ellipse fill="none" stroke="black" cx="37515.24" cy="-790.93" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="37515.24" y="-798.73" font-family="Times,serif" font-size="9.00">Pipeline Stage 01</text>
<text text-anchor="middle" x="37515.24" y="-788.73" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="37515.24" y="-778.73" font-family="Times,serif" font-size="9.00">GPU: GPU23GPU24</text>
</g>
<!-- dp1_moe_s0_l5_tp3&#45;&gt;dp1_pp_s0_to_s1 -->
<g id="edge175" class="edge">
<title>dp1_moe_s0_l5_tp3&#45;&gt;dp1_pp_s0_to_s1</title>
<path fill="none" stroke="black" d="M37515.24,-910.94C37515.24,-889.9 37515.24,-854.75 37515.24,-828.09"/>
<polygon fill="black" stroke="black" points="37518.74,-827.98 37515.24,-817.98 37511.74,-827.98 37518.74,-827.98"/>
</g>
<!-- dp1_gate_s0_l5_tp3 -->
<g id="node206" class="node">
<title>dp1_gate_s0_l5_tp3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="37932,-1122.17 37499.69,-1122.17 37388.48,-1046.17 37820.79,-1046.17 37932,-1122.17"/>
<text text-anchor="middle" x="37660.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Token Gate L5</text>
<text text-anchor="middle" x="37660.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, experts=128, top_k=8]</text>
<text text-anchor="middle" x="37660.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU19</text>
</g>
<!-- dp1_gate_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3 -->
<g id="edge174" class="edge">
<title>dp1_gate_s0_l5_tp3&#45;&gt;dp1_moe_s0_l5_tp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37624.77,-1045.99C37598.44,-1018.39 37563.21,-981.45 37539.9,-957.02"/>
<polygon fill="black" stroke="black" points="37542.21,-954.37 37532.77,-949.55 37537.14,-959.2 37542.21,-954.37"/>
</g>
<!-- dp1_pp_s1_to_s2 -->
<g id="node208" class="node">
<title>dp1_pp_s1_to_s2</title>
<ellipse fill="none" stroke="black" cx="37515.24" cy="-671.83" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="37515.24" y="-679.63" font-family="Times,serif" font-size="9.00">Pipeline Stage 12</text>
<text text-anchor="middle" x="37515.24" y="-669.63" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="37515.24" y="-659.63" font-family="Times,serif" font-size="9.00">GPU: GPU31GPU32</text>
</g>
<!-- dp1_pp_s0_to_s1&#45;&gt;dp1_pp_s1_to_s2 -->
<g id="edge176" class="edge">
<title>dp1_pp_s0_to_s1&#45;&gt;dp1_pp_s1_to_s2</title>
<path fill="none" stroke="black" d="M37515.24,-763.95C37515.24,-747.72 37515.24,-726.61 37515.24,-708.79"/>
<polygon fill="black" stroke="black" points="37518.74,-708.75 37515.24,-698.75 37511.74,-708.75 37518.74,-708.75"/>
</g>
<!-- dp1_pp_s2_to_s3 -->
<g id="node209" class="node">
<title>dp1_pp_s2_to_s3</title>
<ellipse fill="none" stroke="black" cx="37515.24" cy="-559.09" rx="160.53" ry="26.74"/>
<text text-anchor="middle" x="37515.24" y="-566.89" font-family="Times,serif" font-size="9.00">Pipeline Stage 23</text>
<text text-anchor="middle" x="37515.24" y="-556.89" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="37515.24" y="-546.89" font-family="Times,serif" font-size="9.00">GPU: GPU39GPU40</text>
</g>
<!-- dp1_pp_s1_to_s2&#45;&gt;dp1_pp_s2_to_s3 -->
<g id="edge177" class="edge">
<title>dp1_pp_s1_to_s2&#45;&gt;dp1_pp_s2_to_s3</title>
<path fill="none" stroke="black" d="M37515.24,-644.87C37515.24,-630.39 37515.24,-612.14 37515.24,-596.29"/>
<polygon fill="black" stroke="black" points="37518.74,-596.28 37515.24,-586.28 37511.74,-596.28 37518.74,-596.28"/>
</g>
<!-- dp1_final_s3_tp0 -->
<g id="node210" class="node">
<title>dp1_final_s3_tp0</title>
<polygon fill="none" stroke="black" points="37628.74,-465.35 37401.74,-465.35 37401.74,-427.35 37628.74,-427.35 37628.74,-465.35"/>
<text text-anchor="middle" x="37515.24" y="-454.15" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="37515.24" y="-444.15" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="37515.24" y="-434.15" font-family="Times,serif" font-size="9.00">GPU: GPU40</text>
</g>
<!-- dp1_pp_s2_to_s3&#45;&gt;dp1_final_s3_tp0 -->
<g id="edge178" class="edge">
<title>dp1_pp_s2_to_s3&#45;&gt;dp1_final_s3_tp0</title>
<path fill="none" stroke="black" d="M37515.24,-532.13C37515.24,-515.19 37515.24,-493.07 37515.24,-475.68"/>
<polygon fill="black" stroke="black" points="37518.74,-475.54 37515.24,-465.54 37511.74,-475.54 37518.74,-475.54"/>
</g>
<!-- dp1_final_s3_tp1 -->
<g id="node211" class="node">
<title>dp1_final_s3_tp1</title>
<polygon fill="none" stroke="black" points="38194.74,-1103.17 37967.74,-1103.17 37967.74,-1065.17 38194.74,-1065.17 38194.74,-1103.17"/>
<text text-anchor="middle" x="38081.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="38081.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="38081.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU41</text>
</g>
<!-- dp1_final_s3_tp2 -->
<g id="node212" class="node">
<title>dp1_final_s3_tp2</title>
<polygon fill="none" stroke="black" points="38457.74,-1103.17 38230.74,-1103.17 38230.74,-1065.17 38457.74,-1065.17 38457.74,-1103.17"/>
<text text-anchor="middle" x="38344.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="38344.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="38344.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU42</text>
</g>
<!-- dp1_final_s3_tp3 -->
<g id="node213" class="node">
<title>dp1_final_s3_tp3</title>
<polygon fill="none" stroke="black" points="19921.74,-1103.17 19694.74,-1103.17 19694.74,-1065.17 19921.74,-1065.17 19921.74,-1103.17"/>
<text text-anchor="middle" x="19808.24" y="-1091.97" font-family="Times,serif" font-size="9.00">Final Token Processing</text>
<text text-anchor="middle" x="19808.24" y="-1081.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=1024]</text>
<text text-anchor="middle" x="19808.24" y="-1071.97" font-family="Times,serif" font-size="9.00">GPU: GPU43</text>
</g>
<!-- dp1_dp_gather -->
<g id="node214" class="node">
<title>dp1_dp_gather</title>
<polygon fill="none" stroke="black" points="20043.43,-968.17 19669.3,-968.17 19573.06,-892.17 19947.18,-892.17 20043.43,-968.17"/>
<text text-anchor="middle" x="19808.24" y="-937.97" font-family="Times,serif" font-size="9.00">DP Gather 1</text>
<text text-anchor="middle" x="19808.24" y="-927.97" font-family="Times,serif" font-size="9.00">[batch_size=256, seq_len=1, d_model=4096]</text>
<text text-anchor="middle" x="19808.24" y="-917.97" font-family="Times,serif" font-size="9.00">GPU: Host</text>
</g>
<!-- dp1_final_s3_tp3&#45;&gt;dp1_dp_gather -->
<g id="edge179" class="edge">
<title>dp1_final_s3_tp3&#45;&gt;dp1_dp_gather</title>
<path fill="none" stroke="black" d="M19808.24,-1065.14C19808.24,-1043.89 19808.24,-1007.77 19808.24,-978.38"/>
<polygon fill="black" stroke="black" points="19811.74,-978.31 19808.24,-968.31 19804.74,-978.31 19811.74,-978.31"/>
</g>
<!-- dp1_dp_gather&#45;&gt;output -->
<g id="edge181" class="edge">
<title>dp1_dp_gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M19739.78,-892.03C19702.95,-872.05 19657.74,-847.53 19621.28,-827.76"/>
<polygon fill="black" stroke="black" points="19622.67,-824.53 19612.22,-822.84 19619.34,-830.68 19622.67,-824.53"/>
</g>
</g>
</svg>
