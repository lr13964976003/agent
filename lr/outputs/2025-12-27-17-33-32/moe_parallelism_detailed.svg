<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1066pt" height="2880pt"
 viewBox="0.00 0.00 1066.26 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.66 0.66) rotate(0) translate(4 4382.49)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4382.49 1620,-4382.49 1620,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<path fill="lightgray" stroke="black" d="M20,-3327.41C20,-3327.41 1596,-3327.41 1596,-3327.41 1602,-3327.41 1608,-3333.41 1608,-3339.41 1608,-3339.41 1608,-4284.95 1608,-4284.95 1608,-4290.95 1602,-4296.95 1596,-4296.95 1596,-4296.95 20,-4296.95 20,-4296.95 14,-4296.95 8,-4290.95 8,-4284.95 8,-4284.95 8,-3339.41 8,-3339.41 8,-3333.41 14,-3327.41 20,-3327.41"/>
<text text-anchor="middle" x="808" y="-4281.75" font-family="Times,serif" font-size="14.00">Layer 1 (PP Stage 1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer2</title>
<path fill="lightgray" stroke="black" d="M981,-3111.32C981,-3111.32 1215,-3111.32 1215,-3111.32 1221,-3111.32 1227,-3117.32 1227,-3123.32 1227,-3123.32 1227,-3190.32 1227,-3190.32 1227,-3196.32 1221,-3202.32 1215,-3202.32 1215,-3202.32 981,-3202.32 981,-3202.32 975,-3202.32 969,-3196.32 969,-3190.32 969,-3190.32 969,-3123.32 969,-3123.32 969,-3117.32 975,-3111.32 981,-3111.32"/>
<text text-anchor="middle" x="1098" y="-3187.12" font-family="Times,serif" font-size="14.00">Layer 2 (PP Stage 2)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer3</title>
<path fill="lightgray" stroke="black" d="M981,-2895.22C981,-2895.22 1215,-2895.22 1215,-2895.22 1221,-2895.22 1227,-2901.22 1227,-2907.22 1227,-2907.22 1227,-2974.22 1227,-2974.22 1227,-2980.22 1221,-2986.22 1215,-2986.22 1215,-2986.22 981,-2986.22 981,-2986.22 975,-2986.22 969,-2980.22 969,-2974.22 969,-2974.22 969,-2907.22 969,-2907.22 969,-2901.22 975,-2895.22 981,-2895.22"/>
<text text-anchor="middle" x="1098" y="-2971.02" font-family="Times,serif" font-size="14.00">Layer 3 (PP Stage 3)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer4</title>
<path fill="lightgray" stroke="black" d="M981,-2679.13C981,-2679.13 1215,-2679.13 1215,-2679.13 1221,-2679.13 1227,-2685.13 1227,-2691.13 1227,-2691.13 1227,-2758.13 1227,-2758.13 1227,-2764.13 1221,-2770.13 1215,-2770.13 1215,-2770.13 981,-2770.13 981,-2770.13 975,-2770.13 969,-2764.13 969,-2758.13 969,-2758.13 969,-2691.13 969,-2691.13 969,-2685.13 975,-2679.13 981,-2679.13"/>
<text text-anchor="middle" x="1098" y="-2754.93" font-family="Times,serif" font-size="14.00">Layer 4 (PP Stage 4)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer5</title>
<path fill="lightgray" stroke="black" d="M981,-2463.03C981,-2463.03 1215,-2463.03 1215,-2463.03 1221,-2463.03 1227,-2469.03 1227,-2475.03 1227,-2475.03 1227,-2542.03 1227,-2542.03 1227,-2548.03 1221,-2554.03 1215,-2554.03 1215,-2554.03 981,-2554.03 981,-2554.03 975,-2554.03 969,-2548.03 969,-2542.03 969,-2542.03 969,-2475.03 969,-2475.03 969,-2469.03 975,-2463.03 981,-2463.03"/>
<text text-anchor="middle" x="1098" y="-2538.83" font-family="Times,serif" font-size="14.00">Layer 5 (PP Stage 5)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer6</title>
<path fill="lightgray" stroke="black" d="M981,-2246.94C981,-2246.94 1215,-2246.94 1215,-2246.94 1221,-2246.94 1227,-2252.94 1227,-2258.94 1227,-2258.94 1227,-2325.94 1227,-2325.94 1227,-2331.94 1221,-2337.94 1215,-2337.94 1215,-2337.94 981,-2337.94 981,-2337.94 975,-2337.94 969,-2331.94 969,-2325.94 969,-2325.94 969,-2258.94 969,-2258.94 969,-2252.94 975,-2246.94 981,-2246.94"/>
<text text-anchor="middle" x="1098" y="-2322.74" font-family="Times,serif" font-size="14.00">Layer 6 (PP Stage 6)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer7</title>
<path fill="lightgray" stroke="black" d="M981,-2030.84C981,-2030.84 1215,-2030.84 1215,-2030.84 1221,-2030.84 1227,-2036.84 1227,-2042.84 1227,-2042.84 1227,-2109.84 1227,-2109.84 1227,-2115.84 1221,-2121.84 1215,-2121.84 1215,-2121.84 981,-2121.84 981,-2121.84 975,-2121.84 969,-2115.84 969,-2109.84 969,-2109.84 969,-2042.84 969,-2042.84 969,-2036.84 975,-2030.84 981,-2030.84"/>
<text text-anchor="middle" x="1098" y="-2106.64" font-family="Times,serif" font-size="14.00">Layer 7 (PP Stage 7)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer8</title>
<path fill="lightgray" stroke="black" d="M981,-1814.75C981,-1814.75 1215,-1814.75 1215,-1814.75 1221,-1814.75 1227,-1820.75 1227,-1826.75 1227,-1826.75 1227,-1893.75 1227,-1893.75 1227,-1899.75 1221,-1905.75 1215,-1905.75 1215,-1905.75 981,-1905.75 981,-1905.75 975,-1905.75 969,-1899.75 969,-1893.75 969,-1893.75 969,-1826.75 969,-1826.75 969,-1820.75 975,-1814.75 981,-1814.75"/>
<text text-anchor="middle" x="1098" y="-1890.55" font-family="Times,serif" font-size="14.00">Layer 8 (PP Stage 8)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer9</title>
<path fill="lightgray" stroke="black" d="M981,-1598.65C981,-1598.65 1215,-1598.65 1215,-1598.65 1221,-1598.65 1227,-1604.65 1227,-1610.65 1227,-1610.65 1227,-1677.65 1227,-1677.65 1227,-1683.65 1221,-1689.65 1215,-1689.65 1215,-1689.65 981,-1689.65 981,-1689.65 975,-1689.65 969,-1683.65 969,-1677.65 969,-1677.65 969,-1610.65 969,-1610.65 969,-1604.65 975,-1598.65 981,-1598.65"/>
<text text-anchor="middle" x="1098" y="-1674.45" font-family="Times,serif" font-size="14.00">Layer 9 (PP Stage 9)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer10</title>
<path fill="lightgray" stroke="black" d="M981,-1382.56C981,-1382.56 1215,-1382.56 1215,-1382.56 1221,-1382.56 1227,-1388.56 1227,-1394.56 1227,-1394.56 1227,-1461.56 1227,-1461.56 1227,-1467.56 1221,-1473.56 1215,-1473.56 1215,-1473.56 981,-1473.56 981,-1473.56 975,-1473.56 969,-1467.56 969,-1461.56 969,-1461.56 969,-1394.56 969,-1394.56 969,-1388.56 975,-1382.56 981,-1382.56"/>
<text text-anchor="middle" x="1098" y="-1458.36" font-family="Times,serif" font-size="14.00">Layer 10 (PP Stage 10)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer11</title>
<path fill="lightgray" stroke="black" d="M981,-1166.46C981,-1166.46 1215,-1166.46 1215,-1166.46 1221,-1166.46 1227,-1172.46 1227,-1178.46 1227,-1178.46 1227,-1245.46 1227,-1245.46 1227,-1251.46 1221,-1257.46 1215,-1257.46 1215,-1257.46 981,-1257.46 981,-1257.46 975,-1257.46 969,-1251.46 969,-1245.46 969,-1245.46 969,-1178.46 969,-1178.46 969,-1172.46 975,-1166.46 981,-1166.46"/>
<text text-anchor="middle" x="1098" y="-1242.26" font-family="Times,serif" font-size="14.00">Layer 11 (PP Stage 11)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer12</title>
<path fill="lightgray" stroke="black" d="M981,-950.36C981,-950.36 1215,-950.36 1215,-950.36 1221,-950.36 1227,-956.36 1227,-962.36 1227,-962.36 1227,-1029.36 1227,-1029.36 1227,-1035.36 1221,-1041.36 1215,-1041.36 1215,-1041.36 981,-1041.36 981,-1041.36 975,-1041.36 969,-1035.36 969,-1029.36 969,-1029.36 969,-962.36 969,-962.36 969,-956.36 975,-950.36 981,-950.36"/>
<text text-anchor="middle" x="1098" y="-1026.16" font-family="Times,serif" font-size="14.00">Layer 12 (PP Stage 12)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer13</title>
<path fill="lightgray" stroke="black" d="M981,-734.27C981,-734.27 1215,-734.27 1215,-734.27 1221,-734.27 1227,-740.27 1227,-746.27 1227,-746.27 1227,-813.27 1227,-813.27 1227,-819.27 1221,-825.27 1215,-825.27 1215,-825.27 981,-825.27 981,-825.27 975,-825.27 969,-819.27 969,-813.27 969,-813.27 969,-746.27 969,-746.27 969,-740.27 975,-734.27 981,-734.27"/>
<text text-anchor="middle" x="1098" y="-810.07" font-family="Times,serif" font-size="14.00">Layer 13 (PP Stage 13)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer14</title>
<path fill="lightgray" stroke="black" d="M981,-518.17C981,-518.17 1215,-518.17 1215,-518.17 1221,-518.17 1227,-524.17 1227,-530.17 1227,-530.17 1227,-597.17 1227,-597.17 1227,-603.17 1221,-609.17 1215,-609.17 1215,-609.17 981,-609.17 981,-609.17 975,-609.17 969,-603.17 969,-597.17 969,-597.17 969,-530.17 969,-530.17 969,-524.17 975,-518.17 981,-518.17"/>
<text text-anchor="middle" x="1098" y="-593.97" font-family="Times,serif" font-size="14.00">Layer 14 (PP Stage 14)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer15</title>
<path fill="lightgray" stroke="black" d="M981,-302.08C981,-302.08 1215,-302.08 1215,-302.08 1221,-302.08 1227,-308.08 1227,-314.08 1227,-314.08 1227,-381.08 1227,-381.08 1227,-387.08 1221,-393.08 1215,-393.08 1215,-393.08 981,-393.08 981,-393.08 975,-393.08 969,-387.08 969,-381.08 969,-381.08 969,-314.08 969,-314.08 969,-308.08 975,-302.08 981,-302.08"/>
<text text-anchor="middle" x="1098" y="-377.88" font-family="Times,serif" font-size="14.00">Layer 15 (PP Stage 15)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer16</title>
<path fill="lightgray" stroke="black" d="M981,-85.98C981,-85.98 1215,-85.98 1215,-85.98 1221,-85.98 1227,-91.98 1227,-97.98 1227,-97.98 1227,-164.98 1227,-164.98 1227,-170.98 1221,-176.98 1215,-176.98 1215,-176.98 981,-176.98 981,-176.98 975,-176.98 969,-170.98 969,-164.98 969,-164.98 969,-97.98 969,-97.98 969,-91.98 975,-85.98 981,-85.98"/>
<text text-anchor="middle" x="1098" y="-161.78" font-family="Times,serif" font-size="14.00">Layer 16 (PP Stage 16)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="825" cy="-4341.72" rx="171.24" ry="28.98"/>
<text text-anchor="middle" x="825" y="-4350.22" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="825" y="-4339.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="825" y="-4328.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- sp_split_1 -->
<g id="node2" class="node">
<title>sp_split_1</title>
<polygon fill="lightyellow" stroke="black" points="1070.92,-4265.95 679.72,-4265.95 579.08,-4161.95 970.28,-4161.95 1070.92,-4265.95"/>
<text text-anchor="middle" x="825" y="-4227.95" font-family="Arial" font-size="10.00">SP Split</text>
<text text-anchor="middle" x="825" y="-4216.95" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="825" y="-4205.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="825" y="-4194.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- input&#45;&gt;sp_split_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;sp_split_1</title>
<path fill="none" stroke="black" d="M825,-4312.5C825,-4301.7 825,-4288.91 825,-4276.22"/>
<polygon fill="black" stroke="black" points="828.5,-4276.09 825,-4266.09 821.5,-4276.09 828.5,-4276.09"/>
</g>
<!-- attn_q_1 -->
<g id="node3" class="node">
<title>attn_q_1</title>
<polygon fill="lightgreen" stroke="black" points="306.5,-4125.95 69.5,-4125.95 69.5,-4062.95 306.5,-4062.95 306.5,-4125.95"/>
<text text-anchor="middle" x="188" y="-4113.95" font-family="Arial" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="188" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="188" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="188" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="188" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_q_1 -->
<g id="edge2" class="edge">
<title>sp_split_1&#45;&gt;attn_q_1</title>
<path fill="none" stroke="black" d="M593.2,-4176.58C508.94,-4162.54 412.86,-4145.57 316.74,-4126.06"/>
<polygon fill="black" stroke="black" points="317.33,-4122.61 306.84,-4124.05 315.94,-4129.47 317.33,-4122.61"/>
</g>
<!-- attn_q_1_tp1 -->
<g id="node4" class="node">
<title>attn_q_1_tp1</title>
<polygon fill="lightgreen" stroke="black" points="1071.5,-4125.95 834.5,-4125.95 834.5,-4062.95 1071.5,-4062.95 1071.5,-4125.95"/>
<text text-anchor="middle" x="953" y="-4113.95" font-family="Arial" font-size="10.00">Attention Q Projection</text>
<text text-anchor="middle" x="953" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="953" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="953" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="953" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_q_1_tp1 -->
<g id="edge3" class="edge">
<title>sp_split_1&#45;&gt;attn_q_1_tp1</title>
<path fill="none" stroke="black" d="M880.77,-4161.76C891.29,-4152.1 902.12,-4142.16 912.08,-4133.02"/>
<polygon fill="black" stroke="black" points="914.51,-4135.54 919.51,-4126.2 909.78,-4130.38 914.51,-4135.54"/>
</g>
<!-- attn_k_1 -->
<g id="node5" class="node">
<title>attn_k_1</title>
<polygon fill="lightgreen" stroke="black" points="561.5,-4125.95 324.5,-4125.95 324.5,-4062.95 561.5,-4062.95 561.5,-4125.95"/>
<text text-anchor="middle" x="443" y="-4113.95" font-family="Arial" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="443" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="443" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="443" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="443" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_k_1 -->
<g id="edge4" class="edge">
<title>sp_split_1&#45;&gt;attn_k_1</title>
<path fill="none" stroke="black" d="M659.12,-4161.93C622.83,-4150.77 585.31,-4139.23 551.93,-4128.96"/>
<polygon fill="black" stroke="black" points="552.76,-4125.55 542.17,-4125.96 550.7,-4132.24 552.76,-4125.55"/>
</g>
<!-- attn_k_1_tp1 -->
<g id="node6" class="node">
<title>attn_k_1_tp1</title>
<polygon fill="lightgreen" stroke="black" points="1326.5,-4125.95 1089.5,-4125.95 1089.5,-4062.95 1326.5,-4062.95 1326.5,-4125.95"/>
<text text-anchor="middle" x="1208" y="-4113.95" font-family="Arial" font-size="10.00">Attention K Projection</text>
<text text-anchor="middle" x="1208" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1208" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1208" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="1208" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_k_1_tp1 -->
<g id="edge5" class="edge">
<title>sp_split_1&#45;&gt;attn_k_1_tp1</title>
<path fill="none" stroke="black" d="M975.27,-4166.85C1016.52,-4154.2 1060.45,-4140.72 1098.9,-4128.93"/>
<polygon fill="black" stroke="black" points="1100.02,-4132.24 1108.55,-4125.96 1097.96,-4125.55 1100.02,-4132.24"/>
</g>
<!-- attn_v_1 -->
<g id="node7" class="node">
<title>attn_v_1</title>
<polygon fill="lightgreen" stroke="black" points="816.5,-4125.95 579.5,-4125.95 579.5,-4062.95 816.5,-4062.95 816.5,-4125.95"/>
<text text-anchor="middle" x="698" y="-4113.95" font-family="Arial" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="698" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="698" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="698" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="698" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_v_1 -->
<g id="edge6" class="edge">
<title>sp_split_1&#45;&gt;attn_v_1</title>
<path fill="none" stroke="black" d="M769.67,-4161.76C759.23,-4152.1 748.49,-4142.16 738.6,-4133.02"/>
<polygon fill="black" stroke="black" points="740.95,-4130.42 731.23,-4126.2 736.19,-4135.56 740.95,-4130.42"/>
</g>
<!-- attn_v_1_tp1 -->
<g id="node8" class="node">
<title>attn_v_1_tp1</title>
<polygon fill="lightgreen" stroke="black" points="1581.5,-4125.95 1344.5,-4125.95 1344.5,-4062.95 1581.5,-4062.95 1581.5,-4125.95"/>
<text text-anchor="middle" x="1463" y="-4113.95" font-family="Arial" font-size="10.00">Attention V Projection</text>
<text text-anchor="middle" x="1463" y="-4102.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1463" y="-4091.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1463" y="-4080.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="1463" y="-4069.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_v_1_tp1 -->
<g id="edge7" class="edge">
<title>sp_split_1&#45;&gt;attn_v_1_tp1</title>
<path fill="none" stroke="black" d="M994.7,-4186.99C1091.68,-4171.44 1215.72,-4150.36 1334.42,-4126.24"/>
<polygon fill="black" stroke="black" points="1335.32,-4129.63 1344.42,-4124.2 1333.92,-4122.77 1335.32,-4129.63"/>
</g>
<!-- attn_comp_1 -->
<g id="node9" class="node">
<title>attn_comp_1</title>
<polygon fill="lightgreen" stroke="black" points="800.5,-4026.95 527.5,-4026.95 527.5,-3963.95 800.5,-3963.95 800.5,-4026.95"/>
<text text-anchor="middle" x="664" y="-4014.95" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="664" y="-4003.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="664" y="-3992.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="664" y="-3981.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="664" y="-3970.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- attn_q_1&#45;&gt;attn_comp_1 -->
<g id="edge8" class="edge">
<title>attn_q_1&#45;&gt;attn_comp_1</title>
<path fill="none" stroke="black" d="M306.51,-4065.02C309.71,-4064.31 312.87,-4063.62 316,-4062.95 381.94,-4048.81 455.22,-4034.58 517.47,-4022.94"/>
<polygon fill="black" stroke="black" points="518.17,-4026.37 527.36,-4021.09 516.89,-4019.48 518.17,-4026.37"/>
</g>
<!-- attn_comp_1_tp1 -->
<g id="node10" class="node">
<title>attn_comp_1_tp1</title>
<polygon fill="lightgreen" stroke="black" points="1209.5,-4026.95 936.5,-4026.95 936.5,-3963.95 1209.5,-3963.95 1209.5,-4026.95"/>
<text text-anchor="middle" x="1073" y="-4014.95" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="1073" y="-4003.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1073" y="-3992.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1073" y="-3981.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1073" y="-3970.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- attn_q_1_tp1&#45;&gt;attn_comp_1_tp1 -->
<g id="edge9" class="edge">
<title>attn_q_1_tp1&#45;&gt;attn_comp_1_tp1</title>
<path fill="none" stroke="black" d="M990.97,-4062.76C1002.35,-4053.56 1014.96,-4043.37 1026.81,-4033.79"/>
<polygon fill="black" stroke="black" points="1029.29,-4036.29 1034.87,-4027.28 1024.89,-4030.84 1029.29,-4036.29"/>
</g>
<!-- attn_k_1&#45;&gt;attn_comp_1 -->
<g id="edge10" class="edge">
<title>attn_k_1&#45;&gt;attn_comp_1</title>
<path fill="none" stroke="black" d="M512.62,-4062.9C535.63,-4052.8 561.39,-4041.49 585.05,-4031.11"/>
<polygon fill="black" stroke="black" points="586.6,-4034.25 594.35,-4027.02 583.78,-4027.84 586.6,-4034.25"/>
</g>
<!-- attn_k_1_tp1&#45;&gt;attn_comp_1_tp1 -->
<g id="edge11" class="edge">
<title>attn_k_1_tp1&#45;&gt;attn_comp_1_tp1</title>
<path fill="none" stroke="black" d="M1165.29,-4062.76C1152.24,-4053.39 1137.75,-4042.98 1124.2,-4033.24"/>
<polygon fill="black" stroke="black" points="1126.06,-4030.27 1115.9,-4027.28 1121.98,-4035.96 1126.06,-4030.27"/>
</g>
<!-- attn_v_1&#45;&gt;attn_comp_1 -->
<g id="edge12" class="edge">
<title>attn_v_1&#45;&gt;attn_comp_1</title>
<path fill="none" stroke="black" d="M687.24,-4062.76C684.36,-4054.54 681.2,-4045.52 678.16,-4036.85"/>
<polygon fill="black" stroke="black" points="681.42,-4035.56 674.8,-4027.28 674.81,-4037.87 681.42,-4035.56"/>
</g>
<!-- attn_v_1_tp1&#45;&gt;attn_comp_1_tp1 -->
<g id="edge13" class="edge">
<title>attn_v_1_tp1&#45;&gt;attn_comp_1_tp1</title>
<path fill="none" stroke="black" d="M1344.4,-4063.96C1300.55,-4053.05 1250.59,-4040.62 1205.58,-4029.43"/>
<polygon fill="black" stroke="black" points="1206.31,-4026 1195.76,-4026.99 1204.62,-4032.8 1206.31,-4026"/>
</g>
<!-- attn_out_1 -->
<g id="node11" class="node">
<title>attn_out_1</title>
<polygon fill="lightgreen" stroke="black" points="825.5,-3927.95 588.5,-3927.95 588.5,-3864.95 825.5,-3864.95 825.5,-3927.95"/>
<text text-anchor="middle" x="707" y="-3915.95" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="707" y="-3904.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="707" y="-3893.95" font-family="Arial" font-size="10.00">TP Rank 0</text>
<text text-anchor="middle" x="707" y="-3882.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=256]</text>
<text text-anchor="middle" x="707" y="-3871.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- attn_comp_1&#45;&gt;attn_out_1 -->
<g id="edge14" class="edge">
<title>attn_comp_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M677.61,-3963.76C681.29,-3955.45 685.34,-3946.32 689.22,-3937.57"/>
<polygon fill="black" stroke="black" points="692.48,-3938.84 693.34,-3928.28 686.08,-3936 692.48,-3938.84"/>
</g>
<!-- attn_out_1_tp1 -->
<g id="node12" class="node">
<title>attn_out_1_tp1</title>
<polygon fill="lightgreen" stroke="black" points="1123.5,-3927.95 886.5,-3927.95 886.5,-3864.95 1123.5,-3864.95 1123.5,-3927.95"/>
<text text-anchor="middle" x="1005" y="-3915.95" font-family="Arial" font-size="10.00">Attention Output Proj</text>
<text text-anchor="middle" x="1005" y="-3904.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1005" y="-3893.95" font-family="Arial" font-size="10.00">TP Rank 1</text>
<text text-anchor="middle" x="1005" y="-3882.95" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=256]</text>
<text text-anchor="middle" x="1005" y="-3871.95" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=256]</text>
</g>
<!-- attn_comp_1_tp1&#45;&gt;attn_out_1_tp1 -->
<g id="edge15" class="edge">
<title>attn_comp_1_tp1&#45;&gt;attn_out_1_tp1</title>
<path fill="none" stroke="black" d="M1051.48,-3963.76C1045.47,-3955.18 1038.85,-3945.74 1032.54,-3936.73"/>
<polygon fill="black" stroke="black" points="1035.22,-3934.46 1026.61,-3928.28 1029.48,-3938.48 1035.22,-3934.46"/>
</g>
<!-- attn_allreduce_1 -->
<g id="node13" class="node">
<title>attn_allreduce_1</title>
<ellipse fill="lightblue" stroke="black" cx="971" cy="-3792.18" rx="167.67" ry="36.54"/>
<text text-anchor="middle" x="971" y="-3806.18" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="971" y="-3795.18" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="971" y="-3784.18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=256]</text>
<text text-anchor="middle" x="971" y="-3773.18" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- attn_out_1&#45;&gt;attn_allreduce_1 -->
<g id="edge16" class="edge">
<title>attn_out_1&#45;&gt;attn_allreduce_1</title>
<path fill="none" stroke="black" d="M785.85,-3864.91C815.73,-3853.33 849.97,-3840.07 880.82,-3828.12"/>
<polygon fill="black" stroke="black" points="882.21,-3831.33 890.27,-3824.46 879.68,-3824.81 882.21,-3831.33"/>
</g>
<!-- attn_out_1_tp1&#45;&gt;attn_allreduce_1 -->
<g id="edge17" class="edge">
<title>attn_out_1_tp1&#45;&gt;attn_allreduce_1</title>
<path fill="none" stroke="black" d="M994.8,-3864.77C992.04,-3856.47 989,-3847.32 986.03,-3838.41"/>
<polygon fill="black" stroke="black" points="989.34,-3837.27 982.87,-3828.88 982.7,-3839.47 989.34,-3837.27"/>
</g>
<!-- gate_1 -->
<g id="node14" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="579.99,-3719.41 131.4,-3719.41 16.01,-3615.41 464.6,-3615.41 579.99,-3719.41"/>
<text text-anchor="middle" x="298" y="-3681.41" font-family="Arial" font-size="10.00">Expert Gate</text>
<text text-anchor="middle" x="298" y="-3670.41" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="298" y="-3659.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="298" y="-3648.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, num_experts=16]</text>
</g>
<!-- attn_allreduce_1&#45;&gt;gate_1 -->
<g id="edge18" class="edge">
<title>attn_allreduce_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M844.02,-3768.02C771.51,-3754.79 677.43,-3737.63 587.86,-3721.29"/>
<polygon fill="black" stroke="black" points="588.27,-3717.81 577.8,-3719.46 587.01,-3724.69 588.27,-3717.81"/>
</g>
<!-- expert_0_1 -->
<g id="node15" class="node">
<title>expert_0_1</title>
<polygon fill="lightgreen" stroke="black" points="834.5,-3698.91 597.5,-3698.91 597.5,-3635.91 834.5,-3635.91 834.5,-3698.91"/>
<text text-anchor="middle" x="716" y="-3686.91" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="716" y="-3675.91" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="716" y="-3664.91" font-family="Arial" font-size="10.00">EP Rank 0</text>
<text text-anchor="middle" x="716" y="-3653.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="716" y="-3642.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- attn_allreduce_1&#45;&gt;expert_0_1 -->
<g id="edge19" class="edge">
<title>attn_allreduce_1&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M903,-3758.45C867.79,-3741.49 824.77,-3720.78 788.87,-3703.5"/>
<polygon fill="black" stroke="black" points="789.96,-3700.14 779.43,-3698.95 786.92,-3706.44 789.96,-3700.14"/>
</g>
<!-- expert_1_1 -->
<g id="node16" class="node">
<title>expert_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1089.5,-3698.91 852.5,-3698.91 852.5,-3635.91 1089.5,-3635.91 1089.5,-3698.91"/>
<text text-anchor="middle" x="971" y="-3686.91" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="971" y="-3675.91" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="971" y="-3664.91" font-family="Arial" font-size="10.00">EP Rank 1</text>
<text text-anchor="middle" x="971" y="-3653.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="971" y="-3642.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- attn_allreduce_1&#45;&gt;expert_1_1 -->
<g id="edge20" class="edge">
<title>attn_allreduce_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M971,-3755.34C971,-3740.85 971,-3724.05 971,-3709.1"/>
<polygon fill="black" stroke="black" points="974.5,-3709.1 971,-3699.1 967.5,-3709.1 974.5,-3709.1"/>
</g>
<!-- expert_2_1 -->
<g id="node17" class="node">
<title>expert_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1344.5,-3698.91 1107.5,-3698.91 1107.5,-3635.91 1344.5,-3635.91 1344.5,-3698.91"/>
<text text-anchor="middle" x="1226" y="-3686.91" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1226" y="-3675.91" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="1226" y="-3664.91" font-family="Arial" font-size="10.00">EP Rank 2</text>
<text text-anchor="middle" x="1226" y="-3653.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="1226" y="-3642.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- attn_allreduce_1&#45;&gt;expert_2_1 -->
<g id="edge21" class="edge">
<title>attn_allreduce_1&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M1039,-3758.45C1074.21,-3741.49 1117.23,-3720.78 1153.13,-3703.5"/>
<polygon fill="black" stroke="black" points="1155.08,-3706.44 1162.57,-3698.95 1152.04,-3700.14 1155.08,-3706.44"/>
</g>
<!-- expert_3_1 -->
<g id="node18" class="node">
<title>expert_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1599.5,-3698.91 1362.5,-3698.91 1362.5,-3635.91 1599.5,-3635.91 1599.5,-3698.91"/>
<text text-anchor="middle" x="1481" y="-3686.91" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1481" y="-3675.91" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="1481" y="-3664.91" font-family="Arial" font-size="10.00">EP Rank 3</text>
<text text-anchor="middle" x="1481" y="-3653.91" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="1481" y="-3642.91" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- attn_allreduce_1&#45;&gt;expert_3_1 -->
<g id="edge22" class="edge">
<title>attn_allreduce_1&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M1110.82,-3771.76C1184.06,-3759.89 1274.76,-3742.5 1354,-3719.41 1369.87,-3714.79 1386.49,-3708.91 1402.28,-3702.81"/>
<polygon fill="black" stroke="black" points="1403.97,-3705.9 1412,-3698.98 1401.41,-3699.39 1403.97,-3705.9"/>
</g>
<!-- expert_agg_1 -->
<g id="node19" class="node">
<title>expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="1358.45,-3579.41 944.13,-3579.41 837.55,-3475.41 1251.87,-3475.41 1358.45,-3579.41"/>
<text text-anchor="middle" x="1098" y="-3541.41" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1098" y="-3530.41" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="1098" y="-3519.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512] x 16</text>
<text text-anchor="middle" x="1098" y="-3508.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=5120, dim=512]</text>
</g>
<!-- expert_0_1&#45;&gt;expert_agg_1 -->
<g id="edge23" class="edge">
<title>expert_0_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M790.89,-3635.86C808.26,-3628.97 826.73,-3621.81 844,-3615.41 873.39,-3604.54 904.85,-3593.37 935.28,-3582.82"/>
<polygon fill="black" stroke="black" points="936.82,-3585.99 945.12,-3579.42 934.53,-3579.38 936.82,-3585.99"/>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge24" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M999.19,-3635.79C1012.37,-3621.47 1028.52,-3603.91 1043.93,-3587.17"/>
<polygon fill="black" stroke="black" points="1046.74,-3589.28 1050.94,-3579.56 1041.59,-3584.54 1046.74,-3589.28"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_1 -->
<g id="edge25" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1197.59,-3635.79C1184.31,-3621.47 1168.02,-3603.91 1152.5,-3587.17"/>
<polygon fill="black" stroke="black" points="1154.8,-3584.51 1145.44,-3579.56 1149.67,-3589.27 1154.8,-3584.51"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_1 -->
<g id="edge26" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1406.72,-3635.8C1389.48,-3628.92 1371.16,-3621.77 1354,-3615.41 1324.48,-3604.48 1292.86,-3593.3 1262.26,-3582.76"/>
<polygon fill="black" stroke="black" points="1263.4,-3579.45 1252.8,-3579.51 1261.12,-3586.07 1263.4,-3579.45"/>
</g>
<!-- sp_merge_1 -->
<g id="node20" class="node">
<title>sp_merge_1</title>
<polygon fill="lightyellow" stroke="black" points="1348.79,-3439.41 949.84,-3439.41 847.21,-3335.41 1246.16,-3335.41 1348.79,-3439.41"/>
<text text-anchor="middle" x="1098" y="-3401.41" font-family="Arial" font-size="10.00">SP Merge</text>
<text text-anchor="middle" x="1098" y="-3390.41" font-family="Arial" font-size="10.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="1098" y="-3379.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=5120, dim=512]</text>
<text text-anchor="middle" x="1098" y="-3368.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- expert_agg_1&#45;&gt;sp_merge_1 -->
<g id="edge27" class="edge">
<title>expert_agg_1&#45;&gt;sp_merge_1</title>
<path fill="none" stroke="black" d="M1098,-3475.03C1098,-3466.86 1098,-3458.33 1098,-3449.95"/>
<polygon fill="black" stroke="black" points="1101.5,-3449.84 1098,-3439.84 1094.5,-3449.84 1101.5,-3449.84"/>
</g>
<!-- pp_comm_1_2 -->
<g id="node21" class="node">
<title>pp_comm_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-3254.87" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-3274.37" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-3263.37" font-family="Arial" font-size="10.00">Layer 1 &#45;&gt; 2</text>
<text text-anchor="middle" x="1098" y="-3252.37" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-3241.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-3230.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- sp_merge_1&#45;&gt;pp_comm_1_2 -->
<g id="edge28" class="edge">
<title>sp_merge_1&#45;&gt;pp_comm_1_2</title>
<path fill="none" stroke="black" d="M1098,-3335.19C1098,-3326.86 1098,-3318.22 1098,-3309.82"/>
<polygon fill="black" stroke="black" points="1101.5,-3309.75 1098,-3299.75 1094.5,-3309.75 1101.5,-3309.75"/>
</g>
<!-- layer_2_block -->
<g id="node37" class="node">
<title>layer_2_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-3171.32 977,-3171.32 977,-3119.32 1219,-3119.32 1219,-3171.32"/>
<text text-anchor="middle" x="1098" y="-3159.32" font-family="Arial" font-size="10.00">Layer 2 Complete</text>
<text text-anchor="middle" x="1098" y="-3148.32" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-3137.32" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-3126.32" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_1_2&#45;&gt;layer_2_block -->
<g id="edge29" class="edge">
<title>pp_comm_1_2&#45;&gt;layer_2_block</title>
<path fill="none" stroke="black" d="M1098,-3210.12C1098,-3200.68 1098,-3190.8 1098,-3181.72"/>
<polygon fill="black" stroke="black" points="1101.5,-3181.5 1098,-3171.5 1094.5,-3181.5 1101.5,-3181.5"/>
</g>
<!-- pp_comm_2_3 -->
<g id="node22" class="node">
<title>pp_comm_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-3038.77" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-3058.27" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-3047.27" font-family="Arial" font-size="10.00">Layer 2 &#45;&gt; 3</text>
<text text-anchor="middle" x="1098" y="-3036.27" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-3025.27" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-3014.27" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_3_block -->
<g id="node38" class="node">
<title>layer_3_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-2955.22 977,-2955.22 977,-2903.22 1219,-2903.22 1219,-2955.22"/>
<text text-anchor="middle" x="1098" y="-2943.22" font-family="Arial" font-size="10.00">Layer 3 Complete</text>
<text text-anchor="middle" x="1098" y="-2932.22" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-2921.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2910.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_2_3&#45;&gt;layer_3_block -->
<g id="edge31" class="edge">
<title>pp_comm_2_3&#45;&gt;layer_3_block</title>
<path fill="none" stroke="black" d="M1098,-2994.03C1098,-2984.58 1098,-2974.71 1098,-2965.63"/>
<polygon fill="black" stroke="black" points="1101.5,-2965.4 1098,-2955.4 1094.5,-2965.4 1101.5,-2965.4"/>
</g>
<!-- pp_comm_3_4 -->
<g id="node23" class="node">
<title>pp_comm_3_4</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-2822.68" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-2842.18" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-2831.18" font-family="Arial" font-size="10.00">Layer 3 &#45;&gt; 4</text>
<text text-anchor="middle" x="1098" y="-2820.18" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-2809.18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2798.18" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_4_block -->
<g id="node39" class="node">
<title>layer_4_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-2739.13 977,-2739.13 977,-2687.13 1219,-2687.13 1219,-2739.13"/>
<text text-anchor="middle" x="1098" y="-2727.13" font-family="Arial" font-size="10.00">Layer 4 Complete</text>
<text text-anchor="middle" x="1098" y="-2716.13" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-2705.13" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2694.13" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_3_4&#45;&gt;layer_4_block -->
<g id="edge33" class="edge">
<title>pp_comm_3_4&#45;&gt;layer_4_block</title>
<path fill="none" stroke="black" d="M1098,-2777.93C1098,-2768.49 1098,-2758.61 1098,-2749.53"/>
<polygon fill="black" stroke="black" points="1101.5,-2749.31 1098,-2739.31 1094.5,-2749.31 1101.5,-2749.31"/>
</g>
<!-- pp_comm_4_5 -->
<g id="node24" class="node">
<title>pp_comm_4_5</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-2606.58" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-2626.08" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-2615.08" font-family="Arial" font-size="10.00">Layer 4 &#45;&gt; 5</text>
<text text-anchor="middle" x="1098" y="-2604.08" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-2593.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2582.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_5_block -->
<g id="node40" class="node">
<title>layer_5_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-2523.03 977,-2523.03 977,-2471.03 1219,-2471.03 1219,-2523.03"/>
<text text-anchor="middle" x="1098" y="-2511.03" font-family="Arial" font-size="10.00">Layer 5 Complete</text>
<text text-anchor="middle" x="1098" y="-2500.03" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-2489.03" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2478.03" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_4_5&#45;&gt;layer_5_block -->
<g id="edge35" class="edge">
<title>pp_comm_4_5&#45;&gt;layer_5_block</title>
<path fill="none" stroke="black" d="M1098,-2561.84C1098,-2552.39 1098,-2542.52 1098,-2533.44"/>
<polygon fill="black" stroke="black" points="1101.5,-2533.21 1098,-2523.21 1094.5,-2533.21 1101.5,-2533.21"/>
</g>
<!-- pp_comm_5_6 -->
<g id="node25" class="node">
<title>pp_comm_5_6</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-2390.49" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-2409.99" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-2398.99" font-family="Arial" font-size="10.00">Layer 5 &#45;&gt; 6</text>
<text text-anchor="middle" x="1098" y="-2387.99" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-2376.99" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2365.99" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_6_block -->
<g id="node41" class="node">
<title>layer_6_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-2306.94 977,-2306.94 977,-2254.94 1219,-2254.94 1219,-2306.94"/>
<text text-anchor="middle" x="1098" y="-2294.94" font-family="Arial" font-size="10.00">Layer 6 Complete</text>
<text text-anchor="middle" x="1098" y="-2283.94" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-2272.94" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2261.94" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_5_6&#45;&gt;layer_6_block -->
<g id="edge37" class="edge">
<title>pp_comm_5_6&#45;&gt;layer_6_block</title>
<path fill="none" stroke="black" d="M1098,-2345.74C1098,-2336.29 1098,-2326.42 1098,-2317.34"/>
<polygon fill="black" stroke="black" points="1101.5,-2317.12 1098,-2307.12 1094.5,-2317.12 1101.5,-2317.12"/>
</g>
<!-- pp_comm_6_7 -->
<g id="node26" class="node">
<title>pp_comm_6_7</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-2174.39" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-2193.89" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-2182.89" font-family="Arial" font-size="10.00">Layer 6 &#45;&gt; 7</text>
<text text-anchor="middle" x="1098" y="-2171.89" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-2160.89" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2149.89" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_7_block -->
<g id="node42" class="node">
<title>layer_7_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-2090.84 977,-2090.84 977,-2038.84 1219,-2038.84 1219,-2090.84"/>
<text text-anchor="middle" x="1098" y="-2078.84" font-family="Arial" font-size="10.00">Layer 7 Complete</text>
<text text-anchor="middle" x="1098" y="-2067.84" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-2056.84" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-2045.84" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_6_7&#45;&gt;layer_7_block -->
<g id="edge39" class="edge">
<title>pp_comm_6_7&#45;&gt;layer_7_block</title>
<path fill="none" stroke="black" d="M1098,-2129.65C1098,-2120.2 1098,-2110.32 1098,-2101.24"/>
<polygon fill="black" stroke="black" points="1101.5,-2101.02 1098,-2091.02 1094.5,-2101.02 1101.5,-2101.02"/>
</g>
<!-- pp_comm_7_8 -->
<g id="node27" class="node">
<title>pp_comm_7_8</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-1958.29" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-1977.79" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-1966.79" font-family="Arial" font-size="10.00">Layer 7 &#45;&gt; 8</text>
<text text-anchor="middle" x="1098" y="-1955.79" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-1944.79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1933.79" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_8_block -->
<g id="node43" class="node">
<title>layer_8_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-1874.75 977,-1874.75 977,-1822.75 1219,-1822.75 1219,-1874.75"/>
<text text-anchor="middle" x="1098" y="-1862.75" font-family="Arial" font-size="10.00">Layer 8 Complete</text>
<text text-anchor="middle" x="1098" y="-1851.75" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-1840.75" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1829.75" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_7_8&#45;&gt;layer_8_block -->
<g id="edge41" class="edge">
<title>pp_comm_7_8&#45;&gt;layer_8_block</title>
<path fill="none" stroke="black" d="M1098,-1913.55C1098,-1904.1 1098,-1894.23 1098,-1885.15"/>
<polygon fill="black" stroke="black" points="1101.5,-1884.93 1098,-1874.93 1094.5,-1884.93 1101.5,-1884.93"/>
</g>
<!-- pp_comm_8_9 -->
<g id="node28" class="node">
<title>pp_comm_8_9</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-1742.2" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-1761.7" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-1750.7" font-family="Arial" font-size="10.00">Layer 8 &#45;&gt; 9</text>
<text text-anchor="middle" x="1098" y="-1739.7" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-1728.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1717.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_9_block -->
<g id="node44" class="node">
<title>layer_9_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-1658.65 977,-1658.65 977,-1606.65 1219,-1606.65 1219,-1658.65"/>
<text text-anchor="middle" x="1098" y="-1646.65" font-family="Arial" font-size="10.00">Layer 9 Complete</text>
<text text-anchor="middle" x="1098" y="-1635.65" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-1624.65" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1613.65" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_8_9&#45;&gt;layer_9_block -->
<g id="edge43" class="edge">
<title>pp_comm_8_9&#45;&gt;layer_9_block</title>
<path fill="none" stroke="black" d="M1098,-1697.45C1098,-1688.01 1098,-1678.13 1098,-1669.05"/>
<polygon fill="black" stroke="black" points="1101.5,-1668.83 1098,-1658.83 1094.5,-1668.83 1101.5,-1668.83"/>
</g>
<!-- pp_comm_9_10 -->
<g id="node29" class="node">
<title>pp_comm_9_10</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-1526.1" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-1545.6" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-1534.6" font-family="Arial" font-size="10.00">Layer 9 &#45;&gt; 10</text>
<text text-anchor="middle" x="1098" y="-1523.6" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-1512.6" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1501.6" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_10_block -->
<g id="node45" class="node">
<title>layer_10_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-1442.56 977,-1442.56 977,-1390.56 1219,-1390.56 1219,-1442.56"/>
<text text-anchor="middle" x="1098" y="-1430.56" font-family="Arial" font-size="10.00">Layer 10 Complete</text>
<text text-anchor="middle" x="1098" y="-1419.56" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-1408.56" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1397.56" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_9_10&#45;&gt;layer_10_block -->
<g id="edge45" class="edge">
<title>pp_comm_9_10&#45;&gt;layer_10_block</title>
<path fill="none" stroke="black" d="M1098,-1481.36C1098,-1471.91 1098,-1462.04 1098,-1452.96"/>
<polygon fill="black" stroke="black" points="1101.5,-1452.74 1098,-1442.74 1094.5,-1452.74 1101.5,-1452.74"/>
</g>
<!-- pp_comm_10_11 -->
<g id="node30" class="node">
<title>pp_comm_10_11</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-1310.01" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-1329.51" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-1318.51" font-family="Arial" font-size="10.00">Layer 10 &#45;&gt; 11</text>
<text text-anchor="middle" x="1098" y="-1307.51" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-1296.51" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1285.51" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_11_block -->
<g id="node46" class="node">
<title>layer_11_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-1226.46 977,-1226.46 977,-1174.46 1219,-1174.46 1219,-1226.46"/>
<text text-anchor="middle" x="1098" y="-1214.46" font-family="Arial" font-size="10.00">Layer 11 Complete</text>
<text text-anchor="middle" x="1098" y="-1203.46" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-1192.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1181.46" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_10_11&#45;&gt;layer_11_block -->
<g id="edge47" class="edge">
<title>pp_comm_10_11&#45;&gt;layer_11_block</title>
<path fill="none" stroke="black" d="M1098,-1265.26C1098,-1255.82 1098,-1245.94 1098,-1236.86"/>
<polygon fill="black" stroke="black" points="1101.5,-1236.64 1098,-1226.64 1094.5,-1236.64 1101.5,-1236.64"/>
</g>
<!-- pp_comm_11_12 -->
<g id="node31" class="node">
<title>pp_comm_11_12</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-1093.91" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-1113.41" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-1102.41" font-family="Arial" font-size="10.00">Layer 11 &#45;&gt; 12</text>
<text text-anchor="middle" x="1098" y="-1091.41" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-1080.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-1069.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_12_block -->
<g id="node47" class="node">
<title>layer_12_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-1010.36 977,-1010.36 977,-958.36 1219,-958.36 1219,-1010.36"/>
<text text-anchor="middle" x="1098" y="-998.36" font-family="Arial" font-size="10.00">Layer 12 Complete</text>
<text text-anchor="middle" x="1098" y="-987.36" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-976.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-965.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_11_12&#45;&gt;layer_12_block -->
<g id="edge49" class="edge">
<title>pp_comm_11_12&#45;&gt;layer_12_block</title>
<path fill="none" stroke="black" d="M1098,-1049.17C1098,-1039.72 1098,-1029.85 1098,-1020.77"/>
<polygon fill="black" stroke="black" points="1101.5,-1020.55 1098,-1010.55 1094.5,-1020.55 1101.5,-1020.55"/>
</g>
<!-- pp_comm_12_13 -->
<g id="node32" class="node">
<title>pp_comm_12_13</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-877.82" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-897.32" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-886.32" font-family="Arial" font-size="10.00">Layer 12 &#45;&gt; 13</text>
<text text-anchor="middle" x="1098" y="-875.32" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-864.32" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-853.32" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_13_block -->
<g id="node48" class="node">
<title>layer_13_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-794.27 977,-794.27 977,-742.27 1219,-742.27 1219,-794.27"/>
<text text-anchor="middle" x="1098" y="-782.27" font-family="Arial" font-size="10.00">Layer 13 Complete</text>
<text text-anchor="middle" x="1098" y="-771.27" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-760.27" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-749.27" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_12_13&#45;&gt;layer_13_block -->
<g id="edge51" class="edge">
<title>pp_comm_12_13&#45;&gt;layer_13_block</title>
<path fill="none" stroke="black" d="M1098,-833.07C1098,-823.63 1098,-813.75 1098,-804.67"/>
<polygon fill="black" stroke="black" points="1101.5,-804.45 1098,-794.45 1094.5,-804.45 1101.5,-804.45"/>
</g>
<!-- pp_comm_13_14 -->
<g id="node33" class="node">
<title>pp_comm_13_14</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-661.72" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-681.22" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-670.22" font-family="Arial" font-size="10.00">Layer 13 &#45;&gt; 14</text>
<text text-anchor="middle" x="1098" y="-659.22" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-648.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-637.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_14_block -->
<g id="node49" class="node">
<title>layer_14_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-578.17 977,-578.17 977,-526.17 1219,-526.17 1219,-578.17"/>
<text text-anchor="middle" x="1098" y="-566.17" font-family="Arial" font-size="10.00">Layer 14 Complete</text>
<text text-anchor="middle" x="1098" y="-555.17" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-544.17" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-533.17" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_13_14&#45;&gt;layer_14_block -->
<g id="edge53" class="edge">
<title>pp_comm_13_14&#45;&gt;layer_14_block</title>
<path fill="none" stroke="black" d="M1098,-616.98C1098,-607.53 1098,-597.66 1098,-588.58"/>
<polygon fill="black" stroke="black" points="1101.5,-588.35 1098,-578.35 1094.5,-588.35 1101.5,-588.35"/>
</g>
<!-- pp_comm_14_15 -->
<g id="node34" class="node">
<title>pp_comm_14_15</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-445.63" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-465.13" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-454.13" font-family="Arial" font-size="10.00">Layer 14 &#45;&gt; 15</text>
<text text-anchor="middle" x="1098" y="-443.13" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-432.13" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-421.13" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_15_block -->
<g id="node50" class="node">
<title>layer_15_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-362.08 977,-362.08 977,-310.08 1219,-310.08 1219,-362.08"/>
<text text-anchor="middle" x="1098" y="-350.08" font-family="Arial" font-size="10.00">Layer 15 Complete</text>
<text text-anchor="middle" x="1098" y="-339.08" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-328.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-317.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_14_15&#45;&gt;layer_15_block -->
<g id="edge55" class="edge">
<title>pp_comm_14_15&#45;&gt;layer_15_block</title>
<path fill="none" stroke="black" d="M1098,-400.88C1098,-391.44 1098,-381.56 1098,-372.48"/>
<polygon fill="black" stroke="black" points="1101.5,-372.26 1098,-362.26 1094.5,-372.26 1101.5,-372.26"/>
</g>
<!-- pp_comm_15_16 -->
<g id="node35" class="node">
<title>pp_comm_15_16</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-229.53" rx="171.24" ry="44.6"/>
<text text-anchor="middle" x="1098" y="-249.03" font-family="Arial" font-size="10.00">PP Communication</text>
<text text-anchor="middle" x="1098" y="-238.03" font-family="Arial" font-size="10.00">Layer 15 &#45;&gt; 16</text>
<text text-anchor="middle" x="1098" y="-227.03" font-family="Arial" font-size="10.00">GPU: All GPUs</text>
<text text-anchor="middle" x="1098" y="-216.03" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-205.03" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- layer_16_block -->
<g id="node51" class="node">
<title>layer_16_block</title>
<polygon fill="lightgreen" stroke="black" points="1219,-145.98 977,-145.98 977,-93.98 1219,-93.98 1219,-145.98"/>
<text text-anchor="middle" x="1098" y="-133.98" font-family="Arial" font-size="10.00">Layer 16 Complete</text>
<text text-anchor="middle" x="1098" y="-122.98" font-family="Arial" font-size="10.00">GPU: 0&#45;255</text>
<text text-anchor="middle" x="1098" y="-111.98" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-100.98" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, dim=512]</text>
</g>
<!-- pp_comm_15_16&#45;&gt;layer_16_block -->
<g id="edge57" class="edge">
<title>pp_comm_15_16&#45;&gt;layer_16_block</title>
<path fill="none" stroke="black" d="M1098,-184.79C1098,-175.34 1098,-165.47 1098,-156.39"/>
<polygon fill="black" stroke="black" points="1101.5,-156.16 1098,-146.16 1094.5,-156.16 1101.5,-156.16"/>
</g>
<!-- output -->
<g id="node36" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="1098" cy="-28.99" rx="202.88" ry="28.98"/>
<text text-anchor="middle" x="1098" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="1098" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, dim=512]</text>
<text text-anchor="middle" x="1098" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, vocab_size=50000]</text>
</g>
<!-- layer_2_block&#45;&gt;pp_comm_2_3 -->
<g id="edge30" class="edge">
<title>layer_2_block&#45;&gt;pp_comm_2_3</title>
<path fill="none" stroke="black" d="M1098,-3119.28C1098,-3111.46 1098,-3102.53 1098,-3093.53"/>
<polygon fill="black" stroke="black" points="1101.5,-3093.4 1098,-3083.4 1094.5,-3093.4 1101.5,-3093.4"/>
</g>
<!-- layer_3_block&#45;&gt;pp_comm_3_4 -->
<g id="edge32" class="edge">
<title>layer_3_block&#45;&gt;pp_comm_3_4</title>
<path fill="none" stroke="black" d="M1098,-2903.18C1098,-2895.37 1098,-2886.43 1098,-2877.43"/>
<polygon fill="black" stroke="black" points="1101.5,-2877.31 1098,-2867.31 1094.5,-2877.31 1101.5,-2877.31"/>
</g>
<!-- layer_4_block&#45;&gt;pp_comm_4_5 -->
<g id="edge34" class="edge">
<title>layer_4_block&#45;&gt;pp_comm_4_5</title>
<path fill="none" stroke="black" d="M1098,-2687.09C1098,-2679.27 1098,-2670.34 1098,-2661.34"/>
<polygon fill="black" stroke="black" points="1101.5,-2661.21 1098,-2651.21 1094.5,-2661.21 1101.5,-2661.21"/>
</g>
<!-- layer_5_block&#45;&gt;pp_comm_5_6 -->
<g id="edge36" class="edge">
<title>layer_5_block&#45;&gt;pp_comm_5_6</title>
<path fill="none" stroke="black" d="M1098,-2470.99C1098,-2463.18 1098,-2454.24 1098,-2445.24"/>
<polygon fill="black" stroke="black" points="1101.5,-2445.12 1098,-2435.12 1094.5,-2445.12 1101.5,-2445.12"/>
</g>
<!-- layer_6_block&#45;&gt;pp_comm_6_7 -->
<g id="edge38" class="edge">
<title>layer_6_block&#45;&gt;pp_comm_6_7</title>
<path fill="none" stroke="black" d="M1098,-2254.9C1098,-2247.08 1098,-2238.14 1098,-2229.15"/>
<polygon fill="black" stroke="black" points="1101.5,-2229.02 1098,-2219.02 1094.5,-2229.02 1101.5,-2229.02"/>
</g>
<!-- layer_7_block&#45;&gt;pp_comm_7_8 -->
<g id="edge40" class="edge">
<title>layer_7_block&#45;&gt;pp_comm_7_8</title>
<path fill="none" stroke="black" d="M1098,-2038.8C1098,-2030.99 1098,-2022.05 1098,-2013.05"/>
<polygon fill="black" stroke="black" points="1101.5,-2012.93 1098,-2002.93 1094.5,-2012.93 1101.5,-2012.93"/>
</g>
<!-- layer_8_block&#45;&gt;pp_comm_8_9 -->
<g id="edge42" class="edge">
<title>layer_8_block&#45;&gt;pp_comm_8_9</title>
<path fill="none" stroke="black" d="M1098,-1822.7C1098,-1814.89 1098,-1805.95 1098,-1796.96"/>
<polygon fill="black" stroke="black" points="1101.5,-1796.83 1098,-1786.83 1094.5,-1796.83 1101.5,-1796.83"/>
</g>
<!-- layer_9_block&#45;&gt;pp_comm_9_10 -->
<g id="edge44" class="edge">
<title>layer_9_block&#45;&gt;pp_comm_9_10</title>
<path fill="none" stroke="black" d="M1098,-1606.61C1098,-1598.8 1098,-1589.86 1098,-1580.86"/>
<polygon fill="black" stroke="black" points="1101.5,-1580.73 1098,-1570.73 1094.5,-1580.73 1101.5,-1580.73"/>
</g>
<!-- layer_10_block&#45;&gt;pp_comm_10_11 -->
<g id="edge46" class="edge">
<title>layer_10_block&#45;&gt;pp_comm_10_11</title>
<path fill="none" stroke="black" d="M1098,-1390.51C1098,-1382.7 1098,-1373.76 1098,-1364.77"/>
<polygon fill="black" stroke="black" points="1101.5,-1364.64 1098,-1354.64 1094.5,-1364.64 1101.5,-1364.64"/>
</g>
<!-- layer_11_block&#45;&gt;pp_comm_11_12 -->
<g id="edge48" class="edge">
<title>layer_11_block&#45;&gt;pp_comm_11_12</title>
<path fill="none" stroke="black" d="M1098,-1174.42C1098,-1166.61 1098,-1157.67 1098,-1148.67"/>
<polygon fill="black" stroke="black" points="1101.5,-1148.54 1098,-1138.54 1094.5,-1148.54 1101.5,-1148.54"/>
</g>
<!-- layer_12_block&#45;&gt;pp_comm_12_13 -->
<g id="edge50" class="edge">
<title>layer_12_block&#45;&gt;pp_comm_12_13</title>
<path fill="none" stroke="black" d="M1098,-958.32C1098,-950.51 1098,-941.57 1098,-932.57"/>
<polygon fill="black" stroke="black" points="1101.5,-932.45 1098,-922.45 1094.5,-932.45 1101.5,-932.45"/>
</g>
<!-- layer_13_block&#45;&gt;pp_comm_13_14 -->
<g id="edge52" class="edge">
<title>layer_13_block&#45;&gt;pp_comm_13_14</title>
<path fill="none" stroke="black" d="M1098,-742.23C1098,-734.41 1098,-725.48 1098,-716.48"/>
<polygon fill="black" stroke="black" points="1101.5,-716.35 1098,-706.35 1094.5,-716.35 1101.5,-716.35"/>
</g>
<!-- layer_14_block&#45;&gt;pp_comm_14_15 -->
<g id="edge54" class="edge">
<title>layer_14_block&#45;&gt;pp_comm_14_15</title>
<path fill="none" stroke="black" d="M1098,-526.13C1098,-518.32 1098,-509.38 1098,-500.38"/>
<polygon fill="black" stroke="black" points="1101.5,-500.26 1098,-490.26 1094.5,-500.26 1101.5,-500.26"/>
</g>
<!-- layer_15_block&#45;&gt;pp_comm_15_16 -->
<g id="edge56" class="edge">
<title>layer_15_block&#45;&gt;pp_comm_15_16</title>
<path fill="none" stroke="black" d="M1098,-310.04C1098,-302.22 1098,-293.29 1098,-284.29"/>
<polygon fill="black" stroke="black" points="1101.5,-284.16 1098,-274.16 1094.5,-284.16 1101.5,-284.16"/>
</g>
<!-- layer_16_block&#45;&gt;output -->
<g id="edge58" class="edge">
<title>layer_16_block&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1098,-93.72C1098,-85.83 1098,-76.94 1098,-68.36"/>
<polygon fill="black" stroke="black" points="1101.5,-68.13 1098,-58.13 1094.5,-68.13 1101.5,-68.13"/>
</g>
<!-- dp_replicas -->
<g id="node52" class="node">
<title>dp_replicas</title>
<ellipse fill="lightcoral" stroke="black" cx="1100" cy="-4341.72" rx="86.03" ry="36.54"/>
<text text-anchor="middle" x="1100" y="-4355.72" font-family="Arial" font-size="10.00">Data Parallelism</text>
<text text-anchor="middle" x="1100" y="-4344.72" font-family="Arial" font-size="10.00">7 Additional Replicas</text>
<text text-anchor="middle" x="1100" y="-4333.72" font-family="Arial" font-size="10.00">GPU: 256&#45;2047</text>
<text text-anchor="middle" x="1100" y="-4322.72" font-family="Arial" font-size="10.00">Each replica: 256 GPUs</text>
</g>
</g>
</svg>
