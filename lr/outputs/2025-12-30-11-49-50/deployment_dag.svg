<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="179pt" height="2160pt"
 viewBox="0.00 0.00 178.91 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.15 0.15) rotate(0) translate(4 14531.84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-14531.84 1200,-14531.84 1200,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_dp1</title>
<path fill="lightgray" stroke="black" d="M20,-205.98C20,-205.98 582,-205.98 582,-205.98 588,-205.98 594,-211.98 594,-217.98 594,-217.98 594,-14283.86 594,-14283.86 594,-14289.86 588,-14295.86 582,-14295.86 582,-14295.86 20,-14295.86 20,-14295.86 14,-14295.86 8,-14289.86 8,-14283.86 8,-14283.86 8,-217.98 8,-217.98 8,-211.98 14,-205.98 20,-205.98"/>
<text text-anchor="middle" x="301" y="-14280.66" font-family="Times,serif" font-size="14.00">DP Replica 1: GPU0 + GPU1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_dp2</title>
<path fill="lightgray" stroke="black" d="M614,-205.98C614,-205.98 1176,-205.98 1176,-205.98 1182,-205.98 1188,-211.98 1188,-217.98 1188,-217.98 1188,-14283.86 1188,-14283.86 1188,-14289.86 1182,-14295.86 1176,-14295.86 1176,-14295.86 614,-14295.86 614,-14295.86 608,-14295.86 602,-14289.86 602,-14283.86 602,-14283.86 602,-217.98 602,-217.98 602,-211.98 608,-205.98 614,-205.98"/>
<text text-anchor="middle" x="895" y="-14280.66" font-family="Times,serif" font-size="14.00">DP Replica 2: GPU2 + GPU3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcoral" stroke="black" cx="598" cy="-14498.85" rx="202.47" ry="28.98"/>
<text text-anchor="middle" x="598" y="-14507.35" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="598" y="-14496.35" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="598" y="-14485.35" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightyellow" stroke="black" points="889.16,-14418.86 425.99,-14418.86 306.84,-14336.86 770.01,-14336.86 889.16,-14418.86"/>
<text text-anchor="middle" x="598" y="-14386.36" font-family="Arial" font-size="10.00">DP Split</text>
<text text-anchor="middle" x="598" y="-14375.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="598" y="-14364.36" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M598,-14469.65C598,-14457.6 598,-14443.16 598,-14429.38"/>
<polygon fill="black" stroke="black" points="601.5,-14429.02 598,-14419.02 594.5,-14429.02 601.5,-14429.02"/>
<text text-anchor="middle" x="651" y="-14440.66" font-family="Times,serif" font-size="14.00">Host to Device</text>
</g>
<!-- sp_split_1 -->
<g id="node3" class="node">
<title>sp_split_1</title>
<polygon fill="lightyellow" stroke="black" points="586.21,-14264.86 132.5,-14264.86 15.79,-14182.86 469.5,-14182.86 586.21,-14264.86"/>
<text text-anchor="middle" x="301" y="-14232.36" font-family="Arial" font-size="10.00">SP Split (Rep1)</text>
<text text-anchor="middle" x="301" y="-14221.36" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="301" y="-14210.36" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
</g>
<!-- dp_split&#45;&gt;sp_split_1 -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;sp_split_1</title>
<path fill="none" stroke="black" d="M519.58,-14336.72C479.23,-14316.08 429.93,-14290.84 388.36,-14269.57"/>
<polygon fill="black" stroke="black" points="389.84,-14266.4 379.35,-14264.96 386.65,-14272.63 389.84,-14266.4"/>
<text text-anchor="middle" x="509.5" y="-14307.66" font-family="Times,serif" font-size="14.00">Replica 1</text>
</g>
<!-- sp_split_2 -->
<g id="node245" class="node">
<title>sp_split_2</title>
<polygon fill="lightyellow" stroke="black" points="1180.21,-14264.86 726.5,-14264.86 609.79,-14182.86 1063.5,-14182.86 1180.21,-14264.86"/>
<text text-anchor="middle" x="895" y="-14232.36" font-family="Arial" font-size="10.00">SP Split (Rep2)</text>
<text text-anchor="middle" x="895" y="-14221.36" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="895" y="-14210.36" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
</g>
<!-- dp_split&#45;&gt;sp_split_2 -->
<g id="edge3" class="edge">
<title>dp_split&#45;&gt;sp_split_2</title>
<path fill="none" stroke="black" d="M676.42,-14336.72C716.77,-14316.08 766.07,-14290.84 807.64,-14269.57"/>
<polygon fill="black" stroke="black" points="809.35,-14272.63 816.65,-14264.96 806.16,-14266.4 809.35,-14272.63"/>
<text text-anchor="middle" x="770.5" y="-14307.66" font-family="Times,serif" font-size="14.00">Replica 2</text>
</g>
<!-- attn_qkv_1_l1 -->
<g id="node4" class="node">
<title>attn_qkv_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="292,-14145.86 22,-14145.86 22,-14093.86 292,-14093.86 292,-14145.86"/>
<text text-anchor="middle" x="157" y="-14133.86" font-family="Arial" font-size="10.00">Attention QKV (L1)</text>
<text text-anchor="middle" x="157" y="-14122.86" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-14111.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-14100.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_qkv_1_l1 -->
<g id="edge4" class="edge">
<title>sp_split_1&#45;&gt;attn_qkv_1_l1</title>
<path fill="none" stroke="black" d="M244.5,-14182.84C230.01,-14172.58 214.65,-14161.7 200.91,-14151.96"/>
<polygon fill="black" stroke="black" points="202.76,-14148.99 192.58,-14146.06 198.72,-14154.7 202.76,-14148.99"/>
</g>
<!-- attn_qkv_2_l1 -->
<g id="node5" class="node">
<title>attn_qkv_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="580,-14145.86 310,-14145.86 310,-14093.86 580,-14093.86 580,-14145.86"/>
<text text-anchor="middle" x="445" y="-14133.86" font-family="Arial" font-size="10.00">Attention QKV (L1)</text>
<text text-anchor="middle" x="445" y="-14122.86" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-14111.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-14100.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- sp_split_1&#45;&gt;attn_qkv_2_l1 -->
<g id="edge5" class="edge">
<title>sp_split_1&#45;&gt;attn_qkv_2_l1</title>
<path fill="none" stroke="black" d="M357.5,-14182.84C371.99,-14172.58 387.35,-14161.7 401.09,-14151.96"/>
<polygon fill="black" stroke="black" points="403.28,-14154.7 409.42,-14146.06 399.24,-14148.99 403.28,-14154.7"/>
</g>
<!-- tp_comm_attn_l1 -->
<g id="node6" class="node">
<title>tp_comm_attn_l1</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-14020.09" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-14034.09" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L1)</text>
<text text-anchor="middle" x="301" y="-14023.09" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-14012.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-14001.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l1&#45;&gt;tp_comm_attn_l1 -->
<g id="edge6" class="edge">
<title>attn_qkv_1_l1&#45;&gt;tp_comm_attn_l1</title>
<path fill="none" stroke="black" d="M194.08,-14093.68C208.63,-14083.8 225.69,-14072.22 241.85,-14061.25"/>
<polygon fill="black" stroke="black" points="243.9,-14064.09 250.2,-14055.58 239.96,-14058.3 243.9,-14064.09"/>
</g>
<!-- attn_qkv_2_l1&#45;&gt;tp_comm_attn_l1 -->
<g id="edge7" class="edge">
<title>attn_qkv_2_l1&#45;&gt;tp_comm_attn_l1</title>
<path fill="none" stroke="black" d="M407.92,-14093.68C393.37,-14083.8 376.31,-14072.22 360.15,-14061.25"/>
<polygon fill="black" stroke="black" points="362.04,-14058.3 351.8,-14055.58 358.1,-14064.09 362.04,-14058.3"/>
</g>
<!-- attn_out_1_l1 -->
<g id="node7" class="node">
<title>attn_out_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-13946.32 29.5,-13946.32 29.5,-13894.32 292.5,-13894.32 292.5,-13946.32"/>
<text text-anchor="middle" x="161" y="-13934.32" font-family="Arial" font-size="10.00">Attention Output (L1)</text>
<text text-anchor="middle" x="161" y="-13923.32" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-13912.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-13901.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l1&#45;&gt;attn_out_1_l1 -->
<g id="edge8" class="edge">
<title>tp_comm_attn_l1&#45;&gt;attn_out_1_l1</title>
<path fill="none" stroke="black" d="M251.25,-13984.35C236.27,-13973.88 219.93,-13962.48 205.33,-13952.28"/>
<polygon fill="black" stroke="black" points="207.16,-13949.29 196.96,-13946.43 203.15,-13955.03 207.16,-13949.29"/>
</g>
<!-- attn_out_2_l1 -->
<g id="node8" class="node">
<title>attn_out_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-13946.32 310.5,-13946.32 310.5,-13894.32 573.5,-13894.32 573.5,-13946.32"/>
<text text-anchor="middle" x="442" y="-13934.32" font-family="Arial" font-size="10.00">Attention Output (L1)</text>
<text text-anchor="middle" x="442" y="-13923.32" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-13912.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-13901.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l1&#45;&gt;attn_out_2_l1 -->
<g id="edge9" class="edge">
<title>tp_comm_attn_l1&#45;&gt;attn_out_2_l1</title>
<path fill="none" stroke="black" d="M351.11,-13984.35C366.19,-13973.88 382.64,-13962.48 397.35,-13952.28"/>
<polygon fill="black" stroke="black" points="399.56,-13955.01 405.79,-13946.43 395.57,-13949.25 399.56,-13955.01"/>
</g>
<!-- tp_comm_attn_out_l1 -->
<g id="node9" class="node">
<title>tp_comm_attn_out_l1</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-13820.55" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-13834.55" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L1)</text>
<text text-anchor="middle" x="301" y="-13823.55" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-13812.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-13801.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l1&#45;&gt;tp_comm_attn_out_l1 -->
<g id="edge10" class="edge">
<title>attn_out_1_l1&#45;&gt;tp_comm_attn_out_l1</title>
<path fill="none" stroke="black" d="M197.05,-13894.14C211.07,-13884.36 227.48,-13872.9 243.06,-13862.01"/>
<polygon fill="black" stroke="black" points="245.42,-13864.63 251.62,-13856.04 241.41,-13858.9 245.42,-13864.63"/>
</g>
<!-- attn_out_2_l1&#45;&gt;tp_comm_attn_out_l1 -->
<g id="edge11" class="edge">
<title>attn_out_2_l1&#45;&gt;tp_comm_attn_out_l1</title>
<path fill="none" stroke="black" d="M405.69,-13894.14C391.58,-13884.36 375.05,-13872.9 359.35,-13862.01"/>
<polygon fill="black" stroke="black" points="360.95,-13858.86 350.74,-13856.04 356.96,-13864.61 360.95,-13858.86"/>
</g>
<!-- ln1_1_l1 -->
<g id="node15" class="node">
<title>ln1_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-13746.78 31.5,-13746.78 31.5,-13694.78 292.5,-13694.78 292.5,-13746.78"/>
<text text-anchor="middle" x="162" y="-13734.78" font-family="Arial" font-size="10.00">LayerNorm1 (L1)</text>
<text text-anchor="middle" x="162" y="-13723.78" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-13712.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-13701.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l1&#45;&gt;ln1_1_l1 -->
<g id="edge12" class="edge">
<title>tp_comm_attn_out_l1&#45;&gt;ln1_1_l1</title>
<path fill="none" stroke="black" d="M251.99,-13785.08C237.1,-13774.6 220.82,-13763.15 206.25,-13752.91"/>
<polygon fill="black" stroke="black" points="208.09,-13749.92 197.9,-13747.03 204.07,-13755.65 208.09,-13749.92"/>
</g>
<!-- ln1_2_l1 -->
<g id="node16" class="node">
<title>ln1_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-13746.78 310.5,-13746.78 310.5,-13694.78 571.5,-13694.78 571.5,-13746.78"/>
<text text-anchor="middle" x="441" y="-13734.78" font-family="Arial" font-size="10.00">LayerNorm1 (L1)</text>
<text text-anchor="middle" x="441" y="-13723.78" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-13712.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-13701.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l1&#45;&gt;ln1_2_l1 -->
<g id="edge13" class="edge">
<title>tp_comm_attn_out_l1&#45;&gt;ln1_2_l1</title>
<path fill="none" stroke="black" d="M350.36,-13785.08C365.36,-13774.6 381.76,-13763.15 396.43,-13752.91"/>
<polygon fill="black" stroke="black" points="398.65,-13755.63 404.84,-13747.03 394.64,-13749.89 398.65,-13755.63"/>
</g>
<!-- mlp_fc1_1_l1 -->
<g id="node10" class="node">
<title>mlp_fc1_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="289,-13657.78 35,-13657.78 35,-13605.78 289,-13605.78 289,-13657.78"/>
<text text-anchor="middle" x="162" y="-13645.78" font-family="Arial" font-size="10.00">MLP FC1 (L1)</text>
<text text-anchor="middle" x="162" y="-13634.78" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-13623.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-13612.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l1 -->
<g id="node12" class="node">
<title>mlp_fc2_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-13568.78 31.5,-13568.78 31.5,-13516.78 292.5,-13516.78 292.5,-13568.78"/>
<text text-anchor="middle" x="162" y="-13556.78" font-family="Arial" font-size="10.00">MLP FC2 (L1)</text>
<text text-anchor="middle" x="162" y="-13545.78" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-13534.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-13523.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l1&#45;&gt;mlp_fc2_1_l1 -->
<g id="edge16" class="edge">
<title>mlp_fc1_1_l1&#45;&gt;mlp_fc2_1_l1</title>
<path fill="none" stroke="black" d="M162,-13605.62C162,-13597.32 162,-13587.94 162,-13579.03"/>
<polygon fill="black" stroke="black" points="165.5,-13578.89 162,-13568.89 158.5,-13578.89 165.5,-13578.89"/>
</g>
<!-- mlp_fc1_2_l1 -->
<g id="node11" class="node">
<title>mlp_fc1_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="568,-13657.78 314,-13657.78 314,-13605.78 568,-13605.78 568,-13657.78"/>
<text text-anchor="middle" x="441" y="-13645.78" font-family="Arial" font-size="10.00">MLP FC1 (L1)</text>
<text text-anchor="middle" x="441" y="-13634.78" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-13623.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-13612.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l1 -->
<g id="node13" class="node">
<title>mlp_fc2_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-13568.78 310.5,-13568.78 310.5,-13516.78 571.5,-13516.78 571.5,-13568.78"/>
<text text-anchor="middle" x="441" y="-13556.78" font-family="Arial" font-size="10.00">MLP FC2 (L1)</text>
<text text-anchor="middle" x="441" y="-13545.78" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-13534.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-13523.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l1&#45;&gt;mlp_fc2_2_l1 -->
<g id="edge17" class="edge">
<title>mlp_fc1_2_l1&#45;&gt;mlp_fc2_2_l1</title>
<path fill="none" stroke="black" d="M441,-13605.62C441,-13597.32 441,-13587.94 441,-13579.03"/>
<polygon fill="black" stroke="black" points="444.5,-13578.89 441,-13568.89 437.5,-13578.89 444.5,-13578.89"/>
</g>
<!-- tp_comm_mlp_l1 -->
<g id="node14" class="node">
<title>tp_comm_mlp_l1</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-13443.01" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-13457.01" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L1)</text>
<text text-anchor="middle" x="301" y="-13446.01" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-13435.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-13424.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l1&#45;&gt;tp_comm_mlp_l1 -->
<g id="edge18" class="edge">
<title>mlp_fc2_1_l1&#45;&gt;tp_comm_mlp_l1</title>
<path fill="none" stroke="black" d="M197.8,-13516.6C211.71,-13506.82 228,-13495.36 243.48,-13484.47"/>
<polygon fill="black" stroke="black" points="245.8,-13487.12 251.97,-13478.5 241.77,-13481.39 245.8,-13487.12"/>
</g>
<!-- mlp_fc2_2_l1&#45;&gt;tp_comm_mlp_l1 -->
<g id="edge19" class="edge">
<title>mlp_fc2_2_l1&#45;&gt;tp_comm_mlp_l1</title>
<path fill="none" stroke="black" d="M404.95,-13516.6C390.93,-13506.82 374.52,-13495.36 358.94,-13484.47"/>
<polygon fill="black" stroke="black" points="360.59,-13481.36 350.38,-13478.5 356.58,-13487.1 360.59,-13481.36"/>
</g>
<!-- ln2_1_l1 -->
<g id="node17" class="node">
<title>ln2_1_l1</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-13369.24 29.5,-13369.24 29.5,-13317.24 290.5,-13317.24 290.5,-13369.24"/>
<text text-anchor="middle" x="160" y="-13357.24" font-family="Arial" font-size="10.00">LayerNorm2 (L1)</text>
<text text-anchor="middle" x="160" y="-13346.24" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-13335.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-13324.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l1&#45;&gt;ln2_1_l1 -->
<g id="edge20" class="edge">
<title>tp_comm_mlp_l1&#45;&gt;ln2_1_l1</title>
<path fill="none" stroke="black" d="M251.29,-13407.54C236.18,-13397.06 219.67,-13385.62 204.89,-13375.37"/>
<polygon fill="black" stroke="black" points="206.63,-13372.32 196.42,-13369.49 202.64,-13378.07 206.63,-13372.32"/>
</g>
<!-- ln2_2_l1 -->
<g id="node18" class="node">
<title>ln2_2_l1</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-13369.24 312.5,-13369.24 312.5,-13317.24 573.5,-13317.24 573.5,-13369.24"/>
<text text-anchor="middle" x="443" y="-13357.24" font-family="Arial" font-size="10.00">LayerNorm2 (L1)</text>
<text text-anchor="middle" x="443" y="-13346.24" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-13335.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-13324.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l1&#45;&gt;ln2_2_l1 -->
<g id="edge21" class="edge">
<title>tp_comm_mlp_l1&#45;&gt;ln2_2_l1</title>
<path fill="none" stroke="black" d="M351.06,-13407.54C366.28,-13397.06 382.91,-13385.62 397.79,-13375.37"/>
<polygon fill="black" stroke="black" points="400.07,-13378.05 406.32,-13369.49 396.1,-13372.28 400.07,-13378.05"/>
</g>
<!-- ln1_1_l1&#45;&gt;mlp_fc1_1_l1 -->
<g id="edge14" class="edge">
<title>ln1_1_l1&#45;&gt;mlp_fc1_1_l1</title>
<path fill="none" stroke="black" d="M162,-13694.62C162,-13686.32 162,-13676.94 162,-13668.03"/>
<polygon fill="black" stroke="black" points="165.5,-13667.89 162,-13657.89 158.5,-13667.89 165.5,-13667.89"/>
</g>
<!-- ln1_2_l1&#45;&gt;mlp_fc1_2_l1 -->
<g id="edge15" class="edge">
<title>ln1_2_l1&#45;&gt;mlp_fc1_2_l1</title>
<path fill="none" stroke="black" d="M441,-13694.62C441,-13686.32 441,-13676.94 441,-13668.03"/>
<polygon fill="black" stroke="black" points="444.5,-13667.89 441,-13657.89 437.5,-13667.89 444.5,-13667.89"/>
</g>
<!-- attn_qkv_1_l2 -->
<g id="node19" class="node">
<title>attn_qkv_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="292,-13280.24 22,-13280.24 22,-13228.24 292,-13228.24 292,-13280.24"/>
<text text-anchor="middle" x="157" y="-13268.24" font-family="Arial" font-size="10.00">Attention QKV (L2)</text>
<text text-anchor="middle" x="157" y="-13257.24" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-13246.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-13235.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l1&#45;&gt;attn_qkv_1_l2 -->
<g id="edge22" class="edge">
<title>ln2_1_l1&#45;&gt;attn_qkv_1_l2</title>
<path fill="none" stroke="black" d="M159.13,-13317.08C158.85,-13308.78 158.52,-13299.4 158.22,-13290.49"/>
<polygon fill="black" stroke="black" points="161.71,-13290.22 157.87,-13280.35 154.71,-13290.46 161.71,-13290.22"/>
</g>
<!-- attn_qkv_2_l2 -->
<g id="node20" class="node">
<title>attn_qkv_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="580,-13280.24 310,-13280.24 310,-13228.24 580,-13228.24 580,-13280.24"/>
<text text-anchor="middle" x="445" y="-13268.24" font-family="Arial" font-size="10.00">Attention QKV (L2)</text>
<text text-anchor="middle" x="445" y="-13257.24" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-13246.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-13235.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l1&#45;&gt;attn_qkv_2_l2 -->
<g id="edge23" class="edge">
<title>ln2_2_l1&#45;&gt;attn_qkv_2_l2</title>
<path fill="none" stroke="black" d="M443.58,-13317.08C443.77,-13308.78 443.98,-13299.4 444.19,-13290.49"/>
<polygon fill="black" stroke="black" points="447.69,-13290.43 444.42,-13280.35 440.69,-13290.27 447.69,-13290.43"/>
</g>
<!-- tp_comm_attn_l2 -->
<g id="node21" class="node">
<title>tp_comm_attn_l2</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-13154.47" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-13168.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L2)</text>
<text text-anchor="middle" x="301" y="-13157.47" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-13146.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-13135.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l2&#45;&gt;tp_comm_attn_l2 -->
<g id="edge24" class="edge">
<title>attn_qkv_1_l2&#45;&gt;tp_comm_attn_l2</title>
<path fill="none" stroke="black" d="M194.08,-13228.06C208.63,-13218.19 225.69,-13206.61 241.85,-13195.63"/>
<polygon fill="black" stroke="black" points="243.9,-13198.47 250.2,-13189.96 239.96,-13192.68 243.9,-13198.47"/>
</g>
<!-- attn_qkv_2_l2&#45;&gt;tp_comm_attn_l2 -->
<g id="edge25" class="edge">
<title>attn_qkv_2_l2&#45;&gt;tp_comm_attn_l2</title>
<path fill="none" stroke="black" d="M407.92,-13228.06C393.37,-13218.19 376.31,-13206.61 360.15,-13195.63"/>
<polygon fill="black" stroke="black" points="362.04,-13192.68 351.8,-13189.96 358.1,-13198.47 362.04,-13192.68"/>
</g>
<!-- attn_out_1_l2 -->
<g id="node22" class="node">
<title>attn_out_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-13080.7 29.5,-13080.7 29.5,-13028.7 292.5,-13028.7 292.5,-13080.7"/>
<text text-anchor="middle" x="161" y="-13068.7" font-family="Arial" font-size="10.00">Attention Output (L2)</text>
<text text-anchor="middle" x="161" y="-13057.7" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-13046.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-13035.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l2&#45;&gt;attn_out_1_l2 -->
<g id="edge26" class="edge">
<title>tp_comm_attn_l2&#45;&gt;attn_out_1_l2</title>
<path fill="none" stroke="black" d="M251.25,-13118.73C236.27,-13108.27 219.93,-13096.86 205.33,-13086.66"/>
<polygon fill="black" stroke="black" points="207.16,-13083.67 196.96,-13080.81 203.15,-13089.41 207.16,-13083.67"/>
</g>
<!-- attn_out_2_l2 -->
<g id="node23" class="node">
<title>attn_out_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-13080.7 310.5,-13080.7 310.5,-13028.7 573.5,-13028.7 573.5,-13080.7"/>
<text text-anchor="middle" x="442" y="-13068.7" font-family="Arial" font-size="10.00">Attention Output (L2)</text>
<text text-anchor="middle" x="442" y="-13057.7" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-13046.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-13035.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l2&#45;&gt;attn_out_2_l2 -->
<g id="edge27" class="edge">
<title>tp_comm_attn_l2&#45;&gt;attn_out_2_l2</title>
<path fill="none" stroke="black" d="M351.11,-13118.73C366.19,-13108.27 382.64,-13096.86 397.35,-13086.66"/>
<polygon fill="black" stroke="black" points="399.56,-13089.39 405.79,-13080.81 395.57,-13083.64 399.56,-13089.39"/>
</g>
<!-- tp_comm_attn_out_l2 -->
<g id="node24" class="node">
<title>tp_comm_attn_out_l2</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-12954.93" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-12968.93" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L2)</text>
<text text-anchor="middle" x="301" y="-12957.93" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-12946.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-12935.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l2&#45;&gt;tp_comm_attn_out_l2 -->
<g id="edge28" class="edge">
<title>attn_out_1_l2&#45;&gt;tp_comm_attn_out_l2</title>
<path fill="none" stroke="black" d="M197.05,-13028.53C211.07,-13018.74 227.48,-13007.28 243.06,-12996.4"/>
<polygon fill="black" stroke="black" points="245.42,-12999.02 251.62,-12990.42 241.41,-12993.28 245.42,-12999.02"/>
</g>
<!-- attn_out_2_l2&#45;&gt;tp_comm_attn_out_l2 -->
<g id="edge29" class="edge">
<title>attn_out_2_l2&#45;&gt;tp_comm_attn_out_l2</title>
<path fill="none" stroke="black" d="M405.69,-13028.53C391.58,-13018.74 375.05,-13007.28 359.35,-12996.4"/>
<polygon fill="black" stroke="black" points="360.95,-12993.24 350.74,-12990.42 356.96,-12999 360.95,-12993.24"/>
</g>
<!-- ln1_1_l2 -->
<g id="node30" class="node">
<title>ln1_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-12881.16 31.5,-12881.16 31.5,-12829.16 292.5,-12829.16 292.5,-12881.16"/>
<text text-anchor="middle" x="162" y="-12869.16" font-family="Arial" font-size="10.00">LayerNorm1 (L2)</text>
<text text-anchor="middle" x="162" y="-12858.16" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-12847.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-12836.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l2&#45;&gt;ln1_1_l2 -->
<g id="edge30" class="edge">
<title>tp_comm_attn_out_l2&#45;&gt;ln1_1_l2</title>
<path fill="none" stroke="black" d="M251.99,-12919.46C237.1,-12908.99 220.82,-12897.54 206.25,-12887.29"/>
<polygon fill="black" stroke="black" points="208.09,-12884.31 197.9,-12881.42 204.07,-12890.03 208.09,-12884.31"/>
</g>
<!-- ln1_2_l2 -->
<g id="node31" class="node">
<title>ln1_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-12881.16 310.5,-12881.16 310.5,-12829.16 571.5,-12829.16 571.5,-12881.16"/>
<text text-anchor="middle" x="441" y="-12869.16" font-family="Arial" font-size="10.00">LayerNorm1 (L2)</text>
<text text-anchor="middle" x="441" y="-12858.16" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-12847.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-12836.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l2&#45;&gt;ln1_2_l2 -->
<g id="edge31" class="edge">
<title>tp_comm_attn_out_l2&#45;&gt;ln1_2_l2</title>
<path fill="none" stroke="black" d="M350.36,-12919.46C365.36,-12908.99 381.76,-12897.54 396.43,-12887.29"/>
<polygon fill="black" stroke="black" points="398.65,-12890.01 404.84,-12881.42 394.64,-12884.27 398.65,-12890.01"/>
</g>
<!-- mlp_fc1_1_l2 -->
<g id="node25" class="node">
<title>mlp_fc1_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="289,-12792.16 35,-12792.16 35,-12740.16 289,-12740.16 289,-12792.16"/>
<text text-anchor="middle" x="162" y="-12780.16" font-family="Arial" font-size="10.00">MLP FC1 (L2)</text>
<text text-anchor="middle" x="162" y="-12769.16" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-12758.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-12747.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l2 -->
<g id="node27" class="node">
<title>mlp_fc2_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-12703.16 31.5,-12703.16 31.5,-12651.16 292.5,-12651.16 292.5,-12703.16"/>
<text text-anchor="middle" x="162" y="-12691.16" font-family="Arial" font-size="10.00">MLP FC2 (L2)</text>
<text text-anchor="middle" x="162" y="-12680.16" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-12669.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-12658.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l2&#45;&gt;mlp_fc2_1_l2 -->
<g id="edge34" class="edge">
<title>mlp_fc1_1_l2&#45;&gt;mlp_fc2_1_l2</title>
<path fill="none" stroke="black" d="M162,-12740C162,-12731.7 162,-12722.32 162,-12713.41"/>
<polygon fill="black" stroke="black" points="165.5,-12713.27 162,-12703.27 158.5,-12713.27 165.5,-12713.27"/>
</g>
<!-- mlp_fc1_2_l2 -->
<g id="node26" class="node">
<title>mlp_fc1_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="568,-12792.16 314,-12792.16 314,-12740.16 568,-12740.16 568,-12792.16"/>
<text text-anchor="middle" x="441" y="-12780.16" font-family="Arial" font-size="10.00">MLP FC1 (L2)</text>
<text text-anchor="middle" x="441" y="-12769.16" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-12758.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-12747.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l2 -->
<g id="node28" class="node">
<title>mlp_fc2_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-12703.16 310.5,-12703.16 310.5,-12651.16 571.5,-12651.16 571.5,-12703.16"/>
<text text-anchor="middle" x="441" y="-12691.16" font-family="Arial" font-size="10.00">MLP FC2 (L2)</text>
<text text-anchor="middle" x="441" y="-12680.16" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-12669.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-12658.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l2&#45;&gt;mlp_fc2_2_l2 -->
<g id="edge35" class="edge">
<title>mlp_fc1_2_l2&#45;&gt;mlp_fc2_2_l2</title>
<path fill="none" stroke="black" d="M441,-12740C441,-12731.7 441,-12722.32 441,-12713.41"/>
<polygon fill="black" stroke="black" points="444.5,-12713.27 441,-12703.27 437.5,-12713.27 444.5,-12713.27"/>
</g>
<!-- tp_comm_mlp_l2 -->
<g id="node29" class="node">
<title>tp_comm_mlp_l2</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-12577.39" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-12591.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L2)</text>
<text text-anchor="middle" x="301" y="-12580.39" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-12569.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-12558.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l2&#45;&gt;tp_comm_mlp_l2 -->
<g id="edge36" class="edge">
<title>mlp_fc2_1_l2&#45;&gt;tp_comm_mlp_l2</title>
<path fill="none" stroke="black" d="M197.8,-12650.99C211.71,-12641.2 228,-12629.74 243.48,-12618.86"/>
<polygon fill="black" stroke="black" points="245.8,-12621.5 251.97,-12612.88 241.77,-12615.77 245.8,-12621.5"/>
</g>
<!-- mlp_fc2_2_l2&#45;&gt;tp_comm_mlp_l2 -->
<g id="edge37" class="edge">
<title>mlp_fc2_2_l2&#45;&gt;tp_comm_mlp_l2</title>
<path fill="none" stroke="black" d="M404.95,-12650.99C390.93,-12641.2 374.52,-12629.74 358.94,-12618.86"/>
<polygon fill="black" stroke="black" points="360.59,-12615.74 350.38,-12612.88 356.58,-12621.48 360.59,-12615.74"/>
</g>
<!-- ln2_1_l2 -->
<g id="node32" class="node">
<title>ln2_1_l2</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-12503.63 29.5,-12503.63 29.5,-12451.63 290.5,-12451.63 290.5,-12503.63"/>
<text text-anchor="middle" x="160" y="-12491.63" font-family="Arial" font-size="10.00">LayerNorm2 (L2)</text>
<text text-anchor="middle" x="160" y="-12480.63" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-12469.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-12458.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l2&#45;&gt;ln2_1_l2 -->
<g id="edge38" class="edge">
<title>tp_comm_mlp_l2&#45;&gt;ln2_1_l2</title>
<path fill="none" stroke="black" d="M251.29,-12541.92C236.18,-12531.45 219.67,-12520 204.89,-12509.75"/>
<polygon fill="black" stroke="black" points="206.63,-12506.7 196.42,-12503.88 202.64,-12512.45 206.63,-12506.7"/>
</g>
<!-- ln2_2_l2 -->
<g id="node33" class="node">
<title>ln2_2_l2</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-12503.63 312.5,-12503.63 312.5,-12451.63 573.5,-12451.63 573.5,-12503.63"/>
<text text-anchor="middle" x="443" y="-12491.63" font-family="Arial" font-size="10.00">LayerNorm2 (L2)</text>
<text text-anchor="middle" x="443" y="-12480.63" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-12469.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-12458.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l2&#45;&gt;ln2_2_l2 -->
<g id="edge39" class="edge">
<title>tp_comm_mlp_l2&#45;&gt;ln2_2_l2</title>
<path fill="none" stroke="black" d="M351.06,-12541.92C366.28,-12531.45 382.91,-12520 397.79,-12509.75"/>
<polygon fill="black" stroke="black" points="400.07,-12512.43 406.32,-12503.88 396.1,-12506.66 400.07,-12512.43"/>
</g>
<!-- ln1_1_l2&#45;&gt;mlp_fc1_1_l2 -->
<g id="edge32" class="edge">
<title>ln1_1_l2&#45;&gt;mlp_fc1_1_l2</title>
<path fill="none" stroke="black" d="M162,-12829C162,-12820.7 162,-12811.32 162,-12802.41"/>
<polygon fill="black" stroke="black" points="165.5,-12802.27 162,-12792.27 158.5,-12802.27 165.5,-12802.27"/>
</g>
<!-- ln1_2_l2&#45;&gt;mlp_fc1_2_l2 -->
<g id="edge33" class="edge">
<title>ln1_2_l2&#45;&gt;mlp_fc1_2_l2</title>
<path fill="none" stroke="black" d="M441,-12829C441,-12820.7 441,-12811.32 441,-12802.41"/>
<polygon fill="black" stroke="black" points="444.5,-12802.27 441,-12792.27 437.5,-12802.27 444.5,-12802.27"/>
</g>
<!-- attn_qkv_1_l3 -->
<g id="node34" class="node">
<title>attn_qkv_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="292,-12414.63 22,-12414.63 22,-12362.63 292,-12362.63 292,-12414.63"/>
<text text-anchor="middle" x="157" y="-12402.63" font-family="Arial" font-size="10.00">Attention QKV (L3)</text>
<text text-anchor="middle" x="157" y="-12391.63" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-12380.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-12369.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l2&#45;&gt;attn_qkv_1_l3 -->
<g id="edge40" class="edge">
<title>ln2_1_l2&#45;&gt;attn_qkv_1_l3</title>
<path fill="none" stroke="black" d="M159.13,-12451.46C158.85,-12443.17 158.52,-12433.78 158.22,-12424.87"/>
<polygon fill="black" stroke="black" points="161.71,-12424.61 157.87,-12414.73 154.71,-12424.85 161.71,-12424.61"/>
</g>
<!-- attn_qkv_2_l3 -->
<g id="node35" class="node">
<title>attn_qkv_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="580,-12414.63 310,-12414.63 310,-12362.63 580,-12362.63 580,-12414.63"/>
<text text-anchor="middle" x="445" y="-12402.63" font-family="Arial" font-size="10.00">Attention QKV (L3)</text>
<text text-anchor="middle" x="445" y="-12391.63" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-12380.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-12369.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l2&#45;&gt;attn_qkv_2_l3 -->
<g id="edge41" class="edge">
<title>ln2_2_l2&#45;&gt;attn_qkv_2_l3</title>
<path fill="none" stroke="black" d="M443.58,-12451.46C443.77,-12443.17 443.98,-12433.78 444.19,-12424.87"/>
<polygon fill="black" stroke="black" points="447.69,-12424.81 444.42,-12414.73 440.69,-12424.65 447.69,-12424.81"/>
</g>
<!-- tp_comm_attn_l3 -->
<g id="node36" class="node">
<title>tp_comm_attn_l3</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-12288.86" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-12302.86" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L3)</text>
<text text-anchor="middle" x="301" y="-12291.86" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-12280.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-12269.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l3&#45;&gt;tp_comm_attn_l3 -->
<g id="edge42" class="edge">
<title>attn_qkv_1_l3&#45;&gt;tp_comm_attn_l3</title>
<path fill="none" stroke="black" d="M194.08,-12362.45C208.63,-12352.57 225.69,-12340.99 241.85,-12330.02"/>
<polygon fill="black" stroke="black" points="243.9,-12332.86 250.2,-12324.34 239.96,-12327.07 243.9,-12332.86"/>
</g>
<!-- attn_qkv_2_l3&#45;&gt;tp_comm_attn_l3 -->
<g id="edge43" class="edge">
<title>attn_qkv_2_l3&#45;&gt;tp_comm_attn_l3</title>
<path fill="none" stroke="black" d="M407.92,-12362.45C393.37,-12352.57 376.31,-12340.99 360.15,-12330.02"/>
<polygon fill="black" stroke="black" points="362.04,-12327.07 351.8,-12324.34 358.1,-12332.86 362.04,-12327.07"/>
</g>
<!-- attn_out_1_l3 -->
<g id="node37" class="node">
<title>attn_out_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-12215.09 28.5,-12215.09 28.5,-12163.09 291.5,-12163.09 291.5,-12215.09"/>
<text text-anchor="middle" x="160" y="-12203.09" font-family="Arial" font-size="10.00">Attention Output (L3)</text>
<text text-anchor="middle" x="160" y="-12192.09" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-12181.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="160" y="-12170.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l3&#45;&gt;attn_out_1_l3 -->
<g id="edge44" class="edge">
<title>tp_comm_attn_l3&#45;&gt;attn_out_1_l3</title>
<path fill="none" stroke="black" d="M250.89,-12253.11C235.81,-12242.65 219.36,-12231.24 204.65,-12221.05"/>
<polygon fill="black" stroke="black" points="206.43,-12218.02 196.21,-12215.2 202.44,-12223.77 206.43,-12218.02"/>
</g>
<!-- attn_out_2_l3 -->
<g id="node38" class="node">
<title>attn_out_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="572.5,-12215.09 309.5,-12215.09 309.5,-12163.09 572.5,-12163.09 572.5,-12215.09"/>
<text text-anchor="middle" x="441" y="-12203.09" font-family="Arial" font-size="10.00">Attention Output (L3)</text>
<text text-anchor="middle" x="441" y="-12192.09" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-12181.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="441" y="-12170.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l3&#45;&gt;attn_out_2_l3 -->
<g id="edge45" class="edge">
<title>tp_comm_attn_l3&#45;&gt;attn_out_2_l3</title>
<path fill="none" stroke="black" d="M350.75,-12253.11C365.73,-12242.65 382.07,-12231.24 396.67,-12221.05"/>
<polygon fill="black" stroke="black" points="398.85,-12223.79 405.04,-12215.2 394.84,-12218.05 398.85,-12223.79"/>
</g>
<!-- tp_comm_attn_out_l3 -->
<g id="node39" class="node">
<title>tp_comm_attn_out_l3</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-12089.32" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-12103.32" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L3)</text>
<text text-anchor="middle" x="301" y="-12092.32" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-12081.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-12070.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l3&#45;&gt;tp_comm_attn_out_l3 -->
<g id="edge46" class="edge">
<title>attn_out_1_l3&#45;&gt;tp_comm_attn_out_l3</title>
<path fill="none" stroke="black" d="M196.31,-12162.91C210.42,-12153.12 226.95,-12141.66 242.65,-12130.78"/>
<polygon fill="black" stroke="black" points="245.04,-12133.38 251.26,-12124.8 241.05,-12127.63 245.04,-12133.38"/>
</g>
<!-- attn_out_2_l3&#45;&gt;tp_comm_attn_out_l3 -->
<g id="edge47" class="edge">
<title>attn_out_2_l3&#45;&gt;tp_comm_attn_out_l3</title>
<path fill="none" stroke="black" d="M404.95,-12162.91C390.93,-12153.12 374.52,-12141.66 358.94,-12130.78"/>
<polygon fill="black" stroke="black" points="360.59,-12127.66 350.38,-12124.8 356.58,-12133.4 360.59,-12127.66"/>
</g>
<!-- ln1_1_l3 -->
<g id="node45" class="node">
<title>ln1_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-12015.55 31.5,-12015.55 31.5,-11963.55 292.5,-11963.55 292.5,-12015.55"/>
<text text-anchor="middle" x="162" y="-12003.55" font-family="Arial" font-size="10.00">LayerNorm1 (L3)</text>
<text text-anchor="middle" x="162" y="-11992.55" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-11981.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-11970.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l3&#45;&gt;ln1_1_l3 -->
<g id="edge48" class="edge">
<title>tp_comm_attn_out_l3&#45;&gt;ln1_1_l3</title>
<path fill="none" stroke="black" d="M251.99,-12053.85C237.1,-12043.37 220.82,-12031.92 206.25,-12021.67"/>
<polygon fill="black" stroke="black" points="208.09,-12018.69 197.9,-12015.8 204.07,-12024.41 208.09,-12018.69"/>
</g>
<!-- ln1_2_l3 -->
<g id="node46" class="node">
<title>ln1_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-12015.55 310.5,-12015.55 310.5,-11963.55 571.5,-11963.55 571.5,-12015.55"/>
<text text-anchor="middle" x="441" y="-12003.55" font-family="Arial" font-size="10.00">LayerNorm1 (L3)</text>
<text text-anchor="middle" x="441" y="-11992.55" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-11981.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-11970.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l3&#45;&gt;ln1_2_l3 -->
<g id="edge49" class="edge">
<title>tp_comm_attn_out_l3&#45;&gt;ln1_2_l3</title>
<path fill="none" stroke="black" d="M350.36,-12053.85C365.36,-12043.37 381.76,-12031.92 396.43,-12021.67"/>
<polygon fill="black" stroke="black" points="398.65,-12024.39 404.84,-12015.8 394.64,-12018.65 398.65,-12024.39"/>
</g>
<!-- mlp_fc1_1_l3 -->
<g id="node40" class="node">
<title>mlp_fc1_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="289,-11926.55 35,-11926.55 35,-11874.55 289,-11874.55 289,-11926.55"/>
<text text-anchor="middle" x="162" y="-11914.55" font-family="Arial" font-size="10.00">MLP FC1 (L3)</text>
<text text-anchor="middle" x="162" y="-11903.55" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-11892.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-11881.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l3 -->
<g id="node42" class="node">
<title>mlp_fc2_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-11837.55 31.5,-11837.55 31.5,-11785.55 292.5,-11785.55 292.5,-11837.55"/>
<text text-anchor="middle" x="162" y="-11825.55" font-family="Arial" font-size="10.00">MLP FC2 (L3)</text>
<text text-anchor="middle" x="162" y="-11814.55" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-11803.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-11792.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l3&#45;&gt;mlp_fc2_1_l3 -->
<g id="edge52" class="edge">
<title>mlp_fc1_1_l3&#45;&gt;mlp_fc2_1_l3</title>
<path fill="none" stroke="black" d="M162,-11874.38C162,-11866.09 162,-11856.7 162,-11847.8"/>
<polygon fill="black" stroke="black" points="165.5,-11847.65 162,-11837.65 158.5,-11847.65 165.5,-11847.65"/>
</g>
<!-- mlp_fc1_2_l3 -->
<g id="node41" class="node">
<title>mlp_fc1_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="568,-11926.55 314,-11926.55 314,-11874.55 568,-11874.55 568,-11926.55"/>
<text text-anchor="middle" x="441" y="-11914.55" font-family="Arial" font-size="10.00">MLP FC1 (L3)</text>
<text text-anchor="middle" x="441" y="-11903.55" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-11892.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-11881.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l3 -->
<g id="node43" class="node">
<title>mlp_fc2_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-11837.55 310.5,-11837.55 310.5,-11785.55 571.5,-11785.55 571.5,-11837.55"/>
<text text-anchor="middle" x="441" y="-11825.55" font-family="Arial" font-size="10.00">MLP FC2 (L3)</text>
<text text-anchor="middle" x="441" y="-11814.55" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-11803.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-11792.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l3&#45;&gt;mlp_fc2_2_l3 -->
<g id="edge53" class="edge">
<title>mlp_fc1_2_l3&#45;&gt;mlp_fc2_2_l3</title>
<path fill="none" stroke="black" d="M441,-11874.38C441,-11866.09 441,-11856.7 441,-11847.8"/>
<polygon fill="black" stroke="black" points="444.5,-11847.65 441,-11837.65 437.5,-11847.65 444.5,-11847.65"/>
</g>
<!-- tp_comm_mlp_l3 -->
<g id="node44" class="node">
<title>tp_comm_mlp_l3</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-11711.78" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-11725.78" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L3)</text>
<text text-anchor="middle" x="301" y="-11714.78" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-11703.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-11692.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l3&#45;&gt;tp_comm_mlp_l3 -->
<g id="edge54" class="edge">
<title>mlp_fc2_1_l3&#45;&gt;tp_comm_mlp_l3</title>
<path fill="none" stroke="black" d="M197.8,-11785.37C211.71,-11775.58 228,-11764.12 243.48,-11753.24"/>
<polygon fill="black" stroke="black" points="245.8,-11755.88 251.97,-11747.27 241.77,-11750.16 245.8,-11755.88"/>
</g>
<!-- mlp_fc2_2_l3&#45;&gt;tp_comm_mlp_l3 -->
<g id="edge55" class="edge">
<title>mlp_fc2_2_l3&#45;&gt;tp_comm_mlp_l3</title>
<path fill="none" stroke="black" d="M404.95,-11785.37C390.93,-11775.58 374.52,-11764.12 358.94,-11753.24"/>
<polygon fill="black" stroke="black" points="360.59,-11750.12 350.38,-11747.27 356.58,-11755.86 360.59,-11750.12"/>
</g>
<!-- ln2_1_l3 -->
<g id="node47" class="node">
<title>ln2_1_l3</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-11638.01 29.5,-11638.01 29.5,-11586.01 290.5,-11586.01 290.5,-11638.01"/>
<text text-anchor="middle" x="160" y="-11626.01" font-family="Arial" font-size="10.00">LayerNorm2 (L3)</text>
<text text-anchor="middle" x="160" y="-11615.01" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-11604.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-11593.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l3&#45;&gt;ln2_1_l3 -->
<g id="edge56" class="edge">
<title>tp_comm_mlp_l3&#45;&gt;ln2_1_l3</title>
<path fill="none" stroke="black" d="M251.29,-11676.31C236.18,-11665.83 219.67,-11654.38 204.89,-11644.14"/>
<polygon fill="black" stroke="black" points="206.63,-11641.08 196.42,-11638.26 202.64,-11646.83 206.63,-11641.08"/>
</g>
<!-- ln2_2_l3 -->
<g id="node48" class="node">
<title>ln2_2_l3</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-11638.01 312.5,-11638.01 312.5,-11586.01 573.5,-11586.01 573.5,-11638.01"/>
<text text-anchor="middle" x="443" y="-11626.01" font-family="Arial" font-size="10.00">LayerNorm2 (L3)</text>
<text text-anchor="middle" x="443" y="-11615.01" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-11604.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-11593.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l3&#45;&gt;ln2_2_l3 -->
<g id="edge57" class="edge">
<title>tp_comm_mlp_l3&#45;&gt;ln2_2_l3</title>
<path fill="none" stroke="black" d="M351.06,-11676.31C366.28,-11665.83 382.91,-11654.38 397.79,-11644.14"/>
<polygon fill="black" stroke="black" points="400.07,-11646.81 406.32,-11638.26 396.1,-11641.05 400.07,-11646.81"/>
</g>
<!-- ln1_1_l3&#45;&gt;mlp_fc1_1_l3 -->
<g id="edge50" class="edge">
<title>ln1_1_l3&#45;&gt;mlp_fc1_1_l3</title>
<path fill="none" stroke="black" d="M162,-11963.38C162,-11955.09 162,-11945.7 162,-11936.8"/>
<polygon fill="black" stroke="black" points="165.5,-11936.65 162,-11926.65 158.5,-11936.65 165.5,-11936.65"/>
</g>
<!-- ln1_2_l3&#45;&gt;mlp_fc1_2_l3 -->
<g id="edge51" class="edge">
<title>ln1_2_l3&#45;&gt;mlp_fc1_2_l3</title>
<path fill="none" stroke="black" d="M441,-11963.38C441,-11955.09 441,-11945.7 441,-11936.8"/>
<polygon fill="black" stroke="black" points="444.5,-11936.65 441,-11926.65 437.5,-11936.65 444.5,-11936.65"/>
</g>
<!-- attn_qkv_1_l4 -->
<g id="node49" class="node">
<title>attn_qkv_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="292,-11549.01 22,-11549.01 22,-11497.01 292,-11497.01 292,-11549.01"/>
<text text-anchor="middle" x="157" y="-11537.01" font-family="Arial" font-size="10.00">Attention QKV (L4)</text>
<text text-anchor="middle" x="157" y="-11526.01" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-11515.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-11504.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l3&#45;&gt;attn_qkv_1_l4 -->
<g id="edge58" class="edge">
<title>ln2_1_l3&#45;&gt;attn_qkv_1_l4</title>
<path fill="none" stroke="black" d="M159.13,-11585.84C158.85,-11577.55 158.52,-11568.16 158.22,-11559.26"/>
<polygon fill="black" stroke="black" points="161.71,-11558.99 157.87,-11549.12 154.71,-11559.23 161.71,-11558.99"/>
</g>
<!-- attn_qkv_2_l4 -->
<g id="node50" class="node">
<title>attn_qkv_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="580,-11549.01 310,-11549.01 310,-11497.01 580,-11497.01 580,-11549.01"/>
<text text-anchor="middle" x="445" y="-11537.01" font-family="Arial" font-size="10.00">Attention QKV (L4)</text>
<text text-anchor="middle" x="445" y="-11526.01" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-11515.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-11504.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l3&#45;&gt;attn_qkv_2_l4 -->
<g id="edge59" class="edge">
<title>ln2_2_l3&#45;&gt;attn_qkv_2_l4</title>
<path fill="none" stroke="black" d="M443.58,-11585.84C443.77,-11577.55 443.98,-11568.16 444.19,-11559.26"/>
<polygon fill="black" stroke="black" points="447.69,-11559.19 444.42,-11549.12 440.69,-11559.03 447.69,-11559.19"/>
</g>
<!-- tp_comm_attn_l4 -->
<g id="node51" class="node">
<title>tp_comm_attn_l4</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-11423.24" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-11437.24" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L4)</text>
<text text-anchor="middle" x="301" y="-11426.24" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-11415.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-11404.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l4&#45;&gt;tp_comm_attn_l4 -->
<g id="edge60" class="edge">
<title>attn_qkv_1_l4&#45;&gt;tp_comm_attn_l4</title>
<path fill="none" stroke="black" d="M194.08,-11496.83C208.63,-11486.95 225.69,-11475.37 241.85,-11464.4"/>
<polygon fill="black" stroke="black" points="243.9,-11467.24 250.2,-11458.73 239.96,-11461.45 243.9,-11467.24"/>
</g>
<!-- attn_qkv_2_l4&#45;&gt;tp_comm_attn_l4 -->
<g id="edge61" class="edge">
<title>attn_qkv_2_l4&#45;&gt;tp_comm_attn_l4</title>
<path fill="none" stroke="black" d="M407.92,-11496.83C393.37,-11486.95 376.31,-11475.37 360.15,-11464.4"/>
<polygon fill="black" stroke="black" points="362.04,-11461.45 351.8,-11458.73 358.1,-11467.24 362.04,-11461.45"/>
</g>
<!-- attn_out_1_l4 -->
<g id="node52" class="node">
<title>attn_out_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-11349.47 29.5,-11349.47 29.5,-11297.47 292.5,-11297.47 292.5,-11349.47"/>
<text text-anchor="middle" x="161" y="-11337.47" font-family="Arial" font-size="10.00">Attention Output (L4)</text>
<text text-anchor="middle" x="161" y="-11326.47" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-11315.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-11304.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l4&#45;&gt;attn_out_1_l4 -->
<g id="edge62" class="edge">
<title>tp_comm_attn_l4&#45;&gt;attn_out_1_l4</title>
<path fill="none" stroke="black" d="M251.25,-11387.49C236.27,-11377.03 219.93,-11365.63 205.33,-11355.43"/>
<polygon fill="black" stroke="black" points="207.16,-11352.44 196.96,-11349.58 203.15,-11358.17 207.16,-11352.44"/>
</g>
<!-- attn_out_2_l4 -->
<g id="node53" class="node">
<title>attn_out_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-11349.47 310.5,-11349.47 310.5,-11297.47 573.5,-11297.47 573.5,-11349.47"/>
<text text-anchor="middle" x="442" y="-11337.47" font-family="Arial" font-size="10.00">Attention Output (L4)</text>
<text text-anchor="middle" x="442" y="-11326.47" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-11315.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-11304.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l4&#45;&gt;attn_out_2_l4 -->
<g id="edge63" class="edge">
<title>tp_comm_attn_l4&#45;&gt;attn_out_2_l4</title>
<path fill="none" stroke="black" d="M351.11,-11387.49C366.19,-11377.03 382.64,-11365.63 397.35,-11355.43"/>
<polygon fill="black" stroke="black" points="399.56,-11358.15 405.79,-11349.58 395.57,-11352.4 399.56,-11358.15"/>
</g>
<!-- tp_comm_attn_out_l4 -->
<g id="node54" class="node">
<title>tp_comm_attn_out_l4</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-11223.7" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-11237.7" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L4)</text>
<text text-anchor="middle" x="301" y="-11226.7" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-11215.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-11204.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l4&#45;&gt;tp_comm_attn_out_l4 -->
<g id="edge64" class="edge">
<title>attn_out_1_l4&#45;&gt;tp_comm_attn_out_l4</title>
<path fill="none" stroke="black" d="M197.05,-11297.29C211.07,-11287.5 227.48,-11276.05 243.06,-11265.16"/>
<polygon fill="black" stroke="black" points="245.42,-11267.78 251.62,-11259.19 241.41,-11262.04 245.42,-11267.78"/>
</g>
<!-- attn_out_2_l4&#45;&gt;tp_comm_attn_out_l4 -->
<g id="edge65" class="edge">
<title>attn_out_2_l4&#45;&gt;tp_comm_attn_out_l4</title>
<path fill="none" stroke="black" d="M405.69,-11297.29C391.58,-11287.5 375.05,-11276.05 359.35,-11265.16"/>
<polygon fill="black" stroke="black" points="360.95,-11262.01 350.74,-11259.19 356.96,-11267.76 360.95,-11262.01"/>
</g>
<!-- ln1_1_l4 -->
<g id="node60" class="node">
<title>ln1_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-11149.93 16.5,-11149.93 16.5,-11097.93 277.5,-11097.93 277.5,-11149.93"/>
<text text-anchor="middle" x="147" y="-11137.93" font-family="Arial" font-size="10.00">LayerNorm1 (L4)</text>
<text text-anchor="middle" x="147" y="-11126.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-11115.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="147" y="-11104.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l4&#45;&gt;ln1_1_l4 -->
<g id="edge66" class="edge">
<title>tp_comm_attn_out_l4&#45;&gt;ln1_1_l4</title>
<path fill="none" stroke="black" d="M247.14,-11188.5C230.15,-11177.72 211.51,-11165.88 194.96,-11155.38"/>
<polygon fill="black" stroke="black" points="196.83,-11152.42 186.52,-11150.02 193.08,-11158.33 196.83,-11152.42"/>
</g>
<!-- ln1_2_l4 -->
<g id="node61" class="node">
<title>ln1_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-11149.93 295.5,-11149.93 295.5,-11097.93 556.5,-11097.93 556.5,-11149.93"/>
<text text-anchor="middle" x="426" y="-11137.93" font-family="Arial" font-size="10.00">LayerNorm1 (L4)</text>
<text text-anchor="middle" x="426" y="-11126.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-11115.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="426" y="-11104.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l4&#45;&gt;ln1_2_l4 -->
<g id="edge67" class="edge">
<title>tp_comm_attn_out_l4&#45;&gt;ln1_2_l4</title>
<path fill="none" stroke="black" d="M345.42,-11187.95C358.55,-11177.69 372.84,-11166.51 385.69,-11156.46"/>
<polygon fill="black" stroke="black" points="388.18,-11158.96 393.9,-11150.04 383.86,-11153.44 388.18,-11158.96"/>
</g>
<!-- mlp_fc1_1_l4 -->
<g id="node55" class="node">
<title>mlp_fc1_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="274,-11060.93 20,-11060.93 20,-11008.93 274,-11008.93 274,-11060.93"/>
<text text-anchor="middle" x="147" y="-11048.93" font-family="Arial" font-size="10.00">MLP FC1 (L4)</text>
<text text-anchor="middle" x="147" y="-11037.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-11026.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="147" y="-11015.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l4 -->
<g id="node57" class="node">
<title>mlp_fc2_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-10971.93 16.5,-10971.93 16.5,-10919.93 277.5,-10919.93 277.5,-10971.93"/>
<text text-anchor="middle" x="147" y="-10959.93" font-family="Arial" font-size="10.00">MLP FC2 (L4)</text>
<text text-anchor="middle" x="147" y="-10948.93" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-10937.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="147" y="-10926.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l4&#45;&gt;mlp_fc2_1_l4 -->
<g id="edge70" class="edge">
<title>mlp_fc1_1_l4&#45;&gt;mlp_fc2_1_l4</title>
<path fill="none" stroke="black" d="M147,-11008.77C147,-11000.47 147,-10991.08 147,-10982.18"/>
<polygon fill="black" stroke="black" points="150.5,-10982.04 147,-10972.04 143.5,-10982.04 150.5,-10982.04"/>
</g>
<!-- mlp_fc1_2_l4 -->
<g id="node56" class="node">
<title>mlp_fc1_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="553,-11060.93 299,-11060.93 299,-11008.93 553,-11008.93 553,-11060.93"/>
<text text-anchor="middle" x="426" y="-11048.93" font-family="Arial" font-size="10.00">MLP FC1 (L4)</text>
<text text-anchor="middle" x="426" y="-11037.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-11026.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="426" y="-11015.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l4 -->
<g id="node58" class="node">
<title>mlp_fc2_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-10971.93 295.5,-10971.93 295.5,-10919.93 556.5,-10919.93 556.5,-10971.93"/>
<text text-anchor="middle" x="426" y="-10959.93" font-family="Arial" font-size="10.00">MLP FC2 (L4)</text>
<text text-anchor="middle" x="426" y="-10948.93" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-10937.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="426" y="-10926.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l4&#45;&gt;mlp_fc2_2_l4 -->
<g id="edge71" class="edge">
<title>mlp_fc1_2_l4&#45;&gt;mlp_fc2_2_l4</title>
<path fill="none" stroke="black" d="M426,-11008.77C426,-11000.47 426,-10991.08 426,-10982.18"/>
<polygon fill="black" stroke="black" points="429.5,-10982.04 426,-10972.04 422.5,-10982.04 429.5,-10982.04"/>
</g>
<!-- tp_comm_mlp_l4 -->
<g id="node59" class="node">
<title>tp_comm_mlp_l4</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-10846.16" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-10860.16" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L4)</text>
<text text-anchor="middle" x="301" y="-10849.16" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-10838.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-10827.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l4&#45;&gt;tp_comm_mlp_l4 -->
<g id="edge72" class="edge">
<title>mlp_fc2_1_l4&#45;&gt;tp_comm_mlp_l4</title>
<path fill="none" stroke="black" d="M186.66,-10919.75C202.44,-10909.74 220.97,-10897.97 238.47,-10886.86"/>
<polygon fill="black" stroke="black" points="240.4,-10889.78 246.97,-10881.46 236.65,-10883.87 240.4,-10889.78"/>
</g>
<!-- mlp_fc2_2_l4&#45;&gt;tp_comm_mlp_l4 -->
<g id="edge73" class="edge">
<title>mlp_fc2_2_l4&#45;&gt;tp_comm_mlp_l4</title>
<path fill="none" stroke="black" d="M393.81,-10919.75C381.59,-10910.2 367.34,-10899.05 353.72,-10888.4"/>
<polygon fill="black" stroke="black" points="355.83,-10885.6 345.8,-10882.2 351.52,-10891.12 355.83,-10885.6"/>
</g>
<!-- ln2_1_l4 -->
<g id="node62" class="node">
<title>ln2_1_l4</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-10772.39 29.5,-10772.39 29.5,-10720.39 290.5,-10720.39 290.5,-10772.39"/>
<text text-anchor="middle" x="160" y="-10760.39" font-family="Arial" font-size="10.00">LayerNorm2 (L4)</text>
<text text-anchor="middle" x="160" y="-10749.39" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-10738.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-10727.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l4&#45;&gt;ln2_1_l4 -->
<g id="edge74" class="edge">
<title>tp_comm_mlp_l4&#45;&gt;ln2_1_l4</title>
<path fill="none" stroke="black" d="M251.29,-10810.69C236.18,-10800.21 219.67,-10788.76 204.89,-10778.52"/>
<polygon fill="black" stroke="black" points="206.63,-10775.46 196.42,-10772.64 202.64,-10781.22 206.63,-10775.46"/>
</g>
<!-- ln2_2_l4 -->
<g id="node63" class="node">
<title>ln2_2_l4</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-10772.39 312.5,-10772.39 312.5,-10720.39 573.5,-10720.39 573.5,-10772.39"/>
<text text-anchor="middle" x="443" y="-10760.39" font-family="Arial" font-size="10.00">LayerNorm2 (L4)</text>
<text text-anchor="middle" x="443" y="-10749.39" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-10738.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-10727.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l4&#45;&gt;ln2_2_l4 -->
<g id="edge75" class="edge">
<title>tp_comm_mlp_l4&#45;&gt;ln2_2_l4</title>
<path fill="none" stroke="black" d="M351.06,-10810.69C366.28,-10800.21 382.91,-10788.76 397.79,-10778.52"/>
<polygon fill="black" stroke="black" points="400.07,-10781.2 406.32,-10772.64 396.1,-10775.43 400.07,-10781.2"/>
</g>
<!-- ln1_1_l4&#45;&gt;mlp_fc1_1_l4 -->
<g id="edge68" class="edge">
<title>ln1_1_l4&#45;&gt;mlp_fc1_1_l4</title>
<path fill="none" stroke="black" d="M147,-11097.77C147,-11089.47 147,-11080.08 147,-11071.18"/>
<polygon fill="black" stroke="black" points="150.5,-11071.04 147,-11061.04 143.5,-11071.04 150.5,-11071.04"/>
</g>
<!-- ln1_2_l4&#45;&gt;mlp_fc1_2_l4 -->
<g id="edge69" class="edge">
<title>ln1_2_l4&#45;&gt;mlp_fc1_2_l4</title>
<path fill="none" stroke="black" d="M426,-11097.77C426,-11089.47 426,-11080.08 426,-11071.18"/>
<polygon fill="black" stroke="black" points="429.5,-11071.04 426,-11061.04 422.5,-11071.04 429.5,-11071.04"/>
</g>
<!-- attn_qkv_1_l5 -->
<g id="node64" class="node">
<title>attn_qkv_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="292,-10683.39 22,-10683.39 22,-10631.39 292,-10631.39 292,-10683.39"/>
<text text-anchor="middle" x="157" y="-10671.39" font-family="Arial" font-size="10.00">Attention QKV (L5)</text>
<text text-anchor="middle" x="157" y="-10660.39" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-10649.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-10638.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l4&#45;&gt;attn_qkv_1_l5 -->
<g id="edge76" class="edge">
<title>ln2_1_l4&#45;&gt;attn_qkv_1_l5</title>
<path fill="none" stroke="black" d="M159.13,-10720.23C158.85,-10711.93 158.52,-10702.55 158.22,-10693.64"/>
<polygon fill="black" stroke="black" points="161.71,-10693.37 157.87,-10683.5 154.71,-10693.61 161.71,-10693.37"/>
</g>
<!-- attn_qkv_2_l5 -->
<g id="node65" class="node">
<title>attn_qkv_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="580,-10683.39 310,-10683.39 310,-10631.39 580,-10631.39 580,-10683.39"/>
<text text-anchor="middle" x="445" y="-10671.39" font-family="Arial" font-size="10.00">Attention QKV (L5)</text>
<text text-anchor="middle" x="445" y="-10660.39" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-10649.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-10638.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l4&#45;&gt;attn_qkv_2_l5 -->
<g id="edge77" class="edge">
<title>ln2_2_l4&#45;&gt;attn_qkv_2_l5</title>
<path fill="none" stroke="black" d="M443.58,-10720.23C443.77,-10711.93 443.98,-10702.55 444.19,-10693.64"/>
<polygon fill="black" stroke="black" points="447.69,-10693.58 444.42,-10683.5 440.69,-10693.41 447.69,-10693.58"/>
</g>
<!-- tp_comm_attn_l5 -->
<g id="node66" class="node">
<title>tp_comm_attn_l5</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-10557.62" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-10571.62" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L5)</text>
<text text-anchor="middle" x="301" y="-10560.62" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-10549.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-10538.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l5&#45;&gt;tp_comm_attn_l5 -->
<g id="edge78" class="edge">
<title>attn_qkv_1_l5&#45;&gt;tp_comm_attn_l5</title>
<path fill="none" stroke="black" d="M194.08,-10631.21C208.63,-10621.34 225.69,-10609.75 241.85,-10598.78"/>
<polygon fill="black" stroke="black" points="243.9,-10601.62 250.2,-10593.11 239.96,-10595.83 243.9,-10601.62"/>
</g>
<!-- attn_qkv_2_l5&#45;&gt;tp_comm_attn_l5 -->
<g id="edge79" class="edge">
<title>attn_qkv_2_l5&#45;&gt;tp_comm_attn_l5</title>
<path fill="none" stroke="black" d="M407.92,-10631.21C393.37,-10621.34 376.31,-10609.75 360.15,-10598.78"/>
<polygon fill="black" stroke="black" points="362.04,-10595.83 351.8,-10593.11 358.1,-10601.62 362.04,-10595.83"/>
</g>
<!-- attn_out_1_l5 -->
<g id="node67" class="node">
<title>attn_out_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-10483.85 29.5,-10483.85 29.5,-10431.85 292.5,-10431.85 292.5,-10483.85"/>
<text text-anchor="middle" x="161" y="-10471.85" font-family="Arial" font-size="10.00">Attention Output (L5)</text>
<text text-anchor="middle" x="161" y="-10460.85" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-10449.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-10438.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l5&#45;&gt;attn_out_1_l5 -->
<g id="edge80" class="edge">
<title>tp_comm_attn_l5&#45;&gt;attn_out_1_l5</title>
<path fill="none" stroke="black" d="M251.25,-10521.88C236.27,-10511.41 219.93,-10500.01 205.33,-10489.81"/>
<polygon fill="black" stroke="black" points="207.16,-10486.82 196.96,-10483.96 203.15,-10492.56 207.16,-10486.82"/>
</g>
<!-- attn_out_2_l5 -->
<g id="node68" class="node">
<title>attn_out_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-10483.85 310.5,-10483.85 310.5,-10431.85 573.5,-10431.85 573.5,-10483.85"/>
<text text-anchor="middle" x="442" y="-10471.85" font-family="Arial" font-size="10.00">Attention Output (L5)</text>
<text text-anchor="middle" x="442" y="-10460.85" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-10449.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-10438.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l5&#45;&gt;attn_out_2_l5 -->
<g id="edge81" class="edge">
<title>tp_comm_attn_l5&#45;&gt;attn_out_2_l5</title>
<path fill="none" stroke="black" d="M351.11,-10521.88C366.19,-10511.41 382.64,-10500.01 397.35,-10489.81"/>
<polygon fill="black" stroke="black" points="399.56,-10492.54 405.79,-10483.96 395.57,-10486.78 399.56,-10492.54"/>
</g>
<!-- tp_comm_attn_out_l5 -->
<g id="node69" class="node">
<title>tp_comm_attn_out_l5</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-10358.08" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-10372.08" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L5)</text>
<text text-anchor="middle" x="301" y="-10361.08" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-10350.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-10339.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l5&#45;&gt;tp_comm_attn_out_l5 -->
<g id="edge82" class="edge">
<title>attn_out_1_l5&#45;&gt;tp_comm_attn_out_l5</title>
<path fill="none" stroke="black" d="M197.05,-10431.67C211.07,-10421.89 227.48,-10410.43 243.06,-10399.54"/>
<polygon fill="black" stroke="black" points="245.42,-10402.17 251.62,-10393.57 241.41,-10396.43 245.42,-10402.17"/>
</g>
<!-- attn_out_2_l5&#45;&gt;tp_comm_attn_out_l5 -->
<g id="edge83" class="edge">
<title>attn_out_2_l5&#45;&gt;tp_comm_attn_out_l5</title>
<path fill="none" stroke="black" d="M405.69,-10431.67C391.58,-10421.89 375.05,-10410.43 359.35,-10399.54"/>
<polygon fill="black" stroke="black" points="360.95,-10396.39 350.74,-10393.57 356.96,-10402.14 360.95,-10396.39"/>
</g>
<!-- ln1_1_l5 -->
<g id="node75" class="node">
<title>ln1_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-10284.31 30.5,-10284.31 30.5,-10232.31 291.5,-10232.31 291.5,-10284.31"/>
<text text-anchor="middle" x="161" y="-10272.31" font-family="Arial" font-size="10.00">LayerNorm1 (L5)</text>
<text text-anchor="middle" x="161" y="-10261.31" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-10250.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="161" y="-10239.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l5&#45;&gt;ln1_1_l5 -->
<g id="edge84" class="edge">
<title>tp_comm_attn_out_l5&#45;&gt;ln1_1_l5</title>
<path fill="none" stroke="black" d="M251.64,-10322.61C236.64,-10312.13 220.24,-10300.68 205.57,-10290.44"/>
<polygon fill="black" stroke="black" points="207.36,-10287.42 197.16,-10284.56 203.35,-10293.16 207.36,-10287.42"/>
</g>
<!-- ln1_2_l5 -->
<g id="node76" class="node">
<title>ln1_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-10284.31 309.5,-10284.31 309.5,-10232.31 570.5,-10232.31 570.5,-10284.31"/>
<text text-anchor="middle" x="440" y="-10272.31" font-family="Arial" font-size="10.00">LayerNorm1 (L5)</text>
<text text-anchor="middle" x="440" y="-10261.31" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-10250.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="440" y="-10239.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l5&#45;&gt;ln1_2_l5 -->
<g id="edge85" class="edge">
<title>tp_comm_attn_out_l5&#45;&gt;ln1_2_l5</title>
<path fill="none" stroke="black" d="M350.01,-10322.61C364.9,-10312.13 381.18,-10300.68 395.75,-10290.44"/>
<polygon fill="black" stroke="black" points="397.93,-10293.18 404.1,-10284.56 393.91,-10287.45 397.93,-10293.18"/>
</g>
<!-- mlp_fc1_1_l5 -->
<g id="node70" class="node">
<title>mlp_fc1_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="288,-10195.31 34,-10195.31 34,-10143.31 288,-10143.31 288,-10195.31"/>
<text text-anchor="middle" x="161" y="-10183.31" font-family="Arial" font-size="10.00">MLP FC1 (L5)</text>
<text text-anchor="middle" x="161" y="-10172.31" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-10161.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="161" y="-10150.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l5 -->
<g id="node72" class="node">
<title>mlp_fc2_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-10106.31 30.5,-10106.31 30.5,-10054.31 291.5,-10054.31 291.5,-10106.31"/>
<text text-anchor="middle" x="161" y="-10094.31" font-family="Arial" font-size="10.00">MLP FC2 (L5)</text>
<text text-anchor="middle" x="161" y="-10083.31" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-10072.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="161" y="-10061.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l5&#45;&gt;mlp_fc2_1_l5 -->
<g id="edge88" class="edge">
<title>mlp_fc1_1_l5&#45;&gt;mlp_fc2_1_l5</title>
<path fill="none" stroke="black" d="M161,-10143.15C161,-10134.85 161,-10125.47 161,-10116.56"/>
<polygon fill="black" stroke="black" points="164.5,-10116.42 161,-10106.42 157.5,-10116.42 164.5,-10116.42"/>
</g>
<!-- mlp_fc1_2_l5 -->
<g id="node71" class="node">
<title>mlp_fc1_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="567,-10195.31 313,-10195.31 313,-10143.31 567,-10143.31 567,-10195.31"/>
<text text-anchor="middle" x="440" y="-10183.31" font-family="Arial" font-size="10.00">MLP FC1 (L5)</text>
<text text-anchor="middle" x="440" y="-10172.31" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-10161.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="440" y="-10150.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l5 -->
<g id="node73" class="node">
<title>mlp_fc2_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-10106.31 309.5,-10106.31 309.5,-10054.31 570.5,-10054.31 570.5,-10106.31"/>
<text text-anchor="middle" x="440" y="-10094.31" font-family="Arial" font-size="10.00">MLP FC2 (L5)</text>
<text text-anchor="middle" x="440" y="-10083.31" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-10072.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="440" y="-10061.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l5&#45;&gt;mlp_fc2_2_l5 -->
<g id="edge89" class="edge">
<title>mlp_fc1_2_l5&#45;&gt;mlp_fc2_2_l5</title>
<path fill="none" stroke="black" d="M440,-10143.15C440,-10134.85 440,-10125.47 440,-10116.56"/>
<polygon fill="black" stroke="black" points="443.5,-10116.42 440,-10106.42 436.5,-10116.42 443.5,-10116.42"/>
</g>
<!-- tp_comm_mlp_l5 -->
<g id="node74" class="node">
<title>tp_comm_mlp_l5</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-9980.54" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-9994.54" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L5)</text>
<text text-anchor="middle" x="301" y="-9983.54" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-9972.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-9961.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l5&#45;&gt;tp_comm_mlp_l5 -->
<g id="edge90" class="edge">
<title>mlp_fc2_1_l5&#45;&gt;tp_comm_mlp_l5</title>
<path fill="none" stroke="black" d="M197.05,-10054.13C211.07,-10044.35 227.48,-10032.89 243.06,-10022"/>
<polygon fill="black" stroke="black" points="245.42,-10024.63 251.62,-10016.03 241.41,-10018.89 245.42,-10024.63"/>
</g>
<!-- mlp_fc2_2_l5&#45;&gt;tp_comm_mlp_l5 -->
<g id="edge91" class="edge">
<title>mlp_fc2_2_l5&#45;&gt;tp_comm_mlp_l5</title>
<path fill="none" stroke="black" d="M404.2,-10054.13C390.29,-10044.35 374,-10032.89 358.52,-10022"/>
<polygon fill="black" stroke="black" points="360.23,-10018.92 350.03,-10016.03 356.2,-10024.65 360.23,-10018.92"/>
</g>
<!-- ln2_1_l5 -->
<g id="node77" class="node">
<title>ln2_1_l5</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-9906.77 29.5,-9906.77 29.5,-9854.77 290.5,-9854.77 290.5,-9906.77"/>
<text text-anchor="middle" x="160" y="-9894.77" font-family="Arial" font-size="10.00">LayerNorm2 (L5)</text>
<text text-anchor="middle" x="160" y="-9883.77" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-9872.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-9861.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l5&#45;&gt;ln2_1_l5 -->
<g id="edge92" class="edge">
<title>tp_comm_mlp_l5&#45;&gt;ln2_1_l5</title>
<path fill="none" stroke="black" d="M251.29,-9945.07C236.18,-9934.59 219.67,-9923.15 204.89,-9912.9"/>
<polygon fill="black" stroke="black" points="206.63,-9909.85 196.42,-9907.02 202.64,-9915.6 206.63,-9909.85"/>
</g>
<!-- ln2_2_l5 -->
<g id="node78" class="node">
<title>ln2_2_l5</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-9906.77 312.5,-9906.77 312.5,-9854.77 573.5,-9854.77 573.5,-9906.77"/>
<text text-anchor="middle" x="443" y="-9894.77" font-family="Arial" font-size="10.00">LayerNorm2 (L5)</text>
<text text-anchor="middle" x="443" y="-9883.77" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-9872.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-9861.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l5&#45;&gt;ln2_2_l5 -->
<g id="edge93" class="edge">
<title>tp_comm_mlp_l5&#45;&gt;ln2_2_l5</title>
<path fill="none" stroke="black" d="M351.06,-9945.07C366.28,-9934.59 382.91,-9923.15 397.79,-9912.9"/>
<polygon fill="black" stroke="black" points="400.07,-9915.58 406.32,-9907.02 396.1,-9909.81 400.07,-9915.58"/>
</g>
<!-- ln1_1_l5&#45;&gt;mlp_fc1_1_l5 -->
<g id="edge86" class="edge">
<title>ln1_1_l5&#45;&gt;mlp_fc1_1_l5</title>
<path fill="none" stroke="black" d="M161,-10232.15C161,-10223.85 161,-10214.47 161,-10205.56"/>
<polygon fill="black" stroke="black" points="164.5,-10205.42 161,-10195.42 157.5,-10205.42 164.5,-10205.42"/>
</g>
<!-- ln1_2_l5&#45;&gt;mlp_fc1_2_l5 -->
<g id="edge87" class="edge">
<title>ln1_2_l5&#45;&gt;mlp_fc1_2_l5</title>
<path fill="none" stroke="black" d="M440,-10232.15C440,-10223.85 440,-10214.47 440,-10205.56"/>
<polygon fill="black" stroke="black" points="443.5,-10205.42 440,-10195.42 436.5,-10205.42 443.5,-10205.42"/>
</g>
<!-- attn_qkv_1_l6 -->
<g id="node79" class="node">
<title>attn_qkv_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="292,-9817.77 22,-9817.77 22,-9765.77 292,-9765.77 292,-9817.77"/>
<text text-anchor="middle" x="157" y="-9805.77" font-family="Arial" font-size="10.00">Attention QKV (L6)</text>
<text text-anchor="middle" x="157" y="-9794.77" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-9783.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-9772.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l5&#45;&gt;attn_qkv_1_l6 -->
<g id="edge94" class="edge">
<title>ln2_1_l5&#45;&gt;attn_qkv_1_l6</title>
<path fill="none" stroke="black" d="M159.13,-9854.61C158.85,-9846.31 158.52,-9836.93 158.22,-9828.02"/>
<polygon fill="black" stroke="black" points="161.71,-9827.75 157.87,-9817.88 154.71,-9828 161.71,-9827.75"/>
</g>
<!-- attn_qkv_2_l6 -->
<g id="node80" class="node">
<title>attn_qkv_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="580,-9817.77 310,-9817.77 310,-9765.77 580,-9765.77 580,-9817.77"/>
<text text-anchor="middle" x="445" y="-9805.77" font-family="Arial" font-size="10.00">Attention QKV (L6)</text>
<text text-anchor="middle" x="445" y="-9794.77" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-9783.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-9772.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l5&#45;&gt;attn_qkv_2_l6 -->
<g id="edge95" class="edge">
<title>ln2_2_l5&#45;&gt;attn_qkv_2_l6</title>
<path fill="none" stroke="black" d="M443.58,-9854.61C443.77,-9846.31 443.98,-9836.93 444.19,-9828.02"/>
<polygon fill="black" stroke="black" points="447.69,-9827.96 444.42,-9817.88 440.69,-9827.8 447.69,-9827.96"/>
</g>
<!-- tp_comm_attn_l6 -->
<g id="node81" class="node">
<title>tp_comm_attn_l6</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-9692" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-9706" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L6)</text>
<text text-anchor="middle" x="301" y="-9695" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-9684" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-9673" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l6&#45;&gt;tp_comm_attn_l6 -->
<g id="edge96" class="edge">
<title>attn_qkv_1_l6&#45;&gt;tp_comm_attn_l6</title>
<path fill="none" stroke="black" d="M194.08,-9765.6C208.63,-9755.72 225.69,-9744.14 241.85,-9733.16"/>
<polygon fill="black" stroke="black" points="243.9,-9736 250.2,-9727.49 239.96,-9730.21 243.9,-9736"/>
</g>
<!-- attn_qkv_2_l6&#45;&gt;tp_comm_attn_l6 -->
<g id="edge97" class="edge">
<title>attn_qkv_2_l6&#45;&gt;tp_comm_attn_l6</title>
<path fill="none" stroke="black" d="M407.92,-9765.6C393.37,-9755.72 376.31,-9744.14 360.15,-9733.16"/>
<polygon fill="black" stroke="black" points="362.04,-9730.21 351.8,-9727.49 358.1,-9736 362.04,-9730.21"/>
</g>
<!-- attn_out_1_l6 -->
<g id="node82" class="node">
<title>attn_out_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-9618.23 29.5,-9618.23 29.5,-9566.23 292.5,-9566.23 292.5,-9618.23"/>
<text text-anchor="middle" x="161" y="-9606.23" font-family="Arial" font-size="10.00">Attention Output (L6)</text>
<text text-anchor="middle" x="161" y="-9595.23" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-9584.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-9573.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l6&#45;&gt;attn_out_1_l6 -->
<g id="edge98" class="edge">
<title>tp_comm_attn_l6&#45;&gt;attn_out_1_l6</title>
<path fill="none" stroke="black" d="M251.25,-9656.26C236.27,-9645.8 219.93,-9634.39 205.33,-9624.19"/>
<polygon fill="black" stroke="black" points="207.16,-9621.2 196.96,-9618.34 203.15,-9626.94 207.16,-9621.2"/>
</g>
<!-- attn_out_2_l6 -->
<g id="node83" class="node">
<title>attn_out_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-9618.23 310.5,-9618.23 310.5,-9566.23 573.5,-9566.23 573.5,-9618.23"/>
<text text-anchor="middle" x="442" y="-9606.23" font-family="Arial" font-size="10.00">Attention Output (L6)</text>
<text text-anchor="middle" x="442" y="-9595.23" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-9584.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-9573.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l6&#45;&gt;attn_out_2_l6 -->
<g id="edge99" class="edge">
<title>tp_comm_attn_l6&#45;&gt;attn_out_2_l6</title>
<path fill="none" stroke="black" d="M351.11,-9656.26C366.19,-9645.8 382.64,-9634.39 397.35,-9624.19"/>
<polygon fill="black" stroke="black" points="399.56,-9626.92 405.79,-9618.34 395.57,-9621.17 399.56,-9626.92"/>
</g>
<!-- tp_comm_attn_out_l6 -->
<g id="node84" class="node">
<title>tp_comm_attn_out_l6</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-9492.46" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-9506.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L6)</text>
<text text-anchor="middle" x="301" y="-9495.46" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-9484.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-9473.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l6&#45;&gt;tp_comm_attn_out_l6 -->
<g id="edge100" class="edge">
<title>attn_out_1_l6&#45;&gt;tp_comm_attn_out_l6</title>
<path fill="none" stroke="black" d="M197.05,-9566.06C211.07,-9556.27 227.48,-9544.81 243.06,-9533.93"/>
<polygon fill="black" stroke="black" points="245.42,-9536.55 251.62,-9527.95 241.41,-9530.81 245.42,-9536.55"/>
</g>
<!-- attn_out_2_l6&#45;&gt;tp_comm_attn_out_l6 -->
<g id="edge101" class="edge">
<title>attn_out_2_l6&#45;&gt;tp_comm_attn_out_l6</title>
<path fill="none" stroke="black" d="M405.69,-9566.06C391.58,-9556.27 375.05,-9544.81 359.35,-9533.93"/>
<polygon fill="black" stroke="black" points="360.95,-9530.77 350.74,-9527.95 356.96,-9536.53 360.95,-9530.77"/>
</g>
<!-- ln1_1_l6 -->
<g id="node90" class="node">
<title>ln1_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-9418.7 31.5,-9418.7 31.5,-9366.7 292.5,-9366.7 292.5,-9418.7"/>
<text text-anchor="middle" x="162" y="-9406.7" font-family="Arial" font-size="10.00">LayerNorm1 (L6)</text>
<text text-anchor="middle" x="162" y="-9395.7" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-9384.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-9373.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l6&#45;&gt;ln1_1_l6 -->
<g id="edge102" class="edge">
<title>tp_comm_attn_out_l6&#45;&gt;ln1_1_l6</title>
<path fill="none" stroke="black" d="M251.99,-9456.99C237.1,-9446.52 220.82,-9435.07 206.25,-9424.82"/>
<polygon fill="black" stroke="black" points="208.09,-9421.84 197.9,-9418.95 204.07,-9427.56 208.09,-9421.84"/>
</g>
<!-- ln1_2_l6 -->
<g id="node91" class="node">
<title>ln1_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-9418.7 310.5,-9418.7 310.5,-9366.7 571.5,-9366.7 571.5,-9418.7"/>
<text text-anchor="middle" x="441" y="-9406.7" font-family="Arial" font-size="10.00">LayerNorm1 (L6)</text>
<text text-anchor="middle" x="441" y="-9395.7" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-9384.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-9373.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l6&#45;&gt;ln1_2_l6 -->
<g id="edge103" class="edge">
<title>tp_comm_attn_out_l6&#45;&gt;ln1_2_l6</title>
<path fill="none" stroke="black" d="M350.36,-9456.99C365.36,-9446.52 381.76,-9435.07 396.43,-9424.82"/>
<polygon fill="black" stroke="black" points="398.65,-9427.54 404.84,-9418.95 394.64,-9421.8 398.65,-9427.54"/>
</g>
<!-- mlp_fc1_1_l6 -->
<g id="node85" class="node">
<title>mlp_fc1_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="289,-9329.7 35,-9329.7 35,-9277.7 289,-9277.7 289,-9329.7"/>
<text text-anchor="middle" x="162" y="-9317.7" font-family="Arial" font-size="10.00">MLP FC1 (L6)</text>
<text text-anchor="middle" x="162" y="-9306.7" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-9295.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-9284.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l6 -->
<g id="node87" class="node">
<title>mlp_fc2_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-9240.7 31.5,-9240.7 31.5,-9188.7 292.5,-9188.7 292.5,-9240.7"/>
<text text-anchor="middle" x="162" y="-9228.7" font-family="Arial" font-size="10.00">MLP FC2 (L6)</text>
<text text-anchor="middle" x="162" y="-9217.7" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-9206.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-9195.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l6&#45;&gt;mlp_fc2_1_l6 -->
<g id="edge106" class="edge">
<title>mlp_fc1_1_l6&#45;&gt;mlp_fc2_1_l6</title>
<path fill="none" stroke="black" d="M162,-9277.53C162,-9269.23 162,-9259.85 162,-9250.94"/>
<polygon fill="black" stroke="black" points="165.5,-9250.8 162,-9240.8 158.5,-9250.8 165.5,-9250.8"/>
</g>
<!-- mlp_fc1_2_l6 -->
<g id="node86" class="node">
<title>mlp_fc1_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="568,-9329.7 314,-9329.7 314,-9277.7 568,-9277.7 568,-9329.7"/>
<text text-anchor="middle" x="441" y="-9317.7" font-family="Arial" font-size="10.00">MLP FC1 (L6)</text>
<text text-anchor="middle" x="441" y="-9306.7" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-9295.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-9284.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l6 -->
<g id="node88" class="node">
<title>mlp_fc2_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-9240.7 310.5,-9240.7 310.5,-9188.7 571.5,-9188.7 571.5,-9240.7"/>
<text text-anchor="middle" x="441" y="-9228.7" font-family="Arial" font-size="10.00">MLP FC2 (L6)</text>
<text text-anchor="middle" x="441" y="-9217.7" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-9206.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-9195.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l6&#45;&gt;mlp_fc2_2_l6 -->
<g id="edge107" class="edge">
<title>mlp_fc1_2_l6&#45;&gt;mlp_fc2_2_l6</title>
<path fill="none" stroke="black" d="M441,-9277.53C441,-9269.23 441,-9259.85 441,-9250.94"/>
<polygon fill="black" stroke="black" points="444.5,-9250.8 441,-9240.8 437.5,-9250.8 444.5,-9250.8"/>
</g>
<!-- tp_comm_mlp_l6 -->
<g id="node89" class="node">
<title>tp_comm_mlp_l6</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-9114.93" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-9128.93" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L6)</text>
<text text-anchor="middle" x="301" y="-9117.93" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-9106.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-9095.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l6&#45;&gt;tp_comm_mlp_l6 -->
<g id="edge108" class="edge">
<title>mlp_fc2_1_l6&#45;&gt;tp_comm_mlp_l6</title>
<path fill="none" stroke="black" d="M197.8,-9188.52C211.71,-9178.73 228,-9167.27 243.48,-9156.39"/>
<polygon fill="black" stroke="black" points="245.8,-9159.03 251.97,-9150.41 241.77,-9153.3 245.8,-9159.03"/>
</g>
<!-- mlp_fc2_2_l6&#45;&gt;tp_comm_mlp_l6 -->
<g id="edge109" class="edge">
<title>mlp_fc2_2_l6&#45;&gt;tp_comm_mlp_l6</title>
<path fill="none" stroke="black" d="M404.95,-9188.52C390.93,-9178.73 374.52,-9167.27 358.94,-9156.39"/>
<polygon fill="black" stroke="black" points="360.59,-9153.27 350.38,-9150.41 356.58,-9159.01 360.59,-9153.27"/>
</g>
<!-- ln2_1_l6 -->
<g id="node92" class="node">
<title>ln2_1_l6</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-9041.16 29.5,-9041.16 29.5,-8989.16 290.5,-8989.16 290.5,-9041.16"/>
<text text-anchor="middle" x="160" y="-9029.16" font-family="Arial" font-size="10.00">LayerNorm2 (L6)</text>
<text text-anchor="middle" x="160" y="-9018.16" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-9007.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-8996.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l6&#45;&gt;ln2_1_l6 -->
<g id="edge110" class="edge">
<title>tp_comm_mlp_l6&#45;&gt;ln2_1_l6</title>
<path fill="none" stroke="black" d="M251.29,-9079.46C236.18,-9068.98 219.67,-9057.53 204.89,-9047.28"/>
<polygon fill="black" stroke="black" points="206.63,-9044.23 196.42,-9041.41 202.64,-9049.98 206.63,-9044.23"/>
</g>
<!-- ln2_2_l6 -->
<g id="node93" class="node">
<title>ln2_2_l6</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-9041.16 312.5,-9041.16 312.5,-8989.16 573.5,-8989.16 573.5,-9041.16"/>
<text text-anchor="middle" x="443" y="-9029.16" font-family="Arial" font-size="10.00">LayerNorm2 (L6)</text>
<text text-anchor="middle" x="443" y="-9018.16" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-9007.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-8996.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l6&#45;&gt;ln2_2_l6 -->
<g id="edge111" class="edge">
<title>tp_comm_mlp_l6&#45;&gt;ln2_2_l6</title>
<path fill="none" stroke="black" d="M351.06,-9079.46C366.28,-9068.98 382.91,-9057.53 397.79,-9047.28"/>
<polygon fill="black" stroke="black" points="400.07,-9049.96 406.32,-9041.41 396.1,-9044.2 400.07,-9049.96"/>
</g>
<!-- ln1_1_l6&#45;&gt;mlp_fc1_1_l6 -->
<g id="edge104" class="edge">
<title>ln1_1_l6&#45;&gt;mlp_fc1_1_l6</title>
<path fill="none" stroke="black" d="M162,-9366.53C162,-9358.23 162,-9348.85 162,-9339.94"/>
<polygon fill="black" stroke="black" points="165.5,-9339.8 162,-9329.8 158.5,-9339.8 165.5,-9339.8"/>
</g>
<!-- ln1_2_l6&#45;&gt;mlp_fc1_2_l6 -->
<g id="edge105" class="edge">
<title>ln1_2_l6&#45;&gt;mlp_fc1_2_l6</title>
<path fill="none" stroke="black" d="M441,-9366.53C441,-9358.23 441,-9348.85 441,-9339.94"/>
<polygon fill="black" stroke="black" points="444.5,-9339.8 441,-9329.8 437.5,-9339.8 444.5,-9339.8"/>
</g>
<!-- attn_qkv_1_l7 -->
<g id="node94" class="node">
<title>attn_qkv_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="292,-8952.16 22,-8952.16 22,-8900.16 292,-8900.16 292,-8952.16"/>
<text text-anchor="middle" x="157" y="-8940.16" font-family="Arial" font-size="10.00">Attention QKV (L7)</text>
<text text-anchor="middle" x="157" y="-8929.16" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-8918.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-8907.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l6&#45;&gt;attn_qkv_1_l7 -->
<g id="edge112" class="edge">
<title>ln2_1_l6&#45;&gt;attn_qkv_1_l7</title>
<path fill="none" stroke="black" d="M159.13,-8988.99C158.85,-8980.7 158.52,-8971.31 158.22,-8962.4"/>
<polygon fill="black" stroke="black" points="161.71,-8962.14 157.87,-8952.26 154.71,-8962.38 161.71,-8962.14"/>
</g>
<!-- attn_qkv_2_l7 -->
<g id="node95" class="node">
<title>attn_qkv_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="580,-8952.16 310,-8952.16 310,-8900.16 580,-8900.16 580,-8952.16"/>
<text text-anchor="middle" x="445" y="-8940.16" font-family="Arial" font-size="10.00">Attention QKV (L7)</text>
<text text-anchor="middle" x="445" y="-8929.16" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-8918.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-8907.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l6&#45;&gt;attn_qkv_2_l7 -->
<g id="edge113" class="edge">
<title>ln2_2_l6&#45;&gt;attn_qkv_2_l7</title>
<path fill="none" stroke="black" d="M443.58,-8988.99C443.77,-8980.7 443.98,-8971.31 444.19,-8962.4"/>
<polygon fill="black" stroke="black" points="447.69,-8962.34 444.42,-8952.26 440.69,-8962.18 447.69,-8962.34"/>
</g>
<!-- tp_comm_attn_l7 -->
<g id="node96" class="node">
<title>tp_comm_attn_l7</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-8826.39" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-8840.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L7)</text>
<text text-anchor="middle" x="301" y="-8829.39" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-8818.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-8807.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l7&#45;&gt;tp_comm_attn_l7 -->
<g id="edge114" class="edge">
<title>attn_qkv_1_l7&#45;&gt;tp_comm_attn_l7</title>
<path fill="none" stroke="black" d="M194.08,-8899.98C208.63,-8890.1 225.69,-8878.52 241.85,-8867.55"/>
<polygon fill="black" stroke="black" points="243.9,-8870.39 250.2,-8861.87 239.96,-8864.6 243.9,-8870.39"/>
</g>
<!-- attn_qkv_2_l7&#45;&gt;tp_comm_attn_l7 -->
<g id="edge115" class="edge">
<title>attn_qkv_2_l7&#45;&gt;tp_comm_attn_l7</title>
<path fill="none" stroke="black" d="M407.92,-8899.98C393.37,-8890.1 376.31,-8878.52 360.15,-8867.55"/>
<polygon fill="black" stroke="black" points="362.04,-8864.6 351.8,-8861.87 358.1,-8870.39 362.04,-8864.6"/>
</g>
<!-- attn_out_1_l7 -->
<g id="node97" class="node">
<title>attn_out_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-8752.62 29.5,-8752.62 29.5,-8700.62 292.5,-8700.62 292.5,-8752.62"/>
<text text-anchor="middle" x="161" y="-8740.62" font-family="Arial" font-size="10.00">Attention Output (L7)</text>
<text text-anchor="middle" x="161" y="-8729.62" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-8718.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-8707.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l7&#45;&gt;attn_out_1_l7 -->
<g id="edge116" class="edge">
<title>tp_comm_attn_l7&#45;&gt;attn_out_1_l7</title>
<path fill="none" stroke="black" d="M251.25,-8790.64C236.27,-8780.18 219.93,-8768.77 205.33,-8758.58"/>
<polygon fill="black" stroke="black" points="207.16,-8755.58 196.96,-8752.73 203.15,-8761.32 207.16,-8755.58"/>
</g>
<!-- attn_out_2_l7 -->
<g id="node98" class="node">
<title>attn_out_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-8752.62 310.5,-8752.62 310.5,-8700.62 573.5,-8700.62 573.5,-8752.62"/>
<text text-anchor="middle" x="442" y="-8740.62" font-family="Arial" font-size="10.00">Attention Output (L7)</text>
<text text-anchor="middle" x="442" y="-8729.62" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-8718.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-8707.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l7&#45;&gt;attn_out_2_l7 -->
<g id="edge117" class="edge">
<title>tp_comm_attn_l7&#45;&gt;attn_out_2_l7</title>
<path fill="none" stroke="black" d="M351.11,-8790.64C366.19,-8780.18 382.64,-8768.77 397.35,-8758.58"/>
<polygon fill="black" stroke="black" points="399.56,-8761.3 405.79,-8752.73 395.57,-8755.55 399.56,-8761.3"/>
</g>
<!-- tp_comm_attn_out_l7 -->
<g id="node99" class="node">
<title>tp_comm_attn_out_l7</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-8626.85" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-8640.85" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L7)</text>
<text text-anchor="middle" x="301" y="-8629.85" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-8618.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-8607.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l7&#45;&gt;tp_comm_attn_out_l7 -->
<g id="edge118" class="edge">
<title>attn_out_1_l7&#45;&gt;tp_comm_attn_out_l7</title>
<path fill="none" stroke="black" d="M197.05,-8700.44C211.07,-8690.65 227.48,-8679.19 243.06,-8668.31"/>
<polygon fill="black" stroke="black" points="245.42,-8670.93 251.62,-8662.34 241.41,-8665.19 245.42,-8670.93"/>
</g>
<!-- attn_out_2_l7&#45;&gt;tp_comm_attn_out_l7 -->
<g id="edge119" class="edge">
<title>attn_out_2_l7&#45;&gt;tp_comm_attn_out_l7</title>
<path fill="none" stroke="black" d="M405.69,-8700.44C391.58,-8690.65 375.05,-8679.19 359.35,-8668.31"/>
<polygon fill="black" stroke="black" points="360.95,-8665.16 350.74,-8662.34 356.96,-8670.91 360.95,-8665.16"/>
</g>
<!-- ln1_1_l7 -->
<g id="node105" class="node">
<title>ln1_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-8553.08 31.5,-8553.08 31.5,-8501.08 292.5,-8501.08 292.5,-8553.08"/>
<text text-anchor="middle" x="162" y="-8541.08" font-family="Arial" font-size="10.00">LayerNorm1 (L7)</text>
<text text-anchor="middle" x="162" y="-8530.08" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-8519.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-8508.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l7&#45;&gt;ln1_1_l7 -->
<g id="edge120" class="edge">
<title>tp_comm_attn_out_l7&#45;&gt;ln1_1_l7</title>
<path fill="none" stroke="black" d="M251.99,-8591.38C237.1,-8580.9 220.82,-8569.45 206.25,-8559.21"/>
<polygon fill="black" stroke="black" points="208.09,-8556.22 197.9,-8553.33 204.07,-8561.95 208.09,-8556.22"/>
</g>
<!-- ln1_2_l7 -->
<g id="node106" class="node">
<title>ln1_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-8553.08 310.5,-8553.08 310.5,-8501.08 571.5,-8501.08 571.5,-8553.08"/>
<text text-anchor="middle" x="441" y="-8541.08" font-family="Arial" font-size="10.00">LayerNorm1 (L7)</text>
<text text-anchor="middle" x="441" y="-8530.08" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-8519.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-8508.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l7&#45;&gt;ln1_2_l7 -->
<g id="edge121" class="edge">
<title>tp_comm_attn_out_l7&#45;&gt;ln1_2_l7</title>
<path fill="none" stroke="black" d="M350.36,-8591.38C365.36,-8580.9 381.76,-8569.45 396.43,-8559.21"/>
<polygon fill="black" stroke="black" points="398.65,-8561.92 404.84,-8553.33 394.64,-8556.19 398.65,-8561.92"/>
</g>
<!-- mlp_fc1_1_l7 -->
<g id="node100" class="node">
<title>mlp_fc1_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="289,-8464.08 35,-8464.08 35,-8412.08 289,-8412.08 289,-8464.08"/>
<text text-anchor="middle" x="162" y="-8452.08" font-family="Arial" font-size="10.00">MLP FC1 (L7)</text>
<text text-anchor="middle" x="162" y="-8441.08" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-8430.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-8419.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l7 -->
<g id="node102" class="node">
<title>mlp_fc2_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-8375.08 31.5,-8375.08 31.5,-8323.08 292.5,-8323.08 292.5,-8375.08"/>
<text text-anchor="middle" x="162" y="-8363.08" font-family="Arial" font-size="10.00">MLP FC2 (L7)</text>
<text text-anchor="middle" x="162" y="-8352.08" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-8341.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-8330.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l7&#45;&gt;mlp_fc2_1_l7 -->
<g id="edge124" class="edge">
<title>mlp_fc1_1_l7&#45;&gt;mlp_fc2_1_l7</title>
<path fill="none" stroke="black" d="M162,-8411.91C162,-8403.62 162,-8394.23 162,-8385.33"/>
<polygon fill="black" stroke="black" points="165.5,-8385.19 162,-8375.19 158.5,-8385.19 165.5,-8385.19"/>
</g>
<!-- mlp_fc1_2_l7 -->
<g id="node101" class="node">
<title>mlp_fc1_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="568,-8464.08 314,-8464.08 314,-8412.08 568,-8412.08 568,-8464.08"/>
<text text-anchor="middle" x="441" y="-8452.08" font-family="Arial" font-size="10.00">MLP FC1 (L7)</text>
<text text-anchor="middle" x="441" y="-8441.08" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-8430.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-8419.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l7 -->
<g id="node103" class="node">
<title>mlp_fc2_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-8375.08 310.5,-8375.08 310.5,-8323.08 571.5,-8323.08 571.5,-8375.08"/>
<text text-anchor="middle" x="441" y="-8363.08" font-family="Arial" font-size="10.00">MLP FC2 (L7)</text>
<text text-anchor="middle" x="441" y="-8352.08" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-8341.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-8330.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l7&#45;&gt;mlp_fc2_2_l7 -->
<g id="edge125" class="edge">
<title>mlp_fc1_2_l7&#45;&gt;mlp_fc2_2_l7</title>
<path fill="none" stroke="black" d="M441,-8411.91C441,-8403.62 441,-8394.23 441,-8385.33"/>
<polygon fill="black" stroke="black" points="444.5,-8385.19 441,-8375.19 437.5,-8385.19 444.5,-8385.19"/>
</g>
<!-- tp_comm_mlp_l7 -->
<g id="node104" class="node">
<title>tp_comm_mlp_l7</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-8249.31" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-8263.31" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L7)</text>
<text text-anchor="middle" x="301" y="-8252.31" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-8241.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-8230.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l7&#45;&gt;tp_comm_mlp_l7 -->
<g id="edge126" class="edge">
<title>mlp_fc2_1_l7&#45;&gt;tp_comm_mlp_l7</title>
<path fill="none" stroke="black" d="M197.8,-8322.9C211.71,-8313.11 228,-8301.65 243.48,-8290.77"/>
<polygon fill="black" stroke="black" points="245.8,-8293.41 251.97,-8284.8 241.77,-8287.69 245.8,-8293.41"/>
</g>
<!-- mlp_fc2_2_l7&#45;&gt;tp_comm_mlp_l7 -->
<g id="edge127" class="edge">
<title>mlp_fc2_2_l7&#45;&gt;tp_comm_mlp_l7</title>
<path fill="none" stroke="black" d="M404.95,-8322.9C390.93,-8313.11 374.52,-8301.65 358.94,-8290.77"/>
<polygon fill="black" stroke="black" points="360.59,-8287.65 350.38,-8284.8 356.58,-8293.39 360.59,-8287.65"/>
</g>
<!-- ln2_1_l7 -->
<g id="node107" class="node">
<title>ln2_1_l7</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-8175.54 29.5,-8175.54 29.5,-8123.54 290.5,-8123.54 290.5,-8175.54"/>
<text text-anchor="middle" x="160" y="-8163.54" font-family="Arial" font-size="10.00">LayerNorm2 (L7)</text>
<text text-anchor="middle" x="160" y="-8152.54" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-8141.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-8130.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l7&#45;&gt;ln2_1_l7 -->
<g id="edge128" class="edge">
<title>tp_comm_mlp_l7&#45;&gt;ln2_1_l7</title>
<path fill="none" stroke="black" d="M251.29,-8213.84C236.18,-8203.36 219.67,-8191.91 204.89,-8181.67"/>
<polygon fill="black" stroke="black" points="206.63,-8178.61 196.42,-8175.79 202.64,-8184.36 206.63,-8178.61"/>
</g>
<!-- ln2_2_l7 -->
<g id="node108" class="node">
<title>ln2_2_l7</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-8175.54 312.5,-8175.54 312.5,-8123.54 573.5,-8123.54 573.5,-8175.54"/>
<text text-anchor="middle" x="443" y="-8163.54" font-family="Arial" font-size="10.00">LayerNorm2 (L7)</text>
<text text-anchor="middle" x="443" y="-8152.54" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-8141.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-8130.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l7&#45;&gt;ln2_2_l7 -->
<g id="edge129" class="edge">
<title>tp_comm_mlp_l7&#45;&gt;ln2_2_l7</title>
<path fill="none" stroke="black" d="M351.06,-8213.84C366.28,-8203.36 382.91,-8191.91 397.79,-8181.67"/>
<polygon fill="black" stroke="black" points="400.07,-8184.34 406.32,-8175.79 396.1,-8178.58 400.07,-8184.34"/>
</g>
<!-- ln1_1_l7&#45;&gt;mlp_fc1_1_l7 -->
<g id="edge122" class="edge">
<title>ln1_1_l7&#45;&gt;mlp_fc1_1_l7</title>
<path fill="none" stroke="black" d="M162,-8500.91C162,-8492.62 162,-8483.23 162,-8474.33"/>
<polygon fill="black" stroke="black" points="165.5,-8474.19 162,-8464.19 158.5,-8474.19 165.5,-8474.19"/>
</g>
<!-- ln1_2_l7&#45;&gt;mlp_fc1_2_l7 -->
<g id="edge123" class="edge">
<title>ln1_2_l7&#45;&gt;mlp_fc1_2_l7</title>
<path fill="none" stroke="black" d="M441,-8500.91C441,-8492.62 441,-8483.23 441,-8474.33"/>
<polygon fill="black" stroke="black" points="444.5,-8474.19 441,-8464.19 437.5,-8474.19 444.5,-8474.19"/>
</g>
<!-- attn_qkv_1_l8 -->
<g id="node109" class="node">
<title>attn_qkv_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="292,-8086.54 22,-8086.54 22,-8034.54 292,-8034.54 292,-8086.54"/>
<text text-anchor="middle" x="157" y="-8074.54" font-family="Arial" font-size="10.00">Attention QKV (L8)</text>
<text text-anchor="middle" x="157" y="-8063.54" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-8052.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-8041.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l7&#45;&gt;attn_qkv_1_l8 -->
<g id="edge130" class="edge">
<title>ln2_1_l7&#45;&gt;attn_qkv_1_l8</title>
<path fill="none" stroke="black" d="M159.13,-8123.37C158.85,-8115.08 158.52,-8105.69 158.22,-8096.79"/>
<polygon fill="black" stroke="black" points="161.71,-8096.52 157.87,-8086.65 154.71,-8096.76 161.71,-8096.52"/>
</g>
<!-- attn_qkv_2_l8 -->
<g id="node110" class="node">
<title>attn_qkv_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="580,-8086.54 310,-8086.54 310,-8034.54 580,-8034.54 580,-8086.54"/>
<text text-anchor="middle" x="445" y="-8074.54" font-family="Arial" font-size="10.00">Attention QKV (L8)</text>
<text text-anchor="middle" x="445" y="-8063.54" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-8052.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-8041.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l7&#45;&gt;attn_qkv_2_l8 -->
<g id="edge131" class="edge">
<title>ln2_2_l7&#45;&gt;attn_qkv_2_l8</title>
<path fill="none" stroke="black" d="M443.58,-8123.37C443.77,-8115.08 443.98,-8105.69 444.19,-8096.79"/>
<polygon fill="black" stroke="black" points="447.69,-8096.72 444.42,-8086.65 440.69,-8096.56 447.69,-8096.72"/>
</g>
<!-- tp_comm_attn_l8 -->
<g id="node111" class="node">
<title>tp_comm_attn_l8</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-7960.77" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7974.77" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L8)</text>
<text text-anchor="middle" x="301" y="-7963.77" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-7952.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-7941.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l8&#45;&gt;tp_comm_attn_l8 -->
<g id="edge132" class="edge">
<title>attn_qkv_1_l8&#45;&gt;tp_comm_attn_l8</title>
<path fill="none" stroke="black" d="M194.08,-8034.36C208.63,-8024.48 225.69,-8012.9 241.85,-8001.93"/>
<polygon fill="black" stroke="black" points="243.9,-8004.77 250.2,-7996.26 239.96,-7998.98 243.9,-8004.77"/>
</g>
<!-- attn_qkv_2_l8&#45;&gt;tp_comm_attn_l8 -->
<g id="edge133" class="edge">
<title>attn_qkv_2_l8&#45;&gt;tp_comm_attn_l8</title>
<path fill="none" stroke="black" d="M407.92,-8034.36C393.37,-8024.48 376.31,-8012.9 360.15,-8001.93"/>
<polygon fill="black" stroke="black" points="362.04,-7998.98 351.8,-7996.26 358.1,-8004.77 362.04,-7998.98"/>
</g>
<!-- attn_out_1_l8 -->
<g id="node112" class="node">
<title>attn_out_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-7887 29.5,-7887 29.5,-7835 292.5,-7835 292.5,-7887"/>
<text text-anchor="middle" x="161" y="-7875" font-family="Arial" font-size="10.00">Attention Output (L8)</text>
<text text-anchor="middle" x="161" y="-7864" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-7853" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-7842" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l8&#45;&gt;attn_out_1_l8 -->
<g id="edge134" class="edge">
<title>tp_comm_attn_l8&#45;&gt;attn_out_1_l8</title>
<path fill="none" stroke="black" d="M251.25,-7925.02C236.27,-7914.56 219.93,-7903.16 205.33,-7892.96"/>
<polygon fill="black" stroke="black" points="207.16,-7889.97 196.96,-7887.11 203.15,-7895.71 207.16,-7889.97"/>
</g>
<!-- attn_out_2_l8 -->
<g id="node113" class="node">
<title>attn_out_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-7887 310.5,-7887 310.5,-7835 573.5,-7835 573.5,-7887"/>
<text text-anchor="middle" x="442" y="-7875" font-family="Arial" font-size="10.00">Attention Output (L8)</text>
<text text-anchor="middle" x="442" y="-7864" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-7853" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-7842" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l8&#45;&gt;attn_out_2_l8 -->
<g id="edge135" class="edge">
<title>tp_comm_attn_l8&#45;&gt;attn_out_2_l8</title>
<path fill="none" stroke="black" d="M351.11,-7925.02C366.19,-7914.56 382.64,-7903.16 397.35,-7892.96"/>
<polygon fill="black" stroke="black" points="399.56,-7895.68 405.79,-7887.11 395.57,-7889.93 399.56,-7895.68"/>
</g>
<!-- tp_comm_attn_out_l8 -->
<g id="node114" class="node">
<title>tp_comm_attn_out_l8</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-7761.23" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7775.23" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L8)</text>
<text text-anchor="middle" x="301" y="-7764.23" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-7753.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-7742.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l8&#45;&gt;tp_comm_attn_out_l8 -->
<g id="edge136" class="edge">
<title>attn_out_1_l8&#45;&gt;tp_comm_attn_out_l8</title>
<path fill="none" stroke="black" d="M197.05,-7834.82C211.07,-7825.04 227.48,-7813.58 243.06,-7802.69"/>
<polygon fill="black" stroke="black" points="245.42,-7805.31 251.62,-7796.72 241.41,-7799.57 245.42,-7805.31"/>
</g>
<!-- attn_out_2_l8&#45;&gt;tp_comm_attn_out_l8 -->
<g id="edge137" class="edge">
<title>attn_out_2_l8&#45;&gt;tp_comm_attn_out_l8</title>
<path fill="none" stroke="black" d="M405.69,-7834.82C391.58,-7825.04 375.05,-7813.58 359.35,-7802.69"/>
<polygon fill="black" stroke="black" points="360.95,-7799.54 350.74,-7796.72 356.96,-7805.29 360.95,-7799.54"/>
</g>
<!-- ln1_1_l8 -->
<g id="node120" class="node">
<title>ln1_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-7687.46 30.5,-7687.46 30.5,-7635.46 291.5,-7635.46 291.5,-7687.46"/>
<text text-anchor="middle" x="161" y="-7675.46" font-family="Arial" font-size="10.00">LayerNorm1 (L8)</text>
<text text-anchor="middle" x="161" y="-7664.46" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-7653.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="161" y="-7642.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l8&#45;&gt;ln1_1_l8 -->
<g id="edge138" class="edge">
<title>tp_comm_attn_out_l8&#45;&gt;ln1_1_l8</title>
<path fill="none" stroke="black" d="M251.64,-7725.76C236.64,-7715.28 220.24,-7703.83 205.57,-7693.59"/>
<polygon fill="black" stroke="black" points="207.36,-7690.57 197.16,-7687.71 203.35,-7696.31 207.36,-7690.57"/>
</g>
<!-- ln1_2_l8 -->
<g id="node121" class="node">
<title>ln1_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-7687.46 309.5,-7687.46 309.5,-7635.46 570.5,-7635.46 570.5,-7687.46"/>
<text text-anchor="middle" x="440" y="-7675.46" font-family="Arial" font-size="10.00">LayerNorm1 (L8)</text>
<text text-anchor="middle" x="440" y="-7664.46" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-7653.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="440" y="-7642.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l8&#45;&gt;ln1_2_l8 -->
<g id="edge139" class="edge">
<title>tp_comm_attn_out_l8&#45;&gt;ln1_2_l8</title>
<path fill="none" stroke="black" d="M350.01,-7725.76C364.9,-7715.28 381.18,-7703.83 395.75,-7693.59"/>
<polygon fill="black" stroke="black" points="397.93,-7696.33 404.1,-7687.71 393.91,-7690.6 397.93,-7696.33"/>
</g>
<!-- mlp_fc1_1_l8 -->
<g id="node115" class="node">
<title>mlp_fc1_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="288,-7598.46 34,-7598.46 34,-7546.46 288,-7546.46 288,-7598.46"/>
<text text-anchor="middle" x="161" y="-7586.46" font-family="Arial" font-size="10.00">MLP FC1 (L8)</text>
<text text-anchor="middle" x="161" y="-7575.46" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-7564.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="161" y="-7553.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l8 -->
<g id="node117" class="node">
<title>mlp_fc2_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-7509.46 30.5,-7509.46 30.5,-7457.46 291.5,-7457.46 291.5,-7509.46"/>
<text text-anchor="middle" x="161" y="-7497.46" font-family="Arial" font-size="10.00">MLP FC2 (L8)</text>
<text text-anchor="middle" x="161" y="-7486.46" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-7475.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="161" y="-7464.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l8&#45;&gt;mlp_fc2_1_l8 -->
<g id="edge142" class="edge">
<title>mlp_fc1_1_l8&#45;&gt;mlp_fc2_1_l8</title>
<path fill="none" stroke="black" d="M161,-7546.3C161,-7538 161,-7528.62 161,-7519.71"/>
<polygon fill="black" stroke="black" points="164.5,-7519.57 161,-7509.57 157.5,-7519.57 164.5,-7519.57"/>
</g>
<!-- mlp_fc1_2_l8 -->
<g id="node116" class="node">
<title>mlp_fc1_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="567,-7598.46 313,-7598.46 313,-7546.46 567,-7546.46 567,-7598.46"/>
<text text-anchor="middle" x="440" y="-7586.46" font-family="Arial" font-size="10.00">MLP FC1 (L8)</text>
<text text-anchor="middle" x="440" y="-7575.46" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-7564.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="440" y="-7553.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l8 -->
<g id="node118" class="node">
<title>mlp_fc2_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-7509.46 309.5,-7509.46 309.5,-7457.46 570.5,-7457.46 570.5,-7509.46"/>
<text text-anchor="middle" x="440" y="-7497.46" font-family="Arial" font-size="10.00">MLP FC2 (L8)</text>
<text text-anchor="middle" x="440" y="-7486.46" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-7475.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="440" y="-7464.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l8&#45;&gt;mlp_fc2_2_l8 -->
<g id="edge143" class="edge">
<title>mlp_fc1_2_l8&#45;&gt;mlp_fc2_2_l8</title>
<path fill="none" stroke="black" d="M440,-7546.3C440,-7538 440,-7528.62 440,-7519.71"/>
<polygon fill="black" stroke="black" points="443.5,-7519.57 440,-7509.57 436.5,-7519.57 443.5,-7519.57"/>
</g>
<!-- tp_comm_mlp_l8 -->
<g id="node119" class="node">
<title>tp_comm_mlp_l8</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-7383.69" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7397.69" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L8)</text>
<text text-anchor="middle" x="301" y="-7386.69" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-7375.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-7364.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l8&#45;&gt;tp_comm_mlp_l8 -->
<g id="edge144" class="edge">
<title>mlp_fc2_1_l8&#45;&gt;tp_comm_mlp_l8</title>
<path fill="none" stroke="black" d="M197.05,-7457.28C211.07,-7447.5 227.48,-7436.04 243.06,-7425.15"/>
<polygon fill="black" stroke="black" points="245.42,-7427.77 251.62,-7419.18 241.41,-7422.04 245.42,-7427.77"/>
</g>
<!-- mlp_fc2_2_l8&#45;&gt;tp_comm_mlp_l8 -->
<g id="edge145" class="edge">
<title>mlp_fc2_2_l8&#45;&gt;tp_comm_mlp_l8</title>
<path fill="none" stroke="black" d="M404.2,-7457.28C390.29,-7447.5 374,-7436.04 358.52,-7425.15"/>
<polygon fill="black" stroke="black" points="360.23,-7422.07 350.03,-7419.18 356.2,-7427.79 360.23,-7422.07"/>
</g>
<!-- ln2_1_l8 -->
<g id="node122" class="node">
<title>ln2_1_l8</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-7309.92 29.5,-7309.92 29.5,-7257.92 290.5,-7257.92 290.5,-7309.92"/>
<text text-anchor="middle" x="160" y="-7297.92" font-family="Arial" font-size="10.00">LayerNorm2 (L8)</text>
<text text-anchor="middle" x="160" y="-7286.92" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-7275.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-7264.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l8&#45;&gt;ln2_1_l8 -->
<g id="edge146" class="edge">
<title>tp_comm_mlp_l8&#45;&gt;ln2_1_l8</title>
<path fill="none" stroke="black" d="M251.29,-7348.22C236.18,-7337.74 219.67,-7326.29 204.89,-7316.05"/>
<polygon fill="black" stroke="black" points="206.63,-7312.99 196.42,-7310.17 202.64,-7318.75 206.63,-7312.99"/>
</g>
<!-- ln2_2_l8 -->
<g id="node123" class="node">
<title>ln2_2_l8</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-7309.92 312.5,-7309.92 312.5,-7257.92 573.5,-7257.92 573.5,-7309.92"/>
<text text-anchor="middle" x="443" y="-7297.92" font-family="Arial" font-size="10.00">LayerNorm2 (L8)</text>
<text text-anchor="middle" x="443" y="-7286.92" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-7275.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-7264.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l8&#45;&gt;ln2_2_l8 -->
<g id="edge147" class="edge">
<title>tp_comm_mlp_l8&#45;&gt;ln2_2_l8</title>
<path fill="none" stroke="black" d="M351.06,-7348.22C366.28,-7337.74 382.91,-7326.29 397.79,-7316.05"/>
<polygon fill="black" stroke="black" points="400.07,-7318.73 406.32,-7310.17 396.1,-7312.96 400.07,-7318.73"/>
</g>
<!-- ln1_1_l8&#45;&gt;mlp_fc1_1_l8 -->
<g id="edge140" class="edge">
<title>ln1_1_l8&#45;&gt;mlp_fc1_1_l8</title>
<path fill="none" stroke="black" d="M161,-7635.3C161,-7627 161,-7617.62 161,-7608.71"/>
<polygon fill="black" stroke="black" points="164.5,-7608.57 161,-7598.57 157.5,-7608.57 164.5,-7608.57"/>
</g>
<!-- ln1_2_l8&#45;&gt;mlp_fc1_2_l8 -->
<g id="edge141" class="edge">
<title>ln1_2_l8&#45;&gt;mlp_fc1_2_l8</title>
<path fill="none" stroke="black" d="M440,-7635.3C440,-7627 440,-7617.62 440,-7608.71"/>
<polygon fill="black" stroke="black" points="443.5,-7608.57 440,-7598.57 436.5,-7608.57 443.5,-7608.57"/>
</g>
<!-- attn_qkv_1_l9 -->
<g id="node124" class="node">
<title>attn_qkv_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="292,-7220.92 22,-7220.92 22,-7168.92 292,-7168.92 292,-7220.92"/>
<text text-anchor="middle" x="157" y="-7208.92" font-family="Arial" font-size="10.00">Attention QKV (L9)</text>
<text text-anchor="middle" x="157" y="-7197.92" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-7186.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-7175.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l8&#45;&gt;attn_qkv_1_l9 -->
<g id="edge148" class="edge">
<title>ln2_1_l8&#45;&gt;attn_qkv_1_l9</title>
<path fill="none" stroke="black" d="M159.13,-7257.76C158.85,-7249.46 158.52,-7240.08 158.22,-7231.17"/>
<polygon fill="black" stroke="black" points="161.71,-7230.9 157.87,-7221.03 154.71,-7231.14 161.71,-7230.9"/>
</g>
<!-- attn_qkv_2_l9 -->
<g id="node125" class="node">
<title>attn_qkv_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="580,-7220.92 310,-7220.92 310,-7168.92 580,-7168.92 580,-7220.92"/>
<text text-anchor="middle" x="445" y="-7208.92" font-family="Arial" font-size="10.00">Attention QKV (L9)</text>
<text text-anchor="middle" x="445" y="-7197.92" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-7186.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-7175.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l8&#45;&gt;attn_qkv_2_l9 -->
<g id="edge149" class="edge">
<title>ln2_2_l8&#45;&gt;attn_qkv_2_l9</title>
<path fill="none" stroke="black" d="M443.58,-7257.76C443.77,-7249.46 443.98,-7240.08 444.19,-7231.17"/>
<polygon fill="black" stroke="black" points="447.69,-7231.11 444.42,-7221.03 440.69,-7230.95 447.69,-7231.11"/>
</g>
<!-- tp_comm_attn_l9 -->
<g id="node126" class="node">
<title>tp_comm_attn_l9</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-7095.15" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-7109.15" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L9)</text>
<text text-anchor="middle" x="301" y="-7098.15" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-7087.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-7076.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l9&#45;&gt;tp_comm_attn_l9 -->
<g id="edge150" class="edge">
<title>attn_qkv_1_l9&#45;&gt;tp_comm_attn_l9</title>
<path fill="none" stroke="black" d="M194.08,-7168.74C208.63,-7158.87 225.69,-7147.29 241.85,-7136.31"/>
<polygon fill="black" stroke="black" points="243.9,-7139.15 250.2,-7130.64 239.96,-7133.36 243.9,-7139.15"/>
</g>
<!-- attn_qkv_2_l9&#45;&gt;tp_comm_attn_l9 -->
<g id="edge151" class="edge">
<title>attn_qkv_2_l9&#45;&gt;tp_comm_attn_l9</title>
<path fill="none" stroke="black" d="M407.92,-7168.74C393.37,-7158.87 376.31,-7147.29 360.15,-7136.31"/>
<polygon fill="black" stroke="black" points="362.04,-7133.36 351.8,-7130.64 358.1,-7139.15 362.04,-7133.36"/>
</g>
<!-- attn_out_1_l9 -->
<g id="node127" class="node">
<title>attn_out_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-7021.38 29.5,-7021.38 29.5,-6969.38 292.5,-6969.38 292.5,-7021.38"/>
<text text-anchor="middle" x="161" y="-7009.38" font-family="Arial" font-size="10.00">Attention Output (L9)</text>
<text text-anchor="middle" x="161" y="-6998.38" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-6987.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-6976.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l9&#45;&gt;attn_out_1_l9 -->
<g id="edge152" class="edge">
<title>tp_comm_attn_l9&#45;&gt;attn_out_1_l9</title>
<path fill="none" stroke="black" d="M251.25,-7059.41C236.27,-7048.95 219.93,-7037.54 205.33,-7027.34"/>
<polygon fill="black" stroke="black" points="207.16,-7024.35 196.96,-7021.49 203.15,-7030.09 207.16,-7024.35"/>
</g>
<!-- attn_out_2_l9 -->
<g id="node128" class="node">
<title>attn_out_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-7021.38 310.5,-7021.38 310.5,-6969.38 573.5,-6969.38 573.5,-7021.38"/>
<text text-anchor="middle" x="442" y="-7009.38" font-family="Arial" font-size="10.00">Attention Output (L9)</text>
<text text-anchor="middle" x="442" y="-6998.38" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-6987.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-6976.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l9&#45;&gt;attn_out_2_l9 -->
<g id="edge153" class="edge">
<title>tp_comm_attn_l9&#45;&gt;attn_out_2_l9</title>
<path fill="none" stroke="black" d="M351.11,-7059.41C366.19,-7048.95 382.64,-7037.54 397.35,-7027.34"/>
<polygon fill="black" stroke="black" points="399.56,-7030.07 405.79,-7021.49 395.57,-7024.31 399.56,-7030.07"/>
</g>
<!-- tp_comm_attn_out_l9 -->
<g id="node129" class="node">
<title>tp_comm_attn_out_l9</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-6895.61" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-6909.61" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L9)</text>
<text text-anchor="middle" x="301" y="-6898.61" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-6887.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-6876.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l9&#45;&gt;tp_comm_attn_out_l9 -->
<g id="edge154" class="edge">
<title>attn_out_1_l9&#45;&gt;tp_comm_attn_out_l9</title>
<path fill="none" stroke="black" d="M197.05,-6969.2C211.07,-6959.42 227.48,-6947.96 243.06,-6937.07"/>
<polygon fill="black" stroke="black" points="245.42,-6939.7 251.62,-6931.1 241.41,-6933.96 245.42,-6939.7"/>
</g>
<!-- attn_out_2_l9&#45;&gt;tp_comm_attn_out_l9 -->
<g id="edge155" class="edge">
<title>attn_out_2_l9&#45;&gt;tp_comm_attn_out_l9</title>
<path fill="none" stroke="black" d="M405.69,-6969.2C391.58,-6959.42 375.05,-6947.96 359.35,-6937.07"/>
<polygon fill="black" stroke="black" points="360.95,-6933.92 350.74,-6931.1 356.96,-6939.68 360.95,-6933.92"/>
</g>
<!-- ln1_1_l9 -->
<g id="node135" class="node">
<title>ln1_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-6821.84 16.5,-6821.84 16.5,-6769.84 277.5,-6769.84 277.5,-6821.84"/>
<text text-anchor="middle" x="147" y="-6809.84" font-family="Arial" font-size="10.00">LayerNorm1 (L9)</text>
<text text-anchor="middle" x="147" y="-6798.84" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-6787.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="147" y="-6776.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l9&#45;&gt;ln1_1_l9 -->
<g id="edge156" class="edge">
<title>tp_comm_attn_out_l9&#45;&gt;ln1_1_l9</title>
<path fill="none" stroke="black" d="M247.14,-6860.42C230.15,-6849.63 211.51,-6837.8 194.96,-6827.29"/>
<polygon fill="black" stroke="black" points="196.83,-6824.33 186.52,-6821.93 193.08,-6830.24 196.83,-6824.33"/>
</g>
<!-- ln1_2_l9 -->
<g id="node136" class="node">
<title>ln1_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-6821.84 295.5,-6821.84 295.5,-6769.84 556.5,-6769.84 556.5,-6821.84"/>
<text text-anchor="middle" x="426" y="-6809.84" font-family="Arial" font-size="10.00">LayerNorm1 (L9)</text>
<text text-anchor="middle" x="426" y="-6798.84" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-6787.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="426" y="-6776.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l9&#45;&gt;ln1_2_l9 -->
<g id="edge157" class="edge">
<title>tp_comm_attn_out_l9&#45;&gt;ln1_2_l9</title>
<path fill="none" stroke="black" d="M345.42,-6859.87C358.55,-6849.6 372.84,-6838.43 385.69,-6828.38"/>
<polygon fill="black" stroke="black" points="388.18,-6830.87 393.9,-6821.95 383.86,-6825.36 388.18,-6830.87"/>
</g>
<!-- mlp_fc1_1_l9 -->
<g id="node130" class="node">
<title>mlp_fc1_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="274,-6732.84 20,-6732.84 20,-6680.84 274,-6680.84 274,-6732.84"/>
<text text-anchor="middle" x="147" y="-6720.84" font-family="Arial" font-size="10.00">MLP FC1 (L9)</text>
<text text-anchor="middle" x="147" y="-6709.84" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-6698.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="147" y="-6687.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l9 -->
<g id="node132" class="node">
<title>mlp_fc2_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-6643.84 16.5,-6643.84 16.5,-6591.84 277.5,-6591.84 277.5,-6643.84"/>
<text text-anchor="middle" x="147" y="-6631.84" font-family="Arial" font-size="10.00">MLP FC2 (L9)</text>
<text text-anchor="middle" x="147" y="-6620.84" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-6609.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="147" y="-6598.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l9&#45;&gt;mlp_fc2_1_l9 -->
<g id="edge160" class="edge">
<title>mlp_fc1_1_l9&#45;&gt;mlp_fc2_1_l9</title>
<path fill="none" stroke="black" d="M147,-6680.68C147,-6672.38 147,-6663 147,-6654.09"/>
<polygon fill="black" stroke="black" points="150.5,-6653.95 147,-6643.95 143.5,-6653.95 150.5,-6653.95"/>
</g>
<!-- mlp_fc1_2_l9 -->
<g id="node131" class="node">
<title>mlp_fc1_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="553,-6732.84 299,-6732.84 299,-6680.84 553,-6680.84 553,-6732.84"/>
<text text-anchor="middle" x="426" y="-6720.84" font-family="Arial" font-size="10.00">MLP FC1 (L9)</text>
<text text-anchor="middle" x="426" y="-6709.84" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-6698.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="426" y="-6687.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l9 -->
<g id="node133" class="node">
<title>mlp_fc2_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-6643.84 295.5,-6643.84 295.5,-6591.84 556.5,-6591.84 556.5,-6643.84"/>
<text text-anchor="middle" x="426" y="-6631.84" font-family="Arial" font-size="10.00">MLP FC2 (L9)</text>
<text text-anchor="middle" x="426" y="-6620.84" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-6609.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="426" y="-6598.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l9&#45;&gt;mlp_fc2_2_l9 -->
<g id="edge161" class="edge">
<title>mlp_fc1_2_l9&#45;&gt;mlp_fc2_2_l9</title>
<path fill="none" stroke="black" d="M426,-6680.68C426,-6672.38 426,-6663 426,-6654.09"/>
<polygon fill="black" stroke="black" points="429.5,-6653.95 426,-6643.95 422.5,-6653.95 429.5,-6653.95"/>
</g>
<!-- tp_comm_mlp_l9 -->
<g id="node134" class="node">
<title>tp_comm_mlp_l9</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-6518.07" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-6532.07" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L9)</text>
<text text-anchor="middle" x="301" y="-6521.07" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-6510.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-6499.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l9&#45;&gt;tp_comm_mlp_l9 -->
<g id="edge162" class="edge">
<title>mlp_fc2_1_l9&#45;&gt;tp_comm_mlp_l9</title>
<path fill="none" stroke="black" d="M186.66,-6591.66C202.44,-6581.65 220.97,-6569.88 238.47,-6558.77"/>
<polygon fill="black" stroke="black" points="240.4,-6561.69 246.97,-6553.38 236.65,-6555.78 240.4,-6561.69"/>
</g>
<!-- mlp_fc2_2_l9&#45;&gt;tp_comm_mlp_l9 -->
<g id="edge163" class="edge">
<title>mlp_fc2_2_l9&#45;&gt;tp_comm_mlp_l9</title>
<path fill="none" stroke="black" d="M393.81,-6591.66C381.59,-6582.11 367.34,-6570.96 353.72,-6560.31"/>
<polygon fill="black" stroke="black" points="355.83,-6557.52 345.8,-6554.11 351.52,-6563.03 355.83,-6557.52"/>
</g>
<!-- ln2_1_l9 -->
<g id="node137" class="node">
<title>ln2_1_l9</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-6444.3 29.5,-6444.3 29.5,-6392.3 290.5,-6392.3 290.5,-6444.3"/>
<text text-anchor="middle" x="160" y="-6432.3" font-family="Arial" font-size="10.00">LayerNorm2 (L9)</text>
<text text-anchor="middle" x="160" y="-6421.3" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-6410.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-6399.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l9&#45;&gt;ln2_1_l9 -->
<g id="edge164" class="edge">
<title>tp_comm_mlp_l9&#45;&gt;ln2_1_l9</title>
<path fill="none" stroke="black" d="M251.29,-6482.6C236.18,-6472.13 219.67,-6460.68 204.89,-6450.43"/>
<polygon fill="black" stroke="black" points="206.63,-6447.38 196.42,-6444.56 202.64,-6453.13 206.63,-6447.38"/>
</g>
<!-- ln2_2_l9 -->
<g id="node138" class="node">
<title>ln2_2_l9</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-6444.3 312.5,-6444.3 312.5,-6392.3 573.5,-6392.3 573.5,-6444.3"/>
<text text-anchor="middle" x="443" y="-6432.3" font-family="Arial" font-size="10.00">LayerNorm2 (L9)</text>
<text text-anchor="middle" x="443" y="-6421.3" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-6410.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-6399.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l9&#45;&gt;ln2_2_l9 -->
<g id="edge165" class="edge">
<title>tp_comm_mlp_l9&#45;&gt;ln2_2_l9</title>
<path fill="none" stroke="black" d="M351.06,-6482.6C366.28,-6472.13 382.91,-6460.68 397.79,-6450.43"/>
<polygon fill="black" stroke="black" points="400.07,-6453.11 406.32,-6444.56 396.1,-6447.34 400.07,-6453.11"/>
</g>
<!-- ln1_1_l9&#45;&gt;mlp_fc1_1_l9 -->
<g id="edge158" class="edge">
<title>ln1_1_l9&#45;&gt;mlp_fc1_1_l9</title>
<path fill="none" stroke="black" d="M147,-6769.68C147,-6761.38 147,-6752 147,-6743.09"/>
<polygon fill="black" stroke="black" points="150.5,-6742.95 147,-6732.95 143.5,-6742.95 150.5,-6742.95"/>
</g>
<!-- ln1_2_l9&#45;&gt;mlp_fc1_2_l9 -->
<g id="edge159" class="edge">
<title>ln1_2_l9&#45;&gt;mlp_fc1_2_l9</title>
<path fill="none" stroke="black" d="M426,-6769.68C426,-6761.38 426,-6752 426,-6743.09"/>
<polygon fill="black" stroke="black" points="429.5,-6742.95 426,-6732.95 422.5,-6742.95 429.5,-6742.95"/>
</g>
<!-- attn_qkv_1_l10 -->
<g id="node139" class="node">
<title>attn_qkv_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="292,-6355.3 22,-6355.3 22,-6303.3 292,-6303.3 292,-6355.3"/>
<text text-anchor="middle" x="157" y="-6343.3" font-family="Arial" font-size="10.00">Attention QKV (L10)</text>
<text text-anchor="middle" x="157" y="-6332.3" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-6321.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-6310.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l9&#45;&gt;attn_qkv_1_l10 -->
<g id="edge166" class="edge">
<title>ln2_1_l9&#45;&gt;attn_qkv_1_l10</title>
<path fill="none" stroke="black" d="M159.13,-6392.14C158.85,-6383.84 158.52,-6374.46 158.22,-6365.55"/>
<polygon fill="black" stroke="black" points="161.71,-6365.28 157.87,-6355.41 154.71,-6365.53 161.71,-6365.28"/>
</g>
<!-- attn_qkv_2_l10 -->
<g id="node140" class="node">
<title>attn_qkv_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="580,-6355.3 310,-6355.3 310,-6303.3 580,-6303.3 580,-6355.3"/>
<text text-anchor="middle" x="445" y="-6343.3" font-family="Arial" font-size="10.00">Attention QKV (L10)</text>
<text text-anchor="middle" x="445" y="-6332.3" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-6321.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-6310.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l9&#45;&gt;attn_qkv_2_l10 -->
<g id="edge167" class="edge">
<title>ln2_2_l9&#45;&gt;attn_qkv_2_l10</title>
<path fill="none" stroke="black" d="M443.58,-6392.14C443.77,-6383.84 443.98,-6374.46 444.19,-6365.55"/>
<polygon fill="black" stroke="black" points="447.69,-6365.49 444.42,-6355.41 440.69,-6365.33 447.69,-6365.49"/>
</g>
<!-- tp_comm_attn_l10 -->
<g id="node141" class="node">
<title>tp_comm_attn_l10</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-6229.53" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-6243.53" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L10)</text>
<text text-anchor="middle" x="301" y="-6232.53" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-6221.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-6210.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l10&#45;&gt;tp_comm_attn_l10 -->
<g id="edge168" class="edge">
<title>attn_qkv_1_l10&#45;&gt;tp_comm_attn_l10</title>
<path fill="none" stroke="black" d="M194.08,-6303.13C208.63,-6293.25 225.69,-6281.67 241.85,-6270.69"/>
<polygon fill="black" stroke="black" points="243.9,-6273.54 250.2,-6265.02 239.96,-6267.74 243.9,-6273.54"/>
</g>
<!-- attn_qkv_2_l10&#45;&gt;tp_comm_attn_l10 -->
<g id="edge169" class="edge">
<title>attn_qkv_2_l10&#45;&gt;tp_comm_attn_l10</title>
<path fill="none" stroke="black" d="M407.92,-6303.13C393.37,-6293.25 376.31,-6281.67 360.15,-6270.69"/>
<polygon fill="black" stroke="black" points="362.04,-6267.74 351.8,-6265.02 358.1,-6273.54 362.04,-6267.74"/>
</g>
<!-- attn_out_1_l10 -->
<g id="node142" class="node">
<title>attn_out_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-6155.76 28.5,-6155.76 28.5,-6103.76 291.5,-6103.76 291.5,-6155.76"/>
<text text-anchor="middle" x="160" y="-6143.76" font-family="Arial" font-size="10.00">Attention Output (L10)</text>
<text text-anchor="middle" x="160" y="-6132.76" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-6121.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="160" y="-6110.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l10&#45;&gt;attn_out_1_l10 -->
<g id="edge170" class="edge">
<title>tp_comm_attn_l10&#45;&gt;attn_out_1_l10</title>
<path fill="none" stroke="black" d="M250.89,-6193.79C235.81,-6183.33 219.36,-6171.92 204.65,-6161.72"/>
<polygon fill="black" stroke="black" points="206.43,-6158.7 196.21,-6155.88 202.44,-6164.45 206.43,-6158.7"/>
</g>
<!-- attn_out_2_l10 -->
<g id="node143" class="node">
<title>attn_out_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="572.5,-6155.76 309.5,-6155.76 309.5,-6103.76 572.5,-6103.76 572.5,-6155.76"/>
<text text-anchor="middle" x="441" y="-6143.76" font-family="Arial" font-size="10.00">Attention Output (L10)</text>
<text text-anchor="middle" x="441" y="-6132.76" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-6121.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="441" y="-6110.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l10&#45;&gt;attn_out_2_l10 -->
<g id="edge171" class="edge">
<title>tp_comm_attn_l10&#45;&gt;attn_out_2_l10</title>
<path fill="none" stroke="black" d="M350.75,-6193.79C365.73,-6183.33 382.07,-6171.92 396.67,-6161.72"/>
<polygon fill="black" stroke="black" points="398.85,-6164.47 405.04,-6155.88 394.84,-6158.73 398.85,-6164.47"/>
</g>
<!-- tp_comm_attn_out_l10 -->
<g id="node144" class="node">
<title>tp_comm_attn_out_l10</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-6030" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-6044" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L10)</text>
<text text-anchor="middle" x="301" y="-6033" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-6022" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-6011" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l10&#45;&gt;tp_comm_attn_out_l10 -->
<g id="edge172" class="edge">
<title>attn_out_1_l10&#45;&gt;tp_comm_attn_out_l10</title>
<path fill="none" stroke="black" d="M196.31,-6103.59C210.42,-6093.8 226.95,-6082.34 242.65,-6071.46"/>
<polygon fill="black" stroke="black" points="245.04,-6074.06 251.26,-6065.48 241.05,-6068.31 245.04,-6074.06"/>
</g>
<!-- attn_out_2_l10&#45;&gt;tp_comm_attn_out_l10 -->
<g id="edge173" class="edge">
<title>attn_out_2_l10&#45;&gt;tp_comm_attn_out_l10</title>
<path fill="none" stroke="black" d="M404.95,-6103.59C390.93,-6093.8 374.52,-6082.34 358.94,-6071.46"/>
<polygon fill="black" stroke="black" points="360.59,-6068.34 350.38,-6065.48 356.58,-6074.08 360.59,-6068.34"/>
</g>
<!-- ln1_1_l10 -->
<g id="node150" class="node">
<title>ln1_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-5956.23 30.5,-5956.23 30.5,-5904.23 291.5,-5904.23 291.5,-5956.23"/>
<text text-anchor="middle" x="161" y="-5944.23" font-family="Arial" font-size="10.00">LayerNorm1 (L10)</text>
<text text-anchor="middle" x="161" y="-5933.23" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-5922.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="161" y="-5911.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l10&#45;&gt;ln1_1_l10 -->
<g id="edge174" class="edge">
<title>tp_comm_attn_out_l10&#45;&gt;ln1_1_l10</title>
<path fill="none" stroke="black" d="M251.64,-5994.53C236.64,-5984.05 220.24,-5972.6 205.57,-5962.35"/>
<polygon fill="black" stroke="black" points="207.36,-5959.33 197.16,-5956.48 203.35,-5965.07 207.36,-5959.33"/>
</g>
<!-- ln1_2_l10 -->
<g id="node151" class="node">
<title>ln1_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-5956.23 309.5,-5956.23 309.5,-5904.23 570.5,-5904.23 570.5,-5956.23"/>
<text text-anchor="middle" x="440" y="-5944.23" font-family="Arial" font-size="10.00">LayerNorm1 (L10)</text>
<text text-anchor="middle" x="440" y="-5933.23" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-5922.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="440" y="-5911.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l10&#45;&gt;ln1_2_l10 -->
<g id="edge175" class="edge">
<title>tp_comm_attn_out_l10&#45;&gt;ln1_2_l10</title>
<path fill="none" stroke="black" d="M350.01,-5994.53C364.9,-5984.05 381.18,-5972.6 395.75,-5962.35"/>
<polygon fill="black" stroke="black" points="397.93,-5965.09 404.1,-5956.48 393.91,-5959.37 397.93,-5965.09"/>
</g>
<!-- mlp_fc1_1_l10 -->
<g id="node145" class="node">
<title>mlp_fc1_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="288,-5867.23 34,-5867.23 34,-5815.23 288,-5815.23 288,-5867.23"/>
<text text-anchor="middle" x="161" y="-5855.23" font-family="Arial" font-size="10.00">MLP FC1 (L10)</text>
<text text-anchor="middle" x="161" y="-5844.23" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-5833.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="161" y="-5822.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l10 -->
<g id="node147" class="node">
<title>mlp_fc2_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-5778.23 30.5,-5778.23 30.5,-5726.23 291.5,-5726.23 291.5,-5778.23"/>
<text text-anchor="middle" x="161" y="-5766.23" font-family="Arial" font-size="10.00">MLP FC2 (L10)</text>
<text text-anchor="middle" x="161" y="-5755.23" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-5744.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="161" y="-5733.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l10&#45;&gt;mlp_fc2_1_l10 -->
<g id="edge178" class="edge">
<title>mlp_fc1_1_l10&#45;&gt;mlp_fc2_1_l10</title>
<path fill="none" stroke="black" d="M161,-5815.06C161,-5806.77 161,-5797.38 161,-5788.47"/>
<polygon fill="black" stroke="black" points="164.5,-5788.33 161,-5778.33 157.5,-5788.33 164.5,-5788.33"/>
</g>
<!-- mlp_fc1_2_l10 -->
<g id="node146" class="node">
<title>mlp_fc1_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="567,-5867.23 313,-5867.23 313,-5815.23 567,-5815.23 567,-5867.23"/>
<text text-anchor="middle" x="440" y="-5855.23" font-family="Arial" font-size="10.00">MLP FC1 (L10)</text>
<text text-anchor="middle" x="440" y="-5844.23" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-5833.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="440" y="-5822.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l10 -->
<g id="node148" class="node">
<title>mlp_fc2_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="570.5,-5778.23 309.5,-5778.23 309.5,-5726.23 570.5,-5726.23 570.5,-5778.23"/>
<text text-anchor="middle" x="440" y="-5766.23" font-family="Arial" font-size="10.00">MLP FC2 (L10)</text>
<text text-anchor="middle" x="440" y="-5755.23" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="440" y="-5744.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="440" y="-5733.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l10&#45;&gt;mlp_fc2_2_l10 -->
<g id="edge179" class="edge">
<title>mlp_fc1_2_l10&#45;&gt;mlp_fc2_2_l10</title>
<path fill="none" stroke="black" d="M440,-5815.06C440,-5806.77 440,-5797.38 440,-5788.47"/>
<polygon fill="black" stroke="black" points="443.5,-5788.33 440,-5778.33 436.5,-5788.33 443.5,-5788.33"/>
</g>
<!-- tp_comm_mlp_l10 -->
<g id="node149" class="node">
<title>tp_comm_mlp_l10</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-5652.46" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-5666.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L10)</text>
<text text-anchor="middle" x="301" y="-5655.46" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-5644.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-5633.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l10&#45;&gt;tp_comm_mlp_l10 -->
<g id="edge180" class="edge">
<title>mlp_fc2_1_l10&#45;&gt;tp_comm_mlp_l10</title>
<path fill="none" stroke="black" d="M197.05,-5726.05C211.07,-5716.26 227.48,-5704.8 243.06,-5693.92"/>
<polygon fill="black" stroke="black" points="245.42,-5696.54 251.62,-5687.94 241.41,-5690.8 245.42,-5696.54"/>
</g>
<!-- mlp_fc2_2_l10&#45;&gt;tp_comm_mlp_l10 -->
<g id="edge181" class="edge">
<title>mlp_fc2_2_l10&#45;&gt;tp_comm_mlp_l10</title>
<path fill="none" stroke="black" d="M404.2,-5726.05C390.29,-5716.26 374,-5704.8 358.52,-5693.92"/>
<polygon fill="black" stroke="black" points="360.23,-5690.83 350.03,-5687.94 356.2,-5696.56 360.23,-5690.83"/>
</g>
<!-- ln2_1_l10 -->
<g id="node152" class="node">
<title>ln2_1_l10</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-5578.69 29.5,-5578.69 29.5,-5526.69 290.5,-5526.69 290.5,-5578.69"/>
<text text-anchor="middle" x="160" y="-5566.69" font-family="Arial" font-size="10.00">LayerNorm2 (L10)</text>
<text text-anchor="middle" x="160" y="-5555.69" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-5544.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-5533.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l10&#45;&gt;ln2_1_l10 -->
<g id="edge182" class="edge">
<title>tp_comm_mlp_l10&#45;&gt;ln2_1_l10</title>
<path fill="none" stroke="black" d="M251.29,-5616.99C236.18,-5606.51 219.67,-5595.06 204.89,-5584.81"/>
<polygon fill="black" stroke="black" points="206.63,-5581.76 196.42,-5578.94 202.64,-5587.51 206.63,-5581.76"/>
</g>
<!-- ln2_2_l10 -->
<g id="node153" class="node">
<title>ln2_2_l10</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-5578.69 312.5,-5578.69 312.5,-5526.69 573.5,-5526.69 573.5,-5578.69"/>
<text text-anchor="middle" x="443" y="-5566.69" font-family="Arial" font-size="10.00">LayerNorm2 (L10)</text>
<text text-anchor="middle" x="443" y="-5555.69" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-5544.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-5533.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l10&#45;&gt;ln2_2_l10 -->
<g id="edge183" class="edge">
<title>tp_comm_mlp_l10&#45;&gt;ln2_2_l10</title>
<path fill="none" stroke="black" d="M351.06,-5616.99C366.28,-5606.51 382.91,-5595.06 397.79,-5584.81"/>
<polygon fill="black" stroke="black" points="400.07,-5587.49 406.32,-5578.94 396.1,-5581.73 400.07,-5587.49"/>
</g>
<!-- ln1_1_l10&#45;&gt;mlp_fc1_1_l10 -->
<g id="edge176" class="edge">
<title>ln1_1_l10&#45;&gt;mlp_fc1_1_l10</title>
<path fill="none" stroke="black" d="M161,-5904.06C161,-5895.77 161,-5886.38 161,-5877.47"/>
<polygon fill="black" stroke="black" points="164.5,-5877.33 161,-5867.33 157.5,-5877.33 164.5,-5877.33"/>
</g>
<!-- ln1_2_l10&#45;&gt;mlp_fc1_2_l10 -->
<g id="edge177" class="edge">
<title>ln1_2_l10&#45;&gt;mlp_fc1_2_l10</title>
<path fill="none" stroke="black" d="M440,-5904.06C440,-5895.77 440,-5886.38 440,-5877.47"/>
<polygon fill="black" stroke="black" points="443.5,-5877.33 440,-5867.33 436.5,-5877.33 443.5,-5877.33"/>
</g>
<!-- attn_qkv_1_l11 -->
<g id="node154" class="node">
<title>attn_qkv_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="292,-5489.69 22,-5489.69 22,-5437.69 292,-5437.69 292,-5489.69"/>
<text text-anchor="middle" x="157" y="-5477.69" font-family="Arial" font-size="10.00">Attention QKV (L11)</text>
<text text-anchor="middle" x="157" y="-5466.69" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-5455.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-5444.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l10&#45;&gt;attn_qkv_1_l11 -->
<g id="edge184" class="edge">
<title>ln2_1_l10&#45;&gt;attn_qkv_1_l11</title>
<path fill="none" stroke="black" d="M159.13,-5526.52C158.85,-5518.23 158.52,-5508.84 158.22,-5499.94"/>
<polygon fill="black" stroke="black" points="161.71,-5499.67 157.87,-5489.79 154.71,-5499.91 161.71,-5499.67"/>
</g>
<!-- attn_qkv_2_l11 -->
<g id="node155" class="node">
<title>attn_qkv_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="580,-5489.69 310,-5489.69 310,-5437.69 580,-5437.69 580,-5489.69"/>
<text text-anchor="middle" x="445" y="-5477.69" font-family="Arial" font-size="10.00">Attention QKV (L11)</text>
<text text-anchor="middle" x="445" y="-5466.69" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-5455.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-5444.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l10&#45;&gt;attn_qkv_2_l11 -->
<g id="edge185" class="edge">
<title>ln2_2_l10&#45;&gt;attn_qkv_2_l11</title>
<path fill="none" stroke="black" d="M443.58,-5526.52C443.77,-5518.23 443.98,-5508.84 444.19,-5499.94"/>
<polygon fill="black" stroke="black" points="447.69,-5499.87 444.42,-5489.79 440.69,-5499.71 447.69,-5499.87"/>
</g>
<!-- tp_comm_attn_l11 -->
<g id="node156" class="node">
<title>tp_comm_attn_l11</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-5363.92" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-5377.92" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L11)</text>
<text text-anchor="middle" x="301" y="-5366.92" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-5355.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-5344.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l11&#45;&gt;tp_comm_attn_l11 -->
<g id="edge186" class="edge">
<title>attn_qkv_1_l11&#45;&gt;tp_comm_attn_l11</title>
<path fill="none" stroke="black" d="M194.08,-5437.51C208.63,-5427.63 225.69,-5416.05 241.85,-5405.08"/>
<polygon fill="black" stroke="black" points="243.9,-5407.92 250.2,-5399.41 239.96,-5402.13 243.9,-5407.92"/>
</g>
<!-- attn_qkv_2_l11&#45;&gt;tp_comm_attn_l11 -->
<g id="edge187" class="edge">
<title>attn_qkv_2_l11&#45;&gt;tp_comm_attn_l11</title>
<path fill="none" stroke="black" d="M407.92,-5437.51C393.37,-5427.63 376.31,-5416.05 360.15,-5405.08"/>
<polygon fill="black" stroke="black" points="362.04,-5402.13 351.8,-5399.41 358.1,-5407.92 362.04,-5402.13"/>
</g>
<!-- attn_out_1_l11 -->
<g id="node157" class="node">
<title>attn_out_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-5290.15 29.5,-5290.15 29.5,-5238.15 292.5,-5238.15 292.5,-5290.15"/>
<text text-anchor="middle" x="161" y="-5278.15" font-family="Arial" font-size="10.00">Attention Output (L11)</text>
<text text-anchor="middle" x="161" y="-5267.15" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-5256.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-5245.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l11&#45;&gt;attn_out_1_l11 -->
<g id="edge188" class="edge">
<title>tp_comm_attn_l11&#45;&gt;attn_out_1_l11</title>
<path fill="none" stroke="black" d="M251.25,-5328.17C236.27,-5317.71 219.93,-5306.3 205.33,-5296.11"/>
<polygon fill="black" stroke="black" points="207.16,-5293.11 196.96,-5290.26 203.15,-5298.85 207.16,-5293.11"/>
</g>
<!-- attn_out_2_l11 -->
<g id="node158" class="node">
<title>attn_out_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-5290.15 310.5,-5290.15 310.5,-5238.15 573.5,-5238.15 573.5,-5290.15"/>
<text text-anchor="middle" x="442" y="-5278.15" font-family="Arial" font-size="10.00">Attention Output (L11)</text>
<text text-anchor="middle" x="442" y="-5267.15" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-5256.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-5245.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l11&#45;&gt;attn_out_2_l11 -->
<g id="edge189" class="edge">
<title>tp_comm_attn_l11&#45;&gt;attn_out_2_l11</title>
<path fill="none" stroke="black" d="M351.11,-5328.17C366.19,-5317.71 382.64,-5306.3 397.35,-5296.11"/>
<polygon fill="black" stroke="black" points="399.56,-5298.83 405.79,-5290.26 395.57,-5293.08 399.56,-5298.83"/>
</g>
<!-- tp_comm_attn_out_l11 -->
<g id="node159" class="node">
<title>tp_comm_attn_out_l11</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-5164.38" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-5178.38" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L11)</text>
<text text-anchor="middle" x="301" y="-5167.38" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-5156.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-5145.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l11&#45;&gt;tp_comm_attn_out_l11 -->
<g id="edge190" class="edge">
<title>attn_out_1_l11&#45;&gt;tp_comm_attn_out_l11</title>
<path fill="none" stroke="black" d="M197.05,-5237.97C211.07,-5228.18 227.48,-5216.72 243.06,-5205.84"/>
<polygon fill="black" stroke="black" points="245.42,-5208.46 251.62,-5199.87 241.41,-5202.72 245.42,-5208.46"/>
</g>
<!-- attn_out_2_l11&#45;&gt;tp_comm_attn_out_l11 -->
<g id="edge191" class="edge">
<title>attn_out_2_l11&#45;&gt;tp_comm_attn_out_l11</title>
<path fill="none" stroke="black" d="M405.69,-5237.97C391.58,-5228.18 375.05,-5216.72 359.35,-5205.84"/>
<polygon fill="black" stroke="black" points="360.95,-5202.69 350.74,-5199.87 356.96,-5208.44 360.95,-5202.69"/>
</g>
<!-- ln1_1_l11 -->
<g id="node165" class="node">
<title>ln1_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-5090.61 16.5,-5090.61 16.5,-5038.61 277.5,-5038.61 277.5,-5090.61"/>
<text text-anchor="middle" x="147" y="-5078.61" font-family="Arial" font-size="10.00">LayerNorm1 (L11)</text>
<text text-anchor="middle" x="147" y="-5067.61" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-5056.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="147" y="-5045.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l11&#45;&gt;ln1_1_l11 -->
<g id="edge192" class="edge">
<title>tp_comm_attn_out_l11&#45;&gt;ln1_1_l11</title>
<path fill="none" stroke="black" d="M247.14,-5129.18C230.15,-5118.4 211.51,-5106.56 194.96,-5096.06"/>
<polygon fill="black" stroke="black" points="196.83,-5093.1 186.52,-5090.7 193.08,-5099.01 196.83,-5093.1"/>
</g>
<!-- ln1_2_l11 -->
<g id="node166" class="node">
<title>ln1_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-5090.61 295.5,-5090.61 295.5,-5038.61 556.5,-5038.61 556.5,-5090.61"/>
<text text-anchor="middle" x="426" y="-5078.61" font-family="Arial" font-size="10.00">LayerNorm1 (L11)</text>
<text text-anchor="middle" x="426" y="-5067.61" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-5056.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="426" y="-5045.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l11&#45;&gt;ln1_2_l11 -->
<g id="edge193" class="edge">
<title>tp_comm_attn_out_l11&#45;&gt;ln1_2_l11</title>
<path fill="none" stroke="black" d="M345.42,-5128.63C358.55,-5118.37 372.84,-5107.19 385.69,-5097.14"/>
<polygon fill="black" stroke="black" points="388.18,-5099.64 393.9,-5090.72 383.86,-5094.12 388.18,-5099.64"/>
</g>
<!-- mlp_fc1_1_l11 -->
<g id="node160" class="node">
<title>mlp_fc1_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="274,-5001.61 20,-5001.61 20,-4949.61 274,-4949.61 274,-5001.61"/>
<text text-anchor="middle" x="147" y="-4989.61" font-family="Arial" font-size="10.00">MLP FC1 (L11)</text>
<text text-anchor="middle" x="147" y="-4978.61" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-4967.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="147" y="-4956.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l11 -->
<g id="node162" class="node">
<title>mlp_fc2_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-4912.61 16.5,-4912.61 16.5,-4860.61 277.5,-4860.61 277.5,-4912.61"/>
<text text-anchor="middle" x="147" y="-4900.61" font-family="Arial" font-size="10.00">MLP FC2 (L11)</text>
<text text-anchor="middle" x="147" y="-4889.61" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-4878.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="147" y="-4867.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l11&#45;&gt;mlp_fc2_1_l11 -->
<g id="edge196" class="edge">
<title>mlp_fc1_1_l11&#45;&gt;mlp_fc2_1_l11</title>
<path fill="none" stroke="black" d="M147,-4949.44C147,-4941.15 147,-4931.76 147,-4922.86"/>
<polygon fill="black" stroke="black" points="150.5,-4922.72 147,-4912.72 143.5,-4922.72 150.5,-4922.72"/>
</g>
<!-- mlp_fc1_2_l11 -->
<g id="node161" class="node">
<title>mlp_fc1_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="553,-5001.61 299,-5001.61 299,-4949.61 553,-4949.61 553,-5001.61"/>
<text text-anchor="middle" x="426" y="-4989.61" font-family="Arial" font-size="10.00">MLP FC1 (L11)</text>
<text text-anchor="middle" x="426" y="-4978.61" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-4967.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="426" y="-4956.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l11 -->
<g id="node163" class="node">
<title>mlp_fc2_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-4912.61 295.5,-4912.61 295.5,-4860.61 556.5,-4860.61 556.5,-4912.61"/>
<text text-anchor="middle" x="426" y="-4900.61" font-family="Arial" font-size="10.00">MLP FC2 (L11)</text>
<text text-anchor="middle" x="426" y="-4889.61" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-4878.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="426" y="-4867.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l11&#45;&gt;mlp_fc2_2_l11 -->
<g id="edge197" class="edge">
<title>mlp_fc1_2_l11&#45;&gt;mlp_fc2_2_l11</title>
<path fill="none" stroke="black" d="M426,-4949.44C426,-4941.15 426,-4931.76 426,-4922.86"/>
<polygon fill="black" stroke="black" points="429.5,-4922.72 426,-4912.72 422.5,-4922.72 429.5,-4922.72"/>
</g>
<!-- tp_comm_mlp_l11 -->
<g id="node164" class="node">
<title>tp_comm_mlp_l11</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-4786.84" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4800.84" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L11)</text>
<text text-anchor="middle" x="301" y="-4789.84" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-4778.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-4767.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l11&#45;&gt;tp_comm_mlp_l11 -->
<g id="edge198" class="edge">
<title>mlp_fc2_1_l11&#45;&gt;tp_comm_mlp_l11</title>
<path fill="none" stroke="black" d="M186.66,-4860.43C202.44,-4850.41 220.97,-4838.65 238.47,-4827.53"/>
<polygon fill="black" stroke="black" points="240.4,-4830.46 246.97,-4822.14 236.65,-4824.55 240.4,-4830.46"/>
</g>
<!-- mlp_fc2_2_l11&#45;&gt;tp_comm_mlp_l11 -->
<g id="edge199" class="edge">
<title>mlp_fc2_2_l11&#45;&gt;tp_comm_mlp_l11</title>
<path fill="none" stroke="black" d="M393.81,-4860.43C381.59,-4850.88 367.34,-4839.73 353.72,-4829.08"/>
<polygon fill="black" stroke="black" points="355.83,-4826.28 345.8,-4822.88 351.52,-4831.8 355.83,-4826.28"/>
</g>
<!-- ln2_1_l11 -->
<g id="node167" class="node">
<title>ln2_1_l11</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-4713.07 29.5,-4713.07 29.5,-4661.07 290.5,-4661.07 290.5,-4713.07"/>
<text text-anchor="middle" x="160" y="-4701.07" font-family="Arial" font-size="10.00">LayerNorm2 (L11)</text>
<text text-anchor="middle" x="160" y="-4690.07" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-4679.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-4668.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l11&#45;&gt;ln2_1_l11 -->
<g id="edge200" class="edge">
<title>tp_comm_mlp_l11&#45;&gt;ln2_1_l11</title>
<path fill="none" stroke="black" d="M251.29,-4751.37C236.18,-4740.89 219.67,-4729.44 204.89,-4719.2"/>
<polygon fill="black" stroke="black" points="206.63,-4716.14 196.42,-4713.32 202.64,-4721.9 206.63,-4716.14"/>
</g>
<!-- ln2_2_l11 -->
<g id="node168" class="node">
<title>ln2_2_l11</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-4713.07 312.5,-4713.07 312.5,-4661.07 573.5,-4661.07 573.5,-4713.07"/>
<text text-anchor="middle" x="443" y="-4701.07" font-family="Arial" font-size="10.00">LayerNorm2 (L11)</text>
<text text-anchor="middle" x="443" y="-4690.07" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-4679.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-4668.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l11&#45;&gt;ln2_2_l11 -->
<g id="edge201" class="edge">
<title>tp_comm_mlp_l11&#45;&gt;ln2_2_l11</title>
<path fill="none" stroke="black" d="M351.06,-4751.37C366.28,-4740.89 382.91,-4729.44 397.79,-4719.2"/>
<polygon fill="black" stroke="black" points="400.07,-4721.87 406.32,-4713.32 396.1,-4716.11 400.07,-4721.87"/>
</g>
<!-- ln1_1_l11&#45;&gt;mlp_fc1_1_l11 -->
<g id="edge194" class="edge">
<title>ln1_1_l11&#45;&gt;mlp_fc1_1_l11</title>
<path fill="none" stroke="black" d="M147,-5038.44C147,-5030.15 147,-5020.76 147,-5011.86"/>
<polygon fill="black" stroke="black" points="150.5,-5011.72 147,-5001.72 143.5,-5011.72 150.5,-5011.72"/>
</g>
<!-- ln1_2_l11&#45;&gt;mlp_fc1_2_l11 -->
<g id="edge195" class="edge">
<title>ln1_2_l11&#45;&gt;mlp_fc1_2_l11</title>
<path fill="none" stroke="black" d="M426,-5038.44C426,-5030.15 426,-5020.76 426,-5011.86"/>
<polygon fill="black" stroke="black" points="429.5,-5011.72 426,-5001.72 422.5,-5011.72 429.5,-5011.72"/>
</g>
<!-- attn_qkv_1_l12 -->
<g id="node169" class="node">
<title>attn_qkv_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="292,-4624.07 22,-4624.07 22,-4572.07 292,-4572.07 292,-4624.07"/>
<text text-anchor="middle" x="157" y="-4612.07" font-family="Arial" font-size="10.00">Attention QKV (L12)</text>
<text text-anchor="middle" x="157" y="-4601.07" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-4590.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-4579.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l11&#45;&gt;attn_qkv_1_l12 -->
<g id="edge202" class="edge">
<title>ln2_1_l11&#45;&gt;attn_qkv_1_l12</title>
<path fill="none" stroke="black" d="M159.13,-4660.91C158.85,-4652.61 158.52,-4643.22 158.22,-4634.32"/>
<polygon fill="black" stroke="black" points="161.71,-4634.05 157.87,-4624.18 154.71,-4634.29 161.71,-4634.05"/>
</g>
<!-- attn_qkv_2_l12 -->
<g id="node170" class="node">
<title>attn_qkv_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="580,-4624.07 310,-4624.07 310,-4572.07 580,-4572.07 580,-4624.07"/>
<text text-anchor="middle" x="445" y="-4612.07" font-family="Arial" font-size="10.00">Attention QKV (L12)</text>
<text text-anchor="middle" x="445" y="-4601.07" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-4590.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-4579.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l11&#45;&gt;attn_qkv_2_l12 -->
<g id="edge203" class="edge">
<title>ln2_2_l11&#45;&gt;attn_qkv_2_l12</title>
<path fill="none" stroke="black" d="M443.58,-4660.91C443.77,-4652.61 443.98,-4643.22 444.19,-4634.32"/>
<polygon fill="black" stroke="black" points="447.69,-4634.25 444.42,-4624.18 440.69,-4634.09 447.69,-4634.25"/>
</g>
<!-- tp_comm_attn_l12 -->
<g id="node171" class="node">
<title>tp_comm_attn_l12</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-4498.3" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4512.3" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L12)</text>
<text text-anchor="middle" x="301" y="-4501.3" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-4490.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-4479.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l12&#45;&gt;tp_comm_attn_l12 -->
<g id="edge204" class="edge">
<title>attn_qkv_1_l12&#45;&gt;tp_comm_attn_l12</title>
<path fill="none" stroke="black" d="M194.08,-4571.89C208.63,-4562.01 225.69,-4550.43 241.85,-4539.46"/>
<polygon fill="black" stroke="black" points="243.9,-4542.3 250.2,-4533.79 239.96,-4536.51 243.9,-4542.3"/>
</g>
<!-- attn_qkv_2_l12&#45;&gt;tp_comm_attn_l12 -->
<g id="edge205" class="edge">
<title>attn_qkv_2_l12&#45;&gt;tp_comm_attn_l12</title>
<path fill="none" stroke="black" d="M407.92,-4571.89C393.37,-4562.01 376.31,-4550.43 360.15,-4539.46"/>
<polygon fill="black" stroke="black" points="362.04,-4536.51 351.8,-4533.79 358.1,-4542.3 362.04,-4536.51"/>
</g>
<!-- attn_out_1_l12 -->
<g id="node172" class="node">
<title>attn_out_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-4424.53 29.5,-4424.53 29.5,-4372.53 292.5,-4372.53 292.5,-4424.53"/>
<text text-anchor="middle" x="161" y="-4412.53" font-family="Arial" font-size="10.00">Attention Output (L12)</text>
<text text-anchor="middle" x="161" y="-4401.53" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-4390.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-4379.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l12&#45;&gt;attn_out_1_l12 -->
<g id="edge206" class="edge">
<title>tp_comm_attn_l12&#45;&gt;attn_out_1_l12</title>
<path fill="none" stroke="black" d="M251.25,-4462.55C236.27,-4452.09 219.93,-4440.69 205.33,-4430.49"/>
<polygon fill="black" stroke="black" points="207.16,-4427.5 196.96,-4424.64 203.15,-4433.24 207.16,-4427.5"/>
</g>
<!-- attn_out_2_l12 -->
<g id="node173" class="node">
<title>attn_out_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-4424.53 310.5,-4424.53 310.5,-4372.53 573.5,-4372.53 573.5,-4424.53"/>
<text text-anchor="middle" x="442" y="-4412.53" font-family="Arial" font-size="10.00">Attention Output (L12)</text>
<text text-anchor="middle" x="442" y="-4401.53" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-4390.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-4379.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l12&#45;&gt;attn_out_2_l12 -->
<g id="edge207" class="edge">
<title>tp_comm_attn_l12&#45;&gt;attn_out_2_l12</title>
<path fill="none" stroke="black" d="M351.11,-4462.55C366.19,-4452.09 382.64,-4440.69 397.35,-4430.49"/>
<polygon fill="black" stroke="black" points="399.56,-4433.22 405.79,-4424.64 395.57,-4427.46 399.56,-4433.22"/>
</g>
<!-- tp_comm_attn_out_l12 -->
<g id="node174" class="node">
<title>tp_comm_attn_out_l12</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-4298.76" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-4312.76" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L12)</text>
<text text-anchor="middle" x="301" y="-4301.76" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-4290.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-4279.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l12&#45;&gt;tp_comm_attn_out_l12 -->
<g id="edge208" class="edge">
<title>attn_out_1_l12&#45;&gt;tp_comm_attn_out_l12</title>
<path fill="none" stroke="black" d="M197.05,-4372.35C211.07,-4362.57 227.48,-4351.11 243.06,-4340.22"/>
<polygon fill="black" stroke="black" points="245.42,-4342.84 251.62,-4334.25 241.41,-4337.1 245.42,-4342.84"/>
</g>
<!-- attn_out_2_l12&#45;&gt;tp_comm_attn_out_l12 -->
<g id="edge209" class="edge">
<title>attn_out_2_l12&#45;&gt;tp_comm_attn_out_l12</title>
<path fill="none" stroke="black" d="M405.69,-4372.35C391.58,-4362.57 375.05,-4351.11 359.35,-4340.22"/>
<polygon fill="black" stroke="black" points="360.95,-4337.07 350.74,-4334.25 356.96,-4342.82 360.95,-4337.07"/>
</g>
<!-- ln1_1_l12 -->
<g id="node180" class="node">
<title>ln1_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="306.5,-4224.99 45.5,-4224.99 45.5,-4172.99 306.5,-4172.99 306.5,-4224.99"/>
<text text-anchor="middle" x="176" y="-4212.99" font-family="Arial" font-size="10.00">LayerNorm1 (L12)</text>
<text text-anchor="middle" x="176" y="-4201.99" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="176" y="-4190.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="176" y="-4179.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l12&#45;&gt;ln1_1_l12 -->
<g id="edge210" class="edge">
<title>tp_comm_attn_out_l12&#45;&gt;ln1_1_l12</title>
<path fill="none" stroke="black" d="M256.58,-4263.02C243.45,-4252.75 229.16,-4241.57 216.31,-4231.52"/>
<polygon fill="black" stroke="black" points="218.14,-4228.51 208.1,-4225.1 213.82,-4234.02 218.14,-4228.51"/>
</g>
<!-- ln1_2_l12 -->
<g id="node181" class="node">
<title>ln1_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="585.5,-4224.99 324.5,-4224.99 324.5,-4172.99 585.5,-4172.99 585.5,-4224.99"/>
<text text-anchor="middle" x="455" y="-4212.99" font-family="Arial" font-size="10.00">LayerNorm1 (L12)</text>
<text text-anchor="middle" x="455" y="-4201.99" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="455" y="-4190.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="455" y="-4179.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l12&#45;&gt;ln1_2_l12 -->
<g id="edge211" class="edge">
<title>tp_comm_attn_out_l12&#45;&gt;ln1_2_l12</title>
<path fill="none" stroke="black" d="M354.86,-4263.57C371.85,-4252.78 390.49,-4240.94 407.04,-4230.44"/>
<polygon fill="black" stroke="black" points="408.92,-4233.39 415.48,-4225.08 405.17,-4227.48 408.92,-4233.39"/>
</g>
<!-- mlp_fc1_1_l12 -->
<g id="node175" class="node">
<title>mlp_fc1_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="303,-4135.99 49,-4135.99 49,-4083.99 303,-4083.99 303,-4135.99"/>
<text text-anchor="middle" x="176" y="-4123.99" font-family="Arial" font-size="10.00">MLP FC1 (L12)</text>
<text text-anchor="middle" x="176" y="-4112.99" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="176" y="-4101.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="176" y="-4090.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l12 -->
<g id="node177" class="node">
<title>mlp_fc2_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="306.5,-4046.99 45.5,-4046.99 45.5,-3994.99 306.5,-3994.99 306.5,-4046.99"/>
<text text-anchor="middle" x="176" y="-4034.99" font-family="Arial" font-size="10.00">MLP FC2 (L12)</text>
<text text-anchor="middle" x="176" y="-4023.99" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="176" y="-4012.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="176" y="-4001.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l12&#45;&gt;mlp_fc2_1_l12 -->
<g id="edge214" class="edge">
<title>mlp_fc1_1_l12&#45;&gt;mlp_fc2_1_l12</title>
<path fill="none" stroke="black" d="M176,-4083.83C176,-4075.53 176,-4066.15 176,-4057.24"/>
<polygon fill="black" stroke="black" points="179.5,-4057.1 176,-4047.1 172.5,-4057.1 179.5,-4057.1"/>
</g>
<!-- mlp_fc1_2_l12 -->
<g id="node176" class="node">
<title>mlp_fc1_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="582,-4135.99 328,-4135.99 328,-4083.99 582,-4083.99 582,-4135.99"/>
<text text-anchor="middle" x="455" y="-4123.99" font-family="Arial" font-size="10.00">MLP FC1 (L12)</text>
<text text-anchor="middle" x="455" y="-4112.99" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="455" y="-4101.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="455" y="-4090.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l12 -->
<g id="node178" class="node">
<title>mlp_fc2_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="585.5,-4046.99 324.5,-4046.99 324.5,-3994.99 585.5,-3994.99 585.5,-4046.99"/>
<text text-anchor="middle" x="455" y="-4034.99" font-family="Arial" font-size="10.00">MLP FC2 (L12)</text>
<text text-anchor="middle" x="455" y="-4023.99" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="455" y="-4012.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="455" y="-4001.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l12&#45;&gt;mlp_fc2_2_l12 -->
<g id="edge215" class="edge">
<title>mlp_fc1_2_l12&#45;&gt;mlp_fc2_2_l12</title>
<path fill="none" stroke="black" d="M455,-4083.83C455,-4075.53 455,-4066.15 455,-4057.24"/>
<polygon fill="black" stroke="black" points="458.5,-4057.1 455,-4047.1 451.5,-4057.1 458.5,-4057.1"/>
</g>
<!-- tp_comm_mlp_l12 -->
<g id="node179" class="node">
<title>tp_comm_mlp_l12</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-3921.22" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3935.22" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L12)</text>
<text text-anchor="middle" x="301" y="-3924.22" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-3913.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-3902.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l12&#45;&gt;tp_comm_mlp_l12 -->
<g id="edge216" class="edge">
<title>mlp_fc2_1_l12&#45;&gt;tp_comm_mlp_l12</title>
<path fill="none" stroke="black" d="M208.19,-3994.81C220.41,-3985.26 234.66,-3974.11 248.28,-3963.46"/>
<polygon fill="black" stroke="black" points="250.48,-3966.18 256.2,-3957.26 246.17,-3960.67 250.48,-3966.18"/>
</g>
<!-- mlp_fc2_2_l12&#45;&gt;tp_comm_mlp_l12 -->
<g id="edge217" class="edge">
<title>mlp_fc2_2_l12&#45;&gt;tp_comm_mlp_l12</title>
<path fill="none" stroke="black" d="M415.34,-3994.81C399.56,-3984.8 381.03,-3973.03 363.53,-3961.92"/>
<polygon fill="black" stroke="black" points="365.35,-3958.93 355.03,-3956.53 361.6,-3964.84 365.35,-3958.93"/>
</g>
<!-- ln2_1_l12 -->
<g id="node182" class="node">
<title>ln2_1_l12</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-3847.45 29.5,-3847.45 29.5,-3795.45 290.5,-3795.45 290.5,-3847.45"/>
<text text-anchor="middle" x="160" y="-3835.45" font-family="Arial" font-size="10.00">LayerNorm2 (L12)</text>
<text text-anchor="middle" x="160" y="-3824.45" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-3813.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-3802.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l12&#45;&gt;ln2_1_l12 -->
<g id="edge218" class="edge">
<title>tp_comm_mlp_l12&#45;&gt;ln2_1_l12</title>
<path fill="none" stroke="black" d="M251.29,-3885.75C236.18,-3875.27 219.67,-3863.82 204.89,-3853.58"/>
<polygon fill="black" stroke="black" points="206.63,-3850.53 196.42,-3847.7 202.64,-3856.28 206.63,-3850.53"/>
</g>
<!-- ln2_2_l12 -->
<g id="node183" class="node">
<title>ln2_2_l12</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-3847.45 312.5,-3847.45 312.5,-3795.45 573.5,-3795.45 573.5,-3847.45"/>
<text text-anchor="middle" x="443" y="-3835.45" font-family="Arial" font-size="10.00">LayerNorm2 (L12)</text>
<text text-anchor="middle" x="443" y="-3824.45" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-3813.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-3802.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l12&#45;&gt;ln2_2_l12 -->
<g id="edge219" class="edge">
<title>tp_comm_mlp_l12&#45;&gt;ln2_2_l12</title>
<path fill="none" stroke="black" d="M351.06,-3885.75C366.28,-3875.27 382.91,-3863.82 397.79,-3853.58"/>
<polygon fill="black" stroke="black" points="400.07,-3856.26 406.32,-3847.7 396.1,-3850.49 400.07,-3856.26"/>
</g>
<!-- ln1_1_l12&#45;&gt;mlp_fc1_1_l12 -->
<g id="edge212" class="edge">
<title>ln1_1_l12&#45;&gt;mlp_fc1_1_l12</title>
<path fill="none" stroke="black" d="M176,-4172.83C176,-4164.53 176,-4155.15 176,-4146.24"/>
<polygon fill="black" stroke="black" points="179.5,-4146.1 176,-4136.1 172.5,-4146.1 179.5,-4146.1"/>
</g>
<!-- ln1_2_l12&#45;&gt;mlp_fc1_2_l12 -->
<g id="edge213" class="edge">
<title>ln1_2_l12&#45;&gt;mlp_fc1_2_l12</title>
<path fill="none" stroke="black" d="M455,-4172.83C455,-4164.53 455,-4155.15 455,-4146.24"/>
<polygon fill="black" stroke="black" points="458.5,-4146.1 455,-4136.1 451.5,-4146.1 458.5,-4146.1"/>
</g>
<!-- attn_qkv_1_l13 -->
<g id="node184" class="node">
<title>attn_qkv_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="292,-3758.45 22,-3758.45 22,-3706.45 292,-3706.45 292,-3758.45"/>
<text text-anchor="middle" x="157" y="-3746.45" font-family="Arial" font-size="10.00">Attention QKV (L13)</text>
<text text-anchor="middle" x="157" y="-3735.45" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-3724.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-3713.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l12&#45;&gt;attn_qkv_1_l13 -->
<g id="edge220" class="edge">
<title>ln2_1_l12&#45;&gt;attn_qkv_1_l13</title>
<path fill="none" stroke="black" d="M159.13,-3795.29C158.85,-3786.99 158.52,-3777.61 158.22,-3768.7"/>
<polygon fill="black" stroke="black" points="161.71,-3768.43 157.87,-3758.56 154.71,-3768.67 161.71,-3768.43"/>
</g>
<!-- attn_qkv_2_l13 -->
<g id="node185" class="node">
<title>attn_qkv_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="580,-3758.45 310,-3758.45 310,-3706.45 580,-3706.45 580,-3758.45"/>
<text text-anchor="middle" x="445" y="-3746.45" font-family="Arial" font-size="10.00">Attention QKV (L13)</text>
<text text-anchor="middle" x="445" y="-3735.45" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-3724.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-3713.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l12&#45;&gt;attn_qkv_2_l13 -->
<g id="edge221" class="edge">
<title>ln2_2_l12&#45;&gt;attn_qkv_2_l13</title>
<path fill="none" stroke="black" d="M443.58,-3795.29C443.77,-3786.99 443.98,-3777.61 444.19,-3768.7"/>
<polygon fill="black" stroke="black" points="447.69,-3768.64 444.42,-3758.56 440.69,-3768.48 447.69,-3768.64"/>
</g>
<!-- tp_comm_attn_l13 -->
<g id="node186" class="node">
<title>tp_comm_attn_l13</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-3632.68" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3646.68" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L13)</text>
<text text-anchor="middle" x="301" y="-3635.68" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-3624.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-3613.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l13&#45;&gt;tp_comm_attn_l13 -->
<g id="edge222" class="edge">
<title>attn_qkv_1_l13&#45;&gt;tp_comm_attn_l13</title>
<path fill="none" stroke="black" d="M194.08,-3706.27C208.63,-3696.4 225.69,-3684.82 241.85,-3673.84"/>
<polygon fill="black" stroke="black" points="243.9,-3676.68 250.2,-3668.17 239.96,-3670.89 243.9,-3676.68"/>
</g>
<!-- attn_qkv_2_l13&#45;&gt;tp_comm_attn_l13 -->
<g id="edge223" class="edge">
<title>attn_qkv_2_l13&#45;&gt;tp_comm_attn_l13</title>
<path fill="none" stroke="black" d="M407.92,-3706.27C393.37,-3696.4 376.31,-3684.82 360.15,-3673.84"/>
<polygon fill="black" stroke="black" points="362.04,-3670.89 351.8,-3668.17 358.1,-3676.68 362.04,-3670.89"/>
</g>
<!-- attn_out_1_l13 -->
<g id="node187" class="node">
<title>attn_out_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-3558.91 29.5,-3558.91 29.5,-3506.91 292.5,-3506.91 292.5,-3558.91"/>
<text text-anchor="middle" x="161" y="-3546.91" font-family="Arial" font-size="10.00">Attention Output (L13)</text>
<text text-anchor="middle" x="161" y="-3535.91" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-3524.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-3513.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l13&#45;&gt;attn_out_1_l13 -->
<g id="edge224" class="edge">
<title>tp_comm_attn_l13&#45;&gt;attn_out_1_l13</title>
<path fill="none" stroke="black" d="M251.25,-3596.94C236.27,-3586.48 219.93,-3575.07 205.33,-3564.87"/>
<polygon fill="black" stroke="black" points="207.16,-3561.88 196.96,-3559.02 203.15,-3567.62 207.16,-3561.88"/>
</g>
<!-- attn_out_2_l13 -->
<g id="node188" class="node">
<title>attn_out_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-3558.91 310.5,-3558.91 310.5,-3506.91 573.5,-3506.91 573.5,-3558.91"/>
<text text-anchor="middle" x="442" y="-3546.91" font-family="Arial" font-size="10.00">Attention Output (L13)</text>
<text text-anchor="middle" x="442" y="-3535.91" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-3524.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-3513.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l13&#45;&gt;attn_out_2_l13 -->
<g id="edge225" class="edge">
<title>tp_comm_attn_l13&#45;&gt;attn_out_2_l13</title>
<path fill="none" stroke="black" d="M351.11,-3596.94C366.19,-3586.48 382.64,-3575.07 397.35,-3564.87"/>
<polygon fill="black" stroke="black" points="399.56,-3567.6 405.79,-3559.02 395.57,-3561.85 399.56,-3567.6"/>
</g>
<!-- tp_comm_attn_out_l13 -->
<g id="node189" class="node">
<title>tp_comm_attn_out_l13</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-3433.14" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3447.14" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L13)</text>
<text text-anchor="middle" x="301" y="-3436.14" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-3425.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-3414.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l13&#45;&gt;tp_comm_attn_out_l13 -->
<g id="edge226" class="edge">
<title>attn_out_1_l13&#45;&gt;tp_comm_attn_out_l13</title>
<path fill="none" stroke="black" d="M197.05,-3506.73C211.07,-3496.95 227.48,-3485.49 243.06,-3474.61"/>
<polygon fill="black" stroke="black" points="245.42,-3477.23 251.62,-3468.63 241.41,-3471.49 245.42,-3477.23"/>
</g>
<!-- attn_out_2_l13&#45;&gt;tp_comm_attn_out_l13 -->
<g id="edge227" class="edge">
<title>attn_out_2_l13&#45;&gt;tp_comm_attn_out_l13</title>
<path fill="none" stroke="black" d="M405.69,-3506.73C391.58,-3496.95 375.05,-3485.49 359.35,-3474.61"/>
<polygon fill="black" stroke="black" points="360.95,-3471.45 350.74,-3468.63 356.96,-3477.21 360.95,-3471.45"/>
</g>
<!-- ln1_1_l13 -->
<g id="node195" class="node">
<title>ln1_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-3359.37 31.5,-3359.37 31.5,-3307.37 292.5,-3307.37 292.5,-3359.37"/>
<text text-anchor="middle" x="162" y="-3347.37" font-family="Arial" font-size="10.00">LayerNorm1 (L13)</text>
<text text-anchor="middle" x="162" y="-3336.37" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-3325.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-3314.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l13&#45;&gt;ln1_1_l13 -->
<g id="edge228" class="edge">
<title>tp_comm_attn_out_l13&#45;&gt;ln1_1_l13</title>
<path fill="none" stroke="black" d="M251.99,-3397.67C237.1,-3387.2 220.82,-3375.75 206.25,-3365.5"/>
<polygon fill="black" stroke="black" points="208.09,-3362.52 197.9,-3359.63 204.07,-3368.24 208.09,-3362.52"/>
</g>
<!-- ln1_2_l13 -->
<g id="node196" class="node">
<title>ln1_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-3359.37 310.5,-3359.37 310.5,-3307.37 571.5,-3307.37 571.5,-3359.37"/>
<text text-anchor="middle" x="441" y="-3347.37" font-family="Arial" font-size="10.00">LayerNorm1 (L13)</text>
<text text-anchor="middle" x="441" y="-3336.37" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-3325.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-3314.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l13&#45;&gt;ln1_2_l13 -->
<g id="edge229" class="edge">
<title>tp_comm_attn_out_l13&#45;&gt;ln1_2_l13</title>
<path fill="none" stroke="black" d="M350.36,-3397.67C365.36,-3387.2 381.76,-3375.75 396.43,-3365.5"/>
<polygon fill="black" stroke="black" points="398.65,-3368.22 404.84,-3359.63 394.64,-3362.48 398.65,-3368.22"/>
</g>
<!-- mlp_fc1_1_l13 -->
<g id="node190" class="node">
<title>mlp_fc1_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="289,-3270.37 35,-3270.37 35,-3218.37 289,-3218.37 289,-3270.37"/>
<text text-anchor="middle" x="162" y="-3258.37" font-family="Arial" font-size="10.00">MLP FC1 (L13)</text>
<text text-anchor="middle" x="162" y="-3247.37" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-3236.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-3225.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l13 -->
<g id="node192" class="node">
<title>mlp_fc2_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-3181.37 31.5,-3181.37 31.5,-3129.37 292.5,-3129.37 292.5,-3181.37"/>
<text text-anchor="middle" x="162" y="-3169.37" font-family="Arial" font-size="10.00">MLP FC2 (L13)</text>
<text text-anchor="middle" x="162" y="-3158.37" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-3147.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-3136.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l13&#45;&gt;mlp_fc2_1_l13 -->
<g id="edge232" class="edge">
<title>mlp_fc1_1_l13&#45;&gt;mlp_fc2_1_l13</title>
<path fill="none" stroke="black" d="M162,-3218.21C162,-3209.91 162,-3200.53 162,-3191.62"/>
<polygon fill="black" stroke="black" points="165.5,-3191.48 162,-3181.48 158.5,-3191.48 165.5,-3191.48"/>
</g>
<!-- mlp_fc1_2_l13 -->
<g id="node191" class="node">
<title>mlp_fc1_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="568,-3270.37 314,-3270.37 314,-3218.37 568,-3218.37 568,-3270.37"/>
<text text-anchor="middle" x="441" y="-3258.37" font-family="Arial" font-size="10.00">MLP FC1 (L13)</text>
<text text-anchor="middle" x="441" y="-3247.37" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-3236.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-3225.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l13 -->
<g id="node193" class="node">
<title>mlp_fc2_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-3181.37 310.5,-3181.37 310.5,-3129.37 571.5,-3129.37 571.5,-3181.37"/>
<text text-anchor="middle" x="441" y="-3169.37" font-family="Arial" font-size="10.00">MLP FC2 (L13)</text>
<text text-anchor="middle" x="441" y="-3158.37" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-3147.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-3136.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l13&#45;&gt;mlp_fc2_2_l13 -->
<g id="edge233" class="edge">
<title>mlp_fc1_2_l13&#45;&gt;mlp_fc2_2_l13</title>
<path fill="none" stroke="black" d="M441,-3218.21C441,-3209.91 441,-3200.53 441,-3191.62"/>
<polygon fill="black" stroke="black" points="444.5,-3191.48 441,-3181.48 437.5,-3191.48 444.5,-3191.48"/>
</g>
<!-- tp_comm_mlp_l13 -->
<g id="node194" class="node">
<title>tp_comm_mlp_l13</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-3055.6" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-3069.6" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L13)</text>
<text text-anchor="middle" x="301" y="-3058.6" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-3047.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-3036.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l13&#45;&gt;tp_comm_mlp_l13 -->
<g id="edge234" class="edge">
<title>mlp_fc2_1_l13&#45;&gt;tp_comm_mlp_l13</title>
<path fill="none" stroke="black" d="M197.8,-3129.2C211.71,-3119.41 228,-3107.95 243.48,-3097.07"/>
<polygon fill="black" stroke="black" points="245.8,-3099.71 251.97,-3091.09 241.77,-3093.98 245.8,-3099.71"/>
</g>
<!-- mlp_fc2_2_l13&#45;&gt;tp_comm_mlp_l13 -->
<g id="edge235" class="edge">
<title>mlp_fc2_2_l13&#45;&gt;tp_comm_mlp_l13</title>
<path fill="none" stroke="black" d="M404.95,-3129.2C390.93,-3119.41 374.52,-3107.95 358.94,-3097.07"/>
<polygon fill="black" stroke="black" points="360.59,-3093.95 350.38,-3091.09 356.58,-3099.69 360.59,-3093.95"/>
</g>
<!-- ln2_1_l13 -->
<g id="node197" class="node">
<title>ln2_1_l13</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-2981.83 29.5,-2981.83 29.5,-2929.83 290.5,-2929.83 290.5,-2981.83"/>
<text text-anchor="middle" x="160" y="-2969.83" font-family="Arial" font-size="10.00">LayerNorm2 (L13)</text>
<text text-anchor="middle" x="160" y="-2958.83" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-2947.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-2936.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l13&#45;&gt;ln2_1_l13 -->
<g id="edge236" class="edge">
<title>tp_comm_mlp_l13&#45;&gt;ln2_1_l13</title>
<path fill="none" stroke="black" d="M251.29,-3020.13C236.18,-3009.66 219.67,-2998.21 204.89,-2987.96"/>
<polygon fill="black" stroke="black" points="206.63,-2984.91 196.42,-2982.09 202.64,-2990.66 206.63,-2984.91"/>
</g>
<!-- ln2_2_l13 -->
<g id="node198" class="node">
<title>ln2_2_l13</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-2981.83 312.5,-2981.83 312.5,-2929.83 573.5,-2929.83 573.5,-2981.83"/>
<text text-anchor="middle" x="443" y="-2969.83" font-family="Arial" font-size="10.00">LayerNorm2 (L13)</text>
<text text-anchor="middle" x="443" y="-2958.83" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-2947.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-2936.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l13&#45;&gt;ln2_2_l13 -->
<g id="edge237" class="edge">
<title>tp_comm_mlp_l13&#45;&gt;ln2_2_l13</title>
<path fill="none" stroke="black" d="M351.06,-3020.13C366.28,-3009.66 382.91,-2998.21 397.79,-2987.96"/>
<polygon fill="black" stroke="black" points="400.07,-2990.64 406.32,-2982.09 396.1,-2984.87 400.07,-2990.64"/>
</g>
<!-- ln1_1_l13&#45;&gt;mlp_fc1_1_l13 -->
<g id="edge230" class="edge">
<title>ln1_1_l13&#45;&gt;mlp_fc1_1_l13</title>
<path fill="none" stroke="black" d="M162,-3307.21C162,-3298.91 162,-3289.53 162,-3280.62"/>
<polygon fill="black" stroke="black" points="165.5,-3280.48 162,-3270.48 158.5,-3280.48 165.5,-3280.48"/>
</g>
<!-- ln1_2_l13&#45;&gt;mlp_fc1_2_l13 -->
<g id="edge231" class="edge">
<title>ln1_2_l13&#45;&gt;mlp_fc1_2_l13</title>
<path fill="none" stroke="black" d="M441,-3307.21C441,-3298.91 441,-3289.53 441,-3280.62"/>
<polygon fill="black" stroke="black" points="444.5,-3280.48 441,-3270.48 437.5,-3280.48 444.5,-3280.48"/>
</g>
<!-- attn_qkv_1_l14 -->
<g id="node199" class="node">
<title>attn_qkv_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="292,-2892.83 22,-2892.83 22,-2840.83 292,-2840.83 292,-2892.83"/>
<text text-anchor="middle" x="157" y="-2880.83" font-family="Arial" font-size="10.00">Attention QKV (L14)</text>
<text text-anchor="middle" x="157" y="-2869.83" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-2858.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-2847.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l13&#45;&gt;attn_qkv_1_l14 -->
<g id="edge238" class="edge">
<title>ln2_1_l13&#45;&gt;attn_qkv_1_l14</title>
<path fill="none" stroke="black" d="M159.13,-2929.67C158.85,-2921.37 158.52,-2911.99 158.22,-2903.08"/>
<polygon fill="black" stroke="black" points="161.71,-2902.82 157.87,-2892.94 154.71,-2903.06 161.71,-2902.82"/>
</g>
<!-- attn_qkv_2_l14 -->
<g id="node200" class="node">
<title>attn_qkv_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="580,-2892.83 310,-2892.83 310,-2840.83 580,-2840.83 580,-2892.83"/>
<text text-anchor="middle" x="445" y="-2880.83" font-family="Arial" font-size="10.00">Attention QKV (L14)</text>
<text text-anchor="middle" x="445" y="-2869.83" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-2858.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-2847.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l13&#45;&gt;attn_qkv_2_l14 -->
<g id="edge239" class="edge">
<title>ln2_2_l13&#45;&gt;attn_qkv_2_l14</title>
<path fill="none" stroke="black" d="M443.58,-2929.67C443.77,-2921.37 443.98,-2911.99 444.19,-2903.08"/>
<polygon fill="black" stroke="black" points="447.69,-2903.02 444.42,-2892.94 440.69,-2902.86 447.69,-2903.02"/>
</g>
<!-- tp_comm_attn_l14 -->
<g id="node201" class="node">
<title>tp_comm_attn_l14</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-2767.07" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-2781.07" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L14)</text>
<text text-anchor="middle" x="301" y="-2770.07" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-2759.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-2748.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l14&#45;&gt;tp_comm_attn_l14 -->
<g id="edge240" class="edge">
<title>attn_qkv_1_l14&#45;&gt;tp_comm_attn_l14</title>
<path fill="none" stroke="black" d="M194.08,-2840.66C208.63,-2830.78 225.69,-2819.2 241.85,-2808.22"/>
<polygon fill="black" stroke="black" points="243.9,-2811.07 250.2,-2802.55 239.96,-2805.27 243.9,-2811.07"/>
</g>
<!-- attn_qkv_2_l14&#45;&gt;tp_comm_attn_l14 -->
<g id="edge241" class="edge">
<title>attn_qkv_2_l14&#45;&gt;tp_comm_attn_l14</title>
<path fill="none" stroke="black" d="M407.92,-2840.66C393.37,-2830.78 376.31,-2819.2 360.15,-2808.22"/>
<polygon fill="black" stroke="black" points="362.04,-2805.27 351.8,-2802.55 358.1,-2811.07 362.04,-2805.27"/>
</g>
<!-- attn_out_1_l14 -->
<g id="node202" class="node">
<title>attn_out_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-2693.3 29.5,-2693.3 29.5,-2641.3 292.5,-2641.3 292.5,-2693.3"/>
<text text-anchor="middle" x="161" y="-2681.3" font-family="Arial" font-size="10.00">Attention Output (L14)</text>
<text text-anchor="middle" x="161" y="-2670.3" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-2659.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-2648.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l14&#45;&gt;attn_out_1_l14 -->
<g id="edge242" class="edge">
<title>tp_comm_attn_l14&#45;&gt;attn_out_1_l14</title>
<path fill="none" stroke="black" d="M251.25,-2731.32C236.27,-2720.86 219.93,-2709.45 205.33,-2699.25"/>
<polygon fill="black" stroke="black" points="207.16,-2696.26 196.96,-2693.41 203.15,-2702 207.16,-2696.26"/>
</g>
<!-- attn_out_2_l14 -->
<g id="node203" class="node">
<title>attn_out_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-2693.3 310.5,-2693.3 310.5,-2641.3 573.5,-2641.3 573.5,-2693.3"/>
<text text-anchor="middle" x="442" y="-2681.3" font-family="Arial" font-size="10.00">Attention Output (L14)</text>
<text text-anchor="middle" x="442" y="-2670.3" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-2659.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-2648.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l14&#45;&gt;attn_out_2_l14 -->
<g id="edge243" class="edge">
<title>tp_comm_attn_l14&#45;&gt;attn_out_2_l14</title>
<path fill="none" stroke="black" d="M351.11,-2731.32C366.19,-2720.86 382.64,-2709.45 397.35,-2699.25"/>
<polygon fill="black" stroke="black" points="399.56,-2701.98 405.79,-2693.41 395.57,-2696.23 399.56,-2701.98"/>
</g>
<!-- tp_comm_attn_out_l14 -->
<g id="node204" class="node">
<title>tp_comm_attn_out_l14</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-2567.53" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-2581.53" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L14)</text>
<text text-anchor="middle" x="301" y="-2570.53" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-2559.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-2548.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l14&#45;&gt;tp_comm_attn_out_l14 -->
<g id="edge244" class="edge">
<title>attn_out_1_l14&#45;&gt;tp_comm_attn_out_l14</title>
<path fill="none" stroke="black" d="M197.05,-2641.12C211.07,-2631.33 227.48,-2619.87 243.06,-2608.99"/>
<polygon fill="black" stroke="black" points="245.42,-2611.61 251.62,-2603.01 241.41,-2605.87 245.42,-2611.61"/>
</g>
<!-- attn_out_2_l14&#45;&gt;tp_comm_attn_out_l14 -->
<g id="edge245" class="edge">
<title>attn_out_2_l14&#45;&gt;tp_comm_attn_out_l14</title>
<path fill="none" stroke="black" d="M405.69,-2641.12C391.58,-2631.33 375.05,-2619.87 359.35,-2608.99"/>
<polygon fill="black" stroke="black" points="360.95,-2605.84 350.74,-2603.01 356.96,-2611.59 360.95,-2605.84"/>
</g>
<!-- ln1_1_l14 -->
<g id="node210" class="node">
<title>ln1_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-2493.76 16.5,-2493.76 16.5,-2441.76 277.5,-2441.76 277.5,-2493.76"/>
<text text-anchor="middle" x="147" y="-2481.76" font-family="Arial" font-size="10.00">LayerNorm1 (L14)</text>
<text text-anchor="middle" x="147" y="-2470.76" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-2459.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="147" y="-2448.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l14&#45;&gt;ln1_1_l14 -->
<g id="edge246" class="edge">
<title>tp_comm_attn_out_l14&#45;&gt;ln1_1_l14</title>
<path fill="none" stroke="black" d="M247.14,-2532.33C230.15,-2521.55 211.51,-2509.71 194.96,-2499.2"/>
<polygon fill="black" stroke="black" points="196.83,-2496.25 186.52,-2493.84 193.08,-2502.16 196.83,-2496.25"/>
</g>
<!-- ln1_2_l14 -->
<g id="node211" class="node">
<title>ln1_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-2493.76 295.5,-2493.76 295.5,-2441.76 556.5,-2441.76 556.5,-2493.76"/>
<text text-anchor="middle" x="426" y="-2481.76" font-family="Arial" font-size="10.00">LayerNorm1 (L14)</text>
<text text-anchor="middle" x="426" y="-2470.76" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-2459.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="426" y="-2448.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l14&#45;&gt;ln1_2_l14 -->
<g id="edge247" class="edge">
<title>tp_comm_attn_out_l14&#45;&gt;ln1_2_l14</title>
<path fill="none" stroke="black" d="M345.42,-2531.78C358.55,-2521.52 372.84,-2510.34 385.69,-2500.29"/>
<polygon fill="black" stroke="black" points="388.18,-2502.78 393.9,-2493.87 383.86,-2497.27 388.18,-2502.78"/>
</g>
<!-- mlp_fc1_1_l14 -->
<g id="node205" class="node">
<title>mlp_fc1_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="274,-2404.76 20,-2404.76 20,-2352.76 274,-2352.76 274,-2404.76"/>
<text text-anchor="middle" x="147" y="-2392.76" font-family="Arial" font-size="10.00">MLP FC1 (L14)</text>
<text text-anchor="middle" x="147" y="-2381.76" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-2370.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="147" y="-2359.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l14 -->
<g id="node207" class="node">
<title>mlp_fc2_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="277.5,-2315.76 16.5,-2315.76 16.5,-2263.76 277.5,-2263.76 277.5,-2315.76"/>
<text text-anchor="middle" x="147" y="-2303.76" font-family="Arial" font-size="10.00">MLP FC2 (L14)</text>
<text text-anchor="middle" x="147" y="-2292.76" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="147" y="-2281.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="147" y="-2270.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l14&#45;&gt;mlp_fc2_1_l14 -->
<g id="edge250" class="edge">
<title>mlp_fc1_1_l14&#45;&gt;mlp_fc2_1_l14</title>
<path fill="none" stroke="black" d="M147,-2352.59C147,-2344.3 147,-2334.91 147,-2326"/>
<polygon fill="black" stroke="black" points="150.5,-2325.86 147,-2315.86 143.5,-2325.86 150.5,-2325.86"/>
</g>
<!-- mlp_fc1_2_l14 -->
<g id="node206" class="node">
<title>mlp_fc1_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="553,-2404.76 299,-2404.76 299,-2352.76 553,-2352.76 553,-2404.76"/>
<text text-anchor="middle" x="426" y="-2392.76" font-family="Arial" font-size="10.00">MLP FC1 (L14)</text>
<text text-anchor="middle" x="426" y="-2381.76" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-2370.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="426" y="-2359.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l14 -->
<g id="node208" class="node">
<title>mlp_fc2_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="556.5,-2315.76 295.5,-2315.76 295.5,-2263.76 556.5,-2263.76 556.5,-2315.76"/>
<text text-anchor="middle" x="426" y="-2303.76" font-family="Arial" font-size="10.00">MLP FC2 (L14)</text>
<text text-anchor="middle" x="426" y="-2292.76" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="426" y="-2281.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="426" y="-2270.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l14&#45;&gt;mlp_fc2_2_l14 -->
<g id="edge251" class="edge">
<title>mlp_fc1_2_l14&#45;&gt;mlp_fc2_2_l14</title>
<path fill="none" stroke="black" d="M426,-2352.59C426,-2344.3 426,-2334.91 426,-2326"/>
<polygon fill="black" stroke="black" points="429.5,-2325.86 426,-2315.86 422.5,-2325.86 429.5,-2325.86"/>
</g>
<!-- tp_comm_mlp_l14 -->
<g id="node209" class="node">
<title>tp_comm_mlp_l14</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-2189.99" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-2203.99" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L14)</text>
<text text-anchor="middle" x="301" y="-2192.99" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-2181.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-2170.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l14&#45;&gt;tp_comm_mlp_l14 -->
<g id="edge252" class="edge">
<title>mlp_fc2_1_l14&#45;&gt;tp_comm_mlp_l14</title>
<path fill="none" stroke="black" d="M186.66,-2263.58C202.44,-2253.56 220.97,-2241.79 238.47,-2230.68"/>
<polygon fill="black" stroke="black" points="240.4,-2233.61 246.97,-2225.29 236.65,-2227.7 240.4,-2233.61"/>
</g>
<!-- mlp_fc2_2_l14&#45;&gt;tp_comm_mlp_l14 -->
<g id="edge253" class="edge">
<title>mlp_fc2_2_l14&#45;&gt;tp_comm_mlp_l14</title>
<path fill="none" stroke="black" d="M393.81,-2263.58C381.59,-2254.02 367.34,-2242.88 353.72,-2232.23"/>
<polygon fill="black" stroke="black" points="355.83,-2229.43 345.8,-2226.03 351.52,-2234.95 355.83,-2229.43"/>
</g>
<!-- ln2_1_l14 -->
<g id="node212" class="node">
<title>ln2_1_l14</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-2116.22 29.5,-2116.22 29.5,-2064.22 290.5,-2064.22 290.5,-2116.22"/>
<text text-anchor="middle" x="160" y="-2104.22" font-family="Arial" font-size="10.00">LayerNorm2 (L14)</text>
<text text-anchor="middle" x="160" y="-2093.22" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-2082.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-2071.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l14&#45;&gt;ln2_1_l14 -->
<g id="edge254" class="edge">
<title>tp_comm_mlp_l14&#45;&gt;ln2_1_l14</title>
<path fill="none" stroke="black" d="M251.29,-2154.52C236.18,-2144.04 219.67,-2132.59 204.89,-2122.35"/>
<polygon fill="black" stroke="black" points="206.63,-2119.29 196.42,-2116.47 202.64,-2125.04 206.63,-2119.29"/>
</g>
<!-- ln2_2_l14 -->
<g id="node213" class="node">
<title>ln2_2_l14</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-2116.22 312.5,-2116.22 312.5,-2064.22 573.5,-2064.22 573.5,-2116.22"/>
<text text-anchor="middle" x="443" y="-2104.22" font-family="Arial" font-size="10.00">LayerNorm2 (L14)</text>
<text text-anchor="middle" x="443" y="-2093.22" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-2082.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-2071.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l14&#45;&gt;ln2_2_l14 -->
<g id="edge255" class="edge">
<title>tp_comm_mlp_l14&#45;&gt;ln2_2_l14</title>
<path fill="none" stroke="black" d="M351.06,-2154.52C366.28,-2144.04 382.91,-2132.59 397.79,-2122.35"/>
<polygon fill="black" stroke="black" points="400.07,-2125.02 406.32,-2116.47 396.1,-2119.26 400.07,-2125.02"/>
</g>
<!-- ln1_1_l14&#45;&gt;mlp_fc1_1_l14 -->
<g id="edge248" class="edge">
<title>ln1_1_l14&#45;&gt;mlp_fc1_1_l14</title>
<path fill="none" stroke="black" d="M147,-2441.59C147,-2433.3 147,-2423.91 147,-2415"/>
<polygon fill="black" stroke="black" points="150.5,-2414.86 147,-2404.86 143.5,-2414.86 150.5,-2414.86"/>
</g>
<!-- ln1_2_l14&#45;&gt;mlp_fc1_2_l14 -->
<g id="edge249" class="edge">
<title>ln1_2_l14&#45;&gt;mlp_fc1_2_l14</title>
<path fill="none" stroke="black" d="M426,-2441.59C426,-2433.3 426,-2423.91 426,-2415"/>
<polygon fill="black" stroke="black" points="429.5,-2414.86 426,-2404.86 422.5,-2414.86 429.5,-2414.86"/>
</g>
<!-- attn_qkv_1_l15 -->
<g id="node214" class="node">
<title>attn_qkv_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="292,-2027.22 22,-2027.22 22,-1975.22 292,-1975.22 292,-2027.22"/>
<text text-anchor="middle" x="157" y="-2015.22" font-family="Arial" font-size="10.00">Attention QKV (L15)</text>
<text text-anchor="middle" x="157" y="-2004.22" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-1993.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-1982.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l14&#45;&gt;attn_qkv_1_l15 -->
<g id="edge256" class="edge">
<title>ln2_1_l14&#45;&gt;attn_qkv_1_l15</title>
<path fill="none" stroke="black" d="M159.13,-2064.05C158.85,-2055.76 158.52,-2046.37 158.22,-2037.47"/>
<polygon fill="black" stroke="black" points="161.71,-2037.2 157.87,-2027.32 154.71,-2037.44 161.71,-2037.2"/>
</g>
<!-- attn_qkv_2_l15 -->
<g id="node215" class="node">
<title>attn_qkv_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="580,-2027.22 310,-2027.22 310,-1975.22 580,-1975.22 580,-2027.22"/>
<text text-anchor="middle" x="445" y="-2015.22" font-family="Arial" font-size="10.00">Attention QKV (L15)</text>
<text text-anchor="middle" x="445" y="-2004.22" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-1993.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-1982.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l14&#45;&gt;attn_qkv_2_l15 -->
<g id="edge257" class="edge">
<title>ln2_2_l14&#45;&gt;attn_qkv_2_l15</title>
<path fill="none" stroke="black" d="M443.58,-2064.05C443.77,-2055.76 443.98,-2046.37 444.19,-2037.47"/>
<polygon fill="black" stroke="black" points="447.69,-2037.4 444.42,-2027.32 440.69,-2037.24 447.69,-2037.4"/>
</g>
<!-- tp_comm_attn_l15 -->
<g id="node216" class="node">
<title>tp_comm_attn_l15</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-1901.45" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1915.45" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L15)</text>
<text text-anchor="middle" x="301" y="-1904.45" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-1893.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-1882.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l15&#45;&gt;tp_comm_attn_l15 -->
<g id="edge258" class="edge">
<title>attn_qkv_1_l15&#45;&gt;tp_comm_attn_l15</title>
<path fill="none" stroke="black" d="M194.08,-1975.04C208.63,-1965.16 225.69,-1953.58 241.85,-1942.61"/>
<polygon fill="black" stroke="black" points="243.9,-1945.45 250.2,-1936.94 239.96,-1939.66 243.9,-1945.45"/>
</g>
<!-- attn_qkv_2_l15&#45;&gt;tp_comm_attn_l15 -->
<g id="edge259" class="edge">
<title>attn_qkv_2_l15&#45;&gt;tp_comm_attn_l15</title>
<path fill="none" stroke="black" d="M407.92,-1975.04C393.37,-1965.16 376.31,-1953.58 360.15,-1942.61"/>
<polygon fill="black" stroke="black" points="362.04,-1939.66 351.8,-1936.94 358.1,-1945.45 362.04,-1939.66"/>
</g>
<!-- attn_out_1_l15 -->
<g id="node217" class="node">
<title>attn_out_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="291.5,-1827.68 28.5,-1827.68 28.5,-1775.68 291.5,-1775.68 291.5,-1827.68"/>
<text text-anchor="middle" x="160" y="-1815.68" font-family="Arial" font-size="10.00">Attention Output (L15)</text>
<text text-anchor="middle" x="160" y="-1804.68" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-1793.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="160" y="-1782.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l15&#45;&gt;attn_out_1_l15 -->
<g id="edge260" class="edge">
<title>tp_comm_attn_l15&#45;&gt;attn_out_1_l15</title>
<path fill="none" stroke="black" d="M250.89,-1865.7C235.81,-1855.24 219.36,-1843.84 204.65,-1833.64"/>
<polygon fill="black" stroke="black" points="206.43,-1830.61 196.21,-1827.79 202.44,-1836.36 206.43,-1830.61"/>
</g>
<!-- attn_out_2_l15 -->
<g id="node218" class="node">
<title>attn_out_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="572.5,-1827.68 309.5,-1827.68 309.5,-1775.68 572.5,-1775.68 572.5,-1827.68"/>
<text text-anchor="middle" x="441" y="-1815.68" font-family="Arial" font-size="10.00">Attention Output (L15)</text>
<text text-anchor="middle" x="441" y="-1804.68" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-1793.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="441" y="-1782.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l15&#45;&gt;attn_out_2_l15 -->
<g id="edge261" class="edge">
<title>tp_comm_attn_l15&#45;&gt;attn_out_2_l15</title>
<path fill="none" stroke="black" d="M350.75,-1865.7C365.73,-1855.24 382.07,-1843.84 396.67,-1833.64"/>
<polygon fill="black" stroke="black" points="398.85,-1836.38 405.04,-1827.79 394.84,-1830.64 398.85,-1836.38"/>
</g>
<!-- tp_comm_attn_out_l15 -->
<g id="node219" class="node">
<title>tp_comm_attn_out_l15</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-1701.91" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1715.91" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L15)</text>
<text text-anchor="middle" x="301" y="-1704.91" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-1693.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-1682.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l15&#45;&gt;tp_comm_attn_out_l15 -->
<g id="edge262" class="edge">
<title>attn_out_1_l15&#45;&gt;tp_comm_attn_out_l15</title>
<path fill="none" stroke="black" d="M196.31,-1775.5C210.42,-1765.71 226.95,-1754.25 242.65,-1743.37"/>
<polygon fill="black" stroke="black" points="245.04,-1745.97 251.26,-1737.4 241.05,-1740.22 245.04,-1745.97"/>
</g>
<!-- attn_out_2_l15&#45;&gt;tp_comm_attn_out_l15 -->
<g id="edge263" class="edge">
<title>attn_out_2_l15&#45;&gt;tp_comm_attn_out_l15</title>
<path fill="none" stroke="black" d="M404.95,-1775.5C390.93,-1765.71 374.52,-1754.25 358.94,-1743.37"/>
<polygon fill="black" stroke="black" points="360.59,-1740.25 350.38,-1737.4 356.58,-1745.99 360.59,-1740.25"/>
</g>
<!-- ln1_1_l15 -->
<g id="node225" class="node">
<title>ln1_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-1628.14 31.5,-1628.14 31.5,-1576.14 292.5,-1576.14 292.5,-1628.14"/>
<text text-anchor="middle" x="162" y="-1616.14" font-family="Arial" font-size="10.00">LayerNorm1 (L15)</text>
<text text-anchor="middle" x="162" y="-1605.14" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-1594.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-1583.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l15&#45;&gt;ln1_1_l15 -->
<g id="edge264" class="edge">
<title>tp_comm_attn_out_l15&#45;&gt;ln1_1_l15</title>
<path fill="none" stroke="black" d="M251.99,-1666.44C237.1,-1655.96 220.82,-1644.51 206.25,-1634.27"/>
<polygon fill="black" stroke="black" points="208.09,-1631.28 197.9,-1628.39 204.07,-1637.01 208.09,-1631.28"/>
</g>
<!-- ln1_2_l15 -->
<g id="node226" class="node">
<title>ln1_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-1628.14 310.5,-1628.14 310.5,-1576.14 571.5,-1576.14 571.5,-1628.14"/>
<text text-anchor="middle" x="441" y="-1616.14" font-family="Arial" font-size="10.00">LayerNorm1 (L15)</text>
<text text-anchor="middle" x="441" y="-1605.14" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-1594.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-1583.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l15&#45;&gt;ln1_2_l15 -->
<g id="edge265" class="edge">
<title>tp_comm_attn_out_l15&#45;&gt;ln1_2_l15</title>
<path fill="none" stroke="black" d="M350.36,-1666.44C365.36,-1655.96 381.76,-1644.51 396.43,-1634.27"/>
<polygon fill="black" stroke="black" points="398.65,-1636.99 404.84,-1628.39 394.64,-1631.25 398.65,-1636.99"/>
</g>
<!-- mlp_fc1_1_l15 -->
<g id="node220" class="node">
<title>mlp_fc1_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="289,-1539.14 35,-1539.14 35,-1487.14 289,-1487.14 289,-1539.14"/>
<text text-anchor="middle" x="162" y="-1527.14" font-family="Arial" font-size="10.00">MLP FC1 (L15)</text>
<text text-anchor="middle" x="162" y="-1516.14" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-1505.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-1494.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l15 -->
<g id="node222" class="node">
<title>mlp_fc2_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-1450.14 31.5,-1450.14 31.5,-1398.14 292.5,-1398.14 292.5,-1450.14"/>
<text text-anchor="middle" x="162" y="-1438.14" font-family="Arial" font-size="10.00">MLP FC2 (L15)</text>
<text text-anchor="middle" x="162" y="-1427.14" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-1416.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-1405.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l15&#45;&gt;mlp_fc2_1_l15 -->
<g id="edge268" class="edge">
<title>mlp_fc1_1_l15&#45;&gt;mlp_fc2_1_l15</title>
<path fill="none" stroke="black" d="M162,-1486.98C162,-1478.68 162,-1469.29 162,-1460.39"/>
<polygon fill="black" stroke="black" points="165.5,-1460.25 162,-1450.25 158.5,-1460.25 165.5,-1460.25"/>
</g>
<!-- mlp_fc1_2_l15 -->
<g id="node221" class="node">
<title>mlp_fc1_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="568,-1539.14 314,-1539.14 314,-1487.14 568,-1487.14 568,-1539.14"/>
<text text-anchor="middle" x="441" y="-1527.14" font-family="Arial" font-size="10.00">MLP FC1 (L15)</text>
<text text-anchor="middle" x="441" y="-1516.14" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-1505.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-1494.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l15 -->
<g id="node223" class="node">
<title>mlp_fc2_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-1450.14 310.5,-1450.14 310.5,-1398.14 571.5,-1398.14 571.5,-1450.14"/>
<text text-anchor="middle" x="441" y="-1438.14" font-family="Arial" font-size="10.00">MLP FC2 (L15)</text>
<text text-anchor="middle" x="441" y="-1427.14" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-1416.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-1405.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l15&#45;&gt;mlp_fc2_2_l15 -->
<g id="edge269" class="edge">
<title>mlp_fc1_2_l15&#45;&gt;mlp_fc2_2_l15</title>
<path fill="none" stroke="black" d="M441,-1486.98C441,-1478.68 441,-1469.29 441,-1460.39"/>
<polygon fill="black" stroke="black" points="444.5,-1460.25 441,-1450.25 437.5,-1460.25 444.5,-1460.25"/>
</g>
<!-- tp_comm_mlp_l15 -->
<g id="node224" class="node">
<title>tp_comm_mlp_l15</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-1324.37" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1338.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L15)</text>
<text text-anchor="middle" x="301" y="-1327.37" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-1316.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-1305.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l15&#45;&gt;tp_comm_mlp_l15 -->
<g id="edge270" class="edge">
<title>mlp_fc2_1_l15&#45;&gt;tp_comm_mlp_l15</title>
<path fill="none" stroke="black" d="M197.8,-1397.96C211.71,-1388.17 228,-1376.72 243.48,-1365.83"/>
<polygon fill="black" stroke="black" points="245.8,-1368.47 251.97,-1359.86 241.77,-1362.75 245.8,-1368.47"/>
</g>
<!-- mlp_fc2_2_l15&#45;&gt;tp_comm_mlp_l15 -->
<g id="edge271" class="edge">
<title>mlp_fc2_2_l15&#45;&gt;tp_comm_mlp_l15</title>
<path fill="none" stroke="black" d="M404.95,-1397.96C390.93,-1388.17 374.52,-1376.72 358.94,-1365.83"/>
<polygon fill="black" stroke="black" points="360.59,-1362.71 350.38,-1359.86 356.58,-1368.45 360.59,-1362.71"/>
</g>
<!-- ln2_1_l15 -->
<g id="node227" class="node">
<title>ln2_1_l15</title>
<polygon fill="lightgreen" stroke="black" points="290.5,-1250.6 29.5,-1250.6 29.5,-1198.6 290.5,-1198.6 290.5,-1250.6"/>
<text text-anchor="middle" x="160" y="-1238.6" font-family="Arial" font-size="10.00">LayerNorm2 (L15)</text>
<text text-anchor="middle" x="160" y="-1227.6" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="160" y="-1216.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="160" y="-1205.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l15&#45;&gt;ln2_1_l15 -->
<g id="edge272" class="edge">
<title>tp_comm_mlp_l15&#45;&gt;ln2_1_l15</title>
<path fill="none" stroke="black" d="M251.29,-1288.9C236.18,-1278.42 219.67,-1266.97 204.89,-1256.73"/>
<polygon fill="black" stroke="black" points="206.63,-1253.67 196.42,-1250.85 202.64,-1259.43 206.63,-1253.67"/>
</g>
<!-- ln2_2_l15 -->
<g id="node228" class="node">
<title>ln2_2_l15</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-1250.6 312.5,-1250.6 312.5,-1198.6 573.5,-1198.6 573.5,-1250.6"/>
<text text-anchor="middle" x="443" y="-1238.6" font-family="Arial" font-size="10.00">LayerNorm2 (L15)</text>
<text text-anchor="middle" x="443" y="-1227.6" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="443" y="-1216.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="443" y="-1205.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l15&#45;&gt;ln2_2_l15 -->
<g id="edge273" class="edge">
<title>tp_comm_mlp_l15&#45;&gt;ln2_2_l15</title>
<path fill="none" stroke="black" d="M351.06,-1288.9C366.28,-1278.42 382.91,-1266.97 397.79,-1256.73"/>
<polygon fill="black" stroke="black" points="400.07,-1259.41 406.32,-1250.85 396.1,-1253.64 400.07,-1259.41"/>
</g>
<!-- ln1_1_l15&#45;&gt;mlp_fc1_1_l15 -->
<g id="edge266" class="edge">
<title>ln1_1_l15&#45;&gt;mlp_fc1_1_l15</title>
<path fill="none" stroke="black" d="M162,-1575.98C162,-1567.68 162,-1558.29 162,-1549.39"/>
<polygon fill="black" stroke="black" points="165.5,-1549.25 162,-1539.25 158.5,-1549.25 165.5,-1549.25"/>
</g>
<!-- ln1_2_l15&#45;&gt;mlp_fc1_2_l15 -->
<g id="edge267" class="edge">
<title>ln1_2_l15&#45;&gt;mlp_fc1_2_l15</title>
<path fill="none" stroke="black" d="M441,-1575.98C441,-1567.68 441,-1558.29 441,-1549.39"/>
<polygon fill="black" stroke="black" points="444.5,-1549.25 441,-1539.25 437.5,-1549.25 444.5,-1549.25"/>
</g>
<!-- attn_qkv_1_l16 -->
<g id="node229" class="node">
<title>attn_qkv_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="292,-1161.6 22,-1161.6 22,-1109.6 292,-1109.6 292,-1161.6"/>
<text text-anchor="middle" x="157" y="-1149.6" font-family="Arial" font-size="10.00">Attention QKV (L16)</text>
<text text-anchor="middle" x="157" y="-1138.6" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="157" y="-1127.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157" y="-1116.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_1_l15&#45;&gt;attn_qkv_1_l16 -->
<g id="edge274" class="edge">
<title>ln2_1_l15&#45;&gt;attn_qkv_1_l16</title>
<path fill="none" stroke="black" d="M159.13,-1198.44C158.85,-1190.14 158.52,-1180.75 158.22,-1171.85"/>
<polygon fill="black" stroke="black" points="161.71,-1171.58 157.87,-1161.71 154.71,-1171.82 161.71,-1171.58"/>
</g>
<!-- attn_qkv_2_l16 -->
<g id="node230" class="node">
<title>attn_qkv_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="580,-1161.6 310,-1161.6 310,-1109.6 580,-1109.6 580,-1161.6"/>
<text text-anchor="middle" x="445" y="-1149.6" font-family="Arial" font-size="10.00">Attention QKV (L16)</text>
<text text-anchor="middle" x="445" y="-1138.6" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="445" y="-1127.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="445" y="-1116.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_2_l15&#45;&gt;attn_qkv_2_l16 -->
<g id="edge275" class="edge">
<title>ln2_2_l15&#45;&gt;attn_qkv_2_l16</title>
<path fill="none" stroke="black" d="M443.58,-1198.44C443.77,-1190.14 443.98,-1180.75 444.19,-1171.85"/>
<polygon fill="black" stroke="black" points="447.69,-1171.79 444.42,-1161.71 440.69,-1171.62 447.69,-1171.79"/>
</g>
<!-- tp_comm_attn_l16 -->
<g id="node231" class="node">
<title>tp_comm_attn_l16</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-1035.83" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="301" y="-1049.83" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L16)</text>
<text text-anchor="middle" x="301" y="-1038.83" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-1027.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="301" y="-1016.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_1_l16&#45;&gt;tp_comm_attn_l16 -->
<g id="edge276" class="edge">
<title>attn_qkv_1_l16&#45;&gt;tp_comm_attn_l16</title>
<path fill="none" stroke="black" d="M194.08,-1109.42C208.63,-1099.54 225.69,-1087.96 241.85,-1076.99"/>
<polygon fill="black" stroke="black" points="243.9,-1079.83 250.2,-1071.32 239.96,-1074.04 243.9,-1079.83"/>
</g>
<!-- attn_qkv_2_l16&#45;&gt;tp_comm_attn_l16 -->
<g id="edge277" class="edge">
<title>attn_qkv_2_l16&#45;&gt;tp_comm_attn_l16</title>
<path fill="none" stroke="black" d="M407.92,-1109.42C393.37,-1099.54 376.31,-1087.96 360.15,-1076.99"/>
<polygon fill="black" stroke="black" points="362.04,-1074.04 351.8,-1071.32 358.1,-1079.83 362.04,-1074.04"/>
</g>
<!-- attn_out_1_l16 -->
<g id="node232" class="node">
<title>attn_out_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-962.06 29.5,-962.06 29.5,-910.06 292.5,-910.06 292.5,-962.06"/>
<text text-anchor="middle" x="161" y="-950.06" font-family="Arial" font-size="10.00">Attention Output (L16)</text>
<text text-anchor="middle" x="161" y="-939.06" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="161" y="-928.06" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="161" y="-917.06" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l16&#45;&gt;attn_out_1_l16 -->
<g id="edge278" class="edge">
<title>tp_comm_attn_l16&#45;&gt;attn_out_1_l16</title>
<path fill="none" stroke="black" d="M251.25,-1000.09C236.27,-989.62 219.93,-978.22 205.33,-968.02"/>
<polygon fill="black" stroke="black" points="207.16,-965.03 196.96,-962.17 203.15,-970.77 207.16,-965.03"/>
</g>
<!-- attn_out_2_l16 -->
<g id="node233" class="node">
<title>attn_out_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="573.5,-962.06 310.5,-962.06 310.5,-910.06 573.5,-910.06 573.5,-962.06"/>
<text text-anchor="middle" x="442" y="-950.06" font-family="Arial" font-size="10.00">Attention Output (L16)</text>
<text text-anchor="middle" x="442" y="-939.06" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="442" y="-928.06" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="442" y="-917.06" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_l16&#45;&gt;attn_out_2_l16 -->
<g id="edge279" class="edge">
<title>tp_comm_attn_l16&#45;&gt;attn_out_2_l16</title>
<path fill="none" stroke="black" d="M351.11,-1000.09C366.19,-989.62 382.64,-978.22 397.35,-968.02"/>
<polygon fill="black" stroke="black" points="399.56,-970.75 405.79,-962.17 395.57,-964.99 399.56,-970.75"/>
</g>
<!-- tp_comm_attn_out_l16 -->
<g id="node234" class="node">
<title>tp_comm_attn_out_l16</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-836.29" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-850.29" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L16)</text>
<text text-anchor="middle" x="301" y="-839.29" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-828.29" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-817.29" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_1_l16&#45;&gt;tp_comm_attn_out_l16 -->
<g id="edge280" class="edge">
<title>attn_out_1_l16&#45;&gt;tp_comm_attn_out_l16</title>
<path fill="none" stroke="black" d="M197.05,-909.88C211.07,-900.1 227.48,-888.64 243.06,-877.75"/>
<polygon fill="black" stroke="black" points="245.42,-880.37 251.62,-871.78 241.41,-874.64 245.42,-880.37"/>
</g>
<!-- attn_out_2_l16&#45;&gt;tp_comm_attn_out_l16 -->
<g id="edge281" class="edge">
<title>attn_out_2_l16&#45;&gt;tp_comm_attn_out_l16</title>
<path fill="none" stroke="black" d="M405.69,-909.88C391.58,-900.1 375.05,-888.64 359.35,-877.75"/>
<polygon fill="black" stroke="black" points="360.95,-874.6 350.74,-871.78 356.96,-880.35 360.95,-874.6"/>
</g>
<!-- ln1_1_l16 -->
<g id="node240" class="node">
<title>ln1_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-762.52 31.5,-762.52 31.5,-710.52 292.5,-710.52 292.5,-762.52"/>
<text text-anchor="middle" x="162" y="-750.52" font-family="Arial" font-size="10.00">LayerNorm1 (L16)</text>
<text text-anchor="middle" x="162" y="-739.52" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-728.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-717.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l16&#45;&gt;ln1_1_l16 -->
<g id="edge282" class="edge">
<title>tp_comm_attn_out_l16&#45;&gt;ln1_1_l16</title>
<path fill="none" stroke="black" d="M251.99,-800.82C237.1,-790.34 220.82,-778.89 206.25,-768.65"/>
<polygon fill="black" stroke="black" points="208.09,-765.66 197.9,-762.77 204.07,-771.39 208.09,-765.66"/>
</g>
<!-- ln1_2_l16 -->
<g id="node241" class="node">
<title>ln1_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-762.52 310.5,-762.52 310.5,-710.52 571.5,-710.52 571.5,-762.52"/>
<text text-anchor="middle" x="441" y="-750.52" font-family="Arial" font-size="10.00">LayerNorm1 (L16)</text>
<text text-anchor="middle" x="441" y="-739.52" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-728.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-717.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_l16&#45;&gt;ln1_2_l16 -->
<g id="edge283" class="edge">
<title>tp_comm_attn_out_l16&#45;&gt;ln1_2_l16</title>
<path fill="none" stroke="black" d="M350.36,-800.82C365.36,-790.34 381.76,-778.89 396.43,-768.65"/>
<polygon fill="black" stroke="black" points="398.65,-771.37 404.84,-762.77 394.64,-765.63 398.65,-771.37"/>
</g>
<!-- mlp_fc1_1_l16 -->
<g id="node235" class="node">
<title>mlp_fc1_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="289,-673.52 35,-673.52 35,-621.52 289,-621.52 289,-673.52"/>
<text text-anchor="middle" x="162" y="-661.52" font-family="Arial" font-size="10.00">MLP FC1 (L16)</text>
<text text-anchor="middle" x="162" y="-650.52" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-639.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="162" y="-628.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_1_l16 -->
<g id="node237" class="node">
<title>mlp_fc2_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-584.52 31.5,-584.52 31.5,-532.52 292.5,-532.52 292.5,-584.52"/>
<text text-anchor="middle" x="162" y="-572.52" font-family="Arial" font-size="10.00">MLP FC2 (L16)</text>
<text text-anchor="middle" x="162" y="-561.52" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-550.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="162" y="-539.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_1_l16&#45;&gt;mlp_fc2_1_l16 -->
<g id="edge286" class="edge">
<title>mlp_fc1_1_l16&#45;&gt;mlp_fc2_1_l16</title>
<path fill="none" stroke="black" d="M162,-621.36C162,-613.06 162,-603.68 162,-594.77"/>
<polygon fill="black" stroke="black" points="165.5,-594.63 162,-584.63 158.5,-594.63 165.5,-594.63"/>
</g>
<!-- mlp_fc1_2_l16 -->
<g id="node236" class="node">
<title>mlp_fc1_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="568,-673.52 314,-673.52 314,-621.52 568,-621.52 568,-673.52"/>
<text text-anchor="middle" x="441" y="-661.52" font-family="Arial" font-size="10.00">MLP FC1 (L16)</text>
<text text-anchor="middle" x="441" y="-650.52" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-639.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="441" y="-628.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_2_l16 -->
<g id="node238" class="node">
<title>mlp_fc2_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-584.52 310.5,-584.52 310.5,-532.52 571.5,-532.52 571.5,-584.52"/>
<text text-anchor="middle" x="441" y="-572.52" font-family="Arial" font-size="10.00">MLP FC2 (L16)</text>
<text text-anchor="middle" x="441" y="-561.52" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-550.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="441" y="-539.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_2_l16&#45;&gt;mlp_fc2_2_l16 -->
<g id="edge287" class="edge">
<title>mlp_fc1_2_l16&#45;&gt;mlp_fc2_2_l16</title>
<path fill="none" stroke="black" d="M441,-621.36C441,-613.06 441,-603.68 441,-594.77"/>
<polygon fill="black" stroke="black" points="444.5,-594.63 441,-584.63 437.5,-594.63 444.5,-594.63"/>
</g>
<!-- tp_comm_mlp_l16 -->
<g id="node239" class="node">
<title>tp_comm_mlp_l16</title>
<ellipse fill="lightblue" stroke="black" cx="301" cy="-458.75" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="301" y="-472.75" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L16)</text>
<text text-anchor="middle" x="301" y="-461.75" font-family="Arial" font-size="10.00">GPU0 &lt;&#45;&gt; GPU1</text>
<text text-anchor="middle" x="301" y="-450.75" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="301" y="-439.75" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_1_l16&#45;&gt;tp_comm_mlp_l16 -->
<g id="edge288" class="edge">
<title>mlp_fc2_1_l16&#45;&gt;tp_comm_mlp_l16</title>
<path fill="none" stroke="black" d="M197.8,-532.34C211.71,-522.56 228,-511.1 243.48,-500.21"/>
<polygon fill="black" stroke="black" points="245.8,-502.86 251.97,-494.24 241.77,-497.13 245.8,-502.86"/>
</g>
<!-- mlp_fc2_2_l16&#45;&gt;tp_comm_mlp_l16 -->
<g id="edge289" class="edge">
<title>mlp_fc2_2_l16&#45;&gt;tp_comm_mlp_l16</title>
<path fill="none" stroke="black" d="M404.95,-532.34C390.93,-522.56 374.52,-511.1 358.94,-500.21"/>
<polygon fill="black" stroke="black" points="360.59,-497.1 350.38,-494.24 356.58,-502.84 360.59,-497.1"/>
</g>
<!-- ln2_1_l16 -->
<g id="node242" class="node">
<title>ln2_1_l16</title>
<polygon fill="lightgreen" stroke="black" points="292.5,-384.98 31.5,-384.98 31.5,-332.98 292.5,-332.98 292.5,-384.98"/>
<text text-anchor="middle" x="162" y="-372.98" font-family="Arial" font-size="10.00">LayerNorm2 (L16)</text>
<text text-anchor="middle" x="162" y="-361.98" font-family="Arial" font-size="10.00">GPU0</text>
<text text-anchor="middle" x="162" y="-350.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="162" y="-339.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l16&#45;&gt;ln2_1_l16 -->
<g id="edge290" class="edge">
<title>tp_comm_mlp_l16&#45;&gt;ln2_1_l16</title>
<path fill="none" stroke="black" d="M251.99,-423.28C237.1,-412.8 220.82,-401.36 206.25,-391.11"/>
<polygon fill="black" stroke="black" points="208.09,-388.12 197.9,-385.23 204.07,-393.85 208.09,-388.12"/>
</g>
<!-- ln2_2_l16 -->
<g id="node243" class="node">
<title>ln2_2_l16</title>
<polygon fill="lightgreen" stroke="black" points="571.5,-384.98 310.5,-384.98 310.5,-332.98 571.5,-332.98 571.5,-384.98"/>
<text text-anchor="middle" x="441" y="-372.98" font-family="Arial" font-size="10.00">LayerNorm2 (L16)</text>
<text text-anchor="middle" x="441" y="-361.98" font-family="Arial" font-size="10.00">GPU1</text>
<text text-anchor="middle" x="441" y="-350.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="441" y="-339.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_l16&#45;&gt;ln2_2_l16 -->
<g id="edge291" class="edge">
<title>tp_comm_mlp_l16&#45;&gt;ln2_2_l16</title>
<path fill="none" stroke="black" d="M350.36,-423.28C365.36,-412.8 381.76,-401.36 396.43,-391.11"/>
<polygon fill="black" stroke="black" points="398.65,-393.83 404.84,-385.23 394.64,-388.09 398.65,-393.83"/>
</g>
<!-- ln1_1_l16&#45;&gt;mlp_fc1_1_l16 -->
<g id="edge284" class="edge">
<title>ln1_1_l16&#45;&gt;mlp_fc1_1_l16</title>
<path fill="none" stroke="black" d="M162,-710.36C162,-702.06 162,-692.68 162,-683.77"/>
<polygon fill="black" stroke="black" points="165.5,-683.63 162,-673.63 158.5,-683.63 165.5,-683.63"/>
</g>
<!-- ln1_2_l16&#45;&gt;mlp_fc1_2_l16 -->
<g id="edge285" class="edge">
<title>ln1_2_l16&#45;&gt;mlp_fc1_2_l16</title>
<path fill="none" stroke="black" d="M441,-710.36C441,-702.06 441,-692.68 441,-683.77"/>
<polygon fill="black" stroke="black" points="444.5,-683.63 441,-673.63 437.5,-683.63 444.5,-683.63"/>
</g>
<!-- sp_merge_1 -->
<g id="node244" class="node">
<title>sp_merge_1</title>
<polygon fill="lightyellow" stroke="black" points="585.55,-295.98 147.21,-295.98 34.45,-213.98 472.79,-213.98 585.55,-295.98"/>
<text text-anchor="middle" x="310" y="-263.48" font-family="Arial" font-size="10.00">SP Merge (Rep1)</text>
<text text-anchor="middle" x="310" y="-252.48" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="310" y="-241.48" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10240, token_dim=512]</text>
</g>
<!-- ln2_1_l16&#45;&gt;sp_merge_1 -->
<g id="edge292" class="edge">
<title>ln2_1_l16&#45;&gt;sp_merge_1</title>
<path fill="none" stroke="black" d="M198.58,-332.77C212.16,-323.41 228.02,-312.48 243.44,-301.85"/>
<polygon fill="black" stroke="black" points="245.7,-304.55 251.95,-295.99 241.73,-298.78 245.7,-304.55"/>
</g>
<!-- ln2_2_l16&#45;&gt;sp_merge_1 -->
<g id="edge293" class="edge">
<title>ln2_2_l16&#45;&gt;sp_merge_1</title>
<path fill="none" stroke="black" d="M408.62,-332.77C396.71,-323.5 382.82,-312.68 369.29,-302.15"/>
<polygon fill="black" stroke="black" points="371.42,-299.37 361.38,-295.99 367.12,-304.89 371.42,-299.37"/>
</g>
<!-- dp_merge -->
<g id="node487" class="node">
<title>dp_merge</title>
<polygon fill="lightyellow" stroke="black" points="878.99,-176.98 430.4,-176.98 315.01,-94.98 763.6,-94.98 878.99,-176.98"/>
<text text-anchor="middle" x="597" y="-144.48" font-family="Arial" font-size="10.00">DP Merge</text>
<text text-anchor="middle" x="597" y="-133.48" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=10240, token_dim=512]</text>
<text text-anchor="middle" x="597" y="-122.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, token_dim=512]</text>
</g>
<!-- sp_merge_1&#45;&gt;dp_merge -->
<g id="edge584" class="edge">
<title>sp_merge_1&#45;&gt;dp_merge</title>
<path fill="none" stroke="black" d="M408.37,-213.88C434.5,-203.23 462.85,-191.67 489.44,-180.83"/>
<polygon fill="black" stroke="black" points="490.82,-184.05 498.76,-177.03 488.18,-177.57 490.82,-184.05"/>
</g>
<!-- attn_qkv_3_l1 -->
<g id="node246" class="node">
<title>attn_qkv_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="886,-14145.86 616,-14145.86 616,-14093.86 886,-14093.86 886,-14145.86"/>
<text text-anchor="middle" x="751" y="-14133.86" font-family="Arial" font-size="10.00">Attention QKV (L1)</text>
<text text-anchor="middle" x="751" y="-14122.86" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-14111.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-14100.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- sp_split_2&#45;&gt;attn_qkv_3_l1 -->
<g id="edge294" class="edge">
<title>sp_split_2&#45;&gt;attn_qkv_3_l1</title>
<path fill="none" stroke="black" d="M838.5,-14182.84C824.01,-14172.58 808.65,-14161.7 794.91,-14151.96"/>
<polygon fill="black" stroke="black" points="796.76,-14148.99 786.58,-14146.06 792.72,-14154.7 796.76,-14148.99"/>
</g>
<!-- attn_qkv_4_l1 -->
<g id="node247" class="node">
<title>attn_qkv_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1174,-14145.86 904,-14145.86 904,-14093.86 1174,-14093.86 1174,-14145.86"/>
<text text-anchor="middle" x="1039" y="-14133.86" font-family="Arial" font-size="10.00">Attention QKV (L1)</text>
<text text-anchor="middle" x="1039" y="-14122.86" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-14111.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-14100.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- sp_split_2&#45;&gt;attn_qkv_4_l1 -->
<g id="edge295" class="edge">
<title>sp_split_2&#45;&gt;attn_qkv_4_l1</title>
<path fill="none" stroke="black" d="M951.5,-14182.84C965.99,-14172.58 981.35,-14161.7 995.09,-14151.96"/>
<polygon fill="black" stroke="black" points="997.28,-14154.7 1003.42,-14146.06 993.24,-14148.99 997.28,-14154.7"/>
</g>
<!-- tp_comm_attn_gpu23_l1 -->
<g id="node248" class="node">
<title>tp_comm_attn_gpu23_l1</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-14020.09" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-14034.09" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L1)</text>
<text text-anchor="middle" x="895" y="-14023.09" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-14012.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-14001.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l1&#45;&gt;tp_comm_attn_gpu23_l1 -->
<g id="edge296" class="edge">
<title>attn_qkv_3_l1&#45;&gt;tp_comm_attn_gpu23_l1</title>
<path fill="none" stroke="black" d="M788.08,-14093.68C802.63,-14083.8 819.69,-14072.22 835.85,-14061.25"/>
<polygon fill="black" stroke="black" points="837.9,-14064.09 844.2,-14055.58 833.96,-14058.3 837.9,-14064.09"/>
</g>
<!-- attn_qkv_4_l1&#45;&gt;tp_comm_attn_gpu23_l1 -->
<g id="edge297" class="edge">
<title>attn_qkv_4_l1&#45;&gt;tp_comm_attn_gpu23_l1</title>
<path fill="none" stroke="black" d="M1001.92,-14093.68C987.37,-14083.8 970.31,-14072.22 954.15,-14061.25"/>
<polygon fill="black" stroke="black" points="956.04,-14058.3 945.8,-14055.58 952.1,-14064.09 956.04,-14058.3"/>
</g>
<!-- attn_out_3_l1 -->
<g id="node249" class="node">
<title>attn_out_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-13946.32 623.5,-13946.32 623.5,-13894.32 886.5,-13894.32 886.5,-13946.32"/>
<text text-anchor="middle" x="755" y="-13934.32" font-family="Arial" font-size="10.00">Attention Output (L1)</text>
<text text-anchor="middle" x="755" y="-13923.32" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-13912.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-13901.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l1&#45;&gt;attn_out_3_l1 -->
<g id="edge298" class="edge">
<title>tp_comm_attn_gpu23_l1&#45;&gt;attn_out_3_l1</title>
<path fill="none" stroke="black" d="M845.25,-13984.35C830.27,-13973.88 813.93,-13962.48 799.33,-13952.28"/>
<polygon fill="black" stroke="black" points="801.16,-13949.29 790.96,-13946.43 797.15,-13955.03 801.16,-13949.29"/>
</g>
<!-- attn_out_4_l1 -->
<g id="node250" class="node">
<title>attn_out_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-13946.32 904.5,-13946.32 904.5,-13894.32 1167.5,-13894.32 1167.5,-13946.32"/>
<text text-anchor="middle" x="1036" y="-13934.32" font-family="Arial" font-size="10.00">Attention Output (L1)</text>
<text text-anchor="middle" x="1036" y="-13923.32" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-13912.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-13901.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l1&#45;&gt;attn_out_4_l1 -->
<g id="edge299" class="edge">
<title>tp_comm_attn_gpu23_l1&#45;&gt;attn_out_4_l1</title>
<path fill="none" stroke="black" d="M945.11,-13984.35C960.19,-13973.88 976.64,-13962.48 991.35,-13952.28"/>
<polygon fill="black" stroke="black" points="993.56,-13955.01 999.79,-13946.43 989.57,-13949.25 993.56,-13955.01"/>
</g>
<!-- tp_comm_attn_out_gpu23_l1 -->
<g id="node251" class="node">
<title>tp_comm_attn_out_gpu23_l1</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-13820.55" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-13834.55" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L1)</text>
<text text-anchor="middle" x="895" y="-13823.55" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-13812.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-13801.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l1&#45;&gt;tp_comm_attn_out_gpu23_l1 -->
<g id="edge300" class="edge">
<title>attn_out_3_l1&#45;&gt;tp_comm_attn_out_gpu23_l1</title>
<path fill="none" stroke="black" d="M791.05,-13894.14C805.07,-13884.36 821.48,-13872.9 837.06,-13862.01"/>
<polygon fill="black" stroke="black" points="839.42,-13864.63 845.62,-13856.04 835.41,-13858.9 839.42,-13864.63"/>
</g>
<!-- attn_out_4_l1&#45;&gt;tp_comm_attn_out_gpu23_l1 -->
<g id="edge301" class="edge">
<title>attn_out_4_l1&#45;&gt;tp_comm_attn_out_gpu23_l1</title>
<path fill="none" stroke="black" d="M999.69,-13894.14C985.58,-13884.36 969.05,-13872.9 953.35,-13862.01"/>
<polygon fill="black" stroke="black" points="954.95,-13858.86 944.74,-13856.04 950.96,-13864.61 954.95,-13858.86"/>
</g>
<!-- ln1_3_l1 -->
<g id="node257" class="node">
<title>ln1_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-13746.78 624.5,-13746.78 624.5,-13694.78 885.5,-13694.78 885.5,-13746.78"/>
<text text-anchor="middle" x="755" y="-13734.78" font-family="Arial" font-size="10.00">LayerNorm1 (L1)</text>
<text text-anchor="middle" x="755" y="-13723.78" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-13712.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-13701.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l1&#45;&gt;ln1_3_l1 -->
<g id="edge302" class="edge">
<title>tp_comm_attn_out_gpu23_l1&#45;&gt;ln1_3_l1</title>
<path fill="none" stroke="black" d="M845.64,-13785.08C830.64,-13774.6 814.24,-13763.15 799.57,-13752.91"/>
<polygon fill="black" stroke="black" points="801.36,-13749.89 791.16,-13747.03 797.35,-13755.63 801.36,-13749.89"/>
</g>
<!-- ln1_4_l1 -->
<g id="node258" class="node">
<title>ln1_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-13746.78 903.5,-13746.78 903.5,-13694.78 1164.5,-13694.78 1164.5,-13746.78"/>
<text text-anchor="middle" x="1034" y="-13734.78" font-family="Arial" font-size="10.00">LayerNorm1 (L1)</text>
<text text-anchor="middle" x="1034" y="-13723.78" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-13712.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-13701.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l1&#45;&gt;ln1_4_l1 -->
<g id="edge303" class="edge">
<title>tp_comm_attn_out_gpu23_l1&#45;&gt;ln1_4_l1</title>
<path fill="none" stroke="black" d="M944.01,-13785.08C958.9,-13774.6 975.18,-13763.15 989.75,-13752.91"/>
<polygon fill="black" stroke="black" points="991.93,-13755.65 998.1,-13747.03 987.91,-13749.92 991.93,-13755.65"/>
</g>
<!-- mlp_fc1_3_l1 -->
<g id="node252" class="node">
<title>mlp_fc1_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="882,-13657.78 628,-13657.78 628,-13605.78 882,-13605.78 882,-13657.78"/>
<text text-anchor="middle" x="755" y="-13645.78" font-family="Arial" font-size="10.00">MLP FC1 (L1)</text>
<text text-anchor="middle" x="755" y="-13634.78" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-13623.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-13612.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l1 -->
<g id="node254" class="node">
<title>mlp_fc2_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-13568.78 624.5,-13568.78 624.5,-13516.78 885.5,-13516.78 885.5,-13568.78"/>
<text text-anchor="middle" x="755" y="-13556.78" font-family="Arial" font-size="10.00">MLP FC2 (L1)</text>
<text text-anchor="middle" x="755" y="-13545.78" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-13534.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-13523.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l1&#45;&gt;mlp_fc2_3_l1 -->
<g id="edge306" class="edge">
<title>mlp_fc1_3_l1&#45;&gt;mlp_fc2_3_l1</title>
<path fill="none" stroke="black" d="M755,-13605.62C755,-13597.32 755,-13587.94 755,-13579.03"/>
<polygon fill="black" stroke="black" points="758.5,-13578.89 755,-13568.89 751.5,-13578.89 758.5,-13578.89"/>
</g>
<!-- mlp_fc1_4_l1 -->
<g id="node253" class="node">
<title>mlp_fc1_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1161,-13657.78 907,-13657.78 907,-13605.78 1161,-13605.78 1161,-13657.78"/>
<text text-anchor="middle" x="1034" y="-13645.78" font-family="Arial" font-size="10.00">MLP FC1 (L1)</text>
<text text-anchor="middle" x="1034" y="-13634.78" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-13623.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-13612.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l1 -->
<g id="node255" class="node">
<title>mlp_fc2_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-13568.78 903.5,-13568.78 903.5,-13516.78 1164.5,-13516.78 1164.5,-13568.78"/>
<text text-anchor="middle" x="1034" y="-13556.78" font-family="Arial" font-size="10.00">MLP FC2 (L1)</text>
<text text-anchor="middle" x="1034" y="-13545.78" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-13534.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-13523.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l1&#45;&gt;mlp_fc2_4_l1 -->
<g id="edge307" class="edge">
<title>mlp_fc1_4_l1&#45;&gt;mlp_fc2_4_l1</title>
<path fill="none" stroke="black" d="M1034,-13605.62C1034,-13597.32 1034,-13587.94 1034,-13579.03"/>
<polygon fill="black" stroke="black" points="1037.5,-13578.89 1034,-13568.89 1030.5,-13578.89 1037.5,-13578.89"/>
</g>
<!-- tp_comm_mlp_gpu23_l1 -->
<g id="node256" class="node">
<title>tp_comm_mlp_gpu23_l1</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-13443.01" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-13457.01" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L1)</text>
<text text-anchor="middle" x="895" y="-13446.01" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-13435.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-13424.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l1&#45;&gt;tp_comm_mlp_gpu23_l1 -->
<g id="edge308" class="edge">
<title>mlp_fc2_3_l1&#45;&gt;tp_comm_mlp_gpu23_l1</title>
<path fill="none" stroke="black" d="M791.05,-13516.6C805.07,-13506.82 821.48,-13495.36 837.06,-13484.47"/>
<polygon fill="black" stroke="black" points="839.42,-13487.1 845.62,-13478.5 835.41,-13481.36 839.42,-13487.1"/>
</g>
<!-- mlp_fc2_4_l1&#45;&gt;tp_comm_mlp_gpu23_l1 -->
<g id="edge309" class="edge">
<title>mlp_fc2_4_l1&#45;&gt;tp_comm_mlp_gpu23_l1</title>
<path fill="none" stroke="black" d="M998.2,-13516.6C984.29,-13506.82 968,-13495.36 952.52,-13484.47"/>
<polygon fill="black" stroke="black" points="954.23,-13481.39 944.03,-13478.5 950.2,-13487.12 954.23,-13481.39"/>
</g>
<!-- ln2_3_l1 -->
<g id="node259" class="node">
<title>ln2_3_l1</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-13369.24 623.5,-13369.24 623.5,-13317.24 884.5,-13317.24 884.5,-13369.24"/>
<text text-anchor="middle" x="754" y="-13357.24" font-family="Arial" font-size="10.00">LayerNorm2 (L1)</text>
<text text-anchor="middle" x="754" y="-13346.24" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-13335.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-13324.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l1&#45;&gt;ln2_3_l1 -->
<g id="edge310" class="edge">
<title>tp_comm_mlp_gpu23_l1&#45;&gt;ln2_3_l1</title>
<path fill="none" stroke="black" d="M845.29,-13407.54C830.18,-13397.06 813.67,-13385.62 798.89,-13375.37"/>
<polygon fill="black" stroke="black" points="800.63,-13372.32 790.42,-13369.49 796.64,-13378.07 800.63,-13372.32"/>
</g>
<!-- ln2_4_l1 -->
<g id="node260" class="node">
<title>ln2_4_l1</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-13369.24 906.5,-13369.24 906.5,-13317.24 1167.5,-13317.24 1167.5,-13369.24"/>
<text text-anchor="middle" x="1037" y="-13357.24" font-family="Arial" font-size="10.00">LayerNorm2 (L1)</text>
<text text-anchor="middle" x="1037" y="-13346.24" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-13335.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-13324.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l1&#45;&gt;ln2_4_l1 -->
<g id="edge311" class="edge">
<title>tp_comm_mlp_gpu23_l1&#45;&gt;ln2_4_l1</title>
<path fill="none" stroke="black" d="M945.06,-13407.54C960.28,-13397.06 976.91,-13385.62 991.79,-13375.37"/>
<polygon fill="black" stroke="black" points="994.07,-13378.05 1000.32,-13369.49 990.1,-13372.28 994.07,-13378.05"/>
</g>
<!-- ln1_3_l1&#45;&gt;mlp_fc1_3_l1 -->
<g id="edge304" class="edge">
<title>ln1_3_l1&#45;&gt;mlp_fc1_3_l1</title>
<path fill="none" stroke="black" d="M755,-13694.62C755,-13686.32 755,-13676.94 755,-13668.03"/>
<polygon fill="black" stroke="black" points="758.5,-13667.89 755,-13657.89 751.5,-13667.89 758.5,-13667.89"/>
</g>
<!-- ln1_4_l1&#45;&gt;mlp_fc1_4_l1 -->
<g id="edge305" class="edge">
<title>ln1_4_l1&#45;&gt;mlp_fc1_4_l1</title>
<path fill="none" stroke="black" d="M1034,-13694.62C1034,-13686.32 1034,-13676.94 1034,-13668.03"/>
<polygon fill="black" stroke="black" points="1037.5,-13667.89 1034,-13657.89 1030.5,-13667.89 1037.5,-13667.89"/>
</g>
<!-- attn_qkv_3_l2 -->
<g id="node261" class="node">
<title>attn_qkv_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="886,-13280.24 616,-13280.24 616,-13228.24 886,-13228.24 886,-13280.24"/>
<text text-anchor="middle" x="751" y="-13268.24" font-family="Arial" font-size="10.00">Attention QKV (L2)</text>
<text text-anchor="middle" x="751" y="-13257.24" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-13246.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-13235.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l1&#45;&gt;attn_qkv_3_l2 -->
<g id="edge312" class="edge">
<title>ln2_3_l1&#45;&gt;attn_qkv_3_l2</title>
<path fill="none" stroke="black" d="M753.13,-13317.08C752.85,-13308.78 752.52,-13299.4 752.22,-13290.49"/>
<polygon fill="black" stroke="black" points="755.71,-13290.22 751.87,-13280.35 748.71,-13290.46 755.71,-13290.22"/>
</g>
<!-- attn_qkv_4_l2 -->
<g id="node262" class="node">
<title>attn_qkv_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1174,-13280.24 904,-13280.24 904,-13228.24 1174,-13228.24 1174,-13280.24"/>
<text text-anchor="middle" x="1039" y="-13268.24" font-family="Arial" font-size="10.00">Attention QKV (L2)</text>
<text text-anchor="middle" x="1039" y="-13257.24" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-13246.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-13235.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l1&#45;&gt;attn_qkv_4_l2 -->
<g id="edge313" class="edge">
<title>ln2_4_l1&#45;&gt;attn_qkv_4_l2</title>
<path fill="none" stroke="black" d="M1037.58,-13317.08C1037.77,-13308.78 1037.98,-13299.4 1038.19,-13290.49"/>
<polygon fill="black" stroke="black" points="1041.69,-13290.43 1038.42,-13280.35 1034.69,-13290.27 1041.69,-13290.43"/>
</g>
<!-- tp_comm_attn_gpu23_l2 -->
<g id="node263" class="node">
<title>tp_comm_attn_gpu23_l2</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-13154.47" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-13168.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L2)</text>
<text text-anchor="middle" x="895" y="-13157.47" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-13146.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-13135.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l2&#45;&gt;tp_comm_attn_gpu23_l2 -->
<g id="edge314" class="edge">
<title>attn_qkv_3_l2&#45;&gt;tp_comm_attn_gpu23_l2</title>
<path fill="none" stroke="black" d="M788.08,-13228.06C802.63,-13218.19 819.69,-13206.61 835.85,-13195.63"/>
<polygon fill="black" stroke="black" points="837.9,-13198.47 844.2,-13189.96 833.96,-13192.68 837.9,-13198.47"/>
</g>
<!-- attn_qkv_4_l2&#45;&gt;tp_comm_attn_gpu23_l2 -->
<g id="edge315" class="edge">
<title>attn_qkv_4_l2&#45;&gt;tp_comm_attn_gpu23_l2</title>
<path fill="none" stroke="black" d="M1001.92,-13228.06C987.37,-13218.19 970.31,-13206.61 954.15,-13195.63"/>
<polygon fill="black" stroke="black" points="956.04,-13192.68 945.8,-13189.96 952.1,-13198.47 956.04,-13192.68"/>
</g>
<!-- attn_out_3_l2 -->
<g id="node264" class="node">
<title>attn_out_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-13080.7 622.5,-13080.7 622.5,-13028.7 885.5,-13028.7 885.5,-13080.7"/>
<text text-anchor="middle" x="754" y="-13068.7" font-family="Arial" font-size="10.00">Attention Output (L2)</text>
<text text-anchor="middle" x="754" y="-13057.7" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-13046.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="754" y="-13035.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l2&#45;&gt;attn_out_3_l2 -->
<g id="edge316" class="edge">
<title>tp_comm_attn_gpu23_l2&#45;&gt;attn_out_3_l2</title>
<path fill="none" stroke="black" d="M844.89,-13118.73C829.81,-13108.27 813.36,-13096.86 798.65,-13086.66"/>
<polygon fill="black" stroke="black" points="800.43,-13083.64 790.21,-13080.81 796.44,-13089.39 800.43,-13083.64"/>
</g>
<!-- attn_out_4_l2 -->
<g id="node265" class="node">
<title>attn_out_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1166.5,-13080.7 903.5,-13080.7 903.5,-13028.7 1166.5,-13028.7 1166.5,-13080.7"/>
<text text-anchor="middle" x="1035" y="-13068.7" font-family="Arial" font-size="10.00">Attention Output (L2)</text>
<text text-anchor="middle" x="1035" y="-13057.7" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-13046.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1035" y="-13035.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l2&#45;&gt;attn_out_4_l2 -->
<g id="edge317" class="edge">
<title>tp_comm_attn_gpu23_l2&#45;&gt;attn_out_4_l2</title>
<path fill="none" stroke="black" d="M944.75,-13118.73C959.73,-13108.27 976.07,-13096.86 990.67,-13086.66"/>
<polygon fill="black" stroke="black" points="992.85,-13089.41 999.04,-13080.81 988.84,-13083.67 992.85,-13089.41"/>
</g>
<!-- tp_comm_attn_out_gpu23_l2 -->
<g id="node266" class="node">
<title>tp_comm_attn_out_gpu23_l2</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-12954.93" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-12968.93" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L2)</text>
<text text-anchor="middle" x="895" y="-12957.93" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-12946.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-12935.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l2&#45;&gt;tp_comm_attn_out_gpu23_l2 -->
<g id="edge318" class="edge">
<title>attn_out_3_l2&#45;&gt;tp_comm_attn_out_gpu23_l2</title>
<path fill="none" stroke="black" d="M790.31,-13028.53C804.42,-13018.74 820.95,-13007.28 836.65,-12996.4"/>
<polygon fill="black" stroke="black" points="839.04,-12999 845.26,-12990.42 835.05,-12993.24 839.04,-12999"/>
</g>
<!-- attn_out_4_l2&#45;&gt;tp_comm_attn_out_gpu23_l2 -->
<g id="edge319" class="edge">
<title>attn_out_4_l2&#45;&gt;tp_comm_attn_out_gpu23_l2</title>
<path fill="none" stroke="black" d="M998.95,-13028.53C984.93,-13018.74 968.52,-13007.28 952.94,-12996.4"/>
<polygon fill="black" stroke="black" points="954.59,-12993.28 944.38,-12990.42 950.58,-12999.02 954.59,-12993.28"/>
</g>
<!-- ln1_3_l2 -->
<g id="node272" class="node">
<title>ln1_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-12881.16 624.5,-12881.16 624.5,-12829.16 885.5,-12829.16 885.5,-12881.16"/>
<text text-anchor="middle" x="755" y="-12869.16" font-family="Arial" font-size="10.00">LayerNorm1 (L2)</text>
<text text-anchor="middle" x="755" y="-12858.16" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-12847.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-12836.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l2&#45;&gt;ln1_3_l2 -->
<g id="edge320" class="edge">
<title>tp_comm_attn_out_gpu23_l2&#45;&gt;ln1_3_l2</title>
<path fill="none" stroke="black" d="M845.64,-12919.46C830.64,-12908.99 814.24,-12897.54 799.57,-12887.29"/>
<polygon fill="black" stroke="black" points="801.36,-12884.27 791.16,-12881.42 797.35,-12890.01 801.36,-12884.27"/>
</g>
<!-- ln1_4_l2 -->
<g id="node273" class="node">
<title>ln1_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-12881.16 903.5,-12881.16 903.5,-12829.16 1164.5,-12829.16 1164.5,-12881.16"/>
<text text-anchor="middle" x="1034" y="-12869.16" font-family="Arial" font-size="10.00">LayerNorm1 (L2)</text>
<text text-anchor="middle" x="1034" y="-12858.16" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-12847.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-12836.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l2&#45;&gt;ln1_4_l2 -->
<g id="edge321" class="edge">
<title>tp_comm_attn_out_gpu23_l2&#45;&gt;ln1_4_l2</title>
<path fill="none" stroke="black" d="M944.01,-12919.46C958.9,-12908.99 975.18,-12897.54 989.75,-12887.29"/>
<polygon fill="black" stroke="black" points="991.93,-12890.03 998.1,-12881.42 987.91,-12884.31 991.93,-12890.03"/>
</g>
<!-- mlp_fc1_3_l2 -->
<g id="node267" class="node">
<title>mlp_fc1_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="882,-12792.16 628,-12792.16 628,-12740.16 882,-12740.16 882,-12792.16"/>
<text text-anchor="middle" x="755" y="-12780.16" font-family="Arial" font-size="10.00">MLP FC1 (L2)</text>
<text text-anchor="middle" x="755" y="-12769.16" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-12758.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-12747.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l2 -->
<g id="node269" class="node">
<title>mlp_fc2_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-12703.16 624.5,-12703.16 624.5,-12651.16 885.5,-12651.16 885.5,-12703.16"/>
<text text-anchor="middle" x="755" y="-12691.16" font-family="Arial" font-size="10.00">MLP FC2 (L2)</text>
<text text-anchor="middle" x="755" y="-12680.16" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-12669.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-12658.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l2&#45;&gt;mlp_fc2_3_l2 -->
<g id="edge324" class="edge">
<title>mlp_fc1_3_l2&#45;&gt;mlp_fc2_3_l2</title>
<path fill="none" stroke="black" d="M755,-12740C755,-12731.7 755,-12722.32 755,-12713.41"/>
<polygon fill="black" stroke="black" points="758.5,-12713.27 755,-12703.27 751.5,-12713.27 758.5,-12713.27"/>
</g>
<!-- mlp_fc1_4_l2 -->
<g id="node268" class="node">
<title>mlp_fc1_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1161,-12792.16 907,-12792.16 907,-12740.16 1161,-12740.16 1161,-12792.16"/>
<text text-anchor="middle" x="1034" y="-12780.16" font-family="Arial" font-size="10.00">MLP FC1 (L2)</text>
<text text-anchor="middle" x="1034" y="-12769.16" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-12758.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-12747.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l2 -->
<g id="node270" class="node">
<title>mlp_fc2_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-12703.16 903.5,-12703.16 903.5,-12651.16 1164.5,-12651.16 1164.5,-12703.16"/>
<text text-anchor="middle" x="1034" y="-12691.16" font-family="Arial" font-size="10.00">MLP FC2 (L2)</text>
<text text-anchor="middle" x="1034" y="-12680.16" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-12669.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-12658.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l2&#45;&gt;mlp_fc2_4_l2 -->
<g id="edge325" class="edge">
<title>mlp_fc1_4_l2&#45;&gt;mlp_fc2_4_l2</title>
<path fill="none" stroke="black" d="M1034,-12740C1034,-12731.7 1034,-12722.32 1034,-12713.41"/>
<polygon fill="black" stroke="black" points="1037.5,-12713.27 1034,-12703.27 1030.5,-12713.27 1037.5,-12713.27"/>
</g>
<!-- tp_comm_mlp_gpu23_l2 -->
<g id="node271" class="node">
<title>tp_comm_mlp_gpu23_l2</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-12577.39" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-12591.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L2)</text>
<text text-anchor="middle" x="895" y="-12580.39" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-12569.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-12558.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l2&#45;&gt;tp_comm_mlp_gpu23_l2 -->
<g id="edge326" class="edge">
<title>mlp_fc2_3_l2&#45;&gt;tp_comm_mlp_gpu23_l2</title>
<path fill="none" stroke="black" d="M791.05,-12650.99C805.07,-12641.2 821.48,-12629.74 837.06,-12618.86"/>
<polygon fill="black" stroke="black" points="839.42,-12621.48 845.62,-12612.88 835.41,-12615.74 839.42,-12621.48"/>
</g>
<!-- mlp_fc2_4_l2&#45;&gt;tp_comm_mlp_gpu23_l2 -->
<g id="edge327" class="edge">
<title>mlp_fc2_4_l2&#45;&gt;tp_comm_mlp_gpu23_l2</title>
<path fill="none" stroke="black" d="M998.2,-12650.99C984.29,-12641.2 968,-12629.74 952.52,-12618.86"/>
<polygon fill="black" stroke="black" points="954.23,-12615.77 944.03,-12612.88 950.2,-12621.5 954.23,-12615.77"/>
</g>
<!-- ln2_3_l2 -->
<g id="node274" class="node">
<title>ln2_3_l2</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-12503.63 623.5,-12503.63 623.5,-12451.63 884.5,-12451.63 884.5,-12503.63"/>
<text text-anchor="middle" x="754" y="-12491.63" font-family="Arial" font-size="10.00">LayerNorm2 (L2)</text>
<text text-anchor="middle" x="754" y="-12480.63" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-12469.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-12458.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l2&#45;&gt;ln2_3_l2 -->
<g id="edge328" class="edge">
<title>tp_comm_mlp_gpu23_l2&#45;&gt;ln2_3_l2</title>
<path fill="none" stroke="black" d="M845.29,-12541.92C830.18,-12531.45 813.67,-12520 798.89,-12509.75"/>
<polygon fill="black" stroke="black" points="800.63,-12506.7 790.42,-12503.88 796.64,-12512.45 800.63,-12506.7"/>
</g>
<!-- ln2_4_l2 -->
<g id="node275" class="node">
<title>ln2_4_l2</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-12503.63 906.5,-12503.63 906.5,-12451.63 1167.5,-12451.63 1167.5,-12503.63"/>
<text text-anchor="middle" x="1037" y="-12491.63" font-family="Arial" font-size="10.00">LayerNorm2 (L2)</text>
<text text-anchor="middle" x="1037" y="-12480.63" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-12469.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-12458.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l2&#45;&gt;ln2_4_l2 -->
<g id="edge329" class="edge">
<title>tp_comm_mlp_gpu23_l2&#45;&gt;ln2_4_l2</title>
<path fill="none" stroke="black" d="M945.06,-12541.92C960.28,-12531.45 976.91,-12520 991.79,-12509.75"/>
<polygon fill="black" stroke="black" points="994.07,-12512.43 1000.32,-12503.88 990.1,-12506.66 994.07,-12512.43"/>
</g>
<!-- ln1_3_l2&#45;&gt;mlp_fc1_3_l2 -->
<g id="edge322" class="edge">
<title>ln1_3_l2&#45;&gt;mlp_fc1_3_l2</title>
<path fill="none" stroke="black" d="M755,-12829C755,-12820.7 755,-12811.32 755,-12802.41"/>
<polygon fill="black" stroke="black" points="758.5,-12802.27 755,-12792.27 751.5,-12802.27 758.5,-12802.27"/>
</g>
<!-- ln1_4_l2&#45;&gt;mlp_fc1_4_l2 -->
<g id="edge323" class="edge">
<title>ln1_4_l2&#45;&gt;mlp_fc1_4_l2</title>
<path fill="none" stroke="black" d="M1034,-12829C1034,-12820.7 1034,-12811.32 1034,-12802.41"/>
<polygon fill="black" stroke="black" points="1037.5,-12802.27 1034,-12792.27 1030.5,-12802.27 1037.5,-12802.27"/>
</g>
<!-- attn_qkv_3_l3 -->
<g id="node276" class="node">
<title>attn_qkv_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="886,-12414.63 616,-12414.63 616,-12362.63 886,-12362.63 886,-12414.63"/>
<text text-anchor="middle" x="751" y="-12402.63" font-family="Arial" font-size="10.00">Attention QKV (L3)</text>
<text text-anchor="middle" x="751" y="-12391.63" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-12380.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-12369.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l2&#45;&gt;attn_qkv_3_l3 -->
<g id="edge330" class="edge">
<title>ln2_3_l2&#45;&gt;attn_qkv_3_l3</title>
<path fill="none" stroke="black" d="M753.13,-12451.46C752.85,-12443.17 752.52,-12433.78 752.22,-12424.87"/>
<polygon fill="black" stroke="black" points="755.71,-12424.61 751.87,-12414.73 748.71,-12424.85 755.71,-12424.61"/>
</g>
<!-- attn_qkv_4_l3 -->
<g id="node277" class="node">
<title>attn_qkv_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1174,-12414.63 904,-12414.63 904,-12362.63 1174,-12362.63 1174,-12414.63"/>
<text text-anchor="middle" x="1039" y="-12402.63" font-family="Arial" font-size="10.00">Attention QKV (L3)</text>
<text text-anchor="middle" x="1039" y="-12391.63" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-12380.63" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-12369.63" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l2&#45;&gt;attn_qkv_4_l3 -->
<g id="edge331" class="edge">
<title>ln2_4_l2&#45;&gt;attn_qkv_4_l3</title>
<path fill="none" stroke="black" d="M1037.58,-12451.46C1037.77,-12443.17 1037.98,-12433.78 1038.19,-12424.87"/>
<polygon fill="black" stroke="black" points="1041.69,-12424.81 1038.42,-12414.73 1034.69,-12424.65 1041.69,-12424.81"/>
</g>
<!-- tp_comm_attn_gpu23_l3 -->
<g id="node278" class="node">
<title>tp_comm_attn_gpu23_l3</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-12288.86" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-12302.86" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L3)</text>
<text text-anchor="middle" x="895" y="-12291.86" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-12280.86" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-12269.86" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l3&#45;&gt;tp_comm_attn_gpu23_l3 -->
<g id="edge332" class="edge">
<title>attn_qkv_3_l3&#45;&gt;tp_comm_attn_gpu23_l3</title>
<path fill="none" stroke="black" d="M788.08,-12362.45C802.63,-12352.57 819.69,-12340.99 835.85,-12330.02"/>
<polygon fill="black" stroke="black" points="837.9,-12332.86 844.2,-12324.34 833.96,-12327.07 837.9,-12332.86"/>
</g>
<!-- attn_qkv_4_l3&#45;&gt;tp_comm_attn_gpu23_l3 -->
<g id="edge333" class="edge">
<title>attn_qkv_4_l3&#45;&gt;tp_comm_attn_gpu23_l3</title>
<path fill="none" stroke="black" d="M1001.92,-12362.45C987.37,-12352.57 970.31,-12340.99 954.15,-12330.02"/>
<polygon fill="black" stroke="black" points="956.04,-12327.07 945.8,-12324.34 952.1,-12332.86 956.04,-12327.07"/>
</g>
<!-- attn_out_3_l3 -->
<g id="node279" class="node">
<title>attn_out_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-12215.09 623.5,-12215.09 623.5,-12163.09 886.5,-12163.09 886.5,-12215.09"/>
<text text-anchor="middle" x="755" y="-12203.09" font-family="Arial" font-size="10.00">Attention Output (L3)</text>
<text text-anchor="middle" x="755" y="-12192.09" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-12181.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-12170.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l3&#45;&gt;attn_out_3_l3 -->
<g id="edge334" class="edge">
<title>tp_comm_attn_gpu23_l3&#45;&gt;attn_out_3_l3</title>
<path fill="none" stroke="black" d="M845.25,-12253.11C830.27,-12242.65 813.93,-12231.24 799.33,-12221.05"/>
<polygon fill="black" stroke="black" points="801.16,-12218.05 790.96,-12215.2 797.15,-12223.79 801.16,-12218.05"/>
</g>
<!-- attn_out_4_l3 -->
<g id="node280" class="node">
<title>attn_out_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-12215.09 904.5,-12215.09 904.5,-12163.09 1167.5,-12163.09 1167.5,-12215.09"/>
<text text-anchor="middle" x="1036" y="-12203.09" font-family="Arial" font-size="10.00">Attention Output (L3)</text>
<text text-anchor="middle" x="1036" y="-12192.09" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-12181.09" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-12170.09" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l3&#45;&gt;attn_out_4_l3 -->
<g id="edge335" class="edge">
<title>tp_comm_attn_gpu23_l3&#45;&gt;attn_out_4_l3</title>
<path fill="none" stroke="black" d="M945.11,-12253.11C960.19,-12242.65 976.64,-12231.24 991.35,-12221.05"/>
<polygon fill="black" stroke="black" points="993.56,-12223.77 999.79,-12215.2 989.57,-12218.02 993.56,-12223.77"/>
</g>
<!-- tp_comm_attn_out_gpu23_l3 -->
<g id="node281" class="node">
<title>tp_comm_attn_out_gpu23_l3</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-12089.32" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-12103.32" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L3)</text>
<text text-anchor="middle" x="895" y="-12092.32" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-12081.32" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-12070.32" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l3&#45;&gt;tp_comm_attn_out_gpu23_l3 -->
<g id="edge336" class="edge">
<title>attn_out_3_l3&#45;&gt;tp_comm_attn_out_gpu23_l3</title>
<path fill="none" stroke="black" d="M791.05,-12162.91C805.07,-12153.12 821.48,-12141.66 837.06,-12130.78"/>
<polygon fill="black" stroke="black" points="839.42,-12133.4 845.62,-12124.8 835.41,-12127.66 839.42,-12133.4"/>
</g>
<!-- attn_out_4_l3&#45;&gt;tp_comm_attn_out_gpu23_l3 -->
<g id="edge337" class="edge">
<title>attn_out_4_l3&#45;&gt;tp_comm_attn_out_gpu23_l3</title>
<path fill="none" stroke="black" d="M999.69,-12162.91C985.58,-12153.12 969.05,-12141.66 953.35,-12130.78"/>
<polygon fill="black" stroke="black" points="954.95,-12127.63 944.74,-12124.8 950.96,-12133.38 954.95,-12127.63"/>
</g>
<!-- ln1_3_l3 -->
<g id="node287" class="node">
<title>ln1_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-12015.55 624.5,-12015.55 624.5,-11963.55 885.5,-11963.55 885.5,-12015.55"/>
<text text-anchor="middle" x="755" y="-12003.55" font-family="Arial" font-size="10.00">LayerNorm1 (L3)</text>
<text text-anchor="middle" x="755" y="-11992.55" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-11981.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-11970.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l3&#45;&gt;ln1_3_l3 -->
<g id="edge338" class="edge">
<title>tp_comm_attn_out_gpu23_l3&#45;&gt;ln1_3_l3</title>
<path fill="none" stroke="black" d="M845.64,-12053.85C830.64,-12043.37 814.24,-12031.92 799.57,-12021.67"/>
<polygon fill="black" stroke="black" points="801.36,-12018.65 791.16,-12015.8 797.35,-12024.39 801.36,-12018.65"/>
</g>
<!-- ln1_4_l3 -->
<g id="node288" class="node">
<title>ln1_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-12015.55 903.5,-12015.55 903.5,-11963.55 1164.5,-11963.55 1164.5,-12015.55"/>
<text text-anchor="middle" x="1034" y="-12003.55" font-family="Arial" font-size="10.00">LayerNorm1 (L3)</text>
<text text-anchor="middle" x="1034" y="-11992.55" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-11981.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-11970.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l3&#45;&gt;ln1_4_l3 -->
<g id="edge339" class="edge">
<title>tp_comm_attn_out_gpu23_l3&#45;&gt;ln1_4_l3</title>
<path fill="none" stroke="black" d="M944.01,-12053.85C958.9,-12043.37 975.18,-12031.92 989.75,-12021.67"/>
<polygon fill="black" stroke="black" points="991.93,-12024.41 998.1,-12015.8 987.91,-12018.69 991.93,-12024.41"/>
</g>
<!-- mlp_fc1_3_l3 -->
<g id="node282" class="node">
<title>mlp_fc1_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="882,-11926.55 628,-11926.55 628,-11874.55 882,-11874.55 882,-11926.55"/>
<text text-anchor="middle" x="755" y="-11914.55" font-family="Arial" font-size="10.00">MLP FC1 (L3)</text>
<text text-anchor="middle" x="755" y="-11903.55" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-11892.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-11881.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l3 -->
<g id="node284" class="node">
<title>mlp_fc2_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-11837.55 624.5,-11837.55 624.5,-11785.55 885.5,-11785.55 885.5,-11837.55"/>
<text text-anchor="middle" x="755" y="-11825.55" font-family="Arial" font-size="10.00">MLP FC2 (L3)</text>
<text text-anchor="middle" x="755" y="-11814.55" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-11803.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-11792.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l3&#45;&gt;mlp_fc2_3_l3 -->
<g id="edge342" class="edge">
<title>mlp_fc1_3_l3&#45;&gt;mlp_fc2_3_l3</title>
<path fill="none" stroke="black" d="M755,-11874.38C755,-11866.09 755,-11856.7 755,-11847.8"/>
<polygon fill="black" stroke="black" points="758.5,-11847.65 755,-11837.65 751.5,-11847.65 758.5,-11847.65"/>
</g>
<!-- mlp_fc1_4_l3 -->
<g id="node283" class="node">
<title>mlp_fc1_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1161,-11926.55 907,-11926.55 907,-11874.55 1161,-11874.55 1161,-11926.55"/>
<text text-anchor="middle" x="1034" y="-11914.55" font-family="Arial" font-size="10.00">MLP FC1 (L3)</text>
<text text-anchor="middle" x="1034" y="-11903.55" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-11892.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-11881.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l3 -->
<g id="node285" class="node">
<title>mlp_fc2_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-11837.55 903.5,-11837.55 903.5,-11785.55 1164.5,-11785.55 1164.5,-11837.55"/>
<text text-anchor="middle" x="1034" y="-11825.55" font-family="Arial" font-size="10.00">MLP FC2 (L3)</text>
<text text-anchor="middle" x="1034" y="-11814.55" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-11803.55" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-11792.55" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l3&#45;&gt;mlp_fc2_4_l3 -->
<g id="edge343" class="edge">
<title>mlp_fc1_4_l3&#45;&gt;mlp_fc2_4_l3</title>
<path fill="none" stroke="black" d="M1034,-11874.38C1034,-11866.09 1034,-11856.7 1034,-11847.8"/>
<polygon fill="black" stroke="black" points="1037.5,-11847.65 1034,-11837.65 1030.5,-11847.65 1037.5,-11847.65"/>
</g>
<!-- tp_comm_mlp_gpu23_l3 -->
<g id="node286" class="node">
<title>tp_comm_mlp_gpu23_l3</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-11711.78" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-11725.78" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L3)</text>
<text text-anchor="middle" x="895" y="-11714.78" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-11703.78" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-11692.78" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l3&#45;&gt;tp_comm_mlp_gpu23_l3 -->
<g id="edge344" class="edge">
<title>mlp_fc2_3_l3&#45;&gt;tp_comm_mlp_gpu23_l3</title>
<path fill="none" stroke="black" d="M791.05,-11785.37C805.07,-11775.58 821.48,-11764.12 837.06,-11753.24"/>
<polygon fill="black" stroke="black" points="839.42,-11755.86 845.62,-11747.27 835.41,-11750.12 839.42,-11755.86"/>
</g>
<!-- mlp_fc2_4_l3&#45;&gt;tp_comm_mlp_gpu23_l3 -->
<g id="edge345" class="edge">
<title>mlp_fc2_4_l3&#45;&gt;tp_comm_mlp_gpu23_l3</title>
<path fill="none" stroke="black" d="M998.2,-11785.37C984.29,-11775.58 968,-11764.12 952.52,-11753.24"/>
<polygon fill="black" stroke="black" points="954.23,-11750.16 944.03,-11747.27 950.2,-11755.88 954.23,-11750.16"/>
</g>
<!-- ln2_3_l3 -->
<g id="node289" class="node">
<title>ln2_3_l3</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-11638.01 623.5,-11638.01 623.5,-11586.01 884.5,-11586.01 884.5,-11638.01"/>
<text text-anchor="middle" x="754" y="-11626.01" font-family="Arial" font-size="10.00">LayerNorm2 (L3)</text>
<text text-anchor="middle" x="754" y="-11615.01" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-11604.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-11593.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l3&#45;&gt;ln2_3_l3 -->
<g id="edge346" class="edge">
<title>tp_comm_mlp_gpu23_l3&#45;&gt;ln2_3_l3</title>
<path fill="none" stroke="black" d="M845.29,-11676.31C830.18,-11665.83 813.67,-11654.38 798.89,-11644.14"/>
<polygon fill="black" stroke="black" points="800.63,-11641.08 790.42,-11638.26 796.64,-11646.83 800.63,-11641.08"/>
</g>
<!-- ln2_4_l3 -->
<g id="node290" class="node">
<title>ln2_4_l3</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-11638.01 906.5,-11638.01 906.5,-11586.01 1167.5,-11586.01 1167.5,-11638.01"/>
<text text-anchor="middle" x="1037" y="-11626.01" font-family="Arial" font-size="10.00">LayerNorm2 (L3)</text>
<text text-anchor="middle" x="1037" y="-11615.01" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-11604.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-11593.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l3&#45;&gt;ln2_4_l3 -->
<g id="edge347" class="edge">
<title>tp_comm_mlp_gpu23_l3&#45;&gt;ln2_4_l3</title>
<path fill="none" stroke="black" d="M945.06,-11676.31C960.28,-11665.83 976.91,-11654.38 991.79,-11644.14"/>
<polygon fill="black" stroke="black" points="994.07,-11646.81 1000.32,-11638.26 990.1,-11641.05 994.07,-11646.81"/>
</g>
<!-- ln1_3_l3&#45;&gt;mlp_fc1_3_l3 -->
<g id="edge340" class="edge">
<title>ln1_3_l3&#45;&gt;mlp_fc1_3_l3</title>
<path fill="none" stroke="black" d="M755,-11963.38C755,-11955.09 755,-11945.7 755,-11936.8"/>
<polygon fill="black" stroke="black" points="758.5,-11936.65 755,-11926.65 751.5,-11936.65 758.5,-11936.65"/>
</g>
<!-- ln1_4_l3&#45;&gt;mlp_fc1_4_l3 -->
<g id="edge341" class="edge">
<title>ln1_4_l3&#45;&gt;mlp_fc1_4_l3</title>
<path fill="none" stroke="black" d="M1034,-11963.38C1034,-11955.09 1034,-11945.7 1034,-11936.8"/>
<polygon fill="black" stroke="black" points="1037.5,-11936.65 1034,-11926.65 1030.5,-11936.65 1037.5,-11936.65"/>
</g>
<!-- attn_qkv_3_l4 -->
<g id="node291" class="node">
<title>attn_qkv_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="886,-11549.01 616,-11549.01 616,-11497.01 886,-11497.01 886,-11549.01"/>
<text text-anchor="middle" x="751" y="-11537.01" font-family="Arial" font-size="10.00">Attention QKV (L4)</text>
<text text-anchor="middle" x="751" y="-11526.01" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-11515.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-11504.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l3&#45;&gt;attn_qkv_3_l4 -->
<g id="edge348" class="edge">
<title>ln2_3_l3&#45;&gt;attn_qkv_3_l4</title>
<path fill="none" stroke="black" d="M753.13,-11585.84C752.85,-11577.55 752.52,-11568.16 752.22,-11559.26"/>
<polygon fill="black" stroke="black" points="755.71,-11558.99 751.87,-11549.12 748.71,-11559.23 755.71,-11558.99"/>
</g>
<!-- attn_qkv_4_l4 -->
<g id="node292" class="node">
<title>attn_qkv_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1174,-11549.01 904,-11549.01 904,-11497.01 1174,-11497.01 1174,-11549.01"/>
<text text-anchor="middle" x="1039" y="-11537.01" font-family="Arial" font-size="10.00">Attention QKV (L4)</text>
<text text-anchor="middle" x="1039" y="-11526.01" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-11515.01" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-11504.01" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l3&#45;&gt;attn_qkv_4_l4 -->
<g id="edge349" class="edge">
<title>ln2_4_l3&#45;&gt;attn_qkv_4_l4</title>
<path fill="none" stroke="black" d="M1037.58,-11585.84C1037.77,-11577.55 1037.98,-11568.16 1038.19,-11559.26"/>
<polygon fill="black" stroke="black" points="1041.69,-11559.19 1038.42,-11549.12 1034.69,-11559.03 1041.69,-11559.19"/>
</g>
<!-- tp_comm_attn_gpu23_l4 -->
<g id="node293" class="node">
<title>tp_comm_attn_gpu23_l4</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-11423.24" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-11437.24" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L4)</text>
<text text-anchor="middle" x="895" y="-11426.24" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-11415.24" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-11404.24" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l4&#45;&gt;tp_comm_attn_gpu23_l4 -->
<g id="edge350" class="edge">
<title>attn_qkv_3_l4&#45;&gt;tp_comm_attn_gpu23_l4</title>
<path fill="none" stroke="black" d="M788.08,-11496.83C802.63,-11486.95 819.69,-11475.37 835.85,-11464.4"/>
<polygon fill="black" stroke="black" points="837.9,-11467.24 844.2,-11458.73 833.96,-11461.45 837.9,-11467.24"/>
</g>
<!-- attn_qkv_4_l4&#45;&gt;tp_comm_attn_gpu23_l4 -->
<g id="edge351" class="edge">
<title>attn_qkv_4_l4&#45;&gt;tp_comm_attn_gpu23_l4</title>
<path fill="none" stroke="black" d="M1001.92,-11496.83C987.37,-11486.95 970.31,-11475.37 954.15,-11464.4"/>
<polygon fill="black" stroke="black" points="956.04,-11461.45 945.8,-11458.73 952.1,-11467.24 956.04,-11461.45"/>
</g>
<!-- attn_out_3_l4 -->
<g id="node294" class="node">
<title>attn_out_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-11349.47 622.5,-11349.47 622.5,-11297.47 885.5,-11297.47 885.5,-11349.47"/>
<text text-anchor="middle" x="754" y="-11337.47" font-family="Arial" font-size="10.00">Attention Output (L4)</text>
<text text-anchor="middle" x="754" y="-11326.47" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-11315.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="754" y="-11304.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l4&#45;&gt;attn_out_3_l4 -->
<g id="edge352" class="edge">
<title>tp_comm_attn_gpu23_l4&#45;&gt;attn_out_3_l4</title>
<path fill="none" stroke="black" d="M844.89,-11387.49C829.81,-11377.03 813.36,-11365.63 798.65,-11355.43"/>
<polygon fill="black" stroke="black" points="800.43,-11352.4 790.21,-11349.58 796.44,-11358.15 800.43,-11352.4"/>
</g>
<!-- attn_out_4_l4 -->
<g id="node295" class="node">
<title>attn_out_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1166.5,-11349.47 903.5,-11349.47 903.5,-11297.47 1166.5,-11297.47 1166.5,-11349.47"/>
<text text-anchor="middle" x="1035" y="-11337.47" font-family="Arial" font-size="10.00">Attention Output (L4)</text>
<text text-anchor="middle" x="1035" y="-11326.47" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-11315.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1035" y="-11304.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l4&#45;&gt;attn_out_4_l4 -->
<g id="edge353" class="edge">
<title>tp_comm_attn_gpu23_l4&#45;&gt;attn_out_4_l4</title>
<path fill="none" stroke="black" d="M944.75,-11387.49C959.73,-11377.03 976.07,-11365.63 990.67,-11355.43"/>
<polygon fill="black" stroke="black" points="992.85,-11358.17 999.04,-11349.58 988.84,-11352.44 992.85,-11358.17"/>
</g>
<!-- tp_comm_attn_out_gpu23_l4 -->
<g id="node296" class="node">
<title>tp_comm_attn_out_gpu23_l4</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-11223.7" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-11237.7" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L4)</text>
<text text-anchor="middle" x="895" y="-11226.7" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-11215.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-11204.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l4&#45;&gt;tp_comm_attn_out_gpu23_l4 -->
<g id="edge354" class="edge">
<title>attn_out_3_l4&#45;&gt;tp_comm_attn_out_gpu23_l4</title>
<path fill="none" stroke="black" d="M790.31,-11297.29C804.42,-11287.5 820.95,-11276.05 836.65,-11265.16"/>
<polygon fill="black" stroke="black" points="839.04,-11267.76 845.26,-11259.19 835.05,-11262.01 839.04,-11267.76"/>
</g>
<!-- attn_out_4_l4&#45;&gt;tp_comm_attn_out_gpu23_l4 -->
<g id="edge355" class="edge">
<title>attn_out_4_l4&#45;&gt;tp_comm_attn_out_gpu23_l4</title>
<path fill="none" stroke="black" d="M998.95,-11297.29C984.93,-11287.5 968.52,-11276.05 952.94,-11265.16"/>
<polygon fill="black" stroke="black" points="954.59,-11262.04 944.38,-11259.19 950.58,-11267.78 954.59,-11262.04"/>
</g>
<!-- ln1_3_l4 -->
<g id="node302" class="node">
<title>ln1_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-11149.93 624.5,-11149.93 624.5,-11097.93 885.5,-11097.93 885.5,-11149.93"/>
<text text-anchor="middle" x="755" y="-11137.93" font-family="Arial" font-size="10.00">LayerNorm1 (L4)</text>
<text text-anchor="middle" x="755" y="-11126.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-11115.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-11104.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l4&#45;&gt;ln1_3_l4 -->
<g id="edge356" class="edge">
<title>tp_comm_attn_out_gpu23_l4&#45;&gt;ln1_3_l4</title>
<path fill="none" stroke="black" d="M845.64,-11188.23C830.64,-11177.75 814.24,-11166.3 799.57,-11156.06"/>
<polygon fill="black" stroke="black" points="801.36,-11153.04 791.16,-11150.18 797.35,-11158.78 801.36,-11153.04"/>
</g>
<!-- ln1_4_l4 -->
<g id="node303" class="node">
<title>ln1_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-11149.93 903.5,-11149.93 903.5,-11097.93 1164.5,-11097.93 1164.5,-11149.93"/>
<text text-anchor="middle" x="1034" y="-11137.93" font-family="Arial" font-size="10.00">LayerNorm1 (L4)</text>
<text text-anchor="middle" x="1034" y="-11126.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-11115.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-11104.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l4&#45;&gt;ln1_4_l4 -->
<g id="edge357" class="edge">
<title>tp_comm_attn_out_gpu23_l4&#45;&gt;ln1_4_l4</title>
<path fill="none" stroke="black" d="M944.01,-11188.23C958.9,-11177.75 975.18,-11166.3 989.75,-11156.06"/>
<polygon fill="black" stroke="black" points="991.93,-11158.8 998.1,-11150.18 987.91,-11153.07 991.93,-11158.8"/>
</g>
<!-- mlp_fc1_3_l4 -->
<g id="node297" class="node">
<title>mlp_fc1_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="882,-11060.93 628,-11060.93 628,-11008.93 882,-11008.93 882,-11060.93"/>
<text text-anchor="middle" x="755" y="-11048.93" font-family="Arial" font-size="10.00">MLP FC1 (L4)</text>
<text text-anchor="middle" x="755" y="-11037.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-11026.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-11015.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l4 -->
<g id="node299" class="node">
<title>mlp_fc2_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-10971.93 624.5,-10971.93 624.5,-10919.93 885.5,-10919.93 885.5,-10971.93"/>
<text text-anchor="middle" x="755" y="-10959.93" font-family="Arial" font-size="10.00">MLP FC2 (L4)</text>
<text text-anchor="middle" x="755" y="-10948.93" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-10937.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-10926.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l4&#45;&gt;mlp_fc2_3_l4 -->
<g id="edge360" class="edge">
<title>mlp_fc1_3_l4&#45;&gt;mlp_fc2_3_l4</title>
<path fill="none" stroke="black" d="M755,-11008.77C755,-11000.47 755,-10991.08 755,-10982.18"/>
<polygon fill="black" stroke="black" points="758.5,-10982.04 755,-10972.04 751.5,-10982.04 758.5,-10982.04"/>
</g>
<!-- mlp_fc1_4_l4 -->
<g id="node298" class="node">
<title>mlp_fc1_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1161,-11060.93 907,-11060.93 907,-11008.93 1161,-11008.93 1161,-11060.93"/>
<text text-anchor="middle" x="1034" y="-11048.93" font-family="Arial" font-size="10.00">MLP FC1 (L4)</text>
<text text-anchor="middle" x="1034" y="-11037.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-11026.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-11015.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l4 -->
<g id="node300" class="node">
<title>mlp_fc2_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-10971.93 903.5,-10971.93 903.5,-10919.93 1164.5,-10919.93 1164.5,-10971.93"/>
<text text-anchor="middle" x="1034" y="-10959.93" font-family="Arial" font-size="10.00">MLP FC2 (L4)</text>
<text text-anchor="middle" x="1034" y="-10948.93" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-10937.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-10926.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l4&#45;&gt;mlp_fc2_4_l4 -->
<g id="edge361" class="edge">
<title>mlp_fc1_4_l4&#45;&gt;mlp_fc2_4_l4</title>
<path fill="none" stroke="black" d="M1034,-11008.77C1034,-11000.47 1034,-10991.08 1034,-10982.18"/>
<polygon fill="black" stroke="black" points="1037.5,-10982.04 1034,-10972.04 1030.5,-10982.04 1037.5,-10982.04"/>
</g>
<!-- tp_comm_mlp_gpu23_l4 -->
<g id="node301" class="node">
<title>tp_comm_mlp_gpu23_l4</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-10846.16" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-10860.16" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L4)</text>
<text text-anchor="middle" x="895" y="-10849.16" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-10838.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-10827.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l4&#45;&gt;tp_comm_mlp_gpu23_l4 -->
<g id="edge362" class="edge">
<title>mlp_fc2_3_l4&#45;&gt;tp_comm_mlp_gpu23_l4</title>
<path fill="none" stroke="black" d="M791.05,-10919.75C805.07,-10909.97 821.48,-10898.51 837.06,-10887.62"/>
<polygon fill="black" stroke="black" points="839.42,-10890.24 845.62,-10881.65 835.41,-10884.5 839.42,-10890.24"/>
</g>
<!-- mlp_fc2_4_l4&#45;&gt;tp_comm_mlp_gpu23_l4 -->
<g id="edge363" class="edge">
<title>mlp_fc2_4_l4&#45;&gt;tp_comm_mlp_gpu23_l4</title>
<path fill="none" stroke="black" d="M998.2,-10919.75C984.29,-10909.97 968,-10898.51 952.52,-10887.62"/>
<polygon fill="black" stroke="black" points="954.23,-10884.54 944.03,-10881.65 950.2,-10890.26 954.23,-10884.54"/>
</g>
<!-- ln2_3_l4 -->
<g id="node304" class="node">
<title>ln2_3_l4</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-10772.39 623.5,-10772.39 623.5,-10720.39 884.5,-10720.39 884.5,-10772.39"/>
<text text-anchor="middle" x="754" y="-10760.39" font-family="Arial" font-size="10.00">LayerNorm2 (L4)</text>
<text text-anchor="middle" x="754" y="-10749.39" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-10738.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-10727.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l4&#45;&gt;ln2_3_l4 -->
<g id="edge364" class="edge">
<title>tp_comm_mlp_gpu23_l4&#45;&gt;ln2_3_l4</title>
<path fill="none" stroke="black" d="M845.29,-10810.69C830.18,-10800.21 813.67,-10788.76 798.89,-10778.52"/>
<polygon fill="black" stroke="black" points="800.63,-10775.46 790.42,-10772.64 796.64,-10781.22 800.63,-10775.46"/>
</g>
<!-- ln2_4_l4 -->
<g id="node305" class="node">
<title>ln2_4_l4</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-10772.39 906.5,-10772.39 906.5,-10720.39 1167.5,-10720.39 1167.5,-10772.39"/>
<text text-anchor="middle" x="1037" y="-10760.39" font-family="Arial" font-size="10.00">LayerNorm2 (L4)</text>
<text text-anchor="middle" x="1037" y="-10749.39" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-10738.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-10727.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l4&#45;&gt;ln2_4_l4 -->
<g id="edge365" class="edge">
<title>tp_comm_mlp_gpu23_l4&#45;&gt;ln2_4_l4</title>
<path fill="none" stroke="black" d="M945.06,-10810.69C960.28,-10800.21 976.91,-10788.76 991.79,-10778.52"/>
<polygon fill="black" stroke="black" points="994.07,-10781.2 1000.32,-10772.64 990.1,-10775.43 994.07,-10781.2"/>
</g>
<!-- ln1_3_l4&#45;&gt;mlp_fc1_3_l4 -->
<g id="edge358" class="edge">
<title>ln1_3_l4&#45;&gt;mlp_fc1_3_l4</title>
<path fill="none" stroke="black" d="M755,-11097.77C755,-11089.47 755,-11080.08 755,-11071.18"/>
<polygon fill="black" stroke="black" points="758.5,-11071.04 755,-11061.04 751.5,-11071.04 758.5,-11071.04"/>
</g>
<!-- ln1_4_l4&#45;&gt;mlp_fc1_4_l4 -->
<g id="edge359" class="edge">
<title>ln1_4_l4&#45;&gt;mlp_fc1_4_l4</title>
<path fill="none" stroke="black" d="M1034,-11097.77C1034,-11089.47 1034,-11080.08 1034,-11071.18"/>
<polygon fill="black" stroke="black" points="1037.5,-11071.04 1034,-11061.04 1030.5,-11071.04 1037.5,-11071.04"/>
</g>
<!-- attn_qkv_3_l5 -->
<g id="node306" class="node">
<title>attn_qkv_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="886,-10683.39 616,-10683.39 616,-10631.39 886,-10631.39 886,-10683.39"/>
<text text-anchor="middle" x="751" y="-10671.39" font-family="Arial" font-size="10.00">Attention QKV (L5)</text>
<text text-anchor="middle" x="751" y="-10660.39" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-10649.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-10638.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l4&#45;&gt;attn_qkv_3_l5 -->
<g id="edge366" class="edge">
<title>ln2_3_l4&#45;&gt;attn_qkv_3_l5</title>
<path fill="none" stroke="black" d="M753.13,-10720.23C752.85,-10711.93 752.52,-10702.55 752.22,-10693.64"/>
<polygon fill="black" stroke="black" points="755.71,-10693.37 751.87,-10683.5 748.71,-10693.61 755.71,-10693.37"/>
</g>
<!-- attn_qkv_4_l5 -->
<g id="node307" class="node">
<title>attn_qkv_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1174,-10683.39 904,-10683.39 904,-10631.39 1174,-10631.39 1174,-10683.39"/>
<text text-anchor="middle" x="1039" y="-10671.39" font-family="Arial" font-size="10.00">Attention QKV (L5)</text>
<text text-anchor="middle" x="1039" y="-10660.39" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-10649.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-10638.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l4&#45;&gt;attn_qkv_4_l5 -->
<g id="edge367" class="edge">
<title>ln2_4_l4&#45;&gt;attn_qkv_4_l5</title>
<path fill="none" stroke="black" d="M1037.58,-10720.23C1037.77,-10711.93 1037.98,-10702.55 1038.19,-10693.64"/>
<polygon fill="black" stroke="black" points="1041.69,-10693.58 1038.42,-10683.5 1034.69,-10693.41 1041.69,-10693.58"/>
</g>
<!-- tp_comm_attn_gpu23_l5 -->
<g id="node308" class="node">
<title>tp_comm_attn_gpu23_l5</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-10557.62" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-10571.62" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L5)</text>
<text text-anchor="middle" x="895" y="-10560.62" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-10549.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-10538.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l5&#45;&gt;tp_comm_attn_gpu23_l5 -->
<g id="edge368" class="edge">
<title>attn_qkv_3_l5&#45;&gt;tp_comm_attn_gpu23_l5</title>
<path fill="none" stroke="black" d="M788.08,-10631.21C802.63,-10621.34 819.69,-10609.75 835.85,-10598.78"/>
<polygon fill="black" stroke="black" points="837.9,-10601.62 844.2,-10593.11 833.96,-10595.83 837.9,-10601.62"/>
</g>
<!-- attn_qkv_4_l5&#45;&gt;tp_comm_attn_gpu23_l5 -->
<g id="edge369" class="edge">
<title>attn_qkv_4_l5&#45;&gt;tp_comm_attn_gpu23_l5</title>
<path fill="none" stroke="black" d="M1001.92,-10631.21C987.37,-10621.34 970.31,-10609.75 954.15,-10598.78"/>
<polygon fill="black" stroke="black" points="956.04,-10595.83 945.8,-10593.11 952.1,-10601.62 956.04,-10595.83"/>
</g>
<!-- attn_out_3_l5 -->
<g id="node309" class="node">
<title>attn_out_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-10483.85 623.5,-10483.85 623.5,-10431.85 886.5,-10431.85 886.5,-10483.85"/>
<text text-anchor="middle" x="755" y="-10471.85" font-family="Arial" font-size="10.00">Attention Output (L5)</text>
<text text-anchor="middle" x="755" y="-10460.85" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-10449.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-10438.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l5&#45;&gt;attn_out_3_l5 -->
<g id="edge370" class="edge">
<title>tp_comm_attn_gpu23_l5&#45;&gt;attn_out_3_l5</title>
<path fill="none" stroke="black" d="M845.25,-10521.88C830.27,-10511.41 813.93,-10500.01 799.33,-10489.81"/>
<polygon fill="black" stroke="black" points="801.16,-10486.82 790.96,-10483.96 797.15,-10492.56 801.16,-10486.82"/>
</g>
<!-- attn_out_4_l5 -->
<g id="node310" class="node">
<title>attn_out_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-10483.85 904.5,-10483.85 904.5,-10431.85 1167.5,-10431.85 1167.5,-10483.85"/>
<text text-anchor="middle" x="1036" y="-10471.85" font-family="Arial" font-size="10.00">Attention Output (L5)</text>
<text text-anchor="middle" x="1036" y="-10460.85" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-10449.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-10438.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l5&#45;&gt;attn_out_4_l5 -->
<g id="edge371" class="edge">
<title>tp_comm_attn_gpu23_l5&#45;&gt;attn_out_4_l5</title>
<path fill="none" stroke="black" d="M945.11,-10521.88C960.19,-10511.41 976.64,-10500.01 991.35,-10489.81"/>
<polygon fill="black" stroke="black" points="993.56,-10492.54 999.79,-10483.96 989.57,-10486.78 993.56,-10492.54"/>
</g>
<!-- tp_comm_attn_out_gpu23_l5 -->
<g id="node311" class="node">
<title>tp_comm_attn_out_gpu23_l5</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-10358.08" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-10372.08" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L5)</text>
<text text-anchor="middle" x="895" y="-10361.08" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-10350.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-10339.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l5&#45;&gt;tp_comm_attn_out_gpu23_l5 -->
<g id="edge372" class="edge">
<title>attn_out_3_l5&#45;&gt;tp_comm_attn_out_gpu23_l5</title>
<path fill="none" stroke="black" d="M791.05,-10431.67C805.07,-10421.89 821.48,-10410.43 837.06,-10399.54"/>
<polygon fill="black" stroke="black" points="839.42,-10402.17 845.62,-10393.57 835.41,-10396.43 839.42,-10402.17"/>
</g>
<!-- attn_out_4_l5&#45;&gt;tp_comm_attn_out_gpu23_l5 -->
<g id="edge373" class="edge">
<title>attn_out_4_l5&#45;&gt;tp_comm_attn_out_gpu23_l5</title>
<path fill="none" stroke="black" d="M999.69,-10431.67C985.58,-10421.89 969.05,-10410.43 953.35,-10399.54"/>
<polygon fill="black" stroke="black" points="954.95,-10396.39 944.74,-10393.57 950.96,-10402.14 954.95,-10396.39"/>
</g>
<!-- ln1_3_l5 -->
<g id="node317" class="node">
<title>ln1_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="900.5,-10284.31 639.5,-10284.31 639.5,-10232.31 900.5,-10232.31 900.5,-10284.31"/>
<text text-anchor="middle" x="770" y="-10272.31" font-family="Arial" font-size="10.00">LayerNorm1 (L5)</text>
<text text-anchor="middle" x="770" y="-10261.31" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-10250.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="770" y="-10239.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l5&#45;&gt;ln1_3_l5 -->
<g id="edge374" class="edge">
<title>tp_comm_attn_out_gpu23_l5&#45;&gt;ln1_3_l5</title>
<path fill="none" stroke="black" d="M850.58,-10322.34C837.45,-10312.07 823.16,-10300.9 810.31,-10290.84"/>
<polygon fill="black" stroke="black" points="812.14,-10287.83 802.1,-10284.42 807.82,-10293.34 812.14,-10287.83"/>
</g>
<!-- ln1_4_l5 -->
<g id="node318" class="node">
<title>ln1_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1179.5,-10284.31 918.5,-10284.31 918.5,-10232.31 1179.5,-10232.31 1179.5,-10284.31"/>
<text text-anchor="middle" x="1049" y="-10272.31" font-family="Arial" font-size="10.00">LayerNorm1 (L5)</text>
<text text-anchor="middle" x="1049" y="-10261.31" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-10250.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1049" y="-10239.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l5&#45;&gt;ln1_4_l5 -->
<g id="edge375" class="edge">
<title>tp_comm_attn_out_gpu23_l5&#45;&gt;ln1_4_l5</title>
<path fill="none" stroke="black" d="M948.86,-10322.89C965.85,-10312.1 984.49,-10300.26 1001.04,-10289.76"/>
<polygon fill="black" stroke="black" points="1002.92,-10292.71 1009.48,-10284.4 999.17,-10286.8 1002.92,-10292.71"/>
</g>
<!-- mlp_fc1_3_l5 -->
<g id="node312" class="node">
<title>mlp_fc1_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="897,-10195.31 643,-10195.31 643,-10143.31 897,-10143.31 897,-10195.31"/>
<text text-anchor="middle" x="770" y="-10183.31" font-family="Arial" font-size="10.00">MLP FC1 (L5)</text>
<text text-anchor="middle" x="770" y="-10172.31" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-10161.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="770" y="-10150.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l5 -->
<g id="node314" class="node">
<title>mlp_fc2_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="900.5,-10106.31 639.5,-10106.31 639.5,-10054.31 900.5,-10054.31 900.5,-10106.31"/>
<text text-anchor="middle" x="770" y="-10094.31" font-family="Arial" font-size="10.00">MLP FC2 (L5)</text>
<text text-anchor="middle" x="770" y="-10083.31" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-10072.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="770" y="-10061.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l5&#45;&gt;mlp_fc2_3_l5 -->
<g id="edge378" class="edge">
<title>mlp_fc1_3_l5&#45;&gt;mlp_fc2_3_l5</title>
<path fill="none" stroke="black" d="M770,-10143.15C770,-10134.85 770,-10125.47 770,-10116.56"/>
<polygon fill="black" stroke="black" points="773.5,-10116.42 770,-10106.42 766.5,-10116.42 773.5,-10116.42"/>
</g>
<!-- mlp_fc1_4_l5 -->
<g id="node313" class="node">
<title>mlp_fc1_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1176,-10195.31 922,-10195.31 922,-10143.31 1176,-10143.31 1176,-10195.31"/>
<text text-anchor="middle" x="1049" y="-10183.31" font-family="Arial" font-size="10.00">MLP FC1 (L5)</text>
<text text-anchor="middle" x="1049" y="-10172.31" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-10161.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1049" y="-10150.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l5 -->
<g id="node315" class="node">
<title>mlp_fc2_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1179.5,-10106.31 918.5,-10106.31 918.5,-10054.31 1179.5,-10054.31 1179.5,-10106.31"/>
<text text-anchor="middle" x="1049" y="-10094.31" font-family="Arial" font-size="10.00">MLP FC2 (L5)</text>
<text text-anchor="middle" x="1049" y="-10083.31" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-10072.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1049" y="-10061.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l5&#45;&gt;mlp_fc2_4_l5 -->
<g id="edge379" class="edge">
<title>mlp_fc1_4_l5&#45;&gt;mlp_fc2_4_l5</title>
<path fill="none" stroke="black" d="M1049,-10143.15C1049,-10134.85 1049,-10125.47 1049,-10116.56"/>
<polygon fill="black" stroke="black" points="1052.5,-10116.42 1049,-10106.42 1045.5,-10116.42 1052.5,-10116.42"/>
</g>
<!-- tp_comm_mlp_gpu23_l5 -->
<g id="node316" class="node">
<title>tp_comm_mlp_gpu23_l5</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-9980.54" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-9994.54" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L5)</text>
<text text-anchor="middle" x="895" y="-9983.54" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-9972.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-9961.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l5&#45;&gt;tp_comm_mlp_gpu23_l5 -->
<g id="edge380" class="edge">
<title>mlp_fc2_3_l5&#45;&gt;tp_comm_mlp_gpu23_l5</title>
<path fill="none" stroke="black" d="M802.19,-10054.13C814.41,-10044.58 828.66,-10033.43 842.28,-10022.78"/>
<polygon fill="black" stroke="black" points="844.48,-10025.5 850.2,-10016.58 840.17,-10019.99 844.48,-10025.5"/>
</g>
<!-- mlp_fc2_4_l5&#45;&gt;tp_comm_mlp_gpu23_l5 -->
<g id="edge381" class="edge">
<title>mlp_fc2_4_l5&#45;&gt;tp_comm_mlp_gpu23_l5</title>
<path fill="none" stroke="black" d="M1009.34,-10054.13C993.56,-10044.12 975.03,-10032.35 957.53,-10021.24"/>
<polygon fill="black" stroke="black" points="959.35,-10018.25 949.03,-10015.85 955.6,-10024.16 959.35,-10018.25"/>
</g>
<!-- ln2_3_l5 -->
<g id="node319" class="node">
<title>ln2_3_l5</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-9906.77 623.5,-9906.77 623.5,-9854.77 884.5,-9854.77 884.5,-9906.77"/>
<text text-anchor="middle" x="754" y="-9894.77" font-family="Arial" font-size="10.00">LayerNorm2 (L5)</text>
<text text-anchor="middle" x="754" y="-9883.77" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-9872.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-9861.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l5&#45;&gt;ln2_3_l5 -->
<g id="edge382" class="edge">
<title>tp_comm_mlp_gpu23_l5&#45;&gt;ln2_3_l5</title>
<path fill="none" stroke="black" d="M845.29,-9945.07C830.18,-9934.59 813.67,-9923.15 798.89,-9912.9"/>
<polygon fill="black" stroke="black" points="800.63,-9909.85 790.42,-9907.02 796.64,-9915.6 800.63,-9909.85"/>
</g>
<!-- ln2_4_l5 -->
<g id="node320" class="node">
<title>ln2_4_l5</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-9906.77 906.5,-9906.77 906.5,-9854.77 1167.5,-9854.77 1167.5,-9906.77"/>
<text text-anchor="middle" x="1037" y="-9894.77" font-family="Arial" font-size="10.00">LayerNorm2 (L5)</text>
<text text-anchor="middle" x="1037" y="-9883.77" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-9872.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-9861.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l5&#45;&gt;ln2_4_l5 -->
<g id="edge383" class="edge">
<title>tp_comm_mlp_gpu23_l5&#45;&gt;ln2_4_l5</title>
<path fill="none" stroke="black" d="M945.06,-9945.07C960.28,-9934.59 976.91,-9923.15 991.79,-9912.9"/>
<polygon fill="black" stroke="black" points="994.07,-9915.58 1000.32,-9907.02 990.1,-9909.81 994.07,-9915.58"/>
</g>
<!-- ln1_3_l5&#45;&gt;mlp_fc1_3_l5 -->
<g id="edge376" class="edge">
<title>ln1_3_l5&#45;&gt;mlp_fc1_3_l5</title>
<path fill="none" stroke="black" d="M770,-10232.15C770,-10223.85 770,-10214.47 770,-10205.56"/>
<polygon fill="black" stroke="black" points="773.5,-10205.42 770,-10195.42 766.5,-10205.42 773.5,-10205.42"/>
</g>
<!-- ln1_4_l5&#45;&gt;mlp_fc1_4_l5 -->
<g id="edge377" class="edge">
<title>ln1_4_l5&#45;&gt;mlp_fc1_4_l5</title>
<path fill="none" stroke="black" d="M1049,-10232.15C1049,-10223.85 1049,-10214.47 1049,-10205.56"/>
<polygon fill="black" stroke="black" points="1052.5,-10205.42 1049,-10195.42 1045.5,-10205.42 1052.5,-10205.42"/>
</g>
<!-- attn_qkv_3_l6 -->
<g id="node321" class="node">
<title>attn_qkv_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="886,-9817.77 616,-9817.77 616,-9765.77 886,-9765.77 886,-9817.77"/>
<text text-anchor="middle" x="751" y="-9805.77" font-family="Arial" font-size="10.00">Attention QKV (L6)</text>
<text text-anchor="middle" x="751" y="-9794.77" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-9783.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-9772.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l5&#45;&gt;attn_qkv_3_l6 -->
<g id="edge384" class="edge">
<title>ln2_3_l5&#45;&gt;attn_qkv_3_l6</title>
<path fill="none" stroke="black" d="M753.13,-9854.61C752.85,-9846.31 752.52,-9836.93 752.22,-9828.02"/>
<polygon fill="black" stroke="black" points="755.71,-9827.75 751.87,-9817.88 748.71,-9828 755.71,-9827.75"/>
</g>
<!-- attn_qkv_4_l6 -->
<g id="node322" class="node">
<title>attn_qkv_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1174,-9817.77 904,-9817.77 904,-9765.77 1174,-9765.77 1174,-9817.77"/>
<text text-anchor="middle" x="1039" y="-9805.77" font-family="Arial" font-size="10.00">Attention QKV (L6)</text>
<text text-anchor="middle" x="1039" y="-9794.77" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-9783.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-9772.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l5&#45;&gt;attn_qkv_4_l6 -->
<g id="edge385" class="edge">
<title>ln2_4_l5&#45;&gt;attn_qkv_4_l6</title>
<path fill="none" stroke="black" d="M1037.58,-9854.61C1037.77,-9846.31 1037.98,-9836.93 1038.19,-9828.02"/>
<polygon fill="black" stroke="black" points="1041.69,-9827.96 1038.42,-9817.88 1034.69,-9827.8 1041.69,-9827.96"/>
</g>
<!-- tp_comm_attn_gpu23_l6 -->
<g id="node323" class="node">
<title>tp_comm_attn_gpu23_l6</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-9692" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-9706" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L6)</text>
<text text-anchor="middle" x="895" y="-9695" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-9684" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-9673" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l6&#45;&gt;tp_comm_attn_gpu23_l6 -->
<g id="edge386" class="edge">
<title>attn_qkv_3_l6&#45;&gt;tp_comm_attn_gpu23_l6</title>
<path fill="none" stroke="black" d="M788.08,-9765.6C802.63,-9755.72 819.69,-9744.14 835.85,-9733.16"/>
<polygon fill="black" stroke="black" points="837.9,-9736 844.2,-9727.49 833.96,-9730.21 837.9,-9736"/>
</g>
<!-- attn_qkv_4_l6&#45;&gt;tp_comm_attn_gpu23_l6 -->
<g id="edge387" class="edge">
<title>attn_qkv_4_l6&#45;&gt;tp_comm_attn_gpu23_l6</title>
<path fill="none" stroke="black" d="M1001.92,-9765.6C987.37,-9755.72 970.31,-9744.14 954.15,-9733.16"/>
<polygon fill="black" stroke="black" points="956.04,-9730.21 945.8,-9727.49 952.1,-9736 956.04,-9730.21"/>
</g>
<!-- attn_out_3_l6 -->
<g id="node324" class="node">
<title>attn_out_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-9618.23 623.5,-9618.23 623.5,-9566.23 886.5,-9566.23 886.5,-9618.23"/>
<text text-anchor="middle" x="755" y="-9606.23" font-family="Arial" font-size="10.00">Attention Output (L6)</text>
<text text-anchor="middle" x="755" y="-9595.23" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-9584.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-9573.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l6&#45;&gt;attn_out_3_l6 -->
<g id="edge388" class="edge">
<title>tp_comm_attn_gpu23_l6&#45;&gt;attn_out_3_l6</title>
<path fill="none" stroke="black" d="M845.25,-9656.26C830.27,-9645.8 813.93,-9634.39 799.33,-9624.19"/>
<polygon fill="black" stroke="black" points="801.16,-9621.2 790.96,-9618.34 797.15,-9626.94 801.16,-9621.2"/>
</g>
<!-- attn_out_4_l6 -->
<g id="node325" class="node">
<title>attn_out_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-9618.23 904.5,-9618.23 904.5,-9566.23 1167.5,-9566.23 1167.5,-9618.23"/>
<text text-anchor="middle" x="1036" y="-9606.23" font-family="Arial" font-size="10.00">Attention Output (L6)</text>
<text text-anchor="middle" x="1036" y="-9595.23" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-9584.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-9573.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l6&#45;&gt;attn_out_4_l6 -->
<g id="edge389" class="edge">
<title>tp_comm_attn_gpu23_l6&#45;&gt;attn_out_4_l6</title>
<path fill="none" stroke="black" d="M945.11,-9656.26C960.19,-9645.8 976.64,-9634.39 991.35,-9624.19"/>
<polygon fill="black" stroke="black" points="993.56,-9626.92 999.79,-9618.34 989.57,-9621.17 993.56,-9626.92"/>
</g>
<!-- tp_comm_attn_out_gpu23_l6 -->
<g id="node326" class="node">
<title>tp_comm_attn_out_gpu23_l6</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-9492.46" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-9506.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L6)</text>
<text text-anchor="middle" x="895" y="-9495.46" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-9484.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-9473.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l6&#45;&gt;tp_comm_attn_out_gpu23_l6 -->
<g id="edge390" class="edge">
<title>attn_out_3_l6&#45;&gt;tp_comm_attn_out_gpu23_l6</title>
<path fill="none" stroke="black" d="M791.05,-9566.06C805.07,-9556.27 821.48,-9544.81 837.06,-9533.93"/>
<polygon fill="black" stroke="black" points="839.42,-9536.55 845.62,-9527.95 835.41,-9530.81 839.42,-9536.55"/>
</g>
<!-- attn_out_4_l6&#45;&gt;tp_comm_attn_out_gpu23_l6 -->
<g id="edge391" class="edge">
<title>attn_out_4_l6&#45;&gt;tp_comm_attn_out_gpu23_l6</title>
<path fill="none" stroke="black" d="M999.69,-9566.06C985.58,-9556.27 969.05,-9544.81 953.35,-9533.93"/>
<polygon fill="black" stroke="black" points="954.95,-9530.77 944.74,-9527.95 950.96,-9536.53 954.95,-9530.77"/>
</g>
<!-- ln1_3_l6 -->
<g id="node332" class="node">
<title>ln1_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="900.5,-9418.7 639.5,-9418.7 639.5,-9366.7 900.5,-9366.7 900.5,-9418.7"/>
<text text-anchor="middle" x="770" y="-9406.7" font-family="Arial" font-size="10.00">LayerNorm1 (L6)</text>
<text text-anchor="middle" x="770" y="-9395.7" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-9384.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="770" y="-9373.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l6&#45;&gt;ln1_3_l6 -->
<g id="edge392" class="edge">
<title>tp_comm_attn_out_gpu23_l6&#45;&gt;ln1_3_l6</title>
<path fill="none" stroke="black" d="M850.58,-9456.72C837.45,-9446.45 823.16,-9435.28 810.31,-9425.23"/>
<polygon fill="black" stroke="black" points="812.14,-9422.21 802.1,-9418.81 807.82,-9427.72 812.14,-9422.21"/>
</g>
<!-- ln1_4_l6 -->
<g id="node333" class="node">
<title>ln1_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1179.5,-9418.7 918.5,-9418.7 918.5,-9366.7 1179.5,-9366.7 1179.5,-9418.7"/>
<text text-anchor="middle" x="1049" y="-9406.7" font-family="Arial" font-size="10.00">LayerNorm1 (L6)</text>
<text text-anchor="middle" x="1049" y="-9395.7" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-9384.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1049" y="-9373.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l6&#45;&gt;ln1_4_l6 -->
<g id="edge393" class="edge">
<title>tp_comm_attn_out_gpu23_l6&#45;&gt;ln1_4_l6</title>
<path fill="none" stroke="black" d="M948.86,-9457.27C965.85,-9446.48 984.49,-9434.65 1001.04,-9424.14"/>
<polygon fill="black" stroke="black" points="1002.92,-9427.1 1009.48,-9418.78 999.17,-9421.19 1002.92,-9427.1"/>
</g>
<!-- mlp_fc1_3_l6 -->
<g id="node327" class="node">
<title>mlp_fc1_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="897,-9329.7 643,-9329.7 643,-9277.7 897,-9277.7 897,-9329.7"/>
<text text-anchor="middle" x="770" y="-9317.7" font-family="Arial" font-size="10.00">MLP FC1 (L6)</text>
<text text-anchor="middle" x="770" y="-9306.7" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-9295.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="770" y="-9284.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l6 -->
<g id="node329" class="node">
<title>mlp_fc2_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="900.5,-9240.7 639.5,-9240.7 639.5,-9188.7 900.5,-9188.7 900.5,-9240.7"/>
<text text-anchor="middle" x="770" y="-9228.7" font-family="Arial" font-size="10.00">MLP FC2 (L6)</text>
<text text-anchor="middle" x="770" y="-9217.7" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="770" y="-9206.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="770" y="-9195.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l6&#45;&gt;mlp_fc2_3_l6 -->
<g id="edge396" class="edge">
<title>mlp_fc1_3_l6&#45;&gt;mlp_fc2_3_l6</title>
<path fill="none" stroke="black" d="M770,-9277.53C770,-9269.23 770,-9259.85 770,-9250.94"/>
<polygon fill="black" stroke="black" points="773.5,-9250.8 770,-9240.8 766.5,-9250.8 773.5,-9250.8"/>
</g>
<!-- mlp_fc1_4_l6 -->
<g id="node328" class="node">
<title>mlp_fc1_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1176,-9329.7 922,-9329.7 922,-9277.7 1176,-9277.7 1176,-9329.7"/>
<text text-anchor="middle" x="1049" y="-9317.7" font-family="Arial" font-size="10.00">MLP FC1 (L6)</text>
<text text-anchor="middle" x="1049" y="-9306.7" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-9295.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1049" y="-9284.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l6 -->
<g id="node330" class="node">
<title>mlp_fc2_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1179.5,-9240.7 918.5,-9240.7 918.5,-9188.7 1179.5,-9188.7 1179.5,-9240.7"/>
<text text-anchor="middle" x="1049" y="-9228.7" font-family="Arial" font-size="10.00">MLP FC2 (L6)</text>
<text text-anchor="middle" x="1049" y="-9217.7" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1049" y="-9206.7" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1049" y="-9195.7" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l6&#45;&gt;mlp_fc2_4_l6 -->
<g id="edge397" class="edge">
<title>mlp_fc1_4_l6&#45;&gt;mlp_fc2_4_l6</title>
<path fill="none" stroke="black" d="M1049,-9277.53C1049,-9269.23 1049,-9259.85 1049,-9250.94"/>
<polygon fill="black" stroke="black" points="1052.5,-9250.8 1049,-9240.8 1045.5,-9250.8 1052.5,-9250.8"/>
</g>
<!-- tp_comm_mlp_gpu23_l6 -->
<g id="node331" class="node">
<title>tp_comm_mlp_gpu23_l6</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-9114.93" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-9128.93" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L6)</text>
<text text-anchor="middle" x="895" y="-9117.93" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-9106.93" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-9095.93" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l6&#45;&gt;tp_comm_mlp_gpu23_l6 -->
<g id="edge398" class="edge">
<title>mlp_fc2_3_l6&#45;&gt;tp_comm_mlp_gpu23_l6</title>
<path fill="none" stroke="black" d="M802.19,-9188.52C814.41,-9178.96 828.66,-9167.82 842.28,-9157.16"/>
<polygon fill="black" stroke="black" points="844.48,-9159.88 850.2,-9150.97 840.17,-9154.37 844.48,-9159.88"/>
</g>
<!-- mlp_fc2_4_l6&#45;&gt;tp_comm_mlp_gpu23_l6 -->
<g id="edge399" class="edge">
<title>mlp_fc2_4_l6&#45;&gt;tp_comm_mlp_gpu23_l6</title>
<path fill="none" stroke="black" d="M1009.34,-9188.52C993.56,-9178.5 975.03,-9166.73 957.53,-9155.62"/>
<polygon fill="black" stroke="black" points="959.35,-9152.63 949.03,-9150.23 955.6,-9158.54 959.35,-9152.63"/>
</g>
<!-- ln2_3_l6 -->
<g id="node334" class="node">
<title>ln2_3_l6</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-9041.16 623.5,-9041.16 623.5,-8989.16 884.5,-8989.16 884.5,-9041.16"/>
<text text-anchor="middle" x="754" y="-9029.16" font-family="Arial" font-size="10.00">LayerNorm2 (L6)</text>
<text text-anchor="middle" x="754" y="-9018.16" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-9007.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-8996.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l6&#45;&gt;ln2_3_l6 -->
<g id="edge400" class="edge">
<title>tp_comm_mlp_gpu23_l6&#45;&gt;ln2_3_l6</title>
<path fill="none" stroke="black" d="M845.29,-9079.46C830.18,-9068.98 813.67,-9057.53 798.89,-9047.28"/>
<polygon fill="black" stroke="black" points="800.63,-9044.23 790.42,-9041.41 796.64,-9049.98 800.63,-9044.23"/>
</g>
<!-- ln2_4_l6 -->
<g id="node335" class="node">
<title>ln2_4_l6</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-9041.16 906.5,-9041.16 906.5,-8989.16 1167.5,-8989.16 1167.5,-9041.16"/>
<text text-anchor="middle" x="1037" y="-9029.16" font-family="Arial" font-size="10.00">LayerNorm2 (L6)</text>
<text text-anchor="middle" x="1037" y="-9018.16" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-9007.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-8996.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l6&#45;&gt;ln2_4_l6 -->
<g id="edge401" class="edge">
<title>tp_comm_mlp_gpu23_l6&#45;&gt;ln2_4_l6</title>
<path fill="none" stroke="black" d="M945.06,-9079.46C960.28,-9068.98 976.91,-9057.53 991.79,-9047.28"/>
<polygon fill="black" stroke="black" points="994.07,-9049.96 1000.32,-9041.41 990.1,-9044.2 994.07,-9049.96"/>
</g>
<!-- ln1_3_l6&#45;&gt;mlp_fc1_3_l6 -->
<g id="edge394" class="edge">
<title>ln1_3_l6&#45;&gt;mlp_fc1_3_l6</title>
<path fill="none" stroke="black" d="M770,-9366.53C770,-9358.23 770,-9348.85 770,-9339.94"/>
<polygon fill="black" stroke="black" points="773.5,-9339.8 770,-9329.8 766.5,-9339.8 773.5,-9339.8"/>
</g>
<!-- ln1_4_l6&#45;&gt;mlp_fc1_4_l6 -->
<g id="edge395" class="edge">
<title>ln1_4_l6&#45;&gt;mlp_fc1_4_l6</title>
<path fill="none" stroke="black" d="M1049,-9366.53C1049,-9358.23 1049,-9348.85 1049,-9339.94"/>
<polygon fill="black" stroke="black" points="1052.5,-9339.8 1049,-9329.8 1045.5,-9339.8 1052.5,-9339.8"/>
</g>
<!-- attn_qkv_3_l7 -->
<g id="node336" class="node">
<title>attn_qkv_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="886,-8952.16 616,-8952.16 616,-8900.16 886,-8900.16 886,-8952.16"/>
<text text-anchor="middle" x="751" y="-8940.16" font-family="Arial" font-size="10.00">Attention QKV (L7)</text>
<text text-anchor="middle" x="751" y="-8929.16" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-8918.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-8907.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l6&#45;&gt;attn_qkv_3_l7 -->
<g id="edge402" class="edge">
<title>ln2_3_l6&#45;&gt;attn_qkv_3_l7</title>
<path fill="none" stroke="black" d="M753.13,-8988.99C752.85,-8980.7 752.52,-8971.31 752.22,-8962.4"/>
<polygon fill="black" stroke="black" points="755.71,-8962.14 751.87,-8952.26 748.71,-8962.38 755.71,-8962.14"/>
</g>
<!-- attn_qkv_4_l7 -->
<g id="node337" class="node">
<title>attn_qkv_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1174,-8952.16 904,-8952.16 904,-8900.16 1174,-8900.16 1174,-8952.16"/>
<text text-anchor="middle" x="1039" y="-8940.16" font-family="Arial" font-size="10.00">Attention QKV (L7)</text>
<text text-anchor="middle" x="1039" y="-8929.16" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-8918.16" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-8907.16" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l6&#45;&gt;attn_qkv_4_l7 -->
<g id="edge403" class="edge">
<title>ln2_4_l6&#45;&gt;attn_qkv_4_l7</title>
<path fill="none" stroke="black" d="M1037.58,-8988.99C1037.77,-8980.7 1037.98,-8971.31 1038.19,-8962.4"/>
<polygon fill="black" stroke="black" points="1041.69,-8962.34 1038.42,-8952.26 1034.69,-8962.18 1041.69,-8962.34"/>
</g>
<!-- tp_comm_attn_gpu23_l7 -->
<g id="node338" class="node">
<title>tp_comm_attn_gpu23_l7</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-8826.39" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-8840.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L7)</text>
<text text-anchor="middle" x="895" y="-8829.39" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-8818.39" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-8807.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l7&#45;&gt;tp_comm_attn_gpu23_l7 -->
<g id="edge404" class="edge">
<title>attn_qkv_3_l7&#45;&gt;tp_comm_attn_gpu23_l7</title>
<path fill="none" stroke="black" d="M788.08,-8899.98C802.63,-8890.1 819.69,-8878.52 835.85,-8867.55"/>
<polygon fill="black" stroke="black" points="837.9,-8870.39 844.2,-8861.87 833.96,-8864.6 837.9,-8870.39"/>
</g>
<!-- attn_qkv_4_l7&#45;&gt;tp_comm_attn_gpu23_l7 -->
<g id="edge405" class="edge">
<title>attn_qkv_4_l7&#45;&gt;tp_comm_attn_gpu23_l7</title>
<path fill="none" stroke="black" d="M1001.92,-8899.98C987.37,-8890.1 970.31,-8878.52 954.15,-8867.55"/>
<polygon fill="black" stroke="black" points="956.04,-8864.6 945.8,-8861.87 952.1,-8870.39 956.04,-8864.6"/>
</g>
<!-- attn_out_3_l7 -->
<g id="node339" class="node">
<title>attn_out_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-8752.62 623.5,-8752.62 623.5,-8700.62 886.5,-8700.62 886.5,-8752.62"/>
<text text-anchor="middle" x="755" y="-8740.62" font-family="Arial" font-size="10.00">Attention Output (L7)</text>
<text text-anchor="middle" x="755" y="-8729.62" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-8718.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-8707.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l7&#45;&gt;attn_out_3_l7 -->
<g id="edge406" class="edge">
<title>tp_comm_attn_gpu23_l7&#45;&gt;attn_out_3_l7</title>
<path fill="none" stroke="black" d="M845.25,-8790.64C830.27,-8780.18 813.93,-8768.77 799.33,-8758.58"/>
<polygon fill="black" stroke="black" points="801.16,-8755.58 790.96,-8752.73 797.15,-8761.32 801.16,-8755.58"/>
</g>
<!-- attn_out_4_l7 -->
<g id="node340" class="node">
<title>attn_out_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-8752.62 904.5,-8752.62 904.5,-8700.62 1167.5,-8700.62 1167.5,-8752.62"/>
<text text-anchor="middle" x="1036" y="-8740.62" font-family="Arial" font-size="10.00">Attention Output (L7)</text>
<text text-anchor="middle" x="1036" y="-8729.62" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-8718.62" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-8707.62" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l7&#45;&gt;attn_out_4_l7 -->
<g id="edge407" class="edge">
<title>tp_comm_attn_gpu23_l7&#45;&gt;attn_out_4_l7</title>
<path fill="none" stroke="black" d="M945.11,-8790.64C960.19,-8780.18 976.64,-8768.77 991.35,-8758.58"/>
<polygon fill="black" stroke="black" points="993.56,-8761.3 999.79,-8752.73 989.57,-8755.55 993.56,-8761.3"/>
</g>
<!-- tp_comm_attn_out_gpu23_l7 -->
<g id="node341" class="node">
<title>tp_comm_attn_out_gpu23_l7</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-8626.85" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-8640.85" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L7)</text>
<text text-anchor="middle" x="895" y="-8629.85" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-8618.85" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-8607.85" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l7&#45;&gt;tp_comm_attn_out_gpu23_l7 -->
<g id="edge408" class="edge">
<title>attn_out_3_l7&#45;&gt;tp_comm_attn_out_gpu23_l7</title>
<path fill="none" stroke="black" d="M791.05,-8700.44C805.07,-8690.65 821.48,-8679.19 837.06,-8668.31"/>
<polygon fill="black" stroke="black" points="839.42,-8670.93 845.62,-8662.34 835.41,-8665.19 839.42,-8670.93"/>
</g>
<!-- attn_out_4_l7&#45;&gt;tp_comm_attn_out_gpu23_l7 -->
<g id="edge409" class="edge">
<title>attn_out_4_l7&#45;&gt;tp_comm_attn_out_gpu23_l7</title>
<path fill="none" stroke="black" d="M999.69,-8700.44C985.58,-8690.65 969.05,-8679.19 953.35,-8668.31"/>
<polygon fill="black" stroke="black" points="954.95,-8665.16 944.74,-8662.34 950.96,-8670.91 954.95,-8665.16"/>
</g>
<!-- ln1_3_l7 -->
<g id="node347" class="node">
<title>ln1_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-8553.08 624.5,-8553.08 624.5,-8501.08 885.5,-8501.08 885.5,-8553.08"/>
<text text-anchor="middle" x="755" y="-8541.08" font-family="Arial" font-size="10.00">LayerNorm1 (L7)</text>
<text text-anchor="middle" x="755" y="-8530.08" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-8519.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-8508.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l7&#45;&gt;ln1_3_l7 -->
<g id="edge410" class="edge">
<title>tp_comm_attn_out_gpu23_l7&#45;&gt;ln1_3_l7</title>
<path fill="none" stroke="black" d="M845.64,-8591.38C830.64,-8580.9 814.24,-8569.45 799.57,-8559.21"/>
<polygon fill="black" stroke="black" points="801.36,-8556.19 791.16,-8553.33 797.35,-8561.92 801.36,-8556.19"/>
</g>
<!-- ln1_4_l7 -->
<g id="node348" class="node">
<title>ln1_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-8553.08 903.5,-8553.08 903.5,-8501.08 1164.5,-8501.08 1164.5,-8553.08"/>
<text text-anchor="middle" x="1034" y="-8541.08" font-family="Arial" font-size="10.00">LayerNorm1 (L7)</text>
<text text-anchor="middle" x="1034" y="-8530.08" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-8519.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-8508.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l7&#45;&gt;ln1_4_l7 -->
<g id="edge411" class="edge">
<title>tp_comm_attn_out_gpu23_l7&#45;&gt;ln1_4_l7</title>
<path fill="none" stroke="black" d="M944.01,-8591.38C958.9,-8580.9 975.18,-8569.45 989.75,-8559.21"/>
<polygon fill="black" stroke="black" points="991.93,-8561.95 998.1,-8553.33 987.91,-8556.22 991.93,-8561.95"/>
</g>
<!-- mlp_fc1_3_l7 -->
<g id="node342" class="node">
<title>mlp_fc1_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="882,-8464.08 628,-8464.08 628,-8412.08 882,-8412.08 882,-8464.08"/>
<text text-anchor="middle" x="755" y="-8452.08" font-family="Arial" font-size="10.00">MLP FC1 (L7)</text>
<text text-anchor="middle" x="755" y="-8441.08" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-8430.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-8419.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l7 -->
<g id="node344" class="node">
<title>mlp_fc2_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-8375.08 624.5,-8375.08 624.5,-8323.08 885.5,-8323.08 885.5,-8375.08"/>
<text text-anchor="middle" x="755" y="-8363.08" font-family="Arial" font-size="10.00">MLP FC2 (L7)</text>
<text text-anchor="middle" x="755" y="-8352.08" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-8341.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-8330.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l7&#45;&gt;mlp_fc2_3_l7 -->
<g id="edge414" class="edge">
<title>mlp_fc1_3_l7&#45;&gt;mlp_fc2_3_l7</title>
<path fill="none" stroke="black" d="M755,-8411.91C755,-8403.62 755,-8394.23 755,-8385.33"/>
<polygon fill="black" stroke="black" points="758.5,-8385.19 755,-8375.19 751.5,-8385.19 758.5,-8385.19"/>
</g>
<!-- mlp_fc1_4_l7 -->
<g id="node343" class="node">
<title>mlp_fc1_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1161,-8464.08 907,-8464.08 907,-8412.08 1161,-8412.08 1161,-8464.08"/>
<text text-anchor="middle" x="1034" y="-8452.08" font-family="Arial" font-size="10.00">MLP FC1 (L7)</text>
<text text-anchor="middle" x="1034" y="-8441.08" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-8430.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-8419.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l7 -->
<g id="node345" class="node">
<title>mlp_fc2_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-8375.08 903.5,-8375.08 903.5,-8323.08 1164.5,-8323.08 1164.5,-8375.08"/>
<text text-anchor="middle" x="1034" y="-8363.08" font-family="Arial" font-size="10.00">MLP FC2 (L7)</text>
<text text-anchor="middle" x="1034" y="-8352.08" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-8341.08" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-8330.08" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l7&#45;&gt;mlp_fc2_4_l7 -->
<g id="edge415" class="edge">
<title>mlp_fc1_4_l7&#45;&gt;mlp_fc2_4_l7</title>
<path fill="none" stroke="black" d="M1034,-8411.91C1034,-8403.62 1034,-8394.23 1034,-8385.33"/>
<polygon fill="black" stroke="black" points="1037.5,-8385.19 1034,-8375.19 1030.5,-8385.19 1037.5,-8385.19"/>
</g>
<!-- tp_comm_mlp_gpu23_l7 -->
<g id="node346" class="node">
<title>tp_comm_mlp_gpu23_l7</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-8249.31" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-8263.31" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L7)</text>
<text text-anchor="middle" x="895" y="-8252.31" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-8241.31" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-8230.31" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l7&#45;&gt;tp_comm_mlp_gpu23_l7 -->
<g id="edge416" class="edge">
<title>mlp_fc2_3_l7&#45;&gt;tp_comm_mlp_gpu23_l7</title>
<path fill="none" stroke="black" d="M791.05,-8322.9C805.07,-8313.11 821.48,-8301.65 837.06,-8290.77"/>
<polygon fill="black" stroke="black" points="839.42,-8293.39 845.62,-8284.8 835.41,-8287.65 839.42,-8293.39"/>
</g>
<!-- mlp_fc2_4_l7&#45;&gt;tp_comm_mlp_gpu23_l7 -->
<g id="edge417" class="edge">
<title>mlp_fc2_4_l7&#45;&gt;tp_comm_mlp_gpu23_l7</title>
<path fill="none" stroke="black" d="M998.2,-8322.9C984.29,-8313.11 968,-8301.65 952.52,-8290.77"/>
<polygon fill="black" stroke="black" points="954.23,-8287.69 944.03,-8284.8 950.2,-8293.41 954.23,-8287.69"/>
</g>
<!-- ln2_3_l7 -->
<g id="node349" class="node">
<title>ln2_3_l7</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-8175.54 623.5,-8175.54 623.5,-8123.54 884.5,-8123.54 884.5,-8175.54"/>
<text text-anchor="middle" x="754" y="-8163.54" font-family="Arial" font-size="10.00">LayerNorm2 (L7)</text>
<text text-anchor="middle" x="754" y="-8152.54" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-8141.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-8130.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l7&#45;&gt;ln2_3_l7 -->
<g id="edge418" class="edge">
<title>tp_comm_mlp_gpu23_l7&#45;&gt;ln2_3_l7</title>
<path fill="none" stroke="black" d="M845.29,-8213.84C830.18,-8203.36 813.67,-8191.91 798.89,-8181.67"/>
<polygon fill="black" stroke="black" points="800.63,-8178.61 790.42,-8175.79 796.64,-8184.36 800.63,-8178.61"/>
</g>
<!-- ln2_4_l7 -->
<g id="node350" class="node">
<title>ln2_4_l7</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-8175.54 906.5,-8175.54 906.5,-8123.54 1167.5,-8123.54 1167.5,-8175.54"/>
<text text-anchor="middle" x="1037" y="-8163.54" font-family="Arial" font-size="10.00">LayerNorm2 (L7)</text>
<text text-anchor="middle" x="1037" y="-8152.54" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-8141.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-8130.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l7&#45;&gt;ln2_4_l7 -->
<g id="edge419" class="edge">
<title>tp_comm_mlp_gpu23_l7&#45;&gt;ln2_4_l7</title>
<path fill="none" stroke="black" d="M945.06,-8213.84C960.28,-8203.36 976.91,-8191.91 991.79,-8181.67"/>
<polygon fill="black" stroke="black" points="994.07,-8184.34 1000.32,-8175.79 990.1,-8178.58 994.07,-8184.34"/>
</g>
<!-- ln1_3_l7&#45;&gt;mlp_fc1_3_l7 -->
<g id="edge412" class="edge">
<title>ln1_3_l7&#45;&gt;mlp_fc1_3_l7</title>
<path fill="none" stroke="black" d="M755,-8500.91C755,-8492.62 755,-8483.23 755,-8474.33"/>
<polygon fill="black" stroke="black" points="758.5,-8474.19 755,-8464.19 751.5,-8474.19 758.5,-8474.19"/>
</g>
<!-- ln1_4_l7&#45;&gt;mlp_fc1_4_l7 -->
<g id="edge413" class="edge">
<title>ln1_4_l7&#45;&gt;mlp_fc1_4_l7</title>
<path fill="none" stroke="black" d="M1034,-8500.91C1034,-8492.62 1034,-8483.23 1034,-8474.33"/>
<polygon fill="black" stroke="black" points="1037.5,-8474.19 1034,-8464.19 1030.5,-8474.19 1037.5,-8474.19"/>
</g>
<!-- attn_qkv_3_l8 -->
<g id="node351" class="node">
<title>attn_qkv_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="886,-8086.54 616,-8086.54 616,-8034.54 886,-8034.54 886,-8086.54"/>
<text text-anchor="middle" x="751" y="-8074.54" font-family="Arial" font-size="10.00">Attention QKV (L8)</text>
<text text-anchor="middle" x="751" y="-8063.54" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-8052.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-8041.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l7&#45;&gt;attn_qkv_3_l8 -->
<g id="edge420" class="edge">
<title>ln2_3_l7&#45;&gt;attn_qkv_3_l8</title>
<path fill="none" stroke="black" d="M753.13,-8123.37C752.85,-8115.08 752.52,-8105.69 752.22,-8096.79"/>
<polygon fill="black" stroke="black" points="755.71,-8096.52 751.87,-8086.65 748.71,-8096.76 755.71,-8096.52"/>
</g>
<!-- attn_qkv_4_l8 -->
<g id="node352" class="node">
<title>attn_qkv_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1174,-8086.54 904,-8086.54 904,-8034.54 1174,-8034.54 1174,-8086.54"/>
<text text-anchor="middle" x="1039" y="-8074.54" font-family="Arial" font-size="10.00">Attention QKV (L8)</text>
<text text-anchor="middle" x="1039" y="-8063.54" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-8052.54" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-8041.54" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l7&#45;&gt;attn_qkv_4_l8 -->
<g id="edge421" class="edge">
<title>ln2_4_l7&#45;&gt;attn_qkv_4_l8</title>
<path fill="none" stroke="black" d="M1037.58,-8123.37C1037.77,-8115.08 1037.98,-8105.69 1038.19,-8096.79"/>
<polygon fill="black" stroke="black" points="1041.69,-8096.72 1038.42,-8086.65 1034.69,-8096.56 1041.69,-8096.72"/>
</g>
<!-- tp_comm_attn_gpu23_l8 -->
<g id="node353" class="node">
<title>tp_comm_attn_gpu23_l8</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-7960.77" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-7974.77" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L8)</text>
<text text-anchor="middle" x="895" y="-7963.77" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-7952.77" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-7941.77" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l8&#45;&gt;tp_comm_attn_gpu23_l8 -->
<g id="edge422" class="edge">
<title>attn_qkv_3_l8&#45;&gt;tp_comm_attn_gpu23_l8</title>
<path fill="none" stroke="black" d="M788.08,-8034.36C802.63,-8024.48 819.69,-8012.9 835.85,-8001.93"/>
<polygon fill="black" stroke="black" points="837.9,-8004.77 844.2,-7996.26 833.96,-7998.98 837.9,-8004.77"/>
</g>
<!-- attn_qkv_4_l8&#45;&gt;tp_comm_attn_gpu23_l8 -->
<g id="edge423" class="edge">
<title>attn_qkv_4_l8&#45;&gt;tp_comm_attn_gpu23_l8</title>
<path fill="none" stroke="black" d="M1001.92,-8034.36C987.37,-8024.48 970.31,-8012.9 954.15,-8001.93"/>
<polygon fill="black" stroke="black" points="956.04,-7998.98 945.8,-7996.26 952.1,-8004.77 956.04,-7998.98"/>
</g>
<!-- attn_out_3_l8 -->
<g id="node354" class="node">
<title>attn_out_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-7887 623.5,-7887 623.5,-7835 886.5,-7835 886.5,-7887"/>
<text text-anchor="middle" x="755" y="-7875" font-family="Arial" font-size="10.00">Attention Output (L8)</text>
<text text-anchor="middle" x="755" y="-7864" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-7853" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-7842" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l8&#45;&gt;attn_out_3_l8 -->
<g id="edge424" class="edge">
<title>tp_comm_attn_gpu23_l8&#45;&gt;attn_out_3_l8</title>
<path fill="none" stroke="black" d="M845.25,-7925.02C830.27,-7914.56 813.93,-7903.16 799.33,-7892.96"/>
<polygon fill="black" stroke="black" points="801.16,-7889.97 790.96,-7887.11 797.15,-7895.71 801.16,-7889.97"/>
</g>
<!-- attn_out_4_l8 -->
<g id="node355" class="node">
<title>attn_out_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-7887 904.5,-7887 904.5,-7835 1167.5,-7835 1167.5,-7887"/>
<text text-anchor="middle" x="1036" y="-7875" font-family="Arial" font-size="10.00">Attention Output (L8)</text>
<text text-anchor="middle" x="1036" y="-7864" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-7853" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-7842" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l8&#45;&gt;attn_out_4_l8 -->
<g id="edge425" class="edge">
<title>tp_comm_attn_gpu23_l8&#45;&gt;attn_out_4_l8</title>
<path fill="none" stroke="black" d="M945.11,-7925.02C960.19,-7914.56 976.64,-7903.16 991.35,-7892.96"/>
<polygon fill="black" stroke="black" points="993.56,-7895.68 999.79,-7887.11 989.57,-7889.93 993.56,-7895.68"/>
</g>
<!-- tp_comm_attn_out_gpu23_l8 -->
<g id="node356" class="node">
<title>tp_comm_attn_out_gpu23_l8</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-7761.23" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-7775.23" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L8)</text>
<text text-anchor="middle" x="895" y="-7764.23" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-7753.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-7742.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l8&#45;&gt;tp_comm_attn_out_gpu23_l8 -->
<g id="edge426" class="edge">
<title>attn_out_3_l8&#45;&gt;tp_comm_attn_out_gpu23_l8</title>
<path fill="none" stroke="black" d="M791.05,-7834.82C805.07,-7825.04 821.48,-7813.58 837.06,-7802.69"/>
<polygon fill="black" stroke="black" points="839.42,-7805.31 845.62,-7796.72 835.41,-7799.57 839.42,-7805.31"/>
</g>
<!-- attn_out_4_l8&#45;&gt;tp_comm_attn_out_gpu23_l8 -->
<g id="edge427" class="edge">
<title>attn_out_4_l8&#45;&gt;tp_comm_attn_out_gpu23_l8</title>
<path fill="none" stroke="black" d="M999.69,-7834.82C985.58,-7825.04 969.05,-7813.58 953.35,-7802.69"/>
<polygon fill="black" stroke="black" points="954.95,-7799.54 944.74,-7796.72 950.96,-7805.29 954.95,-7799.54"/>
</g>
<!-- ln1_3_l8 -->
<g id="node362" class="node">
<title>ln1_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-7687.46 625.5,-7687.46 625.5,-7635.46 886.5,-7635.46 886.5,-7687.46"/>
<text text-anchor="middle" x="756" y="-7675.46" font-family="Arial" font-size="10.00">LayerNorm1 (L8)</text>
<text text-anchor="middle" x="756" y="-7664.46" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-7653.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="756" y="-7642.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l8&#45;&gt;ln1_3_l8 -->
<g id="edge428" class="edge">
<title>tp_comm_attn_out_gpu23_l8&#45;&gt;ln1_3_l8</title>
<path fill="none" stroke="black" d="M845.99,-7725.76C831.1,-7715.28 814.82,-7703.83 800.25,-7693.59"/>
<polygon fill="black" stroke="black" points="802.09,-7690.6 791.9,-7687.71 798.07,-7696.33 802.09,-7690.6"/>
</g>
<!-- ln1_4_l8 -->
<g id="node363" class="node">
<title>ln1_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1165.5,-7687.46 904.5,-7687.46 904.5,-7635.46 1165.5,-7635.46 1165.5,-7687.46"/>
<text text-anchor="middle" x="1035" y="-7675.46" font-family="Arial" font-size="10.00">LayerNorm1 (L8)</text>
<text text-anchor="middle" x="1035" y="-7664.46" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-7653.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1035" y="-7642.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l8&#45;&gt;ln1_4_l8 -->
<g id="edge429" class="edge">
<title>tp_comm_attn_out_gpu23_l8&#45;&gt;ln1_4_l8</title>
<path fill="none" stroke="black" d="M944.36,-7725.76C959.36,-7715.28 975.76,-7703.83 990.43,-7693.59"/>
<polygon fill="black" stroke="black" points="992.65,-7696.31 998.84,-7687.71 988.64,-7690.57 992.65,-7696.31"/>
</g>
<!-- mlp_fc1_3_l8 -->
<g id="node357" class="node">
<title>mlp_fc1_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="883,-7598.46 629,-7598.46 629,-7546.46 883,-7546.46 883,-7598.46"/>
<text text-anchor="middle" x="756" y="-7586.46" font-family="Arial" font-size="10.00">MLP FC1 (L8)</text>
<text text-anchor="middle" x="756" y="-7575.46" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-7564.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="756" y="-7553.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l8 -->
<g id="node359" class="node">
<title>mlp_fc2_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-7509.46 625.5,-7509.46 625.5,-7457.46 886.5,-7457.46 886.5,-7509.46"/>
<text text-anchor="middle" x="756" y="-7497.46" font-family="Arial" font-size="10.00">MLP FC2 (L8)</text>
<text text-anchor="middle" x="756" y="-7486.46" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-7475.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="756" y="-7464.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l8&#45;&gt;mlp_fc2_3_l8 -->
<g id="edge432" class="edge">
<title>mlp_fc1_3_l8&#45;&gt;mlp_fc2_3_l8</title>
<path fill="none" stroke="black" d="M756,-7546.3C756,-7538 756,-7528.62 756,-7519.71"/>
<polygon fill="black" stroke="black" points="759.5,-7519.57 756,-7509.57 752.5,-7519.57 759.5,-7519.57"/>
</g>
<!-- mlp_fc1_4_l8 -->
<g id="node358" class="node">
<title>mlp_fc1_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1162,-7598.46 908,-7598.46 908,-7546.46 1162,-7546.46 1162,-7598.46"/>
<text text-anchor="middle" x="1035" y="-7586.46" font-family="Arial" font-size="10.00">MLP FC1 (L8)</text>
<text text-anchor="middle" x="1035" y="-7575.46" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-7564.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1035" y="-7553.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l8 -->
<g id="node360" class="node">
<title>mlp_fc2_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1165.5,-7509.46 904.5,-7509.46 904.5,-7457.46 1165.5,-7457.46 1165.5,-7509.46"/>
<text text-anchor="middle" x="1035" y="-7497.46" font-family="Arial" font-size="10.00">MLP FC2 (L8)</text>
<text text-anchor="middle" x="1035" y="-7486.46" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-7475.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1035" y="-7464.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l8&#45;&gt;mlp_fc2_4_l8 -->
<g id="edge433" class="edge">
<title>mlp_fc1_4_l8&#45;&gt;mlp_fc2_4_l8</title>
<path fill="none" stroke="black" d="M1035,-7546.3C1035,-7538 1035,-7528.62 1035,-7519.71"/>
<polygon fill="black" stroke="black" points="1038.5,-7519.57 1035,-7509.57 1031.5,-7519.57 1038.5,-7519.57"/>
</g>
<!-- tp_comm_mlp_gpu23_l8 -->
<g id="node361" class="node">
<title>tp_comm_mlp_gpu23_l8</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-7383.69" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-7397.69" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L8)</text>
<text text-anchor="middle" x="895" y="-7386.69" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-7375.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-7364.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l8&#45;&gt;tp_comm_mlp_gpu23_l8 -->
<g id="edge434" class="edge">
<title>mlp_fc2_3_l8&#45;&gt;tp_comm_mlp_gpu23_l8</title>
<path fill="none" stroke="black" d="M791.8,-7457.28C805.71,-7447.5 822,-7436.04 837.48,-7425.15"/>
<polygon fill="black" stroke="black" points="839.8,-7427.79 845.97,-7419.18 835.77,-7422.07 839.8,-7427.79"/>
</g>
<!-- mlp_fc2_4_l8&#45;&gt;tp_comm_mlp_gpu23_l8 -->
<g id="edge435" class="edge">
<title>mlp_fc2_4_l8&#45;&gt;tp_comm_mlp_gpu23_l8</title>
<path fill="none" stroke="black" d="M998.95,-7457.28C984.93,-7447.5 968.52,-7436.04 952.94,-7425.15"/>
<polygon fill="black" stroke="black" points="954.59,-7422.04 944.38,-7419.18 950.58,-7427.77 954.59,-7422.04"/>
</g>
<!-- ln2_3_l8 -->
<g id="node364" class="node">
<title>ln2_3_l8</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-7309.92 623.5,-7309.92 623.5,-7257.92 884.5,-7257.92 884.5,-7309.92"/>
<text text-anchor="middle" x="754" y="-7297.92" font-family="Arial" font-size="10.00">LayerNorm2 (L8)</text>
<text text-anchor="middle" x="754" y="-7286.92" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-7275.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-7264.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l8&#45;&gt;ln2_3_l8 -->
<g id="edge436" class="edge">
<title>tp_comm_mlp_gpu23_l8&#45;&gt;ln2_3_l8</title>
<path fill="none" stroke="black" d="M845.29,-7348.22C830.18,-7337.74 813.67,-7326.29 798.89,-7316.05"/>
<polygon fill="black" stroke="black" points="800.63,-7312.99 790.42,-7310.17 796.64,-7318.75 800.63,-7312.99"/>
</g>
<!-- ln2_4_l8 -->
<g id="node365" class="node">
<title>ln2_4_l8</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-7309.92 906.5,-7309.92 906.5,-7257.92 1167.5,-7257.92 1167.5,-7309.92"/>
<text text-anchor="middle" x="1037" y="-7297.92" font-family="Arial" font-size="10.00">LayerNorm2 (L8)</text>
<text text-anchor="middle" x="1037" y="-7286.92" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-7275.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-7264.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l8&#45;&gt;ln2_4_l8 -->
<g id="edge437" class="edge">
<title>tp_comm_mlp_gpu23_l8&#45;&gt;ln2_4_l8</title>
<path fill="none" stroke="black" d="M945.06,-7348.22C960.28,-7337.74 976.91,-7326.29 991.79,-7316.05"/>
<polygon fill="black" stroke="black" points="994.07,-7318.73 1000.32,-7310.17 990.1,-7312.96 994.07,-7318.73"/>
</g>
<!-- ln1_3_l8&#45;&gt;mlp_fc1_3_l8 -->
<g id="edge430" class="edge">
<title>ln1_3_l8&#45;&gt;mlp_fc1_3_l8</title>
<path fill="none" stroke="black" d="M756,-7635.3C756,-7627 756,-7617.62 756,-7608.71"/>
<polygon fill="black" stroke="black" points="759.5,-7608.57 756,-7598.57 752.5,-7608.57 759.5,-7608.57"/>
</g>
<!-- ln1_4_l8&#45;&gt;mlp_fc1_4_l8 -->
<g id="edge431" class="edge">
<title>ln1_4_l8&#45;&gt;mlp_fc1_4_l8</title>
<path fill="none" stroke="black" d="M1035,-7635.3C1035,-7627 1035,-7617.62 1035,-7608.71"/>
<polygon fill="black" stroke="black" points="1038.5,-7608.57 1035,-7598.57 1031.5,-7608.57 1038.5,-7608.57"/>
</g>
<!-- attn_qkv_3_l9 -->
<g id="node366" class="node">
<title>attn_qkv_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="886,-7220.92 616,-7220.92 616,-7168.92 886,-7168.92 886,-7220.92"/>
<text text-anchor="middle" x="751" y="-7208.92" font-family="Arial" font-size="10.00">Attention QKV (L9)</text>
<text text-anchor="middle" x="751" y="-7197.92" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-7186.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-7175.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l8&#45;&gt;attn_qkv_3_l9 -->
<g id="edge438" class="edge">
<title>ln2_3_l8&#45;&gt;attn_qkv_3_l9</title>
<path fill="none" stroke="black" d="M753.13,-7257.76C752.85,-7249.46 752.52,-7240.08 752.22,-7231.17"/>
<polygon fill="black" stroke="black" points="755.71,-7230.9 751.87,-7221.03 748.71,-7231.14 755.71,-7230.9"/>
</g>
<!-- attn_qkv_4_l9 -->
<g id="node367" class="node">
<title>attn_qkv_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1174,-7220.92 904,-7220.92 904,-7168.92 1174,-7168.92 1174,-7220.92"/>
<text text-anchor="middle" x="1039" y="-7208.92" font-family="Arial" font-size="10.00">Attention QKV (L9)</text>
<text text-anchor="middle" x="1039" y="-7197.92" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-7186.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-7175.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l8&#45;&gt;attn_qkv_4_l9 -->
<g id="edge439" class="edge">
<title>ln2_4_l8&#45;&gt;attn_qkv_4_l9</title>
<path fill="none" stroke="black" d="M1037.58,-7257.76C1037.77,-7249.46 1037.98,-7240.08 1038.19,-7231.17"/>
<polygon fill="black" stroke="black" points="1041.69,-7231.11 1038.42,-7221.03 1034.69,-7230.95 1041.69,-7231.11"/>
</g>
<!-- tp_comm_attn_gpu23_l9 -->
<g id="node368" class="node">
<title>tp_comm_attn_gpu23_l9</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-7095.15" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-7109.15" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L9)</text>
<text text-anchor="middle" x="895" y="-7098.15" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-7087.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-7076.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l9&#45;&gt;tp_comm_attn_gpu23_l9 -->
<g id="edge440" class="edge">
<title>attn_qkv_3_l9&#45;&gt;tp_comm_attn_gpu23_l9</title>
<path fill="none" stroke="black" d="M788.08,-7168.74C802.63,-7158.87 819.69,-7147.29 835.85,-7136.31"/>
<polygon fill="black" stroke="black" points="837.9,-7139.15 844.2,-7130.64 833.96,-7133.36 837.9,-7139.15"/>
</g>
<!-- attn_qkv_4_l9&#45;&gt;tp_comm_attn_gpu23_l9 -->
<g id="edge441" class="edge">
<title>attn_qkv_4_l9&#45;&gt;tp_comm_attn_gpu23_l9</title>
<path fill="none" stroke="black" d="M1001.92,-7168.74C987.37,-7158.87 970.31,-7147.29 954.15,-7136.31"/>
<polygon fill="black" stroke="black" points="956.04,-7133.36 945.8,-7130.64 952.1,-7139.15 956.04,-7133.36"/>
</g>
<!-- attn_out_3_l9 -->
<g id="node369" class="node">
<title>attn_out_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-7021.38 623.5,-7021.38 623.5,-6969.38 886.5,-6969.38 886.5,-7021.38"/>
<text text-anchor="middle" x="755" y="-7009.38" font-family="Arial" font-size="10.00">Attention Output (L9)</text>
<text text-anchor="middle" x="755" y="-6998.38" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-6987.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-6976.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l9&#45;&gt;attn_out_3_l9 -->
<g id="edge442" class="edge">
<title>tp_comm_attn_gpu23_l9&#45;&gt;attn_out_3_l9</title>
<path fill="none" stroke="black" d="M845.25,-7059.41C830.27,-7048.95 813.93,-7037.54 799.33,-7027.34"/>
<polygon fill="black" stroke="black" points="801.16,-7024.35 790.96,-7021.49 797.15,-7030.09 801.16,-7024.35"/>
</g>
<!-- attn_out_4_l9 -->
<g id="node370" class="node">
<title>attn_out_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-7021.38 904.5,-7021.38 904.5,-6969.38 1167.5,-6969.38 1167.5,-7021.38"/>
<text text-anchor="middle" x="1036" y="-7009.38" font-family="Arial" font-size="10.00">Attention Output (L9)</text>
<text text-anchor="middle" x="1036" y="-6998.38" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-6987.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-6976.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l9&#45;&gt;attn_out_4_l9 -->
<g id="edge443" class="edge">
<title>tp_comm_attn_gpu23_l9&#45;&gt;attn_out_4_l9</title>
<path fill="none" stroke="black" d="M945.11,-7059.41C960.19,-7048.95 976.64,-7037.54 991.35,-7027.34"/>
<polygon fill="black" stroke="black" points="993.56,-7030.07 999.79,-7021.49 989.57,-7024.31 993.56,-7030.07"/>
</g>
<!-- tp_comm_attn_out_gpu23_l9 -->
<g id="node371" class="node">
<title>tp_comm_attn_out_gpu23_l9</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-6895.61" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-6909.61" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L9)</text>
<text text-anchor="middle" x="895" y="-6898.61" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-6887.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-6876.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l9&#45;&gt;tp_comm_attn_out_gpu23_l9 -->
<g id="edge444" class="edge">
<title>attn_out_3_l9&#45;&gt;tp_comm_attn_out_gpu23_l9</title>
<path fill="none" stroke="black" d="M791.05,-6969.2C805.07,-6959.42 821.48,-6947.96 837.06,-6937.07"/>
<polygon fill="black" stroke="black" points="839.42,-6939.7 845.62,-6931.1 835.41,-6933.96 839.42,-6939.7"/>
</g>
<!-- attn_out_4_l9&#45;&gt;tp_comm_attn_out_gpu23_l9 -->
<g id="edge445" class="edge">
<title>attn_out_4_l9&#45;&gt;tp_comm_attn_out_gpu23_l9</title>
<path fill="none" stroke="black" d="M999.69,-6969.2C985.58,-6959.42 969.05,-6947.96 953.35,-6937.07"/>
<polygon fill="black" stroke="black" points="954.95,-6933.92 944.74,-6931.1 950.96,-6939.68 954.95,-6933.92"/>
</g>
<!-- ln1_3_l9 -->
<g id="node377" class="node">
<title>ln1_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-6821.84 624.5,-6821.84 624.5,-6769.84 885.5,-6769.84 885.5,-6821.84"/>
<text text-anchor="middle" x="755" y="-6809.84" font-family="Arial" font-size="10.00">LayerNorm1 (L9)</text>
<text text-anchor="middle" x="755" y="-6798.84" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-6787.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-6776.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l9&#45;&gt;ln1_3_l9 -->
<g id="edge446" class="edge">
<title>tp_comm_attn_out_gpu23_l9&#45;&gt;ln1_3_l9</title>
<path fill="none" stroke="black" d="M845.64,-6860.14C830.64,-6849.66 814.24,-6838.22 799.57,-6827.97"/>
<polygon fill="black" stroke="black" points="801.36,-6824.95 791.16,-6822.09 797.35,-6830.69 801.36,-6824.95"/>
</g>
<!-- ln1_4_l9 -->
<g id="node378" class="node">
<title>ln1_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-6821.84 903.5,-6821.84 903.5,-6769.84 1164.5,-6769.84 1164.5,-6821.84"/>
<text text-anchor="middle" x="1034" y="-6809.84" font-family="Arial" font-size="10.00">LayerNorm1 (L9)</text>
<text text-anchor="middle" x="1034" y="-6798.84" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-6787.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-6776.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l9&#45;&gt;ln1_4_l9 -->
<g id="edge447" class="edge">
<title>tp_comm_attn_out_gpu23_l9&#45;&gt;ln1_4_l9</title>
<path fill="none" stroke="black" d="M944.01,-6860.14C958.9,-6849.66 975.18,-6838.22 989.75,-6827.97"/>
<polygon fill="black" stroke="black" points="991.93,-6830.71 998.1,-6822.09 987.91,-6824.99 991.93,-6830.71"/>
</g>
<!-- mlp_fc1_3_l9 -->
<g id="node372" class="node">
<title>mlp_fc1_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="882,-6732.84 628,-6732.84 628,-6680.84 882,-6680.84 882,-6732.84"/>
<text text-anchor="middle" x="755" y="-6720.84" font-family="Arial" font-size="10.00">MLP FC1 (L9)</text>
<text text-anchor="middle" x="755" y="-6709.84" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-6698.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-6687.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l9 -->
<g id="node374" class="node">
<title>mlp_fc2_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-6643.84 624.5,-6643.84 624.5,-6591.84 885.5,-6591.84 885.5,-6643.84"/>
<text text-anchor="middle" x="755" y="-6631.84" font-family="Arial" font-size="10.00">MLP FC2 (L9)</text>
<text text-anchor="middle" x="755" y="-6620.84" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-6609.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-6598.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l9&#45;&gt;mlp_fc2_3_l9 -->
<g id="edge450" class="edge">
<title>mlp_fc1_3_l9&#45;&gt;mlp_fc2_3_l9</title>
<path fill="none" stroke="black" d="M755,-6680.68C755,-6672.38 755,-6663 755,-6654.09"/>
<polygon fill="black" stroke="black" points="758.5,-6653.95 755,-6643.95 751.5,-6653.95 758.5,-6653.95"/>
</g>
<!-- mlp_fc1_4_l9 -->
<g id="node373" class="node">
<title>mlp_fc1_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1161,-6732.84 907,-6732.84 907,-6680.84 1161,-6680.84 1161,-6732.84"/>
<text text-anchor="middle" x="1034" y="-6720.84" font-family="Arial" font-size="10.00">MLP FC1 (L9)</text>
<text text-anchor="middle" x="1034" y="-6709.84" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-6698.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-6687.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l9 -->
<g id="node375" class="node">
<title>mlp_fc2_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-6643.84 903.5,-6643.84 903.5,-6591.84 1164.5,-6591.84 1164.5,-6643.84"/>
<text text-anchor="middle" x="1034" y="-6631.84" font-family="Arial" font-size="10.00">MLP FC2 (L9)</text>
<text text-anchor="middle" x="1034" y="-6620.84" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-6609.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-6598.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l9&#45;&gt;mlp_fc2_4_l9 -->
<g id="edge451" class="edge">
<title>mlp_fc1_4_l9&#45;&gt;mlp_fc2_4_l9</title>
<path fill="none" stroke="black" d="M1034,-6680.68C1034,-6672.38 1034,-6663 1034,-6654.09"/>
<polygon fill="black" stroke="black" points="1037.5,-6653.95 1034,-6643.95 1030.5,-6653.95 1037.5,-6653.95"/>
</g>
<!-- tp_comm_mlp_gpu23_l9 -->
<g id="node376" class="node">
<title>tp_comm_mlp_gpu23_l9</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-6518.07" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-6532.07" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L9)</text>
<text text-anchor="middle" x="895" y="-6521.07" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-6510.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-6499.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l9&#45;&gt;tp_comm_mlp_gpu23_l9 -->
<g id="edge452" class="edge">
<title>mlp_fc2_3_l9&#45;&gt;tp_comm_mlp_gpu23_l9</title>
<path fill="none" stroke="black" d="M791.05,-6591.66C805.07,-6581.88 821.48,-6570.42 837.06,-6559.54"/>
<polygon fill="black" stroke="black" points="839.42,-6562.16 845.62,-6553.56 835.41,-6556.42 839.42,-6562.16"/>
</g>
<!-- mlp_fc2_4_l9&#45;&gt;tp_comm_mlp_gpu23_l9 -->
<g id="edge453" class="edge">
<title>mlp_fc2_4_l9&#45;&gt;tp_comm_mlp_gpu23_l9</title>
<path fill="none" stroke="black" d="M998.2,-6591.66C984.29,-6581.88 968,-6570.42 952.52,-6559.54"/>
<polygon fill="black" stroke="black" points="954.23,-6556.45 944.03,-6553.56 950.2,-6562.18 954.23,-6556.45"/>
</g>
<!-- ln2_3_l9 -->
<g id="node379" class="node">
<title>ln2_3_l9</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-6444.3 623.5,-6444.3 623.5,-6392.3 884.5,-6392.3 884.5,-6444.3"/>
<text text-anchor="middle" x="754" y="-6432.3" font-family="Arial" font-size="10.00">LayerNorm2 (L9)</text>
<text text-anchor="middle" x="754" y="-6421.3" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-6410.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-6399.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l9&#45;&gt;ln2_3_l9 -->
<g id="edge454" class="edge">
<title>tp_comm_mlp_gpu23_l9&#45;&gt;ln2_3_l9</title>
<path fill="none" stroke="black" d="M845.29,-6482.6C830.18,-6472.13 813.67,-6460.68 798.89,-6450.43"/>
<polygon fill="black" stroke="black" points="800.63,-6447.38 790.42,-6444.56 796.64,-6453.13 800.63,-6447.38"/>
</g>
<!-- ln2_4_l9 -->
<g id="node380" class="node">
<title>ln2_4_l9</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-6444.3 906.5,-6444.3 906.5,-6392.3 1167.5,-6392.3 1167.5,-6444.3"/>
<text text-anchor="middle" x="1037" y="-6432.3" font-family="Arial" font-size="10.00">LayerNorm2 (L9)</text>
<text text-anchor="middle" x="1037" y="-6421.3" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-6410.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-6399.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l9&#45;&gt;ln2_4_l9 -->
<g id="edge455" class="edge">
<title>tp_comm_mlp_gpu23_l9&#45;&gt;ln2_4_l9</title>
<path fill="none" stroke="black" d="M945.06,-6482.6C960.28,-6472.13 976.91,-6460.68 991.79,-6450.43"/>
<polygon fill="black" stroke="black" points="994.07,-6453.11 1000.32,-6444.56 990.1,-6447.34 994.07,-6453.11"/>
</g>
<!-- ln1_3_l9&#45;&gt;mlp_fc1_3_l9 -->
<g id="edge448" class="edge">
<title>ln1_3_l9&#45;&gt;mlp_fc1_3_l9</title>
<path fill="none" stroke="black" d="M755,-6769.68C755,-6761.38 755,-6752 755,-6743.09"/>
<polygon fill="black" stroke="black" points="758.5,-6742.95 755,-6732.95 751.5,-6742.95 758.5,-6742.95"/>
</g>
<!-- ln1_4_l9&#45;&gt;mlp_fc1_4_l9 -->
<g id="edge449" class="edge">
<title>ln1_4_l9&#45;&gt;mlp_fc1_4_l9</title>
<path fill="none" stroke="black" d="M1034,-6769.68C1034,-6761.38 1034,-6752 1034,-6743.09"/>
<polygon fill="black" stroke="black" points="1037.5,-6742.95 1034,-6732.95 1030.5,-6742.95 1037.5,-6742.95"/>
</g>
<!-- attn_qkv_3_l10 -->
<g id="node381" class="node">
<title>attn_qkv_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="886,-6355.3 616,-6355.3 616,-6303.3 886,-6303.3 886,-6355.3"/>
<text text-anchor="middle" x="751" y="-6343.3" font-family="Arial" font-size="10.00">Attention QKV (L10)</text>
<text text-anchor="middle" x="751" y="-6332.3" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-6321.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-6310.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l9&#45;&gt;attn_qkv_3_l10 -->
<g id="edge456" class="edge">
<title>ln2_3_l9&#45;&gt;attn_qkv_3_l10</title>
<path fill="none" stroke="black" d="M753.13,-6392.14C752.85,-6383.84 752.52,-6374.46 752.22,-6365.55"/>
<polygon fill="black" stroke="black" points="755.71,-6365.28 751.87,-6355.41 748.71,-6365.53 755.71,-6365.28"/>
</g>
<!-- attn_qkv_4_l10 -->
<g id="node382" class="node">
<title>attn_qkv_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1174,-6355.3 904,-6355.3 904,-6303.3 1174,-6303.3 1174,-6355.3"/>
<text text-anchor="middle" x="1039" y="-6343.3" font-family="Arial" font-size="10.00">Attention QKV (L10)</text>
<text text-anchor="middle" x="1039" y="-6332.3" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-6321.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-6310.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l9&#45;&gt;attn_qkv_4_l10 -->
<g id="edge457" class="edge">
<title>ln2_4_l9&#45;&gt;attn_qkv_4_l10</title>
<path fill="none" stroke="black" d="M1037.58,-6392.14C1037.77,-6383.84 1037.98,-6374.46 1038.19,-6365.55"/>
<polygon fill="black" stroke="black" points="1041.69,-6365.49 1038.42,-6355.41 1034.69,-6365.33 1041.69,-6365.49"/>
</g>
<!-- tp_comm_attn_gpu23_l10 -->
<g id="node383" class="node">
<title>tp_comm_attn_gpu23_l10</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-6229.53" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-6243.53" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L10)</text>
<text text-anchor="middle" x="895" y="-6232.53" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-6221.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-6210.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l10&#45;&gt;tp_comm_attn_gpu23_l10 -->
<g id="edge458" class="edge">
<title>attn_qkv_3_l10&#45;&gt;tp_comm_attn_gpu23_l10</title>
<path fill="none" stroke="black" d="M788.08,-6303.13C802.63,-6293.25 819.69,-6281.67 835.85,-6270.69"/>
<polygon fill="black" stroke="black" points="837.9,-6273.54 844.2,-6265.02 833.96,-6267.74 837.9,-6273.54"/>
</g>
<!-- attn_qkv_4_l10&#45;&gt;tp_comm_attn_gpu23_l10 -->
<g id="edge459" class="edge">
<title>attn_qkv_4_l10&#45;&gt;tp_comm_attn_gpu23_l10</title>
<path fill="none" stroke="black" d="M1001.92,-6303.13C987.37,-6293.25 970.31,-6281.67 954.15,-6270.69"/>
<polygon fill="black" stroke="black" points="956.04,-6267.74 945.8,-6265.02 952.1,-6273.54 956.04,-6267.74"/>
</g>
<!-- attn_out_3_l10 -->
<g id="node384" class="node">
<title>attn_out_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-6155.76 622.5,-6155.76 622.5,-6103.76 885.5,-6103.76 885.5,-6155.76"/>
<text text-anchor="middle" x="754" y="-6143.76" font-family="Arial" font-size="10.00">Attention Output (L10)</text>
<text text-anchor="middle" x="754" y="-6132.76" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-6121.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="754" y="-6110.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l10&#45;&gt;attn_out_3_l10 -->
<g id="edge460" class="edge">
<title>tp_comm_attn_gpu23_l10&#45;&gt;attn_out_3_l10</title>
<path fill="none" stroke="black" d="M844.89,-6193.79C829.81,-6183.33 813.36,-6171.92 798.65,-6161.72"/>
<polygon fill="black" stroke="black" points="800.43,-6158.7 790.21,-6155.88 796.44,-6164.45 800.43,-6158.7"/>
</g>
<!-- attn_out_4_l10 -->
<g id="node385" class="node">
<title>attn_out_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1166.5,-6155.76 903.5,-6155.76 903.5,-6103.76 1166.5,-6103.76 1166.5,-6155.76"/>
<text text-anchor="middle" x="1035" y="-6143.76" font-family="Arial" font-size="10.00">Attention Output (L10)</text>
<text text-anchor="middle" x="1035" y="-6132.76" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-6121.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1035" y="-6110.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l10&#45;&gt;attn_out_4_l10 -->
<g id="edge461" class="edge">
<title>tp_comm_attn_gpu23_l10&#45;&gt;attn_out_4_l10</title>
<path fill="none" stroke="black" d="M944.75,-6193.79C959.73,-6183.33 976.07,-6171.92 990.67,-6161.72"/>
<polygon fill="black" stroke="black" points="992.85,-6164.47 999.04,-6155.88 988.84,-6158.73 992.85,-6164.47"/>
</g>
<!-- tp_comm_attn_out_gpu23_l10 -->
<g id="node386" class="node">
<title>tp_comm_attn_out_gpu23_l10</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-6030" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-6044" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L10)</text>
<text text-anchor="middle" x="895" y="-6033" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-6022" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-6011" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l10&#45;&gt;tp_comm_attn_out_gpu23_l10 -->
<g id="edge462" class="edge">
<title>attn_out_3_l10&#45;&gt;tp_comm_attn_out_gpu23_l10</title>
<path fill="none" stroke="black" d="M790.31,-6103.59C804.42,-6093.8 820.95,-6082.34 836.65,-6071.46"/>
<polygon fill="black" stroke="black" points="839.04,-6074.06 845.26,-6065.48 835.05,-6068.31 839.04,-6074.06"/>
</g>
<!-- attn_out_4_l10&#45;&gt;tp_comm_attn_out_gpu23_l10 -->
<g id="edge463" class="edge">
<title>attn_out_4_l10&#45;&gt;tp_comm_attn_out_gpu23_l10</title>
<path fill="none" stroke="black" d="M998.95,-6103.59C984.93,-6093.8 968.52,-6082.34 952.94,-6071.46"/>
<polygon fill="black" stroke="black" points="954.59,-6068.34 944.38,-6065.48 950.58,-6074.08 954.59,-6068.34"/>
</g>
<!-- ln1_3_l10 -->
<g id="node392" class="node">
<title>ln1_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-5956.23 625.5,-5956.23 625.5,-5904.23 886.5,-5904.23 886.5,-5956.23"/>
<text text-anchor="middle" x="756" y="-5944.23" font-family="Arial" font-size="10.00">LayerNorm1 (L10)</text>
<text text-anchor="middle" x="756" y="-5933.23" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-5922.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="756" y="-5911.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l10&#45;&gt;ln1_3_l10 -->
<g id="edge464" class="edge">
<title>tp_comm_attn_out_gpu23_l10&#45;&gt;ln1_3_l10</title>
<path fill="none" stroke="black" d="M845.99,-5994.53C831.1,-5984.05 814.82,-5972.6 800.25,-5962.35"/>
<polygon fill="black" stroke="black" points="802.09,-5959.37 791.9,-5956.48 798.07,-5965.09 802.09,-5959.37"/>
</g>
<!-- ln1_4_l10 -->
<g id="node393" class="node">
<title>ln1_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1165.5,-5956.23 904.5,-5956.23 904.5,-5904.23 1165.5,-5904.23 1165.5,-5956.23"/>
<text text-anchor="middle" x="1035" y="-5944.23" font-family="Arial" font-size="10.00">LayerNorm1 (L10)</text>
<text text-anchor="middle" x="1035" y="-5933.23" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-5922.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1035" y="-5911.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l10&#45;&gt;ln1_4_l10 -->
<g id="edge465" class="edge">
<title>tp_comm_attn_out_gpu23_l10&#45;&gt;ln1_4_l10</title>
<path fill="none" stroke="black" d="M944.36,-5994.53C959.36,-5984.05 975.76,-5972.6 990.43,-5962.35"/>
<polygon fill="black" stroke="black" points="992.65,-5965.07 998.84,-5956.48 988.64,-5959.33 992.65,-5965.07"/>
</g>
<!-- mlp_fc1_3_l10 -->
<g id="node387" class="node">
<title>mlp_fc1_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="883,-5867.23 629,-5867.23 629,-5815.23 883,-5815.23 883,-5867.23"/>
<text text-anchor="middle" x="756" y="-5855.23" font-family="Arial" font-size="10.00">MLP FC1 (L10)</text>
<text text-anchor="middle" x="756" y="-5844.23" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-5833.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="756" y="-5822.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l10 -->
<g id="node389" class="node">
<title>mlp_fc2_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-5778.23 625.5,-5778.23 625.5,-5726.23 886.5,-5726.23 886.5,-5778.23"/>
<text text-anchor="middle" x="756" y="-5766.23" font-family="Arial" font-size="10.00">MLP FC2 (L10)</text>
<text text-anchor="middle" x="756" y="-5755.23" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="756" y="-5744.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="756" y="-5733.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l10&#45;&gt;mlp_fc2_3_l10 -->
<g id="edge468" class="edge">
<title>mlp_fc1_3_l10&#45;&gt;mlp_fc2_3_l10</title>
<path fill="none" stroke="black" d="M756,-5815.06C756,-5806.77 756,-5797.38 756,-5788.47"/>
<polygon fill="black" stroke="black" points="759.5,-5788.33 756,-5778.33 752.5,-5788.33 759.5,-5788.33"/>
</g>
<!-- mlp_fc1_4_l10 -->
<g id="node388" class="node">
<title>mlp_fc1_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1162,-5867.23 908,-5867.23 908,-5815.23 1162,-5815.23 1162,-5867.23"/>
<text text-anchor="middle" x="1035" y="-5855.23" font-family="Arial" font-size="10.00">MLP FC1 (L10)</text>
<text text-anchor="middle" x="1035" y="-5844.23" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-5833.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1035" y="-5822.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l10 -->
<g id="node390" class="node">
<title>mlp_fc2_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1165.5,-5778.23 904.5,-5778.23 904.5,-5726.23 1165.5,-5726.23 1165.5,-5778.23"/>
<text text-anchor="middle" x="1035" y="-5766.23" font-family="Arial" font-size="10.00">MLP FC2 (L10)</text>
<text text-anchor="middle" x="1035" y="-5755.23" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-5744.23" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1035" y="-5733.23" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l10&#45;&gt;mlp_fc2_4_l10 -->
<g id="edge469" class="edge">
<title>mlp_fc1_4_l10&#45;&gt;mlp_fc2_4_l10</title>
<path fill="none" stroke="black" d="M1035,-5815.06C1035,-5806.77 1035,-5797.38 1035,-5788.47"/>
<polygon fill="black" stroke="black" points="1038.5,-5788.33 1035,-5778.33 1031.5,-5788.33 1038.5,-5788.33"/>
</g>
<!-- tp_comm_mlp_gpu23_l10 -->
<g id="node391" class="node">
<title>tp_comm_mlp_gpu23_l10</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-5652.46" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-5666.46" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L10)</text>
<text text-anchor="middle" x="895" y="-5655.46" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-5644.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-5633.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l10&#45;&gt;tp_comm_mlp_gpu23_l10 -->
<g id="edge470" class="edge">
<title>mlp_fc2_3_l10&#45;&gt;tp_comm_mlp_gpu23_l10</title>
<path fill="none" stroke="black" d="M791.8,-5726.05C805.71,-5716.26 822,-5704.8 837.48,-5693.92"/>
<polygon fill="black" stroke="black" points="839.8,-5696.56 845.97,-5687.94 835.77,-5690.83 839.8,-5696.56"/>
</g>
<!-- mlp_fc2_4_l10&#45;&gt;tp_comm_mlp_gpu23_l10 -->
<g id="edge471" class="edge">
<title>mlp_fc2_4_l10&#45;&gt;tp_comm_mlp_gpu23_l10</title>
<path fill="none" stroke="black" d="M998.95,-5726.05C984.93,-5716.26 968.52,-5704.8 952.94,-5693.92"/>
<polygon fill="black" stroke="black" points="954.59,-5690.8 944.38,-5687.94 950.58,-5696.54 954.59,-5690.8"/>
</g>
<!-- ln2_3_l10 -->
<g id="node394" class="node">
<title>ln2_3_l10</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-5578.69 623.5,-5578.69 623.5,-5526.69 884.5,-5526.69 884.5,-5578.69"/>
<text text-anchor="middle" x="754" y="-5566.69" font-family="Arial" font-size="10.00">LayerNorm2 (L10)</text>
<text text-anchor="middle" x="754" y="-5555.69" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-5544.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-5533.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l10&#45;&gt;ln2_3_l10 -->
<g id="edge472" class="edge">
<title>tp_comm_mlp_gpu23_l10&#45;&gt;ln2_3_l10</title>
<path fill="none" stroke="black" d="M845.29,-5616.99C830.18,-5606.51 813.67,-5595.06 798.89,-5584.81"/>
<polygon fill="black" stroke="black" points="800.63,-5581.76 790.42,-5578.94 796.64,-5587.51 800.63,-5581.76"/>
</g>
<!-- ln2_4_l10 -->
<g id="node395" class="node">
<title>ln2_4_l10</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-5578.69 906.5,-5578.69 906.5,-5526.69 1167.5,-5526.69 1167.5,-5578.69"/>
<text text-anchor="middle" x="1037" y="-5566.69" font-family="Arial" font-size="10.00">LayerNorm2 (L10)</text>
<text text-anchor="middle" x="1037" y="-5555.69" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-5544.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-5533.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l10&#45;&gt;ln2_4_l10 -->
<g id="edge473" class="edge">
<title>tp_comm_mlp_gpu23_l10&#45;&gt;ln2_4_l10</title>
<path fill="none" stroke="black" d="M945.06,-5616.99C960.28,-5606.51 976.91,-5595.06 991.79,-5584.81"/>
<polygon fill="black" stroke="black" points="994.07,-5587.49 1000.32,-5578.94 990.1,-5581.73 994.07,-5587.49"/>
</g>
<!-- ln1_3_l10&#45;&gt;mlp_fc1_3_l10 -->
<g id="edge466" class="edge">
<title>ln1_3_l10&#45;&gt;mlp_fc1_3_l10</title>
<path fill="none" stroke="black" d="M756,-5904.06C756,-5895.77 756,-5886.38 756,-5877.47"/>
<polygon fill="black" stroke="black" points="759.5,-5877.33 756,-5867.33 752.5,-5877.33 759.5,-5877.33"/>
</g>
<!-- ln1_4_l10&#45;&gt;mlp_fc1_4_l10 -->
<g id="edge467" class="edge">
<title>ln1_4_l10&#45;&gt;mlp_fc1_4_l10</title>
<path fill="none" stroke="black" d="M1035,-5904.06C1035,-5895.77 1035,-5886.38 1035,-5877.47"/>
<polygon fill="black" stroke="black" points="1038.5,-5877.33 1035,-5867.33 1031.5,-5877.33 1038.5,-5877.33"/>
</g>
<!-- attn_qkv_3_l11 -->
<g id="node396" class="node">
<title>attn_qkv_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="886,-5489.69 616,-5489.69 616,-5437.69 886,-5437.69 886,-5489.69"/>
<text text-anchor="middle" x="751" y="-5477.69" font-family="Arial" font-size="10.00">Attention QKV (L11)</text>
<text text-anchor="middle" x="751" y="-5466.69" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-5455.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-5444.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l10&#45;&gt;attn_qkv_3_l11 -->
<g id="edge474" class="edge">
<title>ln2_3_l10&#45;&gt;attn_qkv_3_l11</title>
<path fill="none" stroke="black" d="M753.13,-5526.52C752.85,-5518.23 752.52,-5508.84 752.22,-5499.94"/>
<polygon fill="black" stroke="black" points="755.71,-5499.67 751.87,-5489.79 748.71,-5499.91 755.71,-5499.67"/>
</g>
<!-- attn_qkv_4_l11 -->
<g id="node397" class="node">
<title>attn_qkv_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1174,-5489.69 904,-5489.69 904,-5437.69 1174,-5437.69 1174,-5489.69"/>
<text text-anchor="middle" x="1039" y="-5477.69" font-family="Arial" font-size="10.00">Attention QKV (L11)</text>
<text text-anchor="middle" x="1039" y="-5466.69" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-5455.69" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-5444.69" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l10&#45;&gt;attn_qkv_4_l11 -->
<g id="edge475" class="edge">
<title>ln2_4_l10&#45;&gt;attn_qkv_4_l11</title>
<path fill="none" stroke="black" d="M1037.58,-5526.52C1037.77,-5518.23 1037.98,-5508.84 1038.19,-5499.94"/>
<polygon fill="black" stroke="black" points="1041.69,-5499.87 1038.42,-5489.79 1034.69,-5499.71 1041.69,-5499.87"/>
</g>
<!-- tp_comm_attn_gpu23_l11 -->
<g id="node398" class="node">
<title>tp_comm_attn_gpu23_l11</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-5363.92" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-5377.92" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L11)</text>
<text text-anchor="middle" x="895" y="-5366.92" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-5355.92" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-5344.92" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l11&#45;&gt;tp_comm_attn_gpu23_l11 -->
<g id="edge476" class="edge">
<title>attn_qkv_3_l11&#45;&gt;tp_comm_attn_gpu23_l11</title>
<path fill="none" stroke="black" d="M788.08,-5437.51C802.63,-5427.63 819.69,-5416.05 835.85,-5405.08"/>
<polygon fill="black" stroke="black" points="837.9,-5407.92 844.2,-5399.41 833.96,-5402.13 837.9,-5407.92"/>
</g>
<!-- attn_qkv_4_l11&#45;&gt;tp_comm_attn_gpu23_l11 -->
<g id="edge477" class="edge">
<title>attn_qkv_4_l11&#45;&gt;tp_comm_attn_gpu23_l11</title>
<path fill="none" stroke="black" d="M1001.92,-5437.51C987.37,-5427.63 970.31,-5416.05 954.15,-5405.08"/>
<polygon fill="black" stroke="black" points="956.04,-5402.13 945.8,-5399.41 952.1,-5407.92 956.04,-5402.13"/>
</g>
<!-- attn_out_3_l11 -->
<g id="node399" class="node">
<title>attn_out_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-5290.15 622.5,-5290.15 622.5,-5238.15 885.5,-5238.15 885.5,-5290.15"/>
<text text-anchor="middle" x="754" y="-5278.15" font-family="Arial" font-size="10.00">Attention Output (L11)</text>
<text text-anchor="middle" x="754" y="-5267.15" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-5256.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="754" y="-5245.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l11&#45;&gt;attn_out_3_l11 -->
<g id="edge478" class="edge">
<title>tp_comm_attn_gpu23_l11&#45;&gt;attn_out_3_l11</title>
<path fill="none" stroke="black" d="M844.89,-5328.17C829.81,-5317.71 813.36,-5306.3 798.65,-5296.11"/>
<polygon fill="black" stroke="black" points="800.43,-5293.08 790.21,-5290.26 796.44,-5298.83 800.43,-5293.08"/>
</g>
<!-- attn_out_4_l11 -->
<g id="node400" class="node">
<title>attn_out_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1166.5,-5290.15 903.5,-5290.15 903.5,-5238.15 1166.5,-5238.15 1166.5,-5290.15"/>
<text text-anchor="middle" x="1035" y="-5278.15" font-family="Arial" font-size="10.00">Attention Output (L11)</text>
<text text-anchor="middle" x="1035" y="-5267.15" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1035" y="-5256.15" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1035" y="-5245.15" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l11&#45;&gt;attn_out_4_l11 -->
<g id="edge479" class="edge">
<title>tp_comm_attn_gpu23_l11&#45;&gt;attn_out_4_l11</title>
<path fill="none" stroke="black" d="M944.75,-5328.17C959.73,-5317.71 976.07,-5306.3 990.67,-5296.11"/>
<polygon fill="black" stroke="black" points="992.85,-5298.85 999.04,-5290.26 988.84,-5293.11 992.85,-5298.85"/>
</g>
<!-- tp_comm_attn_out_gpu23_l11 -->
<g id="node401" class="node">
<title>tp_comm_attn_out_gpu23_l11</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-5164.38" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-5178.38" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L11)</text>
<text text-anchor="middle" x="895" y="-5167.38" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-5156.38" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-5145.38" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l11&#45;&gt;tp_comm_attn_out_gpu23_l11 -->
<g id="edge480" class="edge">
<title>attn_out_3_l11&#45;&gt;tp_comm_attn_out_gpu23_l11</title>
<path fill="none" stroke="black" d="M790.31,-5237.97C804.42,-5228.18 820.95,-5216.72 836.65,-5205.84"/>
<polygon fill="black" stroke="black" points="839.04,-5208.44 845.26,-5199.87 835.05,-5202.69 839.04,-5208.44"/>
</g>
<!-- attn_out_4_l11&#45;&gt;tp_comm_attn_out_gpu23_l11 -->
<g id="edge481" class="edge">
<title>attn_out_4_l11&#45;&gt;tp_comm_attn_out_gpu23_l11</title>
<path fill="none" stroke="black" d="M998.95,-5237.97C984.93,-5228.18 968.52,-5216.72 952.94,-5205.84"/>
<polygon fill="black" stroke="black" points="954.59,-5202.72 944.38,-5199.87 950.58,-5208.46 954.59,-5202.72"/>
</g>
<!-- ln1_3_l11 -->
<g id="node407" class="node">
<title>ln1_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="871.5,-5090.61 610.5,-5090.61 610.5,-5038.61 871.5,-5038.61 871.5,-5090.61"/>
<text text-anchor="middle" x="741" y="-5078.61" font-family="Arial" font-size="10.00">LayerNorm1 (L11)</text>
<text text-anchor="middle" x="741" y="-5067.61" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-5056.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="741" y="-5045.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l11&#45;&gt;ln1_3_l11 -->
<g id="edge482" class="edge">
<title>tp_comm_attn_out_gpu23_l11&#45;&gt;ln1_3_l11</title>
<path fill="none" stroke="black" d="M841.14,-5129.18C824.15,-5118.4 805.51,-5106.56 788.96,-5096.06"/>
<polygon fill="black" stroke="black" points="790.83,-5093.1 780.52,-5090.7 787.08,-5099.01 790.83,-5093.1"/>
</g>
<!-- ln1_4_l11 -->
<g id="node408" class="node">
<title>ln1_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1150.5,-5090.61 889.5,-5090.61 889.5,-5038.61 1150.5,-5038.61 1150.5,-5090.61"/>
<text text-anchor="middle" x="1020" y="-5078.61" font-family="Arial" font-size="10.00">LayerNorm1 (L11)</text>
<text text-anchor="middle" x="1020" y="-5067.61" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-5056.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1020" y="-5045.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l11&#45;&gt;ln1_4_l11 -->
<g id="edge483" class="edge">
<title>tp_comm_attn_out_gpu23_l11&#45;&gt;ln1_4_l11</title>
<path fill="none" stroke="black" d="M939.42,-5128.63C952.55,-5118.37 966.84,-5107.19 979.69,-5097.14"/>
<polygon fill="black" stroke="black" points="982.18,-5099.64 987.9,-5090.72 977.86,-5094.12 982.18,-5099.64"/>
</g>
<!-- mlp_fc1_3_l11 -->
<g id="node402" class="node">
<title>mlp_fc1_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="868,-5001.61 614,-5001.61 614,-4949.61 868,-4949.61 868,-5001.61"/>
<text text-anchor="middle" x="741" y="-4989.61" font-family="Arial" font-size="10.00">MLP FC1 (L11)</text>
<text text-anchor="middle" x="741" y="-4978.61" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-4967.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="741" y="-4956.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l11 -->
<g id="node404" class="node">
<title>mlp_fc2_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="871.5,-4912.61 610.5,-4912.61 610.5,-4860.61 871.5,-4860.61 871.5,-4912.61"/>
<text text-anchor="middle" x="741" y="-4900.61" font-family="Arial" font-size="10.00">MLP FC2 (L11)</text>
<text text-anchor="middle" x="741" y="-4889.61" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-4878.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="741" y="-4867.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l11&#45;&gt;mlp_fc2_3_l11 -->
<g id="edge486" class="edge">
<title>mlp_fc1_3_l11&#45;&gt;mlp_fc2_3_l11</title>
<path fill="none" stroke="black" d="M741,-4949.44C741,-4941.15 741,-4931.76 741,-4922.86"/>
<polygon fill="black" stroke="black" points="744.5,-4922.72 741,-4912.72 737.5,-4922.72 744.5,-4922.72"/>
</g>
<!-- mlp_fc1_4_l11 -->
<g id="node403" class="node">
<title>mlp_fc1_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1147,-5001.61 893,-5001.61 893,-4949.61 1147,-4949.61 1147,-5001.61"/>
<text text-anchor="middle" x="1020" y="-4989.61" font-family="Arial" font-size="10.00">MLP FC1 (L11)</text>
<text text-anchor="middle" x="1020" y="-4978.61" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-4967.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1020" y="-4956.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l11 -->
<g id="node405" class="node">
<title>mlp_fc2_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1150.5,-4912.61 889.5,-4912.61 889.5,-4860.61 1150.5,-4860.61 1150.5,-4912.61"/>
<text text-anchor="middle" x="1020" y="-4900.61" font-family="Arial" font-size="10.00">MLP FC2 (L11)</text>
<text text-anchor="middle" x="1020" y="-4889.61" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-4878.61" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1020" y="-4867.61" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l11&#45;&gt;mlp_fc2_4_l11 -->
<g id="edge487" class="edge">
<title>mlp_fc1_4_l11&#45;&gt;mlp_fc2_4_l11</title>
<path fill="none" stroke="black" d="M1020,-4949.44C1020,-4941.15 1020,-4931.76 1020,-4922.86"/>
<polygon fill="black" stroke="black" points="1023.5,-4922.72 1020,-4912.72 1016.5,-4922.72 1023.5,-4922.72"/>
</g>
<!-- tp_comm_mlp_gpu23_l11 -->
<g id="node406" class="node">
<title>tp_comm_mlp_gpu23_l11</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-4786.84" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-4800.84" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L11)</text>
<text text-anchor="middle" x="895" y="-4789.84" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-4778.84" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-4767.84" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l11&#45;&gt;tp_comm_mlp_gpu23_l11 -->
<g id="edge488" class="edge">
<title>mlp_fc2_3_l11&#45;&gt;tp_comm_mlp_gpu23_l11</title>
<path fill="none" stroke="black" d="M780.66,-4860.43C796.44,-4850.41 814.97,-4838.65 832.47,-4827.53"/>
<polygon fill="black" stroke="black" points="834.4,-4830.46 840.97,-4822.14 830.65,-4824.55 834.4,-4830.46"/>
</g>
<!-- mlp_fc2_4_l11&#45;&gt;tp_comm_mlp_gpu23_l11 -->
<g id="edge489" class="edge">
<title>mlp_fc2_4_l11&#45;&gt;tp_comm_mlp_gpu23_l11</title>
<path fill="none" stroke="black" d="M987.81,-4860.43C975.59,-4850.88 961.34,-4839.73 947.72,-4829.08"/>
<polygon fill="black" stroke="black" points="949.83,-4826.28 939.8,-4822.88 945.52,-4831.8 949.83,-4826.28"/>
</g>
<!-- ln2_3_l11 -->
<g id="node409" class="node">
<title>ln2_3_l11</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-4713.07 623.5,-4713.07 623.5,-4661.07 884.5,-4661.07 884.5,-4713.07"/>
<text text-anchor="middle" x="754" y="-4701.07" font-family="Arial" font-size="10.00">LayerNorm2 (L11)</text>
<text text-anchor="middle" x="754" y="-4690.07" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-4679.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-4668.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l11&#45;&gt;ln2_3_l11 -->
<g id="edge490" class="edge">
<title>tp_comm_mlp_gpu23_l11&#45;&gt;ln2_3_l11</title>
<path fill="none" stroke="black" d="M845.29,-4751.37C830.18,-4740.89 813.67,-4729.44 798.89,-4719.2"/>
<polygon fill="black" stroke="black" points="800.63,-4716.14 790.42,-4713.32 796.64,-4721.9 800.63,-4716.14"/>
</g>
<!-- ln2_4_l11 -->
<g id="node410" class="node">
<title>ln2_4_l11</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-4713.07 906.5,-4713.07 906.5,-4661.07 1167.5,-4661.07 1167.5,-4713.07"/>
<text text-anchor="middle" x="1037" y="-4701.07" font-family="Arial" font-size="10.00">LayerNorm2 (L11)</text>
<text text-anchor="middle" x="1037" y="-4690.07" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-4679.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-4668.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l11&#45;&gt;ln2_4_l11 -->
<g id="edge491" class="edge">
<title>tp_comm_mlp_gpu23_l11&#45;&gt;ln2_4_l11</title>
<path fill="none" stroke="black" d="M945.06,-4751.37C960.28,-4740.89 976.91,-4729.44 991.79,-4719.2"/>
<polygon fill="black" stroke="black" points="994.07,-4721.87 1000.32,-4713.32 990.1,-4716.11 994.07,-4721.87"/>
</g>
<!-- ln1_3_l11&#45;&gt;mlp_fc1_3_l11 -->
<g id="edge484" class="edge">
<title>ln1_3_l11&#45;&gt;mlp_fc1_3_l11</title>
<path fill="none" stroke="black" d="M741,-5038.44C741,-5030.15 741,-5020.76 741,-5011.86"/>
<polygon fill="black" stroke="black" points="744.5,-5011.72 741,-5001.72 737.5,-5011.72 744.5,-5011.72"/>
</g>
<!-- ln1_4_l11&#45;&gt;mlp_fc1_4_l11 -->
<g id="edge485" class="edge">
<title>ln1_4_l11&#45;&gt;mlp_fc1_4_l11</title>
<path fill="none" stroke="black" d="M1020,-5038.44C1020,-5030.15 1020,-5020.76 1020,-5011.86"/>
<polygon fill="black" stroke="black" points="1023.5,-5011.72 1020,-5001.72 1016.5,-5011.72 1023.5,-5011.72"/>
</g>
<!-- attn_qkv_3_l12 -->
<g id="node411" class="node">
<title>attn_qkv_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="886,-4624.07 616,-4624.07 616,-4572.07 886,-4572.07 886,-4624.07"/>
<text text-anchor="middle" x="751" y="-4612.07" font-family="Arial" font-size="10.00">Attention QKV (L12)</text>
<text text-anchor="middle" x="751" y="-4601.07" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-4590.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-4579.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l11&#45;&gt;attn_qkv_3_l12 -->
<g id="edge492" class="edge">
<title>ln2_3_l11&#45;&gt;attn_qkv_3_l12</title>
<path fill="none" stroke="black" d="M753.13,-4660.91C752.85,-4652.61 752.52,-4643.22 752.22,-4634.32"/>
<polygon fill="black" stroke="black" points="755.71,-4634.05 751.87,-4624.18 748.71,-4634.29 755.71,-4634.05"/>
</g>
<!-- attn_qkv_4_l12 -->
<g id="node412" class="node">
<title>attn_qkv_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1174,-4624.07 904,-4624.07 904,-4572.07 1174,-4572.07 1174,-4624.07"/>
<text text-anchor="middle" x="1039" y="-4612.07" font-family="Arial" font-size="10.00">Attention QKV (L12)</text>
<text text-anchor="middle" x="1039" y="-4601.07" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-4590.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-4579.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l11&#45;&gt;attn_qkv_4_l12 -->
<g id="edge493" class="edge">
<title>ln2_4_l11&#45;&gt;attn_qkv_4_l12</title>
<path fill="none" stroke="black" d="M1037.58,-4660.91C1037.77,-4652.61 1037.98,-4643.22 1038.19,-4634.32"/>
<polygon fill="black" stroke="black" points="1041.69,-4634.25 1038.42,-4624.18 1034.69,-4634.09 1041.69,-4634.25"/>
</g>
<!-- tp_comm_attn_gpu23_l12 -->
<g id="node413" class="node">
<title>tp_comm_attn_gpu23_l12</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-4498.3" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-4512.3" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L12)</text>
<text text-anchor="middle" x="895" y="-4501.3" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-4490.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-4479.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l12&#45;&gt;tp_comm_attn_gpu23_l12 -->
<g id="edge494" class="edge">
<title>attn_qkv_3_l12&#45;&gt;tp_comm_attn_gpu23_l12</title>
<path fill="none" stroke="black" d="M788.08,-4571.89C802.63,-4562.01 819.69,-4550.43 835.85,-4539.46"/>
<polygon fill="black" stroke="black" points="837.9,-4542.3 844.2,-4533.79 833.96,-4536.51 837.9,-4542.3"/>
</g>
<!-- attn_qkv_4_l12&#45;&gt;tp_comm_attn_gpu23_l12 -->
<g id="edge495" class="edge">
<title>attn_qkv_4_l12&#45;&gt;tp_comm_attn_gpu23_l12</title>
<path fill="none" stroke="black" d="M1001.92,-4571.89C987.37,-4562.01 970.31,-4550.43 954.15,-4539.46"/>
<polygon fill="black" stroke="black" points="956.04,-4536.51 945.8,-4533.79 952.1,-4542.3 956.04,-4536.51"/>
</g>
<!-- attn_out_3_l12 -->
<g id="node414" class="node">
<title>attn_out_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-4424.53 623.5,-4424.53 623.5,-4372.53 886.5,-4372.53 886.5,-4424.53"/>
<text text-anchor="middle" x="755" y="-4412.53" font-family="Arial" font-size="10.00">Attention Output (L12)</text>
<text text-anchor="middle" x="755" y="-4401.53" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-4390.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-4379.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l12&#45;&gt;attn_out_3_l12 -->
<g id="edge496" class="edge">
<title>tp_comm_attn_gpu23_l12&#45;&gt;attn_out_3_l12</title>
<path fill="none" stroke="black" d="M845.25,-4462.55C830.27,-4452.09 813.93,-4440.69 799.33,-4430.49"/>
<polygon fill="black" stroke="black" points="801.16,-4427.5 790.96,-4424.64 797.15,-4433.24 801.16,-4427.5"/>
</g>
<!-- attn_out_4_l12 -->
<g id="node415" class="node">
<title>attn_out_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-4424.53 904.5,-4424.53 904.5,-4372.53 1167.5,-4372.53 1167.5,-4424.53"/>
<text text-anchor="middle" x="1036" y="-4412.53" font-family="Arial" font-size="10.00">Attention Output (L12)</text>
<text text-anchor="middle" x="1036" y="-4401.53" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-4390.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-4379.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l12&#45;&gt;attn_out_4_l12 -->
<g id="edge497" class="edge">
<title>tp_comm_attn_gpu23_l12&#45;&gt;attn_out_4_l12</title>
<path fill="none" stroke="black" d="M945.11,-4462.55C960.19,-4452.09 976.64,-4440.69 991.35,-4430.49"/>
<polygon fill="black" stroke="black" points="993.56,-4433.22 999.79,-4424.64 989.57,-4427.46 993.56,-4433.22"/>
</g>
<!-- tp_comm_attn_out_gpu23_l12 -->
<g id="node416" class="node">
<title>tp_comm_attn_out_gpu23_l12</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-4298.76" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-4312.76" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L12)</text>
<text text-anchor="middle" x="895" y="-4301.76" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-4290.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-4279.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l12&#45;&gt;tp_comm_attn_out_gpu23_l12 -->
<g id="edge498" class="edge">
<title>attn_out_3_l12&#45;&gt;tp_comm_attn_out_gpu23_l12</title>
<path fill="none" stroke="black" d="M791.05,-4372.35C805.07,-4362.57 821.48,-4351.11 837.06,-4340.22"/>
<polygon fill="black" stroke="black" points="839.42,-4342.84 845.62,-4334.25 835.41,-4337.1 839.42,-4342.84"/>
</g>
<!-- attn_out_4_l12&#45;&gt;tp_comm_attn_out_gpu23_l12 -->
<g id="edge499" class="edge">
<title>attn_out_4_l12&#45;&gt;tp_comm_attn_out_gpu23_l12</title>
<path fill="none" stroke="black" d="M999.69,-4372.35C985.58,-4362.57 969.05,-4351.11 953.35,-4340.22"/>
<polygon fill="black" stroke="black" points="954.95,-4337.07 944.74,-4334.25 950.96,-4342.82 954.95,-4337.07"/>
</g>
<!-- ln1_3_l12 -->
<g id="node422" class="node">
<title>ln1_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="871.5,-4224.99 610.5,-4224.99 610.5,-4172.99 871.5,-4172.99 871.5,-4224.99"/>
<text text-anchor="middle" x="741" y="-4212.99" font-family="Arial" font-size="10.00">LayerNorm1 (L12)</text>
<text text-anchor="middle" x="741" y="-4201.99" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-4190.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="741" y="-4179.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l12&#45;&gt;ln1_3_l12 -->
<g id="edge500" class="edge">
<title>tp_comm_attn_out_gpu23_l12&#45;&gt;ln1_3_l12</title>
<path fill="none" stroke="black" d="M841.14,-4263.57C824.15,-4252.78 805.51,-4240.94 788.96,-4230.44"/>
<polygon fill="black" stroke="black" points="790.83,-4227.48 780.52,-4225.08 787.08,-4233.39 790.83,-4227.48"/>
</g>
<!-- ln1_4_l12 -->
<g id="node423" class="node">
<title>ln1_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1150.5,-4224.99 889.5,-4224.99 889.5,-4172.99 1150.5,-4172.99 1150.5,-4224.99"/>
<text text-anchor="middle" x="1020" y="-4212.99" font-family="Arial" font-size="10.00">LayerNorm1 (L12)</text>
<text text-anchor="middle" x="1020" y="-4201.99" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-4190.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1020" y="-4179.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l12&#45;&gt;ln1_4_l12 -->
<g id="edge501" class="edge">
<title>tp_comm_attn_out_gpu23_l12&#45;&gt;ln1_4_l12</title>
<path fill="none" stroke="black" d="M939.42,-4263.02C952.55,-4252.75 966.84,-4241.57 979.69,-4231.52"/>
<polygon fill="black" stroke="black" points="982.18,-4234.02 987.9,-4225.1 977.86,-4228.51 982.18,-4234.02"/>
</g>
<!-- mlp_fc1_3_l12 -->
<g id="node417" class="node">
<title>mlp_fc1_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="868,-4135.99 614,-4135.99 614,-4083.99 868,-4083.99 868,-4135.99"/>
<text text-anchor="middle" x="741" y="-4123.99" font-family="Arial" font-size="10.00">MLP FC1 (L12)</text>
<text text-anchor="middle" x="741" y="-4112.99" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-4101.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="741" y="-4090.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l12 -->
<g id="node419" class="node">
<title>mlp_fc2_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="871.5,-4046.99 610.5,-4046.99 610.5,-3994.99 871.5,-3994.99 871.5,-4046.99"/>
<text text-anchor="middle" x="741" y="-4034.99" font-family="Arial" font-size="10.00">MLP FC2 (L12)</text>
<text text-anchor="middle" x="741" y="-4023.99" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="741" y="-4012.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="741" y="-4001.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l12&#45;&gt;mlp_fc2_3_l12 -->
<g id="edge504" class="edge">
<title>mlp_fc1_3_l12&#45;&gt;mlp_fc2_3_l12</title>
<path fill="none" stroke="black" d="M741,-4083.83C741,-4075.53 741,-4066.15 741,-4057.24"/>
<polygon fill="black" stroke="black" points="744.5,-4057.1 741,-4047.1 737.5,-4057.1 744.5,-4057.1"/>
</g>
<!-- mlp_fc1_4_l12 -->
<g id="node418" class="node">
<title>mlp_fc1_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1147,-4135.99 893,-4135.99 893,-4083.99 1147,-4083.99 1147,-4135.99"/>
<text text-anchor="middle" x="1020" y="-4123.99" font-family="Arial" font-size="10.00">MLP FC1 (L12)</text>
<text text-anchor="middle" x="1020" y="-4112.99" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-4101.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1020" y="-4090.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l12 -->
<g id="node420" class="node">
<title>mlp_fc2_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1150.5,-4046.99 889.5,-4046.99 889.5,-3994.99 1150.5,-3994.99 1150.5,-4046.99"/>
<text text-anchor="middle" x="1020" y="-4034.99" font-family="Arial" font-size="10.00">MLP FC2 (L12)</text>
<text text-anchor="middle" x="1020" y="-4023.99" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1020" y="-4012.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1020" y="-4001.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l12&#45;&gt;mlp_fc2_4_l12 -->
<g id="edge505" class="edge">
<title>mlp_fc1_4_l12&#45;&gt;mlp_fc2_4_l12</title>
<path fill="none" stroke="black" d="M1020,-4083.83C1020,-4075.53 1020,-4066.15 1020,-4057.24"/>
<polygon fill="black" stroke="black" points="1023.5,-4057.1 1020,-4047.1 1016.5,-4057.1 1023.5,-4057.1"/>
</g>
<!-- tp_comm_mlp_gpu23_l12 -->
<g id="node421" class="node">
<title>tp_comm_mlp_gpu23_l12</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-3921.22" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-3935.22" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L12)</text>
<text text-anchor="middle" x="895" y="-3924.22" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-3913.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-3902.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l12&#45;&gt;tp_comm_mlp_gpu23_l12 -->
<g id="edge506" class="edge">
<title>mlp_fc2_3_l12&#45;&gt;tp_comm_mlp_gpu23_l12</title>
<path fill="none" stroke="black" d="M780.66,-3994.81C796.44,-3984.8 814.97,-3973.03 832.47,-3961.92"/>
<polygon fill="black" stroke="black" points="834.4,-3964.84 840.97,-3956.53 830.65,-3958.93 834.4,-3964.84"/>
</g>
<!-- mlp_fc2_4_l12&#45;&gt;tp_comm_mlp_gpu23_l12 -->
<g id="edge507" class="edge">
<title>mlp_fc2_4_l12&#45;&gt;tp_comm_mlp_gpu23_l12</title>
<path fill="none" stroke="black" d="M987.81,-3994.81C975.59,-3985.26 961.34,-3974.11 947.72,-3963.46"/>
<polygon fill="black" stroke="black" points="949.83,-3960.67 939.8,-3957.26 945.52,-3966.18 949.83,-3960.67"/>
</g>
<!-- ln2_3_l12 -->
<g id="node424" class="node">
<title>ln2_3_l12</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-3847.45 623.5,-3847.45 623.5,-3795.45 884.5,-3795.45 884.5,-3847.45"/>
<text text-anchor="middle" x="754" y="-3835.45" font-family="Arial" font-size="10.00">LayerNorm2 (L12)</text>
<text text-anchor="middle" x="754" y="-3824.45" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-3813.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-3802.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l12&#45;&gt;ln2_3_l12 -->
<g id="edge508" class="edge">
<title>tp_comm_mlp_gpu23_l12&#45;&gt;ln2_3_l12</title>
<path fill="none" stroke="black" d="M845.29,-3885.75C830.18,-3875.27 813.67,-3863.82 798.89,-3853.58"/>
<polygon fill="black" stroke="black" points="800.63,-3850.53 790.42,-3847.7 796.64,-3856.28 800.63,-3850.53"/>
</g>
<!-- ln2_4_l12 -->
<g id="node425" class="node">
<title>ln2_4_l12</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-3847.45 906.5,-3847.45 906.5,-3795.45 1167.5,-3795.45 1167.5,-3847.45"/>
<text text-anchor="middle" x="1037" y="-3835.45" font-family="Arial" font-size="10.00">LayerNorm2 (L12)</text>
<text text-anchor="middle" x="1037" y="-3824.45" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-3813.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-3802.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l12&#45;&gt;ln2_4_l12 -->
<g id="edge509" class="edge">
<title>tp_comm_mlp_gpu23_l12&#45;&gt;ln2_4_l12</title>
<path fill="none" stroke="black" d="M945.06,-3885.75C960.28,-3875.27 976.91,-3863.82 991.79,-3853.58"/>
<polygon fill="black" stroke="black" points="994.07,-3856.26 1000.32,-3847.7 990.1,-3850.49 994.07,-3856.26"/>
</g>
<!-- ln1_3_l12&#45;&gt;mlp_fc1_3_l12 -->
<g id="edge502" class="edge">
<title>ln1_3_l12&#45;&gt;mlp_fc1_3_l12</title>
<path fill="none" stroke="black" d="M741,-4172.83C741,-4164.53 741,-4155.15 741,-4146.24"/>
<polygon fill="black" stroke="black" points="744.5,-4146.1 741,-4136.1 737.5,-4146.1 744.5,-4146.1"/>
</g>
<!-- ln1_4_l12&#45;&gt;mlp_fc1_4_l12 -->
<g id="edge503" class="edge">
<title>ln1_4_l12&#45;&gt;mlp_fc1_4_l12</title>
<path fill="none" stroke="black" d="M1020,-4172.83C1020,-4164.53 1020,-4155.15 1020,-4146.24"/>
<polygon fill="black" stroke="black" points="1023.5,-4146.1 1020,-4136.1 1016.5,-4146.1 1023.5,-4146.1"/>
</g>
<!-- attn_qkv_3_l13 -->
<g id="node426" class="node">
<title>attn_qkv_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="886,-3758.45 616,-3758.45 616,-3706.45 886,-3706.45 886,-3758.45"/>
<text text-anchor="middle" x="751" y="-3746.45" font-family="Arial" font-size="10.00">Attention QKV (L13)</text>
<text text-anchor="middle" x="751" y="-3735.45" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-3724.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-3713.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l12&#45;&gt;attn_qkv_3_l13 -->
<g id="edge510" class="edge">
<title>ln2_3_l12&#45;&gt;attn_qkv_3_l13</title>
<path fill="none" stroke="black" d="M753.13,-3795.29C752.85,-3786.99 752.52,-3777.61 752.22,-3768.7"/>
<polygon fill="black" stroke="black" points="755.71,-3768.43 751.87,-3758.56 748.71,-3768.67 755.71,-3768.43"/>
</g>
<!-- attn_qkv_4_l13 -->
<g id="node427" class="node">
<title>attn_qkv_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1174,-3758.45 904,-3758.45 904,-3706.45 1174,-3706.45 1174,-3758.45"/>
<text text-anchor="middle" x="1039" y="-3746.45" font-family="Arial" font-size="10.00">Attention QKV (L13)</text>
<text text-anchor="middle" x="1039" y="-3735.45" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-3724.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-3713.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l12&#45;&gt;attn_qkv_4_l13 -->
<g id="edge511" class="edge">
<title>ln2_4_l12&#45;&gt;attn_qkv_4_l13</title>
<path fill="none" stroke="black" d="M1037.58,-3795.29C1037.77,-3786.99 1037.98,-3777.61 1038.19,-3768.7"/>
<polygon fill="black" stroke="black" points="1041.69,-3768.64 1038.42,-3758.56 1034.69,-3768.48 1041.69,-3768.64"/>
</g>
<!-- tp_comm_attn_gpu23_l13 -->
<g id="node428" class="node">
<title>tp_comm_attn_gpu23_l13</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-3632.68" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-3646.68" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L13)</text>
<text text-anchor="middle" x="895" y="-3635.68" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-3624.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-3613.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l13&#45;&gt;tp_comm_attn_gpu23_l13 -->
<g id="edge512" class="edge">
<title>attn_qkv_3_l13&#45;&gt;tp_comm_attn_gpu23_l13</title>
<path fill="none" stroke="black" d="M788.08,-3706.27C802.63,-3696.4 819.69,-3684.82 835.85,-3673.84"/>
<polygon fill="black" stroke="black" points="837.9,-3676.68 844.2,-3668.17 833.96,-3670.89 837.9,-3676.68"/>
</g>
<!-- attn_qkv_4_l13&#45;&gt;tp_comm_attn_gpu23_l13 -->
<g id="edge513" class="edge">
<title>attn_qkv_4_l13&#45;&gt;tp_comm_attn_gpu23_l13</title>
<path fill="none" stroke="black" d="M1001.92,-3706.27C987.37,-3696.4 970.31,-3684.82 954.15,-3673.84"/>
<polygon fill="black" stroke="black" points="956.04,-3670.89 945.8,-3668.17 952.1,-3676.68 956.04,-3670.89"/>
</g>
<!-- attn_out_3_l13 -->
<g id="node429" class="node">
<title>attn_out_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-3558.91 623.5,-3558.91 623.5,-3506.91 886.5,-3506.91 886.5,-3558.91"/>
<text text-anchor="middle" x="755" y="-3546.91" font-family="Arial" font-size="10.00">Attention Output (L13)</text>
<text text-anchor="middle" x="755" y="-3535.91" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-3524.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-3513.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l13&#45;&gt;attn_out_3_l13 -->
<g id="edge514" class="edge">
<title>tp_comm_attn_gpu23_l13&#45;&gt;attn_out_3_l13</title>
<path fill="none" stroke="black" d="M845.25,-3596.94C830.27,-3586.48 813.93,-3575.07 799.33,-3564.87"/>
<polygon fill="black" stroke="black" points="801.16,-3561.88 790.96,-3559.02 797.15,-3567.62 801.16,-3561.88"/>
</g>
<!-- attn_out_4_l13 -->
<g id="node430" class="node">
<title>attn_out_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-3558.91 904.5,-3558.91 904.5,-3506.91 1167.5,-3506.91 1167.5,-3558.91"/>
<text text-anchor="middle" x="1036" y="-3546.91" font-family="Arial" font-size="10.00">Attention Output (L13)</text>
<text text-anchor="middle" x="1036" y="-3535.91" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-3524.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-3513.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l13&#45;&gt;attn_out_4_l13 -->
<g id="edge515" class="edge">
<title>tp_comm_attn_gpu23_l13&#45;&gt;attn_out_4_l13</title>
<path fill="none" stroke="black" d="M945.11,-3596.94C960.19,-3586.48 976.64,-3575.07 991.35,-3564.87"/>
<polygon fill="black" stroke="black" points="993.56,-3567.6 999.79,-3559.02 989.57,-3561.85 993.56,-3567.6"/>
</g>
<!-- tp_comm_attn_out_gpu23_l13 -->
<g id="node431" class="node">
<title>tp_comm_attn_out_gpu23_l13</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-3433.14" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-3447.14" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L13)</text>
<text text-anchor="middle" x="895" y="-3436.14" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-3425.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-3414.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l13&#45;&gt;tp_comm_attn_out_gpu23_l13 -->
<g id="edge516" class="edge">
<title>attn_out_3_l13&#45;&gt;tp_comm_attn_out_gpu23_l13</title>
<path fill="none" stroke="black" d="M791.05,-3506.73C805.07,-3496.95 821.48,-3485.49 837.06,-3474.61"/>
<polygon fill="black" stroke="black" points="839.42,-3477.23 845.62,-3468.63 835.41,-3471.49 839.42,-3477.23"/>
</g>
<!-- attn_out_4_l13&#45;&gt;tp_comm_attn_out_gpu23_l13 -->
<g id="edge517" class="edge">
<title>attn_out_4_l13&#45;&gt;tp_comm_attn_out_gpu23_l13</title>
<path fill="none" stroke="black" d="M999.69,-3506.73C985.58,-3496.95 969.05,-3485.49 953.35,-3474.61"/>
<polygon fill="black" stroke="black" points="954.95,-3471.45 944.74,-3468.63 950.96,-3477.21 954.95,-3471.45"/>
</g>
<!-- ln1_3_l13 -->
<g id="node437" class="node">
<title>ln1_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-3359.37 624.5,-3359.37 624.5,-3307.37 885.5,-3307.37 885.5,-3359.37"/>
<text text-anchor="middle" x="755" y="-3347.37" font-family="Arial" font-size="10.00">LayerNorm1 (L13)</text>
<text text-anchor="middle" x="755" y="-3336.37" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-3325.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-3314.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l13&#45;&gt;ln1_3_l13 -->
<g id="edge518" class="edge">
<title>tp_comm_attn_out_gpu23_l13&#45;&gt;ln1_3_l13</title>
<path fill="none" stroke="black" d="M845.64,-3397.67C830.64,-3387.2 814.24,-3375.75 799.57,-3365.5"/>
<polygon fill="black" stroke="black" points="801.36,-3362.48 791.16,-3359.63 797.35,-3368.22 801.36,-3362.48"/>
</g>
<!-- ln1_4_l13 -->
<g id="node438" class="node">
<title>ln1_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-3359.37 903.5,-3359.37 903.5,-3307.37 1164.5,-3307.37 1164.5,-3359.37"/>
<text text-anchor="middle" x="1034" y="-3347.37" font-family="Arial" font-size="10.00">LayerNorm1 (L13)</text>
<text text-anchor="middle" x="1034" y="-3336.37" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-3325.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-3314.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l13&#45;&gt;ln1_4_l13 -->
<g id="edge519" class="edge">
<title>tp_comm_attn_out_gpu23_l13&#45;&gt;ln1_4_l13</title>
<path fill="none" stroke="black" d="M944.01,-3397.67C958.9,-3387.2 975.18,-3375.75 989.75,-3365.5"/>
<polygon fill="black" stroke="black" points="991.93,-3368.24 998.1,-3359.63 987.91,-3362.52 991.93,-3368.24"/>
</g>
<!-- mlp_fc1_3_l13 -->
<g id="node432" class="node">
<title>mlp_fc1_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="882,-3270.37 628,-3270.37 628,-3218.37 882,-3218.37 882,-3270.37"/>
<text text-anchor="middle" x="755" y="-3258.37" font-family="Arial" font-size="10.00">MLP FC1 (L13)</text>
<text text-anchor="middle" x="755" y="-3247.37" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-3236.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-3225.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l13 -->
<g id="node434" class="node">
<title>mlp_fc2_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-3181.37 624.5,-3181.37 624.5,-3129.37 885.5,-3129.37 885.5,-3181.37"/>
<text text-anchor="middle" x="755" y="-3169.37" font-family="Arial" font-size="10.00">MLP FC2 (L13)</text>
<text text-anchor="middle" x="755" y="-3158.37" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-3147.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-3136.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l13&#45;&gt;mlp_fc2_3_l13 -->
<g id="edge522" class="edge">
<title>mlp_fc1_3_l13&#45;&gt;mlp_fc2_3_l13</title>
<path fill="none" stroke="black" d="M755,-3218.21C755,-3209.91 755,-3200.53 755,-3191.62"/>
<polygon fill="black" stroke="black" points="758.5,-3191.48 755,-3181.48 751.5,-3191.48 758.5,-3191.48"/>
</g>
<!-- mlp_fc1_4_l13 -->
<g id="node433" class="node">
<title>mlp_fc1_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1161,-3270.37 907,-3270.37 907,-3218.37 1161,-3218.37 1161,-3270.37"/>
<text text-anchor="middle" x="1034" y="-3258.37" font-family="Arial" font-size="10.00">MLP FC1 (L13)</text>
<text text-anchor="middle" x="1034" y="-3247.37" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-3236.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-3225.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l13 -->
<g id="node435" class="node">
<title>mlp_fc2_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-3181.37 903.5,-3181.37 903.5,-3129.37 1164.5,-3129.37 1164.5,-3181.37"/>
<text text-anchor="middle" x="1034" y="-3169.37" font-family="Arial" font-size="10.00">MLP FC2 (L13)</text>
<text text-anchor="middle" x="1034" y="-3158.37" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-3147.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-3136.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l13&#45;&gt;mlp_fc2_4_l13 -->
<g id="edge523" class="edge">
<title>mlp_fc1_4_l13&#45;&gt;mlp_fc2_4_l13</title>
<path fill="none" stroke="black" d="M1034,-3218.21C1034,-3209.91 1034,-3200.53 1034,-3191.62"/>
<polygon fill="black" stroke="black" points="1037.5,-3191.48 1034,-3181.48 1030.5,-3191.48 1037.5,-3191.48"/>
</g>
<!-- tp_comm_mlp_gpu23_l13 -->
<g id="node436" class="node">
<title>tp_comm_mlp_gpu23_l13</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-3055.6" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-3069.6" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L13)</text>
<text text-anchor="middle" x="895" y="-3058.6" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-3047.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-3036.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l13&#45;&gt;tp_comm_mlp_gpu23_l13 -->
<g id="edge524" class="edge">
<title>mlp_fc2_3_l13&#45;&gt;tp_comm_mlp_gpu23_l13</title>
<path fill="none" stroke="black" d="M791.05,-3129.2C805.07,-3119.41 821.48,-3107.95 837.06,-3097.07"/>
<polygon fill="black" stroke="black" points="839.42,-3099.69 845.62,-3091.09 835.41,-3093.95 839.42,-3099.69"/>
</g>
<!-- mlp_fc2_4_l13&#45;&gt;tp_comm_mlp_gpu23_l13 -->
<g id="edge525" class="edge">
<title>mlp_fc2_4_l13&#45;&gt;tp_comm_mlp_gpu23_l13</title>
<path fill="none" stroke="black" d="M998.2,-3129.2C984.29,-3119.41 968,-3107.95 952.52,-3097.07"/>
<polygon fill="black" stroke="black" points="954.23,-3093.98 944.03,-3091.09 950.2,-3099.71 954.23,-3093.98"/>
</g>
<!-- ln2_3_l13 -->
<g id="node439" class="node">
<title>ln2_3_l13</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-2981.83 623.5,-2981.83 623.5,-2929.83 884.5,-2929.83 884.5,-2981.83"/>
<text text-anchor="middle" x="754" y="-2969.83" font-family="Arial" font-size="10.00">LayerNorm2 (L13)</text>
<text text-anchor="middle" x="754" y="-2958.83" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-2947.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-2936.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l13&#45;&gt;ln2_3_l13 -->
<g id="edge526" class="edge">
<title>tp_comm_mlp_gpu23_l13&#45;&gt;ln2_3_l13</title>
<path fill="none" stroke="black" d="M845.29,-3020.13C830.18,-3009.66 813.67,-2998.21 798.89,-2987.96"/>
<polygon fill="black" stroke="black" points="800.63,-2984.91 790.42,-2982.09 796.64,-2990.66 800.63,-2984.91"/>
</g>
<!-- ln2_4_l13 -->
<g id="node440" class="node">
<title>ln2_4_l13</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-2981.83 906.5,-2981.83 906.5,-2929.83 1167.5,-2929.83 1167.5,-2981.83"/>
<text text-anchor="middle" x="1037" y="-2969.83" font-family="Arial" font-size="10.00">LayerNorm2 (L13)</text>
<text text-anchor="middle" x="1037" y="-2958.83" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-2947.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-2936.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l13&#45;&gt;ln2_4_l13 -->
<g id="edge527" class="edge">
<title>tp_comm_mlp_gpu23_l13&#45;&gt;ln2_4_l13</title>
<path fill="none" stroke="black" d="M945.06,-3020.13C960.28,-3009.66 976.91,-2998.21 991.79,-2987.96"/>
<polygon fill="black" stroke="black" points="994.07,-2990.64 1000.32,-2982.09 990.1,-2984.87 994.07,-2990.64"/>
</g>
<!-- ln1_3_l13&#45;&gt;mlp_fc1_3_l13 -->
<g id="edge520" class="edge">
<title>ln1_3_l13&#45;&gt;mlp_fc1_3_l13</title>
<path fill="none" stroke="black" d="M755,-3307.21C755,-3298.91 755,-3289.53 755,-3280.62"/>
<polygon fill="black" stroke="black" points="758.5,-3280.48 755,-3270.48 751.5,-3280.48 758.5,-3280.48"/>
</g>
<!-- ln1_4_l13&#45;&gt;mlp_fc1_4_l13 -->
<g id="edge521" class="edge">
<title>ln1_4_l13&#45;&gt;mlp_fc1_4_l13</title>
<path fill="none" stroke="black" d="M1034,-3307.21C1034,-3298.91 1034,-3289.53 1034,-3280.62"/>
<polygon fill="black" stroke="black" points="1037.5,-3280.48 1034,-3270.48 1030.5,-3280.48 1037.5,-3280.48"/>
</g>
<!-- attn_qkv_3_l14 -->
<g id="node441" class="node">
<title>attn_qkv_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="886,-2892.83 616,-2892.83 616,-2840.83 886,-2840.83 886,-2892.83"/>
<text text-anchor="middle" x="751" y="-2880.83" font-family="Arial" font-size="10.00">Attention QKV (L14)</text>
<text text-anchor="middle" x="751" y="-2869.83" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-2858.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-2847.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l13&#45;&gt;attn_qkv_3_l14 -->
<g id="edge528" class="edge">
<title>ln2_3_l13&#45;&gt;attn_qkv_3_l14</title>
<path fill="none" stroke="black" d="M753.13,-2929.67C752.85,-2921.37 752.52,-2911.99 752.22,-2903.08"/>
<polygon fill="black" stroke="black" points="755.71,-2902.82 751.87,-2892.94 748.71,-2903.06 755.71,-2902.82"/>
</g>
<!-- attn_qkv_4_l14 -->
<g id="node442" class="node">
<title>attn_qkv_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1174,-2892.83 904,-2892.83 904,-2840.83 1174,-2840.83 1174,-2892.83"/>
<text text-anchor="middle" x="1039" y="-2880.83" font-family="Arial" font-size="10.00">Attention QKV (L14)</text>
<text text-anchor="middle" x="1039" y="-2869.83" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-2858.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-2847.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l13&#45;&gt;attn_qkv_4_l14 -->
<g id="edge529" class="edge">
<title>ln2_4_l13&#45;&gt;attn_qkv_4_l14</title>
<path fill="none" stroke="black" d="M1037.58,-2929.67C1037.77,-2921.37 1037.98,-2911.99 1038.19,-2903.08"/>
<polygon fill="black" stroke="black" points="1041.69,-2903.02 1038.42,-2892.94 1034.69,-2902.86 1041.69,-2903.02"/>
</g>
<!-- tp_comm_attn_gpu23_l14 -->
<g id="node443" class="node">
<title>tp_comm_attn_gpu23_l14</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-2767.07" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-2781.07" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L14)</text>
<text text-anchor="middle" x="895" y="-2770.07" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-2759.07" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-2748.07" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l14&#45;&gt;tp_comm_attn_gpu23_l14 -->
<g id="edge530" class="edge">
<title>attn_qkv_3_l14&#45;&gt;tp_comm_attn_gpu23_l14</title>
<path fill="none" stroke="black" d="M788.08,-2840.66C802.63,-2830.78 819.69,-2819.2 835.85,-2808.22"/>
<polygon fill="black" stroke="black" points="837.9,-2811.07 844.2,-2802.55 833.96,-2805.27 837.9,-2811.07"/>
</g>
<!-- attn_qkv_4_l14&#45;&gt;tp_comm_attn_gpu23_l14 -->
<g id="edge531" class="edge">
<title>attn_qkv_4_l14&#45;&gt;tp_comm_attn_gpu23_l14</title>
<path fill="none" stroke="black" d="M1001.92,-2840.66C987.37,-2830.78 970.31,-2819.2 954.15,-2808.22"/>
<polygon fill="black" stroke="black" points="956.04,-2805.27 945.8,-2802.55 952.1,-2811.07 956.04,-2805.27"/>
</g>
<!-- attn_out_3_l14 -->
<g id="node444" class="node">
<title>attn_out_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-2693.3 623.5,-2693.3 623.5,-2641.3 886.5,-2641.3 886.5,-2693.3"/>
<text text-anchor="middle" x="755" y="-2681.3" font-family="Arial" font-size="10.00">Attention Output (L14)</text>
<text text-anchor="middle" x="755" y="-2670.3" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-2659.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-2648.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l14&#45;&gt;attn_out_3_l14 -->
<g id="edge532" class="edge">
<title>tp_comm_attn_gpu23_l14&#45;&gt;attn_out_3_l14</title>
<path fill="none" stroke="black" d="M845.25,-2731.32C830.27,-2720.86 813.93,-2709.45 799.33,-2699.25"/>
<polygon fill="black" stroke="black" points="801.16,-2696.26 790.96,-2693.41 797.15,-2702 801.16,-2696.26"/>
</g>
<!-- attn_out_4_l14 -->
<g id="node445" class="node">
<title>attn_out_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-2693.3 904.5,-2693.3 904.5,-2641.3 1167.5,-2641.3 1167.5,-2693.3"/>
<text text-anchor="middle" x="1036" y="-2681.3" font-family="Arial" font-size="10.00">Attention Output (L14)</text>
<text text-anchor="middle" x="1036" y="-2670.3" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-2659.3" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-2648.3" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l14&#45;&gt;attn_out_4_l14 -->
<g id="edge533" class="edge">
<title>tp_comm_attn_gpu23_l14&#45;&gt;attn_out_4_l14</title>
<path fill="none" stroke="black" d="M945.11,-2731.32C960.19,-2720.86 976.64,-2709.45 991.35,-2699.25"/>
<polygon fill="black" stroke="black" points="993.56,-2701.98 999.79,-2693.41 989.57,-2696.23 993.56,-2701.98"/>
</g>
<!-- tp_comm_attn_out_gpu23_l14 -->
<g id="node446" class="node">
<title>tp_comm_attn_out_gpu23_l14</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-2567.53" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-2581.53" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L14)</text>
<text text-anchor="middle" x="895" y="-2570.53" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-2559.53" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-2548.53" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l14&#45;&gt;tp_comm_attn_out_gpu23_l14 -->
<g id="edge534" class="edge">
<title>attn_out_3_l14&#45;&gt;tp_comm_attn_out_gpu23_l14</title>
<path fill="none" stroke="black" d="M791.05,-2641.12C805.07,-2631.33 821.48,-2619.87 837.06,-2608.99"/>
<polygon fill="black" stroke="black" points="839.42,-2611.61 845.62,-2603.01 835.41,-2605.87 839.42,-2611.61"/>
</g>
<!-- attn_out_4_l14&#45;&gt;tp_comm_attn_out_gpu23_l14 -->
<g id="edge535" class="edge">
<title>attn_out_4_l14&#45;&gt;tp_comm_attn_out_gpu23_l14</title>
<path fill="none" stroke="black" d="M999.69,-2641.12C985.58,-2631.33 969.05,-2619.87 953.35,-2608.99"/>
<polygon fill="black" stroke="black" points="954.95,-2605.84 944.74,-2603.01 950.96,-2611.59 954.95,-2605.84"/>
</g>
<!-- ln1_3_l14 -->
<g id="node452" class="node">
<title>ln1_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-2493.76 624.5,-2493.76 624.5,-2441.76 885.5,-2441.76 885.5,-2493.76"/>
<text text-anchor="middle" x="755" y="-2481.76" font-family="Arial" font-size="10.00">LayerNorm1 (L14)</text>
<text text-anchor="middle" x="755" y="-2470.76" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-2459.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-2448.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l14&#45;&gt;ln1_3_l14 -->
<g id="edge536" class="edge">
<title>tp_comm_attn_out_gpu23_l14&#45;&gt;ln1_3_l14</title>
<path fill="none" stroke="black" d="M845.64,-2532.06C830.64,-2521.58 814.24,-2510.13 799.57,-2499.88"/>
<polygon fill="black" stroke="black" points="801.36,-2496.86 791.16,-2494.01 797.35,-2502.6 801.36,-2496.86"/>
</g>
<!-- ln1_4_l14 -->
<g id="node453" class="node">
<title>ln1_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-2493.76 903.5,-2493.76 903.5,-2441.76 1164.5,-2441.76 1164.5,-2493.76"/>
<text text-anchor="middle" x="1034" y="-2481.76" font-family="Arial" font-size="10.00">LayerNorm1 (L14)</text>
<text text-anchor="middle" x="1034" y="-2470.76" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-2459.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-2448.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l14&#45;&gt;ln1_4_l14 -->
<g id="edge537" class="edge">
<title>tp_comm_attn_out_gpu23_l14&#45;&gt;ln1_4_l14</title>
<path fill="none" stroke="black" d="M944.01,-2532.06C958.9,-2521.58 975.18,-2510.13 989.75,-2499.88"/>
<polygon fill="black" stroke="black" points="991.93,-2502.62 998.1,-2494.01 987.91,-2496.9 991.93,-2502.62"/>
</g>
<!-- mlp_fc1_3_l14 -->
<g id="node447" class="node">
<title>mlp_fc1_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="882,-2404.76 628,-2404.76 628,-2352.76 882,-2352.76 882,-2404.76"/>
<text text-anchor="middle" x="755" y="-2392.76" font-family="Arial" font-size="10.00">MLP FC1 (L14)</text>
<text text-anchor="middle" x="755" y="-2381.76" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-2370.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-2359.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l14 -->
<g id="node449" class="node">
<title>mlp_fc2_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-2315.76 624.5,-2315.76 624.5,-2263.76 885.5,-2263.76 885.5,-2315.76"/>
<text text-anchor="middle" x="755" y="-2303.76" font-family="Arial" font-size="10.00">MLP FC2 (L14)</text>
<text text-anchor="middle" x="755" y="-2292.76" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-2281.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-2270.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l14&#45;&gt;mlp_fc2_3_l14 -->
<g id="edge540" class="edge">
<title>mlp_fc1_3_l14&#45;&gt;mlp_fc2_3_l14</title>
<path fill="none" stroke="black" d="M755,-2352.59C755,-2344.3 755,-2334.91 755,-2326"/>
<polygon fill="black" stroke="black" points="758.5,-2325.86 755,-2315.86 751.5,-2325.86 758.5,-2325.86"/>
</g>
<!-- mlp_fc1_4_l14 -->
<g id="node448" class="node">
<title>mlp_fc1_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1161,-2404.76 907,-2404.76 907,-2352.76 1161,-2352.76 1161,-2404.76"/>
<text text-anchor="middle" x="1034" y="-2392.76" font-family="Arial" font-size="10.00">MLP FC1 (L14)</text>
<text text-anchor="middle" x="1034" y="-2381.76" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-2370.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-2359.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l14 -->
<g id="node450" class="node">
<title>mlp_fc2_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-2315.76 903.5,-2315.76 903.5,-2263.76 1164.5,-2263.76 1164.5,-2315.76"/>
<text text-anchor="middle" x="1034" y="-2303.76" font-family="Arial" font-size="10.00">MLP FC2 (L14)</text>
<text text-anchor="middle" x="1034" y="-2292.76" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-2281.76" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-2270.76" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l14&#45;&gt;mlp_fc2_4_l14 -->
<g id="edge541" class="edge">
<title>mlp_fc1_4_l14&#45;&gt;mlp_fc2_4_l14</title>
<path fill="none" stroke="black" d="M1034,-2352.59C1034,-2344.3 1034,-2334.91 1034,-2326"/>
<polygon fill="black" stroke="black" points="1037.5,-2325.86 1034,-2315.86 1030.5,-2325.86 1037.5,-2325.86"/>
</g>
<!-- tp_comm_mlp_gpu23_l14 -->
<g id="node451" class="node">
<title>tp_comm_mlp_gpu23_l14</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-2189.99" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-2203.99" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L14)</text>
<text text-anchor="middle" x="895" y="-2192.99" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-2181.99" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-2170.99" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l14&#45;&gt;tp_comm_mlp_gpu23_l14 -->
<g id="edge542" class="edge">
<title>mlp_fc2_3_l14&#45;&gt;tp_comm_mlp_gpu23_l14</title>
<path fill="none" stroke="black" d="M791.05,-2263.58C805.07,-2253.79 821.48,-2242.33 837.06,-2231.45"/>
<polygon fill="black" stroke="black" points="839.42,-2234.07 845.62,-2225.48 835.41,-2228.33 839.42,-2234.07"/>
</g>
<!-- mlp_fc2_4_l14&#45;&gt;tp_comm_mlp_gpu23_l14 -->
<g id="edge543" class="edge">
<title>mlp_fc2_4_l14&#45;&gt;tp_comm_mlp_gpu23_l14</title>
<path fill="none" stroke="black" d="M998.2,-2263.58C984.29,-2253.79 968,-2242.33 952.52,-2231.45"/>
<polygon fill="black" stroke="black" points="954.23,-2228.37 944.03,-2225.48 950.2,-2234.09 954.23,-2228.37"/>
</g>
<!-- ln2_3_l14 -->
<g id="node454" class="node">
<title>ln2_3_l14</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-2116.22 623.5,-2116.22 623.5,-2064.22 884.5,-2064.22 884.5,-2116.22"/>
<text text-anchor="middle" x="754" y="-2104.22" font-family="Arial" font-size="10.00">LayerNorm2 (L14)</text>
<text text-anchor="middle" x="754" y="-2093.22" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-2082.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-2071.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l14&#45;&gt;ln2_3_l14 -->
<g id="edge544" class="edge">
<title>tp_comm_mlp_gpu23_l14&#45;&gt;ln2_3_l14</title>
<path fill="none" stroke="black" d="M845.29,-2154.52C830.18,-2144.04 813.67,-2132.59 798.89,-2122.35"/>
<polygon fill="black" stroke="black" points="800.63,-2119.29 790.42,-2116.47 796.64,-2125.04 800.63,-2119.29"/>
</g>
<!-- ln2_4_l14 -->
<g id="node455" class="node">
<title>ln2_4_l14</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-2116.22 906.5,-2116.22 906.5,-2064.22 1167.5,-2064.22 1167.5,-2116.22"/>
<text text-anchor="middle" x="1037" y="-2104.22" font-family="Arial" font-size="10.00">LayerNorm2 (L14)</text>
<text text-anchor="middle" x="1037" y="-2093.22" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-2082.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-2071.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l14&#45;&gt;ln2_4_l14 -->
<g id="edge545" class="edge">
<title>tp_comm_mlp_gpu23_l14&#45;&gt;ln2_4_l14</title>
<path fill="none" stroke="black" d="M945.06,-2154.52C960.28,-2144.04 976.91,-2132.59 991.79,-2122.35"/>
<polygon fill="black" stroke="black" points="994.07,-2125.02 1000.32,-2116.47 990.1,-2119.26 994.07,-2125.02"/>
</g>
<!-- ln1_3_l14&#45;&gt;mlp_fc1_3_l14 -->
<g id="edge538" class="edge">
<title>ln1_3_l14&#45;&gt;mlp_fc1_3_l14</title>
<path fill="none" stroke="black" d="M755,-2441.59C755,-2433.3 755,-2423.91 755,-2415"/>
<polygon fill="black" stroke="black" points="758.5,-2414.86 755,-2404.86 751.5,-2414.86 758.5,-2414.86"/>
</g>
<!-- ln1_4_l14&#45;&gt;mlp_fc1_4_l14 -->
<g id="edge539" class="edge">
<title>ln1_4_l14&#45;&gt;mlp_fc1_4_l14</title>
<path fill="none" stroke="black" d="M1034,-2441.59C1034,-2433.3 1034,-2423.91 1034,-2415"/>
<polygon fill="black" stroke="black" points="1037.5,-2414.86 1034,-2404.86 1030.5,-2414.86 1037.5,-2414.86"/>
</g>
<!-- attn_qkv_3_l15 -->
<g id="node456" class="node">
<title>attn_qkv_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="886,-2027.22 616,-2027.22 616,-1975.22 886,-1975.22 886,-2027.22"/>
<text text-anchor="middle" x="751" y="-2015.22" font-family="Arial" font-size="10.00">Attention QKV (L15)</text>
<text text-anchor="middle" x="751" y="-2004.22" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-1993.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-1982.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l14&#45;&gt;attn_qkv_3_l15 -->
<g id="edge546" class="edge">
<title>ln2_3_l14&#45;&gt;attn_qkv_3_l15</title>
<path fill="none" stroke="black" d="M753.13,-2064.05C752.85,-2055.76 752.52,-2046.37 752.22,-2037.47"/>
<polygon fill="black" stroke="black" points="755.71,-2037.2 751.87,-2027.32 748.71,-2037.44 755.71,-2037.2"/>
</g>
<!-- attn_qkv_4_l15 -->
<g id="node457" class="node">
<title>attn_qkv_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1174,-2027.22 904,-2027.22 904,-1975.22 1174,-1975.22 1174,-2027.22"/>
<text text-anchor="middle" x="1039" y="-2015.22" font-family="Arial" font-size="10.00">Attention QKV (L15)</text>
<text text-anchor="middle" x="1039" y="-2004.22" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-1993.22" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-1982.22" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l14&#45;&gt;attn_qkv_4_l15 -->
<g id="edge547" class="edge">
<title>ln2_4_l14&#45;&gt;attn_qkv_4_l15</title>
<path fill="none" stroke="black" d="M1037.58,-2064.05C1037.77,-2055.76 1037.98,-2046.37 1038.19,-2037.47"/>
<polygon fill="black" stroke="black" points="1041.69,-2037.4 1038.42,-2027.32 1034.69,-2037.24 1041.69,-2037.4"/>
</g>
<!-- tp_comm_attn_gpu23_l15 -->
<g id="node458" class="node">
<title>tp_comm_attn_gpu23_l15</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-1901.45" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-1915.45" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L15)</text>
<text text-anchor="middle" x="895" y="-1904.45" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-1893.45" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-1882.45" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l15&#45;&gt;tp_comm_attn_gpu23_l15 -->
<g id="edge548" class="edge">
<title>attn_qkv_3_l15&#45;&gt;tp_comm_attn_gpu23_l15</title>
<path fill="none" stroke="black" d="M788.08,-1975.04C802.63,-1965.16 819.69,-1953.58 835.85,-1942.61"/>
<polygon fill="black" stroke="black" points="837.9,-1945.45 844.2,-1936.94 833.96,-1939.66 837.9,-1945.45"/>
</g>
<!-- attn_qkv_4_l15&#45;&gt;tp_comm_attn_gpu23_l15 -->
<g id="edge549" class="edge">
<title>attn_qkv_4_l15&#45;&gt;tp_comm_attn_gpu23_l15</title>
<path fill="none" stroke="black" d="M1001.92,-1975.04C987.37,-1965.16 970.31,-1953.58 954.15,-1942.61"/>
<polygon fill="black" stroke="black" points="956.04,-1939.66 945.8,-1936.94 952.1,-1945.45 956.04,-1939.66"/>
</g>
<!-- attn_out_3_l15 -->
<g id="node459" class="node">
<title>attn_out_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-1827.68 623.5,-1827.68 623.5,-1775.68 886.5,-1775.68 886.5,-1827.68"/>
<text text-anchor="middle" x="755" y="-1815.68" font-family="Arial" font-size="10.00">Attention Output (L15)</text>
<text text-anchor="middle" x="755" y="-1804.68" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-1793.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-1782.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l15&#45;&gt;attn_out_3_l15 -->
<g id="edge550" class="edge">
<title>tp_comm_attn_gpu23_l15&#45;&gt;attn_out_3_l15</title>
<path fill="none" stroke="black" d="M845.25,-1865.7C830.27,-1855.24 813.93,-1843.84 799.33,-1833.64"/>
<polygon fill="black" stroke="black" points="801.16,-1830.64 790.96,-1827.79 797.15,-1836.38 801.16,-1830.64"/>
</g>
<!-- attn_out_4_l15 -->
<g id="node460" class="node">
<title>attn_out_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-1827.68 904.5,-1827.68 904.5,-1775.68 1167.5,-1775.68 1167.5,-1827.68"/>
<text text-anchor="middle" x="1036" y="-1815.68" font-family="Arial" font-size="10.00">Attention Output (L15)</text>
<text text-anchor="middle" x="1036" y="-1804.68" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-1793.68" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-1782.68" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l15&#45;&gt;attn_out_4_l15 -->
<g id="edge551" class="edge">
<title>tp_comm_attn_gpu23_l15&#45;&gt;attn_out_4_l15</title>
<path fill="none" stroke="black" d="M945.11,-1865.7C960.19,-1855.24 976.64,-1843.84 991.35,-1833.64"/>
<polygon fill="black" stroke="black" points="993.56,-1836.36 999.79,-1827.79 989.57,-1830.61 993.56,-1836.36"/>
</g>
<!-- tp_comm_attn_out_gpu23_l15 -->
<g id="node461" class="node">
<title>tp_comm_attn_out_gpu23_l15</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-1701.91" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-1715.91" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L15)</text>
<text text-anchor="middle" x="895" y="-1704.91" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-1693.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-1682.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l15&#45;&gt;tp_comm_attn_out_gpu23_l15 -->
<g id="edge552" class="edge">
<title>attn_out_3_l15&#45;&gt;tp_comm_attn_out_gpu23_l15</title>
<path fill="none" stroke="black" d="M791.05,-1775.5C805.07,-1765.71 821.48,-1754.25 837.06,-1743.37"/>
<polygon fill="black" stroke="black" points="839.42,-1745.99 845.62,-1737.4 835.41,-1740.25 839.42,-1745.99"/>
</g>
<!-- attn_out_4_l15&#45;&gt;tp_comm_attn_out_gpu23_l15 -->
<g id="edge553" class="edge">
<title>attn_out_4_l15&#45;&gt;tp_comm_attn_out_gpu23_l15</title>
<path fill="none" stroke="black" d="M999.69,-1775.5C985.58,-1765.71 969.05,-1754.25 953.35,-1743.37"/>
<polygon fill="black" stroke="black" points="954.95,-1740.22 944.74,-1737.4 950.96,-1745.97 954.95,-1740.22"/>
</g>
<!-- ln1_3_l15 -->
<g id="node467" class="node">
<title>ln1_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-1628.14 624.5,-1628.14 624.5,-1576.14 885.5,-1576.14 885.5,-1628.14"/>
<text text-anchor="middle" x="755" y="-1616.14" font-family="Arial" font-size="10.00">LayerNorm1 (L15)</text>
<text text-anchor="middle" x="755" y="-1605.14" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-1594.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-1583.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l15&#45;&gt;ln1_3_l15 -->
<g id="edge554" class="edge">
<title>tp_comm_attn_out_gpu23_l15&#45;&gt;ln1_3_l15</title>
<path fill="none" stroke="black" d="M845.64,-1666.44C830.64,-1655.96 814.24,-1644.51 799.57,-1634.27"/>
<polygon fill="black" stroke="black" points="801.36,-1631.25 791.16,-1628.39 797.35,-1636.99 801.36,-1631.25"/>
</g>
<!-- ln1_4_l15 -->
<g id="node468" class="node">
<title>ln1_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-1628.14 903.5,-1628.14 903.5,-1576.14 1164.5,-1576.14 1164.5,-1628.14"/>
<text text-anchor="middle" x="1034" y="-1616.14" font-family="Arial" font-size="10.00">LayerNorm1 (L15)</text>
<text text-anchor="middle" x="1034" y="-1605.14" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-1594.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-1583.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l15&#45;&gt;ln1_4_l15 -->
<g id="edge555" class="edge">
<title>tp_comm_attn_out_gpu23_l15&#45;&gt;ln1_4_l15</title>
<path fill="none" stroke="black" d="M944.01,-1666.44C958.9,-1655.96 975.18,-1644.51 989.75,-1634.27"/>
<polygon fill="black" stroke="black" points="991.93,-1637.01 998.1,-1628.39 987.91,-1631.28 991.93,-1637.01"/>
</g>
<!-- mlp_fc1_3_l15 -->
<g id="node462" class="node">
<title>mlp_fc1_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="882,-1539.14 628,-1539.14 628,-1487.14 882,-1487.14 882,-1539.14"/>
<text text-anchor="middle" x="755" y="-1527.14" font-family="Arial" font-size="10.00">MLP FC1 (L15)</text>
<text text-anchor="middle" x="755" y="-1516.14" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-1505.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-1494.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l15 -->
<g id="node464" class="node">
<title>mlp_fc2_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-1450.14 624.5,-1450.14 624.5,-1398.14 885.5,-1398.14 885.5,-1450.14"/>
<text text-anchor="middle" x="755" y="-1438.14" font-family="Arial" font-size="10.00">MLP FC2 (L15)</text>
<text text-anchor="middle" x="755" y="-1427.14" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-1416.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-1405.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l15&#45;&gt;mlp_fc2_3_l15 -->
<g id="edge558" class="edge">
<title>mlp_fc1_3_l15&#45;&gt;mlp_fc2_3_l15</title>
<path fill="none" stroke="black" d="M755,-1486.98C755,-1478.68 755,-1469.29 755,-1460.39"/>
<polygon fill="black" stroke="black" points="758.5,-1460.25 755,-1450.25 751.5,-1460.25 758.5,-1460.25"/>
</g>
<!-- mlp_fc1_4_l15 -->
<g id="node463" class="node">
<title>mlp_fc1_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1161,-1539.14 907,-1539.14 907,-1487.14 1161,-1487.14 1161,-1539.14"/>
<text text-anchor="middle" x="1034" y="-1527.14" font-family="Arial" font-size="10.00">MLP FC1 (L15)</text>
<text text-anchor="middle" x="1034" y="-1516.14" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-1505.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-1494.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l15 -->
<g id="node465" class="node">
<title>mlp_fc2_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-1450.14 903.5,-1450.14 903.5,-1398.14 1164.5,-1398.14 1164.5,-1450.14"/>
<text text-anchor="middle" x="1034" y="-1438.14" font-family="Arial" font-size="10.00">MLP FC2 (L15)</text>
<text text-anchor="middle" x="1034" y="-1427.14" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-1416.14" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-1405.14" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l15&#45;&gt;mlp_fc2_4_l15 -->
<g id="edge559" class="edge">
<title>mlp_fc1_4_l15&#45;&gt;mlp_fc2_4_l15</title>
<path fill="none" stroke="black" d="M1034,-1486.98C1034,-1478.68 1034,-1469.29 1034,-1460.39"/>
<polygon fill="black" stroke="black" points="1037.5,-1460.25 1034,-1450.25 1030.5,-1460.25 1037.5,-1460.25"/>
</g>
<!-- tp_comm_mlp_gpu23_l15 -->
<g id="node466" class="node">
<title>tp_comm_mlp_gpu23_l15</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-1324.37" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-1338.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L15)</text>
<text text-anchor="middle" x="895" y="-1327.37" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-1316.37" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-1305.37" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l15&#45;&gt;tp_comm_mlp_gpu23_l15 -->
<g id="edge560" class="edge">
<title>mlp_fc2_3_l15&#45;&gt;tp_comm_mlp_gpu23_l15</title>
<path fill="none" stroke="black" d="M791.05,-1397.96C805.07,-1388.17 821.48,-1376.72 837.06,-1365.83"/>
<polygon fill="black" stroke="black" points="839.42,-1368.45 845.62,-1359.86 835.41,-1362.71 839.42,-1368.45"/>
</g>
<!-- mlp_fc2_4_l15&#45;&gt;tp_comm_mlp_gpu23_l15 -->
<g id="edge561" class="edge">
<title>mlp_fc2_4_l15&#45;&gt;tp_comm_mlp_gpu23_l15</title>
<path fill="none" stroke="black" d="M998.2,-1397.96C984.29,-1388.17 968,-1376.72 952.52,-1365.83"/>
<polygon fill="black" stroke="black" points="954.23,-1362.75 944.03,-1359.86 950.2,-1368.47 954.23,-1362.75"/>
</g>
<!-- ln2_3_l15 -->
<g id="node469" class="node">
<title>ln2_3_l15</title>
<polygon fill="lightgreen" stroke="black" points="884.5,-1250.6 623.5,-1250.6 623.5,-1198.6 884.5,-1198.6 884.5,-1250.6"/>
<text text-anchor="middle" x="754" y="-1238.6" font-family="Arial" font-size="10.00">LayerNorm2 (L15)</text>
<text text-anchor="middle" x="754" y="-1227.6" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="754" y="-1216.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="754" y="-1205.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l15&#45;&gt;ln2_3_l15 -->
<g id="edge562" class="edge">
<title>tp_comm_mlp_gpu23_l15&#45;&gt;ln2_3_l15</title>
<path fill="none" stroke="black" d="M845.29,-1288.9C830.18,-1278.42 813.67,-1266.97 798.89,-1256.73"/>
<polygon fill="black" stroke="black" points="800.63,-1253.67 790.42,-1250.85 796.64,-1259.43 800.63,-1253.67"/>
</g>
<!-- ln2_4_l15 -->
<g id="node470" class="node">
<title>ln2_4_l15</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-1250.6 906.5,-1250.6 906.5,-1198.6 1167.5,-1198.6 1167.5,-1250.6"/>
<text text-anchor="middle" x="1037" y="-1238.6" font-family="Arial" font-size="10.00">LayerNorm2 (L15)</text>
<text text-anchor="middle" x="1037" y="-1227.6" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1037" y="-1216.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1037" y="-1205.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l15&#45;&gt;ln2_4_l15 -->
<g id="edge563" class="edge">
<title>tp_comm_mlp_gpu23_l15&#45;&gt;ln2_4_l15</title>
<path fill="none" stroke="black" d="M945.06,-1288.9C960.28,-1278.42 976.91,-1266.97 991.79,-1256.73"/>
<polygon fill="black" stroke="black" points="994.07,-1259.41 1000.32,-1250.85 990.1,-1253.64 994.07,-1259.41"/>
</g>
<!-- ln1_3_l15&#45;&gt;mlp_fc1_3_l15 -->
<g id="edge556" class="edge">
<title>ln1_3_l15&#45;&gt;mlp_fc1_3_l15</title>
<path fill="none" stroke="black" d="M755,-1575.98C755,-1567.68 755,-1558.29 755,-1549.39"/>
<polygon fill="black" stroke="black" points="758.5,-1549.25 755,-1539.25 751.5,-1549.25 758.5,-1549.25"/>
</g>
<!-- ln1_4_l15&#45;&gt;mlp_fc1_4_l15 -->
<g id="edge557" class="edge">
<title>ln1_4_l15&#45;&gt;mlp_fc1_4_l15</title>
<path fill="none" stroke="black" d="M1034,-1575.98C1034,-1567.68 1034,-1558.29 1034,-1549.39"/>
<polygon fill="black" stroke="black" points="1037.5,-1549.25 1034,-1539.25 1030.5,-1549.25 1037.5,-1549.25"/>
</g>
<!-- attn_qkv_3_l16 -->
<g id="node471" class="node">
<title>attn_qkv_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="886,-1161.6 616,-1161.6 616,-1109.6 886,-1109.6 886,-1161.6"/>
<text text-anchor="middle" x="751" y="-1149.6" font-family="Arial" font-size="10.00">Attention QKV (L16)</text>
<text text-anchor="middle" x="751" y="-1138.6" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="751" y="-1127.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="751" y="-1116.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_3_l15&#45;&gt;attn_qkv_3_l16 -->
<g id="edge564" class="edge">
<title>ln2_3_l15&#45;&gt;attn_qkv_3_l16</title>
<path fill="none" stroke="black" d="M753.13,-1198.44C752.85,-1190.14 752.52,-1180.75 752.22,-1171.85"/>
<polygon fill="black" stroke="black" points="755.71,-1171.58 751.87,-1161.71 748.71,-1171.82 755.71,-1171.58"/>
</g>
<!-- attn_qkv_4_l16 -->
<g id="node472" class="node">
<title>attn_qkv_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1174,-1161.6 904,-1161.6 904,-1109.6 1174,-1109.6 1174,-1161.6"/>
<text text-anchor="middle" x="1039" y="-1149.6" font-family="Arial" font-size="10.00">Attention QKV (L16)</text>
<text text-anchor="middle" x="1039" y="-1138.6" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1039" y="-1127.6" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1039" y="-1116.6" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- ln2_4_l15&#45;&gt;attn_qkv_4_l16 -->
<g id="edge565" class="edge">
<title>ln2_4_l15&#45;&gt;attn_qkv_4_l16</title>
<path fill="none" stroke="black" d="M1037.58,-1198.44C1037.77,-1190.14 1037.98,-1180.75 1038.19,-1171.85"/>
<polygon fill="black" stroke="black" points="1041.69,-1171.79 1038.42,-1161.71 1034.69,-1171.62 1041.69,-1171.79"/>
</g>
<!-- tp_comm_attn_gpu23_l16 -->
<g id="node473" class="node">
<title>tp_comm_attn_gpu23_l16</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-1035.83" rx="190.84" ry="36.54"/>
<text text-anchor="middle" x="895" y="-1049.83" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn L16)</text>
<text text-anchor="middle" x="895" y="-1038.83" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-1027.83" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="895" y="-1016.83" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
</g>
<!-- attn_qkv_3_l16&#45;&gt;tp_comm_attn_gpu23_l16 -->
<g id="edge566" class="edge">
<title>attn_qkv_3_l16&#45;&gt;tp_comm_attn_gpu23_l16</title>
<path fill="none" stroke="black" d="M788.08,-1109.42C802.63,-1099.54 819.69,-1087.96 835.85,-1076.99"/>
<polygon fill="black" stroke="black" points="837.9,-1079.83 844.2,-1071.32 833.96,-1074.04 837.9,-1079.83"/>
</g>
<!-- attn_qkv_4_l16&#45;&gt;tp_comm_attn_gpu23_l16 -->
<g id="edge567" class="edge">
<title>attn_qkv_4_l16&#45;&gt;tp_comm_attn_gpu23_l16</title>
<path fill="none" stroke="black" d="M1001.92,-1109.42C987.37,-1099.54 970.31,-1087.96 954.15,-1076.99"/>
<polygon fill="black" stroke="black" points="956.04,-1074.04 945.8,-1071.32 952.1,-1079.83 956.04,-1074.04"/>
</g>
<!-- attn_out_3_l16 -->
<g id="node474" class="node">
<title>attn_out_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="886.5,-962.06 623.5,-962.06 623.5,-910.06 886.5,-910.06 886.5,-962.06"/>
<text text-anchor="middle" x="755" y="-950.06" font-family="Arial" font-size="10.00">Attention Output (L16)</text>
<text text-anchor="middle" x="755" y="-939.06" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-928.06" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="755" y="-917.06" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l16&#45;&gt;attn_out_3_l16 -->
<g id="edge568" class="edge">
<title>tp_comm_attn_gpu23_l16&#45;&gt;attn_out_3_l16</title>
<path fill="none" stroke="black" d="M845.25,-1000.09C830.27,-989.62 813.93,-978.22 799.33,-968.02"/>
<polygon fill="black" stroke="black" points="801.16,-965.03 790.96,-962.17 797.15,-970.77 801.16,-965.03"/>
</g>
<!-- attn_out_4_l16 -->
<g id="node475" class="node">
<title>attn_out_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1167.5,-962.06 904.5,-962.06 904.5,-910.06 1167.5,-910.06 1167.5,-962.06"/>
<text text-anchor="middle" x="1036" y="-950.06" font-family="Arial" font-size="10.00">Attention Output (L16)</text>
<text text-anchor="middle" x="1036" y="-939.06" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1036" y="-928.06" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, heads=8, d_k=32]</text>
<text text-anchor="middle" x="1036" y="-917.06" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_gpu23_l16&#45;&gt;attn_out_4_l16 -->
<g id="edge569" class="edge">
<title>tp_comm_attn_gpu23_l16&#45;&gt;attn_out_4_l16</title>
<path fill="none" stroke="black" d="M945.11,-1000.09C960.19,-989.62 976.64,-978.22 991.35,-968.02"/>
<polygon fill="black" stroke="black" points="993.56,-970.75 999.79,-962.17 989.57,-964.99 993.56,-970.75"/>
</g>
<!-- tp_comm_attn_out_gpu23_l16 -->
<g id="node476" class="node">
<title>tp_comm_attn_out_gpu23_l16</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-836.29" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-850.29" font-family="Arial" font-size="10.00">TP All&#45;Reduce (Attn Out L16)</text>
<text text-anchor="middle" x="895" y="-839.29" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-828.29" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-817.29" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- attn_out_3_l16&#45;&gt;tp_comm_attn_out_gpu23_l16 -->
<g id="edge570" class="edge">
<title>attn_out_3_l16&#45;&gt;tp_comm_attn_out_gpu23_l16</title>
<path fill="none" stroke="black" d="M791.05,-909.88C805.07,-900.1 821.48,-888.64 837.06,-877.75"/>
<polygon fill="black" stroke="black" points="839.42,-880.37 845.62,-871.78 835.41,-874.64 839.42,-880.37"/>
</g>
<!-- attn_out_4_l16&#45;&gt;tp_comm_attn_out_gpu23_l16 -->
<g id="edge571" class="edge">
<title>attn_out_4_l16&#45;&gt;tp_comm_attn_out_gpu23_l16</title>
<path fill="none" stroke="black" d="M999.69,-909.88C985.58,-900.1 969.05,-888.64 953.35,-877.75"/>
<polygon fill="black" stroke="black" points="954.95,-874.6 944.74,-871.78 950.96,-880.35 954.95,-874.6"/>
</g>
<!-- ln1_3_l16 -->
<g id="node482" class="node">
<title>ln1_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-762.52 624.5,-762.52 624.5,-710.52 885.5,-710.52 885.5,-762.52"/>
<text text-anchor="middle" x="755" y="-750.52" font-family="Arial" font-size="10.00">LayerNorm1 (L16)</text>
<text text-anchor="middle" x="755" y="-739.52" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-728.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-717.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l16&#45;&gt;ln1_3_l16 -->
<g id="edge572" class="edge">
<title>tp_comm_attn_out_gpu23_l16&#45;&gt;ln1_3_l16</title>
<path fill="none" stroke="black" d="M845.64,-800.82C830.64,-790.34 814.24,-778.89 799.57,-768.65"/>
<polygon fill="black" stroke="black" points="801.36,-765.63 791.16,-762.77 797.35,-771.37 801.36,-765.63"/>
</g>
<!-- ln1_4_l16 -->
<g id="node483" class="node">
<title>ln1_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-762.52 903.5,-762.52 903.5,-710.52 1164.5,-710.52 1164.5,-762.52"/>
<text text-anchor="middle" x="1034" y="-750.52" font-family="Arial" font-size="10.00">LayerNorm1 (L16)</text>
<text text-anchor="middle" x="1034" y="-739.52" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-728.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-717.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_attn_out_gpu23_l16&#45;&gt;ln1_4_l16 -->
<g id="edge573" class="edge">
<title>tp_comm_attn_out_gpu23_l16&#45;&gt;ln1_4_l16</title>
<path fill="none" stroke="black" d="M944.01,-800.82C958.9,-790.34 975.18,-778.89 989.75,-768.65"/>
<polygon fill="black" stroke="black" points="991.93,-771.39 998.1,-762.77 987.91,-765.66 991.93,-771.39"/>
</g>
<!-- mlp_fc1_3_l16 -->
<g id="node477" class="node">
<title>mlp_fc1_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="882,-673.52 628,-673.52 628,-621.52 882,-621.52 882,-673.52"/>
<text text-anchor="middle" x="755" y="-661.52" font-family="Arial" font-size="10.00">MLP FC1 (L16)</text>
<text text-anchor="middle" x="755" y="-650.52" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-639.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="755" y="-628.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_3_l16 -->
<g id="node479" class="node">
<title>mlp_fc2_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-584.52 624.5,-584.52 624.5,-532.52 885.5,-532.52 885.5,-584.52"/>
<text text-anchor="middle" x="755" y="-572.52" font-family="Arial" font-size="10.00">MLP FC2 (L16)</text>
<text text-anchor="middle" x="755" y="-561.52" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-550.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="755" y="-539.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_3_l16&#45;&gt;mlp_fc2_3_l16 -->
<g id="edge576" class="edge">
<title>mlp_fc1_3_l16&#45;&gt;mlp_fc2_3_l16</title>
<path fill="none" stroke="black" d="M755,-621.36C755,-613.06 755,-603.68 755,-594.77"/>
<polygon fill="black" stroke="black" points="758.5,-594.63 755,-584.63 751.5,-594.63 758.5,-594.63"/>
</g>
<!-- mlp_fc1_4_l16 -->
<g id="node478" class="node">
<title>mlp_fc1_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1161,-673.52 907,-673.52 907,-621.52 1161,-621.52 1161,-673.52"/>
<text text-anchor="middle" x="1034" y="-661.52" font-family="Arial" font-size="10.00">MLP FC1 (L16)</text>
<text text-anchor="middle" x="1034" y="-650.52" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-639.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="1034" y="-628.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, hidden=512]</text>
</g>
<!-- mlp_fc2_4_l16 -->
<g id="node480" class="node">
<title>mlp_fc2_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-584.52 903.5,-584.52 903.5,-532.52 1164.5,-532.52 1164.5,-584.52"/>
<text text-anchor="middle" x="1034" y="-572.52" font-family="Arial" font-size="10.00">MLP FC2 (L16)</text>
<text text-anchor="middle" x="1034" y="-561.52" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-550.52" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-539.52" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc1_4_l16&#45;&gt;mlp_fc2_4_l16 -->
<g id="edge577" class="edge">
<title>mlp_fc1_4_l16&#45;&gt;mlp_fc2_4_l16</title>
<path fill="none" stroke="black" d="M1034,-621.36C1034,-613.06 1034,-603.68 1034,-594.77"/>
<polygon fill="black" stroke="black" points="1037.5,-594.63 1034,-584.63 1030.5,-594.63 1037.5,-594.63"/>
</g>
<!-- tp_comm_mlp_gpu23_l16 -->
<g id="node481" class="node">
<title>tp_comm_mlp_gpu23_l16</title>
<ellipse fill="lightblue" stroke="black" cx="895" cy="-458.75" rx="184.61" ry="36.54"/>
<text text-anchor="middle" x="895" y="-472.75" font-family="Arial" font-size="10.00">TP All&#45;Reduce (MLP L16)</text>
<text text-anchor="middle" x="895" y="-461.75" font-family="Arial" font-size="10.00">GPU2 &lt;&#45;&gt; GPU3</text>
<text text-anchor="middle" x="895" y="-450.75" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="895" y="-439.75" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- mlp_fc2_3_l16&#45;&gt;tp_comm_mlp_gpu23_l16 -->
<g id="edge578" class="edge">
<title>mlp_fc2_3_l16&#45;&gt;tp_comm_mlp_gpu23_l16</title>
<path fill="none" stroke="black" d="M791.05,-532.34C805.07,-522.56 821.48,-511.1 837.06,-500.21"/>
<polygon fill="black" stroke="black" points="839.42,-502.84 845.62,-494.24 835.41,-497.1 839.42,-502.84"/>
</g>
<!-- mlp_fc2_4_l16&#45;&gt;tp_comm_mlp_gpu23_l16 -->
<g id="edge579" class="edge">
<title>mlp_fc2_4_l16&#45;&gt;tp_comm_mlp_gpu23_l16</title>
<path fill="none" stroke="black" d="M998.2,-532.34C984.29,-522.56 968,-511.1 952.52,-500.21"/>
<polygon fill="black" stroke="black" points="954.23,-497.13 944.03,-494.24 950.2,-502.86 954.23,-497.13"/>
</g>
<!-- ln2_3_l16 -->
<g id="node484" class="node">
<title>ln2_3_l16</title>
<polygon fill="lightgreen" stroke="black" points="885.5,-384.98 624.5,-384.98 624.5,-332.98 885.5,-332.98 885.5,-384.98"/>
<text text-anchor="middle" x="755" y="-372.98" font-family="Arial" font-size="10.00">LayerNorm2 (L16)</text>
<text text-anchor="middle" x="755" y="-361.98" font-family="Arial" font-size="10.00">GPU2</text>
<text text-anchor="middle" x="755" y="-350.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="755" y="-339.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l16&#45;&gt;ln2_3_l16 -->
<g id="edge580" class="edge">
<title>tp_comm_mlp_gpu23_l16&#45;&gt;ln2_3_l16</title>
<path fill="none" stroke="black" d="M845.64,-423.28C830.64,-412.8 814.24,-401.36 799.57,-391.11"/>
<polygon fill="black" stroke="black" points="801.36,-388.09 791.16,-385.23 797.35,-393.83 801.36,-388.09"/>
</g>
<!-- ln2_4_l16 -->
<g id="node485" class="node">
<title>ln2_4_l16</title>
<polygon fill="lightgreen" stroke="black" points="1164.5,-384.98 903.5,-384.98 903.5,-332.98 1164.5,-332.98 1164.5,-384.98"/>
<text text-anchor="middle" x="1034" y="-372.98" font-family="Arial" font-size="10.00">LayerNorm2 (L16)</text>
<text text-anchor="middle" x="1034" y="-361.98" font-family="Arial" font-size="10.00">GPU3</text>
<text text-anchor="middle" x="1034" y="-350.98" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=256]</text>
<text text-anchor="middle" x="1034" y="-339.98" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=5120, token_dim=256]</text>
</g>
<!-- tp_comm_mlp_gpu23_l16&#45;&gt;ln2_4_l16 -->
<g id="edge581" class="edge">
<title>tp_comm_mlp_gpu23_l16&#45;&gt;ln2_4_l16</title>
<path fill="none" stroke="black" d="M944.01,-423.28C958.9,-412.8 975.18,-401.36 989.75,-391.11"/>
<polygon fill="black" stroke="black" points="991.93,-393.85 998.1,-385.23 987.91,-388.12 991.93,-393.85"/>
</g>
<!-- ln1_3_l16&#45;&gt;mlp_fc1_3_l16 -->
<g id="edge574" class="edge">
<title>ln1_3_l16&#45;&gt;mlp_fc1_3_l16</title>
<path fill="none" stroke="black" d="M755,-710.36C755,-702.06 755,-692.68 755,-683.77"/>
<polygon fill="black" stroke="black" points="758.5,-683.63 755,-673.63 751.5,-683.63 758.5,-683.63"/>
</g>
<!-- ln1_4_l16&#45;&gt;mlp_fc1_4_l16 -->
<g id="edge575" class="edge">
<title>ln1_4_l16&#45;&gt;mlp_fc1_4_l16</title>
<path fill="none" stroke="black" d="M1034,-710.36C1034,-702.06 1034,-692.68 1034,-683.77"/>
<polygon fill="black" stroke="black" points="1037.5,-683.63 1034,-673.63 1030.5,-683.63 1037.5,-683.63"/>
</g>
<!-- sp_merge_2 -->
<g id="node486" class="node">
<title>sp_merge_2</title>
<polygon fill="lightyellow" stroke="black" points="1161.55,-295.98 723.21,-295.98 610.45,-213.98 1048.79,-213.98 1161.55,-295.98"/>
<text text-anchor="middle" x="886" y="-263.48" font-family="Arial" font-size="10.00">SP Merge (Rep2)</text>
<text text-anchor="middle" x="886" y="-252.48" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=5120, token_dim=512]</text>
<text text-anchor="middle" x="886" y="-241.48" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=10240, token_dim=512]</text>
</g>
<!-- ln2_3_l16&#45;&gt;sp_merge_2 -->
<g id="edge582" class="edge">
<title>ln2_3_l16&#45;&gt;sp_merge_2</title>
<path fill="none" stroke="black" d="M787.38,-332.77C799.29,-323.5 813.18,-312.68 826.71,-302.15"/>
<polygon fill="black" stroke="black" points="828.88,-304.89 834.62,-295.99 824.58,-299.37 828.88,-304.89"/>
</g>
<!-- ln2_4_l16&#45;&gt;sp_merge_2 -->
<g id="edge583" class="edge">
<title>ln2_4_l16&#45;&gt;sp_merge_2</title>
<path fill="none" stroke="black" d="M997.42,-332.77C983.84,-323.41 967.98,-312.48 952.56,-301.85"/>
<polygon fill="black" stroke="black" points="954.27,-298.78 944.05,-295.99 950.3,-304.55 954.27,-298.78"/>
</g>
<!-- sp_merge_2&#45;&gt;dp_merge -->
<g id="edge585" class="edge">
<title>sp_merge_2&#45;&gt;dp_merge</title>
<path fill="none" stroke="black" d="M786.95,-213.88C760.64,-203.23 732.09,-191.67 705.31,-180.83"/>
<polygon fill="black" stroke="black" points="706.51,-177.54 695.92,-177.03 703.88,-184.03 706.51,-177.54"/>
</g>
<!-- output -->
<g id="node488" class="node">
<title>output</title>
<ellipse fill="lightcoral" stroke="black" cx="597" cy="-28.99" rx="192.17" ry="28.98"/>
<text text-anchor="middle" x="597" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="597" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, token_dim=512]</text>
<text text-anchor="middle" x="597" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, token_dim=512]</text>
</g>
<!-- dp_merge&#45;&gt;output -->
<g id="edge586" class="edge">
<title>dp_merge&#45;&gt;output</title>
<path fill="none" stroke="black" d="M597,-94.69C597,-86.06 597,-76.96 597,-68.4"/>
<polygon fill="black" stroke="black" points="600.5,-68.29 597,-58.29 593.5,-68.29 600.5,-68.29"/>
</g>
</g>
</svg>
