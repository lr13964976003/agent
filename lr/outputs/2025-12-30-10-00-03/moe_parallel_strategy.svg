<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Parallel_Strategy Pages: 1 -->
<svg width="4832pt" height="1448pt"
 viewBox="0.00 0.00 4832.00 1447.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1443.86)">
<title>MoE_Parallel_Strategy</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1443.86 4828,-1443.86 4828,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_replica0</title>
<polygon fill="white" stroke="black" stroke-dasharray="5,2" points="8,-84.98 8,-1250.9 4422,-1250.9 4422,-84.98 8,-84.98"/>
<text text-anchor="middle" x="2215" y="-1235.7" font-family="Arial" font-size="14.00">Replica 0 (DP=0)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pipeline</title>
<polygon fill="white" stroke="black" points="16,-92.98 16,-1134.91 4414,-1134.91 4414,-92.98 16,-92.98"/>
<text text-anchor="middle" x="2215" y="-1119.71" font-family="Arial" font-size="14.00">Pipeline Stage (PP=1)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1</title>
<path fill="white" stroke="black" d="M36,-187.97C36,-187.97 4394,-187.97 4394,-187.97 4400,-187.97 4406,-193.97 4406,-199.97 4406,-199.97 4406,-1091.91 4406,-1091.91 4406,-1097.91 4400,-1103.91 4394,-1103.91 4394,-1103.91 36,-1103.91 36,-1103.91 30,-1103.91 24,-1097.91 24,-1091.91 24,-1091.91 24,-199.97 24,-199.97 24,-193.97 30,-187.97 36,-187.97"/>
<text text-anchor="middle" x="2215" y="-1088.71" font-family="Arial" font-size="14.00">Layer 1 (GPU 0&#45;3)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_replica1</title>
<polygon fill="white" stroke="black" stroke-dasharray="5,2" points="4430,-1012.91 4430,-1250.9 4816,-1250.9 4816,-1012.91 4430,-1012.91"/>
<text text-anchor="middle" x="4623" y="-1235.7" font-family="Arial" font-size="14.00">Replica 1 (DP=1)</text>
</g>
<!-- Request -->
<g id="node1" class="node">
<title>Request</title>
<ellipse fill="lightgreen" stroke="black" cx="4459" cy="-1410.87" rx="137.36" ry="28.98"/>
<text text-anchor="middle" x="4459" y="-1419.37" font-family="Arial" font-size="10.00">Request</text>
<text text-anchor="middle" x="4459" y="-1408.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024]</text>
<text text-anchor="middle" x="4459" y="-1397.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024]</text>
</g>
<!-- DP_Split -->
<g id="node2" class="node">
<title>DP_Split</title>
<ellipse fill="yellow" stroke="black" cx="4459" cy="-1306.89" rx="132.87" ry="28.98"/>
<text text-anchor="middle" x="4459" y="-1315.39" font-family="Arial" font-size="10.00">DP Split</text>
<text text-anchor="middle" x="4459" y="-1304.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024]</text>
<text text-anchor="middle" x="4459" y="-1293.39" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024]</text>
</g>
<!-- Request&#45;&gt;DP_Split -->
<g id="edge1" class="edge">
<title>Request&#45;&gt;DP_Split</title>
<path fill="none" stroke="black" d="M4459,-1381.73C4459,-1370.7 4459,-1357.86 4459,-1346.02"/>
<polygon fill="black" stroke="black" points="4462.5,-1345.93 4459,-1335.93 4455.5,-1345.93 4462.5,-1345.93"/>
<text text-anchor="middle" x="4471" y="-1356.68" font-family="Arial" font-size="9.00">DP=2</text>
</g>
<!-- Input_R0 -->
<g id="node3" class="node">
<title>Input_R0</title>
<ellipse fill="lightgreen" stroke="black" cx="4226" cy="-1190.91" rx="184.61" ry="28.98"/>
<text text-anchor="middle" x="4226" y="-1199.41" font-family="Arial" font-size="10.00">Input R0</text>
<text text-anchor="middle" x="4226" y="-1188.41" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024]</text>
<text text-anchor="middle" x="4226" y="-1177.41" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- DP_Split&#45;&gt;Input_R0 -->
<g id="edge49" class="edge">
<title>DP_Split&#45;&gt;Input_R0</title>
<path fill="none" stroke="black" d="M4406.42,-1280.17C4371.9,-1263.28 4326.53,-1241.08 4289.93,-1223.18"/>
<polygon fill="black" stroke="black" points="4291.34,-1219.97 4280.82,-1218.72 4288.26,-1226.26 4291.34,-1219.97"/>
</g>
<!-- Input_R1 -->
<g id="node36" class="node">
<title>Input_R1</title>
<ellipse fill="lightgreen" stroke="black" cx="4623" cy="-1190.91" rx="184.61" ry="28.98"/>
<text text-anchor="middle" x="4623" y="-1199.41" font-family="Arial" font-size="10.00">Input R1</text>
<text text-anchor="middle" x="4623" y="-1188.41" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024]</text>
<text text-anchor="middle" x="4623" y="-1177.41" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- DP_Split&#45;&gt;Input_R1 -->
<g id="edge50" class="edge">
<title>DP_Split&#45;&gt;Input_R1</title>
<path fill="none" stroke="black" d="M4497.87,-1278.88C4521,-1262.8 4550.53,-1242.27 4575.1,-1225.2"/>
<polygon fill="black" stroke="black" points="4577.35,-1227.9 4583.56,-1219.32 4573.35,-1222.15 4577.35,-1227.9"/>
</g>
<!-- Attention_L1 -->
<g id="node4" class="node">
<title>Attention_L1</title>
<polygon fill="orange" stroke="black" points="3154.5,-1067.41 2879.5,-1067.41 2879.5,-1026.41 3154.5,-1026.41 3154.5,-1067.41"/>
<text text-anchor="middle" x="3017" y="-1055.41" font-family="Arial" font-size="10.00">Attention L1</text>
<text text-anchor="middle" x="3017" y="-1044.41" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3017" y="-1033.41" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=16, d_k=32]</text>
</g>
<!-- Input_R0&#45;&gt;Attention_L1 -->
<g id="edge47" class="edge">
<title>Input_R0&#45;&gt;Attention_L1</title>
<path fill="none" stroke="black" d="M4081.07,-1172.88C3849.51,-1145.69 3398.48,-1092.72 3165,-1065.3"/>
<polygon fill="black" stroke="black" points="3165.07,-1061.78 3154.73,-1064.09 3164.26,-1068.73 3165.07,-1061.78"/>
</g>
<!-- TP_Split_L1 -->
<g id="node5" class="node">
<title>TP_Split_L1</title>
<ellipse fill="yellow" stroke="black" cx="2868" cy="-954.92" rx="164.1" ry="28.98"/>
<text text-anchor="middle" x="2868" y="-963.42" font-family="Arial" font-size="10.00">TP Split L1</text>
<text text-anchor="middle" x="2868" y="-952.42" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=16]</text>
<text text-anchor="middle" x="2868" y="-941.42" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=4]</text>
</g>
<!-- Attention_L1&#45;&gt;TP_Split_L1 -->
<g id="edge2" class="edge">
<title>Attention_L1&#45;&gt;TP_Split_L1</title>
<path fill="none" stroke="black" d="M2984.67,-1026.39C2966.16,-1015.21 2942.48,-1000.91 2921.3,-988.11"/>
<polygon fill="black" stroke="black" points="2923.07,-985.09 2912.7,-982.92 2919.45,-991.09 2923.07,-985.09"/>
</g>
<!-- TP_Sharp_L1_0 -->
<g id="node31" class="node">
<title>TP_Sharp_L1_0</title>
<polygon fill="lightblue" stroke="black" points="2727,-879.93 2641,-879.93 2641,-843.93 2727,-843.93 2727,-879.93"/>
<text text-anchor="middle" x="2684" y="-859.43" font-family="Arial" font-size="10.00">TP_Sharp_L1_0</text>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_0 -->
<g id="edge3" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_0</title>
<path fill="none" stroke="black" d="M2761.49,-932.73C2744.64,-926.47 2728.14,-918.38 2714,-907.93 2707.2,-902.91 2701.48,-895.86 2696.91,-888.82"/>
<polygon fill="black" stroke="black" points="2699.85,-886.91 2691.75,-880.07 2693.82,-890.46 2699.85,-886.91"/>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_0 -->
<g id="edge53" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_0</title>
<path fill="none" stroke="red" stroke-dasharray="1,5" d="M2805.87,-928C2791.65,-921.71 2776.69,-914.81 2763,-907.93 2749.13,-900.97 2734.26,-892.72 2721.21,-885.19"/>
<polygon fill="red" stroke="red" points="2722.9,-882.13 2712.5,-880.13 2719.38,-888.18 2722.9,-882.13"/>
<text text-anchor="middle" x="2777" y="-900.73" font-family="Arial" font-size="9.00">GPU 0</text>
</g>
<!-- TP_Sharp_L1_1 -->
<g id="node32" class="node">
<title>TP_Sharp_L1_1</title>
<polygon fill="lightblue" stroke="black" points="2831,-879.93 2745,-879.93 2745,-843.93 2831,-843.93 2831,-879.93"/>
<text text-anchor="middle" x="2788" y="-859.43" font-family="Arial" font-size="10.00">TP_Sharp_L1_1</text>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_1 -->
<g id="edge4" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_1</title>
<path fill="none" stroke="black" d="M2819.71,-926.94C2812.69,-921.38 2806.12,-915.02 2801,-907.93 2797.13,-902.57 2794.4,-896.06 2792.49,-889.69"/>
<polygon fill="black" stroke="black" points="2795.88,-888.84 2790.1,-879.96 2789.09,-890.51 2795.88,-888.84"/>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_1 -->
<g id="edge54" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_1</title>
<path fill="none" stroke="red" stroke-dasharray="1,5" d="M2843.56,-926.13C2832.81,-913.9 2820.28,-899.65 2809.84,-887.78"/>
<polygon fill="red" stroke="red" points="2812.23,-885.19 2803,-879.99 2806.97,-889.81 2812.23,-885.19"/>
<text text-anchor="middle" x="2839" y="-900.73" font-family="Arial" font-size="9.00">GPU 1</text>
</g>
<!-- TP_Sharp_L1_2 -->
<g id="node33" class="node">
<title>TP_Sharp_L1_2</title>
<polygon fill="lightblue" stroke="black" points="2935,-879.93 2849,-879.93 2849,-843.93 2935,-843.93 2935,-879.93"/>
<text text-anchor="middle" x="2892" y="-859.43" font-family="Arial" font-size="10.00">TP_Sharp_L1_2</text>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_2 -->
<g id="edge5" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_2</title>
<path fill="none" stroke="black" d="M2868.27,-925.87C2868.94,-916.81 2870.32,-906.81 2873,-897.93 2873.89,-894.98 2875.05,-892 2876.35,-889.08"/>
<polygon fill="black" stroke="black" points="2879.49,-890.63 2880.86,-880.12 2873.24,-887.48 2879.49,-890.63"/>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_2 -->
<g id="edge55" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_2</title>
<path fill="none" stroke="red" stroke-dasharray="1,5" d="M2875.46,-925.63C2878.48,-914.21 2881.94,-901.09 2884.91,-889.81"/>
<polygon fill="red" stroke="red" points="2888.31,-890.64 2887.48,-880.07 2881.54,-888.85 2888.31,-890.64"/>
<text text-anchor="middle" x="2896" y="-900.73" font-family="Arial" font-size="9.00">GPU 2</text>
</g>
<!-- TP_Sharp_L1_3 -->
<g id="node34" class="node">
<title>TP_Sharp_L1_3</title>
<polygon fill="lightblue" stroke="black" points="3039,-879.93 2953,-879.93 2953,-843.93 3039,-843.93 3039,-879.93"/>
<text text-anchor="middle" x="2996" y="-859.43" font-family="Arial" font-size="10.00">TP_Sharp_L1_3</text>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_3 -->
<g id="edge6" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_3</title>
<path fill="none" stroke="black" d="M2906.4,-926.62C2924.63,-913.67 2946.17,-898.35 2963.56,-885.99"/>
<polygon fill="black" stroke="black" points="2965.61,-888.83 2971.74,-880.18 2961.56,-883.12 2965.61,-888.83"/>
</g>
<!-- TP_Split_L1&#45;&gt;TP_Sharp_L1_3 -->
<g id="edge56" class="edge">
<title>TP_Split_L1&#45;&gt;TP_Sharp_L1_3</title>
<path fill="none" stroke="red" stroke-dasharray="1,5" d="M2915.43,-926.92C2925.08,-920.96 2935.02,-914.46 2944,-907.93 2952.93,-901.44 2962.19,-893.77 2970.38,-886.61"/>
<polygon fill="red" stroke="red" points="2972.7,-889.23 2977.86,-879.97 2968.06,-884 2972.7,-889.23"/>
<text text-anchor="middle" x="2969" y="-900.73" font-family="Arial" font-size="9.00">GPU 3</text>
</g>
<!-- TP_Shard_L1_0 -->
<g id="node6" class="node">
<title>TP_Shard_L1_0</title>
<polygon fill="lightcoral" stroke="black" points="2816,-1072.91 2584,-1072.91 2584,-1020.91 2816,-1020.91 2816,-1072.91"/>
<text text-anchor="middle" x="2700" y="-1060.91" font-family="Arial" font-size="10.00">TP Shard 0 L1</text>
<text text-anchor="middle" x="2700" y="-1049.91" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2700" y="-1038.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=4]</text>
<text text-anchor="middle" x="2700" y="-1027.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=4]</text>
</g>
<!-- TP_Shard_L1_1 -->
<g id="node7" class="node">
<title>TP_Shard_L1_1</title>
<polygon fill="lightcoral" stroke="black" points="2477,-1072.91 2245,-1072.91 2245,-1020.91 2477,-1020.91 2477,-1072.91"/>
<text text-anchor="middle" x="2361" y="-1060.91" font-family="Arial" font-size="10.00">TP Shard 1 L1</text>
<text text-anchor="middle" x="2361" y="-1049.91" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2361" y="-1038.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=4]</text>
<text text-anchor="middle" x="2361" y="-1027.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=4]</text>
</g>
<!-- TP_Shard_L1_2 -->
<g id="node8" class="node">
<title>TP_Shard_L1_2</title>
<polygon fill="lightcoral" stroke="black" points="2049,-1072.91 1817,-1072.91 1817,-1020.91 2049,-1020.91 2049,-1072.91"/>
<text text-anchor="middle" x="1933" y="-1060.91" font-family="Arial" font-size="10.00">TP Shard 2 L1</text>
<text text-anchor="middle" x="1933" y="-1049.91" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1933" y="-1038.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=4]</text>
<text text-anchor="middle" x="1933" y="-1027.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=4]</text>
</g>
<!-- TP_Shard_L1_3 -->
<g id="node9" class="node">
<title>TP_Shard_L1_3</title>
<polygon fill="lightcoral" stroke="black" points="1442,-1072.91 1210,-1072.91 1210,-1020.91 1442,-1020.91 1442,-1072.91"/>
<text text-anchor="middle" x="1326" y="-1060.91" font-family="Arial" font-size="10.00">TP Shard 3 L1</text>
<text text-anchor="middle" x="1326" y="-1049.91" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="1326" y="-1038.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=4]</text>
<text text-anchor="middle" x="1326" y="-1027.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=4]</text>
</g>
<!-- TP_AllReduce_L1 -->
<g id="node10" class="node">
<title>TP_AllReduce_L1</title>
<ellipse fill="purple" stroke="black" cx="2788" cy="-777.94" rx="167.67" ry="28.98"/>
<text text-anchor="middle" x="2788" y="-786.44" font-family="Arial" font-size="10.00">TP AllReduce L1</text>
<text text-anchor="middle" x="2788" y="-775.44" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, heads=4]×4</text>
<text text-anchor="middle" x="2788" y="-764.44" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, heads=16]</text>
</g>
<!-- MoE_L1 -->
<g id="node11" class="node">
<title>MoE_L1</title>
<polygon fill="lightgreen" stroke="black" points="2327.5,-711.95 2066.5,-711.95 2066.5,-670.95 2327.5,-670.95 2327.5,-711.95"/>
<text text-anchor="middle" x="2197" y="-699.95" font-family="Arial" font-size="10.00">MoE L1</text>
<text text-anchor="middle" x="2197" y="-688.95" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="2197" y="-677.95" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- TP_AllReduce_L1&#45;&gt;MoE_L1 -->
<g id="edge11" class="edge">
<title>TP_AllReduce_L1&#45;&gt;MoE_L1</title>
<path fill="none" stroke="black" d="M2661.58,-758.87C2566.43,-745.26 2436.02,-726.62 2337.59,-712.55"/>
<polygon fill="black" stroke="black" points="2337.96,-709.06 2327.57,-711.11 2336.97,-715.99 2337.96,-709.06"/>
</g>
<!-- Router_L1 -->
<g id="node12" class="node">
<title>Router_L1</title>
<polygon fill="gold" stroke="black" points="2158.17,-633.95 1739.53,-633.95 1631.83,-529.95 2050.47,-529.95 2158.17,-633.95"/>
<text text-anchor="middle" x="1895" y="-595.95" font-family="Arial" font-size="10.00">Router L1</text>
<text text-anchor="middle" x="1895" y="-584.95" font-family="Arial" font-size="10.00">GPU: 0&#45;15</text>
<text text-anchor="middle" x="1895" y="-573.95" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="1895" y="-562.95" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, expert_ids]</text>
</g>
<!-- MoE_L1&#45;&gt;Router_L1 -->
<g id="edge12" class="edge">
<title>MoE_L1&#45;&gt;Router_L1</title>
<path fill="none" stroke="black" d="M2141.96,-670.86C2115.21,-661.33 2081.6,-649.37 2047.87,-637.37"/>
<polygon fill="black" stroke="black" points="2048.96,-634.04 2038.36,-633.98 2046.61,-640.63 2048.96,-634.04"/>
</g>
<!-- Expert_Selection_L1 -->
<g id="node13" class="node">
<title>Expert_Selection_L1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1804" cy="-463.96" rx="181.04" ry="28.98"/>
<text text-anchor="middle" x="1804" y="-472.46" font-family="Arial" font-size="10.00">Expert Selection L1</text>
<text text-anchor="middle" x="1804" y="-461.46" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024]</text>
<text text-anchor="middle" x="1804" y="-450.46" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, top_2_experts]</text>
</g>
<!-- Router_L1&#45;&gt;Expert_Selection_L1 -->
<g id="edge13" class="edge">
<title>Router_L1&#45;&gt;Expert_Selection_L1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1854.82,-529.74C1847.24,-520.07 1839.46,-510.15 1832.33,-501.07"/>
<polygon fill="black" stroke="black" points="1834.93,-498.71 1826,-493 1829.42,-503.03 1834.93,-498.71"/>
</g>
<!-- Expert_L1_0 -->
<g id="node14" class="node">
<title>Expert_L1_0</title>
<polygon fill="lightblue" stroke="black" points="288,-388.97 32,-388.97 32,-336.97 288,-336.97 288,-388.97"/>
<text text-anchor="middle" x="160" y="-376.97" font-family="Arial" font-size="10.00">Expert 0 L1</text>
<text text-anchor="middle" x="160" y="-365.97" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="160" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="160" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_0 -->
<g id="edge14" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_0</title>
<path fill="none" stroke="black" d="M1623.95,-460.82C1303.02,-456.37 644.34,-444.18 416,-416.97 368.03,-411.25 315.68,-401.12 270.9,-391.24"/>
<polygon fill="black" stroke="black" points="271.4,-387.77 260.88,-389 269.88,-394.6 271.4,-387.77"/>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_0 -->
<g id="edge57" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1624.03,-460.77C1378.98,-456.8 926.78,-445.92 542,-416.97 435.91,-408.98 407.08,-405.26 298.37,-389.14"/>
<polygon fill="red" stroke="red" points="298.71,-385.65 288.3,-387.65 297.68,-392.58 298.71,-385.65"/>
<text text-anchor="middle" x="556" y="-409.77" font-family="Arial" font-size="9.00">GPU 4</text>
</g>
<!-- Expert_L1_1 -->
<g id="node15" class="node">
<title>Expert_L1_1</title>
<polygon fill="lightblue" stroke="black" points="562,-388.97 306,-388.97 306,-336.97 562,-336.97 562,-388.97"/>
<text text-anchor="middle" x="434" y="-376.97" font-family="Arial" font-size="10.00">Expert 1 L1</text>
<text text-anchor="middle" x="434" y="-365.97" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="434" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="434" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_1 -->
<g id="edge15" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_1</title>
<path fill="none" stroke="black" d="M1623.67,-461.17C1341.51,-457.5 808.51,-446.75 621,-416.97 586.42,-411.47 549.15,-401.73 517.05,-392.07"/>
<polygon fill="black" stroke="black" points="517.85,-388.66 507.26,-389.09 515.81,-395.35 517.85,-388.66"/>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_1 -->
<g id="edge58" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1625.2,-459.14C1422.94,-453.83 1083.82,-441.88 793,-416.97 697.11,-408.75 670.95,-404.4 572.4,-389.16"/>
<polygon fill="red" stroke="red" points="572.73,-385.67 562.31,-387.6 571.66,-392.59 572.73,-385.67"/>
<text text-anchor="middle" x="807" y="-409.77" font-family="Arial" font-size="9.00">GPU 5</text>
</g>
<!-- Expert_L1_2 -->
<g id="node16" class="node">
<title>Expert_L1_2</title>
<polygon fill="lightblue" stroke="black" points="836,-388.97 580,-388.97 580,-336.97 836,-336.97 836,-388.97"/>
<text text-anchor="middle" x="708" y="-376.97" font-family="Arial" font-size="10.00">Expert 2 L1</text>
<text text-anchor="middle" x="708" y="-365.97" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="708" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="708" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_2 -->
<g id="edge16" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_2</title>
<path fill="none" stroke="black" d="M1624.6,-460.06C1393.7,-455.32 1005.52,-443.59 865,-416.97 836.18,-411.5 805.4,-401.98 778.81,-392.5"/>
<polygon fill="black" stroke="black" points="779.8,-389.14 769.21,-389.02 777.42,-395.72 779.8,-389.14"/>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_2 -->
<g id="edge59" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1627.26,-457.64C1468.09,-451.65 1227.89,-439.64 1020,-416.97 962.28,-410.67 899.05,-400.54 844.7,-390.82"/>
<polygon fill="red" stroke="red" points="845.12,-387.34 834.65,-389.01 843.87,-394.23 845.12,-387.34"/>
<text text-anchor="middle" x="1034" y="-409.77" font-family="Arial" font-size="9.00">GPU 6</text>
</g>
<!-- Expert_L1_3 -->
<g id="node17" class="node">
<title>Expert_L1_3</title>
<polygon fill="lightblue" stroke="black" points="1110,-388.97 854,-388.97 854,-336.97 1110,-336.97 1110,-388.97"/>
<text text-anchor="middle" x="982" y="-376.97" font-family="Arial" font-size="10.00">Expert 3 L1</text>
<text text-anchor="middle" x="982" y="-365.97" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="982" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="982" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_3 -->
<g id="edge17" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_3</title>
<path fill="none" stroke="black" d="M1624.05,-460.54C1442.89,-456.51 1176.58,-445.73 1078,-416.97 1060.58,-411.88 1042.83,-403.24 1027.41,-394.39"/>
<polygon fill="black" stroke="black" points="1029,-391.27 1018.61,-389.19 1025.43,-397.29 1029,-391.27"/>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_3 -->
<g id="edge60" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1647.5,-449.33C1510.84,-436.66 1306.99,-415.92 1120.3,-389.12"/>
<polygon fill="red" stroke="red" points="1120.7,-385.64 1110.3,-387.67 1119.7,-392.56 1120.7,-385.64"/>
<text text-anchor="middle" x="1339" y="-409.77" font-family="Arial" font-size="9.00">GPU 7</text>
</g>
<!-- Expert_L1_4 -->
<g id="node18" class="node">
<title>Expert_L1_4</title>
<polygon fill="lightblue" stroke="black" points="1384,-388.97 1128,-388.97 1128,-336.97 1384,-336.97 1384,-388.97"/>
<text text-anchor="middle" x="1256" y="-376.97" font-family="Arial" font-size="10.00">Expert 4 L1</text>
<text text-anchor="middle" x="1256" y="-365.97" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="1256" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="1256" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_4 -->
<g id="edge18" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_4</title>
<path fill="none" stroke="black" d="M1686.17,-441.82C1606.57,-427.52 1498.79,-408.13 1394.43,-389.22"/>
<polygon fill="black" stroke="black" points="1394.81,-385.74 1384.34,-387.4 1393.56,-392.62 1394.81,-385.74"/>
</g>
<!-- Expert_L1_5 -->
<g id="node19" class="node">
<title>Expert_L1_5</title>
<polygon fill="lightblue" stroke="black" points="1658,-388.97 1402,-388.97 1402,-336.97 1658,-336.97 1658,-388.97"/>
<text text-anchor="middle" x="1530" y="-376.97" font-family="Arial" font-size="10.00">Expert 5 L1</text>
<text text-anchor="middle" x="1530" y="-365.97" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1530" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="1530" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_5 -->
<g id="edge19" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_5</title>
<path fill="none" stroke="black" d="M1732.72,-437.21C1694.87,-423.53 1648.23,-406.68 1609.24,-392.59"/>
<polygon fill="black" stroke="black" points="1610.09,-389.18 1599.5,-389.07 1607.71,-395.76 1610.09,-389.18"/>
</g>
<!-- Expert_L1_6 -->
<g id="node20" class="node">
<title>Expert_L1_6</title>
<polygon fill="lightblue" stroke="black" points="1932,-388.97 1676,-388.97 1676,-336.97 1932,-336.97 1932,-388.97"/>
<text text-anchor="middle" x="1804" y="-376.97" font-family="Arial" font-size="10.00">Expert 6 L1</text>
<text text-anchor="middle" x="1804" y="-365.97" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1804" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="1804" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_6 -->
<g id="edge20" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_6</title>
<path fill="none" stroke="black" d="M1804,-434.85C1804,-423.83 1804,-411.04 1804,-399.39"/>
<polygon fill="black" stroke="black" points="1807.5,-399.1 1804,-389.1 1800.5,-399.1 1807.5,-399.1"/>
</g>
<!-- Expert_L1_7 -->
<g id="node21" class="node">
<title>Expert_L1_7</title>
<polygon fill="lightblue" stroke="black" points="2206,-388.97 1950,-388.97 1950,-336.97 2206,-336.97 2206,-388.97"/>
<text text-anchor="middle" x="2078" y="-376.97" font-family="Arial" font-size="10.00">Expert 7 L1</text>
<text text-anchor="middle" x="2078" y="-365.97" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2078" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="2078" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_7 -->
<g id="edge21" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_7</title>
<path fill="none" stroke="black" d="M1875.28,-437.21C1913.13,-423.53 1959.77,-406.68 1998.76,-392.59"/>
<polygon fill="black" stroke="black" points="2000.29,-395.76 2008.5,-389.07 1997.91,-389.18 2000.29,-395.76"/>
</g>
<!-- Expert_L1_8 -->
<g id="node22" class="node">
<title>Expert_L1_8</title>
<polygon fill="lightblue" stroke="black" points="2480,-388.97 2224,-388.97 2224,-336.97 2480,-336.97 2480,-388.97"/>
<text text-anchor="middle" x="2352" y="-376.97" font-family="Arial" font-size="10.00">Expert 8 L1</text>
<text text-anchor="middle" x="2352" y="-365.97" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2352" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="2352" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_8 -->
<g id="edge22" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_8</title>
<path fill="none" stroke="black" d="M1921.83,-441.82C2001.43,-427.52 2109.21,-408.13 2213.57,-389.22"/>
<polygon fill="black" stroke="black" points="2214.44,-392.62 2223.66,-387.4 2213.19,-385.74 2214.44,-392.62"/>
</g>
<!-- Expert_L1_9 -->
<g id="node23" class="node">
<title>Expert_L1_9</title>
<polygon fill="lightblue" stroke="black" points="2754,-388.97 2498,-388.97 2498,-336.97 2754,-336.97 2754,-388.97"/>
<text text-anchor="middle" x="2626" y="-376.97" font-family="Arial" font-size="10.00">Expert 9 L1</text>
<text text-anchor="middle" x="2626" y="-365.97" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="2626" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="2626" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_9 -->
<g id="edge23" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_9</title>
<path fill="none" stroke="black" d="M1960.5,-449.33C2097.16,-436.66 2301.01,-415.92 2487.7,-389.12"/>
<polygon fill="black" stroke="black" points="2488.3,-392.56 2497.7,-387.67 2487.3,-385.64 2488.3,-392.56"/>
</g>
<!-- Expert_L1_10 -->
<g id="node24" class="node">
<title>Expert_L1_10</title>
<polygon fill="lightblue" stroke="black" points="3028,-388.97 2772,-388.97 2772,-336.97 3028,-336.97 3028,-388.97"/>
<text text-anchor="middle" x="2900" y="-376.97" font-family="Arial" font-size="10.00">Expert 10 L1</text>
<text text-anchor="middle" x="2900" y="-365.97" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="2900" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="2900" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_10 -->
<g id="edge24" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_10</title>
<path fill="none" stroke="black" d="M1976.49,-455.03C2166.64,-445.06 2481.64,-424.9 2761.77,-389.07"/>
<polygon fill="black" stroke="black" points="2762.25,-392.54 2771.72,-387.79 2761.35,-385.6 2762.25,-392.54"/>
</g>
<!-- Expert_L1_11 -->
<g id="node25" class="node">
<title>Expert_L1_11</title>
<polygon fill="lightblue" stroke="black" points="3302,-388.97 3046,-388.97 3046,-336.97 3302,-336.97 3302,-388.97"/>
<text text-anchor="middle" x="3174" y="-376.97" font-family="Arial" font-size="10.00">Expert 11 L1</text>
<text text-anchor="middle" x="3174" y="-365.97" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="3174" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3174" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_11 -->
<g id="edge25" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_11</title>
<path fill="none" stroke="black" d="M1982.5,-459C2220.74,-452.18 2655.77,-434.41 3035.63,-389.07"/>
<polygon fill="black" stroke="black" points="3036.21,-392.53 3045.72,-387.86 3035.38,-385.58 3036.21,-392.53"/>
</g>
<!-- Expert_L1_12 -->
<g id="node26" class="node">
<title>Expert_L1_12</title>
<polygon fill="lightblue" stroke="black" points="3576,-388.97 3320,-388.97 3320,-336.97 3576,-336.97 3576,-388.97"/>
<text text-anchor="middle" x="3448" y="-376.97" font-family="Arial" font-size="10.00">Expert 12 L1</text>
<text text-anchor="middle" x="3448" y="-365.97" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="3448" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3448" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_12 -->
<g id="edge26" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_12</title>
<path fill="none" stroke="black" d="M1984.75,-462.22C2266.37,-459.25 2826.81,-446.07 3309.76,-389.05"/>
<polygon fill="black" stroke="black" points="3310.21,-392.52 3319.73,-387.87 3309.38,-385.57 3310.21,-392.52"/>
</g>
<!-- Expert_L1_13 -->
<g id="node27" class="node">
<title>Expert_L1_13</title>
<polygon fill="lightblue" stroke="black" points="3850,-388.97 3594,-388.97 3594,-336.97 3850,-336.97 3850,-388.97"/>
<text text-anchor="middle" x="3722" y="-376.97" font-family="Arial" font-size="10.00">Expert 13 L1</text>
<text text-anchor="middle" x="3722" y="-365.97" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="3722" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3722" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_13 -->
<g id="edge27" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_13</title>
<path fill="none" stroke="black" d="M1981,-457.8C2229.15,-450.31 2694.57,-435.28 3091,-416.97 3307.35,-406.97 3364.9,-414.73 3583.53,-389.08"/>
<polygon fill="black" stroke="black" points="3584.21,-392.52 3593.73,-387.87 3583.38,-385.57 3584.21,-392.52"/>
</g>
<!-- Expert_L1_14 -->
<g id="node28" class="node">
<title>Expert_L1_14</title>
<polygon fill="lightblue" stroke="black" points="4124,-388.97 3868,-388.97 3868,-336.97 4124,-336.97 4124,-388.97"/>
<text text-anchor="middle" x="3996" y="-376.97" font-family="Arial" font-size="10.00">Expert 14 L1</text>
<text text-anchor="middle" x="3996" y="-365.97" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="3996" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3996" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_14 -->
<g id="edge28" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_14</title>
<path fill="none" stroke="black" d="M1981.44,-458.03C2252.68,-450.32 2786.68,-434.48 3240,-416.97 3511.83,-406.47 3583.62,-419.65 3857.48,-389.07"/>
<polygon fill="black" stroke="black" points="3858.19,-392.51 3867.73,-387.92 3857.4,-385.56 3858.19,-392.51"/>
</g>
<!-- Expert_L1_15 -->
<g id="node29" class="node">
<title>Expert_L1_15</title>
<polygon fill="lightblue" stroke="black" points="4398,-388.97 4142,-388.97 4142,-336.97 4398,-336.97 4398,-388.97"/>
<text text-anchor="middle" x="4270" y="-376.97" font-family="Arial" font-size="10.00">Expert 15 L1</text>
<text text-anchor="middle" x="4270" y="-365.97" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="4270" y="-354.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="4270" y="-343.97" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Selection_L1&#45;&gt;Expert_L1_15 -->
<g id="edge29" class="edge">
<title>Expert_Selection_L1&#45;&gt;Expert_L1_15</title>
<path fill="none" stroke="black" d="M1982.11,-458.72C2283.68,-451.37 2914.06,-435.3 3447,-416.97 3748.69,-406.59 3828.03,-422.31 4131.76,-389.03"/>
<polygon fill="black" stroke="black" points="4132.18,-392.51 4141.73,-387.93 4131.41,-385.55 4132.18,-392.51"/>
</g>
<!-- Expert_Aggregate_L1 -->
<g id="node30" class="node">
<title>Expert_Aggregate_L1</title>
<polygon fill="gold" stroke="black" points="2626.98,-299.97 2189.55,-299.97 2077.02,-195.97 2514.45,-195.97 2626.98,-299.97"/>
<text text-anchor="middle" x="2352" y="-261.97" font-family="Arial" font-size="10.00">Expert Aggregate L1</text>
<text text-anchor="middle" x="2352" y="-250.97" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2352" y="-239.97" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=1024, token_dim=512]×16</text>
<text text-anchor="middle" x="2352" y="-228.97" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_L1_0&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge30" class="edge">
<title>Expert_L1_0&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M288.27,-338.01C291.2,-337.64 294.12,-337.29 297,-336.97 957.42,-262.92 1743.64,-250.03 2123.75,-248.5"/>
<polygon fill="black" stroke="black" points="2123.78,-252 2133.76,-248.47 2123.75,-245 2123.78,-252"/>
</g>
<!-- Expert_L1_1&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge31" class="edge">
<title>Expert_L1_1&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M562.27,-338.03C565.2,-337.65 568.12,-337.3 571,-336.97 1127.4,-272.73 1786.89,-255.34 2125.86,-250.66"/>
<polygon fill="black" stroke="black" points="2126.09,-254.16 2136.04,-250.52 2126,-247.16 2126.09,-254.16"/>
</g>
<!-- Expert_L1_2&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge32" class="edge">
<title>Expert_L1_2&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M836.27,-338.07C839.21,-337.68 842.12,-337.31 845,-336.97 1298.73,-282.53 1833.52,-261.42 2128.44,-253.5"/>
<polygon fill="black" stroke="black" points="2128.93,-256.98 2138.83,-253.22 2128.74,-249.99 2128.93,-256.98"/>
</g>
<!-- Expert_L1_3&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge33" class="edge">
<title>Expert_L1_3&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M1110.28,-338.12C1113.21,-337.71 1116.12,-337.33 1119,-336.97 1472.19,-292.27 1885.39,-268.55 2132.52,-257.39"/>
<polygon fill="black" stroke="black" points="2132.86,-260.88 2142.7,-256.93 2132.55,-253.88 2132.86,-260.88"/>
</g>
<!-- Expert_L1_4&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge34" class="edge">
<title>Expert_L1_4&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M1384.29,-338.2C1387.22,-337.77 1390.13,-337.36 1393,-336.97 1648.22,-302.04 1943.6,-277.28 2138.35,-263.1"/>
<polygon fill="black" stroke="black" points="2138.7,-266.58 2148.42,-262.37 2138.19,-259.6 2138.7,-266.58"/>
</g>
<!-- Expert_L1_5&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge35" class="edge">
<title>Expert_L1_5&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M1658.31,-338.34C1661.23,-337.87 1664.13,-337.41 1667,-336.97 1828.24,-311.91 2011.64,-288.63 2148.07,-272.31"/>
<polygon fill="black" stroke="black" points="2148.7,-275.76 2158.22,-271.1 2147.87,-268.81 2148.7,-275.76"/>
</g>
<!-- Expert_L1_6&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge36" class="edge">
<title>Expert_L1_6&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M1925.28,-336.96C1995.27,-322.53 2084.79,-304.07 2163.75,-287.78"/>
<polygon fill="black" stroke="black" points="2164.73,-291.15 2173.82,-285.71 2163.32,-284.3 2164.73,-291.15"/>
</g>
<!-- Expert_L1_7&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge37" class="edge">
<title>Expert_L1_7&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M2138.81,-336.89C2162.54,-327.1 2190.73,-315.47 2218.72,-303.93"/>
<polygon fill="black" stroke="black" points="2220.29,-307.07 2228.2,-300.02 2217.62,-300.6 2220.29,-307.07"/>
</g>
<!-- Expert_L1_8&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge38" class="edge">
<title>Expert_L1_8&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M2352,-336.89C2352,-328.96 2352,-319.82 2352,-310.5"/>
<polygon fill="black" stroke="black" points="2355.5,-310.37 2352,-300.37 2348.5,-310.37 2355.5,-310.37"/>
</g>
<!-- Expert_L1_9&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge39" class="edge">
<title>Expert_L1_9&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M2565.19,-336.89C2541.46,-327.1 2513.27,-315.47 2485.28,-303.93"/>
<polygon fill="black" stroke="black" points="2486.38,-300.6 2475.8,-300.02 2483.71,-307.07 2486.38,-300.6"/>
</g>
<!-- Expert_L1_10&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge40" class="edge">
<title>Expert_L1_10&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M2778.72,-336.96C2728.63,-326.63 2668.52,-314.23 2609.45,-302.05"/>
<polygon fill="black" stroke="black" points="2610.09,-298.61 2599.59,-300.02 2608.68,-305.47 2610.09,-298.61"/>
</g>
<!-- Expert_L1_11&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge41" class="edge">
<title>Expert_L1_11&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M3045.69,-338.34C3042.77,-337.87 3039.87,-337.41 3037,-336.97 2897.42,-315.28 2741.25,-294.92 2613.31,-279.25"/>
<polygon fill="black" stroke="black" points="2613.72,-275.78 2603.37,-278.04 2612.87,-282.73 2613.72,-275.78"/>
</g>
<!-- Expert_L1_12&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge42" class="edge">
<title>Expert_L1_12&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M3319.71,-338.2C3316.78,-337.77 3313.87,-337.36 3311,-336.97 3070.03,-303.99 2793.26,-280.08 2599.18,-265.57"/>
<polygon fill="black" stroke="black" points="2599.36,-262.08 2589.13,-264.82 2598.84,-269.06 2599.36,-262.08"/>
</g>
<!-- Expert_L1_13&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge43" class="edge">
<title>Expert_L1_13&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M3593.72,-338.12C3590.79,-337.71 3587.88,-337.33 3585,-336.97 3241.26,-293.47 2840.68,-269.83 2591.67,-258.31"/>
<polygon fill="black" stroke="black" points="2591.55,-254.8 2581.4,-257.84 2591.23,-261.79 2591.55,-254.8"/>
</g>
<!-- Expert_L1_14&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge44" class="edge">
<title>Expert_L1_14&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M3867.73,-338.07C3864.79,-337.68 3861.88,-337.31 3859,-336.97 3411,-283.21 2883.96,-261.96 2586.84,-253.8"/>
<polygon fill="black" stroke="black" points="2586.9,-250.3 2576.8,-253.53 2586.71,-257.3 2586.9,-250.3"/>
</g>
<!-- Expert_L1_15&#45;&gt;Expert_Aggregate_L1 -->
<g id="edge45" class="edge">
<title>Expert_L1_15&#45;&gt;Expert_Aggregate_L1</title>
<path fill="none" stroke="black" d="M4141.73,-338.03C4138.8,-337.65 4135.88,-337.3 4133,-336.97 3579.84,-273.11 2924.78,-255.54 2584.08,-250.74"/>
<polygon fill="black" stroke="black" points="2583.89,-247.24 2573.85,-250.6 2583.8,-254.24 2583.89,-247.24"/>
</g>
<!-- Layer1_Output -->
<g id="node35" class="node">
<title>Layer1_Output</title>
<ellipse fill="lightgreen" stroke="black" cx="3584" cy="-129.97" rx="184.61" ry="28.98"/>
<text text-anchor="middle" x="3584" y="-138.47" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="3584" y="-127.47" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="3584" y="-116.47" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- Expert_Aggregate_L1&#45;&gt;Layer1_Output -->
<g id="edge46" class="edge">
<title>Expert_Aggregate_L1&#45;&gt;Layer1_Output</title>
<path fill="none" stroke="black" d="M2549.6,-228.36C2790.35,-205.7 3192.79,-167.81 3418.16,-146.59"/>
<polygon fill="black" stroke="black" points="3418.8,-150.04 3428.42,-145.62 3418.14,-143.07 3418.8,-150.04"/>
</g>
<!-- TP_Sharp_L1_0&#45;&gt;TP_AllReduce_L1 -->
<g id="edge7" class="edge">
<title>TP_Sharp_L1_0&#45;&gt;TP_AllReduce_L1</title>
<path fill="none" stroke="black" d="M2705.8,-843.74C2717.25,-834.71 2731.7,-823.33 2745.27,-812.63"/>
<polygon fill="black" stroke="black" points="2747.44,-815.37 2753.13,-806.43 2743.11,-809.87 2747.44,-815.37"/>
</g>
<!-- TP_Sharp_L1_1&#45;&gt;TP_AllReduce_L1 -->
<g id="edge8" class="edge">
<title>TP_Sharp_L1_1&#45;&gt;TP_AllReduce_L1</title>
<path fill="none" stroke="black" d="M2788,-843.54C2788,-835.82 2788,-826.41 2788,-817.19"/>
<polygon fill="black" stroke="black" points="2791.5,-816.95 2788,-806.95 2784.5,-816.95 2791.5,-816.95"/>
</g>
<!-- TP_Sharp_L1_2&#45;&gt;TP_AllReduce_L1 -->
<g id="edge9" class="edge">
<title>TP_Sharp_L1_2&#45;&gt;TP_AllReduce_L1</title>
<path fill="none" stroke="black" d="M2870.2,-843.74C2858.75,-834.71 2844.3,-823.33 2830.73,-812.63"/>
<polygon fill="black" stroke="black" points="2832.89,-809.87 2822.87,-806.43 2828.56,-815.37 2832.89,-809.87"/>
</g>
<!-- TP_Sharp_L1_3&#45;&gt;TP_AllReduce_L1 -->
<g id="edge10" class="edge">
<title>TP_Sharp_L1_3&#45;&gt;TP_AllReduce_L1</title>
<path fill="none" stroke="black" d="M2952.9,-843.94C2927.03,-833.74 2893.38,-820.48 2863.24,-808.6"/>
<polygon fill="black" stroke="black" points="2864.17,-805.2 2853.59,-804.79 2861.61,-811.72 2864.17,-805.2"/>
</g>
<!-- Final_Output -->
<g id="node38" class="node">
<title>Final_Output</title>
<ellipse fill="lightgreen" stroke="black" cx="3895" cy="-28.99" rx="188.18" ry="28.98"/>
<text text-anchor="middle" x="3895" y="-37.49" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="3895" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]×2</text>
<text text-anchor="middle" x="3895" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, token_dim=512]</text>
</g>
<!-- Layer1_Output&#45;&gt;Final_Output -->
<g id="edge51" class="edge">
<title>Layer1_Output&#45;&gt;Final_Output</title>
<path fill="none" stroke="black" d="M3663.28,-103.74C3706.71,-89.92 3760.67,-72.75 3805.59,-58.45"/>
<polygon fill="black" stroke="black" points="3806.85,-61.72 3815.32,-55.35 3804.73,-55.05 3806.85,-61.72"/>
</g>
<!-- Layer1_R1 -->
<g id="node37" class="node">
<title>Layer1_R1</title>
<polygon fill="lightcyan" stroke="black" points="4726.5,-1072.91 4465.5,-1072.91 4465.5,-1020.91 4726.5,-1020.91 4726.5,-1072.91"/>
<text text-anchor="middle" x="4596" y="-1060.91" font-family="Arial" font-size="10.00">Layer 1 R1</text>
<text text-anchor="middle" x="4596" y="-1049.91" font-family="Arial" font-size="10.00">GPUs: 20&#45;39</text>
<text text-anchor="middle" x="4596" y="-1038.91" font-family="Arial" font-size="10.00">Input: [batch_size=64, seq_len=1024, token_dim=512]</text>
<text text-anchor="middle" x="4596" y="-1027.91" font-family="Arial" font-size="10.00">Output: [batch_size=64, seq_len=1024, token_dim=512]</text>
</g>
<!-- Input_R1&#45;&gt;Layer1_R1 -->
<g id="edge48" class="edge">
<title>Input_R1&#45;&gt;Layer1_R1</title>
<path fill="none" stroke="black" d="M4617.67,-1161.85C4613.36,-1139.22 4607.29,-1107.27 4602.66,-1082.96"/>
<polygon fill="black" stroke="black" points="4606.09,-1082.22 4600.78,-1073.05 4599.21,-1083.53 4606.09,-1082.22"/>
</g>
<!-- Layer1_R1&#45;&gt;Final_Output -->
<g id="edge52" class="edge">
<title>Layer1_R1&#45;&gt;Final_Output</title>
<path fill="none" stroke="black" d="M4547.84,-1020.91C4525.58,-1005.61 4504,-983.63 4504,-955.92 4504,-955.92 4504,-955.92 4504,-128.97 4504,-86.04 4459.15,-97.21 4418,-84.98 4312.76,-53.72 4191,-39.69 4091.45,-33.61"/>
<polygon fill="black" stroke="black" points="4091.47,-30.1 4081.28,-33.01 4091.05,-37.09 4091.47,-30.1"/>
</g>
</g>
</svg>
