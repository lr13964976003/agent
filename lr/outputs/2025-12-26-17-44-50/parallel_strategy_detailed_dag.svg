<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="910pt" height="2880pt"
 viewBox="0.00 0.00 909.67 2880.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.18 0.18) rotate(0) translate(4 16324.96)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-16324.96 5153.64,-16324.96 5153.64,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightcoral" stroke="black" points="2696.32,-16320.96 2482.32,-16320.96 2482.32,-16268.96 2696.32,-16268.96 2696.32,-16320.96"/>
<text text-anchor="middle" x="2589.32" y="-16308.96" font-family="Arial" font-size="10.00">Input Embedding</text>
<text text-anchor="middle" x="2589.32" y="-16297.96" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2589.32" y="-16286.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=512]</text>
<text text-anchor="middle" x="2589.32" y="-16275.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_qkv_gpu0 -->
<g id="node2" class="node">
<title>layer_0_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2354.32,-16232.96 2148.32,-16232.96 2148.32,-16180.96 2354.32,-16180.96 2354.32,-16232.96"/>
<text text-anchor="middle" x="2251.32" y="-16220.96" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2251.32" y="-16209.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2251.32" y="-16198.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2251.32" y="-16187.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2490.65,-16268.86C2449.52,-16258.39 2401.63,-16246.21 2359.55,-16235.5"/>
<polygon fill="black" stroke="black" points="2360.38,-16232.1 2349.82,-16233.03 2358.65,-16238.88 2360.38,-16232.1"/>
</g>
<!-- layer_0_qkv_gpu1 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2580.32,-16232.96 2374.32,-16232.96 2374.32,-16180.96 2580.32,-16180.96 2580.32,-16232.96"/>
<text text-anchor="middle" x="2477.32" y="-16220.96" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2477.32" y="-16209.96" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2477.32" y="-16198.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2477.32" y="-16187.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer_0_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2556.62,-16268.86C2544.65,-16259.67 2530.96,-16249.15 2518.35,-16239.47"/>
<polygon fill="black" stroke="black" points="2520.31,-16236.56 2510.25,-16233.25 2516.05,-16242.12 2520.31,-16236.56"/>
</g>
<!-- layer_0_qkv_gpu2 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2806.32,-16232.96 2600.32,-16232.96 2600.32,-16180.96 2806.32,-16180.96 2806.32,-16232.96"/>
<text text-anchor="middle" x="2703.32" y="-16220.96" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2703.32" y="-16209.96" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2703.32" y="-16198.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2703.32" y="-16187.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer_0_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2622.6,-16268.86C2634.78,-16259.67 2648.73,-16249.15 2661.56,-16239.47"/>
<polygon fill="black" stroke="black" points="2663.93,-16242.07 2669.8,-16233.25 2659.71,-16236.48 2663.93,-16242.07"/>
</g>
<!-- layer_0_qkv_gpu3 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3031.32,-16232.96 2825.32,-16232.96 2825.32,-16180.96 3031.32,-16180.96 3031.32,-16232.96"/>
<text text-anchor="middle" x="2928.32" y="-16220.96" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2928.32" y="-16209.96" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2928.32" y="-16198.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2928.32" y="-16187.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- input&#45;&gt;layer_0_qkv_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer_0_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2688.28,-16268.86C2729.53,-16258.39 2777.56,-16246.21 2819.77,-16235.5"/>
<polygon fill="black" stroke="black" points="2820.69,-16238.88 2829.53,-16233.03 2818.97,-16232.09 2820.69,-16238.88"/>
</g>
<!-- layer_0_attn_gpu0 -->
<g id="node6" class="node">
<title>layer_0_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2349.32,-16144.96 2147.32,-16144.96 2147.32,-16092.96 2349.32,-16092.96 2349.32,-16144.96"/>
<text text-anchor="middle" x="2248.32" y="-16132.96" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2248.32" y="-16121.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2248.32" y="-16110.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2248.32" y="-16099.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_0_qkv_gpu0&#45;&gt;layer_0_attn_gpu0 -->
<g id="edge5" class="edge">
<title>layer_0_qkv_gpu0&#45;&gt;layer_0_attn_gpu0</title>
<path fill="none" stroke="black" d="M2250.44,-16180.63C2250.16,-16172.67 2249.85,-16163.73 2249.55,-16155.21"/>
<polygon fill="black" stroke="black" points="2253.04,-16154.99 2249.2,-16145.12 2246.05,-16155.24 2253.04,-16154.99"/>
</g>
<!-- layer_0_attn_gpu1 -->
<g id="node7" class="node">
<title>layer_0_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2578.32,-16144.96 2376.32,-16144.96 2376.32,-16092.96 2578.32,-16092.96 2578.32,-16144.96"/>
<text text-anchor="middle" x="2477.32" y="-16132.96" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2477.32" y="-16121.96" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2477.32" y="-16110.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2477.32" y="-16099.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_0_qkv_gpu1&#45;&gt;layer_0_attn_gpu1 -->
<g id="edge6" class="edge">
<title>layer_0_qkv_gpu1&#45;&gt;layer_0_attn_gpu1</title>
<path fill="none" stroke="black" d="M2477.32,-16180.63C2477.32,-16172.67 2477.32,-16163.73 2477.32,-16155.21"/>
<polygon fill="black" stroke="black" points="2480.82,-16155.12 2477.32,-16145.12 2473.82,-16155.12 2480.82,-16155.12"/>
</g>
<!-- layer_0_attn_gpu2 -->
<g id="node8" class="node">
<title>layer_0_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2808.32,-16144.96 2606.32,-16144.96 2606.32,-16092.96 2808.32,-16092.96 2808.32,-16144.96"/>
<text text-anchor="middle" x="2707.32" y="-16132.96" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2707.32" y="-16121.96" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2707.32" y="-16110.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2707.32" y="-16099.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_0_qkv_gpu2&#45;&gt;layer_0_attn_gpu2 -->
<g id="edge7" class="edge">
<title>layer_0_qkv_gpu2&#45;&gt;layer_0_attn_gpu2</title>
<path fill="none" stroke="black" d="M2704.5,-16180.63C2704.87,-16172.67 2705.29,-16163.73 2705.68,-16155.21"/>
<polygon fill="black" stroke="black" points="2709.18,-16155.27 2706.15,-16145.12 2702.19,-16154.95 2709.18,-16155.27"/>
</g>
<!-- layer_0_attn_gpu3 -->
<g id="node9" class="node">
<title>layer_0_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3030.32,-16144.96 2828.32,-16144.96 2828.32,-16092.96 3030.32,-16092.96 3030.32,-16144.96"/>
<text text-anchor="middle" x="2929.32" y="-16132.96" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2929.32" y="-16121.96" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2929.32" y="-16110.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2929.32" y="-16099.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_0_qkv_gpu3&#45;&gt;layer_0_attn_gpu3 -->
<g id="edge8" class="edge">
<title>layer_0_qkv_gpu3&#45;&gt;layer_0_attn_gpu3</title>
<path fill="none" stroke="black" d="M2928.62,-16180.63C2928.71,-16172.67 2928.81,-16163.73 2928.91,-16155.21"/>
<polygon fill="black" stroke="black" points="2932.41,-16155.16 2929.03,-16145.12 2925.41,-16155.08 2932.41,-16155.16"/>
</g>
<!-- layer_0_attn_out_gpu0 -->
<g id="node10" class="node">
<title>layer_0_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2351.32,-16056.96 2137.32,-16056.96 2137.32,-16004.96 2351.32,-16004.96 2351.32,-16056.96"/>
<text text-anchor="middle" x="2244.32" y="-16044.96" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2244.32" y="-16033.96" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2244.32" y="-16022.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2244.32" y="-16011.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_attn_gpu0&#45;&gt;layer_0_attn_out_gpu0 -->
<g id="edge9" class="edge">
<title>layer_0_attn_gpu0&#45;&gt;layer_0_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2247.14,-16092.63C2246.77,-16084.67 2246.36,-16075.73 2245.96,-16067.21"/>
<polygon fill="black" stroke="black" points="2249.45,-16066.95 2245.49,-16057.12 2242.46,-16067.27 2249.45,-16066.95"/>
</g>
<!-- layer_0_attn_out_gpu1 -->
<g id="node11" class="node">
<title>layer_0_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2583.32,-16056.96 2369.32,-16056.96 2369.32,-16004.96 2583.32,-16004.96 2583.32,-16056.96"/>
<text text-anchor="middle" x="2476.32" y="-16044.96" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2476.32" y="-16033.96" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2476.32" y="-16022.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2476.32" y="-16011.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_attn_gpu1&#45;&gt;layer_0_attn_out_gpu1 -->
<g id="edge10" class="edge">
<title>layer_0_attn_gpu1&#45;&gt;layer_0_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2477.03,-16092.63C2476.93,-16084.67 2476.83,-16075.73 2476.73,-16067.21"/>
<polygon fill="black" stroke="black" points="2480.23,-16067.08 2476.61,-16057.12 2473.23,-16067.16 2480.23,-16067.08"/>
</g>
<!-- layer_0_attn_out_gpu2 -->
<g id="node12" class="node">
<title>layer_0_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2815.32,-16056.96 2601.32,-16056.96 2601.32,-16004.96 2815.32,-16004.96 2815.32,-16056.96"/>
<text text-anchor="middle" x="2708.32" y="-16044.96" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2708.32" y="-16033.96" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2708.32" y="-16022.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2708.32" y="-16011.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_attn_gpu2&#45;&gt;layer_0_attn_out_gpu2 -->
<g id="edge11" class="edge">
<title>layer_0_attn_gpu2&#45;&gt;layer_0_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2707.62,-16092.63C2707.71,-16084.67 2707.81,-16075.73 2707.91,-16067.21"/>
<polygon fill="black" stroke="black" points="2711.41,-16067.16 2708.03,-16057.12 2704.41,-16067.08 2711.41,-16067.16"/>
</g>
<!-- layer_0_attn_out_gpu3 -->
<g id="node13" class="node">
<title>layer_0_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3047.32,-16056.96 2833.32,-16056.96 2833.32,-16004.96 3047.32,-16004.96 3047.32,-16056.96"/>
<text text-anchor="middle" x="2940.32" y="-16044.96" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2940.32" y="-16033.96" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2940.32" y="-16022.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2940.32" y="-16011.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_attn_gpu3&#45;&gt;layer_0_attn_out_gpu3 -->
<g id="edge12" class="edge">
<title>layer_0_attn_gpu3&#45;&gt;layer_0_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2932.56,-16092.63C2933.58,-16084.67 2934.72,-16075.73 2935.81,-16067.21"/>
<polygon fill="black" stroke="black" points="2939.31,-16067.48 2937.1,-16057.12 2932.36,-16066.6 2939.31,-16067.48"/>
</g>
<!-- layer_0_attn_allreduce -->
<g id="node14" class="node">
<title>layer_0_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2592.32" cy="-15932.19" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2592.32" y="-15946.19" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2592.32" y="-15935.19" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2592.32" y="-15924.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2592.32" y="-15913.19" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_attn_out_gpu0&#45;&gt;layer_0_attn_allreduce -->
<g id="edge13" class="edge">
<title>layer_0_attn_out_gpu0&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2334.39,-16004.92C2380.36,-15992.13 2436.61,-15976.49 2484.84,-15963.08"/>
<polygon fill="black" stroke="black" points="2485.99,-15966.4 2494.69,-15960.34 2484.11,-15959.65 2485.99,-15966.4"/>
</g>
<!-- layer_0_attn_out_gpu1&#45;&gt;layer_0_attn_allreduce -->
<g id="edge14" class="edge">
<title>layer_0_attn_out_gpu1&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2506.5,-16004.79C2517.73,-15995.42 2530.78,-15984.53 2543.26,-15974.12"/>
<polygon fill="black" stroke="black" points="2545.51,-15976.8 2550.94,-15967.71 2541.02,-15971.43 2545.51,-15976.8"/>
</g>
<!-- layer_0_attn_out_gpu2&#45;&gt;layer_0_attn_allreduce -->
<g id="edge15" class="edge">
<title>layer_0_attn_out_gpu2&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2678.15,-16004.79C2666.92,-15995.42 2653.86,-15984.53 2641.38,-15974.12"/>
<polygon fill="black" stroke="black" points="2643.62,-15971.43 2633.7,-15967.71 2639.13,-15976.8 2643.62,-15971.43"/>
</g>
<!-- layer_0_attn_out_gpu3&#45;&gt;layer_0_attn_allreduce -->
<g id="edge16" class="edge">
<title>layer_0_attn_out_gpu3&#45;&gt;layer_0_attn_allreduce</title>
<path fill="none" stroke="black" d="M2850.25,-16004.92C2804.28,-15992.13 2748.03,-15976.49 2699.8,-15963.08"/>
<polygon fill="black" stroke="black" points="2700.53,-15959.65 2689.96,-15960.34 2698.65,-15966.4 2700.53,-15959.65"/>
</g>
<!-- layer_0_gate -->
<g id="node15" class="node">
<title>layer_0_gate</title>
<polygon fill="lightyellow" stroke="black" points="2809.18,-15859.42 2464.2,-15859.42 2375.46,-15755.42 2720.44,-15755.42 2809.18,-15859.42"/>
<text text-anchor="middle" x="2592.32" y="-15821.42" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2592.32" y="-15810.42" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2592.32" y="-15799.42" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2592.32" y="-15788.42" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_gate -->
<g id="edge17" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2573.76,-15895.68C2572.65,-15887.64 2572.08,-15878.87 2572.07,-15870.1"/>
<polygon fill="black" stroke="black" points="2575.58,-15869.92 2572.31,-15859.84 2568.58,-15869.75 2575.58,-15869.92"/>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_gate -->
<g id="edge18" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2586.12,-15895.35C2585.75,-15887.32 2585.57,-15878.57 2585.57,-15869.82"/>
<polygon fill="black" stroke="black" points="2589.07,-15869.62 2585.65,-15859.59 2582.07,-15869.56 2589.07,-15869.62"/>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_gate -->
<g id="edge19" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2598.52,-15895.35C2598.89,-15887.32 2599.07,-15878.57 2599.07,-15869.82"/>
<polygon fill="black" stroke="black" points="2602.57,-15869.56 2598.99,-15859.59 2595.57,-15869.62 2602.57,-15869.56"/>
</g>
<!-- layer_0_attn_allreduce&#45;&gt;layer_0_gate -->
<g id="edge20" class="edge">
<title>layer_0_attn_allreduce&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2610.88,-15895.68C2611.99,-15887.64 2612.56,-15878.87 2612.57,-15870.1"/>
<polygon fill="black" stroke="black" points="2616.06,-15869.75 2612.33,-15859.84 2609.07,-15869.92 2616.06,-15869.75"/>
</g>
<!-- layer_0_all2all_expert_0 -->
<g id="node17" class="node">
<title>layer_0_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="209.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="209.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="209.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="209.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="209.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_0 -->
<g id="edge21" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2416.28,-15803.3C1964.66,-15794.66 772.96,-15767.87 380.32,-15719.42 362.2,-15717.19 343.16,-15714.03 324.61,-15710.5"/>
<polygon fill="black" stroke="black" points="325.16,-15707.04 314.67,-15708.57 323.82,-15713.91 325.16,-15707.04"/>
</g>
<!-- layer_0_all2all_expert_1 -->
<g id="node19" class="node">
<title>layer_0_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="537.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="537.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="537.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="537.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="537.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_1 -->
<g id="edge23" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2415.21,-15802.1C2010.83,-15791.6 1029.32,-15762.43 701.32,-15719.42 684.9,-15717.27 667.68,-15714.31 650.83,-15711.01"/>
<polygon fill="black" stroke="black" points="651.46,-15707.56 640.97,-15709.03 650.08,-15714.43 651.46,-15707.56"/>
</g>
<!-- layer_0_all2all_expert_2 -->
<g id="node21" class="node">
<title>layer_0_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="858.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="858.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="858.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="858.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="858.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_2 -->
<g id="edge25" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2418.49,-15806.14C2127.41,-15803.59 1523.57,-15789.38 1018.32,-15719.42 1002.79,-15717.27 986.54,-15714.39 970.6,-15711.2"/>
<polygon fill="black" stroke="black" points="971.22,-15707.75 960.72,-15709.17 969.81,-15714.61 971.22,-15707.75"/>
</g>
<!-- layer_0_all2all_expert_3 -->
<g id="node23" class="node">
<title>layer_0_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1175.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1175.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1175.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1175.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1175.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_3 -->
<g id="edge27" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2415.62,-15802.67C2171.38,-15795.57 1717.34,-15775.42 1334.32,-15719.42 1319.28,-15717.23 1303.55,-15714.37 1288.08,-15711.24"/>
<polygon fill="black" stroke="black" points="1288.46,-15707.75 1277.96,-15709.14 1287.04,-15714.6 1288.46,-15707.75"/>
</g>
<!-- layer_0_all2all_expert_4 -->
<g id="node25" class="node">
<title>layer_0_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1491.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1491.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1491.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1491.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1491.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_4 -->
<g id="edge29" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2410.67,-15796.73C2220.13,-15784.91 1912.38,-15761.15 1649.32,-15719.42 1634.74,-15717.11 1619.49,-15714.24 1604.47,-15711.14"/>
<polygon fill="black" stroke="black" points="1605.14,-15707.71 1594.63,-15709.08 1603.7,-15714.56 1605.14,-15707.71"/>
</g>
<!-- layer_0_all2all_expert_5 -->
<g id="node27" class="node">
<title>layer_0_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1806.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1806.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1806.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1806.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1806.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_5 -->
<g id="edge31" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.97,-15784.2C2275.09,-15768.7 2109.04,-15746.05 1963.32,-15719.42 1949.47,-15716.89 1934.99,-15713.97 1920.66,-15710.92"/>
<polygon fill="black" stroke="black" points="1921.29,-15707.47 1910.78,-15708.78 1919.82,-15714.31 1921.29,-15707.47"/>
</g>
<!-- layer_0_all2all_expert_6 -->
<g id="node29" class="node">
<title>layer_0_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2120.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2120.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2120.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2120.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2120.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_6 -->
<g id="edge33" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.91,-15755.34C2339.31,-15740.62 2279.59,-15725.08 2230.27,-15712.25"/>
<polygon fill="black" stroke="black" points="2231.1,-15708.85 2220.54,-15709.72 2229.34,-15715.63 2231.1,-15708.85"/>
</g>
<!-- layer_0_all2all_expert_7 -->
<g id="node31" class="node">
<title>layer_0_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2434.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2434.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2434.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2434.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2434.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_7 -->
<g id="edge35" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2526.23,-15755.07C2513.05,-15744.83 2499.38,-15734.21 2486.73,-15724.38"/>
<polygon fill="black" stroke="black" points="2488.63,-15721.42 2478.59,-15718.05 2484.34,-15726.95 2488.63,-15721.42"/>
</g>
<!-- layer_0_all2all_expert_8 -->
<g id="node33" class="node">
<title>layer_0_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2750.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2750.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2750.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2750.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2750.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_8 -->
<g id="edge37" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2658.41,-15755.07C2671.59,-15744.83 2685.26,-15734.21 2697.91,-15724.38"/>
<polygon fill="black" stroke="black" points="2700.3,-15726.95 2706.05,-15718.05 2696.01,-15721.42 2700.3,-15726.95"/>
</g>
<!-- layer_0_all2all_expert_9 -->
<g id="node35" class="node">
<title>layer_0_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3068.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3068.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3068.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3068.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3068.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_9 -->
<g id="edge39" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.2,-15770.09C2804.93,-15751.59 2890.86,-15729.43 2957.74,-15712.17"/>
<polygon fill="black" stroke="black" points="2958.66,-15715.55 2967.47,-15709.67 2956.91,-15708.77 2958.66,-15715.55"/>
</g>
<!-- layer_0_all2all_expert_10 -->
<g id="node37" class="node">
<title>layer_0_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3388.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3388.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3388.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3388.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3388.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_10 -->
<g id="edge41" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2748.94,-15788.41C2877.38,-15772.8 3063.69,-15748.22 3225.32,-15719.42 3240.41,-15716.74 3256.23,-15713.63 3271.82,-15710.4"/>
<polygon fill="black" stroke="black" points="3272.96,-15713.73 3282.03,-15708.25 3271.53,-15706.88 3272.96,-15713.73"/>
</g>
<!-- layer_0_all2all_expert_11 -->
<g id="node39" class="node">
<title>layer_0_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3708.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3708.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3708.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3708.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3708.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_11 -->
<g id="edge43" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.66,-15797.68C2947.19,-15786.09 3270.31,-15761.98 3545.32,-15719.42 3560.97,-15717 3577.37,-15713.98 3593.48,-15710.74"/>
<polygon fill="black" stroke="black" points="3594.37,-15714.13 3603.46,-15708.69 3592.96,-15707.27 3594.37,-15714.13"/>
</g>
<!-- layer_0_all2all_expert_12 -->
<g id="node41" class="node">
<title>layer_0_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4029.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4029.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4029.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4029.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4029.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_12 -->
<g id="edge45" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2760.97,-15802.75C3005.49,-15795.65 3472.21,-15775.42 3865.32,-15719.42 3881.45,-15717.13 3898.35,-15714.13 3914.92,-15710.84"/>
<polygon fill="black" stroke="black" points="3916.08,-15714.18 3925.19,-15708.76 3914.69,-15707.32 3916.08,-15714.18"/>
</g>
<!-- layer_0_all2all_expert_13 -->
<g id="node43" class="node">
<title>layer_0_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4350.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4350.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4350.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4350.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4350.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_13 -->
<g id="edge47" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2763.9,-15806.05C3056.89,-15803.39 3671.89,-15789.11 4186.32,-15719.42 4202.74,-15717.2 4219.95,-15714.2 4236.79,-15710.88"/>
<polygon fill="black" stroke="black" points="4237.55,-15714.3 4246.66,-15708.89 4236.16,-15707.44 4237.55,-15714.3"/>
</g>
<!-- layer_0_all2all_expert_14 -->
<g id="node45" class="node">
<title>layer_0_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4671.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4671.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4671.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4671.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4671.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_14 -->
<g id="edge49" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2760.76,-15802.43C3163.24,-15792.31 4172.17,-15763.27 4507.32,-15719.42 4523.75,-15717.28 4540.96,-15714.32 4557.81,-15711.02"/>
<polygon fill="black" stroke="black" points="4558.56,-15714.43 4567.68,-15709.04 4557.18,-15707.57 4558.56,-15714.43"/>
</g>
<!-- layer_0_all2all_expert_15 -->
<g id="node47" class="node">
<title>layer_0_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4992.32" cy="-15682.65" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4992.32" y="-15696.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4992.32" y="-15685.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4992.32" y="-15674.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4992.32" y="-15663.65" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_all2all_expert_15 -->
<g id="edge51" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2761.66,-15803.69C3211.48,-15795.82 4429.1,-15770.33 4828.32,-15719.42 4844.87,-15717.31 4862.23,-15714.36 4879.19,-15711.04"/>
<polygon fill="black" stroke="black" points="4880.01,-15714.45 4889.13,-15709.05 4878.64,-15707.58 4880.01,-15714.45"/>
</g>
<!-- layer_0_expert_0_gpu0 -->
<g id="node16" class="node">
<title>layer_0_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="289.82,-15609.89 80.82,-15609.89 80.82,-15557.89 289.82,-15557.89 289.82,-15609.89"/>
<text text-anchor="middle" x="185.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="185.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="185.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="185.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_0 -->
<g id="node48" class="node">
<title>layer_0_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="183.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="183.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="183.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="183.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="183.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_0_gpu0&#45;&gt;layer_0_all2all_back_0 -->
<g id="edge53" class="edge">
<title>layer_0_expert_0_gpu0&#45;&gt;layer_0_all2all_back_0</title>
<path fill="none" stroke="black" d="M184.8,-15557.71C184.64,-15549.9 184.46,-15541.04 184.27,-15532.27"/>
<polygon fill="black" stroke="black" points="187.77,-15532.02 184.06,-15522.09 180.77,-15532.16 187.77,-15532.02"/>
</g>
<!-- layer_0_all2all_expert_0&#45;&gt;layer_0_expert_0_gpu0 -->
<g id="edge22" class="edge">
<title>layer_0_all2all_expert_0&#45;&gt;layer_0_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M200.45,-15645.9C198.34,-15637.4 196.1,-15628.34 194,-15619.88"/>
<polygon fill="black" stroke="black" points="197.34,-15618.79 191.53,-15609.93 190.54,-15620.48 197.34,-15618.79"/>
</g>
<!-- layer_0_expert_1_gpu0 -->
<g id="node18" class="node">
<title>layer_0_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="624.82,-15609.89 415.82,-15609.89 415.82,-15557.89 624.82,-15557.89 624.82,-15609.89"/>
<text text-anchor="middle" x="520.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="520.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="520.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="520.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_1 -->
<g id="node49" class="node">
<title>layer_0_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="504.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="504.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="504.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="504.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="504.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_1_gpu0&#45;&gt;layer_0_all2all_back_1 -->
<g id="edge54" class="edge">
<title>layer_0_expert_1_gpu0&#45;&gt;layer_0_all2all_back_1</title>
<path fill="none" stroke="black" d="M516.16,-15557.71C514.85,-15549.82 513.37,-15540.85 511.9,-15531.98"/>
<polygon fill="black" stroke="black" points="515.35,-15531.39 510.27,-15522.09 508.45,-15532.53 515.35,-15531.39"/>
</g>
<!-- layer_0_all2all_expert_1&#45;&gt;layer_0_expert_1_gpu0 -->
<g id="edge24" class="edge">
<title>layer_0_all2all_expert_1&#45;&gt;layer_0_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M531.04,-15645.9C529.55,-15637.4 527.96,-15628.34 526.47,-15619.88"/>
<polygon fill="black" stroke="black" points="529.9,-15619.17 524.72,-15609.93 523,-15620.38 529.9,-15619.17"/>
</g>
<!-- layer_0_expert_2_gpu1 -->
<g id="node20" class="node">
<title>layer_0_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="945.82,-15609.89 736.82,-15609.89 736.82,-15557.89 945.82,-15557.89 945.82,-15609.89"/>
<text text-anchor="middle" x="841.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="841.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="841.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="841.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_2 -->
<g id="node50" class="node">
<title>layer_0_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="825.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="825.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="825.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="825.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="825.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_2_gpu1&#45;&gt;layer_0_all2all_back_2 -->
<g id="edge55" class="edge">
<title>layer_0_expert_2_gpu1&#45;&gt;layer_0_all2all_back_2</title>
<path fill="none" stroke="black" d="M837.16,-15557.71C835.85,-15549.82 834.37,-15540.85 832.9,-15531.98"/>
<polygon fill="black" stroke="black" points="836.35,-15531.39 831.27,-15522.09 829.45,-15532.53 836.35,-15531.39"/>
</g>
<!-- layer_0_all2all_expert_2&#45;&gt;layer_0_expert_2_gpu1 -->
<g id="edge26" class="edge">
<title>layer_0_all2all_expert_2&#45;&gt;layer_0_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M852.04,-15645.9C850.55,-15637.4 848.96,-15628.34 847.47,-15619.88"/>
<polygon fill="black" stroke="black" points="850.9,-15619.17 845.72,-15609.93 844,-15620.38 850.9,-15619.17"/>
</g>
<!-- layer_0_expert_3_gpu1 -->
<g id="node22" class="node">
<title>layer_0_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1264.82,-15609.89 1055.82,-15609.89 1055.82,-15557.89 1264.82,-15557.89 1264.82,-15609.89"/>
<text text-anchor="middle" x="1160.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1160.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1160.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1160.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_3 -->
<g id="node51" class="node">
<title>layer_0_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1146.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1146.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1146.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1146.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1146.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_3_gpu1&#45;&gt;layer_0_all2all_back_3 -->
<g id="edge56" class="edge">
<title>layer_0_expert_3_gpu1&#45;&gt;layer_0_all2all_back_3</title>
<path fill="none" stroke="black" d="M1156.68,-15557.71C1155.55,-15549.9 1154.27,-15541.04 1153,-15532.27"/>
<polygon fill="black" stroke="black" points="1156.42,-15531.49 1151.53,-15522.09 1149.49,-15532.49 1156.42,-15531.49"/>
</g>
<!-- layer_0_all2all_expert_3&#45;&gt;layer_0_expert_3_gpu1 -->
<g id="edge28" class="edge">
<title>layer_0_all2all_expert_3&#45;&gt;layer_0_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1169.78,-15645.9C1168.46,-15637.4 1167.06,-15628.34 1165.75,-15619.88"/>
<polygon fill="black" stroke="black" points="1169.19,-15619.27 1164.2,-15609.93 1162.28,-15620.35 1169.19,-15619.27"/>
</g>
<!-- layer_0_expert_4_gpu2 -->
<g id="node24" class="node">
<title>layer_0_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1585.82,-15609.89 1376.82,-15609.89 1376.82,-15557.89 1585.82,-15557.89 1585.82,-15609.89"/>
<text text-anchor="middle" x="1481.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1481.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1481.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1481.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_4 -->
<g id="node52" class="node">
<title>layer_0_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1467.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1467.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1467.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1467.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1467.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_4_gpu2&#45;&gt;layer_0_all2all_back_4 -->
<g id="edge57" class="edge">
<title>layer_0_expert_4_gpu2&#45;&gt;layer_0_all2all_back_4</title>
<path fill="none" stroke="black" d="M1477.68,-15557.71C1476.55,-15549.9 1475.27,-15541.04 1474,-15532.27"/>
<polygon fill="black" stroke="black" points="1477.42,-15531.49 1472.53,-15522.09 1470.49,-15532.49 1477.42,-15531.49"/>
</g>
<!-- layer_0_all2all_expert_4&#45;&gt;layer_0_expert_4_gpu2 -->
<g id="edge30" class="edge">
<title>layer_0_all2all_expert_4&#45;&gt;layer_0_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1487.63,-15645.9C1486.75,-15637.4 1485.81,-15628.34 1484.94,-15619.88"/>
<polygon fill="black" stroke="black" points="1488.42,-15619.52 1483.91,-15609.93 1481.46,-15620.24 1488.42,-15619.52"/>
</g>
<!-- layer_0_expert_5_gpu2 -->
<g id="node26" class="node">
<title>layer_0_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1903.82,-15609.89 1694.82,-15609.89 1694.82,-15557.89 1903.82,-15557.89 1903.82,-15609.89"/>
<text text-anchor="middle" x="1799.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1799.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1799.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1799.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_5 -->
<g id="node53" class="node">
<title>layer_0_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1788.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1788.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1788.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1788.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1788.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_5_gpu2&#45;&gt;layer_0_all2all_back_5 -->
<g id="edge58" class="edge">
<title>layer_0_expert_5_gpu2&#45;&gt;layer_0_all2all_back_5</title>
<path fill="none" stroke="black" d="M1796.46,-15557.71C1795.57,-15549.9 1794.56,-15541.04 1793.57,-15532.27"/>
<polygon fill="black" stroke="black" points="1797.02,-15531.63 1792.41,-15522.09 1790.06,-15532.42 1797.02,-15531.63"/>
</g>
<!-- layer_0_all2all_expert_5&#45;&gt;layer_0_expert_5_gpu2 -->
<g id="edge32" class="edge">
<title>layer_0_all2all_expert_5&#45;&gt;layer_0_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1803.71,-15645.62C1803.11,-15637.31 1802.47,-15628.48 1801.88,-15620.19"/>
<polygon fill="black" stroke="black" points="1805.36,-15619.8 1801.14,-15610.08 1798.37,-15620.31 1805.36,-15619.8"/>
</g>
<!-- layer_0_expert_6_gpu3 -->
<g id="node28" class="node">
<title>layer_0_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2218.82,-15609.89 2009.82,-15609.89 2009.82,-15557.89 2218.82,-15557.89 2218.82,-15609.89"/>
<text text-anchor="middle" x="2114.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2114.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2114.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2114.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_6 -->
<g id="node54" class="node">
<title>layer_0_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2109.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2109.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2109.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2109.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2109.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_6_gpu3&#45;&gt;layer_0_all2all_back_6 -->
<g id="edge59" class="edge">
<title>layer_0_expert_6_gpu3&#45;&gt;layer_0_all2all_back_6</title>
<path fill="none" stroke="black" d="M2113.02,-15557.71C2112.62,-15549.9 2112.16,-15541.04 2111.71,-15532.27"/>
<polygon fill="black" stroke="black" points="2115.19,-15531.9 2111.18,-15522.09 2108.2,-15532.26 2115.19,-15531.9"/>
</g>
<!-- layer_0_all2all_expert_6&#45;&gt;layer_0_expert_6_gpu3 -->
<g id="edge34" class="edge">
<title>layer_0_all2all_expert_6&#45;&gt;layer_0_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2118.09,-15645.62C2117.57,-15637.31 2117.02,-15628.48 2116.51,-15620.19"/>
<polygon fill="black" stroke="black" points="2120,-15619.85 2115.88,-15610.08 2113.01,-15620.28 2120,-15619.85"/>
</g>
<!-- layer_0_expert_7_gpu3 -->
<g id="node30" class="node">
<title>layer_0_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2535.82,-15609.89 2326.82,-15609.89 2326.82,-15557.89 2535.82,-15557.89 2535.82,-15609.89"/>
<text text-anchor="middle" x="2431.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2431.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2431.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2431.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_7 -->
<g id="node55" class="node">
<title>layer_0_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2430.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2430.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2430.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2430.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2430.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_7_gpu3&#45;&gt;layer_0_all2all_back_7 -->
<g id="edge60" class="edge">
<title>layer_0_expert_7_gpu3&#45;&gt;layer_0_all2all_back_7</title>
<path fill="none" stroke="black" d="M2431.06,-15557.71C2430.98,-15549.9 2430.89,-15541.04 2430.8,-15532.27"/>
<polygon fill="black" stroke="black" points="2434.3,-15532.06 2430.69,-15522.09 2427.3,-15532.13 2434.3,-15532.06"/>
</g>
<!-- layer_0_all2all_expert_7&#45;&gt;layer_0_expert_7_gpu3 -->
<g id="edge36" class="edge">
<title>layer_0_all2all_expert_7&#45;&gt;layer_0_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2433.2,-15645.62C2432.95,-15637.31 2432.67,-15628.48 2432.42,-15620.19"/>
<polygon fill="black" stroke="black" points="2435.91,-15619.97 2432.1,-15610.08 2428.91,-15620.19 2435.91,-15619.97"/>
</g>
<!-- layer_0_expert_8_gpu4 -->
<g id="node32" class="node">
<title>layer_0_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2855.82,-15609.89 2646.82,-15609.89 2646.82,-15557.89 2855.82,-15557.89 2855.82,-15609.89"/>
<text text-anchor="middle" x="2751.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2751.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2751.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2751.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_8 -->
<g id="node56" class="node">
<title>layer_0_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2751.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2751.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2751.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2751.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2751.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_8_gpu4&#45;&gt;layer_0_all2all_back_8 -->
<g id="edge61" class="edge">
<title>layer_0_expert_8_gpu4&#45;&gt;layer_0_all2all_back_8</title>
<path fill="none" stroke="black" d="M2751.32,-15557.71C2751.32,-15549.9 2751.32,-15541.04 2751.32,-15532.27"/>
<polygon fill="black" stroke="black" points="2754.82,-15532.09 2751.32,-15522.09 2747.82,-15532.09 2754.82,-15532.09"/>
</g>
<!-- layer_0_all2all_expert_8&#45;&gt;layer_0_expert_8_gpu4 -->
<g id="edge38" class="edge">
<title>layer_0_all2all_expert_8&#45;&gt;layer_0_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2750.69,-15645.62C2750.78,-15637.31 2750.87,-15628.48 2750.96,-15620.19"/>
<polygon fill="black" stroke="black" points="2754.46,-15620.12 2751.06,-15610.08 2747.46,-15620.04 2754.46,-15620.12"/>
</g>
<!-- layer_0_expert_9_gpu4 -->
<g id="node34" class="node">
<title>layer_0_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3174.82,-15609.89 2965.82,-15609.89 2965.82,-15557.89 3174.82,-15557.89 3174.82,-15609.89"/>
<text text-anchor="middle" x="3070.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3070.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3070.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3070.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_9 -->
<g id="node57" class="node">
<title>layer_0_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3072.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3072.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3072.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3072.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3072.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_9_gpu4&#45;&gt;layer_0_all2all_back_9 -->
<g id="edge62" class="edge">
<title>layer_0_expert_9_gpu4&#45;&gt;layer_0_all2all_back_9</title>
<path fill="none" stroke="black" d="M3070.84,-15557.71C3071,-15549.9 3071.19,-15541.04 3071.37,-15532.27"/>
<polygon fill="black" stroke="black" points="3074.87,-15532.16 3071.58,-15522.09 3067.87,-15532.02 3074.87,-15532.16"/>
</g>
<!-- layer_0_all2all_expert_9&#45;&gt;layer_0_expert_9_gpu4 -->
<g id="edge40" class="edge">
<title>layer_0_all2all_expert_9&#45;&gt;layer_0_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3069.07,-15645.62C3069.24,-15637.31 3069.42,-15628.48 3069.59,-15620.19"/>
<polygon fill="black" stroke="black" points="3073.09,-15620.15 3069.8,-15610.08 3066.09,-15620.01 3073.09,-15620.15"/>
</g>
<!-- layer_0_expert_10_gpu5 -->
<g id="node36" class="node">
<title>layer_0_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3494.82,-15609.89 3285.82,-15609.89 3285.82,-15557.89 3494.82,-15557.89 3494.82,-15609.89"/>
<text text-anchor="middle" x="3390.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3390.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3390.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3390.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_10 -->
<g id="node58" class="node">
<title>layer_0_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3393.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3393.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3393.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3393.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3393.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_10_gpu5&#45;&gt;layer_0_all2all_back_10 -->
<g id="edge63" class="edge">
<title>layer_0_expert_10_gpu5&#45;&gt;layer_0_all2all_back_10</title>
<path fill="none" stroke="black" d="M3391.1,-15557.71C3391.34,-15549.9 3391.62,-15541.04 3391.89,-15532.27"/>
<polygon fill="black" stroke="black" points="3395.39,-15532.2 3392.21,-15522.09 3388.4,-15531.98 3395.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_10&#45;&gt;layer_0_expert_10_gpu5 -->
<g id="edge42" class="edge">
<title>layer_0_all2all_expert_10&#45;&gt;layer_0_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3389.07,-15645.62C3389.24,-15637.31 3389.42,-15628.48 3389.59,-15620.19"/>
<polygon fill="black" stroke="black" points="3393.09,-15620.15 3389.8,-15610.08 3386.09,-15620.01 3393.09,-15620.15"/>
</g>
<!-- layer_0_expert_11_gpu5 -->
<g id="node38" class="node">
<title>layer_0_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3815.82,-15609.89 3606.82,-15609.89 3606.82,-15557.89 3815.82,-15557.89 3815.82,-15609.89"/>
<text text-anchor="middle" x="3711.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3711.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3711.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3711.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_11 -->
<g id="node59" class="node">
<title>layer_0_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3714.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3714.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3714.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3714.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3714.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_11_gpu5&#45;&gt;layer_0_all2all_back_11 -->
<g id="edge64" class="edge">
<title>layer_0_expert_11_gpu5&#45;&gt;layer_0_all2all_back_11</title>
<path fill="none" stroke="black" d="M3712.1,-15557.71C3712.34,-15549.9 3712.62,-15541.04 3712.89,-15532.27"/>
<polygon fill="black" stroke="black" points="3716.39,-15532.2 3713.21,-15522.09 3709.4,-15531.98 3716.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_11&#45;&gt;layer_0_expert_11_gpu5 -->
<g id="edge44" class="edge">
<title>layer_0_all2all_expert_11&#45;&gt;layer_0_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3709.44,-15645.62C3709.7,-15637.31 3709.97,-15628.48 3710.23,-15620.19"/>
<polygon fill="black" stroke="black" points="3713.73,-15620.19 3710.54,-15610.08 3706.73,-15619.97 3713.73,-15620.19"/>
</g>
<!-- layer_0_expert_12_gpu6 -->
<g id="node40" class="node">
<title>layer_0_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4136.82,-15609.89 3927.82,-15609.89 3927.82,-15557.89 4136.82,-15557.89 4136.82,-15609.89"/>
<text text-anchor="middle" x="4032.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4032.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4032.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4032.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_12 -->
<g id="node60" class="node">
<title>layer_0_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4035.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4035.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4035.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4035.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4035.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_12_gpu6&#45;&gt;layer_0_all2all_back_12 -->
<g id="edge65" class="edge">
<title>layer_0_expert_12_gpu6&#45;&gt;layer_0_all2all_back_12</title>
<path fill="none" stroke="black" d="M4033.1,-15557.71C4033.34,-15549.9 4033.62,-15541.04 4033.89,-15532.27"/>
<polygon fill="black" stroke="black" points="4037.39,-15532.2 4034.21,-15522.09 4030.4,-15531.98 4037.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_12&#45;&gt;layer_0_expert_12_gpu6 -->
<g id="edge46" class="edge">
<title>layer_0_all2all_expert_12&#45;&gt;layer_0_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4030.44,-15645.62C4030.7,-15637.31 4030.97,-15628.48 4031.23,-15620.19"/>
<polygon fill="black" stroke="black" points="4034.73,-15620.19 4031.54,-15610.08 4027.73,-15619.97 4034.73,-15620.19"/>
</g>
<!-- layer_0_expert_13_gpu6 -->
<g id="node42" class="node">
<title>layer_0_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4457.82,-15609.89 4248.82,-15609.89 4248.82,-15557.89 4457.82,-15557.89 4457.82,-15609.89"/>
<text text-anchor="middle" x="4353.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4353.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4353.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4353.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_13 -->
<g id="node61" class="node">
<title>layer_0_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4356.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4356.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4356.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4356.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4356.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_13_gpu6&#45;&gt;layer_0_all2all_back_13 -->
<g id="edge66" class="edge">
<title>layer_0_expert_13_gpu6&#45;&gt;layer_0_all2all_back_13</title>
<path fill="none" stroke="black" d="M4354.1,-15557.71C4354.34,-15549.9 4354.62,-15541.04 4354.89,-15532.27"/>
<polygon fill="black" stroke="black" points="4358.39,-15532.2 4355.21,-15522.09 4351.4,-15531.98 4358.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_13&#45;&gt;layer_0_expert_13_gpu6 -->
<g id="edge48" class="edge">
<title>layer_0_all2all_expert_13&#45;&gt;layer_0_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4351.44,-15645.62C4351.7,-15637.31 4351.97,-15628.48 4352.23,-15620.19"/>
<polygon fill="black" stroke="black" points="4355.73,-15620.19 4352.54,-15610.08 4348.73,-15619.97 4355.73,-15620.19"/>
</g>
<!-- layer_0_expert_14_gpu7 -->
<g id="node44" class="node">
<title>layer_0_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4778.82,-15609.89 4569.82,-15609.89 4569.82,-15557.89 4778.82,-15557.89 4778.82,-15609.89"/>
<text text-anchor="middle" x="4674.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4674.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4674.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4674.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_14 -->
<g id="node62" class="node">
<title>layer_0_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4677.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4677.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4677.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4677.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4677.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_14_gpu7&#45;&gt;layer_0_all2all_back_14 -->
<g id="edge67" class="edge">
<title>layer_0_expert_14_gpu7&#45;&gt;layer_0_all2all_back_14</title>
<path fill="none" stroke="black" d="M4675.1,-15557.71C4675.34,-15549.9 4675.62,-15541.04 4675.89,-15532.27"/>
<polygon fill="black" stroke="black" points="4679.39,-15532.2 4676.21,-15522.09 4672.4,-15531.98 4679.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_14&#45;&gt;layer_0_expert_14_gpu7 -->
<g id="edge50" class="edge">
<title>layer_0_all2all_expert_14&#45;&gt;layer_0_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4672.44,-15645.62C4672.7,-15637.31 4672.97,-15628.48 4673.23,-15620.19"/>
<polygon fill="black" stroke="black" points="4676.73,-15620.19 4673.54,-15610.08 4669.73,-15619.97 4676.73,-15620.19"/>
</g>
<!-- layer_0_expert_15_gpu7 -->
<g id="node46" class="node">
<title>layer_0_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5099.82,-15609.89 4890.82,-15609.89 4890.82,-15557.89 5099.82,-15557.89 5099.82,-15609.89"/>
<text text-anchor="middle" x="4995.32" y="-15597.89" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4995.32" y="-15586.89" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4995.32" y="-15575.89" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4995.32" y="-15564.89" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_15 -->
<g id="node63" class="node">
<title>layer_0_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4998.32" cy="-15485.12" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4998.32" y="-15499.12" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4998.32" y="-15488.12" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4998.32" y="-15477.12" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4998.32" y="-15466.12" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_expert_15_gpu7&#45;&gt;layer_0_all2all_back_15 -->
<g id="edge68" class="edge">
<title>layer_0_expert_15_gpu7&#45;&gt;layer_0_all2all_back_15</title>
<path fill="none" stroke="black" d="M4996.1,-15557.71C4996.34,-15549.9 4996.62,-15541.04 4996.89,-15532.27"/>
<polygon fill="black" stroke="black" points="5000.39,-15532.2 4997.21,-15522.09 4993.4,-15531.98 5000.39,-15532.2"/>
</g>
<!-- layer_0_all2all_expert_15&#45;&gt;layer_0_expert_15_gpu7 -->
<g id="edge52" class="edge">
<title>layer_0_all2all_expert_15&#45;&gt;layer_0_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4993.44,-15645.62C4993.7,-15637.31 4993.97,-15628.48 4994.23,-15620.19"/>
<polygon fill="black" stroke="black" points="4997.73,-15620.19 4994.54,-15610.08 4990.73,-15619.97 4997.73,-15620.19"/>
</g>
<!-- layer_0_output -->
<g id="node64" class="node">
<title>layer_0_output</title>
<polygon fill="lightblue" stroke="black" points="2697.32,-15412.35 2483.32,-15412.35 2483.32,-15360.35 2697.32,-15360.35 2697.32,-15412.35"/>
<text text-anchor="middle" x="2590.32" y="-15400.35" font-family="Arial" font-size="10.00">Layer 0 Output</text>
<text text-anchor="middle" x="2590.32" y="-15389.35" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2590.32" y="-15378.35" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2590.32" y="-15367.35" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_0_all2all_back_0&#45;&gt;layer_0_output -->
<g id="edge69" class="edge">
<title>layer_0_all2all_back_0&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M286.31,-15458.17C305.48,-15454.22 325.42,-15450.68 344.32,-15448.35 762.21,-15396.73 2072.59,-15388.79 2472.96,-15387.57"/>
<polygon fill="black" stroke="black" points="2473.12,-15391.07 2483.11,-15387.54 2473.1,-15384.07 2473.12,-15391.07"/>
</g>
<!-- layer_0_all2all_back_1&#45;&gt;layer_0_output -->
<g id="edge70" class="edge">
<title>layer_0_all2all_back_1&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M607.75,-15458.15C626.79,-15454.23 646.57,-15450.71 665.32,-15448.35 1017.84,-15404 2111.7,-15391.24 2473.1,-15388.19"/>
<polygon fill="black" stroke="black" points="2473.35,-15391.69 2483.32,-15388.1 2473.29,-15384.69 2473.35,-15391.69"/>
</g>
<!-- layer_0_all2all_back_2&#45;&gt;layer_0_output -->
<g id="edge71" class="edge">
<title>layer_0_all2all_back_2&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M928.76,-15458.25C947.8,-15454.31 967.58,-15450.76 986.32,-15448.35 1273.83,-15411.25 2153.45,-15394.16 2472.86,-15389.06"/>
<polygon fill="black" stroke="black" points="2473.12,-15392.56 2483.06,-15388.9 2473.01,-15385.56 2473.12,-15392.56"/>
</g>
<!-- layer_0_all2all_back_3&#45;&gt;layer_0_output -->
<g id="edge72" class="edge">
<title>layer_0_all2all_back_3&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M1250.21,-15458.31C1269.12,-15454.39 1288.73,-15450.83 1307.32,-15448.35 1530.45,-15418.48 2199.68,-15397.78 2472.55,-15390.37"/>
<polygon fill="black" stroke="black" points="2472.98,-15393.86 2482.88,-15390.09 2472.79,-15386.86 2472.98,-15393.86"/>
</g>
<!-- layer_0_all2all_back_4&#45;&gt;layer_0_output -->
<g id="edge73" class="edge">
<title>layer_0_all2all_back_4&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M1571.68,-15458.46C1590.45,-15454.55 1609.89,-15450.96 1628.32,-15448.35 1930.78,-15405.42 2291.05,-15392.7 2472.88,-15388.93"/>
<polygon fill="black" stroke="black" points="2473.07,-15392.43 2483,-15388.72 2472.93,-15385.43 2473.07,-15392.43"/>
</g>
<!-- layer_0_all2all_back_5&#45;&gt;layer_0_output -->
<g id="edge74" class="edge">
<title>layer_0_all2all_back_5&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M1894.05,-15458.67C1912.41,-15454.82 1931.36,-15451.18 1949.32,-15448.35 2131.01,-15419.63 2343.95,-15402.63 2472.91,-15394.15"/>
<polygon fill="black" stroke="black" points="2473.45,-15397.62 2483.2,-15393.47 2472.99,-15390.63 2473.45,-15397.62"/>
</g>
<!-- layer_0_all2all_back_6&#45;&gt;layer_0_output -->
<g id="edge75" class="edge">
<title>layer_0_all2all_back_6&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M2218.35,-15459.43C2235.71,-15455.63 2253.5,-15451.82 2270.32,-15448.35 2337.35,-15434.52 2412.51,-15420.13 2473.14,-15408.8"/>
<polygon fill="black" stroke="black" points="2473.94,-15412.22 2483.13,-15406.94 2472.66,-15405.33 2473.94,-15412.22"/>
</g>
<!-- layer_0_all2all_back_7&#45;&gt;layer_0_output -->
<g id="edge76" class="edge">
<title>layer_0_all2all_back_7&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M2485.38,-15450.81C2503.09,-15440.11 2522.6,-15428.3 2539.95,-15417.81"/>
<polygon fill="black" stroke="black" points="2542.06,-15420.62 2548.81,-15412.45 2538.44,-15414.63 2542.06,-15420.62"/>
</g>
<!-- layer_0_all2all_back_8&#45;&gt;layer_0_output -->
<g id="edge77" class="edge">
<title>layer_0_all2all_back_8&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M2695.91,-15450.81C2678.1,-15440.11 2658.46,-15428.3 2641,-15417.81"/>
<polygon fill="black" stroke="black" points="2642.47,-15414.61 2632.09,-15412.45 2638.86,-15420.61 2642.47,-15414.61"/>
</g>
<!-- layer_0_all2all_back_9&#45;&gt;layer_0_output -->
<g id="edge78" class="edge">
<title>layer_0_all2all_back_9&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M2963.3,-15459.42C2945.93,-15455.62 2928.15,-15451.81 2911.32,-15448.35 2843.96,-15434.47 2768.39,-15420.05 2707.51,-15408.72"/>
<polygon fill="black" stroke="black" points="2707.96,-15405.24 2697.48,-15406.86 2706.68,-15412.12 2707.96,-15405.24"/>
</g>
<!-- layer_0_all2all_back_10&#45;&gt;layer_0_output -->
<g id="edge79" class="edge">
<title>layer_0_all2all_back_10&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M3287.59,-15458.67C3269.24,-15454.81 3250.28,-15451.18 3232.32,-15448.35 3050.22,-15419.58 2836.76,-15402.58 2707.63,-15394.11"/>
<polygon fill="black" stroke="black" points="2707.53,-15390.6 2697.33,-15393.45 2707.08,-15397.59 2707.53,-15390.6"/>
</g>
<!-- layer_0_all2all_back_11&#45;&gt;layer_0_output -->
<g id="edge80" class="edge">
<title>layer_0_all2all_back_11&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M3609.96,-15458.46C3591.2,-15454.55 3571.75,-15450.96 3553.32,-15448.35 3250.34,-15405.36 2889.42,-15392.66 2707.52,-15388.91"/>
<polygon fill="black" stroke="black" points="2707.46,-15385.41 2697.39,-15388.71 2707.32,-15392.41 2707.46,-15385.41"/>
</g>
<!-- layer_0_all2all_back_12&#45;&gt;layer_0_output -->
<g id="edge81" class="edge">
<title>layer_0_all2all_back_12&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M3931.43,-15458.31C3912.53,-15454.39 3892.91,-15450.83 3874.32,-15448.35 3650.88,-15418.44 2980.45,-15397.75 2707.68,-15390.35"/>
<polygon fill="black" stroke="black" points="2707.45,-15386.84 2697.36,-15390.07 2707.26,-15393.84 2707.45,-15386.84"/>
</g>
<!-- layer_0_all2all_back_13&#45;&gt;layer_0_output -->
<g id="edge82" class="edge">
<title>layer_0_all2all_back_13&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M4252.88,-15458.25C4233.84,-15454.31 4214.06,-15450.76 4195.32,-15448.35 3907.54,-15411.22 3026.94,-15394.14 2707.57,-15389.05"/>
<polygon fill="black" stroke="black" points="2707.42,-15385.55 2697.37,-15388.89 2707.31,-15392.55 2707.42,-15385.55"/>
</g>
<!-- layer_0_all2all_back_14&#45;&gt;layer_0_output -->
<g id="edge83" class="edge">
<title>layer_0_all2all_back_14&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M4573.89,-15458.15C4554.85,-15454.23 4535.07,-15450.71 4516.32,-15448.35 4163.62,-15403.98 3069.19,-15391.24 2707.6,-15388.19"/>
<polygon fill="black" stroke="black" points="2707.41,-15384.69 2697.38,-15388.1 2707.35,-15391.69 2707.41,-15384.69"/>
</g>
<!-- layer_0_all2all_back_15&#45;&gt;layer_0_output -->
<g id="edge84" class="edge">
<title>layer_0_all2all_back_15&#45;&gt;layer_0_output</title>
<path fill="none" stroke="black" d="M4895.33,-15458.17C4876.16,-15454.22 4856.22,-15450.68 4837.32,-15448.35 4419.25,-15396.71 3108.28,-15388.78 2707.73,-15387.57"/>
<polygon fill="black" stroke="black" points="2707.59,-15384.07 2697.58,-15387.54 2707.57,-15391.07 2707.59,-15384.07"/>
</g>
<!-- layer_1_tp_gather -->
<g id="node66" class="node">
<title>layer_1_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2590.32" cy="-15287.58" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2590.32" y="-15301.58" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2590.32" y="-15290.58" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2590.32" y="-15279.58" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2590.32" y="-15268.58" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_0_output&#45;&gt;layer_1_tp_gather -->
<g id="edge85" class="edge">
<title>layer_0_output&#45;&gt;layer_1_tp_gather</title>
<path fill="none" stroke="black" d="M2572.3,-15360.17C2570.64,-15352.2 2569.91,-15343.12 2570.1,-15334.17"/>
<polygon fill="black" stroke="black" points="2573.59,-15334.38 2570.71,-15324.19 2566.61,-15333.95 2573.59,-15334.38"/>
</g>
<!-- layer_0_output&#45;&gt;layer_1_tp_gather -->
<g id="edge87" class="edge">
<title>layer_0_output&#45;&gt;layer_1_tp_gather</title>
<path fill="none" stroke="black" d="M2584.32,-15360.17C2583.77,-15352.37 2583.53,-15343.5 2583.58,-15334.73"/>
<polygon fill="black" stroke="black" points="2587.08,-15334.62 2583.77,-15324.55 2580.08,-15334.48 2587.08,-15334.62"/>
</g>
<!-- layer_0_output&#45;&gt;layer_1_tp_gather -->
<g id="edge89" class="edge">
<title>layer_0_output&#45;&gt;layer_1_tp_gather</title>
<path fill="none" stroke="black" d="M2596.33,-15360.17C2596.87,-15352.37 2597.11,-15343.5 2597.06,-15334.73"/>
<polygon fill="black" stroke="black" points="2600.56,-15334.48 2596.87,-15324.55 2593.56,-15334.62 2600.56,-15334.48"/>
</g>
<!-- layer_0_output&#45;&gt;layer_1_tp_gather -->
<g id="edge91" class="edge">
<title>layer_0_output&#45;&gt;layer_1_tp_gather</title>
<path fill="none" stroke="black" d="M2608.34,-15360.17C2610,-15352.2 2610.73,-15343.12 2610.54,-15334.17"/>
<polygon fill="black" stroke="black" points="2614.03,-15333.95 2609.93,-15324.19 2607.05,-15334.38 2614.03,-15333.95"/>
</g>
<!-- layer_1_qkv_gpu0 -->
<g id="node65" class="node">
<title>layer_1_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2353.32,-15214.81 2147.32,-15214.81 2147.32,-15162.81 2353.32,-15162.81 2353.32,-15214.81"/>
<text text-anchor="middle" x="2250.32" y="-15202.81" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2250.32" y="-15191.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2250.32" y="-15180.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2250.32" y="-15169.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_1_attn_gpu0 -->
<g id="node70" class="node">
<title>layer_1_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2347.32,-15126.81 2145.32,-15126.81 2145.32,-15074.81 2347.32,-15074.81 2347.32,-15126.81"/>
<text text-anchor="middle" x="2246.32" y="-15114.81" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2246.32" y="-15103.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2246.32" y="-15092.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2246.32" y="-15081.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_1_qkv_gpu0&#45;&gt;layer_1_attn_gpu0 -->
<g id="edge93" class="edge">
<title>layer_1_qkv_gpu0&#45;&gt;layer_1_attn_gpu0</title>
<path fill="none" stroke="black" d="M2249.14,-15162.47C2248.77,-15154.51 2248.36,-15145.57 2247.96,-15137.05"/>
<polygon fill="black" stroke="black" points="2251.45,-15136.79 2247.49,-15126.96 2244.46,-15137.12 2251.45,-15136.79"/>
</g>
<!-- layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu0 -->
<g id="edge86" class="edge">
<title>layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2493.8,-15259.11C2448.16,-15246.12 2393.77,-15230.64 2347.99,-15217.61"/>
<polygon fill="black" stroke="black" points="2348.93,-15214.23 2338.36,-15214.86 2347.02,-15220.97 2348.93,-15214.23"/>
</g>
<!-- layer_1_qkv_gpu1 -->
<g id="node67" class="node">
<title>layer_1_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2580.32,-15214.81 2374.32,-15214.81 2374.32,-15162.81 2580.32,-15162.81 2580.32,-15214.81"/>
<text text-anchor="middle" x="2477.32" y="-15202.81" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2477.32" y="-15191.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2477.32" y="-15180.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2477.32" y="-15169.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu1 -->
<g id="edge88" class="edge">
<title>layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2549.84,-15251.91C2538.22,-15241.96 2525.6,-15231.15 2514.2,-15221.39"/>
<polygon fill="black" stroke="black" points="2516.4,-15218.67 2506.53,-15214.82 2511.85,-15223.98 2516.4,-15218.67"/>
</g>
<!-- layer_1_qkv_gpu2 -->
<g id="node68" class="node">
<title>layer_1_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2806.32,-15214.81 2600.32,-15214.81 2600.32,-15162.81 2806.32,-15162.81 2806.32,-15214.81"/>
<text text-anchor="middle" x="2703.32" y="-15202.81" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2703.32" y="-15191.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2703.32" y="-15180.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2703.32" y="-15169.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu2 -->
<g id="edge90" class="edge">
<title>layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2630.8,-15251.91C2642.43,-15241.96 2655.04,-15231.15 2666.44,-15221.39"/>
<polygon fill="black" stroke="black" points="2668.79,-15223.98 2674.11,-15214.82 2664.24,-15218.67 2668.79,-15223.98"/>
</g>
<!-- layer_1_qkv_gpu3 -->
<g id="node69" class="node">
<title>layer_1_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3031.32,-15214.81 2825.32,-15214.81 2825.32,-15162.81 3031.32,-15162.81 3031.32,-15214.81"/>
<text text-anchor="middle" x="2928.32" y="-15202.81" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2928.32" y="-15191.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2928.32" y="-15180.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2928.32" y="-15169.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu3 -->
<g id="edge92" class="edge">
<title>layer_1_tp_gather&#45;&gt;layer_1_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2686.27,-15259.11C2731.55,-15246.14 2785.49,-15230.7 2830.94,-15217.69"/>
<polygon fill="black" stroke="black" points="2832.15,-15220.98 2840.8,-15214.86 2830.23,-15214.25 2832.15,-15220.98"/>
</g>
<!-- layer_1_attn_gpu1 -->
<g id="node71" class="node">
<title>layer_1_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2576.32,-15126.81 2374.32,-15126.81 2374.32,-15074.81 2576.32,-15074.81 2576.32,-15126.81"/>
<text text-anchor="middle" x="2475.32" y="-15114.81" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2475.32" y="-15103.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2475.32" y="-15092.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2475.32" y="-15081.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_1_qkv_gpu1&#45;&gt;layer_1_attn_gpu1 -->
<g id="edge94" class="edge">
<title>layer_1_qkv_gpu1&#45;&gt;layer_1_attn_gpu1</title>
<path fill="none" stroke="black" d="M2476.73,-15162.47C2476.55,-15154.51 2476.34,-15145.57 2476.14,-15137.05"/>
<polygon fill="black" stroke="black" points="2479.64,-15136.88 2475.91,-15126.96 2472.64,-15137.04 2479.64,-15136.88"/>
</g>
<!-- layer_1_attn_gpu2 -->
<g id="node72" class="node">
<title>layer_1_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2807.32,-15126.81 2605.32,-15126.81 2605.32,-15074.81 2807.32,-15074.81 2807.32,-15126.81"/>
<text text-anchor="middle" x="2706.32" y="-15114.81" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2706.32" y="-15103.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2706.32" y="-15092.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2706.32" y="-15081.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_1_qkv_gpu2&#45;&gt;layer_1_attn_gpu2 -->
<g id="edge95" class="edge">
<title>layer_1_qkv_gpu2&#45;&gt;layer_1_attn_gpu2</title>
<path fill="none" stroke="black" d="M2704.2,-15162.47C2704.48,-15154.51 2704.79,-15145.57 2705.09,-15137.05"/>
<polygon fill="black" stroke="black" points="2708.59,-15137.08 2705.44,-15126.96 2701.6,-15136.84 2708.59,-15137.08"/>
</g>
<!-- layer_1_attn_gpu3 -->
<g id="node73" class="node">
<title>layer_1_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3029.32,-15126.81 2827.32,-15126.81 2827.32,-15074.81 3029.32,-15074.81 3029.32,-15126.81"/>
<text text-anchor="middle" x="2928.32" y="-15114.81" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2928.32" y="-15103.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2928.32" y="-15092.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2928.32" y="-15081.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_1_qkv_gpu3&#45;&gt;layer_1_attn_gpu3 -->
<g id="edge96" class="edge">
<title>layer_1_qkv_gpu3&#45;&gt;layer_1_attn_gpu3</title>
<path fill="none" stroke="black" d="M2928.32,-15162.47C2928.32,-15154.51 2928.32,-15145.57 2928.32,-15137.05"/>
<polygon fill="black" stroke="black" points="2931.82,-15136.96 2928.32,-15126.96 2924.82,-15136.96 2931.82,-15136.96"/>
</g>
<!-- layer_1_attn_out_gpu0 -->
<g id="node74" class="node">
<title>layer_1_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2350.32,-15038.81 2136.32,-15038.81 2136.32,-14986.81 2350.32,-14986.81 2350.32,-15038.81"/>
<text text-anchor="middle" x="2243.32" y="-15026.81" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2243.32" y="-15015.81" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2243.32" y="-15004.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2243.32" y="-14993.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_attn_gpu0&#45;&gt;layer_1_attn_out_gpu0 -->
<g id="edge97" class="edge">
<title>layer_1_attn_gpu0&#45;&gt;layer_1_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2245.44,-15074.47C2245.16,-15066.51 2244.85,-15057.57 2244.55,-15049.05"/>
<polygon fill="black" stroke="black" points="2248.04,-15048.84 2244.2,-15038.96 2241.05,-15049.08 2248.04,-15048.84"/>
</g>
<!-- layer_1_attn_out_gpu1 -->
<g id="node75" class="node">
<title>layer_1_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2582.32,-15038.81 2368.32,-15038.81 2368.32,-14986.81 2582.32,-14986.81 2582.32,-15038.81"/>
<text text-anchor="middle" x="2475.32" y="-15026.81" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2475.32" y="-15015.81" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2475.32" y="-15004.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2475.32" y="-14993.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_attn_gpu1&#45;&gt;layer_1_attn_out_gpu1 -->
<g id="edge98" class="edge">
<title>layer_1_attn_gpu1&#45;&gt;layer_1_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2475.32,-15074.47C2475.32,-15066.51 2475.32,-15057.57 2475.32,-15049.05"/>
<polygon fill="black" stroke="black" points="2478.82,-15048.96 2475.32,-15038.96 2471.82,-15048.96 2478.82,-15048.96"/>
</g>
<!-- layer_1_attn_out_gpu2 -->
<g id="node76" class="node">
<title>layer_1_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2814.32,-15038.81 2600.32,-15038.81 2600.32,-14986.81 2814.32,-14986.81 2814.32,-15038.81"/>
<text text-anchor="middle" x="2707.32" y="-15026.81" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2707.32" y="-15015.81" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2707.32" y="-15004.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2707.32" y="-14993.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_attn_gpu2&#45;&gt;layer_1_attn_out_gpu2 -->
<g id="edge99" class="edge">
<title>layer_1_attn_gpu2&#45;&gt;layer_1_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2706.62,-15074.47C2706.71,-15066.51 2706.81,-15057.57 2706.91,-15049.05"/>
<polygon fill="black" stroke="black" points="2710.41,-15049 2707.03,-15038.96 2703.41,-15048.92 2710.41,-15049"/>
</g>
<!-- layer_1_attn_out_gpu3 -->
<g id="node77" class="node">
<title>layer_1_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3046.32,-15038.81 2832.32,-15038.81 2832.32,-14986.81 3046.32,-14986.81 3046.32,-15038.81"/>
<text text-anchor="middle" x="2939.32" y="-15026.81" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2939.32" y="-15015.81" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2939.32" y="-15004.81" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2939.32" y="-14993.81" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_attn_gpu3&#45;&gt;layer_1_attn_out_gpu3 -->
<g id="edge100" class="edge">
<title>layer_1_attn_gpu3&#45;&gt;layer_1_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2931.56,-15074.47C2932.58,-15066.51 2933.72,-15057.57 2934.81,-15049.05"/>
<polygon fill="black" stroke="black" points="2938.31,-15049.33 2936.1,-15038.96 2931.36,-15048.44 2938.31,-15049.33"/>
</g>
<!-- layer_1_attn_allreduce -->
<g id="node78" class="node">
<title>layer_1_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2591.32" cy="-14914.04" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2591.32" y="-14928.04" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2591.32" y="-14917.04" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2591.32" y="-14906.04" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2591.32" y="-14895.04" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_attn_out_gpu0&#45;&gt;layer_1_attn_allreduce -->
<g id="edge101" class="edge">
<title>layer_1_attn_out_gpu0&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2333.39,-14986.76C2379.36,-14973.98 2435.61,-14958.34 2483.84,-14944.93"/>
<polygon fill="black" stroke="black" points="2484.99,-14948.24 2493.69,-14942.19 2483.11,-14941.49 2484.99,-14948.24"/>
</g>
<!-- layer_1_attn_out_gpu1&#45;&gt;layer_1_attn_allreduce -->
<g id="edge102" class="edge">
<title>layer_1_attn_out_gpu1&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2505.5,-14986.63C2516.73,-14977.27 2529.78,-14966.38 2542.26,-14955.96"/>
<polygon fill="black" stroke="black" points="2544.51,-14958.65 2549.94,-14949.55 2540.02,-14953.27 2544.51,-14958.65"/>
</g>
<!-- layer_1_attn_out_gpu2&#45;&gt;layer_1_attn_allreduce -->
<g id="edge103" class="edge">
<title>layer_1_attn_out_gpu2&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2677.15,-14986.63C2665.92,-14977.27 2652.86,-14966.38 2640.38,-14955.96"/>
<polygon fill="black" stroke="black" points="2642.62,-14953.27 2632.7,-14949.55 2638.13,-14958.65 2642.62,-14953.27"/>
</g>
<!-- layer_1_attn_out_gpu3&#45;&gt;layer_1_attn_allreduce -->
<g id="edge104" class="edge">
<title>layer_1_attn_out_gpu3&#45;&gt;layer_1_attn_allreduce</title>
<path fill="none" stroke="black" d="M2849.25,-14986.76C2803.28,-14973.98 2747.03,-14958.34 2698.8,-14944.93"/>
<polygon fill="black" stroke="black" points="2699.53,-14941.49 2688.96,-14942.19 2697.65,-14948.24 2699.53,-14941.49"/>
</g>
<!-- layer_1_gate -->
<g id="node79" class="node">
<title>layer_1_gate</title>
<polygon fill="lightyellow" stroke="black" points="2808.18,-14841.27 2463.2,-14841.27 2374.46,-14737.27 2719.44,-14737.27 2808.18,-14841.27"/>
<text text-anchor="middle" x="2591.32" y="-14803.27" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2591.32" y="-14792.27" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2591.32" y="-14781.27" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2591.32" y="-14770.27" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_1_attn_allreduce&#45;&gt;layer_1_gate -->
<g id="edge105" class="edge">
<title>layer_1_attn_allreduce&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2572.76,-14877.53C2571.65,-14869.49 2571.08,-14860.72 2571.07,-14851.94"/>
<polygon fill="black" stroke="black" points="2574.58,-14851.76 2571.31,-14841.68 2567.58,-14851.6 2574.58,-14851.76"/>
</g>
<!-- layer_1_attn_allreduce&#45;&gt;layer_1_gate -->
<g id="edge106" class="edge">
<title>layer_1_attn_allreduce&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2585.12,-14877.2C2584.75,-14869.16 2584.57,-14860.41 2584.57,-14851.66"/>
<polygon fill="black" stroke="black" points="2588.07,-14851.46 2584.65,-14841.43 2581.07,-14851.41 2588.07,-14851.46"/>
</g>
<!-- layer_1_attn_allreduce&#45;&gt;layer_1_gate -->
<g id="edge107" class="edge">
<title>layer_1_attn_allreduce&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2597.52,-14877.2C2597.89,-14869.16 2598.07,-14860.41 2598.07,-14851.66"/>
<polygon fill="black" stroke="black" points="2601.57,-14851.41 2597.99,-14841.43 2594.57,-14851.46 2601.57,-14851.41"/>
</g>
<!-- layer_1_attn_allreduce&#45;&gt;layer_1_gate -->
<g id="edge108" class="edge">
<title>layer_1_attn_allreduce&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2609.88,-14877.53C2610.99,-14869.49 2611.56,-14860.72 2611.57,-14851.94"/>
<polygon fill="black" stroke="black" points="2615.06,-14851.6 2611.33,-14841.68 2608.07,-14851.76 2615.06,-14851.6"/>
</g>
<!-- layer_1_all2all_expert_0 -->
<g id="node81" class="node">
<title>layer_1_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="208.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="208.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="208.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="208.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="208.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_0 -->
<g id="edge109" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2415.28,-14785.14C1963.66,-14776.5 771.96,-14749.71 379.32,-14701.27 361.2,-14699.03 342.16,-14695.87 323.61,-14692.34"/>
<polygon fill="black" stroke="black" points="324.16,-14688.88 313.67,-14690.41 322.82,-14695.76 324.16,-14688.88"/>
</g>
<!-- layer_1_all2all_expert_1 -->
<g id="node83" class="node">
<title>layer_1_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="536.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="536.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="536.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="536.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="536.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_1 -->
<g id="edge111" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2414.21,-14783.94C2009.83,-14773.44 1028.32,-14744.27 700.32,-14701.27 683.9,-14699.11 666.68,-14696.15 649.83,-14692.85"/>
<polygon fill="black" stroke="black" points="650.46,-14689.41 639.97,-14690.87 649.08,-14696.27 650.46,-14689.41"/>
</g>
<!-- layer_1_all2all_expert_2 -->
<g id="node85" class="node">
<title>layer_1_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="857.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="857.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="857.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="857.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="857.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_2 -->
<g id="edge113" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2417.49,-14787.99C2126.41,-14785.43 1522.57,-14771.22 1017.32,-14701.27 1001.79,-14699.12 985.54,-14696.24 969.6,-14693.04"/>
<polygon fill="black" stroke="black" points="970.22,-14689.6 959.72,-14691.01 968.81,-14696.45 970.22,-14689.6"/>
</g>
<!-- layer_1_all2all_expert_3 -->
<g id="node87" class="node">
<title>layer_1_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1174.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1174.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1174.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1174.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1174.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_3 -->
<g id="edge115" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2414.62,-14784.52C2170.38,-14777.41 1716.34,-14757.26 1333.32,-14701.27 1318.28,-14699.07 1302.55,-14696.22 1287.08,-14693.08"/>
<polygon fill="black" stroke="black" points="1287.46,-14689.59 1276.96,-14690.99 1286.04,-14696.44 1287.46,-14689.59"/>
</g>
<!-- layer_1_all2all_expert_4 -->
<g id="node89" class="node">
<title>layer_1_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1490.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1490.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1490.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1490.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1490.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_4 -->
<g id="edge117" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2409.67,-14778.57C2219.13,-14766.75 1911.38,-14743 1648.32,-14701.27 1633.74,-14698.95 1618.49,-14696.09 1603.47,-14692.99"/>
<polygon fill="black" stroke="black" points="1604.14,-14689.55 1593.63,-14690.92 1602.7,-14696.4 1604.14,-14689.55"/>
</g>
<!-- layer_1_all2all_expert_5 -->
<g id="node91" class="node">
<title>layer_1_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1805.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1805.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1805.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1805.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1805.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_5 -->
<g id="edge119" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.97,-14766.05C2274.09,-14750.54 2108.04,-14727.89 1962.32,-14701.27 1948.47,-14698.74 1933.99,-14695.82 1919.66,-14692.76"/>
<polygon fill="black" stroke="black" points="1920.29,-14689.31 1909.78,-14690.62 1918.82,-14696.16 1920.29,-14689.31"/>
</g>
<!-- layer_1_all2all_expert_6 -->
<g id="node93" class="node">
<title>layer_1_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2119.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2119.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2119.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2119.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2119.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_6 -->
<g id="edge121" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2394.91,-14737.18C2338.31,-14722.46 2278.59,-14706.93 2229.27,-14694.1"/>
<polygon fill="black" stroke="black" points="2230.1,-14690.7 2219.54,-14691.57 2228.34,-14697.47 2230.1,-14690.7"/>
</g>
<!-- layer_1_all2all_expert_7 -->
<g id="node95" class="node">
<title>layer_1_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2433.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2433.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2433.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2433.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2433.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_7 -->
<g id="edge123" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2525.23,-14736.91C2512.05,-14726.67 2498.38,-14716.05 2485.73,-14706.22"/>
<polygon fill="black" stroke="black" points="2487.63,-14703.27 2477.59,-14699.9 2483.34,-14708.8 2487.63,-14703.27"/>
</g>
<!-- layer_1_all2all_expert_8 -->
<g id="node97" class="node">
<title>layer_1_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2749.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2749.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2749.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2749.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2749.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_8 -->
<g id="edge125" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2657.41,-14736.91C2670.59,-14726.67 2684.26,-14716.05 2696.91,-14706.22"/>
<polygon fill="black" stroke="black" points="2699.3,-14708.8 2705.05,-14699.9 2695.01,-14703.27 2699.3,-14708.8"/>
</g>
<!-- layer_1_all2all_expert_9 -->
<g id="node99" class="node">
<title>layer_1_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3067.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3067.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3067.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3067.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3067.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_9 -->
<g id="edge127" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2732.2,-14751.93C2803.93,-14733.43 2889.86,-14711.27 2956.74,-14694.02"/>
<polygon fill="black" stroke="black" points="2957.66,-14697.4 2966.47,-14691.51 2955.91,-14690.62 2957.66,-14697.4"/>
</g>
<!-- layer_1_all2all_expert_10 -->
<g id="node101" class="node">
<title>layer_1_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3387.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3387.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3387.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3387.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3387.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_10 -->
<g id="edge129" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2747.94,-14770.26C2876.38,-14754.64 3062.69,-14730.06 3224.32,-14701.27 3239.41,-14698.58 3255.23,-14695.47 3270.82,-14692.24"/>
<polygon fill="black" stroke="black" points="3271.96,-14695.58 3281.03,-14690.1 3270.53,-14688.73 3271.96,-14695.58"/>
</g>
<!-- layer_1_all2all_expert_11 -->
<g id="node103" class="node">
<title>layer_1_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3707.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3707.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3707.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3707.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3707.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_11 -->
<g id="edge131" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2755.66,-14779.52C2946.19,-14767.94 3269.31,-14743.83 3544.32,-14701.27 3559.97,-14698.85 3576.37,-14695.83 3592.48,-14692.58"/>
<polygon fill="black" stroke="black" points="3593.37,-14695.97 3602.46,-14690.53 3591.96,-14689.11 3593.37,-14695.97"/>
</g>
<!-- layer_1_all2all_expert_12 -->
<g id="node105" class="node">
<title>layer_1_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4028.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4028.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4028.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4028.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4028.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_12 -->
<g id="edge133" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2759.97,-14784.6C3004.49,-14777.5 3471.21,-14757.26 3864.32,-14701.27 3880.45,-14698.97 3897.35,-14695.97 3913.92,-14692.69"/>
<polygon fill="black" stroke="black" points="3915.08,-14696.02 3924.19,-14690.61 3913.69,-14689.16 3915.08,-14696.02"/>
</g>
<!-- layer_1_all2all_expert_13 -->
<g id="node107" class="node">
<title>layer_1_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4349.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4349.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4349.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4349.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4349.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_13 -->
<g id="edge135" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2762.9,-14787.89C3055.89,-14785.24 3670.89,-14770.95 4185.32,-14701.27 4201.74,-14699.04 4218.95,-14696.04 4235.79,-14692.72"/>
<polygon fill="black" stroke="black" points="4236.55,-14696.14 4245.66,-14690.73 4235.16,-14689.28 4236.55,-14696.14"/>
</g>
<!-- layer_1_all2all_expert_14 -->
<g id="node109" class="node">
<title>layer_1_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4670.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4670.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4670.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4670.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4670.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_14 -->
<g id="edge137" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2759.76,-14784.28C3162.24,-14774.15 4171.17,-14745.11 4506.32,-14701.27 4522.75,-14699.12 4539.96,-14696.16 4556.81,-14692.86"/>
<polygon fill="black" stroke="black" points="4557.56,-14696.28 4566.68,-14690.88 4556.18,-14689.42 4557.56,-14696.28"/>
</g>
<!-- layer_1_all2all_expert_15 -->
<g id="node111" class="node">
<title>layer_1_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4991.32" cy="-14664.5" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4991.32" y="-14678.5" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4991.32" y="-14667.5" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4991.32" y="-14656.5" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4991.32" y="-14645.5" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_all2all_expert_15 -->
<g id="edge139" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2760.66,-14785.54C3210.48,-14777.66 4428.1,-14752.17 4827.32,-14701.27 4843.87,-14699.16 4861.23,-14696.2 4878.19,-14692.88"/>
<polygon fill="black" stroke="black" points="4879.01,-14696.29 4888.13,-14690.89 4877.64,-14689.43 4879.01,-14696.29"/>
</g>
<!-- layer_1_expert_0_gpu0 -->
<g id="node80" class="node">
<title>layer_1_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="310.82,-14591.73 101.82,-14591.73 101.82,-14539.73 310.82,-14539.73 310.82,-14591.73"/>
<text text-anchor="middle" x="206.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="206.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="206.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="206.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_0 -->
<g id="node112" class="node">
<title>layer_1_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="182.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="182.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="182.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="182.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="182.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_0_gpu0&#45;&gt;layer_1_all2all_back_0 -->
<g id="edge141" class="edge">
<title>layer_1_expert_0_gpu0&#45;&gt;layer_1_all2all_back_0</title>
<path fill="none" stroke="black" d="M200.08,-14539.56C198.12,-14531.66 195.89,-14522.69 193.7,-14513.83"/>
<polygon fill="black" stroke="black" points="197.05,-14512.8 191.24,-14503.94 190.25,-14514.48 197.05,-14512.8"/>
</g>
<!-- layer_1_all2all_expert_0&#45;&gt;layer_1_expert_0_gpu0 -->
<g id="edge110" class="edge">
<title>layer_1_all2all_expert_0&#45;&gt;layer_1_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M207.58,-14627.47C207.4,-14619.15 207.22,-14610.32 207.05,-14602.04"/>
<polygon fill="black" stroke="black" points="210.55,-14601.85 206.84,-14591.93 203.55,-14602 210.55,-14601.85"/>
</g>
<!-- layer_1_expert_1_gpu0 -->
<g id="node82" class="node">
<title>layer_1_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="619.82,-14591.73 410.82,-14591.73 410.82,-14539.73 619.82,-14539.73 619.82,-14591.73"/>
<text text-anchor="middle" x="515.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="515.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="515.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="515.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_1 -->
<g id="node113" class="node">
<title>layer_1_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="503.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="503.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="503.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="503.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="503.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_1_gpu0&#45;&gt;layer_1_all2all_back_1 -->
<g id="edge142" class="edge">
<title>layer_1_expert_1_gpu0&#45;&gt;layer_1_all2all_back_1</title>
<path fill="none" stroke="black" d="M512.2,-14539.56C511.23,-14531.75 510.13,-14522.88 509.04,-14514.11"/>
<polygon fill="black" stroke="black" points="512.49,-14513.43 507.78,-14503.94 505.54,-14514.29 512.49,-14513.43"/>
</g>
<!-- layer_1_all2all_expert_1&#45;&gt;layer_1_expert_1_gpu0 -->
<g id="edge112" class="edge">
<title>layer_1_all2all_expert_1&#45;&gt;layer_1_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M528.56,-14627.74C526.72,-14619.24 524.75,-14610.19 522.92,-14601.72"/>
<polygon fill="black" stroke="black" points="526.3,-14600.8 520.76,-14591.77 519.46,-14602.29 526.3,-14600.8"/>
</g>
<!-- layer_1_expert_2_gpu1 -->
<g id="node84" class="node">
<title>layer_1_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="944.82,-14591.73 735.82,-14591.73 735.82,-14539.73 944.82,-14539.73 944.82,-14591.73"/>
<text text-anchor="middle" x="840.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="840.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="840.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="840.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_2 -->
<g id="node114" class="node">
<title>layer_1_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="824.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="824.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="824.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="824.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="824.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_2_gpu1&#45;&gt;layer_1_all2all_back_2 -->
<g id="edge143" class="edge">
<title>layer_1_expert_2_gpu1&#45;&gt;layer_1_all2all_back_2</title>
<path fill="none" stroke="black" d="M836.16,-14539.56C834.85,-14531.66 833.37,-14522.69 831.9,-14513.83"/>
<polygon fill="black" stroke="black" points="835.35,-14513.23 830.27,-14503.94 828.45,-14514.37 835.35,-14513.23"/>
</g>
<!-- layer_1_all2all_expert_2&#45;&gt;layer_1_expert_2_gpu1 -->
<g id="edge114" class="edge">
<title>layer_1_all2all_expert_2&#45;&gt;layer_1_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M851.04,-14627.74C849.55,-14619.24 847.96,-14610.19 846.47,-14601.72"/>
<polygon fill="black" stroke="black" points="849.9,-14601.02 844.72,-14591.77 843,-14602.23 849.9,-14601.02"/>
</g>
<!-- layer_1_expert_3_gpu1 -->
<g id="node86" class="node">
<title>layer_1_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1263.82,-14591.73 1054.82,-14591.73 1054.82,-14539.73 1263.82,-14539.73 1263.82,-14591.73"/>
<text text-anchor="middle" x="1159.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1159.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1159.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1159.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_3 -->
<g id="node115" class="node">
<title>layer_1_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1145.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1145.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1145.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1145.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1145.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_3_gpu1&#45;&gt;layer_1_all2all_back_3 -->
<g id="edge144" class="edge">
<title>layer_1_expert_3_gpu1&#45;&gt;layer_1_all2all_back_3</title>
<path fill="none" stroke="black" d="M1155.68,-14539.56C1154.55,-14531.75 1153.27,-14522.88 1152,-14514.11"/>
<polygon fill="black" stroke="black" points="1155.42,-14513.33 1150.53,-14503.94 1148.49,-14514.33 1155.42,-14513.33"/>
</g>
<!-- layer_1_all2all_expert_3&#45;&gt;layer_1_expert_3_gpu1 -->
<g id="edge116" class="edge">
<title>layer_1_all2all_expert_3&#45;&gt;layer_1_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1168.78,-14627.74C1167.46,-14619.24 1166.06,-14610.19 1164.75,-14601.72"/>
<polygon fill="black" stroke="black" points="1168.19,-14601.12 1163.2,-14591.77 1161.28,-14602.19 1168.19,-14601.12"/>
</g>
<!-- layer_1_expert_4_gpu2 -->
<g id="node88" class="node">
<title>layer_1_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1581.82,-14591.73 1372.82,-14591.73 1372.82,-14539.73 1581.82,-14539.73 1581.82,-14591.73"/>
<text text-anchor="middle" x="1477.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1477.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1477.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1477.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_4 -->
<g id="node116" class="node">
<title>layer_1_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1466.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1466.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1466.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1466.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1466.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_4_gpu2&#45;&gt;layer_1_all2all_back_4 -->
<g id="edge145" class="edge">
<title>layer_1_expert_4_gpu2&#45;&gt;layer_1_all2all_back_4</title>
<path fill="none" stroke="black" d="M1474.46,-14539.56C1473.57,-14531.75 1472.56,-14522.88 1471.57,-14514.11"/>
<polygon fill="black" stroke="black" points="1475.02,-14513.48 1470.41,-14503.94 1468.06,-14514.27 1475.02,-14513.48"/>
</g>
<!-- layer_1_all2all_expert_4&#45;&gt;layer_1_expert_4_gpu2 -->
<g id="edge118" class="edge">
<title>layer_1_all2all_expert_4&#45;&gt;layer_1_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1485.52,-14627.74C1484.38,-14619.24 1483.16,-14610.19 1482.02,-14601.72"/>
<polygon fill="black" stroke="black" points="1485.49,-14601.22 1480.69,-14591.77 1478.55,-14602.15 1485.49,-14601.22"/>
</g>
<!-- layer_1_expert_5_gpu2 -->
<g id="node90" class="node">
<title>layer_1_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1899.82,-14591.73 1690.82,-14591.73 1690.82,-14539.73 1899.82,-14539.73 1899.82,-14591.73"/>
<text text-anchor="middle" x="1795.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1795.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1795.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1795.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_5 -->
<g id="node117" class="node">
<title>layer_1_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1787.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1787.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1787.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1787.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1787.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_5_gpu2&#45;&gt;layer_1_all2all_back_5 -->
<g id="edge146" class="edge">
<title>layer_1_expert_5_gpu2&#45;&gt;layer_1_all2all_back_5</title>
<path fill="none" stroke="black" d="M1793.24,-14539.56C1792.59,-14531.75 1791.86,-14522.88 1791.14,-14514.11"/>
<polygon fill="black" stroke="black" points="1794.61,-14513.61 1790.3,-14503.94 1787.63,-14514.19 1794.61,-14513.61"/>
</g>
<!-- layer_1_all2all_expert_5&#45;&gt;layer_1_expert_5_gpu2 -->
<g id="edge120" class="edge">
<title>layer_1_all2all_expert_5&#45;&gt;layer_1_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1801.63,-14627.74C1800.75,-14619.24 1799.81,-14610.19 1798.94,-14601.72"/>
<polygon fill="black" stroke="black" points="1802.42,-14601.36 1797.91,-14591.77 1795.46,-14602.08 1802.42,-14601.36"/>
</g>
<!-- layer_1_expert_6_gpu3 -->
<g id="node92" class="node">
<title>layer_1_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2220.82,-14591.73 2011.82,-14591.73 2011.82,-14539.73 2220.82,-14539.73 2220.82,-14591.73"/>
<text text-anchor="middle" x="2116.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2116.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2116.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2116.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_6 -->
<g id="node118" class="node">
<title>layer_1_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2108.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2108.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2108.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2108.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2108.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_6_gpu3&#45;&gt;layer_1_all2all_back_6 -->
<g id="edge147" class="edge">
<title>layer_1_expert_6_gpu3&#45;&gt;layer_1_all2all_back_6</title>
<path fill="none" stroke="black" d="M2114.24,-14539.56C2113.59,-14531.75 2112.86,-14522.88 2112.14,-14514.11"/>
<polygon fill="black" stroke="black" points="2115.61,-14513.61 2111.3,-14503.94 2108.63,-14514.19 2115.61,-14513.61"/>
</g>
<!-- layer_1_all2all_expert_6&#45;&gt;layer_1_expert_6_gpu3 -->
<g id="edge122" class="edge">
<title>layer_1_all2all_expert_6&#45;&gt;layer_1_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2118.2,-14627.47C2117.95,-14619.15 2117.67,-14610.32 2117.42,-14602.04"/>
<polygon fill="black" stroke="black" points="2120.91,-14601.81 2117.1,-14591.93 2113.91,-14602.03 2120.91,-14601.81"/>
</g>
<!-- layer_1_expert_7_gpu3 -->
<g id="node94" class="node">
<title>layer_1_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2534.82,-14591.73 2325.82,-14591.73 2325.82,-14539.73 2534.82,-14539.73 2534.82,-14591.73"/>
<text text-anchor="middle" x="2430.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2430.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2430.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2430.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_7 -->
<g id="node119" class="node">
<title>layer_1_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2429.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2429.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2429.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2429.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2429.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_7_gpu3&#45;&gt;layer_1_all2all_back_7 -->
<g id="edge148" class="edge">
<title>layer_1_expert_7_gpu3&#45;&gt;layer_1_all2all_back_7</title>
<path fill="none" stroke="black" d="M2430.06,-14539.56C2429.98,-14531.75 2429.89,-14522.88 2429.8,-14514.11"/>
<polygon fill="black" stroke="black" points="2433.3,-14513.9 2429.69,-14503.94 2426.3,-14513.97 2433.3,-14513.9"/>
</g>
<!-- layer_1_all2all_expert_7&#45;&gt;layer_1_expert_7_gpu3 -->
<g id="edge124" class="edge">
<title>layer_1_all2all_expert_7&#45;&gt;layer_1_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2432.2,-14627.47C2431.95,-14619.15 2431.67,-14610.32 2431.42,-14602.04"/>
<polygon fill="black" stroke="black" points="2434.91,-14601.81 2431.1,-14591.93 2427.91,-14602.03 2434.91,-14601.81"/>
</g>
<!-- layer_1_expert_8_gpu4 -->
<g id="node96" class="node">
<title>layer_1_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2853.82,-14591.73 2644.82,-14591.73 2644.82,-14539.73 2853.82,-14539.73 2853.82,-14591.73"/>
<text text-anchor="middle" x="2749.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2749.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2749.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2749.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_8 -->
<g id="node120" class="node">
<title>layer_1_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2750.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2750.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2750.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2750.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2750.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_8_gpu4&#45;&gt;layer_1_all2all_back_8 -->
<g id="edge149" class="edge">
<title>layer_1_expert_8_gpu4&#45;&gt;layer_1_all2all_back_8</title>
<path fill="none" stroke="black" d="M2749.58,-14539.56C2749.66,-14531.75 2749.75,-14522.88 2749.84,-14514.11"/>
<polygon fill="black" stroke="black" points="2753.35,-14513.97 2749.95,-14503.94 2746.35,-14513.9 2753.35,-14513.97"/>
</g>
<!-- layer_1_all2all_expert_8&#45;&gt;layer_1_expert_8_gpu4 -->
<g id="edge126" class="edge">
<title>layer_1_all2all_expert_8&#45;&gt;layer_1_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2749.32,-14627.47C2749.32,-14619.15 2749.32,-14610.32 2749.32,-14602.04"/>
<polygon fill="black" stroke="black" points="2752.82,-14601.93 2749.32,-14591.93 2745.82,-14601.93 2752.82,-14601.93"/>
</g>
<!-- layer_1_expert_9_gpu4 -->
<g id="node98" class="node">
<title>layer_1_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3173.82,-14591.73 2964.82,-14591.73 2964.82,-14539.73 3173.82,-14539.73 3173.82,-14591.73"/>
<text text-anchor="middle" x="3069.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3069.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3069.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3069.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_9 -->
<g id="node121" class="node">
<title>layer_1_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3071.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3071.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3071.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3071.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3071.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_9_gpu4&#45;&gt;layer_1_all2all_back_9 -->
<g id="edge150" class="edge">
<title>layer_1_expert_9_gpu4&#45;&gt;layer_1_all2all_back_9</title>
<path fill="none" stroke="black" d="M3069.84,-14539.56C3070,-14531.75 3070.19,-14522.88 3070.37,-14514.11"/>
<polygon fill="black" stroke="black" points="3073.87,-14514.01 3070.58,-14503.94 3066.87,-14513.86 3073.87,-14514.01"/>
</g>
<!-- layer_1_all2all_expert_9&#45;&gt;layer_1_expert_9_gpu4 -->
<g id="edge128" class="edge">
<title>layer_1_all2all_expert_9&#45;&gt;layer_1_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3068.07,-14627.47C3068.24,-14619.15 3068.42,-14610.32 3068.59,-14602.04"/>
<polygon fill="black" stroke="black" points="3072.09,-14602 3068.8,-14591.93 3065.09,-14601.85 3072.09,-14602"/>
</g>
<!-- layer_1_expert_10_gpu5 -->
<g id="node100" class="node">
<title>layer_1_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3493.82,-14591.73 3284.82,-14591.73 3284.82,-14539.73 3493.82,-14539.73 3493.82,-14591.73"/>
<text text-anchor="middle" x="3389.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3389.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3389.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3389.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_10 -->
<g id="node122" class="node">
<title>layer_1_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3392.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3392.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3392.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3392.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3392.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_10_gpu5&#45;&gt;layer_1_all2all_back_10 -->
<g id="edge151" class="edge">
<title>layer_1_expert_10_gpu5&#45;&gt;layer_1_all2all_back_10</title>
<path fill="none" stroke="black" d="M3390.1,-14539.56C3390.34,-14531.75 3390.62,-14522.88 3390.89,-14514.11"/>
<polygon fill="black" stroke="black" points="3394.39,-14514.04 3391.21,-14503.94 3387.4,-14513.82 3394.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_10&#45;&gt;layer_1_expert_10_gpu5 -->
<g id="edge130" class="edge">
<title>layer_1_all2all_expert_10&#45;&gt;layer_1_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3388.07,-14627.47C3388.24,-14619.15 3388.42,-14610.32 3388.59,-14602.04"/>
<polygon fill="black" stroke="black" points="3392.09,-14602 3388.8,-14591.93 3385.09,-14601.85 3392.09,-14602"/>
</g>
<!-- layer_1_expert_11_gpu5 -->
<g id="node102" class="node">
<title>layer_1_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3814.82,-14591.73 3605.82,-14591.73 3605.82,-14539.73 3814.82,-14539.73 3814.82,-14591.73"/>
<text text-anchor="middle" x="3710.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3710.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3710.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3710.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_11 -->
<g id="node123" class="node">
<title>layer_1_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3713.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3713.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3713.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3713.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3713.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_11_gpu5&#45;&gt;layer_1_all2all_back_11 -->
<g id="edge152" class="edge">
<title>layer_1_expert_11_gpu5&#45;&gt;layer_1_all2all_back_11</title>
<path fill="none" stroke="black" d="M3711.1,-14539.56C3711.34,-14531.75 3711.62,-14522.88 3711.89,-14514.11"/>
<polygon fill="black" stroke="black" points="3715.39,-14514.04 3712.21,-14503.94 3708.4,-14513.82 3715.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_11&#45;&gt;layer_1_expert_11_gpu5 -->
<g id="edge132" class="edge">
<title>layer_1_all2all_expert_11&#45;&gt;layer_1_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3708.44,-14627.47C3708.7,-14619.15 3708.97,-14610.32 3709.23,-14602.04"/>
<polygon fill="black" stroke="black" points="3712.73,-14602.03 3709.54,-14591.93 3705.73,-14601.81 3712.73,-14602.03"/>
</g>
<!-- layer_1_expert_12_gpu6 -->
<g id="node104" class="node">
<title>layer_1_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4135.82,-14591.73 3926.82,-14591.73 3926.82,-14539.73 4135.82,-14539.73 4135.82,-14591.73"/>
<text text-anchor="middle" x="4031.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4031.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4031.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4031.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_12 -->
<g id="node124" class="node">
<title>layer_1_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4034.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4034.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4034.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4034.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4034.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_12_gpu6&#45;&gt;layer_1_all2all_back_12 -->
<g id="edge153" class="edge">
<title>layer_1_expert_12_gpu6&#45;&gt;layer_1_all2all_back_12</title>
<path fill="none" stroke="black" d="M4032.1,-14539.56C4032.34,-14531.75 4032.62,-14522.88 4032.89,-14514.11"/>
<polygon fill="black" stroke="black" points="4036.39,-14514.04 4033.21,-14503.94 4029.4,-14513.82 4036.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_12&#45;&gt;layer_1_expert_12_gpu6 -->
<g id="edge134" class="edge">
<title>layer_1_all2all_expert_12&#45;&gt;layer_1_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4029.44,-14627.47C4029.7,-14619.15 4029.97,-14610.32 4030.23,-14602.04"/>
<polygon fill="black" stroke="black" points="4033.73,-14602.03 4030.54,-14591.93 4026.73,-14601.81 4033.73,-14602.03"/>
</g>
<!-- layer_1_expert_13_gpu6 -->
<g id="node106" class="node">
<title>layer_1_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4456.82,-14591.73 4247.82,-14591.73 4247.82,-14539.73 4456.82,-14539.73 4456.82,-14591.73"/>
<text text-anchor="middle" x="4352.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4352.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4352.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4352.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_13 -->
<g id="node125" class="node">
<title>layer_1_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4355.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4355.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4355.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4355.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4355.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_13_gpu6&#45;&gt;layer_1_all2all_back_13 -->
<g id="edge154" class="edge">
<title>layer_1_expert_13_gpu6&#45;&gt;layer_1_all2all_back_13</title>
<path fill="none" stroke="black" d="M4353.1,-14539.56C4353.34,-14531.75 4353.62,-14522.88 4353.89,-14514.11"/>
<polygon fill="black" stroke="black" points="4357.39,-14514.04 4354.21,-14503.94 4350.4,-14513.82 4357.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_13&#45;&gt;layer_1_expert_13_gpu6 -->
<g id="edge136" class="edge">
<title>layer_1_all2all_expert_13&#45;&gt;layer_1_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4350.44,-14627.47C4350.7,-14619.15 4350.97,-14610.32 4351.23,-14602.04"/>
<polygon fill="black" stroke="black" points="4354.73,-14602.03 4351.54,-14591.93 4347.73,-14601.81 4354.73,-14602.03"/>
</g>
<!-- layer_1_expert_14_gpu7 -->
<g id="node108" class="node">
<title>layer_1_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4777.82,-14591.73 4568.82,-14591.73 4568.82,-14539.73 4777.82,-14539.73 4777.82,-14591.73"/>
<text text-anchor="middle" x="4673.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4673.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4673.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4673.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_14 -->
<g id="node126" class="node">
<title>layer_1_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4676.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4676.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4676.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4676.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4676.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_14_gpu7&#45;&gt;layer_1_all2all_back_14 -->
<g id="edge155" class="edge">
<title>layer_1_expert_14_gpu7&#45;&gt;layer_1_all2all_back_14</title>
<path fill="none" stroke="black" d="M4674.1,-14539.56C4674.34,-14531.75 4674.62,-14522.88 4674.89,-14514.11"/>
<polygon fill="black" stroke="black" points="4678.39,-14514.04 4675.21,-14503.94 4671.4,-14513.82 4678.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_14&#45;&gt;layer_1_expert_14_gpu7 -->
<g id="edge138" class="edge">
<title>layer_1_all2all_expert_14&#45;&gt;layer_1_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4671.44,-14627.47C4671.7,-14619.15 4671.97,-14610.32 4672.23,-14602.04"/>
<polygon fill="black" stroke="black" points="4675.73,-14602.03 4672.54,-14591.93 4668.73,-14601.81 4675.73,-14602.03"/>
</g>
<!-- layer_1_expert_15_gpu7 -->
<g id="node110" class="node">
<title>layer_1_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5098.82,-14591.73 4889.82,-14591.73 4889.82,-14539.73 5098.82,-14539.73 5098.82,-14591.73"/>
<text text-anchor="middle" x="4994.32" y="-14579.73" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4994.32" y="-14568.73" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4994.32" y="-14557.73" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4994.32" y="-14546.73" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_15 -->
<g id="node127" class="node">
<title>layer_1_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4997.32" cy="-14466.96" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4997.32" y="-14480.96" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4997.32" y="-14469.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4997.32" y="-14458.96" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4997.32" y="-14447.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_expert_15_gpu7&#45;&gt;layer_1_all2all_back_15 -->
<g id="edge156" class="edge">
<title>layer_1_expert_15_gpu7&#45;&gt;layer_1_all2all_back_15</title>
<path fill="none" stroke="black" d="M4995.1,-14539.56C4995.34,-14531.75 4995.62,-14522.88 4995.89,-14514.11"/>
<polygon fill="black" stroke="black" points="4999.39,-14514.04 4996.21,-14503.94 4992.4,-14513.82 4999.39,-14514.04"/>
</g>
<!-- layer_1_all2all_expert_15&#45;&gt;layer_1_expert_15_gpu7 -->
<g id="edge140" class="edge">
<title>layer_1_all2all_expert_15&#45;&gt;layer_1_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4992.44,-14627.47C4992.7,-14619.15 4992.97,-14610.32 4993.23,-14602.04"/>
<polygon fill="black" stroke="black" points="4996.73,-14602.03 4993.54,-14591.93 4989.73,-14601.81 4996.73,-14602.03"/>
</g>
<!-- layer_1_output -->
<g id="node128" class="node">
<title>layer_1_output</title>
<polygon fill="lightblue" stroke="black" points="2696.32,-14394.19 2482.32,-14394.19 2482.32,-14342.19 2696.32,-14342.19 2696.32,-14394.19"/>
<text text-anchor="middle" x="2589.32" y="-14382.19" font-family="Arial" font-size="10.00">Layer 1 Output</text>
<text text-anchor="middle" x="2589.32" y="-14371.19" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2589.32" y="-14360.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2589.32" y="-14349.19" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_1_all2all_back_0&#45;&gt;layer_1_output -->
<g id="edge157" class="edge">
<title>layer_1_all2all_back_0&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M285.31,-14440.01C304.48,-14436.06 324.42,-14432.52 343.32,-14430.19 761.21,-14378.58 2071.59,-14370.63 2471.96,-14369.41"/>
<polygon fill="black" stroke="black" points="2472.12,-14372.91 2482.11,-14369.38 2472.1,-14365.91 2472.12,-14372.91"/>
</g>
<!-- layer_1_all2all_back_1&#45;&gt;layer_1_output -->
<g id="edge158" class="edge">
<title>layer_1_all2all_back_1&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M606.75,-14439.99C625.79,-14436.07 645.57,-14432.55 664.32,-14430.19 1016.84,-14385.84 2110.7,-14373.09 2472.1,-14370.03"/>
<polygon fill="black" stroke="black" points="2472.35,-14373.53 2482.32,-14369.95 2472.29,-14366.53 2472.35,-14373.53"/>
</g>
<!-- layer_1_all2all_back_2&#45;&gt;layer_1_output -->
<g id="edge159" class="edge">
<title>layer_1_all2all_back_2&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M927.76,-14440.09C946.8,-14436.16 966.58,-14432.61 985.32,-14430.19 1272.83,-14393.09 2152.45,-14376 2471.86,-14370.9"/>
<polygon fill="black" stroke="black" points="2472.12,-14374.4 2482.06,-14370.74 2472.01,-14367.4 2472.12,-14374.4"/>
</g>
<!-- layer_1_all2all_back_3&#45;&gt;layer_1_output -->
<g id="edge160" class="edge">
<title>layer_1_all2all_back_3&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M1249.21,-14440.15C1268.12,-14436.23 1287.73,-14432.68 1306.32,-14430.19 1529.45,-14400.32 2198.68,-14379.62 2471.55,-14372.21"/>
<polygon fill="black" stroke="black" points="2471.98,-14375.7 2481.88,-14371.93 2471.79,-14368.7 2471.98,-14375.7"/>
</g>
<!-- layer_1_all2all_back_4&#45;&gt;layer_1_output -->
<g id="edge161" class="edge">
<title>layer_1_all2all_back_4&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M1570.68,-14440.3C1589.45,-14436.4 1608.89,-14432.8 1627.32,-14430.19 1929.78,-14387.27 2290.05,-14374.54 2471.88,-14370.77"/>
<polygon fill="black" stroke="black" points="2472.07,-14374.27 2482,-14370.57 2471.93,-14367.27 2472.07,-14374.27"/>
</g>
<!-- layer_1_all2all_back_5&#45;&gt;layer_1_output -->
<g id="edge162" class="edge">
<title>layer_1_all2all_back_5&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M1893.05,-14440.52C1911.41,-14436.66 1930.36,-14433.03 1948.32,-14430.19 2130.01,-14401.48 2342.95,-14384.47 2471.91,-14375.99"/>
<polygon fill="black" stroke="black" points="2472.45,-14379.46 2482.2,-14375.32 2471.99,-14372.48 2472.45,-14379.46"/>
</g>
<!-- layer_1_all2all_back_6&#45;&gt;layer_1_output -->
<g id="edge163" class="edge">
<title>layer_1_all2all_back_6&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M2217.35,-14441.27C2234.71,-14437.47 2252.5,-14433.66 2269.32,-14430.19 2336.35,-14416.36 2411.51,-14401.97 2472.14,-14390.65"/>
<polygon fill="black" stroke="black" points="2472.94,-14394.06 2482.13,-14388.79 2471.66,-14387.18 2472.94,-14394.06"/>
</g>
<!-- layer_1_all2all_back_7&#45;&gt;layer_1_output -->
<g id="edge164" class="edge">
<title>layer_1_all2all_back_7&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M2484.38,-14432.66C2502.09,-14421.95 2521.6,-14410.15 2538.95,-14399.65"/>
<polygon fill="black" stroke="black" points="2541.06,-14402.47 2547.81,-14394.3 2537.44,-14396.48 2541.06,-14402.47"/>
</g>
<!-- layer_1_all2all_back_8&#45;&gt;layer_1_output -->
<g id="edge165" class="edge">
<title>layer_1_all2all_back_8&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M2694.91,-14432.66C2677.1,-14421.95 2657.46,-14410.15 2640,-14399.65"/>
<polygon fill="black" stroke="black" points="2641.47,-14396.45 2631.09,-14394.3 2637.86,-14402.45 2641.47,-14396.45"/>
</g>
<!-- layer_1_all2all_back_9&#45;&gt;layer_1_output -->
<g id="edge166" class="edge">
<title>layer_1_all2all_back_9&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M2962.3,-14441.26C2944.93,-14437.46 2927.15,-14433.66 2910.32,-14430.19 2842.96,-14416.31 2767.39,-14401.89 2706.51,-14390.56"/>
<polygon fill="black" stroke="black" points="2706.96,-14387.09 2696.48,-14388.7 2705.68,-14393.97 2706.96,-14387.09"/>
</g>
<!-- layer_1_all2all_back_10&#45;&gt;layer_1_output -->
<g id="edge167" class="edge">
<title>layer_1_all2all_back_10&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M3286.59,-14440.51C3268.24,-14436.66 3249.28,-14433.03 3231.32,-14430.19 3049.22,-14401.42 2835.76,-14384.43 2706.63,-14375.96"/>
<polygon fill="black" stroke="black" points="2706.53,-14372.44 2696.33,-14375.29 2706.08,-14379.43 2706.53,-14372.44"/>
</g>
<!-- layer_1_all2all_back_11&#45;&gt;layer_1_output -->
<g id="edge168" class="edge">
<title>layer_1_all2all_back_11&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M3608.96,-14440.3C3590.2,-14436.4 3570.75,-14432.8 3552.32,-14430.19 3249.34,-14387.2 2888.42,-14374.5 2706.52,-14370.76"/>
<polygon fill="black" stroke="black" points="2706.46,-14367.25 2696.39,-14370.55 2706.32,-14374.25 2706.46,-14367.25"/>
</g>
<!-- layer_1_all2all_back_12&#45;&gt;layer_1_output -->
<g id="edge169" class="edge">
<title>layer_1_all2all_back_12&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M3930.43,-14440.15C3911.53,-14436.23 3891.91,-14432.68 3873.32,-14430.19 3649.88,-14400.29 2979.45,-14379.59 2706.68,-14372.19"/>
<polygon fill="black" stroke="black" points="2706.45,-14368.69 2696.36,-14371.91 2706.26,-14375.68 2706.45,-14368.69"/>
</g>
<!-- layer_1_all2all_back_13&#45;&gt;layer_1_output -->
<g id="edge170" class="edge">
<title>layer_1_all2all_back_13&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M4251.88,-14440.09C4232.84,-14436.16 4213.06,-14432.61 4194.32,-14430.19 3906.54,-14393.06 3025.94,-14375.99 2706.57,-14370.9"/>
<polygon fill="black" stroke="black" points="2706.42,-14367.39 2696.37,-14370.74 2706.31,-14374.39 2706.42,-14367.39"/>
</g>
<!-- layer_1_all2all_back_14&#45;&gt;layer_1_output -->
<g id="edge171" class="edge">
<title>layer_1_all2all_back_14&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M4572.89,-14439.99C4553.85,-14436.07 4534.07,-14432.55 4515.32,-14430.19 4162.62,-14385.82 3068.19,-14373.08 2706.6,-14370.03"/>
<polygon fill="black" stroke="black" points="2706.41,-14366.53 2696.38,-14369.95 2706.35,-14373.53 2706.41,-14366.53"/>
</g>
<!-- layer_1_all2all_back_15&#45;&gt;layer_1_output -->
<g id="edge172" class="edge">
<title>layer_1_all2all_back_15&#45;&gt;layer_1_output</title>
<path fill="none" stroke="black" d="M4894.33,-14440.01C4875.16,-14436.06 4855.22,-14432.52 4836.32,-14430.19 4418.25,-14378.56 3107.28,-14370.63 2706.73,-14369.41"/>
<polygon fill="black" stroke="black" points="2706.59,-14365.91 2696.58,-14369.38 2706.57,-14372.91 2706.59,-14365.91"/>
</g>
<!-- layer_2_tp_gather -->
<g id="node130" class="node">
<title>layer_2_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2589.32" cy="-14269.42" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2589.32" y="-14283.42" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2589.32" y="-14272.42" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2589.32" y="-14261.42" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2589.32" y="-14250.42" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_1_output&#45;&gt;layer_2_tp_gather -->
<g id="edge173" class="edge">
<title>layer_1_output&#45;&gt;layer_2_tp_gather</title>
<path fill="none" stroke="black" d="M2571.3,-14342.02C2569.64,-14334.04 2568.91,-14324.97 2569.1,-14316.02"/>
<polygon fill="black" stroke="black" points="2572.59,-14316.23 2569.71,-14306.03 2565.61,-14315.8 2572.59,-14316.23"/>
</g>
<!-- layer_1_output&#45;&gt;layer_2_tp_gather -->
<g id="edge175" class="edge">
<title>layer_1_output&#45;&gt;layer_2_tp_gather</title>
<path fill="none" stroke="black" d="M2583.32,-14342.02C2582.77,-14334.21 2582.53,-14325.34 2582.58,-14316.58"/>
<polygon fill="black" stroke="black" points="2586.08,-14316.46 2582.77,-14306.4 2579.08,-14316.33 2586.08,-14316.46"/>
</g>
<!-- layer_1_output&#45;&gt;layer_2_tp_gather -->
<g id="edge177" class="edge">
<title>layer_1_output&#45;&gt;layer_2_tp_gather</title>
<path fill="none" stroke="black" d="M2595.33,-14342.02C2595.87,-14334.21 2596.11,-14325.34 2596.06,-14316.58"/>
<polygon fill="black" stroke="black" points="2599.56,-14316.33 2595.87,-14306.4 2592.56,-14316.46 2599.56,-14316.33"/>
</g>
<!-- layer_1_output&#45;&gt;layer_2_tp_gather -->
<g id="edge179" class="edge">
<title>layer_1_output&#45;&gt;layer_2_tp_gather</title>
<path fill="none" stroke="black" d="M2607.34,-14342.02C2609,-14334.04 2609.73,-14324.97 2609.54,-14316.02"/>
<polygon fill="black" stroke="black" points="2613.03,-14315.8 2608.93,-14306.03 2606.05,-14316.23 2613.03,-14315.8"/>
</g>
<!-- layer_2_qkv_gpu0 -->
<g id="node129" class="node">
<title>layer_2_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2354.32,-14196.65 2148.32,-14196.65 2148.32,-14144.65 2354.32,-14144.65 2354.32,-14196.65"/>
<text text-anchor="middle" x="2251.32" y="-14184.65" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2251.32" y="-14173.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2251.32" y="-14162.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2251.32" y="-14151.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_2_attn_gpu0 -->
<g id="node134" class="node">
<title>layer_2_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2350.32,-14108.65 2148.32,-14108.65 2148.32,-14056.65 2350.32,-14056.65 2350.32,-14108.65"/>
<text text-anchor="middle" x="2249.32" y="-14096.65" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2249.32" y="-14085.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2249.32" y="-14074.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2249.32" y="-14063.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_2_qkv_gpu0&#45;&gt;layer_2_attn_gpu0 -->
<g id="edge181" class="edge">
<title>layer_2_qkv_gpu0&#45;&gt;layer_2_attn_gpu0</title>
<path fill="none" stroke="black" d="M2250.73,-14144.31C2250.55,-14136.35 2250.34,-14127.41 2250.14,-14118.9"/>
<polygon fill="black" stroke="black" points="2253.64,-14118.72 2249.91,-14108.81 2246.64,-14118.89 2253.64,-14118.72"/>
</g>
<!-- layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu0 -->
<g id="edge174" class="edge">
<title>layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2493.37,-14240.95C2448.09,-14227.99 2394.16,-14212.54 2348.7,-14199.53"/>
<polygon fill="black" stroke="black" points="2349.42,-14196.09 2338.84,-14196.71 2347.49,-14202.82 2349.42,-14196.09"/>
</g>
<!-- layer_2_qkv_gpu1 -->
<g id="node131" class="node">
<title>layer_2_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2580.32,-14196.65 2374.32,-14196.65 2374.32,-14144.65 2580.32,-14144.65 2580.32,-14196.65"/>
<text text-anchor="middle" x="2477.32" y="-14184.65" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2477.32" y="-14173.65" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2477.32" y="-14162.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2477.32" y="-14151.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu1 -->
<g id="edge176" class="edge">
<title>layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2549.2,-14233.76C2537.68,-14223.8 2525.17,-14213 2513.87,-14203.23"/>
<polygon fill="black" stroke="black" points="2516.13,-14200.55 2506.27,-14196.66 2511.55,-14205.85 2516.13,-14200.55"/>
</g>
<!-- layer_2_qkv_gpu2 -->
<g id="node132" class="node">
<title>layer_2_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2805.32,-14196.65 2599.32,-14196.65 2599.32,-14144.65 2805.32,-14144.65 2805.32,-14196.65"/>
<text text-anchor="middle" x="2702.32" y="-14184.65" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2702.32" y="-14173.65" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2702.32" y="-14162.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2702.32" y="-14151.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu2 -->
<g id="edge178" class="edge">
<title>layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2629.8,-14233.76C2641.43,-14223.8 2654.04,-14213 2665.44,-14203.23"/>
<polygon fill="black" stroke="black" points="2667.79,-14205.83 2673.11,-14196.66 2663.24,-14200.51 2667.79,-14205.83"/>
</g>
<!-- layer_2_qkv_gpu3 -->
<g id="node133" class="node">
<title>layer_2_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3034.32,-14196.65 2828.32,-14196.65 2828.32,-14144.65 3034.32,-14144.65 3034.32,-14196.65"/>
<text text-anchor="middle" x="2931.32" y="-14184.65" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2931.32" y="-14173.65" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2931.32" y="-14162.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2931.32" y="-14151.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu3 -->
<g id="edge180" class="edge">
<title>layer_2_tp_gather&#45;&gt;layer_2_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2685.95,-14241.08C2731.96,-14228.06 2786.89,-14212.52 2833.11,-14199.44"/>
<polygon fill="black" stroke="black" points="2834.16,-14202.78 2842.83,-14196.69 2832.25,-14196.04 2834.16,-14202.78"/>
</g>
<!-- layer_2_attn_gpu1 -->
<g id="node135" class="node">
<title>layer_2_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2573.32,-14108.65 2371.32,-14108.65 2371.32,-14056.65 2573.32,-14056.65 2573.32,-14108.65"/>
<text text-anchor="middle" x="2472.32" y="-14096.65" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2472.32" y="-14085.65" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2472.32" y="-14074.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2472.32" y="-14063.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_2_qkv_gpu1&#45;&gt;layer_2_attn_gpu1 -->
<g id="edge182" class="edge">
<title>layer_2_qkv_gpu1&#45;&gt;layer_2_attn_gpu1</title>
<path fill="none" stroke="black" d="M2475.85,-14144.31C2475.38,-14136.35 2474.87,-14127.41 2474.37,-14118.9"/>
<polygon fill="black" stroke="black" points="2477.86,-14118.59 2473.78,-14108.81 2470.87,-14118.99 2477.86,-14118.59"/>
</g>
<!-- layer_2_attn_gpu2 -->
<g id="node136" class="node">
<title>layer_2_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2803.32,-14108.65 2601.32,-14108.65 2601.32,-14056.65 2803.32,-14056.65 2803.32,-14108.65"/>
<text text-anchor="middle" x="2702.32" y="-14096.65" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2702.32" y="-14085.65" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2702.32" y="-14074.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2702.32" y="-14063.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_2_qkv_gpu2&#45;&gt;layer_2_attn_gpu2 -->
<g id="edge183" class="edge">
<title>layer_2_qkv_gpu2&#45;&gt;layer_2_attn_gpu2</title>
<path fill="none" stroke="black" d="M2702.32,-14144.31C2702.32,-14136.35 2702.32,-14127.41 2702.32,-14118.9"/>
<polygon fill="black" stroke="black" points="2705.82,-14118.81 2702.32,-14108.81 2698.82,-14118.81 2705.82,-14118.81"/>
</g>
<!-- layer_2_attn_gpu3 -->
<g id="node137" class="node">
<title>layer_2_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3034.32,-14108.65 2832.32,-14108.65 2832.32,-14056.65 3034.32,-14056.65 3034.32,-14108.65"/>
<text text-anchor="middle" x="2933.32" y="-14096.65" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2933.32" y="-14085.65" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2933.32" y="-14074.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2933.32" y="-14063.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_2_qkv_gpu3&#45;&gt;layer_2_attn_gpu3 -->
<g id="edge184" class="edge">
<title>layer_2_qkv_gpu3&#45;&gt;layer_2_attn_gpu3</title>
<path fill="none" stroke="black" d="M2931.91,-14144.31C2932.1,-14136.35 2932.3,-14127.41 2932.5,-14118.9"/>
<polygon fill="black" stroke="black" points="2936,-14118.89 2932.74,-14108.81 2929,-14118.72 2936,-14118.89"/>
</g>
<!-- layer_2_attn_out_gpu0 -->
<g id="node138" class="node">
<title>layer_2_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2346.32,-14020.65 2132.32,-14020.65 2132.32,-13968.65 2346.32,-13968.65 2346.32,-14020.65"/>
<text text-anchor="middle" x="2239.32" y="-14008.65" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2239.32" y="-13997.65" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2239.32" y="-13986.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2239.32" y="-13975.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_attn_gpu0&#45;&gt;layer_2_attn_out_gpu0 -->
<g id="edge185" class="edge">
<title>layer_2_attn_gpu0&#45;&gt;layer_2_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2246.37,-14056.31C2245.45,-14048.35 2244.41,-14039.41 2243.42,-14030.9"/>
<polygon fill="black" stroke="black" points="2246.88,-14030.34 2242.25,-14020.81 2239.92,-14031.14 2246.88,-14030.34"/>
</g>
<!-- layer_2_attn_out_gpu1 -->
<g id="node139" class="node">
<title>layer_2_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2578.32,-14020.65 2364.32,-14020.65 2364.32,-13968.65 2578.32,-13968.65 2578.32,-14020.65"/>
<text text-anchor="middle" x="2471.32" y="-14008.65" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2471.32" y="-13997.65" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2471.32" y="-13986.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2471.32" y="-13975.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_attn_gpu1&#45;&gt;layer_2_attn_out_gpu1 -->
<g id="edge186" class="edge">
<title>layer_2_attn_gpu1&#45;&gt;layer_2_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2472.03,-14056.31C2471.93,-14048.35 2471.83,-14039.41 2471.73,-14030.9"/>
<polygon fill="black" stroke="black" points="2475.23,-14030.77 2471.61,-14020.81 2468.23,-14030.85 2475.23,-14030.77"/>
</g>
<!-- layer_2_attn_out_gpu2 -->
<g id="node140" class="node">
<title>layer_2_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2810.32,-14020.65 2596.32,-14020.65 2596.32,-13968.65 2810.32,-13968.65 2810.32,-14020.65"/>
<text text-anchor="middle" x="2703.32" y="-14008.65" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2703.32" y="-13997.65" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2703.32" y="-13986.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2703.32" y="-13975.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_attn_gpu2&#45;&gt;layer_2_attn_out_gpu2 -->
<g id="edge187" class="edge">
<title>layer_2_attn_gpu2&#45;&gt;layer_2_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2702.62,-14056.31C2702.71,-14048.35 2702.81,-14039.41 2702.91,-14030.9"/>
<polygon fill="black" stroke="black" points="2706.41,-14030.85 2703.03,-14020.81 2699.41,-14030.77 2706.41,-14030.85"/>
</g>
<!-- layer_2_attn_out_gpu3 -->
<g id="node141" class="node">
<title>layer_2_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3042.32,-14020.65 2828.32,-14020.65 2828.32,-13968.65 3042.32,-13968.65 3042.32,-14020.65"/>
<text text-anchor="middle" x="2935.32" y="-14008.65" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2935.32" y="-13997.65" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2935.32" y="-13986.65" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2935.32" y="-13975.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_attn_gpu3&#45;&gt;layer_2_attn_out_gpu3 -->
<g id="edge188" class="edge">
<title>layer_2_attn_gpu3&#45;&gt;layer_2_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2933.91,-14056.31C2934.1,-14048.35 2934.3,-14039.41 2934.5,-14030.9"/>
<polygon fill="black" stroke="black" points="2938,-14030.89 2934.74,-14020.81 2931,-14030.72 2938,-14030.89"/>
</g>
<!-- layer_2_attn_allreduce -->
<g id="node142" class="node">
<title>layer_2_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2587.32" cy="-13895.88" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2587.32" y="-13909.88" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2587.32" y="-13898.88" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2587.32" y="-13887.88" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2587.32" y="-13876.88" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_attn_out_gpu0&#45;&gt;layer_2_attn_allreduce -->
<g id="edge189" class="edge">
<title>layer_2_attn_out_gpu0&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2329.39,-13968.6C2375.36,-13955.82 2431.61,-13940.18 2479.84,-13926.77"/>
<polygon fill="black" stroke="black" points="2480.99,-13930.08 2489.69,-13924.03 2479.11,-13923.34 2480.99,-13930.08"/>
</g>
<!-- layer_2_attn_out_gpu1&#45;&gt;layer_2_attn_allreduce -->
<g id="edge190" class="edge">
<title>layer_2_attn_out_gpu1&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2501.5,-13968.48C2512.73,-13959.11 2525.78,-13948.22 2538.26,-13937.8"/>
<polygon fill="black" stroke="black" points="2540.51,-13940.49 2545.94,-13931.4 2536.02,-13935.12 2540.51,-13940.49"/>
</g>
<!-- layer_2_attn_out_gpu2&#45;&gt;layer_2_attn_allreduce -->
<g id="edge191" class="edge">
<title>layer_2_attn_out_gpu2&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2673.15,-13968.48C2661.92,-13959.11 2648.86,-13948.22 2636.38,-13937.8"/>
<polygon fill="black" stroke="black" points="2638.62,-13935.12 2628.7,-13931.4 2634.13,-13940.49 2638.62,-13935.12"/>
</g>
<!-- layer_2_attn_out_gpu3&#45;&gt;layer_2_attn_allreduce -->
<g id="edge192" class="edge">
<title>layer_2_attn_out_gpu3&#45;&gt;layer_2_attn_allreduce</title>
<path fill="none" stroke="black" d="M2845.25,-13968.6C2799.28,-13955.82 2743.03,-13940.18 2694.8,-13926.77"/>
<polygon fill="black" stroke="black" points="2695.53,-13923.34 2684.96,-13924.03 2693.65,-13930.08 2695.53,-13923.34"/>
</g>
<!-- layer_2_gate -->
<g id="node143" class="node">
<title>layer_2_gate</title>
<polygon fill="lightyellow" stroke="black" points="2804.18,-13823.11 2459.2,-13823.11 2370.46,-13719.11 2715.44,-13719.11 2804.18,-13823.11"/>
<text text-anchor="middle" x="2587.32" y="-13785.11" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2587.32" y="-13774.11" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2587.32" y="-13763.11" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2587.32" y="-13752.11" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_2_attn_allreduce&#45;&gt;layer_2_gate -->
<g id="edge193" class="edge">
<title>layer_2_attn_allreduce&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2568.76,-13859.37C2567.65,-13851.33 2567.08,-13842.56 2567.07,-13833.79"/>
<polygon fill="black" stroke="black" points="2570.58,-13833.6 2567.31,-13823.52 2563.58,-13833.44 2570.58,-13833.6"/>
</g>
<!-- layer_2_attn_allreduce&#45;&gt;layer_2_gate -->
<g id="edge194" class="edge">
<title>layer_2_attn_allreduce&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2581.12,-13859.04C2580.75,-13851 2580.57,-13842.26 2580.57,-13833.51"/>
<polygon fill="black" stroke="black" points="2584.07,-13833.31 2580.65,-13823.28 2577.07,-13833.25 2584.07,-13833.31"/>
</g>
<!-- layer_2_attn_allreduce&#45;&gt;layer_2_gate -->
<g id="edge195" class="edge">
<title>layer_2_attn_allreduce&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2593.52,-13859.04C2593.89,-13851 2594.07,-13842.26 2594.07,-13833.51"/>
<polygon fill="black" stroke="black" points="2597.57,-13833.25 2593.99,-13823.28 2590.57,-13833.31 2597.57,-13833.25"/>
</g>
<!-- layer_2_attn_allreduce&#45;&gt;layer_2_gate -->
<g id="edge196" class="edge">
<title>layer_2_attn_allreduce&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2605.88,-13859.37C2606.99,-13851.33 2607.56,-13842.56 2607.57,-13833.79"/>
<polygon fill="black" stroke="black" points="2611.06,-13833.44 2607.33,-13823.52 2604.07,-13833.6 2611.06,-13833.44"/>
</g>
<!-- layer_2_all2all_expert_0 -->
<g id="node145" class="node">
<title>layer_2_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="204.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="204.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="204.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="204.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="204.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_0 -->
<g id="edge197" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2411.28,-13766.98C1959.66,-13758.35 767.96,-13731.55 375.32,-13683.11 357.2,-13680.88 338.16,-13677.72 319.61,-13674.19"/>
<polygon fill="black" stroke="black" points="320.16,-13670.73 309.67,-13672.25 318.82,-13677.6 320.16,-13670.73"/>
</g>
<!-- layer_2_all2all_expert_1 -->
<g id="node147" class="node">
<title>layer_2_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="532.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="532.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="532.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="532.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="532.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_1 -->
<g id="edge199" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2410.21,-13765.78C2005.83,-13755.28 1024.32,-13726.11 696.32,-13683.11 679.9,-13680.96 662.68,-13678 645.83,-13674.69"/>
<polygon fill="black" stroke="black" points="646.46,-13671.25 635.97,-13672.71 645.08,-13678.11 646.46,-13671.25"/>
</g>
<!-- layer_2_all2all_expert_2 -->
<g id="node149" class="node">
<title>layer_2_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="853.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="853.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="853.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="853.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="853.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_2 -->
<g id="edge201" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2413.49,-13769.83C2122.41,-13767.28 1518.57,-13753.07 1013.32,-13683.11 997.79,-13680.96 981.54,-13678.08 965.6,-13674.89"/>
<polygon fill="black" stroke="black" points="966.22,-13671.44 955.72,-13672.86 964.81,-13678.3 966.22,-13671.44"/>
</g>
<!-- layer_2_all2all_expert_3 -->
<g id="node151" class="node">
<title>layer_2_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1170.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1170.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1170.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1170.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1170.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_3 -->
<g id="edge203" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2410.62,-13766.36C2166.38,-13759.25 1712.34,-13739.11 1329.32,-13683.11 1314.28,-13680.91 1298.55,-13678.06 1283.08,-13674.93"/>
<polygon fill="black" stroke="black" points="1283.46,-13671.43 1272.96,-13672.83 1282.04,-13678.29 1283.46,-13671.43"/>
</g>
<!-- layer_2_all2all_expert_4 -->
<g id="node153" class="node">
<title>layer_2_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1486.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1486.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1486.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1486.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1486.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_4 -->
<g id="edge205" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2405.67,-13760.41C2215.13,-13748.6 1907.38,-13724.84 1644.32,-13683.11 1629.74,-13680.8 1614.49,-13677.93 1599.47,-13674.83"/>
<polygon fill="black" stroke="black" points="1600.14,-13671.4 1589.63,-13672.76 1598.7,-13678.25 1600.14,-13671.4"/>
</g>
<!-- layer_2_all2all_expert_5 -->
<g id="node155" class="node">
<title>layer_2_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1801.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1801.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1801.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1801.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1801.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_5 -->
<g id="edge207" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2394.97,-13747.89C2270.09,-13732.38 2104.04,-13709.74 1958.32,-13683.11 1944.47,-13680.58 1929.99,-13677.66 1915.66,-13674.6"/>
<polygon fill="black" stroke="black" points="1916.29,-13671.16 1905.78,-13672.47 1914.82,-13678 1916.29,-13671.16"/>
</g>
<!-- layer_2_all2all_expert_6 -->
<g id="node157" class="node">
<title>layer_2_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2115.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2115.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2115.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2115.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2115.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_6 -->
<g id="edge209" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2390.91,-13719.02C2334.31,-13704.3 2274.59,-13688.77 2225.27,-13675.94"/>
<polygon fill="black" stroke="black" points="2226.1,-13672.54 2215.54,-13673.41 2224.34,-13679.32 2226.1,-13672.54"/>
</g>
<!-- layer_2_all2all_expert_7 -->
<g id="node159" class="node">
<title>layer_2_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2429.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2429.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2429.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2429.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2429.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_7 -->
<g id="edge211" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2521.23,-13718.76C2508.05,-13708.52 2494.38,-13697.89 2481.73,-13688.07"/>
<polygon fill="black" stroke="black" points="2483.63,-13685.11 2473.59,-13681.74 2479.34,-13690.64 2483.63,-13685.11"/>
</g>
<!-- layer_2_all2all_expert_8 -->
<g id="node161" class="node">
<title>layer_2_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2745.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2745.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2745.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2745.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2745.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_8 -->
<g id="edge213" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2653.41,-13718.76C2666.59,-13708.52 2680.26,-13697.89 2692.91,-13688.07"/>
<polygon fill="black" stroke="black" points="2695.3,-13690.64 2701.05,-13681.74 2691.01,-13685.11 2695.3,-13690.64"/>
</g>
<!-- layer_2_all2all_expert_9 -->
<g id="node163" class="node">
<title>layer_2_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3063.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3063.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3063.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3063.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3063.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_9 -->
<g id="edge215" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2728.2,-13733.78C2799.93,-13715.28 2885.86,-13693.11 2952.74,-13675.86"/>
<polygon fill="black" stroke="black" points="2953.66,-13679.24 2962.47,-13673.35 2951.91,-13672.46 2953.66,-13679.24"/>
</g>
<!-- layer_2_all2all_expert_10 -->
<g id="node165" class="node">
<title>layer_2_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3383.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3383.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3383.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3383.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3383.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_10 -->
<g id="edge217" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2743.94,-13752.1C2872.38,-13736.49 3058.69,-13711.91 3220.32,-13683.11 3235.41,-13680.42 3251.23,-13677.32 3266.82,-13674.08"/>
<polygon fill="black" stroke="black" points="3267.96,-13677.42 3277.03,-13671.94 3266.53,-13670.57 3267.96,-13677.42"/>
</g>
<!-- layer_2_all2all_expert_11 -->
<g id="node167" class="node">
<title>layer_2_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3703.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3703.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3703.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3703.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3703.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_11 -->
<g id="edge219" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2751.66,-13761.37C2942.19,-13749.78 3265.31,-13725.67 3540.32,-13683.11 3555.97,-13680.69 3572.37,-13677.67 3588.48,-13674.42"/>
<polygon fill="black" stroke="black" points="3589.37,-13677.81 3598.46,-13672.37 3587.96,-13670.96 3589.37,-13677.81"/>
</g>
<!-- layer_2_all2all_expert_12 -->
<g id="node169" class="node">
<title>layer_2_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4024.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4024.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4024.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4024.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4024.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_12 -->
<g id="edge221" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2755.97,-13766.44C3000.49,-13759.34 3467.21,-13739.11 3860.32,-13683.11 3876.45,-13680.81 3893.35,-13677.82 3909.92,-13674.53"/>
<polygon fill="black" stroke="black" points="3911.08,-13677.87 3920.19,-13672.45 3909.69,-13671.01 3911.08,-13677.87"/>
</g>
<!-- layer_2_all2all_expert_13 -->
<g id="node171" class="node">
<title>layer_2_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4345.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4345.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4345.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4345.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4345.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_13 -->
<g id="edge223" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2758.9,-13769.73C3051.89,-13767.08 3666.89,-13752.79 4181.32,-13683.11 4197.74,-13680.89 4214.95,-13677.89 4231.79,-13674.57"/>
<polygon fill="black" stroke="black" points="4232.55,-13677.99 4241.66,-13672.58 4231.16,-13671.12 4232.55,-13677.99"/>
</g>
<!-- layer_2_all2all_expert_14 -->
<g id="node173" class="node">
<title>layer_2_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4666.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4666.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4666.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4666.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4666.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_14 -->
<g id="edge225" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2755.76,-13766.12C3158.24,-13755.99 4167.17,-13726.95 4502.32,-13683.11 4518.75,-13680.96 4535.96,-13678.01 4552.81,-13674.7"/>
<polygon fill="black" stroke="black" points="4553.56,-13678.12 4562.68,-13672.72 4552.18,-13671.26 4553.56,-13678.12"/>
</g>
<!-- layer_2_all2all_expert_15 -->
<g id="node175" class="node">
<title>layer_2_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4987.32" cy="-13646.34" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4987.32" y="-13660.34" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4987.32" y="-13649.34" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4987.32" y="-13638.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4987.32" y="-13627.34" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_all2all_expert_15 -->
<g id="edge227" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.66,-13767.38C3206.48,-13759.51 4424.1,-13734.01 4823.32,-13683.11 4839.87,-13681 4857.23,-13678.05 4874.19,-13674.73"/>
<polygon fill="black" stroke="black" points="4875.01,-13678.13 4884.13,-13672.74 4873.64,-13671.27 4875.01,-13678.13"/>
</g>
<!-- layer_2_expert_0_gpu0 -->
<g id="node144" class="node">
<title>layer_2_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="306.82,-13573.57 97.82,-13573.57 97.82,-13521.57 306.82,-13521.57 306.82,-13573.57"/>
<text text-anchor="middle" x="202.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="202.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="202.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="202.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_0 -->
<g id="node176" class="node">
<title>layer_2_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="178.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="178.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="178.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="178.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="178.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_0_gpu0&#45;&gt;layer_2_all2all_back_0 -->
<g id="edge229" class="edge">
<title>layer_2_expert_0_gpu0&#45;&gt;layer_2_all2all_back_0</title>
<path fill="none" stroke="black" d="M196.08,-13521.4C194.12,-13513.51 191.89,-13504.53 189.7,-13495.67"/>
<polygon fill="black" stroke="black" points="193.05,-13494.64 187.24,-13485.78 186.25,-13496.33 193.05,-13494.64"/>
</g>
<!-- layer_2_all2all_expert_0&#45;&gt;layer_2_expert_0_gpu0 -->
<g id="edge198" class="edge">
<title>layer_2_all2all_expert_0&#45;&gt;layer_2_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M203.58,-13609.31C203.4,-13601 203.22,-13592.16 203.05,-13583.88"/>
<polygon fill="black" stroke="black" points="206.55,-13583.69 202.84,-13573.77 199.55,-13583.84 206.55,-13583.69"/>
</g>
<!-- layer_2_expert_1_gpu0 -->
<g id="node146" class="node">
<title>layer_2_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="619.82,-13573.57 410.82,-13573.57 410.82,-13521.57 619.82,-13521.57 619.82,-13573.57"/>
<text text-anchor="middle" x="515.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="515.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="515.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="515.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_1 -->
<g id="node177" class="node">
<title>layer_2_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="499.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="499.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="499.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="499.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="499.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_1_gpu0&#45;&gt;layer_2_all2all_back_1 -->
<g id="edge230" class="edge">
<title>layer_2_expert_1_gpu0&#45;&gt;layer_2_all2all_back_1</title>
<path fill="none" stroke="black" d="M511.16,-13521.4C509.85,-13513.51 508.37,-13504.53 506.9,-13495.67"/>
<polygon fill="black" stroke="black" points="510.35,-13495.07 505.27,-13485.78 503.45,-13496.22 510.35,-13495.07"/>
</g>
<!-- layer_2_all2all_expert_1&#45;&gt;layer_2_expert_1_gpu0 -->
<g id="edge200" class="edge">
<title>layer_2_all2all_expert_1&#45;&gt;layer_2_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M526.04,-13609.58C524.55,-13601.09 522.96,-13592.03 521.47,-13583.57"/>
<polygon fill="black" stroke="black" points="524.9,-13582.86 519.72,-13573.62 518,-13584.07 524.9,-13582.86"/>
</g>
<!-- layer_2_expert_2_gpu1 -->
<g id="node148" class="node">
<title>layer_2_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="940.82,-13573.57 731.82,-13573.57 731.82,-13521.57 940.82,-13521.57 940.82,-13573.57"/>
<text text-anchor="middle" x="836.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="836.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="836.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="836.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_2 -->
<g id="node178" class="node">
<title>layer_2_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="820.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="820.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="820.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="820.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="820.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_2_gpu1&#45;&gt;layer_2_all2all_back_2 -->
<g id="edge231" class="edge">
<title>layer_2_expert_2_gpu1&#45;&gt;layer_2_all2all_back_2</title>
<path fill="none" stroke="black" d="M832.16,-13521.4C830.85,-13513.51 829.37,-13504.53 827.9,-13495.67"/>
<polygon fill="black" stroke="black" points="831.35,-13495.07 826.27,-13485.78 824.45,-13496.22 831.35,-13495.07"/>
</g>
<!-- layer_2_all2all_expert_2&#45;&gt;layer_2_expert_2_gpu1 -->
<g id="edge202" class="edge">
<title>layer_2_all2all_expert_2&#45;&gt;layer_2_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M847.04,-13609.58C845.55,-13601.09 843.96,-13592.03 842.47,-13583.57"/>
<polygon fill="black" stroke="black" points="845.9,-13582.86 840.72,-13573.62 839,-13584.07 845.9,-13582.86"/>
</g>
<!-- layer_2_expert_3_gpu1 -->
<g id="node150" class="node">
<title>layer_2_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1259.82,-13573.57 1050.82,-13573.57 1050.82,-13521.57 1259.82,-13521.57 1259.82,-13573.57"/>
<text text-anchor="middle" x="1155.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1155.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1155.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1155.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_3 -->
<g id="node179" class="node">
<title>layer_2_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1141.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1141.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1141.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1141.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1141.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_3_gpu1&#45;&gt;layer_2_all2all_back_3 -->
<g id="edge232" class="edge">
<title>layer_2_expert_3_gpu1&#45;&gt;layer_2_all2all_back_3</title>
<path fill="none" stroke="black" d="M1151.68,-13521.4C1150.55,-13513.59 1149.27,-13504.73 1148,-13495.96"/>
<polygon fill="black" stroke="black" points="1151.42,-13495.18 1146.53,-13485.78 1144.49,-13496.18 1151.42,-13495.18"/>
</g>
<!-- layer_2_all2all_expert_3&#45;&gt;layer_2_expert_3_gpu1 -->
<g id="edge204" class="edge">
<title>layer_2_all2all_expert_3&#45;&gt;layer_2_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1164.78,-13609.58C1163.46,-13601.09 1162.06,-13592.03 1160.75,-13583.57"/>
<polygon fill="black" stroke="black" points="1164.19,-13582.96 1159.2,-13573.62 1157.28,-13584.03 1164.19,-13582.96"/>
</g>
<!-- layer_2_expert_4_gpu2 -->
<g id="node152" class="node">
<title>layer_2_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1580.82,-13573.57 1371.82,-13573.57 1371.82,-13521.57 1580.82,-13521.57 1580.82,-13573.57"/>
<text text-anchor="middle" x="1476.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1476.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1476.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1476.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_4 -->
<g id="node180" class="node">
<title>layer_2_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1462.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1462.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1462.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1462.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1462.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_4_gpu2&#45;&gt;layer_2_all2all_back_4 -->
<g id="edge233" class="edge">
<title>layer_2_expert_4_gpu2&#45;&gt;layer_2_all2all_back_4</title>
<path fill="none" stroke="black" d="M1472.68,-13521.4C1471.55,-13513.59 1470.27,-13504.73 1469,-13495.96"/>
<polygon fill="black" stroke="black" points="1472.42,-13495.18 1467.53,-13485.78 1465.49,-13496.18 1472.42,-13495.18"/>
</g>
<!-- layer_2_all2all_expert_4&#45;&gt;layer_2_expert_4_gpu2 -->
<g id="edge206" class="edge">
<title>layer_2_all2all_expert_4&#45;&gt;layer_2_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1482.63,-13609.58C1481.75,-13601.09 1480.81,-13592.03 1479.94,-13583.57"/>
<polygon fill="black" stroke="black" points="1483.42,-13583.2 1478.91,-13573.62 1476.46,-13583.92 1483.42,-13583.2"/>
</g>
<!-- layer_2_expert_5_gpu2 -->
<g id="node154" class="node">
<title>layer_2_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1898.82,-13573.57 1689.82,-13573.57 1689.82,-13521.57 1898.82,-13521.57 1898.82,-13573.57"/>
<text text-anchor="middle" x="1794.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1794.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1794.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1794.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_5 -->
<g id="node181" class="node">
<title>layer_2_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1783.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1783.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1783.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1783.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1783.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_5_gpu2&#45;&gt;layer_2_all2all_back_5 -->
<g id="edge234" class="edge">
<title>layer_2_expert_5_gpu2&#45;&gt;layer_2_all2all_back_5</title>
<path fill="none" stroke="black" d="M1791.46,-13521.4C1790.57,-13513.59 1789.56,-13504.73 1788.57,-13495.96"/>
<polygon fill="black" stroke="black" points="1792.02,-13495.32 1787.41,-13485.78 1785.06,-13496.11 1792.02,-13495.32"/>
</g>
<!-- layer_2_all2all_expert_5&#45;&gt;layer_2_expert_5_gpu2 -->
<g id="edge208" class="edge">
<title>layer_2_all2all_expert_5&#45;&gt;layer_2_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1798.71,-13609.31C1798.11,-13601 1797.47,-13592.16 1796.88,-13583.88"/>
<polygon fill="black" stroke="black" points="1800.36,-13583.49 1796.14,-13573.77 1793.37,-13584 1800.36,-13583.49"/>
</g>
<!-- layer_2_expert_6_gpu3 -->
<g id="node156" class="node">
<title>layer_2_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2216.82,-13573.57 2007.82,-13573.57 2007.82,-13521.57 2216.82,-13521.57 2216.82,-13573.57"/>
<text text-anchor="middle" x="2112.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2112.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2112.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2112.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_6 -->
<g id="node182" class="node">
<title>layer_2_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2104.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2104.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2104.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2104.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2104.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_6_gpu3&#45;&gt;layer_2_all2all_back_6 -->
<g id="edge235" class="edge">
<title>layer_2_expert_6_gpu3&#45;&gt;layer_2_all2all_back_6</title>
<path fill="none" stroke="black" d="M2110.24,-13521.4C2109.59,-13513.59 2108.86,-13504.73 2108.14,-13495.96"/>
<polygon fill="black" stroke="black" points="2111.61,-13495.46 2107.3,-13485.78 2104.63,-13496.03 2111.61,-13495.46"/>
</g>
<!-- layer_2_all2all_expert_6&#45;&gt;layer_2_expert_6_gpu3 -->
<g id="edge210" class="edge">
<title>layer_2_all2all_expert_6&#45;&gt;layer_2_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2114.2,-13609.31C2113.95,-13601 2113.67,-13592.16 2113.42,-13583.88"/>
<polygon fill="black" stroke="black" points="2116.91,-13583.66 2113.1,-13573.77 2109.91,-13583.87 2116.91,-13583.66"/>
</g>
<!-- layer_2_expert_7_gpu3 -->
<g id="node158" class="node">
<title>layer_2_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2530.82,-13573.57 2321.82,-13573.57 2321.82,-13521.57 2530.82,-13521.57 2530.82,-13573.57"/>
<text text-anchor="middle" x="2426.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2426.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2426.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2426.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_7 -->
<g id="node183" class="node">
<title>layer_2_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2425.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2425.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2425.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2425.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2425.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_7_gpu3&#45;&gt;layer_2_all2all_back_7 -->
<g id="edge236" class="edge">
<title>layer_2_expert_7_gpu3&#45;&gt;layer_2_all2all_back_7</title>
<path fill="none" stroke="black" d="M2426.06,-13521.4C2425.98,-13513.59 2425.89,-13504.73 2425.8,-13495.96"/>
<polygon fill="black" stroke="black" points="2429.3,-13495.74 2425.69,-13485.78 2422.3,-13495.82 2429.3,-13495.74"/>
</g>
<!-- layer_2_all2all_expert_7&#45;&gt;layer_2_expert_7_gpu3 -->
<g id="edge212" class="edge">
<title>layer_2_all2all_expert_7&#45;&gt;layer_2_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2428.2,-13609.31C2427.95,-13601 2427.67,-13592.16 2427.42,-13583.88"/>
<polygon fill="black" stroke="black" points="2430.91,-13583.66 2427.1,-13573.77 2423.91,-13583.87 2430.91,-13583.66"/>
</g>
<!-- layer_2_expert_8_gpu4 -->
<g id="node160" class="node">
<title>layer_2_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2849.82,-13573.57 2640.82,-13573.57 2640.82,-13521.57 2849.82,-13521.57 2849.82,-13573.57"/>
<text text-anchor="middle" x="2745.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2745.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2745.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2745.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_8 -->
<g id="node184" class="node">
<title>layer_2_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2746.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2746.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2746.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2746.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2746.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_8_gpu4&#45;&gt;layer_2_all2all_back_8 -->
<g id="edge237" class="edge">
<title>layer_2_expert_8_gpu4&#45;&gt;layer_2_all2all_back_8</title>
<path fill="none" stroke="black" d="M2745.58,-13521.4C2745.66,-13513.59 2745.75,-13504.73 2745.84,-13495.96"/>
<polygon fill="black" stroke="black" points="2749.35,-13495.82 2745.95,-13485.78 2742.35,-13495.74 2749.35,-13495.82"/>
</g>
<!-- layer_2_all2all_expert_8&#45;&gt;layer_2_expert_8_gpu4 -->
<g id="edge214" class="edge">
<title>layer_2_all2all_expert_8&#45;&gt;layer_2_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2745.32,-13609.31C2745.32,-13601 2745.32,-13592.16 2745.32,-13583.88"/>
<polygon fill="black" stroke="black" points="2748.82,-13583.77 2745.32,-13573.77 2741.82,-13583.77 2748.82,-13583.77"/>
</g>
<!-- layer_2_expert_9_gpu4 -->
<g id="node162" class="node">
<title>layer_2_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3169.82,-13573.57 2960.82,-13573.57 2960.82,-13521.57 3169.82,-13521.57 3169.82,-13573.57"/>
<text text-anchor="middle" x="3065.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3065.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3065.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3065.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_9 -->
<g id="node185" class="node">
<title>layer_2_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3067.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3067.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3067.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3067.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3067.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_9_gpu4&#45;&gt;layer_2_all2all_back_9 -->
<g id="edge238" class="edge">
<title>layer_2_expert_9_gpu4&#45;&gt;layer_2_all2all_back_9</title>
<path fill="none" stroke="black" d="M3065.84,-13521.4C3066,-13513.59 3066.19,-13504.73 3066.37,-13495.96"/>
<polygon fill="black" stroke="black" points="3069.87,-13495.85 3066.58,-13485.78 3062.87,-13495.7 3069.87,-13495.85"/>
</g>
<!-- layer_2_all2all_expert_9&#45;&gt;layer_2_expert_9_gpu4 -->
<g id="edge216" class="edge">
<title>layer_2_all2all_expert_9&#45;&gt;layer_2_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3064.07,-13609.31C3064.24,-13601 3064.42,-13592.16 3064.59,-13583.88"/>
<polygon fill="black" stroke="black" points="3068.09,-13583.84 3064.8,-13573.77 3061.09,-13583.69 3068.09,-13583.84"/>
</g>
<!-- layer_2_expert_10_gpu5 -->
<g id="node164" class="node">
<title>layer_2_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3489.82,-13573.57 3280.82,-13573.57 3280.82,-13521.57 3489.82,-13521.57 3489.82,-13573.57"/>
<text text-anchor="middle" x="3385.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3385.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3385.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3385.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_10 -->
<g id="node186" class="node">
<title>layer_2_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3388.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3388.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3388.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3388.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3388.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_10_gpu5&#45;&gt;layer_2_all2all_back_10 -->
<g id="edge239" class="edge">
<title>layer_2_expert_10_gpu5&#45;&gt;layer_2_all2all_back_10</title>
<path fill="none" stroke="black" d="M3386.1,-13521.4C3386.34,-13513.59 3386.62,-13504.73 3386.89,-13495.96"/>
<polygon fill="black" stroke="black" points="3390.39,-13495.88 3387.21,-13485.78 3383.4,-13495.67 3390.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_10&#45;&gt;layer_2_expert_10_gpu5 -->
<g id="edge218" class="edge">
<title>layer_2_all2all_expert_10&#45;&gt;layer_2_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3384.07,-13609.31C3384.24,-13601 3384.42,-13592.16 3384.59,-13583.88"/>
<polygon fill="black" stroke="black" points="3388.09,-13583.84 3384.8,-13573.77 3381.09,-13583.69 3388.09,-13583.84"/>
</g>
<!-- layer_2_expert_11_gpu5 -->
<g id="node166" class="node">
<title>layer_2_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3810.82,-13573.57 3601.82,-13573.57 3601.82,-13521.57 3810.82,-13521.57 3810.82,-13573.57"/>
<text text-anchor="middle" x="3706.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3706.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3706.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3706.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_11 -->
<g id="node187" class="node">
<title>layer_2_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3709.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3709.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3709.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3709.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3709.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_11_gpu5&#45;&gt;layer_2_all2all_back_11 -->
<g id="edge240" class="edge">
<title>layer_2_expert_11_gpu5&#45;&gt;layer_2_all2all_back_11</title>
<path fill="none" stroke="black" d="M3707.1,-13521.4C3707.34,-13513.59 3707.62,-13504.73 3707.89,-13495.96"/>
<polygon fill="black" stroke="black" points="3711.39,-13495.88 3708.21,-13485.78 3704.4,-13495.67 3711.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_11&#45;&gt;layer_2_expert_11_gpu5 -->
<g id="edge220" class="edge">
<title>layer_2_all2all_expert_11&#45;&gt;layer_2_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3704.44,-13609.31C3704.7,-13601 3704.97,-13592.16 3705.23,-13583.88"/>
<polygon fill="black" stroke="black" points="3708.73,-13583.87 3705.54,-13573.77 3701.73,-13583.66 3708.73,-13583.87"/>
</g>
<!-- layer_2_expert_12_gpu6 -->
<g id="node168" class="node">
<title>layer_2_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4131.82,-13573.57 3922.82,-13573.57 3922.82,-13521.57 4131.82,-13521.57 4131.82,-13573.57"/>
<text text-anchor="middle" x="4027.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4027.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4027.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4027.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_12 -->
<g id="node188" class="node">
<title>layer_2_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4030.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4030.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4030.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4030.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4030.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_12_gpu6&#45;&gt;layer_2_all2all_back_12 -->
<g id="edge241" class="edge">
<title>layer_2_expert_12_gpu6&#45;&gt;layer_2_all2all_back_12</title>
<path fill="none" stroke="black" d="M4028.1,-13521.4C4028.34,-13513.59 4028.62,-13504.73 4028.89,-13495.96"/>
<polygon fill="black" stroke="black" points="4032.39,-13495.88 4029.21,-13485.78 4025.4,-13495.67 4032.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_12&#45;&gt;layer_2_expert_12_gpu6 -->
<g id="edge222" class="edge">
<title>layer_2_all2all_expert_12&#45;&gt;layer_2_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4025.44,-13609.31C4025.7,-13601 4025.97,-13592.16 4026.23,-13583.88"/>
<polygon fill="black" stroke="black" points="4029.73,-13583.87 4026.54,-13573.77 4022.73,-13583.66 4029.73,-13583.87"/>
</g>
<!-- layer_2_expert_13_gpu6 -->
<g id="node170" class="node">
<title>layer_2_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4452.82,-13573.57 4243.82,-13573.57 4243.82,-13521.57 4452.82,-13521.57 4452.82,-13573.57"/>
<text text-anchor="middle" x="4348.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4348.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4348.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4348.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_13 -->
<g id="node189" class="node">
<title>layer_2_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4351.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4351.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4351.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4351.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4351.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_13_gpu6&#45;&gt;layer_2_all2all_back_13 -->
<g id="edge242" class="edge">
<title>layer_2_expert_13_gpu6&#45;&gt;layer_2_all2all_back_13</title>
<path fill="none" stroke="black" d="M4349.1,-13521.4C4349.34,-13513.59 4349.62,-13504.73 4349.89,-13495.96"/>
<polygon fill="black" stroke="black" points="4353.39,-13495.88 4350.21,-13485.78 4346.4,-13495.67 4353.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_13&#45;&gt;layer_2_expert_13_gpu6 -->
<g id="edge224" class="edge">
<title>layer_2_all2all_expert_13&#45;&gt;layer_2_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4346.44,-13609.31C4346.7,-13601 4346.97,-13592.16 4347.23,-13583.88"/>
<polygon fill="black" stroke="black" points="4350.73,-13583.87 4347.54,-13573.77 4343.73,-13583.66 4350.73,-13583.87"/>
</g>
<!-- layer_2_expert_14_gpu7 -->
<g id="node172" class="node">
<title>layer_2_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4773.82,-13573.57 4564.82,-13573.57 4564.82,-13521.57 4773.82,-13521.57 4773.82,-13573.57"/>
<text text-anchor="middle" x="4669.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4669.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4669.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4669.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_14 -->
<g id="node190" class="node">
<title>layer_2_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4672.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4672.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4672.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4672.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4672.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_14_gpu7&#45;&gt;layer_2_all2all_back_14 -->
<g id="edge243" class="edge">
<title>layer_2_expert_14_gpu7&#45;&gt;layer_2_all2all_back_14</title>
<path fill="none" stroke="black" d="M4670.1,-13521.4C4670.34,-13513.59 4670.62,-13504.73 4670.89,-13495.96"/>
<polygon fill="black" stroke="black" points="4674.39,-13495.88 4671.21,-13485.78 4667.4,-13495.67 4674.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_14&#45;&gt;layer_2_expert_14_gpu7 -->
<g id="edge226" class="edge">
<title>layer_2_all2all_expert_14&#45;&gt;layer_2_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4667.44,-13609.31C4667.7,-13601 4667.97,-13592.16 4668.23,-13583.88"/>
<polygon fill="black" stroke="black" points="4671.73,-13583.87 4668.54,-13573.77 4664.73,-13583.66 4671.73,-13583.87"/>
</g>
<!-- layer_2_expert_15_gpu7 -->
<g id="node174" class="node">
<title>layer_2_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5094.82,-13573.57 4885.82,-13573.57 4885.82,-13521.57 5094.82,-13521.57 5094.82,-13573.57"/>
<text text-anchor="middle" x="4990.32" y="-13561.57" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4990.32" y="-13550.57" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4990.32" y="-13539.57" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4990.32" y="-13528.57" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_15 -->
<g id="node191" class="node">
<title>layer_2_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4993.32" cy="-13448.8" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4993.32" y="-13462.8" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4993.32" y="-13451.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4993.32" y="-13440.8" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4993.32" y="-13429.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_expert_15_gpu7&#45;&gt;layer_2_all2all_back_15 -->
<g id="edge244" class="edge">
<title>layer_2_expert_15_gpu7&#45;&gt;layer_2_all2all_back_15</title>
<path fill="none" stroke="black" d="M4991.1,-13521.4C4991.34,-13513.59 4991.62,-13504.73 4991.89,-13495.96"/>
<polygon fill="black" stroke="black" points="4995.39,-13495.88 4992.21,-13485.78 4988.4,-13495.67 4995.39,-13495.88"/>
</g>
<!-- layer_2_all2all_expert_15&#45;&gt;layer_2_expert_15_gpu7 -->
<g id="edge228" class="edge">
<title>layer_2_all2all_expert_15&#45;&gt;layer_2_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4988.44,-13609.31C4988.7,-13601 4988.97,-13592.16 4989.23,-13583.88"/>
<polygon fill="black" stroke="black" points="4992.73,-13583.87 4989.54,-13573.77 4985.73,-13583.66 4992.73,-13583.87"/>
</g>
<!-- layer_2_output -->
<g id="node192" class="node">
<title>layer_2_output</title>
<polygon fill="lightblue" stroke="black" points="2692.32,-13376.03 2478.32,-13376.03 2478.32,-13324.03 2692.32,-13324.03 2692.32,-13376.03"/>
<text text-anchor="middle" x="2585.32" y="-13364.03" font-family="Arial" font-size="10.00">Layer 2 Output</text>
<text text-anchor="middle" x="2585.32" y="-13353.03" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2585.32" y="-13342.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2585.32" y="-13331.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_2_all2all_back_0&#45;&gt;layer_2_output -->
<g id="edge245" class="edge">
<title>layer_2_all2all_back_0&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M281.31,-13421.86C300.48,-13417.9 320.42,-13414.37 339.32,-13412.03 757.21,-13360.42 2067.59,-13352.48 2467.96,-13351.26"/>
<polygon fill="black" stroke="black" points="2468.12,-13354.76 2478.11,-13351.23 2468.1,-13347.76 2468.12,-13354.76"/>
</g>
<!-- layer_2_all2all_back_1&#45;&gt;layer_2_output -->
<g id="edge246" class="edge">
<title>layer_2_all2all_back_1&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M602.75,-13421.84C621.79,-13417.91 641.57,-13414.39 660.32,-13412.03 1012.84,-13367.68 2106.7,-13354.93 2468.1,-13351.88"/>
<polygon fill="black" stroke="black" points="2468.35,-13355.37 2478.32,-13351.79 2468.29,-13348.38 2468.35,-13355.37"/>
</g>
<!-- layer_2_all2all_back_2&#45;&gt;layer_2_output -->
<g id="edge247" class="edge">
<title>layer_2_all2all_back_2&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M923.76,-13421.94C942.8,-13418 962.58,-13414.45 981.32,-13412.03 1268.83,-13374.94 2148.45,-13357.85 2467.86,-13352.75"/>
<polygon fill="black" stroke="black" points="2468.12,-13356.24 2478.06,-13352.59 2468.01,-13349.24 2468.12,-13356.24"/>
</g>
<!-- layer_2_all2all_back_3&#45;&gt;layer_2_output -->
<g id="edge248" class="edge">
<title>layer_2_all2all_back_3&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M1245.21,-13421.99C1264.12,-13418.08 1283.73,-13414.52 1302.32,-13412.03 1525.45,-13382.17 2194.68,-13361.47 2467.55,-13354.05"/>
<polygon fill="black" stroke="black" points="2467.98,-13357.54 2477.88,-13353.77 2467.79,-13350.55 2467.98,-13357.54"/>
</g>
<!-- layer_2_all2all_back_4&#45;&gt;layer_2_output -->
<g id="edge249" class="edge">
<title>layer_2_all2all_back_4&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M1566.68,-13422.15C1585.45,-13418.24 1604.89,-13414.65 1623.32,-13412.03 1925.78,-13369.11 2286.05,-13356.38 2467.88,-13352.62"/>
<polygon fill="black" stroke="black" points="2468.07,-13356.11 2478,-13352.41 2467.93,-13349.11 2468.07,-13356.11"/>
</g>
<!-- layer_2_all2all_back_5&#45;&gt;layer_2_output -->
<g id="edge250" class="edge">
<title>layer_2_all2all_back_5&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M1889.05,-13422.36C1907.41,-13418.5 1926.36,-13414.87 1944.32,-13412.03 2126.01,-13383.32 2338.95,-13366.32 2467.91,-13357.83"/>
<polygon fill="black" stroke="black" points="2468.45,-13361.3 2478.2,-13357.16 2467.99,-13354.32 2468.45,-13361.3"/>
</g>
<!-- layer_2_all2all_back_6&#45;&gt;layer_2_output -->
<g id="edge251" class="edge">
<title>layer_2_all2all_back_6&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M2213.35,-13423.11C2230.71,-13419.31 2248.5,-13415.51 2265.32,-13412.03 2332.35,-13398.2 2407.51,-13383.82 2468.14,-13372.49"/>
<polygon fill="black" stroke="black" points="2468.94,-13375.9 2478.13,-13370.63 2467.66,-13369.02 2468.94,-13375.9"/>
</g>
<!-- layer_2_all2all_back_7&#45;&gt;layer_2_output -->
<g id="edge252" class="edge">
<title>layer_2_all2all_back_7&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M2480.38,-13414.5C2498.09,-13403.79 2517.6,-13391.99 2534.95,-13381.5"/>
<polygon fill="black" stroke="black" points="2537.06,-13384.31 2543.81,-13376.14 2533.44,-13378.32 2537.06,-13384.31"/>
</g>
<!-- layer_2_all2all_back_8&#45;&gt;layer_2_output -->
<g id="edge253" class="edge">
<title>layer_2_all2all_back_8&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M2690.91,-13414.5C2673.1,-13403.79 2653.46,-13391.99 2636,-13381.5"/>
<polygon fill="black" stroke="black" points="2637.47,-13378.29 2627.09,-13376.14 2633.86,-13384.29 2637.47,-13378.29"/>
</g>
<!-- layer_2_all2all_back_9&#45;&gt;layer_2_output -->
<g id="edge254" class="edge">
<title>layer_2_all2all_back_9&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M2958.3,-13423.1C2940.93,-13419.31 2923.15,-13415.5 2906.32,-13412.03 2838.96,-13398.15 2763.39,-13383.74 2702.51,-13372.41"/>
<polygon fill="black" stroke="black" points="2702.96,-13368.93 2692.48,-13370.54 2701.68,-13375.81 2702.96,-13368.93"/>
</g>
<!-- layer_2_all2all_back_10&#45;&gt;layer_2_output -->
<g id="edge255" class="edge">
<title>layer_2_all2all_back_10&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M3282.59,-13422.36C3264.24,-13418.5 3245.28,-13414.87 3227.32,-13412.03 3045.22,-13383.27 2831.76,-13366.27 2702.63,-13357.8"/>
<polygon fill="black" stroke="black" points="2702.53,-13354.29 2692.33,-13357.13 2702.08,-13361.27 2702.53,-13354.29"/>
</g>
<!-- layer_2_all2all_back_11&#45;&gt;layer_2_output -->
<g id="edge256" class="edge">
<title>layer_2_all2all_back_11&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M3604.96,-13422.15C3586.2,-13418.24 3566.75,-13414.65 3548.32,-13412.03 3245.34,-13369.05 2884.42,-13356.35 2702.52,-13352.6"/>
<polygon fill="black" stroke="black" points="2702.46,-13349.1 2692.39,-13352.4 2702.32,-13356.1 2702.46,-13349.1"/>
</g>
<!-- layer_2_all2all_back_12&#45;&gt;layer_2_output -->
<g id="edge257" class="edge">
<title>layer_2_all2all_back_12&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M3926.43,-13421.99C3907.53,-13418.08 3887.91,-13414.52 3869.32,-13412.03 3645.88,-13382.13 2975.45,-13361.43 2702.68,-13354.04"/>
<polygon fill="black" stroke="black" points="2702.45,-13350.53 2692.36,-13353.76 2702.26,-13357.53 2702.45,-13350.53"/>
</g>
<!-- layer_2_all2all_back_13&#45;&gt;layer_2_output -->
<g id="edge258" class="edge">
<title>layer_2_all2all_back_13&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M4247.88,-13421.94C4228.84,-13418 4209.06,-13414.45 4190.32,-13412.03 3902.54,-13374.91 3021.94,-13357.83 2702.57,-13352.74"/>
<polygon fill="black" stroke="black" points="2702.42,-13349.24 2692.37,-13352.58 2702.31,-13356.24 2702.42,-13349.24"/>
</g>
<!-- layer_2_all2all_back_14&#45;&gt;layer_2_output -->
<g id="edge259" class="edge">
<title>layer_2_all2all_back_14&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M4568.89,-13421.84C4549.85,-13417.91 4530.07,-13414.39 4511.32,-13412.03 4158.62,-13367.66 3064.19,-13354.92 2702.6,-13351.87"/>
<polygon fill="black" stroke="black" points="2702.41,-13348.37 2692.38,-13351.79 2702.35,-13355.37 2702.41,-13348.37"/>
</g>
<!-- layer_2_all2all_back_15&#45;&gt;layer_2_output -->
<g id="edge260" class="edge">
<title>layer_2_all2all_back_15&#45;&gt;layer_2_output</title>
<path fill="none" stroke="black" d="M4890.33,-13421.86C4871.16,-13417.9 4851.22,-13414.37 4832.32,-13412.03 4414.25,-13360.4 3103.28,-13352.47 2702.73,-13351.25"/>
<polygon fill="black" stroke="black" points="2702.59,-13347.75 2692.58,-13351.22 2702.57,-13354.75 2702.59,-13347.75"/>
</g>
<!-- layer_3_tp_gather -->
<g id="node194" class="node">
<title>layer_3_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2585.32" cy="-13251.26" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2585.32" y="-13265.26" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2585.32" y="-13254.26" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2585.32" y="-13243.26" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2585.32" y="-13232.26" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_2_output&#45;&gt;layer_3_tp_gather -->
<g id="edge261" class="edge">
<title>layer_2_output&#45;&gt;layer_3_tp_gather</title>
<path fill="none" stroke="black" d="M2567.3,-13323.86C2565.64,-13315.89 2564.91,-13306.81 2565.1,-13297.86"/>
<polygon fill="black" stroke="black" points="2568.59,-13298.07 2565.71,-13287.87 2561.61,-13297.64 2568.59,-13298.07"/>
</g>
<!-- layer_2_output&#45;&gt;layer_3_tp_gather -->
<g id="edge263" class="edge">
<title>layer_2_output&#45;&gt;layer_3_tp_gather</title>
<path fill="none" stroke="black" d="M2579.32,-13323.86C2578.77,-13316.05 2578.53,-13307.19 2578.58,-13298.42"/>
<polygon fill="black" stroke="black" points="2582.08,-13298.31 2578.77,-13288.24 2575.08,-13298.17 2582.08,-13298.31"/>
</g>
<!-- layer_2_output&#45;&gt;layer_3_tp_gather -->
<g id="edge265" class="edge">
<title>layer_2_output&#45;&gt;layer_3_tp_gather</title>
<path fill="none" stroke="black" d="M2591.33,-13323.86C2591.87,-13316.05 2592.11,-13307.19 2592.06,-13298.42"/>
<polygon fill="black" stroke="black" points="2595.56,-13298.17 2591.87,-13288.24 2588.56,-13298.31 2595.56,-13298.17"/>
</g>
<!-- layer_2_output&#45;&gt;layer_3_tp_gather -->
<g id="edge267" class="edge">
<title>layer_2_output&#45;&gt;layer_3_tp_gather</title>
<path fill="none" stroke="black" d="M2603.34,-13323.86C2605,-13315.89 2605.73,-13306.81 2605.54,-13297.86"/>
<polygon fill="black" stroke="black" points="2609.03,-13297.64 2604.93,-13287.87 2602.05,-13298.07 2609.03,-13297.64"/>
</g>
<!-- layer_3_qkv_gpu0 -->
<g id="node193" class="node">
<title>layer_3_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2350.32,-13178.49 2144.32,-13178.49 2144.32,-13126.49 2350.32,-13126.49 2350.32,-13178.49"/>
<text text-anchor="middle" x="2247.32" y="-13166.49" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2247.32" y="-13155.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2247.32" y="-13144.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2247.32" y="-13133.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_3_attn_gpu0 -->
<g id="node198" class="node">
<title>layer_3_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2348.32,-13090.49 2146.32,-13090.49 2146.32,-13038.49 2348.32,-13038.49 2348.32,-13090.49"/>
<text text-anchor="middle" x="2247.32" y="-13078.49" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2247.32" y="-13067.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2247.32" y="-13056.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2247.32" y="-13045.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_3_qkv_gpu0&#45;&gt;layer_3_attn_gpu0 -->
<g id="edge269" class="edge">
<title>layer_3_qkv_gpu0&#45;&gt;layer_3_attn_gpu0</title>
<path fill="none" stroke="black" d="M2247.32,-13126.16C2247.32,-13118.2 2247.32,-13109.26 2247.32,-13100.74"/>
<polygon fill="black" stroke="black" points="2250.82,-13100.65 2247.32,-13090.65 2243.82,-13100.65 2250.82,-13100.65"/>
</g>
<!-- layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu0 -->
<g id="edge262" class="edge">
<title>layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2489.37,-13222.79C2444.09,-13209.83 2390.16,-13194.39 2344.7,-13181.37"/>
<polygon fill="black" stroke="black" points="2345.42,-13177.94 2334.84,-13178.55 2343.49,-13184.67 2345.42,-13177.94"/>
</g>
<!-- layer_3_qkv_gpu1 -->
<g id="node195" class="node">
<title>layer_3_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2576.32,-13178.49 2370.32,-13178.49 2370.32,-13126.49 2576.32,-13126.49 2576.32,-13178.49"/>
<text text-anchor="middle" x="2473.32" y="-13166.49" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2473.32" y="-13155.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2473.32" y="-13144.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2473.32" y="-13133.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu1 -->
<g id="edge264" class="edge">
<title>layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2545.2,-13215.6C2533.68,-13205.64 2521.17,-13194.84 2509.87,-13185.08"/>
<polygon fill="black" stroke="black" points="2512.13,-13182.4 2502.27,-13178.51 2507.55,-13187.69 2512.13,-13182.4"/>
</g>
<!-- layer_3_qkv_gpu2 -->
<g id="node196" class="node">
<title>layer_3_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2801.32,-13178.49 2595.32,-13178.49 2595.32,-13126.49 2801.32,-13126.49 2801.32,-13178.49"/>
<text text-anchor="middle" x="2698.32" y="-13166.49" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2698.32" y="-13155.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2698.32" y="-13144.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2698.32" y="-13133.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu2 -->
<g id="edge266" class="edge">
<title>layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2625.8,-13215.6C2637.43,-13205.64 2650.04,-13194.84 2661.44,-13185.08"/>
<polygon fill="black" stroke="black" points="2663.79,-13187.67 2669.11,-13178.51 2659.24,-13182.35 2663.79,-13187.67"/>
</g>
<!-- layer_3_qkv_gpu3 -->
<g id="node197" class="node">
<title>layer_3_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3025.32,-13178.49 2819.32,-13178.49 2819.32,-13126.49 3025.32,-13126.49 3025.32,-13178.49"/>
<text text-anchor="middle" x="2922.32" y="-13166.49" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2922.32" y="-13155.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2922.32" y="-13144.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2922.32" y="-13133.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu3 -->
<g id="edge268" class="edge">
<title>layer_3_tp_gather&#45;&gt;layer_3_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2681.44,-13222.66C2726.48,-13209.73 2780.04,-13194.35 2825.2,-13181.38"/>
<polygon fill="black" stroke="black" points="2826.36,-13184.69 2835,-13178.57 2824.43,-13177.96 2826.36,-13184.69"/>
</g>
<!-- layer_3_attn_gpu1 -->
<g id="node199" class="node">
<title>layer_3_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2570.32,-13090.49 2368.32,-13090.49 2368.32,-13038.49 2570.32,-13038.49 2570.32,-13090.49"/>
<text text-anchor="middle" x="2469.32" y="-13078.49" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2469.32" y="-13067.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2469.32" y="-13056.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2469.32" y="-13045.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_3_qkv_gpu1&#45;&gt;layer_3_attn_gpu1 -->
<g id="edge270" class="edge">
<title>layer_3_qkv_gpu1&#45;&gt;layer_3_attn_gpu1</title>
<path fill="none" stroke="black" d="M2472.14,-13126.16C2471.77,-13118.2 2471.36,-13109.26 2470.96,-13100.74"/>
<polygon fill="black" stroke="black" points="2474.45,-13100.48 2470.49,-13090.65 2467.46,-13100.8 2474.45,-13100.48"/>
</g>
<!-- layer_3_attn_gpu2 -->
<g id="node200" class="node">
<title>layer_3_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2801.32,-13090.49 2599.32,-13090.49 2599.32,-13038.49 2801.32,-13038.49 2801.32,-13090.49"/>
<text text-anchor="middle" x="2700.32" y="-13078.49" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2700.32" y="-13067.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2700.32" y="-13056.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2700.32" y="-13045.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_3_qkv_gpu2&#45;&gt;layer_3_attn_gpu2 -->
<g id="edge271" class="edge">
<title>layer_3_qkv_gpu2&#45;&gt;layer_3_attn_gpu2</title>
<path fill="none" stroke="black" d="M2698.91,-13126.16C2699.1,-13118.2 2699.3,-13109.26 2699.5,-13100.74"/>
<polygon fill="black" stroke="black" points="2703,-13100.73 2699.74,-13090.65 2696,-13100.57 2703,-13100.73"/>
</g>
<!-- layer_3_attn_gpu3 -->
<g id="node201" class="node">
<title>layer_3_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3023.32,-13090.49 2821.32,-13090.49 2821.32,-13038.49 3023.32,-13038.49 3023.32,-13090.49"/>
<text text-anchor="middle" x="2922.32" y="-13078.49" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2922.32" y="-13067.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2922.32" y="-13056.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2922.32" y="-13045.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_3_qkv_gpu3&#45;&gt;layer_3_attn_gpu3 -->
<g id="edge272" class="edge">
<title>layer_3_qkv_gpu3&#45;&gt;layer_3_attn_gpu3</title>
<path fill="none" stroke="black" d="M2922.32,-13126.16C2922.32,-13118.2 2922.32,-13109.26 2922.32,-13100.74"/>
<polygon fill="black" stroke="black" points="2925.82,-13100.65 2922.32,-13090.65 2918.82,-13100.65 2925.82,-13100.65"/>
</g>
<!-- layer_3_attn_out_gpu0 -->
<g id="node202" class="node">
<title>layer_3_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2344.32,-13002.49 2130.32,-13002.49 2130.32,-12950.49 2344.32,-12950.49 2344.32,-13002.49"/>
<text text-anchor="middle" x="2237.32" y="-12990.49" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2237.32" y="-12979.49" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2237.32" y="-12968.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2237.32" y="-12957.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_attn_gpu0&#45;&gt;layer_3_attn_out_gpu0 -->
<g id="edge273" class="edge">
<title>layer_3_attn_gpu0&#45;&gt;layer_3_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2244.37,-13038.16C2243.45,-13030.2 2242.41,-13021.26 2241.42,-13012.74"/>
<polygon fill="black" stroke="black" points="2244.88,-13012.18 2240.25,-13002.65 2237.92,-13012.99 2244.88,-13012.18"/>
</g>
<!-- layer_3_attn_out_gpu1 -->
<g id="node203" class="node">
<title>layer_3_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2576.32,-13002.49 2362.32,-13002.49 2362.32,-12950.49 2576.32,-12950.49 2576.32,-13002.49"/>
<text text-anchor="middle" x="2469.32" y="-12990.49" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2469.32" y="-12979.49" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2469.32" y="-12968.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2469.32" y="-12957.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_attn_gpu1&#45;&gt;layer_3_attn_out_gpu1 -->
<g id="edge274" class="edge">
<title>layer_3_attn_gpu1&#45;&gt;layer_3_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2469.32,-13038.16C2469.32,-13030.2 2469.32,-13021.26 2469.32,-13012.74"/>
<polygon fill="black" stroke="black" points="2472.82,-13012.65 2469.32,-13002.65 2465.82,-13012.65 2472.82,-13012.65"/>
</g>
<!-- layer_3_attn_out_gpu2 -->
<g id="node204" class="node">
<title>layer_3_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2808.32,-13002.49 2594.32,-13002.49 2594.32,-12950.49 2808.32,-12950.49 2808.32,-13002.49"/>
<text text-anchor="middle" x="2701.32" y="-12990.49" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2701.32" y="-12979.49" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2701.32" y="-12968.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2701.32" y="-12957.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_attn_gpu2&#45;&gt;layer_3_attn_out_gpu2 -->
<g id="edge275" class="edge">
<title>layer_3_attn_gpu2&#45;&gt;layer_3_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2700.62,-13038.16C2700.71,-13030.2 2700.81,-13021.26 2700.91,-13012.74"/>
<polygon fill="black" stroke="black" points="2704.41,-13012.69 2701.03,-13002.65 2697.41,-13012.61 2704.41,-13012.69"/>
</g>
<!-- layer_3_attn_out_gpu3 -->
<g id="node205" class="node">
<title>layer_3_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3040.32,-13002.49 2826.32,-13002.49 2826.32,-12950.49 3040.32,-12950.49 3040.32,-13002.49"/>
<text text-anchor="middle" x="2933.32" y="-12990.49" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2933.32" y="-12979.49" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2933.32" y="-12968.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2933.32" y="-12957.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_attn_gpu3&#45;&gt;layer_3_attn_out_gpu3 -->
<g id="edge276" class="edge">
<title>layer_3_attn_gpu3&#45;&gt;layer_3_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2925.56,-13038.16C2926.58,-13030.2 2927.72,-13021.26 2928.81,-13012.74"/>
<polygon fill="black" stroke="black" points="2932.31,-13013.01 2930.1,-13002.65 2925.36,-13012.13 2932.31,-13013.01"/>
</g>
<!-- layer_3_attn_allreduce -->
<g id="node206" class="node">
<title>layer_3_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2585.32" cy="-12877.72" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2585.32" y="-12891.72" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2585.32" y="-12880.72" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2585.32" y="-12869.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2585.32" y="-12858.72" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_attn_out_gpu0&#45;&gt;layer_3_attn_allreduce -->
<g id="edge277" class="edge">
<title>layer_3_attn_out_gpu0&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2327.39,-12950.45C2373.36,-12937.66 2429.61,-12922.02 2477.84,-12908.61"/>
<polygon fill="black" stroke="black" points="2478.99,-12911.93 2487.69,-12905.87 2477.11,-12905.18 2478.99,-12911.93"/>
</g>
<!-- layer_3_attn_out_gpu1&#45;&gt;layer_3_attn_allreduce -->
<g id="edge278" class="edge">
<title>layer_3_attn_out_gpu1&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2499.5,-12950.32C2510.73,-12940.95 2523.78,-12930.06 2536.26,-12919.65"/>
<polygon fill="black" stroke="black" points="2538.51,-12922.33 2543.94,-12913.24 2534.02,-12916.96 2538.51,-12922.33"/>
</g>
<!-- layer_3_attn_out_gpu2&#45;&gt;layer_3_attn_allreduce -->
<g id="edge279" class="edge">
<title>layer_3_attn_out_gpu2&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2671.15,-12950.32C2659.92,-12940.95 2646.86,-12930.06 2634.38,-12919.65"/>
<polygon fill="black" stroke="black" points="2636.62,-12916.96 2626.7,-12913.24 2632.13,-12922.33 2636.62,-12916.96"/>
</g>
<!-- layer_3_attn_out_gpu3&#45;&gt;layer_3_attn_allreduce -->
<g id="edge280" class="edge">
<title>layer_3_attn_out_gpu3&#45;&gt;layer_3_attn_allreduce</title>
<path fill="none" stroke="black" d="M2843.25,-12950.45C2797.28,-12937.66 2741.03,-12922.02 2692.8,-12908.61"/>
<polygon fill="black" stroke="black" points="2693.53,-12905.18 2682.96,-12905.87 2691.65,-12911.93 2693.53,-12905.18"/>
</g>
<!-- layer_3_gate -->
<g id="node207" class="node">
<title>layer_3_gate</title>
<polygon fill="lightyellow" stroke="black" points="2802.18,-12804.96 2457.2,-12804.96 2368.46,-12700.96 2713.44,-12700.96 2802.18,-12804.96"/>
<text text-anchor="middle" x="2585.32" y="-12766.96" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2585.32" y="-12755.96" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2585.32" y="-12744.96" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2585.32" y="-12733.96" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_3_attn_allreduce&#45;&gt;layer_3_gate -->
<g id="edge281" class="edge">
<title>layer_3_attn_allreduce&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2566.76,-12841.21C2565.65,-12833.17 2565.08,-12824.41 2565.07,-12815.63"/>
<polygon fill="black" stroke="black" points="2568.58,-12815.45 2565.31,-12805.37 2561.58,-12815.28 2568.58,-12815.45"/>
</g>
<!-- layer_3_attn_allreduce&#45;&gt;layer_3_gate -->
<g id="edge282" class="edge">
<title>layer_3_attn_allreduce&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2579.12,-12840.88C2578.75,-12832.85 2578.57,-12824.1 2578.57,-12815.35"/>
<polygon fill="black" stroke="black" points="2582.07,-12815.15 2578.65,-12805.12 2575.07,-12815.09 2582.07,-12815.15"/>
</g>
<!-- layer_3_attn_allreduce&#45;&gt;layer_3_gate -->
<g id="edge283" class="edge">
<title>layer_3_attn_allreduce&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2591.52,-12840.88C2591.89,-12832.85 2592.07,-12824.1 2592.07,-12815.35"/>
<polygon fill="black" stroke="black" points="2595.57,-12815.09 2591.99,-12805.12 2588.57,-12815.15 2595.57,-12815.09"/>
</g>
<!-- layer_3_attn_allreduce&#45;&gt;layer_3_gate -->
<g id="edge284" class="edge">
<title>layer_3_attn_allreduce&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2603.88,-12841.21C2604.99,-12833.17 2605.56,-12824.41 2605.57,-12815.63"/>
<polygon fill="black" stroke="black" points="2609.06,-12815.28 2605.33,-12805.37 2602.07,-12815.45 2609.06,-12815.28"/>
</g>
<!-- layer_3_all2all_expert_0 -->
<g id="node209" class="node">
<title>layer_3_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="189.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="189.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="189.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="189.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="189.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_0 -->
<g id="edge285" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2409.07,-12749.02C1954.68,-12740.84 751.37,-12714.97 355.32,-12664.96 338.45,-12662.82 320.76,-12659.84 303.46,-12656.49"/>
<polygon fill="black" stroke="black" points="303.83,-12652.99 293.34,-12654.48 302.47,-12659.86 303.83,-12652.99"/>
</g>
<!-- layer_3_all2all_expert_1 -->
<g id="node211" class="node">
<title>layer_3_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="512.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="512.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="512.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="512.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="512.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_1 -->
<g id="edge287" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2408.13,-12747.82C2000.42,-12737.66 1005.39,-12709.06 673.32,-12664.96 657.57,-12662.86 641.09,-12660 624.93,-12656.79"/>
<polygon fill="black" stroke="black" points="625.41,-12653.32 614.91,-12654.76 624.02,-12660.18 625.41,-12653.32"/>
</g>
<!-- layer_3_all2all_expert_2 -->
<g id="node213" class="node">
<title>layer_3_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="830.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="830.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="830.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="830.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="830.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_2 -->
<g id="edge289" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2411.19,-12751.29C2118.08,-12748.19 1508.07,-12733.22 997.32,-12664.96 980.37,-12662.69 962.58,-12659.63 945.19,-12656.25"/>
<polygon fill="black" stroke="black" points="945.49,-12652.74 935,-12654.22 944.13,-12659.6 945.49,-12652.74"/>
</g>
<!-- layer_3_all2all_expert_3 -->
<g id="node215" class="node">
<title>layer_3_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1154.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1154.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1154.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1154.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1154.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_3 -->
<g id="edge291" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2408.68,-12748.14C2162.71,-12740.94 1703.62,-12720.67 1316.32,-12664.96 1300.62,-12662.7 1284.18,-12659.75 1268.04,-12656.53"/>
<polygon fill="black" stroke="black" points="1268.54,-12653.06 1258.04,-12654.48 1267.14,-12659.92 1268.54,-12653.06"/>
</g>
<!-- layer_3_all2all_expert_4 -->
<g id="node217" class="node">
<title>layer_3_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1473.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1473.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1473.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1473.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1473.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_4 -->
<g id="edge293" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2403.73,-12742.34C2211.53,-12730.53 1899.76,-12706.73 1633.32,-12664.96 1618.33,-12662.6 1602.64,-12659.68 1587.19,-12656.53"/>
<polygon fill="black" stroke="black" points="1587.59,-12653.03 1577.09,-12654.42 1586.17,-12659.89 1587.59,-12653.03"/>
</g>
<!-- layer_3_all2all_expert_5 -->
<g id="node219" class="node">
<title>layer_3_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1790.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1790.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1790.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1790.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1790.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_5 -->
<g id="edge295" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2392.89,-12729.73C2266.88,-12714.14 2098.81,-12691.41 1951.32,-12664.96 1936.64,-12662.32 1921.27,-12659.28 1906.09,-12656.1"/>
<polygon fill="black" stroke="black" points="1906.67,-12652.65 1896.16,-12654 1905.22,-12659.49 1906.67,-12652.65"/>
</g>
<!-- layer_3_all2all_expert_6 -->
<g id="node221" class="node">
<title>layer_3_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2108.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2108.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2108.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2108.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2108.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_6 -->
<g id="edge297" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2386.83,-12700.87C2329.51,-12686.12 2269.03,-12670.55 2219.12,-12657.7"/>
<polygon fill="black" stroke="black" points="2219.84,-12654.27 2209.28,-12655.17 2218.09,-12661.05 2219.84,-12654.27"/>
</g>
<!-- layer_3_all2all_expert_7 -->
<g id="node223" class="node">
<title>layer_3_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2427.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2427.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2427.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2427.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2427.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_7 -->
<g id="edge299" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2519.23,-12700.6C2506.05,-12690.36 2492.38,-12679.74 2479.73,-12669.91"/>
<polygon fill="black" stroke="black" points="2481.63,-12666.95 2471.59,-12663.58 2477.34,-12672.48 2481.63,-12666.95"/>
</g>
<!-- layer_3_all2all_expert_8 -->
<g id="node225" class="node">
<title>layer_3_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2743.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2743.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2743.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2743.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2743.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_8 -->
<g id="edge301" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2651.41,-12700.6C2664.59,-12690.36 2678.26,-12679.74 2690.91,-12669.91"/>
<polygon fill="black" stroke="black" points="2693.3,-12672.48 2699.05,-12663.58 2689.01,-12666.95 2693.3,-12672.48"/>
</g>
<!-- layer_3_all2all_expert_9 -->
<g id="node227" class="node">
<title>layer_3_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3061.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3061.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3061.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3061.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3061.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_9 -->
<g id="edge303" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2726.2,-12715.62C2797.93,-12697.12 2883.86,-12674.96 2950.74,-12657.71"/>
<polygon fill="black" stroke="black" points="2951.66,-12661.08 2960.47,-12655.2 2949.91,-12654.31 2951.66,-12661.08"/>
</g>
<!-- layer_3_all2all_expert_10 -->
<g id="node229" class="node">
<title>layer_3_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3381.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3381.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3381.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3381.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3381.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_10 -->
<g id="edge305" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.94,-12733.94C2870.38,-12718.33 3056.69,-12693.75 3218.32,-12664.96 3233.41,-12662.27 3249.23,-12659.16 3264.82,-12655.93"/>
<polygon fill="black" stroke="black" points="3265.96,-12659.26 3275.03,-12653.79 3264.53,-12652.41 3265.96,-12659.26"/>
</g>
<!-- layer_3_all2all_expert_11 -->
<g id="node231" class="node">
<title>layer_3_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3701.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3701.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3701.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3701.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3701.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_11 -->
<g id="edge307" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2749.66,-12743.21C2940.19,-12731.62 3263.31,-12707.51 3538.32,-12664.96 3553.97,-12662.53 3570.37,-12659.52 3586.48,-12656.27"/>
<polygon fill="black" stroke="black" points="3587.37,-12659.66 3596.46,-12654.22 3585.96,-12652.8 3587.37,-12659.66"/>
</g>
<!-- layer_3_all2all_expert_12 -->
<g id="node233" class="node">
<title>layer_3_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4022.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4022.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4022.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4022.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4022.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_12 -->
<g id="edge309" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2753.97,-12748.28C2998.49,-12741.18 3465.21,-12720.95 3858.32,-12664.96 3874.45,-12662.66 3891.35,-12659.66 3907.92,-12656.37"/>
<polygon fill="black" stroke="black" points="3909.08,-12659.71 3918.19,-12654.29 3907.69,-12652.85 3909.08,-12659.71"/>
</g>
<!-- layer_3_all2all_expert_13 -->
<g id="node235" class="node">
<title>layer_3_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4343.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4343.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4343.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4343.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4343.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_13 -->
<g id="edge311" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.9,-12751.58C3049.89,-12748.93 3664.89,-12734.64 4179.32,-12664.96 4195.74,-12662.73 4212.95,-12659.73 4229.79,-12656.41"/>
<polygon fill="black" stroke="black" points="4230.55,-12659.83 4239.66,-12654.42 4229.16,-12652.97 4230.55,-12659.83"/>
</g>
<!-- layer_3_all2all_expert_14 -->
<g id="node237" class="node">
<title>layer_3_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4664.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4664.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4664.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4664.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4664.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_14 -->
<g id="edge313" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2753.76,-12747.96C3156.24,-12737.84 4165.17,-12708.8 4500.32,-12664.96 4516.75,-12662.81 4533.96,-12659.85 4550.81,-12656.55"/>
<polygon fill="black" stroke="black" points="4551.56,-12659.97 4560.68,-12654.57 4550.18,-12653.1 4551.56,-12659.97"/>
</g>
<!-- layer_3_all2all_expert_15 -->
<g id="node239" class="node">
<title>layer_3_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4985.32" cy="-12628.19" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4985.32" y="-12642.19" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4985.32" y="-12631.19" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4985.32" y="-12620.19" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4985.32" y="-12609.19" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_all2all_expert_15 -->
<g id="edge315" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2754.66,-12749.22C3204.48,-12741.35 4422.1,-12715.86 4821.32,-12664.96 4837.87,-12662.84 4855.23,-12659.89 4872.19,-12656.57"/>
<polygon fill="black" stroke="black" points="4873.01,-12659.98 4882.13,-12654.58 4871.64,-12653.11 4873.01,-12659.98"/>
</g>
<!-- layer_3_expert_0_gpu0 -->
<g id="node208" class="node">
<title>layer_3_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="283.82,-12555.42 74.82,-12555.42 74.82,-12503.42 283.82,-12503.42 283.82,-12555.42"/>
<text text-anchor="middle" x="179.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="179.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="179.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="179.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_0 -->
<g id="node240" class="node">
<title>layer_3_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="176.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="176.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="176.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="176.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="176.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_0_gpu0&#45;&gt;layer_3_all2all_back_0 -->
<g id="edge317" class="edge">
<title>layer_3_expert_0_gpu0&#45;&gt;layer_3_all2all_back_0</title>
<path fill="none" stroke="black" d="M178.54,-12503.24C178.3,-12495.44 178.02,-12486.57 177.75,-12477.8"/>
<polygon fill="black" stroke="black" points="181.24,-12477.51 177.44,-12467.62 174.25,-12477.73 181.24,-12477.51"/>
</g>
<!-- layer_3_all2all_expert_0&#45;&gt;layer_3_expert_0_gpu0 -->
<g id="edge286" class="edge">
<title>layer_3_all2all_expert_0&#45;&gt;layer_3_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M185.63,-12591.43C184.75,-12582.93 183.81,-12573.87 182.94,-12565.41"/>
<polygon fill="black" stroke="black" points="186.42,-12565.05 181.91,-12555.46 179.46,-12565.77 186.42,-12565.05"/>
</g>
<!-- layer_3_expert_1_gpu0 -->
<g id="node210" class="node">
<title>layer_3_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="602.82,-12555.42 393.82,-12555.42 393.82,-12503.42 602.82,-12503.42 602.82,-12555.42"/>
<text text-anchor="middle" x="498.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="498.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="498.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="498.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_1 -->
<g id="node241" class="node">
<title>layer_3_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="497.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="497.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="497.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="497.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="497.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_1_gpu0&#45;&gt;layer_3_all2all_back_1 -->
<g id="edge318" class="edge">
<title>layer_3_expert_1_gpu0&#45;&gt;layer_3_all2all_back_1</title>
<path fill="none" stroke="black" d="M498.06,-12503.24C497.98,-12495.44 497.89,-12486.57 497.8,-12477.8"/>
<polygon fill="black" stroke="black" points="501.3,-12477.59 497.69,-12467.62 494.3,-12477.66 501.3,-12477.59"/>
</g>
<!-- layer_3_all2all_expert_1&#45;&gt;layer_3_expert_1_gpu0 -->
<g id="edge288" class="edge">
<title>layer_3_all2all_expert_1&#45;&gt;layer_3_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M507.15,-12591.43C505.92,-12582.93 504.61,-12573.87 503.38,-12565.41"/>
<polygon fill="black" stroke="black" points="506.84,-12564.86 501.94,-12555.46 499.91,-12565.86 506.84,-12564.86"/>
</g>
<!-- layer_3_expert_2_gpu1 -->
<g id="node212" class="node">
<title>layer_3_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="927.82,-12555.42 718.82,-12555.42 718.82,-12503.42 927.82,-12503.42 927.82,-12555.42"/>
<text text-anchor="middle" x="823.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="823.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="823.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="823.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_2 -->
<g id="node242" class="node">
<title>layer_3_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="818.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="818.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="818.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="818.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="818.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_2_gpu1&#45;&gt;layer_3_all2all_back_2 -->
<g id="edge319" class="edge">
<title>layer_3_expert_2_gpu1&#45;&gt;layer_3_all2all_back_2</title>
<path fill="none" stroke="black" d="M822.02,-12503.24C821.62,-12495.44 821.16,-12486.57 820.71,-12477.8"/>
<polygon fill="black" stroke="black" points="824.19,-12477.43 820.18,-12467.62 817.2,-12477.79 824.19,-12477.43"/>
</g>
<!-- layer_3_all2all_expert_2&#45;&gt;layer_3_expert_2_gpu1 -->
<g id="edge290" class="edge">
<title>layer_3_all2all_expert_2&#45;&gt;layer_3_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M827.71,-12591.15C827.11,-12582.84 826.47,-12574.01 825.88,-12565.73"/>
<polygon fill="black" stroke="black" points="829.36,-12565.33 825.14,-12555.61 822.37,-12565.84 829.36,-12565.33"/>
</g>
<!-- layer_3_expert_3_gpu1 -->
<g id="node214" class="node">
<title>layer_3_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1249.82,-12555.42 1040.82,-12555.42 1040.82,-12503.42 1249.82,-12503.42 1249.82,-12555.42"/>
<text text-anchor="middle" x="1145.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1145.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1145.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1145.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_3 -->
<g id="node243" class="node">
<title>layer_3_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1139.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1139.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1139.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1139.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1139.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_3_gpu1&#45;&gt;layer_3_all2all_back_3 -->
<g id="edge320" class="edge">
<title>layer_3_expert_3_gpu1&#45;&gt;layer_3_all2all_back_3</title>
<path fill="none" stroke="black" d="M1143.76,-12503.24C1143.28,-12495.44 1142.73,-12486.57 1142.18,-12477.8"/>
<polygon fill="black" stroke="black" points="1145.66,-12477.39 1141.55,-12467.62 1138.68,-12477.82 1145.66,-12477.39"/>
</g>
<!-- layer_3_all2all_expert_3&#45;&gt;layer_3_expert_3_gpu1 -->
<g id="edge292" class="edge">
<title>layer_3_all2all_expert_3&#45;&gt;layer_3_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1150.97,-12591.15C1150.2,-12582.84 1149.37,-12574.01 1148.6,-12565.73"/>
<polygon fill="black" stroke="black" points="1152.08,-12565.25 1147.66,-12555.61 1145.11,-12565.89 1152.08,-12565.25"/>
</g>
<!-- layer_3_expert_4_gpu2 -->
<g id="node216" class="node">
<title>layer_3_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1574.82,-12555.42 1365.82,-12555.42 1365.82,-12503.42 1574.82,-12503.42 1574.82,-12555.42"/>
<text text-anchor="middle" x="1470.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1470.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1470.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1470.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_4 -->
<g id="node244" class="node">
<title>layer_3_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1460.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1460.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1460.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1460.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1460.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_4_gpu2&#45;&gt;layer_3_all2all_back_4 -->
<g id="edge321" class="edge">
<title>layer_3_expert_4_gpu2&#45;&gt;layer_3_all2all_back_4</title>
<path fill="none" stroke="black" d="M1467.72,-12503.24C1466.91,-12495.44 1466,-12486.57 1465.09,-12477.8"/>
<polygon fill="black" stroke="black" points="1468.55,-12477.21 1464.04,-12467.62 1461.59,-12477.93 1468.55,-12477.21"/>
</g>
<!-- layer_3_all2all_expert_4&#45;&gt;layer_3_expert_4_gpu2 -->
<g id="edge294" class="edge">
<title>layer_3_all2all_expert_4&#45;&gt;layer_3_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1472.2,-12591.15C1471.95,-12582.84 1471.67,-12574.01 1471.42,-12565.73"/>
<polygon fill="black" stroke="black" points="1474.91,-12565.5 1471.1,-12555.61 1467.91,-12565.72 1474.91,-12565.5"/>
</g>
<!-- layer_3_expert_5_gpu2 -->
<g id="node218" class="node">
<title>layer_3_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1887.82,-12555.42 1678.82,-12555.42 1678.82,-12503.42 1887.82,-12503.42 1887.82,-12555.42"/>
<text text-anchor="middle" x="1783.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1783.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1783.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1783.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_5 -->
<g id="node245" class="node">
<title>layer_3_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1781.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1781.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1781.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1781.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1781.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_5_gpu2&#45;&gt;layer_3_all2all_back_5 -->
<g id="edge322" class="edge">
<title>layer_3_expert_5_gpu2&#45;&gt;layer_3_all2all_back_5</title>
<path fill="none" stroke="black" d="M1782.8,-12503.24C1782.64,-12495.44 1782.46,-12486.57 1782.27,-12477.8"/>
<polygon fill="black" stroke="black" points="1785.77,-12477.55 1782.06,-12467.62 1778.77,-12477.69 1785.77,-12477.55"/>
</g>
<!-- layer_3_all2all_expert_5&#45;&gt;layer_3_expert_5_gpu2 -->
<g id="edge296" class="edge">
<title>layer_3_all2all_expert_5&#45;&gt;layer_3_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1787.71,-12591.15C1787.11,-12582.84 1786.47,-12574.01 1785.88,-12565.73"/>
<polygon fill="black" stroke="black" points="1789.36,-12565.33 1785.14,-12555.61 1782.37,-12565.84 1789.36,-12565.33"/>
</g>
<!-- layer_3_expert_6_gpu3 -->
<g id="node220" class="node">
<title>layer_3_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2208.82,-12555.42 1999.82,-12555.42 1999.82,-12503.42 2208.82,-12503.42 2208.82,-12555.42"/>
<text text-anchor="middle" x="2104.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2104.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2104.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2104.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_6 -->
<g id="node246" class="node">
<title>layer_3_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2102.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2102.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2102.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2102.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2102.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_6_gpu3&#45;&gt;layer_3_all2all_back_6 -->
<g id="edge323" class="edge">
<title>layer_3_expert_6_gpu3&#45;&gt;layer_3_all2all_back_6</title>
<path fill="none" stroke="black" d="M2103.8,-12503.24C2103.64,-12495.44 2103.46,-12486.57 2103.27,-12477.8"/>
<polygon fill="black" stroke="black" points="2106.77,-12477.55 2103.06,-12467.62 2099.77,-12477.69 2106.77,-12477.55"/>
</g>
<!-- layer_3_all2all_expert_6&#45;&gt;layer_3_expert_6_gpu3 -->
<g id="edge298" class="edge">
<title>layer_3_all2all_expert_6&#45;&gt;layer_3_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2106.83,-12591.15C2106.49,-12582.84 2106.12,-12574.01 2105.78,-12565.73"/>
<polygon fill="black" stroke="black" points="2109.27,-12565.46 2105.36,-12555.61 2102.28,-12565.75 2109.27,-12565.46"/>
</g>
<!-- layer_3_expert_7_gpu3 -->
<g id="node222" class="node">
<title>layer_3_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2528.82,-12555.42 2319.82,-12555.42 2319.82,-12503.42 2528.82,-12503.42 2528.82,-12555.42"/>
<text text-anchor="middle" x="2424.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2424.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2424.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2424.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_7 -->
<g id="node247" class="node">
<title>layer_3_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2423.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2423.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2423.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2423.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2423.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_7_gpu3&#45;&gt;layer_3_all2all_back_7 -->
<g id="edge324" class="edge">
<title>layer_3_expert_7_gpu3&#45;&gt;layer_3_all2all_back_7</title>
<path fill="none" stroke="black" d="M2424.06,-12503.24C2423.98,-12495.44 2423.89,-12486.57 2423.8,-12477.8"/>
<polygon fill="black" stroke="black" points="2427.3,-12477.59 2423.69,-12467.62 2420.3,-12477.66 2427.3,-12477.59"/>
</g>
<!-- layer_3_all2all_expert_7&#45;&gt;layer_3_expert_7_gpu3 -->
<g id="edge300" class="edge">
<title>layer_3_all2all_expert_7&#45;&gt;layer_3_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2426.2,-12591.15C2425.95,-12582.84 2425.67,-12574.01 2425.42,-12565.73"/>
<polygon fill="black" stroke="black" points="2428.91,-12565.5 2425.1,-12555.61 2421.91,-12565.72 2428.91,-12565.5"/>
</g>
<!-- layer_3_expert_8_gpu4 -->
<g id="node224" class="node">
<title>layer_3_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2847.82,-12555.42 2638.82,-12555.42 2638.82,-12503.42 2847.82,-12503.42 2847.82,-12555.42"/>
<text text-anchor="middle" x="2743.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2743.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2743.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2743.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_8 -->
<g id="node248" class="node">
<title>layer_3_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2744.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2744.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2744.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2744.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2744.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_8_gpu4&#45;&gt;layer_3_all2all_back_8 -->
<g id="edge325" class="edge">
<title>layer_3_expert_8_gpu4&#45;&gt;layer_3_all2all_back_8</title>
<path fill="none" stroke="black" d="M2743.58,-12503.24C2743.66,-12495.44 2743.75,-12486.57 2743.84,-12477.8"/>
<polygon fill="black" stroke="black" points="2747.35,-12477.66 2743.95,-12467.62 2740.35,-12477.59 2747.35,-12477.66"/>
</g>
<!-- layer_3_all2all_expert_8&#45;&gt;layer_3_expert_8_gpu4 -->
<g id="edge302" class="edge">
<title>layer_3_all2all_expert_8&#45;&gt;layer_3_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2743.32,-12591.15C2743.32,-12582.84 2743.32,-12574.01 2743.32,-12565.73"/>
<polygon fill="black" stroke="black" points="2746.82,-12565.61 2743.32,-12555.61 2739.82,-12565.61 2746.82,-12565.61"/>
</g>
<!-- layer_3_expert_9_gpu4 -->
<g id="node226" class="node">
<title>layer_3_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3167.82,-12555.42 2958.82,-12555.42 2958.82,-12503.42 3167.82,-12503.42 3167.82,-12555.42"/>
<text text-anchor="middle" x="3063.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3063.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3063.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3063.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_9 -->
<g id="node249" class="node">
<title>layer_3_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3065.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3065.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3065.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3065.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3065.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_9_gpu4&#45;&gt;layer_3_all2all_back_9 -->
<g id="edge326" class="edge">
<title>layer_3_expert_9_gpu4&#45;&gt;layer_3_all2all_back_9</title>
<path fill="none" stroke="black" d="M3063.84,-12503.24C3064,-12495.44 3064.19,-12486.57 3064.37,-12477.8"/>
<polygon fill="black" stroke="black" points="3067.87,-12477.69 3064.58,-12467.62 3060.87,-12477.55 3067.87,-12477.69"/>
</g>
<!-- layer_3_all2all_expert_9&#45;&gt;layer_3_expert_9_gpu4 -->
<g id="edge304" class="edge">
<title>layer_3_all2all_expert_9&#45;&gt;layer_3_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3062.07,-12591.15C3062.24,-12582.84 3062.42,-12574.01 3062.59,-12565.73"/>
<polygon fill="black" stroke="black" points="3066.09,-12565.68 3062.8,-12555.61 3059.09,-12565.54 3066.09,-12565.68"/>
</g>
<!-- layer_3_expert_10_gpu5 -->
<g id="node228" class="node">
<title>layer_3_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3487.82,-12555.42 3278.82,-12555.42 3278.82,-12503.42 3487.82,-12503.42 3487.82,-12555.42"/>
<text text-anchor="middle" x="3383.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3383.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3383.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3383.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_10 -->
<g id="node250" class="node">
<title>layer_3_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3386.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3386.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3386.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3386.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3386.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_10_gpu5&#45;&gt;layer_3_all2all_back_10 -->
<g id="edge327" class="edge">
<title>layer_3_expert_10_gpu5&#45;&gt;layer_3_all2all_back_10</title>
<path fill="none" stroke="black" d="M3384.1,-12503.24C3384.34,-12495.44 3384.62,-12486.57 3384.89,-12477.8"/>
<polygon fill="black" stroke="black" points="3388.39,-12477.73 3385.21,-12467.62 3381.4,-12477.51 3388.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_10&#45;&gt;layer_3_expert_10_gpu5 -->
<g id="edge306" class="edge">
<title>layer_3_all2all_expert_10&#45;&gt;layer_3_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3382.07,-12591.15C3382.24,-12582.84 3382.42,-12574.01 3382.59,-12565.73"/>
<polygon fill="black" stroke="black" points="3386.09,-12565.68 3382.8,-12555.61 3379.09,-12565.54 3386.09,-12565.68"/>
</g>
<!-- layer_3_expert_11_gpu5 -->
<g id="node230" class="node">
<title>layer_3_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3808.82,-12555.42 3599.82,-12555.42 3599.82,-12503.42 3808.82,-12503.42 3808.82,-12555.42"/>
<text text-anchor="middle" x="3704.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3704.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3704.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3704.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_11 -->
<g id="node251" class="node">
<title>layer_3_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3707.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3707.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3707.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3707.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3707.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_11_gpu5&#45;&gt;layer_3_all2all_back_11 -->
<g id="edge328" class="edge">
<title>layer_3_expert_11_gpu5&#45;&gt;layer_3_all2all_back_11</title>
<path fill="none" stroke="black" d="M3705.1,-12503.24C3705.34,-12495.44 3705.62,-12486.57 3705.89,-12477.8"/>
<polygon fill="black" stroke="black" points="3709.39,-12477.73 3706.21,-12467.62 3702.4,-12477.51 3709.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_11&#45;&gt;layer_3_expert_11_gpu5 -->
<g id="edge308" class="edge">
<title>layer_3_all2all_expert_11&#45;&gt;layer_3_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3702.44,-12591.15C3702.7,-12582.84 3702.97,-12574.01 3703.23,-12565.73"/>
<polygon fill="black" stroke="black" points="3706.73,-12565.72 3703.54,-12555.61 3699.73,-12565.5 3706.73,-12565.72"/>
</g>
<!-- layer_3_expert_12_gpu6 -->
<g id="node232" class="node">
<title>layer_3_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4129.82,-12555.42 3920.82,-12555.42 3920.82,-12503.42 4129.82,-12503.42 4129.82,-12555.42"/>
<text text-anchor="middle" x="4025.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4025.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4025.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4025.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_12 -->
<g id="node252" class="node">
<title>layer_3_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4028.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4028.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4028.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4028.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4028.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_12_gpu6&#45;&gt;layer_3_all2all_back_12 -->
<g id="edge329" class="edge">
<title>layer_3_expert_12_gpu6&#45;&gt;layer_3_all2all_back_12</title>
<path fill="none" stroke="black" d="M4026.1,-12503.24C4026.34,-12495.44 4026.62,-12486.57 4026.89,-12477.8"/>
<polygon fill="black" stroke="black" points="4030.39,-12477.73 4027.21,-12467.62 4023.4,-12477.51 4030.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_12&#45;&gt;layer_3_expert_12_gpu6 -->
<g id="edge310" class="edge">
<title>layer_3_all2all_expert_12&#45;&gt;layer_3_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4023.44,-12591.15C4023.7,-12582.84 4023.97,-12574.01 4024.23,-12565.73"/>
<polygon fill="black" stroke="black" points="4027.73,-12565.72 4024.54,-12555.61 4020.73,-12565.5 4027.73,-12565.72"/>
</g>
<!-- layer_3_expert_13_gpu6 -->
<g id="node234" class="node">
<title>layer_3_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4450.82,-12555.42 4241.82,-12555.42 4241.82,-12503.42 4450.82,-12503.42 4450.82,-12555.42"/>
<text text-anchor="middle" x="4346.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4346.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4346.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4346.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_13 -->
<g id="node253" class="node">
<title>layer_3_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4349.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4349.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4349.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4349.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4349.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_13_gpu6&#45;&gt;layer_3_all2all_back_13 -->
<g id="edge330" class="edge">
<title>layer_3_expert_13_gpu6&#45;&gt;layer_3_all2all_back_13</title>
<path fill="none" stroke="black" d="M4347.1,-12503.24C4347.34,-12495.44 4347.62,-12486.57 4347.89,-12477.8"/>
<polygon fill="black" stroke="black" points="4351.39,-12477.73 4348.21,-12467.62 4344.4,-12477.51 4351.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_13&#45;&gt;layer_3_expert_13_gpu6 -->
<g id="edge312" class="edge">
<title>layer_3_all2all_expert_13&#45;&gt;layer_3_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4344.44,-12591.15C4344.7,-12582.84 4344.97,-12574.01 4345.23,-12565.73"/>
<polygon fill="black" stroke="black" points="4348.73,-12565.72 4345.54,-12555.61 4341.73,-12565.5 4348.73,-12565.72"/>
</g>
<!-- layer_3_expert_14_gpu7 -->
<g id="node236" class="node">
<title>layer_3_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4771.82,-12555.42 4562.82,-12555.42 4562.82,-12503.42 4771.82,-12503.42 4771.82,-12555.42"/>
<text text-anchor="middle" x="4667.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4667.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4667.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4667.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_14 -->
<g id="node254" class="node">
<title>layer_3_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4670.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4670.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4670.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4670.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4670.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_14_gpu7&#45;&gt;layer_3_all2all_back_14 -->
<g id="edge331" class="edge">
<title>layer_3_expert_14_gpu7&#45;&gt;layer_3_all2all_back_14</title>
<path fill="none" stroke="black" d="M4668.1,-12503.24C4668.34,-12495.44 4668.62,-12486.57 4668.89,-12477.8"/>
<polygon fill="black" stroke="black" points="4672.39,-12477.73 4669.21,-12467.62 4665.4,-12477.51 4672.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_14&#45;&gt;layer_3_expert_14_gpu7 -->
<g id="edge314" class="edge">
<title>layer_3_all2all_expert_14&#45;&gt;layer_3_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4665.44,-12591.15C4665.7,-12582.84 4665.97,-12574.01 4666.23,-12565.73"/>
<polygon fill="black" stroke="black" points="4669.73,-12565.72 4666.54,-12555.61 4662.73,-12565.5 4669.73,-12565.72"/>
</g>
<!-- layer_3_expert_15_gpu7 -->
<g id="node238" class="node">
<title>layer_3_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5092.82,-12555.42 4883.82,-12555.42 4883.82,-12503.42 5092.82,-12503.42 5092.82,-12555.42"/>
<text text-anchor="middle" x="4988.32" y="-12543.42" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4988.32" y="-12532.42" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4988.32" y="-12521.42" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4988.32" y="-12510.42" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_15 -->
<g id="node255" class="node">
<title>layer_3_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4991.32" cy="-12430.65" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4991.32" y="-12444.65" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4991.32" y="-12433.65" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4991.32" y="-12422.65" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4991.32" y="-12411.65" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_expert_15_gpu7&#45;&gt;layer_3_all2all_back_15 -->
<g id="edge332" class="edge">
<title>layer_3_expert_15_gpu7&#45;&gt;layer_3_all2all_back_15</title>
<path fill="none" stroke="black" d="M4989.1,-12503.24C4989.34,-12495.44 4989.62,-12486.57 4989.89,-12477.8"/>
<polygon fill="black" stroke="black" points="4993.39,-12477.73 4990.21,-12467.62 4986.4,-12477.51 4993.39,-12477.73"/>
</g>
<!-- layer_3_all2all_expert_15&#45;&gt;layer_3_expert_15_gpu7 -->
<g id="edge316" class="edge">
<title>layer_3_all2all_expert_15&#45;&gt;layer_3_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4986.44,-12591.15C4986.7,-12582.84 4986.97,-12574.01 4987.23,-12565.73"/>
<polygon fill="black" stroke="black" points="4990.73,-12565.72 4987.54,-12555.61 4983.73,-12565.5 4990.73,-12565.72"/>
</g>
<!-- layer_3_output -->
<g id="node256" class="node">
<title>layer_3_output</title>
<polygon fill="lightblue" stroke="black" points="2690.32,-12357.88 2476.32,-12357.88 2476.32,-12305.88 2690.32,-12305.88 2690.32,-12357.88"/>
<text text-anchor="middle" x="2583.32" y="-12345.88" font-family="Arial" font-size="10.00">Layer 3 Output</text>
<text text-anchor="middle" x="2583.32" y="-12334.88" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2583.32" y="-12323.88" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2583.32" y="-12312.88" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_3_all2all_back_0&#45;&gt;layer_3_output -->
<g id="edge333" class="edge">
<title>layer_3_all2all_back_0&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M279.31,-12403.7C298.48,-12399.75 318.42,-12396.21 337.32,-12393.88 755.21,-12342.26 2065.59,-12334.32 2465.96,-12333.1"/>
<polygon fill="black" stroke="black" points="2466.12,-12336.6 2476.11,-12333.07 2466.1,-12329.6 2466.12,-12336.6"/>
</g>
<!-- layer_3_all2all_back_1&#45;&gt;layer_3_output -->
<g id="edge334" class="edge">
<title>layer_3_all2all_back_1&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M600.75,-12403.68C619.79,-12399.76 639.57,-12396.24 658.32,-12393.88 1010.84,-12349.53 2104.7,-12336.77 2466.1,-12333.72"/>
<polygon fill="black" stroke="black" points="2466.35,-12337.22 2476.32,-12333.63 2466.29,-12330.22 2466.35,-12337.22"/>
</g>
<!-- layer_3_all2all_back_2&#45;&gt;layer_3_output -->
<g id="edge335" class="edge">
<title>layer_3_all2all_back_2&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M921.76,-12403.78C940.8,-12399.84 960.58,-12396.3 979.32,-12393.88 1266.83,-12356.78 2146.45,-12339.69 2465.86,-12334.59"/>
<polygon fill="black" stroke="black" points="2466.12,-12338.09 2476.06,-12334.43 2466.01,-12331.09 2466.12,-12338.09"/>
</g>
<!-- layer_3_all2all_back_3&#45;&gt;layer_3_output -->
<g id="edge336" class="edge">
<title>layer_3_all2all_back_3&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M1243.21,-12403.84C1262.12,-12399.92 1281.73,-12396.37 1300.32,-12393.88 1523.45,-12364.01 2192.68,-12343.31 2465.55,-12335.9"/>
<polygon fill="black" stroke="black" points="2465.98,-12339.39 2475.88,-12335.62 2465.79,-12332.39 2465.98,-12339.39"/>
</g>
<!-- layer_3_all2all_back_4&#45;&gt;layer_3_output -->
<g id="edge337" class="edge">
<title>layer_3_all2all_back_4&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M1564.68,-12403.99C1583.45,-12400.09 1602.89,-12396.49 1621.32,-12393.88 1923.78,-12350.95 2284.05,-12338.23 2465.88,-12334.46"/>
<polygon fill="black" stroke="black" points="2466.07,-12337.96 2476,-12334.26 2465.93,-12330.96 2466.07,-12337.96"/>
</g>
<!-- layer_3_all2all_back_5&#45;&gt;layer_3_output -->
<g id="edge338" class="edge">
<title>layer_3_all2all_back_5&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M1887.05,-12404.2C1905.41,-12400.35 1924.36,-12396.72 1942.32,-12393.88 2124.01,-12365.16 2336.95,-12348.16 2465.91,-12339.68"/>
<polygon fill="black" stroke="black" points="2466.45,-12343.15 2476.2,-12339.01 2465.99,-12336.16 2466.45,-12343.15"/>
</g>
<!-- layer_3_all2all_back_6&#45;&gt;layer_3_output -->
<g id="edge339" class="edge">
<title>layer_3_all2all_back_6&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M2211.35,-12404.96C2228.71,-12401.16 2246.5,-12397.35 2263.32,-12393.88 2330.35,-12380.05 2405.51,-12365.66 2466.14,-12354.34"/>
<polygon fill="black" stroke="black" points="2466.94,-12357.75 2476.13,-12352.47 2465.66,-12350.87 2466.94,-12357.75"/>
</g>
<!-- layer_3_all2all_back_7&#45;&gt;layer_3_output -->
<g id="edge340" class="edge">
<title>layer_3_all2all_back_7&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M2478.38,-12396.34C2496.09,-12385.64 2515.6,-12373.83 2532.95,-12363.34"/>
<polygon fill="black" stroke="black" points="2535.06,-12366.15 2541.81,-12357.98 2531.44,-12360.16 2535.06,-12366.15"/>
</g>
<!-- layer_3_all2all_back_8&#45;&gt;layer_3_output -->
<g id="edge341" class="edge">
<title>layer_3_all2all_back_8&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M2688.91,-12396.34C2671.1,-12385.64 2651.46,-12373.83 2634,-12363.34"/>
<polygon fill="black" stroke="black" points="2635.47,-12360.14 2625.09,-12357.98 2631.86,-12366.14 2635.47,-12360.14"/>
</g>
<!-- layer_3_all2all_back_9&#45;&gt;layer_3_output -->
<g id="edge342" class="edge">
<title>layer_3_all2all_back_9&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M2956.3,-12404.95C2938.93,-12401.15 2921.15,-12397.34 2904.32,-12393.88 2836.96,-12380 2761.39,-12365.58 2700.51,-12354.25"/>
<polygon fill="black" stroke="black" points="2700.96,-12350.77 2690.48,-12352.39 2699.68,-12357.65 2700.96,-12350.77"/>
</g>
<!-- layer_3_all2all_back_10&#45;&gt;layer_3_output -->
<g id="edge343" class="edge">
<title>layer_3_all2all_back_10&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M3280.59,-12404.2C3262.24,-12400.34 3243.28,-12396.71 3225.32,-12393.88 3043.22,-12365.11 2829.76,-12348.11 2700.63,-12339.65"/>
<polygon fill="black" stroke="black" points="2700.53,-12336.13 2690.33,-12338.98 2700.08,-12343.12 2700.53,-12336.13"/>
</g>
<!-- layer_3_all2all_back_11&#45;&gt;layer_3_output -->
<g id="edge344" class="edge">
<title>layer_3_all2all_back_11&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M3602.96,-12403.99C3584.2,-12400.08 3564.75,-12396.49 3546.32,-12393.88 3243.34,-12350.89 2882.42,-12338.19 2700.52,-12334.44"/>
<polygon fill="black" stroke="black" points="2700.46,-12330.94 2690.39,-12334.24 2700.32,-12337.94 2700.46,-12330.94"/>
</g>
<!-- layer_3_all2all_back_12&#45;&gt;layer_3_output -->
<g id="edge345" class="edge">
<title>layer_3_all2all_back_12&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M3924.43,-12403.84C3905.53,-12399.92 3885.91,-12396.36 3867.32,-12393.88 3643.88,-12363.97 2973.45,-12343.28 2700.68,-12335.88"/>
<polygon fill="black" stroke="black" points="2700.45,-12332.37 2690.36,-12335.6 2700.26,-12339.37 2700.45,-12332.37"/>
</g>
<!-- layer_3_all2all_back_13&#45;&gt;layer_3_output -->
<g id="edge346" class="edge">
<title>layer_3_all2all_back_13&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M4245.88,-12403.78C4226.84,-12399.84 4207.06,-12396.3 4188.32,-12393.88 3900.54,-12356.75 3019.94,-12339.67 2700.57,-12334.58"/>
<polygon fill="black" stroke="black" points="2700.42,-12331.08 2690.37,-12334.42 2700.31,-12338.08 2700.42,-12331.08"/>
</g>
<!-- layer_3_all2all_back_14&#45;&gt;layer_3_output -->
<g id="edge347" class="edge">
<title>layer_3_all2all_back_14&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M4566.89,-12403.68C4547.85,-12399.76 4528.07,-12396.24 4509.32,-12393.88 4156.62,-12349.51 3062.19,-12336.77 2700.6,-12333.72"/>
<polygon fill="black" stroke="black" points="2700.41,-12330.22 2690.38,-12333.63 2700.35,-12337.22 2700.41,-12330.22"/>
</g>
<!-- layer_3_all2all_back_15&#45;&gt;layer_3_output -->
<g id="edge348" class="edge">
<title>layer_3_all2all_back_15&#45;&gt;layer_3_output</title>
<path fill="none" stroke="black" d="M4888.33,-12403.7C4869.16,-12399.75 4849.22,-12396.21 4830.32,-12393.88 4412.25,-12342.24 3101.28,-12334.31 2700.73,-12333.1"/>
<polygon fill="black" stroke="black" points="2700.59,-12329.6 2690.58,-12333.07 2700.57,-12336.6 2700.59,-12329.6"/>
</g>
<!-- layer_4_tp_gather -->
<g id="node258" class="node">
<title>layer_4_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2583.32" cy="-12233.11" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2583.32" y="-12247.11" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2583.32" y="-12236.11" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2583.32" y="-12225.11" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2583.32" y="-12214.11" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_3_output&#45;&gt;layer_4_tp_gather -->
<g id="edge349" class="edge">
<title>layer_3_output&#45;&gt;layer_4_tp_gather</title>
<path fill="none" stroke="black" d="M2565.3,-12305.7C2563.64,-12297.73 2562.91,-12288.65 2563.1,-12279.7"/>
<polygon fill="black" stroke="black" points="2566.59,-12279.91 2563.71,-12269.72 2559.61,-12279.49 2566.59,-12279.91"/>
</g>
<!-- layer_3_output&#45;&gt;layer_4_tp_gather -->
<g id="edge351" class="edge">
<title>layer_3_output&#45;&gt;layer_4_tp_gather</title>
<path fill="none" stroke="black" d="M2577.32,-12305.7C2576.77,-12297.9 2576.53,-12289.03 2576.58,-12280.26"/>
<polygon fill="black" stroke="black" points="2580.08,-12280.15 2576.77,-12270.08 2573.08,-12280.02 2580.08,-12280.15"/>
</g>
<!-- layer_3_output&#45;&gt;layer_4_tp_gather -->
<g id="edge353" class="edge">
<title>layer_3_output&#45;&gt;layer_4_tp_gather</title>
<path fill="none" stroke="black" d="M2589.33,-12305.7C2589.87,-12297.9 2590.11,-12289.03 2590.06,-12280.26"/>
<polygon fill="black" stroke="black" points="2593.56,-12280.02 2589.87,-12270.08 2586.56,-12280.15 2593.56,-12280.02"/>
</g>
<!-- layer_3_output&#45;&gt;layer_4_tp_gather -->
<g id="edge355" class="edge">
<title>layer_3_output&#45;&gt;layer_4_tp_gather</title>
<path fill="none" stroke="black" d="M2601.34,-12305.7C2603,-12297.73 2603.73,-12288.65 2603.54,-12279.7"/>
<polygon fill="black" stroke="black" points="2607.03,-12279.49 2602.93,-12269.72 2600.05,-12279.91 2607.03,-12279.49"/>
</g>
<!-- layer_4_qkv_gpu0 -->
<g id="node257" class="node">
<title>layer_4_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2345.32,-12160.34 2139.32,-12160.34 2139.32,-12108.34 2345.32,-12108.34 2345.32,-12160.34"/>
<text text-anchor="middle" x="2242.32" y="-12148.34" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2242.32" y="-12137.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2242.32" y="-12126.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2242.32" y="-12115.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_4_attn_gpu0 -->
<g id="node262" class="node">
<title>layer_4_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2338.32,-12072.34 2136.32,-12072.34 2136.32,-12020.34 2338.32,-12020.34 2338.32,-12072.34"/>
<text text-anchor="middle" x="2237.32" y="-12060.34" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2237.32" y="-12049.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2237.32" y="-12038.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2237.32" y="-12027.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_4_qkv_gpu0&#45;&gt;layer_4_attn_gpu0 -->
<g id="edge357" class="edge">
<title>layer_4_qkv_gpu0&#45;&gt;layer_4_attn_gpu0</title>
<path fill="none" stroke="black" d="M2240.85,-12108C2240.38,-12100.04 2239.87,-12091.1 2239.37,-12082.58"/>
<polygon fill="black" stroke="black" points="2242.86,-12082.27 2238.78,-12072.49 2235.87,-12082.68 2242.86,-12082.27"/>
</g>
<!-- layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu0 -->
<g id="edge350" class="edge">
<title>layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2486.52,-12204.64C2440.74,-12191.65 2386.19,-12176.17 2340.28,-12163.14"/>
<polygon fill="black" stroke="black" points="2341.19,-12159.76 2330.61,-12160.39 2339.28,-12166.49 2341.19,-12159.76"/>
</g>
<!-- layer_4_qkv_gpu1 -->
<g id="node259" class="node">
<title>layer_4_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2573.32,-12160.34 2367.32,-12160.34 2367.32,-12108.34 2573.32,-12108.34 2573.32,-12160.34"/>
<text text-anchor="middle" x="2470.32" y="-12148.34" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2470.32" y="-12137.34" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2470.32" y="-12126.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2470.32" y="-12115.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu1 -->
<g id="edge352" class="edge">
<title>layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2542.84,-12197.44C2531.22,-12187.49 2518.6,-12176.68 2507.2,-12166.92"/>
<polygon fill="black" stroke="black" points="2509.4,-12164.2 2499.53,-12160.35 2504.85,-12169.51 2509.4,-12164.2"/>
</g>
<!-- layer_4_qkv_gpu2 -->
<g id="node260" class="node">
<title>layer_4_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2799.32,-12160.34 2593.32,-12160.34 2593.32,-12108.34 2799.32,-12108.34 2799.32,-12160.34"/>
<text text-anchor="middle" x="2696.32" y="-12148.34" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2696.32" y="-12137.34" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2696.32" y="-12126.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2696.32" y="-12115.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu2 -->
<g id="edge354" class="edge">
<title>layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2623.8,-12197.44C2635.43,-12187.49 2648.04,-12176.68 2659.44,-12166.92"/>
<polygon fill="black" stroke="black" points="2661.79,-12169.51 2667.11,-12160.35 2657.24,-12164.2 2661.79,-12169.51"/>
</g>
<!-- layer_4_qkv_gpu3 -->
<g id="node261" class="node">
<title>layer_4_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3028.32,-12160.34 2822.32,-12160.34 2822.32,-12108.34 3028.32,-12108.34 3028.32,-12160.34"/>
<text text-anchor="middle" x="2925.32" y="-12148.34" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2925.32" y="-12137.34" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2925.32" y="-12126.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2925.32" y="-12115.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu3 -->
<g id="edge356" class="edge">
<title>layer_4_tp_gather&#45;&gt;layer_4_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2679.95,-12204.77C2725.96,-12191.75 2780.89,-12176.2 2827.11,-12163.13"/>
<polygon fill="black" stroke="black" points="2828.16,-12166.47 2836.83,-12160.38 2826.25,-12159.73 2828.16,-12166.47"/>
</g>
<!-- layer_4_attn_gpu1 -->
<g id="node263" class="node">
<title>layer_4_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2567.32,-12072.34 2365.32,-12072.34 2365.32,-12020.34 2567.32,-12020.34 2567.32,-12072.34"/>
<text text-anchor="middle" x="2466.32" y="-12060.34" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2466.32" y="-12049.34" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2466.32" y="-12038.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2466.32" y="-12027.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_4_qkv_gpu1&#45;&gt;layer_4_attn_gpu1 -->
<g id="edge358" class="edge">
<title>layer_4_qkv_gpu1&#45;&gt;layer_4_attn_gpu1</title>
<path fill="none" stroke="black" d="M2469.14,-12108C2468.77,-12100.04 2468.36,-12091.1 2467.96,-12082.58"/>
<polygon fill="black" stroke="black" points="2471.45,-12082.32 2467.49,-12072.49 2464.46,-12082.65 2471.45,-12082.32"/>
</g>
<!-- layer_4_attn_gpu2 -->
<g id="node264" class="node">
<title>layer_4_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2797.32,-12072.34 2595.32,-12072.34 2595.32,-12020.34 2797.32,-12020.34 2797.32,-12072.34"/>
<text text-anchor="middle" x="2696.32" y="-12060.34" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2696.32" y="-12049.34" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2696.32" y="-12038.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2696.32" y="-12027.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_4_qkv_gpu2&#45;&gt;layer_4_attn_gpu2 -->
<g id="edge359" class="edge">
<title>layer_4_qkv_gpu2&#45;&gt;layer_4_attn_gpu2</title>
<path fill="none" stroke="black" d="M2696.32,-12108C2696.32,-12100.04 2696.32,-12091.1 2696.32,-12082.58"/>
<polygon fill="black" stroke="black" points="2699.82,-12082.49 2696.32,-12072.49 2692.82,-12082.49 2699.82,-12082.49"/>
</g>
<!-- layer_4_attn_gpu3 -->
<g id="node265" class="node">
<title>layer_4_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3028.32,-12072.34 2826.32,-12072.34 2826.32,-12020.34 3028.32,-12020.34 3028.32,-12072.34"/>
<text text-anchor="middle" x="2927.32" y="-12060.34" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2927.32" y="-12049.34" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2927.32" y="-12038.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2927.32" y="-12027.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_4_qkv_gpu3&#45;&gt;layer_4_attn_gpu3 -->
<g id="edge360" class="edge">
<title>layer_4_qkv_gpu3&#45;&gt;layer_4_attn_gpu3</title>
<path fill="none" stroke="black" d="M2925.91,-12108C2926.1,-12100.04 2926.3,-12091.1 2926.5,-12082.58"/>
<polygon fill="black" stroke="black" points="2930,-12082.57 2926.74,-12072.49 2923,-12082.41 2930,-12082.57"/>
</g>
<!-- layer_4_attn_out_gpu0 -->
<g id="node266" class="node">
<title>layer_4_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2340.32,-11984.34 2126.32,-11984.34 2126.32,-11932.34 2340.32,-11932.34 2340.32,-11984.34"/>
<text text-anchor="middle" x="2233.32" y="-11972.34" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2233.32" y="-11961.34" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2233.32" y="-11950.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2233.32" y="-11939.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_attn_gpu0&#45;&gt;layer_4_attn_out_gpu0 -->
<g id="edge361" class="edge">
<title>layer_4_attn_gpu0&#45;&gt;layer_4_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2236.14,-12020C2235.77,-12012.04 2235.36,-12003.1 2234.96,-11994.58"/>
<polygon fill="black" stroke="black" points="2238.45,-11994.32 2234.49,-11984.49 2231.46,-11994.65 2238.45,-11994.32"/>
</g>
<!-- layer_4_attn_out_gpu1 -->
<g id="node267" class="node">
<title>layer_4_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2572.32,-11984.34 2358.32,-11984.34 2358.32,-11932.34 2572.32,-11932.34 2572.32,-11984.34"/>
<text text-anchor="middle" x="2465.32" y="-11972.34" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2465.32" y="-11961.34" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2465.32" y="-11950.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2465.32" y="-11939.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_attn_gpu1&#45;&gt;layer_4_attn_out_gpu1 -->
<g id="edge362" class="edge">
<title>layer_4_attn_gpu1&#45;&gt;layer_4_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2466.03,-12020C2465.93,-12012.04 2465.83,-12003.1 2465.73,-11994.58"/>
<polygon fill="black" stroke="black" points="2469.23,-11994.45 2465.61,-11984.49 2462.23,-11994.53 2469.23,-11994.45"/>
</g>
<!-- layer_4_attn_out_gpu2 -->
<g id="node268" class="node">
<title>layer_4_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2804.32,-11984.34 2590.32,-11984.34 2590.32,-11932.34 2804.32,-11932.34 2804.32,-11984.34"/>
<text text-anchor="middle" x="2697.32" y="-11972.34" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2697.32" y="-11961.34" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2697.32" y="-11950.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2697.32" y="-11939.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_attn_gpu2&#45;&gt;layer_4_attn_out_gpu2 -->
<g id="edge363" class="edge">
<title>layer_4_attn_gpu2&#45;&gt;layer_4_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2696.62,-12020C2696.71,-12012.04 2696.81,-12003.1 2696.91,-11994.58"/>
<polygon fill="black" stroke="black" points="2700.41,-11994.53 2697.03,-11984.49 2693.41,-11994.45 2700.41,-11994.53"/>
</g>
<!-- layer_4_attn_out_gpu3 -->
<g id="node269" class="node">
<title>layer_4_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3036.32,-11984.34 2822.32,-11984.34 2822.32,-11932.34 3036.32,-11932.34 3036.32,-11984.34"/>
<text text-anchor="middle" x="2929.32" y="-11972.34" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2929.32" y="-11961.34" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2929.32" y="-11950.34" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2929.32" y="-11939.34" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_attn_gpu3&#45;&gt;layer_4_attn_out_gpu3 -->
<g id="edge364" class="edge">
<title>layer_4_attn_gpu3&#45;&gt;layer_4_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2927.91,-12020C2928.1,-12012.04 2928.3,-12003.1 2928.5,-11994.58"/>
<polygon fill="black" stroke="black" points="2932,-11994.57 2928.74,-11984.49 2925,-11994.41 2932,-11994.57"/>
</g>
<!-- layer_4_attn_allreduce -->
<g id="node270" class="node">
<title>layer_4_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2581.32" cy="-11859.57" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2581.32" y="-11873.57" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2581.32" y="-11862.57" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2581.32" y="-11851.57" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2581.32" y="-11840.57" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_attn_out_gpu0&#45;&gt;layer_4_attn_allreduce -->
<g id="edge365" class="edge">
<title>layer_4_attn_out_gpu0&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2323.39,-11932.29C2369.36,-11919.51 2425.61,-11903.87 2473.84,-11890.46"/>
<polygon fill="black" stroke="black" points="2474.99,-11893.77 2483.69,-11887.72 2473.11,-11887.03 2474.99,-11893.77"/>
</g>
<!-- layer_4_attn_out_gpu1&#45;&gt;layer_4_attn_allreduce -->
<g id="edge366" class="edge">
<title>layer_4_attn_out_gpu1&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2495.5,-11932.17C2506.73,-11922.8 2519.78,-11911.91 2532.26,-11901.49"/>
<polygon fill="black" stroke="black" points="2534.51,-11904.18 2539.94,-11895.08 2530.02,-11898.8 2534.51,-11904.18"/>
</g>
<!-- layer_4_attn_out_gpu2&#45;&gt;layer_4_attn_allreduce -->
<g id="edge367" class="edge">
<title>layer_4_attn_out_gpu2&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2667.15,-11932.17C2655.92,-11922.8 2642.86,-11911.91 2630.38,-11901.49"/>
<polygon fill="black" stroke="black" points="2632.62,-11898.8 2622.7,-11895.08 2628.13,-11904.18 2632.62,-11898.8"/>
</g>
<!-- layer_4_attn_out_gpu3&#45;&gt;layer_4_attn_allreduce -->
<g id="edge368" class="edge">
<title>layer_4_attn_out_gpu3&#45;&gt;layer_4_attn_allreduce</title>
<path fill="none" stroke="black" d="M2839.25,-11932.29C2793.28,-11919.51 2737.03,-11903.87 2688.8,-11890.46"/>
<polygon fill="black" stroke="black" points="2689.53,-11887.03 2678.96,-11887.72 2687.65,-11893.77 2689.53,-11887.03"/>
</g>
<!-- layer_4_gate -->
<g id="node271" class="node">
<title>layer_4_gate</title>
<polygon fill="lightyellow" stroke="black" points="2798.18,-11786.8 2453.2,-11786.8 2364.46,-11682.8 2709.44,-11682.8 2798.18,-11786.8"/>
<text text-anchor="middle" x="2581.32" y="-11748.8" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2581.32" y="-11737.8" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2581.32" y="-11726.8" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2581.32" y="-11715.8" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_4_attn_allreduce&#45;&gt;layer_4_gate -->
<g id="edge369" class="edge">
<title>layer_4_attn_allreduce&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2562.76,-11823.06C2561.65,-11815.02 2561.08,-11806.25 2561.07,-11797.47"/>
<polygon fill="black" stroke="black" points="2564.58,-11797.29 2561.31,-11787.21 2557.58,-11797.13 2564.58,-11797.29"/>
</g>
<!-- layer_4_attn_allreduce&#45;&gt;layer_4_gate -->
<g id="edge370" class="edge">
<title>layer_4_attn_allreduce&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2575.12,-11822.73C2574.75,-11814.69 2574.57,-11805.94 2574.57,-11797.19"/>
<polygon fill="black" stroke="black" points="2578.07,-11796.99 2574.65,-11786.97 2571.07,-11796.94 2578.07,-11796.99"/>
</g>
<!-- layer_4_attn_allreduce&#45;&gt;layer_4_gate -->
<g id="edge371" class="edge">
<title>layer_4_attn_allreduce&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2587.52,-11822.73C2587.89,-11814.69 2588.07,-11805.94 2588.07,-11797.19"/>
<polygon fill="black" stroke="black" points="2591.57,-11796.94 2587.99,-11786.97 2584.57,-11796.99 2591.57,-11796.94"/>
</g>
<!-- layer_4_attn_allreduce&#45;&gt;layer_4_gate -->
<g id="edge372" class="edge">
<title>layer_4_attn_allreduce&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2599.88,-11823.06C2600.99,-11815.02 2601.56,-11806.25 2601.57,-11797.47"/>
<polygon fill="black" stroke="black" points="2605.06,-11797.13 2601.33,-11787.21 2598.07,-11797.29 2605.06,-11797.13"/>
</g>
<!-- layer_4_all2all_expert_0 -->
<g id="node273" class="node">
<title>layer_4_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="187.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="187.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="187.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="187.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="187.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_0 -->
<g id="edge373" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2405.31,-11730.83C1951.54,-11722.56 749.86,-11696.51 354.32,-11646.8 337.23,-11644.65 319.29,-11641.64 301.78,-11638.26"/>
<polygon fill="black" stroke="black" points="302.01,-11634.74 291.52,-11636.23 300.65,-11641.6 302.01,-11634.74"/>
</g>
<!-- layer_4_all2all_expert_1 -->
<g id="node275" class="node">
<title>layer_4_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="511.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="511.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="511.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="511.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="511.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_1 -->
<g id="edge375" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2404.13,-11729.61C1997.04,-11719.36 1004.62,-11690.6 673.32,-11646.8 657.36,-11644.69 640.64,-11641.79 624.27,-11638.56"/>
<polygon fill="black" stroke="black" points="624.62,-11635.06 614.12,-11636.51 623.23,-11641.92 624.62,-11635.06"/>
</g>
<!-- layer_4_all2all_expert_2 -->
<g id="node277" class="node">
<title>layer_4_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="830.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="830.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="830.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="830.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="830.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_2 -->
<g id="edge377" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2407.45,-11733.42C2114.39,-11730.74 1504.06,-11716.37 993.32,-11646.8 977.27,-11644.61 960.46,-11641.68 943.99,-11638.42"/>
<polygon fill="black" stroke="black" points="944.28,-11634.91 933.78,-11636.36 942.89,-11641.77 944.28,-11634.91"/>
</g>
<!-- layer_4_all2all_expert_3 -->
<g id="node279" class="node">
<title>layer_4_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1150.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1150.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1150.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1150.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1150.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_3 -->
<g id="edge379" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2404.45,-11729.81C2158.77,-11722.41 1700.8,-11701.91 1314.32,-11646.8 1298.19,-11644.5 1281.29,-11641.5 1264.72,-11638.21"/>
<polygon fill="black" stroke="black" points="1264.95,-11634.69 1254.45,-11636.13 1263.56,-11641.55 1264.95,-11634.69"/>
</g>
<!-- layer_4_all2all_expert_4 -->
<g id="node281" class="node">
<title>layer_4_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1471.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1471.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1471.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1471.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1471.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_4 -->
<g id="edge381" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.67,-11724.13C2207.84,-11712.29 1897,-11688.48 1631.32,-11646.8 1616.33,-11644.45 1600.64,-11641.52 1585.19,-11638.37"/>
<polygon fill="black" stroke="black" points="1585.59,-11634.87 1575.09,-11636.26 1584.17,-11641.73 1585.59,-11634.87"/>
</g>
<!-- layer_4_all2all_expert_5 -->
<g id="node283" class="node">
<title>layer_4_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1788.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1788.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1788.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1788.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1788.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_5 -->
<g id="edge383" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.87,-11711.7C2262.84,-11696.17 2094.78,-11673.45 1947.32,-11646.8 1933.07,-11644.22 1918.16,-11641.25 1903.43,-11638.13"/>
<polygon fill="black" stroke="black" points="1903.77,-11634.63 1893.26,-11635.96 1902.31,-11641.47 1903.77,-11634.63"/>
</g>
<!-- layer_4_all2all_expert_6 -->
<g id="node285" class="node">
<title>layer_4_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2104.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2104.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2104.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2104.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2104.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_6 -->
<g id="edge385" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2382.83,-11682.71C2325.51,-11667.96 2265.03,-11652.39 2215.12,-11639.55"/>
<polygon fill="black" stroke="black" points="2215.84,-11636.12 2205.28,-11637.01 2214.09,-11642.9 2215.84,-11636.12"/>
</g>
<!-- layer_4_all2all_expert_7 -->
<g id="node287" class="node">
<title>layer_4_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2423.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2423.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2423.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2423.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2423.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_7 -->
<g id="edge387" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2515.23,-11682.44C2502.05,-11672.2 2488.38,-11661.58 2475.73,-11651.76"/>
<polygon fill="black" stroke="black" points="2477.63,-11648.8 2467.59,-11645.43 2473.34,-11654.33 2477.63,-11648.8"/>
</g>
<!-- layer_4_all2all_expert_8 -->
<g id="node289" class="node">
<title>layer_4_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2739.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2739.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2739.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2739.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2739.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_8 -->
<g id="edge389" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2647.41,-11682.44C2660.59,-11672.2 2674.26,-11661.58 2686.91,-11651.76"/>
<polygon fill="black" stroke="black" points="2689.3,-11654.33 2695.05,-11645.43 2685.01,-11648.8 2689.3,-11654.33"/>
</g>
<!-- layer_4_all2all_expert_9 -->
<g id="node291" class="node">
<title>layer_4_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3057.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3057.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3057.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3057.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3057.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_9 -->
<g id="edge391" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2722.2,-11697.46C2793.93,-11678.96 2879.86,-11656.8 2946.74,-11639.55"/>
<polygon fill="black" stroke="black" points="2947.66,-11642.93 2956.47,-11637.04 2945.91,-11636.15 2947.66,-11642.93"/>
</g>
<!-- layer_4_all2all_expert_10 -->
<g id="node293" class="node">
<title>layer_4_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3377.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3377.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3377.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3377.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3377.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_10 -->
<g id="edge393" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2737.94,-11715.79C2866.38,-11700.17 3052.69,-11675.59 3214.32,-11646.8 3229.41,-11644.11 3245.23,-11641.01 3260.82,-11637.77"/>
<polygon fill="black" stroke="black" points="3261.96,-11641.11 3271.03,-11635.63 3260.53,-11634.26 3261.96,-11641.11"/>
</g>
<!-- layer_4_all2all_expert_11 -->
<g id="node295" class="node">
<title>layer_4_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3697.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3697.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3697.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3697.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3697.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_11 -->
<g id="edge395" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2745.66,-11725.05C2936.19,-11713.47 3259.31,-11689.36 3534.32,-11646.8 3549.97,-11644.38 3566.37,-11641.36 3582.48,-11638.11"/>
<polygon fill="black" stroke="black" points="3583.37,-11641.5 3592.46,-11636.06 3581.96,-11634.64 3583.37,-11641.5"/>
</g>
<!-- layer_4_all2all_expert_12 -->
<g id="node297" class="node">
<title>layer_4_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4018.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4018.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4018.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4018.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4018.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_12 -->
<g id="edge397" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2749.97,-11730.13C2994.49,-11723.03 3461.21,-11702.79 3854.32,-11646.8 3870.45,-11644.5 3887.35,-11641.5 3903.92,-11638.22"/>
<polygon fill="black" stroke="black" points="3905.08,-11641.55 3914.19,-11636.14 3903.69,-11634.69 3905.08,-11641.55"/>
</g>
<!-- layer_4_all2all_expert_13 -->
<g id="node299" class="node">
<title>layer_4_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4339.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4339.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4339.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4339.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4339.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_13 -->
<g id="edge399" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2752.9,-11733.42C3045.89,-11730.77 3660.89,-11716.48 4175.32,-11646.8 4191.74,-11644.58 4208.95,-11641.58 4225.79,-11638.25"/>
<polygon fill="black" stroke="black" points="4226.55,-11641.67 4235.66,-11636.26 4225.16,-11634.81 4226.55,-11641.67"/>
</g>
<!-- layer_4_all2all_expert_14 -->
<g id="node301" class="node">
<title>layer_4_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4660.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4660.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4660.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4660.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4660.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_14 -->
<g id="edge401" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2749.76,-11729.81C3152.24,-11719.68 4161.17,-11690.64 4496.32,-11646.8 4512.75,-11644.65 4529.96,-11641.69 4546.81,-11638.39"/>
<polygon fill="black" stroke="black" points="4547.56,-11641.81 4556.68,-11636.41 4546.18,-11634.95 4547.56,-11641.81"/>
</g>
<!-- layer_4_all2all_expert_15 -->
<g id="node303" class="node">
<title>layer_4_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4981.32" cy="-11610.03" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4981.32" y="-11624.03" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4981.32" y="-11613.03" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4981.32" y="-11602.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4981.32" y="-11591.03" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_all2all_expert_15 -->
<g id="edge403" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2750.66,-11731.07C3200.48,-11723.2 4418.1,-11697.7 4817.32,-11646.8 4833.87,-11644.69 4851.23,-11641.73 4868.19,-11638.41"/>
<polygon fill="black" stroke="black" points="4869.01,-11641.82 4878.13,-11636.42 4867.64,-11634.96 4869.01,-11641.82"/>
</g>
<!-- layer_4_expert_0_gpu0 -->
<g id="node272" class="node">
<title>layer_4_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="284.82,-11537.26 75.82,-11537.26 75.82,-11485.26 284.82,-11485.26 284.82,-11537.26"/>
<text text-anchor="middle" x="180.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="180.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="180.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="180.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_0 -->
<g id="node304" class="node">
<title>layer_4_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="172.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="172.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="172.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="172.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="172.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_0_gpu0&#45;&gt;layer_4_all2all_back_0 -->
<g id="edge405" class="edge">
<title>layer_4_expert_0_gpu0&#45;&gt;layer_4_all2all_back_0</title>
<path fill="none" stroke="black" d="M178.24,-11485.09C177.59,-11477.28 176.86,-11468.41 176.14,-11459.65"/>
<polygon fill="black" stroke="black" points="179.61,-11459.14 175.3,-11449.47 172.63,-11459.72 179.61,-11459.14"/>
</g>
<!-- layer_4_all2all_expert_0&#45;&gt;layer_4_expert_0_gpu0 -->
<g id="edge374" class="edge">
<title>layer_4_all2all_expert_0&#45;&gt;layer_4_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M184.71,-11573C184.11,-11564.68 183.47,-11555.85 182.88,-11547.57"/>
<polygon fill="black" stroke="black" points="186.36,-11547.18 182.14,-11537.46 179.37,-11547.68 186.36,-11547.18"/>
</g>
<!-- layer_4_expert_1_gpu0 -->
<g id="node274" class="node">
<title>layer_4_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="605.82,-11537.26 396.82,-11537.26 396.82,-11485.26 605.82,-11485.26 605.82,-11537.26"/>
<text text-anchor="middle" x="501.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="501.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="501.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="501.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_1 -->
<g id="node305" class="node">
<title>layer_4_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="493.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="493.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="493.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="493.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="493.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_1_gpu0&#45;&gt;layer_4_all2all_back_1 -->
<g id="edge406" class="edge">
<title>layer_4_expert_1_gpu0&#45;&gt;layer_4_all2all_back_1</title>
<path fill="none" stroke="black" d="M499.24,-11485.09C498.59,-11477.28 497.86,-11468.41 497.14,-11459.65"/>
<polygon fill="black" stroke="black" points="500.61,-11459.14 496.3,-11449.47 493.63,-11459.72 500.61,-11459.14"/>
</g>
<!-- layer_4_all2all_expert_1&#45;&gt;layer_4_expert_1_gpu0 -->
<g id="edge376" class="edge">
<title>layer_4_all2all_expert_1&#45;&gt;layer_4_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M507.63,-11573.27C506.75,-11564.77 505.81,-11555.72 504.94,-11547.25"/>
<polygon fill="black" stroke="black" points="508.42,-11546.89 503.91,-11537.3 501.46,-11547.61 508.42,-11546.89"/>
</g>
<!-- layer_4_expert_2_gpu1 -->
<g id="node276" class="node">
<title>layer_4_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="920.82,-11537.26 711.82,-11537.26 711.82,-11485.26 920.82,-11485.26 920.82,-11537.26"/>
<text text-anchor="middle" x="816.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="816.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="816.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="816.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_2 -->
<g id="node306" class="node">
<title>layer_4_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="814.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="814.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="814.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="814.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="814.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_2_gpu1&#45;&gt;layer_4_all2all_back_2 -->
<g id="edge407" class="edge">
<title>layer_4_expert_2_gpu1&#45;&gt;layer_4_all2all_back_2</title>
<path fill="none" stroke="black" d="M815.8,-11485.09C815.64,-11477.28 815.46,-11468.41 815.27,-11459.65"/>
<polygon fill="black" stroke="black" points="818.77,-11459.39 815.06,-11449.47 811.77,-11459.54 818.77,-11459.39"/>
</g>
<!-- layer_4_all2all_expert_2&#45;&gt;layer_4_expert_2_gpu1 -->
<g id="edge378" class="edge">
<title>layer_4_all2all_expert_2&#45;&gt;layer_4_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M825.15,-11573.27C823.92,-11564.77 822.61,-11555.72 821.38,-11547.25"/>
<polygon fill="black" stroke="black" points="824.84,-11546.7 819.94,-11537.3 817.91,-11547.7 824.84,-11546.7"/>
</g>
<!-- layer_4_expert_3_gpu1 -->
<g id="node278" class="node">
<title>layer_4_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1244.82,-11537.26 1035.82,-11537.26 1035.82,-11485.26 1244.82,-11485.26 1244.82,-11537.26"/>
<text text-anchor="middle" x="1140.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1140.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1140.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1140.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_3 -->
<g id="node307" class="node">
<title>layer_4_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1135.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1135.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1135.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1135.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1135.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_3_gpu1&#45;&gt;layer_4_all2all_back_3 -->
<g id="edge408" class="edge">
<title>layer_4_expert_3_gpu1&#45;&gt;layer_4_all2all_back_3</title>
<path fill="none" stroke="black" d="M1139.02,-11485.09C1138.62,-11477.28 1138.16,-11468.41 1137.71,-11459.65"/>
<polygon fill="black" stroke="black" points="1141.19,-11459.27 1137.18,-11449.47 1134.2,-11459.63 1141.19,-11459.27"/>
</g>
<!-- layer_4_all2all_expert_3&#45;&gt;layer_4_expert_3_gpu1 -->
<g id="edge380" class="edge">
<title>layer_4_all2all_expert_3&#45;&gt;layer_4_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1146.63,-11573.27C1145.75,-11564.77 1144.81,-11555.72 1143.94,-11547.25"/>
<polygon fill="black" stroke="black" points="1147.42,-11546.89 1142.91,-11537.3 1140.46,-11547.61 1147.42,-11546.89"/>
</g>
<!-- layer_4_expert_4_gpu2 -->
<g id="node280" class="node">
<title>layer_4_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1566.82,-11537.26 1357.82,-11537.26 1357.82,-11485.26 1566.82,-11485.26 1566.82,-11537.26"/>
<text text-anchor="middle" x="1462.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1462.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1462.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1462.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_4 -->
<g id="node308" class="node">
<title>layer_4_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1456.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1456.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1456.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1456.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1456.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_4_gpu2&#45;&gt;layer_4_all2all_back_4 -->
<g id="edge409" class="edge">
<title>layer_4_expert_4_gpu2&#45;&gt;layer_4_all2all_back_4</title>
<path fill="none" stroke="black" d="M1460.76,-11485.09C1460.28,-11477.28 1459.73,-11468.41 1459.18,-11459.65"/>
<polygon fill="black" stroke="black" points="1462.66,-11459.23 1458.55,-11449.47 1455.68,-11459.66 1462.66,-11459.23"/>
</g>
<!-- layer_4_all2all_expert_4&#45;&gt;layer_4_expert_4_gpu2 -->
<g id="edge382" class="edge">
<title>layer_4_all2all_expert_4&#45;&gt;layer_4_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1467.97,-11573C1467.2,-11564.68 1466.37,-11555.85 1465.6,-11547.57"/>
<polygon fill="black" stroke="black" points="1469.08,-11547.09 1464.66,-11537.46 1462.11,-11547.74 1469.08,-11547.09"/>
</g>
<!-- layer_4_expert_5_gpu2 -->
<g id="node282" class="node">
<title>layer_4_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1885.82,-11537.26 1676.82,-11537.26 1676.82,-11485.26 1885.82,-11485.26 1885.82,-11537.26"/>
<text text-anchor="middle" x="1781.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1781.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1781.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1781.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_5 -->
<g id="node309" class="node">
<title>layer_4_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1777.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1777.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1777.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1777.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1777.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_5_gpu2&#45;&gt;layer_4_all2all_back_5 -->
<g id="edge410" class="edge">
<title>layer_4_expert_5_gpu2&#45;&gt;layer_4_all2all_back_5</title>
<path fill="none" stroke="black" d="M1780.28,-11485.09C1779.96,-11477.28 1779.59,-11468.41 1779.23,-11459.65"/>
<polygon fill="black" stroke="black" points="1782.72,-11459.31 1778.81,-11449.47 1775.72,-11459.6 1782.72,-11459.31"/>
</g>
<!-- layer_4_all2all_expert_5&#45;&gt;layer_4_expert_5_gpu2 -->
<g id="edge384" class="edge">
<title>layer_4_all2all_expert_5&#45;&gt;layer_4_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1785.71,-11573C1785.11,-11564.68 1784.47,-11555.85 1783.88,-11547.57"/>
<polygon fill="black" stroke="black" points="1787.36,-11547.18 1783.14,-11537.46 1780.37,-11547.68 1787.36,-11547.18"/>
</g>
<!-- layer_4_expert_6_gpu3 -->
<g id="node284" class="node">
<title>layer_4_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2205.82,-11537.26 1996.82,-11537.26 1996.82,-11485.26 2205.82,-11485.26 2205.82,-11537.26"/>
<text text-anchor="middle" x="2101.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2101.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2101.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2101.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_6 -->
<g id="node310" class="node">
<title>layer_4_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2098.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2098.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2098.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2098.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2098.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_6_gpu3&#45;&gt;layer_4_all2all_back_6 -->
<g id="edge411" class="edge">
<title>layer_4_expert_6_gpu3&#45;&gt;layer_4_all2all_back_6</title>
<path fill="none" stroke="black" d="M2100.54,-11485.09C2100.3,-11477.28 2100.02,-11468.41 2099.75,-11459.65"/>
<polygon fill="black" stroke="black" points="2103.24,-11459.35 2099.44,-11449.47 2096.25,-11459.57 2103.24,-11459.35"/>
</g>
<!-- layer_4_all2all_expert_6&#45;&gt;layer_4_expert_6_gpu3 -->
<g id="edge386" class="edge">
<title>layer_4_all2all_expert_6&#45;&gt;layer_4_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2103.2,-11573C2102.95,-11564.68 2102.67,-11555.85 2102.42,-11547.57"/>
<polygon fill="black" stroke="black" points="2105.91,-11547.34 2102.1,-11537.46 2098.91,-11547.56 2105.91,-11547.34"/>
</g>
<!-- layer_4_expert_7_gpu3 -->
<g id="node286" class="node">
<title>layer_4_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2524.82,-11537.26 2315.82,-11537.26 2315.82,-11485.26 2524.82,-11485.26 2524.82,-11537.26"/>
<text text-anchor="middle" x="2420.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2420.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2420.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2420.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_7 -->
<g id="node311" class="node">
<title>layer_4_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2419.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2419.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2419.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2419.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2419.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_7_gpu3&#45;&gt;layer_4_all2all_back_7 -->
<g id="edge412" class="edge">
<title>layer_4_expert_7_gpu3&#45;&gt;layer_4_all2all_back_7</title>
<path fill="none" stroke="black" d="M2420.06,-11485.09C2419.98,-11477.28 2419.89,-11468.41 2419.8,-11459.65"/>
<polygon fill="black" stroke="black" points="2423.3,-11459.43 2419.69,-11449.47 2416.3,-11459.5 2423.3,-11459.43"/>
</g>
<!-- layer_4_all2all_expert_7&#45;&gt;layer_4_expert_7_gpu3 -->
<g id="edge388" class="edge">
<title>layer_4_all2all_expert_7&#45;&gt;layer_4_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2422.2,-11573C2421.95,-11564.68 2421.67,-11555.85 2421.42,-11547.57"/>
<polygon fill="black" stroke="black" points="2424.91,-11547.34 2421.1,-11537.46 2417.91,-11547.56 2424.91,-11547.34"/>
</g>
<!-- layer_4_expert_8_gpu4 -->
<g id="node288" class="node">
<title>layer_4_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2844.82,-11537.26 2635.82,-11537.26 2635.82,-11485.26 2844.82,-11485.26 2844.82,-11537.26"/>
<text text-anchor="middle" x="2740.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2740.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2740.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2740.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_8 -->
<g id="node312" class="node">
<title>layer_4_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2740.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2740.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2740.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2740.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2740.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_8_gpu4&#45;&gt;layer_4_all2all_back_8 -->
<g id="edge413" class="edge">
<title>layer_4_expert_8_gpu4&#45;&gt;layer_4_all2all_back_8</title>
<path fill="none" stroke="black" d="M2740.32,-11485.09C2740.32,-11477.28 2740.32,-11468.41 2740.32,-11459.65"/>
<polygon fill="black" stroke="black" points="2743.82,-11459.47 2740.32,-11449.47 2736.82,-11459.47 2743.82,-11459.47"/>
</g>
<!-- layer_4_all2all_expert_8&#45;&gt;layer_4_expert_8_gpu4 -->
<g id="edge390" class="edge">
<title>layer_4_all2all_expert_8&#45;&gt;layer_4_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2739.69,-11573C2739.78,-11564.68 2739.87,-11555.85 2739.96,-11547.57"/>
<polygon fill="black" stroke="black" points="2743.46,-11547.49 2740.06,-11537.46 2736.46,-11547.42 2743.46,-11547.49"/>
</g>
<!-- layer_4_expert_9_gpu4 -->
<g id="node290" class="node">
<title>layer_4_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3163.82,-11537.26 2954.82,-11537.26 2954.82,-11485.26 3163.82,-11485.26 3163.82,-11537.26"/>
<text text-anchor="middle" x="3059.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3059.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3059.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3059.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_9 -->
<g id="node313" class="node">
<title>layer_4_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3061.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3061.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3061.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3061.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3061.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_9_gpu4&#45;&gt;layer_4_all2all_back_9 -->
<g id="edge414" class="edge">
<title>layer_4_expert_9_gpu4&#45;&gt;layer_4_all2all_back_9</title>
<path fill="none" stroke="black" d="M3059.84,-11485.09C3060,-11477.28 3060.19,-11468.41 3060.37,-11459.65"/>
<polygon fill="black" stroke="black" points="3063.87,-11459.54 3060.58,-11449.47 3056.87,-11459.39 3063.87,-11459.54"/>
</g>
<!-- layer_4_all2all_expert_9&#45;&gt;layer_4_expert_9_gpu4 -->
<g id="edge392" class="edge">
<title>layer_4_all2all_expert_9&#45;&gt;layer_4_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3058.07,-11573C3058.24,-11564.68 3058.42,-11555.85 3058.59,-11547.57"/>
<polygon fill="black" stroke="black" points="3062.09,-11547.53 3058.8,-11537.46 3055.09,-11547.38 3062.09,-11547.53"/>
</g>
<!-- layer_4_expert_10_gpu5 -->
<g id="node292" class="node">
<title>layer_4_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3483.82,-11537.26 3274.82,-11537.26 3274.82,-11485.26 3483.82,-11485.26 3483.82,-11537.26"/>
<text text-anchor="middle" x="3379.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3379.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3379.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3379.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_10 -->
<g id="node314" class="node">
<title>layer_4_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3382.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3382.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3382.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3382.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3382.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_10_gpu5&#45;&gt;layer_4_all2all_back_10 -->
<g id="edge415" class="edge">
<title>layer_4_expert_10_gpu5&#45;&gt;layer_4_all2all_back_10</title>
<path fill="none" stroke="black" d="M3380.1,-11485.09C3380.34,-11477.28 3380.62,-11468.41 3380.89,-11459.65"/>
<polygon fill="black" stroke="black" points="3384.39,-11459.57 3381.21,-11449.47 3377.4,-11459.35 3384.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_10&#45;&gt;layer_4_expert_10_gpu5 -->
<g id="edge394" class="edge">
<title>layer_4_all2all_expert_10&#45;&gt;layer_4_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3378.07,-11573C3378.24,-11564.68 3378.42,-11555.85 3378.59,-11547.57"/>
<polygon fill="black" stroke="black" points="3382.09,-11547.53 3378.8,-11537.46 3375.09,-11547.38 3382.09,-11547.53"/>
</g>
<!-- layer_4_expert_11_gpu5 -->
<g id="node294" class="node">
<title>layer_4_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3804.82,-11537.26 3595.82,-11537.26 3595.82,-11485.26 3804.82,-11485.26 3804.82,-11537.26"/>
<text text-anchor="middle" x="3700.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3700.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3700.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3700.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_11 -->
<g id="node315" class="node">
<title>layer_4_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3703.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3703.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3703.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3703.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3703.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_11_gpu5&#45;&gt;layer_4_all2all_back_11 -->
<g id="edge416" class="edge">
<title>layer_4_expert_11_gpu5&#45;&gt;layer_4_all2all_back_11</title>
<path fill="none" stroke="black" d="M3701.1,-11485.09C3701.34,-11477.28 3701.62,-11468.41 3701.89,-11459.65"/>
<polygon fill="black" stroke="black" points="3705.39,-11459.57 3702.21,-11449.47 3698.4,-11459.35 3705.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_11&#45;&gt;layer_4_expert_11_gpu5 -->
<g id="edge396" class="edge">
<title>layer_4_all2all_expert_11&#45;&gt;layer_4_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3698.44,-11573C3698.7,-11564.68 3698.97,-11555.85 3699.23,-11547.57"/>
<polygon fill="black" stroke="black" points="3702.73,-11547.56 3699.54,-11537.46 3695.73,-11547.34 3702.73,-11547.56"/>
</g>
<!-- layer_4_expert_12_gpu6 -->
<g id="node296" class="node">
<title>layer_4_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4125.82,-11537.26 3916.82,-11537.26 3916.82,-11485.26 4125.82,-11485.26 4125.82,-11537.26"/>
<text text-anchor="middle" x="4021.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4021.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4021.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4021.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_12 -->
<g id="node316" class="node">
<title>layer_4_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4024.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4024.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4024.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4024.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4024.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_12_gpu6&#45;&gt;layer_4_all2all_back_12 -->
<g id="edge417" class="edge">
<title>layer_4_expert_12_gpu6&#45;&gt;layer_4_all2all_back_12</title>
<path fill="none" stroke="black" d="M4022.1,-11485.09C4022.34,-11477.28 4022.62,-11468.41 4022.89,-11459.65"/>
<polygon fill="black" stroke="black" points="4026.39,-11459.57 4023.21,-11449.47 4019.4,-11459.35 4026.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_12&#45;&gt;layer_4_expert_12_gpu6 -->
<g id="edge398" class="edge">
<title>layer_4_all2all_expert_12&#45;&gt;layer_4_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4019.44,-11573C4019.7,-11564.68 4019.97,-11555.85 4020.23,-11547.57"/>
<polygon fill="black" stroke="black" points="4023.73,-11547.56 4020.54,-11537.46 4016.73,-11547.34 4023.73,-11547.56"/>
</g>
<!-- layer_4_expert_13_gpu6 -->
<g id="node298" class="node">
<title>layer_4_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4446.82,-11537.26 4237.82,-11537.26 4237.82,-11485.26 4446.82,-11485.26 4446.82,-11537.26"/>
<text text-anchor="middle" x="4342.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4342.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4342.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4342.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_13 -->
<g id="node317" class="node">
<title>layer_4_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4345.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4345.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4345.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4345.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4345.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_13_gpu6&#45;&gt;layer_4_all2all_back_13 -->
<g id="edge418" class="edge">
<title>layer_4_expert_13_gpu6&#45;&gt;layer_4_all2all_back_13</title>
<path fill="none" stroke="black" d="M4343.1,-11485.09C4343.34,-11477.28 4343.62,-11468.41 4343.89,-11459.65"/>
<polygon fill="black" stroke="black" points="4347.39,-11459.57 4344.21,-11449.47 4340.4,-11459.35 4347.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_13&#45;&gt;layer_4_expert_13_gpu6 -->
<g id="edge400" class="edge">
<title>layer_4_all2all_expert_13&#45;&gt;layer_4_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4340.44,-11573C4340.7,-11564.68 4340.97,-11555.85 4341.23,-11547.57"/>
<polygon fill="black" stroke="black" points="4344.73,-11547.56 4341.54,-11537.46 4337.73,-11547.34 4344.73,-11547.56"/>
</g>
<!-- layer_4_expert_14_gpu7 -->
<g id="node300" class="node">
<title>layer_4_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4767.82,-11537.26 4558.82,-11537.26 4558.82,-11485.26 4767.82,-11485.26 4767.82,-11537.26"/>
<text text-anchor="middle" x="4663.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4663.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4663.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4663.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_14 -->
<g id="node318" class="node">
<title>layer_4_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4666.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4666.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4666.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4666.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4666.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_14_gpu7&#45;&gt;layer_4_all2all_back_14 -->
<g id="edge419" class="edge">
<title>layer_4_expert_14_gpu7&#45;&gt;layer_4_all2all_back_14</title>
<path fill="none" stroke="black" d="M4664.1,-11485.09C4664.34,-11477.28 4664.62,-11468.41 4664.89,-11459.65"/>
<polygon fill="black" stroke="black" points="4668.39,-11459.57 4665.21,-11449.47 4661.4,-11459.35 4668.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_14&#45;&gt;layer_4_expert_14_gpu7 -->
<g id="edge402" class="edge">
<title>layer_4_all2all_expert_14&#45;&gt;layer_4_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4661.44,-11573C4661.7,-11564.68 4661.97,-11555.85 4662.23,-11547.57"/>
<polygon fill="black" stroke="black" points="4665.73,-11547.56 4662.54,-11537.46 4658.73,-11547.34 4665.73,-11547.56"/>
</g>
<!-- layer_4_expert_15_gpu7 -->
<g id="node302" class="node">
<title>layer_4_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5088.82,-11537.26 4879.82,-11537.26 4879.82,-11485.26 5088.82,-11485.26 5088.82,-11537.26"/>
<text text-anchor="middle" x="4984.32" y="-11525.26" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4984.32" y="-11514.26" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4984.32" y="-11503.26" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4984.32" y="-11492.26" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_15 -->
<g id="node319" class="node">
<title>layer_4_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4987.32" cy="-11412.49" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4987.32" y="-11426.49" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4987.32" y="-11415.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4987.32" y="-11404.49" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4987.32" y="-11393.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_expert_15_gpu7&#45;&gt;layer_4_all2all_back_15 -->
<g id="edge420" class="edge">
<title>layer_4_expert_15_gpu7&#45;&gt;layer_4_all2all_back_15</title>
<path fill="none" stroke="black" d="M4985.1,-11485.09C4985.34,-11477.28 4985.62,-11468.41 4985.89,-11459.65"/>
<polygon fill="black" stroke="black" points="4989.39,-11459.57 4986.21,-11449.47 4982.4,-11459.35 4989.39,-11459.57"/>
</g>
<!-- layer_4_all2all_expert_15&#45;&gt;layer_4_expert_15_gpu7 -->
<g id="edge404" class="edge">
<title>layer_4_all2all_expert_15&#45;&gt;layer_4_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4982.44,-11573C4982.7,-11564.68 4982.97,-11555.85 4983.23,-11547.57"/>
<polygon fill="black" stroke="black" points="4986.73,-11547.56 4983.54,-11537.46 4979.73,-11547.34 4986.73,-11547.56"/>
</g>
<!-- layer_4_output -->
<g id="node320" class="node">
<title>layer_4_output</title>
<polygon fill="lightblue" stroke="black" points="2686.32,-11339.72 2472.32,-11339.72 2472.32,-11287.72 2686.32,-11287.72 2686.32,-11339.72"/>
<text text-anchor="middle" x="2579.32" y="-11327.72" font-family="Arial" font-size="10.00">Layer 4 Output</text>
<text text-anchor="middle" x="2579.32" y="-11316.72" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2579.32" y="-11305.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2579.32" y="-11294.72" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_4_all2all_back_0&#45;&gt;layer_4_output -->
<g id="edge421" class="edge">
<title>layer_4_all2all_back_0&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M275.31,-11385.54C294.48,-11381.59 314.42,-11378.05 333.32,-11375.72 751.21,-11324.11 2061.59,-11316.16 2461.96,-11314.94"/>
<polygon fill="black" stroke="black" points="2462.12,-11318.44 2472.11,-11314.91 2462.1,-11311.44 2462.12,-11318.44"/>
</g>
<!-- layer_4_all2all_back_1&#45;&gt;layer_4_output -->
<g id="edge422" class="edge">
<title>layer_4_all2all_back_1&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M596.75,-11385.53C615.79,-11381.6 635.57,-11378.08 654.32,-11375.72 1006.84,-11331.37 2100.7,-11318.62 2462.1,-11315.56"/>
<polygon fill="black" stroke="black" points="2462.35,-11319.06 2472.32,-11315.48 2462.29,-11312.06 2462.35,-11319.06"/>
</g>
<!-- layer_4_all2all_back_2&#45;&gt;layer_4_output -->
<g id="edge423" class="edge">
<title>layer_4_all2all_back_2&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M917.76,-11385.62C936.8,-11381.69 956.58,-11378.14 975.32,-11375.72 1262.83,-11338.62 2142.45,-11321.53 2461.86,-11316.43"/>
<polygon fill="black" stroke="black" points="2462.12,-11319.93 2472.06,-11316.27 2462.01,-11312.93 2462.12,-11319.93"/>
</g>
<!-- layer_4_all2all_back_3&#45;&gt;layer_4_output -->
<g id="edge424" class="edge">
<title>layer_4_all2all_back_3&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M1239.21,-11385.68C1258.12,-11381.77 1277.73,-11378.21 1296.32,-11375.72 1519.45,-11345.85 2188.68,-11325.15 2461.55,-11317.74"/>
<polygon fill="black" stroke="black" points="2461.98,-11321.23 2471.88,-11317.46 2461.79,-11314.23 2461.98,-11321.23"/>
</g>
<!-- layer_4_all2all_back_4&#45;&gt;layer_4_output -->
<g id="edge425" class="edge">
<title>layer_4_all2all_back_4&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M1560.68,-11385.83C1579.45,-11381.93 1598.89,-11378.34 1617.32,-11375.72 1919.78,-11332.8 2280.05,-11320.07 2461.88,-11316.3"/>
<polygon fill="black" stroke="black" points="2462.07,-11319.8 2472,-11316.1 2461.93,-11312.8 2462.07,-11319.8"/>
</g>
<!-- layer_4_all2all_back_5&#45;&gt;layer_4_output -->
<g id="edge426" class="edge">
<title>layer_4_all2all_back_5&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M1883.05,-11386.05C1901.41,-11382.19 1920.36,-11378.56 1938.32,-11375.72 2120.01,-11347.01 2332.95,-11330 2461.91,-11321.52"/>
<polygon fill="black" stroke="black" points="2462.45,-11324.99 2472.2,-11320.85 2461.99,-11318.01 2462.45,-11324.99"/>
</g>
<!-- layer_4_all2all_back_6&#45;&gt;layer_4_output -->
<g id="edge427" class="edge">
<title>layer_4_all2all_back_6&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M2207.35,-11386.8C2224.71,-11383 2242.5,-11379.19 2259.32,-11375.72 2326.35,-11361.89 2401.51,-11347.5 2462.14,-11336.18"/>
<polygon fill="black" stroke="black" points="2462.94,-11339.59 2472.13,-11334.32 2461.66,-11332.71 2462.94,-11339.59"/>
</g>
<!-- layer_4_all2all_back_7&#45;&gt;layer_4_output -->
<g id="edge428" class="edge">
<title>layer_4_all2all_back_7&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M2474.38,-11378.19C2492.09,-11367.48 2511.6,-11355.68 2528.95,-11345.18"/>
<polygon fill="black" stroke="black" points="2531.06,-11348 2537.81,-11339.83 2527.44,-11342.01 2531.06,-11348"/>
</g>
<!-- layer_4_all2all_back_8&#45;&gt;layer_4_output -->
<g id="edge429" class="edge">
<title>layer_4_all2all_back_8&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M2684.91,-11378.19C2667.1,-11367.48 2647.46,-11355.68 2630,-11345.18"/>
<polygon fill="black" stroke="black" points="2631.47,-11341.98 2621.09,-11339.83 2627.86,-11347.98 2631.47,-11341.98"/>
</g>
<!-- layer_4_all2all_back_9&#45;&gt;layer_4_output -->
<g id="edge430" class="edge">
<title>layer_4_all2all_back_9&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M2952.3,-11386.79C2934.93,-11382.99 2917.15,-11379.19 2900.32,-11375.72 2832.96,-11361.84 2757.39,-11347.42 2696.51,-11336.09"/>
<polygon fill="black" stroke="black" points="2696.96,-11332.62 2686.48,-11334.23 2695.68,-11339.5 2696.96,-11332.62"/>
</g>
<!-- layer_4_all2all_back_10&#45;&gt;layer_4_output -->
<g id="edge431" class="edge">
<title>layer_4_all2all_back_10&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M3276.59,-11386.04C3258.24,-11382.19 3239.28,-11378.56 3221.32,-11375.72 3039.22,-11346.95 2825.76,-11329.96 2696.63,-11321.49"/>
<polygon fill="black" stroke="black" points="2696.53,-11317.98 2686.33,-11320.82 2696.08,-11324.96 2696.53,-11317.98"/>
</g>
<!-- layer_4_all2all_back_11&#45;&gt;layer_4_output -->
<g id="edge432" class="edge">
<title>layer_4_all2all_back_11&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M3598.96,-11385.83C3580.2,-11381.93 3560.75,-11378.34 3542.32,-11375.72 3239.34,-11332.73 2878.42,-11320.03 2696.52,-11316.29"/>
<polygon fill="black" stroke="black" points="2696.46,-11312.79 2686.39,-11316.08 2696.32,-11319.78 2696.46,-11312.79"/>
</g>
<!-- layer_4_all2all_back_12&#45;&gt;layer_4_output -->
<g id="edge433" class="edge">
<title>layer_4_all2all_back_12&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M3920.43,-11385.68C3901.53,-11381.76 3881.91,-11378.21 3863.32,-11375.72 3639.88,-11345.82 2969.45,-11325.12 2696.68,-11317.72"/>
<polygon fill="black" stroke="black" points="2696.45,-11314.22 2686.36,-11317.45 2696.26,-11321.21 2696.45,-11314.22"/>
</g>
<!-- layer_4_all2all_back_13&#45;&gt;layer_4_output -->
<g id="edge434" class="edge">
<title>layer_4_all2all_back_13&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M4241.88,-11385.62C4222.84,-11381.69 4203.06,-11378.14 4184.32,-11375.72 3896.54,-11338.59 3015.94,-11321.52 2696.57,-11316.43"/>
<polygon fill="black" stroke="black" points="2696.42,-11312.93 2686.37,-11316.27 2696.31,-11319.92 2696.42,-11312.93"/>
</g>
<!-- layer_4_all2all_back_14&#45;&gt;layer_4_output -->
<g id="edge435" class="edge">
<title>layer_4_all2all_back_14&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M4562.89,-11385.53C4543.85,-11381.6 4524.07,-11378.08 4505.32,-11375.72 4152.62,-11331.35 3058.19,-11318.61 2696.6,-11315.56"/>
<polygon fill="black" stroke="black" points="2696.41,-11312.06 2686.38,-11315.48 2696.35,-11319.06 2696.41,-11312.06"/>
</g>
<!-- layer_4_all2all_back_15&#45;&gt;layer_4_output -->
<g id="edge436" class="edge">
<title>layer_4_all2all_back_15&#45;&gt;layer_4_output</title>
<path fill="none" stroke="black" d="M4884.33,-11385.54C4865.16,-11381.59 4845.22,-11378.05 4826.32,-11375.72 4408.25,-11324.09 3097.28,-11316.16 2696.73,-11314.94"/>
<polygon fill="black" stroke="black" points="2696.59,-11311.44 2686.58,-11314.91 2696.57,-11318.44 2696.59,-11311.44"/>
</g>
<!-- layer_5_tp_gather -->
<g id="node322" class="node">
<title>layer_5_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2579.32" cy="-11214.95" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2579.32" y="-11228.95" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2579.32" y="-11217.95" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2579.32" y="-11206.95" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2579.32" y="-11195.95" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_4_output&#45;&gt;layer_5_tp_gather -->
<g id="edge437" class="edge">
<title>layer_4_output&#45;&gt;layer_5_tp_gather</title>
<path fill="none" stroke="black" d="M2561.3,-11287.55C2559.64,-11279.57 2558.91,-11270.5 2559.1,-11261.55"/>
<polygon fill="black" stroke="black" points="2562.59,-11261.76 2559.71,-11251.56 2555.61,-11261.33 2562.59,-11261.76"/>
</g>
<!-- layer_4_output&#45;&gt;layer_5_tp_gather -->
<g id="edge439" class="edge">
<title>layer_4_output&#45;&gt;layer_5_tp_gather</title>
<path fill="none" stroke="black" d="M2573.32,-11287.55C2572.77,-11279.74 2572.53,-11270.87 2572.58,-11262.11"/>
<polygon fill="black" stroke="black" points="2576.08,-11261.99 2572.77,-11251.93 2569.08,-11261.86 2576.08,-11261.99"/>
</g>
<!-- layer_4_output&#45;&gt;layer_5_tp_gather -->
<g id="edge441" class="edge">
<title>layer_4_output&#45;&gt;layer_5_tp_gather</title>
<path fill="none" stroke="black" d="M2585.33,-11287.55C2585.87,-11279.74 2586.11,-11270.87 2586.06,-11262.11"/>
<polygon fill="black" stroke="black" points="2589.56,-11261.86 2585.87,-11251.93 2582.56,-11261.99 2589.56,-11261.86"/>
</g>
<!-- layer_4_output&#45;&gt;layer_5_tp_gather -->
<g id="edge443" class="edge">
<title>layer_4_output&#45;&gt;layer_5_tp_gather</title>
<path fill="none" stroke="black" d="M2597.34,-11287.55C2599,-11279.57 2599.73,-11270.5 2599.54,-11261.55"/>
<polygon fill="black" stroke="black" points="2603.03,-11261.33 2598.93,-11251.56 2596.05,-11261.76 2603.03,-11261.33"/>
</g>
<!-- layer_5_qkv_gpu0 -->
<g id="node321" class="node">
<title>layer_5_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2341.32,-11142.18 2135.32,-11142.18 2135.32,-11090.18 2341.32,-11090.18 2341.32,-11142.18"/>
<text text-anchor="middle" x="2238.32" y="-11130.18" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2238.32" y="-11119.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2238.32" y="-11108.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2238.32" y="-11097.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_5_attn_gpu0 -->
<g id="node326" class="node">
<title>layer_5_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2335.32,-11054.18 2133.32,-11054.18 2133.32,-11002.18 2335.32,-11002.18 2335.32,-11054.18"/>
<text text-anchor="middle" x="2234.32" y="-11042.18" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2234.32" y="-11031.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2234.32" y="-11020.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2234.32" y="-11009.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_5_qkv_gpu0&#45;&gt;layer_5_attn_gpu0 -->
<g id="edge445" class="edge">
<title>layer_5_qkv_gpu0&#45;&gt;layer_5_attn_gpu0</title>
<path fill="none" stroke="black" d="M2237.14,-11089.84C2236.77,-11081.88 2236.36,-11072.94 2235.96,-11064.43"/>
<polygon fill="black" stroke="black" points="2239.45,-11064.16 2235.49,-11054.34 2232.46,-11064.49 2239.45,-11064.16"/>
</g>
<!-- layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu0 -->
<g id="edge438" class="edge">
<title>layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2482.52,-11186.48C2436.74,-11173.49 2382.19,-11158.01 2336.28,-11144.98"/>
<polygon fill="black" stroke="black" points="2337.19,-11141.6 2326.61,-11142.24 2335.28,-11148.33 2337.19,-11141.6"/>
</g>
<!-- layer_5_qkv_gpu1 -->
<g id="node323" class="node">
<title>layer_5_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2569.32,-11142.18 2363.32,-11142.18 2363.32,-11090.18 2569.32,-11090.18 2569.32,-11142.18"/>
<text text-anchor="middle" x="2466.32" y="-11130.18" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2466.32" y="-11119.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2466.32" y="-11108.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2466.32" y="-11097.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu1 -->
<g id="edge440" class="edge">
<title>layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2538.84,-11179.29C2527.22,-11169.33 2514.6,-11158.53 2503.2,-11148.76"/>
<polygon fill="black" stroke="black" points="2505.4,-11146.04 2495.53,-11142.2 2500.85,-11151.36 2505.4,-11146.04"/>
</g>
<!-- layer_5_qkv_gpu2 -->
<g id="node324" class="node">
<title>layer_5_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2795.32,-11142.18 2589.32,-11142.18 2589.32,-11090.18 2795.32,-11090.18 2795.32,-11142.18"/>
<text text-anchor="middle" x="2692.32" y="-11130.18" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2692.32" y="-11119.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2692.32" y="-11108.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2692.32" y="-11097.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu2 -->
<g id="edge442" class="edge">
<title>layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2619.8,-11179.29C2631.43,-11169.33 2644.04,-11158.53 2655.44,-11148.76"/>
<polygon fill="black" stroke="black" points="2657.79,-11151.36 2663.11,-11142.2 2653.24,-11146.04 2657.79,-11151.36"/>
</g>
<!-- layer_5_qkv_gpu3 -->
<g id="node325" class="node">
<title>layer_5_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3024.32,-11142.18 2818.32,-11142.18 2818.32,-11090.18 3024.32,-11090.18 3024.32,-11142.18"/>
<text text-anchor="middle" x="2921.32" y="-11130.18" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2921.32" y="-11119.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2921.32" y="-11108.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2921.32" y="-11097.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu3 -->
<g id="edge444" class="edge">
<title>layer_5_tp_gather&#45;&gt;layer_5_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2675.95,-11186.61C2721.96,-11173.59 2776.89,-11158.05 2823.11,-11144.97"/>
<polygon fill="black" stroke="black" points="2824.16,-11148.31 2832.83,-11142.22 2822.25,-11141.58 2824.16,-11148.31"/>
</g>
<!-- layer_5_attn_gpu1 -->
<g id="node327" class="node">
<title>layer_5_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2563.32,-11054.18 2361.32,-11054.18 2361.32,-11002.18 2563.32,-11002.18 2563.32,-11054.18"/>
<text text-anchor="middle" x="2462.32" y="-11042.18" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2462.32" y="-11031.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2462.32" y="-11020.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2462.32" y="-11009.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_5_qkv_gpu1&#45;&gt;layer_5_attn_gpu1 -->
<g id="edge446" class="edge">
<title>layer_5_qkv_gpu1&#45;&gt;layer_5_attn_gpu1</title>
<path fill="none" stroke="black" d="M2465.14,-11089.84C2464.77,-11081.88 2464.36,-11072.94 2463.96,-11064.43"/>
<polygon fill="black" stroke="black" points="2467.45,-11064.16 2463.49,-11054.34 2460.46,-11064.49 2467.45,-11064.16"/>
</g>
<!-- layer_5_attn_gpu2 -->
<g id="node328" class="node">
<title>layer_5_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2793.32,-11054.18 2591.32,-11054.18 2591.32,-11002.18 2793.32,-11002.18 2793.32,-11054.18"/>
<text text-anchor="middle" x="2692.32" y="-11042.18" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2692.32" y="-11031.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2692.32" y="-11020.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2692.32" y="-11009.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_5_qkv_gpu2&#45;&gt;layer_5_attn_gpu2 -->
<g id="edge447" class="edge">
<title>layer_5_qkv_gpu2&#45;&gt;layer_5_attn_gpu2</title>
<path fill="none" stroke="black" d="M2692.32,-11089.84C2692.32,-11081.88 2692.32,-11072.94 2692.32,-11064.43"/>
<polygon fill="black" stroke="black" points="2695.82,-11064.34 2692.32,-11054.34 2688.82,-11064.34 2695.82,-11064.34"/>
</g>
<!-- layer_5_attn_gpu3 -->
<g id="node329" class="node">
<title>layer_5_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3024.32,-11054.18 2822.32,-11054.18 2822.32,-11002.18 3024.32,-11002.18 3024.32,-11054.18"/>
<text text-anchor="middle" x="2923.32" y="-11042.18" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2923.32" y="-11031.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2923.32" y="-11020.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2923.32" y="-11009.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_5_qkv_gpu3&#45;&gt;layer_5_attn_gpu3 -->
<g id="edge448" class="edge">
<title>layer_5_qkv_gpu3&#45;&gt;layer_5_attn_gpu3</title>
<path fill="none" stroke="black" d="M2921.91,-11089.84C2922.1,-11081.88 2922.3,-11072.94 2922.5,-11064.43"/>
<polygon fill="black" stroke="black" points="2926,-11064.42 2922.74,-11054.34 2919,-11064.25 2926,-11064.42"/>
</g>
<!-- layer_5_attn_out_gpu0 -->
<g id="node330" class="node">
<title>layer_5_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2336.32,-10966.18 2122.32,-10966.18 2122.32,-10914.18 2336.32,-10914.18 2336.32,-10966.18"/>
<text text-anchor="middle" x="2229.32" y="-10954.18" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2229.32" y="-10943.18" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2229.32" y="-10932.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2229.32" y="-10921.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_attn_gpu0&#45;&gt;layer_5_attn_out_gpu0 -->
<g id="edge449" class="edge">
<title>layer_5_attn_gpu0&#45;&gt;layer_5_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2232.85,-11001.84C2232.38,-10993.88 2231.87,-10984.94 2231.37,-10976.43"/>
<polygon fill="black" stroke="black" points="2234.86,-10976.12 2230.78,-10966.34 2227.87,-10976.52 2234.86,-10976.12"/>
</g>
<!-- layer_5_attn_out_gpu1 -->
<g id="node331" class="node">
<title>layer_5_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2568.32,-10966.18 2354.32,-10966.18 2354.32,-10914.18 2568.32,-10914.18 2568.32,-10966.18"/>
<text text-anchor="middle" x="2461.32" y="-10954.18" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2461.32" y="-10943.18" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2461.32" y="-10932.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2461.32" y="-10921.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_attn_gpu1&#45;&gt;layer_5_attn_out_gpu1 -->
<g id="edge450" class="edge">
<title>layer_5_attn_gpu1&#45;&gt;layer_5_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2462.03,-11001.84C2461.93,-10993.88 2461.83,-10984.94 2461.73,-10976.43"/>
<polygon fill="black" stroke="black" points="2465.23,-10976.3 2461.61,-10966.34 2458.23,-10976.38 2465.23,-10976.3"/>
</g>
<!-- layer_5_attn_out_gpu2 -->
<g id="node332" class="node">
<title>layer_5_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2800.32,-10966.18 2586.32,-10966.18 2586.32,-10914.18 2800.32,-10914.18 2800.32,-10966.18"/>
<text text-anchor="middle" x="2693.32" y="-10954.18" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2693.32" y="-10943.18" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2693.32" y="-10932.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2693.32" y="-10921.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_attn_gpu2&#45;&gt;layer_5_attn_out_gpu2 -->
<g id="edge451" class="edge">
<title>layer_5_attn_gpu2&#45;&gt;layer_5_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2692.62,-11001.84C2692.71,-10993.88 2692.81,-10984.94 2692.91,-10976.43"/>
<polygon fill="black" stroke="black" points="2696.41,-10976.38 2693.03,-10966.34 2689.41,-10976.3 2696.41,-10976.38"/>
</g>
<!-- layer_5_attn_out_gpu3 -->
<g id="node333" class="node">
<title>layer_5_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3032.32,-10966.18 2818.32,-10966.18 2818.32,-10914.18 3032.32,-10914.18 3032.32,-10966.18"/>
<text text-anchor="middle" x="2925.32" y="-10954.18" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2925.32" y="-10943.18" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2925.32" y="-10932.18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2925.32" y="-10921.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_attn_gpu3&#45;&gt;layer_5_attn_out_gpu3 -->
<g id="edge452" class="edge">
<title>layer_5_attn_gpu3&#45;&gt;layer_5_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2923.91,-11001.84C2924.1,-10993.88 2924.3,-10984.94 2924.5,-10976.43"/>
<polygon fill="black" stroke="black" points="2928,-10976.42 2924.74,-10966.34 2921,-10976.25 2928,-10976.42"/>
</g>
<!-- layer_5_attn_allreduce -->
<g id="node334" class="node">
<title>layer_5_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2577.32" cy="-10841.41" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2577.32" y="-10855.41" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2577.32" y="-10844.41" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2577.32" y="-10833.41" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2577.32" y="-10822.41" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_attn_out_gpu0&#45;&gt;layer_5_attn_allreduce -->
<g id="edge453" class="edge">
<title>layer_5_attn_out_gpu0&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2319.39,-10914.14C2365.36,-10901.35 2421.61,-10885.71 2469.84,-10872.3"/>
<polygon fill="black" stroke="black" points="2470.99,-10875.61 2479.69,-10869.56 2469.11,-10868.87 2470.99,-10875.61"/>
</g>
<!-- layer_5_attn_out_gpu1&#45;&gt;layer_5_attn_allreduce -->
<g id="edge454" class="edge">
<title>layer_5_attn_out_gpu1&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2491.5,-10914.01C2502.73,-10904.64 2515.78,-10893.75 2528.26,-10883.34"/>
<polygon fill="black" stroke="black" points="2530.51,-10886.02 2535.94,-10876.93 2526.02,-10880.65 2530.51,-10886.02"/>
</g>
<!-- layer_5_attn_out_gpu2&#45;&gt;layer_5_attn_allreduce -->
<g id="edge455" class="edge">
<title>layer_5_attn_out_gpu2&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2663.15,-10914.01C2651.92,-10904.64 2638.86,-10893.75 2626.38,-10883.34"/>
<polygon fill="black" stroke="black" points="2628.62,-10880.65 2618.7,-10876.93 2624.13,-10886.02 2628.62,-10880.65"/>
</g>
<!-- layer_5_attn_out_gpu3&#45;&gt;layer_5_attn_allreduce -->
<g id="edge456" class="edge">
<title>layer_5_attn_out_gpu3&#45;&gt;layer_5_attn_allreduce</title>
<path fill="none" stroke="black" d="M2835.25,-10914.14C2789.28,-10901.35 2733.03,-10885.71 2684.8,-10872.3"/>
<polygon fill="black" stroke="black" points="2685.53,-10868.87 2674.96,-10869.56 2683.65,-10875.61 2685.53,-10868.87"/>
</g>
<!-- layer_5_gate -->
<g id="node335" class="node">
<title>layer_5_gate</title>
<polygon fill="lightyellow" stroke="black" points="2794.18,-10768.64 2449.2,-10768.64 2360.46,-10664.64 2705.44,-10664.64 2794.18,-10768.64"/>
<text text-anchor="middle" x="2577.32" y="-10730.64" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2577.32" y="-10719.64" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2577.32" y="-10708.64" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2577.32" y="-10697.64" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_5_attn_allreduce&#45;&gt;layer_5_gate -->
<g id="edge457" class="edge">
<title>layer_5_attn_allreduce&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2558.76,-10804.9C2557.65,-10796.86 2557.08,-10788.09 2557.07,-10779.32"/>
<polygon fill="black" stroke="black" points="2560.58,-10779.13 2557.31,-10769.05 2553.58,-10778.97 2560.58,-10779.13"/>
</g>
<!-- layer_5_attn_allreduce&#45;&gt;layer_5_gate -->
<g id="edge458" class="edge">
<title>layer_5_attn_allreduce&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2571.12,-10804.57C2570.75,-10796.53 2570.57,-10787.79 2570.57,-10779.04"/>
<polygon fill="black" stroke="black" points="2574.07,-10778.84 2570.65,-10768.81 2567.07,-10778.78 2574.07,-10778.84"/>
</g>
<!-- layer_5_attn_allreduce&#45;&gt;layer_5_gate -->
<g id="edge459" class="edge">
<title>layer_5_attn_allreduce&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2583.52,-10804.57C2583.89,-10796.53 2584.07,-10787.79 2584.07,-10779.04"/>
<polygon fill="black" stroke="black" points="2587.57,-10778.78 2583.99,-10768.81 2580.57,-10778.84 2587.57,-10778.78"/>
</g>
<!-- layer_5_attn_allreduce&#45;&gt;layer_5_gate -->
<g id="edge460" class="edge">
<title>layer_5_attn_allreduce&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2595.88,-10804.9C2596.99,-10796.86 2597.56,-10788.09 2597.57,-10779.32"/>
<polygon fill="black" stroke="black" points="2601.06,-10778.97 2597.33,-10769.05 2594.07,-10779.13 2601.06,-10778.97"/>
</g>
<!-- layer_5_all2all_expert_0 -->
<g id="node337" class="node">
<title>layer_5_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="183.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="183.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="183.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="183.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="183.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_0 -->
<g id="edge461" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2401.06,-10712.61C1947.4,-10704.19 747.45,-10677.82 352.32,-10628.64 334.62,-10626.44 316.02,-10623.33 297.89,-10619.85"/>
<polygon fill="black" stroke="black" points="298.37,-10616.38 287.88,-10617.88 297.02,-10623.25 298.37,-10616.38"/>
</g>
<!-- layer_5_all2all_expert_1 -->
<g id="node339" class="node">
<title>layer_5_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="509.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="509.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="509.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="509.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="509.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_1 -->
<g id="edge463" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2400.03,-10711.41C1993.36,-10701.07 1003.03,-10672.16 672.32,-10628.64 655.99,-10626.49 638.88,-10623.54 622.13,-10620.23"/>
<polygon fill="black" stroke="black" points="622.82,-10616.8 612.33,-10618.25 621.44,-10623.66 622.82,-10616.8"/>
</g>
<!-- layer_5_all2all_expert_2 -->
<g id="node341" class="node">
<title>layer_5_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="829.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="829.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="829.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="829.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="829.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_2 -->
<g id="edge465" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2403.71,-10715.48C2110.73,-10713.13 1500.1,-10699.24 989.32,-10628.64 973.79,-10626.5 957.54,-10623.62 941.6,-10620.42"/>
<polygon fill="black" stroke="black" points="942.22,-10616.98 931.72,-10618.4 940.81,-10623.83 942.22,-10616.98"/>
</g>
<!-- layer_5_all2all_expert_3 -->
<g id="node343" class="node">
<title>layer_5_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1146.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1146.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1146.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1146.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1146.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_3 -->
<g id="edge467" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2400.64,-10712C2154.32,-10705 1694.29,-10684.96 1306.32,-10628.64 1290.93,-10626.41 1274.81,-10623.5 1258.98,-10620.3"/>
<polygon fill="black" stroke="black" points="1259.68,-10616.87 1249.18,-10618.28 1258.26,-10623.73 1259.68,-10616.87"/>
</g>
<!-- layer_5_all2all_expert_4 -->
<g id="node345" class="node">
<title>layer_5_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1463.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1463.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1463.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1463.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1463.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_4 -->
<g id="edge469" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.03,-10705.56C2203.38,-10693.41 1893.44,-10669.38 1628.32,-10628.64 1612.25,-10626.17 1595.39,-10623.09 1578.84,-10619.78"/>
<polygon fill="black" stroke="black" points="1579.09,-10616.26 1568.59,-10617.7 1577.69,-10623.12 1579.09,-10616.26"/>
</g>
<!-- layer_5_all2all_expert_5 -->
<g id="node347" class="node">
<title>layer_5_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1785.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1785.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1785.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1785.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1785.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_5 -->
<g id="edge471" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2384.76,-10693.23C2259.46,-10677.63 2092.71,-10654.95 1946.32,-10628.64 1931.64,-10626 1916.27,-10622.96 1901.1,-10619.78"/>
<polygon fill="black" stroke="black" points="1901.67,-10616.33 1891.16,-10617.68 1900.22,-10623.17 1901.67,-10616.33"/>
</g>
<!-- layer_5_all2all_expert_6 -->
<g id="node349" class="node">
<title>layer_5_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2103.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2103.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2103.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2103.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2103.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_6 -->
<g id="edge473" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2380.08,-10664.55C2323.24,-10649.83 2263.27,-10634.3 2213.73,-10621.47"/>
<polygon fill="black" stroke="black" points="2214.53,-10618.06 2203.97,-10618.94 2212.77,-10624.84 2214.53,-10618.06"/>
</g>
<!-- layer_5_all2all_expert_7 -->
<g id="node351" class="node">
<title>layer_5_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2419.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2419.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2419.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2419.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2419.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_7 -->
<g id="edge475" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2511.23,-10664.29C2498.05,-10654.05 2484.38,-10643.42 2471.73,-10633.6"/>
<polygon fill="black" stroke="black" points="2473.63,-10630.64 2463.59,-10627.27 2469.34,-10636.17 2473.63,-10630.64"/>
</g>
<!-- layer_5_all2all_expert_8 -->
<g id="node353" class="node">
<title>layer_5_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2735.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2735.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2735.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2735.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2735.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_8 -->
<g id="edge477" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2643.41,-10664.29C2656.59,-10654.05 2670.26,-10643.42 2682.91,-10633.6"/>
<polygon fill="black" stroke="black" points="2685.3,-10636.17 2691.05,-10627.27 2681.01,-10630.64 2685.3,-10636.17"/>
</g>
<!-- layer_5_all2all_expert_9 -->
<g id="node355" class="node">
<title>layer_5_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3053.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3053.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3053.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3053.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3053.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_9 -->
<g id="edge479" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2718.2,-10679.31C2789.93,-10660.81 2875.86,-10638.64 2942.74,-10621.39"/>
<polygon fill="black" stroke="black" points="2943.66,-10624.77 2952.47,-10618.88 2941.91,-10617.99 2943.66,-10624.77"/>
</g>
<!-- layer_5_all2all_expert_10 -->
<g id="node357" class="node">
<title>layer_5_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3373.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3373.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3373.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3373.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3373.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_10 -->
<g id="edge481" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.94,-10697.63C2862.38,-10682.02 3048.69,-10657.44 3210.32,-10628.64 3225.41,-10625.95 3241.23,-10622.85 3256.82,-10619.61"/>
<polygon fill="black" stroke="black" points="3257.96,-10622.95 3267.03,-10617.47 3256.53,-10616.1 3257.96,-10622.95"/>
</g>
<!-- layer_5_all2all_expert_11 -->
<g id="node359" class="node">
<title>layer_5_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3693.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3693.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3693.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3693.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3693.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_11 -->
<g id="edge483" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.66,-10706.9C2932.19,-10695.31 3255.31,-10671.2 3530.32,-10628.64 3545.97,-10626.22 3562.37,-10623.2 3578.48,-10619.95"/>
<polygon fill="black" stroke="black" points="3579.37,-10623.34 3588.46,-10617.9 3577.96,-10616.49 3579.37,-10623.34"/>
</g>
<!-- layer_5_all2all_expert_12 -->
<g id="node361" class="node">
<title>layer_5_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4014.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4014.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4014.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4014.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4014.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_12 -->
<g id="edge485" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2745.97,-10711.97C2990.49,-10704.87 3457.21,-10684.64 3850.32,-10628.64 3866.45,-10626.35 3883.35,-10623.35 3899.92,-10620.06"/>
<polygon fill="black" stroke="black" points="3901.08,-10623.4 3910.19,-10617.98 3899.69,-10616.54 3901.08,-10623.4"/>
</g>
<!-- layer_5_all2all_expert_13 -->
<g id="node363" class="node">
<title>layer_5_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4335.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4335.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4335.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4335.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4335.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_13 -->
<g id="edge487" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2748.9,-10715.26C3041.89,-10712.61 3656.89,-10698.32 4171.32,-10628.64 4187.74,-10626.42 4204.95,-10623.42 4221.79,-10620.1"/>
<polygon fill="black" stroke="black" points="4222.55,-10623.52 4231.66,-10618.11 4221.16,-10616.65 4222.55,-10623.52"/>
</g>
<!-- layer_5_all2all_expert_14 -->
<g id="node365" class="node">
<title>layer_5_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4656.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4656.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4656.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4656.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4656.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_14 -->
<g id="edge489" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2745.76,-10711.65C3148.24,-10701.53 4157.17,-10672.48 4492.32,-10628.64 4508.75,-10626.49 4525.96,-10623.54 4542.81,-10620.23"/>
<polygon fill="black" stroke="black" points="4543.56,-10623.65 4552.68,-10618.25 4542.18,-10616.79 4543.56,-10623.65"/>
</g>
<!-- layer_5_all2all_expert_15 -->
<g id="node367" class="node">
<title>layer_5_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4977.32" cy="-10591.87" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4977.32" y="-10605.87" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4977.32" y="-10594.87" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4977.32" y="-10583.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4977.32" y="-10572.87" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_all2all_expert_15 -->
<g id="edge491" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2746.66,-10712.91C3196.48,-10705.04 4414.1,-10679.54 4813.32,-10628.64 4829.87,-10626.53 4847.23,-10623.58 4864.19,-10620.26"/>
<polygon fill="black" stroke="black" points="4865.01,-10623.66 4874.13,-10618.27 4863.64,-10616.8 4865.01,-10623.66"/>
</g>
<!-- layer_5_expert_0_gpu0 -->
<g id="node336" class="node">
<title>layer_5_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="282.82,-10519.1 73.82,-10519.1 73.82,-10467.1 282.82,-10467.1 282.82,-10519.1"/>
<text text-anchor="middle" x="178.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="178.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="178.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="178.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_0 -->
<g id="node368" class="node">
<title>layer_5_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="168.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="168.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="168.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="168.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="168.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_0_gpu0&#45;&gt;layer_5_all2all_back_0 -->
<g id="edge493" class="edge">
<title>layer_5_expert_0_gpu0&#45;&gt;layer_5_all2all_back_0</title>
<path fill="none" stroke="black" d="M175.72,-10466.93C174.91,-10459.12 174,-10450.26 173.09,-10441.49"/>
<polygon fill="black" stroke="black" points="176.55,-10440.9 172.04,-10431.31 169.59,-10441.62 176.55,-10440.9"/>
</g>
<!-- layer_5_all2all_expert_0&#45;&gt;layer_5_expert_0_gpu0 -->
<g id="edge462" class="edge">
<title>layer_5_all2all_expert_0&#45;&gt;layer_5_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M181.46,-10554.84C181.03,-10546.53 180.57,-10537.69 180.15,-10529.41"/>
<polygon fill="black" stroke="black" points="183.63,-10529.11 179.62,-10519.3 176.64,-10529.47 183.63,-10529.11"/>
</g>
<!-- layer_5_expert_1_gpu0 -->
<g id="node338" class="node">
<title>layer_5_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="602.82,-10519.1 393.82,-10519.1 393.82,-10467.1 602.82,-10467.1 602.82,-10519.1"/>
<text text-anchor="middle" x="498.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="498.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="498.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="498.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_1 -->
<g id="node369" class="node">
<title>layer_5_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="489.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="489.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="489.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="489.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="489.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_1_gpu0&#45;&gt;layer_5_all2all_back_1 -->
<g id="edge494" class="edge">
<title>layer_5_expert_1_gpu0&#45;&gt;layer_5_all2all_back_1</title>
<path fill="none" stroke="black" d="M495.98,-10466.93C495.25,-10459.12 494.43,-10450.26 493.61,-10441.49"/>
<polygon fill="black" stroke="black" points="497.08,-10440.94 492.67,-10431.31 490.11,-10441.59 497.08,-10440.94"/>
</g>
<!-- layer_5_all2all_expert_1&#45;&gt;layer_5_expert_1_gpu0 -->
<g id="edge464" class="edge">
<title>layer_5_all2all_expert_1&#45;&gt;layer_5_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M505.26,-10555.11C504.29,-10546.62 503.26,-10537.56 502.3,-10529.1"/>
<polygon fill="black" stroke="black" points="505.77,-10528.69 501.17,-10519.15 498.82,-10529.48 505.77,-10528.69"/>
</g>
<!-- layer_5_expert_2_gpu1 -->
<g id="node340" class="node">
<title>layer_5_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="930.82,-10519.1 721.82,-10519.1 721.82,-10467.1 930.82,-10467.1 930.82,-10519.1"/>
<text text-anchor="middle" x="826.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="826.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="826.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="826.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_2 -->
<g id="node370" class="node">
<title>layer_5_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="810.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="810.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="810.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="810.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="810.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_2_gpu1&#45;&gt;layer_5_all2all_back_2 -->
<g id="edge495" class="edge">
<title>layer_5_expert_2_gpu1&#45;&gt;layer_5_all2all_back_2</title>
<path fill="none" stroke="black" d="M822.16,-10466.93C820.85,-10459.04 819.37,-10450.06 817.9,-10441.2"/>
<polygon fill="black" stroke="black" points="821.35,-10440.61 816.27,-10431.31 814.45,-10441.75 821.35,-10440.61"/>
</g>
<!-- layer_5_all2all_expert_2&#45;&gt;layer_5_expert_2_gpu1 -->
<g id="edge466" class="edge">
<title>layer_5_all2all_expert_2&#45;&gt;layer_5_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M828.2,-10554.84C827.95,-10546.53 827.67,-10537.69 827.42,-10529.41"/>
<polygon fill="black" stroke="black" points="830.91,-10529.19 827.1,-10519.3 823.91,-10529.4 830.91,-10529.19"/>
</g>
<!-- layer_5_expert_3_gpu1 -->
<g id="node342" class="node">
<title>layer_5_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1236.82,-10519.1 1027.82,-10519.1 1027.82,-10467.1 1236.82,-10467.1 1236.82,-10519.1"/>
<text text-anchor="middle" x="1132.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1132.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1132.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1132.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_3 -->
<g id="node371" class="node">
<title>layer_5_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1131.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1131.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1131.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1131.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1131.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_3_gpu1&#45;&gt;layer_5_all2all_back_3 -->
<g id="edge496" class="edge">
<title>layer_5_expert_3_gpu1&#45;&gt;layer_5_all2all_back_3</title>
<path fill="none" stroke="black" d="M1132.06,-10466.93C1131.98,-10459.12 1131.89,-10450.26 1131.8,-10441.49"/>
<polygon fill="black" stroke="black" points="1135.3,-10441.27 1131.69,-10431.31 1128.3,-10441.35 1135.3,-10441.27"/>
</g>
<!-- layer_5_all2all_expert_3&#45;&gt;layer_5_expert_3_gpu1 -->
<g id="edge468" class="edge">
<title>layer_5_all2all_expert_3&#45;&gt;layer_5_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1141.15,-10555.11C1139.92,-10546.62 1138.61,-10537.56 1137.38,-10529.1"/>
<polygon fill="black" stroke="black" points="1140.84,-10528.54 1135.94,-10519.15 1133.91,-10529.54 1140.84,-10528.54"/>
</g>
<!-- layer_5_expert_4_gpu2 -->
<g id="node344" class="node">
<title>layer_5_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1561.82,-10519.1 1352.82,-10519.1 1352.82,-10467.1 1561.82,-10467.1 1561.82,-10519.1"/>
<text text-anchor="middle" x="1457.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1457.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1457.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1457.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_4 -->
<g id="node372" class="node">
<title>layer_5_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1452.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1452.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1452.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1452.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1452.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_4_gpu2&#45;&gt;layer_5_all2all_back_4 -->
<g id="edge497" class="edge">
<title>layer_5_expert_4_gpu2&#45;&gt;layer_5_all2all_back_4</title>
<path fill="none" stroke="black" d="M1456.02,-10466.93C1455.62,-10459.12 1455.16,-10450.26 1454.71,-10441.49"/>
<polygon fill="black" stroke="black" points="1458.19,-10441.12 1454.18,-10431.31 1451.2,-10441.48 1458.19,-10441.12"/>
</g>
<!-- layer_5_all2all_expert_4&#45;&gt;layer_5_expert_4_gpu2 -->
<g id="edge470" class="edge">
<title>layer_5_all2all_expert_4&#45;&gt;layer_5_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1461.09,-10554.84C1460.57,-10546.53 1460.02,-10537.69 1459.51,-10529.41"/>
<polygon fill="black" stroke="black" points="1463,-10529.06 1458.88,-10519.3 1456.01,-10529.5 1463,-10529.06"/>
</g>
<!-- layer_5_expert_5_gpu2 -->
<g id="node346" class="node">
<title>layer_5_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1882.82,-10519.1 1673.82,-10519.1 1673.82,-10467.1 1882.82,-10467.1 1882.82,-10519.1"/>
<text text-anchor="middle" x="1778.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1778.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1778.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1778.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_5 -->
<g id="node373" class="node">
<title>layer_5_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1773.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1773.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1773.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1773.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1773.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_5_gpu2&#45;&gt;layer_5_all2all_back_5 -->
<g id="edge498" class="edge">
<title>layer_5_expert_5_gpu2&#45;&gt;layer_5_all2all_back_5</title>
<path fill="none" stroke="black" d="M1777.02,-10466.93C1776.62,-10459.12 1776.16,-10450.26 1775.71,-10441.49"/>
<polygon fill="black" stroke="black" points="1779.19,-10441.12 1775.18,-10431.31 1772.2,-10441.48 1779.19,-10441.12"/>
</g>
<!-- layer_5_all2all_expert_5&#45;&gt;layer_5_expert_5_gpu2 -->
<g id="edge472" class="edge">
<title>layer_5_all2all_expert_5&#45;&gt;layer_5_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1782.71,-10554.84C1782.11,-10546.53 1781.47,-10537.69 1780.88,-10529.41"/>
<polygon fill="black" stroke="black" points="1784.36,-10529.02 1780.14,-10519.3 1777.37,-10529.53 1784.36,-10529.02"/>
</g>
<!-- layer_5_expert_6_gpu3 -->
<g id="node348" class="node">
<title>layer_5_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2204.82,-10519.1 1995.82,-10519.1 1995.82,-10467.1 2204.82,-10467.1 2204.82,-10519.1"/>
<text text-anchor="middle" x="2100.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2100.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2100.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2100.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_6 -->
<g id="node374" class="node">
<title>layer_5_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2094.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2094.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2094.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_6_gpu3&#45;&gt;layer_5_all2all_back_6 -->
<g id="edge499" class="edge">
<title>layer_5_expert_6_gpu3&#45;&gt;layer_5_all2all_back_6</title>
<path fill="none" stroke="black" d="M2098.76,-10466.93C2098.28,-10459.12 2097.73,-10450.26 2097.18,-10441.49"/>
<polygon fill="black" stroke="black" points="2100.66,-10441.07 2096.55,-10431.31 2093.68,-10441.51 2100.66,-10441.07"/>
</g>
<!-- layer_5_all2all_expert_6&#45;&gt;layer_5_expert_6_gpu3 -->
<g id="edge474" class="edge">
<title>layer_5_all2all_expert_6&#45;&gt;layer_5_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2102.2,-10554.84C2101.95,-10546.53 2101.67,-10537.69 2101.42,-10529.41"/>
<polygon fill="black" stroke="black" points="2104.91,-10529.19 2101.1,-10519.3 2097.91,-10529.4 2104.91,-10529.19"/>
</g>
<!-- layer_5_expert_7_gpu3 -->
<g id="node350" class="node">
<title>layer_5_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2520.82,-10519.1 2311.82,-10519.1 2311.82,-10467.1 2520.82,-10467.1 2520.82,-10519.1"/>
<text text-anchor="middle" x="2416.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2416.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2416.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2416.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_7 -->
<g id="node375" class="node">
<title>layer_5_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2415.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2415.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2415.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2415.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2415.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_7_gpu3&#45;&gt;layer_5_all2all_back_7 -->
<g id="edge500" class="edge">
<title>layer_5_expert_7_gpu3&#45;&gt;layer_5_all2all_back_7</title>
<path fill="none" stroke="black" d="M2416.06,-10466.93C2415.98,-10459.12 2415.89,-10450.26 2415.8,-10441.49"/>
<polygon fill="black" stroke="black" points="2419.3,-10441.27 2415.69,-10431.31 2412.3,-10441.35 2419.3,-10441.27"/>
</g>
<!-- layer_5_all2all_expert_7&#45;&gt;layer_5_expert_7_gpu3 -->
<g id="edge476" class="edge">
<title>layer_5_all2all_expert_7&#45;&gt;layer_5_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2418.2,-10554.84C2417.95,-10546.53 2417.67,-10537.69 2417.42,-10529.41"/>
<polygon fill="black" stroke="black" points="2420.91,-10529.19 2417.1,-10519.3 2413.91,-10529.4 2420.91,-10529.19"/>
</g>
<!-- layer_5_expert_8_gpu4 -->
<g id="node352" class="node">
<title>layer_5_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2840.82,-10519.1 2631.82,-10519.1 2631.82,-10467.1 2840.82,-10467.1 2840.82,-10519.1"/>
<text text-anchor="middle" x="2736.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2736.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2736.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2736.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_8 -->
<g id="node376" class="node">
<title>layer_5_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2736.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2736.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2736.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2736.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2736.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_8_gpu4&#45;&gt;layer_5_all2all_back_8 -->
<g id="edge501" class="edge">
<title>layer_5_expert_8_gpu4&#45;&gt;layer_5_all2all_back_8</title>
<path fill="none" stroke="black" d="M2736.32,-10466.93C2736.32,-10459.12 2736.32,-10450.26 2736.32,-10441.49"/>
<polygon fill="black" stroke="black" points="2739.82,-10441.31 2736.32,-10431.31 2732.82,-10441.31 2739.82,-10441.31"/>
</g>
<!-- layer_5_all2all_expert_8&#45;&gt;layer_5_expert_8_gpu4 -->
<g id="edge478" class="edge">
<title>layer_5_all2all_expert_8&#45;&gt;layer_5_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2735.69,-10554.84C2735.78,-10546.53 2735.87,-10537.69 2735.96,-10529.41"/>
<polygon fill="black" stroke="black" points="2739.46,-10529.34 2736.06,-10519.3 2732.46,-10529.26 2739.46,-10529.34"/>
</g>
<!-- layer_5_expert_9_gpu4 -->
<g id="node354" class="node">
<title>layer_5_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3159.82,-10519.1 2950.82,-10519.1 2950.82,-10467.1 3159.82,-10467.1 3159.82,-10519.1"/>
<text text-anchor="middle" x="3055.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3055.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3055.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3055.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_9 -->
<g id="node377" class="node">
<title>layer_5_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3057.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3057.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3057.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3057.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3057.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_9_gpu4&#45;&gt;layer_5_all2all_back_9 -->
<g id="edge502" class="edge">
<title>layer_5_expert_9_gpu4&#45;&gt;layer_5_all2all_back_9</title>
<path fill="none" stroke="black" d="M3055.84,-10466.93C3056,-10459.12 3056.19,-10450.26 3056.37,-10441.49"/>
<polygon fill="black" stroke="black" points="3059.87,-10441.38 3056.58,-10431.31 3052.87,-10441.24 3059.87,-10441.38"/>
</g>
<!-- layer_5_all2all_expert_9&#45;&gt;layer_5_expert_9_gpu4 -->
<g id="edge480" class="edge">
<title>layer_5_all2all_expert_9&#45;&gt;layer_5_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3054.07,-10554.84C3054.24,-10546.53 3054.42,-10537.69 3054.59,-10529.41"/>
<polygon fill="black" stroke="black" points="3058.09,-10529.37 3054.8,-10519.3 3051.09,-10529.22 3058.09,-10529.37"/>
</g>
<!-- layer_5_expert_10_gpu5 -->
<g id="node356" class="node">
<title>layer_5_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3480.82,-10519.1 3271.82,-10519.1 3271.82,-10467.1 3480.82,-10467.1 3480.82,-10519.1"/>
<text text-anchor="middle" x="3376.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3376.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3376.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3376.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_10 -->
<g id="node378" class="node">
<title>layer_5_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3378.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3378.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3378.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3378.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3378.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_10_gpu5&#45;&gt;layer_5_all2all_back_10 -->
<g id="edge503" class="edge">
<title>layer_5_expert_10_gpu5&#45;&gt;layer_5_all2all_back_10</title>
<path fill="none" stroke="black" d="M3376.84,-10466.93C3377,-10459.12 3377.19,-10450.26 3377.37,-10441.49"/>
<polygon fill="black" stroke="black" points="3380.87,-10441.38 3377.58,-10431.31 3373.87,-10441.24 3380.87,-10441.38"/>
</g>
<!-- layer_5_all2all_expert_10&#45;&gt;layer_5_expert_10_gpu5 -->
<g id="edge482" class="edge">
<title>layer_5_all2all_expert_10&#45;&gt;layer_5_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3374.44,-10554.84C3374.7,-10546.53 3374.97,-10537.69 3375.23,-10529.41"/>
<polygon fill="black" stroke="black" points="3378.73,-10529.4 3375.54,-10519.3 3371.73,-10529.19 3378.73,-10529.4"/>
</g>
<!-- layer_5_expert_11_gpu5 -->
<g id="node358" class="node">
<title>layer_5_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3800.82,-10519.1 3591.82,-10519.1 3591.82,-10467.1 3800.82,-10467.1 3800.82,-10519.1"/>
<text text-anchor="middle" x="3696.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3696.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3696.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3696.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_11 -->
<g id="node379" class="node">
<title>layer_5_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3699.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3699.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3699.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3699.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3699.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_11_gpu5&#45;&gt;layer_5_all2all_back_11 -->
<g id="edge504" class="edge">
<title>layer_5_expert_11_gpu5&#45;&gt;layer_5_all2all_back_11</title>
<path fill="none" stroke="black" d="M3697.1,-10466.93C3697.34,-10459.12 3697.62,-10450.26 3697.89,-10441.49"/>
<polygon fill="black" stroke="black" points="3701.39,-10441.41 3698.21,-10431.31 3694.4,-10441.2 3701.39,-10441.41"/>
</g>
<!-- layer_5_all2all_expert_11&#45;&gt;layer_5_expert_11_gpu5 -->
<g id="edge484" class="edge">
<title>layer_5_all2all_expert_11&#45;&gt;layer_5_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3694.44,-10554.84C3694.7,-10546.53 3694.97,-10537.69 3695.23,-10529.41"/>
<polygon fill="black" stroke="black" points="3698.73,-10529.4 3695.54,-10519.3 3691.73,-10529.19 3698.73,-10529.4"/>
</g>
<!-- layer_5_expert_12_gpu6 -->
<g id="node360" class="node">
<title>layer_5_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4121.82,-10519.1 3912.82,-10519.1 3912.82,-10467.1 4121.82,-10467.1 4121.82,-10519.1"/>
<text text-anchor="middle" x="4017.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4017.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4017.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4017.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_12 -->
<g id="node380" class="node">
<title>layer_5_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4020.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4020.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4020.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4020.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4020.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_12_gpu6&#45;&gt;layer_5_all2all_back_12 -->
<g id="edge505" class="edge">
<title>layer_5_expert_12_gpu6&#45;&gt;layer_5_all2all_back_12</title>
<path fill="none" stroke="black" d="M4018.1,-10466.93C4018.34,-10459.12 4018.62,-10450.26 4018.89,-10441.49"/>
<polygon fill="black" stroke="black" points="4022.39,-10441.41 4019.21,-10431.31 4015.4,-10441.2 4022.39,-10441.41"/>
</g>
<!-- layer_5_all2all_expert_12&#45;&gt;layer_5_expert_12_gpu6 -->
<g id="edge486" class="edge">
<title>layer_5_all2all_expert_12&#45;&gt;layer_5_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4015.44,-10554.84C4015.7,-10546.53 4015.97,-10537.69 4016.23,-10529.41"/>
<polygon fill="black" stroke="black" points="4019.73,-10529.4 4016.54,-10519.3 4012.73,-10529.19 4019.73,-10529.4"/>
</g>
<!-- layer_5_expert_13_gpu6 -->
<g id="node362" class="node">
<title>layer_5_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4442.82,-10519.1 4233.82,-10519.1 4233.82,-10467.1 4442.82,-10467.1 4442.82,-10519.1"/>
<text text-anchor="middle" x="4338.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4338.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4338.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4338.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_13 -->
<g id="node381" class="node">
<title>layer_5_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4341.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4341.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4341.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4341.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4341.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_13_gpu6&#45;&gt;layer_5_all2all_back_13 -->
<g id="edge506" class="edge">
<title>layer_5_expert_13_gpu6&#45;&gt;layer_5_all2all_back_13</title>
<path fill="none" stroke="black" d="M4339.1,-10466.93C4339.34,-10459.12 4339.62,-10450.26 4339.89,-10441.49"/>
<polygon fill="black" stroke="black" points="4343.39,-10441.41 4340.21,-10431.31 4336.4,-10441.2 4343.39,-10441.41"/>
</g>
<!-- layer_5_all2all_expert_13&#45;&gt;layer_5_expert_13_gpu6 -->
<g id="edge488" class="edge">
<title>layer_5_all2all_expert_13&#45;&gt;layer_5_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4336.44,-10554.84C4336.7,-10546.53 4336.97,-10537.69 4337.23,-10529.41"/>
<polygon fill="black" stroke="black" points="4340.73,-10529.4 4337.54,-10519.3 4333.73,-10529.19 4340.73,-10529.4"/>
</g>
<!-- layer_5_expert_14_gpu7 -->
<g id="node364" class="node">
<title>layer_5_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4763.82,-10519.1 4554.82,-10519.1 4554.82,-10467.1 4763.82,-10467.1 4763.82,-10519.1"/>
<text text-anchor="middle" x="4659.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4659.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4659.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4659.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_14 -->
<g id="node382" class="node">
<title>layer_5_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4662.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4662.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4662.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4662.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4662.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_14_gpu7&#45;&gt;layer_5_all2all_back_14 -->
<g id="edge507" class="edge">
<title>layer_5_expert_14_gpu7&#45;&gt;layer_5_all2all_back_14</title>
<path fill="none" stroke="black" d="M4660.1,-10466.93C4660.34,-10459.12 4660.62,-10450.26 4660.89,-10441.49"/>
<polygon fill="black" stroke="black" points="4664.39,-10441.41 4661.21,-10431.31 4657.4,-10441.2 4664.39,-10441.41"/>
</g>
<!-- layer_5_all2all_expert_14&#45;&gt;layer_5_expert_14_gpu7 -->
<g id="edge490" class="edge">
<title>layer_5_all2all_expert_14&#45;&gt;layer_5_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4657.44,-10554.84C4657.7,-10546.53 4657.97,-10537.69 4658.23,-10529.41"/>
<polygon fill="black" stroke="black" points="4661.73,-10529.4 4658.54,-10519.3 4654.73,-10529.19 4661.73,-10529.4"/>
</g>
<!-- layer_5_expert_15_gpu7 -->
<g id="node366" class="node">
<title>layer_5_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5084.82,-10519.1 4875.82,-10519.1 4875.82,-10467.1 5084.82,-10467.1 5084.82,-10519.1"/>
<text text-anchor="middle" x="4980.32" y="-10507.1" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4980.32" y="-10496.1" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4980.32" y="-10485.1" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4980.32" y="-10474.1" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_15 -->
<g id="node383" class="node">
<title>layer_5_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4983.32" cy="-10394.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4983.32" y="-10408.33" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4983.32" y="-10397.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4983.32" y="-10386.33" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4983.32" y="-10375.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_expert_15_gpu7&#45;&gt;layer_5_all2all_back_15 -->
<g id="edge508" class="edge">
<title>layer_5_expert_15_gpu7&#45;&gt;layer_5_all2all_back_15</title>
<path fill="none" stroke="black" d="M4981.1,-10466.93C4981.34,-10459.12 4981.62,-10450.26 4981.89,-10441.49"/>
<polygon fill="black" stroke="black" points="4985.39,-10441.41 4982.21,-10431.31 4978.4,-10441.2 4985.39,-10441.41"/>
</g>
<!-- layer_5_all2all_expert_15&#45;&gt;layer_5_expert_15_gpu7 -->
<g id="edge492" class="edge">
<title>layer_5_all2all_expert_15&#45;&gt;layer_5_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4978.44,-10554.84C4978.7,-10546.53 4978.97,-10537.69 4979.23,-10529.41"/>
<polygon fill="black" stroke="black" points="4982.73,-10529.4 4979.54,-10519.3 4975.73,-10529.19 4982.73,-10529.4"/>
</g>
<!-- layer_5_output -->
<g id="node384" class="node">
<title>layer_5_output</title>
<polygon fill="lightblue" stroke="black" points="2682.32,-10321.56 2468.32,-10321.56 2468.32,-10269.56 2682.32,-10269.56 2682.32,-10321.56"/>
<text text-anchor="middle" x="2575.32" y="-10309.56" font-family="Arial" font-size="10.00">Layer 5 Output</text>
<text text-anchor="middle" x="2575.32" y="-10298.56" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2575.32" y="-10287.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2575.32" y="-10276.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_5_all2all_back_0&#45;&gt;layer_5_output -->
<g id="edge509" class="edge">
<title>layer_5_all2all_back_0&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M271.31,-10367.39C290.48,-10363.43 310.42,-10359.9 329.32,-10357.56 747.21,-10305.95 2057.59,-10298.01 2457.96,-10296.79"/>
<polygon fill="black" stroke="black" points="2458.12,-10300.29 2468.11,-10296.76 2458.1,-10293.29 2458.12,-10300.29"/>
</g>
<!-- layer_5_all2all_back_1&#45;&gt;layer_5_output -->
<g id="edge510" class="edge">
<title>layer_5_all2all_back_1&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M592.75,-10367.37C611.79,-10363.44 631.57,-10359.92 650.32,-10357.56 1002.84,-10313.21 2096.7,-10300.46 2458.1,-10297.41"/>
<polygon fill="black" stroke="black" points="2458.35,-10300.91 2468.32,-10297.32 2458.29,-10293.91 2458.35,-10300.91"/>
</g>
<!-- layer_5_all2all_back_2&#45;&gt;layer_5_output -->
<g id="edge511" class="edge">
<title>layer_5_all2all_back_2&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M913.76,-10367.47C932.8,-10363.53 952.58,-10359.98 971.32,-10357.56 1258.83,-10320.47 2138.45,-10303.38 2457.86,-10298.28"/>
<polygon fill="black" stroke="black" points="2458.12,-10301.77 2468.06,-10298.12 2458.01,-10294.78 2458.12,-10301.77"/>
</g>
<!-- layer_5_all2all_back_3&#45;&gt;layer_5_output -->
<g id="edge512" class="edge">
<title>layer_5_all2all_back_3&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M1235.21,-10367.52C1254.12,-10363.61 1273.73,-10360.05 1292.32,-10357.56 1515.45,-10327.7 2184.68,-10307 2457.55,-10299.58"/>
<polygon fill="black" stroke="black" points="2457.98,-10303.07 2467.88,-10299.3 2457.79,-10296.08 2457.98,-10303.07"/>
</g>
<!-- layer_5_all2all_back_4&#45;&gt;layer_5_output -->
<g id="edge513" class="edge">
<title>layer_5_all2all_back_4&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M1556.68,-10367.68C1575.45,-10363.77 1594.89,-10360.18 1613.32,-10357.56 1915.78,-10314.64 2276.05,-10301.92 2457.88,-10298.15"/>
<polygon fill="black" stroke="black" points="2458.07,-10301.64 2468,-10297.94 2457.93,-10294.65 2458.07,-10301.64"/>
</g>
<!-- layer_5_all2all_back_5&#45;&gt;layer_5_output -->
<g id="edge514" class="edge">
<title>layer_5_all2all_back_5&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M1879.05,-10367.89C1897.41,-10364.03 1916.36,-10360.4 1934.32,-10357.56 2116.01,-10328.85 2328.95,-10311.85 2457.91,-10303.36"/>
<polygon fill="black" stroke="black" points="2458.45,-10306.84 2468.2,-10302.69 2457.99,-10299.85 2458.45,-10306.84"/>
</g>
<!-- layer_5_all2all_back_6&#45;&gt;layer_5_output -->
<g id="edge515" class="edge">
<title>layer_5_all2all_back_6&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M2203.35,-10368.64C2220.71,-10364.85 2238.5,-10361.04 2255.32,-10357.56 2322.35,-10343.73 2397.51,-10329.35 2458.14,-10318.02"/>
<polygon fill="black" stroke="black" points="2458.94,-10321.43 2468.13,-10316.16 2457.66,-10314.55 2458.94,-10321.43"/>
</g>
<!-- layer_5_all2all_back_7&#45;&gt;layer_5_output -->
<g id="edge516" class="edge">
<title>layer_5_all2all_back_7&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M2470.38,-10360.03C2488.09,-10349.32 2507.6,-10337.52 2524.95,-10327.03"/>
<polygon fill="black" stroke="black" points="2527.06,-10329.84 2533.81,-10321.67 2523.44,-10323.85 2527.06,-10329.84"/>
</g>
<!-- layer_5_all2all_back_8&#45;&gt;layer_5_output -->
<g id="edge517" class="edge">
<title>layer_5_all2all_back_8&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M2680.91,-10360.03C2663.1,-10349.32 2643.46,-10337.52 2626,-10327.03"/>
<polygon fill="black" stroke="black" points="2627.47,-10323.82 2617.09,-10321.67 2623.86,-10329.82 2627.47,-10323.82"/>
</g>
<!-- layer_5_all2all_back_9&#45;&gt;layer_5_output -->
<g id="edge518" class="edge">
<title>layer_5_all2all_back_9&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M2948.3,-10368.63C2930.93,-10364.84 2913.15,-10361.03 2896.32,-10357.56 2828.96,-10343.68 2753.39,-10329.27 2692.51,-10317.94"/>
<polygon fill="black" stroke="black" points="2692.96,-10314.46 2682.48,-10316.07 2691.68,-10321.34 2692.96,-10314.46"/>
</g>
<!-- layer_5_all2all_back_10&#45;&gt;layer_5_output -->
<g id="edge519" class="edge">
<title>layer_5_all2all_back_10&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M3272.59,-10367.89C3254.24,-10364.03 3235.28,-10360.4 3217.32,-10357.56 3035.22,-10328.8 2821.76,-10311.8 2692.63,-10303.33"/>
<polygon fill="black" stroke="black" points="2692.53,-10299.82 2682.33,-10302.66 2692.08,-10306.8 2692.53,-10299.82"/>
</g>
<!-- layer_5_all2all_back_11&#45;&gt;layer_5_output -->
<g id="edge520" class="edge">
<title>layer_5_all2all_back_11&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M3594.96,-10367.68C3576.2,-10363.77 3556.75,-10360.18 3538.32,-10357.56 3235.34,-10314.58 2874.42,-10301.88 2692.52,-10298.13"/>
<polygon fill="black" stroke="black" points="2692.46,-10294.63 2682.39,-10297.93 2692.32,-10301.63 2692.46,-10294.63"/>
</g>
<!-- layer_5_all2all_back_12&#45;&gt;layer_5_output -->
<g id="edge521" class="edge">
<title>layer_5_all2all_back_12&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M3916.43,-10367.52C3897.53,-10363.61 3877.91,-10360.05 3859.32,-10357.56 3635.88,-10327.66 2965.45,-10306.96 2692.68,-10299.57"/>
<polygon fill="black" stroke="black" points="2692.45,-10296.06 2682.36,-10299.29 2692.26,-10303.06 2692.45,-10296.06"/>
</g>
<!-- layer_5_all2all_back_13&#45;&gt;layer_5_output -->
<g id="edge522" class="edge">
<title>layer_5_all2all_back_13&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M4237.88,-10367.47C4218.84,-10363.53 4199.06,-10359.98 4180.32,-10357.56 3892.54,-10320.44 3011.94,-10303.36 2692.57,-10298.27"/>
<polygon fill="black" stroke="black" points="2692.42,-10294.77 2682.37,-10298.11 2692.31,-10301.77 2692.42,-10294.77"/>
</g>
<!-- layer_5_all2all_back_14&#45;&gt;layer_5_output -->
<g id="edge523" class="edge">
<title>layer_5_all2all_back_14&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M4558.89,-10367.37C4539.85,-10363.44 4520.07,-10359.92 4501.32,-10357.56 4148.62,-10313.19 3054.19,-10300.45 2692.6,-10297.41"/>
<polygon fill="black" stroke="black" points="2692.41,-10293.9 2682.38,-10297.32 2692.35,-10300.9 2692.41,-10293.9"/>
</g>
<!-- layer_5_all2all_back_15&#45;&gt;layer_5_output -->
<g id="edge524" class="edge">
<title>layer_5_all2all_back_15&#45;&gt;layer_5_output</title>
<path fill="none" stroke="black" d="M4880.33,-10367.39C4861.16,-10363.43 4841.22,-10359.9 4822.32,-10357.56 4404.25,-10305.93 3093.28,-10298 2692.73,-10296.78"/>
<polygon fill="black" stroke="black" points="2692.59,-10293.28 2682.58,-10296.75 2692.57,-10300.28 2692.59,-10293.28"/>
</g>
<!-- layer_6_tp_gather -->
<g id="node386" class="node">
<title>layer_6_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2575.32" cy="-10196.79" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2575.32" y="-10210.79" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2575.32" y="-10199.79" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2575.32" y="-10188.79" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2575.32" y="-10177.79" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_5_output&#45;&gt;layer_6_tp_gather -->
<g id="edge525" class="edge">
<title>layer_5_output&#45;&gt;layer_6_tp_gather</title>
<path fill="none" stroke="black" d="M2557.3,-10269.39C2555.64,-10261.42 2554.91,-10252.34 2555.1,-10243.39"/>
<polygon fill="black" stroke="black" points="2558.59,-10243.6 2555.71,-10233.41 2551.61,-10243.17 2558.59,-10243.6"/>
</g>
<!-- layer_5_output&#45;&gt;layer_6_tp_gather -->
<g id="edge527" class="edge">
<title>layer_5_output&#45;&gt;layer_6_tp_gather</title>
<path fill="none" stroke="black" d="M2569.32,-10269.39C2568.77,-10261.58 2568.53,-10252.72 2568.58,-10243.95"/>
<polygon fill="black" stroke="black" points="2572.08,-10243.84 2568.77,-10233.77 2565.08,-10243.7 2572.08,-10243.84"/>
</g>
<!-- layer_5_output&#45;&gt;layer_6_tp_gather -->
<g id="edge529" class="edge">
<title>layer_5_output&#45;&gt;layer_6_tp_gather</title>
<path fill="none" stroke="black" d="M2581.33,-10269.39C2581.87,-10261.58 2582.11,-10252.72 2582.06,-10243.95"/>
<polygon fill="black" stroke="black" points="2585.56,-10243.7 2581.87,-10233.77 2578.56,-10243.84 2585.56,-10243.7"/>
</g>
<!-- layer_5_output&#45;&gt;layer_6_tp_gather -->
<g id="edge531" class="edge">
<title>layer_5_output&#45;&gt;layer_6_tp_gather</title>
<path fill="none" stroke="black" d="M2593.34,-10269.39C2595,-10261.42 2595.73,-10252.34 2595.54,-10243.39"/>
<polygon fill="black" stroke="black" points="2599.03,-10243.17 2594.93,-10233.41 2592.05,-10243.6 2599.03,-10243.17"/>
</g>
<!-- layer_6_qkv_gpu0 -->
<g id="node385" class="node">
<title>layer_6_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2340.32,-10124.03 2134.32,-10124.03 2134.32,-10072.03 2340.32,-10072.03 2340.32,-10124.03"/>
<text text-anchor="middle" x="2237.32" y="-10112.03" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2237.32" y="-10101.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2237.32" y="-10090.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2237.32" y="-10079.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_6_attn_gpu0 -->
<g id="node390" class="node">
<title>layer_6_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2338.32,-10036.03 2136.32,-10036.03 2136.32,-9984.03 2338.32,-9984.03 2338.32,-10036.03"/>
<text text-anchor="middle" x="2237.32" y="-10024.03" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2237.32" y="-10013.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2237.32" y="-10002.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2237.32" y="-9991.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_6_qkv_gpu0&#45;&gt;layer_6_attn_gpu0 -->
<g id="edge533" class="edge">
<title>layer_6_qkv_gpu0&#45;&gt;layer_6_attn_gpu0</title>
<path fill="none" stroke="black" d="M2237.32,-10071.69C2237.32,-10063.73 2237.32,-10054.79 2237.32,-10046.27"/>
<polygon fill="black" stroke="black" points="2240.82,-10046.18 2237.32,-10036.18 2233.82,-10046.18 2240.82,-10046.18"/>
</g>
<!-- layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu0 -->
<g id="edge526" class="edge">
<title>layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2479.37,-10168.32C2434.09,-10155.36 2380.16,-10139.92 2334.7,-10126.9"/>
<polygon fill="black" stroke="black" points="2335.42,-10123.47 2324.84,-10124.08 2333.49,-10130.2 2335.42,-10123.47"/>
</g>
<!-- layer_6_qkv_gpu1 -->
<g id="node387" class="node">
<title>layer_6_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2566.32,-10124.03 2360.32,-10124.03 2360.32,-10072.03 2566.32,-10072.03 2566.32,-10124.03"/>
<text text-anchor="middle" x="2463.32" y="-10112.03" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2463.32" y="-10101.03" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2463.32" y="-10090.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2463.32" y="-10079.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu1 -->
<g id="edge528" class="edge">
<title>layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2535.2,-10161.13C2523.68,-10151.17 2511.17,-10140.37 2499.87,-10130.61"/>
<polygon fill="black" stroke="black" points="2502.13,-10127.93 2492.27,-10124.04 2497.55,-10133.23 2502.13,-10127.93"/>
</g>
<!-- layer_6_qkv_gpu2 -->
<g id="node388" class="node">
<title>layer_6_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2791.32,-10124.03 2585.32,-10124.03 2585.32,-10072.03 2791.32,-10072.03 2791.32,-10124.03"/>
<text text-anchor="middle" x="2688.32" y="-10112.03" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2688.32" y="-10101.03" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2688.32" y="-10090.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2688.32" y="-10079.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu2 -->
<g id="edge530" class="edge">
<title>layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2615.8,-10161.13C2627.43,-10151.17 2640.04,-10140.37 2651.44,-10130.61"/>
<polygon fill="black" stroke="black" points="2653.79,-10133.2 2659.11,-10124.04 2649.24,-10127.89 2653.79,-10133.2"/>
</g>
<!-- layer_6_qkv_gpu3 -->
<g id="node389" class="node">
<title>layer_6_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3015.32,-10124.03 2809.32,-10124.03 2809.32,-10072.03 3015.32,-10072.03 3015.32,-10124.03"/>
<text text-anchor="middle" x="2912.32" y="-10112.03" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2912.32" y="-10101.03" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2912.32" y="-10090.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2912.32" y="-10079.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu3 -->
<g id="edge532" class="edge">
<title>layer_6_tp_gather&#45;&gt;layer_6_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2671.44,-10168.19C2716.48,-10155.26 2770.04,-10139.88 2815.2,-10126.91"/>
<polygon fill="black" stroke="black" points="2816.36,-10130.22 2825,-10124.1 2814.43,-10123.49 2816.36,-10130.22"/>
</g>
<!-- layer_6_attn_gpu1 -->
<g id="node391" class="node">
<title>layer_6_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2560.32,-10036.03 2358.32,-10036.03 2358.32,-9984.03 2560.32,-9984.03 2560.32,-10036.03"/>
<text text-anchor="middle" x="2459.32" y="-10024.03" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2459.32" y="-10013.03" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2459.32" y="-10002.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2459.32" y="-9991.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_6_qkv_gpu1&#45;&gt;layer_6_attn_gpu1 -->
<g id="edge534" class="edge">
<title>layer_6_qkv_gpu1&#45;&gt;layer_6_attn_gpu1</title>
<path fill="none" stroke="black" d="M2462.14,-10071.69C2461.77,-10063.73 2461.36,-10054.79 2460.96,-10046.27"/>
<polygon fill="black" stroke="black" points="2464.45,-10046.01 2460.49,-10036.18 2457.46,-10046.33 2464.45,-10046.01"/>
</g>
<!-- layer_6_attn_gpu2 -->
<g id="node392" class="node">
<title>layer_6_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2791.32,-10036.03 2589.32,-10036.03 2589.32,-9984.03 2791.32,-9984.03 2791.32,-10036.03"/>
<text text-anchor="middle" x="2690.32" y="-10024.03" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2690.32" y="-10013.03" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2690.32" y="-10002.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2690.32" y="-9991.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_6_qkv_gpu2&#45;&gt;layer_6_attn_gpu2 -->
<g id="edge535" class="edge">
<title>layer_6_qkv_gpu2&#45;&gt;layer_6_attn_gpu2</title>
<path fill="none" stroke="black" d="M2688.91,-10071.69C2689.1,-10063.73 2689.3,-10054.79 2689.5,-10046.27"/>
<polygon fill="black" stroke="black" points="2693,-10046.26 2689.74,-10036.18 2686,-10046.1 2693,-10046.26"/>
</g>
<!-- layer_6_attn_gpu3 -->
<g id="node393" class="node">
<title>layer_6_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3013.32,-10036.03 2811.32,-10036.03 2811.32,-9984.03 3013.32,-9984.03 3013.32,-10036.03"/>
<text text-anchor="middle" x="2912.32" y="-10024.03" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2912.32" y="-10013.03" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2912.32" y="-10002.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2912.32" y="-9991.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_6_qkv_gpu3&#45;&gt;layer_6_attn_gpu3 -->
<g id="edge536" class="edge">
<title>layer_6_qkv_gpu3&#45;&gt;layer_6_attn_gpu3</title>
<path fill="none" stroke="black" d="M2912.32,-10071.69C2912.32,-10063.73 2912.32,-10054.79 2912.32,-10046.27"/>
<polygon fill="black" stroke="black" points="2915.82,-10046.18 2912.32,-10036.18 2908.82,-10046.18 2915.82,-10046.18"/>
</g>
<!-- layer_6_attn_out_gpu0 -->
<g id="node394" class="node">
<title>layer_6_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2334.32,-9948.03 2120.32,-9948.03 2120.32,-9896.03 2334.32,-9896.03 2334.32,-9948.03"/>
<text text-anchor="middle" x="2227.32" y="-9936.03" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2227.32" y="-9925.03" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2227.32" y="-9914.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2227.32" y="-9903.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_attn_gpu0&#45;&gt;layer_6_attn_out_gpu0 -->
<g id="edge537" class="edge">
<title>layer_6_attn_gpu0&#45;&gt;layer_6_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2234.37,-9983.69C2233.45,-9975.73 2232.41,-9966.79 2231.42,-9958.27"/>
<polygon fill="black" stroke="black" points="2234.88,-9957.71 2230.25,-9948.18 2227.92,-9958.52 2234.88,-9957.71"/>
</g>
<!-- layer_6_attn_out_gpu1 -->
<g id="node395" class="node">
<title>layer_6_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2566.32,-9948.03 2352.32,-9948.03 2352.32,-9896.03 2566.32,-9896.03 2566.32,-9948.03"/>
<text text-anchor="middle" x="2459.32" y="-9936.03" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2459.32" y="-9925.03" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2459.32" y="-9914.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2459.32" y="-9903.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_attn_gpu1&#45;&gt;layer_6_attn_out_gpu1 -->
<g id="edge538" class="edge">
<title>layer_6_attn_gpu1&#45;&gt;layer_6_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2459.32,-9983.69C2459.32,-9975.73 2459.32,-9966.79 2459.32,-9958.27"/>
<polygon fill="black" stroke="black" points="2462.82,-9958.18 2459.32,-9948.18 2455.82,-9958.18 2462.82,-9958.18"/>
</g>
<!-- layer_6_attn_out_gpu2 -->
<g id="node396" class="node">
<title>layer_6_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2798.32,-9948.03 2584.32,-9948.03 2584.32,-9896.03 2798.32,-9896.03 2798.32,-9948.03"/>
<text text-anchor="middle" x="2691.32" y="-9936.03" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2691.32" y="-9925.03" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2691.32" y="-9914.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2691.32" y="-9903.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_attn_gpu2&#45;&gt;layer_6_attn_out_gpu2 -->
<g id="edge539" class="edge">
<title>layer_6_attn_gpu2&#45;&gt;layer_6_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2690.62,-9983.69C2690.71,-9975.73 2690.81,-9966.79 2690.91,-9958.27"/>
<polygon fill="black" stroke="black" points="2694.41,-9958.22 2691.03,-9948.18 2687.41,-9958.14 2694.41,-9958.22"/>
</g>
<!-- layer_6_attn_out_gpu3 -->
<g id="node397" class="node">
<title>layer_6_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3030.32,-9948.03 2816.32,-9948.03 2816.32,-9896.03 3030.32,-9896.03 3030.32,-9948.03"/>
<text text-anchor="middle" x="2923.32" y="-9936.03" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2923.32" y="-9925.03" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2923.32" y="-9914.03" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2923.32" y="-9903.03" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_attn_gpu3&#45;&gt;layer_6_attn_out_gpu3 -->
<g id="edge540" class="edge">
<title>layer_6_attn_gpu3&#45;&gt;layer_6_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2915.56,-9983.69C2916.58,-9975.73 2917.72,-9966.79 2918.81,-9958.27"/>
<polygon fill="black" stroke="black" points="2922.31,-9958.54 2920.1,-9948.18 2915.36,-9957.66 2922.31,-9958.54"/>
</g>
<!-- layer_6_attn_allreduce -->
<g id="node398" class="node">
<title>layer_6_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2575.32" cy="-9823.26" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2575.32" y="-9837.26" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2575.32" y="-9826.26" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2575.32" y="-9815.26" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2575.32" y="-9804.26" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_attn_out_gpu0&#45;&gt;layer_6_attn_allreduce -->
<g id="edge541" class="edge">
<title>layer_6_attn_out_gpu0&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M2317.39,-9895.98C2363.36,-9883.2 2419.61,-9867.55 2467.84,-9854.14"/>
<polygon fill="black" stroke="black" points="2468.99,-9857.46 2477.69,-9851.41 2467.11,-9850.71 2468.99,-9857.46"/>
</g>
<!-- layer_6_attn_out_gpu1&#45;&gt;layer_6_attn_allreduce -->
<g id="edge542" class="edge">
<title>layer_6_attn_out_gpu1&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M2489.5,-9895.85C2500.73,-9886.48 2513.78,-9875.6 2526.26,-9865.18"/>
<polygon fill="black" stroke="black" points="2528.51,-9867.87 2533.94,-9858.77 2524.02,-9862.49 2528.51,-9867.87"/>
</g>
<!-- layer_6_attn_out_gpu2&#45;&gt;layer_6_attn_allreduce -->
<g id="edge543" class="edge">
<title>layer_6_attn_out_gpu2&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M2661.15,-9895.85C2649.92,-9886.48 2636.86,-9875.6 2624.38,-9865.18"/>
<polygon fill="black" stroke="black" points="2626.62,-9862.49 2616.7,-9858.77 2622.13,-9867.87 2626.62,-9862.49"/>
</g>
<!-- layer_6_attn_out_gpu3&#45;&gt;layer_6_attn_allreduce -->
<g id="edge544" class="edge">
<title>layer_6_attn_out_gpu3&#45;&gt;layer_6_attn_allreduce</title>
<path fill="none" stroke="black" d="M2833.25,-9895.98C2787.28,-9883.2 2731.03,-9867.55 2682.8,-9854.14"/>
<polygon fill="black" stroke="black" points="2683.53,-9850.71 2672.96,-9851.41 2681.65,-9857.46 2683.53,-9850.71"/>
</g>
<!-- layer_6_gate -->
<g id="node399" class="node">
<title>layer_6_gate</title>
<polygon fill="lightyellow" stroke="black" points="2792.18,-9750.49 2447.2,-9750.49 2358.46,-9646.49 2703.44,-9646.49 2792.18,-9750.49"/>
<text text-anchor="middle" x="2575.32" y="-9712.49" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2575.32" y="-9701.49" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2575.32" y="-9690.49" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2575.32" y="-9679.49" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_6_attn_allreduce&#45;&gt;layer_6_gate -->
<g id="edge545" class="edge">
<title>layer_6_attn_allreduce&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2556.76,-9786.75C2555.65,-9778.7 2555.08,-9769.94 2555.07,-9761.16"/>
<polygon fill="black" stroke="black" points="2558.58,-9760.98 2555.31,-9750.9 2551.58,-9760.81 2558.58,-9760.98"/>
</g>
<!-- layer_6_attn_allreduce&#45;&gt;layer_6_gate -->
<g id="edge546" class="edge">
<title>layer_6_attn_allreduce&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2569.12,-9786.42C2568.75,-9778.38 2568.57,-9769.63 2568.57,-9760.88"/>
<polygon fill="black" stroke="black" points="2572.07,-9760.68 2568.65,-9750.65 2565.07,-9760.62 2572.07,-9760.68"/>
</g>
<!-- layer_6_attn_allreduce&#45;&gt;layer_6_gate -->
<g id="edge547" class="edge">
<title>layer_6_attn_allreduce&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2581.52,-9786.42C2581.89,-9778.38 2582.07,-9769.63 2582.07,-9760.88"/>
<polygon fill="black" stroke="black" points="2585.57,-9760.62 2581.99,-9750.65 2578.57,-9760.68 2585.57,-9760.62"/>
</g>
<!-- layer_6_attn_allreduce&#45;&gt;layer_6_gate -->
<g id="edge548" class="edge">
<title>layer_6_attn_allreduce&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2593.88,-9786.75C2594.99,-9778.7 2595.56,-9769.94 2595.57,-9761.16"/>
<polygon fill="black" stroke="black" points="2599.06,-9760.81 2595.33,-9750.9 2592.07,-9760.98 2599.06,-9760.81"/>
</g>
<!-- layer_6_all2all_expert_0 -->
<g id="node401" class="node">
<title>layer_6_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="192.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="192.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="192.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="192.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="192.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_0 -->
<g id="edge549" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.28,-9694.36C1947.66,-9685.72 755.96,-9658.93 363.32,-9610.49 345.2,-9608.25 326.16,-9605.09 307.61,-9601.56"/>
<polygon fill="black" stroke="black" points="308.16,-9598.1 297.67,-9599.63 306.82,-9604.97 308.16,-9598.1"/>
</g>
<!-- layer_6_all2all_expert_1 -->
<g id="node403" class="node">
<title>layer_6_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="520.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="520.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="520.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="520.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="520.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_1 -->
<g id="edge551" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.21,-9693.16C1993.83,-9682.66 1012.32,-9653.49 684.32,-9610.49 667.9,-9608.33 650.68,-9605.37 633.83,-9602.07"/>
<polygon fill="black" stroke="black" points="634.46,-9598.62 623.97,-9600.09 633.08,-9605.49 634.46,-9598.62"/>
</g>
<!-- layer_6_all2all_expert_2 -->
<g id="node405" class="node">
<title>layer_6_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="841.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="841.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="841.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="841.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="841.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_2 -->
<g id="edge553" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2401.49,-9697.2C2110.41,-9694.65 1506.57,-9680.44 1001.32,-9610.49 985.79,-9608.34 969.54,-9605.46 953.6,-9602.26"/>
<polygon fill="black" stroke="black" points="954.22,-9598.81 943.72,-9600.23 952.81,-9605.67 954.22,-9598.81"/>
</g>
<!-- layer_6_all2all_expert_3 -->
<g id="node407" class="node">
<title>layer_6_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1158.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1158.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1158.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1158.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1158.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_3 -->
<g id="edge555" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.62,-9693.74C2154.38,-9686.63 1700.34,-9666.48 1317.32,-9610.49 1302.28,-9608.29 1286.55,-9605.44 1271.08,-9602.3"/>
<polygon fill="black" stroke="black" points="1271.46,-9598.81 1260.96,-9600.21 1270.04,-9605.66 1271.46,-9598.81"/>
</g>
<!-- layer_6_all2all_expert_4 -->
<g id="node409" class="node">
<title>layer_6_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1474.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1474.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1474.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1474.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1474.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_4 -->
<g id="edge557" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2393.67,-9687.79C2203.13,-9675.97 1895.38,-9652.21 1632.32,-9610.49 1617.74,-9608.17 1602.49,-9605.3 1587.47,-9602.2"/>
<polygon fill="black" stroke="black" points="1588.14,-9598.77 1577.63,-9600.14 1586.7,-9605.62 1588.14,-9598.77"/>
</g>
<!-- layer_6_all2all_expert_5 -->
<g id="node411" class="node">
<title>layer_6_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1789.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1789.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1789.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1789.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1789.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_5 -->
<g id="edge559" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2382.97,-9675.26C2258.09,-9659.76 2092.04,-9637.11 1946.32,-9610.49 1932.47,-9607.95 1917.99,-9605.03 1903.66,-9601.98"/>
<polygon fill="black" stroke="black" points="1904.29,-9598.53 1893.78,-9599.84 1902.82,-9605.37 1904.29,-9598.53"/>
</g>
<!-- layer_6_all2all_expert_6 -->
<g id="node413" class="node">
<title>layer_6_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2103.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2103.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2103.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2103.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2103.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_6 -->
<g id="edge561" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2378.91,-9646.4C2322.31,-9631.68 2262.59,-9616.14 2213.27,-9603.31"/>
<polygon fill="black" stroke="black" points="2214.1,-9599.92 2203.54,-9600.79 2212.34,-9606.69 2214.1,-9599.92"/>
</g>
<!-- layer_6_all2all_expert_7 -->
<g id="node415" class="node">
<title>layer_6_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2417.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2417.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2417.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2417.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2417.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_7 -->
<g id="edge563" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2509.23,-9646.13C2496.05,-9635.89 2482.38,-9625.27 2469.73,-9615.44"/>
<polygon fill="black" stroke="black" points="2471.63,-9612.49 2461.59,-9609.11 2467.34,-9618.01 2471.63,-9612.49"/>
</g>
<!-- layer_6_all2all_expert_8 -->
<g id="node417" class="node">
<title>layer_6_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2733.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2733.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2733.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2733.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2733.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_8 -->
<g id="edge565" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2641.41,-9646.13C2654.59,-9635.89 2668.26,-9625.27 2680.91,-9615.44"/>
<polygon fill="black" stroke="black" points="2683.3,-9618.01 2689.05,-9609.11 2679.01,-9612.49 2683.3,-9618.01"/>
</g>
<!-- layer_6_all2all_expert_9 -->
<g id="node419" class="node">
<title>layer_6_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3051.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3051.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3051.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3051.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3051.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_9 -->
<g id="edge567" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2716.2,-9661.15C2787.93,-9642.65 2873.86,-9620.49 2940.74,-9603.24"/>
<polygon fill="black" stroke="black" points="2941.66,-9606.61 2950.47,-9600.73 2939.91,-9599.84 2941.66,-9606.61"/>
</g>
<!-- layer_6_all2all_expert_10 -->
<g id="node421" class="node">
<title>layer_6_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3371.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3371.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3371.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3371.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3371.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_10 -->
<g id="edge569" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2731.94,-9679.47C2860.38,-9663.86 3046.69,-9639.28 3208.32,-9610.49 3223.41,-9607.8 3239.23,-9604.69 3254.82,-9601.46"/>
<polygon fill="black" stroke="black" points="3255.96,-9604.79 3265.03,-9599.32 3254.53,-9597.94 3255.96,-9604.79"/>
</g>
<!-- layer_6_all2all_expert_11 -->
<g id="node423" class="node">
<title>layer_6_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3691.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3691.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3691.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3691.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3691.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_11 -->
<g id="edge571" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2739.66,-9688.74C2930.19,-9677.16 3253.31,-9653.04 3528.32,-9610.49 3543.97,-9608.06 3560.37,-9605.05 3576.48,-9601.8"/>
<polygon fill="black" stroke="black" points="3577.37,-9605.19 3586.46,-9599.75 3575.96,-9598.33 3577.37,-9605.19"/>
</g>
<!-- layer_6_all2all_expert_12 -->
<g id="node425" class="node">
<title>layer_6_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4012.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4012.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4012.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4012.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4012.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_12 -->
<g id="edge573" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2743.97,-9693.81C2988.49,-9686.72 3455.21,-9666.48 3848.32,-9610.49 3864.45,-9608.19 3881.35,-9605.19 3897.92,-9601.9"/>
<polygon fill="black" stroke="black" points="3899.08,-9605.24 3908.19,-9599.83 3897.69,-9598.38 3899.08,-9605.24"/>
</g>
<!-- layer_6_all2all_expert_13 -->
<g id="node427" class="node">
<title>layer_6_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4333.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4333.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4333.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4333.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4333.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_13 -->
<g id="edge575" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2746.9,-9697.11C3039.89,-9694.46 3654.89,-9680.17 4169.32,-9610.49 4185.74,-9608.26 4202.95,-9605.26 4219.79,-9601.94"/>
<polygon fill="black" stroke="black" points="4220.55,-9605.36 4229.66,-9599.95 4219.16,-9598.5 4220.55,-9605.36"/>
</g>
<!-- layer_6_all2all_expert_14 -->
<g id="node429" class="node">
<title>layer_6_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4654.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4654.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4654.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4654.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4654.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_14 -->
<g id="edge577" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2743.76,-9693.5C3146.24,-9683.37 4155.17,-9654.33 4490.32,-9610.49 4506.75,-9608.34 4523.96,-9605.38 4540.81,-9602.08"/>
<polygon fill="black" stroke="black" points="4541.56,-9605.5 4550.68,-9600.1 4540.18,-9598.63 4541.56,-9605.5"/>
</g>
<!-- layer_6_all2all_expert_15 -->
<g id="node431" class="node">
<title>layer_6_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4975.32" cy="-9573.72" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4975.32" y="-9587.72" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4975.32" y="-9576.72" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4975.32" y="-9565.72" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4975.32" y="-9554.72" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_all2all_expert_15 -->
<g id="edge579" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2744.66,-9694.75C3194.48,-9686.88 4412.1,-9661.39 4811.32,-9610.49 4827.87,-9608.38 4845.23,-9605.42 4862.19,-9602.1"/>
<polygon fill="black" stroke="black" points="4863.01,-9605.51 4872.13,-9600.11 4861.64,-9598.64 4863.01,-9605.51"/>
</g>
<!-- layer_6_expert_0_gpu0 -->
<g id="node400" class="node">
<title>layer_6_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="294.82,-9500.95 85.82,-9500.95 85.82,-9448.95 294.82,-9448.95 294.82,-9500.95"/>
<text text-anchor="middle" x="190.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="190.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="190.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="190.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_0 -->
<g id="node432" class="node">
<title>layer_6_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="166.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="166.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="166.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="166.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="166.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_0_gpu0&#45;&gt;layer_6_all2all_back_0 -->
<g id="edge581" class="edge">
<title>layer_6_expert_0_gpu0&#45;&gt;layer_6_all2all_back_0</title>
<path fill="none" stroke="black" d="M184.08,-9448.77C182.12,-9440.88 179.89,-9431.91 177.7,-9423.05"/>
<polygon fill="black" stroke="black" points="181.05,-9422.02 175.24,-9413.15 174.25,-9423.7 181.05,-9422.02"/>
</g>
<!-- layer_6_all2all_expert_0&#45;&gt;layer_6_expert_0_gpu0 -->
<g id="edge550" class="edge">
<title>layer_6_all2all_expert_0&#45;&gt;layer_6_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M191.58,-9536.68C191.4,-9528.37 191.22,-9519.54 191.05,-9511.26"/>
<polygon fill="black" stroke="black" points="194.55,-9511.07 190.84,-9501.14 187.55,-9511.21 194.55,-9511.07"/>
</g>
<!-- layer_6_expert_1_gpu0 -->
<g id="node402" class="node">
<title>layer_6_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="603.82,-9500.95 394.82,-9500.95 394.82,-9448.95 603.82,-9448.95 603.82,-9500.95"/>
<text text-anchor="middle" x="499.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="499.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="499.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="499.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_1 -->
<g id="node433" class="node">
<title>layer_6_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="487.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="487.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="487.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="487.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="487.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_1_gpu0&#45;&gt;layer_6_all2all_back_1 -->
<g id="edge582" class="edge">
<title>layer_6_expert_1_gpu0&#45;&gt;layer_6_all2all_back_1</title>
<path fill="none" stroke="black" d="M496.2,-9448.77C495.23,-9440.97 494.13,-9432.1 493.04,-9423.33"/>
<polygon fill="black" stroke="black" points="496.49,-9422.65 491.78,-9413.15 489.54,-9423.51 496.49,-9422.65"/>
</g>
<!-- layer_6_all2all_expert_1&#45;&gt;layer_6_expert_1_gpu0 -->
<g id="edge552" class="edge">
<title>layer_6_all2all_expert_1&#45;&gt;layer_6_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M512.56,-9536.96C510.72,-9528.46 508.75,-9519.4 506.92,-9510.94"/>
<polygon fill="black" stroke="black" points="510.3,-9510.02 504.76,-9500.99 503.46,-9511.51 510.3,-9510.02"/>
</g>
<!-- layer_6_expert_2_gpu1 -->
<g id="node404" class="node">
<title>layer_6_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="928.82,-9500.95 719.82,-9500.95 719.82,-9448.95 928.82,-9448.95 928.82,-9500.95"/>
<text text-anchor="middle" x="824.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="824.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="824.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="824.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_2 -->
<g id="node434" class="node">
<title>layer_6_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="808.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="808.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="808.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="808.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="808.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_2_gpu1&#45;&gt;layer_6_all2all_back_2 -->
<g id="edge583" class="edge">
<title>layer_6_expert_2_gpu1&#45;&gt;layer_6_all2all_back_2</title>
<path fill="none" stroke="black" d="M820.16,-9448.77C818.85,-9440.88 817.37,-9431.91 815.9,-9423.05"/>
<polygon fill="black" stroke="black" points="819.35,-9422.45 814.27,-9413.15 812.45,-9423.59 819.35,-9422.45"/>
</g>
<!-- layer_6_all2all_expert_2&#45;&gt;layer_6_expert_2_gpu1 -->
<g id="edge554" class="edge">
<title>layer_6_all2all_expert_2&#45;&gt;layer_6_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M835.04,-9536.96C833.55,-9528.46 831.96,-9519.4 830.47,-9510.94"/>
<polygon fill="black" stroke="black" points="833.9,-9510.23 828.72,-9500.99 827,-9511.45 833.9,-9510.23"/>
</g>
<!-- layer_6_expert_3_gpu1 -->
<g id="node406" class="node">
<title>layer_6_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1247.82,-9500.95 1038.82,-9500.95 1038.82,-9448.95 1247.82,-9448.95 1247.82,-9500.95"/>
<text text-anchor="middle" x="1143.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1143.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1143.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1143.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_3 -->
<g id="node435" class="node">
<title>layer_6_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1129.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1129.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1129.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1129.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1129.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_3_gpu1&#45;&gt;layer_6_all2all_back_3 -->
<g id="edge584" class="edge">
<title>layer_6_expert_3_gpu1&#45;&gt;layer_6_all2all_back_3</title>
<path fill="none" stroke="black" d="M1139.68,-9448.77C1138.55,-9440.97 1137.27,-9432.1 1136,-9423.33"/>
<polygon fill="black" stroke="black" points="1139.42,-9422.55 1134.53,-9413.15 1132.49,-9423.55 1139.42,-9422.55"/>
</g>
<!-- layer_6_all2all_expert_3&#45;&gt;layer_6_expert_3_gpu1 -->
<g id="edge556" class="edge">
<title>layer_6_all2all_expert_3&#45;&gt;layer_6_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1152.78,-9536.96C1151.46,-9528.46 1150.06,-9519.4 1148.75,-9510.94"/>
<polygon fill="black" stroke="black" points="1152.19,-9510.34 1147.2,-9500.99 1145.28,-9511.41 1152.19,-9510.34"/>
</g>
<!-- layer_6_expert_4_gpu2 -->
<g id="node408" class="node">
<title>layer_6_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1568.82,-9500.95 1359.82,-9500.95 1359.82,-9448.95 1568.82,-9448.95 1568.82,-9500.95"/>
<text text-anchor="middle" x="1464.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1464.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1464.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1464.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_4 -->
<g id="node436" class="node">
<title>layer_6_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1450.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1450.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1450.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1450.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1450.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_4_gpu2&#45;&gt;layer_6_all2all_back_4 -->
<g id="edge585" class="edge">
<title>layer_6_expert_4_gpu2&#45;&gt;layer_6_all2all_back_4</title>
<path fill="none" stroke="black" d="M1460.68,-9448.77C1459.55,-9440.97 1458.27,-9432.1 1457,-9423.33"/>
<polygon fill="black" stroke="black" points="1460.42,-9422.55 1455.53,-9413.15 1453.49,-9423.55 1460.42,-9422.55"/>
</g>
<!-- layer_6_all2all_expert_4&#45;&gt;layer_6_expert_4_gpu2 -->
<g id="edge558" class="edge">
<title>layer_6_all2all_expert_4&#45;&gt;layer_6_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1470.63,-9536.96C1469.75,-9528.46 1468.81,-9519.4 1467.94,-9510.94"/>
<polygon fill="black" stroke="black" points="1471.42,-9510.58 1466.91,-9500.99 1464.46,-9511.3 1471.42,-9510.58"/>
</g>
<!-- layer_6_expert_5_gpu2 -->
<g id="node410" class="node">
<title>layer_6_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1886.82,-9500.95 1677.82,-9500.95 1677.82,-9448.95 1886.82,-9448.95 1886.82,-9500.95"/>
<text text-anchor="middle" x="1782.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1782.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1782.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1782.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_5 -->
<g id="node437" class="node">
<title>layer_6_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1771.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1771.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1771.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1771.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1771.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_5_gpu2&#45;&gt;layer_6_all2all_back_5 -->
<g id="edge586" class="edge">
<title>layer_6_expert_5_gpu2&#45;&gt;layer_6_all2all_back_5</title>
<path fill="none" stroke="black" d="M1779.46,-9448.77C1778.57,-9440.97 1777.56,-9432.1 1776.57,-9423.33"/>
<polygon fill="black" stroke="black" points="1780.02,-9422.69 1775.41,-9413.15 1773.06,-9423.49 1780.02,-9422.69"/>
</g>
<!-- layer_6_all2all_expert_5&#45;&gt;layer_6_expert_5_gpu2 -->
<g id="edge560" class="edge">
<title>layer_6_all2all_expert_5&#45;&gt;layer_6_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1786.71,-9536.68C1786.11,-9528.37 1785.47,-9519.54 1784.88,-9511.26"/>
<polygon fill="black" stroke="black" points="1788.36,-9510.86 1784.14,-9501.14 1781.37,-9511.37 1788.36,-9510.86"/>
</g>
<!-- layer_6_expert_6_gpu3 -->
<g id="node412" class="node">
<title>layer_6_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2204.82,-9500.95 1995.82,-9500.95 1995.82,-9448.95 2204.82,-9448.95 2204.82,-9500.95"/>
<text text-anchor="middle" x="2100.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2100.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2100.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2100.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_6 -->
<g id="node438" class="node">
<title>layer_6_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2092.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2092.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2092.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2092.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2092.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_6_gpu3&#45;&gt;layer_6_all2all_back_6 -->
<g id="edge587" class="edge">
<title>layer_6_expert_6_gpu3&#45;&gt;layer_6_all2all_back_6</title>
<path fill="none" stroke="black" d="M2098.24,-9448.77C2097.59,-9440.97 2096.86,-9432.1 2096.14,-9423.33"/>
<polygon fill="black" stroke="black" points="2099.61,-9422.83 2095.3,-9413.15 2092.63,-9423.41 2099.61,-9422.83"/>
</g>
<!-- layer_6_all2all_expert_6&#45;&gt;layer_6_expert_6_gpu3 -->
<g id="edge562" class="edge">
<title>layer_6_all2all_expert_6&#45;&gt;layer_6_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2102.2,-9536.68C2101.95,-9528.37 2101.67,-9519.54 2101.42,-9511.26"/>
<polygon fill="black" stroke="black" points="2104.91,-9511.03 2101.1,-9501.14 2097.91,-9511.25 2104.91,-9511.03"/>
</g>
<!-- layer_6_expert_7_gpu3 -->
<g id="node414" class="node">
<title>layer_6_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2518.82,-9500.95 2309.82,-9500.95 2309.82,-9448.95 2518.82,-9448.95 2518.82,-9500.95"/>
<text text-anchor="middle" x="2414.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2414.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2414.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2414.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_7 -->
<g id="node439" class="node">
<title>layer_6_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2413.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2413.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2413.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2413.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2413.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_7_gpu3&#45;&gt;layer_6_all2all_back_7 -->
<g id="edge588" class="edge">
<title>layer_6_expert_7_gpu3&#45;&gt;layer_6_all2all_back_7</title>
<path fill="none" stroke="black" d="M2414.06,-9448.77C2413.98,-9440.97 2413.89,-9432.1 2413.8,-9423.33"/>
<polygon fill="black" stroke="black" points="2417.3,-9423.12 2413.69,-9413.15 2410.3,-9423.19 2417.3,-9423.12"/>
</g>
<!-- layer_6_all2all_expert_7&#45;&gt;layer_6_expert_7_gpu3 -->
<g id="edge564" class="edge">
<title>layer_6_all2all_expert_7&#45;&gt;layer_6_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2416.2,-9536.68C2415.95,-9528.37 2415.67,-9519.54 2415.42,-9511.26"/>
<polygon fill="black" stroke="black" points="2418.91,-9511.03 2415.1,-9501.14 2411.91,-9511.25 2418.91,-9511.03"/>
</g>
<!-- layer_6_expert_8_gpu4 -->
<g id="node416" class="node">
<title>layer_6_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2837.82,-9500.95 2628.82,-9500.95 2628.82,-9448.95 2837.82,-9448.95 2837.82,-9500.95"/>
<text text-anchor="middle" x="2733.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2733.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2733.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2733.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_8 -->
<g id="node440" class="node">
<title>layer_6_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2734.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2734.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2734.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2734.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2734.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_8_gpu4&#45;&gt;layer_6_all2all_back_8 -->
<g id="edge589" class="edge">
<title>layer_6_expert_8_gpu4&#45;&gt;layer_6_all2all_back_8</title>
<path fill="none" stroke="black" d="M2733.58,-9448.77C2733.66,-9440.97 2733.75,-9432.1 2733.84,-9423.33"/>
<polygon fill="black" stroke="black" points="2737.35,-9423.19 2733.95,-9413.15 2730.35,-9423.12 2737.35,-9423.19"/>
</g>
<!-- layer_6_all2all_expert_8&#45;&gt;layer_6_expert_8_gpu4 -->
<g id="edge566" class="edge">
<title>layer_6_all2all_expert_8&#45;&gt;layer_6_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2733.32,-9536.68C2733.32,-9528.37 2733.32,-9519.54 2733.32,-9511.26"/>
<polygon fill="black" stroke="black" points="2736.82,-9511.14 2733.32,-9501.14 2729.82,-9511.14 2736.82,-9511.14"/>
</g>
<!-- layer_6_expert_9_gpu4 -->
<g id="node418" class="node">
<title>layer_6_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3157.82,-9500.95 2948.82,-9500.95 2948.82,-9448.95 3157.82,-9448.95 3157.82,-9500.95"/>
<text text-anchor="middle" x="3053.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3053.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3053.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3053.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_9 -->
<g id="node441" class="node">
<title>layer_6_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3055.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3055.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3055.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3055.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3055.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_9_gpu4&#45;&gt;layer_6_all2all_back_9 -->
<g id="edge590" class="edge">
<title>layer_6_expert_9_gpu4&#45;&gt;layer_6_all2all_back_9</title>
<path fill="none" stroke="black" d="M3053.84,-9448.77C3054,-9440.97 3054.19,-9432.1 3054.37,-9423.33"/>
<polygon fill="black" stroke="black" points="3057.87,-9423.22 3054.58,-9413.15 3050.87,-9423.08 3057.87,-9423.22"/>
</g>
<!-- layer_6_all2all_expert_9&#45;&gt;layer_6_expert_9_gpu4 -->
<g id="edge568" class="edge">
<title>layer_6_all2all_expert_9&#45;&gt;layer_6_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3052.07,-9536.68C3052.24,-9528.37 3052.42,-9519.54 3052.59,-9511.26"/>
<polygon fill="black" stroke="black" points="3056.09,-9511.21 3052.8,-9501.14 3049.09,-9511.07 3056.09,-9511.21"/>
</g>
<!-- layer_6_expert_10_gpu5 -->
<g id="node420" class="node">
<title>layer_6_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3477.82,-9500.95 3268.82,-9500.95 3268.82,-9448.95 3477.82,-9448.95 3477.82,-9500.95"/>
<text text-anchor="middle" x="3373.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3373.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3373.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3373.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_10 -->
<g id="node442" class="node">
<title>layer_6_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3376.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3376.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3376.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3376.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3376.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_10_gpu5&#45;&gt;layer_6_all2all_back_10 -->
<g id="edge591" class="edge">
<title>layer_6_expert_10_gpu5&#45;&gt;layer_6_all2all_back_10</title>
<path fill="none" stroke="black" d="M3374.1,-9448.77C3374.34,-9440.97 3374.62,-9432.1 3374.89,-9423.33"/>
<polygon fill="black" stroke="black" points="3378.39,-9423.26 3375.21,-9413.15 3371.4,-9423.04 3378.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_10&#45;&gt;layer_6_expert_10_gpu5 -->
<g id="edge570" class="edge">
<title>layer_6_all2all_expert_10&#45;&gt;layer_6_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3372.07,-9536.68C3372.24,-9528.37 3372.42,-9519.54 3372.59,-9511.26"/>
<polygon fill="black" stroke="black" points="3376.09,-9511.21 3372.8,-9501.14 3369.09,-9511.07 3376.09,-9511.21"/>
</g>
<!-- layer_6_expert_11_gpu5 -->
<g id="node422" class="node">
<title>layer_6_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3798.82,-9500.95 3589.82,-9500.95 3589.82,-9448.95 3798.82,-9448.95 3798.82,-9500.95"/>
<text text-anchor="middle" x="3694.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3694.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3694.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3694.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_11 -->
<g id="node443" class="node">
<title>layer_6_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3697.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3697.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3697.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3697.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3697.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_11_gpu5&#45;&gt;layer_6_all2all_back_11 -->
<g id="edge592" class="edge">
<title>layer_6_expert_11_gpu5&#45;&gt;layer_6_all2all_back_11</title>
<path fill="none" stroke="black" d="M3695.1,-9448.77C3695.34,-9440.97 3695.62,-9432.1 3695.89,-9423.33"/>
<polygon fill="black" stroke="black" points="3699.39,-9423.26 3696.21,-9413.15 3692.4,-9423.04 3699.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_11&#45;&gt;layer_6_expert_11_gpu5 -->
<g id="edge572" class="edge">
<title>layer_6_all2all_expert_11&#45;&gt;layer_6_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3692.44,-9536.68C3692.7,-9528.37 3692.97,-9519.54 3693.23,-9511.26"/>
<polygon fill="black" stroke="black" points="3696.73,-9511.25 3693.54,-9501.14 3689.73,-9511.03 3696.73,-9511.25"/>
</g>
<!-- layer_6_expert_12_gpu6 -->
<g id="node424" class="node">
<title>layer_6_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4119.82,-9500.95 3910.82,-9500.95 3910.82,-9448.95 4119.82,-9448.95 4119.82,-9500.95"/>
<text text-anchor="middle" x="4015.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4015.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4015.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4015.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_12 -->
<g id="node444" class="node">
<title>layer_6_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4018.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4018.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4018.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4018.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4018.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_12_gpu6&#45;&gt;layer_6_all2all_back_12 -->
<g id="edge593" class="edge">
<title>layer_6_expert_12_gpu6&#45;&gt;layer_6_all2all_back_12</title>
<path fill="none" stroke="black" d="M4016.1,-9448.77C4016.34,-9440.97 4016.62,-9432.1 4016.89,-9423.33"/>
<polygon fill="black" stroke="black" points="4020.39,-9423.26 4017.21,-9413.15 4013.4,-9423.04 4020.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_12&#45;&gt;layer_6_expert_12_gpu6 -->
<g id="edge574" class="edge">
<title>layer_6_all2all_expert_12&#45;&gt;layer_6_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4013.44,-9536.68C4013.7,-9528.37 4013.97,-9519.54 4014.23,-9511.26"/>
<polygon fill="black" stroke="black" points="4017.73,-9511.25 4014.54,-9501.14 4010.73,-9511.03 4017.73,-9511.25"/>
</g>
<!-- layer_6_expert_13_gpu6 -->
<g id="node426" class="node">
<title>layer_6_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4440.82,-9500.95 4231.82,-9500.95 4231.82,-9448.95 4440.82,-9448.95 4440.82,-9500.95"/>
<text text-anchor="middle" x="4336.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4336.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4336.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4336.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_13 -->
<g id="node445" class="node">
<title>layer_6_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4339.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4339.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4339.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4339.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4339.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_13_gpu6&#45;&gt;layer_6_all2all_back_13 -->
<g id="edge594" class="edge">
<title>layer_6_expert_13_gpu6&#45;&gt;layer_6_all2all_back_13</title>
<path fill="none" stroke="black" d="M4337.1,-9448.77C4337.34,-9440.97 4337.62,-9432.1 4337.89,-9423.33"/>
<polygon fill="black" stroke="black" points="4341.39,-9423.26 4338.21,-9413.15 4334.4,-9423.04 4341.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_13&#45;&gt;layer_6_expert_13_gpu6 -->
<g id="edge576" class="edge">
<title>layer_6_all2all_expert_13&#45;&gt;layer_6_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4334.44,-9536.68C4334.7,-9528.37 4334.97,-9519.54 4335.23,-9511.26"/>
<polygon fill="black" stroke="black" points="4338.73,-9511.25 4335.54,-9501.14 4331.73,-9511.03 4338.73,-9511.25"/>
</g>
<!-- layer_6_expert_14_gpu7 -->
<g id="node428" class="node">
<title>layer_6_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4761.82,-9500.95 4552.82,-9500.95 4552.82,-9448.95 4761.82,-9448.95 4761.82,-9500.95"/>
<text text-anchor="middle" x="4657.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4657.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4657.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4657.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_14 -->
<g id="node446" class="node">
<title>layer_6_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4660.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4660.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4660.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4660.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4660.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_14_gpu7&#45;&gt;layer_6_all2all_back_14 -->
<g id="edge595" class="edge">
<title>layer_6_expert_14_gpu7&#45;&gt;layer_6_all2all_back_14</title>
<path fill="none" stroke="black" d="M4658.1,-9448.77C4658.34,-9440.97 4658.62,-9432.1 4658.89,-9423.33"/>
<polygon fill="black" stroke="black" points="4662.39,-9423.26 4659.21,-9413.15 4655.4,-9423.04 4662.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_14&#45;&gt;layer_6_expert_14_gpu7 -->
<g id="edge578" class="edge">
<title>layer_6_all2all_expert_14&#45;&gt;layer_6_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4655.44,-9536.68C4655.7,-9528.37 4655.97,-9519.54 4656.23,-9511.26"/>
<polygon fill="black" stroke="black" points="4659.73,-9511.25 4656.54,-9501.14 4652.73,-9511.03 4659.73,-9511.25"/>
</g>
<!-- layer_6_expert_15_gpu7 -->
<g id="node430" class="node">
<title>layer_6_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5082.82,-9500.95 4873.82,-9500.95 4873.82,-9448.95 5082.82,-9448.95 5082.82,-9500.95"/>
<text text-anchor="middle" x="4978.32" y="-9488.95" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4978.32" y="-9477.95" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4978.32" y="-9466.95" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4978.32" y="-9455.95" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_15 -->
<g id="node447" class="node">
<title>layer_6_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4981.32" cy="-9376.18" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4981.32" y="-9390.18" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4981.32" y="-9379.18" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4981.32" y="-9368.18" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4981.32" y="-9357.18" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_expert_15_gpu7&#45;&gt;layer_6_all2all_back_15 -->
<g id="edge596" class="edge">
<title>layer_6_expert_15_gpu7&#45;&gt;layer_6_all2all_back_15</title>
<path fill="none" stroke="black" d="M4979.1,-9448.77C4979.34,-9440.97 4979.62,-9432.1 4979.89,-9423.33"/>
<polygon fill="black" stroke="black" points="4983.39,-9423.26 4980.21,-9413.15 4976.4,-9423.04 4983.39,-9423.26"/>
</g>
<!-- layer_6_all2all_expert_15&#45;&gt;layer_6_expert_15_gpu7 -->
<g id="edge580" class="edge">
<title>layer_6_all2all_expert_15&#45;&gt;layer_6_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4976.44,-9536.68C4976.7,-9528.37 4976.97,-9519.54 4977.23,-9511.26"/>
<polygon fill="black" stroke="black" points="4980.73,-9511.25 4977.54,-9501.14 4973.73,-9511.03 4980.73,-9511.25"/>
</g>
<!-- layer_6_output -->
<g id="node448" class="node">
<title>layer_6_output</title>
<polygon fill="lightblue" stroke="black" points="2680.32,-9303.41 2466.32,-9303.41 2466.32,-9251.41 2680.32,-9251.41 2680.32,-9303.41"/>
<text text-anchor="middle" x="2573.32" y="-9291.41" font-family="Arial" font-size="10.00">Layer 6 Output</text>
<text text-anchor="middle" x="2573.32" y="-9280.41" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2573.32" y="-9269.41" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2573.32" y="-9258.41" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_6_all2all_back_0&#45;&gt;layer_6_output -->
<g id="edge597" class="edge">
<title>layer_6_all2all_back_0&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M269.31,-9349.23C288.48,-9345.28 308.42,-9341.74 327.32,-9339.41 745.21,-9287.79 2055.59,-9279.85 2455.96,-9278.63"/>
<polygon fill="black" stroke="black" points="2456.12,-9282.13 2466.11,-9278.6 2456.1,-9275.13 2456.12,-9282.13"/>
</g>
<!-- layer_6_all2all_back_1&#45;&gt;layer_6_output -->
<g id="edge598" class="edge">
<title>layer_6_all2all_back_1&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M590.75,-9349.21C609.79,-9345.29 629.57,-9341.77 648.32,-9339.41 1000.84,-9295.06 2094.7,-9282.3 2456.1,-9279.25"/>
<polygon fill="black" stroke="black" points="2456.35,-9282.75 2466.32,-9279.17 2456.29,-9275.75 2456.35,-9282.75"/>
</g>
<!-- layer_6_all2all_back_2&#45;&gt;layer_6_output -->
<g id="edge599" class="edge">
<title>layer_6_all2all_back_2&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M911.76,-9349.31C930.8,-9345.37 950.58,-9341.83 969.32,-9339.41 1256.83,-9302.31 2136.45,-9285.22 2455.86,-9280.12"/>
<polygon fill="black" stroke="black" points="2456.12,-9283.62 2466.06,-9279.96 2456.01,-9276.62 2456.12,-9283.62"/>
</g>
<!-- layer_6_all2all_back_3&#45;&gt;layer_6_output -->
<g id="edge600" class="edge">
<title>layer_6_all2all_back_3&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M1233.21,-9349.37C1252.12,-9345.45 1271.73,-9341.9 1290.32,-9339.41 1513.45,-9309.54 2182.68,-9288.84 2455.55,-9281.43"/>
<polygon fill="black" stroke="black" points="2455.98,-9284.92 2465.88,-9281.15 2455.79,-9277.92 2455.98,-9284.92"/>
</g>
<!-- layer_6_all2all_back_4&#45;&gt;layer_6_output -->
<g id="edge601" class="edge">
<title>layer_6_all2all_back_4&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M1554.68,-9349.52C1573.45,-9345.62 1592.89,-9342.02 1611.32,-9339.41 1913.78,-9296.48 2274.05,-9283.76 2455.88,-9279.99"/>
<polygon fill="black" stroke="black" points="2456.07,-9283.49 2466,-9279.79 2455.93,-9276.49 2456.07,-9283.49"/>
</g>
<!-- layer_6_all2all_back_5&#45;&gt;layer_6_output -->
<g id="edge602" class="edge">
<title>layer_6_all2all_back_5&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M1877.05,-9349.73C1895.41,-9345.88 1914.36,-9342.25 1932.32,-9339.41 2114.01,-9310.69 2326.95,-9293.69 2455.91,-9285.21"/>
<polygon fill="black" stroke="black" points="2456.45,-9288.68 2466.2,-9284.54 2455.99,-9281.69 2456.45,-9288.68"/>
</g>
<!-- layer_6_all2all_back_6&#45;&gt;layer_6_output -->
<g id="edge603" class="edge">
<title>layer_6_all2all_back_6&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M2201.35,-9350.49C2218.71,-9346.69 2236.5,-9342.88 2253.32,-9339.41 2320.35,-9325.58 2395.51,-9311.19 2456.14,-9299.87"/>
<polygon fill="black" stroke="black" points="2456.94,-9303.28 2466.13,-9298 2455.66,-9296.4 2456.94,-9303.28"/>
</g>
<!-- layer_6_all2all_back_7&#45;&gt;layer_6_output -->
<g id="edge604" class="edge">
<title>layer_6_all2all_back_7&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M2468.38,-9341.87C2486.09,-9331.17 2505.6,-9319.36 2522.95,-9308.87"/>
<polygon fill="black" stroke="black" points="2525.06,-9311.69 2531.81,-9303.52 2521.44,-9305.7 2525.06,-9311.69"/>
</g>
<!-- layer_6_all2all_back_8&#45;&gt;layer_6_output -->
<g id="edge605" class="edge">
<title>layer_6_all2all_back_8&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M2678.91,-9341.87C2661.1,-9331.17 2641.46,-9319.36 2624,-9308.87"/>
<polygon fill="black" stroke="black" points="2625.47,-9305.67 2615.09,-9303.52 2621.86,-9311.67 2625.47,-9305.67"/>
</g>
<!-- layer_6_all2all_back_9&#45;&gt;layer_6_output -->
<g id="edge606" class="edge">
<title>layer_6_all2all_back_9&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M2946.3,-9350.48C2928.93,-9346.68 2911.15,-9342.87 2894.32,-9339.41 2826.96,-9325.53 2751.39,-9311.11 2690.51,-9299.78"/>
<polygon fill="black" stroke="black" points="2690.96,-9296.3 2680.48,-9297.92 2689.68,-9303.19 2690.96,-9296.3"/>
</g>
<!-- layer_6_all2all_back_10&#45;&gt;layer_6_output -->
<g id="edge607" class="edge">
<title>layer_6_all2all_back_10&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M3270.59,-9349.73C3252.24,-9345.88 3233.28,-9342.24 3215.32,-9339.41 3033.22,-9310.64 2819.76,-9293.64 2690.63,-9285.18"/>
<polygon fill="black" stroke="black" points="2690.53,-9281.66 2680.33,-9284.51 2690.08,-9288.65 2690.53,-9281.66"/>
</g>
<!-- layer_6_all2all_back_11&#45;&gt;layer_6_output -->
<g id="edge608" class="edge">
<title>layer_6_all2all_back_11&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M3592.96,-9349.52C3574.2,-9345.61 3554.75,-9342.02 3536.32,-9339.41 3233.34,-9296.42 2872.42,-9283.72 2690.52,-9279.97"/>
<polygon fill="black" stroke="black" points="2690.46,-9276.47 2680.39,-9279.77 2690.32,-9283.47 2690.46,-9276.47"/>
</g>
<!-- layer_6_all2all_back_12&#45;&gt;layer_6_output -->
<g id="edge609" class="edge">
<title>layer_6_all2all_back_12&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M3914.43,-9349.37C3895.53,-9345.45 3875.91,-9341.9 3857.32,-9339.41 3633.88,-9309.5 2963.45,-9288.81 2690.68,-9281.41"/>
<polygon fill="black" stroke="black" points="2690.45,-9277.9 2680.36,-9281.13 2690.26,-9284.9 2690.45,-9277.9"/>
</g>
<!-- layer_6_all2all_back_13&#45;&gt;layer_6_output -->
<g id="edge610" class="edge">
<title>layer_6_all2all_back_13&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M4235.88,-9349.31C4216.84,-9345.37 4197.06,-9341.83 4178.32,-9339.41 3890.54,-9302.28 3009.94,-9285.2 2690.57,-9280.12"/>
<polygon fill="black" stroke="black" points="2690.42,-9276.61 2680.37,-9279.95 2690.31,-9283.61 2690.42,-9276.61"/>
</g>
<!-- layer_6_all2all_back_14&#45;&gt;layer_6_output -->
<g id="edge611" class="edge">
<title>layer_6_all2all_back_14&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M4556.89,-9349.21C4537.85,-9345.29 4518.07,-9341.77 4499.32,-9339.41 4146.62,-9295.04 3052.19,-9282.3 2690.6,-9279.25"/>
<polygon fill="black" stroke="black" points="2690.41,-9275.75 2680.38,-9279.16 2690.35,-9282.75 2690.41,-9275.75"/>
</g>
<!-- layer_6_all2all_back_15&#45;&gt;layer_6_output -->
<g id="edge612" class="edge">
<title>layer_6_all2all_back_15&#45;&gt;layer_6_output</title>
<path fill="none" stroke="black" d="M4878.33,-9349.23C4859.16,-9345.28 4839.22,-9341.74 4820.32,-9339.41 4402.25,-9287.77 3091.28,-9279.85 2690.73,-9278.63"/>
<polygon fill="black" stroke="black" points="2690.59,-9275.13 2680.58,-9278.6 2690.57,-9282.13 2690.59,-9275.13"/>
</g>
<!-- layer_7_tp_gather -->
<g id="node450" class="node">
<title>layer_7_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2573.32" cy="-9178.64" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2573.32" y="-9192.64" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2573.32" y="-9181.64" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2573.32" y="-9170.64" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2573.32" y="-9159.64" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_6_output&#45;&gt;layer_7_tp_gather -->
<g id="edge613" class="edge">
<title>layer_6_output&#45;&gt;layer_7_tp_gather</title>
<path fill="none" stroke="black" d="M2555.3,-9251.24C2553.64,-9243.26 2552.91,-9234.18 2553.1,-9225.23"/>
<polygon fill="black" stroke="black" points="2556.59,-9225.44 2553.71,-9215.25 2549.61,-9225.02 2556.59,-9225.44"/>
</g>
<!-- layer_6_output&#45;&gt;layer_7_tp_gather -->
<g id="edge615" class="edge">
<title>layer_6_output&#45;&gt;layer_7_tp_gather</title>
<path fill="none" stroke="black" d="M2567.32,-9251.24C2566.77,-9243.43 2566.53,-9234.56 2566.58,-9225.79"/>
<polygon fill="black" stroke="black" points="2570.08,-9225.68 2566.77,-9215.61 2563.08,-9225.55 2570.08,-9225.68"/>
</g>
<!-- layer_6_output&#45;&gt;layer_7_tp_gather -->
<g id="edge617" class="edge">
<title>layer_6_output&#45;&gt;layer_7_tp_gather</title>
<path fill="none" stroke="black" d="M2579.33,-9251.24C2579.87,-9243.43 2580.11,-9234.56 2580.06,-9225.79"/>
<polygon fill="black" stroke="black" points="2583.56,-9225.55 2579.87,-9215.61 2576.56,-9225.68 2583.56,-9225.55"/>
</g>
<!-- layer_6_output&#45;&gt;layer_7_tp_gather -->
<g id="edge619" class="edge">
<title>layer_6_output&#45;&gt;layer_7_tp_gather</title>
<path fill="none" stroke="black" d="M2591.34,-9251.24C2593,-9243.26 2593.73,-9234.18 2593.54,-9225.23"/>
<polygon fill="black" stroke="black" points="2597.03,-9225.02 2592.93,-9215.25 2590.05,-9225.44 2597.03,-9225.02"/>
</g>
<!-- layer_7_qkv_gpu0 -->
<g id="node449" class="node">
<title>layer_7_qkv_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2337.32,-9105.87 2131.32,-9105.87 2131.32,-9053.87 2337.32,-9053.87 2337.32,-9105.87"/>
<text text-anchor="middle" x="2234.32" y="-9093.87" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2234.32" y="-9082.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2234.32" y="-9071.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2234.32" y="-9060.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_7_attn_gpu0 -->
<g id="node454" class="node">
<title>layer_7_attn_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2332.32,-9017.87 2130.32,-9017.87 2130.32,-8965.87 2332.32,-8965.87 2332.32,-9017.87"/>
<text text-anchor="middle" x="2231.32" y="-9005.87" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2231.32" y="-8994.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2231.32" y="-8983.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2231.32" y="-8972.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_7_qkv_gpu0&#45;&gt;layer_7_attn_gpu0 -->
<g id="edge621" class="edge">
<title>layer_7_qkv_gpu0&#45;&gt;layer_7_attn_gpu0</title>
<path fill="none" stroke="black" d="M2233.44,-9053.53C2233.16,-9045.57 2232.85,-9036.63 2232.55,-9028.11"/>
<polygon fill="black" stroke="black" points="2236.04,-9027.9 2232.2,-9018.03 2229.05,-9028.14 2236.04,-9027.9"/>
</g>
<!-- layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu0 -->
<g id="edge614" class="edge">
<title>layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu0</title>
<path fill="none" stroke="black" d="M2477.08,-9150.17C2431.67,-9137.2 2377.58,-9121.76 2331.99,-9108.75"/>
<polygon fill="black" stroke="black" points="2332.67,-9105.3 2322.1,-9105.92 2330.75,-9112.04 2332.67,-9105.3"/>
</g>
<!-- layer_7_qkv_gpu1 -->
<g id="node451" class="node">
<title>layer_7_qkv_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2563.32,-9105.87 2357.32,-9105.87 2357.32,-9053.87 2563.32,-9053.87 2563.32,-9105.87"/>
<text text-anchor="middle" x="2460.32" y="-9093.87" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2460.32" y="-9082.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2460.32" y="-9071.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2460.32" y="-9060.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu1 -->
<g id="edge616" class="edge">
<title>layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu1</title>
<path fill="none" stroke="black" d="M2532.84,-9142.98C2521.22,-9133.02 2508.6,-9122.21 2497.2,-9112.45"/>
<polygon fill="black" stroke="black" points="2499.4,-9109.73 2489.53,-9105.88 2494.85,-9115.05 2499.4,-9109.73"/>
</g>
<!-- layer_7_qkv_gpu2 -->
<g id="node452" class="node">
<title>layer_7_qkv_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2789.32,-9105.87 2583.32,-9105.87 2583.32,-9053.87 2789.32,-9053.87 2789.32,-9105.87"/>
<text text-anchor="middle" x="2686.32" y="-9093.87" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2686.32" y="-9082.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2686.32" y="-9071.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2686.32" y="-9060.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu2 -->
<g id="edge618" class="edge">
<title>layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu2</title>
<path fill="none" stroke="black" d="M2613.8,-9142.98C2625.43,-9133.02 2638.04,-9122.21 2649.44,-9112.45"/>
<polygon fill="black" stroke="black" points="2651.79,-9115.05 2657.11,-9105.88 2647.24,-9109.73 2651.79,-9115.05"/>
</g>
<!-- layer_7_qkv_gpu3 -->
<g id="node453" class="node">
<title>layer_7_qkv_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3014.32,-9105.87 2808.32,-9105.87 2808.32,-9053.87 3014.32,-9053.87 3014.32,-9105.87"/>
<text text-anchor="middle" x="2911.32" y="-9093.87" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2911.32" y="-9082.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2911.32" y="-9071.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2911.32" y="-9060.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu3 -->
<g id="edge620" class="edge">
<title>layer_7_tp_gather&#45;&gt;layer_7_qkv_gpu3</title>
<path fill="none" stroke="black" d="M2669.27,-9150.17C2714.55,-9137.2 2768.49,-9121.76 2813.94,-9108.75"/>
<polygon fill="black" stroke="black" points="2815.15,-9112.04 2823.8,-9105.92 2813.23,-9105.31 2815.15,-9112.04"/>
</g>
<!-- layer_7_attn_gpu1 -->
<g id="node455" class="node">
<title>layer_7_attn_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2559.32,-9017.87 2357.32,-9017.87 2357.32,-8965.87 2559.32,-8965.87 2559.32,-9017.87"/>
<text text-anchor="middle" x="2458.32" y="-9005.87" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2458.32" y="-8994.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2458.32" y="-8983.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2458.32" y="-8972.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_7_qkv_gpu1&#45;&gt;layer_7_attn_gpu1 -->
<g id="edge622" class="edge">
<title>layer_7_qkv_gpu1&#45;&gt;layer_7_attn_gpu1</title>
<path fill="none" stroke="black" d="M2459.73,-9053.53C2459.55,-9045.57 2459.34,-9036.63 2459.14,-9028.11"/>
<polygon fill="black" stroke="black" points="2462.64,-9027.94 2458.91,-9018.03 2455.64,-9028.1 2462.64,-9027.94"/>
</g>
<!-- layer_7_attn_gpu2 -->
<g id="node456" class="node">
<title>layer_7_attn_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2790.32,-9017.87 2588.32,-9017.87 2588.32,-8965.87 2790.32,-8965.87 2790.32,-9017.87"/>
<text text-anchor="middle" x="2689.32" y="-9005.87" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2689.32" y="-8994.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2689.32" y="-8983.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2689.32" y="-8972.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_7_qkv_gpu2&#45;&gt;layer_7_attn_gpu2 -->
<g id="edge623" class="edge">
<title>layer_7_qkv_gpu2&#45;&gt;layer_7_attn_gpu2</title>
<path fill="none" stroke="black" d="M2687.2,-9053.53C2687.48,-9045.57 2687.79,-9036.63 2688.09,-9028.11"/>
<polygon fill="black" stroke="black" points="2691.59,-9028.14 2688.44,-9018.03 2684.6,-9027.9 2691.59,-9028.14"/>
</g>
<!-- layer_7_attn_gpu3 -->
<g id="node457" class="node">
<title>layer_7_attn_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3012.32,-9017.87 2810.32,-9017.87 2810.32,-8965.87 3012.32,-8965.87 3012.32,-9017.87"/>
<text text-anchor="middle" x="2911.32" y="-9005.87" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2911.32" y="-8994.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2911.32" y="-8983.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2911.32" y="-8972.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_7_qkv_gpu3&#45;&gt;layer_7_attn_gpu3 -->
<g id="edge624" class="edge">
<title>layer_7_qkv_gpu3&#45;&gt;layer_7_attn_gpu3</title>
<path fill="none" stroke="black" d="M2911.32,-9053.53C2911.32,-9045.57 2911.32,-9036.63 2911.32,-9028.11"/>
<polygon fill="black" stroke="black" points="2914.82,-9028.03 2911.32,-9018.03 2907.82,-9028.03 2914.82,-9028.03"/>
</g>
<!-- layer_7_attn_out_gpu0 -->
<g id="node458" class="node">
<title>layer_7_attn_out_gpu0</title>
<polygon fill="lightblue" stroke="black" points="2333.32,-8929.87 2119.32,-8929.87 2119.32,-8877.87 2333.32,-8877.87 2333.32,-8929.87"/>
<text text-anchor="middle" x="2226.32" y="-8917.87" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2226.32" y="-8906.87" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="2226.32" y="-8895.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2226.32" y="-8884.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_attn_gpu0&#45;&gt;layer_7_attn_out_gpu0 -->
<g id="edge625" class="edge">
<title>layer_7_attn_gpu0&#45;&gt;layer_7_attn_out_gpu0</title>
<path fill="none" stroke="black" d="M2229.85,-8965.53C2229.38,-8957.57 2228.87,-8948.63 2228.37,-8940.11"/>
<polygon fill="black" stroke="black" points="2231.86,-8939.81 2227.78,-8930.03 2224.87,-8940.21 2231.86,-8939.81"/>
</g>
<!-- layer_7_attn_out_gpu1 -->
<g id="node459" class="node">
<title>layer_7_attn_out_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2565.32,-8929.87 2351.32,-8929.87 2351.32,-8877.87 2565.32,-8877.87 2565.32,-8929.87"/>
<text text-anchor="middle" x="2458.32" y="-8917.87" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2458.32" y="-8906.87" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="2458.32" y="-8895.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2458.32" y="-8884.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_attn_gpu1&#45;&gt;layer_7_attn_out_gpu1 -->
<g id="edge626" class="edge">
<title>layer_7_attn_gpu1&#45;&gt;layer_7_attn_out_gpu1</title>
<path fill="none" stroke="black" d="M2458.32,-8965.53C2458.32,-8957.57 2458.32,-8948.63 2458.32,-8940.11"/>
<polygon fill="black" stroke="black" points="2461.82,-8940.03 2458.32,-8930.03 2454.82,-8940.03 2461.82,-8940.03"/>
</g>
<!-- layer_7_attn_out_gpu2 -->
<g id="node460" class="node">
<title>layer_7_attn_out_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2797.32,-8929.87 2583.32,-8929.87 2583.32,-8877.87 2797.32,-8877.87 2797.32,-8929.87"/>
<text text-anchor="middle" x="2690.32" y="-8917.87" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2690.32" y="-8906.87" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="2690.32" y="-8895.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2690.32" y="-8884.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_attn_gpu2&#45;&gt;layer_7_attn_out_gpu2 -->
<g id="edge627" class="edge">
<title>layer_7_attn_gpu2&#45;&gt;layer_7_attn_out_gpu2</title>
<path fill="none" stroke="black" d="M2689.62,-8965.53C2689.71,-8957.57 2689.81,-8948.63 2689.91,-8940.11"/>
<polygon fill="black" stroke="black" points="2693.41,-8940.07 2690.03,-8930.03 2686.41,-8939.98 2693.41,-8940.07"/>
</g>
<!-- layer_7_attn_out_gpu3 -->
<g id="node461" class="node">
<title>layer_7_attn_out_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3029.32,-8929.87 2815.32,-8929.87 2815.32,-8877.87 3029.32,-8877.87 3029.32,-8929.87"/>
<text text-anchor="middle" x="2922.32" y="-8917.87" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2922.32" y="-8906.87" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2922.32" y="-8895.87" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2922.32" y="-8884.87" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_attn_gpu3&#45;&gt;layer_7_attn_out_gpu3 -->
<g id="edge628" class="edge">
<title>layer_7_attn_gpu3&#45;&gt;layer_7_attn_out_gpu3</title>
<path fill="none" stroke="black" d="M2914.56,-8965.53C2915.58,-8957.57 2916.72,-8948.63 2917.81,-8940.11"/>
<polygon fill="black" stroke="black" points="2921.31,-8940.39 2919.1,-8930.03 2914.36,-8939.5 2921.31,-8940.39"/>
</g>
<!-- layer_7_attn_allreduce -->
<g id="node462" class="node">
<title>layer_7_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2574.32" cy="-8805.1" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2574.32" y="-8819.1" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2574.32" y="-8808.1" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2574.32" y="-8797.1" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2574.32" y="-8786.1" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_attn_out_gpu0&#45;&gt;layer_7_attn_allreduce -->
<g id="edge629" class="edge">
<title>layer_7_attn_out_gpu0&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M2316.39,-8877.82C2362.36,-8865.04 2418.61,-8849.4 2466.84,-8835.99"/>
<polygon fill="black" stroke="black" points="2467.99,-8839.3 2476.69,-8833.25 2466.11,-8832.56 2467.99,-8839.3"/>
</g>
<!-- layer_7_attn_out_gpu1&#45;&gt;layer_7_attn_allreduce -->
<g id="edge630" class="edge">
<title>layer_7_attn_out_gpu1&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M2488.5,-8877.7C2499.73,-8868.33 2512.78,-8857.44 2525.26,-8847.02"/>
<polygon fill="black" stroke="black" points="2527.51,-8849.71 2532.94,-8840.62 2523.02,-8844.33 2527.51,-8849.71"/>
</g>
<!-- layer_7_attn_out_gpu2&#45;&gt;layer_7_attn_allreduce -->
<g id="edge631" class="edge">
<title>layer_7_attn_out_gpu2&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M2660.15,-8877.7C2648.92,-8868.33 2635.86,-8857.44 2623.38,-8847.02"/>
<polygon fill="black" stroke="black" points="2625.62,-8844.33 2615.7,-8840.62 2621.13,-8849.71 2625.62,-8844.33"/>
</g>
<!-- layer_7_attn_out_gpu3&#45;&gt;layer_7_attn_allreduce -->
<g id="edge632" class="edge">
<title>layer_7_attn_out_gpu3&#45;&gt;layer_7_attn_allreduce</title>
<path fill="none" stroke="black" d="M2832.25,-8877.82C2786.28,-8865.04 2730.03,-8849.4 2681.8,-8835.99"/>
<polygon fill="black" stroke="black" points="2682.53,-8832.56 2671.96,-8833.25 2680.65,-8839.3 2682.53,-8832.56"/>
</g>
<!-- layer_7_gate -->
<g id="node463" class="node">
<title>layer_7_gate</title>
<polygon fill="lightyellow" stroke="black" points="2791.18,-8732.33 2446.2,-8732.33 2357.46,-8628.33 2702.44,-8628.33 2791.18,-8732.33"/>
<text text-anchor="middle" x="2574.32" y="-8694.33" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2574.32" y="-8683.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2574.32" y="-8672.33" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2574.32" y="-8661.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_7_attn_allreduce&#45;&gt;layer_7_gate -->
<g id="edge633" class="edge">
<title>layer_7_attn_allreduce&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2555.76,-8768.59C2554.65,-8760.55 2554.08,-8751.78 2554.07,-8743"/>
<polygon fill="black" stroke="black" points="2557.58,-8742.82 2554.31,-8732.74 2550.58,-8742.66 2557.58,-8742.82"/>
</g>
<!-- layer_7_attn_allreduce&#45;&gt;layer_7_gate -->
<g id="edge634" class="edge">
<title>layer_7_attn_allreduce&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2568.12,-8768.26C2567.75,-8760.22 2567.57,-8751.47 2567.57,-8742.72"/>
<polygon fill="black" stroke="black" points="2571.07,-8742.52 2567.65,-8732.5 2564.07,-8742.47 2571.07,-8742.52"/>
</g>
<!-- layer_7_attn_allreduce&#45;&gt;layer_7_gate -->
<g id="edge635" class="edge">
<title>layer_7_attn_allreduce&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2580.52,-8768.26C2580.89,-8760.22 2581.07,-8751.47 2581.07,-8742.72"/>
<polygon fill="black" stroke="black" points="2584.57,-8742.47 2580.99,-8732.5 2577.57,-8742.52 2584.57,-8742.47"/>
</g>
<!-- layer_7_attn_allreduce&#45;&gt;layer_7_gate -->
<g id="edge636" class="edge">
<title>layer_7_attn_allreduce&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2592.88,-8768.59C2593.99,-8760.55 2594.56,-8751.78 2594.57,-8743"/>
<polygon fill="black" stroke="black" points="2598.06,-8742.66 2594.33,-8732.74 2591.07,-8742.82 2598.06,-8742.66"/>
</g>
<!-- layer_7_all2all_expert_0 -->
<g id="node465" class="node">
<title>layer_7_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="191.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="191.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="191.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="191.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="191.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_0 -->
<g id="edge637" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.28,-8676.2C1946.66,-8667.57 754.96,-8640.77 362.32,-8592.33 344.2,-8590.09 325.16,-8586.93 306.61,-8583.41"/>
<polygon fill="black" stroke="black" points="307.16,-8579.95 296.67,-8581.47 305.82,-8586.82 307.16,-8579.95"/>
</g>
<!-- layer_7_all2all_expert_1 -->
<g id="node467" class="node">
<title>layer_7_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="519.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="519.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="519.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="519.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="519.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_1 -->
<g id="edge639" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2397.21,-8675C1992.83,-8664.5 1011.32,-8635.33 683.32,-8592.33 666.9,-8590.18 649.68,-8587.22 632.83,-8583.91"/>
<polygon fill="black" stroke="black" points="633.46,-8580.47 622.97,-8581.93 632.08,-8587.33 633.46,-8580.47"/>
</g>
<!-- layer_7_all2all_expert_2 -->
<g id="node469" class="node">
<title>layer_7_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="840.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="840.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="840.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="840.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="840.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_2 -->
<g id="edge641" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2400.49,-8679.05C2109.41,-8676.49 1505.57,-8662.28 1000.32,-8592.33 984.79,-8590.18 968.54,-8587.3 952.6,-8584.1"/>
<polygon fill="black" stroke="black" points="953.22,-8580.66 942.72,-8582.08 951.81,-8587.51 953.22,-8580.66"/>
</g>
<!-- layer_7_all2all_expert_3 -->
<g id="node471" class="node">
<title>layer_7_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1157.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1157.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1157.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1157.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1157.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_3 -->
<g id="edge643" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2397.62,-8675.58C2153.38,-8668.47 1699.34,-8648.32 1316.32,-8592.33 1301.28,-8590.13 1285.55,-8587.28 1270.08,-8584.15"/>
<polygon fill="black" stroke="black" points="1270.46,-8580.65 1259.96,-8582.05 1269.04,-8587.51 1270.46,-8580.65"/>
</g>
<!-- layer_7_all2all_expert_4 -->
<g id="node473" class="node">
<title>layer_7_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1473.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1473.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1473.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1473.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1473.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_4 -->
<g id="edge645" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2392.67,-8669.63C2202.13,-8657.81 1894.38,-8634.06 1631.32,-8592.33 1616.74,-8590.02 1601.49,-8587.15 1586.47,-8584.05"/>
<polygon fill="black" stroke="black" points="1587.14,-8580.61 1576.63,-8581.98 1585.7,-8587.46 1587.14,-8580.61"/>
</g>
<!-- layer_7_all2all_expert_5 -->
<g id="node475" class="node">
<title>layer_7_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1788.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1788.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1788.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1788.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1788.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_5 -->
<g id="edge647" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2381.97,-8657.11C2257.09,-8641.6 2091.04,-8618.96 1945.32,-8592.33 1931.47,-8589.8 1916.99,-8586.88 1902.66,-8583.82"/>
<polygon fill="black" stroke="black" points="1903.29,-8580.38 1892.78,-8581.68 1901.82,-8587.22 1903.29,-8580.38"/>
</g>
<!-- layer_7_all2all_expert_6 -->
<g id="node477" class="node">
<title>layer_7_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2102.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2102.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2102.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2102.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2102.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_6 -->
<g id="edge649" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2377.91,-8628.24C2321.31,-8613.52 2261.59,-8597.99 2212.27,-8585.16"/>
<polygon fill="black" stroke="black" points="2213.1,-8581.76 2202.54,-8582.63 2211.34,-8588.53 2213.1,-8581.76"/>
</g>
<!-- layer_7_all2all_expert_7 -->
<g id="node479" class="node">
<title>layer_7_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2416.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2416.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2416.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2416.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2416.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_7 -->
<g id="edge651" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2508.23,-8627.98C2495.05,-8617.73 2481.38,-8607.11 2468.73,-8597.29"/>
<polygon fill="black" stroke="black" points="2470.63,-8594.33 2460.59,-8590.96 2466.34,-8599.86 2470.63,-8594.33"/>
</g>
<!-- layer_7_all2all_expert_8 -->
<g id="node481" class="node">
<title>layer_7_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2732.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2732.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2732.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2732.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2732.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_8 -->
<g id="edge653" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2640.41,-8627.98C2653.59,-8617.73 2667.26,-8607.11 2679.91,-8597.29"/>
<polygon fill="black" stroke="black" points="2682.3,-8599.86 2688.05,-8590.96 2678.01,-8594.33 2682.3,-8599.86"/>
</g>
<!-- layer_7_all2all_expert_9 -->
<g id="node483" class="node">
<title>layer_7_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3050.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3050.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3050.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3050.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3050.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_9 -->
<g id="edge655" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2715.2,-8642.99C2786.93,-8624.49 2872.86,-8602.33 2939.74,-8585.08"/>
<polygon fill="black" stroke="black" points="2940.66,-8588.46 2949.47,-8582.57 2938.91,-8581.68 2940.66,-8588.46"/>
</g>
<!-- layer_7_all2all_expert_10 -->
<g id="node485" class="node">
<title>layer_7_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3370.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3370.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3370.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3370.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3370.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_10 -->
<g id="edge657" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2730.94,-8661.32C2859.38,-8645.7 3045.69,-8621.12 3207.32,-8592.33 3222.41,-8589.64 3238.23,-8586.54 3253.82,-8583.3"/>
<polygon fill="black" stroke="black" points="3254.96,-8586.64 3264.03,-8581.16 3253.53,-8579.79 3254.96,-8586.64"/>
</g>
<!-- layer_7_all2all_expert_11 -->
<g id="node487" class="node">
<title>layer_7_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3690.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3690.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3690.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3690.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3690.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_11 -->
<g id="edge659" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.66,-8670.58C2929.19,-8659 3252.31,-8634.89 3527.32,-8592.33 3542.97,-8589.91 3559.37,-8586.89 3575.48,-8583.64"/>
<polygon fill="black" stroke="black" points="3576.37,-8587.03 3585.46,-8581.59 3574.96,-8580.17 3576.37,-8587.03"/>
</g>
<!-- layer_7_all2all_expert_12 -->
<g id="node489" class="node">
<title>layer_7_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4011.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4011.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4011.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4011.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4011.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_12 -->
<g id="edge661" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2742.97,-8675.66C2987.49,-8668.56 3454.21,-8648.33 3847.32,-8592.33 3863.45,-8590.03 3880.35,-8587.03 3896.92,-8583.75"/>
<polygon fill="black" stroke="black" points="3898.08,-8587.08 3907.19,-8581.67 3896.69,-8580.22 3898.08,-8587.08"/>
</g>
<!-- layer_7_all2all_expert_13 -->
<g id="node491" class="node">
<title>layer_7_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4332.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4332.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4332.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4332.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4332.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_13 -->
<g id="edge663" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2745.9,-8678.95C3038.89,-8676.3 3653.89,-8662.01 4168.32,-8592.33 4184.74,-8590.11 4201.95,-8587.11 4218.79,-8583.78"/>
<polygon fill="black" stroke="black" points="4219.55,-8587.2 4228.66,-8581.8 4218.16,-8580.34 4219.55,-8587.2"/>
</g>
<!-- layer_7_all2all_expert_14 -->
<g id="node493" class="node">
<title>layer_7_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4653.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4653.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4653.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4653.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4653.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_14 -->
<g id="edge665" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2742.76,-8675.34C3145.24,-8665.21 4154.17,-8636.17 4489.32,-8592.33 4505.75,-8590.18 4522.96,-8587.22 4539.81,-8583.92"/>
<polygon fill="black" stroke="black" points="4540.56,-8587.34 4549.68,-8581.94 4539.18,-8580.48 4540.56,-8587.34"/>
</g>
<!-- layer_7_all2all_expert_15 -->
<g id="node495" class="node">
<title>layer_7_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4974.32" cy="-8555.56" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4974.32" y="-8569.56" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4974.32" y="-8558.56" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4974.32" y="-8547.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4974.32" y="-8536.56" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_all2all_expert_15 -->
<g id="edge667" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2743.66,-8676.6C3193.48,-8668.73 4411.1,-8643.23 4810.32,-8592.33 4826.87,-8590.22 4844.23,-8587.26 4861.19,-8583.95"/>
<polygon fill="black" stroke="black" points="4862.01,-8587.35 4871.13,-8581.95 4860.64,-8580.49 4862.01,-8587.35"/>
</g>
<!-- layer_7_expert_0_gpu0 -->
<g id="node464" class="node">
<title>layer_7_expert_0_gpu0</title>
<polygon fill="lightblue" stroke="black" points="293.82,-8482.79 84.82,-8482.79 84.82,-8430.79 293.82,-8430.79 293.82,-8482.79"/>
<text text-anchor="middle" x="189.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="189.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="189.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="189.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_0 -->
<g id="node496" class="node">
<title>layer_7_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="165.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="165.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="165.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="165.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="165.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_0_gpu0&#45;&gt;layer_7_all2all_back_0 -->
<g id="edge669" class="edge">
<title>layer_7_expert_0_gpu0&#45;&gt;layer_7_all2all_back_0</title>
<path fill="none" stroke="black" d="M183.08,-8430.62C181.12,-8422.72 178.89,-8413.75 176.7,-8404.89"/>
<polygon fill="black" stroke="black" points="180.05,-8403.86 174.24,-8395 173.25,-8405.55 180.05,-8403.86"/>
</g>
<!-- layer_7_all2all_expert_0&#45;&gt;layer_7_expert_0_gpu0 -->
<g id="edge638" class="edge">
<title>layer_7_all2all_expert_0&#45;&gt;layer_7_expert_0_gpu0</title>
<path fill="none" stroke="black" d="M190.58,-8518.53C190.4,-8510.21 190.22,-8501.38 190.05,-8493.1"/>
<polygon fill="black" stroke="black" points="193.55,-8492.91 189.84,-8482.99 186.55,-8493.06 193.55,-8492.91"/>
</g>
<!-- layer_7_expert_1_gpu0 -->
<g id="node466" class="node">
<title>layer_7_expert_1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="606.82,-8482.79 397.82,-8482.79 397.82,-8430.79 606.82,-8430.79 606.82,-8482.79"/>
<text text-anchor="middle" x="502.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="502.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="502.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="502.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_1 -->
<g id="node497" class="node">
<title>layer_7_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="486.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="486.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="486.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="486.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="486.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_1_gpu0&#45;&gt;layer_7_all2all_back_1 -->
<g id="edge670" class="edge">
<title>layer_7_expert_1_gpu0&#45;&gt;layer_7_all2all_back_1</title>
<path fill="none" stroke="black" d="M498.16,-8430.62C496.85,-8422.72 495.37,-8413.75 493.9,-8404.89"/>
<polygon fill="black" stroke="black" points="497.35,-8404.29 492.27,-8395 490.45,-8405.43 497.35,-8404.29"/>
</g>
<!-- layer_7_all2all_expert_1&#45;&gt;layer_7_expert_1_gpu0 -->
<g id="edge640" class="edge">
<title>layer_7_all2all_expert_1&#45;&gt;layer_7_expert_1_gpu0</title>
<path fill="none" stroke="black" d="M513.04,-8518.8C511.55,-8510.3 509.96,-8501.25 508.47,-8492.79"/>
<polygon fill="black" stroke="black" points="511.9,-8492.08 506.72,-8482.83 505,-8493.29 511.9,-8492.08"/>
</g>
<!-- layer_7_expert_2_gpu1 -->
<g id="node468" class="node">
<title>layer_7_expert_2_gpu1</title>
<polygon fill="lightblue" stroke="black" points="927.82,-8482.79 718.82,-8482.79 718.82,-8430.79 927.82,-8430.79 927.82,-8482.79"/>
<text text-anchor="middle" x="823.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="823.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="823.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="823.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_2 -->
<g id="node498" class="node">
<title>layer_7_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="807.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="807.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="807.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="807.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="807.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_2_gpu1&#45;&gt;layer_7_all2all_back_2 -->
<g id="edge671" class="edge">
<title>layer_7_expert_2_gpu1&#45;&gt;layer_7_all2all_back_2</title>
<path fill="none" stroke="black" d="M819.16,-8430.62C817.85,-8422.72 816.37,-8413.75 814.9,-8404.89"/>
<polygon fill="black" stroke="black" points="818.35,-8404.29 813.27,-8395 811.45,-8405.43 818.35,-8404.29"/>
</g>
<!-- layer_7_all2all_expert_2&#45;&gt;layer_7_expert_2_gpu1 -->
<g id="edge642" class="edge">
<title>layer_7_all2all_expert_2&#45;&gt;layer_7_expert_2_gpu1</title>
<path fill="none" stroke="black" d="M834.04,-8518.8C832.55,-8510.3 830.96,-8501.25 829.47,-8492.79"/>
<polygon fill="black" stroke="black" points="832.9,-8492.08 827.72,-8482.83 826,-8493.29 832.9,-8492.08"/>
</g>
<!-- layer_7_expert_3_gpu1 -->
<g id="node470" class="node">
<title>layer_7_expert_3_gpu1</title>
<polygon fill="lightblue" stroke="black" points="1246.82,-8482.79 1037.82,-8482.79 1037.82,-8430.79 1246.82,-8430.79 1246.82,-8482.79"/>
<text text-anchor="middle" x="1142.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1142.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="1142.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1142.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_3 -->
<g id="node499" class="node">
<title>layer_7_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1128.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1128.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1128.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1128.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1128.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_3_gpu1&#45;&gt;layer_7_all2all_back_3 -->
<g id="edge672" class="edge">
<title>layer_7_expert_3_gpu1&#45;&gt;layer_7_all2all_back_3</title>
<path fill="none" stroke="black" d="M1138.68,-8430.62C1137.55,-8422.81 1136.27,-8413.94 1135,-8405.18"/>
<polygon fill="black" stroke="black" points="1138.42,-8404.39 1133.53,-8395 1131.49,-8405.4 1138.42,-8404.39"/>
</g>
<!-- layer_7_all2all_expert_3&#45;&gt;layer_7_expert_3_gpu1 -->
<g id="edge644" class="edge">
<title>layer_7_all2all_expert_3&#45;&gt;layer_7_expert_3_gpu1</title>
<path fill="none" stroke="black" d="M1151.78,-8518.8C1150.46,-8510.3 1149.06,-8501.25 1147.75,-8492.79"/>
<polygon fill="black" stroke="black" points="1151.19,-8492.18 1146.2,-8482.83 1144.28,-8493.25 1151.19,-8492.18"/>
</g>
<!-- layer_7_expert_4_gpu2 -->
<g id="node472" class="node">
<title>layer_7_expert_4_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1567.82,-8482.79 1358.82,-8482.79 1358.82,-8430.79 1567.82,-8430.79 1567.82,-8482.79"/>
<text text-anchor="middle" x="1463.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1463.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1463.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1463.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_4 -->
<g id="node500" class="node">
<title>layer_7_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1449.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1449.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1449.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1449.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1449.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_4_gpu2&#45;&gt;layer_7_all2all_back_4 -->
<g id="edge673" class="edge">
<title>layer_7_expert_4_gpu2&#45;&gt;layer_7_all2all_back_4</title>
<path fill="none" stroke="black" d="M1459.68,-8430.62C1458.55,-8422.81 1457.27,-8413.94 1456,-8405.18"/>
<polygon fill="black" stroke="black" points="1459.42,-8404.39 1454.53,-8395 1452.49,-8405.4 1459.42,-8404.39"/>
</g>
<!-- layer_7_all2all_expert_4&#45;&gt;layer_7_expert_4_gpu2 -->
<g id="edge646" class="edge">
<title>layer_7_all2all_expert_4&#45;&gt;layer_7_expert_4_gpu2</title>
<path fill="none" stroke="black" d="M1469.63,-8518.8C1468.75,-8510.3 1467.81,-8501.25 1466.94,-8492.79"/>
<polygon fill="black" stroke="black" points="1470.42,-8492.42 1465.91,-8482.83 1463.46,-8493.14 1470.42,-8492.42"/>
</g>
<!-- layer_7_expert_5_gpu2 -->
<g id="node474" class="node">
<title>layer_7_expert_5_gpu2</title>
<polygon fill="lightblue" stroke="black" points="1885.82,-8482.79 1676.82,-8482.79 1676.82,-8430.79 1885.82,-8430.79 1885.82,-8482.79"/>
<text text-anchor="middle" x="1781.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1781.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="1781.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1781.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_5 -->
<g id="node501" class="node">
<title>layer_7_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1770.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1770.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1770.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="1770.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1770.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_5_gpu2&#45;&gt;layer_7_all2all_back_5 -->
<g id="edge674" class="edge">
<title>layer_7_expert_5_gpu2&#45;&gt;layer_7_all2all_back_5</title>
<path fill="none" stroke="black" d="M1778.46,-8430.62C1777.57,-8422.81 1776.56,-8413.94 1775.57,-8405.18"/>
<polygon fill="black" stroke="black" points="1779.02,-8404.54 1774.41,-8395 1772.06,-8405.33 1779.02,-8404.54"/>
</g>
<!-- layer_7_all2all_expert_5&#45;&gt;layer_7_expert_5_gpu2 -->
<g id="edge648" class="edge">
<title>layer_7_all2all_expert_5&#45;&gt;layer_7_expert_5_gpu2</title>
<path fill="none" stroke="black" d="M1785.71,-8518.53C1785.11,-8510.21 1784.47,-8501.38 1783.88,-8493.1"/>
<polygon fill="black" stroke="black" points="1787.36,-8492.71 1783.14,-8482.99 1780.37,-8493.21 1787.36,-8492.71"/>
</g>
<!-- layer_7_expert_6_gpu3 -->
<g id="node476" class="node">
<title>layer_7_expert_6_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2200.82,-8482.79 1991.82,-8482.79 1991.82,-8430.79 2200.82,-8430.79 2200.82,-8482.79"/>
<text text-anchor="middle" x="2096.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2096.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2096.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2096.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_6 -->
<g id="node502" class="node">
<title>layer_7_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2091.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2091.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2091.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2091.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2091.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_6_gpu3&#45;&gt;layer_7_all2all_back_6 -->
<g id="edge675" class="edge">
<title>layer_7_expert_6_gpu3&#45;&gt;layer_7_all2all_back_6</title>
<path fill="none" stroke="black" d="M2095.02,-8430.62C2094.62,-8422.81 2094.16,-8413.94 2093.71,-8405.18"/>
<polygon fill="black" stroke="black" points="2097.19,-8404.8 2093.18,-8395 2090.2,-8405.16 2097.19,-8404.8"/>
</g>
<!-- layer_7_all2all_expert_6&#45;&gt;layer_7_expert_6_gpu3 -->
<g id="edge650" class="edge">
<title>layer_7_all2all_expert_6&#45;&gt;layer_7_expert_6_gpu3</title>
<path fill="none" stroke="black" d="M2100.09,-8518.53C2099.57,-8510.21 2099.02,-8501.38 2098.51,-8493.1"/>
<polygon fill="black" stroke="black" points="2102,-8492.75 2097.88,-8482.99 2095.01,-8493.18 2102,-8492.75"/>
</g>
<!-- layer_7_expert_7_gpu3 -->
<g id="node478" class="node">
<title>layer_7_expert_7_gpu3</title>
<polygon fill="lightblue" stroke="black" points="2517.82,-8482.79 2308.82,-8482.79 2308.82,-8430.79 2517.82,-8430.79 2517.82,-8482.79"/>
<text text-anchor="middle" x="2413.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2413.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="2413.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2413.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_7 -->
<g id="node503" class="node">
<title>layer_7_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2412.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2412.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2412.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2412.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2412.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_7_gpu3&#45;&gt;layer_7_all2all_back_7 -->
<g id="edge676" class="edge">
<title>layer_7_expert_7_gpu3&#45;&gt;layer_7_all2all_back_7</title>
<path fill="none" stroke="black" d="M2413.06,-8430.62C2412.98,-8422.81 2412.89,-8413.94 2412.8,-8405.18"/>
<polygon fill="black" stroke="black" points="2416.3,-8404.96 2412.69,-8395 2409.3,-8405.03 2416.3,-8404.96"/>
</g>
<!-- layer_7_all2all_expert_7&#45;&gt;layer_7_expert_7_gpu3 -->
<g id="edge652" class="edge">
<title>layer_7_all2all_expert_7&#45;&gt;layer_7_expert_7_gpu3</title>
<path fill="none" stroke="black" d="M2415.2,-8518.53C2414.95,-8510.21 2414.67,-8501.38 2414.42,-8493.1"/>
<polygon fill="black" stroke="black" points="2417.91,-8492.87 2414.1,-8482.99 2410.91,-8493.09 2417.91,-8492.87"/>
</g>
<!-- layer_7_expert_8_gpu4 -->
<g id="node480" class="node">
<title>layer_7_expert_8_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2836.82,-8482.79 2627.82,-8482.79 2627.82,-8430.79 2836.82,-8430.79 2836.82,-8482.79"/>
<text text-anchor="middle" x="2732.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2732.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2732.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2732.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_8 -->
<g id="node504" class="node">
<title>layer_7_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2733.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2733.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2733.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="2733.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2733.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_8_gpu4&#45;&gt;layer_7_all2all_back_8 -->
<g id="edge677" class="edge">
<title>layer_7_expert_8_gpu4&#45;&gt;layer_7_all2all_back_8</title>
<path fill="none" stroke="black" d="M2732.58,-8430.62C2732.66,-8422.81 2732.75,-8413.94 2732.84,-8405.18"/>
<polygon fill="black" stroke="black" points="2736.35,-8405.03 2732.95,-8395 2729.35,-8404.96 2736.35,-8405.03"/>
</g>
<!-- layer_7_all2all_expert_8&#45;&gt;layer_7_expert_8_gpu4 -->
<g id="edge654" class="edge">
<title>layer_7_all2all_expert_8&#45;&gt;layer_7_expert_8_gpu4</title>
<path fill="none" stroke="black" d="M2732.32,-8518.53C2732.32,-8510.21 2732.32,-8501.38 2732.32,-8493.1"/>
<polygon fill="black" stroke="black" points="2735.82,-8492.99 2732.32,-8482.99 2728.82,-8492.99 2735.82,-8492.99"/>
</g>
<!-- layer_7_expert_9_gpu4 -->
<g id="node482" class="node">
<title>layer_7_expert_9_gpu4</title>
<polygon fill="lightblue" stroke="black" points="3156.82,-8482.79 2947.82,-8482.79 2947.82,-8430.79 3156.82,-8430.79 3156.82,-8482.79"/>
<text text-anchor="middle" x="3052.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3052.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="3052.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3052.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_9 -->
<g id="node505" class="node">
<title>layer_7_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3054.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3054.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3054.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3054.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3054.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_9_gpu4&#45;&gt;layer_7_all2all_back_9 -->
<g id="edge678" class="edge">
<title>layer_7_expert_9_gpu4&#45;&gt;layer_7_all2all_back_9</title>
<path fill="none" stroke="black" d="M3052.84,-8430.62C3053,-8422.81 3053.19,-8413.94 3053.37,-8405.18"/>
<polygon fill="black" stroke="black" points="3056.87,-8405.07 3053.58,-8395 3049.87,-8404.92 3056.87,-8405.07"/>
</g>
<!-- layer_7_all2all_expert_9&#45;&gt;layer_7_expert_9_gpu4 -->
<g id="edge656" class="edge">
<title>layer_7_all2all_expert_9&#45;&gt;layer_7_expert_9_gpu4</title>
<path fill="none" stroke="black" d="M3051.07,-8518.53C3051.24,-8510.21 3051.42,-8501.38 3051.59,-8493.1"/>
<polygon fill="black" stroke="black" points="3055.09,-8493.06 3051.8,-8482.99 3048.09,-8492.91 3055.09,-8493.06"/>
</g>
<!-- layer_7_expert_10_gpu5 -->
<g id="node484" class="node">
<title>layer_7_expert_10_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3476.82,-8482.79 3267.82,-8482.79 3267.82,-8430.79 3476.82,-8430.79 3476.82,-8482.79"/>
<text text-anchor="middle" x="3372.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3372.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3372.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3372.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_10 -->
<g id="node506" class="node">
<title>layer_7_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3375.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3375.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3375.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3375.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3375.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_10_gpu5&#45;&gt;layer_7_all2all_back_10 -->
<g id="edge679" class="edge">
<title>layer_7_expert_10_gpu5&#45;&gt;layer_7_all2all_back_10</title>
<path fill="none" stroke="black" d="M3373.1,-8430.62C3373.34,-8422.81 3373.62,-8413.94 3373.89,-8405.18"/>
<polygon fill="black" stroke="black" points="3377.39,-8405.1 3374.21,-8395 3370.4,-8404.88 3377.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_10&#45;&gt;layer_7_expert_10_gpu5 -->
<g id="edge658" class="edge">
<title>layer_7_all2all_expert_10&#45;&gt;layer_7_expert_10_gpu5</title>
<path fill="none" stroke="black" d="M3371.07,-8518.53C3371.24,-8510.21 3371.42,-8501.38 3371.59,-8493.1"/>
<polygon fill="black" stroke="black" points="3375.09,-8493.06 3371.8,-8482.99 3368.09,-8492.91 3375.09,-8493.06"/>
</g>
<!-- layer_7_expert_11_gpu5 -->
<g id="node486" class="node">
<title>layer_7_expert_11_gpu5</title>
<polygon fill="lightblue" stroke="black" points="3797.82,-8482.79 3588.82,-8482.79 3588.82,-8430.79 3797.82,-8430.79 3797.82,-8482.79"/>
<text text-anchor="middle" x="3693.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3693.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="3693.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3693.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_11 -->
<g id="node507" class="node">
<title>layer_7_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3696.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3696.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3696.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3696.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3696.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_11_gpu5&#45;&gt;layer_7_all2all_back_11 -->
<g id="edge680" class="edge">
<title>layer_7_expert_11_gpu5&#45;&gt;layer_7_all2all_back_11</title>
<path fill="none" stroke="black" d="M3694.1,-8430.62C3694.34,-8422.81 3694.62,-8413.94 3694.89,-8405.18"/>
<polygon fill="black" stroke="black" points="3698.39,-8405.1 3695.21,-8395 3691.4,-8404.88 3698.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_11&#45;&gt;layer_7_expert_11_gpu5 -->
<g id="edge660" class="edge">
<title>layer_7_all2all_expert_11&#45;&gt;layer_7_expert_11_gpu5</title>
<path fill="none" stroke="black" d="M3691.44,-8518.53C3691.7,-8510.21 3691.97,-8501.38 3692.23,-8493.1"/>
<polygon fill="black" stroke="black" points="3695.73,-8493.09 3692.54,-8482.99 3688.73,-8492.87 3695.73,-8493.09"/>
</g>
<!-- layer_7_expert_12_gpu6 -->
<g id="node488" class="node">
<title>layer_7_expert_12_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4118.82,-8482.79 3909.82,-8482.79 3909.82,-8430.79 4118.82,-8430.79 4118.82,-8482.79"/>
<text text-anchor="middle" x="4014.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4014.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4014.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4014.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_12 -->
<g id="node508" class="node">
<title>layer_7_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4017.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4017.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4017.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4017.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4017.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_12_gpu6&#45;&gt;layer_7_all2all_back_12 -->
<g id="edge681" class="edge">
<title>layer_7_expert_12_gpu6&#45;&gt;layer_7_all2all_back_12</title>
<path fill="none" stroke="black" d="M4015.1,-8430.62C4015.34,-8422.81 4015.62,-8413.94 4015.89,-8405.18"/>
<polygon fill="black" stroke="black" points="4019.39,-8405.1 4016.21,-8395 4012.4,-8404.88 4019.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_12&#45;&gt;layer_7_expert_12_gpu6 -->
<g id="edge662" class="edge">
<title>layer_7_all2all_expert_12&#45;&gt;layer_7_expert_12_gpu6</title>
<path fill="none" stroke="black" d="M4012.44,-8518.53C4012.7,-8510.21 4012.97,-8501.38 4013.23,-8493.1"/>
<polygon fill="black" stroke="black" points="4016.73,-8493.09 4013.54,-8482.99 4009.73,-8492.87 4016.73,-8493.09"/>
</g>
<!-- layer_7_expert_13_gpu6 -->
<g id="node490" class="node">
<title>layer_7_expert_13_gpu6</title>
<polygon fill="lightblue" stroke="black" points="4439.82,-8482.79 4230.82,-8482.79 4230.82,-8430.79 4439.82,-8430.79 4439.82,-8482.79"/>
<text text-anchor="middle" x="4335.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4335.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="4335.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4335.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_13 -->
<g id="node509" class="node">
<title>layer_7_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4338.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4338.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4338.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4338.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4338.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_13_gpu6&#45;&gt;layer_7_all2all_back_13 -->
<g id="edge682" class="edge">
<title>layer_7_expert_13_gpu6&#45;&gt;layer_7_all2all_back_13</title>
<path fill="none" stroke="black" d="M4336.1,-8430.62C4336.34,-8422.81 4336.62,-8413.94 4336.89,-8405.18"/>
<polygon fill="black" stroke="black" points="4340.39,-8405.1 4337.21,-8395 4333.4,-8404.88 4340.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_13&#45;&gt;layer_7_expert_13_gpu6 -->
<g id="edge664" class="edge">
<title>layer_7_all2all_expert_13&#45;&gt;layer_7_expert_13_gpu6</title>
<path fill="none" stroke="black" d="M4333.44,-8518.53C4333.7,-8510.21 4333.97,-8501.38 4334.23,-8493.1"/>
<polygon fill="black" stroke="black" points="4337.73,-8493.09 4334.54,-8482.99 4330.73,-8492.87 4337.73,-8493.09"/>
</g>
<!-- layer_7_expert_14_gpu7 -->
<g id="node492" class="node">
<title>layer_7_expert_14_gpu7</title>
<polygon fill="lightblue" stroke="black" points="4760.82,-8482.79 4551.82,-8482.79 4551.82,-8430.79 4760.82,-8430.79 4760.82,-8482.79"/>
<text text-anchor="middle" x="4656.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4656.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4656.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4656.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_14 -->
<g id="node510" class="node">
<title>layer_7_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4659.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4659.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4659.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4659.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4659.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_14_gpu7&#45;&gt;layer_7_all2all_back_14 -->
<g id="edge683" class="edge">
<title>layer_7_expert_14_gpu7&#45;&gt;layer_7_all2all_back_14</title>
<path fill="none" stroke="black" d="M4657.1,-8430.62C4657.34,-8422.81 4657.62,-8413.94 4657.89,-8405.18"/>
<polygon fill="black" stroke="black" points="4661.39,-8405.1 4658.21,-8395 4654.4,-8404.88 4661.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_14&#45;&gt;layer_7_expert_14_gpu7 -->
<g id="edge666" class="edge">
<title>layer_7_all2all_expert_14&#45;&gt;layer_7_expert_14_gpu7</title>
<path fill="none" stroke="black" d="M4654.44,-8518.53C4654.7,-8510.21 4654.97,-8501.38 4655.23,-8493.1"/>
<polygon fill="black" stroke="black" points="4658.73,-8493.09 4655.54,-8482.99 4651.73,-8492.87 4658.73,-8493.09"/>
</g>
<!-- layer_7_expert_15_gpu7 -->
<g id="node494" class="node">
<title>layer_7_expert_15_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5081.82,-8482.79 4872.82,-8482.79 4872.82,-8430.79 5081.82,-8430.79 5081.82,-8482.79"/>
<text text-anchor="middle" x="4977.32" y="-8470.79" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4977.32" y="-8459.79" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="4977.32" y="-8448.79" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4977.32" y="-8437.79" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_15 -->
<g id="node511" class="node">
<title>layer_7_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4980.32" cy="-8358.02" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4980.32" y="-8372.02" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4980.32" y="-8361.02" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="4980.32" y="-8350.02" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4980.32" y="-8339.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_expert_15_gpu7&#45;&gt;layer_7_all2all_back_15 -->
<g id="edge684" class="edge">
<title>layer_7_expert_15_gpu7&#45;&gt;layer_7_all2all_back_15</title>
<path fill="none" stroke="black" d="M4978.1,-8430.62C4978.34,-8422.81 4978.62,-8413.94 4978.89,-8405.18"/>
<polygon fill="black" stroke="black" points="4982.39,-8405.1 4979.21,-8395 4975.4,-8404.88 4982.39,-8405.1"/>
</g>
<!-- layer_7_all2all_expert_15&#45;&gt;layer_7_expert_15_gpu7 -->
<g id="edge668" class="edge">
<title>layer_7_all2all_expert_15&#45;&gt;layer_7_expert_15_gpu7</title>
<path fill="none" stroke="black" d="M4975.44,-8518.53C4975.7,-8510.21 4975.97,-8501.38 4976.23,-8493.1"/>
<polygon fill="black" stroke="black" points="4979.73,-8493.09 4976.54,-8482.99 4972.73,-8492.87 4979.73,-8493.09"/>
</g>
<!-- layer_7_output -->
<g id="node512" class="node">
<title>layer_7_output</title>
<polygon fill="lightblue" stroke="black" points="2679.32,-8285.25 2465.32,-8285.25 2465.32,-8233.25 2679.32,-8233.25 2679.32,-8285.25"/>
<text text-anchor="middle" x="2572.32" y="-8273.25" font-family="Arial" font-size="10.00">Layer 7 Output</text>
<text text-anchor="middle" x="2572.32" y="-8262.25" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="2572.32" y="-8251.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2572.32" y="-8240.25" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_all2all_back_0&#45;&gt;layer_7_output -->
<g id="edge685" class="edge">
<title>layer_7_all2all_back_0&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M268.31,-8331.08C287.48,-8327.12 307.42,-8323.59 326.32,-8321.25 744.21,-8269.64 2054.59,-8261.7 2454.96,-8260.47"/>
<polygon fill="black" stroke="black" points="2455.12,-8263.97 2465.11,-8260.44 2455.1,-8256.97 2455.12,-8263.97"/>
</g>
<!-- layer_7_all2all_back_1&#45;&gt;layer_7_output -->
<g id="edge686" class="edge">
<title>layer_7_all2all_back_1&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M589.75,-8331.06C608.79,-8327.13 628.57,-8323.61 647.32,-8321.25 999.84,-8276.9 2093.7,-8264.15 2455.1,-8261.09"/>
<polygon fill="black" stroke="black" points="2455.35,-8264.59 2465.32,-8261.01 2455.29,-8257.59 2455.35,-8264.59"/>
</g>
<!-- layer_7_all2all_back_2&#45;&gt;layer_7_output -->
<g id="edge687" class="edge">
<title>layer_7_all2all_back_2&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M910.76,-8331.15C929.8,-8327.22 949.58,-8323.67 968.32,-8321.25 1255.83,-8284.16 2135.45,-8267.07 2454.86,-8261.97"/>
<polygon fill="black" stroke="black" points="2455.12,-8265.46 2465.06,-8261.8 2455.01,-8258.46 2455.12,-8265.46"/>
</g>
<!-- layer_7_all2all_back_3&#45;&gt;layer_7_output -->
<g id="edge688" class="edge">
<title>layer_7_all2all_back_3&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M1232.21,-8331.21C1251.12,-8327.3 1270.73,-8323.74 1289.32,-8321.25 1512.45,-8291.38 2181.68,-8270.69 2454.55,-8263.27"/>
<polygon fill="black" stroke="black" points="2454.98,-8266.76 2464.88,-8262.99 2454.79,-8259.76 2454.98,-8266.76"/>
</g>
<!-- layer_7_all2all_back_4&#45;&gt;layer_7_output -->
<g id="edge689" class="edge">
<title>layer_7_all2all_back_4&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M1553.68,-8331.37C1572.45,-8327.46 1591.89,-8323.87 1610.32,-8321.25 1912.78,-8278.33 2273.05,-8265.6 2454.88,-8261.83"/>
<polygon fill="black" stroke="black" points="2455.07,-8265.33 2465,-8261.63 2454.93,-8258.33 2455.07,-8265.33"/>
</g>
<!-- layer_7_all2all_back_5&#45;&gt;layer_7_output -->
<g id="edge690" class="edge">
<title>layer_7_all2all_back_5&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M1876.05,-8331.58C1894.41,-8327.72 1913.36,-8324.09 1931.32,-8321.25 2113.01,-8292.54 2325.95,-8275.53 2454.91,-8267.05"/>
<polygon fill="black" stroke="black" points="2455.45,-8270.52 2465.2,-8266.38 2454.99,-8263.54 2455.45,-8270.52"/>
</g>
<!-- layer_7_all2all_back_6&#45;&gt;layer_7_output -->
<g id="edge691" class="edge">
<title>layer_7_all2all_back_6&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M2200.35,-8332.33C2217.71,-8328.53 2235.5,-8324.72 2252.32,-8321.25 2319.35,-8307.42 2394.51,-8293.03 2455.14,-8281.71"/>
<polygon fill="black" stroke="black" points="2455.94,-8285.12 2465.13,-8279.85 2454.66,-8278.24 2455.94,-8285.12"/>
</g>
<!-- layer_7_all2all_back_7&#45;&gt;layer_7_output -->
<g id="edge692" class="edge">
<title>layer_7_all2all_back_7&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M2467.38,-8323.72C2485.09,-8313.01 2504.6,-8301.21 2521.95,-8290.71"/>
<polygon fill="black" stroke="black" points="2524.06,-8293.53 2530.81,-8285.36 2520.44,-8287.54 2524.06,-8293.53"/>
</g>
<!-- layer_7_all2all_back_8&#45;&gt;layer_7_output -->
<g id="edge693" class="edge">
<title>layer_7_all2all_back_8&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M2677.91,-8323.72C2660.1,-8313.01 2640.46,-8301.21 2623,-8290.71"/>
<polygon fill="black" stroke="black" points="2624.47,-8287.51 2614.09,-8285.36 2620.86,-8293.51 2624.47,-8287.51"/>
</g>
<!-- layer_7_all2all_back_9&#45;&gt;layer_7_output -->
<g id="edge694" class="edge">
<title>layer_7_all2all_back_9&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M2945.3,-8332.32C2927.93,-8328.53 2910.15,-8324.72 2893.32,-8321.25 2825.96,-8307.37 2750.39,-8292.95 2689.51,-8281.62"/>
<polygon fill="black" stroke="black" points="2689.96,-8278.15 2679.48,-8279.76 2688.68,-8285.03 2689.96,-8278.15"/>
</g>
<!-- layer_7_all2all_back_10&#45;&gt;layer_7_output -->
<g id="edge695" class="edge">
<title>layer_7_all2all_back_10&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M3269.59,-8331.57C3251.24,-8327.72 3232.28,-8324.09 3214.32,-8321.25 3032.22,-8292.48 2818.76,-8275.49 2689.63,-8267.02"/>
<polygon fill="black" stroke="black" points="2689.53,-8263.51 2679.33,-8266.35 2689.08,-8270.49 2689.53,-8263.51"/>
</g>
<!-- layer_7_all2all_back_11&#45;&gt;layer_7_output -->
<g id="edge696" class="edge">
<title>layer_7_all2all_back_11&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M3591.96,-8331.36C3573.2,-8327.46 3553.75,-8323.87 3535.32,-8321.25 3232.34,-8278.26 2871.42,-8265.57 2689.52,-8261.82"/>
<polygon fill="black" stroke="black" points="2689.46,-8258.32 2679.39,-8261.61 2689.32,-8265.31 2689.46,-8258.32"/>
</g>
<!-- layer_7_all2all_back_12&#45;&gt;layer_7_output -->
<g id="edge697" class="edge">
<title>layer_7_all2all_back_12&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M3913.43,-8331.21C3894.53,-8327.3 3874.91,-8323.74 3856.32,-8321.25 3632.88,-8291.35 2962.45,-8270.65 2689.68,-8263.25"/>
<polygon fill="black" stroke="black" points="2689.45,-8259.75 2679.36,-8262.98 2689.26,-8266.74 2689.45,-8259.75"/>
</g>
<!-- layer_7_all2all_back_13&#45;&gt;layer_7_output -->
<g id="edge698" class="edge">
<title>layer_7_all2all_back_13&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M4234.88,-8331.15C4215.84,-8327.22 4196.06,-8323.67 4177.32,-8321.25 3889.54,-8284.12 3008.94,-8267.05 2689.57,-8261.96"/>
<polygon fill="black" stroke="black" points="2689.42,-8258.46 2679.37,-8261.8 2689.31,-8265.46 2689.42,-8258.46"/>
</g>
<!-- layer_7_all2all_back_14&#45;&gt;layer_7_output -->
<g id="edge699" class="edge">
<title>layer_7_all2all_back_14&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M4555.89,-8331.06C4536.85,-8327.13 4517.07,-8323.61 4498.32,-8321.25 4145.62,-8276.88 3051.19,-8264.14 2689.6,-8261.09"/>
<polygon fill="black" stroke="black" points="2689.41,-8257.59 2679.38,-8261.01 2689.35,-8264.59 2689.41,-8257.59"/>
</g>
<!-- layer_7_all2all_back_15&#45;&gt;layer_7_output -->
<g id="edge700" class="edge">
<title>layer_7_all2all_back_15&#45;&gt;layer_7_output</title>
<path fill="none" stroke="black" d="M4877.33,-8331.07C4858.16,-8327.12 4838.22,-8323.59 4819.32,-8321.25 4401.25,-8269.62 3090.28,-8261.69 2689.73,-8260.47"/>
<polygon fill="black" stroke="black" points="2689.59,-8256.97 2679.58,-8260.44 2689.57,-8263.97 2689.59,-8256.97"/>
</g>
<!-- pipeline_stage0_to_stage1 -->
<g id="node513" class="node">
<title>pipeline_stage0_to_stage1</title>
<ellipse fill="lightgreen" stroke="black" cx="2572.32" cy="-8160.48" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2572.32" y="-8174.48" font-family="Arial" font-size="10.00">Pipeline Stage 01</text>
<text text-anchor="middle" x="2572.32" y="-8163.48" font-family="Arial" font-size="10.00">GPU: 0&#45;3  4&#45;7</text>
<text text-anchor="middle" x="2572.32" y="-8152.48" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2572.32" y="-8141.48" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_7_output&#45;&gt;pipeline_stage0_to_stage1 -->
<g id="edge701" class="edge">
<title>layer_7_output&#45;&gt;pipeline_stage0_to_stage1</title>
<path fill="none" stroke="black" d="M2572.32,-8233.08C2572.32,-8225.27 2572.32,-8216.4 2572.32,-8207.64"/>
<polygon fill="black" stroke="black" points="2575.82,-8207.46 2572.32,-8197.46 2568.82,-8207.46 2575.82,-8207.46"/>
</g>
<!-- layer_8_qkv_gpu4 -->
<g id="node514" class="node">
<title>layer_8_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2335.32,-8087.71 2129.32,-8087.71 2129.32,-8035.71 2335.32,-8035.71 2335.32,-8087.71"/>
<text text-anchor="middle" x="2232.32" y="-8075.71" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2232.32" y="-8064.71" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2232.32" y="-8053.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2232.32" y="-8042.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu4 -->
<g id="edge702" class="edge">
<title>pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2475.8,-8132.01C2430.16,-8119.02 2375.77,-8103.54 2329.99,-8090.51"/>
<polygon fill="black" stroke="black" points="2330.93,-8087.14 2320.36,-8087.77 2329.02,-8093.87 2330.93,-8087.14"/>
</g>
<!-- layer_8_qkv_gpu5 -->
<g id="node515" class="node">
<title>layer_8_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2563.32,-8087.71 2357.32,-8087.71 2357.32,-8035.71 2563.32,-8035.71 2563.32,-8087.71"/>
<text text-anchor="middle" x="2460.32" y="-8075.71" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2460.32" y="-8064.71" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2460.32" y="-8053.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2460.32" y="-8042.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu5 -->
<g id="edge703" class="edge">
<title>pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2532.2,-8124.82C2520.68,-8114.86 2508.17,-8104.06 2496.87,-8094.29"/>
<polygon fill="black" stroke="black" points="2499.13,-8091.62 2489.27,-8087.73 2494.55,-8096.91 2499.13,-8091.62"/>
</g>
<!-- layer_8_qkv_gpu6 -->
<g id="node516" class="node">
<title>layer_8_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2788.32,-8087.71 2582.32,-8087.71 2582.32,-8035.71 2788.32,-8035.71 2788.32,-8087.71"/>
<text text-anchor="middle" x="2685.32" y="-8075.71" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2685.32" y="-8064.71" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2685.32" y="-8053.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2685.32" y="-8042.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu6 -->
<g id="edge704" class="edge">
<title>pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2612.8,-8124.82C2624.43,-8114.86 2637.04,-8104.06 2648.44,-8094.29"/>
<polygon fill="black" stroke="black" points="2650.79,-8096.89 2656.11,-8087.73 2646.24,-8091.57 2650.79,-8096.89"/>
</g>
<!-- layer_8_qkv_gpu7 -->
<g id="node517" class="node">
<title>layer_8_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3017.32,-8087.71 2811.32,-8087.71 2811.32,-8035.71 3017.32,-8035.71 3017.32,-8087.71"/>
<text text-anchor="middle" x="2914.32" y="-8075.71" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2914.32" y="-8064.71" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2914.32" y="-8053.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2914.32" y="-8042.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu7 -->
<g id="edge705" class="edge">
<title>pipeline_stage0_to_stage1&#45;&gt;layer_8_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2668.95,-8132.14C2714.96,-8119.12 2769.89,-8103.58 2816.11,-8090.5"/>
<polygon fill="black" stroke="black" points="2817.16,-8093.84 2825.83,-8087.75 2815.25,-8087.11 2817.16,-8093.84"/>
</g>
<!-- layer_8_attn_gpu4 -->
<g id="node518" class="node">
<title>layer_8_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2329.32,-7999.71 2127.32,-7999.71 2127.32,-7947.71 2329.32,-7947.71 2329.32,-7999.71"/>
<text text-anchor="middle" x="2228.32" y="-7987.71" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2228.32" y="-7976.71" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2228.32" y="-7965.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2228.32" y="-7954.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_8_qkv_gpu4&#45;&gt;layer_8_attn_gpu4 -->
<g id="edge706" class="edge">
<title>layer_8_qkv_gpu4&#45;&gt;layer_8_attn_gpu4</title>
<path fill="none" stroke="black" d="M2231.14,-8035.37C2230.77,-8027.41 2230.36,-8018.48 2229.96,-8009.96"/>
<polygon fill="black" stroke="black" points="2233.45,-8009.7 2229.49,-7999.87 2226.46,-8010.02 2233.45,-8009.7"/>
</g>
<!-- layer_8_attn_gpu5 -->
<g id="node519" class="node">
<title>layer_8_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2557.32,-7999.71 2355.32,-7999.71 2355.32,-7947.71 2557.32,-7947.71 2557.32,-7999.71"/>
<text text-anchor="middle" x="2456.32" y="-7987.71" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2456.32" y="-7976.71" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2456.32" y="-7965.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2456.32" y="-7954.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_8_qkv_gpu5&#45;&gt;layer_8_attn_gpu5 -->
<g id="edge707" class="edge">
<title>layer_8_qkv_gpu5&#45;&gt;layer_8_attn_gpu5</title>
<path fill="none" stroke="black" d="M2459.14,-8035.37C2458.77,-8027.41 2458.36,-8018.48 2457.96,-8009.96"/>
<polygon fill="black" stroke="black" points="2461.45,-8009.7 2457.49,-7999.87 2454.46,-8010.02 2461.45,-8009.7"/>
</g>
<!-- layer_8_attn_gpu6 -->
<g id="node520" class="node">
<title>layer_8_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2788.32,-7999.71 2586.32,-7999.71 2586.32,-7947.71 2788.32,-7947.71 2788.32,-7999.71"/>
<text text-anchor="middle" x="2687.32" y="-7987.71" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2687.32" y="-7976.71" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2687.32" y="-7965.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2687.32" y="-7954.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_8_qkv_gpu6&#45;&gt;layer_8_attn_gpu6 -->
<g id="edge708" class="edge">
<title>layer_8_qkv_gpu6&#45;&gt;layer_8_attn_gpu6</title>
<path fill="none" stroke="black" d="M2685.91,-8035.37C2686.1,-8027.41 2686.3,-8018.48 2686.5,-8009.96"/>
<polygon fill="black" stroke="black" points="2690,-8009.95 2686.74,-7999.87 2683,-8009.78 2690,-8009.95"/>
</g>
<!-- layer_8_attn_gpu7 -->
<g id="node521" class="node">
<title>layer_8_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3018.32,-7999.71 2816.32,-7999.71 2816.32,-7947.71 3018.32,-7947.71 3018.32,-7999.71"/>
<text text-anchor="middle" x="2917.32" y="-7987.71" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2917.32" y="-7976.71" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2917.32" y="-7965.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2917.32" y="-7954.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_8_qkv_gpu7&#45;&gt;layer_8_attn_gpu7 -->
<g id="edge709" class="edge">
<title>layer_8_qkv_gpu7&#45;&gt;layer_8_attn_gpu7</title>
<path fill="none" stroke="black" d="M2915.2,-8035.37C2915.48,-8027.41 2915.79,-8018.48 2916.09,-8009.96"/>
<polygon fill="black" stroke="black" points="2919.59,-8009.98 2916.44,-7999.87 2912.6,-8009.74 2919.59,-8009.98"/>
</g>
<!-- layer_8_attn_out_gpu4 -->
<g id="node522" class="node">
<title>layer_8_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2331.32,-7911.71 2117.32,-7911.71 2117.32,-7859.71 2331.32,-7859.71 2331.32,-7911.71"/>
<text text-anchor="middle" x="2224.32" y="-7899.71" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2224.32" y="-7888.71" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2224.32" y="-7877.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2224.32" y="-7866.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_attn_gpu4&#45;&gt;layer_8_attn_out_gpu4 -->
<g id="edge710" class="edge">
<title>layer_8_attn_gpu4&#45;&gt;layer_8_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2227.14,-7947.37C2226.77,-7939.41 2226.36,-7930.48 2225.96,-7921.96"/>
<polygon fill="black" stroke="black" points="2229.45,-7921.7 2225.49,-7911.87 2222.46,-7922.02 2229.45,-7921.7"/>
</g>
<!-- layer_8_attn_out_gpu5 -->
<g id="node523" class="node">
<title>layer_8_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2563.32,-7911.71 2349.32,-7911.71 2349.32,-7859.71 2563.32,-7859.71 2563.32,-7911.71"/>
<text text-anchor="middle" x="2456.32" y="-7899.71" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2456.32" y="-7888.71" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2456.32" y="-7877.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2456.32" y="-7866.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_attn_gpu5&#45;&gt;layer_8_attn_out_gpu5 -->
<g id="edge711" class="edge">
<title>layer_8_attn_gpu5&#45;&gt;layer_8_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2456.32,-7947.37C2456.32,-7939.41 2456.32,-7930.48 2456.32,-7921.96"/>
<polygon fill="black" stroke="black" points="2459.82,-7921.87 2456.32,-7911.87 2452.82,-7921.87 2459.82,-7921.87"/>
</g>
<!-- layer_8_attn_out_gpu6 -->
<g id="node524" class="node">
<title>layer_8_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2795.32,-7911.71 2581.32,-7911.71 2581.32,-7859.71 2795.32,-7859.71 2795.32,-7911.71"/>
<text text-anchor="middle" x="2688.32" y="-7899.71" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2688.32" y="-7888.71" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2688.32" y="-7877.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2688.32" y="-7866.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_attn_gpu6&#45;&gt;layer_8_attn_out_gpu6 -->
<g id="edge712" class="edge">
<title>layer_8_attn_gpu6&#45;&gt;layer_8_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2687.62,-7947.37C2687.71,-7939.41 2687.81,-7930.48 2687.91,-7921.96"/>
<polygon fill="black" stroke="black" points="2691.41,-7921.91 2688.03,-7911.87 2684.41,-7921.83 2691.41,-7921.91"/>
</g>
<!-- layer_8_attn_out_gpu7 -->
<g id="node525" class="node">
<title>layer_8_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3027.32,-7911.71 2813.32,-7911.71 2813.32,-7859.71 3027.32,-7859.71 3027.32,-7911.71"/>
<text text-anchor="middle" x="2920.32" y="-7899.71" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2920.32" y="-7888.71" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2920.32" y="-7877.71" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2920.32" y="-7866.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_attn_gpu7&#45;&gt;layer_8_attn_out_gpu7 -->
<g id="edge713" class="edge">
<title>layer_8_attn_gpu7&#45;&gt;layer_8_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2918.2,-7947.37C2918.48,-7939.41 2918.79,-7930.48 2919.09,-7921.96"/>
<polygon fill="black" stroke="black" points="2922.59,-7921.98 2919.44,-7911.87 2915.6,-7921.74 2922.59,-7921.98"/>
</g>
<!-- layer_8_attn_allreduce -->
<g id="node526" class="node">
<title>layer_8_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2572.32" cy="-7786.94" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2572.32" y="-7800.94" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2572.32" y="-7789.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2572.32" y="-7778.94" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2572.32" y="-7767.94" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_attn_out_gpu4&#45;&gt;layer_8_attn_allreduce -->
<g id="edge714" class="edge">
<title>layer_8_attn_out_gpu4&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M2314.39,-7859.67C2360.36,-7846.88 2416.61,-7831.24 2464.84,-7817.83"/>
<polygon fill="black" stroke="black" points="2465.99,-7821.14 2474.69,-7815.09 2464.11,-7814.4 2465.99,-7821.14"/>
</g>
<!-- layer_8_attn_out_gpu5&#45;&gt;layer_8_attn_allreduce -->
<g id="edge715" class="edge">
<title>layer_8_attn_out_gpu5&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M2486.5,-7859.54C2497.73,-7850.17 2510.78,-7839.28 2523.26,-7828.87"/>
<polygon fill="black" stroke="black" points="2525.51,-7831.55 2530.94,-7822.46 2521.02,-7826.18 2525.51,-7831.55"/>
</g>
<!-- layer_8_attn_out_gpu6&#45;&gt;layer_8_attn_allreduce -->
<g id="edge716" class="edge">
<title>layer_8_attn_out_gpu6&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M2658.15,-7859.54C2646.92,-7850.17 2633.86,-7839.28 2621.38,-7828.87"/>
<polygon fill="black" stroke="black" points="2623.62,-7826.18 2613.7,-7822.46 2619.13,-7831.55 2623.62,-7826.18"/>
</g>
<!-- layer_8_attn_out_gpu7&#45;&gt;layer_8_attn_allreduce -->
<g id="edge717" class="edge">
<title>layer_8_attn_out_gpu7&#45;&gt;layer_8_attn_allreduce</title>
<path fill="none" stroke="black" d="M2830.25,-7859.67C2784.28,-7846.88 2728.03,-7831.24 2679.8,-7817.83"/>
<polygon fill="black" stroke="black" points="2680.53,-7814.4 2669.96,-7815.09 2678.65,-7821.14 2680.53,-7814.4"/>
</g>
<!-- layer_8_gate -->
<g id="node527" class="node">
<title>layer_8_gate</title>
<polygon fill="lightyellow" stroke="black" points="2789.18,-7714.17 2444.2,-7714.17 2355.46,-7610.17 2700.44,-7610.17 2789.18,-7714.17"/>
<text text-anchor="middle" x="2572.32" y="-7676.17" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2572.32" y="-7665.17" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2572.32" y="-7654.17" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2572.32" y="-7643.17" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_8_attn_allreduce&#45;&gt;layer_8_gate -->
<g id="edge718" class="edge">
<title>layer_8_attn_allreduce&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2553.76,-7750.43C2552.65,-7742.39 2552.08,-7733.62 2552.07,-7724.85"/>
<polygon fill="black" stroke="black" points="2555.58,-7724.66 2552.31,-7714.59 2548.58,-7724.5 2555.58,-7724.66"/>
</g>
<!-- layer_8_attn_allreduce&#45;&gt;layer_8_gate -->
<g id="edge719" class="edge">
<title>layer_8_attn_allreduce&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2566.12,-7750.1C2565.75,-7742.07 2565.57,-7733.32 2565.57,-7724.57"/>
<polygon fill="black" stroke="black" points="2569.07,-7724.37 2565.65,-7714.34 2562.07,-7724.31 2569.07,-7724.37"/>
</g>
<!-- layer_8_attn_allreduce&#45;&gt;layer_8_gate -->
<g id="edge720" class="edge">
<title>layer_8_attn_allreduce&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2578.52,-7750.1C2578.89,-7742.07 2579.07,-7733.32 2579.07,-7724.57"/>
<polygon fill="black" stroke="black" points="2582.57,-7724.31 2578.99,-7714.34 2575.57,-7724.37 2582.57,-7724.31"/>
</g>
<!-- layer_8_attn_allreduce&#45;&gt;layer_8_gate -->
<g id="edge721" class="edge">
<title>layer_8_attn_allreduce&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2590.88,-7750.43C2591.99,-7742.39 2592.56,-7733.62 2592.57,-7724.85"/>
<polygon fill="black" stroke="black" points="2596.06,-7724.5 2592.33,-7714.59 2589.07,-7724.66 2596.06,-7724.5"/>
</g>
<!-- layer_8_all2all_expert_0 -->
<g id="node529" class="node">
<title>layer_8_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="189.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="189.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="189.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="189.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="189.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_0 -->
<g id="edge722" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2396.28,-7658.04C1944.66,-7649.41 752.96,-7622.62 360.32,-7574.17 342.2,-7571.94 323.16,-7568.78 304.61,-7565.25"/>
<polygon fill="black" stroke="black" points="305.16,-7561.79 294.67,-7563.31 303.82,-7568.66 305.16,-7561.79"/>
</g>
<!-- layer_8_all2all_expert_1 -->
<g id="node531" class="node">
<title>layer_8_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="517.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="517.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="517.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="517.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="517.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_1 -->
<g id="edge724" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.21,-7656.85C1990.83,-7646.35 1009.32,-7617.17 681.32,-7574.17 664.9,-7572.02 647.68,-7569.06 630.83,-7565.76"/>
<polygon fill="black" stroke="black" points="631.46,-7562.31 620.97,-7563.77 630.08,-7569.17 631.46,-7562.31"/>
</g>
<!-- layer_8_all2all_expert_2 -->
<g id="node533" class="node">
<title>layer_8_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="838.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="838.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="838.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="838.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="838.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_2 -->
<g id="edge726" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.49,-7660.89C2107.41,-7658.34 1503.57,-7644.13 998.32,-7574.17 982.79,-7572.02 966.54,-7569.14 950.6,-7565.95"/>
<polygon fill="black" stroke="black" points="951.22,-7562.5 940.72,-7563.92 949.81,-7569.36 951.22,-7562.5"/>
</g>
<!-- layer_8_all2all_expert_3 -->
<g id="node535" class="node">
<title>layer_8_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1155.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1155.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1155.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1155.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1155.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_3 -->
<g id="edge728" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.62,-7657.42C2151.38,-7650.32 1697.34,-7630.17 1314.32,-7574.17 1299.28,-7571.97 1283.55,-7569.12 1268.08,-7565.99"/>
<polygon fill="black" stroke="black" points="1268.46,-7562.49 1257.96,-7563.89 1267.04,-7569.35 1268.46,-7562.49"/>
</g>
<!-- layer_8_all2all_expert_4 -->
<g id="node537" class="node">
<title>layer_8_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1471.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1471.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1471.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1471.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1471.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_4 -->
<g id="edge730" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2390.67,-7651.48C2200.13,-7639.66 1892.38,-7615.9 1629.32,-7574.17 1614.74,-7571.86 1599.49,-7568.99 1584.47,-7565.89"/>
<polygon fill="black" stroke="black" points="1585.14,-7562.46 1574.63,-7563.83 1583.7,-7569.31 1585.14,-7562.46"/>
</g>
<!-- layer_8_all2all_expert_5 -->
<g id="node539" class="node">
<title>layer_8_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1786.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1786.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1786.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1786.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1786.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_5 -->
<g id="edge732" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2379.97,-7638.95C2255.09,-7623.44 2089.04,-7600.8 1943.32,-7574.17 1929.47,-7571.64 1914.99,-7568.72 1900.66,-7565.66"/>
<polygon fill="black" stroke="black" points="1901.29,-7562.22 1890.78,-7563.53 1899.82,-7569.06 1901.29,-7562.22"/>
</g>
<!-- layer_8_all2all_expert_6 -->
<g id="node541" class="node">
<title>layer_8_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2100.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2100.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2100.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2100.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2100.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_6 -->
<g id="edge734" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2375.91,-7610.09C2319.31,-7595.36 2259.59,-7579.83 2210.27,-7567"/>
<polygon fill="black" stroke="black" points="2211.1,-7563.6 2200.54,-7564.47 2209.34,-7570.38 2211.1,-7563.6"/>
</g>
<!-- layer_8_all2all_expert_7 -->
<g id="node543" class="node">
<title>layer_8_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2414.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2414.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2414.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2414.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2414.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_7 -->
<g id="edge736" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2506.23,-7609.82C2493.05,-7599.58 2479.38,-7588.95 2466.73,-7579.13"/>
<polygon fill="black" stroke="black" points="2468.63,-7576.17 2458.59,-7572.8 2464.34,-7581.7 2468.63,-7576.17"/>
</g>
<!-- layer_8_all2all_expert_8 -->
<g id="node545" class="node">
<title>layer_8_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2730.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2730.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2730.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2730.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2730.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_8 -->
<g id="edge738" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2638.41,-7609.82C2651.59,-7599.58 2665.26,-7588.95 2677.91,-7579.13"/>
<polygon fill="black" stroke="black" points="2680.3,-7581.7 2686.05,-7572.8 2676.01,-7576.17 2680.3,-7581.7"/>
</g>
<!-- layer_8_all2all_expert_9 -->
<g id="node547" class="node">
<title>layer_8_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3048.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3048.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3048.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3048.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3048.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_9 -->
<g id="edge740" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2713.2,-7624.84C2784.93,-7606.34 2870.86,-7584.17 2937.74,-7566.92"/>
<polygon fill="black" stroke="black" points="2938.66,-7570.3 2947.47,-7564.41 2936.91,-7563.52 2938.66,-7570.3"/>
</g>
<!-- layer_8_all2all_expert_10 -->
<g id="node549" class="node">
<title>layer_8_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3368.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3368.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3368.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3368.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3368.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_10 -->
<g id="edge742" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2728.94,-7643.16C2857.38,-7627.55 3043.69,-7602.97 3205.32,-7574.17 3220.41,-7571.48 3236.23,-7568.38 3251.82,-7565.14"/>
<polygon fill="black" stroke="black" points="3252.96,-7568.48 3262.03,-7563 3251.53,-7561.63 3252.96,-7568.48"/>
</g>
<!-- layer_8_all2all_expert_11 -->
<g id="node551" class="node">
<title>layer_8_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3688.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3688.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3688.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3688.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3688.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_11 -->
<g id="edge744" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2736.66,-7652.43C2927.19,-7640.84 3250.31,-7616.73 3525.32,-7574.17 3540.97,-7571.75 3557.37,-7568.73 3573.48,-7565.48"/>
<polygon fill="black" stroke="black" points="3574.37,-7568.87 3583.46,-7563.43 3572.96,-7562.02 3574.37,-7568.87"/>
</g>
<!-- layer_8_all2all_expert_12 -->
<g id="node553" class="node">
<title>layer_8_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4009.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4009.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4009.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4009.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4009.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_12 -->
<g id="edge746" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2740.97,-7657.5C2985.49,-7650.4 3452.21,-7630.17 3845.32,-7574.17 3861.45,-7571.88 3878.35,-7568.88 3894.92,-7565.59"/>
<polygon fill="black" stroke="black" points="3896.08,-7568.93 3905.19,-7563.51 3894.69,-7562.07 3896.08,-7568.93"/>
</g>
<!-- layer_8_all2all_expert_13 -->
<g id="node555" class="node">
<title>layer_8_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4330.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4330.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4330.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4330.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4330.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_13 -->
<g id="edge748" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2743.9,-7660.79C3036.89,-7658.14 3651.89,-7643.86 4166.32,-7574.17 4182.74,-7571.95 4199.95,-7568.95 4216.79,-7565.63"/>
<polygon fill="black" stroke="black" points="4217.55,-7569.05 4226.66,-7563.64 4216.16,-7562.18 4217.55,-7569.05"/>
</g>
<!-- layer_8_all2all_expert_14 -->
<g id="node557" class="node">
<title>layer_8_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4651.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4651.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4651.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4651.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4651.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_14 -->
<g id="edge750" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2740.76,-7657.18C3143.24,-7647.06 4152.17,-7618.01 4487.32,-7574.17 4503.75,-7572.02 4520.96,-7569.07 4537.81,-7565.76"/>
<polygon fill="black" stroke="black" points="4538.56,-7569.18 4547.68,-7563.78 4537.18,-7562.32 4538.56,-7569.18"/>
</g>
<!-- layer_8_all2all_expert_15 -->
<g id="node559" class="node">
<title>layer_8_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4972.32" cy="-7537.4" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4972.32" y="-7551.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4972.32" y="-7540.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4972.32" y="-7529.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4972.32" y="-7518.4" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_all2all_expert_15 -->
<g id="edge752" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.66,-7658.44C3191.48,-7650.57 4409.1,-7625.07 4808.32,-7574.17 4824.87,-7572.06 4842.23,-7569.11 4859.19,-7565.79"/>
<polygon fill="black" stroke="black" points="4860.01,-7569.19 4869.13,-7563.8 4858.64,-7562.33 4860.01,-7569.19"/>
</g>
<!-- layer_8_expert_0_gpu8 -->
<g id="node528" class="node">
<title>layer_8_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="269.82,-7464.63 60.82,-7464.63 60.82,-7412.63 269.82,-7412.63 269.82,-7464.63"/>
<text text-anchor="middle" x="165.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="165.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="165.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="165.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_0 -->
<g id="node560" class="node">
<title>layer_8_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="163.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="163.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="163.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="163.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="163.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_0_gpu8&#45;&gt;layer_8_all2all_back_0 -->
<g id="edge754" class="edge">
<title>layer_8_expert_0_gpu8&#45;&gt;layer_8_all2all_back_0</title>
<path fill="none" stroke="black" d="M164.8,-7412.46C164.64,-7404.65 164.46,-7395.79 164.27,-7387.02"/>
<polygon fill="black" stroke="black" points="167.77,-7386.77 164.06,-7376.84 160.77,-7386.91 167.77,-7386.77"/>
</g>
<!-- layer_8_all2all_expert_0&#45;&gt;layer_8_expert_0_gpu8 -->
<g id="edge723" class="edge">
<title>layer_8_all2all_expert_0&#45;&gt;layer_8_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M180.45,-7500.65C178.34,-7492.15 176.1,-7483.09 174,-7474.63"/>
<polygon fill="black" stroke="black" points="177.34,-7473.54 171.53,-7464.68 170.54,-7475.23 177.34,-7473.54"/>
</g>
<!-- layer_8_expert_1_gpu8 -->
<g id="node530" class="node">
<title>layer_8_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="600.82,-7464.63 391.82,-7464.63 391.82,-7412.63 600.82,-7412.63 600.82,-7464.63"/>
<text text-anchor="middle" x="496.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="496.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="496.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="496.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_1 -->
<g id="node561" class="node">
<title>layer_8_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="484.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="484.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="484.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="484.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="484.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_1_gpu8&#45;&gt;layer_8_all2all_back_1 -->
<g id="edge755" class="edge">
<title>layer_8_expert_1_gpu8&#45;&gt;layer_8_all2all_back_1</title>
<path fill="none" stroke="black" d="M493.2,-7412.46C492.23,-7404.65 491.13,-7395.79 490.04,-7387.02"/>
<polygon fill="black" stroke="black" points="493.49,-7386.33 488.78,-7376.84 486.54,-7387.2 493.49,-7386.33"/>
</g>
<!-- layer_8_all2all_expert_1&#45;&gt;layer_8_expert_1_gpu8 -->
<g id="edge725" class="edge">
<title>layer_8_all2all_expert_1&#45;&gt;layer_8_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M509.56,-7500.65C507.72,-7492.15 505.75,-7483.09 503.92,-7474.63"/>
<polygon fill="black" stroke="black" points="507.3,-7473.71 501.76,-7464.68 500.46,-7475.19 507.3,-7473.71"/>
</g>
<!-- layer_8_expert_2_gpu9 -->
<g id="node532" class="node">
<title>layer_8_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="925.82,-7464.63 716.82,-7464.63 716.82,-7412.63 925.82,-7412.63 925.82,-7464.63"/>
<text text-anchor="middle" x="821.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="821.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="821.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="821.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_2 -->
<g id="node562" class="node">
<title>layer_8_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="805.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="805.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="805.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="805.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="805.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_2_gpu9&#45;&gt;layer_8_all2all_back_2 -->
<g id="edge756" class="edge">
<title>layer_8_expert_2_gpu9&#45;&gt;layer_8_all2all_back_2</title>
<path fill="none" stroke="black" d="M817.16,-7412.46C815.85,-7404.57 814.37,-7395.59 812.9,-7386.73"/>
<polygon fill="black" stroke="black" points="816.35,-7386.14 811.27,-7376.84 809.45,-7387.28 816.35,-7386.14"/>
</g>
<!-- layer_8_all2all_expert_2&#45;&gt;layer_8_expert_2_gpu9 -->
<g id="edge727" class="edge">
<title>layer_8_all2all_expert_2&#45;&gt;layer_8_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M832.04,-7500.65C830.55,-7492.15 828.96,-7483.09 827.47,-7474.63"/>
<polygon fill="black" stroke="black" points="830.9,-7473.92 825.72,-7464.68 824,-7475.13 830.9,-7473.92"/>
</g>
<!-- layer_8_expert_3_gpu9 -->
<g id="node534" class="node">
<title>layer_8_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1244.82,-7464.63 1035.82,-7464.63 1035.82,-7412.63 1244.82,-7412.63 1244.82,-7464.63"/>
<text text-anchor="middle" x="1140.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1140.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1140.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1140.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_3 -->
<g id="node563" class="node">
<title>layer_8_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1126.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1126.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1126.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1126.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1126.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_3_gpu9&#45;&gt;layer_8_all2all_back_3 -->
<g id="edge757" class="edge">
<title>layer_8_expert_3_gpu9&#45;&gt;layer_8_all2all_back_3</title>
<path fill="none" stroke="black" d="M1136.68,-7412.46C1135.55,-7404.65 1134.27,-7395.79 1133,-7387.02"/>
<polygon fill="black" stroke="black" points="1136.42,-7386.24 1131.53,-7376.84 1129.49,-7387.24 1136.42,-7386.24"/>
</g>
<!-- layer_8_all2all_expert_3&#45;&gt;layer_8_expert_3_gpu9 -->
<g id="edge729" class="edge">
<title>layer_8_all2all_expert_3&#45;&gt;layer_8_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1149.78,-7500.65C1148.46,-7492.15 1147.06,-7483.09 1145.75,-7474.63"/>
<polygon fill="black" stroke="black" points="1149.19,-7474.02 1144.2,-7464.68 1142.28,-7475.1 1149.19,-7474.02"/>
</g>
<!-- layer_8_expert_4_gpu10 -->
<g id="node536" class="node">
<title>layer_8_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1565.82,-7464.63 1356.82,-7464.63 1356.82,-7412.63 1565.82,-7412.63 1565.82,-7464.63"/>
<text text-anchor="middle" x="1461.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1461.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1461.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1461.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_4 -->
<g id="node564" class="node">
<title>layer_8_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1447.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1447.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1447.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1447.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1447.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_4_gpu10&#45;&gt;layer_8_all2all_back_4 -->
<g id="edge758" class="edge">
<title>layer_8_expert_4_gpu10&#45;&gt;layer_8_all2all_back_4</title>
<path fill="none" stroke="black" d="M1457.68,-7412.46C1456.55,-7404.65 1455.27,-7395.79 1454,-7387.02"/>
<polygon fill="black" stroke="black" points="1457.42,-7386.24 1452.53,-7376.84 1450.49,-7387.24 1457.42,-7386.24"/>
</g>
<!-- layer_8_all2all_expert_4&#45;&gt;layer_8_expert_4_gpu10 -->
<g id="edge731" class="edge">
<title>layer_8_all2all_expert_4&#45;&gt;layer_8_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1467.63,-7500.65C1466.75,-7492.15 1465.81,-7483.09 1464.94,-7474.63"/>
<polygon fill="black" stroke="black" points="1468.42,-7474.26 1463.91,-7464.68 1461.46,-7474.98 1468.42,-7474.26"/>
</g>
<!-- layer_8_expert_5_gpu10 -->
<g id="node538" class="node">
<title>layer_8_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1880.82,-7464.63 1671.82,-7464.63 1671.82,-7412.63 1880.82,-7412.63 1880.82,-7464.63"/>
<text text-anchor="middle" x="1776.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1776.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1776.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1776.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_5 -->
<g id="node565" class="node">
<title>layer_8_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1768.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1768.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1768.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1768.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1768.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_5_gpu10&#45;&gt;layer_8_all2all_back_5 -->
<g id="edge759" class="edge">
<title>layer_8_expert_5_gpu10&#45;&gt;layer_8_all2all_back_5</title>
<path fill="none" stroke="black" d="M1774.24,-7412.46C1773.59,-7404.65 1772.86,-7395.79 1772.14,-7387.02"/>
<polygon fill="black" stroke="black" points="1775.61,-7386.52 1771.3,-7376.84 1768.63,-7387.1 1775.61,-7386.52"/>
</g>
<!-- layer_8_all2all_expert_5&#45;&gt;layer_8_expert_5_gpu10 -->
<g id="edge733" class="edge">
<title>layer_8_all2all_expert_5&#45;&gt;layer_8_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1782.63,-7500.65C1781.75,-7492.15 1780.81,-7483.09 1779.94,-7474.63"/>
<polygon fill="black" stroke="black" points="1783.42,-7474.26 1778.91,-7464.68 1776.46,-7474.98 1783.42,-7474.26"/>
</g>
<!-- layer_8_expert_6_gpu11 -->
<g id="node540" class="node">
<title>layer_8_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2201.82,-7464.63 1992.82,-7464.63 1992.82,-7412.63 2201.82,-7412.63 2201.82,-7464.63"/>
<text text-anchor="middle" x="2097.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2097.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2097.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2097.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_6 -->
<g id="node566" class="node">
<title>layer_8_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2089.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2089.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2089.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2089.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2089.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_6_gpu11&#45;&gt;layer_8_all2all_back_6 -->
<g id="edge760" class="edge">
<title>layer_8_expert_6_gpu11&#45;&gt;layer_8_all2all_back_6</title>
<path fill="none" stroke="black" d="M2095.24,-7412.46C2094.59,-7404.65 2093.86,-7395.79 2093.14,-7387.02"/>
<polygon fill="black" stroke="black" points="2096.61,-7386.52 2092.3,-7376.84 2089.63,-7387.1 2096.61,-7386.52"/>
</g>
<!-- layer_8_all2all_expert_6&#45;&gt;layer_8_expert_6_gpu11 -->
<g id="edge735" class="edge">
<title>layer_8_all2all_expert_6&#45;&gt;layer_8_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2099.2,-7500.37C2098.95,-7492.06 2098.67,-7483.22 2098.42,-7474.94"/>
<polygon fill="black" stroke="black" points="2101.91,-7474.72 2098.1,-7464.83 2094.91,-7474.93 2101.91,-7474.72"/>
</g>
<!-- layer_8_expert_7_gpu11 -->
<g id="node542" class="node">
<title>layer_8_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2515.82,-7464.63 2306.82,-7464.63 2306.82,-7412.63 2515.82,-7412.63 2515.82,-7464.63"/>
<text text-anchor="middle" x="2411.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2411.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2411.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2411.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_7 -->
<g id="node567" class="node">
<title>layer_8_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2410.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2410.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2410.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2410.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2410.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_7_gpu11&#45;&gt;layer_8_all2all_back_7 -->
<g id="edge761" class="edge">
<title>layer_8_expert_7_gpu11&#45;&gt;layer_8_all2all_back_7</title>
<path fill="none" stroke="black" d="M2411.06,-7412.46C2410.98,-7404.65 2410.89,-7395.79 2410.8,-7387.02"/>
<polygon fill="black" stroke="black" points="2414.3,-7386.8 2410.69,-7376.84 2407.3,-7386.88 2414.3,-7386.8"/>
</g>
<!-- layer_8_all2all_expert_7&#45;&gt;layer_8_expert_7_gpu11 -->
<g id="edge737" class="edge">
<title>layer_8_all2all_expert_7&#45;&gt;layer_8_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2413.2,-7500.37C2412.95,-7492.06 2412.67,-7483.22 2412.42,-7474.94"/>
<polygon fill="black" stroke="black" points="2415.91,-7474.72 2412.1,-7464.83 2408.91,-7474.93 2415.91,-7474.72"/>
</g>
<!-- layer_8_expert_8_gpu12 -->
<g id="node544" class="node">
<title>layer_8_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2834.82,-7464.63 2625.82,-7464.63 2625.82,-7412.63 2834.82,-7412.63 2834.82,-7464.63"/>
<text text-anchor="middle" x="2730.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2730.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2730.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2730.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_8 -->
<g id="node568" class="node">
<title>layer_8_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2731.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2731.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2731.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2731.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2731.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_8_gpu12&#45;&gt;layer_8_all2all_back_8 -->
<g id="edge762" class="edge">
<title>layer_8_expert_8_gpu12&#45;&gt;layer_8_all2all_back_8</title>
<path fill="none" stroke="black" d="M2730.58,-7412.46C2730.66,-7404.65 2730.75,-7395.79 2730.84,-7387.02"/>
<polygon fill="black" stroke="black" points="2734.35,-7386.88 2730.95,-7376.84 2727.35,-7386.8 2734.35,-7386.88"/>
</g>
<!-- layer_8_all2all_expert_8&#45;&gt;layer_8_expert_8_gpu12 -->
<g id="edge739" class="edge">
<title>layer_8_all2all_expert_8&#45;&gt;layer_8_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2730.32,-7500.37C2730.32,-7492.06 2730.32,-7483.22 2730.32,-7474.94"/>
<polygon fill="black" stroke="black" points="2733.82,-7474.83 2730.32,-7464.83 2726.82,-7474.83 2733.82,-7474.83"/>
</g>
<!-- layer_8_expert_9_gpu12 -->
<g id="node546" class="node">
<title>layer_8_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3154.82,-7464.63 2945.82,-7464.63 2945.82,-7412.63 3154.82,-7412.63 3154.82,-7464.63"/>
<text text-anchor="middle" x="3050.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3050.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3050.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3050.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_9 -->
<g id="node569" class="node">
<title>layer_8_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3052.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3052.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3052.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3052.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3052.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_9_gpu12&#45;&gt;layer_8_all2all_back_9 -->
<g id="edge763" class="edge">
<title>layer_8_expert_9_gpu12&#45;&gt;layer_8_all2all_back_9</title>
<path fill="none" stroke="black" d="M3050.84,-7412.46C3051,-7404.65 3051.19,-7395.79 3051.37,-7387.02"/>
<polygon fill="black" stroke="black" points="3054.87,-7386.91 3051.58,-7376.84 3047.87,-7386.77 3054.87,-7386.91"/>
</g>
<!-- layer_8_all2all_expert_9&#45;&gt;layer_8_expert_9_gpu12 -->
<g id="edge741" class="edge">
<title>layer_8_all2all_expert_9&#45;&gt;layer_8_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3049.07,-7500.37C3049.24,-7492.06 3049.42,-7483.22 3049.59,-7474.94"/>
<polygon fill="black" stroke="black" points="3053.09,-7474.9 3049.8,-7464.83 3046.09,-7474.76 3053.09,-7474.9"/>
</g>
<!-- layer_8_expert_10_gpu13 -->
<g id="node548" class="node">
<title>layer_8_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3474.82,-7464.63 3265.82,-7464.63 3265.82,-7412.63 3474.82,-7412.63 3474.82,-7464.63"/>
<text text-anchor="middle" x="3370.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3370.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3370.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3370.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_10 -->
<g id="node570" class="node">
<title>layer_8_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3373.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3373.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3373.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3373.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3373.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_10_gpu13&#45;&gt;layer_8_all2all_back_10 -->
<g id="edge764" class="edge">
<title>layer_8_expert_10_gpu13&#45;&gt;layer_8_all2all_back_10</title>
<path fill="none" stroke="black" d="M3371.1,-7412.46C3371.34,-7404.65 3371.62,-7395.79 3371.89,-7387.02"/>
<polygon fill="black" stroke="black" points="3375.39,-7386.94 3372.21,-7376.84 3368.4,-7386.73 3375.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_10&#45;&gt;layer_8_expert_10_gpu13 -->
<g id="edge743" class="edge">
<title>layer_8_all2all_expert_10&#45;&gt;layer_8_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3369.07,-7500.37C3369.24,-7492.06 3369.42,-7483.22 3369.59,-7474.94"/>
<polygon fill="black" stroke="black" points="3373.09,-7474.9 3369.8,-7464.83 3366.09,-7474.76 3373.09,-7474.9"/>
</g>
<!-- layer_8_expert_11_gpu13 -->
<g id="node550" class="node">
<title>layer_8_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3795.82,-7464.63 3586.82,-7464.63 3586.82,-7412.63 3795.82,-7412.63 3795.82,-7464.63"/>
<text text-anchor="middle" x="3691.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3691.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3691.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3691.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_11 -->
<g id="node571" class="node">
<title>layer_8_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3694.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3694.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3694.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3694.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3694.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_11_gpu13&#45;&gt;layer_8_all2all_back_11 -->
<g id="edge765" class="edge">
<title>layer_8_expert_11_gpu13&#45;&gt;layer_8_all2all_back_11</title>
<path fill="none" stroke="black" d="M3692.1,-7412.46C3692.34,-7404.65 3692.62,-7395.79 3692.89,-7387.02"/>
<polygon fill="black" stroke="black" points="3696.39,-7386.94 3693.21,-7376.84 3689.4,-7386.73 3696.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_11&#45;&gt;layer_8_expert_11_gpu13 -->
<g id="edge745" class="edge">
<title>layer_8_all2all_expert_11&#45;&gt;layer_8_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3689.44,-7500.37C3689.7,-7492.06 3689.97,-7483.22 3690.23,-7474.94"/>
<polygon fill="black" stroke="black" points="3693.73,-7474.93 3690.54,-7464.83 3686.73,-7474.72 3693.73,-7474.93"/>
</g>
<!-- layer_8_expert_12_gpu14 -->
<g id="node552" class="node">
<title>layer_8_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4116.82,-7464.63 3907.82,-7464.63 3907.82,-7412.63 4116.82,-7412.63 4116.82,-7464.63"/>
<text text-anchor="middle" x="4012.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4012.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4012.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4012.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_12 -->
<g id="node572" class="node">
<title>layer_8_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4015.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4015.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4015.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4015.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4015.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_12_gpu14&#45;&gt;layer_8_all2all_back_12 -->
<g id="edge766" class="edge">
<title>layer_8_expert_12_gpu14&#45;&gt;layer_8_all2all_back_12</title>
<path fill="none" stroke="black" d="M4013.1,-7412.46C4013.34,-7404.65 4013.62,-7395.79 4013.89,-7387.02"/>
<polygon fill="black" stroke="black" points="4017.39,-7386.94 4014.21,-7376.84 4010.4,-7386.73 4017.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_12&#45;&gt;layer_8_expert_12_gpu14 -->
<g id="edge747" class="edge">
<title>layer_8_all2all_expert_12&#45;&gt;layer_8_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4010.44,-7500.37C4010.7,-7492.06 4010.97,-7483.22 4011.23,-7474.94"/>
<polygon fill="black" stroke="black" points="4014.73,-7474.93 4011.54,-7464.83 4007.73,-7474.72 4014.73,-7474.93"/>
</g>
<!-- layer_8_expert_13_gpu14 -->
<g id="node554" class="node">
<title>layer_8_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4437.82,-7464.63 4228.82,-7464.63 4228.82,-7412.63 4437.82,-7412.63 4437.82,-7464.63"/>
<text text-anchor="middle" x="4333.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4333.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4333.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4333.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_13 -->
<g id="node573" class="node">
<title>layer_8_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4336.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4336.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4336.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4336.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4336.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_13_gpu14&#45;&gt;layer_8_all2all_back_13 -->
<g id="edge767" class="edge">
<title>layer_8_expert_13_gpu14&#45;&gt;layer_8_all2all_back_13</title>
<path fill="none" stroke="black" d="M4334.1,-7412.46C4334.34,-7404.65 4334.62,-7395.79 4334.89,-7387.02"/>
<polygon fill="black" stroke="black" points="4338.39,-7386.94 4335.21,-7376.84 4331.4,-7386.73 4338.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_13&#45;&gt;layer_8_expert_13_gpu14 -->
<g id="edge749" class="edge">
<title>layer_8_all2all_expert_13&#45;&gt;layer_8_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4331.44,-7500.37C4331.7,-7492.06 4331.97,-7483.22 4332.23,-7474.94"/>
<polygon fill="black" stroke="black" points="4335.73,-7474.93 4332.54,-7464.83 4328.73,-7474.72 4335.73,-7474.93"/>
</g>
<!-- layer_8_expert_14_gpu15 -->
<g id="node556" class="node">
<title>layer_8_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4758.82,-7464.63 4549.82,-7464.63 4549.82,-7412.63 4758.82,-7412.63 4758.82,-7464.63"/>
<text text-anchor="middle" x="4654.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4654.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4654.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4654.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_14 -->
<g id="node574" class="node">
<title>layer_8_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4657.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4657.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4657.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4657.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4657.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_14_gpu15&#45;&gt;layer_8_all2all_back_14 -->
<g id="edge768" class="edge">
<title>layer_8_expert_14_gpu15&#45;&gt;layer_8_all2all_back_14</title>
<path fill="none" stroke="black" d="M4655.1,-7412.46C4655.34,-7404.65 4655.62,-7395.79 4655.89,-7387.02"/>
<polygon fill="black" stroke="black" points="4659.39,-7386.94 4656.21,-7376.84 4652.4,-7386.73 4659.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_14&#45;&gt;layer_8_expert_14_gpu15 -->
<g id="edge751" class="edge">
<title>layer_8_all2all_expert_14&#45;&gt;layer_8_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4652.44,-7500.37C4652.7,-7492.06 4652.97,-7483.22 4653.23,-7474.94"/>
<polygon fill="black" stroke="black" points="4656.73,-7474.93 4653.54,-7464.83 4649.73,-7474.72 4656.73,-7474.93"/>
</g>
<!-- layer_8_expert_15_gpu15 -->
<g id="node558" class="node">
<title>layer_8_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5079.82,-7464.63 4870.82,-7464.63 4870.82,-7412.63 5079.82,-7412.63 5079.82,-7464.63"/>
<text text-anchor="middle" x="4975.32" y="-7452.63" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4975.32" y="-7441.63" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4975.32" y="-7430.63" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4975.32" y="-7419.63" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_15 -->
<g id="node575" class="node">
<title>layer_8_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4978.32" cy="-7339.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4978.32" y="-7353.86" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4978.32" y="-7342.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4978.32" y="-7331.86" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4978.32" y="-7320.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_expert_15_gpu15&#45;&gt;layer_8_all2all_back_15 -->
<g id="edge769" class="edge">
<title>layer_8_expert_15_gpu15&#45;&gt;layer_8_all2all_back_15</title>
<path fill="none" stroke="black" d="M4976.1,-7412.46C4976.34,-7404.65 4976.62,-7395.79 4976.89,-7387.02"/>
<polygon fill="black" stroke="black" points="4980.39,-7386.94 4977.21,-7376.84 4973.4,-7386.73 4980.39,-7386.94"/>
</g>
<!-- layer_8_all2all_expert_15&#45;&gt;layer_8_expert_15_gpu15 -->
<g id="edge753" class="edge">
<title>layer_8_all2all_expert_15&#45;&gt;layer_8_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4973.44,-7500.37C4973.7,-7492.06 4973.97,-7483.22 4974.23,-7474.94"/>
<polygon fill="black" stroke="black" points="4977.73,-7474.93 4974.54,-7464.83 4970.73,-7474.72 4977.73,-7474.93"/>
</g>
<!-- layer_8_output -->
<g id="node576" class="node">
<title>layer_8_output</title>
<polygon fill="lightblue" stroke="black" points="2677.32,-7267.09 2463.32,-7267.09 2463.32,-7215.09 2677.32,-7215.09 2677.32,-7267.09"/>
<text text-anchor="middle" x="2570.32" y="-7255.09" font-family="Arial" font-size="10.00">Layer 8 Output</text>
<text text-anchor="middle" x="2570.32" y="-7244.09" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2570.32" y="-7233.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2570.32" y="-7222.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_8_all2all_back_0&#45;&gt;layer_8_output -->
<g id="edge770" class="edge">
<title>layer_8_all2all_back_0&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M266.31,-7312.92C285.48,-7308.96 305.42,-7305.43 324.32,-7303.09 742.21,-7251.48 2052.59,-7243.54 2452.96,-7242.32"/>
<polygon fill="black" stroke="black" points="2453.12,-7245.82 2463.11,-7242.29 2453.1,-7238.82 2453.12,-7245.82"/>
</g>
<!-- layer_8_all2all_back_1&#45;&gt;layer_8_output -->
<g id="edge771" class="edge">
<title>layer_8_all2all_back_1&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M587.75,-7312.9C606.79,-7308.97 626.57,-7305.45 645.32,-7303.09 997.84,-7258.75 2091.7,-7245.99 2453.1,-7242.94"/>
<polygon fill="black" stroke="black" points="2453.35,-7246.44 2463.32,-7242.85 2453.29,-7239.44 2453.35,-7246.44"/>
</g>
<!-- layer_8_all2all_back_2&#45;&gt;layer_8_output -->
<g id="edge772" class="edge">
<title>layer_8_all2all_back_2&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M908.76,-7313C927.8,-7309.06 947.58,-7305.51 966.32,-7303.09 1253.83,-7266 2133.45,-7248.91 2452.86,-7243.81"/>
<polygon fill="black" stroke="black" points="2453.12,-7247.31 2463.06,-7243.65 2453.01,-7240.31 2453.12,-7247.31"/>
</g>
<!-- layer_8_all2all_back_3&#45;&gt;layer_8_output -->
<g id="edge773" class="edge">
<title>layer_8_all2all_back_3&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M1230.21,-7313.06C1249.12,-7309.14 1268.73,-7305.58 1287.32,-7303.09 1510.45,-7273.23 2179.68,-7252.53 2452.55,-7245.11"/>
<polygon fill="black" stroke="black" points="2452.98,-7248.6 2462.88,-7244.83 2452.79,-7241.61 2452.98,-7248.6"/>
</g>
<!-- layer_8_all2all_back_4&#45;&gt;layer_8_output -->
<g id="edge774" class="edge">
<title>layer_8_all2all_back_4&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M1551.68,-7313.21C1570.45,-7309.3 1589.89,-7305.71 1608.32,-7303.09 1910.78,-7260.17 2271.05,-7247.45 2452.88,-7243.68"/>
<polygon fill="black" stroke="black" points="2453.07,-7247.17 2463,-7243.47 2452.93,-7240.18 2453.07,-7247.17"/>
</g>
<!-- layer_8_all2all_back_5&#45;&gt;layer_8_output -->
<g id="edge775" class="edge">
<title>layer_8_all2all_back_5&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M1874.05,-7313.42C1892.41,-7309.56 1911.36,-7305.93 1929.32,-7303.09 2111.01,-7274.38 2323.95,-7257.38 2452.91,-7248.89"/>
<polygon fill="black" stroke="black" points="2453.45,-7252.37 2463.2,-7248.22 2452.99,-7245.38 2453.45,-7252.37"/>
</g>
<!-- layer_8_all2all_back_6&#45;&gt;layer_8_output -->
<g id="edge776" class="edge">
<title>layer_8_all2all_back_6&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M2198.35,-7314.17C2215.71,-7310.38 2233.5,-7306.57 2250.32,-7303.09 2317.35,-7289.26 2392.51,-7274.88 2453.14,-7263.55"/>
<polygon fill="black" stroke="black" points="2453.94,-7266.96 2463.13,-7261.69 2452.66,-7260.08 2453.94,-7266.96"/>
</g>
<!-- layer_8_all2all_back_7&#45;&gt;layer_8_output -->
<g id="edge777" class="edge">
<title>layer_8_all2all_back_7&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M2465.38,-7305.56C2483.09,-7294.85 2502.6,-7283.05 2519.95,-7272.56"/>
<polygon fill="black" stroke="black" points="2522.06,-7275.37 2528.81,-7267.2 2518.44,-7269.38 2522.06,-7275.37"/>
</g>
<!-- layer_8_all2all_back_8&#45;&gt;layer_8_output -->
<g id="edge778" class="edge">
<title>layer_8_all2all_back_8&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M2675.91,-7305.56C2658.1,-7294.85 2638.46,-7283.05 2621,-7272.56"/>
<polygon fill="black" stroke="black" points="2622.47,-7269.35 2612.09,-7267.2 2618.86,-7275.35 2622.47,-7269.35"/>
</g>
<!-- layer_8_all2all_back_9&#45;&gt;layer_8_output -->
<g id="edge779" class="edge">
<title>layer_8_all2all_back_9&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M2943.3,-7314.17C2925.93,-7310.37 2908.15,-7306.56 2891.32,-7303.09 2823.96,-7289.21 2748.39,-7274.8 2687.51,-7263.47"/>
<polygon fill="black" stroke="black" points="2687.96,-7259.99 2677.48,-7261.6 2686.68,-7266.87 2687.96,-7259.99"/>
</g>
<!-- layer_8_all2all_back_10&#45;&gt;layer_8_output -->
<g id="edge780" class="edge">
<title>layer_8_all2all_back_10&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M3267.59,-7313.42C3249.24,-7309.56 3230.28,-7305.93 3212.32,-7303.09 3030.22,-7274.33 2816.76,-7257.33 2687.63,-7248.86"/>
<polygon fill="black" stroke="black" points="2687.53,-7245.35 2677.33,-7248.19 2687.08,-7252.33 2687.53,-7245.35"/>
</g>
<!-- layer_8_all2all_back_11&#45;&gt;layer_8_output -->
<g id="edge781" class="edge">
<title>layer_8_all2all_back_11&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M3589.96,-7313.21C3571.2,-7309.3 3551.75,-7305.71 3533.32,-7303.09 3230.34,-7260.11 2869.42,-7247.41 2687.52,-7243.66"/>
<polygon fill="black" stroke="black" points="2687.46,-7240.16 2677.39,-7243.46 2687.32,-7247.16 2687.46,-7240.16"/>
</g>
<!-- layer_8_all2all_back_12&#45;&gt;layer_8_output -->
<g id="edge782" class="edge">
<title>layer_8_all2all_back_12&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M3911.43,-7313.05C3892.53,-7309.14 3872.91,-7305.58 3854.32,-7303.09 3630.88,-7273.19 2960.45,-7252.5 2687.68,-7245.1"/>
<polygon fill="black" stroke="black" points="2687.45,-7241.59 2677.36,-7244.82 2687.26,-7248.59 2687.45,-7241.59"/>
</g>
<!-- layer_8_all2all_back_13&#45;&gt;layer_8_output -->
<g id="edge783" class="edge">
<title>layer_8_all2all_back_13&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M4232.88,-7313C4213.84,-7309.06 4194.06,-7305.51 4175.32,-7303.09 3887.54,-7265.97 3006.94,-7248.89 2687.57,-7243.8"/>
<polygon fill="black" stroke="black" points="2687.42,-7240.3 2677.37,-7243.64 2687.31,-7247.3 2687.42,-7240.3"/>
</g>
<!-- layer_8_all2all_back_14&#45;&gt;layer_8_output -->
<g id="edge784" class="edge">
<title>layer_8_all2all_back_14&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M4553.89,-7312.9C4534.85,-7308.97 4515.07,-7305.45 4496.32,-7303.09 4143.62,-7258.73 3049.19,-7245.98 2687.6,-7242.94"/>
<polygon fill="black" stroke="black" points="2687.41,-7239.43 2677.38,-7242.85 2687.35,-7246.43 2687.41,-7239.43"/>
</g>
<!-- layer_8_all2all_back_15&#45;&gt;layer_8_output -->
<g id="edge785" class="edge">
<title>layer_8_all2all_back_15&#45;&gt;layer_8_output</title>
<path fill="none" stroke="black" d="M4875.33,-7312.92C4856.16,-7308.96 4836.22,-7305.43 4817.32,-7303.09 4399.25,-7251.46 3088.28,-7243.53 2687.73,-7242.32"/>
<polygon fill="black" stroke="black" points="2687.59,-7238.82 2677.58,-7242.29 2687.57,-7245.82 2687.59,-7238.82"/>
</g>
<!-- layer_9_tp_gather -->
<g id="node578" class="node">
<title>layer_9_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2570.32" cy="-7142.33" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2570.32" y="-7156.33" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2570.32" y="-7145.33" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2570.32" y="-7134.33" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2570.32" y="-7123.33" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_8_output&#45;&gt;layer_9_tp_gather -->
<g id="edge786" class="edge">
<title>layer_8_output&#45;&gt;layer_9_tp_gather</title>
<path fill="none" stroke="black" d="M2552.3,-7214.92C2550.64,-7206.95 2549.91,-7197.87 2550.1,-7188.92"/>
<polygon fill="black" stroke="black" points="2553.59,-7189.13 2550.71,-7178.94 2546.61,-7188.7 2553.59,-7189.13"/>
</g>
<!-- layer_8_output&#45;&gt;layer_9_tp_gather -->
<g id="edge788" class="edge">
<title>layer_8_output&#45;&gt;layer_9_tp_gather</title>
<path fill="none" stroke="black" d="M2564.32,-7214.92C2563.77,-7207.11 2563.53,-7198.25 2563.58,-7189.48"/>
<polygon fill="black" stroke="black" points="2567.08,-7189.37 2563.77,-7179.3 2560.08,-7189.23 2567.08,-7189.37"/>
</g>
<!-- layer_8_output&#45;&gt;layer_9_tp_gather -->
<g id="edge790" class="edge">
<title>layer_8_output&#45;&gt;layer_9_tp_gather</title>
<path fill="none" stroke="black" d="M2576.33,-7214.92C2576.87,-7207.11 2577.11,-7198.25 2577.06,-7189.48"/>
<polygon fill="black" stroke="black" points="2580.56,-7189.23 2576.87,-7179.3 2573.56,-7189.37 2580.56,-7189.23"/>
</g>
<!-- layer_8_output&#45;&gt;layer_9_tp_gather -->
<g id="edge792" class="edge">
<title>layer_8_output&#45;&gt;layer_9_tp_gather</title>
<path fill="none" stroke="black" d="M2588.34,-7214.92C2590,-7206.95 2590.73,-7197.87 2590.54,-7188.92"/>
<polygon fill="black" stroke="black" points="2594.03,-7188.7 2589.93,-7178.94 2587.05,-7189.13 2594.03,-7188.7"/>
</g>
<!-- layer_9_qkv_gpu4 -->
<g id="node577" class="node">
<title>layer_9_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2333.32,-7069.56 2127.32,-7069.56 2127.32,-7017.56 2333.32,-7017.56 2333.32,-7069.56"/>
<text text-anchor="middle" x="2230.32" y="-7057.56" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2230.32" y="-7046.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2230.32" y="-7035.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2230.32" y="-7024.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_9_attn_gpu4 -->
<g id="node582" class="node">
<title>layer_9_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2327.32,-6981.56 2125.32,-6981.56 2125.32,-6929.56 2327.32,-6929.56 2327.32,-6981.56"/>
<text text-anchor="middle" x="2226.32" y="-6969.56" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2226.32" y="-6958.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2226.32" y="-6947.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2226.32" y="-6936.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_9_qkv_gpu4&#45;&gt;layer_9_attn_gpu4 -->
<g id="edge794" class="edge">
<title>layer_9_qkv_gpu4&#45;&gt;layer_9_attn_gpu4</title>
<path fill="none" stroke="black" d="M2229.14,-7017.22C2228.77,-7009.26 2228.36,-7000.32 2227.96,-6991.8"/>
<polygon fill="black" stroke="black" points="2231.45,-6991.54 2227.49,-6981.71 2224.46,-6991.86 2231.45,-6991.54"/>
</g>
<!-- layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu4 -->
<g id="edge787" class="edge">
<title>layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2473.8,-7113.85C2428.16,-7100.86 2373.77,-7085.38 2327.99,-7072.35"/>
<polygon fill="black" stroke="black" points="2328.93,-7068.98 2318.36,-7069.61 2327.02,-7075.72 2328.93,-7068.98"/>
</g>
<!-- layer_9_qkv_gpu5 -->
<g id="node579" class="node">
<title>layer_9_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2560.32,-7069.56 2354.32,-7069.56 2354.32,-7017.56 2560.32,-7017.56 2560.32,-7069.56"/>
<text text-anchor="middle" x="2457.32" y="-7057.56" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2457.32" y="-7046.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2457.32" y="-7035.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2457.32" y="-7024.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu5 -->
<g id="edge789" class="edge">
<title>layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2529.84,-7106.66C2518.22,-7096.7 2505.6,-7085.9 2494.2,-7076.14"/>
<polygon fill="black" stroke="black" points="2496.4,-7073.42 2486.53,-7069.57 2491.85,-7078.73 2496.4,-7073.42"/>
</g>
<!-- layer_9_qkv_gpu6 -->
<g id="node580" class="node">
<title>layer_9_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2786.32,-7069.56 2580.32,-7069.56 2580.32,-7017.56 2786.32,-7017.56 2786.32,-7069.56"/>
<text text-anchor="middle" x="2683.32" y="-7057.56" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2683.32" y="-7046.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2683.32" y="-7035.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2683.32" y="-7024.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu6 -->
<g id="edge791" class="edge">
<title>layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2610.8,-7106.66C2622.43,-7096.7 2635.04,-7085.9 2646.44,-7076.14"/>
<polygon fill="black" stroke="black" points="2648.79,-7078.73 2654.11,-7069.57 2644.24,-7073.42 2648.79,-7078.73"/>
</g>
<!-- layer_9_qkv_gpu7 -->
<g id="node581" class="node">
<title>layer_9_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3011.32,-7069.56 2805.32,-7069.56 2805.32,-7017.56 3011.32,-7017.56 3011.32,-7069.56"/>
<text text-anchor="middle" x="2908.32" y="-7057.56" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2908.32" y="-7046.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2908.32" y="-7035.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2908.32" y="-7024.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu7 -->
<g id="edge793" class="edge">
<title>layer_9_tp_gather&#45;&gt;layer_9_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2666.27,-7113.85C2711.55,-7100.89 2765.49,-7085.45 2810.94,-7072.44"/>
<polygon fill="black" stroke="black" points="2812.15,-7075.73 2820.8,-7069.61 2810.23,-7069 2812.15,-7075.73"/>
</g>
<!-- layer_9_attn_gpu5 -->
<g id="node583" class="node">
<title>layer_9_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2556.32,-6981.56 2354.32,-6981.56 2354.32,-6929.56 2556.32,-6929.56 2556.32,-6981.56"/>
<text text-anchor="middle" x="2455.32" y="-6969.56" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2455.32" y="-6958.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2455.32" y="-6947.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2455.32" y="-6936.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_9_qkv_gpu5&#45;&gt;layer_9_attn_gpu5 -->
<g id="edge795" class="edge">
<title>layer_9_qkv_gpu5&#45;&gt;layer_9_attn_gpu5</title>
<path fill="none" stroke="black" d="M2456.73,-7017.22C2456.55,-7009.26 2456.34,-7000.32 2456.14,-6991.8"/>
<polygon fill="black" stroke="black" points="2459.64,-6991.63 2455.91,-6981.71 2452.64,-6991.79 2459.64,-6991.63"/>
</g>
<!-- layer_9_attn_gpu6 -->
<g id="node584" class="node">
<title>layer_9_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2787.32,-6981.56 2585.32,-6981.56 2585.32,-6929.56 2787.32,-6929.56 2787.32,-6981.56"/>
<text text-anchor="middle" x="2686.32" y="-6969.56" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2686.32" y="-6958.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2686.32" y="-6947.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2686.32" y="-6936.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_9_qkv_gpu6&#45;&gt;layer_9_attn_gpu6 -->
<g id="edge796" class="edge">
<title>layer_9_qkv_gpu6&#45;&gt;layer_9_attn_gpu6</title>
<path fill="none" stroke="black" d="M2684.2,-7017.22C2684.48,-7009.26 2684.79,-7000.32 2685.09,-6991.8"/>
<polygon fill="black" stroke="black" points="2688.59,-6991.83 2685.44,-6981.71 2681.6,-6991.58 2688.59,-6991.83"/>
</g>
<!-- layer_9_attn_gpu7 -->
<g id="node585" class="node">
<title>layer_9_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3009.32,-6981.56 2807.32,-6981.56 2807.32,-6929.56 3009.32,-6929.56 3009.32,-6981.56"/>
<text text-anchor="middle" x="2908.32" y="-6969.56" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2908.32" y="-6958.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2908.32" y="-6947.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2908.32" y="-6936.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_9_qkv_gpu7&#45;&gt;layer_9_attn_gpu7 -->
<g id="edge797" class="edge">
<title>layer_9_qkv_gpu7&#45;&gt;layer_9_attn_gpu7</title>
<path fill="none" stroke="black" d="M2908.32,-7017.22C2908.32,-7009.26 2908.32,-7000.32 2908.32,-6991.8"/>
<polygon fill="black" stroke="black" points="2911.82,-6991.71 2908.32,-6981.71 2904.82,-6991.71 2911.82,-6991.71"/>
</g>
<!-- layer_9_attn_out_gpu4 -->
<g id="node586" class="node">
<title>layer_9_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2330.32,-6893.56 2116.32,-6893.56 2116.32,-6841.56 2330.32,-6841.56 2330.32,-6893.56"/>
<text text-anchor="middle" x="2223.32" y="-6881.56" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2223.32" y="-6870.56" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2223.32" y="-6859.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2223.32" y="-6848.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_attn_gpu4&#45;&gt;layer_9_attn_out_gpu4 -->
<g id="edge798" class="edge">
<title>layer_9_attn_gpu4&#45;&gt;layer_9_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2225.44,-6929.22C2225.16,-6921.26 2224.85,-6912.32 2224.55,-6903.8"/>
<polygon fill="black" stroke="black" points="2228.04,-6903.58 2224.2,-6893.71 2221.05,-6903.83 2228.04,-6903.58"/>
</g>
<!-- layer_9_attn_out_gpu5 -->
<g id="node587" class="node">
<title>layer_9_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2562.32,-6893.56 2348.32,-6893.56 2348.32,-6841.56 2562.32,-6841.56 2562.32,-6893.56"/>
<text text-anchor="middle" x="2455.32" y="-6881.56" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2455.32" y="-6870.56" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2455.32" y="-6859.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2455.32" y="-6848.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_attn_gpu5&#45;&gt;layer_9_attn_out_gpu5 -->
<g id="edge799" class="edge">
<title>layer_9_attn_gpu5&#45;&gt;layer_9_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2455.32,-6929.22C2455.32,-6921.26 2455.32,-6912.32 2455.32,-6903.8"/>
<polygon fill="black" stroke="black" points="2458.82,-6903.71 2455.32,-6893.71 2451.82,-6903.71 2458.82,-6903.71"/>
</g>
<!-- layer_9_attn_out_gpu6 -->
<g id="node588" class="node">
<title>layer_9_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2794.32,-6893.56 2580.32,-6893.56 2580.32,-6841.56 2794.32,-6841.56 2794.32,-6893.56"/>
<text text-anchor="middle" x="2687.32" y="-6881.56" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2687.32" y="-6870.56" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2687.32" y="-6859.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2687.32" y="-6848.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_attn_gpu6&#45;&gt;layer_9_attn_out_gpu6 -->
<g id="edge800" class="edge">
<title>layer_9_attn_gpu6&#45;&gt;layer_9_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2686.62,-6929.22C2686.71,-6921.26 2686.81,-6912.32 2686.91,-6903.8"/>
<polygon fill="black" stroke="black" points="2690.41,-6903.75 2687.03,-6893.71 2683.41,-6903.67 2690.41,-6903.75"/>
</g>
<!-- layer_9_attn_out_gpu7 -->
<g id="node589" class="node">
<title>layer_9_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3026.32,-6893.56 2812.32,-6893.56 2812.32,-6841.56 3026.32,-6841.56 3026.32,-6893.56"/>
<text text-anchor="middle" x="2919.32" y="-6881.56" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2919.32" y="-6870.56" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2919.32" y="-6859.56" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2919.32" y="-6848.56" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_attn_gpu7&#45;&gt;layer_9_attn_out_gpu7 -->
<g id="edge801" class="edge">
<title>layer_9_attn_gpu7&#45;&gt;layer_9_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2911.56,-6929.22C2912.58,-6921.26 2913.72,-6912.32 2914.81,-6903.8"/>
<polygon fill="black" stroke="black" points="2918.31,-6904.08 2916.1,-6893.71 2911.36,-6903.19 2918.31,-6904.08"/>
</g>
<!-- layer_9_attn_allreduce -->
<g id="node590" class="node">
<title>layer_9_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2571.32" cy="-6768.79" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2571.32" y="-6782.79" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2571.32" y="-6771.79" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2571.32" y="-6760.79" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2571.32" y="-6749.79" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_attn_out_gpu4&#45;&gt;layer_9_attn_allreduce -->
<g id="edge802" class="edge">
<title>layer_9_attn_out_gpu4&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M2313.39,-6841.51C2359.36,-6828.73 2415.61,-6813.08 2463.84,-6799.67"/>
<polygon fill="black" stroke="black" points="2464.99,-6802.99 2473.69,-6796.94 2463.11,-6796.24 2464.99,-6802.99"/>
</g>
<!-- layer_9_attn_out_gpu5&#45;&gt;layer_9_attn_allreduce -->
<g id="edge803" class="edge">
<title>layer_9_attn_out_gpu5&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M2485.5,-6841.38C2496.73,-6832.02 2509.78,-6821.13 2522.26,-6810.71"/>
<polygon fill="black" stroke="black" points="2524.51,-6813.4 2529.94,-6804.3 2520.02,-6808.02 2524.51,-6813.4"/>
</g>
<!-- layer_9_attn_out_gpu6&#45;&gt;layer_9_attn_allreduce -->
<g id="edge804" class="edge">
<title>layer_9_attn_out_gpu6&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M2657.15,-6841.38C2645.92,-6832.02 2632.86,-6821.13 2620.38,-6810.71"/>
<polygon fill="black" stroke="black" points="2622.62,-6808.02 2612.7,-6804.3 2618.13,-6813.4 2622.62,-6808.02"/>
</g>
<!-- layer_9_attn_out_gpu7&#45;&gt;layer_9_attn_allreduce -->
<g id="edge805" class="edge">
<title>layer_9_attn_out_gpu7&#45;&gt;layer_9_attn_allreduce</title>
<path fill="none" stroke="black" d="M2829.25,-6841.51C2783.28,-6828.73 2727.03,-6813.08 2678.8,-6799.67"/>
<polygon fill="black" stroke="black" points="2679.53,-6796.24 2668.96,-6796.94 2677.65,-6802.99 2679.53,-6796.24"/>
</g>
<!-- layer_9_gate -->
<g id="node591" class="node">
<title>layer_9_gate</title>
<polygon fill="lightyellow" stroke="black" points="2788.18,-6696.02 2443.2,-6696.02 2354.46,-6592.02 2699.44,-6592.02 2788.18,-6696.02"/>
<text text-anchor="middle" x="2571.32" y="-6658.02" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2571.32" y="-6647.02" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2571.32" y="-6636.02" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2571.32" y="-6625.02" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_9_attn_allreduce&#45;&gt;layer_9_gate -->
<g id="edge806" class="edge">
<title>layer_9_attn_allreduce&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2552.76,-6732.28C2551.65,-6724.23 2551.08,-6715.47 2551.07,-6706.69"/>
<polygon fill="black" stroke="black" points="2554.58,-6706.51 2551.31,-6696.43 2547.58,-6706.34 2554.58,-6706.51"/>
</g>
<!-- layer_9_attn_allreduce&#45;&gt;layer_9_gate -->
<g id="edge807" class="edge">
<title>layer_9_attn_allreduce&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2565.12,-6731.95C2564.75,-6723.91 2564.57,-6715.16 2564.57,-6706.41"/>
<polygon fill="black" stroke="black" points="2568.07,-6706.21 2564.65,-6696.18 2561.07,-6706.15 2568.07,-6706.21"/>
</g>
<!-- layer_9_attn_allreduce&#45;&gt;layer_9_gate -->
<g id="edge808" class="edge">
<title>layer_9_attn_allreduce&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2577.52,-6731.95C2577.89,-6723.91 2578.07,-6715.16 2578.07,-6706.41"/>
<polygon fill="black" stroke="black" points="2581.57,-6706.15 2577.99,-6696.18 2574.57,-6706.21 2581.57,-6706.15"/>
</g>
<!-- layer_9_attn_allreduce&#45;&gt;layer_9_gate -->
<g id="edge809" class="edge">
<title>layer_9_attn_allreduce&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2589.88,-6732.28C2590.99,-6724.23 2591.56,-6715.47 2591.57,-6706.69"/>
<polygon fill="black" stroke="black" points="2595.06,-6706.34 2591.33,-6696.43 2588.07,-6706.51 2595.06,-6706.34"/>
</g>
<!-- layer_9_all2all_expert_0 -->
<g id="node593" class="node">
<title>layer_9_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="180.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="180.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="180.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="180.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="180.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_0 -->
<g id="edge810" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.3,-6639.98C1942.25,-6631.54 743.92,-6605.14 349.32,-6556.02 331.62,-6553.81 313.02,-6550.7 294.89,-6547.22"/>
<polygon fill="black" stroke="black" points="295.37,-6543.75 284.88,-6545.26 294.02,-6550.62 295.37,-6543.75"/>
</g>
<!-- layer_9_all2all_expert_1 -->
<g id="node595" class="node">
<title>layer_9_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="506.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="506.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="506.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="506.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="506.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_1 -->
<g id="edge812" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2394.31,-6638.78C1988.27,-6628.42 999.51,-6599.47 669.32,-6556.02 652.99,-6553.87 635.88,-6550.91 619.13,-6547.61"/>
<polygon fill="black" stroke="black" points="619.82,-6544.18 609.33,-6545.63 618.44,-6551.04 619.82,-6544.18"/>
</g>
<!-- layer_9_all2all_expert_2 -->
<g id="node597" class="node">
<title>layer_9_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="826.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="826.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="826.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="826.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="826.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_2 -->
<g id="edge814" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2397.75,-6642.83C2105.2,-6640.44 1495.96,-6626.48 986.32,-6556.02 970.79,-6553.87 954.54,-6550.99 938.6,-6547.8"/>
<polygon fill="black" stroke="black" points="939.22,-6544.35 928.72,-6545.77 937.81,-6551.21 939.22,-6544.35"/>
</g>
<!-- layer_9_all2all_expert_3 -->
<g id="node599" class="node">
<title>layer_9_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1143.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1143.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1143.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1143.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1143.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_3 -->
<g id="edge816" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2394.75,-6639.51C2148.61,-6632.67 1688.91,-6612.82 1301.32,-6556.02 1286.48,-6553.84 1270.97,-6551.02 1255.71,-6547.92"/>
<polygon fill="black" stroke="black" points="1256.23,-6544.45 1245.73,-6545.84 1254.81,-6551.31 1256.23,-6544.45"/>
</g>
<!-- layer_9_all2all_expert_4 -->
<g id="node601" class="node">
<title>layer_9_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1458.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1458.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1458.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1458.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1458.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_4 -->
<g id="edge818" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2389.54,-6633.41C2197.14,-6621.61 1885.04,-6597.83 1618.32,-6556.02 1603.33,-6553.67 1587.64,-6550.74 1572.19,-6547.59"/>
<polygon fill="black" stroke="black" points="1572.59,-6544.1 1562.09,-6545.48 1571.17,-6550.95 1572.59,-6544.1"/>
</g>
<!-- layer_9_all2all_expert_5 -->
<g id="node603" class="node">
<title>layer_9_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1775.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1775.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1775.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1775.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1775.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_5 -->
<g id="edge820" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2378.49,-6620.43C2253,-6604.76 2085.99,-6582.07 1939.32,-6556.02 1923.99,-6553.29 1907.92,-6550.15 1892.09,-6546.88"/>
<polygon fill="black" stroke="black" points="1892.77,-6543.45 1882.27,-6544.83 1891.34,-6550.3 1892.77,-6543.45"/>
</g>
<!-- layer_9_all2all_expert_6 -->
<g id="node605" class="node">
<title>layer_9_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2096.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2096.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2096.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2096.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2096.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_6 -->
<g id="edge822" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2373.66,-6591.93C2316.59,-6577.18 2256.35,-6561.61 2206.65,-6548.76"/>
<polygon fill="black" stroke="black" points="2207.42,-6545.35 2196.86,-6546.23 2205.66,-6552.12 2207.42,-6545.35"/>
</g>
<!-- layer_9_all2all_expert_7 -->
<g id="node607" class="node">
<title>layer_9_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2413.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2413.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2413.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2413.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2413.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_7 -->
<g id="edge824" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2505.23,-6591.66C2492.05,-6581.42 2478.38,-6570.8 2465.73,-6560.97"/>
<polygon fill="black" stroke="black" points="2467.63,-6558.02 2457.59,-6554.64 2463.34,-6563.54 2467.63,-6558.02"/>
</g>
<!-- layer_9_all2all_expert_8 -->
<g id="node609" class="node">
<title>layer_9_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2729.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2729.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2729.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2729.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2729.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_8 -->
<g id="edge826" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2637.41,-6591.66C2650.59,-6581.42 2664.26,-6570.8 2676.91,-6560.97"/>
<polygon fill="black" stroke="black" points="2679.3,-6563.54 2685.05,-6554.64 2675.01,-6558.02 2679.3,-6563.54"/>
</g>
<!-- layer_9_all2all_expert_9 -->
<g id="node611" class="node">
<title>layer_9_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3047.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3047.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3047.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3047.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3047.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_9 -->
<g id="edge828" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2712.2,-6606.68C2783.93,-6588.18 2869.86,-6566.02 2936.74,-6548.77"/>
<polygon fill="black" stroke="black" points="2937.66,-6552.15 2946.47,-6546.26 2935.91,-6545.37 2937.66,-6552.15"/>
</g>
<!-- layer_9_all2all_expert_10 -->
<g id="node613" class="node">
<title>layer_9_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3367.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3367.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3367.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3367.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3367.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_10 -->
<g id="edge830" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2727.94,-6625C2856.38,-6609.39 3042.69,-6584.81 3204.32,-6556.02 3219.41,-6553.33 3235.23,-6550.22 3250.82,-6546.99"/>
<polygon fill="black" stroke="black" points="3251.96,-6550.33 3261.03,-6544.85 3250.53,-6543.47 3251.96,-6550.33"/>
</g>
<!-- layer_9_all2all_expert_11 -->
<g id="node615" class="node">
<title>layer_9_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3687.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3687.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3687.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3687.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3687.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_11 -->
<g id="edge832" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2735.66,-6634.27C2926.19,-6622.69 3249.31,-6598.57 3524.32,-6556.02 3539.97,-6553.6 3556.37,-6550.58 3572.48,-6547.33"/>
<polygon fill="black" stroke="black" points="3573.37,-6550.72 3582.46,-6545.28 3571.96,-6543.86 3573.37,-6550.72"/>
</g>
<!-- layer_9_all2all_expert_12 -->
<g id="node617" class="node">
<title>layer_9_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4008.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4008.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4008.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4008.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4008.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_12 -->
<g id="edge834" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2739.97,-6639.35C2984.49,-6632.25 3451.21,-6612.01 3844.32,-6556.02 3860.45,-6553.72 3877.35,-6550.72 3893.92,-6547.43"/>
<polygon fill="black" stroke="black" points="3895.08,-6550.77 3904.19,-6545.36 3893.69,-6543.91 3895.08,-6550.77"/>
</g>
<!-- layer_9_all2all_expert_13 -->
<g id="node619" class="node">
<title>layer_9_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4329.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4329.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4329.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4329.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4329.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_13 -->
<g id="edge836" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2742.9,-6642.64C3035.89,-6639.99 3650.89,-6625.7 4165.32,-6556.02 4181.74,-6553.79 4198.95,-6550.79 4215.79,-6547.47"/>
<polygon fill="black" stroke="black" points="4216.55,-6550.89 4225.66,-6545.48 4215.16,-6544.03 4216.55,-6550.89"/>
</g>
<!-- layer_9_all2all_expert_14 -->
<g id="node621" class="node">
<title>layer_9_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4650.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4650.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4650.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4650.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4650.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_14 -->
<g id="edge838" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2739.76,-6639.03C3142.24,-6628.9 4151.17,-6599.86 4486.32,-6556.02 4502.75,-6553.87 4519.96,-6550.91 4536.81,-6547.61"/>
<polygon fill="black" stroke="black" points="4537.56,-6551.03 4546.68,-6545.63 4536.18,-6544.16 4537.56,-6551.03"/>
</g>
<!-- layer_9_all2all_expert_15 -->
<g id="node623" class="node">
<title>layer_9_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4971.32" cy="-6519.25" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4971.32" y="-6533.25" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4971.32" y="-6522.25" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4971.32" y="-6511.25" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4971.32" y="-6500.25" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_all2all_expert_15 -->
<g id="edge840" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2740.66,-6640.29C3190.48,-6632.41 4408.1,-6606.92 4807.32,-6556.02 4823.87,-6553.91 4841.23,-6550.95 4858.19,-6547.63"/>
<polygon fill="black" stroke="black" points="4859.01,-6551.04 4868.13,-6545.64 4857.64,-6544.17 4859.01,-6551.04"/>
</g>
<!-- layer_9_expert_0_gpu8 -->
<g id="node592" class="node">
<title>layer_9_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="280.82,-6446.48 71.82,-6446.48 71.82,-6394.48 280.82,-6394.48 280.82,-6446.48"/>
<text text-anchor="middle" x="176.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="176.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="176.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="176.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_0 -->
<g id="node624" class="node">
<title>layer_9_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="162.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="162.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="162.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="162.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="162.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_0_gpu8&#45;&gt;layer_9_all2all_back_0 -->
<g id="edge842" class="edge">
<title>layer_9_expert_0_gpu8&#45;&gt;layer_9_all2all_back_0</title>
<path fill="none" stroke="black" d="M172.68,-6394.31C171.55,-6386.5 170.27,-6377.63 169,-6368.86"/>
<polygon fill="black" stroke="black" points="172.42,-6368.08 167.53,-6358.68 165.49,-6369.08 172.42,-6368.08"/>
</g>
<!-- layer_9_all2all_expert_0&#45;&gt;layer_9_expert_0_gpu8 -->
<g id="edge811" class="edge">
<title>layer_9_all2all_expert_0&#45;&gt;layer_9_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M178.83,-6482.21C178.49,-6473.9 178.12,-6465.07 177.78,-6456.79"/>
<polygon fill="black" stroke="black" points="181.27,-6456.52 177.36,-6446.67 174.28,-6456.81 181.27,-6456.52"/>
</g>
<!-- layer_9_expert_1_gpu8 -->
<g id="node594" class="node">
<title>layer_9_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="597.82,-6446.48 388.82,-6446.48 388.82,-6394.48 597.82,-6394.48 597.82,-6446.48"/>
<text text-anchor="middle" x="493.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="493.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="493.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="493.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_1 -->
<g id="node625" class="node">
<title>layer_9_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="483.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="483.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="483.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="483.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="483.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_1_gpu8&#45;&gt;layer_9_all2all_back_1 -->
<g id="edge843" class="edge">
<title>layer_9_expert_1_gpu8&#45;&gt;layer_9_all2all_back_1</title>
<path fill="none" stroke="black" d="M490.72,-6394.31C489.91,-6386.5 489,-6377.63 488.09,-6368.86"/>
<polygon fill="black" stroke="black" points="491.55,-6368.27 487.04,-6358.68 484.59,-6368.99 491.55,-6368.27"/>
</g>
<!-- layer_9_all2all_expert_1&#45;&gt;layer_9_expert_1_gpu8 -->
<g id="edge813" class="edge">
<title>layer_9_all2all_expert_1&#45;&gt;layer_9_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M501.52,-6482.49C500.38,-6473.99 499.16,-6464.94 498.02,-6456.47"/>
<polygon fill="black" stroke="black" points="501.49,-6455.97 496.69,-6446.52 494.55,-6456.9 501.49,-6455.97"/>
</g>
<!-- layer_9_expert_2_gpu9 -->
<g id="node596" class="node">
<title>layer_9_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="923.82,-6446.48 714.82,-6446.48 714.82,-6394.48 923.82,-6394.48 923.82,-6446.48"/>
<text text-anchor="middle" x="819.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="819.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="819.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="819.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_2 -->
<g id="node626" class="node">
<title>layer_9_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="804.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="804.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="804.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="804.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="804.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_2_gpu9&#45;&gt;layer_9_all2all_back_2 -->
<g id="edge844" class="edge">
<title>layer_9_expert_2_gpu9&#45;&gt;layer_9_all2all_back_2</title>
<path fill="none" stroke="black" d="M815.42,-6394.31C814.2,-6386.41 812.8,-6377.44 811.43,-6368.58"/>
<polygon fill="black" stroke="black" points="814.89,-6368.03 809.9,-6358.68 807.97,-6369.1 814.89,-6368.03"/>
</g>
<!-- layer_9_all2all_expert_2&#45;&gt;layer_9_expert_2_gpu9 -->
<g id="edge815" class="edge">
<title>layer_9_all2all_expert_2&#45;&gt;layer_9_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M823.71,-6482.21C823.11,-6473.9 822.47,-6465.07 821.88,-6456.79"/>
<polygon fill="black" stroke="black" points="825.36,-6456.4 821.14,-6446.67 818.37,-6456.9 825.36,-6456.4"/>
</g>
<!-- layer_9_expert_3_gpu9 -->
<g id="node598" class="node">
<title>layer_9_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1244.82,-6446.48 1035.82,-6446.48 1035.82,-6394.48 1244.82,-6394.48 1244.82,-6446.48"/>
<text text-anchor="middle" x="1140.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1140.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1140.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1140.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_3 -->
<g id="node627" class="node">
<title>layer_9_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1125.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1125.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1125.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1125.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1125.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_3_gpu9&#45;&gt;layer_9_all2all_back_3 -->
<g id="edge845" class="edge">
<title>layer_9_expert_3_gpu9&#45;&gt;layer_9_all2all_back_3</title>
<path fill="none" stroke="black" d="M1136.42,-6394.31C1135.2,-6386.41 1133.8,-6377.44 1132.43,-6368.58"/>
<polygon fill="black" stroke="black" points="1135.89,-6368.03 1130.9,-6358.68 1128.97,-6369.1 1135.89,-6368.03"/>
</g>
<!-- layer_9_all2all_expert_3&#45;&gt;layer_9_expert_3_gpu9 -->
<g id="edge817" class="edge">
<title>layer_9_all2all_expert_3&#45;&gt;layer_9_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1142.2,-6482.21C1141.95,-6473.9 1141.67,-6465.07 1141.42,-6456.79"/>
<polygon fill="black" stroke="black" points="1144.91,-6456.56 1141.1,-6446.67 1137.91,-6456.78 1144.91,-6456.56"/>
</g>
<!-- layer_9_expert_4_gpu10 -->
<g id="node600" class="node">
<title>layer_9_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1552.82,-6446.48 1343.82,-6446.48 1343.82,-6394.48 1552.82,-6394.48 1552.82,-6446.48"/>
<text text-anchor="middle" x="1448.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1448.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1448.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1448.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_4 -->
<g id="node628" class="node">
<title>layer_9_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1446.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1446.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1446.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1446.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1446.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_4_gpu10&#45;&gt;layer_9_all2all_back_4 -->
<g id="edge846" class="edge">
<title>layer_9_expert_4_gpu10&#45;&gt;layer_9_all2all_back_4</title>
<path fill="none" stroke="black" d="M1447.8,-6394.31C1447.64,-6386.5 1447.46,-6377.63 1447.27,-6368.86"/>
<polygon fill="black" stroke="black" points="1450.77,-6368.61 1447.06,-6358.68 1443.77,-6368.75 1450.77,-6368.61"/>
</g>
<!-- layer_9_all2all_expert_4&#45;&gt;layer_9_expert_4_gpu10 -->
<g id="edge819" class="edge">
<title>layer_9_all2all_expert_4&#45;&gt;layer_9_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1454.63,-6482.49C1453.75,-6473.99 1452.81,-6464.94 1451.94,-6456.47"/>
<polygon fill="black" stroke="black" points="1455.42,-6456.11 1450.91,-6446.52 1448.46,-6456.83 1455.42,-6456.11"/>
</g>
<!-- layer_9_expert_5_gpu10 -->
<g id="node602" class="node">
<title>layer_9_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1874.82,-6446.48 1665.82,-6446.48 1665.82,-6394.48 1874.82,-6394.48 1874.82,-6446.48"/>
<text text-anchor="middle" x="1770.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1770.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1770.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1770.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_5 -->
<g id="node629" class="node">
<title>layer_9_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1767.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1767.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1767.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1767.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1767.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_5_gpu10&#45;&gt;layer_9_all2all_back_5 -->
<g id="edge847" class="edge">
<title>layer_9_expert_5_gpu10&#45;&gt;layer_9_all2all_back_5</title>
<path fill="none" stroke="black" d="M1769.54,-6394.31C1769.3,-6386.5 1769.02,-6377.63 1768.75,-6368.86"/>
<polygon fill="black" stroke="black" points="1772.24,-6368.57 1768.44,-6358.68 1765.25,-6368.79 1772.24,-6368.57"/>
</g>
<!-- layer_9_all2all_expert_5&#45;&gt;layer_9_expert_5_gpu10 -->
<g id="edge821" class="edge">
<title>layer_9_all2all_expert_5&#45;&gt;layer_9_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1773.46,-6482.21C1773.03,-6473.9 1772.57,-6465.07 1772.15,-6456.79"/>
<polygon fill="black" stroke="black" points="1775.63,-6456.48 1771.62,-6446.67 1768.64,-6456.84 1775.63,-6456.48"/>
</g>
<!-- layer_9_expert_6_gpu11 -->
<g id="node604" class="node">
<title>layer_9_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2197.82,-6446.48 1988.82,-6446.48 1988.82,-6394.48 2197.82,-6394.48 2197.82,-6446.48"/>
<text text-anchor="middle" x="2093.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2093.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2093.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2093.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_6 -->
<g id="node630" class="node">
<title>layer_9_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2088.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2088.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2088.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2088.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2088.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_6_gpu11&#45;&gt;layer_9_all2all_back_6 -->
<g id="edge848" class="edge">
<title>layer_9_expert_6_gpu11&#45;&gt;layer_9_all2all_back_6</title>
<path fill="none" stroke="black" d="M2092.02,-6394.31C2091.62,-6386.5 2091.16,-6377.63 2090.71,-6368.86"/>
<polygon fill="black" stroke="black" points="2094.19,-6368.49 2090.18,-6358.68 2087.2,-6368.85 2094.19,-6368.49"/>
</g>
<!-- layer_9_all2all_expert_6&#45;&gt;layer_9_expert_6_gpu11 -->
<g id="edge823" class="edge">
<title>layer_9_all2all_expert_6&#45;&gt;layer_9_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2095.2,-6482.21C2094.95,-6473.9 2094.67,-6465.07 2094.42,-6456.79"/>
<polygon fill="black" stroke="black" points="2097.91,-6456.56 2094.1,-6446.67 2090.91,-6456.78 2097.91,-6456.56"/>
</g>
<!-- layer_9_expert_7_gpu11 -->
<g id="node606" class="node">
<title>layer_9_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2514.82,-6446.48 2305.82,-6446.48 2305.82,-6394.48 2514.82,-6394.48 2514.82,-6446.48"/>
<text text-anchor="middle" x="2410.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2410.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2410.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2410.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_7 -->
<g id="node631" class="node">
<title>layer_9_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2409.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2409.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2409.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2409.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2409.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_7_gpu11&#45;&gt;layer_9_all2all_back_7 -->
<g id="edge849" class="edge">
<title>layer_9_expert_7_gpu11&#45;&gt;layer_9_all2all_back_7</title>
<path fill="none" stroke="black" d="M2410.06,-6394.31C2409.98,-6386.5 2409.89,-6377.63 2409.8,-6368.86"/>
<polygon fill="black" stroke="black" points="2413.3,-6368.65 2409.69,-6358.68 2406.3,-6368.72 2413.3,-6368.65"/>
</g>
<!-- layer_9_all2all_expert_7&#45;&gt;layer_9_expert_7_gpu11 -->
<g id="edge825" class="edge">
<title>layer_9_all2all_expert_7&#45;&gt;layer_9_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2412.2,-6482.21C2411.95,-6473.9 2411.67,-6465.07 2411.42,-6456.79"/>
<polygon fill="black" stroke="black" points="2414.91,-6456.56 2411.1,-6446.67 2407.91,-6456.78 2414.91,-6456.56"/>
</g>
<!-- layer_9_expert_8_gpu12 -->
<g id="node608" class="node">
<title>layer_9_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2833.82,-6446.48 2624.82,-6446.48 2624.82,-6394.48 2833.82,-6394.48 2833.82,-6446.48"/>
<text text-anchor="middle" x="2729.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2729.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2729.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2729.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_8 -->
<g id="node632" class="node">
<title>layer_9_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2730.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2730.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2730.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2730.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2730.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_8_gpu12&#45;&gt;layer_9_all2all_back_8 -->
<g id="edge850" class="edge">
<title>layer_9_expert_8_gpu12&#45;&gt;layer_9_all2all_back_8</title>
<path fill="none" stroke="black" d="M2729.58,-6394.31C2729.66,-6386.5 2729.75,-6377.63 2729.84,-6368.86"/>
<polygon fill="black" stroke="black" points="2733.35,-6368.72 2729.95,-6358.68 2726.35,-6368.65 2733.35,-6368.72"/>
</g>
<!-- layer_9_all2all_expert_8&#45;&gt;layer_9_expert_8_gpu12 -->
<g id="edge827" class="edge">
<title>layer_9_all2all_expert_8&#45;&gt;layer_9_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2729.32,-6482.21C2729.32,-6473.9 2729.32,-6465.07 2729.32,-6456.79"/>
<polygon fill="black" stroke="black" points="2732.82,-6456.67 2729.32,-6446.67 2725.82,-6456.67 2732.82,-6456.67"/>
</g>
<!-- layer_9_expert_9_gpu12 -->
<g id="node610" class="node">
<title>layer_9_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3153.82,-6446.48 2944.82,-6446.48 2944.82,-6394.48 3153.82,-6394.48 3153.82,-6446.48"/>
<text text-anchor="middle" x="3049.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3049.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3049.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3049.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_9 -->
<g id="node633" class="node">
<title>layer_9_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3051.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3051.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3051.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3051.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3051.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_9_gpu12&#45;&gt;layer_9_all2all_back_9 -->
<g id="edge851" class="edge">
<title>layer_9_expert_9_gpu12&#45;&gt;layer_9_all2all_back_9</title>
<path fill="none" stroke="black" d="M3049.84,-6394.31C3050,-6386.5 3050.19,-6377.63 3050.37,-6368.86"/>
<polygon fill="black" stroke="black" points="3053.87,-6368.75 3050.58,-6358.68 3046.87,-6368.61 3053.87,-6368.75"/>
</g>
<!-- layer_9_all2all_expert_9&#45;&gt;layer_9_expert_9_gpu12 -->
<g id="edge829" class="edge">
<title>layer_9_all2all_expert_9&#45;&gt;layer_9_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3048.07,-6482.21C3048.24,-6473.9 3048.42,-6465.07 3048.59,-6456.79"/>
<polygon fill="black" stroke="black" points="3052.09,-6456.74 3048.8,-6446.67 3045.09,-6456.6 3052.09,-6456.74"/>
</g>
<!-- layer_9_expert_10_gpu13 -->
<g id="node612" class="node">
<title>layer_9_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3474.82,-6446.48 3265.82,-6446.48 3265.82,-6394.48 3474.82,-6394.48 3474.82,-6446.48"/>
<text text-anchor="middle" x="3370.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3370.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3370.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3370.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_10 -->
<g id="node634" class="node">
<title>layer_9_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3372.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3372.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3372.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3372.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3372.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_10_gpu13&#45;&gt;layer_9_all2all_back_10 -->
<g id="edge852" class="edge">
<title>layer_9_expert_10_gpu13&#45;&gt;layer_9_all2all_back_10</title>
<path fill="none" stroke="black" d="M3370.84,-6394.31C3371,-6386.5 3371.19,-6377.63 3371.37,-6368.86"/>
<polygon fill="black" stroke="black" points="3374.87,-6368.75 3371.58,-6358.68 3367.87,-6368.61 3374.87,-6368.75"/>
</g>
<!-- layer_9_all2all_expert_10&#45;&gt;layer_9_expert_10_gpu13 -->
<g id="edge831" class="edge">
<title>layer_9_all2all_expert_10&#45;&gt;layer_9_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3368.44,-6482.21C3368.7,-6473.9 3368.97,-6465.07 3369.23,-6456.79"/>
<polygon fill="black" stroke="black" points="3372.73,-6456.78 3369.54,-6446.67 3365.73,-6456.56 3372.73,-6456.78"/>
</g>
<!-- layer_9_expert_11_gpu13 -->
<g id="node614" class="node">
<title>layer_9_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3794.82,-6446.48 3585.82,-6446.48 3585.82,-6394.48 3794.82,-6394.48 3794.82,-6446.48"/>
<text text-anchor="middle" x="3690.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3690.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3690.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3690.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_11 -->
<g id="node635" class="node">
<title>layer_9_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3693.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3693.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3693.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3693.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3693.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_11_gpu13&#45;&gt;layer_9_all2all_back_11 -->
<g id="edge853" class="edge">
<title>layer_9_expert_11_gpu13&#45;&gt;layer_9_all2all_back_11</title>
<path fill="none" stroke="black" d="M3691.1,-6394.31C3691.34,-6386.5 3691.62,-6377.63 3691.89,-6368.86"/>
<polygon fill="black" stroke="black" points="3695.39,-6368.79 3692.21,-6358.68 3688.4,-6368.57 3695.39,-6368.79"/>
</g>
<!-- layer_9_all2all_expert_11&#45;&gt;layer_9_expert_11_gpu13 -->
<g id="edge833" class="edge">
<title>layer_9_all2all_expert_11&#45;&gt;layer_9_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3688.44,-6482.21C3688.7,-6473.9 3688.97,-6465.07 3689.23,-6456.79"/>
<polygon fill="black" stroke="black" points="3692.73,-6456.78 3689.54,-6446.67 3685.73,-6456.56 3692.73,-6456.78"/>
</g>
<!-- layer_9_expert_12_gpu14 -->
<g id="node616" class="node">
<title>layer_9_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4115.82,-6446.48 3906.82,-6446.48 3906.82,-6394.48 4115.82,-6394.48 4115.82,-6446.48"/>
<text text-anchor="middle" x="4011.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4011.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4011.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4011.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_12 -->
<g id="node636" class="node">
<title>layer_9_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4014.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4014.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4014.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4014.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4014.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_12_gpu14&#45;&gt;layer_9_all2all_back_12 -->
<g id="edge854" class="edge">
<title>layer_9_expert_12_gpu14&#45;&gt;layer_9_all2all_back_12</title>
<path fill="none" stroke="black" d="M4012.1,-6394.31C4012.34,-6386.5 4012.62,-6377.63 4012.89,-6368.86"/>
<polygon fill="black" stroke="black" points="4016.39,-6368.79 4013.21,-6358.68 4009.4,-6368.57 4016.39,-6368.79"/>
</g>
<!-- layer_9_all2all_expert_12&#45;&gt;layer_9_expert_12_gpu14 -->
<g id="edge835" class="edge">
<title>layer_9_all2all_expert_12&#45;&gt;layer_9_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4009.44,-6482.21C4009.7,-6473.9 4009.97,-6465.07 4010.23,-6456.79"/>
<polygon fill="black" stroke="black" points="4013.73,-6456.78 4010.54,-6446.67 4006.73,-6456.56 4013.73,-6456.78"/>
</g>
<!-- layer_9_expert_13_gpu14 -->
<g id="node618" class="node">
<title>layer_9_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4436.82,-6446.48 4227.82,-6446.48 4227.82,-6394.48 4436.82,-6394.48 4436.82,-6446.48"/>
<text text-anchor="middle" x="4332.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4332.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4332.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4332.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_13 -->
<g id="node637" class="node">
<title>layer_9_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4335.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4335.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4335.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4335.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4335.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_13_gpu14&#45;&gt;layer_9_all2all_back_13 -->
<g id="edge855" class="edge">
<title>layer_9_expert_13_gpu14&#45;&gt;layer_9_all2all_back_13</title>
<path fill="none" stroke="black" d="M4333.1,-6394.31C4333.34,-6386.5 4333.62,-6377.63 4333.89,-6368.86"/>
<polygon fill="black" stroke="black" points="4337.39,-6368.79 4334.21,-6358.68 4330.4,-6368.57 4337.39,-6368.79"/>
</g>
<!-- layer_9_all2all_expert_13&#45;&gt;layer_9_expert_13_gpu14 -->
<g id="edge837" class="edge">
<title>layer_9_all2all_expert_13&#45;&gt;layer_9_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4330.44,-6482.21C4330.7,-6473.9 4330.97,-6465.07 4331.23,-6456.79"/>
<polygon fill="black" stroke="black" points="4334.73,-6456.78 4331.54,-6446.67 4327.73,-6456.56 4334.73,-6456.78"/>
</g>
<!-- layer_9_expert_14_gpu15 -->
<g id="node620" class="node">
<title>layer_9_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4757.82,-6446.48 4548.82,-6446.48 4548.82,-6394.48 4757.82,-6394.48 4757.82,-6446.48"/>
<text text-anchor="middle" x="4653.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4653.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4653.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4653.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_14 -->
<g id="node638" class="node">
<title>layer_9_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4656.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4656.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4656.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4656.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4656.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_14_gpu15&#45;&gt;layer_9_all2all_back_14 -->
<g id="edge856" class="edge">
<title>layer_9_expert_14_gpu15&#45;&gt;layer_9_all2all_back_14</title>
<path fill="none" stroke="black" d="M4654.1,-6394.31C4654.34,-6386.5 4654.62,-6377.63 4654.89,-6368.86"/>
<polygon fill="black" stroke="black" points="4658.39,-6368.79 4655.21,-6358.68 4651.4,-6368.57 4658.39,-6368.79"/>
</g>
<!-- layer_9_all2all_expert_14&#45;&gt;layer_9_expert_14_gpu15 -->
<g id="edge839" class="edge">
<title>layer_9_all2all_expert_14&#45;&gt;layer_9_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4651.44,-6482.21C4651.7,-6473.9 4651.97,-6465.07 4652.23,-6456.79"/>
<polygon fill="black" stroke="black" points="4655.73,-6456.78 4652.54,-6446.67 4648.73,-6456.56 4655.73,-6456.78"/>
</g>
<!-- layer_9_expert_15_gpu15 -->
<g id="node622" class="node">
<title>layer_9_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5078.82,-6446.48 4869.82,-6446.48 4869.82,-6394.48 5078.82,-6394.48 5078.82,-6446.48"/>
<text text-anchor="middle" x="4974.32" y="-6434.48" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4974.32" y="-6423.48" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4974.32" y="-6412.48" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4974.32" y="-6401.48" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_15 -->
<g id="node639" class="node">
<title>layer_9_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4977.32" cy="-6321.71" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4977.32" y="-6335.71" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4977.32" y="-6324.71" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4977.32" y="-6313.71" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4977.32" y="-6302.71" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_expert_15_gpu15&#45;&gt;layer_9_all2all_back_15 -->
<g id="edge857" class="edge">
<title>layer_9_expert_15_gpu15&#45;&gt;layer_9_all2all_back_15</title>
<path fill="none" stroke="black" d="M4975.1,-6394.31C4975.34,-6386.5 4975.62,-6377.63 4975.89,-6368.86"/>
<polygon fill="black" stroke="black" points="4979.39,-6368.79 4976.21,-6358.68 4972.4,-6368.57 4979.39,-6368.79"/>
</g>
<!-- layer_9_all2all_expert_15&#45;&gt;layer_9_expert_15_gpu15 -->
<g id="edge841" class="edge">
<title>layer_9_all2all_expert_15&#45;&gt;layer_9_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4972.44,-6482.21C4972.7,-6473.9 4972.97,-6465.07 4973.23,-6456.79"/>
<polygon fill="black" stroke="black" points="4976.73,-6456.78 4973.54,-6446.67 4969.73,-6456.56 4976.73,-6456.78"/>
</g>
<!-- layer_9_output -->
<g id="node640" class="node">
<title>layer_9_output</title>
<polygon fill="lightblue" stroke="black" points="2676.32,-6248.94 2462.32,-6248.94 2462.32,-6196.94 2676.32,-6196.94 2676.32,-6248.94"/>
<text text-anchor="middle" x="2569.32" y="-6236.94" font-family="Arial" font-size="10.00">Layer 9 Output</text>
<text text-anchor="middle" x="2569.32" y="-6225.94" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2569.32" y="-6214.94" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2569.32" y="-6203.94" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_9_all2all_back_0&#45;&gt;layer_9_output -->
<g id="edge858" class="edge">
<title>layer_9_all2all_back_0&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M265.31,-6294.76C284.48,-6290.81 304.42,-6287.27 323.32,-6284.94 741.21,-6233.33 2051.59,-6225.38 2451.96,-6224.16"/>
<polygon fill="black" stroke="black" points="2452.12,-6227.66 2462.11,-6224.13 2452.1,-6220.66 2452.12,-6227.66"/>
</g>
<!-- layer_9_all2all_back_1&#45;&gt;layer_9_output -->
<g id="edge859" class="edge">
<title>layer_9_all2all_back_1&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M586.75,-6294.74C605.79,-6290.82 625.57,-6287.3 644.32,-6284.94 996.84,-6240.59 2090.7,-6227.83 2452.1,-6224.78"/>
<polygon fill="black" stroke="black" points="2452.35,-6228.28 2462.32,-6224.7 2452.29,-6221.28 2452.35,-6228.28"/>
</g>
<!-- layer_9_all2all_back_2&#45;&gt;layer_9_output -->
<g id="edge860" class="edge">
<title>layer_9_all2all_back_2&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M907.76,-6294.84C926.8,-6290.91 946.58,-6287.36 965.32,-6284.94 1252.83,-6247.84 2132.45,-6230.75 2451.86,-6225.65"/>
<polygon fill="black" stroke="black" points="2452.12,-6229.15 2462.06,-6225.49 2452.01,-6222.15 2452.12,-6229.15"/>
</g>
<!-- layer_9_all2all_back_3&#45;&gt;layer_9_output -->
<g id="edge861" class="edge">
<title>layer_9_all2all_back_3&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M1229.21,-6294.9C1248.12,-6290.98 1267.73,-6287.43 1286.32,-6284.94 1509.45,-6255.07 2178.68,-6234.37 2451.55,-6226.96"/>
<polygon fill="black" stroke="black" points="2451.98,-6230.45 2461.88,-6226.68 2451.79,-6223.45 2451.98,-6230.45"/>
</g>
<!-- layer_9_all2all_back_4&#45;&gt;layer_9_output -->
<g id="edge862" class="edge">
<title>layer_9_all2all_back_4&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M1550.68,-6295.05C1569.45,-6291.15 1588.89,-6287.55 1607.32,-6284.94 1909.78,-6242.01 2270.05,-6229.29 2451.88,-6225.52"/>
<polygon fill="black" stroke="black" points="2452.07,-6229.02 2462,-6225.32 2451.93,-6222.02 2452.07,-6229.02"/>
</g>
<!-- layer_9_all2all_back_5&#45;&gt;layer_9_output -->
<g id="edge863" class="edge">
<title>layer_9_all2all_back_5&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M1873.05,-6295.26C1891.41,-6291.41 1910.36,-6287.78 1928.32,-6284.94 2110.01,-6256.22 2322.95,-6239.22 2451.91,-6230.74"/>
<polygon fill="black" stroke="black" points="2452.45,-6234.21 2462.2,-6230.07 2451.99,-6227.22 2452.45,-6234.21"/>
</g>
<!-- layer_9_all2all_back_6&#45;&gt;layer_9_output -->
<g id="edge864" class="edge">
<title>layer_9_all2all_back_6&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M2197.35,-6296.02C2214.71,-6292.22 2232.5,-6288.41 2249.32,-6284.94 2316.35,-6271.11 2391.51,-6256.72 2452.14,-6245.4"/>
<polygon fill="black" stroke="black" points="2452.94,-6248.81 2462.13,-6243.53 2451.66,-6241.93 2452.94,-6248.81"/>
</g>
<!-- layer_9_all2all_back_7&#45;&gt;layer_9_output -->
<g id="edge865" class="edge">
<title>layer_9_all2all_back_7&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M2464.38,-6287.41C2482.09,-6276.7 2501.6,-6264.89 2518.95,-6254.4"/>
<polygon fill="black" stroke="black" points="2521.06,-6257.22 2527.81,-6249.05 2517.44,-6251.23 2521.06,-6257.22"/>
</g>
<!-- layer_9_all2all_back_8&#45;&gt;layer_9_output -->
<g id="edge866" class="edge">
<title>layer_9_all2all_back_8&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M2674.91,-6287.41C2657.1,-6276.7 2637.46,-6264.89 2620,-6254.4"/>
<polygon fill="black" stroke="black" points="2621.47,-6251.2 2611.09,-6249.05 2617.86,-6257.2 2621.47,-6251.2"/>
</g>
<!-- layer_9_all2all_back_9&#45;&gt;layer_9_output -->
<g id="edge867" class="edge">
<title>layer_9_all2all_back_9&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M2942.3,-6296.01C2924.93,-6292.21 2907.15,-6288.41 2890.32,-6284.94 2822.96,-6271.06 2747.39,-6256.64 2686.51,-6245.31"/>
<polygon fill="black" stroke="black" points="2686.96,-6241.83 2676.48,-6243.45 2685.68,-6248.72 2686.96,-6241.83"/>
</g>
<!-- layer_9_all2all_back_10&#45;&gt;layer_9_output -->
<g id="edge868" class="edge">
<title>layer_9_all2all_back_10&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M3266.59,-6295.26C3248.24,-6291.41 3229.28,-6287.78 3211.32,-6284.94 3029.22,-6256.17 2815.76,-6239.17 2686.63,-6230.71"/>
<polygon fill="black" stroke="black" points="2686.53,-6227.19 2676.33,-6230.04 2686.08,-6234.18 2686.53,-6227.19"/>
</g>
<!-- layer_9_all2all_back_11&#45;&gt;layer_9_output -->
<g id="edge869" class="edge">
<title>layer_9_all2all_back_11&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M3588.96,-6295.05C3570.2,-6291.15 3550.75,-6287.55 3532.32,-6284.94 3229.34,-6241.95 2868.42,-6229.25 2686.52,-6225.51"/>
<polygon fill="black" stroke="black" points="2686.46,-6222 2676.39,-6225.3 2686.32,-6229 2686.46,-6222"/>
</g>
<!-- layer_9_all2all_back_12&#45;&gt;layer_9_output -->
<g id="edge870" class="edge">
<title>layer_9_all2all_back_12&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M3910.43,-6294.9C3891.53,-6290.98 3871.91,-6287.43 3853.32,-6284.94 3629.88,-6255.03 2959.45,-6234.34 2686.68,-6226.94"/>
<polygon fill="black" stroke="black" points="2686.45,-6223.43 2676.36,-6226.66 2686.26,-6230.43 2686.45,-6223.43"/>
</g>
<!-- layer_9_all2all_back_13&#45;&gt;layer_9_output -->
<g id="edge871" class="edge">
<title>layer_9_all2all_back_13&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M4231.88,-6294.84C4212.84,-6290.91 4193.06,-6287.36 4174.32,-6284.94 3886.54,-6247.81 3005.94,-6230.74 2686.57,-6225.65"/>
<polygon fill="black" stroke="black" points="2686.42,-6222.14 2676.37,-6225.48 2686.31,-6229.14 2686.42,-6222.14"/>
</g>
<!-- layer_9_all2all_back_14&#45;&gt;layer_9_output -->
<g id="edge872" class="edge">
<title>layer_9_all2all_back_14&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M4552.89,-6294.74C4533.85,-6290.82 4514.07,-6287.3 4495.32,-6284.94 4142.62,-6240.57 3048.19,-6227.83 2686.6,-6224.78"/>
<polygon fill="black" stroke="black" points="2686.41,-6221.28 2676.38,-6224.69 2686.35,-6228.28 2686.41,-6221.28"/>
</g>
<!-- layer_9_all2all_back_15&#45;&gt;layer_9_output -->
<g id="edge873" class="edge">
<title>layer_9_all2all_back_15&#45;&gt;layer_9_output</title>
<path fill="none" stroke="black" d="M4874.33,-6294.76C4855.16,-6290.81 4835.22,-6287.27 4816.32,-6284.94 4398.25,-6233.31 3087.28,-6225.38 2686.73,-6224.16"/>
<polygon fill="black" stroke="black" points="2686.59,-6220.66 2676.58,-6224.13 2686.57,-6227.66 2686.59,-6220.66"/>
</g>
<!-- layer_10_tp_gather -->
<g id="node642" class="node">
<title>layer_10_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2569.32" cy="-6124.17" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2569.32" y="-6138.17" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2569.32" y="-6127.17" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2569.32" y="-6116.17" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2569.32" y="-6105.17" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_9_output&#45;&gt;layer_10_tp_gather -->
<g id="edge874" class="edge">
<title>layer_9_output&#45;&gt;layer_10_tp_gather</title>
<path fill="none" stroke="black" d="M2551.3,-6196.77C2549.64,-6188.79 2548.91,-6179.71 2549.1,-6170.76"/>
<polygon fill="black" stroke="black" points="2552.59,-6170.97 2549.71,-6160.78 2545.61,-6170.55 2552.59,-6170.97"/>
</g>
<!-- layer_9_output&#45;&gt;layer_10_tp_gather -->
<g id="edge876" class="edge">
<title>layer_9_output&#45;&gt;layer_10_tp_gather</title>
<path fill="none" stroke="black" d="M2563.32,-6196.77C2562.77,-6188.96 2562.53,-6180.09 2562.58,-6171.32"/>
<polygon fill="black" stroke="black" points="2566.08,-6171.21 2562.77,-6161.15 2559.08,-6171.08 2566.08,-6171.21"/>
</g>
<!-- layer_9_output&#45;&gt;layer_10_tp_gather -->
<g id="edge878" class="edge">
<title>layer_9_output&#45;&gt;layer_10_tp_gather</title>
<path fill="none" stroke="black" d="M2575.33,-6196.77C2575.87,-6188.96 2576.11,-6180.09 2576.06,-6171.32"/>
<polygon fill="black" stroke="black" points="2579.56,-6171.08 2575.87,-6161.15 2572.56,-6171.21 2579.56,-6171.08"/>
</g>
<!-- layer_9_output&#45;&gt;layer_10_tp_gather -->
<g id="edge880" class="edge">
<title>layer_9_output&#45;&gt;layer_10_tp_gather</title>
<path fill="none" stroke="black" d="M2587.34,-6196.77C2589,-6188.79 2589.73,-6179.71 2589.54,-6170.76"/>
<polygon fill="black" stroke="black" points="2593.03,-6170.55 2588.93,-6160.78 2586.05,-6170.97 2593.03,-6170.55"/>
</g>
<!-- layer_10_qkv_gpu4 -->
<g id="node641" class="node">
<title>layer_10_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2332.32,-6051.4 2126.32,-6051.4 2126.32,-5999.4 2332.32,-5999.4 2332.32,-6051.4"/>
<text text-anchor="middle" x="2229.32" y="-6039.4" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2229.32" y="-6028.4" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2229.32" y="-6017.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2229.32" y="-6006.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_10_attn_gpu4 -->
<g id="node646" class="node">
<title>layer_10_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2326.32,-5963.4 2124.32,-5963.4 2124.32,-5911.4 2326.32,-5911.4 2326.32,-5963.4"/>
<text text-anchor="middle" x="2225.32" y="-5951.4" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2225.32" y="-5940.4" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2225.32" y="-5929.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2225.32" y="-5918.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_10_qkv_gpu4&#45;&gt;layer_10_attn_gpu4 -->
<g id="edge882" class="edge">
<title>layer_10_qkv_gpu4&#45;&gt;layer_10_attn_gpu4</title>
<path fill="none" stroke="black" d="M2228.14,-5999.06C2227.77,-5991.1 2227.36,-5982.16 2226.96,-5973.64"/>
<polygon fill="black" stroke="black" points="2230.45,-5973.38 2226.49,-5963.56 2223.46,-5973.71 2230.45,-5973.38"/>
</g>
<!-- layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu4 -->
<g id="edge875" class="edge">
<title>layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2472.8,-6095.7C2427.16,-6082.71 2372.77,-6067.23 2326.99,-6054.2"/>
<polygon fill="black" stroke="black" points="2327.93,-6050.83 2317.36,-6051.46 2326.02,-6057.56 2327.93,-6050.83"/>
</g>
<!-- layer_10_qkv_gpu5 -->
<g id="node643" class="node">
<title>layer_10_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2559.32,-6051.4 2353.32,-6051.4 2353.32,-5999.4 2559.32,-5999.4 2559.32,-6051.4"/>
<text text-anchor="middle" x="2456.32" y="-6039.4" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2456.32" y="-6028.4" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2456.32" y="-6017.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2456.32" y="-6006.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu5 -->
<g id="edge877" class="edge">
<title>layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2528.84,-6088.51C2517.22,-6078.55 2504.6,-6067.74 2493.2,-6057.98"/>
<polygon fill="black" stroke="black" points="2495.4,-6055.26 2485.53,-6051.41 2490.85,-6060.58 2495.4,-6055.26"/>
</g>
<!-- layer_10_qkv_gpu6 -->
<g id="node644" class="node">
<title>layer_10_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2785.32,-6051.4 2579.32,-6051.4 2579.32,-5999.4 2785.32,-5999.4 2785.32,-6051.4"/>
<text text-anchor="middle" x="2682.32" y="-6039.4" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2682.32" y="-6028.4" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2682.32" y="-6017.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2682.32" y="-6006.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu6 -->
<g id="edge879" class="edge">
<title>layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2609.8,-6088.51C2621.43,-6078.55 2634.04,-6067.74 2645.44,-6057.98"/>
<polygon fill="black" stroke="black" points="2647.79,-6060.58 2653.11,-6051.41 2643.24,-6055.26 2647.79,-6060.58"/>
</g>
<!-- layer_10_qkv_gpu7 -->
<g id="node645" class="node">
<title>layer_10_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3010.32,-6051.4 2804.32,-6051.4 2804.32,-5999.4 3010.32,-5999.4 3010.32,-6051.4"/>
<text text-anchor="middle" x="2907.32" y="-6039.4" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2907.32" y="-6028.4" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2907.32" y="-6017.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2907.32" y="-6006.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu7 -->
<g id="edge881" class="edge">
<title>layer_10_tp_gather&#45;&gt;layer_10_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2665.27,-6095.7C2710.55,-6082.74 2764.49,-6067.29 2809.94,-6054.28"/>
<polygon fill="black" stroke="black" points="2811.15,-6057.57 2819.8,-6051.46 2809.23,-6050.84 2811.15,-6057.57"/>
</g>
<!-- layer_10_attn_gpu5 -->
<g id="node647" class="node">
<title>layer_10_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2555.32,-5963.4 2353.32,-5963.4 2353.32,-5911.4 2555.32,-5911.4 2555.32,-5963.4"/>
<text text-anchor="middle" x="2454.32" y="-5951.4" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2454.32" y="-5940.4" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2454.32" y="-5929.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2454.32" y="-5918.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_10_qkv_gpu5&#45;&gt;layer_10_attn_gpu5 -->
<g id="edge883" class="edge">
<title>layer_10_qkv_gpu5&#45;&gt;layer_10_attn_gpu5</title>
<path fill="none" stroke="black" d="M2455.73,-5999.06C2455.55,-5991.1 2455.34,-5982.16 2455.14,-5973.64"/>
<polygon fill="black" stroke="black" points="2458.64,-5973.47 2454.91,-5963.56 2451.64,-5973.63 2458.64,-5973.47"/>
</g>
<!-- layer_10_attn_gpu6 -->
<g id="node648" class="node">
<title>layer_10_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2786.32,-5963.4 2584.32,-5963.4 2584.32,-5911.4 2786.32,-5911.4 2786.32,-5963.4"/>
<text text-anchor="middle" x="2685.32" y="-5951.4" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2685.32" y="-5940.4" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2685.32" y="-5929.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2685.32" y="-5918.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_10_qkv_gpu6&#45;&gt;layer_10_attn_gpu6 -->
<g id="edge884" class="edge">
<title>layer_10_qkv_gpu6&#45;&gt;layer_10_attn_gpu6</title>
<path fill="none" stroke="black" d="M2683.2,-5999.06C2683.48,-5991.1 2683.79,-5982.16 2684.09,-5973.64"/>
<polygon fill="black" stroke="black" points="2687.59,-5973.67 2684.44,-5963.56 2680.6,-5973.43 2687.59,-5973.67"/>
</g>
<!-- layer_10_attn_gpu7 -->
<g id="node649" class="node">
<title>layer_10_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3008.32,-5963.4 2806.32,-5963.4 2806.32,-5911.4 3008.32,-5911.4 3008.32,-5963.4"/>
<text text-anchor="middle" x="2907.32" y="-5951.4" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2907.32" y="-5940.4" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2907.32" y="-5929.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2907.32" y="-5918.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_10_qkv_gpu7&#45;&gt;layer_10_attn_gpu7 -->
<g id="edge885" class="edge">
<title>layer_10_qkv_gpu7&#45;&gt;layer_10_attn_gpu7</title>
<path fill="none" stroke="black" d="M2907.32,-5999.06C2907.32,-5991.1 2907.32,-5982.16 2907.32,-5973.64"/>
<polygon fill="black" stroke="black" points="2910.82,-5973.56 2907.32,-5963.56 2903.82,-5973.56 2910.82,-5973.56"/>
</g>
<!-- layer_10_attn_out_gpu4 -->
<g id="node650" class="node">
<title>layer_10_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2329.32,-5875.4 2115.32,-5875.4 2115.32,-5823.4 2329.32,-5823.4 2329.32,-5875.4"/>
<text text-anchor="middle" x="2222.32" y="-5863.4" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2222.32" y="-5852.4" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2222.32" y="-5841.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2222.32" y="-5830.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_attn_gpu4&#45;&gt;layer_10_attn_out_gpu4 -->
<g id="edge886" class="edge">
<title>layer_10_attn_gpu4&#45;&gt;layer_10_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2224.44,-5911.06C2224.16,-5903.1 2223.85,-5894.16 2223.55,-5885.64"/>
<polygon fill="black" stroke="black" points="2227.04,-5885.43 2223.2,-5875.56 2220.05,-5885.67 2227.04,-5885.43"/>
</g>
<!-- layer_10_attn_out_gpu5 -->
<g id="node651" class="node">
<title>layer_10_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2561.32,-5875.4 2347.32,-5875.4 2347.32,-5823.4 2561.32,-5823.4 2561.32,-5875.4"/>
<text text-anchor="middle" x="2454.32" y="-5863.4" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2454.32" y="-5852.4" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2454.32" y="-5841.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2454.32" y="-5830.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_attn_gpu5&#45;&gt;layer_10_attn_out_gpu5 -->
<g id="edge887" class="edge">
<title>layer_10_attn_gpu5&#45;&gt;layer_10_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2454.32,-5911.06C2454.32,-5903.1 2454.32,-5894.16 2454.32,-5885.64"/>
<polygon fill="black" stroke="black" points="2457.82,-5885.56 2454.32,-5875.56 2450.82,-5885.56 2457.82,-5885.56"/>
</g>
<!-- layer_10_attn_out_gpu6 -->
<g id="node652" class="node">
<title>layer_10_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2793.32,-5875.4 2579.32,-5875.4 2579.32,-5823.4 2793.32,-5823.4 2793.32,-5875.4"/>
<text text-anchor="middle" x="2686.32" y="-5863.4" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2686.32" y="-5852.4" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2686.32" y="-5841.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2686.32" y="-5830.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_attn_gpu6&#45;&gt;layer_10_attn_out_gpu6 -->
<g id="edge888" class="edge">
<title>layer_10_attn_gpu6&#45;&gt;layer_10_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2685.62,-5911.06C2685.71,-5903.1 2685.81,-5894.16 2685.91,-5885.64"/>
<polygon fill="black" stroke="black" points="2689.41,-5885.6 2686.03,-5875.56 2682.41,-5885.51 2689.41,-5885.6"/>
</g>
<!-- layer_10_attn_out_gpu7 -->
<g id="node653" class="node">
<title>layer_10_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3025.32,-5875.4 2811.32,-5875.4 2811.32,-5823.4 3025.32,-5823.4 3025.32,-5875.4"/>
<text text-anchor="middle" x="2918.32" y="-5863.4" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2918.32" y="-5852.4" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2918.32" y="-5841.4" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2918.32" y="-5830.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_attn_gpu7&#45;&gt;layer_10_attn_out_gpu7 -->
<g id="edge889" class="edge">
<title>layer_10_attn_gpu7&#45;&gt;layer_10_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2910.56,-5911.06C2911.58,-5903.1 2912.72,-5894.16 2913.81,-5885.64"/>
<polygon fill="black" stroke="black" points="2917.31,-5885.92 2915.1,-5875.56 2910.36,-5885.03 2917.31,-5885.92"/>
</g>
<!-- layer_10_attn_allreduce -->
<g id="node654" class="node">
<title>layer_10_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2570.32" cy="-5750.63" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2570.32" y="-5764.63" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2570.32" y="-5753.63" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2570.32" y="-5742.63" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2570.32" y="-5731.63" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_attn_out_gpu4&#45;&gt;layer_10_attn_allreduce -->
<g id="edge890" class="edge">
<title>layer_10_attn_out_gpu4&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M2312.39,-5823.35C2358.36,-5810.57 2414.61,-5794.93 2462.84,-5781.52"/>
<polygon fill="black" stroke="black" points="2463.99,-5784.83 2472.69,-5778.78 2462.11,-5778.09 2463.99,-5784.83"/>
</g>
<!-- layer_10_attn_out_gpu5&#45;&gt;layer_10_attn_allreduce -->
<g id="edge891" class="edge">
<title>layer_10_attn_out_gpu5&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M2484.5,-5823.23C2495.73,-5813.86 2508.78,-5802.97 2521.26,-5792.55"/>
<polygon fill="black" stroke="black" points="2523.51,-5795.24 2528.94,-5786.15 2519.02,-5789.86 2523.51,-5795.24"/>
</g>
<!-- layer_10_attn_out_gpu6&#45;&gt;layer_10_attn_allreduce -->
<g id="edge892" class="edge">
<title>layer_10_attn_out_gpu6&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M2656.15,-5823.23C2644.92,-5813.86 2631.86,-5802.97 2619.38,-5792.55"/>
<polygon fill="black" stroke="black" points="2621.62,-5789.86 2611.7,-5786.15 2617.13,-5795.24 2621.62,-5789.86"/>
</g>
<!-- layer_10_attn_out_gpu7&#45;&gt;layer_10_attn_allreduce -->
<g id="edge893" class="edge">
<title>layer_10_attn_out_gpu7&#45;&gt;layer_10_attn_allreduce</title>
<path fill="none" stroke="black" d="M2828.25,-5823.35C2782.28,-5810.57 2726.03,-5794.93 2677.8,-5781.52"/>
<polygon fill="black" stroke="black" points="2678.53,-5778.09 2667.96,-5778.78 2676.65,-5784.83 2678.53,-5778.09"/>
</g>
<!-- layer_10_gate -->
<g id="node655" class="node">
<title>layer_10_gate</title>
<polygon fill="lightyellow" stroke="black" points="2787.18,-5677.86 2442.2,-5677.86 2353.46,-5573.86 2698.44,-5573.86 2787.18,-5677.86"/>
<text text-anchor="middle" x="2570.32" y="-5639.86" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2570.32" y="-5628.86" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2570.32" y="-5617.86" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2570.32" y="-5606.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_10_attn_allreduce&#45;&gt;layer_10_gate -->
<g id="edge894" class="edge">
<title>layer_10_attn_allreduce&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2551.76,-5714.12C2550.65,-5706.08 2550.08,-5697.31 2550.07,-5688.53"/>
<polygon fill="black" stroke="black" points="2553.58,-5688.35 2550.31,-5678.27 2546.58,-5688.19 2553.58,-5688.35"/>
</g>
<!-- layer_10_attn_allreduce&#45;&gt;layer_10_gate -->
<g id="edge895" class="edge">
<title>layer_10_attn_allreduce&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2564.12,-5713.79C2563.75,-5705.75 2563.57,-5697 2563.57,-5688.25"/>
<polygon fill="black" stroke="black" points="2567.07,-5688.06 2563.65,-5678.03 2560.07,-5688 2567.07,-5688.06"/>
</g>
<!-- layer_10_attn_allreduce&#45;&gt;layer_10_gate -->
<g id="edge896" class="edge">
<title>layer_10_attn_allreduce&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2576.52,-5713.79C2576.89,-5705.75 2577.07,-5697 2577.07,-5688.25"/>
<polygon fill="black" stroke="black" points="2580.57,-5688 2576.99,-5678.03 2573.57,-5688.06 2580.57,-5688"/>
</g>
<!-- layer_10_attn_allreduce&#45;&gt;layer_10_gate -->
<g id="edge897" class="edge">
<title>layer_10_attn_allreduce&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2588.88,-5714.12C2589.99,-5706.08 2590.56,-5697.31 2590.57,-5688.53"/>
<polygon fill="black" stroke="black" points="2594.06,-5688.19 2590.33,-5678.27 2587.07,-5688.35 2594.06,-5688.19"/>
</g>
<!-- layer_10_all2all_expert_0 -->
<g id="node657" class="node">
<title>layer_10_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="179.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="179.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="179.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="179.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="179.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_0 -->
<g id="edge898" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2394.3,-5621.82C1941.25,-5613.38 742.92,-5586.98 348.32,-5537.86 330.62,-5535.66 312.02,-5532.55 293.89,-5529.07"/>
<polygon fill="black" stroke="black" points="294.37,-5525.59 283.88,-5527.1 293.02,-5532.46 294.37,-5525.59"/>
</g>
<!-- layer_10_all2all_expert_1 -->
<g id="node659" class="node">
<title>layer_10_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="505.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="505.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="505.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="505.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="505.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_1 -->
<g id="edge900" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2393.4,-5620.72C1986.93,-5610.58 996.04,-5582.04 665.32,-5537.86 649.78,-5535.78 633.53,-5532.95 617.58,-5529.77"/>
<polygon fill="black" stroke="black" points="618.2,-5526.33 607.7,-5527.75 616.8,-5533.18 618.2,-5526.33"/>
</g>
<!-- layer_10_all2all_expert_2 -->
<g id="node661" class="node">
<title>layer_10_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="822.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="822.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="822.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="822.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="822.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_2 -->
<g id="edge902" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2396.08,-5624.13C2103.92,-5620.93 1497.3,-5605.82 989.32,-5537.86 972.37,-5535.59 954.58,-5532.53 937.19,-5529.15"/>
<polygon fill="black" stroke="black" points="937.49,-5525.64 927,-5527.12 936.13,-5532.51 937.49,-5525.64"/>
</g>
<!-- layer_10_all2all_expert_3 -->
<g id="node663" class="node">
<title>layer_10_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1146.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1146.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1146.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1146.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1146.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_3 -->
<g id="edge904" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2393.61,-5620.95C2148.75,-5613.64 1692.94,-5593.27 1308.32,-5537.86 1292.62,-5535.6 1276.18,-5532.65 1260.04,-5529.43"/>
<polygon fill="black" stroke="black" points="1260.54,-5525.96 1250.04,-5527.38 1259.14,-5532.81 1260.54,-5525.96"/>
</g>
<!-- layer_10_all2all_expert_4 -->
<g id="node665" class="node">
<title>layer_10_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1465.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1465.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1465.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1465.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1465.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_4 -->
<g id="edge906" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.3,-5615.04C2197.38,-5603.13 1888.99,-5579.3 1625.32,-5537.86 1610.33,-5535.5 1594.64,-5532.58 1579.2,-5529.42"/>
<polygon fill="black" stroke="black" points="1579.6,-5525.93 1569.09,-5527.32 1578.17,-5532.78 1579.6,-5525.93"/>
</g>
<!-- layer_10_all2all_expert_5 -->
<g id="node667" class="node">
<title>layer_10_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1782.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1782.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1782.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1782.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1782.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_5 -->
<g id="edge908" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2377.68,-5602.59C2252.6,-5587.06 2086.29,-5564.41 1940.32,-5537.86 1926.27,-5535.3 1911.58,-5532.35 1897.05,-5529.27"/>
<polygon fill="black" stroke="black" points="1897.54,-5525.79 1887.02,-5527.11 1896.07,-5532.64 1897.54,-5525.79"/>
</g>
<!-- layer_10_all2all_expert_6 -->
<g id="node669" class="node">
<title>layer_10_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2097.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2097.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2097.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2097.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2097.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_6 -->
<g id="edge910" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2373.49,-5573.77C2316.78,-5559.05 2256.93,-5543.52 2207.5,-5530.69"/>
<polygon fill="black" stroke="black" points="2208.32,-5527.28 2197.76,-5528.16 2206.56,-5534.06 2208.32,-5527.28"/>
</g>
<!-- layer_10_all2all_expert_7 -->
<g id="node671" class="node">
<title>layer_10_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2412.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2412.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2412.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2412.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2412.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_7 -->
<g id="edge912" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2504.23,-5573.51C2491.05,-5563.27 2477.38,-5552.64 2464.73,-5542.82"/>
<polygon fill="black" stroke="black" points="2466.63,-5539.86 2456.59,-5536.49 2462.34,-5545.39 2466.63,-5539.86"/>
</g>
<!-- layer_10_all2all_expert_8 -->
<g id="node673" class="node">
<title>layer_10_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2728.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2728.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2728.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2728.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2728.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_8 -->
<g id="edge914" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2636.41,-5573.51C2649.59,-5563.27 2663.26,-5552.64 2675.91,-5542.82"/>
<polygon fill="black" stroke="black" points="2678.3,-5545.39 2684.05,-5536.49 2674.01,-5539.86 2678.3,-5545.39"/>
</g>
<!-- layer_10_all2all_expert_9 -->
<g id="node675" class="node">
<title>layer_10_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3046.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3046.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3046.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3046.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3046.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_9 -->
<g id="edge916" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2711.2,-5588.52C2782.93,-5570.02 2868.86,-5547.86 2935.74,-5530.61"/>
<polygon fill="black" stroke="black" points="2936.66,-5533.99 2945.47,-5528.1 2934.91,-5527.21 2936.66,-5533.99"/>
</g>
<!-- layer_10_all2all_expert_10 -->
<g id="node677" class="node">
<title>layer_10_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3366.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3366.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3366.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3366.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3366.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_10 -->
<g id="edge918" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2726.94,-5606.85C2855.38,-5591.23 3041.69,-5566.66 3203.32,-5537.86 3218.41,-5535.17 3234.23,-5532.07 3249.82,-5528.83"/>
<polygon fill="black" stroke="black" points="3250.96,-5532.17 3260.03,-5526.69 3249.53,-5525.32 3250.96,-5532.17"/>
</g>
<!-- layer_10_all2all_expert_11 -->
<g id="node679" class="node">
<title>layer_10_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3686.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3686.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3686.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3686.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3686.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_11 -->
<g id="edge920" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734.66,-5616.11C2925.19,-5604.53 3248.31,-5580.42 3523.32,-5537.86 3538.97,-5535.44 3555.37,-5532.42 3571.48,-5529.17"/>
<polygon fill="black" stroke="black" points="3572.37,-5532.56 3581.46,-5527.12 3570.96,-5525.7 3572.37,-5532.56"/>
</g>
<!-- layer_10_all2all_expert_12 -->
<g id="node681" class="node">
<title>layer_10_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4007.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4007.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4007.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4007.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4007.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_12 -->
<g id="edge922" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.97,-5621.19C2983.49,-5614.09 3450.21,-5593.86 3843.32,-5537.86 3859.45,-5535.56 3876.35,-5532.56 3892.92,-5529.28"/>
<polygon fill="black" stroke="black" points="3894.08,-5532.61 3903.19,-5527.2 3892.69,-5525.75 3894.08,-5532.61"/>
</g>
<!-- layer_10_all2all_expert_13 -->
<g id="node683" class="node">
<title>layer_10_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4328.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4328.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4328.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4328.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4328.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_13 -->
<g id="edge924" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2741.9,-5624.48C3034.89,-5621.83 3649.89,-5607.54 4164.32,-5537.86 4180.74,-5535.64 4197.95,-5532.64 4214.79,-5529.32"/>
<polygon fill="black" stroke="black" points="4215.55,-5532.73 4224.66,-5527.33 4214.16,-5525.87 4215.55,-5532.73"/>
</g>
<!-- layer_10_all2all_expert_14 -->
<g id="node685" class="node">
<title>layer_10_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4649.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4649.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4649.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4649.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4649.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_14 -->
<g id="edge926" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.76,-5620.87C3141.24,-5610.74 4150.17,-5581.7 4485.32,-5537.86 4501.75,-5535.71 4518.96,-5532.75 4535.81,-5529.45"/>
<polygon fill="black" stroke="black" points="4536.56,-5532.87 4545.68,-5527.47 4535.18,-5526.01 4536.56,-5532.87"/>
</g>
<!-- layer_10_all2all_expert_15 -->
<g id="node687" class="node">
<title>layer_10_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4970.32" cy="-5501.09" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4970.32" y="-5515.09" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4970.32" y="-5504.09" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4970.32" y="-5493.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4970.32" y="-5482.09" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_all2all_expert_15 -->
<g id="edge928" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2739.66,-5622.13C3189.48,-5614.26 4407.1,-5588.76 4806.32,-5537.86 4822.87,-5535.75 4840.23,-5532.79 4857.19,-5529.48"/>
<polygon fill="black" stroke="black" points="4858.01,-5532.88 4867.13,-5527.48 4856.64,-5526.02 4858.01,-5532.88"/>
</g>
<!-- layer_10_expert_0_gpu8 -->
<g id="node656" class="node">
<title>layer_10_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="268.82,-5428.32 59.82,-5428.32 59.82,-5376.32 268.82,-5376.32 268.82,-5428.32"/>
<text text-anchor="middle" x="164.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="164.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="164.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="164.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_0 -->
<g id="node688" class="node">
<title>layer_10_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="161.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="161.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="161.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="161.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="161.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_0_gpu8&#45;&gt;layer_10_all2all_back_0 -->
<g id="edge930" class="edge">
<title>layer_10_expert_0_gpu8&#45;&gt;layer_10_all2all_back_0</title>
<path fill="none" stroke="black" d="M163.54,-5376.15C163.3,-5368.34 163.02,-5359.47 162.75,-5350.71"/>
<polygon fill="black" stroke="black" points="166.24,-5350.41 162.44,-5340.53 159.25,-5350.63 166.24,-5350.41"/>
</g>
<!-- layer_10_all2all_expert_0&#45;&gt;layer_10_expert_0_gpu8 -->
<g id="edge899" class="edge">
<title>layer_10_all2all_expert_0&#45;&gt;layer_10_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M173.78,-5464.33C172.46,-5455.83 171.06,-5446.78 169.75,-5438.32"/>
<polygon fill="black" stroke="black" points="173.19,-5437.71 168.2,-5428.36 166.28,-5438.78 173.19,-5437.71"/>
</g>
<!-- layer_10_expert_1_gpu8 -->
<g id="node658" class="node">
<title>layer_10_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="588.82,-5428.32 379.82,-5428.32 379.82,-5376.32 588.82,-5376.32 588.82,-5428.32"/>
<text text-anchor="middle" x="484.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="484.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="484.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="484.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_1 -->
<g id="node689" class="node">
<title>layer_10_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="482.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="482.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="482.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="482.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="482.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_1_gpu8&#45;&gt;layer_10_all2all_back_1 -->
<g id="edge931" class="edge">
<title>layer_10_expert_1_gpu8&#45;&gt;layer_10_all2all_back_1</title>
<path fill="none" stroke="black" d="M483.8,-5376.15C483.64,-5368.34 483.46,-5359.47 483.27,-5350.71"/>
<polygon fill="black" stroke="black" points="486.77,-5350.45 483.06,-5340.53 479.77,-5350.6 486.77,-5350.45"/>
</g>
<!-- layer_10_all2all_expert_1&#45;&gt;layer_10_expert_1_gpu8 -->
<g id="edge901" class="edge">
<title>layer_10_all2all_expert_1&#45;&gt;layer_10_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M497.56,-5464.33C495.72,-5455.83 493.75,-5446.78 491.92,-5438.32"/>
<polygon fill="black" stroke="black" points="495.3,-5437.39 489.76,-5428.36 488.46,-5438.88 495.3,-5437.39"/>
</g>
<!-- layer_10_expert_2_gpu9 -->
<g id="node660" class="node">
<title>layer_10_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="909.82,-5428.32 700.82,-5428.32 700.82,-5376.32 909.82,-5376.32 909.82,-5428.32"/>
<text text-anchor="middle" x="805.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="805.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="805.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="805.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_2 -->
<g id="node690" class="node">
<title>layer_10_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="803.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="803.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="803.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="803.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="803.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_2_gpu9&#45;&gt;layer_10_all2all_back_2 -->
<g id="edge932" class="edge">
<title>layer_10_expert_2_gpu9&#45;&gt;layer_10_all2all_back_2</title>
<path fill="none" stroke="black" d="M804.8,-5376.15C804.64,-5368.34 804.46,-5359.47 804.27,-5350.71"/>
<polygon fill="black" stroke="black" points="807.77,-5350.45 804.06,-5340.53 800.77,-5350.6 807.77,-5350.45"/>
</g>
<!-- layer_10_all2all_expert_2&#45;&gt;layer_10_expert_2_gpu9 -->
<g id="edge903" class="edge">
<title>layer_10_all2all_expert_2&#45;&gt;layer_10_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M816.04,-5464.33C814.55,-5455.83 812.96,-5446.78 811.47,-5438.32"/>
<polygon fill="black" stroke="black" points="814.9,-5437.61 809.72,-5428.36 808,-5438.82 814.9,-5437.61"/>
</g>
<!-- layer_10_expert_3_gpu9 -->
<g id="node662" class="node">
<title>layer_10_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1238.82,-5428.32 1029.82,-5428.32 1029.82,-5376.32 1238.82,-5376.32 1238.82,-5428.32"/>
<text text-anchor="middle" x="1134.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1134.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1134.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1134.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_3 -->
<g id="node691" class="node">
<title>layer_10_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1124.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1124.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1124.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1124.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1124.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_3_gpu9&#45;&gt;layer_10_all2all_back_3 -->
<g id="edge933" class="edge">
<title>layer_10_expert_3_gpu9&#45;&gt;layer_10_all2all_back_3</title>
<path fill="none" stroke="black" d="M1131.72,-5376.15C1130.91,-5368.34 1130,-5359.47 1129.09,-5350.71"/>
<polygon fill="black" stroke="black" points="1132.55,-5350.12 1128.04,-5340.53 1125.59,-5350.83 1132.55,-5350.12"/>
</g>
<!-- layer_10_all2all_expert_3&#45;&gt;layer_10_expert_3_gpu9 -->
<g id="edge905" class="edge">
<title>layer_10_all2all_expert_3&#45;&gt;layer_10_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1141.89,-5464.33C1140.83,-5455.83 1139.71,-5446.78 1138.66,-5438.32"/>
<polygon fill="black" stroke="black" points="1142.13,-5437.86 1137.43,-5428.36 1135.18,-5438.72 1142.13,-5437.86"/>
</g>
<!-- layer_10_expert_4_gpu10 -->
<g id="node664" class="node">
<title>layer_10_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1559.82,-5428.32 1350.82,-5428.32 1350.82,-5376.32 1559.82,-5376.32 1559.82,-5428.32"/>
<text text-anchor="middle" x="1455.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1455.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1455.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1455.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_4 -->
<g id="node692" class="node">
<title>layer_10_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1445.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1445.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1445.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1445.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1445.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_4_gpu10&#45;&gt;layer_10_all2all_back_4 -->
<g id="edge934" class="edge">
<title>layer_10_expert_4_gpu10&#45;&gt;layer_10_all2all_back_4</title>
<path fill="none" stroke="black" d="M1452.72,-5376.15C1451.91,-5368.34 1451,-5359.47 1450.09,-5350.71"/>
<polygon fill="black" stroke="black" points="1453.55,-5350.12 1449.04,-5340.53 1446.59,-5350.83 1453.55,-5350.12"/>
</g>
<!-- layer_10_all2all_expert_4&#45;&gt;layer_10_expert_4_gpu10 -->
<g id="edge907" class="edge">
<title>layer_10_all2all_expert_4&#45;&gt;layer_10_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1461.63,-5464.33C1460.75,-5455.83 1459.81,-5446.78 1458.94,-5438.32"/>
<polygon fill="black" stroke="black" points="1462.42,-5437.95 1457.91,-5428.36 1455.46,-5438.67 1462.42,-5437.95"/>
</g>
<!-- layer_10_expert_5_gpu10 -->
<g id="node666" class="node">
<title>layer_10_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1877.82,-5428.32 1668.82,-5428.32 1668.82,-5376.32 1877.82,-5376.32 1877.82,-5428.32"/>
<text text-anchor="middle" x="1773.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1773.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1773.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1773.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_5 -->
<g id="node693" class="node">
<title>layer_10_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1766.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1766.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1766.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1766.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1766.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_5_gpu10&#45;&gt;layer_10_all2all_back_5 -->
<g id="edge935" class="edge">
<title>layer_10_expert_5_gpu10&#45;&gt;layer_10_all2all_back_5</title>
<path fill="none" stroke="black" d="M1771.5,-5376.15C1770.94,-5368.34 1770.29,-5359.47 1769.66,-5350.71"/>
<polygon fill="black" stroke="black" points="1773.14,-5350.25 1768.92,-5340.53 1766.15,-5350.75 1773.14,-5350.25"/>
</g>
<!-- layer_10_all2all_expert_5&#45;&gt;layer_10_expert_5_gpu10 -->
<g id="edge909" class="edge">
<title>layer_10_all2all_expert_5&#45;&gt;layer_10_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1778.97,-5464.06C1778.2,-5455.75 1777.37,-5446.91 1776.6,-5438.63"/>
<polygon fill="black" stroke="black" points="1780.08,-5438.15 1775.66,-5428.52 1773.11,-5438.8 1780.08,-5438.15"/>
</g>
<!-- layer_10_expert_6_gpu11 -->
<g id="node668" class="node">
<title>layer_10_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2198.82,-5428.32 1989.82,-5428.32 1989.82,-5376.32 2198.82,-5376.32 2198.82,-5428.32"/>
<text text-anchor="middle" x="2094.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2094.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2094.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_6 -->
<g id="node694" class="node">
<title>layer_10_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2087.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2087.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2087.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2087.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2087.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_6_gpu11&#45;&gt;layer_10_all2all_back_6 -->
<g id="edge936" class="edge">
<title>layer_10_expert_6_gpu11&#45;&gt;layer_10_all2all_back_6</title>
<path fill="none" stroke="black" d="M2092.5,-5376.15C2091.94,-5368.34 2091.29,-5359.47 2090.66,-5350.71"/>
<polygon fill="black" stroke="black" points="2094.14,-5350.25 2089.92,-5340.53 2087.15,-5350.75 2094.14,-5350.25"/>
</g>
<!-- layer_10_all2all_expert_6&#45;&gt;layer_10_expert_6_gpu11 -->
<g id="edge911" class="edge">
<title>layer_10_all2all_expert_6&#45;&gt;layer_10_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2096.2,-5464.06C2095.95,-5455.75 2095.67,-5446.91 2095.42,-5438.63"/>
<polygon fill="black" stroke="black" points="2098.91,-5438.4 2095.1,-5428.52 2091.91,-5438.62 2098.91,-5438.4"/>
</g>
<!-- layer_10_expert_7_gpu11 -->
<g id="node670" class="node">
<title>layer_10_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2513.82,-5428.32 2304.82,-5428.32 2304.82,-5376.32 2513.82,-5376.32 2513.82,-5428.32"/>
<text text-anchor="middle" x="2409.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2409.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2409.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2409.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_7 -->
<g id="node695" class="node">
<title>layer_10_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2408.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2408.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2408.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2408.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2408.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_7_gpu11&#45;&gt;layer_10_all2all_back_7 -->
<g id="edge937" class="edge">
<title>layer_10_expert_7_gpu11&#45;&gt;layer_10_all2all_back_7</title>
<path fill="none" stroke="black" d="M2409.06,-5376.15C2408.98,-5368.34 2408.89,-5359.47 2408.8,-5350.71"/>
<polygon fill="black" stroke="black" points="2412.3,-5350.49 2408.69,-5340.53 2405.3,-5350.56 2412.3,-5350.49"/>
</g>
<!-- layer_10_all2all_expert_7&#45;&gt;layer_10_expert_7_gpu11 -->
<g id="edge913" class="edge">
<title>layer_10_all2all_expert_7&#45;&gt;layer_10_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2411.2,-5464.06C2410.95,-5455.75 2410.67,-5446.91 2410.42,-5438.63"/>
<polygon fill="black" stroke="black" points="2413.91,-5438.4 2410.1,-5428.52 2406.91,-5438.62 2413.91,-5438.4"/>
</g>
<!-- layer_10_expert_8_gpu12 -->
<g id="node672" class="node">
<title>layer_10_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2832.82,-5428.32 2623.82,-5428.32 2623.82,-5376.32 2832.82,-5376.32 2832.82,-5428.32"/>
<text text-anchor="middle" x="2728.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2728.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2728.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2728.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_8 -->
<g id="node696" class="node">
<title>layer_10_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2729.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2729.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2729.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2729.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2729.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_8_gpu12&#45;&gt;layer_10_all2all_back_8 -->
<g id="edge938" class="edge">
<title>layer_10_expert_8_gpu12&#45;&gt;layer_10_all2all_back_8</title>
<path fill="none" stroke="black" d="M2728.58,-5376.15C2728.66,-5368.34 2728.75,-5359.47 2728.84,-5350.71"/>
<polygon fill="black" stroke="black" points="2732.35,-5350.56 2728.95,-5340.53 2725.35,-5350.49 2732.35,-5350.56"/>
</g>
<!-- layer_10_all2all_expert_8&#45;&gt;layer_10_expert_8_gpu12 -->
<g id="edge915" class="edge">
<title>layer_10_all2all_expert_8&#45;&gt;layer_10_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2728.32,-5464.06C2728.32,-5455.75 2728.32,-5446.91 2728.32,-5438.63"/>
<polygon fill="black" stroke="black" points="2731.82,-5438.52 2728.32,-5428.52 2724.82,-5438.52 2731.82,-5438.52"/>
</g>
<!-- layer_10_expert_9_gpu12 -->
<g id="node674" class="node">
<title>layer_10_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3152.82,-5428.32 2943.82,-5428.32 2943.82,-5376.32 3152.82,-5376.32 3152.82,-5428.32"/>
<text text-anchor="middle" x="3048.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3048.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3048.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3048.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_9 -->
<g id="node697" class="node">
<title>layer_10_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3050.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3050.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3050.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3050.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3050.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_9_gpu12&#45;&gt;layer_10_all2all_back_9 -->
<g id="edge939" class="edge">
<title>layer_10_expert_9_gpu12&#45;&gt;layer_10_all2all_back_9</title>
<path fill="none" stroke="black" d="M3048.84,-5376.15C3049,-5368.34 3049.19,-5359.47 3049.37,-5350.71"/>
<polygon fill="black" stroke="black" points="3052.87,-5350.6 3049.58,-5340.53 3045.87,-5350.45 3052.87,-5350.6"/>
</g>
<!-- layer_10_all2all_expert_9&#45;&gt;layer_10_expert_9_gpu12 -->
<g id="edge917" class="edge">
<title>layer_10_all2all_expert_9&#45;&gt;layer_10_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3047.07,-5464.06C3047.24,-5455.75 3047.42,-5446.91 3047.59,-5438.63"/>
<polygon fill="black" stroke="black" points="3051.09,-5438.59 3047.8,-5428.52 3044.09,-5438.44 3051.09,-5438.59"/>
</g>
<!-- layer_10_expert_10_gpu13 -->
<g id="node676" class="node">
<title>layer_10_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3473.82,-5428.32 3264.82,-5428.32 3264.82,-5376.32 3473.82,-5376.32 3473.82,-5428.32"/>
<text text-anchor="middle" x="3369.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3369.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3369.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3369.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_10 -->
<g id="node698" class="node">
<title>layer_10_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3371.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3371.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3371.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3371.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3371.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_10_gpu13&#45;&gt;layer_10_all2all_back_10 -->
<g id="edge940" class="edge">
<title>layer_10_expert_10_gpu13&#45;&gt;layer_10_all2all_back_10</title>
<path fill="none" stroke="black" d="M3369.84,-5376.15C3370,-5368.34 3370.19,-5359.47 3370.37,-5350.71"/>
<polygon fill="black" stroke="black" points="3373.87,-5350.6 3370.58,-5340.53 3366.87,-5350.45 3373.87,-5350.6"/>
</g>
<!-- layer_10_all2all_expert_10&#45;&gt;layer_10_expert_10_gpu13 -->
<g id="edge919" class="edge">
<title>layer_10_all2all_expert_10&#45;&gt;layer_10_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3367.44,-5464.06C3367.7,-5455.75 3367.97,-5446.91 3368.23,-5438.63"/>
<polygon fill="black" stroke="black" points="3371.73,-5438.62 3368.54,-5428.52 3364.73,-5438.4 3371.73,-5438.62"/>
</g>
<!-- layer_10_expert_11_gpu13 -->
<g id="node678" class="node">
<title>layer_10_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3793.82,-5428.32 3584.82,-5428.32 3584.82,-5376.32 3793.82,-5376.32 3793.82,-5428.32"/>
<text text-anchor="middle" x="3689.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3689.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3689.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3689.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_11 -->
<g id="node699" class="node">
<title>layer_10_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3692.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3692.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3692.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3692.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3692.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_11_gpu13&#45;&gt;layer_10_all2all_back_11 -->
<g id="edge941" class="edge">
<title>layer_10_expert_11_gpu13&#45;&gt;layer_10_all2all_back_11</title>
<path fill="none" stroke="black" d="M3690.1,-5376.15C3690.34,-5368.34 3690.62,-5359.47 3690.89,-5350.71"/>
<polygon fill="black" stroke="black" points="3694.39,-5350.63 3691.21,-5340.53 3687.4,-5350.41 3694.39,-5350.63"/>
</g>
<!-- layer_10_all2all_expert_11&#45;&gt;layer_10_expert_11_gpu13 -->
<g id="edge921" class="edge">
<title>layer_10_all2all_expert_11&#45;&gt;layer_10_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3687.44,-5464.06C3687.7,-5455.75 3687.97,-5446.91 3688.23,-5438.63"/>
<polygon fill="black" stroke="black" points="3691.73,-5438.62 3688.54,-5428.52 3684.73,-5438.4 3691.73,-5438.62"/>
</g>
<!-- layer_10_expert_12_gpu14 -->
<g id="node680" class="node">
<title>layer_10_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4114.82,-5428.32 3905.82,-5428.32 3905.82,-5376.32 4114.82,-5376.32 4114.82,-5428.32"/>
<text text-anchor="middle" x="4010.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4010.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4010.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4010.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_12 -->
<g id="node700" class="node">
<title>layer_10_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4013.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4013.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4013.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4013.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4013.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_12_gpu14&#45;&gt;layer_10_all2all_back_12 -->
<g id="edge942" class="edge">
<title>layer_10_expert_12_gpu14&#45;&gt;layer_10_all2all_back_12</title>
<path fill="none" stroke="black" d="M4011.1,-5376.15C4011.34,-5368.34 4011.62,-5359.47 4011.89,-5350.71"/>
<polygon fill="black" stroke="black" points="4015.39,-5350.63 4012.21,-5340.53 4008.4,-5350.41 4015.39,-5350.63"/>
</g>
<!-- layer_10_all2all_expert_12&#45;&gt;layer_10_expert_12_gpu14 -->
<g id="edge923" class="edge">
<title>layer_10_all2all_expert_12&#45;&gt;layer_10_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4008.44,-5464.06C4008.7,-5455.75 4008.97,-5446.91 4009.23,-5438.63"/>
<polygon fill="black" stroke="black" points="4012.73,-5438.62 4009.54,-5428.52 4005.73,-5438.4 4012.73,-5438.62"/>
</g>
<!-- layer_10_expert_13_gpu14 -->
<g id="node682" class="node">
<title>layer_10_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4435.82,-5428.32 4226.82,-5428.32 4226.82,-5376.32 4435.82,-5376.32 4435.82,-5428.32"/>
<text text-anchor="middle" x="4331.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4331.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4331.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4331.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_13 -->
<g id="node701" class="node">
<title>layer_10_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4334.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4334.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4334.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4334.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4334.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_13_gpu14&#45;&gt;layer_10_all2all_back_13 -->
<g id="edge943" class="edge">
<title>layer_10_expert_13_gpu14&#45;&gt;layer_10_all2all_back_13</title>
<path fill="none" stroke="black" d="M4332.1,-5376.15C4332.34,-5368.34 4332.62,-5359.47 4332.89,-5350.71"/>
<polygon fill="black" stroke="black" points="4336.39,-5350.63 4333.21,-5340.53 4329.4,-5350.41 4336.39,-5350.63"/>
</g>
<!-- layer_10_all2all_expert_13&#45;&gt;layer_10_expert_13_gpu14 -->
<g id="edge925" class="edge">
<title>layer_10_all2all_expert_13&#45;&gt;layer_10_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4329.44,-5464.06C4329.7,-5455.75 4329.97,-5446.91 4330.23,-5438.63"/>
<polygon fill="black" stroke="black" points="4333.73,-5438.62 4330.54,-5428.52 4326.73,-5438.4 4333.73,-5438.62"/>
</g>
<!-- layer_10_expert_14_gpu15 -->
<g id="node684" class="node">
<title>layer_10_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4756.82,-5428.32 4547.82,-5428.32 4547.82,-5376.32 4756.82,-5376.32 4756.82,-5428.32"/>
<text text-anchor="middle" x="4652.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4652.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4652.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4652.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_14 -->
<g id="node702" class="node">
<title>layer_10_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4655.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4655.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4655.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4655.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4655.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_14_gpu15&#45;&gt;layer_10_all2all_back_14 -->
<g id="edge944" class="edge">
<title>layer_10_expert_14_gpu15&#45;&gt;layer_10_all2all_back_14</title>
<path fill="none" stroke="black" d="M4653.1,-5376.15C4653.34,-5368.34 4653.62,-5359.47 4653.89,-5350.71"/>
<polygon fill="black" stroke="black" points="4657.39,-5350.63 4654.21,-5340.53 4650.4,-5350.41 4657.39,-5350.63"/>
</g>
<!-- layer_10_all2all_expert_14&#45;&gt;layer_10_expert_14_gpu15 -->
<g id="edge927" class="edge">
<title>layer_10_all2all_expert_14&#45;&gt;layer_10_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4650.44,-5464.06C4650.7,-5455.75 4650.97,-5446.91 4651.23,-5438.63"/>
<polygon fill="black" stroke="black" points="4654.73,-5438.62 4651.54,-5428.52 4647.73,-5438.4 4654.73,-5438.62"/>
</g>
<!-- layer_10_expert_15_gpu15 -->
<g id="node686" class="node">
<title>layer_10_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5077.82,-5428.32 4868.82,-5428.32 4868.82,-5376.32 5077.82,-5376.32 5077.82,-5428.32"/>
<text text-anchor="middle" x="4973.32" y="-5416.32" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4973.32" y="-5405.32" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4973.32" y="-5394.32" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4973.32" y="-5383.32" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_15 -->
<g id="node703" class="node">
<title>layer_10_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4976.32" cy="-5303.55" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4976.32" y="-5317.55" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4976.32" y="-5306.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4976.32" y="-5295.55" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4976.32" y="-5284.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_expert_15_gpu15&#45;&gt;layer_10_all2all_back_15 -->
<g id="edge945" class="edge">
<title>layer_10_expert_15_gpu15&#45;&gt;layer_10_all2all_back_15</title>
<path fill="none" stroke="black" d="M4974.1,-5376.15C4974.34,-5368.34 4974.62,-5359.47 4974.89,-5350.71"/>
<polygon fill="black" stroke="black" points="4978.39,-5350.63 4975.21,-5340.53 4971.4,-5350.41 4978.39,-5350.63"/>
</g>
<!-- layer_10_all2all_expert_15&#45;&gt;layer_10_expert_15_gpu15 -->
<g id="edge929" class="edge">
<title>layer_10_all2all_expert_15&#45;&gt;layer_10_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4971.44,-5464.06C4971.7,-5455.75 4971.97,-5446.91 4972.23,-5438.63"/>
<polygon fill="black" stroke="black" points="4975.73,-5438.62 4972.54,-5428.52 4968.73,-5438.4 4975.73,-5438.62"/>
</g>
<!-- layer_10_output -->
<g id="node704" class="node">
<title>layer_10_output</title>
<polygon fill="lightblue" stroke="black" points="2675.32,-5230.78 2461.32,-5230.78 2461.32,-5178.78 2675.32,-5178.78 2675.32,-5230.78"/>
<text text-anchor="middle" x="2568.32" y="-5218.78" font-family="Arial" font-size="10.00">Layer 10 Output</text>
<text text-anchor="middle" x="2568.32" y="-5207.78" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2568.32" y="-5196.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2568.32" y="-5185.78" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_10_all2all_back_0&#45;&gt;layer_10_output -->
<g id="edge946" class="edge">
<title>layer_10_all2all_back_0&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M264.31,-5276.61C283.48,-5272.65 303.42,-5269.12 322.32,-5266.78 740.21,-5215.17 2050.59,-5207.23 2450.96,-5206"/>
<polygon fill="black" stroke="black" points="2451.12,-5209.5 2461.11,-5205.97 2451.1,-5202.5 2451.12,-5209.5"/>
</g>
<!-- layer_10_all2all_back_1&#45;&gt;layer_10_output -->
<g id="edge947" class="edge">
<title>layer_10_all2all_back_1&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M585.75,-5276.59C604.79,-5272.66 624.57,-5269.14 643.32,-5266.78 995.84,-5222.43 2089.7,-5209.68 2451.1,-5206.63"/>
<polygon fill="black" stroke="black" points="2451.35,-5210.12 2461.32,-5206.54 2451.29,-5203.12 2451.35,-5210.12"/>
</g>
<!-- layer_10_all2all_back_2&#45;&gt;layer_10_output -->
<g id="edge948" class="edge">
<title>layer_10_all2all_back_2&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M906.76,-5276.68C925.8,-5272.75 945.58,-5269.2 964.32,-5266.78 1251.83,-5229.69 2131.45,-5212.6 2450.86,-5207.5"/>
<polygon fill="black" stroke="black" points="2451.12,-5210.99 2461.06,-5207.33 2451.01,-5203.99 2451.12,-5210.99"/>
</g>
<!-- layer_10_all2all_back_3&#45;&gt;layer_10_output -->
<g id="edge949" class="edge">
<title>layer_10_all2all_back_3&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M1228.21,-5276.74C1247.12,-5272.83 1266.73,-5269.27 1285.32,-5266.78 1508.45,-5236.92 2177.68,-5216.22 2450.55,-5208.8"/>
<polygon fill="black" stroke="black" points="2450.98,-5212.29 2460.88,-5208.52 2450.79,-5205.29 2450.98,-5212.29"/>
</g>
<!-- layer_10_all2all_back_4&#45;&gt;layer_10_output -->
<g id="edge950" class="edge">
<title>layer_10_all2all_back_4&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M1549.68,-5276.9C1568.45,-5272.99 1587.89,-5269.4 1606.32,-5266.78 1908.78,-5223.86 2269.05,-5211.13 2450.88,-5207.36"/>
<polygon fill="black" stroke="black" points="2451.07,-5210.86 2461,-5207.16 2450.93,-5203.86 2451.07,-5210.86"/>
</g>
<!-- layer_10_all2all_back_5&#45;&gt;layer_10_output -->
<g id="edge951" class="edge">
<title>layer_10_all2all_back_5&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M1872.05,-5277.11C1890.41,-5273.25 1909.36,-5269.62 1927.32,-5266.78 2109.01,-5238.07 2321.95,-5221.06 2450.91,-5212.58"/>
<polygon fill="black" stroke="black" points="2451.45,-5216.05 2461.2,-5211.91 2450.99,-5209.07 2451.45,-5216.05"/>
</g>
<!-- layer_10_all2all_back_6&#45;&gt;layer_10_output -->
<g id="edge952" class="edge">
<title>layer_10_all2all_back_6&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M2196.35,-5277.86C2213.71,-5274.06 2231.5,-5270.25 2248.32,-5266.78 2315.35,-5252.95 2390.51,-5238.57 2451.14,-5227.24"/>
<polygon fill="black" stroke="black" points="2451.94,-5230.65 2461.13,-5225.38 2450.66,-5223.77 2451.94,-5230.65"/>
</g>
<!-- layer_10_all2all_back_7&#45;&gt;layer_10_output -->
<g id="edge953" class="edge">
<title>layer_10_all2all_back_7&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M2463.38,-5269.25C2481.09,-5258.54 2500.6,-5246.74 2517.95,-5236.24"/>
<polygon fill="black" stroke="black" points="2520.06,-5239.06 2526.81,-5230.89 2516.44,-5233.07 2520.06,-5239.06"/>
</g>
<!-- layer_10_all2all_back_8&#45;&gt;layer_10_output -->
<g id="edge954" class="edge">
<title>layer_10_all2all_back_8&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M2673.91,-5269.25C2656.1,-5258.54 2636.46,-5246.74 2619,-5236.24"/>
<polygon fill="black" stroke="black" points="2620.47,-5233.04 2610.09,-5230.89 2616.86,-5239.04 2620.47,-5233.04"/>
</g>
<!-- layer_10_all2all_back_9&#45;&gt;layer_10_output -->
<g id="edge955" class="edge">
<title>layer_10_all2all_back_9&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M2941.3,-5277.85C2923.93,-5274.06 2906.15,-5270.25 2889.32,-5266.78 2821.96,-5252.9 2746.39,-5238.49 2685.51,-5227.16"/>
<polygon fill="black" stroke="black" points="2685.96,-5223.68 2675.48,-5225.29 2684.68,-5230.56 2685.96,-5223.68"/>
</g>
<!-- layer_10_all2all_back_10&#45;&gt;layer_10_output -->
<g id="edge956" class="edge">
<title>layer_10_all2all_back_10&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M3265.59,-5277.11C3247.24,-5273.25 3228.28,-5269.62 3210.32,-5266.78 3028.22,-5238.02 2814.76,-5221.02 2685.63,-5212.55"/>
<polygon fill="black" stroke="black" points="2685.53,-5209.04 2675.33,-5211.88 2685.08,-5216.02 2685.53,-5209.04"/>
</g>
<!-- layer_10_all2all_back_11&#45;&gt;layer_10_output -->
<g id="edge957" class="edge">
<title>layer_10_all2all_back_11&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M3587.96,-5276.9C3569.2,-5272.99 3549.75,-5269.4 3531.32,-5266.78 3228.34,-5223.79 2867.42,-5211.1 2685.52,-5207.35"/>
<polygon fill="black" stroke="black" points="2685.46,-5203.85 2675.39,-5207.15 2685.32,-5210.85 2685.46,-5203.85"/>
</g>
<!-- layer_10_all2all_back_12&#45;&gt;layer_10_output -->
<g id="edge958" class="edge">
<title>layer_10_all2all_back_12&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M3909.43,-5276.74C3890.53,-5272.83 3870.91,-5269.27 3852.32,-5266.78 3628.88,-5236.88 2958.45,-5216.18 2685.68,-5208.79"/>
<polygon fill="black" stroke="black" points="2685.45,-5205.28 2675.36,-5208.51 2685.26,-5212.28 2685.45,-5205.28"/>
</g>
<!-- layer_10_all2all_back_13&#45;&gt;layer_10_output -->
<g id="edge959" class="edge">
<title>layer_10_all2all_back_13&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M4230.88,-5276.68C4211.84,-5272.75 4192.06,-5269.2 4173.32,-5266.78 3885.54,-5229.66 3004.94,-5212.58 2685.57,-5207.49"/>
<polygon fill="black" stroke="black" points="2685.42,-5203.99 2675.37,-5207.33 2685.31,-5210.99 2685.42,-5203.99"/>
</g>
<!-- layer_10_all2all_back_14&#45;&gt;layer_10_output -->
<g id="edge960" class="edge">
<title>layer_10_all2all_back_14&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M4551.89,-5276.59C4532.85,-5272.66 4513.07,-5269.14 4494.32,-5266.78 4141.62,-5222.41 3047.19,-5209.67 2685.6,-5206.62"/>
<polygon fill="black" stroke="black" points="2685.41,-5203.12 2675.38,-5206.54 2685.35,-5210.12 2685.41,-5203.12"/>
</g>
<!-- layer_10_all2all_back_15&#45;&gt;layer_10_output -->
<g id="edge961" class="edge">
<title>layer_10_all2all_back_15&#45;&gt;layer_10_output</title>
<path fill="none" stroke="black" d="M4873.33,-5276.61C4854.16,-5272.65 4834.22,-5269.12 4815.32,-5266.78 4397.25,-5215.15 3086.28,-5207.22 2685.73,-5206"/>
<polygon fill="black" stroke="black" points="2685.59,-5202.5 2675.58,-5205.97 2685.57,-5209.5 2685.59,-5202.5"/>
</g>
<!-- layer_11_tp_gather -->
<g id="node706" class="node">
<title>layer_11_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2568.32" cy="-5106.01" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2568.32" y="-5120.01" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2568.32" y="-5109.01" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2568.32" y="-5098.01" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2568.32" y="-5087.01" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_10_output&#45;&gt;layer_11_tp_gather -->
<g id="edge962" class="edge">
<title>layer_10_output&#45;&gt;layer_11_tp_gather</title>
<path fill="none" stroke="black" d="M2550.3,-5178.61C2548.64,-5170.63 2547.91,-5161.56 2548.1,-5152.61"/>
<polygon fill="black" stroke="black" points="2551.59,-5152.82 2548.71,-5142.62 2544.61,-5152.39 2551.59,-5152.82"/>
</g>
<!-- layer_10_output&#45;&gt;layer_11_tp_gather -->
<g id="edge964" class="edge">
<title>layer_10_output&#45;&gt;layer_11_tp_gather</title>
<path fill="none" stroke="black" d="M2562.32,-5178.61C2561.77,-5170.8 2561.53,-5161.94 2561.58,-5153.17"/>
<polygon fill="black" stroke="black" points="2565.08,-5153.05 2561.77,-5142.99 2558.08,-5152.92 2565.08,-5153.05"/>
</g>
<!-- layer_10_output&#45;&gt;layer_11_tp_gather -->
<g id="edge966" class="edge">
<title>layer_10_output&#45;&gt;layer_11_tp_gather</title>
<path fill="none" stroke="black" d="M2574.33,-5178.61C2574.87,-5170.8 2575.11,-5161.94 2575.06,-5153.17"/>
<polygon fill="black" stroke="black" points="2578.56,-5152.92 2574.87,-5142.99 2571.56,-5153.05 2578.56,-5152.92"/>
</g>
<!-- layer_10_output&#45;&gt;layer_11_tp_gather -->
<g id="edge968" class="edge">
<title>layer_10_output&#45;&gt;layer_11_tp_gather</title>
<path fill="none" stroke="black" d="M2586.34,-5178.61C2588,-5170.63 2588.73,-5161.56 2588.54,-5152.61"/>
<polygon fill="black" stroke="black" points="2592.03,-5152.39 2587.93,-5142.62 2585.05,-5152.82 2592.03,-5152.39"/>
</g>
<!-- layer_11_qkv_gpu4 -->
<g id="node705" class="node">
<title>layer_11_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2331.32,-5033.24 2125.32,-5033.24 2125.32,-4981.24 2331.32,-4981.24 2331.32,-5033.24"/>
<text text-anchor="middle" x="2228.32" y="-5021.24" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2228.32" y="-5010.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2228.32" y="-4999.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2228.32" y="-4988.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_11_attn_gpu4 -->
<g id="node710" class="node">
<title>layer_11_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2325.32,-4945.24 2123.32,-4945.24 2123.32,-4893.24 2325.32,-4893.24 2325.32,-4945.24"/>
<text text-anchor="middle" x="2224.32" y="-4933.24" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2224.32" y="-4922.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2224.32" y="-4911.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2224.32" y="-4900.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_11_qkv_gpu4&#45;&gt;layer_11_attn_gpu4 -->
<g id="edge970" class="edge">
<title>layer_11_qkv_gpu4&#45;&gt;layer_11_attn_gpu4</title>
<path fill="none" stroke="black" d="M2227.14,-4980.91C2226.77,-4972.94 2226.36,-4964.01 2225.96,-4955.49"/>
<polygon fill="black" stroke="black" points="2229.45,-4955.23 2225.49,-4945.4 2222.46,-4955.55 2229.45,-4955.23"/>
</g>
<!-- layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu4 -->
<g id="edge963" class="edge">
<title>layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2471.8,-5077.54C2426.16,-5064.55 2371.77,-5049.07 2325.99,-5036.04"/>
<polygon fill="black" stroke="black" points="2326.93,-5032.67 2316.36,-5033.3 2325.02,-5039.4 2326.93,-5032.67"/>
</g>
<!-- layer_11_qkv_gpu5 -->
<g id="node707" class="node">
<title>layer_11_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2558.32,-5033.24 2352.32,-5033.24 2352.32,-4981.24 2558.32,-4981.24 2558.32,-5033.24"/>
<text text-anchor="middle" x="2455.32" y="-5021.24" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2455.32" y="-5010.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2455.32" y="-4999.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2455.32" y="-4988.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu5 -->
<g id="edge965" class="edge">
<title>layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2527.84,-5070.35C2516.22,-5060.39 2503.6,-5049.59 2492.2,-5039.83"/>
<polygon fill="black" stroke="black" points="2494.4,-5037.1 2484.53,-5033.26 2489.85,-5042.42 2494.4,-5037.1"/>
</g>
<!-- layer_11_qkv_gpu6 -->
<g id="node708" class="node">
<title>layer_11_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2784.32,-5033.24 2578.32,-5033.24 2578.32,-4981.24 2784.32,-4981.24 2784.32,-5033.24"/>
<text text-anchor="middle" x="2681.32" y="-5021.24" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2681.32" y="-5010.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2681.32" y="-4999.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2681.32" y="-4988.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu6 -->
<g id="edge967" class="edge">
<title>layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2608.8,-5070.35C2620.43,-5060.39 2633.04,-5049.59 2644.44,-5039.83"/>
<polygon fill="black" stroke="black" points="2646.79,-5042.42 2652.11,-5033.26 2642.24,-5037.1 2646.79,-5042.42"/>
</g>
<!-- layer_11_qkv_gpu7 -->
<g id="node709" class="node">
<title>layer_11_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3009.32,-5033.24 2803.32,-5033.24 2803.32,-4981.24 3009.32,-4981.24 3009.32,-5033.24"/>
<text text-anchor="middle" x="2906.32" y="-5021.24" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2906.32" y="-5010.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2906.32" y="-4999.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2906.32" y="-4988.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu7 -->
<g id="edge969" class="edge">
<title>layer_11_tp_gather&#45;&gt;layer_11_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2664.27,-5077.54C2709.55,-5064.58 2763.49,-5049.14 2808.94,-5036.12"/>
<polygon fill="black" stroke="black" points="2810.15,-5039.42 2818.8,-5033.3 2808.23,-5032.69 2810.15,-5039.42"/>
</g>
<!-- layer_11_attn_gpu5 -->
<g id="node711" class="node">
<title>layer_11_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2554.32,-4945.24 2352.32,-4945.24 2352.32,-4893.24 2554.32,-4893.24 2554.32,-4945.24"/>
<text text-anchor="middle" x="2453.32" y="-4933.24" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2453.32" y="-4922.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2453.32" y="-4911.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2453.32" y="-4900.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_11_qkv_gpu5&#45;&gt;layer_11_attn_gpu5 -->
<g id="edge971" class="edge">
<title>layer_11_qkv_gpu5&#45;&gt;layer_11_attn_gpu5</title>
<path fill="none" stroke="black" d="M2454.73,-4980.91C2454.55,-4972.94 2454.34,-4964.01 2454.14,-4955.49"/>
<polygon fill="black" stroke="black" points="2457.64,-4955.32 2453.91,-4945.4 2450.64,-4955.48 2457.64,-4955.32"/>
</g>
<!-- layer_11_attn_gpu6 -->
<g id="node712" class="node">
<title>layer_11_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2785.32,-4945.24 2583.32,-4945.24 2583.32,-4893.24 2785.32,-4893.24 2785.32,-4945.24"/>
<text text-anchor="middle" x="2684.32" y="-4933.24" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2684.32" y="-4922.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2684.32" y="-4911.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2684.32" y="-4900.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_11_qkv_gpu6&#45;&gt;layer_11_attn_gpu6 -->
<g id="edge972" class="edge">
<title>layer_11_qkv_gpu6&#45;&gt;layer_11_attn_gpu6</title>
<path fill="none" stroke="black" d="M2682.2,-4980.91C2682.48,-4972.94 2682.79,-4964.01 2683.09,-4955.49"/>
<polygon fill="black" stroke="black" points="2686.59,-4955.52 2683.44,-4945.4 2679.6,-4955.27 2686.59,-4955.52"/>
</g>
<!-- layer_11_attn_gpu7 -->
<g id="node713" class="node">
<title>layer_11_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3007.32,-4945.24 2805.32,-4945.24 2805.32,-4893.24 3007.32,-4893.24 3007.32,-4945.24"/>
<text text-anchor="middle" x="2906.32" y="-4933.24" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2906.32" y="-4922.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2906.32" y="-4911.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2906.32" y="-4900.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_11_qkv_gpu7&#45;&gt;layer_11_attn_gpu7 -->
<g id="edge973" class="edge">
<title>layer_11_qkv_gpu7&#45;&gt;layer_11_attn_gpu7</title>
<path fill="none" stroke="black" d="M2906.32,-4980.91C2906.32,-4972.94 2906.32,-4964.01 2906.32,-4955.49"/>
<polygon fill="black" stroke="black" points="2909.82,-4955.4 2906.32,-4945.4 2902.82,-4955.4 2909.82,-4955.4"/>
</g>
<!-- layer_11_attn_out_gpu4 -->
<g id="node714" class="node">
<title>layer_11_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2328.32,-4857.24 2114.32,-4857.24 2114.32,-4805.24 2328.32,-4805.24 2328.32,-4857.24"/>
<text text-anchor="middle" x="2221.32" y="-4845.24" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2221.32" y="-4834.24" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2221.32" y="-4823.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2221.32" y="-4812.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_attn_gpu4&#45;&gt;layer_11_attn_out_gpu4 -->
<g id="edge974" class="edge">
<title>layer_11_attn_gpu4&#45;&gt;layer_11_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2223.44,-4892.91C2223.16,-4884.94 2222.85,-4876.01 2222.55,-4867.49"/>
<polygon fill="black" stroke="black" points="2226.04,-4867.27 2222.2,-4857.4 2219.05,-4867.52 2226.04,-4867.27"/>
</g>
<!-- layer_11_attn_out_gpu5 -->
<g id="node715" class="node">
<title>layer_11_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2560.32,-4857.24 2346.32,-4857.24 2346.32,-4805.24 2560.32,-4805.24 2560.32,-4857.24"/>
<text text-anchor="middle" x="2453.32" y="-4845.24" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2453.32" y="-4834.24" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2453.32" y="-4823.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2453.32" y="-4812.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_attn_gpu5&#45;&gt;layer_11_attn_out_gpu5 -->
<g id="edge975" class="edge">
<title>layer_11_attn_gpu5&#45;&gt;layer_11_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2453.32,-4892.91C2453.32,-4884.94 2453.32,-4876.01 2453.32,-4867.49"/>
<polygon fill="black" stroke="black" points="2456.82,-4867.4 2453.32,-4857.4 2449.82,-4867.4 2456.82,-4867.4"/>
</g>
<!-- layer_11_attn_out_gpu6 -->
<g id="node716" class="node">
<title>layer_11_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2792.32,-4857.24 2578.32,-4857.24 2578.32,-4805.24 2792.32,-4805.24 2792.32,-4857.24"/>
<text text-anchor="middle" x="2685.32" y="-4845.24" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2685.32" y="-4834.24" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2685.32" y="-4823.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2685.32" y="-4812.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_attn_gpu6&#45;&gt;layer_11_attn_out_gpu6 -->
<g id="edge976" class="edge">
<title>layer_11_attn_gpu6&#45;&gt;layer_11_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2684.62,-4892.91C2684.71,-4884.94 2684.81,-4876.01 2684.91,-4867.49"/>
<polygon fill="black" stroke="black" points="2688.41,-4867.44 2685.03,-4857.4 2681.41,-4867.36 2688.41,-4867.44"/>
</g>
<!-- layer_11_attn_out_gpu7 -->
<g id="node717" class="node">
<title>layer_11_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3024.32,-4857.24 2810.32,-4857.24 2810.32,-4805.24 3024.32,-4805.24 3024.32,-4857.24"/>
<text text-anchor="middle" x="2917.32" y="-4845.24" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2917.32" y="-4834.24" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2917.32" y="-4823.24" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2917.32" y="-4812.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_attn_gpu7&#45;&gt;layer_11_attn_out_gpu7 -->
<g id="edge977" class="edge">
<title>layer_11_attn_gpu7&#45;&gt;layer_11_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2909.56,-4892.91C2910.58,-4884.94 2911.72,-4876.01 2912.81,-4867.49"/>
<polygon fill="black" stroke="black" points="2916.31,-4867.76 2914.1,-4857.4 2909.36,-4866.87 2916.31,-4867.76"/>
</g>
<!-- layer_11_attn_allreduce -->
<g id="node718" class="node">
<title>layer_11_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2569.32" cy="-4732.47" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2569.32" y="-4746.47" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2569.32" y="-4735.47" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2569.32" y="-4724.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2569.32" y="-4713.47" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_attn_out_gpu4&#45;&gt;layer_11_attn_allreduce -->
<g id="edge978" class="edge">
<title>layer_11_attn_out_gpu4&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M2311.39,-4805.2C2357.36,-4792.41 2413.61,-4776.77 2461.84,-4763.36"/>
<polygon fill="black" stroke="black" points="2462.99,-4766.67 2471.69,-4760.62 2461.11,-4759.93 2462.99,-4766.67"/>
</g>
<!-- layer_11_attn_out_gpu5&#45;&gt;layer_11_attn_allreduce -->
<g id="edge979" class="edge">
<title>layer_11_attn_out_gpu5&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M2483.5,-4805.07C2494.73,-4795.7 2507.78,-4784.81 2520.26,-4774.4"/>
<polygon fill="black" stroke="black" points="2522.51,-4777.08 2527.94,-4767.99 2518.02,-4771.71 2522.51,-4777.08"/>
</g>
<!-- layer_11_attn_out_gpu6&#45;&gt;layer_11_attn_allreduce -->
<g id="edge980" class="edge">
<title>layer_11_attn_out_gpu6&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M2655.15,-4805.07C2643.92,-4795.7 2630.86,-4784.81 2618.38,-4774.4"/>
<polygon fill="black" stroke="black" points="2620.62,-4771.71 2610.7,-4767.99 2616.13,-4777.08 2620.62,-4771.71"/>
</g>
<!-- layer_11_attn_out_gpu7&#45;&gt;layer_11_attn_allreduce -->
<g id="edge981" class="edge">
<title>layer_11_attn_out_gpu7&#45;&gt;layer_11_attn_allreduce</title>
<path fill="none" stroke="black" d="M2827.25,-4805.2C2781.28,-4792.41 2725.03,-4776.77 2676.8,-4763.36"/>
<polygon fill="black" stroke="black" points="2677.53,-4759.93 2666.96,-4760.62 2675.65,-4766.67 2677.53,-4759.93"/>
</g>
<!-- layer_11_gate -->
<g id="node719" class="node">
<title>layer_11_gate</title>
<polygon fill="lightyellow" stroke="black" points="2786.18,-4659.7 2441.2,-4659.7 2352.46,-4555.7 2697.44,-4555.7 2786.18,-4659.7"/>
<text text-anchor="middle" x="2569.32" y="-4621.7" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2569.32" y="-4610.7" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2569.32" y="-4599.7" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2569.32" y="-4588.7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_11_attn_allreduce&#45;&gt;layer_11_gate -->
<g id="edge982" class="edge">
<title>layer_11_attn_allreduce&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2550.76,-4695.96C2549.65,-4687.92 2549.08,-4679.15 2549.07,-4670.38"/>
<polygon fill="black" stroke="black" points="2552.58,-4670.2 2549.31,-4660.12 2545.58,-4670.03 2552.58,-4670.2"/>
</g>
<!-- layer_11_attn_allreduce&#45;&gt;layer_11_gate -->
<g id="edge983" class="edge">
<title>layer_11_attn_allreduce&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2563.12,-4695.63C2562.75,-4687.6 2562.57,-4678.85 2562.57,-4670.1"/>
<polygon fill="black" stroke="black" points="2566.07,-4669.9 2562.65,-4659.87 2559.07,-4669.84 2566.07,-4669.9"/>
</g>
<!-- layer_11_attn_allreduce&#45;&gt;layer_11_gate -->
<g id="edge984" class="edge">
<title>layer_11_attn_allreduce&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2575.52,-4695.63C2575.89,-4687.6 2576.07,-4678.85 2576.07,-4670.1"/>
<polygon fill="black" stroke="black" points="2579.57,-4669.84 2575.99,-4659.87 2572.57,-4669.9 2579.57,-4669.84"/>
</g>
<!-- layer_11_attn_allreduce&#45;&gt;layer_11_gate -->
<g id="edge985" class="edge">
<title>layer_11_attn_allreduce&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2587.88,-4695.96C2588.99,-4687.92 2589.56,-4679.15 2589.57,-4670.38"/>
<polygon fill="black" stroke="black" points="2593.06,-4670.03 2589.33,-4660.12 2586.07,-4670.2 2593.06,-4670.03"/>
</g>
<!-- layer_11_all2all_expert_0 -->
<g id="node721" class="node">
<title>layer_11_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="186.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="186.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="186.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="186.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="186.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_0 -->
<g id="edge986" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2393.28,-4603.58C1941.66,-4594.94 749.96,-4568.15 357.32,-4519.7 339.2,-4517.47 320.16,-4514.31 301.61,-4510.78"/>
<polygon fill="black" stroke="black" points="302.16,-4507.32 291.67,-4508.84 300.82,-4514.19 302.16,-4507.32"/>
</g>
<!-- layer_11_all2all_expert_1 -->
<g id="node723" class="node">
<title>layer_11_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="514.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="514.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="514.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="514.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="514.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_1 -->
<g id="edge988" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2392.21,-4602.38C1987.83,-4591.88 1006.32,-4562.71 678.32,-4519.7 661.9,-4517.55 644.68,-4514.59 627.83,-4511.29"/>
<polygon fill="black" stroke="black" points="628.46,-4507.84 617.97,-4509.31 627.08,-4514.71 628.46,-4507.84"/>
</g>
<!-- layer_11_all2all_expert_2 -->
<g id="node725" class="node">
<title>layer_11_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="835.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="835.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="835.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="835.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="835.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_2 -->
<g id="edge990" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2395.49,-4606.42C2104.41,-4603.87 1500.57,-4589.66 995.32,-4519.7 979.79,-4517.55 963.54,-4514.67 947.6,-4511.48"/>
<polygon fill="black" stroke="black" points="948.22,-4508.03 937.72,-4509.45 946.81,-4514.89 948.22,-4508.03"/>
</g>
<!-- layer_11_all2all_expert_3 -->
<g id="node727" class="node">
<title>layer_11_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1152.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1152.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1152.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1152.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1152.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_3 -->
<g id="edge992" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2392.62,-4602.95C2148.38,-4595.85 1694.34,-4575.7 1311.32,-4519.7 1296.28,-4517.5 1280.55,-4514.65 1265.08,-4511.52"/>
<polygon fill="black" stroke="black" points="1265.46,-4508.02 1254.96,-4509.42 1264.04,-4514.88 1265.46,-4508.02"/>
</g>
<!-- layer_11_all2all_expert_4 -->
<g id="node729" class="node">
<title>layer_11_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1468.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1468.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1468.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1468.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1468.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_4 -->
<g id="edge994" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2387.67,-4597.01C2197.13,-4585.19 1889.38,-4561.43 1626.32,-4519.7 1611.74,-4517.39 1596.49,-4514.52 1581.47,-4511.42"/>
<polygon fill="black" stroke="black" points="1582.14,-4507.99 1571.63,-4509.36 1580.7,-4514.84 1582.14,-4507.99"/>
</g>
<!-- layer_11_all2all_expert_5 -->
<g id="node731" class="node">
<title>layer_11_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1783.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1783.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1783.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1783.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1783.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_5 -->
<g id="edge996" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2376.97,-4584.48C2252.09,-4568.97 2086.04,-4546.33 1940.32,-4519.7 1926.47,-4517.17 1911.99,-4514.25 1897.66,-4511.19"/>
<polygon fill="black" stroke="black" points="1898.29,-4507.75 1887.78,-4509.06 1896.82,-4514.59 1898.29,-4507.75"/>
</g>
<!-- layer_11_all2all_expert_6 -->
<g id="node733" class="node">
<title>layer_11_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2097.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2097.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2097.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2097.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2097.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_6 -->
<g id="edge998" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2372.91,-4555.62C2316.31,-4540.9 2256.59,-4525.36 2207.27,-4512.53"/>
<polygon fill="black" stroke="black" points="2208.1,-4509.13 2197.54,-4510 2206.34,-4515.91 2208.1,-4509.13"/>
</g>
<!-- layer_11_all2all_expert_7 -->
<g id="node735" class="node">
<title>layer_11_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2411.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2411.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2411.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2411.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2411.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_7 -->
<g id="edge1000" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2503.23,-4555.35C2490.05,-4545.11 2476.38,-4534.48 2463.73,-4524.66"/>
<polygon fill="black" stroke="black" points="2465.63,-4521.7 2455.59,-4518.33 2461.34,-4527.23 2465.63,-4521.7"/>
</g>
<!-- layer_11_all2all_expert_8 -->
<g id="node737" class="node">
<title>layer_11_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2727.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2727.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2727.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2727.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2727.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_8 -->
<g id="edge1002" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2635.41,-4555.35C2648.59,-4545.11 2662.26,-4534.48 2674.91,-4524.66"/>
<polygon fill="black" stroke="black" points="2677.3,-4527.23 2683.05,-4518.33 2673.01,-4521.7 2677.3,-4527.23"/>
</g>
<!-- layer_11_all2all_expert_9 -->
<g id="node739" class="node">
<title>layer_11_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3045.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3045.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3045.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3045.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3045.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_9 -->
<g id="edge1004" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2710.2,-4570.37C2781.93,-4551.87 2867.86,-4529.71 2934.74,-4512.45"/>
<polygon fill="black" stroke="black" points="2935.66,-4515.83 2944.47,-4509.95 2933.91,-4509.05 2935.66,-4515.83"/>
</g>
<!-- layer_11_all2all_expert_10 -->
<g id="node741" class="node">
<title>layer_11_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3365.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3365.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3365.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3365.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3365.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_10 -->
<g id="edge1006" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2725.94,-4588.69C2854.38,-4573.08 3040.69,-4548.5 3202.32,-4519.7 3217.41,-4517.02 3233.23,-4513.91 3248.82,-4510.68"/>
<polygon fill="black" stroke="black" points="3249.96,-4514.01 3259.03,-4508.53 3248.53,-4507.16 3249.96,-4514.01"/>
</g>
<!-- layer_11_all2all_expert_11 -->
<g id="node743" class="node">
<title>layer_11_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3685.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3685.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3685.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3685.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3685.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_11 -->
<g id="edge1008" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.66,-4597.96C2924.19,-4586.37 3247.31,-4562.26 3522.32,-4519.7 3537.97,-4517.28 3554.37,-4514.26 3570.48,-4511.01"/>
<polygon fill="black" stroke="black" points="3571.37,-4514.4 3580.46,-4508.96 3569.96,-4507.55 3571.37,-4514.4"/>
</g>
<!-- layer_11_all2all_expert_12 -->
<g id="node745" class="node">
<title>layer_11_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4006.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4006.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4006.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4006.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4006.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_12 -->
<g id="edge1010" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2737.97,-4603.03C2982.49,-4595.93 3449.21,-4575.7 3842.32,-4519.7 3858.45,-4517.41 3875.35,-4514.41 3891.92,-4511.12"/>
<polygon fill="black" stroke="black" points="3893.08,-4514.46 3902.19,-4509.04 3891.69,-4507.6 3893.08,-4514.46"/>
</g>
<!-- layer_11_all2all_expert_13 -->
<g id="node747" class="node">
<title>layer_11_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4327.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4327.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4327.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4327.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4327.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_13 -->
<g id="edge1012" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2740.9,-4606.32C3033.89,-4603.67 3648.89,-4589.39 4163.32,-4519.7 4179.74,-4517.48 4196.95,-4514.48 4213.79,-4511.16"/>
<polygon fill="black" stroke="black" points="4214.55,-4514.58 4223.66,-4509.17 4213.16,-4507.72 4214.55,-4514.58"/>
</g>
<!-- layer_11_all2all_expert_14 -->
<g id="node749" class="node">
<title>layer_11_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4648.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4648.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4648.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4648.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4648.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_14 -->
<g id="edge1014" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2737.76,-4602.71C3140.24,-4592.59 4149.17,-4563.55 4484.32,-4519.7 4500.75,-4517.56 4517.96,-4514.6 4534.81,-4511.3"/>
<polygon fill="black" stroke="black" points="4535.56,-4514.71 4544.68,-4509.31 4534.18,-4507.85 4535.56,-4514.71"/>
</g>
<!-- layer_11_all2all_expert_15 -->
<g id="node751" class="node">
<title>layer_11_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4969.32" cy="-4482.93" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4969.32" y="-4496.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4969.32" y="-4485.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4969.32" y="-4474.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4969.32" y="-4463.93" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_all2all_expert_15 -->
<g id="edge1016" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2738.66,-4603.97C3188.48,-4596.1 4406.1,-4570.6 4805.32,-4519.7 4821.87,-4517.59 4839.23,-4514.64 4856.19,-4511.32"/>
<polygon fill="black" stroke="black" points="4857.01,-4514.73 4866.13,-4509.33 4855.64,-4507.86 4857.01,-4514.73"/>
</g>
<!-- layer_11_expert_0_gpu8 -->
<g id="node720" class="node">
<title>layer_11_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="288.82,-4410.16 79.82,-4410.16 79.82,-4358.16 288.82,-4358.16 288.82,-4410.16"/>
<text text-anchor="middle" x="184.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="184.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="184.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="184.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_0 -->
<g id="node752" class="node">
<title>layer_11_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="160.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="160.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="160.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="160.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="160.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_0_gpu8&#45;&gt;layer_11_all2all_back_0 -->
<g id="edge1018" class="edge">
<title>layer_11_expert_0_gpu8&#45;&gt;layer_11_all2all_back_0</title>
<path fill="none" stroke="black" d="M178.08,-4357.99C176.12,-4350.1 173.89,-4341.13 171.7,-4332.26"/>
<polygon fill="black" stroke="black" points="175.05,-4331.24 169.24,-4322.37 168.25,-4332.92 175.05,-4331.24"/>
</g>
<!-- layer_11_all2all_expert_0&#45;&gt;layer_11_expert_0_gpu8 -->
<g id="edge987" class="edge">
<title>layer_11_all2all_expert_0&#45;&gt;layer_11_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M185.58,-4445.9C185.4,-4437.59 185.22,-4428.76 185.05,-4420.47"/>
<polygon fill="black" stroke="black" points="188.55,-4420.29 184.84,-4410.36 181.55,-4420.43 188.55,-4420.29"/>
</g>
<!-- layer_11_expert_1_gpu8 -->
<g id="node722" class="node">
<title>layer_11_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="601.82,-4410.16 392.82,-4410.16 392.82,-4358.16 601.82,-4358.16 601.82,-4410.16"/>
<text text-anchor="middle" x="497.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="497.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="497.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="497.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_1 -->
<g id="node753" class="node">
<title>layer_11_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="481.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="481.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="481.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="481.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="481.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_1_gpu8&#45;&gt;layer_11_all2all_back_1 -->
<g id="edge1019" class="edge">
<title>layer_11_expert_1_gpu8&#45;&gt;layer_11_all2all_back_1</title>
<path fill="none" stroke="black" d="M493.16,-4357.99C491.85,-4350.1 490.37,-4341.13 488.9,-4332.26"/>
<polygon fill="black" stroke="black" points="492.35,-4331.67 487.27,-4322.37 485.45,-4332.81 492.35,-4331.67"/>
</g>
<!-- layer_11_all2all_expert_1&#45;&gt;layer_11_expert_1_gpu8 -->
<g id="edge989" class="edge">
<title>layer_11_all2all_expert_1&#45;&gt;layer_11_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M508.04,-4446.18C506.55,-4437.68 504.96,-4428.62 503.47,-4420.16"/>
<polygon fill="black" stroke="black" points="506.9,-4419.45 501.72,-4410.21 500,-4420.66 506.9,-4419.45"/>
</g>
<!-- layer_11_expert_2_gpu9 -->
<g id="node724" class="node">
<title>layer_11_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="922.82,-4410.16 713.82,-4410.16 713.82,-4358.16 922.82,-4358.16 922.82,-4410.16"/>
<text text-anchor="middle" x="818.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="818.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="818.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="818.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_2 -->
<g id="node754" class="node">
<title>layer_11_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="802.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="802.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="802.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="802.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="802.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_2_gpu9&#45;&gt;layer_11_all2all_back_2 -->
<g id="edge1020" class="edge">
<title>layer_11_expert_2_gpu9&#45;&gt;layer_11_all2all_back_2</title>
<path fill="none" stroke="black" d="M814.16,-4357.99C812.85,-4350.1 811.37,-4341.13 809.9,-4332.26"/>
<polygon fill="black" stroke="black" points="813.35,-4331.67 808.27,-4322.37 806.45,-4332.81 813.35,-4331.67"/>
</g>
<!-- layer_11_all2all_expert_2&#45;&gt;layer_11_expert_2_gpu9 -->
<g id="edge991" class="edge">
<title>layer_11_all2all_expert_2&#45;&gt;layer_11_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M829.04,-4446.18C827.55,-4437.68 825.96,-4428.62 824.47,-4420.16"/>
<polygon fill="black" stroke="black" points="827.9,-4419.45 822.72,-4410.21 821,-4420.66 827.9,-4419.45"/>
</g>
<!-- layer_11_expert_3_gpu9 -->
<g id="node726" class="node">
<title>layer_11_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1242.82,-4410.16 1033.82,-4410.16 1033.82,-4358.16 1242.82,-4358.16 1242.82,-4410.16"/>
<text text-anchor="middle" x="1138.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1138.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1138.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1138.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_3 -->
<g id="node755" class="node">
<title>layer_11_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1123.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1123.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1123.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1123.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1123.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_3_gpu9&#45;&gt;layer_11_all2all_back_3 -->
<g id="edge1021" class="edge">
<title>layer_11_expert_3_gpu9&#45;&gt;layer_11_all2all_back_3</title>
<path fill="none" stroke="black" d="M1134.42,-4357.99C1133.2,-4350.1 1131.8,-4341.13 1130.43,-4332.26"/>
<polygon fill="black" stroke="black" points="1133.89,-4331.72 1128.9,-4322.37 1126.97,-4332.79 1133.89,-4331.72"/>
</g>
<!-- layer_11_all2all_expert_3&#45;&gt;layer_11_expert_3_gpu9 -->
<g id="edge993" class="edge">
<title>layer_11_all2all_expert_3&#45;&gt;layer_11_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1147.15,-4446.18C1145.92,-4437.68 1144.61,-4428.62 1143.38,-4420.16"/>
<polygon fill="black" stroke="black" points="1146.84,-4419.6 1141.94,-4410.21 1139.91,-4420.61 1146.84,-4419.6"/>
</g>
<!-- layer_11_expert_4_gpu10 -->
<g id="node728" class="node">
<title>layer_11_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1562.82,-4410.16 1353.82,-4410.16 1353.82,-4358.16 1562.82,-4358.16 1562.82,-4410.16"/>
<text text-anchor="middle" x="1458.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1458.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1458.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1458.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_4 -->
<g id="node756" class="node">
<title>layer_11_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1444.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1444.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1444.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1444.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1444.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_4_gpu10&#45;&gt;layer_11_all2all_back_4 -->
<g id="edge1022" class="edge">
<title>layer_11_expert_4_gpu10&#45;&gt;layer_11_all2all_back_4</title>
<path fill="none" stroke="black" d="M1454.68,-4357.99C1453.55,-4350.18 1452.27,-4341.32 1451,-4332.55"/>
<polygon fill="black" stroke="black" points="1454.42,-4331.77 1449.53,-4322.37 1447.49,-4332.77 1454.42,-4331.77"/>
</g>
<!-- layer_11_all2all_expert_4&#45;&gt;layer_11_expert_4_gpu10 -->
<g id="edge995" class="edge">
<title>layer_11_all2all_expert_4&#45;&gt;layer_11_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1464.63,-4446.18C1463.75,-4437.68 1462.81,-4428.62 1461.94,-4420.16"/>
<polygon fill="black" stroke="black" points="1465.42,-4419.8 1460.91,-4410.21 1458.46,-4420.52 1465.42,-4419.8"/>
</g>
<!-- layer_11_expert_5_gpu10 -->
<g id="node730" class="node">
<title>layer_11_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1877.82,-4410.16 1668.82,-4410.16 1668.82,-4358.16 1877.82,-4358.16 1877.82,-4410.16"/>
<text text-anchor="middle" x="1773.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1773.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1773.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1773.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_5 -->
<g id="node757" class="node">
<title>layer_11_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1765.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1765.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1765.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1765.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1765.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_5_gpu10&#45;&gt;layer_11_all2all_back_5 -->
<g id="edge1023" class="edge">
<title>layer_11_expert_5_gpu10&#45;&gt;layer_11_all2all_back_5</title>
<path fill="none" stroke="black" d="M1771.24,-4357.99C1770.59,-4350.18 1769.86,-4341.32 1769.14,-4332.55"/>
<polygon fill="black" stroke="black" points="1772.61,-4332.05 1768.3,-4322.37 1765.63,-4332.63 1772.61,-4332.05"/>
</g>
<!-- layer_11_all2all_expert_5&#45;&gt;layer_11_expert_5_gpu10 -->
<g id="edge997" class="edge">
<title>layer_11_all2all_expert_5&#45;&gt;layer_11_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1779.63,-4446.18C1778.75,-4437.68 1777.81,-4428.62 1776.94,-4420.16"/>
<polygon fill="black" stroke="black" points="1780.42,-4419.8 1775.91,-4410.21 1773.46,-4420.52 1780.42,-4419.8"/>
</g>
<!-- layer_11_expert_6_gpu11 -->
<g id="node732" class="node">
<title>layer_11_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2195.82,-4410.16 1986.82,-4410.16 1986.82,-4358.16 2195.82,-4358.16 2195.82,-4410.16"/>
<text text-anchor="middle" x="2091.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2091.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2091.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2091.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_6 -->
<g id="node758" class="node">
<title>layer_11_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2086.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2086.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2086.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2086.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2086.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_6_gpu11&#45;&gt;layer_11_all2all_back_6 -->
<g id="edge1024" class="edge">
<title>layer_11_expert_6_gpu11&#45;&gt;layer_11_all2all_back_6</title>
<path fill="none" stroke="black" d="M2090.02,-4357.99C2089.62,-4350.18 2089.16,-4341.32 2088.71,-4332.55"/>
<polygon fill="black" stroke="black" points="2092.19,-4332.18 2088.18,-4322.37 2085.2,-4332.54 2092.19,-4332.18"/>
</g>
<!-- layer_11_all2all_expert_6&#45;&gt;layer_11_expert_6_gpu11 -->
<g id="edge999" class="edge">
<title>layer_11_all2all_expert_6&#45;&gt;layer_11_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2095.09,-4445.9C2094.57,-4437.59 2094.02,-4428.76 2093.51,-4420.47"/>
<polygon fill="black" stroke="black" points="2097,-4420.13 2092.88,-4410.36 2090.01,-4420.56 2097,-4420.13"/>
</g>
<!-- layer_11_expert_7_gpu11 -->
<g id="node734" class="node">
<title>layer_11_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2512.82,-4410.16 2303.82,-4410.16 2303.82,-4358.16 2512.82,-4358.16 2512.82,-4410.16"/>
<text text-anchor="middle" x="2408.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2408.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2408.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2408.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_7 -->
<g id="node759" class="node">
<title>layer_11_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2407.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2407.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2407.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2407.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2407.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_7_gpu11&#45;&gt;layer_11_all2all_back_7 -->
<g id="edge1025" class="edge">
<title>layer_11_expert_7_gpu11&#45;&gt;layer_11_all2all_back_7</title>
<path fill="none" stroke="black" d="M2408.06,-4357.99C2407.98,-4350.18 2407.89,-4341.32 2407.8,-4332.55"/>
<polygon fill="black" stroke="black" points="2411.3,-4332.33 2407.69,-4322.37 2404.3,-4332.41 2411.3,-4332.33"/>
</g>
<!-- layer_11_all2all_expert_7&#45;&gt;layer_11_expert_7_gpu11 -->
<g id="edge1001" class="edge">
<title>layer_11_all2all_expert_7&#45;&gt;layer_11_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2410.2,-4445.9C2409.95,-4437.59 2409.67,-4428.76 2409.42,-4420.47"/>
<polygon fill="black" stroke="black" points="2412.91,-4420.25 2409.1,-4410.36 2405.91,-4420.46 2412.91,-4420.25"/>
</g>
<!-- layer_11_expert_8_gpu12 -->
<g id="node736" class="node">
<title>layer_11_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2831.82,-4410.16 2622.82,-4410.16 2622.82,-4358.16 2831.82,-4358.16 2831.82,-4410.16"/>
<text text-anchor="middle" x="2727.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2727.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2727.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2727.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_8 -->
<g id="node760" class="node">
<title>layer_11_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2728.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2728.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2728.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2728.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2728.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_8_gpu12&#45;&gt;layer_11_all2all_back_8 -->
<g id="edge1026" class="edge">
<title>layer_11_expert_8_gpu12&#45;&gt;layer_11_all2all_back_8</title>
<path fill="none" stroke="black" d="M2727.58,-4357.99C2727.66,-4350.18 2727.75,-4341.32 2727.84,-4332.55"/>
<polygon fill="black" stroke="black" points="2731.35,-4332.41 2727.95,-4322.37 2724.35,-4332.33 2731.35,-4332.41"/>
</g>
<!-- layer_11_all2all_expert_8&#45;&gt;layer_11_expert_8_gpu12 -->
<g id="edge1003" class="edge">
<title>layer_11_all2all_expert_8&#45;&gt;layer_11_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2727.32,-4445.9C2727.32,-4437.59 2727.32,-4428.76 2727.32,-4420.47"/>
<polygon fill="black" stroke="black" points="2730.82,-4420.36 2727.32,-4410.36 2723.82,-4420.36 2730.82,-4420.36"/>
</g>
<!-- layer_11_expert_9_gpu12 -->
<g id="node738" class="node">
<title>layer_11_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3151.82,-4410.16 2942.82,-4410.16 2942.82,-4358.16 3151.82,-4358.16 3151.82,-4410.16"/>
<text text-anchor="middle" x="3047.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3047.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3047.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3047.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_9 -->
<g id="node761" class="node">
<title>layer_11_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3049.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3049.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3049.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3049.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3049.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_9_gpu12&#45;&gt;layer_11_all2all_back_9 -->
<g id="edge1027" class="edge">
<title>layer_11_expert_9_gpu12&#45;&gt;layer_11_all2all_back_9</title>
<path fill="none" stroke="black" d="M3047.84,-4357.99C3048,-4350.18 3048.19,-4341.32 3048.37,-4332.55"/>
<polygon fill="black" stroke="black" points="3051.87,-4332.44 3048.58,-4322.37 3044.87,-4332.3 3051.87,-4332.44"/>
</g>
<!-- layer_11_all2all_expert_9&#45;&gt;layer_11_expert_9_gpu12 -->
<g id="edge1005" class="edge">
<title>layer_11_all2all_expert_9&#45;&gt;layer_11_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3046.07,-4445.9C3046.24,-4437.59 3046.42,-4428.76 3046.59,-4420.47"/>
<polygon fill="black" stroke="black" points="3050.09,-4420.43 3046.8,-4410.36 3043.09,-4420.29 3050.09,-4420.43"/>
</g>
<!-- layer_11_expert_10_gpu13 -->
<g id="node740" class="node">
<title>layer_11_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3472.82,-4410.16 3263.82,-4410.16 3263.82,-4358.16 3472.82,-4358.16 3472.82,-4410.16"/>
<text text-anchor="middle" x="3368.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3368.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3368.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3368.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_10 -->
<g id="node762" class="node">
<title>layer_11_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3370.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3370.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3370.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3370.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3370.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_10_gpu13&#45;&gt;layer_11_all2all_back_10 -->
<g id="edge1028" class="edge">
<title>layer_11_expert_10_gpu13&#45;&gt;layer_11_all2all_back_10</title>
<path fill="none" stroke="black" d="M3368.84,-4357.99C3369,-4350.18 3369.19,-4341.32 3369.37,-4332.55"/>
<polygon fill="black" stroke="black" points="3372.87,-4332.44 3369.58,-4322.37 3365.87,-4332.3 3372.87,-4332.44"/>
</g>
<!-- layer_11_all2all_expert_10&#45;&gt;layer_11_expert_10_gpu13 -->
<g id="edge1007" class="edge">
<title>layer_11_all2all_expert_10&#45;&gt;layer_11_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3366.44,-4445.9C3366.7,-4437.59 3366.97,-4428.76 3367.23,-4420.47"/>
<polygon fill="black" stroke="black" points="3370.73,-4420.46 3367.54,-4410.36 3363.73,-4420.25 3370.73,-4420.46"/>
</g>
<!-- layer_11_expert_11_gpu13 -->
<g id="node742" class="node">
<title>layer_11_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3792.82,-4410.16 3583.82,-4410.16 3583.82,-4358.16 3792.82,-4358.16 3792.82,-4410.16"/>
<text text-anchor="middle" x="3688.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3688.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3688.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3688.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_11 -->
<g id="node763" class="node">
<title>layer_11_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3691.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3691.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3691.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3691.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3691.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_11_gpu13&#45;&gt;layer_11_all2all_back_11 -->
<g id="edge1029" class="edge">
<title>layer_11_expert_11_gpu13&#45;&gt;layer_11_all2all_back_11</title>
<path fill="none" stroke="black" d="M3689.1,-4357.99C3689.34,-4350.18 3689.62,-4341.32 3689.89,-4332.55"/>
<polygon fill="black" stroke="black" points="3693.39,-4332.48 3690.21,-4322.37 3686.4,-4332.26 3693.39,-4332.48"/>
</g>
<!-- layer_11_all2all_expert_11&#45;&gt;layer_11_expert_11_gpu13 -->
<g id="edge1009" class="edge">
<title>layer_11_all2all_expert_11&#45;&gt;layer_11_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3686.44,-4445.9C3686.7,-4437.59 3686.97,-4428.76 3687.23,-4420.47"/>
<polygon fill="black" stroke="black" points="3690.73,-4420.46 3687.54,-4410.36 3683.73,-4420.25 3690.73,-4420.46"/>
</g>
<!-- layer_11_expert_12_gpu14 -->
<g id="node744" class="node">
<title>layer_11_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4113.82,-4410.16 3904.82,-4410.16 3904.82,-4358.16 4113.82,-4358.16 4113.82,-4410.16"/>
<text text-anchor="middle" x="4009.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4009.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4009.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4009.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_12 -->
<g id="node764" class="node">
<title>layer_11_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4012.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4012.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4012.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4012.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4012.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_12_gpu14&#45;&gt;layer_11_all2all_back_12 -->
<g id="edge1030" class="edge">
<title>layer_11_expert_12_gpu14&#45;&gt;layer_11_all2all_back_12</title>
<path fill="none" stroke="black" d="M4010.1,-4357.99C4010.34,-4350.18 4010.62,-4341.32 4010.89,-4332.55"/>
<polygon fill="black" stroke="black" points="4014.39,-4332.48 4011.21,-4322.37 4007.4,-4332.26 4014.39,-4332.48"/>
</g>
<!-- layer_11_all2all_expert_12&#45;&gt;layer_11_expert_12_gpu14 -->
<g id="edge1011" class="edge">
<title>layer_11_all2all_expert_12&#45;&gt;layer_11_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4007.44,-4445.9C4007.7,-4437.59 4007.97,-4428.76 4008.23,-4420.47"/>
<polygon fill="black" stroke="black" points="4011.73,-4420.46 4008.54,-4410.36 4004.73,-4420.25 4011.73,-4420.46"/>
</g>
<!-- layer_11_expert_13_gpu14 -->
<g id="node746" class="node">
<title>layer_11_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4434.82,-4410.16 4225.82,-4410.16 4225.82,-4358.16 4434.82,-4358.16 4434.82,-4410.16"/>
<text text-anchor="middle" x="4330.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4330.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4330.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4330.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_13 -->
<g id="node765" class="node">
<title>layer_11_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4333.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4333.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4333.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4333.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4333.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_13_gpu14&#45;&gt;layer_11_all2all_back_13 -->
<g id="edge1031" class="edge">
<title>layer_11_expert_13_gpu14&#45;&gt;layer_11_all2all_back_13</title>
<path fill="none" stroke="black" d="M4331.1,-4357.99C4331.34,-4350.18 4331.62,-4341.32 4331.89,-4332.55"/>
<polygon fill="black" stroke="black" points="4335.39,-4332.48 4332.21,-4322.37 4328.4,-4332.26 4335.39,-4332.48"/>
</g>
<!-- layer_11_all2all_expert_13&#45;&gt;layer_11_expert_13_gpu14 -->
<g id="edge1013" class="edge">
<title>layer_11_all2all_expert_13&#45;&gt;layer_11_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4328.44,-4445.9C4328.7,-4437.59 4328.97,-4428.76 4329.23,-4420.47"/>
<polygon fill="black" stroke="black" points="4332.73,-4420.46 4329.54,-4410.36 4325.73,-4420.25 4332.73,-4420.46"/>
</g>
<!-- layer_11_expert_14_gpu15 -->
<g id="node748" class="node">
<title>layer_11_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4755.82,-4410.16 4546.82,-4410.16 4546.82,-4358.16 4755.82,-4358.16 4755.82,-4410.16"/>
<text text-anchor="middle" x="4651.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4651.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4651.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4651.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_14 -->
<g id="node766" class="node">
<title>layer_11_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4654.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4654.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4654.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4654.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4654.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_14_gpu15&#45;&gt;layer_11_all2all_back_14 -->
<g id="edge1032" class="edge">
<title>layer_11_expert_14_gpu15&#45;&gt;layer_11_all2all_back_14</title>
<path fill="none" stroke="black" d="M4652.1,-4357.99C4652.34,-4350.18 4652.62,-4341.32 4652.89,-4332.55"/>
<polygon fill="black" stroke="black" points="4656.39,-4332.48 4653.21,-4322.37 4649.4,-4332.26 4656.39,-4332.48"/>
</g>
<!-- layer_11_all2all_expert_14&#45;&gt;layer_11_expert_14_gpu15 -->
<g id="edge1015" class="edge">
<title>layer_11_all2all_expert_14&#45;&gt;layer_11_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4649.44,-4445.9C4649.7,-4437.59 4649.97,-4428.76 4650.23,-4420.47"/>
<polygon fill="black" stroke="black" points="4653.73,-4420.46 4650.54,-4410.36 4646.73,-4420.25 4653.73,-4420.46"/>
</g>
<!-- layer_11_expert_15_gpu15 -->
<g id="node750" class="node">
<title>layer_11_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5076.82,-4410.16 4867.82,-4410.16 4867.82,-4358.16 5076.82,-4358.16 5076.82,-4410.16"/>
<text text-anchor="middle" x="4972.32" y="-4398.16" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4972.32" y="-4387.16" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4972.32" y="-4376.16" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4972.32" y="-4365.16" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_15 -->
<g id="node767" class="node">
<title>layer_11_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4975.32" cy="-4285.4" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4975.32" y="-4299.4" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4975.32" y="-4288.4" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4975.32" y="-4277.4" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4975.32" y="-4266.4" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_expert_15_gpu15&#45;&gt;layer_11_all2all_back_15 -->
<g id="edge1033" class="edge">
<title>layer_11_expert_15_gpu15&#45;&gt;layer_11_all2all_back_15</title>
<path fill="none" stroke="black" d="M4973.1,-4357.99C4973.34,-4350.18 4973.62,-4341.32 4973.89,-4332.55"/>
<polygon fill="black" stroke="black" points="4977.39,-4332.48 4974.21,-4322.37 4970.4,-4332.26 4977.39,-4332.48"/>
</g>
<!-- layer_11_all2all_expert_15&#45;&gt;layer_11_expert_15_gpu15 -->
<g id="edge1017" class="edge">
<title>layer_11_all2all_expert_15&#45;&gt;layer_11_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4970.44,-4445.9C4970.7,-4437.59 4970.97,-4428.76 4971.23,-4420.47"/>
<polygon fill="black" stroke="black" points="4974.73,-4420.46 4971.54,-4410.36 4967.73,-4420.25 4974.73,-4420.46"/>
</g>
<!-- layer_11_output -->
<g id="node768" class="node">
<title>layer_11_output</title>
<polygon fill="lightblue" stroke="black" points="2674.32,-4212.63 2460.32,-4212.63 2460.32,-4160.63 2674.32,-4160.63 2674.32,-4212.63"/>
<text text-anchor="middle" x="2567.32" y="-4200.63" font-family="Arial" font-size="10.00">Layer 11 Output</text>
<text text-anchor="middle" x="2567.32" y="-4189.63" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2567.32" y="-4178.63" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2567.32" y="-4167.63" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_11_all2all_back_0&#45;&gt;layer_11_output -->
<g id="edge1034" class="edge">
<title>layer_11_all2all_back_0&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M263.31,-4258.45C282.48,-4254.49 302.42,-4250.96 321.32,-4248.63 739.21,-4197.01 2049.59,-4189.07 2449.96,-4187.85"/>
<polygon fill="black" stroke="black" points="2450.12,-4191.35 2460.11,-4187.82 2450.1,-4184.35 2450.12,-4191.35"/>
</g>
<!-- layer_11_all2all_back_1&#45;&gt;layer_11_output -->
<g id="edge1035" class="edge">
<title>layer_11_all2all_back_1&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M584.75,-4258.43C603.79,-4254.5 623.57,-4250.98 642.32,-4248.63 994.84,-4204.28 2088.7,-4191.52 2450.1,-4188.47"/>
<polygon fill="black" stroke="black" points="2450.35,-4191.97 2460.32,-4188.38 2450.29,-4184.97 2450.35,-4191.97"/>
</g>
<!-- layer_11_all2all_back_2&#45;&gt;layer_11_output -->
<g id="edge1036" class="edge">
<title>layer_11_all2all_back_2&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M905.76,-4258.53C924.8,-4254.59 944.58,-4251.04 963.32,-4248.63 1250.83,-4211.53 2130.45,-4194.44 2449.86,-4189.34"/>
<polygon fill="black" stroke="black" points="2450.12,-4192.84 2460.06,-4189.18 2450.01,-4185.84 2450.12,-4192.84"/>
</g>
<!-- layer_11_all2all_back_3&#45;&gt;layer_11_output -->
<g id="edge1037" class="edge">
<title>layer_11_all2all_back_3&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M1227.21,-4258.59C1246.12,-4254.67 1265.73,-4251.11 1284.32,-4248.63 1507.45,-4218.76 2176.68,-4198.06 2449.55,-4190.65"/>
<polygon fill="black" stroke="black" points="2449.98,-4194.13 2459.88,-4190.37 2449.79,-4187.14 2449.98,-4194.13"/>
</g>
<!-- layer_11_all2all_back_4&#45;&gt;layer_11_output -->
<g id="edge1038" class="edge">
<title>layer_11_all2all_back_4&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M1548.68,-4258.74C1567.45,-4254.83 1586.89,-4251.24 1605.32,-4248.63 1907.78,-4205.7 2268.05,-4192.98 2449.88,-4189.21"/>
<polygon fill="black" stroke="black" points="2450.07,-4192.71 2460,-4189 2449.93,-4185.71 2450.07,-4192.71"/>
</g>
<!-- layer_11_all2all_back_5&#45;&gt;layer_11_output -->
<g id="edge1039" class="edge">
<title>layer_11_all2all_back_5&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M1871.05,-4258.95C1889.41,-4255.1 1908.36,-4251.46 1926.32,-4248.63 2108.01,-4219.91 2320.95,-4202.91 2449.91,-4194.42"/>
<polygon fill="black" stroke="black" points="2450.45,-4197.9 2460.2,-4193.75 2449.99,-4190.91 2450.45,-4197.9"/>
</g>
<!-- layer_11_all2all_back_6&#45;&gt;layer_11_output -->
<g id="edge1040" class="edge">
<title>layer_11_all2all_back_6&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M2195.35,-4259.7C2212.71,-4255.91 2230.5,-4252.1 2247.32,-4248.63 2314.35,-4234.79 2389.51,-4220.41 2450.14,-4209.08"/>
<polygon fill="black" stroke="black" points="2450.94,-4212.5 2460.13,-4207.22 2449.66,-4205.61 2450.94,-4212.5"/>
</g>
<!-- layer_11_all2all_back_7&#45;&gt;layer_11_output -->
<g id="edge1041" class="edge">
<title>layer_11_all2all_back_7&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M2462.38,-4251.09C2480.09,-4240.38 2499.6,-4228.58 2516.95,-4218.09"/>
<polygon fill="black" stroke="black" points="2519.06,-4220.9 2525.81,-4212.73 2515.44,-4214.91 2519.06,-4220.9"/>
</g>
<!-- layer_11_all2all_back_8&#45;&gt;layer_11_output -->
<g id="edge1042" class="edge">
<title>layer_11_all2all_back_8&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M2672.91,-4251.09C2655.1,-4240.38 2635.46,-4228.58 2618,-4218.09"/>
<polygon fill="black" stroke="black" points="2619.47,-4214.88 2609.09,-4212.73 2615.86,-4220.88 2619.47,-4214.88"/>
</g>
<!-- layer_11_all2all_back_9&#45;&gt;layer_11_output -->
<g id="edge1043" class="edge">
<title>layer_11_all2all_back_9&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M2940.3,-4259.7C2922.93,-4255.9 2905.15,-4252.09 2888.32,-4248.63 2820.96,-4234.74 2745.39,-4220.33 2684.51,-4209"/>
<polygon fill="black" stroke="black" points="2684.96,-4205.52 2674.48,-4207.14 2683.68,-4212.4 2684.96,-4205.52"/>
</g>
<!-- layer_11_all2all_back_10&#45;&gt;layer_11_output -->
<g id="edge1044" class="edge">
<title>layer_11_all2all_back_10&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M3264.59,-4258.95C3246.24,-4255.09 3227.28,-4251.46 3209.32,-4248.63 3027.22,-4219.86 2813.76,-4202.86 2684.63,-4194.39"/>
<polygon fill="black" stroke="black" points="2684.53,-4190.88 2674.33,-4193.72 2684.08,-4197.87 2684.53,-4190.88"/>
</g>
<!-- layer_11_all2all_back_11&#45;&gt;layer_11_output -->
<g id="edge1045" class="edge">
<title>layer_11_all2all_back_11&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M3586.96,-4258.74C3568.2,-4254.83 3548.75,-4251.24 3530.32,-4248.63 3227.34,-4205.64 2866.42,-4192.94 2684.52,-4189.19"/>
<polygon fill="black" stroke="black" points="2684.46,-4185.69 2674.39,-4188.99 2684.32,-4192.69 2684.46,-4185.69"/>
</g>
<!-- layer_11_all2all_back_12&#45;&gt;layer_11_output -->
<g id="edge1046" class="edge">
<title>layer_11_all2all_back_12&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M3908.43,-4258.59C3889.53,-4254.67 3869.91,-4251.11 3851.32,-4248.63 3627.88,-4218.72 2957.45,-4198.03 2684.68,-4190.63"/>
<polygon fill="black" stroke="black" points="2684.45,-4187.12 2674.36,-4190.35 2684.26,-4194.12 2684.45,-4187.12"/>
</g>
<!-- layer_11_all2all_back_13&#45;&gt;layer_11_output -->
<g id="edge1047" class="edge">
<title>layer_11_all2all_back_13&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M4229.88,-4258.53C4210.84,-4254.59 4191.06,-4251.04 4172.32,-4248.63 3884.54,-4211.5 3003.94,-4194.42 2684.57,-4189.33"/>
<polygon fill="black" stroke="black" points="2684.42,-4185.83 2674.37,-4189.17 2684.31,-4192.83 2684.42,-4185.83"/>
</g>
<!-- layer_11_all2all_back_14&#45;&gt;layer_11_output -->
<g id="edge1048" class="edge">
<title>layer_11_all2all_back_14&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M4550.89,-4258.43C4531.85,-4254.5 4512.07,-4250.98 4493.32,-4248.63 4140.62,-4204.26 3046.19,-4191.52 2684.6,-4188.47"/>
<polygon fill="black" stroke="black" points="2684.41,-4184.97 2674.38,-4188.38 2684.35,-4191.97 2684.41,-4184.97"/>
</g>
<!-- layer_11_all2all_back_15&#45;&gt;layer_11_output -->
<g id="edge1049" class="edge">
<title>layer_11_all2all_back_15&#45;&gt;layer_11_output</title>
<path fill="none" stroke="black" d="M4872.33,-4258.45C4853.16,-4254.49 4833.22,-4250.96 4814.32,-4248.63 4396.25,-4196.99 3085.28,-4189.06 2684.73,-4187.85"/>
<polygon fill="black" stroke="black" points="2684.59,-4184.35 2674.58,-4187.82 2684.57,-4191.35 2684.59,-4184.35"/>
</g>
<!-- layer_12_tp_gather -->
<g id="node770" class="node">
<title>layer_12_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2567.32" cy="-4087.86" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2567.32" y="-4101.86" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2567.32" y="-4090.86" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2567.32" y="-4079.86" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2567.32" y="-4068.86" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_11_output&#45;&gt;layer_12_tp_gather -->
<g id="edge1050" class="edge">
<title>layer_11_output&#45;&gt;layer_12_tp_gather</title>
<path fill="none" stroke="black" d="M2549.3,-4160.45C2547.64,-4152.48 2546.91,-4143.4 2547.1,-4134.45"/>
<polygon fill="black" stroke="black" points="2550.59,-4134.66 2547.71,-4124.47 2543.61,-4134.23 2550.59,-4134.66"/>
</g>
<!-- layer_11_output&#45;&gt;layer_12_tp_gather -->
<g id="edge1052" class="edge">
<title>layer_11_output&#45;&gt;layer_12_tp_gather</title>
<path fill="none" stroke="black" d="M2561.32,-4160.45C2560.77,-4152.64 2560.53,-4143.78 2560.58,-4135.01"/>
<polygon fill="black" stroke="black" points="2564.08,-4134.9 2560.77,-4124.83 2557.08,-4134.76 2564.08,-4134.9"/>
</g>
<!-- layer_11_output&#45;&gt;layer_12_tp_gather -->
<g id="edge1054" class="edge">
<title>layer_11_output&#45;&gt;layer_12_tp_gather</title>
<path fill="none" stroke="black" d="M2573.33,-4160.45C2573.87,-4152.64 2574.11,-4143.78 2574.06,-4135.01"/>
<polygon fill="black" stroke="black" points="2577.56,-4134.76 2573.87,-4124.83 2570.56,-4134.9 2577.56,-4134.76"/>
</g>
<!-- layer_11_output&#45;&gt;layer_12_tp_gather -->
<g id="edge1056" class="edge">
<title>layer_11_output&#45;&gt;layer_12_tp_gather</title>
<path fill="none" stroke="black" d="M2585.34,-4160.45C2587,-4152.48 2587.73,-4143.4 2587.54,-4134.45"/>
<polygon fill="black" stroke="black" points="2591.03,-4134.23 2586.93,-4124.47 2584.05,-4134.66 2591.03,-4134.23"/>
</g>
<!-- layer_12_qkv_gpu4 -->
<g id="node769" class="node">
<title>layer_12_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2329.32,-4015.09 2123.32,-4015.09 2123.32,-3963.09 2329.32,-3963.09 2329.32,-4015.09"/>
<text text-anchor="middle" x="2226.32" y="-4003.09" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2226.32" y="-3992.09" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2226.32" y="-3981.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2226.32" y="-3970.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_12_attn_gpu4 -->
<g id="node774" class="node">
<title>layer_12_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2322.32,-3927.09 2120.32,-3927.09 2120.32,-3875.09 2322.32,-3875.09 2322.32,-3927.09"/>
<text text-anchor="middle" x="2221.32" y="-3915.09" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2221.32" y="-3904.09" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2221.32" y="-3893.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2221.32" y="-3882.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_12_qkv_gpu4&#45;&gt;layer_12_attn_gpu4 -->
<g id="edge1058" class="edge">
<title>layer_12_qkv_gpu4&#45;&gt;layer_12_attn_gpu4</title>
<path fill="none" stroke="black" d="M2224.85,-3962.75C2224.38,-3954.79 2223.87,-3945.85 2223.37,-3937.33"/>
<polygon fill="black" stroke="black" points="2226.86,-3937.02 2222.78,-3927.24 2219.87,-3937.43 2226.86,-3937.02"/>
</g>
<!-- layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu4 -->
<g id="edge1051" class="edge">
<title>layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2470.52,-4059.38C2424.74,-4046.4 2370.19,-4030.92 2324.28,-4017.88"/>
<polygon fill="black" stroke="black" points="2325.19,-4014.51 2314.61,-4015.14 2323.28,-4021.24 2325.19,-4014.51"/>
</g>
<!-- layer_12_qkv_gpu5 -->
<g id="node771" class="node">
<title>layer_12_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2557.32,-4015.09 2351.32,-4015.09 2351.32,-3963.09 2557.32,-3963.09 2557.32,-4015.09"/>
<text text-anchor="middle" x="2454.32" y="-4003.09" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2454.32" y="-3992.09" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2454.32" y="-3981.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2454.32" y="-3970.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu5 -->
<g id="edge1053" class="edge">
<title>layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2526.84,-4052.19C2515.22,-4042.24 2502.6,-4031.43 2491.2,-4021.67"/>
<polygon fill="black" stroke="black" points="2493.4,-4018.95 2483.53,-4015.1 2488.85,-4024.26 2493.4,-4018.95"/>
</g>
<!-- layer_12_qkv_gpu6 -->
<g id="node772" class="node">
<title>layer_12_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2783.32,-4015.09 2577.32,-4015.09 2577.32,-3963.09 2783.32,-3963.09 2783.32,-4015.09"/>
<text text-anchor="middle" x="2680.32" y="-4003.09" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2680.32" y="-3992.09" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2680.32" y="-3981.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2680.32" y="-3970.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu6 -->
<g id="edge1055" class="edge">
<title>layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2607.8,-4052.19C2619.43,-4042.24 2632.04,-4031.43 2643.44,-4021.67"/>
<polygon fill="black" stroke="black" points="2645.79,-4024.26 2651.11,-4015.1 2641.24,-4018.95 2645.79,-4024.26"/>
</g>
<!-- layer_12_qkv_gpu7 -->
<g id="node773" class="node">
<title>layer_12_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3012.32,-4015.09 2806.32,-4015.09 2806.32,-3963.09 3012.32,-3963.09 3012.32,-4015.09"/>
<text text-anchor="middle" x="2909.32" y="-4003.09" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2909.32" y="-3992.09" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2909.32" y="-3981.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2909.32" y="-3970.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu7 -->
<g id="edge1057" class="edge">
<title>layer_12_tp_gather&#45;&gt;layer_12_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2663.95,-4059.51C2709.96,-4046.5 2764.89,-4030.95 2811.11,-4017.88"/>
<polygon fill="black" stroke="black" points="2812.16,-4021.22 2820.83,-4015.13 2810.25,-4014.48 2812.16,-4021.22"/>
</g>
<!-- layer_12_attn_gpu5 -->
<g id="node775" class="node">
<title>layer_12_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2551.32,-3927.09 2349.32,-3927.09 2349.32,-3875.09 2551.32,-3875.09 2551.32,-3927.09"/>
<text text-anchor="middle" x="2450.32" y="-3915.09" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2450.32" y="-3904.09" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2450.32" y="-3893.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2450.32" y="-3882.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_12_qkv_gpu5&#45;&gt;layer_12_attn_gpu5 -->
<g id="edge1059" class="edge">
<title>layer_12_qkv_gpu5&#45;&gt;layer_12_attn_gpu5</title>
<path fill="none" stroke="black" d="M2453.14,-3962.75C2452.77,-3954.79 2452.36,-3945.85 2451.96,-3937.33"/>
<polygon fill="black" stroke="black" points="2455.45,-3937.07 2451.49,-3927.24 2448.46,-3937.4 2455.45,-3937.07"/>
</g>
<!-- layer_12_attn_gpu6 -->
<g id="node776" class="node">
<title>layer_12_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2781.32,-3927.09 2579.32,-3927.09 2579.32,-3875.09 2781.32,-3875.09 2781.32,-3927.09"/>
<text text-anchor="middle" x="2680.32" y="-3915.09" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2680.32" y="-3904.09" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2680.32" y="-3893.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2680.32" y="-3882.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_12_qkv_gpu6&#45;&gt;layer_12_attn_gpu6 -->
<g id="edge1060" class="edge">
<title>layer_12_qkv_gpu6&#45;&gt;layer_12_attn_gpu6</title>
<path fill="none" stroke="black" d="M2680.32,-3962.75C2680.32,-3954.79 2680.32,-3945.85 2680.32,-3937.33"/>
<polygon fill="black" stroke="black" points="2683.82,-3937.24 2680.32,-3927.24 2676.82,-3937.24 2683.82,-3937.24"/>
</g>
<!-- layer_12_attn_gpu7 -->
<g id="node777" class="node">
<title>layer_12_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3012.32,-3927.09 2810.32,-3927.09 2810.32,-3875.09 3012.32,-3875.09 3012.32,-3927.09"/>
<text text-anchor="middle" x="2911.32" y="-3915.09" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2911.32" y="-3904.09" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2911.32" y="-3893.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2911.32" y="-3882.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_12_qkv_gpu7&#45;&gt;layer_12_attn_gpu7 -->
<g id="edge1061" class="edge">
<title>layer_12_qkv_gpu7&#45;&gt;layer_12_attn_gpu7</title>
<path fill="none" stroke="black" d="M2909.91,-3962.75C2910.1,-3954.79 2910.3,-3945.85 2910.5,-3937.33"/>
<polygon fill="black" stroke="black" points="2914,-3937.32 2910.74,-3927.24 2907,-3937.16 2914,-3937.32"/>
</g>
<!-- layer_12_attn_out_gpu4 -->
<g id="node778" class="node">
<title>layer_12_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2324.32,-3839.09 2110.32,-3839.09 2110.32,-3787.09 2324.32,-3787.09 2324.32,-3839.09"/>
<text text-anchor="middle" x="2217.32" y="-3827.09" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2217.32" y="-3816.09" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2217.32" y="-3805.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2217.32" y="-3794.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_attn_gpu4&#45;&gt;layer_12_attn_out_gpu4 -->
<g id="edge1062" class="edge">
<title>layer_12_attn_gpu4&#45;&gt;layer_12_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2220.14,-3874.75C2219.77,-3866.79 2219.36,-3857.85 2218.96,-3849.33"/>
<polygon fill="black" stroke="black" points="2222.45,-3849.07 2218.49,-3839.24 2215.46,-3849.4 2222.45,-3849.07"/>
</g>
<!-- layer_12_attn_out_gpu5 -->
<g id="node779" class="node">
<title>layer_12_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2556.32,-3839.09 2342.32,-3839.09 2342.32,-3787.09 2556.32,-3787.09 2556.32,-3839.09"/>
<text text-anchor="middle" x="2449.32" y="-3827.09" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2449.32" y="-3816.09" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2449.32" y="-3805.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2449.32" y="-3794.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_attn_gpu5&#45;&gt;layer_12_attn_out_gpu5 -->
<g id="edge1063" class="edge">
<title>layer_12_attn_gpu5&#45;&gt;layer_12_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2450.03,-3874.75C2449.93,-3866.79 2449.83,-3857.85 2449.73,-3849.33"/>
<polygon fill="black" stroke="black" points="2453.23,-3849.2 2449.61,-3839.24 2446.23,-3849.28 2453.23,-3849.2"/>
</g>
<!-- layer_12_attn_out_gpu6 -->
<g id="node780" class="node">
<title>layer_12_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2788.32,-3839.09 2574.32,-3839.09 2574.32,-3787.09 2788.32,-3787.09 2788.32,-3839.09"/>
<text text-anchor="middle" x="2681.32" y="-3827.09" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2681.32" y="-3816.09" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2681.32" y="-3805.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2681.32" y="-3794.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_attn_gpu6&#45;&gt;layer_12_attn_out_gpu6 -->
<g id="edge1064" class="edge">
<title>layer_12_attn_gpu6&#45;&gt;layer_12_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2680.62,-3874.75C2680.71,-3866.79 2680.81,-3857.85 2680.91,-3849.33"/>
<polygon fill="black" stroke="black" points="2684.41,-3849.28 2681.03,-3839.24 2677.41,-3849.2 2684.41,-3849.28"/>
</g>
<!-- layer_12_attn_out_gpu7 -->
<g id="node781" class="node">
<title>layer_12_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3020.32,-3839.09 2806.32,-3839.09 2806.32,-3787.09 3020.32,-3787.09 3020.32,-3839.09"/>
<text text-anchor="middle" x="2913.32" y="-3827.09" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2913.32" y="-3816.09" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2913.32" y="-3805.09" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2913.32" y="-3794.09" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_attn_gpu7&#45;&gt;layer_12_attn_out_gpu7 -->
<g id="edge1065" class="edge">
<title>layer_12_attn_gpu7&#45;&gt;layer_12_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2911.91,-3874.75C2912.1,-3866.79 2912.3,-3857.85 2912.5,-3849.33"/>
<polygon fill="black" stroke="black" points="2916,-3849.32 2912.74,-3839.24 2909,-3849.16 2916,-3849.32"/>
</g>
<!-- layer_12_attn_allreduce -->
<g id="node782" class="node">
<title>layer_12_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2565.32" cy="-3714.32" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2565.32" y="-3728.32" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2565.32" y="-3717.32" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2565.32" y="-3706.32" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2565.32" y="-3695.32" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_attn_out_gpu4&#45;&gt;layer_12_attn_allreduce -->
<g id="edge1066" class="edge">
<title>layer_12_attn_out_gpu4&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M2307.39,-3787.04C2353.36,-3774.26 2409.61,-3758.62 2457.84,-3745.2"/>
<polygon fill="black" stroke="black" points="2458.99,-3748.52 2467.69,-3742.47 2457.11,-3741.77 2458.99,-3748.52"/>
</g>
<!-- layer_12_attn_out_gpu5&#45;&gt;layer_12_attn_allreduce -->
<g id="edge1067" class="edge">
<title>layer_12_attn_out_gpu5&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M2479.5,-3786.91C2490.73,-3777.55 2503.78,-3766.66 2516.26,-3756.24"/>
<polygon fill="black" stroke="black" points="2518.51,-3758.93 2523.94,-3749.83 2514.02,-3753.55 2518.51,-3758.93"/>
</g>
<!-- layer_12_attn_out_gpu6&#45;&gt;layer_12_attn_allreduce -->
<g id="edge1068" class="edge">
<title>layer_12_attn_out_gpu6&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M2651.15,-3786.91C2639.92,-3777.55 2626.86,-3766.66 2614.38,-3756.24"/>
<polygon fill="black" stroke="black" points="2616.62,-3753.55 2606.7,-3749.83 2612.13,-3758.93 2616.62,-3753.55"/>
</g>
<!-- layer_12_attn_out_gpu7&#45;&gt;layer_12_attn_allreduce -->
<g id="edge1069" class="edge">
<title>layer_12_attn_out_gpu7&#45;&gt;layer_12_attn_allreduce</title>
<path fill="none" stroke="black" d="M2823.25,-3787.04C2777.28,-3774.26 2721.03,-3758.62 2672.8,-3745.2"/>
<polygon fill="black" stroke="black" points="2673.53,-3741.77 2662.96,-3742.47 2671.65,-3748.52 2673.53,-3741.77"/>
</g>
<!-- layer_12_gate -->
<g id="node783" class="node">
<title>layer_12_gate</title>
<polygon fill="lightyellow" stroke="black" points="2782.18,-3641.55 2437.2,-3641.55 2348.46,-3537.55 2693.44,-3537.55 2782.18,-3641.55"/>
<text text-anchor="middle" x="2565.32" y="-3603.55" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2565.32" y="-3592.55" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2565.32" y="-3581.55" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2565.32" y="-3570.55" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_12_attn_allreduce&#45;&gt;layer_12_gate -->
<g id="edge1070" class="edge">
<title>layer_12_attn_allreduce&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2546.76,-3677.81C2545.65,-3669.76 2545.08,-3661 2545.07,-3652.22"/>
<polygon fill="black" stroke="black" points="2548.58,-3652.04 2545.31,-3641.96 2541.58,-3651.88 2548.58,-3652.04"/>
</g>
<!-- layer_12_attn_allreduce&#45;&gt;layer_12_gate -->
<g id="edge1071" class="edge">
<title>layer_12_attn_allreduce&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2559.12,-3677.48C2558.75,-3669.44 2558.57,-3660.69 2558.57,-3651.94"/>
<polygon fill="black" stroke="black" points="2562.07,-3651.74 2558.65,-3641.71 2555.07,-3651.69 2562.07,-3651.74"/>
</g>
<!-- layer_12_attn_allreduce&#45;&gt;layer_12_gate -->
<g id="edge1072" class="edge">
<title>layer_12_attn_allreduce&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2571.52,-3677.48C2571.89,-3669.44 2572.07,-3660.69 2572.07,-3651.94"/>
<polygon fill="black" stroke="black" points="2575.57,-3651.69 2571.99,-3641.71 2568.57,-3651.74 2575.57,-3651.69"/>
</g>
<!-- layer_12_attn_allreduce&#45;&gt;layer_12_gate -->
<g id="edge1073" class="edge">
<title>layer_12_attn_allreduce&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2583.88,-3677.81C2584.99,-3669.76 2585.56,-3661 2585.57,-3652.22"/>
<polygon fill="black" stroke="black" points="2589.06,-3651.88 2585.33,-3641.96 2582.07,-3652.04 2589.06,-3651.88"/>
</g>
<!-- layer_12_all2all_expert_0 -->
<g id="node785" class="node">
<title>layer_12_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="182.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="182.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="182.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="182.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="182.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_0 -->
<g id="edge1074" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2389.28,-3585.42C1937.66,-3576.78 745.96,-3549.99 353.32,-3501.55 335.2,-3499.31 316.16,-3496.15 297.61,-3492.62"/>
<polygon fill="black" stroke="black" points="298.16,-3489.16 287.67,-3490.69 296.82,-3496.03 298.16,-3489.16"/>
</g>
<!-- layer_12_all2all_expert_1 -->
<g id="node787" class="node">
<title>layer_12_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="510.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="510.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="510.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="510.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="510.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_1 -->
<g id="edge1076" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.21,-3584.22C1983.83,-3573.72 1002.32,-3544.55 674.32,-3501.55 657.9,-3499.39 640.68,-3496.43 623.83,-3493.13"/>
<polygon fill="black" stroke="black" points="624.46,-3489.69 613.97,-3491.15 623.08,-3496.55 624.46,-3489.69"/>
</g>
<!-- layer_12_all2all_expert_2 -->
<g id="node789" class="node">
<title>layer_12_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="831.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="831.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="831.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="831.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="831.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_2 -->
<g id="edge1078" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2391.49,-3588.27C2100.41,-3585.71 1496.57,-3571.5 991.32,-3501.55 975.79,-3499.4 959.54,-3496.52 943.6,-3493.32"/>
<polygon fill="black" stroke="black" points="944.22,-3489.88 933.72,-3491.29 942.81,-3496.73 944.22,-3489.88"/>
</g>
<!-- layer_12_all2all_expert_3 -->
<g id="node791" class="node">
<title>layer_12_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1148.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1148.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1148.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1148.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1148.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_3 -->
<g id="edge1080" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.62,-3584.8C2144.38,-3577.69 1690.34,-3557.54 1307.32,-3501.55 1292.28,-3499.35 1276.55,-3496.5 1261.08,-3493.36"/>
<polygon fill="black" stroke="black" points="1261.46,-3489.87 1250.96,-3491.27 1260.04,-3496.72 1261.46,-3489.87"/>
</g>
<!-- layer_12_all2all_expert_4 -->
<g id="node793" class="node">
<title>layer_12_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1464.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1464.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1464.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1464.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1464.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_4 -->
<g id="edge1082" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2383.67,-3578.85C2193.13,-3567.03 1885.38,-3543.28 1622.32,-3501.55 1607.74,-3499.23 1592.49,-3496.37 1577.47,-3493.27"/>
<polygon fill="black" stroke="black" points="1578.14,-3489.83 1567.63,-3491.2 1576.7,-3496.68 1578.14,-3489.83"/>
</g>
<!-- layer_12_all2all_expert_5 -->
<g id="node795" class="node">
<title>layer_12_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1779.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1779.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1779.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1779.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1779.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_5 -->
<g id="edge1084" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2372.97,-3566.32C2248.09,-3550.82 2082.04,-3528.17 1936.32,-3501.55 1922.47,-3499.02 1907.99,-3496.1 1893.66,-3493.04"/>
<polygon fill="black" stroke="black" points="1894.29,-3489.59 1883.78,-3490.9 1892.82,-3496.44 1894.29,-3489.59"/>
</g>
<!-- layer_12_all2all_expert_6 -->
<g id="node797" class="node">
<title>layer_12_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2093.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2093.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2093.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2093.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2093.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_6 -->
<g id="edge1086" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2368.91,-3537.46C2312.31,-3522.74 2252.59,-3507.2 2203.27,-3494.38"/>
<polygon fill="black" stroke="black" points="2204.1,-3490.98 2193.54,-3491.85 2202.34,-3497.75 2204.1,-3490.98"/>
</g>
<!-- layer_12_all2all_expert_7 -->
<g id="node799" class="node">
<title>layer_12_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2407.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2407.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2407.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2407.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2407.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_7 -->
<g id="edge1088" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2499.23,-3537.19C2486.05,-3526.95 2472.38,-3516.33 2459.73,-3506.5"/>
<polygon fill="black" stroke="black" points="2461.63,-3503.55 2451.59,-3500.18 2457.34,-3509.07 2461.63,-3503.55"/>
</g>
<!-- layer_12_all2all_expert_8 -->
<g id="node801" class="node">
<title>layer_12_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2723.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2723.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2723.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2723.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2723.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_8 -->
<g id="edge1090" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2631.41,-3537.19C2644.59,-3526.95 2658.26,-3516.33 2670.91,-3506.5"/>
<polygon fill="black" stroke="black" points="2673.3,-3509.07 2679.05,-3500.18 2669.01,-3503.55 2673.3,-3509.07"/>
</g>
<!-- layer_12_all2all_expert_9 -->
<g id="node803" class="node">
<title>layer_12_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3041.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3041.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3041.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3041.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3041.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_9 -->
<g id="edge1092" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2706.2,-3552.21C2777.93,-3533.71 2863.86,-3511.55 2930.74,-3494.3"/>
<polygon fill="black" stroke="black" points="2931.66,-3497.68 2940.47,-3491.79 2929.91,-3490.9 2931.66,-3497.68"/>
</g>
<!-- layer_12_all2all_expert_10 -->
<g id="node805" class="node">
<title>layer_12_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3361.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3361.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3361.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3361.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3361.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_10 -->
<g id="edge1094" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2721.94,-3570.53C2850.38,-3554.92 3036.69,-3530.34 3198.32,-3501.55 3213.41,-3498.86 3229.23,-3495.75 3244.82,-3492.52"/>
<polygon fill="black" stroke="black" points="3245.96,-3495.86 3255.03,-3490.38 3244.53,-3489.01 3245.96,-3495.86"/>
</g>
<!-- layer_12_all2all_expert_11 -->
<g id="node807" class="node">
<title>layer_12_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3681.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3681.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3681.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3681.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3681.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_11 -->
<g id="edge1096" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.66,-3579.8C2920.19,-3568.22 3243.31,-3544.1 3518.32,-3501.55 3533.97,-3499.13 3550.37,-3496.11 3566.48,-3492.86"/>
<polygon fill="black" stroke="black" points="3567.37,-3496.25 3576.46,-3490.81 3565.96,-3489.39 3567.37,-3496.25"/>
</g>
<!-- layer_12_all2all_expert_12 -->
<g id="node809" class="node">
<title>layer_12_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4002.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4002.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4002.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4002.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4002.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_12 -->
<g id="edge1098" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.97,-3584.88C2978.49,-3577.78 3445.21,-3557.54 3838.32,-3501.55 3854.45,-3499.25 3871.35,-3496.25 3887.92,-3492.97"/>
<polygon fill="black" stroke="black" points="3889.08,-3496.3 3898.19,-3490.89 3887.69,-3489.44 3889.08,-3496.3"/>
</g>
<!-- layer_12_all2all_expert_13 -->
<g id="node811" class="node">
<title>layer_12_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4323.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4323.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4323.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4323.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4323.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_13 -->
<g id="edge1100" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2736.9,-3588.17C3029.89,-3585.52 3644.89,-3571.23 4159.32,-3501.55 4175.74,-3499.32 4192.95,-3496.32 4209.79,-3493"/>
<polygon fill="black" stroke="black" points="4210.55,-3496.42 4219.66,-3491.01 4209.16,-3489.56 4210.55,-3496.42"/>
</g>
<!-- layer_12_all2all_expert_14 -->
<g id="node813" class="node">
<title>layer_12_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4644.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4644.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4644.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4644.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4644.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_14 -->
<g id="edge1102" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.76,-3584.56C3136.24,-3574.43 4145.17,-3545.39 4480.32,-3501.55 4496.75,-3499.4 4513.96,-3496.44 4530.81,-3493.14"/>
<polygon fill="black" stroke="black" points="4531.56,-3496.56 4540.68,-3491.16 4530.18,-3489.69 4531.56,-3496.56"/>
</g>
<!-- layer_12_all2all_expert_15 -->
<g id="node815" class="node">
<title>layer_12_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4965.32" cy="-3464.78" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4965.32" y="-3478.78" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4965.32" y="-3467.78" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4965.32" y="-3456.78" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4965.32" y="-3445.78" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_all2all_expert_15 -->
<g id="edge1104" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734.66,-3585.82C3184.48,-3577.94 4402.1,-3552.45 4801.32,-3501.55 4817.87,-3499.44 4835.23,-3496.48 4852.19,-3493.16"/>
<polygon fill="black" stroke="black" points="4853.01,-3496.57 4862.13,-3491.17 4851.64,-3489.71 4853.01,-3496.57"/>
</g>
<!-- layer_12_expert_0_gpu8 -->
<g id="node784" class="node">
<title>layer_12_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="285.82,-3392.01 76.82,-3392.01 76.82,-3340.01 285.82,-3340.01 285.82,-3392.01"/>
<text text-anchor="middle" x="181.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="181.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="181.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="181.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_0 -->
<g id="node816" class="node">
<title>layer_12_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="157.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="157.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="157.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="157.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="157.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_0_gpu8&#45;&gt;layer_12_all2all_back_0 -->
<g id="edge1106" class="edge">
<title>layer_12_expert_0_gpu8&#45;&gt;layer_12_all2all_back_0</title>
<path fill="none" stroke="black" d="M175.08,-3339.84C173.12,-3331.94 170.89,-3322.97 168.7,-3314.11"/>
<polygon fill="black" stroke="black" points="172.05,-3313.08 166.24,-3304.22 165.25,-3314.76 172.05,-3313.08"/>
</g>
<!-- layer_12_all2all_expert_0&#45;&gt;layer_12_expert_0_gpu8 -->
<g id="edge1075" class="edge">
<title>layer_12_all2all_expert_0&#45;&gt;layer_12_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M181.95,-3427.74C181.86,-3419.43 181.77,-3410.6 181.69,-3402.32"/>
<polygon fill="black" stroke="black" points="185.18,-3402.17 181.58,-3392.2 178.18,-3402.24 185.18,-3402.17"/>
</g>
<!-- layer_12_expert_1_gpu8 -->
<g id="node786" class="node">
<title>layer_12_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="598.82,-3392.01 389.82,-3392.01 389.82,-3340.01 598.82,-3340.01 598.82,-3392.01"/>
<text text-anchor="middle" x="494.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="494.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="494.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="494.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_1 -->
<g id="node817" class="node">
<title>layer_12_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="478.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="478.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="478.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="478.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="478.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_1_gpu8&#45;&gt;layer_12_all2all_back_1 -->
<g id="edge1107" class="edge">
<title>layer_12_expert_1_gpu8&#45;&gt;layer_12_all2all_back_1</title>
<path fill="none" stroke="black" d="M490.16,-3339.84C488.85,-3331.94 487.37,-3322.97 485.9,-3314.11"/>
<polygon fill="black" stroke="black" points="489.35,-3313.51 484.27,-3304.22 482.45,-3314.65 489.35,-3313.51"/>
</g>
<!-- layer_12_all2all_expert_1&#45;&gt;layer_12_expert_1_gpu8 -->
<g id="edge1077" class="edge">
<title>layer_12_all2all_expert_1&#45;&gt;layer_12_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M504.41,-3428.02C503,-3419.52 501.51,-3410.47 500.11,-3402"/>
<polygon fill="black" stroke="black" points="503.55,-3401.35 498.46,-3392.05 496.64,-3402.49 503.55,-3401.35"/>
</g>
<!-- layer_12_expert_2_gpu9 -->
<g id="node788" class="node">
<title>layer_12_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="918.82,-3392.01 709.82,-3392.01 709.82,-3340.01 918.82,-3340.01 918.82,-3392.01"/>
<text text-anchor="middle" x="814.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="814.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="814.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="814.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_2 -->
<g id="node818" class="node">
<title>layer_12_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="799.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="799.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="799.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="799.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="799.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_2_gpu9&#45;&gt;layer_12_all2all_back_2 -->
<g id="edge1108" class="edge">
<title>layer_12_expert_2_gpu9&#45;&gt;layer_12_all2all_back_2</title>
<path fill="none" stroke="black" d="M810.42,-3339.84C809.2,-3331.94 807.8,-3322.97 806.43,-3314.11"/>
<polygon fill="black" stroke="black" points="809.89,-3313.56 804.9,-3304.22 802.97,-3314.63 809.89,-3313.56"/>
</g>
<!-- layer_12_all2all_expert_2&#45;&gt;layer_12_expert_2_gpu9 -->
<g id="edge1079" class="edge">
<title>layer_12_all2all_expert_2&#45;&gt;layer_12_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M825.04,-3428.02C823.55,-3419.52 821.96,-3410.47 820.47,-3402"/>
<polygon fill="black" stroke="black" points="823.9,-3401.3 818.72,-3392.05 817,-3402.51 823.9,-3401.3"/>
</g>
<!-- layer_12_expert_3_gpu9 -->
<g id="node790" class="node">
<title>layer_12_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1238.82,-3392.01 1029.82,-3392.01 1029.82,-3340.01 1238.82,-3340.01 1238.82,-3392.01"/>
<text text-anchor="middle" x="1134.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1134.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1134.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1134.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_3 -->
<g id="node819" class="node">
<title>layer_12_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1120.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1120.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1120.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1120.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1120.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_3_gpu9&#45;&gt;layer_12_all2all_back_3 -->
<g id="edge1109" class="edge">
<title>layer_12_expert_3_gpu9&#45;&gt;layer_12_all2all_back_3</title>
<path fill="none" stroke="black" d="M1130.68,-3339.84C1129.55,-3332.03 1128.27,-3323.16 1127,-3314.39"/>
<polygon fill="black" stroke="black" points="1130.42,-3313.61 1125.53,-3304.22 1123.49,-3314.61 1130.42,-3313.61"/>
</g>
<!-- layer_12_all2all_expert_3&#45;&gt;layer_12_expert_3_gpu9 -->
<g id="edge1081" class="edge">
<title>layer_12_all2all_expert_3&#45;&gt;layer_12_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1143.15,-3428.02C1141.92,-3419.52 1140.61,-3410.47 1139.38,-3402"/>
<polygon fill="black" stroke="black" points="1142.84,-3401.45 1137.94,-3392.05 1135.91,-3402.45 1142.84,-3401.45"/>
</g>
<!-- layer_12_expert_4_gpu10 -->
<g id="node792" class="node">
<title>layer_12_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1558.82,-3392.01 1349.82,-3392.01 1349.82,-3340.01 1558.82,-3340.01 1558.82,-3392.01"/>
<text text-anchor="middle" x="1454.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1454.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1454.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1454.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_4 -->
<g id="node820" class="node">
<title>layer_12_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1441.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1441.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1441.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1441.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1441.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_4_gpu10&#45;&gt;layer_12_all2all_back_4 -->
<g id="edge1110" class="edge">
<title>layer_12_expert_4_gpu10&#45;&gt;layer_12_all2all_back_4</title>
<path fill="none" stroke="black" d="M1450.94,-3339.84C1449.89,-3332.03 1448.7,-3323.16 1447.52,-3314.39"/>
<polygon fill="black" stroke="black" points="1450.95,-3313.66 1446.15,-3304.22 1444.02,-3314.59 1450.95,-3313.66"/>
</g>
<!-- layer_12_all2all_expert_4&#45;&gt;layer_12_expert_4_gpu10 -->
<g id="edge1083" class="edge">
<title>layer_12_all2all_expert_4&#45;&gt;layer_12_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1460.63,-3428.02C1459.75,-3419.52 1458.81,-3410.47 1457.94,-3402"/>
<polygon fill="black" stroke="black" points="1461.42,-3401.64 1456.91,-3392.05 1454.46,-3402.36 1461.42,-3401.64"/>
</g>
<!-- layer_12_expert_5_gpu10 -->
<g id="node794" class="node">
<title>layer_12_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1876.82,-3392.01 1667.82,-3392.01 1667.82,-3340.01 1876.82,-3340.01 1876.82,-3392.01"/>
<text text-anchor="middle" x="1772.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1772.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1772.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1772.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_5 -->
<g id="node821" class="node">
<title>layer_12_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1762.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1762.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1762.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1762.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1762.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_5_gpu10&#45;&gt;layer_12_all2all_back_5 -->
<g id="edge1111" class="edge">
<title>layer_12_expert_5_gpu10&#45;&gt;layer_12_all2all_back_5</title>
<path fill="none" stroke="black" d="M1769.72,-3339.84C1768.91,-3332.03 1768,-3323.16 1767.09,-3314.39"/>
<polygon fill="black" stroke="black" points="1770.55,-3313.8 1766.04,-3304.22 1763.59,-3314.52 1770.55,-3313.8"/>
</g>
<!-- layer_12_all2all_expert_5&#45;&gt;layer_12_expert_5_gpu10 -->
<g id="edge1085" class="edge">
<title>layer_12_all2all_expert_5&#45;&gt;layer_12_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1776.71,-3427.74C1776.11,-3419.43 1775.47,-3410.6 1774.88,-3402.32"/>
<polygon fill="black" stroke="black" points="1778.36,-3401.93 1774.14,-3392.2 1771.37,-3402.43 1778.36,-3401.93"/>
</g>
<!-- layer_12_expert_6_gpu11 -->
<g id="node796" class="node">
<title>layer_12_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2192.82,-3392.01 1983.82,-3392.01 1983.82,-3340.01 2192.82,-3340.01 2192.82,-3392.01"/>
<text text-anchor="middle" x="2088.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2088.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2088.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2088.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_6 -->
<g id="node822" class="node">
<title>layer_12_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2083.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2083.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2083.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2083.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2083.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_6_gpu11&#45;&gt;layer_12_all2all_back_6 -->
<g id="edge1112" class="edge">
<title>layer_12_expert_6_gpu11&#45;&gt;layer_12_all2all_back_6</title>
<path fill="none" stroke="black" d="M2087.02,-3339.84C2086.62,-3332.03 2086.16,-3323.16 2085.71,-3314.39"/>
<polygon fill="black" stroke="black" points="2089.19,-3314.02 2085.18,-3304.22 2082.2,-3314.38 2089.19,-3314.02"/>
</g>
<!-- layer_12_all2all_expert_6&#45;&gt;layer_12_expert_6_gpu11 -->
<g id="edge1087" class="edge">
<title>layer_12_all2all_expert_6&#45;&gt;layer_12_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2091.46,-3427.74C2091.03,-3419.43 2090.57,-3410.6 2090.15,-3402.32"/>
<polygon fill="black" stroke="black" points="2093.63,-3402.01 2089.62,-3392.2 2086.64,-3402.37 2093.63,-3402.01"/>
</g>
<!-- layer_12_expert_7_gpu11 -->
<g id="node798" class="node">
<title>layer_12_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2508.82,-3392.01 2299.82,-3392.01 2299.82,-3340.01 2508.82,-3340.01 2508.82,-3392.01"/>
<text text-anchor="middle" x="2404.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2404.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2404.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2404.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_7 -->
<g id="node823" class="node">
<title>layer_12_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2404.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2404.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2404.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2404.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2404.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_7_gpu11&#45;&gt;layer_12_all2all_back_7 -->
<g id="edge1113" class="edge">
<title>layer_12_expert_7_gpu11&#45;&gt;layer_12_all2all_back_7</title>
<path fill="none" stroke="black" d="M2404.32,-3339.84C2404.32,-3332.03 2404.32,-3323.16 2404.32,-3314.39"/>
<polygon fill="black" stroke="black" points="2407.82,-3314.22 2404.32,-3304.22 2400.82,-3314.22 2407.82,-3314.22"/>
</g>
<!-- layer_12_all2all_expert_7&#45;&gt;layer_12_expert_7_gpu11 -->
<g id="edge1089" class="edge">
<title>layer_12_all2all_expert_7&#45;&gt;layer_12_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2406.2,-3427.74C2405.95,-3419.43 2405.67,-3410.6 2405.42,-3402.32"/>
<polygon fill="black" stroke="black" points="2408.91,-3402.09 2405.1,-3392.2 2401.91,-3402.31 2408.91,-3402.09"/>
</g>
<!-- layer_12_expert_8_gpu12 -->
<g id="node800" class="node">
<title>layer_12_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2828.82,-3392.01 2619.82,-3392.01 2619.82,-3340.01 2828.82,-3340.01 2828.82,-3392.01"/>
<text text-anchor="middle" x="2724.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2724.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2724.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2724.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_8 -->
<g id="node824" class="node">
<title>layer_12_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2725.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2725.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2725.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2725.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2725.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_8_gpu12&#45;&gt;layer_12_all2all_back_8 -->
<g id="edge1114" class="edge">
<title>layer_12_expert_8_gpu12&#45;&gt;layer_12_all2all_back_8</title>
<path fill="none" stroke="black" d="M2724.58,-3339.84C2724.66,-3332.03 2724.75,-3323.16 2724.84,-3314.39"/>
<polygon fill="black" stroke="black" points="2728.35,-3314.25 2724.95,-3304.22 2721.35,-3314.18 2728.35,-3314.25"/>
</g>
<!-- layer_12_all2all_expert_8&#45;&gt;layer_12_expert_8_gpu12 -->
<g id="edge1091" class="edge">
<title>layer_12_all2all_expert_8&#45;&gt;layer_12_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2723.69,-3427.74C2723.78,-3419.43 2723.87,-3410.6 2723.96,-3402.32"/>
<polygon fill="black" stroke="black" points="2727.46,-3402.24 2724.06,-3392.2 2720.46,-3402.17 2727.46,-3402.24"/>
</g>
<!-- layer_12_expert_9_gpu12 -->
<g id="node802" class="node">
<title>layer_12_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3148.82,-3392.01 2939.82,-3392.01 2939.82,-3340.01 3148.82,-3340.01 3148.82,-3392.01"/>
<text text-anchor="middle" x="3044.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3044.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3044.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3044.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_9 -->
<g id="node825" class="node">
<title>layer_12_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3046.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3046.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3046.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3046.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3046.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_9_gpu12&#45;&gt;layer_12_all2all_back_9 -->
<g id="edge1115" class="edge">
<title>layer_12_expert_9_gpu12&#45;&gt;layer_12_all2all_back_9</title>
<path fill="none" stroke="black" d="M3044.84,-3339.84C3045,-3332.03 3045.19,-3323.16 3045.37,-3314.39"/>
<polygon fill="black" stroke="black" points="3048.87,-3314.29 3045.58,-3304.22 3041.87,-3314.14 3048.87,-3314.29"/>
</g>
<!-- layer_12_all2all_expert_9&#45;&gt;layer_12_expert_9_gpu12 -->
<g id="edge1093" class="edge">
<title>layer_12_all2all_expert_9&#45;&gt;layer_12_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3042.44,-3427.74C3042.7,-3419.43 3042.97,-3410.6 3043.23,-3402.32"/>
<polygon fill="black" stroke="black" points="3046.73,-3402.31 3043.54,-3392.2 3039.73,-3402.09 3046.73,-3402.31"/>
</g>
<!-- layer_12_expert_10_gpu13 -->
<g id="node804" class="node">
<title>layer_12_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3468.82,-3392.01 3259.82,-3392.01 3259.82,-3340.01 3468.82,-3340.01 3468.82,-3392.01"/>
<text text-anchor="middle" x="3364.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3364.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3364.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3364.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_10 -->
<g id="node826" class="node">
<title>layer_12_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3367.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3367.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3367.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3367.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3367.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_10_gpu13&#45;&gt;layer_12_all2all_back_10 -->
<g id="edge1116" class="edge">
<title>layer_12_expert_10_gpu13&#45;&gt;layer_12_all2all_back_10</title>
<path fill="none" stroke="black" d="M3365.1,-3339.84C3365.34,-3332.03 3365.62,-3323.16 3365.89,-3314.39"/>
<polygon fill="black" stroke="black" points="3369.39,-3314.32 3366.21,-3304.22 3362.4,-3314.1 3369.39,-3314.32"/>
</g>
<!-- layer_12_all2all_expert_10&#45;&gt;layer_12_expert_10_gpu13 -->
<g id="edge1095" class="edge">
<title>layer_12_all2all_expert_10&#45;&gt;layer_12_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3362.44,-3427.74C3362.7,-3419.43 3362.97,-3410.6 3363.23,-3402.32"/>
<polygon fill="black" stroke="black" points="3366.73,-3402.31 3363.54,-3392.2 3359.73,-3402.09 3366.73,-3402.31"/>
</g>
<!-- layer_12_expert_11_gpu13 -->
<g id="node806" class="node">
<title>layer_12_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3789.82,-3392.01 3580.82,-3392.01 3580.82,-3340.01 3789.82,-3340.01 3789.82,-3392.01"/>
<text text-anchor="middle" x="3685.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3685.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3685.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3685.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_11 -->
<g id="node827" class="node">
<title>layer_12_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3688.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3688.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3688.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3688.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3688.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_11_gpu13&#45;&gt;layer_12_all2all_back_11 -->
<g id="edge1117" class="edge">
<title>layer_12_expert_11_gpu13&#45;&gt;layer_12_all2all_back_11</title>
<path fill="none" stroke="black" d="M3686.1,-3339.84C3686.34,-3332.03 3686.62,-3323.16 3686.89,-3314.39"/>
<polygon fill="black" stroke="black" points="3690.39,-3314.32 3687.21,-3304.22 3683.4,-3314.1 3690.39,-3314.32"/>
</g>
<!-- layer_12_all2all_expert_11&#45;&gt;layer_12_expert_11_gpu13 -->
<g id="edge1097" class="edge">
<title>layer_12_all2all_expert_11&#45;&gt;layer_12_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3682.81,-3427.74C3683.15,-3419.43 3683.52,-3410.6 3683.86,-3402.32"/>
<polygon fill="black" stroke="black" points="3687.36,-3402.34 3684.28,-3392.2 3680.37,-3402.05 3687.36,-3402.34"/>
</g>
<!-- layer_12_expert_12_gpu14 -->
<g id="node808" class="node">
<title>layer_12_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4109.82,-3392.01 3900.82,-3392.01 3900.82,-3340.01 4109.82,-3340.01 4109.82,-3392.01"/>
<text text-anchor="middle" x="4005.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4005.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4005.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4005.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_12 -->
<g id="node828" class="node">
<title>layer_12_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4009.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4009.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4009.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4009.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4009.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_12_gpu14&#45;&gt;layer_12_all2all_back_12 -->
<g id="edge1118" class="edge">
<title>layer_12_expert_12_gpu14&#45;&gt;layer_12_all2all_back_12</title>
<path fill="none" stroke="black" d="M4006.36,-3339.84C4006.68,-3332.03 4007.05,-3323.16 4007.41,-3314.39"/>
<polygon fill="black" stroke="black" points="4010.92,-3314.35 4007.83,-3304.22 4003.92,-3314.06 4010.92,-3314.35"/>
</g>
<!-- layer_12_all2all_expert_12&#45;&gt;layer_12_expert_12_gpu14 -->
<g id="edge1099" class="edge">
<title>layer_12_all2all_expert_12&#45;&gt;layer_12_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4003.44,-3427.74C4003.7,-3419.43 4003.97,-3410.6 4004.23,-3402.32"/>
<polygon fill="black" stroke="black" points="4007.73,-3402.31 4004.54,-3392.2 4000.73,-3402.09 4007.73,-3402.31"/>
</g>
<!-- layer_12_expert_13_gpu14 -->
<g id="node810" class="node">
<title>layer_12_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4430.82,-3392.01 4221.82,-3392.01 4221.82,-3340.01 4430.82,-3340.01 4430.82,-3392.01"/>
<text text-anchor="middle" x="4326.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4326.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4326.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4326.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_13 -->
<g id="node829" class="node">
<title>layer_12_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4330.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4330.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4330.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4330.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4330.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_13_gpu14&#45;&gt;layer_12_all2all_back_13 -->
<g id="edge1119" class="edge">
<title>layer_12_expert_13_gpu14&#45;&gt;layer_12_all2all_back_13</title>
<path fill="none" stroke="black" d="M4327.36,-3339.84C4327.68,-3332.03 4328.05,-3323.16 4328.41,-3314.39"/>
<polygon fill="black" stroke="black" points="4331.92,-3314.35 4328.83,-3304.22 4324.92,-3314.06 4331.92,-3314.35"/>
</g>
<!-- layer_12_all2all_expert_13&#45;&gt;layer_12_expert_13_gpu14 -->
<g id="edge1101" class="edge">
<title>layer_12_all2all_expert_13&#45;&gt;layer_12_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4324.44,-3427.74C4324.7,-3419.43 4324.97,-3410.6 4325.23,-3402.32"/>
<polygon fill="black" stroke="black" points="4328.73,-3402.31 4325.54,-3392.2 4321.73,-3402.09 4328.73,-3402.31"/>
</g>
<!-- layer_12_expert_14_gpu15 -->
<g id="node812" class="node">
<title>layer_12_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4752.82,-3392.01 4543.82,-3392.01 4543.82,-3340.01 4752.82,-3340.01 4752.82,-3392.01"/>
<text text-anchor="middle" x="4648.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4648.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4648.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4648.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_14 -->
<g id="node830" class="node">
<title>layer_12_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4651.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4651.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4651.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4651.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4651.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_14_gpu15&#45;&gt;layer_12_all2all_back_14 -->
<g id="edge1120" class="edge">
<title>layer_12_expert_14_gpu15&#45;&gt;layer_12_all2all_back_14</title>
<path fill="none" stroke="black" d="M4649.1,-3339.84C4649.34,-3332.03 4649.62,-3323.16 4649.89,-3314.39"/>
<polygon fill="black" stroke="black" points="4653.39,-3314.32 4650.21,-3304.22 4646.4,-3314.1 4653.39,-3314.32"/>
</g>
<!-- layer_12_all2all_expert_14&#45;&gt;layer_12_expert_14_gpu15 -->
<g id="edge1103" class="edge">
<title>layer_12_all2all_expert_14&#45;&gt;layer_12_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4645.81,-3427.74C4646.15,-3419.43 4646.52,-3410.6 4646.86,-3402.32"/>
<polygon fill="black" stroke="black" points="4650.36,-3402.34 4647.28,-3392.2 4643.37,-3402.05 4650.36,-3402.34"/>
</g>
<!-- layer_12_expert_15_gpu15 -->
<g id="node814" class="node">
<title>layer_12_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5072.82,-3392.01 4863.82,-3392.01 4863.82,-3340.01 5072.82,-3340.01 5072.82,-3392.01"/>
<text text-anchor="middle" x="4968.32" y="-3380.01" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4968.32" y="-3369.01" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4968.32" y="-3358.01" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4968.32" y="-3347.01" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_15 -->
<g id="node831" class="node">
<title>layer_12_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4972.32" cy="-3267.24" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4972.32" y="-3281.24" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4972.32" y="-3270.24" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4972.32" y="-3259.24" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4972.32" y="-3248.24" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_expert_15_gpu15&#45;&gt;layer_12_all2all_back_15 -->
<g id="edge1121" class="edge">
<title>layer_12_expert_15_gpu15&#45;&gt;layer_12_all2all_back_15</title>
<path fill="none" stroke="black" d="M4969.36,-3339.84C4969.68,-3332.03 4970.05,-3323.16 4970.41,-3314.39"/>
<polygon fill="black" stroke="black" points="4973.92,-3314.35 4970.83,-3304.22 4966.92,-3314.06 4973.92,-3314.35"/>
</g>
<!-- layer_12_all2all_expert_15&#45;&gt;layer_12_expert_15_gpu15 -->
<g id="edge1105" class="edge">
<title>layer_12_all2all_expert_15&#45;&gt;layer_12_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4966.44,-3427.74C4966.7,-3419.43 4966.97,-3410.6 4967.23,-3402.32"/>
<polygon fill="black" stroke="black" points="4970.73,-3402.31 4967.54,-3392.2 4963.73,-3402.09 4970.73,-3402.31"/>
</g>
<!-- layer_12_output -->
<g id="node832" class="node">
<title>layer_12_output</title>
<polygon fill="lightblue" stroke="black" points="2671.32,-3194.47 2457.32,-3194.47 2457.32,-3142.47 2671.32,-3142.47 2671.32,-3194.47"/>
<text text-anchor="middle" x="2564.32" y="-3182.47" font-family="Arial" font-size="10.00">Layer 12 Output</text>
<text text-anchor="middle" x="2564.32" y="-3171.47" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2564.32" y="-3160.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2564.32" y="-3149.47" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_12_all2all_back_0&#45;&gt;layer_12_output -->
<g id="edge1122" class="edge">
<title>layer_12_all2all_back_0&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M260.31,-3240.29C279.48,-3236.34 299.42,-3232.8 318.32,-3230.47 736.21,-3178.86 2046.59,-3170.91 2446.96,-3169.69"/>
<polygon fill="black" stroke="black" points="2447.12,-3173.19 2457.11,-3169.66 2447.1,-3166.19 2447.12,-3173.19"/>
</g>
<!-- layer_12_all2all_back_1&#45;&gt;layer_12_output -->
<g id="edge1123" class="edge">
<title>layer_12_all2all_back_1&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M581.75,-3240.27C600.79,-3236.35 620.57,-3232.83 639.32,-3230.47 991.84,-3186.12 2085.7,-3173.37 2447.1,-3170.31"/>
<polygon fill="black" stroke="black" points="2447.35,-3173.81 2457.32,-3170.23 2447.29,-3166.81 2447.35,-3173.81"/>
</g>
<!-- layer_12_all2all_back_2&#45;&gt;layer_12_output -->
<g id="edge1124" class="edge">
<title>layer_12_all2all_back_2&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M902.76,-3240.37C921.8,-3236.44 941.58,-3232.89 960.32,-3230.47 1247.83,-3193.37 2127.45,-3176.28 2446.86,-3171.18"/>
<polygon fill="black" stroke="black" points="2447.12,-3174.68 2457.06,-3171.02 2447.01,-3167.68 2447.12,-3174.68"/>
</g>
<!-- layer_12_all2all_back_3&#45;&gt;layer_12_output -->
<g id="edge1125" class="edge">
<title>layer_12_all2all_back_3&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M1224.21,-3240.43C1243.12,-3236.51 1262.73,-3232.96 1281.32,-3230.47 1504.45,-3200.6 2173.68,-3179.9 2446.55,-3172.49"/>
<polygon fill="black" stroke="black" points="2446.98,-3175.98 2456.88,-3172.21 2446.79,-3168.98 2446.98,-3175.98"/>
</g>
<!-- layer_12_all2all_back_4&#45;&gt;layer_12_output -->
<g id="edge1126" class="edge">
<title>layer_12_all2all_back_4&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M1545.68,-3240.58C1564.45,-3236.68 1583.89,-3233.08 1602.32,-3230.47 1904.78,-3187.55 2265.05,-3174.82 2446.88,-3171.05"/>
<polygon fill="black" stroke="black" points="2447.07,-3174.55 2457,-3170.85 2446.93,-3167.55 2447.07,-3174.55"/>
</g>
<!-- layer_12_all2all_back_5&#45;&gt;layer_12_output -->
<g id="edge1127" class="edge">
<title>layer_12_all2all_back_5&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M1868.05,-3240.79C1886.41,-3236.94 1905.36,-3233.31 1923.32,-3230.47 2105.01,-3201.75 2317.95,-3184.75 2446.91,-3176.27"/>
<polygon fill="black" stroke="black" points="2447.45,-3179.74 2457.2,-3175.6 2446.99,-3172.76 2447.45,-3179.74"/>
</g>
<!-- layer_12_all2all_back_6&#45;&gt;layer_12_output -->
<g id="edge1128" class="edge">
<title>layer_12_all2all_back_6&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M2192.35,-3241.55C2209.71,-3237.75 2227.5,-3233.94 2244.32,-3230.47 2311.35,-3216.64 2386.51,-3202.25 2447.14,-3190.93"/>
<polygon fill="black" stroke="black" points="2447.94,-3194.34 2457.13,-3189.06 2446.66,-3187.46 2447.94,-3194.34"/>
</g>
<!-- layer_12_all2all_back_7&#45;&gt;layer_12_output -->
<g id="edge1129" class="edge">
<title>layer_12_all2all_back_7&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M2459.38,-3232.94C2477.09,-3222.23 2496.6,-3210.43 2513.95,-3199.93"/>
<polygon fill="black" stroke="black" points="2516.06,-3202.75 2522.81,-3194.58 2512.44,-3196.76 2516.06,-3202.75"/>
</g>
<!-- layer_12_all2all_back_8&#45;&gt;layer_12_output -->
<g id="edge1130" class="edge">
<title>layer_12_all2all_back_8&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M2669.91,-3232.94C2652.1,-3222.23 2632.46,-3210.43 2615,-3199.93"/>
<polygon fill="black" stroke="black" points="2616.47,-3196.73 2606.09,-3194.58 2612.86,-3202.73 2616.47,-3196.73"/>
</g>
<!-- layer_12_all2all_back_9&#45;&gt;layer_12_output -->
<g id="edge1131" class="edge">
<title>layer_12_all2all_back_9&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M2937.3,-3241.54C2919.93,-3237.74 2902.15,-3233.94 2885.32,-3230.47 2817.96,-3216.59 2742.39,-3202.17 2681.51,-3190.84"/>
<polygon fill="black" stroke="black" points="2681.96,-3187.36 2671.48,-3188.98 2680.68,-3194.25 2681.96,-3187.36"/>
</g>
<!-- layer_12_all2all_back_10&#45;&gt;layer_12_output -->
<g id="edge1132" class="edge">
<title>layer_12_all2all_back_10&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M3261.59,-3240.79C3243.24,-3236.94 3224.28,-3233.31 3206.32,-3230.47 3024.22,-3201.7 2810.76,-3184.7 2681.63,-3176.24"/>
<polygon fill="black" stroke="black" points="2681.53,-3172.72 2671.33,-3175.57 2681.08,-3179.71 2681.53,-3172.72"/>
</g>
<!-- layer_12_all2all_back_11&#45;&gt;layer_12_output -->
<g id="edge1133" class="edge">
<title>layer_12_all2all_back_11&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M3583.96,-3240.58C3565.2,-3236.68 3545.75,-3233.08 3527.32,-3230.47 3224.34,-3187.48 2863.42,-3174.78 2681.52,-3171.04"/>
<polygon fill="black" stroke="black" points="2681.46,-3167.53 2671.39,-3170.83 2681.32,-3174.53 2681.46,-3167.53"/>
</g>
<!-- layer_12_all2all_back_12&#45;&gt;layer_12_output -->
<g id="edge1134" class="edge">
<title>layer_12_all2all_back_12&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M3905.43,-3240.43C3886.53,-3236.51 3866.91,-3232.96 3848.32,-3230.47 3624.88,-3200.57 2954.45,-3179.87 2681.68,-3172.47"/>
<polygon fill="black" stroke="black" points="2681.45,-3168.97 2671.36,-3172.19 2681.26,-3175.96 2681.45,-3168.97"/>
</g>
<!-- layer_12_all2all_back_13&#45;&gt;layer_12_output -->
<g id="edge1135" class="edge">
<title>layer_12_all2all_back_13&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M4226.88,-3240.37C4207.84,-3236.44 4188.06,-3232.89 4169.32,-3230.47 3881.54,-3193.34 3000.94,-3176.27 2681.57,-3171.18"/>
<polygon fill="black" stroke="black" points="2681.42,-3167.67 2671.37,-3171.02 2681.31,-3174.67 2681.42,-3167.67"/>
</g>
<!-- layer_12_all2all_back_14&#45;&gt;layer_12_output -->
<g id="edge1136" class="edge">
<title>layer_12_all2all_back_14&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M4547.89,-3240.27C4528.85,-3236.35 4509.07,-3232.83 4490.32,-3230.47 4137.62,-3186.1 3043.19,-3173.36 2681.6,-3170.31"/>
<polygon fill="black" stroke="black" points="2681.41,-3166.81 2671.38,-3170.23 2681.35,-3173.81 2681.41,-3166.81"/>
</g>
<!-- layer_12_all2all_back_15&#45;&gt;layer_12_output -->
<g id="edge1137" class="edge">
<title>layer_12_all2all_back_15&#45;&gt;layer_12_output</title>
<path fill="none" stroke="black" d="M4869.33,-3240.29C4850.16,-3236.34 4830.22,-3232.8 4811.32,-3230.47 4393.25,-3178.84 3082.28,-3170.91 2681.73,-3169.69"/>
<polygon fill="black" stroke="black" points="2681.59,-3166.19 2671.58,-3169.66 2681.57,-3173.19 2681.59,-3166.19"/>
</g>
<!-- layer_13_tp_gather -->
<g id="node834" class="node">
<title>layer_13_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2564.32" cy="-3069.7" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2564.32" y="-3083.7" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2564.32" y="-3072.7" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2564.32" y="-3061.7" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2564.32" y="-3050.7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_12_output&#45;&gt;layer_13_tp_gather -->
<g id="edge1138" class="edge">
<title>layer_12_output&#45;&gt;layer_13_tp_gather</title>
<path fill="none" stroke="black" d="M2546.3,-3142.3C2544.64,-3134.32 2543.91,-3125.24 2544.1,-3116.29"/>
<polygon fill="black" stroke="black" points="2547.59,-3116.51 2544.71,-3106.31 2540.61,-3116.08 2547.59,-3116.51"/>
</g>
<!-- layer_12_output&#45;&gt;layer_13_tp_gather -->
<g id="edge1140" class="edge">
<title>layer_12_output&#45;&gt;layer_13_tp_gather</title>
<path fill="none" stroke="black" d="M2558.32,-3142.3C2557.77,-3134.49 2557.53,-3125.62 2557.58,-3116.85"/>
<polygon fill="black" stroke="black" points="2561.08,-3116.74 2557.77,-3106.68 2554.08,-3116.61 2561.08,-3116.74"/>
</g>
<!-- layer_12_output&#45;&gt;layer_13_tp_gather -->
<g id="edge1142" class="edge">
<title>layer_12_output&#45;&gt;layer_13_tp_gather</title>
<path fill="none" stroke="black" d="M2570.33,-3142.3C2570.87,-3134.49 2571.11,-3125.62 2571.06,-3116.85"/>
<polygon fill="black" stroke="black" points="2574.56,-3116.61 2570.87,-3106.68 2567.56,-3116.74 2574.56,-3116.61"/>
</g>
<!-- layer_12_output&#45;&gt;layer_13_tp_gather -->
<g id="edge1144" class="edge">
<title>layer_12_output&#45;&gt;layer_13_tp_gather</title>
<path fill="none" stroke="black" d="M2582.34,-3142.3C2584,-3134.32 2584.73,-3125.24 2584.54,-3116.29"/>
<polygon fill="black" stroke="black" points="2588.03,-3116.08 2583.93,-3106.31 2581.05,-3116.51 2588.03,-3116.08"/>
</g>
<!-- layer_13_qkv_gpu4 -->
<g id="node833" class="node">
<title>layer_13_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2327.32,-2996.93 2121.32,-2996.93 2121.32,-2944.93 2327.32,-2944.93 2327.32,-2996.93"/>
<text text-anchor="middle" x="2224.32" y="-2984.93" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2224.32" y="-2973.93" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2224.32" y="-2962.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2224.32" y="-2951.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_13_attn_gpu4 -->
<g id="node838" class="node">
<title>layer_13_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2321.32,-2908.93 2119.32,-2908.93 2119.32,-2856.93 2321.32,-2856.93 2321.32,-2908.93"/>
<text text-anchor="middle" x="2220.32" y="-2896.93" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2220.32" y="-2885.93" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2220.32" y="-2874.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2220.32" y="-2863.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_13_qkv_gpu4&#45;&gt;layer_13_attn_gpu4 -->
<g id="edge1146" class="edge">
<title>layer_13_qkv_gpu4&#45;&gt;layer_13_attn_gpu4</title>
<path fill="none" stroke="black" d="M2223.14,-2944.59C2222.77,-2936.63 2222.36,-2927.69 2221.96,-2919.18"/>
<polygon fill="black" stroke="black" points="2225.45,-2918.91 2221.49,-2909.09 2218.46,-2919.24 2225.45,-2918.91"/>
</g>
<!-- layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu4 -->
<g id="edge1139" class="edge">
<title>layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2467.8,-3041.23C2422.16,-3028.24 2367.77,-3012.76 2321.99,-2999.73"/>
<polygon fill="black" stroke="black" points="2322.93,-2996.36 2312.36,-2996.99 2321.02,-3003.09 2322.93,-2996.36"/>
</g>
<!-- layer_13_qkv_gpu5 -->
<g id="node835" class="node">
<title>layer_13_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2554.32,-2996.93 2348.32,-2996.93 2348.32,-2944.93 2554.32,-2944.93 2554.32,-2996.93"/>
<text text-anchor="middle" x="2451.32" y="-2984.93" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2451.32" y="-2973.93" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2451.32" y="-2962.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2451.32" y="-2951.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu5 -->
<g id="edge1141" class="edge">
<title>layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2523.84,-3034.04C2512.22,-3024.08 2499.6,-3013.27 2488.2,-3003.51"/>
<polygon fill="black" stroke="black" points="2490.4,-3000.79 2480.53,-2996.94 2485.85,-3006.11 2490.4,-3000.79"/>
</g>
<!-- layer_13_qkv_gpu6 -->
<g id="node836" class="node">
<title>layer_13_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2780.32,-2996.93 2574.32,-2996.93 2574.32,-2944.93 2780.32,-2944.93 2780.32,-2996.93"/>
<text text-anchor="middle" x="2677.32" y="-2984.93" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2677.32" y="-2973.93" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2677.32" y="-2962.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2677.32" y="-2951.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu6 -->
<g id="edge1143" class="edge">
<title>layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2604.8,-3034.04C2616.43,-3024.08 2629.04,-3013.27 2640.44,-3003.51"/>
<polygon fill="black" stroke="black" points="2642.79,-3006.11 2648.11,-2996.94 2638.24,-3000.79 2642.79,-3006.11"/>
</g>
<!-- layer_13_qkv_gpu7 -->
<g id="node837" class="node">
<title>layer_13_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3005.32,-2996.93 2799.32,-2996.93 2799.32,-2944.93 3005.32,-2944.93 3005.32,-2996.93"/>
<text text-anchor="middle" x="2902.32" y="-2984.93" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2902.32" y="-2973.93" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2902.32" y="-2962.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2902.32" y="-2951.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu7 -->
<g id="edge1145" class="edge">
<title>layer_13_tp_gather&#45;&gt;layer_13_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2660.27,-3041.23C2705.55,-3028.27 2759.49,-3012.82 2804.94,-2999.81"/>
<polygon fill="black" stroke="black" points="2806.15,-3003.1 2814.8,-2996.99 2804.23,-2996.37 2806.15,-3003.1"/>
</g>
<!-- layer_13_attn_gpu5 -->
<g id="node839" class="node">
<title>layer_13_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2550.32,-2908.93 2348.32,-2908.93 2348.32,-2856.93 2550.32,-2856.93 2550.32,-2908.93"/>
<text text-anchor="middle" x="2449.32" y="-2896.93" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2449.32" y="-2885.93" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2449.32" y="-2874.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2449.32" y="-2863.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_13_qkv_gpu5&#45;&gt;layer_13_attn_gpu5 -->
<g id="edge1147" class="edge">
<title>layer_13_qkv_gpu5&#45;&gt;layer_13_attn_gpu5</title>
<path fill="none" stroke="black" d="M2450.73,-2944.59C2450.55,-2936.63 2450.34,-2927.69 2450.14,-2919.18"/>
<polygon fill="black" stroke="black" points="2453.64,-2919 2449.91,-2909.09 2446.64,-2919.17 2453.64,-2919"/>
</g>
<!-- layer_13_attn_gpu6 -->
<g id="node840" class="node">
<title>layer_13_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2781.32,-2908.93 2579.32,-2908.93 2579.32,-2856.93 2781.32,-2856.93 2781.32,-2908.93"/>
<text text-anchor="middle" x="2680.32" y="-2896.93" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2680.32" y="-2885.93" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2680.32" y="-2874.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2680.32" y="-2863.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_13_qkv_gpu6&#45;&gt;layer_13_attn_gpu6 -->
<g id="edge1148" class="edge">
<title>layer_13_qkv_gpu6&#45;&gt;layer_13_attn_gpu6</title>
<path fill="none" stroke="black" d="M2678.2,-2944.59C2678.48,-2936.63 2678.79,-2927.69 2679.09,-2919.18"/>
<polygon fill="black" stroke="black" points="2682.59,-2919.2 2679.44,-2909.09 2675.6,-2918.96 2682.59,-2919.2"/>
</g>
<!-- layer_13_attn_gpu7 -->
<g id="node841" class="node">
<title>layer_13_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3003.32,-2908.93 2801.32,-2908.93 2801.32,-2856.93 3003.32,-2856.93 3003.32,-2908.93"/>
<text text-anchor="middle" x="2902.32" y="-2896.93" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2902.32" y="-2885.93" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2902.32" y="-2874.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2902.32" y="-2863.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_13_qkv_gpu7&#45;&gt;layer_13_attn_gpu7 -->
<g id="edge1149" class="edge">
<title>layer_13_qkv_gpu7&#45;&gt;layer_13_attn_gpu7</title>
<path fill="none" stroke="black" d="M2902.32,-2944.59C2902.32,-2936.63 2902.32,-2927.69 2902.32,-2919.18"/>
<polygon fill="black" stroke="black" points="2905.82,-2919.09 2902.32,-2909.09 2898.82,-2919.09 2905.82,-2919.09"/>
</g>
<!-- layer_13_attn_out_gpu4 -->
<g id="node842" class="node">
<title>layer_13_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2324.32,-2820.93 2110.32,-2820.93 2110.32,-2768.93 2324.32,-2768.93 2324.32,-2820.93"/>
<text text-anchor="middle" x="2217.32" y="-2808.93" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2217.32" y="-2797.93" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2217.32" y="-2786.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2217.32" y="-2775.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_attn_gpu4&#45;&gt;layer_13_attn_out_gpu4 -->
<g id="edge1150" class="edge">
<title>layer_13_attn_gpu4&#45;&gt;layer_13_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2219.44,-2856.59C2219.16,-2848.63 2218.85,-2839.69 2218.55,-2831.18"/>
<polygon fill="black" stroke="black" points="2222.04,-2830.96 2218.2,-2821.09 2215.05,-2831.2 2222.04,-2830.96"/>
</g>
<!-- layer_13_attn_out_gpu5 -->
<g id="node843" class="node">
<title>layer_13_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2556.32,-2820.93 2342.32,-2820.93 2342.32,-2768.93 2556.32,-2768.93 2556.32,-2820.93"/>
<text text-anchor="middle" x="2449.32" y="-2808.93" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2449.32" y="-2797.93" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2449.32" y="-2786.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2449.32" y="-2775.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_attn_gpu5&#45;&gt;layer_13_attn_out_gpu5 -->
<g id="edge1151" class="edge">
<title>layer_13_attn_gpu5&#45;&gt;layer_13_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2449.32,-2856.59C2449.32,-2848.63 2449.32,-2839.69 2449.32,-2831.18"/>
<polygon fill="black" stroke="black" points="2452.82,-2831.09 2449.32,-2821.09 2445.82,-2831.09 2452.82,-2831.09"/>
</g>
<!-- layer_13_attn_out_gpu6 -->
<g id="node844" class="node">
<title>layer_13_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2788.32,-2820.93 2574.32,-2820.93 2574.32,-2768.93 2788.32,-2768.93 2788.32,-2820.93"/>
<text text-anchor="middle" x="2681.32" y="-2808.93" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2681.32" y="-2797.93" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2681.32" y="-2786.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2681.32" y="-2775.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_attn_gpu6&#45;&gt;layer_13_attn_out_gpu6 -->
<g id="edge1152" class="edge">
<title>layer_13_attn_gpu6&#45;&gt;layer_13_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2680.62,-2856.59C2680.71,-2848.63 2680.81,-2839.69 2680.91,-2831.18"/>
<polygon fill="black" stroke="black" points="2684.41,-2831.13 2681.03,-2821.09 2677.41,-2831.05 2684.41,-2831.13"/>
</g>
<!-- layer_13_attn_out_gpu7 -->
<g id="node845" class="node">
<title>layer_13_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3020.32,-2820.93 2806.32,-2820.93 2806.32,-2768.93 3020.32,-2768.93 3020.32,-2820.93"/>
<text text-anchor="middle" x="2913.32" y="-2808.93" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2913.32" y="-2797.93" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2913.32" y="-2786.93" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2913.32" y="-2775.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_attn_gpu7&#45;&gt;layer_13_attn_out_gpu7 -->
<g id="edge1153" class="edge">
<title>layer_13_attn_gpu7&#45;&gt;layer_13_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2905.56,-2856.59C2906.58,-2848.63 2907.72,-2839.69 2908.81,-2831.18"/>
<polygon fill="black" stroke="black" points="2912.31,-2831.45 2910.1,-2821.09 2905.36,-2830.56 2912.31,-2831.45"/>
</g>
<!-- layer_13_attn_allreduce -->
<g id="node846" class="node">
<title>layer_13_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2565.32" cy="-2696.16" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2565.32" y="-2710.16" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2565.32" y="-2699.16" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2565.32" y="-2688.16" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2565.32" y="-2677.16" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_attn_out_gpu4&#45;&gt;layer_13_attn_allreduce -->
<g id="edge1154" class="edge">
<title>layer_13_attn_out_gpu4&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M2307.39,-2768.88C2353.36,-2756.1 2409.61,-2740.46 2457.84,-2727.05"/>
<polygon fill="black" stroke="black" points="2458.99,-2730.36 2467.69,-2724.31 2457.11,-2723.62 2458.99,-2730.36"/>
</g>
<!-- layer_13_attn_out_gpu5&#45;&gt;layer_13_attn_allreduce -->
<g id="edge1155" class="edge">
<title>layer_13_attn_out_gpu5&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M2479.5,-2768.76C2490.73,-2759.39 2503.78,-2748.5 2516.26,-2738.08"/>
<polygon fill="black" stroke="black" points="2518.51,-2740.77 2523.94,-2731.68 2514.02,-2735.4 2518.51,-2740.77"/>
</g>
<!-- layer_13_attn_out_gpu6&#45;&gt;layer_13_attn_allreduce -->
<g id="edge1156" class="edge">
<title>layer_13_attn_out_gpu6&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M2651.15,-2768.76C2639.92,-2759.39 2626.86,-2748.5 2614.38,-2738.08"/>
<polygon fill="black" stroke="black" points="2616.62,-2735.4 2606.7,-2731.68 2612.13,-2740.77 2616.62,-2735.4"/>
</g>
<!-- layer_13_attn_out_gpu7&#45;&gt;layer_13_attn_allreduce -->
<g id="edge1157" class="edge">
<title>layer_13_attn_out_gpu7&#45;&gt;layer_13_attn_allreduce</title>
<path fill="none" stroke="black" d="M2823.25,-2768.88C2777.28,-2756.1 2721.03,-2740.46 2672.8,-2727.05"/>
<polygon fill="black" stroke="black" points="2673.53,-2723.62 2662.96,-2724.31 2671.65,-2730.36 2673.53,-2723.62"/>
</g>
<!-- layer_13_gate -->
<g id="node847" class="node">
<title>layer_13_gate</title>
<polygon fill="lightyellow" stroke="black" points="2782.18,-2623.39 2437.2,-2623.39 2348.46,-2519.39 2693.44,-2519.39 2782.18,-2623.39"/>
<text text-anchor="middle" x="2565.32" y="-2585.39" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2565.32" y="-2574.39" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2565.32" y="-2563.39" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2565.32" y="-2552.39" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_13_attn_allreduce&#45;&gt;layer_13_gate -->
<g id="edge1158" class="edge">
<title>layer_13_attn_allreduce&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2546.76,-2659.65C2545.65,-2651.61 2545.08,-2642.84 2545.07,-2634.07"/>
<polygon fill="black" stroke="black" points="2548.58,-2633.88 2545.31,-2623.8 2541.58,-2633.72 2548.58,-2633.88"/>
</g>
<!-- layer_13_attn_allreduce&#45;&gt;layer_13_gate -->
<g id="edge1159" class="edge">
<title>layer_13_attn_allreduce&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2559.12,-2659.32C2558.75,-2651.28 2558.57,-2642.53 2558.57,-2633.79"/>
<polygon fill="black" stroke="black" points="2562.07,-2633.59 2558.65,-2623.56 2555.07,-2633.53 2562.07,-2633.59"/>
</g>
<!-- layer_13_attn_allreduce&#45;&gt;layer_13_gate -->
<g id="edge1160" class="edge">
<title>layer_13_attn_allreduce&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2571.52,-2659.32C2571.89,-2651.28 2572.07,-2642.53 2572.07,-2633.79"/>
<polygon fill="black" stroke="black" points="2575.57,-2633.53 2571.99,-2623.56 2568.57,-2633.59 2575.57,-2633.53"/>
</g>
<!-- layer_13_attn_allreduce&#45;&gt;layer_13_gate -->
<g id="edge1161" class="edge">
<title>layer_13_attn_allreduce&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2583.88,-2659.65C2584.99,-2651.61 2585.56,-2642.84 2585.57,-2634.07"/>
<polygon fill="black" stroke="black" points="2589.06,-2633.72 2585.33,-2623.8 2582.07,-2633.88 2589.06,-2633.72"/>
</g>
<!-- layer_13_all2all_expert_0 -->
<g id="node849" class="node">
<title>layer_13_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="192.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="192.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="192.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="192.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="192.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_0 -->
<g id="edge1162" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2389.49,-2567.61C1937.67,-2559.82 744.06,-2534.85 351.32,-2483.39 335.87,-2481.37 319.71,-2478.56 303.86,-2475.4"/>
<polygon fill="black" stroke="black" points="304.54,-2471.96 294.04,-2473.39 303.13,-2478.82 304.54,-2471.96"/>
</g>
<!-- layer_13_all2all_expert_1 -->
<g id="node851" class="node">
<title>layer_13_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="508.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="508.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="508.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="508.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="508.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_1 -->
<g id="edge1164" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.12,-2566.04C1983.53,-2555.48 1001.52,-2526.2 673.32,-2483.39 656.68,-2481.22 639.22,-2478.23 622.16,-2474.9"/>
<polygon fill="black" stroke="black" points="622.65,-2471.43 612.16,-2472.9 621.28,-2478.29 622.65,-2471.43"/>
</g>
<!-- layer_13_all2all_expert_2 -->
<g id="node853" class="node">
<title>layer_13_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="830.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="830.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="830.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="830.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="830.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_2 -->
<g id="edge1166" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2391.5,-2570.03C2100.43,-2567.37 1496.62,-2553.01 991.32,-2483.39 975.7,-2481.24 959.35,-2478.36 943.31,-2475.16"/>
<polygon fill="black" stroke="black" points="943.86,-2471.7 933.37,-2473.13 942.46,-2478.56 943.86,-2471.7"/>
</g>
<!-- layer_13_all2all_expert_3 -->
<g id="node855" class="node">
<title>layer_13_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1148.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1148.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1148.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1148.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1148.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_3 -->
<g id="edge1168" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.62,-2566.64C2144.38,-2559.53 1690.34,-2539.39 1307.32,-2483.39 1292.28,-2481.19 1276.55,-2478.34 1261.08,-2475.21"/>
<polygon fill="black" stroke="black" points="1261.46,-2471.71 1250.96,-2473.11 1260.04,-2478.57 1261.46,-2471.71"/>
</g>
<!-- layer_13_all2all_expert_4 -->
<g id="node857" class="node">
<title>layer_13_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1464.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1464.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1464.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1464.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1464.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_4 -->
<g id="edge1170" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2383.67,-2560.69C2193.13,-2548.87 1885.38,-2525.12 1622.32,-2483.39 1607.74,-2481.08 1592.49,-2478.21 1577.47,-2475.11"/>
<polygon fill="black" stroke="black" points="1578.14,-2471.67 1567.63,-2473.04 1576.7,-2478.53 1578.14,-2471.67"/>
</g>
<!-- layer_13_all2all_expert_5 -->
<g id="node859" class="node">
<title>layer_13_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1779.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1779.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1779.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1779.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1779.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_5 -->
<g id="edge1172" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2372.97,-2548.17C2248.09,-2532.66 2082.04,-2510.02 1936.32,-2483.39 1922.47,-2480.86 1907.99,-2477.94 1893.66,-2474.88"/>
<polygon fill="black" stroke="black" points="1894.29,-2471.44 1883.78,-2472.75 1892.82,-2478.28 1894.29,-2471.44"/>
</g>
<!-- layer_13_all2all_expert_6 -->
<g id="node861" class="node">
<title>layer_13_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2093.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2093.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2093.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2093.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2093.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_6 -->
<g id="edge1174" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2368.91,-2519.3C2312.31,-2504.58 2252.59,-2489.05 2203.27,-2476.22"/>
<polygon fill="black" stroke="black" points="2204.1,-2472.82 2193.54,-2473.69 2202.34,-2479.59 2204.1,-2472.82"/>
</g>
<!-- layer_13_all2all_expert_7 -->
<g id="node863" class="node">
<title>layer_13_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2407.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2407.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2407.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2407.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2407.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_7 -->
<g id="edge1176" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2499.23,-2519.04C2486.05,-2508.8 2472.38,-2498.17 2459.73,-2488.35"/>
<polygon fill="black" stroke="black" points="2461.63,-2485.39 2451.59,-2482.02 2457.34,-2490.92 2461.63,-2485.39"/>
</g>
<!-- layer_13_all2all_expert_8 -->
<g id="node865" class="node">
<title>layer_13_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2723.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2723.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2723.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2723.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2723.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_8 -->
<g id="edge1178" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2631.41,-2519.04C2644.59,-2508.8 2658.26,-2498.17 2670.91,-2488.35"/>
<polygon fill="black" stroke="black" points="2673.3,-2490.92 2679.05,-2482.02 2669.01,-2485.39 2673.3,-2490.92"/>
</g>
<!-- layer_13_all2all_expert_9 -->
<g id="node867" class="node">
<title>layer_13_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3041.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3041.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3041.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3041.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3041.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_9 -->
<g id="edge1180" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2706.2,-2534.05C2777.93,-2515.56 2863.86,-2493.39 2930.74,-2476.14"/>
<polygon fill="black" stroke="black" points="2931.66,-2479.52 2940.47,-2473.63 2929.91,-2472.74 2931.66,-2479.52"/>
</g>
<!-- layer_13_all2all_expert_10 -->
<g id="node869" class="node">
<title>layer_13_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3361.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3361.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3361.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3361.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3361.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_10 -->
<g id="edge1182" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2721.94,-2552.38C2850.38,-2536.76 3036.69,-2512.19 3198.32,-2483.39 3213.41,-2480.7 3229.23,-2477.6 3244.82,-2474.36"/>
<polygon fill="black" stroke="black" points="3245.96,-2477.7 3255.03,-2472.22 3244.53,-2470.85 3245.96,-2477.7"/>
</g>
<!-- layer_13_all2all_expert_11 -->
<g id="node871" class="node">
<title>layer_13_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3681.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3681.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3681.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3681.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3681.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_11 -->
<g id="edge1184" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.66,-2561.65C2920.19,-2550.06 3243.31,-2525.95 3518.32,-2483.39 3533.97,-2480.97 3550.37,-2477.95 3566.48,-2474.7"/>
<polygon fill="black" stroke="black" points="3567.37,-2478.09 3576.46,-2472.65 3565.96,-2471.23 3567.37,-2478.09"/>
</g>
<!-- layer_13_all2all_expert_12 -->
<g id="node873" class="node">
<title>layer_13_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4002.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4002.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4002.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4002.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4002.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_12 -->
<g id="edge1186" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.97,-2566.72C2978.49,-2559.62 3445.21,-2539.39 3838.32,-2483.39 3854.45,-2481.09 3871.35,-2478.09 3887.92,-2474.81"/>
<polygon fill="black" stroke="black" points="3889.08,-2478.15 3898.19,-2472.73 3887.69,-2471.28 3889.08,-2478.15"/>
</g>
<!-- layer_13_all2all_expert_13 -->
<g id="node875" class="node">
<title>layer_13_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4323.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4323.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4323.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4323.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4323.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_13 -->
<g id="edge1188" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2736.9,-2570.01C3029.89,-2567.36 3644.89,-2553.07 4159.32,-2483.39 4175.74,-2481.17 4192.95,-2478.17 4209.79,-2474.85"/>
<polygon fill="black" stroke="black" points="4210.55,-2478.26 4219.66,-2472.86 4209.16,-2471.4 4210.55,-2478.26"/>
</g>
<!-- layer_13_all2all_expert_14 -->
<g id="node877" class="node">
<title>layer_13_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4644.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4644.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4644.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4644.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4644.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_14 -->
<g id="edge1190" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.76,-2566.4C3136.24,-2556.27 4145.17,-2527.23 4480.32,-2483.39 4496.75,-2481.24 4513.96,-2478.28 4530.81,-2474.98"/>
<polygon fill="black" stroke="black" points="4531.56,-2478.4 4540.68,-2473 4530.18,-2471.54 4531.56,-2478.4"/>
</g>
<!-- layer_13_all2all_expert_15 -->
<g id="node879" class="node">
<title>layer_13_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4965.32" cy="-2446.62" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4965.32" y="-2460.62" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4965.32" y="-2449.62" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4965.32" y="-2438.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4965.32" y="-2427.62" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_all2all_expert_15 -->
<g id="edge1192" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2734.66,-2567.66C3184.48,-2559.79 4402.1,-2534.29 4801.32,-2483.39 4817.87,-2481.28 4835.23,-2478.32 4852.19,-2475.01"/>
<polygon fill="black" stroke="black" points="4853.01,-2478.41 4862.13,-2473.02 4851.64,-2471.55 4853.01,-2478.41"/>
</g>
<!-- layer_13_expert_0_gpu8 -->
<g id="node848" class="node">
<title>layer_13_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="272.82,-2373.85 63.82,-2373.85 63.82,-2321.85 272.82,-2321.85 272.82,-2373.85"/>
<text text-anchor="middle" x="168.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="168.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="168.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="168.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_0 -->
<g id="node880" class="node">
<title>layer_13_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="156.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="156.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="156.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="156.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="156.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_0_gpu8&#45;&gt;layer_13_all2all_back_0 -->
<g id="edge1194" class="edge">
<title>layer_13_expert_0_gpu8&#45;&gt;layer_13_all2all_back_0</title>
<path fill="none" stroke="black" d="M165.2,-2321.68C164.23,-2313.87 163.13,-2305.01 162.04,-2296.24"/>
<polygon fill="black" stroke="black" points="165.49,-2295.55 160.78,-2286.06 158.54,-2296.41 165.49,-2295.55"/>
</g>
<!-- layer_13_all2all_expert_0&#45;&gt;layer_13_expert_0_gpu8 -->
<g id="edge1163" class="edge">
<title>layer_13_all2all_expert_0&#45;&gt;layer_13_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M183.45,-2409.86C181.34,-2401.37 179.1,-2392.31 177,-2383.85"/>
<polygon fill="black" stroke="black" points="180.34,-2382.76 174.53,-2373.9 173.54,-2384.44 180.34,-2382.76"/>
</g>
<!-- layer_13_expert_1_gpu8 -->
<g id="node850" class="node">
<title>layer_13_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="591.82,-2373.85 382.82,-2373.85 382.82,-2321.85 591.82,-2321.85 591.82,-2373.85"/>
<text text-anchor="middle" x="487.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="487.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="487.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="487.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_1 -->
<g id="node881" class="node">
<title>layer_13_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="477.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="477.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="477.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="477.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="477.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_1_gpu8&#45;&gt;layer_13_all2all_back_1 -->
<g id="edge1195" class="edge">
<title>layer_13_expert_1_gpu8&#45;&gt;layer_13_all2all_back_1</title>
<path fill="none" stroke="black" d="M484.72,-2321.68C483.91,-2313.87 483,-2305.01 482.09,-2296.24"/>
<polygon fill="black" stroke="black" points="485.55,-2295.65 481.04,-2286.06 478.59,-2296.37 485.55,-2295.65"/>
</g>
<!-- layer_13_all2all_expert_1&#45;&gt;layer_13_expert_1_gpu8 -->
<g id="edge1165" class="edge">
<title>layer_13_all2all_expert_1&#45;&gt;layer_13_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M500.56,-2409.86C498.72,-2401.37 496.75,-2392.31 494.92,-2383.85"/>
<polygon fill="black" stroke="black" points="498.3,-2382.93 492.76,-2373.9 491.46,-2384.41 498.3,-2382.93"/>
</g>
<!-- layer_13_expert_2_gpu9 -->
<g id="node852" class="node">
<title>layer_13_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="917.82,-2373.85 708.82,-2373.85 708.82,-2321.85 917.82,-2321.85 917.82,-2373.85"/>
<text text-anchor="middle" x="813.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="813.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="813.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="813.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_2 -->
<g id="node882" class="node">
<title>layer_13_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="798.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="798.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="798.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="798.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="798.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_2_gpu9&#45;&gt;layer_13_all2all_back_2 -->
<g id="edge1196" class="edge">
<title>layer_13_expert_2_gpu9&#45;&gt;layer_13_all2all_back_2</title>
<path fill="none" stroke="black" d="M809.42,-2321.68C808.2,-2313.79 806.8,-2304.81 805.43,-2295.95"/>
<polygon fill="black" stroke="black" points="808.89,-2295.4 803.9,-2286.06 801.97,-2296.48 808.89,-2295.4"/>
</g>
<!-- layer_13_all2all_expert_2&#45;&gt;layer_13_expert_2_gpu9 -->
<g id="edge1167" class="edge">
<title>layer_13_all2all_expert_2&#45;&gt;layer_13_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M824.04,-2409.86C822.55,-2401.37 820.96,-2392.31 819.47,-2383.85"/>
<polygon fill="black" stroke="black" points="822.9,-2383.14 817.72,-2373.9 816,-2384.35 822.9,-2383.14"/>
</g>
<!-- layer_13_expert_3_gpu9 -->
<g id="node854" class="node">
<title>layer_13_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1237.82,-2373.85 1028.82,-2373.85 1028.82,-2321.85 1237.82,-2321.85 1237.82,-2373.85"/>
<text text-anchor="middle" x="1133.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1133.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1133.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1133.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_3 -->
<g id="node883" class="node">
<title>layer_13_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1119.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1119.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1119.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1119.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1119.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_3_gpu9&#45;&gt;layer_13_all2all_back_3 -->
<g id="edge1197" class="edge">
<title>layer_13_expert_3_gpu9&#45;&gt;layer_13_all2all_back_3</title>
<path fill="none" stroke="black" d="M1129.68,-2321.68C1128.55,-2313.87 1127.27,-2305.01 1126,-2296.24"/>
<polygon fill="black" stroke="black" points="1129.42,-2295.45 1124.53,-2286.06 1122.49,-2296.46 1129.42,-2295.45"/>
</g>
<!-- layer_13_all2all_expert_3&#45;&gt;layer_13_expert_3_gpu9 -->
<g id="edge1169" class="edge">
<title>layer_13_all2all_expert_3&#45;&gt;layer_13_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1142.78,-2409.86C1141.46,-2401.37 1140.06,-2392.31 1138.75,-2383.85"/>
<polygon fill="black" stroke="black" points="1142.19,-2383.24 1137.2,-2373.9 1135.28,-2384.31 1142.19,-2383.24"/>
</g>
<!-- layer_13_expert_4_gpu10 -->
<g id="node856" class="node">
<title>layer_13_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1558.82,-2373.85 1349.82,-2373.85 1349.82,-2321.85 1558.82,-2321.85 1558.82,-2373.85"/>
<text text-anchor="middle" x="1454.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1454.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1454.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1454.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_4 -->
<g id="node884" class="node">
<title>layer_13_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1440.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1440.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1440.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1440.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1440.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_4_gpu10&#45;&gt;layer_13_all2all_back_4 -->
<g id="edge1198" class="edge">
<title>layer_13_expert_4_gpu10&#45;&gt;layer_13_all2all_back_4</title>
<path fill="none" stroke="black" d="M1450.68,-2321.68C1449.55,-2313.87 1448.27,-2305.01 1447,-2296.24"/>
<polygon fill="black" stroke="black" points="1450.42,-2295.45 1445.53,-2286.06 1443.49,-2296.46 1450.42,-2295.45"/>
</g>
<!-- layer_13_all2all_expert_4&#45;&gt;layer_13_expert_4_gpu10 -->
<g id="edge1171" class="edge">
<title>layer_13_all2all_expert_4&#45;&gt;layer_13_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1460.63,-2409.86C1459.75,-2401.37 1458.81,-2392.31 1457.94,-2383.85"/>
<polygon fill="black" stroke="black" points="1461.42,-2383.48 1456.91,-2373.9 1454.46,-2384.2 1461.42,-2383.48"/>
</g>
<!-- layer_13_expert_5_gpu10 -->
<g id="node858" class="node">
<title>layer_13_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1873.82,-2373.85 1664.82,-2373.85 1664.82,-2321.85 1873.82,-2321.85 1873.82,-2373.85"/>
<text text-anchor="middle" x="1769.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1769.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1769.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1769.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_5 -->
<g id="node885" class="node">
<title>layer_13_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1761.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1761.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1761.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1761.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1761.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_5_gpu10&#45;&gt;layer_13_all2all_back_5 -->
<g id="edge1199" class="edge">
<title>layer_13_expert_5_gpu10&#45;&gt;layer_13_all2all_back_5</title>
<path fill="none" stroke="black" d="M1767.24,-2321.68C1766.59,-2313.87 1765.86,-2305.01 1765.14,-2296.24"/>
<polygon fill="black" stroke="black" points="1768.61,-2295.74 1764.3,-2286.06 1761.63,-2296.31 1768.61,-2295.74"/>
</g>
<!-- layer_13_all2all_expert_5&#45;&gt;layer_13_expert_5_gpu10 -->
<g id="edge1173" class="edge">
<title>layer_13_all2all_expert_5&#45;&gt;layer_13_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1775.63,-2409.86C1774.75,-2401.37 1773.81,-2392.31 1772.94,-2383.85"/>
<polygon fill="black" stroke="black" points="1776.42,-2383.48 1771.91,-2373.9 1769.46,-2384.2 1776.42,-2383.48"/>
</g>
<!-- layer_13_expert_6_gpu11 -->
<g id="node860" class="node">
<title>layer_13_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2191.82,-2373.85 1982.82,-2373.85 1982.82,-2321.85 2191.82,-2321.85 2191.82,-2373.85"/>
<text text-anchor="middle" x="2087.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2087.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2087.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2087.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_6 -->
<g id="node886" class="node">
<title>layer_13_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2082.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2082.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2082.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2082.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2082.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_6_gpu11&#45;&gt;layer_13_all2all_back_6 -->
<g id="edge1200" class="edge">
<title>layer_13_expert_6_gpu11&#45;&gt;layer_13_all2all_back_6</title>
<path fill="none" stroke="black" d="M2086.02,-2321.68C2085.62,-2313.87 2085.16,-2305.01 2084.71,-2296.24"/>
<polygon fill="black" stroke="black" points="2088.19,-2295.86 2084.18,-2286.06 2081.2,-2296.23 2088.19,-2295.86"/>
</g>
<!-- layer_13_all2all_expert_6&#45;&gt;layer_13_expert_6_gpu11 -->
<g id="edge1175" class="edge">
<title>layer_13_all2all_expert_6&#45;&gt;layer_13_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2091.09,-2409.59C2090.57,-2401.28 2090.02,-2392.44 2089.51,-2384.16"/>
<polygon fill="black" stroke="black" points="2093,-2383.81 2088.88,-2374.05 2086.01,-2384.25 2093,-2383.81"/>
</g>
<!-- layer_13_expert_7_gpu11 -->
<g id="node862" class="node">
<title>layer_13_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2508.82,-2373.85 2299.82,-2373.85 2299.82,-2321.85 2508.82,-2321.85 2508.82,-2373.85"/>
<text text-anchor="middle" x="2404.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2404.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2404.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2404.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_7 -->
<g id="node887" class="node">
<title>layer_13_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2403.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2403.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2403.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2403.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2403.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_7_gpu11&#45;&gt;layer_13_all2all_back_7 -->
<g id="edge1201" class="edge">
<title>layer_13_expert_7_gpu11&#45;&gt;layer_13_all2all_back_7</title>
<path fill="none" stroke="black" d="M2404.06,-2321.68C2403.98,-2313.87 2403.89,-2305.01 2403.8,-2296.24"/>
<polygon fill="black" stroke="black" points="2407.3,-2296.02 2403.69,-2286.06 2400.3,-2296.09 2407.3,-2296.02"/>
</g>
<!-- layer_13_all2all_expert_7&#45;&gt;layer_13_expert_7_gpu11 -->
<g id="edge1177" class="edge">
<title>layer_13_all2all_expert_7&#45;&gt;layer_13_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2406.2,-2409.59C2405.95,-2401.28 2405.67,-2392.44 2405.42,-2384.16"/>
<polygon fill="black" stroke="black" points="2408.91,-2383.93 2405.1,-2374.05 2401.91,-2384.15 2408.91,-2383.93"/>
</g>
<!-- layer_13_expert_8_gpu12 -->
<g id="node864" class="node">
<title>layer_13_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2827.82,-2373.85 2618.82,-2373.85 2618.82,-2321.85 2827.82,-2321.85 2827.82,-2373.85"/>
<text text-anchor="middle" x="2723.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2723.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2723.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2723.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_8 -->
<g id="node888" class="node">
<title>layer_13_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2724.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2724.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2724.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2724.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2724.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_8_gpu12&#45;&gt;layer_13_all2all_back_8 -->
<g id="edge1202" class="edge">
<title>layer_13_expert_8_gpu12&#45;&gt;layer_13_all2all_back_8</title>
<path fill="none" stroke="black" d="M2723.58,-2321.68C2723.66,-2313.87 2723.75,-2305.01 2723.84,-2296.24"/>
<polygon fill="black" stroke="black" points="2727.35,-2296.09 2723.95,-2286.06 2720.35,-2296.02 2727.35,-2296.09"/>
</g>
<!-- layer_13_all2all_expert_8&#45;&gt;layer_13_expert_8_gpu12 -->
<g id="edge1179" class="edge">
<title>layer_13_all2all_expert_8&#45;&gt;layer_13_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2723.32,-2409.59C2723.32,-2401.28 2723.32,-2392.44 2723.32,-2384.16"/>
<polygon fill="black" stroke="black" points="2726.82,-2384.05 2723.32,-2374.05 2719.82,-2384.05 2726.82,-2384.05"/>
</g>
<!-- layer_13_expert_9_gpu12 -->
<g id="node866" class="node">
<title>layer_13_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3147.82,-2373.85 2938.82,-2373.85 2938.82,-2321.85 3147.82,-2321.85 3147.82,-2373.85"/>
<text text-anchor="middle" x="3043.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3043.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3043.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3043.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_9 -->
<g id="node889" class="node">
<title>layer_13_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3045.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3045.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3045.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3045.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3045.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_9_gpu12&#45;&gt;layer_13_all2all_back_9 -->
<g id="edge1203" class="edge">
<title>layer_13_expert_9_gpu12&#45;&gt;layer_13_all2all_back_9</title>
<path fill="none" stroke="black" d="M3043.84,-2321.68C3044,-2313.87 3044.19,-2305.01 3044.37,-2296.24"/>
<polygon fill="black" stroke="black" points="3047.87,-2296.13 3044.58,-2286.06 3040.87,-2295.98 3047.87,-2296.13"/>
</g>
<!-- layer_13_all2all_expert_9&#45;&gt;layer_13_expert_9_gpu12 -->
<g id="edge1181" class="edge">
<title>layer_13_all2all_expert_9&#45;&gt;layer_13_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3042.07,-2409.59C3042.24,-2401.28 3042.42,-2392.44 3042.59,-2384.16"/>
<polygon fill="black" stroke="black" points="3046.09,-2384.12 3042.8,-2374.05 3039.09,-2383.97 3046.09,-2384.12"/>
</g>
<!-- layer_13_expert_10_gpu13 -->
<g id="node868" class="node">
<title>layer_13_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3467.82,-2373.85 3258.82,-2373.85 3258.82,-2321.85 3467.82,-2321.85 3467.82,-2373.85"/>
<text text-anchor="middle" x="3363.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3363.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3363.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3363.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_10 -->
<g id="node890" class="node">
<title>layer_13_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3366.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3366.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3366.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3366.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3366.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_10_gpu13&#45;&gt;layer_13_all2all_back_10 -->
<g id="edge1204" class="edge">
<title>layer_13_expert_10_gpu13&#45;&gt;layer_13_all2all_back_10</title>
<path fill="none" stroke="black" d="M3364.1,-2321.68C3364.34,-2313.87 3364.62,-2305.01 3364.89,-2296.24"/>
<polygon fill="black" stroke="black" points="3368.39,-2296.16 3365.21,-2286.06 3361.4,-2295.95 3368.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_10&#45;&gt;layer_13_expert_10_gpu13 -->
<g id="edge1183" class="edge">
<title>layer_13_all2all_expert_10&#45;&gt;layer_13_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3362.07,-2409.59C3362.24,-2401.28 3362.42,-2392.44 3362.59,-2384.16"/>
<polygon fill="black" stroke="black" points="3366.09,-2384.12 3362.8,-2374.05 3359.09,-2383.97 3366.09,-2384.12"/>
</g>
<!-- layer_13_expert_11_gpu13 -->
<g id="node870" class="node">
<title>layer_13_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3788.82,-2373.85 3579.82,-2373.85 3579.82,-2321.85 3788.82,-2321.85 3788.82,-2373.85"/>
<text text-anchor="middle" x="3684.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3684.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3684.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3684.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_11 -->
<g id="node891" class="node">
<title>layer_13_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3687.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3687.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3687.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3687.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3687.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_11_gpu13&#45;&gt;layer_13_all2all_back_11 -->
<g id="edge1205" class="edge">
<title>layer_13_expert_11_gpu13&#45;&gt;layer_13_all2all_back_11</title>
<path fill="none" stroke="black" d="M3685.1,-2321.68C3685.34,-2313.87 3685.62,-2305.01 3685.89,-2296.24"/>
<polygon fill="black" stroke="black" points="3689.39,-2296.16 3686.21,-2286.06 3682.4,-2295.95 3689.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_11&#45;&gt;layer_13_expert_11_gpu13 -->
<g id="edge1185" class="edge">
<title>layer_13_all2all_expert_11&#45;&gt;layer_13_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3682.44,-2409.59C3682.7,-2401.28 3682.97,-2392.44 3683.23,-2384.16"/>
<polygon fill="black" stroke="black" points="3686.73,-2384.15 3683.54,-2374.05 3679.73,-2383.93 3686.73,-2384.15"/>
</g>
<!-- layer_13_expert_12_gpu14 -->
<g id="node872" class="node">
<title>layer_13_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4109.82,-2373.85 3900.82,-2373.85 3900.82,-2321.85 4109.82,-2321.85 4109.82,-2373.85"/>
<text text-anchor="middle" x="4005.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4005.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4005.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4005.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_12 -->
<g id="node892" class="node">
<title>layer_13_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4008.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4008.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4008.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4008.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4008.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_12_gpu14&#45;&gt;layer_13_all2all_back_12 -->
<g id="edge1206" class="edge">
<title>layer_13_expert_12_gpu14&#45;&gt;layer_13_all2all_back_12</title>
<path fill="none" stroke="black" d="M4006.1,-2321.68C4006.34,-2313.87 4006.62,-2305.01 4006.89,-2296.24"/>
<polygon fill="black" stroke="black" points="4010.39,-2296.16 4007.21,-2286.06 4003.4,-2295.95 4010.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_12&#45;&gt;layer_13_expert_12_gpu14 -->
<g id="edge1187" class="edge">
<title>layer_13_all2all_expert_12&#45;&gt;layer_13_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4003.44,-2409.59C4003.7,-2401.28 4003.97,-2392.44 4004.23,-2384.16"/>
<polygon fill="black" stroke="black" points="4007.73,-2384.15 4004.54,-2374.05 4000.73,-2383.93 4007.73,-2384.15"/>
</g>
<!-- layer_13_expert_13_gpu14 -->
<g id="node874" class="node">
<title>layer_13_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4430.82,-2373.85 4221.82,-2373.85 4221.82,-2321.85 4430.82,-2321.85 4430.82,-2373.85"/>
<text text-anchor="middle" x="4326.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4326.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4326.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4326.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_13 -->
<g id="node893" class="node">
<title>layer_13_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4329.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4329.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4329.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4329.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4329.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_13_gpu14&#45;&gt;layer_13_all2all_back_13 -->
<g id="edge1207" class="edge">
<title>layer_13_expert_13_gpu14&#45;&gt;layer_13_all2all_back_13</title>
<path fill="none" stroke="black" d="M4327.1,-2321.68C4327.34,-2313.87 4327.62,-2305.01 4327.89,-2296.24"/>
<polygon fill="black" stroke="black" points="4331.39,-2296.16 4328.21,-2286.06 4324.4,-2295.95 4331.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_13&#45;&gt;layer_13_expert_13_gpu14 -->
<g id="edge1189" class="edge">
<title>layer_13_all2all_expert_13&#45;&gt;layer_13_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4324.44,-2409.59C4324.7,-2401.28 4324.97,-2392.44 4325.23,-2384.16"/>
<polygon fill="black" stroke="black" points="4328.73,-2384.15 4325.54,-2374.05 4321.73,-2383.93 4328.73,-2384.15"/>
</g>
<!-- layer_13_expert_14_gpu15 -->
<g id="node876" class="node">
<title>layer_13_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4751.82,-2373.85 4542.82,-2373.85 4542.82,-2321.85 4751.82,-2321.85 4751.82,-2373.85"/>
<text text-anchor="middle" x="4647.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4647.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4647.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4647.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_14 -->
<g id="node894" class="node">
<title>layer_13_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4650.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4650.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4650.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4650.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4650.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_14_gpu15&#45;&gt;layer_13_all2all_back_14 -->
<g id="edge1208" class="edge">
<title>layer_13_expert_14_gpu15&#45;&gt;layer_13_all2all_back_14</title>
<path fill="none" stroke="black" d="M4648.1,-2321.68C4648.34,-2313.87 4648.62,-2305.01 4648.89,-2296.24"/>
<polygon fill="black" stroke="black" points="4652.39,-2296.16 4649.21,-2286.06 4645.4,-2295.95 4652.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_14&#45;&gt;layer_13_expert_14_gpu15 -->
<g id="edge1191" class="edge">
<title>layer_13_all2all_expert_14&#45;&gt;layer_13_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4645.44,-2409.59C4645.7,-2401.28 4645.97,-2392.44 4646.23,-2384.16"/>
<polygon fill="black" stroke="black" points="4649.73,-2384.15 4646.54,-2374.05 4642.73,-2383.93 4649.73,-2384.15"/>
</g>
<!-- layer_13_expert_15_gpu15 -->
<g id="node878" class="node">
<title>layer_13_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5072.82,-2373.85 4863.82,-2373.85 4863.82,-2321.85 5072.82,-2321.85 5072.82,-2373.85"/>
<text text-anchor="middle" x="4968.32" y="-2361.85" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4968.32" y="-2350.85" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4968.32" y="-2339.85" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4968.32" y="-2328.85" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_15 -->
<g id="node895" class="node">
<title>layer_13_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4971.32" cy="-2249.08" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4971.32" y="-2263.08" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4971.32" y="-2252.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4971.32" y="-2241.08" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4971.32" y="-2230.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_expert_15_gpu15&#45;&gt;layer_13_all2all_back_15 -->
<g id="edge1209" class="edge">
<title>layer_13_expert_15_gpu15&#45;&gt;layer_13_all2all_back_15</title>
<path fill="none" stroke="black" d="M4969.1,-2321.68C4969.34,-2313.87 4969.62,-2305.01 4969.89,-2296.24"/>
<polygon fill="black" stroke="black" points="4973.39,-2296.16 4970.21,-2286.06 4966.4,-2295.95 4973.39,-2296.16"/>
</g>
<!-- layer_13_all2all_expert_15&#45;&gt;layer_13_expert_15_gpu15 -->
<g id="edge1193" class="edge">
<title>layer_13_all2all_expert_15&#45;&gt;layer_13_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4966.44,-2409.59C4966.7,-2401.28 4966.97,-2392.44 4967.23,-2384.16"/>
<polygon fill="black" stroke="black" points="4970.73,-2384.15 4967.54,-2374.05 4963.73,-2383.93 4970.73,-2384.15"/>
</g>
<!-- layer_13_output -->
<g id="node896" class="node">
<title>layer_13_output</title>
<polygon fill="lightblue" stroke="black" points="2670.32,-2176.31 2456.32,-2176.31 2456.32,-2124.31 2670.32,-2124.31 2670.32,-2176.31"/>
<text text-anchor="middle" x="2563.32" y="-2164.31" font-family="Arial" font-size="10.00">Layer 13 Output</text>
<text text-anchor="middle" x="2563.32" y="-2153.31" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2563.32" y="-2142.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2563.32" y="-2131.31" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_13_all2all_back_0&#45;&gt;layer_13_output -->
<g id="edge1210" class="edge">
<title>layer_13_all2all_back_0&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M259.31,-2222.14C278.48,-2218.18 298.42,-2214.65 317.32,-2212.31 735.21,-2160.7 2045.59,-2152.76 2445.96,-2151.53"/>
<polygon fill="black" stroke="black" points="2446.12,-2155.03 2456.11,-2151.5 2446.1,-2148.03 2446.12,-2155.03"/>
</g>
<!-- layer_13_all2all_back_1&#45;&gt;layer_13_output -->
<g id="edge1211" class="edge">
<title>layer_13_all2all_back_1&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M580.75,-2222.12C599.79,-2218.19 619.57,-2214.67 638.32,-2212.31 990.84,-2167.96 2084.7,-2155.21 2446.1,-2152.16"/>
<polygon fill="black" stroke="black" points="2446.35,-2155.65 2456.32,-2152.07 2446.29,-2148.65 2446.35,-2155.65"/>
</g>
<!-- layer_13_all2all_back_2&#45;&gt;layer_13_output -->
<g id="edge1212" class="edge">
<title>layer_13_all2all_back_2&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M901.76,-2222.22C920.8,-2218.28 940.58,-2214.73 959.32,-2212.31 1246.83,-2175.22 2126.45,-2158.13 2445.86,-2153.03"/>
<polygon fill="black" stroke="black" points="2446.12,-2156.52 2456.06,-2152.86 2446.01,-2149.52 2446.12,-2156.52"/>
</g>
<!-- layer_13_all2all_back_3&#45;&gt;layer_13_output -->
<g id="edge1213" class="edge">
<title>layer_13_all2all_back_3&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M1223.21,-2222.27C1242.12,-2218.36 1261.73,-2214.8 1280.32,-2212.31 1503.45,-2182.45 2172.68,-2161.75 2445.55,-2154.33"/>
<polygon fill="black" stroke="black" points="2445.98,-2157.82 2455.88,-2154.05 2445.79,-2150.82 2445.98,-2157.82"/>
</g>
<!-- layer_13_all2all_back_4&#45;&gt;layer_13_output -->
<g id="edge1214" class="edge">
<title>layer_13_all2all_back_4&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M1544.68,-2222.43C1563.45,-2218.52 1582.89,-2214.93 1601.32,-2212.31 1903.78,-2169.39 2264.05,-2156.66 2445.88,-2152.9"/>
<polygon fill="black" stroke="black" points="2446.07,-2156.39 2456,-2152.69 2445.93,-2149.39 2446.07,-2156.39"/>
</g>
<!-- layer_13_all2all_back_5&#45;&gt;layer_13_output -->
<g id="edge1215" class="edge">
<title>layer_13_all2all_back_5&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M1867.05,-2222.64C1885.41,-2218.78 1904.36,-2215.15 1922.32,-2212.31 2104.01,-2183.6 2316.95,-2166.6 2445.91,-2158.11"/>
<polygon fill="black" stroke="black" points="2446.45,-2161.58 2456.2,-2157.44 2445.99,-2154.6 2446.45,-2161.58"/>
</g>
<!-- layer_13_all2all_back_6&#45;&gt;layer_13_output -->
<g id="edge1216" class="edge">
<title>layer_13_all2all_back_6&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M2191.35,-2223.39C2208.71,-2219.59 2226.5,-2215.78 2243.32,-2212.31 2310.35,-2198.48 2385.51,-2184.1 2446.14,-2172.77"/>
<polygon fill="black" stroke="black" points="2446.94,-2176.18 2456.13,-2170.91 2445.66,-2169.3 2446.94,-2176.18"/>
</g>
<!-- layer_13_all2all_back_7&#45;&gt;layer_13_output -->
<g id="edge1217" class="edge">
<title>layer_13_all2all_back_7&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M2458.38,-2214.78C2476.09,-2204.07 2495.6,-2192.27 2512.95,-2181.78"/>
<polygon fill="black" stroke="black" points="2515.06,-2184.59 2521.81,-2176.42 2511.44,-2178.6 2515.06,-2184.59"/>
</g>
<!-- layer_13_all2all_back_8&#45;&gt;layer_13_output -->
<g id="edge1218" class="edge">
<title>layer_13_all2all_back_8&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M2668.91,-2214.78C2651.1,-2204.07 2631.46,-2192.27 2614,-2181.78"/>
<polygon fill="black" stroke="black" points="2615.47,-2178.57 2605.09,-2176.42 2611.86,-2184.57 2615.47,-2178.57"/>
</g>
<!-- layer_13_all2all_back_9&#45;&gt;layer_13_output -->
<g id="edge1219" class="edge">
<title>layer_13_all2all_back_9&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M2936.3,-2223.38C2918.93,-2219.59 2901.15,-2215.78 2884.32,-2212.31 2816.96,-2198.43 2741.39,-2184.02 2680.51,-2172.69"/>
<polygon fill="black" stroke="black" points="2680.96,-2169.21 2670.48,-2170.82 2679.68,-2176.09 2680.96,-2169.21"/>
</g>
<!-- layer_13_all2all_back_10&#45;&gt;layer_13_output -->
<g id="edge1220" class="edge">
<title>layer_13_all2all_back_10&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M3260.59,-2222.64C3242.24,-2218.78 3223.28,-2215.15 3205.32,-2212.31 3023.22,-2183.55 2809.76,-2166.55 2680.63,-2158.08"/>
<polygon fill="black" stroke="black" points="2680.53,-2154.57 2670.33,-2157.41 2680.08,-2161.55 2680.53,-2154.57"/>
</g>
<!-- layer_13_all2all_back_11&#45;&gt;layer_13_output -->
<g id="edge1221" class="edge">
<title>layer_13_all2all_back_11&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M3582.96,-2222.43C3564.2,-2218.52 3544.75,-2214.93 3526.32,-2212.31 3223.34,-2169.33 2862.42,-2156.63 2680.52,-2152.88"/>
<polygon fill="black" stroke="black" points="2680.46,-2149.38 2670.39,-2152.68 2680.32,-2156.38 2680.46,-2149.38"/>
</g>
<!-- layer_13_all2all_back_12&#45;&gt;layer_13_output -->
<g id="edge1222" class="edge">
<title>layer_13_all2all_back_12&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M3904.43,-2222.27C3885.53,-2218.36 3865.91,-2214.8 3847.32,-2212.31 3623.88,-2182.41 2953.45,-2161.71 2680.68,-2154.32"/>
<polygon fill="black" stroke="black" points="2680.45,-2150.81 2670.36,-2154.04 2680.26,-2157.81 2680.45,-2150.81"/>
</g>
<!-- layer_13_all2all_back_13&#45;&gt;layer_13_output -->
<g id="edge1223" class="edge">
<title>layer_13_all2all_back_13&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M4225.88,-2222.22C4206.84,-2218.28 4187.06,-2214.73 4168.32,-2212.31 3880.54,-2175.19 2999.94,-2158.11 2680.57,-2153.02"/>
<polygon fill="black" stroke="black" points="2680.42,-2149.52 2670.37,-2152.86 2680.31,-2156.52 2680.42,-2149.52"/>
</g>
<!-- layer_13_all2all_back_14&#45;&gt;layer_13_output -->
<g id="edge1224" class="edge">
<title>layer_13_all2all_back_14&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M4546.89,-2222.12C4527.85,-2218.19 4508.07,-2214.67 4489.32,-2212.31 4136.62,-2167.94 3042.19,-2155.2 2680.6,-2152.15"/>
<polygon fill="black" stroke="black" points="2680.41,-2148.65 2670.38,-2152.07 2680.35,-2155.65 2680.41,-2148.65"/>
</g>
<!-- layer_13_all2all_back_15&#45;&gt;layer_13_output -->
<g id="edge1225" class="edge">
<title>layer_13_all2all_back_15&#45;&gt;layer_13_output</title>
<path fill="none" stroke="black" d="M4868.33,-2222.14C4849.16,-2218.18 4829.22,-2214.65 4810.32,-2212.31 4392.25,-2160.68 3081.28,-2152.75 2680.73,-2151.53"/>
<polygon fill="black" stroke="black" points="2680.59,-2148.03 2670.58,-2151.5 2680.57,-2155.03 2680.59,-2148.03"/>
</g>
<!-- layer_14_tp_gather -->
<g id="node898" class="node">
<title>layer_14_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2563.32" cy="-2051.54" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2563.32" y="-2065.54" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2563.32" y="-2054.54" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2563.32" y="-2043.54" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2563.32" y="-2032.54" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_13_output&#45;&gt;layer_14_tp_gather -->
<g id="edge1226" class="edge">
<title>layer_13_output&#45;&gt;layer_14_tp_gather</title>
<path fill="none" stroke="black" d="M2545.3,-2124.14C2543.64,-2116.17 2542.91,-2107.09 2543.1,-2098.14"/>
<polygon fill="black" stroke="black" points="2546.59,-2098.35 2543.71,-2088.15 2539.61,-2097.92 2546.59,-2098.35"/>
</g>
<!-- layer_13_output&#45;&gt;layer_14_tp_gather -->
<g id="edge1228" class="edge">
<title>layer_13_output&#45;&gt;layer_14_tp_gather</title>
<path fill="none" stroke="black" d="M2557.32,-2124.14C2556.77,-2116.33 2556.53,-2107.47 2556.58,-2098.7"/>
<polygon fill="black" stroke="black" points="2560.08,-2098.58 2556.77,-2088.52 2553.08,-2098.45 2560.08,-2098.58"/>
</g>
<!-- layer_13_output&#45;&gt;layer_14_tp_gather -->
<g id="edge1230" class="edge">
<title>layer_13_output&#45;&gt;layer_14_tp_gather</title>
<path fill="none" stroke="black" d="M2569.33,-2124.14C2569.87,-2116.33 2570.11,-2107.47 2570.06,-2098.7"/>
<polygon fill="black" stroke="black" points="2573.56,-2098.45 2569.87,-2088.52 2566.56,-2098.58 2573.56,-2098.45"/>
</g>
<!-- layer_13_output&#45;&gt;layer_14_tp_gather -->
<g id="edge1232" class="edge">
<title>layer_13_output&#45;&gt;layer_14_tp_gather</title>
<path fill="none" stroke="black" d="M2581.34,-2124.14C2583,-2116.17 2583.73,-2107.09 2583.54,-2098.14"/>
<polygon fill="black" stroke="black" points="2587.03,-2097.92 2582.93,-2088.15 2580.05,-2098.35 2587.03,-2097.92"/>
</g>
<!-- layer_14_qkv_gpu4 -->
<g id="node897" class="node">
<title>layer_14_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2326.32,-1978.77 2120.32,-1978.77 2120.32,-1926.77 2326.32,-1926.77 2326.32,-1978.77"/>
<text text-anchor="middle" x="2223.32" y="-1966.77" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2223.32" y="-1955.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2223.32" y="-1944.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2223.32" y="-1933.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_14_attn_gpu4 -->
<g id="node902" class="node">
<title>layer_14_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2321.32,-1890.77 2119.32,-1890.77 2119.32,-1838.77 2321.32,-1838.77 2321.32,-1890.77"/>
<text text-anchor="middle" x="2220.32" y="-1878.77" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2220.32" y="-1867.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2220.32" y="-1856.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2220.32" y="-1845.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_14_qkv_gpu4&#45;&gt;layer_14_attn_gpu4 -->
<g id="edge1234" class="edge">
<title>layer_14_qkv_gpu4&#45;&gt;layer_14_attn_gpu4</title>
<path fill="none" stroke="black" d="M2222.44,-1926.44C2222.16,-1918.48 2221.85,-1909.54 2221.55,-1901.02"/>
<polygon fill="black" stroke="black" points="2225.04,-1900.8 2221.2,-1890.93 2218.05,-1901.05 2225.04,-1900.8"/>
</g>
<!-- layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu4 -->
<g id="edge1227" class="edge">
<title>layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2466.8,-2023.07C2421.16,-2010.08 2366.77,-1994.6 2320.99,-1981.57"/>
<polygon fill="black" stroke="black" points="2321.93,-1978.2 2311.36,-1978.83 2320.02,-1984.93 2321.93,-1978.2"/>
</g>
<!-- layer_14_qkv_gpu5 -->
<g id="node899" class="node">
<title>layer_14_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2553.32,-1978.77 2347.32,-1978.77 2347.32,-1926.77 2553.32,-1926.77 2553.32,-1978.77"/>
<text text-anchor="middle" x="2450.32" y="-1966.77" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2450.32" y="-1955.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2450.32" y="-1944.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2450.32" y="-1933.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu5 -->
<g id="edge1229" class="edge">
<title>layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2522.84,-2015.88C2511.22,-2005.92 2498.6,-1995.12 2487.2,-1985.36"/>
<polygon fill="black" stroke="black" points="2489.4,-1982.63 2479.53,-1978.79 2484.85,-1987.95 2489.4,-1982.63"/>
</g>
<!-- layer_14_qkv_gpu6 -->
<g id="node900" class="node">
<title>layer_14_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2779.32,-1978.77 2573.32,-1978.77 2573.32,-1926.77 2779.32,-1926.77 2779.32,-1978.77"/>
<text text-anchor="middle" x="2676.32" y="-1966.77" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2676.32" y="-1955.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2676.32" y="-1944.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2676.32" y="-1933.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu6 -->
<g id="edge1231" class="edge">
<title>layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2603.8,-2015.88C2615.43,-2005.92 2628.04,-1995.12 2639.44,-1985.36"/>
<polygon fill="black" stroke="black" points="2641.79,-1987.95 2647.11,-1978.79 2637.24,-1982.63 2641.79,-1987.95"/>
</g>
<!-- layer_14_qkv_gpu7 -->
<g id="node901" class="node">
<title>layer_14_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3004.32,-1978.77 2798.32,-1978.77 2798.32,-1926.77 3004.32,-1926.77 3004.32,-1978.77"/>
<text text-anchor="middle" x="2901.32" y="-1966.77" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2901.32" y="-1955.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2901.32" y="-1944.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2901.32" y="-1933.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu7 -->
<g id="edge1233" class="edge">
<title>layer_14_tp_gather&#45;&gt;layer_14_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2659.27,-2023.07C2704.55,-2010.11 2758.49,-1994.67 2803.94,-1981.65"/>
<polygon fill="black" stroke="black" points="2805.15,-1984.95 2813.8,-1978.83 2803.23,-1978.22 2805.15,-1984.95"/>
</g>
<!-- layer_14_attn_gpu5 -->
<g id="node903" class="node">
<title>layer_14_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2549.32,-1890.77 2347.32,-1890.77 2347.32,-1838.77 2549.32,-1838.77 2549.32,-1890.77"/>
<text text-anchor="middle" x="2448.32" y="-1878.77" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2448.32" y="-1867.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2448.32" y="-1856.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2448.32" y="-1845.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_14_qkv_gpu5&#45;&gt;layer_14_attn_gpu5 -->
<g id="edge1235" class="edge">
<title>layer_14_qkv_gpu5&#45;&gt;layer_14_attn_gpu5</title>
<path fill="none" stroke="black" d="M2449.73,-1926.44C2449.55,-1918.48 2449.34,-1909.54 2449.14,-1901.02"/>
<polygon fill="black" stroke="black" points="2452.64,-1900.85 2448.91,-1890.93 2445.64,-1901.01 2452.64,-1900.85"/>
</g>
<!-- layer_14_attn_gpu6 -->
<g id="node904" class="node">
<title>layer_14_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2780.32,-1890.77 2578.32,-1890.77 2578.32,-1838.77 2780.32,-1838.77 2780.32,-1890.77"/>
<text text-anchor="middle" x="2679.32" y="-1878.77" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2679.32" y="-1867.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2679.32" y="-1856.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2679.32" y="-1845.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_14_qkv_gpu6&#45;&gt;layer_14_attn_gpu6 -->
<g id="edge1236" class="edge">
<title>layer_14_qkv_gpu6&#45;&gt;layer_14_attn_gpu6</title>
<path fill="none" stroke="black" d="M2677.2,-1926.44C2677.48,-1918.48 2677.79,-1909.54 2678.09,-1901.02"/>
<polygon fill="black" stroke="black" points="2681.59,-1901.05 2678.44,-1890.93 2674.6,-1900.8 2681.59,-1901.05"/>
</g>
<!-- layer_14_attn_gpu7 -->
<g id="node905" class="node">
<title>layer_14_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3002.32,-1890.77 2800.32,-1890.77 2800.32,-1838.77 3002.32,-1838.77 3002.32,-1890.77"/>
<text text-anchor="middle" x="2901.32" y="-1878.77" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2901.32" y="-1867.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2901.32" y="-1856.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2901.32" y="-1845.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_14_qkv_gpu7&#45;&gt;layer_14_attn_gpu7 -->
<g id="edge1237" class="edge">
<title>layer_14_qkv_gpu7&#45;&gt;layer_14_attn_gpu7</title>
<path fill="none" stroke="black" d="M2901.32,-1926.44C2901.32,-1918.48 2901.32,-1909.54 2901.32,-1901.02"/>
<polygon fill="black" stroke="black" points="2904.82,-1900.93 2901.32,-1890.93 2897.82,-1900.93 2904.82,-1900.93"/>
</g>
<!-- layer_14_attn_out_gpu4 -->
<g id="node906" class="node">
<title>layer_14_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2323.32,-1802.77 2109.32,-1802.77 2109.32,-1750.77 2323.32,-1750.77 2323.32,-1802.77"/>
<text text-anchor="middle" x="2216.32" y="-1790.77" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2216.32" y="-1779.77" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2216.32" y="-1768.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2216.32" y="-1757.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_attn_gpu4&#45;&gt;layer_14_attn_out_gpu4 -->
<g id="edge1238" class="edge">
<title>layer_14_attn_gpu4&#45;&gt;layer_14_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2219.14,-1838.44C2218.77,-1830.48 2218.36,-1821.54 2217.96,-1813.02"/>
<polygon fill="black" stroke="black" points="2221.45,-1812.76 2217.49,-1802.93 2214.46,-1813.08 2221.45,-1812.76"/>
</g>
<!-- layer_14_attn_out_gpu5 -->
<g id="node907" class="node">
<title>layer_14_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2555.32,-1802.77 2341.32,-1802.77 2341.32,-1750.77 2555.32,-1750.77 2555.32,-1802.77"/>
<text text-anchor="middle" x="2448.32" y="-1790.77" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2448.32" y="-1779.77" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2448.32" y="-1768.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2448.32" y="-1757.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_attn_gpu5&#45;&gt;layer_14_attn_out_gpu5 -->
<g id="edge1239" class="edge">
<title>layer_14_attn_gpu5&#45;&gt;layer_14_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2448.32,-1838.44C2448.32,-1830.48 2448.32,-1821.54 2448.32,-1813.02"/>
<polygon fill="black" stroke="black" points="2451.82,-1812.93 2448.32,-1802.93 2444.82,-1812.93 2451.82,-1812.93"/>
</g>
<!-- layer_14_attn_out_gpu6 -->
<g id="node908" class="node">
<title>layer_14_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2787.32,-1802.77 2573.32,-1802.77 2573.32,-1750.77 2787.32,-1750.77 2787.32,-1802.77"/>
<text text-anchor="middle" x="2680.32" y="-1790.77" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2680.32" y="-1779.77" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2680.32" y="-1768.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2680.32" y="-1757.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_attn_gpu6&#45;&gt;layer_14_attn_out_gpu6 -->
<g id="edge1240" class="edge">
<title>layer_14_attn_gpu6&#45;&gt;layer_14_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2679.62,-1838.44C2679.71,-1830.48 2679.81,-1821.54 2679.91,-1813.02"/>
<polygon fill="black" stroke="black" points="2683.41,-1812.97 2680.03,-1802.93 2676.41,-1812.89 2683.41,-1812.97"/>
</g>
<!-- layer_14_attn_out_gpu7 -->
<g id="node909" class="node">
<title>layer_14_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3019.32,-1802.77 2805.32,-1802.77 2805.32,-1750.77 3019.32,-1750.77 3019.32,-1802.77"/>
<text text-anchor="middle" x="2912.32" y="-1790.77" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2912.32" y="-1779.77" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2912.32" y="-1768.77" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2912.32" y="-1757.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_attn_gpu7&#45;&gt;layer_14_attn_out_gpu7 -->
<g id="edge1241" class="edge">
<title>layer_14_attn_gpu7&#45;&gt;layer_14_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2904.56,-1838.44C2905.58,-1830.48 2906.72,-1821.54 2907.81,-1813.02"/>
<polygon fill="black" stroke="black" points="2911.31,-1813.29 2909.1,-1802.93 2904.36,-1812.41 2911.31,-1813.29"/>
</g>
<!-- layer_14_attn_allreduce -->
<g id="node910" class="node">
<title>layer_14_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2564.32" cy="-1678" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2564.32" y="-1692" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2564.32" y="-1681" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2564.32" y="-1670" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2564.32" y="-1659" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_attn_out_gpu4&#45;&gt;layer_14_attn_allreduce -->
<g id="edge1242" class="edge">
<title>layer_14_attn_out_gpu4&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M2306.39,-1750.73C2352.36,-1737.94 2408.61,-1722.3 2456.84,-1708.89"/>
<polygon fill="black" stroke="black" points="2457.99,-1712.21 2466.69,-1706.15 2456.11,-1705.46 2457.99,-1712.21"/>
</g>
<!-- layer_14_attn_out_gpu5&#45;&gt;layer_14_attn_allreduce -->
<g id="edge1243" class="edge">
<title>layer_14_attn_out_gpu5&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M2478.5,-1750.6C2489.73,-1741.23 2502.78,-1730.34 2515.26,-1719.93"/>
<polygon fill="black" stroke="black" points="2517.51,-1722.61 2522.94,-1713.52 2513.02,-1717.24 2517.51,-1722.61"/>
</g>
<!-- layer_14_attn_out_gpu6&#45;&gt;layer_14_attn_allreduce -->
<g id="edge1244" class="edge">
<title>layer_14_attn_out_gpu6&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M2650.15,-1750.6C2638.92,-1741.23 2625.86,-1730.34 2613.38,-1719.93"/>
<polygon fill="black" stroke="black" points="2615.62,-1717.24 2605.7,-1713.52 2611.13,-1722.61 2615.62,-1717.24"/>
</g>
<!-- layer_14_attn_out_gpu7&#45;&gt;layer_14_attn_allreduce -->
<g id="edge1245" class="edge">
<title>layer_14_attn_out_gpu7&#45;&gt;layer_14_attn_allreduce</title>
<path fill="none" stroke="black" d="M2822.25,-1750.73C2776.28,-1737.94 2720.03,-1722.3 2671.8,-1708.89"/>
<polygon fill="black" stroke="black" points="2672.53,-1705.46 2661.96,-1706.15 2670.65,-1712.21 2672.53,-1705.46"/>
</g>
<!-- layer_14_gate -->
<g id="node911" class="node">
<title>layer_14_gate</title>
<polygon fill="lightyellow" stroke="black" points="2781.18,-1605.23 2436.2,-1605.23 2347.46,-1501.23 2692.44,-1501.23 2781.18,-1605.23"/>
<text text-anchor="middle" x="2564.32" y="-1567.23" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2564.32" y="-1556.23" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2564.32" y="-1545.23" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2564.32" y="-1534.23" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_14_attn_allreduce&#45;&gt;layer_14_gate -->
<g id="edge1246" class="edge">
<title>layer_14_attn_allreduce&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2545.76,-1641.49C2544.65,-1633.45 2544.08,-1624.68 2544.07,-1615.91"/>
<polygon fill="black" stroke="black" points="2547.58,-1615.73 2544.31,-1605.65 2540.58,-1615.56 2547.58,-1615.73"/>
</g>
<!-- layer_14_attn_allreduce&#45;&gt;layer_14_gate -->
<g id="edge1247" class="edge">
<title>layer_14_attn_allreduce&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2558.12,-1641.16C2557.75,-1633.13 2557.57,-1624.38 2557.57,-1615.63"/>
<polygon fill="black" stroke="black" points="2561.07,-1615.43 2557.65,-1605.4 2554.07,-1615.37 2561.07,-1615.43"/>
</g>
<!-- layer_14_attn_allreduce&#45;&gt;layer_14_gate -->
<g id="edge1248" class="edge">
<title>layer_14_attn_allreduce&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2570.52,-1641.16C2570.89,-1633.13 2571.07,-1624.38 2571.07,-1615.63"/>
<polygon fill="black" stroke="black" points="2574.57,-1615.37 2570.99,-1605.4 2567.57,-1615.43 2574.57,-1615.37"/>
</g>
<!-- layer_14_attn_allreduce&#45;&gt;layer_14_gate -->
<g id="edge1249" class="edge">
<title>layer_14_attn_allreduce&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2582.88,-1641.49C2583.99,-1633.45 2584.56,-1624.68 2584.57,-1615.91"/>
<polygon fill="black" stroke="black" points="2588.06,-1615.56 2584.33,-1605.65 2581.07,-1615.73 2588.06,-1615.56"/>
</g>
<!-- layer_14_all2all_expert_0 -->
<g id="node913" class="node">
<title>layer_14_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="181.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="181.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="181.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="181.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="181.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_0 -->
<g id="edge1250" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2388.28,-1549.11C1936.66,-1540.47 744.96,-1513.68 352.32,-1465.23 334.2,-1463 315.16,-1459.84 296.61,-1456.31"/>
<polygon fill="black" stroke="black" points="297.16,-1452.85 286.67,-1454.38 295.82,-1459.72 297.16,-1452.85"/>
</g>
<!-- layer_14_all2all_expert_1 -->
<g id="node915" class="node">
<title>layer_14_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="509.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="509.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="509.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="509.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="509.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_1 -->
<g id="edge1252" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2387.21,-1547.91C1982.83,-1537.41 1001.32,-1508.24 673.32,-1465.23 656.9,-1463.08 639.68,-1460.12 622.83,-1456.82"/>
<polygon fill="black" stroke="black" points="623.46,-1453.37 612.97,-1454.84 622.08,-1460.24 623.46,-1453.37"/>
</g>
<!-- layer_14_all2all_expert_2 -->
<g id="node917" class="node">
<title>layer_14_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="830.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="830.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="830.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="830.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="830.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_2 -->
<g id="edge1254" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2390.49,-1551.95C2099.41,-1549.4 1495.57,-1535.19 990.32,-1465.23 974.79,-1463.08 958.54,-1460.2 942.6,-1457.01"/>
<polygon fill="black" stroke="black" points="943.22,-1453.56 932.72,-1454.98 941.81,-1460.42 943.22,-1453.56"/>
</g>
<!-- layer_14_all2all_expert_3 -->
<g id="node919" class="node">
<title>layer_14_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1147.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1147.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1147.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1147.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1147.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_3 -->
<g id="edge1256" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2387.62,-1548.48C2143.38,-1541.38 1689.34,-1521.23 1306.32,-1465.23 1291.28,-1463.04 1275.55,-1460.18 1260.08,-1457.05"/>
<polygon fill="black" stroke="black" points="1260.46,-1453.56 1249.96,-1454.95 1259.04,-1460.41 1260.46,-1453.56"/>
</g>
<!-- layer_14_all2all_expert_4 -->
<g id="node921" class="node">
<title>layer_14_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1463.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1463.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1463.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1463.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1463.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_4 -->
<g id="edge1258" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2382.67,-1542.54C2192.13,-1530.72 1884.38,-1506.96 1621.32,-1465.23 1606.74,-1462.92 1591.49,-1460.05 1576.47,-1456.95"/>
<polygon fill="black" stroke="black" points="1577.14,-1453.52 1566.63,-1454.89 1575.7,-1460.37 1577.14,-1453.52"/>
</g>
<!-- layer_14_all2all_expert_5 -->
<g id="node923" class="node">
<title>layer_14_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1778.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1778.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1778.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1778.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1778.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_5 -->
<g id="edge1260" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2371.97,-1530.01C2247.09,-1514.51 2081.04,-1491.86 1935.32,-1465.23 1921.47,-1462.7 1906.99,-1459.78 1892.66,-1456.73"/>
<polygon fill="black" stroke="black" points="1893.29,-1453.28 1882.78,-1454.59 1891.82,-1460.12 1893.29,-1453.28"/>
</g>
<!-- layer_14_all2all_expert_6 -->
<g id="node925" class="node">
<title>layer_14_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2092.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2092.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2092.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2092.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2092.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_6 -->
<g id="edge1262" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2367.91,-1501.15C2311.31,-1486.43 2251.59,-1470.89 2202.27,-1458.06"/>
<polygon fill="black" stroke="black" points="2203.1,-1454.66 2192.54,-1455.53 2201.34,-1461.44 2203.1,-1454.66"/>
</g>
<!-- layer_14_all2all_expert_7 -->
<g id="node927" class="node">
<title>layer_14_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2406.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2406.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2406.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2406.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2406.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_7 -->
<g id="edge1264" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2498.23,-1500.88C2485.05,-1490.64 2471.38,-1480.02 2458.73,-1470.19"/>
<polygon fill="black" stroke="black" points="2460.63,-1467.23 2450.59,-1463.86 2456.34,-1472.76 2460.63,-1467.23"/>
</g>
<!-- layer_14_all2all_expert_8 -->
<g id="node929" class="node">
<title>layer_14_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2722.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2722.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2722.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2722.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2722.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_8 -->
<g id="edge1266" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2630.41,-1500.88C2643.59,-1490.64 2657.26,-1480.02 2669.91,-1470.19"/>
<polygon fill="black" stroke="black" points="2672.3,-1472.76 2678.05,-1463.86 2668.01,-1467.23 2672.3,-1472.76"/>
</g>
<!-- layer_14_all2all_expert_9 -->
<g id="node931" class="node">
<title>layer_14_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3040.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3040.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3040.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3040.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3040.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_9 -->
<g id="edge1268" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2705.2,-1515.9C2776.93,-1497.4 2862.86,-1475.24 2929.74,-1457.98"/>
<polygon fill="black" stroke="black" points="2930.66,-1461.36 2939.47,-1455.48 2928.91,-1454.58 2930.66,-1461.36"/>
</g>
<!-- layer_14_all2all_expert_10 -->
<g id="node933" class="node">
<title>layer_14_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3360.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3360.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3360.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3360.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3360.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_10 -->
<g id="edge1270" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2720.94,-1534.22C2849.38,-1518.61 3035.69,-1494.03 3197.32,-1465.23 3212.41,-1462.55 3228.23,-1459.44 3243.82,-1456.21"/>
<polygon fill="black" stroke="black" points="3244.96,-1459.54 3254.03,-1454.06 3243.53,-1452.69 3244.96,-1459.54"/>
</g>
<!-- layer_14_all2all_expert_11 -->
<g id="node935" class="node">
<title>layer_14_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3680.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3680.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3680.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3680.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3680.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_11 -->
<g id="edge1272" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2728.66,-1543.49C2919.19,-1531.9 3242.31,-1507.79 3517.32,-1465.23 3532.97,-1462.81 3549.37,-1459.79 3565.48,-1456.55"/>
<polygon fill="black" stroke="black" points="3566.37,-1459.94 3575.46,-1454.5 3564.96,-1453.08 3566.37,-1459.94"/>
</g>
<!-- layer_14_all2all_expert_12 -->
<g id="node937" class="node">
<title>layer_14_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4001.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4001.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="4001.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4001.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4001.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_12 -->
<g id="edge1274" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2732.97,-1548.56C2977.49,-1541.46 3444.21,-1521.23 3837.32,-1465.23 3853.45,-1462.94 3870.35,-1459.94 3886.92,-1456.65"/>
<polygon fill="black" stroke="black" points="3888.08,-1459.99 3897.19,-1454.57 3886.69,-1453.13 3888.08,-1459.99"/>
</g>
<!-- layer_14_all2all_expert_13 -->
<g id="node939" class="node">
<title>layer_14_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4322.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4322.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4322.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4322.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4322.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_13 -->
<g id="edge1276" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2735.9,-1551.86C3028.89,-1549.2 3643.89,-1534.92 4158.32,-1465.23 4174.74,-1463.01 4191.95,-1460.01 4208.79,-1456.69"/>
<polygon fill="black" stroke="black" points="4209.55,-1460.11 4218.66,-1454.7 4208.16,-1453.25 4209.55,-1460.11"/>
</g>
<!-- layer_14_all2all_expert_14 -->
<g id="node941" class="node">
<title>layer_14_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4643.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4643.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4643.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4643.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4643.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_14 -->
<g id="edge1278" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2732.76,-1548.24C3135.24,-1538.12 4144.17,-1509.08 4479.32,-1465.23 4495.75,-1463.09 4512.96,-1460.13 4529.81,-1456.83"/>
<polygon fill="black" stroke="black" points="4530.56,-1460.24 4539.68,-1454.85 4529.18,-1453.38 4530.56,-1460.24"/>
</g>
<!-- layer_14_all2all_expert_15 -->
<g id="node943" class="node">
<title>layer_14_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4964.32" cy="-1428.47" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4964.32" y="-1442.47" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4964.32" y="-1431.47" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4964.32" y="-1420.47" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4964.32" y="-1409.47" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_all2all_expert_15 -->
<g id="edge1280" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2733.66,-1549.5C3183.48,-1541.63 4401.1,-1516.14 4800.32,-1465.23 4816.87,-1463.12 4834.23,-1460.17 4851.19,-1456.85"/>
<polygon fill="black" stroke="black" points="4852.01,-1460.26 4861.13,-1454.86 4850.64,-1453.39 4852.01,-1460.26"/>
</g>
<!-- layer_14_expert_0_gpu8 -->
<g id="node912" class="node">
<title>layer_14_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="261.82,-1355.7 52.82,-1355.7 52.82,-1303.7 261.82,-1303.7 261.82,-1355.7"/>
<text text-anchor="middle" x="157.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="157.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="157.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="157.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_0 -->
<g id="node944" class="node">
<title>layer_14_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="155.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="155.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="155.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="155.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="155.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_0_gpu8&#45;&gt;layer_14_all2all_back_0 -->
<g id="edge1282" class="edge">
<title>layer_14_expert_0_gpu8&#45;&gt;layer_14_all2all_back_0</title>
<path fill="none" stroke="black" d="M156.8,-1303.52C156.64,-1295.71 156.46,-1286.85 156.27,-1278.08"/>
<polygon fill="black" stroke="black" points="159.77,-1277.83 156.06,-1267.9 152.77,-1277.97 159.77,-1277.83"/>
</g>
<!-- layer_14_all2all_expert_0&#45;&gt;layer_14_expert_0_gpu8 -->
<g id="edge1251" class="edge">
<title>layer_14_all2all_expert_0&#45;&gt;layer_14_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M172.45,-1391.71C170.34,-1383.21 168.1,-1374.15 166,-1365.69"/>
<polygon fill="black" stroke="black" points="169.34,-1364.6 163.53,-1355.74 162.54,-1366.29 169.34,-1364.6"/>
</g>
<!-- layer_14_expert_1_gpu8 -->
<g id="node914" class="node">
<title>layer_14_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="596.82,-1355.7 387.82,-1355.7 387.82,-1303.7 596.82,-1303.7 596.82,-1355.7"/>
<text text-anchor="middle" x="492.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="492.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="492.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="492.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_1 -->
<g id="node945" class="node">
<title>layer_14_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="476.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="476.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="476.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="476.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="476.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_1_gpu8&#45;&gt;layer_14_all2all_back_1 -->
<g id="edge1283" class="edge">
<title>layer_14_expert_1_gpu8&#45;&gt;layer_14_all2all_back_1</title>
<path fill="none" stroke="black" d="M488.16,-1303.52C486.85,-1295.63 485.37,-1286.66 483.9,-1277.8"/>
<polygon fill="black" stroke="black" points="487.35,-1277.2 482.27,-1267.9 480.45,-1278.34 487.35,-1277.2"/>
</g>
<!-- layer_14_all2all_expert_1&#45;&gt;layer_14_expert_1_gpu8 -->
<g id="edge1253" class="edge">
<title>layer_14_all2all_expert_1&#45;&gt;layer_14_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M503.04,-1391.71C501.55,-1383.21 499.96,-1374.15 498.47,-1365.69"/>
<polygon fill="black" stroke="black" points="501.9,-1364.98 496.72,-1355.74 495,-1366.19 501.9,-1364.98"/>
</g>
<!-- layer_14_expert_2_gpu9 -->
<g id="node916" class="node">
<title>layer_14_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="917.82,-1355.7 708.82,-1355.7 708.82,-1303.7 917.82,-1303.7 917.82,-1355.7"/>
<text text-anchor="middle" x="813.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="813.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="813.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="813.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_2 -->
<g id="node946" class="node">
<title>layer_14_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="797.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="797.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="797.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="797.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="797.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_2_gpu9&#45;&gt;layer_14_all2all_back_2 -->
<g id="edge1284" class="edge">
<title>layer_14_expert_2_gpu9&#45;&gt;layer_14_all2all_back_2</title>
<path fill="none" stroke="black" d="M809.16,-1303.52C807.85,-1295.63 806.37,-1286.66 804.9,-1277.8"/>
<polygon fill="black" stroke="black" points="808.35,-1277.2 803.27,-1267.9 801.45,-1278.34 808.35,-1277.2"/>
</g>
<!-- layer_14_all2all_expert_2&#45;&gt;layer_14_expert_2_gpu9 -->
<g id="edge1255" class="edge">
<title>layer_14_all2all_expert_2&#45;&gt;layer_14_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M824.04,-1391.71C822.55,-1383.21 820.96,-1374.15 819.47,-1365.69"/>
<polygon fill="black" stroke="black" points="822.9,-1364.98 817.72,-1355.74 816,-1366.19 822.9,-1364.98"/>
</g>
<!-- layer_14_expert_3_gpu9 -->
<g id="node918" class="node">
<title>layer_14_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1236.82,-1355.7 1027.82,-1355.7 1027.82,-1303.7 1236.82,-1303.7 1236.82,-1355.7"/>
<text text-anchor="middle" x="1132.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1132.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1132.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1132.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_3 -->
<g id="node947" class="node">
<title>layer_14_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1118.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1118.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1118.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1118.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1118.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_3_gpu9&#45;&gt;layer_14_all2all_back_3 -->
<g id="edge1285" class="edge">
<title>layer_14_expert_3_gpu9&#45;&gt;layer_14_all2all_back_3</title>
<path fill="none" stroke="black" d="M1128.68,-1303.52C1127.55,-1295.71 1126.27,-1286.85 1125,-1278.08"/>
<polygon fill="black" stroke="black" points="1128.42,-1277.3 1123.53,-1267.9 1121.49,-1278.3 1128.42,-1277.3"/>
</g>
<!-- layer_14_all2all_expert_3&#45;&gt;layer_14_expert_3_gpu9 -->
<g id="edge1257" class="edge">
<title>layer_14_all2all_expert_3&#45;&gt;layer_14_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1141.78,-1391.71C1140.46,-1383.21 1139.06,-1374.15 1137.75,-1365.69"/>
<polygon fill="black" stroke="black" points="1141.19,-1365.08 1136.2,-1355.74 1134.28,-1366.16 1141.19,-1365.08"/>
</g>
<!-- layer_14_expert_4_gpu10 -->
<g id="node920" class="node">
<title>layer_14_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1554.82,-1355.7 1345.82,-1355.7 1345.82,-1303.7 1554.82,-1303.7 1554.82,-1355.7"/>
<text text-anchor="middle" x="1450.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1450.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1450.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1450.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_4 -->
<g id="node948" class="node">
<title>layer_14_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1439.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1439.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1439.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1439.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1439.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_4_gpu10&#45;&gt;layer_14_all2all_back_4 -->
<g id="edge1286" class="edge">
<title>layer_14_expert_4_gpu10&#45;&gt;layer_14_all2all_back_4</title>
<path fill="none" stroke="black" d="M1447.46,-1303.52C1446.57,-1295.71 1445.56,-1286.85 1444.57,-1278.08"/>
<polygon fill="black" stroke="black" points="1448.02,-1277.44 1443.41,-1267.9 1441.06,-1278.23 1448.02,-1277.44"/>
</g>
<!-- layer_14_all2all_expert_4&#45;&gt;layer_14_expert_4_gpu10 -->
<g id="edge1259" class="edge">
<title>layer_14_all2all_expert_4&#45;&gt;layer_14_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1458.52,-1391.71C1457.38,-1383.21 1456.16,-1374.15 1455.02,-1365.69"/>
<polygon fill="black" stroke="black" points="1458.49,-1365.18 1453.69,-1355.74 1451.55,-1366.12 1458.49,-1365.18"/>
</g>
<!-- layer_14_expert_5_gpu10 -->
<g id="node922" class="node">
<title>layer_14_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1872.82,-1355.7 1663.82,-1355.7 1663.82,-1303.7 1872.82,-1303.7 1872.82,-1355.7"/>
<text text-anchor="middle" x="1768.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1768.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1768.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1768.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_5 -->
<g id="node949" class="node">
<title>layer_14_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1760.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1760.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1760.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1760.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1760.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_5_gpu10&#45;&gt;layer_14_all2all_back_5 -->
<g id="edge1287" class="edge">
<title>layer_14_expert_5_gpu10&#45;&gt;layer_14_all2all_back_5</title>
<path fill="none" stroke="black" d="M1766.24,-1303.52C1765.59,-1295.71 1764.86,-1286.85 1764.14,-1278.08"/>
<polygon fill="black" stroke="black" points="1767.61,-1277.58 1763.3,-1267.9 1760.63,-1278.16 1767.61,-1277.58"/>
</g>
<!-- layer_14_all2all_expert_5&#45;&gt;layer_14_expert_5_gpu10 -->
<g id="edge1261" class="edge">
<title>layer_14_all2all_expert_5&#45;&gt;layer_14_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1774.63,-1391.71C1773.75,-1383.21 1772.81,-1374.15 1771.94,-1365.69"/>
<polygon fill="black" stroke="black" points="1775.42,-1365.33 1770.91,-1355.74 1768.46,-1366.05 1775.42,-1365.33"/>
</g>
<!-- layer_14_expert_6_gpu11 -->
<g id="node924" class="node">
<title>layer_14_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2190.82,-1355.7 1981.82,-1355.7 1981.82,-1303.7 2190.82,-1303.7 2190.82,-1355.7"/>
<text text-anchor="middle" x="2086.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2086.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2086.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2086.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_6 -->
<g id="node950" class="node">
<title>layer_14_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2081.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2081.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2081.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2081.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2081.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_6_gpu11&#45;&gt;layer_14_all2all_back_6 -->
<g id="edge1288" class="edge">
<title>layer_14_expert_6_gpu11&#45;&gt;layer_14_all2all_back_6</title>
<path fill="none" stroke="black" d="M2085.02,-1303.52C2084.62,-1295.71 2084.16,-1286.85 2083.71,-1278.08"/>
<polygon fill="black" stroke="black" points="2087.19,-1277.71 2083.18,-1267.9 2080.2,-1278.07 2087.19,-1277.71"/>
</g>
<!-- layer_14_all2all_expert_6&#45;&gt;layer_14_expert_6_gpu11 -->
<g id="edge1263" class="edge">
<title>layer_14_all2all_expert_6&#45;&gt;layer_14_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2090.09,-1391.43C2089.57,-1383.12 2089.02,-1374.29 2088.51,-1366"/>
<polygon fill="black" stroke="black" points="2092,-1365.66 2087.88,-1355.89 2085.01,-1366.09 2092,-1365.66"/>
</g>
<!-- layer_14_expert_7_gpu11 -->
<g id="node926" class="node">
<title>layer_14_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2507.82,-1355.7 2298.82,-1355.7 2298.82,-1303.7 2507.82,-1303.7 2507.82,-1355.7"/>
<text text-anchor="middle" x="2403.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2403.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2403.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2403.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_7 -->
<g id="node951" class="node">
<title>layer_14_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2402.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2402.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2402.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2402.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2402.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_7_gpu11&#45;&gt;layer_14_all2all_back_7 -->
<g id="edge1289" class="edge">
<title>layer_14_expert_7_gpu11&#45;&gt;layer_14_all2all_back_7</title>
<path fill="none" stroke="black" d="M2403.06,-1303.52C2402.98,-1295.71 2402.89,-1286.85 2402.8,-1278.08"/>
<polygon fill="black" stroke="black" points="2406.3,-1277.87 2402.69,-1267.9 2399.3,-1277.94 2406.3,-1277.87"/>
</g>
<!-- layer_14_all2all_expert_7&#45;&gt;layer_14_expert_7_gpu11 -->
<g id="edge1265" class="edge">
<title>layer_14_all2all_expert_7&#45;&gt;layer_14_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2405.2,-1391.43C2404.95,-1383.12 2404.67,-1374.29 2404.42,-1366"/>
<polygon fill="black" stroke="black" points="2407.91,-1365.78 2404.1,-1355.89 2400.91,-1366 2407.91,-1365.78"/>
</g>
<!-- layer_14_expert_8_gpu12 -->
<g id="node928" class="node">
<title>layer_14_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2826.82,-1355.7 2617.82,-1355.7 2617.82,-1303.7 2826.82,-1303.7 2826.82,-1355.7"/>
<text text-anchor="middle" x="2722.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2722.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2722.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2722.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_8 -->
<g id="node952" class="node">
<title>layer_14_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2723.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2723.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2723.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2723.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2723.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_8_gpu12&#45;&gt;layer_14_all2all_back_8 -->
<g id="edge1290" class="edge">
<title>layer_14_expert_8_gpu12&#45;&gt;layer_14_all2all_back_8</title>
<path fill="none" stroke="black" d="M2722.58,-1303.52C2722.66,-1295.71 2722.75,-1286.85 2722.84,-1278.08"/>
<polygon fill="black" stroke="black" points="2726.35,-1277.94 2722.95,-1267.9 2719.35,-1277.87 2726.35,-1277.94"/>
</g>
<!-- layer_14_all2all_expert_8&#45;&gt;layer_14_expert_8_gpu12 -->
<g id="edge1267" class="edge">
<title>layer_14_all2all_expert_8&#45;&gt;layer_14_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2722.32,-1391.43C2722.32,-1383.12 2722.32,-1374.29 2722.32,-1366"/>
<polygon fill="black" stroke="black" points="2725.82,-1365.89 2722.32,-1355.89 2718.82,-1365.89 2725.82,-1365.89"/>
</g>
<!-- layer_14_expert_9_gpu12 -->
<g id="node930" class="node">
<title>layer_14_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3146.82,-1355.7 2937.82,-1355.7 2937.82,-1303.7 3146.82,-1303.7 3146.82,-1355.7"/>
<text text-anchor="middle" x="3042.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3042.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3042.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3042.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_9 -->
<g id="node953" class="node">
<title>layer_14_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3044.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3044.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3044.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3044.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3044.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_9_gpu12&#45;&gt;layer_14_all2all_back_9 -->
<g id="edge1291" class="edge">
<title>layer_14_expert_9_gpu12&#45;&gt;layer_14_all2all_back_9</title>
<path fill="none" stroke="black" d="M3042.84,-1303.52C3043,-1295.71 3043.19,-1286.85 3043.37,-1278.08"/>
<polygon fill="black" stroke="black" points="3046.87,-1277.97 3043.58,-1267.9 3039.87,-1277.83 3046.87,-1277.97"/>
</g>
<!-- layer_14_all2all_expert_9&#45;&gt;layer_14_expert_9_gpu12 -->
<g id="edge1269" class="edge">
<title>layer_14_all2all_expert_9&#45;&gt;layer_14_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3041.07,-1391.43C3041.24,-1383.12 3041.42,-1374.29 3041.59,-1366"/>
<polygon fill="black" stroke="black" points="3045.09,-1365.96 3041.8,-1355.89 3038.09,-1365.82 3045.09,-1365.96"/>
</g>
<!-- layer_14_expert_10_gpu13 -->
<g id="node932" class="node">
<title>layer_14_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3466.82,-1355.7 3257.82,-1355.7 3257.82,-1303.7 3466.82,-1303.7 3466.82,-1355.7"/>
<text text-anchor="middle" x="3362.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3362.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3362.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3362.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_10 -->
<g id="node954" class="node">
<title>layer_14_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3365.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3365.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3365.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3365.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3365.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_10_gpu13&#45;&gt;layer_14_all2all_back_10 -->
<g id="edge1292" class="edge">
<title>layer_14_expert_10_gpu13&#45;&gt;layer_14_all2all_back_10</title>
<path fill="none" stroke="black" d="M3363.1,-1303.52C3363.34,-1295.71 3363.62,-1286.85 3363.89,-1278.08"/>
<polygon fill="black" stroke="black" points="3367.39,-1278.01 3364.21,-1267.9 3360.4,-1277.79 3367.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_10&#45;&gt;layer_14_expert_10_gpu13 -->
<g id="edge1271" class="edge">
<title>layer_14_all2all_expert_10&#45;&gt;layer_14_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3361.07,-1391.43C3361.24,-1383.12 3361.42,-1374.29 3361.59,-1366"/>
<polygon fill="black" stroke="black" points="3365.09,-1365.96 3361.8,-1355.89 3358.09,-1365.82 3365.09,-1365.96"/>
</g>
<!-- layer_14_expert_11_gpu13 -->
<g id="node934" class="node">
<title>layer_14_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3787.82,-1355.7 3578.82,-1355.7 3578.82,-1303.7 3787.82,-1303.7 3787.82,-1355.7"/>
<text text-anchor="middle" x="3683.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3683.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3683.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3683.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_11 -->
<g id="node955" class="node">
<title>layer_14_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3686.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3686.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3686.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3686.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3686.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_11_gpu13&#45;&gt;layer_14_all2all_back_11 -->
<g id="edge1293" class="edge">
<title>layer_14_expert_11_gpu13&#45;&gt;layer_14_all2all_back_11</title>
<path fill="none" stroke="black" d="M3684.1,-1303.52C3684.34,-1295.71 3684.62,-1286.85 3684.89,-1278.08"/>
<polygon fill="black" stroke="black" points="3688.39,-1278.01 3685.21,-1267.9 3681.4,-1277.79 3688.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_11&#45;&gt;layer_14_expert_11_gpu13 -->
<g id="edge1273" class="edge">
<title>layer_14_all2all_expert_11&#45;&gt;layer_14_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3681.44,-1391.43C3681.7,-1383.12 3681.97,-1374.29 3682.23,-1366"/>
<polygon fill="black" stroke="black" points="3685.73,-1366 3682.54,-1355.89 3678.73,-1365.78 3685.73,-1366"/>
</g>
<!-- layer_14_expert_12_gpu14 -->
<g id="node936" class="node">
<title>layer_14_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4108.82,-1355.7 3899.82,-1355.7 3899.82,-1303.7 4108.82,-1303.7 4108.82,-1355.7"/>
<text text-anchor="middle" x="4004.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4004.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4004.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4004.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_12 -->
<g id="node956" class="node">
<title>layer_14_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4007.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4007.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4007.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4007.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4007.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_12_gpu14&#45;&gt;layer_14_all2all_back_12 -->
<g id="edge1294" class="edge">
<title>layer_14_expert_12_gpu14&#45;&gt;layer_14_all2all_back_12</title>
<path fill="none" stroke="black" d="M4005.1,-1303.52C4005.34,-1295.71 4005.62,-1286.85 4005.89,-1278.08"/>
<polygon fill="black" stroke="black" points="4009.39,-1278.01 4006.21,-1267.9 4002.4,-1277.79 4009.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_12&#45;&gt;layer_14_expert_12_gpu14 -->
<g id="edge1275" class="edge">
<title>layer_14_all2all_expert_12&#45;&gt;layer_14_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M4002.44,-1391.43C4002.7,-1383.12 4002.97,-1374.29 4003.23,-1366"/>
<polygon fill="black" stroke="black" points="4006.73,-1366 4003.54,-1355.89 3999.73,-1365.78 4006.73,-1366"/>
</g>
<!-- layer_14_expert_13_gpu14 -->
<g id="node938" class="node">
<title>layer_14_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4429.82,-1355.7 4220.82,-1355.7 4220.82,-1303.7 4429.82,-1303.7 4429.82,-1355.7"/>
<text text-anchor="middle" x="4325.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4325.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4325.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4325.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_13 -->
<g id="node957" class="node">
<title>layer_14_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4328.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4328.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4328.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4328.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4328.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_13_gpu14&#45;&gt;layer_14_all2all_back_13 -->
<g id="edge1295" class="edge">
<title>layer_14_expert_13_gpu14&#45;&gt;layer_14_all2all_back_13</title>
<path fill="none" stroke="black" d="M4326.1,-1303.52C4326.34,-1295.71 4326.62,-1286.85 4326.89,-1278.08"/>
<polygon fill="black" stroke="black" points="4330.39,-1278.01 4327.21,-1267.9 4323.4,-1277.79 4330.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_13&#45;&gt;layer_14_expert_13_gpu14 -->
<g id="edge1277" class="edge">
<title>layer_14_all2all_expert_13&#45;&gt;layer_14_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4323.44,-1391.43C4323.7,-1383.12 4323.97,-1374.29 4324.23,-1366"/>
<polygon fill="black" stroke="black" points="4327.73,-1366 4324.54,-1355.89 4320.73,-1365.78 4327.73,-1366"/>
</g>
<!-- layer_14_expert_14_gpu15 -->
<g id="node940" class="node">
<title>layer_14_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4750.82,-1355.7 4541.82,-1355.7 4541.82,-1303.7 4750.82,-1303.7 4750.82,-1355.7"/>
<text text-anchor="middle" x="4646.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4646.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4646.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4646.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_14 -->
<g id="node958" class="node">
<title>layer_14_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4649.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4649.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4649.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4649.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4649.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_14_gpu15&#45;&gt;layer_14_all2all_back_14 -->
<g id="edge1296" class="edge">
<title>layer_14_expert_14_gpu15&#45;&gt;layer_14_all2all_back_14</title>
<path fill="none" stroke="black" d="M4647.1,-1303.52C4647.34,-1295.71 4647.62,-1286.85 4647.89,-1278.08"/>
<polygon fill="black" stroke="black" points="4651.39,-1278.01 4648.21,-1267.9 4644.4,-1277.79 4651.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_14&#45;&gt;layer_14_expert_14_gpu15 -->
<g id="edge1279" class="edge">
<title>layer_14_all2all_expert_14&#45;&gt;layer_14_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4644.44,-1391.43C4644.7,-1383.12 4644.97,-1374.29 4645.23,-1366"/>
<polygon fill="black" stroke="black" points="4648.73,-1366 4645.54,-1355.89 4641.73,-1365.78 4648.73,-1366"/>
</g>
<!-- layer_14_expert_15_gpu15 -->
<g id="node942" class="node">
<title>layer_14_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5071.82,-1355.7 4862.82,-1355.7 4862.82,-1303.7 5071.82,-1303.7 5071.82,-1355.7"/>
<text text-anchor="middle" x="4967.32" y="-1343.7" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4967.32" y="-1332.7" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4967.32" y="-1321.7" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4967.32" y="-1310.7" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_15 -->
<g id="node959" class="node">
<title>layer_14_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4970.32" cy="-1230.93" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4970.32" y="-1244.93" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4970.32" y="-1233.93" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4970.32" y="-1222.93" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4970.32" y="-1211.93" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_expert_15_gpu15&#45;&gt;layer_14_all2all_back_15 -->
<g id="edge1297" class="edge">
<title>layer_14_expert_15_gpu15&#45;&gt;layer_14_all2all_back_15</title>
<path fill="none" stroke="black" d="M4968.1,-1303.52C4968.34,-1295.71 4968.62,-1286.85 4968.89,-1278.08"/>
<polygon fill="black" stroke="black" points="4972.39,-1278.01 4969.21,-1267.9 4965.4,-1277.79 4972.39,-1278.01"/>
</g>
<!-- layer_14_all2all_expert_15&#45;&gt;layer_14_expert_15_gpu15 -->
<g id="edge1281" class="edge">
<title>layer_14_all2all_expert_15&#45;&gt;layer_14_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4965.44,-1391.43C4965.7,-1383.12 4965.97,-1374.29 4966.23,-1366"/>
<polygon fill="black" stroke="black" points="4969.73,-1366 4966.54,-1355.89 4962.73,-1365.78 4969.73,-1366"/>
</g>
<!-- layer_14_output -->
<g id="node960" class="node">
<title>layer_14_output</title>
<polygon fill="lightblue" stroke="black" points="2669.32,-1158.16 2455.32,-1158.16 2455.32,-1106.16 2669.32,-1106.16 2669.32,-1158.16"/>
<text text-anchor="middle" x="2562.32" y="-1146.16" font-family="Arial" font-size="10.00">Layer 14 Output</text>
<text text-anchor="middle" x="2562.32" y="-1135.16" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2562.32" y="-1124.16" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2562.32" y="-1113.16" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_14_all2all_back_0&#45;&gt;layer_14_output -->
<g id="edge1298" class="edge">
<title>layer_14_all2all_back_0&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M258.31,-1203.98C277.48,-1200.03 297.42,-1196.49 316.32,-1194.16 734.21,-1142.54 2044.59,-1134.6 2444.96,-1133.38"/>
<polygon fill="black" stroke="black" points="2445.12,-1136.88 2455.11,-1133.35 2445.1,-1129.88 2445.12,-1136.88"/>
</g>
<!-- layer_14_all2all_back_1&#45;&gt;layer_14_output -->
<g id="edge1299" class="edge">
<title>layer_14_all2all_back_1&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M579.75,-1203.96C598.79,-1200.04 618.57,-1196.52 637.32,-1194.16 989.84,-1149.81 2083.7,-1137.05 2445.1,-1134"/>
<polygon fill="black" stroke="black" points="2445.35,-1137.5 2455.32,-1133.91 2445.29,-1130.5 2445.35,-1137.5"/>
</g>
<!-- layer_14_all2all_back_2&#45;&gt;layer_14_output -->
<g id="edge1300" class="edge">
<title>layer_14_all2all_back_2&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M900.76,-1204.06C919.8,-1200.12 939.58,-1196.57 958.32,-1194.16 1245.83,-1157.06 2125.45,-1139.97 2444.86,-1134.87"/>
<polygon fill="black" stroke="black" points="2445.12,-1138.37 2455.06,-1134.71 2445.01,-1131.37 2445.12,-1138.37"/>
</g>
<!-- layer_14_all2all_back_3&#45;&gt;layer_14_output -->
<g id="edge1301" class="edge">
<title>layer_14_all2all_back_3&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M1222.21,-1204.12C1241.12,-1200.2 1260.73,-1196.64 1279.32,-1194.16 1502.45,-1164.29 2171.68,-1143.59 2444.55,-1136.18"/>
<polygon fill="black" stroke="black" points="2444.98,-1139.67 2454.88,-1135.9 2444.79,-1132.67 2444.98,-1139.67"/>
</g>
<!-- layer_14_all2all_back_4&#45;&gt;layer_14_output -->
<g id="edge1302" class="edge">
<title>layer_14_all2all_back_4&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M1543.68,-1204.27C1562.45,-1200.36 1581.89,-1196.77 1600.32,-1194.16 1902.78,-1151.23 2263.05,-1138.51 2444.88,-1134.74"/>
<polygon fill="black" stroke="black" points="2445.07,-1138.24 2455,-1134.53 2444.93,-1131.24 2445.07,-1138.24"/>
</g>
<!-- layer_14_all2all_back_5&#45;&gt;layer_14_output -->
<g id="edge1303" class="edge">
<title>layer_14_all2all_back_5&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M1866.05,-1204.48C1884.41,-1200.63 1903.36,-1196.99 1921.32,-1194.16 2103.01,-1165.44 2315.95,-1148.44 2444.91,-1139.96"/>
<polygon fill="black" stroke="black" points="2445.45,-1143.43 2455.2,-1139.28 2444.99,-1136.44 2445.45,-1143.43"/>
</g>
<!-- layer_14_all2all_back_6&#45;&gt;layer_14_output -->
<g id="edge1304" class="edge">
<title>layer_14_all2all_back_6&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M2190.35,-1205.24C2207.71,-1201.44 2225.5,-1197.63 2242.32,-1194.16 2309.35,-1180.33 2384.51,-1165.94 2445.14,-1154.61"/>
<polygon fill="black" stroke="black" points="2445.94,-1158.03 2455.13,-1152.75 2444.66,-1151.14 2445.94,-1158.03"/>
</g>
<!-- layer_14_all2all_back_7&#45;&gt;layer_14_output -->
<g id="edge1305" class="edge">
<title>layer_14_all2all_back_7&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M2457.38,-1196.62C2475.09,-1185.92 2494.6,-1174.11 2511.95,-1163.62"/>
<polygon fill="black" stroke="black" points="2514.06,-1166.43 2520.81,-1158.26 2510.44,-1160.44 2514.06,-1166.43"/>
</g>
<!-- layer_14_all2all_back_8&#45;&gt;layer_14_output -->
<g id="edge1306" class="edge">
<title>layer_14_all2all_back_8&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M2667.91,-1196.62C2650.1,-1185.92 2630.46,-1174.11 2613,-1163.62"/>
<polygon fill="black" stroke="black" points="2614.47,-1160.42 2604.09,-1158.26 2610.86,-1166.42 2614.47,-1160.42"/>
</g>
<!-- layer_14_all2all_back_9&#45;&gt;layer_14_output -->
<g id="edge1307" class="edge">
<title>layer_14_all2all_back_9&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M2935.3,-1205.23C2917.93,-1201.43 2900.15,-1197.62 2883.32,-1194.16 2815.96,-1180.28 2740.39,-1165.86 2679.51,-1154.53"/>
<polygon fill="black" stroke="black" points="2679.96,-1151.05 2669.48,-1152.67 2678.68,-1157.93 2679.96,-1151.05"/>
</g>
<!-- layer_14_all2all_back_10&#45;&gt;layer_14_output -->
<g id="edge1308" class="edge">
<title>layer_14_all2all_back_10&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M3259.59,-1204.48C3241.24,-1200.62 3222.28,-1196.99 3204.32,-1194.16 3022.22,-1165.39 2808.76,-1148.39 2679.63,-1139.92"/>
<polygon fill="black" stroke="black" points="2679.53,-1136.41 2669.33,-1139.26 2679.08,-1143.4 2679.53,-1136.41"/>
</g>
<!-- layer_14_all2all_back_11&#45;&gt;layer_14_output -->
<g id="edge1309" class="edge">
<title>layer_14_all2all_back_11&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M3581.96,-1204.27C3563.2,-1200.36 3543.75,-1196.77 3525.32,-1194.16 3222.34,-1151.17 2861.42,-1138.47 2679.52,-1134.72"/>
<polygon fill="black" stroke="black" points="2679.46,-1131.22 2669.39,-1134.52 2679.32,-1138.22 2679.46,-1131.22"/>
</g>
<!-- layer_14_all2all_back_12&#45;&gt;layer_14_output -->
<g id="edge1310" class="edge">
<title>layer_14_all2all_back_12&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M3903.43,-1204.12C3884.53,-1200.2 3864.91,-1196.64 3846.32,-1194.16 3622.88,-1164.25 2952.45,-1143.56 2679.68,-1136.16"/>
<polygon fill="black" stroke="black" points="2679.45,-1132.65 2669.36,-1135.88 2679.26,-1139.65 2679.45,-1132.65"/>
</g>
<!-- layer_14_all2all_back_13&#45;&gt;layer_14_output -->
<g id="edge1311" class="edge">
<title>layer_14_all2all_back_13&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M4224.88,-1204.06C4205.84,-1200.12 4186.06,-1196.57 4167.32,-1194.16 3879.54,-1157.03 2998.94,-1139.95 2679.57,-1134.86"/>
<polygon fill="black" stroke="black" points="2679.42,-1131.36 2669.37,-1134.7 2679.31,-1138.36 2679.42,-1131.36"/>
</g>
<!-- layer_14_all2all_back_14&#45;&gt;layer_14_output -->
<g id="edge1312" class="edge">
<title>layer_14_all2all_back_14&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M4545.89,-1203.96C4526.85,-1200.04 4507.07,-1196.52 4488.32,-1194.16 4135.62,-1149.79 3041.19,-1137.05 2679.6,-1134"/>
<polygon fill="black" stroke="black" points="2679.41,-1130.5 2669.38,-1133.91 2679.35,-1137.5 2679.41,-1130.5"/>
</g>
<!-- layer_14_all2all_back_15&#45;&gt;layer_14_output -->
<g id="edge1313" class="edge">
<title>layer_14_all2all_back_15&#45;&gt;layer_14_output</title>
<path fill="none" stroke="black" d="M4867.33,-1203.98C4848.16,-1200.03 4828.22,-1196.49 4809.32,-1194.16 4391.25,-1142.52 3080.28,-1134.59 2679.73,-1133.38"/>
<polygon fill="black" stroke="black" points="2679.59,-1129.88 2669.58,-1133.35 2679.57,-1136.88 2679.59,-1129.88"/>
</g>
<!-- layer_15_tp_gather -->
<g id="node962" class="node">
<title>layer_15_tp_gather</title>
<ellipse fill="lightgreen" stroke="black" cx="2562.32" cy="-1033.39" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2562.32" y="-1047.39" font-family="Arial" font-size="10.00">TP All&#45;Gather</text>
<text text-anchor="middle" x="2562.32" y="-1036.39" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2562.32" y="-1025.39" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2562.32" y="-1014.39" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=512]</text>
</g>
<!-- layer_14_output&#45;&gt;layer_15_tp_gather -->
<g id="edge1314" class="edge">
<title>layer_14_output&#45;&gt;layer_15_tp_gather</title>
<path fill="none" stroke="black" d="M2544.3,-1105.98C2542.64,-1098.01 2541.91,-1088.93 2542.1,-1079.98"/>
<polygon fill="black" stroke="black" points="2545.59,-1080.19 2542.71,-1070 2538.61,-1079.76 2545.59,-1080.19"/>
</g>
<!-- layer_14_output&#45;&gt;layer_15_tp_gather -->
<g id="edge1316" class="edge">
<title>layer_14_output&#45;&gt;layer_15_tp_gather</title>
<path fill="none" stroke="black" d="M2556.32,-1105.98C2555.77,-1098.18 2555.53,-1089.31 2555.58,-1080.54"/>
<polygon fill="black" stroke="black" points="2559.08,-1080.43 2555.77,-1070.36 2552.08,-1080.29 2559.08,-1080.43"/>
</g>
<!-- layer_14_output&#45;&gt;layer_15_tp_gather -->
<g id="edge1318" class="edge">
<title>layer_14_output&#45;&gt;layer_15_tp_gather</title>
<path fill="none" stroke="black" d="M2568.33,-1105.98C2568.87,-1098.18 2569.11,-1089.31 2569.06,-1080.54"/>
<polygon fill="black" stroke="black" points="2572.56,-1080.29 2568.87,-1070.36 2565.56,-1080.43 2572.56,-1080.29"/>
</g>
<!-- layer_14_output&#45;&gt;layer_15_tp_gather -->
<g id="edge1320" class="edge">
<title>layer_14_output&#45;&gt;layer_15_tp_gather</title>
<path fill="none" stroke="black" d="M2580.34,-1105.98C2582,-1098.01 2582.73,-1088.93 2582.54,-1079.98"/>
<polygon fill="black" stroke="black" points="2586.03,-1079.76 2581.93,-1070 2579.05,-1080.19 2586.03,-1079.76"/>
</g>
<!-- layer_15_qkv_gpu4 -->
<g id="node961" class="node">
<title>layer_15_qkv_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2324.32,-960.62 2118.32,-960.62 2118.32,-908.62 2324.32,-908.62 2324.32,-960.62"/>
<text text-anchor="middle" x="2221.32" y="-948.62" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2221.32" y="-937.62" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2221.32" y="-926.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2221.32" y="-915.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_15_attn_gpu4 -->
<g id="node966" class="node">
<title>layer_15_attn_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2318.32,-872.62 2116.32,-872.62 2116.32,-820.62 2318.32,-820.62 2318.32,-872.62"/>
<text text-anchor="middle" x="2217.32" y="-860.62" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2217.32" y="-849.62" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2217.32" y="-838.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2217.32" y="-827.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_15_qkv_gpu4&#45;&gt;layer_15_attn_gpu4 -->
<g id="edge1322" class="edge">
<title>layer_15_qkv_gpu4&#45;&gt;layer_15_attn_gpu4</title>
<path fill="none" stroke="black" d="M2220.14,-908.28C2219.77,-900.32 2219.36,-891.38 2218.96,-882.86"/>
<polygon fill="black" stroke="black" points="2222.45,-882.6 2218.49,-872.77 2215.46,-882.93 2222.45,-882.6"/>
</g>
<!-- layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu4 -->
<g id="edge1315" class="edge">
<title>layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu4</title>
<path fill="none" stroke="black" d="M2465.52,-1004.92C2419.74,-991.93 2365.19,-976.45 2319.28,-963.42"/>
<polygon fill="black" stroke="black" points="2320.19,-960.04 2309.61,-960.67 2318.28,-966.77 2320.19,-960.04"/>
</g>
<!-- layer_15_qkv_gpu5 -->
<g id="node963" class="node">
<title>layer_15_qkv_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2552.32,-960.62 2346.32,-960.62 2346.32,-908.62 2552.32,-908.62 2552.32,-960.62"/>
<text text-anchor="middle" x="2449.32" y="-948.62" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2449.32" y="-937.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2449.32" y="-926.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2449.32" y="-915.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu5 -->
<g id="edge1317" class="edge">
<title>layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu5</title>
<path fill="none" stroke="black" d="M2521.84,-997.72C2510.22,-987.77 2497.6,-976.96 2486.2,-967.2"/>
<polygon fill="black" stroke="black" points="2488.4,-964.48 2478.53,-960.63 2483.85,-969.79 2488.4,-964.48"/>
</g>
<!-- layer_15_qkv_gpu6 -->
<g id="node964" class="node">
<title>layer_15_qkv_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2778.32,-960.62 2572.32,-960.62 2572.32,-908.62 2778.32,-908.62 2778.32,-960.62"/>
<text text-anchor="middle" x="2675.32" y="-948.62" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2675.32" y="-937.62" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2675.32" y="-926.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2675.32" y="-915.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu6 -->
<g id="edge1319" class="edge">
<title>layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu6</title>
<path fill="none" stroke="black" d="M2602.8,-997.72C2614.43,-987.77 2627.04,-976.96 2638.44,-967.2"/>
<polygon fill="black" stroke="black" points="2640.79,-969.79 2646.11,-960.63 2636.24,-964.48 2640.79,-969.79"/>
</g>
<!-- layer_15_qkv_gpu7 -->
<g id="node965" class="node">
<title>layer_15_qkv_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3007.32,-960.62 2801.32,-960.62 2801.32,-908.62 3007.32,-908.62 3007.32,-960.62"/>
<text text-anchor="middle" x="2904.32" y="-948.62" font-family="Arial" font-size="10.00">Q/K/V Projection</text>
<text text-anchor="middle" x="2904.32" y="-937.62" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2904.32" y="-926.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2904.32" y="-915.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, qkv=128]</text>
</g>
<!-- layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu7 -->
<g id="edge1321" class="edge">
<title>layer_15_tp_gather&#45;&gt;layer_15_qkv_gpu7</title>
<path fill="none" stroke="black" d="M2658.95,-1005.04C2704.96,-992.03 2759.89,-976.48 2806.11,-963.41"/>
<polygon fill="black" stroke="black" points="2807.16,-966.75 2815.83,-960.66 2805.25,-960.01 2807.16,-966.75"/>
</g>
<!-- layer_15_attn_gpu5 -->
<g id="node967" class="node">
<title>layer_15_attn_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2546.32,-872.62 2344.32,-872.62 2344.32,-820.62 2546.32,-820.62 2546.32,-872.62"/>
<text text-anchor="middle" x="2445.32" y="-860.62" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2445.32" y="-849.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2445.32" y="-838.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2445.32" y="-827.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_15_qkv_gpu5&#45;&gt;layer_15_attn_gpu5 -->
<g id="edge1323" class="edge">
<title>layer_15_qkv_gpu5&#45;&gt;layer_15_attn_gpu5</title>
<path fill="none" stroke="black" d="M2448.14,-908.28C2447.77,-900.32 2447.36,-891.38 2446.96,-882.86"/>
<polygon fill="black" stroke="black" points="2450.45,-882.6 2446.49,-872.77 2443.46,-882.93 2450.45,-882.6"/>
</g>
<!-- layer_15_attn_gpu6 -->
<g id="node968" class="node">
<title>layer_15_attn_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2776.32,-872.62 2574.32,-872.62 2574.32,-820.62 2776.32,-820.62 2776.32,-872.62"/>
<text text-anchor="middle" x="2675.32" y="-860.62" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2675.32" y="-849.62" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2675.32" y="-838.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2675.32" y="-827.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_15_qkv_gpu6&#45;&gt;layer_15_attn_gpu6 -->
<g id="edge1324" class="edge">
<title>layer_15_qkv_gpu6&#45;&gt;layer_15_attn_gpu6</title>
<path fill="none" stroke="black" d="M2675.32,-908.28C2675.32,-900.32 2675.32,-891.38 2675.32,-882.86"/>
<polygon fill="black" stroke="black" points="2678.82,-882.77 2675.32,-872.77 2671.82,-882.77 2678.82,-882.77"/>
</g>
<!-- layer_15_attn_gpu7 -->
<g id="node969" class="node">
<title>layer_15_attn_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3007.32,-872.62 2805.32,-872.62 2805.32,-820.62 3007.32,-820.62 3007.32,-872.62"/>
<text text-anchor="middle" x="2906.32" y="-860.62" font-family="Arial" font-size="10.00">Attention Computation</text>
<text text-anchor="middle" x="2906.32" y="-849.62" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2906.32" y="-838.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, qkv=128]</text>
<text text-anchor="middle" x="2906.32" y="-827.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, attn=128]</text>
</g>
<!-- layer_15_qkv_gpu7&#45;&gt;layer_15_attn_gpu7 -->
<g id="edge1325" class="edge">
<title>layer_15_qkv_gpu7&#45;&gt;layer_15_attn_gpu7</title>
<path fill="none" stroke="black" d="M2904.91,-908.28C2905.1,-900.32 2905.3,-891.38 2905.5,-882.86"/>
<polygon fill="black" stroke="black" points="2909,-882.85 2905.74,-872.77 2902,-882.69 2909,-882.85"/>
</g>
<!-- layer_15_attn_out_gpu4 -->
<g id="node970" class="node">
<title>layer_15_attn_out_gpu4</title>
<polygon fill="lightblue" stroke="black" points="2319.32,-784.62 2105.32,-784.62 2105.32,-732.62 2319.32,-732.62 2319.32,-784.62"/>
<text text-anchor="middle" x="2212.32" y="-772.62" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2212.32" y="-761.62" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="2212.32" y="-750.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2212.32" y="-739.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_attn_gpu4&#45;&gt;layer_15_attn_out_gpu4 -->
<g id="edge1326" class="edge">
<title>layer_15_attn_gpu4&#45;&gt;layer_15_attn_out_gpu4</title>
<path fill="none" stroke="black" d="M2215.85,-820.28C2215.38,-812.32 2214.87,-803.38 2214.37,-794.86"/>
<polygon fill="black" stroke="black" points="2217.86,-794.55 2213.78,-784.77 2210.87,-794.96 2217.86,-794.55"/>
</g>
<!-- layer_15_attn_out_gpu5 -->
<g id="node971" class="node">
<title>layer_15_attn_out_gpu5</title>
<polygon fill="lightblue" stroke="black" points="2551.32,-784.62 2337.32,-784.62 2337.32,-732.62 2551.32,-732.62 2551.32,-784.62"/>
<text text-anchor="middle" x="2444.32" y="-772.62" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2444.32" y="-761.62" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="2444.32" y="-750.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2444.32" y="-739.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_attn_gpu5&#45;&gt;layer_15_attn_out_gpu5 -->
<g id="edge1327" class="edge">
<title>layer_15_attn_gpu5&#45;&gt;layer_15_attn_out_gpu5</title>
<path fill="none" stroke="black" d="M2445.03,-820.28C2444.93,-812.32 2444.83,-803.38 2444.73,-794.86"/>
<polygon fill="black" stroke="black" points="2448.23,-794.73 2444.61,-784.77 2441.23,-794.81 2448.23,-794.73"/>
</g>
<!-- layer_15_attn_out_gpu6 -->
<g id="node972" class="node">
<title>layer_15_attn_out_gpu6</title>
<polygon fill="lightblue" stroke="black" points="2783.32,-784.62 2569.32,-784.62 2569.32,-732.62 2783.32,-732.62 2783.32,-784.62"/>
<text text-anchor="middle" x="2676.32" y="-772.62" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2676.32" y="-761.62" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="2676.32" y="-750.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2676.32" y="-739.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_attn_gpu6&#45;&gt;layer_15_attn_out_gpu6 -->
<g id="edge1328" class="edge">
<title>layer_15_attn_gpu6&#45;&gt;layer_15_attn_out_gpu6</title>
<path fill="none" stroke="black" d="M2675.62,-820.28C2675.71,-812.32 2675.81,-803.38 2675.91,-794.86"/>
<polygon fill="black" stroke="black" points="2679.41,-794.81 2676.03,-784.77 2672.41,-794.73 2679.41,-794.81"/>
</g>
<!-- layer_15_attn_out_gpu7 -->
<g id="node973" class="node">
<title>layer_15_attn_out_gpu7</title>
<polygon fill="lightblue" stroke="black" points="3015.32,-784.62 2801.32,-784.62 2801.32,-732.62 3015.32,-732.62 3015.32,-784.62"/>
<text text-anchor="middle" x="2908.32" y="-772.62" font-family="Arial" font-size="10.00">Attention Output Projection</text>
<text text-anchor="middle" x="2908.32" y="-761.62" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="2908.32" y="-750.62" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, attn=128]</text>
<text text-anchor="middle" x="2908.32" y="-739.62" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_attn_gpu7&#45;&gt;layer_15_attn_out_gpu7 -->
<g id="edge1329" class="edge">
<title>layer_15_attn_gpu7&#45;&gt;layer_15_attn_out_gpu7</title>
<path fill="none" stroke="black" d="M2906.91,-820.28C2907.1,-812.32 2907.3,-803.38 2907.5,-794.86"/>
<polygon fill="black" stroke="black" points="2911,-794.85 2907.74,-784.77 2904,-794.69 2911,-794.85"/>
</g>
<!-- layer_15_attn_allreduce -->
<g id="node974" class="node">
<title>layer_15_attn_allreduce</title>
<ellipse fill="lightgreen" stroke="black" cx="2560.32" cy="-659.85" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2560.32" y="-673.85" font-family="Arial" font-size="10.00">Attention TP All&#45;Reduce</text>
<text text-anchor="middle" x="2560.32" y="-662.85" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2560.32" y="-651.85" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2560.32" y="-640.85" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_attn_out_gpu4&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1330" class="edge">
<title>layer_15_attn_out_gpu4&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M2302.39,-732.57C2348.36,-719.79 2404.61,-704.15 2452.84,-690.74"/>
<polygon fill="black" stroke="black" points="2453.99,-694.05 2462.69,-688 2452.11,-687.3 2453.99,-694.05"/>
</g>
<!-- layer_15_attn_out_gpu5&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1331" class="edge">
<title>layer_15_attn_out_gpu5&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M2474.5,-732.44C2485.73,-723.08 2498.78,-712.19 2511.26,-701.77"/>
<polygon fill="black" stroke="black" points="2513.51,-704.46 2518.94,-695.36 2509.02,-699.08 2513.51,-704.46"/>
</g>
<!-- layer_15_attn_out_gpu6&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1332" class="edge">
<title>layer_15_attn_out_gpu6&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M2646.15,-732.44C2634.92,-723.08 2621.86,-712.19 2609.38,-701.77"/>
<polygon fill="black" stroke="black" points="2611.62,-699.08 2601.7,-695.36 2607.13,-704.46 2611.62,-699.08"/>
</g>
<!-- layer_15_attn_out_gpu7&#45;&gt;layer_15_attn_allreduce -->
<g id="edge1333" class="edge">
<title>layer_15_attn_out_gpu7&#45;&gt;layer_15_attn_allreduce</title>
<path fill="none" stroke="black" d="M2818.25,-732.57C2772.28,-719.79 2716.03,-704.15 2667.8,-690.74"/>
<polygon fill="black" stroke="black" points="2668.53,-687.3 2657.96,-688 2666.65,-694.05 2668.53,-687.3"/>
</g>
<!-- layer_15_gate -->
<g id="node975" class="node">
<title>layer_15_gate</title>
<polygon fill="lightyellow" stroke="black" points="2777.18,-587.08 2432.2,-587.08 2343.46,-483.08 2688.44,-483.08 2777.18,-587.08"/>
<text text-anchor="middle" x="2560.32" y="-549.08" font-family="Arial" font-size="10.00">Expert Gate Routing</text>
<text text-anchor="middle" x="2560.32" y="-538.08" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2560.32" y="-527.08" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2560.32" y="-516.08" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, expert_ids]</text>
</g>
<!-- layer_15_attn_allreduce&#45;&gt;layer_15_gate -->
<g id="edge1334" class="edge">
<title>layer_15_attn_allreduce&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2541.76,-623.34C2540.65,-615.3 2540.08,-606.53 2540.07,-597.75"/>
<polygon fill="black" stroke="black" points="2543.58,-597.57 2540.31,-587.49 2536.58,-597.41 2543.58,-597.57"/>
</g>
<!-- layer_15_attn_allreduce&#45;&gt;layer_15_gate -->
<g id="edge1335" class="edge">
<title>layer_15_attn_allreduce&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2554.12,-623.01C2553.75,-614.97 2553.57,-606.22 2553.57,-597.47"/>
<polygon fill="black" stroke="black" points="2557.07,-597.27 2553.65,-587.24 2550.07,-597.22 2557.07,-597.27"/>
</g>
<!-- layer_15_attn_allreduce&#45;&gt;layer_15_gate -->
<g id="edge1336" class="edge">
<title>layer_15_attn_allreduce&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2566.52,-623.01C2566.89,-614.97 2567.07,-606.22 2567.07,-597.47"/>
<polygon fill="black" stroke="black" points="2570.57,-597.22 2566.99,-587.24 2563.57,-597.27 2570.57,-597.22"/>
</g>
<!-- layer_15_attn_allreduce&#45;&gt;layer_15_gate -->
<g id="edge1337" class="edge">
<title>layer_15_attn_allreduce&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2578.88,-623.34C2579.99,-615.3 2580.56,-606.53 2580.57,-597.75"/>
<polygon fill="black" stroke="black" points="2584.06,-597.41 2580.33,-587.49 2577.07,-597.57 2584.06,-597.41"/>
</g>
<!-- layer_15_all2all_expert_0 -->
<g id="node977" class="node">
<title>layer_15_all2all_expert_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="177.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="177.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 0</text>
<text text-anchor="middle" x="177.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="177.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="177.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_0 -->
<g id="edge1338" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2384.28,-530.95C1932.66,-522.31 740.96,-495.52 348.32,-447.08 330.2,-444.84 311.16,-441.68 292.61,-438.15"/>
<polygon fill="black" stroke="black" points="293.16,-434.69 282.67,-436.22 291.82,-441.57 293.16,-434.69"/>
</g>
<!-- layer_15_all2all_expert_1 -->
<g id="node979" class="node">
<title>layer_15_all2all_expert_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="505.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="505.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 1</text>
<text text-anchor="middle" x="505.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="505.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="505.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_1 -->
<g id="edge1340" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2383.21,-529.75C1978.83,-519.25 997.32,-490.08 669.32,-447.08 652.9,-444.92 635.68,-441.96 618.83,-438.66"/>
<polygon fill="black" stroke="black" points="619.46,-435.22 608.97,-436.68 618.08,-442.08 619.46,-435.22"/>
</g>
<!-- layer_15_all2all_expert_2 -->
<g id="node981" class="node">
<title>layer_15_all2all_expert_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="826.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="826.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 2</text>
<text text-anchor="middle" x="826.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="826.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="826.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_2 -->
<g id="edge1342" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2386.49,-533.8C2095.41,-531.24 1491.57,-517.03 986.32,-447.08 970.79,-444.93 954.54,-442.05 938.6,-438.85"/>
<polygon fill="black" stroke="black" points="939.22,-435.41 928.72,-436.82 937.81,-442.26 939.22,-435.41"/>
</g>
<!-- layer_15_all2all_expert_3 -->
<g id="node983" class="node">
<title>layer_15_all2all_expert_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1143.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1143.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 3</text>
<text text-anchor="middle" x="1143.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1143.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1143.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_3 -->
<g id="edge1344" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2383.62,-530.33C2139.38,-523.22 1685.34,-503.07 1302.32,-447.08 1287.28,-444.88 1271.55,-442.03 1256.08,-438.89"/>
<polygon fill="black" stroke="black" points="1256.46,-435.4 1245.96,-436.8 1255.04,-442.25 1256.46,-435.4"/>
</g>
<!-- layer_15_all2all_expert_4 -->
<g id="node985" class="node">
<title>layer_15_all2all_expert_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1459.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1459.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 4</text>
<text text-anchor="middle" x="1459.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1459.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1459.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_4 -->
<g id="edge1346" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2378.67,-524.38C2188.13,-512.56 1880.38,-488.81 1617.32,-447.08 1602.74,-444.76 1587.49,-441.9 1572.47,-438.8"/>
<polygon fill="black" stroke="black" points="1573.14,-435.36 1562.63,-436.73 1571.7,-442.21 1573.14,-435.36"/>
</g>
<!-- layer_15_all2all_expert_5 -->
<g id="node987" class="node">
<title>layer_15_all2all_expert_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1774.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="1774.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 5</text>
<text text-anchor="middle" x="1774.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1774.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1774.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_5 -->
<g id="edge1348" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2367.97,-511.86C2243.09,-496.35 2077.04,-473.7 1931.32,-447.08 1917.47,-444.55 1902.99,-441.63 1888.66,-438.57"/>
<polygon fill="black" stroke="black" points="1889.29,-435.12 1878.78,-436.43 1887.82,-441.97 1889.29,-435.12"/>
</g>
<!-- layer_15_all2all_expert_6 -->
<g id="node989" class="node">
<title>layer_15_all2all_expert_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2088.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2088.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 6</text>
<text text-anchor="middle" x="2088.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2088.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2088.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_6 -->
<g id="edge1350" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2363.91,-482.99C2307.31,-468.27 2247.59,-452.74 2198.27,-439.91"/>
<polygon fill="black" stroke="black" points="2199.1,-436.51 2188.54,-437.38 2197.34,-443.28 2199.1,-436.51"/>
</g>
<!-- layer_15_all2all_expert_7 -->
<g id="node991" class="node">
<title>layer_15_all2all_expert_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2402.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2402.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 7</text>
<text text-anchor="middle" x="2402.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2402.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2402.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_7 -->
<g id="edge1352" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2494.23,-482.72C2481.05,-472.48 2467.38,-461.86 2454.73,-452.03"/>
<polygon fill="black" stroke="black" points="2456.63,-449.08 2446.59,-445.71 2452.34,-454.61 2456.63,-449.08"/>
</g>
<!-- layer_15_all2all_expert_8 -->
<g id="node993" class="node">
<title>layer_15_all2all_expert_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2718.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="2718.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 8</text>
<text text-anchor="middle" x="2718.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2718.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2718.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_8 -->
<g id="edge1354" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2626.41,-482.72C2639.59,-472.48 2653.26,-461.86 2665.91,-452.03"/>
<polygon fill="black" stroke="black" points="2668.3,-454.61 2674.05,-445.71 2664.01,-449.08 2668.3,-454.61"/>
</g>
<!-- layer_15_all2all_expert_9 -->
<g id="node995" class="node">
<title>layer_15_all2all_expert_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3036.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3036.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 9</text>
<text text-anchor="middle" x="3036.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3036.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3036.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_9 -->
<g id="edge1356" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2701.2,-497.74C2772.93,-479.24 2858.86,-457.08 2925.74,-439.83"/>
<polygon fill="black" stroke="black" points="2926.66,-443.21 2935.47,-437.32 2924.91,-436.43 2926.66,-443.21"/>
</g>
<!-- layer_15_all2all_expert_10 -->
<g id="node997" class="node">
<title>layer_15_all2all_expert_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3356.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3356.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 10</text>
<text text-anchor="middle" x="3356.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3356.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3356.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_10 -->
<g id="edge1358" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2716.94,-516.07C2845.38,-500.45 3031.69,-475.87 3193.32,-447.08 3208.41,-444.39 3224.23,-441.28 3239.82,-438.05"/>
<polygon fill="black" stroke="black" points="3240.96,-441.39 3250.03,-435.91 3239.53,-434.54 3240.96,-441.39"/>
</g>
<!-- layer_15_all2all_expert_11 -->
<g id="node999" class="node">
<title>layer_15_all2all_expert_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3676.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3676.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 11</text>
<text text-anchor="middle" x="3676.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3676.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3676.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_11 -->
<g id="edge1360" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2724.66,-525.33C2915.19,-513.75 3238.31,-489.64 3513.32,-447.08 3528.97,-444.66 3545.37,-441.64 3561.48,-438.39"/>
<polygon fill="black" stroke="black" points="3562.37,-441.78 3571.46,-436.34 3560.96,-434.92 3562.37,-441.78"/>
</g>
<!-- layer_15_all2all_expert_12 -->
<g id="node1001" class="node">
<title>layer_15_all2all_expert_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3997.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="3997.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 12</text>
<text text-anchor="middle" x="3997.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3997.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3997.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_12 -->
<g id="edge1362" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2728.97,-530.41C2973.49,-523.31 3440.21,-503.07 3833.32,-447.08 3849.45,-444.78 3866.35,-441.78 3882.92,-438.5"/>
<polygon fill="black" stroke="black" points="3884.08,-441.83 3893.19,-436.42 3882.69,-434.97 3884.08,-441.83"/>
</g>
<!-- layer_15_all2all_expert_13 -->
<g id="node1003" class="node">
<title>layer_15_all2all_expert_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4318.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4318.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 13</text>
<text text-anchor="middle" x="4318.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4318.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4318.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_13 -->
<g id="edge1364" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2731.9,-533.7C3024.89,-531.05 3639.89,-516.76 4154.32,-447.08 4170.74,-444.85 4187.95,-441.86 4204.79,-438.53"/>
<polygon fill="black" stroke="black" points="4205.55,-441.95 4214.66,-436.54 4204.16,-435.09 4205.55,-441.95"/>
</g>
<!-- layer_15_all2all_expert_14 -->
<g id="node1005" class="node">
<title>layer_15_all2all_expert_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4639.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4639.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 14</text>
<text text-anchor="middle" x="4639.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4639.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4639.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_14 -->
<g id="edge1366" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2728.76,-530.09C3131.24,-519.96 4140.17,-490.92 4475.32,-447.08 4491.75,-444.93 4508.96,-441.97 4525.81,-438.67"/>
<polygon fill="black" stroke="black" points="4526.56,-442.09 4535.68,-436.69 4525.18,-435.23 4526.56,-442.09"/>
</g>
<!-- layer_15_all2all_expert_15 -->
<g id="node1007" class="node">
<title>layer_15_all2all_expert_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4960.32" cy="-410.31" rx="147.57" ry="36.54"/>
<text text-anchor="middle" x="4960.32" y="-424.31" font-family="Arial" font-size="10.00">All&#45;to&#45;All Expert 15</text>
<text text-anchor="middle" x="4960.32" y="-413.31" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4960.32" y="-402.31" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4960.32" y="-391.31" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_all2all_expert_15 -->
<g id="edge1368" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_all2all_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2729.66,-531.35C3179.48,-523.47 4397.1,-497.98 4796.32,-447.08 4812.87,-444.97 4830.23,-442.01 4847.19,-438.69"/>
<polygon fill="black" stroke="black" points="4848.01,-442.1 4857.13,-436.7 4846.64,-435.24 4848.01,-442.1"/>
</g>
<!-- layer_15_expert_0_gpu8 -->
<g id="node976" class="node">
<title>layer_15_expert_0_gpu8</title>
<polygon fill="lightblue" stroke="black" points="279.82,-337.54 70.82,-337.54 70.82,-285.54 279.82,-285.54 279.82,-337.54"/>
<text text-anchor="middle" x="175.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="175.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="175.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="175.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_0 -->
<g id="node1008" class="node">
<title>layer_15_all2all_back_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="151.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="151.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 0</text>
<text text-anchor="middle" x="151.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="151.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="151.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_0_gpu8&#45;&gt;layer_15_all2all_back_0 -->
<g id="edge1370" class="edge">
<title>layer_15_expert_0_gpu8&#45;&gt;layer_15_all2all_back_0</title>
<path fill="none" stroke="black" d="M169.08,-285.37C167.12,-277.47 164.89,-268.5 162.7,-259.64"/>
<polygon fill="black" stroke="black" points="166.05,-258.61 160.24,-249.75 159.25,-260.29 166.05,-258.61"/>
</g>
<!-- layer_15_all2all_expert_0&#45;&gt;layer_15_expert_0_gpu8 -->
<g id="edge1339" class="edge">
<title>layer_15_all2all_expert_0&#45;&gt;layer_15_expert_0_gpu8</title>
<path fill="none" stroke="black" d="M176.58,-373.28C176.4,-364.96 176.22,-356.13 176.05,-347.85"/>
<polygon fill="black" stroke="black" points="179.55,-347.66 175.84,-337.74 172.55,-347.81 179.55,-347.66"/>
</g>
<!-- layer_15_expert_1_gpu8 -->
<g id="node978" class="node">
<title>layer_15_expert_1_gpu8</title>
<polygon fill="lightblue" stroke="black" points="588.82,-337.54 379.82,-337.54 379.82,-285.54 588.82,-285.54 588.82,-337.54"/>
<text text-anchor="middle" x="484.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="484.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="484.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="484.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_1 -->
<g id="node1009" class="node">
<title>layer_15_all2all_back_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="472.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="472.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 1</text>
<text text-anchor="middle" x="472.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="472.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="472.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_1_gpu8&#45;&gt;layer_15_all2all_back_1 -->
<g id="edge1371" class="edge">
<title>layer_15_expert_1_gpu8&#45;&gt;layer_15_all2all_back_1</title>
<path fill="none" stroke="black" d="M481.2,-285.37C480.23,-277.56 479.13,-268.69 478.04,-259.92"/>
<polygon fill="black" stroke="black" points="481.49,-259.24 476.78,-249.75 474.54,-260.1 481.49,-259.24"/>
</g>
<!-- layer_15_all2all_expert_1&#45;&gt;layer_15_expert_1_gpu8 -->
<g id="edge1341" class="edge">
<title>layer_15_all2all_expert_1&#45;&gt;layer_15_expert_1_gpu8</title>
<path fill="none" stroke="black" d="M497.56,-373.55C495.72,-365.05 493.75,-356 491.92,-347.53"/>
<polygon fill="black" stroke="black" points="495.3,-346.61 489.76,-337.58 488.46,-348.1 495.3,-346.61"/>
</g>
<!-- layer_15_expert_2_gpu9 -->
<g id="node980" class="node">
<title>layer_15_expert_2_gpu9</title>
<polygon fill="lightblue" stroke="black" points="913.82,-337.54 704.82,-337.54 704.82,-285.54 913.82,-285.54 913.82,-337.54"/>
<text text-anchor="middle" x="809.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="809.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="809.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="809.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_2 -->
<g id="node1010" class="node">
<title>layer_15_all2all_back_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="793.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="793.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 2</text>
<text text-anchor="middle" x="793.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="793.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="793.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_2_gpu9&#45;&gt;layer_15_all2all_back_2 -->
<g id="edge1372" class="edge">
<title>layer_15_expert_2_gpu9&#45;&gt;layer_15_all2all_back_2</title>
<path fill="none" stroke="black" d="M805.16,-285.37C803.85,-277.47 802.37,-268.5 800.9,-259.64"/>
<polygon fill="black" stroke="black" points="804.35,-259.04 799.27,-249.75 797.45,-260.18 804.35,-259.04"/>
</g>
<!-- layer_15_all2all_expert_2&#45;&gt;layer_15_expert_2_gpu9 -->
<g id="edge1343" class="edge">
<title>layer_15_all2all_expert_2&#45;&gt;layer_15_expert_2_gpu9</title>
<path fill="none" stroke="black" d="M820.04,-373.55C818.55,-365.05 816.96,-356 815.47,-347.53"/>
<polygon fill="black" stroke="black" points="818.9,-346.83 813.72,-337.58 812,-348.04 818.9,-346.83"/>
</g>
<!-- layer_15_expert_3_gpu9 -->
<g id="node982" class="node">
<title>layer_15_expert_3_gpu9</title>
<polygon fill="lightblue" stroke="black" points="1232.82,-337.54 1023.82,-337.54 1023.82,-285.54 1232.82,-285.54 1232.82,-337.54"/>
<text text-anchor="middle" x="1128.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1128.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="1128.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1128.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_3 -->
<g id="node1011" class="node">
<title>layer_15_all2all_back_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1114.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1114.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 3</text>
<text text-anchor="middle" x="1114.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1114.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1114.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_3_gpu9&#45;&gt;layer_15_all2all_back_3 -->
<g id="edge1373" class="edge">
<title>layer_15_expert_3_gpu9&#45;&gt;layer_15_all2all_back_3</title>
<path fill="none" stroke="black" d="M1124.68,-285.37C1123.55,-277.56 1122.27,-268.69 1121,-259.92"/>
<polygon fill="black" stroke="black" points="1124.42,-259.14 1119.53,-249.75 1117.49,-260.14 1124.42,-259.14"/>
</g>
<!-- layer_15_all2all_expert_3&#45;&gt;layer_15_expert_3_gpu9 -->
<g id="edge1345" class="edge">
<title>layer_15_all2all_expert_3&#45;&gt;layer_15_expert_3_gpu9</title>
<path fill="none" stroke="black" d="M1137.78,-373.55C1136.46,-365.05 1135.06,-356 1133.75,-347.53"/>
<polygon fill="black" stroke="black" points="1137.19,-346.93 1132.2,-337.58 1130.28,-348 1137.19,-346.93"/>
</g>
<!-- layer_15_expert_4_gpu10 -->
<g id="node984" class="node">
<title>layer_15_expert_4_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1550.82,-337.54 1341.82,-337.54 1341.82,-285.54 1550.82,-285.54 1550.82,-337.54"/>
<text text-anchor="middle" x="1446.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1446.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1446.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1446.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_4 -->
<g id="node1012" class="node">
<title>layer_15_all2all_back_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1435.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1435.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 4</text>
<text text-anchor="middle" x="1435.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1435.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1435.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_4_gpu10&#45;&gt;layer_15_all2all_back_4 -->
<g id="edge1374" class="edge">
<title>layer_15_expert_4_gpu10&#45;&gt;layer_15_all2all_back_4</title>
<path fill="none" stroke="black" d="M1443.46,-285.37C1442.57,-277.56 1441.56,-268.69 1440.57,-259.92"/>
<polygon fill="black" stroke="black" points="1444.02,-259.29 1439.41,-249.75 1437.06,-260.08 1444.02,-259.29"/>
</g>
<!-- layer_15_all2all_expert_4&#45;&gt;layer_15_expert_4_gpu10 -->
<g id="edge1347" class="edge">
<title>layer_15_all2all_expert_4&#45;&gt;layer_15_expert_4_gpu10</title>
<path fill="none" stroke="black" d="M1454.52,-373.55C1453.38,-365.05 1452.16,-356 1451.02,-347.53"/>
<polygon fill="black" stroke="black" points="1454.49,-347.03 1449.69,-337.58 1447.55,-347.96 1454.49,-347.03"/>
</g>
<!-- layer_15_expert_5_gpu10 -->
<g id="node986" class="node">
<title>layer_15_expert_5_gpu10</title>
<polygon fill="lightblue" stroke="black" points="1868.82,-337.54 1659.82,-337.54 1659.82,-285.54 1868.82,-285.54 1868.82,-337.54"/>
<text text-anchor="middle" x="1764.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1764.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="1764.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1764.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_5 -->
<g id="node1013" class="node">
<title>layer_15_all2all_back_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1756.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="1756.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 5</text>
<text text-anchor="middle" x="1756.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="1756.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="1756.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_5_gpu10&#45;&gt;layer_15_all2all_back_5 -->
<g id="edge1375" class="edge">
<title>layer_15_expert_5_gpu10&#45;&gt;layer_15_all2all_back_5</title>
<path fill="none" stroke="black" d="M1762.24,-285.37C1761.59,-277.56 1760.86,-268.69 1760.14,-259.92"/>
<polygon fill="black" stroke="black" points="1763.61,-259.42 1759.3,-249.75 1756.63,-260 1763.61,-259.42"/>
</g>
<!-- layer_15_all2all_expert_5&#45;&gt;layer_15_expert_5_gpu10 -->
<g id="edge1349" class="edge">
<title>layer_15_all2all_expert_5&#45;&gt;layer_15_expert_5_gpu10</title>
<path fill="none" stroke="black" d="M1770.63,-373.55C1769.75,-365.05 1768.81,-356 1767.94,-347.53"/>
<polygon fill="black" stroke="black" points="1771.42,-347.17 1766.91,-337.58 1764.46,-347.89 1771.42,-347.17"/>
</g>
<!-- layer_15_expert_6_gpu11 -->
<g id="node988" class="node">
<title>layer_15_expert_6_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2186.82,-337.54 1977.82,-337.54 1977.82,-285.54 2186.82,-285.54 2186.82,-337.54"/>
<text text-anchor="middle" x="2082.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2082.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2082.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2082.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_6 -->
<g id="node1014" class="node">
<title>layer_15_all2all_back_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2077.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2077.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 6</text>
<text text-anchor="middle" x="2077.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2077.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2077.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_6_gpu11&#45;&gt;layer_15_all2all_back_6 -->
<g id="edge1376" class="edge">
<title>layer_15_expert_6_gpu11&#45;&gt;layer_15_all2all_back_6</title>
<path fill="none" stroke="black" d="M2081.02,-285.37C2080.62,-277.56 2080.16,-268.69 2079.71,-259.92"/>
<polygon fill="black" stroke="black" points="2083.19,-259.55 2079.18,-249.75 2076.2,-259.91 2083.19,-259.55"/>
</g>
<!-- layer_15_all2all_expert_6&#45;&gt;layer_15_expert_6_gpu11 -->
<g id="edge1351" class="edge">
<title>layer_15_all2all_expert_6&#45;&gt;layer_15_expert_6_gpu11</title>
<path fill="none" stroke="black" d="M2086.09,-373.28C2085.57,-364.96 2085.02,-356.13 2084.51,-347.85"/>
<polygon fill="black" stroke="black" points="2088,-347.5 2083.88,-337.74 2081.01,-347.93 2088,-347.5"/>
</g>
<!-- layer_15_expert_7_gpu11 -->
<g id="node990" class="node">
<title>layer_15_expert_7_gpu11</title>
<polygon fill="lightblue" stroke="black" points="2503.82,-337.54 2294.82,-337.54 2294.82,-285.54 2503.82,-285.54 2503.82,-337.54"/>
<text text-anchor="middle" x="2399.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2399.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="2399.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2399.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_7 -->
<g id="node1015" class="node">
<title>layer_15_all2all_back_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2398.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2398.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 7</text>
<text text-anchor="middle" x="2398.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2398.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2398.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_7_gpu11&#45;&gt;layer_15_all2all_back_7 -->
<g id="edge1377" class="edge">
<title>layer_15_expert_7_gpu11&#45;&gt;layer_15_all2all_back_7</title>
<path fill="none" stroke="black" d="M2399.06,-285.37C2398.98,-277.56 2398.89,-268.69 2398.8,-259.92"/>
<polygon fill="black" stroke="black" points="2402.3,-259.71 2398.69,-249.75 2395.3,-259.78 2402.3,-259.71"/>
</g>
<!-- layer_15_all2all_expert_7&#45;&gt;layer_15_expert_7_gpu11 -->
<g id="edge1353" class="edge">
<title>layer_15_all2all_expert_7&#45;&gt;layer_15_expert_7_gpu11</title>
<path fill="none" stroke="black" d="M2401.2,-373.28C2400.95,-364.96 2400.67,-356.13 2400.42,-347.85"/>
<polygon fill="black" stroke="black" points="2403.91,-347.62 2400.1,-337.74 2396.91,-347.84 2403.91,-347.62"/>
</g>
<!-- layer_15_expert_8_gpu12 -->
<g id="node992" class="node">
<title>layer_15_expert_8_gpu12</title>
<polygon fill="lightblue" stroke="black" points="2823.82,-337.54 2614.82,-337.54 2614.82,-285.54 2823.82,-285.54 2823.82,-337.54"/>
<text text-anchor="middle" x="2719.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2719.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="2719.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2719.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_8 -->
<g id="node1016" class="node">
<title>layer_15_all2all_back_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2719.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="2719.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 8</text>
<text text-anchor="middle" x="2719.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="2719.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2719.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_8_gpu12&#45;&gt;layer_15_all2all_back_8 -->
<g id="edge1378" class="edge">
<title>layer_15_expert_8_gpu12&#45;&gt;layer_15_all2all_back_8</title>
<path fill="none" stroke="black" d="M2719.32,-285.37C2719.32,-277.56 2719.32,-268.69 2719.32,-259.92"/>
<polygon fill="black" stroke="black" points="2722.82,-259.75 2719.32,-249.75 2715.82,-259.75 2722.82,-259.75"/>
</g>
<!-- layer_15_all2all_expert_8&#45;&gt;layer_15_expert_8_gpu12 -->
<g id="edge1355" class="edge">
<title>layer_15_all2all_expert_8&#45;&gt;layer_15_expert_8_gpu12</title>
<path fill="none" stroke="black" d="M2718.69,-373.28C2718.78,-364.96 2718.87,-356.13 2718.96,-347.85"/>
<polygon fill="black" stroke="black" points="2722.46,-347.77 2719.06,-337.74 2715.46,-347.7 2722.46,-347.77"/>
</g>
<!-- layer_15_expert_9_gpu12 -->
<g id="node994" class="node">
<title>layer_15_expert_9_gpu12</title>
<polygon fill="lightblue" stroke="black" points="3142.82,-337.54 2933.82,-337.54 2933.82,-285.54 3142.82,-285.54 3142.82,-337.54"/>
<text text-anchor="middle" x="3038.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="3038.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="3038.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3038.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_9 -->
<g id="node1017" class="node">
<title>layer_15_all2all_back_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3040.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3040.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 9</text>
<text text-anchor="middle" x="3040.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3040.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3040.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_9_gpu12&#45;&gt;layer_15_all2all_back_9 -->
<g id="edge1379" class="edge">
<title>layer_15_expert_9_gpu12&#45;&gt;layer_15_all2all_back_9</title>
<path fill="none" stroke="black" d="M3038.84,-285.37C3039,-277.56 3039.19,-268.69 3039.37,-259.92"/>
<polygon fill="black" stroke="black" points="3042.87,-259.82 3039.58,-249.75 3035.87,-259.67 3042.87,-259.82"/>
</g>
<!-- layer_15_all2all_expert_9&#45;&gt;layer_15_expert_9_gpu12 -->
<g id="edge1357" class="edge">
<title>layer_15_all2all_expert_9&#45;&gt;layer_15_expert_9_gpu12</title>
<path fill="none" stroke="black" d="M3037.07,-373.28C3037.24,-364.96 3037.42,-356.13 3037.59,-347.85"/>
<polygon fill="black" stroke="black" points="3041.09,-347.81 3037.8,-337.74 3034.09,-347.66 3041.09,-347.81"/>
</g>
<!-- layer_15_expert_10_gpu13 -->
<g id="node996" class="node">
<title>layer_15_expert_10_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3462.82,-337.54 3253.82,-337.54 3253.82,-285.54 3462.82,-285.54 3462.82,-337.54"/>
<text text-anchor="middle" x="3358.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="3358.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3358.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3358.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_10 -->
<g id="node1018" class="node">
<title>layer_15_all2all_back_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3361.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3361.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 10</text>
<text text-anchor="middle" x="3361.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3361.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3361.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_10_gpu13&#45;&gt;layer_15_all2all_back_10 -->
<g id="edge1380" class="edge">
<title>layer_15_expert_10_gpu13&#45;&gt;layer_15_all2all_back_10</title>
<path fill="none" stroke="black" d="M3359.1,-285.37C3359.34,-277.56 3359.62,-268.69 3359.89,-259.92"/>
<polygon fill="black" stroke="black" points="3363.39,-259.85 3360.21,-249.75 3356.4,-259.63 3363.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_10&#45;&gt;layer_15_expert_10_gpu13 -->
<g id="edge1359" class="edge">
<title>layer_15_all2all_expert_10&#45;&gt;layer_15_expert_10_gpu13</title>
<path fill="none" stroke="black" d="M3357.07,-373.28C3357.24,-364.96 3357.42,-356.13 3357.59,-347.85"/>
<polygon fill="black" stroke="black" points="3361.09,-347.81 3357.8,-337.74 3354.09,-347.66 3361.09,-347.81"/>
</g>
<!-- layer_15_expert_11_gpu13 -->
<g id="node998" class="node">
<title>layer_15_expert_11_gpu13</title>
<polygon fill="lightblue" stroke="black" points="3783.82,-337.54 3574.82,-337.54 3574.82,-285.54 3783.82,-285.54 3783.82,-337.54"/>
<text text-anchor="middle" x="3679.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="3679.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="3679.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3679.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_11 -->
<g id="node1019" class="node">
<title>layer_15_all2all_back_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3682.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="3682.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 11</text>
<text text-anchor="middle" x="3682.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="3682.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="3682.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_11_gpu13&#45;&gt;layer_15_all2all_back_11 -->
<g id="edge1381" class="edge">
<title>layer_15_expert_11_gpu13&#45;&gt;layer_15_all2all_back_11</title>
<path fill="none" stroke="black" d="M3680.1,-285.37C3680.34,-277.56 3680.62,-268.69 3680.89,-259.92"/>
<polygon fill="black" stroke="black" points="3684.39,-259.85 3681.21,-249.75 3677.4,-259.63 3684.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_11&#45;&gt;layer_15_expert_11_gpu13 -->
<g id="edge1361" class="edge">
<title>layer_15_all2all_expert_11&#45;&gt;layer_15_expert_11_gpu13</title>
<path fill="none" stroke="black" d="M3677.44,-373.28C3677.7,-364.96 3677.97,-356.13 3678.23,-347.85"/>
<polygon fill="black" stroke="black" points="3681.73,-347.84 3678.54,-337.74 3674.73,-347.62 3681.73,-347.84"/>
</g>
<!-- layer_15_expert_12_gpu14 -->
<g id="node1000" class="node">
<title>layer_15_expert_12_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4104.82,-337.54 3895.82,-337.54 3895.82,-285.54 4104.82,-285.54 4104.82,-337.54"/>
<text text-anchor="middle" x="4000.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="4000.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4000.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4000.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_12 -->
<g id="node1020" class="node">
<title>layer_15_all2all_back_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4003.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4003.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 12</text>
<text text-anchor="middle" x="4003.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4003.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4003.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_12_gpu14&#45;&gt;layer_15_all2all_back_12 -->
<g id="edge1382" class="edge">
<title>layer_15_expert_12_gpu14&#45;&gt;layer_15_all2all_back_12</title>
<path fill="none" stroke="black" d="M4001.1,-285.37C4001.34,-277.56 4001.62,-268.69 4001.89,-259.92"/>
<polygon fill="black" stroke="black" points="4005.39,-259.85 4002.21,-249.75 3998.4,-259.63 4005.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_12&#45;&gt;layer_15_expert_12_gpu14 -->
<g id="edge1363" class="edge">
<title>layer_15_all2all_expert_12&#45;&gt;layer_15_expert_12_gpu14</title>
<path fill="none" stroke="black" d="M3998.44,-373.28C3998.7,-364.96 3998.97,-356.13 3999.23,-347.85"/>
<polygon fill="black" stroke="black" points="4002.73,-347.84 3999.54,-337.74 3995.73,-347.62 4002.73,-347.84"/>
</g>
<!-- layer_15_expert_13_gpu14 -->
<g id="node1002" class="node">
<title>layer_15_expert_13_gpu14</title>
<polygon fill="lightblue" stroke="black" points="4425.82,-337.54 4216.82,-337.54 4216.82,-285.54 4425.82,-285.54 4425.82,-337.54"/>
<text text-anchor="middle" x="4321.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="4321.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="4321.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4321.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_13 -->
<g id="node1021" class="node">
<title>layer_15_all2all_back_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4324.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4324.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 13</text>
<text text-anchor="middle" x="4324.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4324.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4324.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_13_gpu14&#45;&gt;layer_15_all2all_back_13 -->
<g id="edge1383" class="edge">
<title>layer_15_expert_13_gpu14&#45;&gt;layer_15_all2all_back_13</title>
<path fill="none" stroke="black" d="M4322.1,-285.37C4322.34,-277.56 4322.62,-268.69 4322.89,-259.92"/>
<polygon fill="black" stroke="black" points="4326.39,-259.85 4323.21,-249.75 4319.4,-259.63 4326.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_13&#45;&gt;layer_15_expert_13_gpu14 -->
<g id="edge1365" class="edge">
<title>layer_15_all2all_expert_13&#45;&gt;layer_15_expert_13_gpu14</title>
<path fill="none" stroke="black" d="M4319.44,-373.28C4319.7,-364.96 4319.97,-356.13 4320.23,-347.85"/>
<polygon fill="black" stroke="black" points="4323.73,-347.84 4320.54,-337.74 4316.73,-347.62 4323.73,-347.84"/>
</g>
<!-- layer_15_expert_14_gpu15 -->
<g id="node1004" class="node">
<title>layer_15_expert_14_gpu15</title>
<polygon fill="lightblue" stroke="black" points="4746.82,-337.54 4537.82,-337.54 4537.82,-285.54 4746.82,-285.54 4746.82,-337.54"/>
<text text-anchor="middle" x="4642.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="4642.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4642.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4642.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_14 -->
<g id="node1022" class="node">
<title>layer_15_all2all_back_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4645.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4645.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 14</text>
<text text-anchor="middle" x="4645.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4645.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4645.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_14_gpu15&#45;&gt;layer_15_all2all_back_14 -->
<g id="edge1384" class="edge">
<title>layer_15_expert_14_gpu15&#45;&gt;layer_15_all2all_back_14</title>
<path fill="none" stroke="black" d="M4643.1,-285.37C4643.34,-277.56 4643.62,-268.69 4643.89,-259.92"/>
<polygon fill="black" stroke="black" points="4647.39,-259.85 4644.21,-249.75 4640.4,-259.63 4647.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_14&#45;&gt;layer_15_expert_14_gpu15 -->
<g id="edge1367" class="edge">
<title>layer_15_all2all_expert_14&#45;&gt;layer_15_expert_14_gpu15</title>
<path fill="none" stroke="black" d="M4640.44,-373.28C4640.7,-364.96 4640.97,-356.13 4641.23,-347.85"/>
<polygon fill="black" stroke="black" points="4644.73,-347.84 4641.54,-337.74 4637.73,-347.62 4644.73,-347.84"/>
</g>
<!-- layer_15_expert_15_gpu15 -->
<g id="node1006" class="node">
<title>layer_15_expert_15_gpu15</title>
<polygon fill="lightblue" stroke="black" points="5067.82,-337.54 4858.82,-337.54 4858.82,-285.54 5067.82,-285.54 5067.82,-337.54"/>
<text text-anchor="middle" x="4963.32" y="-325.54" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="4963.32" y="-314.54" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="4963.32" y="-303.54" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4963.32" y="-292.54" font-family="Arial" font-size="10.00">Output: [batch=16, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_15 -->
<g id="node1023" class="node">
<title>layer_15_all2all_back_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4966.32" cy="-212.77" rx="151.14" ry="36.54"/>
<text text-anchor="middle" x="4966.32" y="-226.77" font-family="Arial" font-size="10.00">All&#45;to&#45;All Back 15</text>
<text text-anchor="middle" x="4966.32" y="-215.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
<text text-anchor="middle" x="4966.32" y="-204.77" font-family="Arial" font-size="10.00">Input: [batch=16, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="4966.32" y="-193.77" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_expert_15_gpu15&#45;&gt;layer_15_all2all_back_15 -->
<g id="edge1385" class="edge">
<title>layer_15_expert_15_gpu15&#45;&gt;layer_15_all2all_back_15</title>
<path fill="none" stroke="black" d="M4964.1,-285.37C4964.34,-277.56 4964.62,-268.69 4964.89,-259.92"/>
<polygon fill="black" stroke="black" points="4968.39,-259.85 4965.21,-249.75 4961.4,-259.63 4968.39,-259.85"/>
</g>
<!-- layer_15_all2all_expert_15&#45;&gt;layer_15_expert_15_gpu15 -->
<g id="edge1369" class="edge">
<title>layer_15_all2all_expert_15&#45;&gt;layer_15_expert_15_gpu15</title>
<path fill="none" stroke="black" d="M4961.44,-373.28C4961.7,-364.96 4961.97,-356.13 4962.23,-347.85"/>
<polygon fill="black" stroke="black" points="4965.73,-347.84 4962.54,-337.74 4958.73,-347.62 4965.73,-347.84"/>
</g>
<!-- layer_15_output -->
<g id="node1024" class="node">
<title>layer_15_output</title>
<polygon fill="lightblue" stroke="black" points="2665.32,-140 2451.32,-140 2451.32,-88 2665.32,-88 2665.32,-140"/>
<text text-anchor="middle" x="2558.32" y="-128" font-family="Arial" font-size="10.00">Layer 15 Output</text>
<text text-anchor="middle" x="2558.32" y="-117" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2558.32" y="-106" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2558.32" y="-95" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, hidden=128]</text>
</g>
<!-- layer_15_all2all_back_0&#45;&gt;layer_15_output -->
<g id="edge1386" class="edge">
<title>layer_15_all2all_back_0&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M254.31,-185.82C273.48,-181.87 293.42,-178.33 312.32,-176 730.21,-124.39 2040.59,-116.44 2440.96,-115.22"/>
<polygon fill="black" stroke="black" points="2441.12,-118.72 2451.11,-115.19 2441.1,-111.72 2441.12,-118.72"/>
</g>
<!-- layer_15_all2all_back_1&#45;&gt;layer_15_output -->
<g id="edge1387" class="edge">
<title>layer_15_all2all_back_1&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M575.75,-185.8C594.79,-181.88 614.57,-178.36 633.32,-176 985.84,-131.65 2079.7,-118.9 2441.1,-115.84"/>
<polygon fill="black" stroke="black" points="2441.35,-119.34 2451.32,-115.76 2441.29,-112.34 2441.35,-119.34"/>
</g>
<!-- layer_15_all2all_back_2&#45;&gt;layer_15_output -->
<g id="edge1388" class="edge">
<title>layer_15_all2all_back_2&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M896.76,-185.9C915.8,-181.97 935.58,-178.42 954.32,-176 1241.83,-138.9 2121.45,-121.81 2440.86,-116.71"/>
<polygon fill="black" stroke="black" points="2441.12,-120.21 2451.06,-116.55 2441.01,-113.21 2441.12,-120.21"/>
</g>
<!-- layer_15_all2all_back_3&#45;&gt;layer_15_output -->
<g id="edge1389" class="edge">
<title>layer_15_all2all_back_3&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M1218.21,-185.96C1237.12,-182.04 1256.73,-178.49 1275.32,-176 1498.45,-146.13 2167.68,-125.43 2440.55,-118.02"/>
<polygon fill="black" stroke="black" points="2440.98,-121.51 2450.88,-117.74 2440.79,-114.51 2440.98,-121.51"/>
</g>
<!-- layer_15_all2all_back_4&#45;&gt;layer_15_output -->
<g id="edge1390" class="edge">
<title>layer_15_all2all_back_4&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M1539.68,-186.11C1558.45,-182.21 1577.89,-178.62 1596.32,-176 1898.78,-133.08 2259.05,-120.35 2440.88,-116.58"/>
<polygon fill="black" stroke="black" points="2441.07,-120.08 2451,-116.38 2440.93,-113.08 2441.07,-120.08"/>
</g>
<!-- layer_15_all2all_back_5&#45;&gt;layer_15_output -->
<g id="edge1391" class="edge">
<title>layer_15_all2all_back_5&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M1862.05,-186.33C1880.41,-182.47 1899.36,-178.84 1917.32,-176 2099.01,-147.29 2311.95,-130.28 2440.91,-121.8"/>
<polygon fill="black" stroke="black" points="2441.45,-125.27 2451.2,-121.13 2440.99,-118.29 2441.45,-125.27"/>
</g>
<!-- layer_15_all2all_back_6&#45;&gt;layer_15_output -->
<g id="edge1392" class="edge">
<title>layer_15_all2all_back_6&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M2186.35,-187.08C2203.71,-183.28 2221.5,-179.47 2238.32,-176 2305.35,-162.17 2380.51,-147.78 2441.14,-136.46"/>
<polygon fill="black" stroke="black" points="2441.94,-139.87 2451.13,-134.6 2440.66,-132.99 2441.94,-139.87"/>
</g>
<!-- layer_15_all2all_back_7&#45;&gt;layer_15_output -->
<g id="edge1393" class="edge">
<title>layer_15_all2all_back_7&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M2453.38,-178.47C2471.09,-167.76 2490.6,-155.96 2507.95,-145.46"/>
<polygon fill="black" stroke="black" points="2510.06,-148.28 2516.81,-140.11 2506.44,-142.29 2510.06,-148.28"/>
</g>
<!-- layer_15_all2all_back_8&#45;&gt;layer_15_output -->
<g id="edge1394" class="edge">
<title>layer_15_all2all_back_8&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M2663.91,-178.47C2646.1,-167.76 2626.46,-155.96 2609,-145.46"/>
<polygon fill="black" stroke="black" points="2610.47,-142.26 2600.09,-140.11 2606.86,-148.26 2610.47,-142.26"/>
</g>
<!-- layer_15_all2all_back_9&#45;&gt;layer_15_output -->
<g id="edge1395" class="edge">
<title>layer_15_all2all_back_9&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M2931.3,-187.07C2913.93,-183.27 2896.15,-179.47 2879.32,-176 2811.96,-162.12 2736.39,-147.7 2675.51,-136.37"/>
<polygon fill="black" stroke="black" points="2675.96,-132.9 2665.48,-134.51 2674.68,-139.78 2675.96,-132.9"/>
</g>
<!-- layer_15_all2all_back_10&#45;&gt;layer_15_output -->
<g id="edge1396" class="edge">
<title>layer_15_all2all_back_10&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M3255.59,-186.32C3237.24,-182.47 3218.28,-178.84 3200.32,-176 3018.22,-147.23 2804.76,-130.24 2675.63,-121.77"/>
<polygon fill="black" stroke="black" points="2675.53,-118.25 2665.33,-121.1 2675.08,-125.24 2675.53,-118.25"/>
</g>
<!-- layer_15_all2all_back_11&#45;&gt;layer_15_output -->
<g id="edge1397" class="edge">
<title>layer_15_all2all_back_11&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M3577.96,-186.11C3559.2,-182.21 3539.75,-178.61 3521.32,-176 3218.34,-133.01 2857.42,-120.31 2675.52,-116.57"/>
<polygon fill="black" stroke="black" points="2675.46,-113.06 2665.39,-116.36 2675.32,-120.06 2675.46,-113.06"/>
</g>
<!-- layer_15_all2all_back_12&#45;&gt;layer_15_output -->
<g id="edge1398" class="edge">
<title>layer_15_all2all_back_12&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M3899.43,-185.96C3880.53,-182.04 3860.91,-178.49 3842.32,-176 3618.88,-146.1 2948.45,-125.4 2675.68,-118"/>
<polygon fill="black" stroke="black" points="2675.45,-114.5 2665.36,-117.72 2675.26,-121.49 2675.45,-114.5"/>
</g>
<!-- layer_15_all2all_back_13&#45;&gt;layer_15_output -->
<g id="edge1399" class="edge">
<title>layer_15_all2all_back_13&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M4220.88,-185.9C4201.84,-181.97 4182.06,-178.42 4163.32,-176 3875.54,-138.87 2994.94,-121.8 2675.57,-116.71"/>
<polygon fill="black" stroke="black" points="2675.42,-113.2 2665.37,-116.55 2675.31,-120.2 2675.42,-113.2"/>
</g>
<!-- layer_15_all2all_back_14&#45;&gt;layer_15_output -->
<g id="edge1400" class="edge">
<title>layer_15_all2all_back_14&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M4541.89,-185.8C4522.85,-181.88 4503.07,-178.36 4484.32,-176 4131.62,-131.63 3037.19,-118.89 2675.6,-115.84"/>
<polygon fill="black" stroke="black" points="2675.41,-112.34 2665.38,-115.76 2675.35,-119.34 2675.41,-112.34"/>
</g>
<!-- layer_15_all2all_back_15&#45;&gt;layer_15_output -->
<g id="edge1401" class="edge">
<title>layer_15_all2all_back_15&#45;&gt;layer_15_output</title>
<path fill="none" stroke="black" d="M4863.33,-185.82C4844.16,-181.87 4824.22,-178.33 4805.32,-176 4387.25,-124.37 3076.28,-116.44 2675.73,-115.22"/>
<polygon fill="black" stroke="black" points="2675.59,-111.72 2665.58,-115.19 2675.57,-118.72 2675.59,-111.72"/>
</g>
<!-- output -->
<g id="node1025" class="node">
<title>output</title>
<polygon fill="lightcoral" stroke="black" points="2669.32,-52 2447.32,-52 2447.32,0 2669.32,0 2669.32,-52"/>
<text text-anchor="middle" x="2558.32" y="-40" font-family="Arial" font-size="10.00">Final Output</text>
<text text-anchor="middle" x="2558.32" y="-29" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="2558.32" y="-18" font-family="Arial" font-size="10.00">Input: [batch=128, seq=10240, hidden=128]</text>
<text text-anchor="middle" x="2558.32" y="-7" font-family="Arial" font-size="10.00">Output: [batch=128, seq=10240, vocab=50000]</text>
</g>
<!-- layer_15_output&#45;&gt;output -->
<g id="edge1402" class="edge">
<title>layer_15_output&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2558.32,-87.66C2558.32,-79.7 2558.32,-70.76 2558.32,-62.24"/>
<polygon fill="black" stroke="black" points="2561.82,-62.16 2558.32,-52.16 2554.82,-62.16 2561.82,-62.16"/>
</g>
</g>
</svg>
