<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="4198pt" height="11059pt"
 viewBox="0.00 0.00 4198.00 11058.79" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 11054.79)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11054.79 4194,-11054.79 4194,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgray" stroke="black" points="2222,-11050.79 1967,-11050.79 1967,-10998.79 2222,-10998.79 2222,-11050.79"/>
<text text-anchor="middle" x="2094.5" y="-11038.79" font-family="Arial" font-size="10.00">Input Embedding</text>
<text text-anchor="middle" x="2094.5" y="-11027.79" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-11016.79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="2094.5" y="-11005.79" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_0 -->
<g id="node2" class="node">
<title>attn_0</title>
<polygon fill="lightblue" stroke="black" points="2235,-10962.79 1954,-10962.79 1954,-10910.79 2235,-10910.79 2235,-10962.79"/>
<text text-anchor="middle" x="2094.5" y="-10950.79" font-family="Arial" font-size="10.00">Attention Layer 0</text>
<text text-anchor="middle" x="2094.5" y="-10939.79" font-family="Arial" font-size="10.00">GPU: 0 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10928.79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-10917.79" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- input&#45;&gt;attn_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M2094.5,-10998.45C2094.5,-10990.49 2094.5,-10981.55 2094.5,-10973.04"/>
<polygon fill="black" stroke="black" points="2098,-10972.95 2094.5,-10962.95 2091,-10972.95 2098,-10972.95"/>
</g>
<!-- comm_attn_0 -->
<g id="node3" class="node">
<title>comm_attn_0</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-10838.02" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-10852.02" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-10841.02" font-family="Arial" font-size="10.00">GPU: 0 ↔ GPU: 1, 2, 3</text>
<text text-anchor="middle" x="2094.5" y="-10830.02" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10819.02" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_0&#45;&gt;comm_attn_0 -->
<g id="edge2" class="edge">
<title>attn_0&#45;&gt;comm_attn_0</title>
<path fill="none" stroke="black" d="M2094.5,-10910.62C2094.5,-10902.81 2094.5,-10893.94 2094.5,-10885.18"/>
<polygon fill="black" stroke="black" points="2098,-10885 2094.5,-10875 2091,-10885 2098,-10885"/>
</g>
<!-- gate_0 -->
<g id="node4" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-10765.25 1931.71,-10765.25 1818.95,-10661.25 2257.29,-10661.25 2370.05,-10765.25"/>
<text text-anchor="middle" x="2094.5" y="-10727.25" font-family="Arial" font-size="10.00">Expert Gate 0</text>
<text text-anchor="middle" x="2094.5" y="-10716.25" font-family="Arial" font-size="10.00">GPU: 0 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10705.25" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10694.25" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_0&#45;&gt;gate_0 -->
<g id="edge3" class="edge">
<title>comm_attn_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M2094.5,-10801.18C2094.5,-10793.14 2094.5,-10784.39 2094.5,-10775.65"/>
<polygon fill="black" stroke="black" points="2098,-10775.42 2094.5,-10765.42 2091,-10775.42 2098,-10775.42"/>
</g>
<!-- all2all_0 -->
<g id="node21" class="node">
<title>all2all_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-10588.48" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-10602.48" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-10591.48" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10580.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10569.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_0&#45;&gt;all2all_0 -->
<g id="edge4" class="edge">
<title>gate_0&#45;&gt;all2all_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-10660.9C2094.5,-10652.49 2094.5,-10643.82 2094.5,-10635.55"/>
<polygon fill="black" stroke="black" points="2098,-10635.34 2094.5,-10625.34 2091,-10635.34 2098,-10635.34"/>
</g>
<!-- expert_0_0 -->
<g id="node5" class="node">
<title>expert_0_0</title>
<polygon fill="lightblue" stroke="black" points="245,-10515.71 0,-10515.71 0,-10463.71 245,-10463.71 245,-10515.71"/>
<text text-anchor="middle" x="122.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 0 Layer 0</text>
<text text-anchor="middle" x="122.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 0)</text>
<text text-anchor="middle" x="122.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_0 -->
<g id="node22" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-10427.71 1938.39,-10427.71 1830.26,-10323.71 2250.61,-10323.71 2358.74,-10427.71"/>
<text text-anchor="middle" x="2094.5" y="-10389.71" font-family="Arial" font-size="10.00">Expert Aggregation 0</text>
<text text-anchor="middle" x="2094.5" y="-10378.71" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10367.71" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10356.71" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_0&#45;&gt;agg_0 -->
<g id="edge6" class="edge">
<title>expert_0_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M245.14,-10464.76C247.95,-10464.39 250.74,-10464.04 253.5,-10463.71 836.59,-10394.65 1529.68,-10379.89 1875.48,-10377.08"/>
<polygon fill="black" stroke="black" points="1875.63,-10380.57 1885.61,-10377 1875.58,-10373.57 1875.63,-10380.57"/>
</g>
<!-- expert_0_1 -->
<g id="node6" class="node">
<title>expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="508,-10515.71 263,-10515.71 263,-10463.71 508,-10463.71 508,-10515.71"/>
<text text-anchor="middle" x="385.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 1 Layer 0</text>
<text text-anchor="middle" x="385.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 0)</text>
<text text-anchor="middle" x="385.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_1&#45;&gt;agg_0 -->
<g id="edge8" class="edge">
<title>expert_0_1&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M508.15,-10464.79C510.96,-10464.41 513.74,-10464.05 516.5,-10463.71 1000.37,-10404.47 1572.67,-10385.55 1877.6,-10379.52"/>
<polygon fill="black" stroke="black" points="1877.96,-10383.02 1887.89,-10379.32 1877.82,-10376.02 1877.96,-10383.02"/>
</g>
<!-- expert_0_2 -->
<g id="node7" class="node">
<title>expert_0_2</title>
<polygon fill="lightblue" stroke="black" points="771,-10515.71 526,-10515.71 526,-10463.71 771,-10463.71 771,-10515.71"/>
<text text-anchor="middle" x="648.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 2 Layer 0</text>
<text text-anchor="middle" x="648.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 0)</text>
<text text-anchor="middle" x="648.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_2&#45;&gt;agg_0 -->
<g id="edge10" class="edge">
<title>expert_0_2&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M771.15,-10464.83C773.96,-10464.44 776.74,-10464.07 779.5,-10463.71 1165.96,-10414.24 1620.14,-10392.09 1880.94,-10382.8"/>
<polygon fill="black" stroke="black" points="1881.42,-10386.29 1891.29,-10382.44 1881.17,-10379.29 1881.42,-10386.29"/>
</g>
<!-- expert_0_3 -->
<g id="node8" class="node">
<title>expert_0_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-10515.71 789,-10515.71 789,-10463.71 1034,-10463.71 1034,-10515.71"/>
<text text-anchor="middle" x="911.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 3 Layer 0</text>
<text text-anchor="middle" x="911.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 0)</text>
<text text-anchor="middle" x="911.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_3&#45;&gt;agg_0 -->
<g id="edge12" class="edge">
<title>expert_0_3&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1034.16,-10464.9C1036.96,-10464.48 1039.75,-10464.09 1042.5,-10463.71 1333.63,-10424.01 1672.73,-10399.91 1885.52,-10387.45"/>
<polygon fill="black" stroke="black" points="1885.78,-10390.94 1895.56,-10386.86 1885.37,-10383.95 1885.78,-10390.94"/>
</g>
<!-- expert_0_4 -->
<g id="node9" class="node">
<title>expert_0_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-10515.71 1052,-10515.71 1052,-10463.71 1297,-10463.71 1297,-10515.71"/>
<text text-anchor="middle" x="1174.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 4 Layer 0</text>
<text text-anchor="middle" x="1174.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 0)</text>
<text text-anchor="middle" x="1174.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_4&#45;&gt;agg_0 -->
<g id="edge14" class="edge">
<title>expert_0_4&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1297.18,-10465C1299.97,-10464.55 1302.75,-10464.13 1305.5,-10463.71 1504.19,-10433.85 1732.48,-10409.78 1892.21,-10394.59"/>
<polygon fill="black" stroke="black" points="1893.01,-10398.03 1902.63,-10393.61 1892.35,-10391.07 1893.01,-10398.03"/>
</g>
<!-- expert_0_5 -->
<g id="node10" class="node">
<title>expert_0_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-10515.71 1315,-10515.71 1315,-10463.71 1560,-10463.71 1560,-10515.71"/>
<text text-anchor="middle" x="1437.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 5 Layer 0</text>
<text text-anchor="middle" x="1437.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 0)</text>
<text text-anchor="middle" x="1437.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_5&#45;&gt;agg_0 -->
<g id="edge16" class="edge">
<title>expert_0_5&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1560.21,-10465.2C1563,-10464.7 1565.76,-10464.2 1568.5,-10463.71 1679.84,-10443.88 1804.72,-10423.16 1904.85,-10406.92"/>
<polygon fill="black" stroke="black" points="1905.46,-10410.37 1914.77,-10405.31 1904.34,-10403.46 1905.46,-10410.37"/>
</g>
<!-- expert_0_6 -->
<g id="node11" class="node">
<title>expert_0_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-10515.71 1578,-10515.71 1578,-10463.71 1823,-10463.71 1823,-10515.71"/>
<text text-anchor="middle" x="1700.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 6 Layer 0</text>
<text text-anchor="middle" x="1700.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 0)</text>
<text text-anchor="middle" x="1700.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_6&#45;&gt;agg_0 -->
<g id="edge18" class="edge">
<title>expert_0_6&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1788.92,-10463.58C1828.53,-10452.32 1876.66,-10438.64 1922.89,-10425.5"/>
<polygon fill="black" stroke="black" points="1924.06,-10428.8 1932.72,-10422.7 1922.14,-10422.07 1924.06,-10428.8"/>
</g>
<!-- expert_0_7 -->
<g id="node12" class="node">
<title>expert_0_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-10515.71 1841,-10515.71 1841,-10463.71 2086,-10463.71 2086,-10515.71"/>
<text text-anchor="middle" x="1963.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 7 Layer 0</text>
<text text-anchor="middle" x="1963.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 0)</text>
<text text-anchor="middle" x="1963.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_7&#45;&gt;agg_0 -->
<g id="edge20" class="edge">
<title>expert_0_7&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1992.9,-10463.58C2003.05,-10454.9 2014.88,-10444.79 2026.8,-10434.59"/>
<polygon fill="black" stroke="black" points="2029.31,-10437.05 2034.64,-10427.89 2024.76,-10431.73 2029.31,-10437.05"/>
</g>
<!-- expert_0_8 -->
<g id="node13" class="node">
<title>expert_0_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-10515.71 2104,-10515.71 2104,-10463.71 2349,-10463.71 2349,-10515.71"/>
<text text-anchor="middle" x="2226.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 8 Layer 0</text>
<text text-anchor="middle" x="2226.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 0)</text>
<text text-anchor="middle" x="2226.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_8&#45;&gt;agg_0 -->
<g id="edge22" class="edge">
<title>expert_0_8&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2196.88,-10463.58C2186.65,-10454.9 2174.73,-10444.79 2162.71,-10434.59"/>
<polygon fill="black" stroke="black" points="2164.71,-10431.69 2154.82,-10427.89 2160.18,-10437.03 2164.71,-10431.69"/>
</g>
<!-- expert_0_9 -->
<g id="node14" class="node">
<title>expert_0_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-10515.71 2367,-10515.71 2367,-10463.71 2612,-10463.71 2612,-10515.71"/>
<text text-anchor="middle" x="2489.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 9 Layer 0</text>
<text text-anchor="middle" x="2489.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 0)</text>
<text text-anchor="middle" x="2489.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_9&#45;&gt;agg_0 -->
<g id="edge24" class="edge">
<title>expert_0_9&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2400.85,-10463.58C2366.21,-10453.76 2325.08,-10442.09 2284.37,-10430.55"/>
<polygon fill="black" stroke="black" points="2285.17,-10427.14 2274.6,-10427.78 2283.26,-10433.87 2285.17,-10427.14"/>
</g>
<!-- expert_0_10 -->
<g id="node15" class="node">
<title>expert_0_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-10515.71 2630,-10515.71 2630,-10463.71 2875,-10463.71 2875,-10515.71"/>
<text text-anchor="middle" x="2752.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 10 Layer 0</text>
<text text-anchor="middle" x="2752.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 0)</text>
<text text-anchor="middle" x="2752.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_10&#45;&gt;agg_0 -->
<g id="edge26" class="edge">
<title>expert_0_10&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2629.79,-10465.2C2627,-10464.7 2624.24,-10464.2 2621.5,-10463.71 2535.88,-10448.48 2442.26,-10432.73 2357.99,-10418.89"/>
<polygon fill="black" stroke="black" points="2358.47,-10415.42 2348.03,-10417.25 2357.33,-10422.32 2358.47,-10415.42"/>
</g>
<!-- expert_0_11 -->
<g id="node16" class="node">
<title>expert_0_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-10515.71 2893,-10515.71 2893,-10463.71 3138,-10463.71 3138,-10515.71"/>
<text text-anchor="middle" x="3015.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 11 Layer 0</text>
<text text-anchor="middle" x="3015.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 0)</text>
<text text-anchor="middle" x="3015.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_11&#45;&gt;agg_0 -->
<g id="edge28" class="edge">
<title>expert_0_11&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2892.82,-10465C2890.03,-10464.55 2887.25,-10464.13 2884.5,-10463.71 2701.91,-10436.28 2494.36,-10413.76 2337.83,-10398.5"/>
<polygon fill="black" stroke="black" points="2337.88,-10394.99 2327.59,-10397.51 2337.21,-10401.96 2337.88,-10394.99"/>
</g>
<!-- expert_0_12 -->
<g id="node17" class="node">
<title>expert_0_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-10515.71 3156,-10515.71 3156,-10463.71 3401,-10463.71 3401,-10515.71"/>
<text text-anchor="middle" x="3278.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 12 Layer 0</text>
<text text-anchor="middle" x="3278.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 0)</text>
<text text-anchor="middle" x="3278.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_12&#45;&gt;agg_0 -->
<g id="edge30" class="edge">
<title>expert_0_12&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3155.84,-10464.89C3153.04,-10464.48 3150.25,-10464.09 3147.5,-10463.71 2866.94,-10425.46 2541.87,-10401.71 2327.98,-10388.88"/>
<polygon fill="black" stroke="black" points="2328.07,-10385.37 2317.87,-10388.27 2327.65,-10392.36 2328.07,-10385.37"/>
</g>
<!-- expert_0_13 -->
<g id="node18" class="node">
<title>expert_0_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-10515.71 3419,-10515.71 3419,-10463.71 3664,-10463.71 3664,-10515.71"/>
<text text-anchor="middle" x="3541.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 13 Layer 0</text>
<text text-anchor="middle" x="3541.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 0)</text>
<text text-anchor="middle" x="3541.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_13&#45;&gt;agg_0 -->
<g id="edge32" class="edge">
<title>expert_0_13&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3418.85,-10464.83C3416.04,-10464.44 3413.26,-10464.06 3410.5,-10463.71 3030.7,-10415.1 2585.55,-10392.88 2322.49,-10383.31"/>
<polygon fill="black" stroke="black" points="2322.55,-10379.81 2312.43,-10382.94 2322.3,-10386.8 2322.55,-10379.81"/>
</g>
<!-- expert_0_14 -->
<g id="node19" class="node">
<title>expert_0_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-10515.71 3682,-10515.71 3682,-10463.71 3927,-10463.71 3927,-10515.71"/>
<text text-anchor="middle" x="3804.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 14 Layer 0</text>
<text text-anchor="middle" x="3804.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 0)</text>
<text text-anchor="middle" x="3804.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_14&#45;&gt;agg_0 -->
<g id="edge34" class="edge">
<title>expert_0_14&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3681.85,-10464.79C3679.04,-10464.41 3676.26,-10464.05 3673.5,-10463.71 3193.37,-10404.94 2626.21,-10385.86 2319.23,-10379.67"/>
<polygon fill="black" stroke="black" points="2318.94,-10376.16 2308.87,-10379.46 2318.8,-10383.16 2318.94,-10376.16"/>
</g>
<!-- expert_0_15 -->
<g id="node20" class="node">
<title>expert_0_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-10515.71 3945,-10515.71 3945,-10463.71 4190,-10463.71 4190,-10515.71"/>
<text text-anchor="middle" x="4067.5" y="-10503.71" font-family="Arial" font-size="10.00">Expert 15 Layer 0</text>
<text text-anchor="middle" x="4067.5" y="-10492.71" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 0)</text>
<text text-anchor="middle" x="4067.5" y="-10481.71" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-10470.71" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_0_15&#45;&gt;agg_0 -->
<g id="edge36" class="edge">
<title>expert_0_15&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3944.86,-10464.76C3942.05,-10464.39 3939.26,-10464.04 3936.5,-10463.71 3354.67,-10394.8 2663.37,-10379.96 2316.45,-10377.09"/>
<polygon fill="black" stroke="black" points="2316.31,-10373.59 2306.29,-10377.01 2316.26,-10380.59 2316.31,-10373.59"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_0 -->
<g id="edge5" class="edge">
<title>all2all_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" d="M1915.5,-10583.92C1522.04,-10575.53 590.94,-10552.54 255.38,-10515.84"/>
<polygon fill="black" stroke="black" points="255.47,-10512.33 245.14,-10514.69 254.69,-10519.28 255.47,-10512.33"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_1 -->
<g id="edge7" class="edge">
<title>all2all_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" d="M1913.96,-10587.65C1622.01,-10586.06 1028.27,-10575.09 518.28,-10515.85"/>
<polygon fill="black" stroke="black" points="518.48,-10512.35 508.14,-10514.67 517.67,-10519.31 518.48,-10512.35"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_2 -->
<g id="edge9" class="edge">
<title>all2all_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" d="M1914.63,-10585.29C1662.79,-10580.5 1190.87,-10565.27 781.12,-10515.85"/>
<polygon fill="black" stroke="black" points="781.5,-10512.37 771.15,-10514.63 780.65,-10519.31 781.5,-10512.37"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_3 -->
<g id="edge11" class="edge">
<title>all2all_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" d="M1917.03,-10581.9C1709.64,-10573.88 1356.12,-10555.59 1044.3,-10515.88"/>
<polygon fill="black" stroke="black" points="1044.52,-10512.38 1034.15,-10514.58 1043.63,-10519.33 1044.52,-10512.38"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_4 -->
<g id="edge13" class="edge">
<title>all2all_0&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" d="M1923.49,-10576.77C1765.73,-10565.77 1524.89,-10546.11 1307.19,-10515.9"/>
<polygon fill="black" stroke="black" points="1307.55,-10512.42 1297.17,-10514.5 1306.58,-10519.35 1307.55,-10512.42"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_5 -->
<g id="edge15" class="edge">
<title>all2all_0&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" d="M1941.98,-10568.84C1839.48,-10555.79 1701.14,-10537.19 1570.39,-10515.99"/>
<polygon fill="black" stroke="black" points="1570.62,-10512.48 1560.19,-10514.33 1569.5,-10519.39 1570.62,-10512.48"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_6 -->
<g id="edge17" class="edge">
<title>all2all_0&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" d="M1981.6,-10559.75C1928.4,-10546.69 1865.13,-10531.15 1812.1,-10518.12"/>
<polygon fill="black" stroke="black" points="1812.87,-10514.71 1802.32,-10515.72 1811.2,-10521.5 1812.87,-10514.71"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_7 -->
<g id="edge19" class="edge">
<title>all2all_0&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" d="M2047.58,-10552.82C2033.84,-10542.67 2018.91,-10531.64 2005.49,-10521.73"/>
<polygon fill="black" stroke="black" points="2007.49,-10518.85 1997.36,-10515.73 2003.33,-10524.48 2007.49,-10518.85"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_8 -->
<g id="edge21" class="edge">
<title>all2all_0&#45;&gt;expert_0_8</title>
<path fill="none" stroke="black" d="M2141.78,-10552.82C2155.63,-10542.67 2170.67,-10531.64 2184.19,-10521.73"/>
<polygon fill="black" stroke="black" points="2186.38,-10524.46 2192.38,-10515.73 2182.25,-10518.82 2186.38,-10524.46"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_9 -->
<g id="edge23" class="edge">
<title>all2all_0&#45;&gt;expert_0_9</title>
<path fill="none" stroke="black" d="M2207.43,-10559.82C2260.77,-10546.75 2324.25,-10531.2 2377.47,-10518.16"/>
<polygon fill="black" stroke="black" points="2378.41,-10521.53 2387.29,-10515.75 2376.74,-10514.73 2378.41,-10521.53"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_10 -->
<g id="edge25" class="edge">
<title>all2all_0&#45;&gt;expert_0_10</title>
<path fill="none" stroke="black" d="M2247.31,-10568.85C2350.01,-10555.82 2488.61,-10537.21 2619.59,-10516"/>
<polygon fill="black" stroke="black" points="2620.5,-10519.39 2629.81,-10514.33 2619.38,-10512.48 2620.5,-10519.39"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_11 -->
<g id="edge27" class="edge">
<title>all2all_0&#45;&gt;expert_0_11</title>
<path fill="none" stroke="black" d="M2265.73,-10576.79C2423.69,-10565.79 2664.83,-10546.14 2882.8,-10515.9"/>
<polygon fill="black" stroke="black" points="2883.42,-10519.35 2892.84,-10514.5 2882.45,-10512.42 2883.42,-10519.35"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_12 -->
<g id="edge29" class="edge">
<title>all2all_0&#45;&gt;expert_0_12</title>
<path fill="none" stroke="black" d="M2272.14,-10581.91C2479.73,-10573.9 2833.58,-10555.62 3145.69,-10515.89"/>
<polygon fill="black" stroke="black" points="3146.37,-10519.33 3155.85,-10514.58 3145.48,-10512.38 3146.37,-10519.33"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_13 -->
<g id="edge31" class="edge">
<title>all2all_0&#45;&gt;expert_0_13</title>
<path fill="none" stroke="black" d="M2274.24,-10585.3C2526.2,-10580.53 2998.67,-10565.32 3408.87,-10515.85"/>
<polygon fill="black" stroke="black" points="3409.35,-10519.31 3418.85,-10514.63 3408.5,-10512.37 3409.35,-10519.31"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_14 -->
<g id="edge33" class="edge">
<title>all2all_0&#45;&gt;expert_0_14</title>
<path fill="none" stroke="black" d="M2274.85,-10587.66C2566.88,-10586.08 3161.23,-10575.14 3671.71,-10515.86"/>
<polygon fill="black" stroke="black" points="3672.33,-10519.31 3681.86,-10514.67 3671.52,-10512.35 3672.33,-10519.31"/>
</g>
<!-- all2all_0&#45;&gt;expert_0_15 -->
<g id="edge35" class="edge">
<title>all2all_0&#45;&gt;expert_0_15</title>
<path fill="none" stroke="black" d="M2273.6,-10583.92C2667.27,-10575.54 3598.88,-10552.55 3934.62,-10515.84"/>
<polygon fill="black" stroke="black" points="3935.31,-10519.28 3944.86,-10514.69 3934.53,-10512.33 3935.31,-10519.28"/>
</g>
<!-- attn_1 -->
<g id="node23" class="node">
<title>attn_1</title>
<polygon fill="lightblue" stroke="black" points="2235,-10287.71 1954,-10287.71 1954,-10235.71 2235,-10235.71 2235,-10287.71"/>
<text text-anchor="middle" x="2094.5" y="-10275.71" font-family="Arial" font-size="10.00">Attention Layer 1</text>
<text text-anchor="middle" x="2094.5" y="-10264.71" font-family="Arial" font-size="10.00">GPU: 1 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10253.71" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-10242.71" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_0&#45;&gt;attn_1 -->
<g id="edge37" class="edge">
<title>agg_0&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M2094.5,-10323.63C2094.5,-10314.96 2094.5,-10306.14 2094.5,-10298"/>
<polygon fill="black" stroke="black" points="2098,-10297.76 2094.5,-10287.76 2091,-10297.76 2098,-10297.76"/>
</g>
<!-- comm_attn_1 -->
<g id="node24" class="node">
<title>comm_attn_1</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-10162.94" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-10176.94" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-10165.94" font-family="Arial" font-size="10.00">GPU: 1 ↔ GPU: 2, 3, 4</text>
<text text-anchor="middle" x="2094.5" y="-10154.94" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10143.94" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_1&#45;&gt;comm_attn_1 -->
<g id="edge38" class="edge">
<title>attn_1&#45;&gt;comm_attn_1</title>
<path fill="none" stroke="black" d="M2094.5,-10235.54C2094.5,-10227.73 2094.5,-10218.87 2094.5,-10210.1"/>
<polygon fill="black" stroke="black" points="2098,-10209.92 2094.5,-10199.92 2091,-10209.92 2098,-10209.92"/>
</g>
<!-- gate_1 -->
<g id="node25" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-10090.17 1931.71,-10090.17 1818.95,-9986.17 2257.29,-9986.17 2370.05,-10090.17"/>
<text text-anchor="middle" x="2094.5" y="-10052.17" font-family="Arial" font-size="10.00">Expert Gate 1</text>
<text text-anchor="middle" x="2094.5" y="-10041.17" font-family="Arial" font-size="10.00">GPU: 1 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-10030.17" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-10019.17" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_1&#45;&gt;gate_1 -->
<g id="edge39" class="edge">
<title>comm_attn_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M2094.5,-10126.1C2094.5,-10118.07 2094.5,-10109.32 2094.5,-10100.57"/>
<polygon fill="black" stroke="black" points="2098,-10100.34 2094.5,-10090.34 2091,-10100.34 2098,-10100.34"/>
</g>
<!-- all2all_1 -->
<g id="node42" class="node">
<title>all2all_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-9913.4" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-9927.4" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-9916.4" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-9905.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9894.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_1&#45;&gt;all2all_1 -->
<g id="edge40" class="edge">
<title>gate_1&#45;&gt;all2all_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-9985.82C2094.5,-9977.41 2094.5,-9968.74 2094.5,-9960.47"/>
<polygon fill="black" stroke="black" points="2098,-9960.26 2094.5,-9950.26 2091,-9960.26 2098,-9960.26"/>
</g>
<!-- expert_1_0 -->
<g id="node26" class="node">
<title>expert_1_0</title>
<polygon fill="lightblue" stroke="black" points="245,-9840.63 0,-9840.63 0,-9788.63 245,-9788.63 245,-9840.63"/>
<text text-anchor="middle" x="122.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 0 Layer 1</text>
<text text-anchor="middle" x="122.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 0)</text>
<text text-anchor="middle" x="122.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_1 -->
<g id="node43" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-9752.63 1938.39,-9752.63 1830.26,-9648.63 2250.61,-9648.63 2358.74,-9752.63"/>
<text text-anchor="middle" x="2094.5" y="-9714.63" font-family="Arial" font-size="10.00">Expert Aggregation 1</text>
<text text-anchor="middle" x="2094.5" y="-9703.63" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-9692.63" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9681.63" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_0&#45;&gt;agg_1 -->
<g id="edge42" class="edge">
<title>expert_1_0&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M245.14,-9789.68C247.95,-9789.31 250.74,-9788.96 253.5,-9788.63 836.59,-9719.57 1529.68,-9704.82 1875.48,-9702"/>
<polygon fill="black" stroke="black" points="1875.63,-9705.5 1885.61,-9701.92 1875.58,-9698.5 1875.63,-9705.5"/>
</g>
<!-- expert_1_1 -->
<g id="node27" class="node">
<title>expert_1_1</title>
<polygon fill="lightblue" stroke="black" points="508,-9840.63 263,-9840.63 263,-9788.63 508,-9788.63 508,-9840.63"/>
<text text-anchor="middle" x="385.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 1 Layer 1</text>
<text text-anchor="middle" x="385.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 0)</text>
<text text-anchor="middle" x="385.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_1&#45;&gt;agg_1 -->
<g id="edge44" class="edge">
<title>expert_1_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M508.15,-9789.71C510.96,-9789.33 513.74,-9788.97 516.5,-9788.63 1000.37,-9729.39 1572.67,-9710.48 1877.6,-9704.45"/>
<polygon fill="black" stroke="black" points="1877.96,-9707.94 1887.89,-9704.25 1877.82,-9700.94 1877.96,-9707.94"/>
</g>
<!-- expert_1_2 -->
<g id="node28" class="node">
<title>expert_1_2</title>
<polygon fill="lightblue" stroke="black" points="771,-9840.63 526,-9840.63 526,-9788.63 771,-9788.63 771,-9840.63"/>
<text text-anchor="middle" x="648.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 2 Layer 1</text>
<text text-anchor="middle" x="648.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 0)</text>
<text text-anchor="middle" x="648.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_2&#45;&gt;agg_1 -->
<g id="edge46" class="edge">
<title>expert_1_2&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M771.15,-9789.76C773.96,-9789.36 776.74,-9788.99 779.5,-9788.63 1165.96,-9739.16 1620.14,-9717.01 1880.94,-9707.72"/>
<polygon fill="black" stroke="black" points="1881.42,-9711.21 1891.29,-9707.36 1881.17,-9704.21 1881.42,-9711.21"/>
</g>
<!-- expert_1_3 -->
<g id="node29" class="node">
<title>expert_1_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-9840.63 789,-9840.63 789,-9788.63 1034,-9788.63 1034,-9840.63"/>
<text text-anchor="middle" x="911.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 3 Layer 1</text>
<text text-anchor="middle" x="911.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 0)</text>
<text text-anchor="middle" x="911.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_3&#45;&gt;agg_1 -->
<g id="edge48" class="edge">
<title>expert_1_3&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1034.16,-9789.82C1036.96,-9789.4 1039.75,-9789.01 1042.5,-9788.63 1333.63,-9748.93 1672.73,-9724.83 1885.52,-9712.37"/>
<polygon fill="black" stroke="black" points="1885.78,-9715.86 1895.56,-9711.78 1885.37,-9708.87 1885.78,-9715.86"/>
</g>
<!-- expert_1_4 -->
<g id="node30" class="node">
<title>expert_1_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-9840.63 1052,-9840.63 1052,-9788.63 1297,-9788.63 1297,-9840.63"/>
<text text-anchor="middle" x="1174.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 4 Layer 1</text>
<text text-anchor="middle" x="1174.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 0)</text>
<text text-anchor="middle" x="1174.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_4&#45;&gt;agg_1 -->
<g id="edge50" class="edge">
<title>expert_1_4&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1297.18,-9789.92C1299.97,-9789.48 1302.75,-9789.05 1305.5,-9788.63 1504.19,-9758.77 1732.48,-9734.7 1892.21,-9719.52"/>
<polygon fill="black" stroke="black" points="1893.01,-9722.96 1902.63,-9718.53 1892.35,-9715.99 1893.01,-9722.96"/>
</g>
<!-- expert_1_5 -->
<g id="node31" class="node">
<title>expert_1_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-9840.63 1315,-9840.63 1315,-9788.63 1560,-9788.63 1560,-9840.63"/>
<text text-anchor="middle" x="1437.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 5 Layer 1</text>
<text text-anchor="middle" x="1437.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 0)</text>
<text text-anchor="middle" x="1437.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_5&#45;&gt;agg_1 -->
<g id="edge52" class="edge">
<title>expert_1_5&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1560.21,-9790.12C1563,-9789.62 1565.76,-9789.12 1568.5,-9788.63 1679.84,-9768.81 1804.72,-9748.09 1904.85,-9731.84"/>
<polygon fill="black" stroke="black" points="1905.46,-9735.29 1914.77,-9730.24 1904.34,-9728.38 1905.46,-9735.29"/>
</g>
<!-- expert_1_6 -->
<g id="node32" class="node">
<title>expert_1_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-9840.63 1578,-9840.63 1578,-9788.63 1823,-9788.63 1823,-9840.63"/>
<text text-anchor="middle" x="1700.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 6 Layer 1</text>
<text text-anchor="middle" x="1700.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 0)</text>
<text text-anchor="middle" x="1700.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_6&#45;&gt;agg_1 -->
<g id="edge54" class="edge">
<title>expert_1_6&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1788.92,-9788.5C1828.53,-9777.24 1876.66,-9763.56 1922.89,-9750.42"/>
<polygon fill="black" stroke="black" points="1924.06,-9753.72 1932.72,-9747.62 1922.14,-9746.99 1924.06,-9753.72"/>
</g>
<!-- expert_1_7 -->
<g id="node33" class="node">
<title>expert_1_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-9840.63 1841,-9840.63 1841,-9788.63 2086,-9788.63 2086,-9840.63"/>
<text text-anchor="middle" x="1963.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 7 Layer 1</text>
<text text-anchor="middle" x="1963.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 0)</text>
<text text-anchor="middle" x="1963.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_7&#45;&gt;agg_1 -->
<g id="edge56" class="edge">
<title>expert_1_7&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1992.9,-9788.5C2003.05,-9779.82 2014.88,-9769.71 2026.8,-9759.51"/>
<polygon fill="black" stroke="black" points="2029.31,-9761.97 2034.64,-9752.81 2024.76,-9756.65 2029.31,-9761.97"/>
</g>
<!-- expert_1_8 -->
<g id="node34" class="node">
<title>expert_1_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-9840.63 2104,-9840.63 2104,-9788.63 2349,-9788.63 2349,-9840.63"/>
<text text-anchor="middle" x="2226.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 8 Layer 1</text>
<text text-anchor="middle" x="2226.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 0)</text>
<text text-anchor="middle" x="2226.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_8&#45;&gt;agg_1 -->
<g id="edge58" class="edge">
<title>expert_1_8&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2196.88,-9788.5C2186.65,-9779.82 2174.73,-9769.71 2162.71,-9759.51"/>
<polygon fill="black" stroke="black" points="2164.71,-9756.61 2154.82,-9752.81 2160.18,-9761.95 2164.71,-9756.61"/>
</g>
<!-- expert_1_9 -->
<g id="node35" class="node">
<title>expert_1_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-9840.63 2367,-9840.63 2367,-9788.63 2612,-9788.63 2612,-9840.63"/>
<text text-anchor="middle" x="2489.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 9 Layer 1</text>
<text text-anchor="middle" x="2489.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 0)</text>
<text text-anchor="middle" x="2489.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_9&#45;&gt;agg_1 -->
<g id="edge60" class="edge">
<title>expert_1_9&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2400.85,-9788.5C2366.21,-9778.68 2325.08,-9767.01 2284.37,-9755.47"/>
<polygon fill="black" stroke="black" points="2285.17,-9752.06 2274.6,-9752.7 2283.26,-9758.79 2285.17,-9752.06"/>
</g>
<!-- expert_1_10 -->
<g id="node36" class="node">
<title>expert_1_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-9840.63 2630,-9840.63 2630,-9788.63 2875,-9788.63 2875,-9840.63"/>
<text text-anchor="middle" x="2752.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 10 Layer 1</text>
<text text-anchor="middle" x="2752.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 0)</text>
<text text-anchor="middle" x="2752.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_10&#45;&gt;agg_1 -->
<g id="edge62" class="edge">
<title>expert_1_10&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2629.79,-9790.12C2627,-9789.62 2624.24,-9789.12 2621.5,-9788.63 2535.88,-9773.4 2442.26,-9757.65 2357.99,-9743.81"/>
<polygon fill="black" stroke="black" points="2358.47,-9740.34 2348.03,-9742.17 2357.33,-9747.25 2358.47,-9740.34"/>
</g>
<!-- expert_1_11 -->
<g id="node37" class="node">
<title>expert_1_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-9840.63 2893,-9840.63 2893,-9788.63 3138,-9788.63 3138,-9840.63"/>
<text text-anchor="middle" x="3015.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 11 Layer 1</text>
<text text-anchor="middle" x="3015.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 0)</text>
<text text-anchor="middle" x="3015.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_11&#45;&gt;agg_1 -->
<g id="edge64" class="edge">
<title>expert_1_11&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2892.82,-9789.92C2890.03,-9789.48 2887.25,-9789.05 2884.5,-9788.63 2701.91,-9761.2 2494.36,-9738.68 2337.83,-9723.42"/>
<polygon fill="black" stroke="black" points="2337.88,-9719.91 2327.59,-9722.43 2337.21,-9726.88 2337.88,-9719.91"/>
</g>
<!-- expert_1_12 -->
<g id="node38" class="node">
<title>expert_1_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-9840.63 3156,-9840.63 3156,-9788.63 3401,-9788.63 3401,-9840.63"/>
<text text-anchor="middle" x="3278.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 12 Layer 1</text>
<text text-anchor="middle" x="3278.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 0)</text>
<text text-anchor="middle" x="3278.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_12&#45;&gt;agg_1 -->
<g id="edge66" class="edge">
<title>expert_1_12&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3155.84,-9789.82C3153.04,-9789.4 3150.25,-9789.01 3147.5,-9788.63 2866.94,-9750.38 2541.87,-9726.63 2327.98,-9713.8"/>
<polygon fill="black" stroke="black" points="2328.07,-9710.3 2317.87,-9713.19 2327.65,-9717.28 2328.07,-9710.3"/>
</g>
<!-- expert_1_13 -->
<g id="node39" class="node">
<title>expert_1_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-9840.63 3419,-9840.63 3419,-9788.63 3664,-9788.63 3664,-9840.63"/>
<text text-anchor="middle" x="3541.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 13 Layer 1</text>
<text text-anchor="middle" x="3541.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 0)</text>
<text text-anchor="middle" x="3541.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_13&#45;&gt;agg_1 -->
<g id="edge68" class="edge">
<title>expert_1_13&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3418.85,-9789.75C3416.04,-9789.36 3413.26,-9788.99 3410.5,-9788.63 3030.7,-9740.03 2585.55,-9717.8 2322.49,-9708.23"/>
<polygon fill="black" stroke="black" points="2322.55,-9704.73 2312.43,-9707.87 2322.3,-9711.72 2322.55,-9704.73"/>
</g>
<!-- expert_1_14 -->
<g id="node40" class="node">
<title>expert_1_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-9840.63 3682,-9840.63 3682,-9788.63 3927,-9788.63 3927,-9840.63"/>
<text text-anchor="middle" x="3804.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 14 Layer 1</text>
<text text-anchor="middle" x="3804.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 0)</text>
<text text-anchor="middle" x="3804.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_14&#45;&gt;agg_1 -->
<g id="edge70" class="edge">
<title>expert_1_14&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3681.85,-9789.71C3679.04,-9789.33 3676.26,-9788.97 3673.5,-9788.63 3193.37,-9729.86 2626.21,-9710.78 2319.23,-9704.59"/>
<polygon fill="black" stroke="black" points="2318.94,-9701.09 2308.87,-9704.39 2318.8,-9708.08 2318.94,-9701.09"/>
</g>
<!-- expert_1_15 -->
<g id="node41" class="node">
<title>expert_1_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-9840.63 3945,-9840.63 3945,-9788.63 4190,-9788.63 4190,-9840.63"/>
<text text-anchor="middle" x="4067.5" y="-9828.63" font-family="Arial" font-size="10.00">Expert 15 Layer 1</text>
<text text-anchor="middle" x="4067.5" y="-9817.63" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 0)</text>
<text text-anchor="middle" x="4067.5" y="-9806.63" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-9795.63" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_1_15&#45;&gt;agg_1 -->
<g id="edge72" class="edge">
<title>expert_1_15&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3944.86,-9789.68C3942.05,-9789.31 3939.26,-9788.96 3936.5,-9788.63 3354.67,-9719.73 2663.37,-9704.88 2316.45,-9702.01"/>
<polygon fill="black" stroke="black" points="2316.31,-9698.51 2306.29,-9701.93 2316.26,-9705.51 2316.31,-9698.51"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_0 -->
<g id="edge41" class="edge">
<title>all2all_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M1915.5,-9908.84C1522.04,-9900.46 590.94,-9877.46 255.38,-9840.76"/>
<polygon fill="black" stroke="black" points="255.47,-9837.25 245.14,-9839.61 254.69,-9844.2 255.47,-9837.25"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_1 -->
<g id="edge43" class="edge">
<title>all2all_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M1913.96,-9912.57C1622.01,-9910.98 1028.27,-9900.01 518.28,-9840.78"/>
<polygon fill="black" stroke="black" points="518.48,-9837.28 508.14,-9839.59 517.67,-9844.23 518.48,-9837.28"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_2 -->
<g id="edge45" class="edge">
<title>all2all_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M1914.63,-9910.21C1662.79,-9905.42 1190.87,-9890.19 781.12,-9840.77"/>
<polygon fill="black" stroke="black" points="781.5,-9837.29 771.15,-9839.56 780.65,-9844.24 781.5,-9837.29"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_3 -->
<g id="edge47" class="edge">
<title>all2all_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M1917.03,-9906.82C1709.64,-9898.8 1356.12,-9880.51 1044.3,-9840.81"/>
<polygon fill="black" stroke="black" points="1044.52,-9837.31 1034.15,-9839.51 1043.63,-9844.25 1044.52,-9837.31"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_4 -->
<g id="edge49" class="edge">
<title>all2all_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M1923.49,-9901.7C1765.73,-9890.69 1524.89,-9871.03 1307.19,-9840.82"/>
<polygon fill="black" stroke="black" points="1307.55,-9837.34 1297.17,-9839.42 1306.58,-9844.27 1307.55,-9837.34"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_5 -->
<g id="edge51" class="edge">
<title>all2all_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M1941.98,-9893.76C1839.48,-9880.72 1701.14,-9862.11 1570.39,-9840.91"/>
<polygon fill="black" stroke="black" points="1570.62,-9837.41 1560.19,-9839.25 1569.5,-9844.31 1570.62,-9837.41"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_6 -->
<g id="edge53" class="edge">
<title>all2all_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M1981.6,-9884.67C1928.4,-9871.61 1865.13,-9856.07 1812.1,-9843.04"/>
<polygon fill="black" stroke="black" points="1812.87,-9839.63 1802.32,-9840.64 1811.2,-9846.43 1812.87,-9839.63"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_7 -->
<g id="edge55" class="edge">
<title>all2all_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M2047.58,-9877.74C2033.84,-9867.59 2018.91,-9856.56 2005.49,-9846.65"/>
<polygon fill="black" stroke="black" points="2007.49,-9843.77 1997.36,-9840.65 2003.33,-9849.4 2007.49,-9843.77"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_8 -->
<g id="edge57" class="edge">
<title>all2all_1&#45;&gt;expert_1_8</title>
<path fill="none" stroke="black" d="M2141.78,-9877.74C2155.63,-9867.59 2170.67,-9856.56 2184.19,-9846.65"/>
<polygon fill="black" stroke="black" points="2186.38,-9849.38 2192.38,-9840.65 2182.25,-9843.74 2186.38,-9849.38"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_9 -->
<g id="edge59" class="edge">
<title>all2all_1&#45;&gt;expert_1_9</title>
<path fill="none" stroke="black" d="M2207.43,-9884.74C2260.77,-9871.67 2324.25,-9856.12 2377.47,-9843.08"/>
<polygon fill="black" stroke="black" points="2378.41,-9846.45 2387.29,-9840.67 2376.74,-9839.65 2378.41,-9846.45"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_10 -->
<g id="edge61" class="edge">
<title>all2all_1&#45;&gt;expert_1_10</title>
<path fill="none" stroke="black" d="M2247.31,-9893.78C2350.01,-9880.74 2488.61,-9862.14 2619.59,-9840.92"/>
<polygon fill="black" stroke="black" points="2620.5,-9844.31 2629.81,-9839.25 2619.38,-9837.41 2620.5,-9844.31"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_11 -->
<g id="edge63" class="edge">
<title>all2all_1&#45;&gt;expert_1_11</title>
<path fill="none" stroke="black" d="M2265.73,-9901.71C2423.69,-9890.71 2664.83,-9871.06 2882.8,-9840.82"/>
<polygon fill="black" stroke="black" points="2883.42,-9844.27 2892.84,-9839.42 2882.45,-9837.34 2883.42,-9844.27"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_12 -->
<g id="edge65" class="edge">
<title>all2all_1&#45;&gt;expert_1_12</title>
<path fill="none" stroke="black" d="M2272.14,-9906.83C2479.73,-9898.82 2833.58,-9880.54 3145.69,-9840.81"/>
<polygon fill="black" stroke="black" points="3146.37,-9844.25 3155.85,-9839.51 3145.48,-9837.31 3146.37,-9844.25"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_13 -->
<g id="edge67" class="edge">
<title>all2all_1&#45;&gt;expert_1_13</title>
<path fill="none" stroke="black" d="M2274.24,-9910.22C2526.2,-9905.45 2998.67,-9890.24 3408.87,-9840.77"/>
<polygon fill="black" stroke="black" points="3409.35,-9844.24 3418.85,-9839.56 3408.5,-9837.29 3409.35,-9844.24"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_14 -->
<g id="edge69" class="edge">
<title>all2all_1&#45;&gt;expert_1_14</title>
<path fill="none" stroke="black" d="M2274.85,-9912.58C2566.88,-9911 3161.23,-9900.06 3671.71,-9840.78"/>
<polygon fill="black" stroke="black" points="3672.33,-9844.23 3681.86,-9839.59 3671.52,-9837.28 3672.33,-9844.23"/>
</g>
<!-- all2all_1&#45;&gt;expert_1_15 -->
<g id="edge71" class="edge">
<title>all2all_1&#45;&gt;expert_1_15</title>
<path fill="none" stroke="black" d="M2273.6,-9908.84C2667.27,-9900.46 3598.88,-9877.47 3934.62,-9840.76"/>
<polygon fill="black" stroke="black" points="3935.31,-9844.2 3944.86,-9839.61 3934.53,-9837.25 3935.31,-9844.2"/>
</g>
<!-- attn_2 -->
<g id="node44" class="node">
<title>attn_2</title>
<polygon fill="lightblue" stroke="black" points="2235,-9612.63 1954,-9612.63 1954,-9560.63 2235,-9560.63 2235,-9612.63"/>
<text text-anchor="middle" x="2094.5" y="-9600.63" font-family="Arial" font-size="10.00">Attention Layer 2</text>
<text text-anchor="middle" x="2094.5" y="-9589.63" font-family="Arial" font-size="10.00">GPU: 2 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-9578.63" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-9567.63" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_1&#45;&gt;attn_2 -->
<g id="edge73" class="edge">
<title>agg_1&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M2094.5,-9648.55C2094.5,-9639.89 2094.5,-9631.06 2094.5,-9622.92"/>
<polygon fill="black" stroke="black" points="2098,-9622.68 2094.5,-9612.68 2091,-9622.68 2098,-9622.68"/>
</g>
<!-- comm_attn_2 -->
<g id="node45" class="node">
<title>comm_attn_2</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-9487.86" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-9501.86" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-9490.86" font-family="Arial" font-size="10.00">GPU: 2 ↔ GPU: 3, 4, 5</text>
<text text-anchor="middle" x="2094.5" y="-9479.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9468.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_2&#45;&gt;comm_attn_2 -->
<g id="edge74" class="edge">
<title>attn_2&#45;&gt;comm_attn_2</title>
<path fill="none" stroke="black" d="M2094.5,-9560.46C2094.5,-9552.65 2094.5,-9543.79 2094.5,-9535.02"/>
<polygon fill="black" stroke="black" points="2098,-9534.84 2094.5,-9524.84 2091,-9534.84 2098,-9534.84"/>
</g>
<!-- gate_2 -->
<g id="node46" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-9415.09 1931.71,-9415.09 1818.95,-9311.09 2257.29,-9311.09 2370.05,-9415.09"/>
<text text-anchor="middle" x="2094.5" y="-9377.09" font-family="Arial" font-size="10.00">Expert Gate 2</text>
<text text-anchor="middle" x="2094.5" y="-9366.09" font-family="Arial" font-size="10.00">GPU: 2 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-9355.09" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9344.09" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_2&#45;&gt;gate_2 -->
<g id="edge75" class="edge">
<title>comm_attn_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M2094.5,-9451.02C2094.5,-9442.99 2094.5,-9434.24 2094.5,-9425.49"/>
<polygon fill="black" stroke="black" points="2098,-9425.26 2094.5,-9415.26 2091,-9425.26 2098,-9425.26"/>
</g>
<!-- all2all_2 -->
<g id="node63" class="node">
<title>all2all_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-9238.33" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-9252.33" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-9241.33" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-9230.33" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9219.33" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_2&#45;&gt;all2all_2 -->
<g id="edge76" class="edge">
<title>gate_2&#45;&gt;all2all_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-9310.74C2094.5,-9302.33 2094.5,-9293.67 2094.5,-9285.4"/>
<polygon fill="black" stroke="black" points="2098,-9285.18 2094.5,-9275.18 2091,-9285.18 2098,-9285.18"/>
</g>
<!-- expert_2_0 -->
<g id="node47" class="node">
<title>expert_2_0</title>
<polygon fill="lightblue" stroke="black" points="245,-9165.56 0,-9165.56 0,-9113.56 245,-9113.56 245,-9165.56"/>
<text text-anchor="middle" x="122.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 0 Layer 2</text>
<text text-anchor="middle" x="122.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 1)</text>
<text text-anchor="middle" x="122.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_2 -->
<g id="node64" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-9077.56 1938.39,-9077.56 1830.26,-8973.56 2250.61,-8973.56 2358.74,-9077.56"/>
<text text-anchor="middle" x="2094.5" y="-9039.56" font-family="Arial" font-size="10.00">Expert Aggregation 2</text>
<text text-anchor="middle" x="2094.5" y="-9028.56" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-9017.56" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-9006.56" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_0&#45;&gt;agg_2 -->
<g id="edge78" class="edge">
<title>expert_2_0&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M245.14,-9114.61C247.95,-9114.23 250.74,-9113.88 253.5,-9113.56 836.59,-9044.49 1529.68,-9029.74 1875.48,-9026.92"/>
<polygon fill="black" stroke="black" points="1875.63,-9030.42 1885.61,-9026.84 1875.58,-9023.42 1875.63,-9030.42"/>
</g>
<!-- expert_2_1 -->
<g id="node48" class="node">
<title>expert_2_1</title>
<polygon fill="lightblue" stroke="black" points="508,-9165.56 263,-9165.56 263,-9113.56 508,-9113.56 508,-9165.56"/>
<text text-anchor="middle" x="385.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 1 Layer 2</text>
<text text-anchor="middle" x="385.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 1)</text>
<text text-anchor="middle" x="385.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_1&#45;&gt;agg_2 -->
<g id="edge80" class="edge">
<title>expert_2_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M508.15,-9114.64C510.96,-9114.25 513.74,-9113.89 516.5,-9113.56 1000.37,-9054.32 1572.67,-9035.4 1877.6,-9029.37"/>
<polygon fill="black" stroke="black" points="1877.96,-9032.86 1887.89,-9029.17 1877.82,-9025.86 1877.96,-9032.86"/>
</g>
<!-- expert_2_2 -->
<g id="node49" class="node">
<title>expert_2_2</title>
<polygon fill="lightblue" stroke="black" points="771,-9165.56 526,-9165.56 526,-9113.56 771,-9113.56 771,-9165.56"/>
<text text-anchor="middle" x="648.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 2 Layer 2</text>
<text text-anchor="middle" x="648.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 1)</text>
<text text-anchor="middle" x="648.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_2&#45;&gt;agg_2 -->
<g id="edge82" class="edge">
<title>expert_2_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M771.15,-9114.68C773.96,-9114.28 776.74,-9113.91 779.5,-9113.56 1165.96,-9064.08 1620.14,-9041.93 1880.94,-9032.65"/>
<polygon fill="black" stroke="black" points="1881.42,-9036.13 1891.29,-9032.28 1881.17,-9029.14 1881.42,-9036.13"/>
</g>
<!-- expert_2_3 -->
<g id="node50" class="node">
<title>expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-9165.56 789,-9165.56 789,-9113.56 1034,-9113.56 1034,-9165.56"/>
<text text-anchor="middle" x="911.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 3 Layer 2</text>
<text text-anchor="middle" x="911.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 1)</text>
<text text-anchor="middle" x="911.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_3&#45;&gt;agg_2 -->
<g id="edge84" class="edge">
<title>expert_2_3&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1034.16,-9114.74C1036.96,-9114.33 1039.75,-9113.93 1042.5,-9113.56 1333.63,-9073.85 1672.73,-9049.76 1885.52,-9037.29"/>
<polygon fill="black" stroke="black" points="1885.78,-9040.78 1895.56,-9036.71 1885.37,-9033.79 1885.78,-9040.78"/>
</g>
<!-- expert_2_4 -->
<g id="node51" class="node">
<title>expert_2_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-9165.56 1052,-9165.56 1052,-9113.56 1297,-9113.56 1297,-9165.56"/>
<text text-anchor="middle" x="1174.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 4 Layer 2</text>
<text text-anchor="middle" x="1174.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 1)</text>
<text text-anchor="middle" x="1174.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_4&#45;&gt;agg_2 -->
<g id="edge86" class="edge">
<title>expert_2_4&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1297.18,-9114.84C1299.97,-9114.4 1302.75,-9113.97 1305.5,-9113.56 1504.19,-9083.69 1732.48,-9059.62 1892.21,-9044.44"/>
<polygon fill="black" stroke="black" points="1893.01,-9047.88 1902.63,-9043.45 1892.35,-9040.91 1893.01,-9047.88"/>
</g>
<!-- expert_2_5 -->
<g id="node52" class="node">
<title>expert_2_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-9165.56 1315,-9165.56 1315,-9113.56 1560,-9113.56 1560,-9165.56"/>
<text text-anchor="middle" x="1437.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 5 Layer 2</text>
<text text-anchor="middle" x="1437.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 1)</text>
<text text-anchor="middle" x="1437.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_5&#45;&gt;agg_2 -->
<g id="edge88" class="edge">
<title>expert_2_5&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1560.21,-9115.04C1563,-9114.54 1565.76,-9114.04 1568.5,-9113.56 1679.84,-9093.73 1804.72,-9073.01 1904.85,-9056.77"/>
<polygon fill="black" stroke="black" points="1905.46,-9060.21 1914.77,-9055.16 1904.34,-9053.3 1905.46,-9060.21"/>
</g>
<!-- expert_2_6 -->
<g id="node53" class="node">
<title>expert_2_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-9165.56 1578,-9165.56 1578,-9113.56 1823,-9113.56 1823,-9165.56"/>
<text text-anchor="middle" x="1700.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 6 Layer 2</text>
<text text-anchor="middle" x="1700.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 1)</text>
<text text-anchor="middle" x="1700.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_6&#45;&gt;agg_2 -->
<g id="edge90" class="edge">
<title>expert_2_6&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1788.92,-9113.42C1828.53,-9102.16 1876.66,-9088.48 1922.89,-9075.34"/>
<polygon fill="black" stroke="black" points="1924.06,-9078.65 1932.72,-9072.54 1922.14,-9071.91 1924.06,-9078.65"/>
</g>
<!-- expert_2_7 -->
<g id="node54" class="node">
<title>expert_2_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-9165.56 1841,-9165.56 1841,-9113.56 2086,-9113.56 2086,-9165.56"/>
<text text-anchor="middle" x="1963.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 7 Layer 2</text>
<text text-anchor="middle" x="1963.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 1)</text>
<text text-anchor="middle" x="1963.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_7&#45;&gt;agg_2 -->
<g id="edge92" class="edge">
<title>expert_2_7&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1992.9,-9113.42C2003.05,-9104.74 2014.88,-9094.63 2026.8,-9084.43"/>
<polygon fill="black" stroke="black" points="2029.31,-9086.89 2034.64,-9077.73 2024.76,-9081.57 2029.31,-9086.89"/>
</g>
<!-- expert_2_8 -->
<g id="node55" class="node">
<title>expert_2_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-9165.56 2104,-9165.56 2104,-9113.56 2349,-9113.56 2349,-9165.56"/>
<text text-anchor="middle" x="2226.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 8 Layer 2</text>
<text text-anchor="middle" x="2226.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 1)</text>
<text text-anchor="middle" x="2226.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_8&#45;&gt;agg_2 -->
<g id="edge94" class="edge">
<title>expert_2_8&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2196.88,-9113.42C2186.65,-9104.74 2174.73,-9094.63 2162.71,-9084.43"/>
<polygon fill="black" stroke="black" points="2164.71,-9081.54 2154.82,-9077.73 2160.18,-9086.87 2164.71,-9081.54"/>
</g>
<!-- expert_2_9 -->
<g id="node56" class="node">
<title>expert_2_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-9165.56 2367,-9165.56 2367,-9113.56 2612,-9113.56 2612,-9165.56"/>
<text text-anchor="middle" x="2489.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 9 Layer 2</text>
<text text-anchor="middle" x="2489.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 1)</text>
<text text-anchor="middle" x="2489.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_9&#45;&gt;agg_2 -->
<g id="edge96" class="edge">
<title>expert_2_9&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2400.85,-9113.42C2366.21,-9103.6 2325.08,-9091.93 2284.37,-9080.39"/>
<polygon fill="black" stroke="black" points="2285.17,-9076.98 2274.6,-9077.62 2283.26,-9083.72 2285.17,-9076.98"/>
</g>
<!-- expert_2_10 -->
<g id="node57" class="node">
<title>expert_2_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-9165.56 2630,-9165.56 2630,-9113.56 2875,-9113.56 2875,-9165.56"/>
<text text-anchor="middle" x="2752.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 10 Layer 2</text>
<text text-anchor="middle" x="2752.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 1)</text>
<text text-anchor="middle" x="2752.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_10&#45;&gt;agg_2 -->
<g id="edge98" class="edge">
<title>expert_2_10&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2629.79,-9115.04C2627,-9114.54 2624.24,-9114.04 2621.5,-9113.56 2535.88,-9098.32 2442.26,-9082.57 2357.99,-9068.73"/>
<polygon fill="black" stroke="black" points="2358.47,-9065.26 2348.03,-9067.09 2357.33,-9072.17 2358.47,-9065.26"/>
</g>
<!-- expert_2_11 -->
<g id="node58" class="node">
<title>expert_2_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-9165.56 2893,-9165.56 2893,-9113.56 3138,-9113.56 3138,-9165.56"/>
<text text-anchor="middle" x="3015.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 11 Layer 2</text>
<text text-anchor="middle" x="3015.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 1)</text>
<text text-anchor="middle" x="3015.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_11&#45;&gt;agg_2 -->
<g id="edge100" class="edge">
<title>expert_2_11&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2892.82,-9114.84C2890.03,-9114.4 2887.25,-9113.97 2884.5,-9113.56 2701.91,-9086.12 2494.36,-9063.6 2337.83,-9048.35"/>
<polygon fill="black" stroke="black" points="2337.88,-9044.84 2327.59,-9047.35 2337.21,-9051.8 2337.88,-9044.84"/>
</g>
<!-- expert_2_12 -->
<g id="node59" class="node">
<title>expert_2_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-9165.56 3156,-9165.56 3156,-9113.56 3401,-9113.56 3401,-9165.56"/>
<text text-anchor="middle" x="3278.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 12 Layer 2</text>
<text text-anchor="middle" x="3278.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 1)</text>
<text text-anchor="middle" x="3278.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_12&#45;&gt;agg_2 -->
<g id="edge102" class="edge">
<title>expert_2_12&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3155.84,-9114.74C3153.04,-9114.33 3150.25,-9113.93 3147.5,-9113.56 2866.94,-9075.3 2541.87,-9051.55 2327.98,-9038.72"/>
<polygon fill="black" stroke="black" points="2328.07,-9035.22 2317.87,-9038.12 2327.65,-9042.21 2328.07,-9035.22"/>
</g>
<!-- expert_2_13 -->
<g id="node60" class="node">
<title>expert_2_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-9165.56 3419,-9165.56 3419,-9113.56 3664,-9113.56 3664,-9165.56"/>
<text text-anchor="middle" x="3541.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 13 Layer 2</text>
<text text-anchor="middle" x="3541.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 1)</text>
<text text-anchor="middle" x="3541.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_13&#45;&gt;agg_2 -->
<g id="edge104" class="edge">
<title>expert_2_13&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3418.85,-9114.68C3416.04,-9114.28 3413.26,-9113.91 3410.5,-9113.56 3030.7,-9064.95 2585.55,-9042.72 2322.49,-9033.15"/>
<polygon fill="black" stroke="black" points="2322.55,-9029.65 2312.43,-9032.79 2322.3,-9036.65 2322.55,-9029.65"/>
</g>
<!-- expert_2_14 -->
<g id="node61" class="node">
<title>expert_2_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-9165.56 3682,-9165.56 3682,-9113.56 3927,-9113.56 3927,-9165.56"/>
<text text-anchor="middle" x="3804.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 14 Layer 2</text>
<text text-anchor="middle" x="3804.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 1)</text>
<text text-anchor="middle" x="3804.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_14&#45;&gt;agg_2 -->
<g id="edge106" class="edge">
<title>expert_2_14&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3681.85,-9114.64C3679.04,-9114.25 3676.26,-9113.89 3673.5,-9113.56 3193.37,-9054.78 2626.21,-9035.7 2319.23,-9029.51"/>
<polygon fill="black" stroke="black" points="2318.94,-9026.01 2308.87,-9029.31 2318.8,-9033.01 2318.94,-9026.01"/>
</g>
<!-- expert_2_15 -->
<g id="node62" class="node">
<title>expert_2_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-9165.56 3945,-9165.56 3945,-9113.56 4190,-9113.56 4190,-9165.56"/>
<text text-anchor="middle" x="4067.5" y="-9153.56" font-family="Arial" font-size="10.00">Expert 15 Layer 2</text>
<text text-anchor="middle" x="4067.5" y="-9142.56" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 1)</text>
<text text-anchor="middle" x="4067.5" y="-9131.56" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-9120.56" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_2_15&#45;&gt;agg_2 -->
<g id="edge108" class="edge">
<title>expert_2_15&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3944.86,-9114.61C3942.05,-9114.23 3939.26,-9113.88 3936.5,-9113.56 3354.67,-9044.65 2663.37,-9029.8 2316.45,-9026.94"/>
<polygon fill="black" stroke="black" points="2316.31,-9023.43 2306.29,-9026.85 2316.26,-9030.43 2316.31,-9023.43"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_0 -->
<g id="edge77" class="edge">
<title>all2all_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M1915.5,-9233.76C1522.04,-9225.38 590.94,-9202.38 255.38,-9165.68"/>
<polygon fill="black" stroke="black" points="255.47,-9162.17 245.14,-9164.54 254.69,-9169.13 255.47,-9162.17"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_1 -->
<g id="edge79" class="edge">
<title>all2all_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M1913.96,-9237.49C1622.01,-9235.9 1028.27,-9224.93 518.28,-9165.7"/>
<polygon fill="black" stroke="black" points="518.48,-9162.2 508.14,-9164.51 517.67,-9169.15 518.48,-9162.2"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_2 -->
<g id="edge81" class="edge">
<title>all2all_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M1914.63,-9235.13C1662.79,-9230.34 1190.87,-9215.11 781.12,-9165.69"/>
<polygon fill="black" stroke="black" points="781.5,-9162.21 771.15,-9164.48 780.65,-9169.16 781.5,-9162.21"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_3 -->
<g id="edge83" class="edge">
<title>all2all_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M1917.03,-9231.74C1709.64,-9223.72 1356.12,-9205.44 1044.3,-9165.73"/>
<polygon fill="black" stroke="black" points="1044.52,-9162.23 1034.15,-9164.43 1043.63,-9169.17 1044.52,-9162.23"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_4 -->
<g id="edge85" class="edge">
<title>all2all_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M1923.49,-9226.62C1765.73,-9215.61 1524.89,-9195.96 1307.19,-9165.74"/>
<polygon fill="black" stroke="black" points="1307.55,-9162.26 1297.17,-9164.34 1306.58,-9169.19 1307.55,-9162.26"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_5 -->
<g id="edge87" class="edge">
<title>all2all_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M1941.98,-9218.68C1839.48,-9205.64 1701.14,-9187.04 1570.39,-9165.84"/>
<polygon fill="black" stroke="black" points="1570.62,-9162.33 1560.19,-9164.17 1569.5,-9169.24 1570.62,-9162.33"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_6 -->
<g id="edge89" class="edge">
<title>all2all_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M1981.6,-9209.6C1928.4,-9196.53 1865.13,-9180.99 1812.1,-9167.97"/>
<polygon fill="black" stroke="black" points="1812.87,-9164.55 1802.32,-9165.56 1811.2,-9171.35 1812.87,-9164.55"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_7 -->
<g id="edge91" class="edge">
<title>all2all_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M2047.58,-9202.66C2033.84,-9192.51 2018.91,-9181.48 2005.49,-9171.58"/>
<polygon fill="black" stroke="black" points="2007.49,-9168.7 1997.36,-9165.57 2003.33,-9174.33 2007.49,-9168.7"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_8 -->
<g id="edge93" class="edge">
<title>all2all_2&#45;&gt;expert_2_8</title>
<path fill="none" stroke="black" d="M2141.78,-9202.66C2155.63,-9192.51 2170.67,-9181.48 2184.19,-9171.58"/>
<polygon fill="black" stroke="black" points="2186.38,-9174.3 2192.38,-9165.57 2182.25,-9168.66 2186.38,-9174.3"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_9 -->
<g id="edge95" class="edge">
<title>all2all_2&#45;&gt;expert_2_9</title>
<path fill="none" stroke="black" d="M2207.43,-9209.66C2260.77,-9196.59 2324.25,-9181.04 2377.47,-9168"/>
<polygon fill="black" stroke="black" points="2378.41,-9171.38 2387.29,-9165.6 2376.74,-9164.58 2378.41,-9171.38"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_10 -->
<g id="edge97" class="edge">
<title>all2all_2&#45;&gt;expert_2_10</title>
<path fill="none" stroke="black" d="M2247.31,-9218.7C2350.01,-9205.66 2488.61,-9187.06 2619.59,-9165.84"/>
<polygon fill="black" stroke="black" points="2620.5,-9169.24 2629.81,-9164.18 2619.38,-9162.33 2620.5,-9169.24"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_11 -->
<g id="edge99" class="edge">
<title>all2all_2&#45;&gt;expert_2_11</title>
<path fill="none" stroke="black" d="M2265.73,-9226.63C2423.69,-9215.63 2664.83,-9195.98 2882.8,-9165.74"/>
<polygon fill="black" stroke="black" points="2883.42,-9169.19 2892.84,-9164.34 2882.45,-9162.26 2883.42,-9169.19"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_12 -->
<g id="edge101" class="edge">
<title>all2all_2&#45;&gt;expert_2_12</title>
<path fill="none" stroke="black" d="M2272.14,-9231.75C2479.73,-9223.74 2833.58,-9205.46 3145.69,-9165.73"/>
<polygon fill="black" stroke="black" points="3146.37,-9169.17 3155.85,-9164.43 3145.48,-9162.23 3146.37,-9169.17"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_13 -->
<g id="edge103" class="edge">
<title>all2all_2&#45;&gt;expert_2_13</title>
<path fill="none" stroke="black" d="M2274.24,-9235.14C2526.2,-9230.37 2998.67,-9215.16 3408.87,-9165.69"/>
<polygon fill="black" stroke="black" points="3409.35,-9169.16 3418.85,-9164.48 3408.5,-9162.21 3409.35,-9169.16"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_14 -->
<g id="edge105" class="edge">
<title>all2all_2&#45;&gt;expert_2_14</title>
<path fill="none" stroke="black" d="M2274.85,-9237.5C2566.88,-9235.92 3161.23,-9224.98 3671.71,-9165.7"/>
<polygon fill="black" stroke="black" points="3672.33,-9169.15 3681.86,-9164.51 3671.52,-9162.2 3672.33,-9169.15"/>
</g>
<!-- all2all_2&#45;&gt;expert_2_15 -->
<g id="edge107" class="edge">
<title>all2all_2&#45;&gt;expert_2_15</title>
<path fill="none" stroke="black" d="M2273.6,-9233.76C2667.27,-9225.38 3598.88,-9202.4 3934.62,-9165.68"/>
<polygon fill="black" stroke="black" points="3935.31,-9169.13 3944.86,-9164.54 3934.53,-9162.17 3935.31,-9169.13"/>
</g>
<!-- attn_3 -->
<g id="node65" class="node">
<title>attn_3</title>
<polygon fill="lightblue" stroke="black" points="2235,-8937.56 1954,-8937.56 1954,-8885.56 2235,-8885.56 2235,-8937.56"/>
<text text-anchor="middle" x="2094.5" y="-8925.56" font-family="Arial" font-size="10.00">Attention Layer 3</text>
<text text-anchor="middle" x="2094.5" y="-8914.56" font-family="Arial" font-size="10.00">GPU: 3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-8903.56" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-8892.56" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_2&#45;&gt;attn_3 -->
<g id="edge109" class="edge">
<title>agg_2&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M2094.5,-8973.47C2094.5,-8964.81 2094.5,-8955.98 2094.5,-8947.84"/>
<polygon fill="black" stroke="black" points="2098,-8947.6 2094.5,-8937.6 2091,-8947.6 2098,-8947.6"/>
</g>
<!-- comm_attn_3 -->
<g id="node66" class="node">
<title>comm_attn_3</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-8812.79" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-8826.79" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-8815.79" font-family="Arial" font-size="10.00">GPU: 3 ↔ GPU: 4, 5, 6</text>
<text text-anchor="middle" x="2094.5" y="-8804.79" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-8793.79" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_3&#45;&gt;comm_attn_3 -->
<g id="edge110" class="edge">
<title>attn_3&#45;&gt;comm_attn_3</title>
<path fill="none" stroke="black" d="M2094.5,-8885.38C2094.5,-8877.57 2094.5,-8868.71 2094.5,-8859.94"/>
<polygon fill="black" stroke="black" points="2098,-8859.76 2094.5,-8849.76 2091,-8859.76 2098,-8859.76"/>
</g>
<!-- gate_3 -->
<g id="node67" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-8740.02 1931.71,-8740.02 1818.95,-8636.02 2257.29,-8636.02 2370.05,-8740.02"/>
<text text-anchor="middle" x="2094.5" y="-8702.02" font-family="Arial" font-size="10.00">Expert Gate 3</text>
<text text-anchor="middle" x="2094.5" y="-8691.02" font-family="Arial" font-size="10.00">GPU: 3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-8680.02" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-8669.02" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_3&#45;&gt;gate_3 -->
<g id="edge111" class="edge">
<title>comm_attn_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M2094.5,-8775.95C2094.5,-8767.91 2094.5,-8759.16 2094.5,-8750.41"/>
<polygon fill="black" stroke="black" points="2098,-8750.18 2094.5,-8740.18 2091,-8750.18 2098,-8750.18"/>
</g>
<!-- all2all_3 -->
<g id="node84" class="node">
<title>all2all_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-8563.25" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-8577.25" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-8566.25" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-8555.25" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-8544.25" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_3&#45;&gt;all2all_3 -->
<g id="edge112" class="edge">
<title>gate_3&#45;&gt;all2all_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-8635.66C2094.5,-8627.25 2094.5,-8618.59 2094.5,-8610.32"/>
<polygon fill="black" stroke="black" points="2098,-8610.1 2094.5,-8600.1 2091,-8610.1 2098,-8610.1"/>
</g>
<!-- expert_3_0 -->
<g id="node68" class="node">
<title>expert_3_0</title>
<polygon fill="lightblue" stroke="black" points="245,-8490.48 0,-8490.48 0,-8438.48 245,-8438.48 245,-8490.48"/>
<text text-anchor="middle" x="122.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 0 Layer 3</text>
<text text-anchor="middle" x="122.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 1)</text>
<text text-anchor="middle" x="122.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_3 -->
<g id="node85" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-8402.48 1938.39,-8402.48 1830.26,-8298.48 2250.61,-8298.48 2358.74,-8402.48"/>
<text text-anchor="middle" x="2094.5" y="-8364.48" font-family="Arial" font-size="10.00">Expert Aggregation 3</text>
<text text-anchor="middle" x="2094.5" y="-8353.48" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-8342.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-8331.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_0&#45;&gt;agg_3 -->
<g id="edge114" class="edge">
<title>expert_3_0&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M245.14,-8439.53C247.95,-8439.16 250.74,-8438.8 253.5,-8438.48 836.59,-8369.41 1529.68,-8354.66 1875.48,-8351.84"/>
<polygon fill="black" stroke="black" points="1875.63,-8355.34 1885.61,-8351.76 1875.58,-8348.34 1875.63,-8355.34"/>
</g>
<!-- expert_3_1 -->
<g id="node69" class="node">
<title>expert_3_1</title>
<polygon fill="lightblue" stroke="black" points="508,-8490.48 263,-8490.48 263,-8438.48 508,-8438.48 508,-8490.48"/>
<text text-anchor="middle" x="385.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 1 Layer 3</text>
<text text-anchor="middle" x="385.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 1)</text>
<text text-anchor="middle" x="385.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_1&#45;&gt;agg_3 -->
<g id="edge116" class="edge">
<title>expert_3_1&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M508.15,-8439.56C510.96,-8439.18 513.74,-8438.82 516.5,-8438.48 1000.37,-8379.24 1572.67,-8360.32 1877.6,-8354.29"/>
<polygon fill="black" stroke="black" points="1877.96,-8357.78 1887.89,-8354.09 1877.82,-8350.79 1877.96,-8357.78"/>
</g>
<!-- expert_3_2 -->
<g id="node70" class="node">
<title>expert_3_2</title>
<polygon fill="lightblue" stroke="black" points="771,-8490.48 526,-8490.48 526,-8438.48 771,-8438.48 771,-8490.48"/>
<text text-anchor="middle" x="648.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 2 Layer 3</text>
<text text-anchor="middle" x="648.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 1)</text>
<text text-anchor="middle" x="648.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_2&#45;&gt;agg_3 -->
<g id="edge118" class="edge">
<title>expert_3_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M771.15,-8439.6C773.96,-8439.21 776.74,-8438.83 779.5,-8438.48 1165.96,-8389.01 1620.14,-8366.86 1880.94,-8357.57"/>
<polygon fill="black" stroke="black" points="1881.42,-8361.05 1891.29,-8357.2 1881.17,-8354.06 1881.42,-8361.05"/>
</g>
<!-- expert_3_3 -->
<g id="node71" class="node">
<title>expert_3_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-8490.48 789,-8490.48 789,-8438.48 1034,-8438.48 1034,-8490.48"/>
<text text-anchor="middle" x="911.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 3 Layer 3</text>
<text text-anchor="middle" x="911.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 1)</text>
<text text-anchor="middle" x="911.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_3&#45;&gt;agg_3 -->
<g id="edge120" class="edge">
<title>expert_3_3&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1034.16,-8439.66C1036.96,-8439.25 1039.75,-8438.85 1042.5,-8438.48 1333.63,-8398.77 1672.73,-8374.68 1885.52,-8362.21"/>
<polygon fill="black" stroke="black" points="1885.78,-8365.7 1895.56,-8361.63 1885.37,-8358.72 1885.78,-8365.7"/>
</g>
<!-- expert_3_4 -->
<g id="node72" class="node">
<title>expert_3_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-8490.48 1052,-8490.48 1052,-8438.48 1297,-8438.48 1297,-8490.48"/>
<text text-anchor="middle" x="1174.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 4 Layer 3</text>
<text text-anchor="middle" x="1174.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 1)</text>
<text text-anchor="middle" x="1174.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_4&#45;&gt;agg_3 -->
<g id="edge122" class="edge">
<title>expert_3_4&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1297.18,-8439.76C1299.97,-8439.32 1302.75,-8438.89 1305.5,-8438.48 1504.19,-8408.61 1732.48,-8384.54 1892.21,-8369.36"/>
<polygon fill="black" stroke="black" points="1893.01,-8372.8 1902.63,-8368.37 1892.35,-8365.83 1893.01,-8372.8"/>
</g>
<!-- expert_3_5 -->
<g id="node73" class="node">
<title>expert_3_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-8490.48 1315,-8490.48 1315,-8438.48 1560,-8438.48 1560,-8490.48"/>
<text text-anchor="middle" x="1437.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 5 Layer 3</text>
<text text-anchor="middle" x="1437.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 1)</text>
<text text-anchor="middle" x="1437.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_5&#45;&gt;agg_3 -->
<g id="edge124" class="edge">
<title>expert_3_5&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1560.21,-8439.96C1563,-8439.46 1565.76,-8438.96 1568.5,-8438.48 1679.84,-8418.65 1804.72,-8397.93 1904.85,-8381.69"/>
<polygon fill="black" stroke="black" points="1905.46,-8385.13 1914.77,-8380.08 1904.34,-8378.22 1905.46,-8385.13"/>
</g>
<!-- expert_3_6 -->
<g id="node74" class="node">
<title>expert_3_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-8490.48 1578,-8490.48 1578,-8438.48 1823,-8438.48 1823,-8490.48"/>
<text text-anchor="middle" x="1700.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 6 Layer 3</text>
<text text-anchor="middle" x="1700.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 1)</text>
<text text-anchor="middle" x="1700.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_6&#45;&gt;agg_3 -->
<g id="edge126" class="edge">
<title>expert_3_6&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1788.92,-8438.34C1828.53,-8427.08 1876.66,-8413.4 1922.89,-8400.26"/>
<polygon fill="black" stroke="black" points="1924.06,-8403.57 1932.72,-8397.47 1922.14,-8396.83 1924.06,-8403.57"/>
</g>
<!-- expert_3_7 -->
<g id="node75" class="node">
<title>expert_3_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-8490.48 1841,-8490.48 1841,-8438.48 2086,-8438.48 2086,-8490.48"/>
<text text-anchor="middle" x="1963.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 7 Layer 3</text>
<text text-anchor="middle" x="1963.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 1)</text>
<text text-anchor="middle" x="1963.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_7&#45;&gt;agg_3 -->
<g id="edge128" class="edge">
<title>expert_3_7&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1992.9,-8438.34C2003.05,-8429.67 2014.88,-8419.55 2026.8,-8409.35"/>
<polygon fill="black" stroke="black" points="2029.31,-8411.81 2034.64,-8402.66 2024.76,-8406.49 2029.31,-8411.81"/>
</g>
<!-- expert_3_8 -->
<g id="node76" class="node">
<title>expert_3_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-8490.48 2104,-8490.48 2104,-8438.48 2349,-8438.48 2349,-8490.48"/>
<text text-anchor="middle" x="2226.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 8 Layer 3</text>
<text text-anchor="middle" x="2226.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 1)</text>
<text text-anchor="middle" x="2226.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_8&#45;&gt;agg_3 -->
<g id="edge130" class="edge">
<title>expert_3_8&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M2196.88,-8438.34C2186.65,-8429.67 2174.73,-8419.55 2162.71,-8409.35"/>
<polygon fill="black" stroke="black" points="2164.71,-8406.46 2154.82,-8402.66 2160.18,-8411.79 2164.71,-8406.46"/>
</g>
<!-- expert_3_9 -->
<g id="node77" class="node">
<title>expert_3_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-8490.48 2367,-8490.48 2367,-8438.48 2612,-8438.48 2612,-8490.48"/>
<text text-anchor="middle" x="2489.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 9 Layer 3</text>
<text text-anchor="middle" x="2489.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 1)</text>
<text text-anchor="middle" x="2489.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_9&#45;&gt;agg_3 -->
<g id="edge132" class="edge">
<title>expert_3_9&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M2400.85,-8438.34C2366.21,-8428.52 2325.08,-8416.86 2284.37,-8405.31"/>
<polygon fill="black" stroke="black" points="2285.17,-8401.9 2274.6,-8402.54 2283.26,-8408.64 2285.17,-8401.9"/>
</g>
<!-- expert_3_10 -->
<g id="node78" class="node">
<title>expert_3_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-8490.48 2630,-8490.48 2630,-8438.48 2875,-8438.48 2875,-8490.48"/>
<text text-anchor="middle" x="2752.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 10 Layer 3</text>
<text text-anchor="middle" x="2752.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 1)</text>
<text text-anchor="middle" x="2752.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_10&#45;&gt;agg_3 -->
<g id="edge134" class="edge">
<title>expert_3_10&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M2629.79,-8439.96C2627,-8439.46 2624.24,-8438.96 2621.5,-8438.48 2535.88,-8423.24 2442.26,-8407.49 2357.99,-8393.65"/>
<polygon fill="black" stroke="black" points="2358.47,-8390.18 2348.03,-8392.02 2357.33,-8397.09 2358.47,-8390.18"/>
</g>
<!-- expert_3_11 -->
<g id="node79" class="node">
<title>expert_3_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-8490.48 2893,-8490.48 2893,-8438.48 3138,-8438.48 3138,-8490.48"/>
<text text-anchor="middle" x="3015.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 11 Layer 3</text>
<text text-anchor="middle" x="3015.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 1)</text>
<text text-anchor="middle" x="3015.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_11&#45;&gt;agg_3 -->
<g id="edge136" class="edge">
<title>expert_3_11&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M2892.82,-8439.76C2890.03,-8439.32 2887.25,-8438.89 2884.5,-8438.48 2701.91,-8411.05 2494.36,-8388.52 2337.83,-8373.27"/>
<polygon fill="black" stroke="black" points="2337.88,-8369.76 2327.59,-8372.27 2337.21,-8376.72 2337.88,-8369.76"/>
</g>
<!-- expert_3_12 -->
<g id="node80" class="node">
<title>expert_3_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-8490.48 3156,-8490.48 3156,-8438.48 3401,-8438.48 3401,-8490.48"/>
<text text-anchor="middle" x="3278.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 12 Layer 3</text>
<text text-anchor="middle" x="3278.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 1)</text>
<text text-anchor="middle" x="3278.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_12&#45;&gt;agg_3 -->
<g id="edge138" class="edge">
<title>expert_3_12&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3155.84,-8439.66C3153.04,-8439.25 3150.25,-8438.85 3147.5,-8438.48 2866.94,-8400.23 2541.87,-8376.47 2327.98,-8363.64"/>
<polygon fill="black" stroke="black" points="2328.07,-8360.14 2317.87,-8363.04 2327.65,-8367.13 2328.07,-8360.14"/>
</g>
<!-- expert_3_13 -->
<g id="node81" class="node">
<title>expert_3_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-8490.48 3419,-8490.48 3419,-8438.48 3664,-8438.48 3664,-8490.48"/>
<text text-anchor="middle" x="3541.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 13 Layer 3</text>
<text text-anchor="middle" x="3541.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 1)</text>
<text text-anchor="middle" x="3541.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_13&#45;&gt;agg_3 -->
<g id="edge140" class="edge">
<title>expert_3_13&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3418.85,-8439.6C3416.04,-8439.2 3413.26,-8438.83 3410.5,-8438.48 3030.7,-8389.87 2585.55,-8367.64 2322.49,-8358.07"/>
<polygon fill="black" stroke="black" points="2322.55,-8354.57 2312.43,-8357.71 2322.3,-8361.57 2322.55,-8354.57"/>
</g>
<!-- expert_3_14 -->
<g id="node82" class="node">
<title>expert_3_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-8490.48 3682,-8490.48 3682,-8438.48 3927,-8438.48 3927,-8490.48"/>
<text text-anchor="middle" x="3804.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 14 Layer 3</text>
<text text-anchor="middle" x="3804.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 1)</text>
<text text-anchor="middle" x="3804.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_14&#45;&gt;agg_3 -->
<g id="edge142" class="edge">
<title>expert_3_14&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3681.85,-8439.56C3679.04,-8439.18 3676.26,-8438.82 3673.5,-8438.48 3193.37,-8379.7 2626.21,-8360.62 2319.23,-8354.44"/>
<polygon fill="black" stroke="black" points="2318.94,-8350.93 2308.87,-8354.23 2318.8,-8357.93 2318.94,-8350.93"/>
</g>
<!-- expert_3_15 -->
<g id="node83" class="node">
<title>expert_3_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-8490.48 3945,-8490.48 3945,-8438.48 4190,-8438.48 4190,-8490.48"/>
<text text-anchor="middle" x="4067.5" y="-8478.48" font-family="Arial" font-size="10.00">Expert 15 Layer 3</text>
<text text-anchor="middle" x="4067.5" y="-8467.48" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 1)</text>
<text text-anchor="middle" x="4067.5" y="-8456.48" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-8445.48" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_3_15&#45;&gt;agg_3 -->
<g id="edge144" class="edge">
<title>expert_3_15&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3944.86,-8439.53C3942.05,-8439.16 3939.26,-8438.8 3936.5,-8438.48 3354.67,-8369.57 2663.37,-8354.72 2316.45,-8351.86"/>
<polygon fill="black" stroke="black" points="2316.31,-8348.36 2306.29,-8351.78 2316.26,-8355.36 2316.31,-8348.36"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_0 -->
<g id="edge113" class="edge">
<title>all2all_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M1915.5,-8558.68C1522.04,-8550.3 590.94,-8527.3 255.38,-8490.6"/>
<polygon fill="black" stroke="black" points="255.47,-8487.09 245.14,-8489.46 254.69,-8494.05 255.47,-8487.09"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_1 -->
<g id="edge115" class="edge">
<title>all2all_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M1913.96,-8562.42C1622.01,-8560.82 1028.27,-8549.85 518.28,-8490.62"/>
<polygon fill="black" stroke="black" points="518.48,-8487.12 508.14,-8489.43 517.67,-8494.07 518.48,-8487.12"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_2 -->
<g id="edge117" class="edge">
<title>all2all_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M1914.63,-8560.05C1662.79,-8555.26 1190.87,-8540.04 781.12,-8490.61"/>
<polygon fill="black" stroke="black" points="781.5,-8487.13 771.15,-8489.4 780.65,-8494.08 781.5,-8487.13"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_3 -->
<g id="edge119" class="edge">
<title>all2all_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M1917.03,-8556.66C1709.64,-8548.65 1356.12,-8530.36 1044.3,-8490.65"/>
<polygon fill="black" stroke="black" points="1044.52,-8487.15 1034.15,-8489.35 1043.63,-8494.09 1044.52,-8487.15"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_4 -->
<g id="edge121" class="edge">
<title>all2all_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M1923.49,-8551.54C1765.73,-8540.53 1524.89,-8520.88 1307.19,-8490.66"/>
<polygon fill="black" stroke="black" points="1307.55,-8487.18 1297.17,-8489.26 1306.58,-8494.11 1307.55,-8487.18"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_5 -->
<g id="edge123" class="edge">
<title>all2all_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M1941.98,-8543.61C1839.48,-8530.56 1701.14,-8511.96 1570.39,-8490.76"/>
<polygon fill="black" stroke="black" points="1570.62,-8487.25 1560.19,-8489.1 1569.5,-8494.16 1570.62,-8487.25"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_6 -->
<g id="edge125" class="edge">
<title>all2all_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M1981.6,-8534.52C1928.4,-8521.45 1865.13,-8505.91 1812.1,-8492.89"/>
<polygon fill="black" stroke="black" points="1812.87,-8489.47 1802.32,-8490.49 1811.2,-8496.27 1812.87,-8489.47"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_7 -->
<g id="edge127" class="edge">
<title>all2all_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M2047.58,-8527.58C2033.84,-8517.43 2018.91,-8506.41 2005.49,-8496.5"/>
<polygon fill="black" stroke="black" points="2007.49,-8493.62 1997.36,-8490.49 2003.33,-8499.25 2007.49,-8493.62"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_8 -->
<g id="edge129" class="edge">
<title>all2all_3&#45;&gt;expert_3_8</title>
<path fill="none" stroke="black" d="M2141.78,-8527.58C2155.63,-8517.43 2170.67,-8506.41 2184.19,-8496.5"/>
<polygon fill="black" stroke="black" points="2186.38,-8499.23 2192.38,-8490.49 2182.25,-8493.58 2186.38,-8499.23"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_9 -->
<g id="edge131" class="edge">
<title>all2all_3&#45;&gt;expert_3_9</title>
<path fill="none" stroke="black" d="M2207.43,-8534.58C2260.77,-8521.51 2324.25,-8505.96 2377.47,-8492.92"/>
<polygon fill="black" stroke="black" points="2378.41,-8496.3 2387.29,-8490.52 2376.74,-8489.5 2378.41,-8496.3"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_10 -->
<g id="edge133" class="edge">
<title>all2all_3&#45;&gt;expert_3_10</title>
<path fill="none" stroke="black" d="M2247.31,-8543.62C2350.01,-8530.58 2488.61,-8511.98 2619.59,-8490.76"/>
<polygon fill="black" stroke="black" points="2620.5,-8494.16 2629.81,-8489.1 2619.38,-8487.25 2620.5,-8494.16"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_11 -->
<g id="edge135" class="edge">
<title>all2all_3&#45;&gt;expert_3_11</title>
<path fill="none" stroke="black" d="M2265.73,-8551.55C2423.69,-8540.55 2664.83,-8520.9 2882.8,-8490.67"/>
<polygon fill="black" stroke="black" points="2883.42,-8494.11 2892.84,-8489.26 2882.45,-8487.18 2883.42,-8494.11"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_12 -->
<g id="edge137" class="edge">
<title>all2all_3&#45;&gt;expert_3_12</title>
<path fill="none" stroke="black" d="M2272.14,-8556.67C2479.73,-8548.66 2833.58,-8530.38 3145.69,-8490.65"/>
<polygon fill="black" stroke="black" points="3146.37,-8494.09 3155.85,-8489.35 3145.48,-8487.15 3146.37,-8494.09"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_13 -->
<g id="edge139" class="edge">
<title>all2all_3&#45;&gt;expert_3_13</title>
<path fill="none" stroke="black" d="M2274.24,-8560.07C2526.2,-8555.29 2998.67,-8540.08 3408.87,-8490.61"/>
<polygon fill="black" stroke="black" points="3409.35,-8494.08 3418.85,-8489.4 3408.5,-8487.13 3409.35,-8494.08"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_14 -->
<g id="edge141" class="edge">
<title>all2all_3&#45;&gt;expert_3_14</title>
<path fill="none" stroke="black" d="M2274.85,-8562.42C2566.88,-8560.85 3161.23,-8549.9 3671.71,-8490.62"/>
<polygon fill="black" stroke="black" points="3672.33,-8494.07 3681.86,-8489.43 3671.52,-8487.12 3672.33,-8494.07"/>
</g>
<!-- all2all_3&#45;&gt;expert_3_15 -->
<g id="edge143" class="edge">
<title>all2all_3&#45;&gt;expert_3_15</title>
<path fill="none" stroke="black" d="M2273.6,-8558.69C2667.27,-8550.31 3598.88,-8527.32 3934.62,-8490.6"/>
<polygon fill="black" stroke="black" points="3935.31,-8494.05 3944.86,-8489.46 3934.53,-8487.09 3935.31,-8494.05"/>
</g>
<!-- attn_4 -->
<g id="node86" class="node">
<title>attn_4</title>
<polygon fill="lightblue" stroke="black" points="2235,-8262.48 1954,-8262.48 1954,-8210.48 2235,-8210.48 2235,-8262.48"/>
<text text-anchor="middle" x="2094.5" y="-8250.48" font-family="Arial" font-size="10.00">Attention Layer 4</text>
<text text-anchor="middle" x="2094.5" y="-8239.48" font-family="Arial" font-size="10.00">GPU: 0 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-8228.48" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-8217.48" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_3&#45;&gt;attn_4 -->
<g id="edge145" class="edge">
<title>agg_3&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M2094.5,-8298.39C2094.5,-8289.73 2094.5,-8280.91 2094.5,-8272.76"/>
<polygon fill="black" stroke="black" points="2098,-8272.52 2094.5,-8262.52 2091,-8272.52 2098,-8272.52"/>
</g>
<!-- comm_attn_4 -->
<g id="node87" class="node">
<title>comm_attn_4</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-8137.71" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-8151.71" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-8140.71" font-family="Arial" font-size="10.00">GPU: 0 ↔ GPU: 1, 2, 3</text>
<text text-anchor="middle" x="2094.5" y="-8129.71" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-8118.71" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_4&#45;&gt;comm_attn_4 -->
<g id="edge146" class="edge">
<title>attn_4&#45;&gt;comm_attn_4</title>
<path fill="none" stroke="black" d="M2094.5,-8210.31C2094.5,-8202.5 2094.5,-8193.63 2094.5,-8184.86"/>
<polygon fill="black" stroke="black" points="2098,-8184.68 2094.5,-8174.68 2091,-8184.68 2098,-8184.68"/>
</g>
<!-- gate_4 -->
<g id="node88" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-8064.94 1931.71,-8064.94 1818.95,-7960.94 2257.29,-7960.94 2370.05,-8064.94"/>
<text text-anchor="middle" x="2094.5" y="-8026.94" font-family="Arial" font-size="10.00">Expert Gate 4</text>
<text text-anchor="middle" x="2094.5" y="-8015.94" font-family="Arial" font-size="10.00">GPU: 0 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-8004.94" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7993.94" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_4&#45;&gt;gate_4 -->
<g id="edge147" class="edge">
<title>comm_attn_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M2094.5,-8100.87C2094.5,-8092.83 2094.5,-8084.08 2094.5,-8075.33"/>
<polygon fill="black" stroke="black" points="2098,-8075.11 2094.5,-8065.11 2091,-8075.11 2098,-8075.11"/>
</g>
<!-- all2all_4 -->
<g id="node105" class="node">
<title>all2all_4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-7888.17" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-7902.17" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-7891.17" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 2)</text>
<text text-anchor="middle" x="2094.5" y="-7880.17" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7869.17" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_4&#45;&gt;all2all_4 -->
<g id="edge148" class="edge">
<title>gate_4&#45;&gt;all2all_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-7960.58C2094.5,-7952.18 2094.5,-7943.51 2094.5,-7935.24"/>
<polygon fill="black" stroke="black" points="2098,-7935.02 2094.5,-7925.02 2091,-7935.02 2098,-7935.02"/>
</g>
<!-- expert_4_0 -->
<g id="node89" class="node">
<title>expert_4_0</title>
<polygon fill="lightblue" stroke="black" points="245,-7815.4 0,-7815.4 0,-7763.4 245,-7763.4 245,-7815.4"/>
<text text-anchor="middle" x="122.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 0 Layer 4</text>
<text text-anchor="middle" x="122.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 2)</text>
<text text-anchor="middle" x="122.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_4 -->
<g id="node106" class="node">
<title>agg_4</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-7727.4 1938.39,-7727.4 1830.26,-7623.4 2250.61,-7623.4 2358.74,-7727.4"/>
<text text-anchor="middle" x="2094.5" y="-7689.4" font-family="Arial" font-size="10.00">Expert Aggregation 4</text>
<text text-anchor="middle" x="2094.5" y="-7678.4" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-7667.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7656.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_0&#45;&gt;agg_4 -->
<g id="edge150" class="edge">
<title>expert_4_0&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M245.14,-7764.45C247.95,-7764.08 250.74,-7763.73 253.5,-7763.4 836.59,-7694.33 1529.68,-7679.58 1875.48,-7676.76"/>
<polygon fill="black" stroke="black" points="1875.63,-7680.26 1885.61,-7676.68 1875.58,-7673.26 1875.63,-7680.26"/>
</g>
<!-- expert_4_1 -->
<g id="node90" class="node">
<title>expert_4_1</title>
<polygon fill="lightblue" stroke="black" points="508,-7815.4 263,-7815.4 263,-7763.4 508,-7763.4 508,-7815.4"/>
<text text-anchor="middle" x="385.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 1 Layer 4</text>
<text text-anchor="middle" x="385.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 2)</text>
<text text-anchor="middle" x="385.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_1&#45;&gt;agg_4 -->
<g id="edge152" class="edge">
<title>expert_4_1&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M508.15,-7764.48C510.96,-7764.1 513.74,-7763.74 516.5,-7763.4 1000.37,-7704.16 1572.67,-7685.24 1877.6,-7679.21"/>
<polygon fill="black" stroke="black" points="1877.96,-7682.71 1887.89,-7679.01 1877.82,-7675.71 1877.96,-7682.71"/>
</g>
<!-- expert_4_2 -->
<g id="node91" class="node">
<title>expert_4_2</title>
<polygon fill="lightblue" stroke="black" points="771,-7815.4 526,-7815.4 526,-7763.4 771,-7763.4 771,-7815.4"/>
<text text-anchor="middle" x="648.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 2 Layer 4</text>
<text text-anchor="middle" x="648.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 2)</text>
<text text-anchor="middle" x="648.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_2&#45;&gt;agg_4 -->
<g id="edge154" class="edge">
<title>expert_4_2&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M771.15,-7764.52C773.96,-7764.13 776.74,-7763.75 779.5,-7763.4 1165.96,-7713.93 1620.14,-7691.78 1880.94,-7682.49"/>
<polygon fill="black" stroke="black" points="1881.42,-7685.98 1891.29,-7682.12 1881.17,-7678.98 1881.42,-7685.98"/>
</g>
<!-- expert_4_3 -->
<g id="node92" class="node">
<title>expert_4_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-7815.4 789,-7815.4 789,-7763.4 1034,-7763.4 1034,-7815.4"/>
<text text-anchor="middle" x="911.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 3 Layer 4</text>
<text text-anchor="middle" x="911.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 2)</text>
<text text-anchor="middle" x="911.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_3&#45;&gt;agg_4 -->
<g id="edge156" class="edge">
<title>expert_4_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1034.16,-7764.58C1036.96,-7764.17 1039.75,-7763.77 1042.5,-7763.4 1333.63,-7723.7 1672.73,-7699.6 1885.52,-7687.13"/>
<polygon fill="black" stroke="black" points="1885.78,-7690.63 1895.56,-7686.55 1885.37,-7683.64 1885.78,-7690.63"/>
</g>
<!-- expert_4_4 -->
<g id="node93" class="node">
<title>expert_4_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-7815.4 1052,-7815.4 1052,-7763.4 1297,-7763.4 1297,-7815.4"/>
<text text-anchor="middle" x="1174.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 4 Layer 4</text>
<text text-anchor="middle" x="1174.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 2)</text>
<text text-anchor="middle" x="1174.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_4&#45;&gt;agg_4 -->
<g id="edge158" class="edge">
<title>expert_4_4&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1297.18,-7764.68C1299.97,-7764.24 1302.75,-7763.81 1305.5,-7763.4 1504.19,-7733.53 1732.48,-7709.47 1892.21,-7694.28"/>
<polygon fill="black" stroke="black" points="1893.01,-7697.72 1902.63,-7693.29 1892.35,-7690.75 1893.01,-7697.72"/>
</g>
<!-- expert_4_5 -->
<g id="node94" class="node">
<title>expert_4_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-7815.4 1315,-7815.4 1315,-7763.4 1560,-7763.4 1560,-7815.4"/>
<text text-anchor="middle" x="1437.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 5 Layer 4</text>
<text text-anchor="middle" x="1437.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 2)</text>
<text text-anchor="middle" x="1437.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_5&#45;&gt;agg_4 -->
<g id="edge160" class="edge">
<title>expert_4_5&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1560.21,-7764.89C1563,-7764.38 1565.76,-7763.89 1568.5,-7763.4 1679.84,-7743.57 1804.72,-7722.85 1904.85,-7706.61"/>
<polygon fill="black" stroke="black" points="1905.46,-7710.06 1914.77,-7705 1904.34,-7703.15 1905.46,-7710.06"/>
</g>
<!-- expert_4_6 -->
<g id="node95" class="node">
<title>expert_4_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-7815.4 1578,-7815.4 1578,-7763.4 1823,-7763.4 1823,-7815.4"/>
<text text-anchor="middle" x="1700.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 6 Layer 4</text>
<text text-anchor="middle" x="1700.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 2)</text>
<text text-anchor="middle" x="1700.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_6&#45;&gt;agg_4 -->
<g id="edge162" class="edge">
<title>expert_4_6&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1788.92,-7763.26C1828.53,-7752 1876.66,-7738.32 1922.89,-7725.18"/>
<polygon fill="black" stroke="black" points="1924.06,-7728.49 1932.72,-7722.39 1922.14,-7721.76 1924.06,-7728.49"/>
</g>
<!-- expert_4_7 -->
<g id="node96" class="node">
<title>expert_4_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-7815.4 1841,-7815.4 1841,-7763.4 2086,-7763.4 2086,-7815.4"/>
<text text-anchor="middle" x="1963.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 7 Layer 4</text>
<text text-anchor="middle" x="1963.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 2)</text>
<text text-anchor="middle" x="1963.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_7&#45;&gt;agg_4 -->
<g id="edge164" class="edge">
<title>expert_4_7&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1992.9,-7763.26C2003.05,-7754.59 2014.88,-7744.47 2026.8,-7734.28"/>
<polygon fill="black" stroke="black" points="2029.31,-7736.74 2034.64,-7727.58 2024.76,-7731.42 2029.31,-7736.74"/>
</g>
<!-- expert_4_8 -->
<g id="node97" class="node">
<title>expert_4_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-7815.4 2104,-7815.4 2104,-7763.4 2349,-7763.4 2349,-7815.4"/>
<text text-anchor="middle" x="2226.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 8 Layer 4</text>
<text text-anchor="middle" x="2226.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 2)</text>
<text text-anchor="middle" x="2226.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_8&#45;&gt;agg_4 -->
<g id="edge166" class="edge">
<title>expert_4_8&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2196.88,-7763.26C2186.65,-7754.59 2174.73,-7744.47 2162.71,-7734.28"/>
<polygon fill="black" stroke="black" points="2164.71,-7731.38 2154.82,-7727.58 2160.18,-7736.72 2164.71,-7731.38"/>
</g>
<!-- expert_4_9 -->
<g id="node98" class="node">
<title>expert_4_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-7815.4 2367,-7815.4 2367,-7763.4 2612,-7763.4 2612,-7815.4"/>
<text text-anchor="middle" x="2489.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 9 Layer 4</text>
<text text-anchor="middle" x="2489.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 2)</text>
<text text-anchor="middle" x="2489.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_9&#45;&gt;agg_4 -->
<g id="edge168" class="edge">
<title>expert_4_9&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2400.85,-7763.26C2366.21,-7753.44 2325.08,-7741.78 2284.37,-7730.24"/>
<polygon fill="black" stroke="black" points="2285.17,-7726.83 2274.6,-7727.46 2283.26,-7733.56 2285.17,-7726.83"/>
</g>
<!-- expert_4_10 -->
<g id="node99" class="node">
<title>expert_4_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-7815.4 2630,-7815.4 2630,-7763.4 2875,-7763.4 2875,-7815.4"/>
<text text-anchor="middle" x="2752.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 10 Layer 4</text>
<text text-anchor="middle" x="2752.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 2)</text>
<text text-anchor="middle" x="2752.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_10&#45;&gt;agg_4 -->
<g id="edge170" class="edge">
<title>expert_4_10&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2629.79,-7764.89C2627,-7764.38 2624.24,-7763.89 2621.5,-7763.4 2535.88,-7748.16 2442.26,-7732.41 2357.99,-7718.57"/>
<polygon fill="black" stroke="black" points="2358.47,-7715.1 2348.03,-7716.94 2357.33,-7722.01 2358.47,-7715.1"/>
</g>
<!-- expert_4_11 -->
<g id="node100" class="node">
<title>expert_4_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-7815.4 2893,-7815.4 2893,-7763.4 3138,-7763.4 3138,-7815.4"/>
<text text-anchor="middle" x="3015.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 11 Layer 4</text>
<text text-anchor="middle" x="3015.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 2)</text>
<text text-anchor="middle" x="3015.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_11&#45;&gt;agg_4 -->
<g id="edge172" class="edge">
<title>expert_4_11&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2892.82,-7764.68C2890.03,-7764.24 2887.25,-7763.81 2884.5,-7763.4 2701.91,-7735.97 2494.36,-7713.44 2337.83,-7698.19"/>
<polygon fill="black" stroke="black" points="2337.88,-7694.68 2327.59,-7697.2 2337.21,-7701.65 2337.88,-7694.68"/>
</g>
<!-- expert_4_12 -->
<g id="node101" class="node">
<title>expert_4_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-7815.4 3156,-7815.4 3156,-7763.4 3401,-7763.4 3401,-7815.4"/>
<text text-anchor="middle" x="3278.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 12 Layer 4</text>
<text text-anchor="middle" x="3278.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 2)</text>
<text text-anchor="middle" x="3278.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_12&#45;&gt;agg_4 -->
<g id="edge174" class="edge">
<title>expert_4_12&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M3155.84,-7764.58C3153.04,-7764.17 3150.25,-7763.77 3147.5,-7763.4 2866.94,-7725.15 2541.87,-7701.39 2327.98,-7688.56"/>
<polygon fill="black" stroke="black" points="2328.07,-7685.06 2317.87,-7687.96 2327.65,-7692.05 2328.07,-7685.06"/>
</g>
<!-- expert_4_13 -->
<g id="node102" class="node">
<title>expert_4_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-7815.4 3419,-7815.4 3419,-7763.4 3664,-7763.4 3664,-7815.4"/>
<text text-anchor="middle" x="3541.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 13 Layer 4</text>
<text text-anchor="middle" x="3541.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 2)</text>
<text text-anchor="middle" x="3541.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_13&#45;&gt;agg_4 -->
<g id="edge176" class="edge">
<title>expert_4_13&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M3418.85,-7764.52C3416.04,-7764.13 3413.26,-7763.75 3410.5,-7763.4 3030.7,-7714.79 2585.55,-7692.56 2322.49,-7682.99"/>
<polygon fill="black" stroke="black" points="2322.55,-7679.49 2312.43,-7682.63 2322.3,-7686.49 2322.55,-7679.49"/>
</g>
<!-- expert_4_14 -->
<g id="node103" class="node">
<title>expert_4_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-7815.4 3682,-7815.4 3682,-7763.4 3927,-7763.4 3927,-7815.4"/>
<text text-anchor="middle" x="3804.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 14 Layer 4</text>
<text text-anchor="middle" x="3804.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 2)</text>
<text text-anchor="middle" x="3804.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_14&#45;&gt;agg_4 -->
<g id="edge178" class="edge">
<title>expert_4_14&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M3681.85,-7764.48C3679.04,-7764.1 3676.26,-7763.74 3673.5,-7763.4 3193.37,-7704.62 2626.21,-7685.54 2319.23,-7679.36"/>
<polygon fill="black" stroke="black" points="2318.94,-7675.85 2308.87,-7679.15 2318.8,-7682.85 2318.94,-7675.85"/>
</g>
<!-- expert_4_15 -->
<g id="node104" class="node">
<title>expert_4_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-7815.4 3945,-7815.4 3945,-7763.4 4190,-7763.4 4190,-7815.4"/>
<text text-anchor="middle" x="4067.5" y="-7803.4" font-family="Arial" font-size="10.00">Expert 15 Layer 4</text>
<text text-anchor="middle" x="4067.5" y="-7792.4" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 2)</text>
<text text-anchor="middle" x="4067.5" y="-7781.4" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-7770.4" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_4_15&#45;&gt;agg_4 -->
<g id="edge180" class="edge">
<title>expert_4_15&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M3944.86,-7764.45C3942.05,-7764.08 3939.26,-7763.73 3936.5,-7763.4 3354.67,-7694.49 2663.37,-7679.64 2316.45,-7676.78"/>
<polygon fill="black" stroke="black" points="2316.31,-7673.28 2306.29,-7676.7 2316.26,-7680.28 2316.31,-7673.28"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_0 -->
<g id="edge149" class="edge">
<title>all2all_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M1915.5,-7883.61C1522.04,-7875.22 590.94,-7852.22 255.38,-7815.53"/>
<polygon fill="black" stroke="black" points="255.47,-7812.01 245.14,-7814.38 254.69,-7818.97 255.47,-7812.01"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_1 -->
<g id="edge151" class="edge">
<title>all2all_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M1913.96,-7887.34C1622.01,-7885.74 1028.27,-7874.78 518.28,-7815.54"/>
<polygon fill="black" stroke="black" points="518.48,-7812.04 508.14,-7814.36 517.67,-7818.99 518.48,-7812.04"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_2 -->
<g id="edge153" class="edge">
<title>all2all_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M1914.63,-7884.97C1662.79,-7880.18 1190.87,-7864.96 781.12,-7815.53"/>
<polygon fill="black" stroke="black" points="781.5,-7812.05 771.15,-7814.32 780.65,-7819 781.5,-7812.05"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_3 -->
<g id="edge155" class="edge">
<title>all2all_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M1917.03,-7881.58C1709.64,-7873.57 1356.12,-7855.28 1044.3,-7815.57"/>
<polygon fill="black" stroke="black" points="1044.52,-7812.07 1034.15,-7814.27 1043.63,-7819.01 1044.52,-7812.07"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_4 -->
<g id="edge157" class="edge">
<title>all2all_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M1923.49,-7876.46C1765.73,-7865.46 1524.89,-7845.8 1307.19,-7815.59"/>
<polygon fill="black" stroke="black" points="1307.55,-7812.1 1297.17,-7814.19 1306.58,-7819.04 1307.55,-7812.1"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_5 -->
<g id="edge159" class="edge">
<title>all2all_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M1941.98,-7868.53C1839.48,-7855.48 1701.14,-7836.88 1570.39,-7815.68"/>
<polygon fill="black" stroke="black" points="1570.62,-7812.17 1560.19,-7814.02 1569.5,-7819.08 1570.62,-7812.17"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_6 -->
<g id="edge161" class="edge">
<title>all2all_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M1981.6,-7859.44C1928.4,-7846.37 1865.13,-7830.83 1812.1,-7817.81"/>
<polygon fill="black" stroke="black" points="1812.87,-7814.39 1802.32,-7815.41 1811.2,-7821.19 1812.87,-7814.39"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_7 -->
<g id="edge163" class="edge">
<title>all2all_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M2047.58,-7852.51C2033.84,-7842.36 2018.91,-7831.33 2005.49,-7821.42"/>
<polygon fill="black" stroke="black" points="2007.49,-7818.54 1997.36,-7815.41 2003.33,-7824.17 2007.49,-7818.54"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_8 -->
<g id="edge165" class="edge">
<title>all2all_4&#45;&gt;expert_4_8</title>
<path fill="none" stroke="black" d="M2141.78,-7852.51C2155.63,-7842.36 2170.67,-7831.33 2184.19,-7821.42"/>
<polygon fill="black" stroke="black" points="2186.38,-7824.15 2192.38,-7815.41 2182.25,-7818.5 2186.38,-7824.15"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_9 -->
<g id="edge167" class="edge">
<title>all2all_4&#45;&gt;expert_4_9</title>
<path fill="none" stroke="black" d="M2207.43,-7859.5C2260.77,-7846.44 2324.25,-7830.88 2377.47,-7817.84"/>
<polygon fill="black" stroke="black" points="2378.41,-7821.22 2387.29,-7815.44 2376.74,-7814.42 2378.41,-7821.22"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_10 -->
<g id="edge169" class="edge">
<title>all2all_4&#45;&gt;expert_4_10</title>
<path fill="none" stroke="black" d="M2247.31,-7868.54C2350.01,-7855.5 2488.61,-7836.9 2619.59,-7815.68"/>
<polygon fill="black" stroke="black" points="2620.5,-7819.08 2629.81,-7814.02 2619.38,-7812.17 2620.5,-7819.08"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_11 -->
<g id="edge171" class="edge">
<title>all2all_4&#45;&gt;expert_4_11</title>
<path fill="none" stroke="black" d="M2265.73,-7876.47C2423.69,-7865.47 2664.83,-7845.82 2882.8,-7815.59"/>
<polygon fill="black" stroke="black" points="2883.42,-7819.04 2892.84,-7814.19 2882.45,-7812.1 2883.42,-7819.04"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_12 -->
<g id="edge173" class="edge">
<title>all2all_4&#45;&gt;expert_4_12</title>
<path fill="none" stroke="black" d="M2272.14,-7881.59C2479.73,-7873.59 2833.58,-7855.31 3145.69,-7815.57"/>
<polygon fill="black" stroke="black" points="3146.37,-7819.01 3155.85,-7814.27 3145.48,-7812.07 3146.37,-7819.01"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_13 -->
<g id="edge175" class="edge">
<title>all2all_4&#45;&gt;expert_4_13</title>
<path fill="none" stroke="black" d="M2274.24,-7884.99C2526.2,-7880.21 2998.67,-7865 3408.87,-7815.53"/>
<polygon fill="black" stroke="black" points="3409.35,-7819 3418.85,-7814.32 3408.5,-7812.05 3409.35,-7819"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_14 -->
<g id="edge177" class="edge">
<title>all2all_4&#45;&gt;expert_4_14</title>
<path fill="none" stroke="black" d="M2274.85,-7887.35C2566.88,-7885.77 3161.23,-7874.83 3671.71,-7815.54"/>
<polygon fill="black" stroke="black" points="3672.33,-7818.99 3681.86,-7814.36 3671.52,-7812.04 3672.33,-7818.99"/>
</g>
<!-- all2all_4&#45;&gt;expert_4_15 -->
<g id="edge179" class="edge">
<title>all2all_4&#45;&gt;expert_4_15</title>
<path fill="none" stroke="black" d="M2273.6,-7883.61C2667.27,-7875.23 3598.88,-7852.24 3934.62,-7815.53"/>
<polygon fill="black" stroke="black" points="3935.31,-7818.97 3944.86,-7814.38 3934.53,-7812.01 3935.31,-7818.97"/>
</g>
<!-- attn_5 -->
<g id="node107" class="node">
<title>attn_5</title>
<polygon fill="lightblue" stroke="black" points="2235,-7587.4 1954,-7587.4 1954,-7535.4 2235,-7535.4 2235,-7587.4"/>
<text text-anchor="middle" x="2094.5" y="-7575.4" font-family="Arial" font-size="10.00">Attention Layer 5</text>
<text text-anchor="middle" x="2094.5" y="-7564.4" font-family="Arial" font-size="10.00">GPU: 1 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-7553.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-7542.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_4&#45;&gt;attn_5 -->
<g id="edge181" class="edge">
<title>agg_4&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M2094.5,-7623.32C2094.5,-7614.65 2094.5,-7605.83 2094.5,-7597.69"/>
<polygon fill="black" stroke="black" points="2098,-7597.44 2094.5,-7587.44 2091,-7597.44 2098,-7597.44"/>
</g>
<!-- comm_attn_5 -->
<g id="node108" class="node">
<title>comm_attn_5</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-7462.63" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-7476.63" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-7465.63" font-family="Arial" font-size="10.00">GPU: 1 ↔ GPU: 2, 3, 4</text>
<text text-anchor="middle" x="2094.5" y="-7454.63" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7443.63" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_5&#45;&gt;comm_attn_5 -->
<g id="edge182" class="edge">
<title>attn_5&#45;&gt;comm_attn_5</title>
<path fill="none" stroke="black" d="M2094.5,-7535.23C2094.5,-7527.42 2094.5,-7518.55 2094.5,-7509.78"/>
<polygon fill="black" stroke="black" points="2098,-7509.61 2094.5,-7499.61 2091,-7509.61 2098,-7509.61"/>
</g>
<!-- gate_5 -->
<g id="node109" class="node">
<title>gate_5</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-7389.86 1931.71,-7389.86 1818.95,-7285.86 2257.29,-7285.86 2370.05,-7389.86"/>
<text text-anchor="middle" x="2094.5" y="-7351.86" font-family="Arial" font-size="10.00">Expert Gate 5</text>
<text text-anchor="middle" x="2094.5" y="-7340.86" font-family="Arial" font-size="10.00">GPU: 1 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-7329.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7318.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_5&#45;&gt;gate_5 -->
<g id="edge183" class="edge">
<title>comm_attn_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M2094.5,-7425.79C2094.5,-7417.75 2094.5,-7409 2094.5,-7400.25"/>
<polygon fill="black" stroke="black" points="2098,-7400.03 2094.5,-7390.03 2091,-7400.03 2098,-7400.03"/>
</g>
<!-- all2all_5 -->
<g id="node126" class="node">
<title>all2all_5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-7213.09" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-7227.09" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-7216.09" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 2)</text>
<text text-anchor="middle" x="2094.5" y="-7205.09" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7194.09" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_5&#45;&gt;all2all_5 -->
<g id="edge184" class="edge">
<title>gate_5&#45;&gt;all2all_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-7285.51C2094.5,-7277.1 2094.5,-7268.43 2094.5,-7260.16"/>
<polygon fill="black" stroke="black" points="2098,-7259.95 2094.5,-7249.95 2091,-7259.95 2098,-7259.95"/>
</g>
<!-- expert_5_0 -->
<g id="node110" class="node">
<title>expert_5_0</title>
<polygon fill="lightblue" stroke="black" points="245,-7140.32 0,-7140.32 0,-7088.32 245,-7088.32 245,-7140.32"/>
<text text-anchor="middle" x="122.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 0 Layer 5</text>
<text text-anchor="middle" x="122.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 2)</text>
<text text-anchor="middle" x="122.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_5 -->
<g id="node127" class="node">
<title>agg_5</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-7052.32 1938.39,-7052.32 1830.26,-6948.32 2250.61,-6948.32 2358.74,-7052.32"/>
<text text-anchor="middle" x="2094.5" y="-7014.32" font-family="Arial" font-size="10.00">Expert Aggregation 5</text>
<text text-anchor="middle" x="2094.5" y="-7003.32" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-6992.32" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6981.32" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_0&#45;&gt;agg_5 -->
<g id="edge186" class="edge">
<title>expert_5_0&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M245.14,-7089.37C247.95,-7089 250.74,-7088.65 253.5,-7088.32 836.59,-7019.26 1529.68,-7004.5 1875.48,-7001.68"/>
<polygon fill="black" stroke="black" points="1875.63,-7005.18 1885.61,-7001.6 1875.58,-6998.18 1875.63,-7005.18"/>
</g>
<!-- expert_5_1 -->
<g id="node111" class="node">
<title>expert_5_1</title>
<polygon fill="lightblue" stroke="black" points="508,-7140.32 263,-7140.32 263,-7088.32 508,-7088.32 508,-7140.32"/>
<text text-anchor="middle" x="385.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 1 Layer 5</text>
<text text-anchor="middle" x="385.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 2)</text>
<text text-anchor="middle" x="385.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_1&#45;&gt;agg_5 -->
<g id="edge188" class="edge">
<title>expert_5_1&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M508.15,-7089.4C510.96,-7089.02 513.74,-7088.66 516.5,-7088.32 1000.37,-7029.08 1572.67,-7010.16 1877.6,-7004.13"/>
<polygon fill="black" stroke="black" points="1877.96,-7007.63 1887.89,-7003.93 1877.82,-7000.63 1877.96,-7007.63"/>
</g>
<!-- expert_5_2 -->
<g id="node112" class="node">
<title>expert_5_2</title>
<polygon fill="lightblue" stroke="black" points="771,-7140.32 526,-7140.32 526,-7088.32 771,-7088.32 771,-7140.32"/>
<text text-anchor="middle" x="648.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 2 Layer 5</text>
<text text-anchor="middle" x="648.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 2)</text>
<text text-anchor="middle" x="648.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_2&#45;&gt;agg_5 -->
<g id="edge190" class="edge">
<title>expert_5_2&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M771.15,-7089.44C773.96,-7089.05 776.74,-7088.67 779.5,-7088.32 1165.96,-7038.85 1620.14,-7016.7 1880.94,-7007.41"/>
<polygon fill="black" stroke="black" points="1881.42,-7010.9 1891.29,-7007.05 1881.17,-7003.9 1881.42,-7010.9"/>
</g>
<!-- expert_5_3 -->
<g id="node113" class="node">
<title>expert_5_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-7140.32 789,-7140.32 789,-7088.32 1034,-7088.32 1034,-7140.32"/>
<text text-anchor="middle" x="911.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 3 Layer 5</text>
<text text-anchor="middle" x="911.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 2)</text>
<text text-anchor="middle" x="911.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_3&#45;&gt;agg_5 -->
<g id="edge192" class="edge">
<title>expert_5_3&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1034.16,-7089.5C1036.96,-7089.09 1039.75,-7088.7 1042.5,-7088.32 1333.63,-7048.62 1672.73,-7024.52 1885.52,-7012.06"/>
<polygon fill="black" stroke="black" points="1885.78,-7015.55 1895.56,-7011.47 1885.37,-7008.56 1885.78,-7015.55"/>
</g>
<!-- expert_5_4 -->
<g id="node114" class="node">
<title>expert_5_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-7140.32 1052,-7140.32 1052,-7088.32 1297,-7088.32 1297,-7140.32"/>
<text text-anchor="middle" x="1174.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 4 Layer 5</text>
<text text-anchor="middle" x="1174.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 2)</text>
<text text-anchor="middle" x="1174.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_4&#45;&gt;agg_5 -->
<g id="edge194" class="edge">
<title>expert_5_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1297.18,-7089.61C1299.97,-7089.16 1302.75,-7088.73 1305.5,-7088.32 1504.19,-7058.45 1732.48,-7034.39 1892.21,-7019.2"/>
<polygon fill="black" stroke="black" points="1893.01,-7022.64 1902.63,-7018.22 1892.35,-7015.67 1893.01,-7022.64"/>
</g>
<!-- expert_5_5 -->
<g id="node115" class="node">
<title>expert_5_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-7140.32 1315,-7140.32 1315,-7088.32 1560,-7088.32 1560,-7140.32"/>
<text text-anchor="middle" x="1437.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 5 Layer 5</text>
<text text-anchor="middle" x="1437.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 2)</text>
<text text-anchor="middle" x="1437.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_5&#45;&gt;agg_5 -->
<g id="edge196" class="edge">
<title>expert_5_5&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1560.21,-7089.81C1563,-7089.3 1565.76,-7088.81 1568.5,-7088.32 1679.84,-7068.49 1804.72,-7047.77 1904.85,-7031.53"/>
<polygon fill="black" stroke="black" points="1905.46,-7034.98 1914.77,-7029.92 1904.34,-7028.07 1905.46,-7034.98"/>
</g>
<!-- expert_5_6 -->
<g id="node116" class="node">
<title>expert_5_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-7140.32 1578,-7140.32 1578,-7088.32 1823,-7088.32 1823,-7140.32"/>
<text text-anchor="middle" x="1700.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 6 Layer 5</text>
<text text-anchor="middle" x="1700.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 2)</text>
<text text-anchor="middle" x="1700.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_6&#45;&gt;agg_5 -->
<g id="edge198" class="edge">
<title>expert_5_6&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1788.92,-7088.19C1828.53,-7076.93 1876.66,-7063.25 1922.89,-7050.1"/>
<polygon fill="black" stroke="black" points="1924.06,-7053.41 1932.72,-7047.31 1922.14,-7046.68 1924.06,-7053.41"/>
</g>
<!-- expert_5_7 -->
<g id="node117" class="node">
<title>expert_5_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-7140.32 1841,-7140.32 1841,-7088.32 2086,-7088.32 2086,-7140.32"/>
<text text-anchor="middle" x="1963.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 7 Layer 5</text>
<text text-anchor="middle" x="1963.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 2)</text>
<text text-anchor="middle" x="1963.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_7&#45;&gt;agg_5 -->
<g id="edge200" class="edge">
<title>expert_5_7&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1992.9,-7088.19C2003.05,-7079.51 2014.88,-7069.4 2026.8,-7059.2"/>
<polygon fill="black" stroke="black" points="2029.31,-7061.66 2034.64,-7052.5 2024.76,-7056.34 2029.31,-7061.66"/>
</g>
<!-- expert_5_8 -->
<g id="node118" class="node">
<title>expert_5_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-7140.32 2104,-7140.32 2104,-7088.32 2349,-7088.32 2349,-7140.32"/>
<text text-anchor="middle" x="2226.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 8 Layer 5</text>
<text text-anchor="middle" x="2226.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 2)</text>
<text text-anchor="middle" x="2226.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_8&#45;&gt;agg_5 -->
<g id="edge202" class="edge">
<title>expert_5_8&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2196.88,-7088.19C2186.65,-7079.51 2174.73,-7069.4 2162.71,-7059.2"/>
<polygon fill="black" stroke="black" points="2164.71,-7056.3 2154.82,-7052.5 2160.18,-7061.64 2164.71,-7056.3"/>
</g>
<!-- expert_5_9 -->
<g id="node119" class="node">
<title>expert_5_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-7140.32 2367,-7140.32 2367,-7088.32 2612,-7088.32 2612,-7140.32"/>
<text text-anchor="middle" x="2489.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 9 Layer 5</text>
<text text-anchor="middle" x="2489.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 2)</text>
<text text-anchor="middle" x="2489.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_9&#45;&gt;agg_5 -->
<g id="edge204" class="edge">
<title>expert_5_9&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2400.85,-7088.19C2366.21,-7078.36 2325.08,-7066.7 2284.37,-7055.16"/>
<polygon fill="black" stroke="black" points="2285.17,-7051.75 2274.6,-7052.39 2283.26,-7058.48 2285.17,-7051.75"/>
</g>
<!-- expert_5_10 -->
<g id="node120" class="node">
<title>expert_5_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-7140.32 2630,-7140.32 2630,-7088.32 2875,-7088.32 2875,-7140.32"/>
<text text-anchor="middle" x="2752.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 10 Layer 5</text>
<text text-anchor="middle" x="2752.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 2)</text>
<text text-anchor="middle" x="2752.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_10&#45;&gt;agg_5 -->
<g id="edge206" class="edge">
<title>expert_5_10&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2629.79,-7089.81C2627,-7089.3 2624.24,-7088.81 2621.5,-7088.32 2535.88,-7073.09 2442.26,-7057.34 2357.99,-7043.5"/>
<polygon fill="black" stroke="black" points="2358.47,-7040.03 2348.03,-7041.86 2357.33,-7046.93 2358.47,-7040.03"/>
</g>
<!-- expert_5_11 -->
<g id="node121" class="node">
<title>expert_5_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-7140.32 2893,-7140.32 2893,-7088.32 3138,-7088.32 3138,-7140.32"/>
<text text-anchor="middle" x="3015.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 11 Layer 5</text>
<text text-anchor="middle" x="3015.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 2)</text>
<text text-anchor="middle" x="3015.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_11&#45;&gt;agg_5 -->
<g id="edge208" class="edge">
<title>expert_5_11&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2892.82,-7089.61C2890.03,-7089.16 2887.25,-7088.73 2884.5,-7088.32 2701.91,-7060.89 2494.36,-7038.36 2337.83,-7023.11"/>
<polygon fill="black" stroke="black" points="2337.88,-7019.6 2327.59,-7022.12 2337.21,-7026.57 2337.88,-7019.6"/>
</g>
<!-- expert_5_12 -->
<g id="node122" class="node">
<title>expert_5_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-7140.32 3156,-7140.32 3156,-7088.32 3401,-7088.32 3401,-7140.32"/>
<text text-anchor="middle" x="3278.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 12 Layer 5</text>
<text text-anchor="middle" x="3278.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 2)</text>
<text text-anchor="middle" x="3278.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_12&#45;&gt;agg_5 -->
<g id="edge210" class="edge">
<title>expert_5_12&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M3155.84,-7089.5C3153.04,-7089.09 3150.25,-7088.7 3147.5,-7088.32 2866.94,-7050.07 2541.87,-7026.32 2327.98,-7013.48"/>
<polygon fill="black" stroke="black" points="2328.07,-7009.98 2317.87,-7012.88 2327.65,-7016.97 2328.07,-7009.98"/>
</g>
<!-- expert_5_13 -->
<g id="node123" class="node">
<title>expert_5_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-7140.32 3419,-7140.32 3419,-7088.32 3664,-7088.32 3664,-7140.32"/>
<text text-anchor="middle" x="3541.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 13 Layer 5</text>
<text text-anchor="middle" x="3541.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 2)</text>
<text text-anchor="middle" x="3541.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_13&#45;&gt;agg_5 -->
<g id="edge212" class="edge">
<title>expert_5_13&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M3418.85,-7089.44C3416.04,-7089.05 3413.26,-7088.67 3410.5,-7088.32 3030.7,-7039.71 2585.55,-7017.49 2322.49,-7007.92"/>
<polygon fill="black" stroke="black" points="2322.55,-7004.42 2312.43,-7007.55 2322.3,-7011.41 2322.55,-7004.42"/>
</g>
<!-- expert_5_14 -->
<g id="node124" class="node">
<title>expert_5_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-7140.32 3682,-7140.32 3682,-7088.32 3927,-7088.32 3927,-7140.32"/>
<text text-anchor="middle" x="3804.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 14 Layer 5</text>
<text text-anchor="middle" x="3804.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 2)</text>
<text text-anchor="middle" x="3804.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_14&#45;&gt;agg_5 -->
<g id="edge214" class="edge">
<title>expert_5_14&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M3681.85,-7089.4C3679.04,-7089.02 3676.26,-7088.66 3673.5,-7088.32 3193.37,-7029.55 2626.21,-7010.46 2319.23,-7004.28"/>
<polygon fill="black" stroke="black" points="2318.94,-7000.77 2308.87,-7004.07 2318.8,-7007.77 2318.94,-7000.77"/>
</g>
<!-- expert_5_15 -->
<g id="node125" class="node">
<title>expert_5_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-7140.32 3945,-7140.32 3945,-7088.32 4190,-7088.32 4190,-7140.32"/>
<text text-anchor="middle" x="4067.5" y="-7128.32" font-family="Arial" font-size="10.00">Expert 15 Layer 5</text>
<text text-anchor="middle" x="4067.5" y="-7117.32" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 2)</text>
<text text-anchor="middle" x="4067.5" y="-7106.32" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-7095.32" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_5_15&#45;&gt;agg_5 -->
<g id="edge216" class="edge">
<title>expert_5_15&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M3944.86,-7089.37C3942.05,-7089 3939.26,-7088.65 3936.5,-7088.32 3354.67,-7019.41 2663.37,-7004.57 2316.45,-7001.7"/>
<polygon fill="black" stroke="black" points="2316.31,-6998.2 2306.29,-7001.62 2316.26,-7005.2 2316.31,-6998.2"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_0 -->
<g id="edge185" class="edge">
<title>all2all_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" d="M1915.5,-7208.53C1522.04,-7200.14 590.94,-7177.14 255.38,-7140.45"/>
<polygon fill="black" stroke="black" points="255.47,-7136.94 245.14,-7139.3 254.69,-7143.89 255.47,-7136.94"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_1 -->
<g id="edge187" class="edge">
<title>all2all_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" d="M1913.96,-7212.26C1622.01,-7210.67 1028.27,-7199.7 518.28,-7140.46"/>
<polygon fill="black" stroke="black" points="518.48,-7136.96 508.14,-7139.28 517.67,-7143.92 518.48,-7136.96"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_2 -->
<g id="edge189" class="edge">
<title>all2all_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" d="M1914.63,-7209.9C1662.79,-7205.11 1190.87,-7189.88 781.12,-7140.45"/>
<polygon fill="black" stroke="black" points="781.5,-7136.97 771.15,-7139.24 780.65,-7143.92 781.5,-7136.97"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_3 -->
<g id="edge191" class="edge">
<title>all2all_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" d="M1917.03,-7206.51C1709.64,-7198.49 1356.12,-7180.2 1044.3,-7140.49"/>
<polygon fill="black" stroke="black" points="1044.52,-7136.99 1034.15,-7139.19 1043.63,-7143.94 1044.52,-7136.99"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_4 -->
<g id="edge193" class="edge">
<title>all2all_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" d="M1923.49,-7201.38C1765.73,-7190.38 1524.89,-7170.72 1307.19,-7140.51"/>
<polygon fill="black" stroke="black" points="1307.55,-7137.03 1297.17,-7139.11 1306.58,-7143.96 1307.55,-7137.03"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_5 -->
<g id="edge195" class="edge">
<title>all2all_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" d="M1941.98,-7193.45C1839.48,-7180.4 1701.14,-7161.8 1570.39,-7140.6"/>
<polygon fill="black" stroke="black" points="1570.62,-7137.09 1560.19,-7138.94 1569.5,-7144 1570.62,-7137.09"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_6 -->
<g id="edge197" class="edge">
<title>all2all_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" d="M1981.6,-7184.36C1928.4,-7171.29 1865.13,-7155.76 1812.1,-7142.73"/>
<polygon fill="black" stroke="black" points="1812.87,-7139.32 1802.32,-7140.33 1811.2,-7146.11 1812.87,-7139.32"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_7 -->
<g id="edge199" class="edge">
<title>all2all_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" d="M2047.58,-7177.43C2033.84,-7167.28 2018.91,-7156.25 2005.49,-7146.34"/>
<polygon fill="black" stroke="black" points="2007.49,-7143.46 1997.36,-7140.34 2003.33,-7149.09 2007.49,-7143.46"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_8 -->
<g id="edge201" class="edge">
<title>all2all_5&#45;&gt;expert_5_8</title>
<path fill="none" stroke="black" d="M2141.78,-7177.43C2155.63,-7167.28 2170.67,-7156.25 2184.19,-7146.34"/>
<polygon fill="black" stroke="black" points="2186.38,-7149.07 2192.38,-7140.34 2182.25,-7143.42 2186.38,-7149.07"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_9 -->
<g id="edge203" class="edge">
<title>all2all_5&#45;&gt;expert_5_9</title>
<path fill="none" stroke="black" d="M2207.43,-7184.43C2260.77,-7171.36 2324.25,-7155.81 2377.47,-7142.77"/>
<polygon fill="black" stroke="black" points="2378.41,-7146.14 2387.29,-7140.36 2376.74,-7139.34 2378.41,-7146.14"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_10 -->
<g id="edge205" class="edge">
<title>all2all_5&#45;&gt;expert_5_10</title>
<path fill="none" stroke="black" d="M2247.31,-7193.46C2350.01,-7180.42 2488.61,-7161.82 2619.59,-7140.6"/>
<polygon fill="black" stroke="black" points="2620.5,-7144 2629.81,-7138.94 2619.38,-7137.09 2620.5,-7144"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_11 -->
<g id="edge207" class="edge">
<title>all2all_5&#45;&gt;expert_5_11</title>
<path fill="none" stroke="black" d="M2265.73,-7201.4C2423.69,-7190.4 2664.83,-7170.75 2882.8,-7140.51"/>
<polygon fill="black" stroke="black" points="2883.42,-7143.96 2892.84,-7139.11 2882.45,-7137.03 2883.42,-7143.96"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_12 -->
<g id="edge209" class="edge">
<title>all2all_5&#45;&gt;expert_5_12</title>
<path fill="none" stroke="black" d="M2272.14,-7206.52C2479.73,-7198.51 2833.58,-7180.23 3145.69,-7140.49"/>
<polygon fill="black" stroke="black" points="3146.37,-7143.94 3155.85,-7139.19 3145.48,-7136.99 3146.37,-7143.94"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_13 -->
<g id="edge211" class="edge">
<title>all2all_5&#45;&gt;expert_5_13</title>
<path fill="none" stroke="black" d="M2274.24,-7209.91C2526.2,-7205.13 2998.67,-7189.93 3408.87,-7140.46"/>
<polygon fill="black" stroke="black" points="3409.35,-7143.92 3418.85,-7139.24 3408.5,-7136.97 3409.35,-7143.92"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_14 -->
<g id="edge213" class="edge">
<title>all2all_5&#45;&gt;expert_5_14</title>
<path fill="none" stroke="black" d="M2274.85,-7212.27C2566.88,-7210.69 3161.23,-7199.75 3671.71,-7140.46"/>
<polygon fill="black" stroke="black" points="3672.33,-7143.92 3681.86,-7139.28 3671.52,-7136.96 3672.33,-7143.92"/>
</g>
<!-- all2all_5&#45;&gt;expert_5_15 -->
<g id="edge215" class="edge">
<title>all2all_5&#45;&gt;expert_5_15</title>
<path fill="none" stroke="black" d="M2273.6,-7208.53C2667.27,-7200.15 3598.88,-7177.16 3934.62,-7140.45"/>
<polygon fill="black" stroke="black" points="3935.31,-7143.89 3944.86,-7139.3 3934.53,-7136.94 3935.31,-7143.89"/>
</g>
<!-- attn_6 -->
<g id="node128" class="node">
<title>attn_6</title>
<polygon fill="lightblue" stroke="black" points="2235,-6912.32 1954,-6912.32 1954,-6860.32 2235,-6860.32 2235,-6912.32"/>
<text text-anchor="middle" x="2094.5" y="-6900.32" font-family="Arial" font-size="10.00">Attention Layer 6</text>
<text text-anchor="middle" x="2094.5" y="-6889.32" font-family="Arial" font-size="10.00">GPU: 2 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-6878.32" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-6867.32" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_5&#45;&gt;attn_6 -->
<g id="edge217" class="edge">
<title>agg_5&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M2094.5,-6948.24C2094.5,-6939.57 2094.5,-6930.75 2094.5,-6922.61"/>
<polygon fill="black" stroke="black" points="2098,-6922.36 2094.5,-6912.36 2091,-6922.36 2098,-6922.36"/>
</g>
<!-- comm_attn_6 -->
<g id="node129" class="node">
<title>comm_attn_6</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-6787.55" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-6801.55" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-6790.55" font-family="Arial" font-size="10.00">GPU: 2 ↔ GPU: 3, 4, 5</text>
<text text-anchor="middle" x="2094.5" y="-6779.55" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6768.55" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_6&#45;&gt;comm_attn_6 -->
<g id="edge218" class="edge">
<title>attn_6&#45;&gt;comm_attn_6</title>
<path fill="none" stroke="black" d="M2094.5,-6860.15C2094.5,-6852.34 2094.5,-6843.47 2094.5,-6834.71"/>
<polygon fill="black" stroke="black" points="2098,-6834.53 2094.5,-6824.53 2091,-6834.53 2098,-6834.53"/>
</g>
<!-- gate_6 -->
<g id="node130" class="node">
<title>gate_6</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-6714.78 1931.71,-6714.78 1818.95,-6610.78 2257.29,-6610.78 2370.05,-6714.78"/>
<text text-anchor="middle" x="2094.5" y="-6676.78" font-family="Arial" font-size="10.00">Expert Gate 6</text>
<text text-anchor="middle" x="2094.5" y="-6665.78" font-family="Arial" font-size="10.00">GPU: 2 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-6654.78" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6643.78" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_6&#45;&gt;gate_6 -->
<g id="edge219" class="edge">
<title>comm_attn_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M2094.5,-6750.71C2094.5,-6742.67 2094.5,-6733.93 2094.5,-6725.18"/>
<polygon fill="black" stroke="black" points="2098,-6724.95 2094.5,-6714.95 2091,-6724.95 2098,-6724.95"/>
</g>
<!-- all2all_6 -->
<g id="node147" class="node">
<title>all2all_6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-6538.01" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-6552.01" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-6541.01" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 3)</text>
<text text-anchor="middle" x="2094.5" y="-6530.01" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6519.01" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_6&#45;&gt;all2all_6 -->
<g id="edge220" class="edge">
<title>gate_6&#45;&gt;all2all_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-6610.43C2094.5,-6602.02 2094.5,-6593.35 2094.5,-6585.08"/>
<polygon fill="black" stroke="black" points="2098,-6584.87 2094.5,-6574.87 2091,-6584.87 2098,-6584.87"/>
</g>
<!-- expert_6_0 -->
<g id="node131" class="node">
<title>expert_6_0</title>
<polygon fill="lightblue" stroke="black" points="245,-6465.24 0,-6465.24 0,-6413.24 245,-6413.24 245,-6465.24"/>
<text text-anchor="middle" x="122.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 0 Layer 6</text>
<text text-anchor="middle" x="122.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 3)</text>
<text text-anchor="middle" x="122.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_6 -->
<g id="node148" class="node">
<title>agg_6</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-6377.24 1938.39,-6377.24 1830.26,-6273.24 2250.61,-6273.24 2358.74,-6377.24"/>
<text text-anchor="middle" x="2094.5" y="-6339.24" font-family="Arial" font-size="10.00">Expert Aggregation 6</text>
<text text-anchor="middle" x="2094.5" y="-6328.24" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-6317.24" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6306.24" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_0&#45;&gt;agg_6 -->
<g id="edge222" class="edge">
<title>expert_6_0&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M245.14,-6414.29C247.95,-6413.92 250.74,-6413.57 253.5,-6413.24 836.59,-6344.18 1529.68,-6329.42 1875.48,-6326.61"/>
<polygon fill="black" stroke="black" points="1875.63,-6330.11 1885.61,-6326.53 1875.58,-6323.11 1875.63,-6330.11"/>
</g>
<!-- expert_6_1 -->
<g id="node132" class="node">
<title>expert_6_1</title>
<polygon fill="lightblue" stroke="black" points="508,-6465.24 263,-6465.24 263,-6413.24 508,-6413.24 508,-6465.24"/>
<text text-anchor="middle" x="385.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 1 Layer 6</text>
<text text-anchor="middle" x="385.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 3)</text>
<text text-anchor="middle" x="385.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_1&#45;&gt;agg_6 -->
<g id="edge224" class="edge">
<title>expert_6_1&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M508.15,-6414.32C510.96,-6413.94 513.74,-6413.58 516.5,-6413.24 1000.37,-6354 1572.67,-6335.09 1877.6,-6329.06"/>
<polygon fill="black" stroke="black" points="1877.96,-6332.55 1887.89,-6328.85 1877.82,-6325.55 1877.96,-6332.55"/>
</g>
<!-- expert_6_2 -->
<g id="node133" class="node">
<title>expert_6_2</title>
<polygon fill="lightblue" stroke="black" points="771,-6465.24 526,-6465.24 526,-6413.24 771,-6413.24 771,-6465.24"/>
<text text-anchor="middle" x="648.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 2 Layer 6</text>
<text text-anchor="middle" x="648.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 3)</text>
<text text-anchor="middle" x="648.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_2&#45;&gt;agg_6 -->
<g id="edge226" class="edge">
<title>expert_6_2&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M771.15,-6414.36C773.96,-6413.97 776.74,-6413.6 779.5,-6413.24 1165.96,-6363.77 1620.14,-6341.62 1880.94,-6332.33"/>
<polygon fill="black" stroke="black" points="1881.42,-6335.82 1891.29,-6331.97 1881.17,-6328.82 1881.42,-6335.82"/>
</g>
<!-- expert_6_3 -->
<g id="node134" class="node">
<title>expert_6_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-6465.24 789,-6465.24 789,-6413.24 1034,-6413.24 1034,-6465.24"/>
<text text-anchor="middle" x="911.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 3 Layer 6</text>
<text text-anchor="middle" x="911.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 3)</text>
<text text-anchor="middle" x="911.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_3&#45;&gt;agg_6 -->
<g id="edge228" class="edge">
<title>expert_6_3&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1034.16,-6414.43C1036.96,-6414.01 1039.75,-6413.62 1042.5,-6413.24 1333.63,-6373.54 1672.73,-6349.44 1885.52,-6336.98"/>
<polygon fill="black" stroke="black" points="1885.78,-6340.47 1895.56,-6336.39 1885.37,-6333.48 1885.78,-6340.47"/>
</g>
<!-- expert_6_4 -->
<g id="node135" class="node">
<title>expert_6_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-6465.24 1052,-6465.24 1052,-6413.24 1297,-6413.24 1297,-6465.24"/>
<text text-anchor="middle" x="1174.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 4 Layer 6</text>
<text text-anchor="middle" x="1174.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 3)</text>
<text text-anchor="middle" x="1174.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_4&#45;&gt;agg_6 -->
<g id="edge230" class="edge">
<title>expert_6_4&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1297.18,-6414.53C1299.97,-6414.09 1302.75,-6413.66 1305.5,-6413.24 1504.19,-6383.38 1732.48,-6359.31 1892.21,-6344.12"/>
<polygon fill="black" stroke="black" points="1893.01,-6347.57 1902.63,-6343.14 1892.35,-6340.6 1893.01,-6347.57"/>
</g>
<!-- expert_6_5 -->
<g id="node136" class="node">
<title>expert_6_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-6465.24 1315,-6465.24 1315,-6413.24 1560,-6413.24 1560,-6465.24"/>
<text text-anchor="middle" x="1437.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 5 Layer 6</text>
<text text-anchor="middle" x="1437.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 3)</text>
<text text-anchor="middle" x="1437.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_5&#45;&gt;agg_6 -->
<g id="edge232" class="edge">
<title>expert_6_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1560.21,-6414.73C1563,-6414.23 1565.76,-6413.73 1568.5,-6413.24 1679.84,-6393.41 1804.72,-6372.7 1904.85,-6356.45"/>
<polygon fill="black" stroke="black" points="1905.46,-6359.9 1914.77,-6354.85 1904.34,-6352.99 1905.46,-6359.9"/>
</g>
<!-- expert_6_6 -->
<g id="node137" class="node">
<title>expert_6_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-6465.24 1578,-6465.24 1578,-6413.24 1823,-6413.24 1823,-6465.24"/>
<text text-anchor="middle" x="1700.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 6 Layer 6</text>
<text text-anchor="middle" x="1700.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 3)</text>
<text text-anchor="middle" x="1700.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_6&#45;&gt;agg_6 -->
<g id="edge234" class="edge">
<title>expert_6_6&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1788.92,-6413.11C1828.53,-6401.85 1876.66,-6388.17 1922.89,-6375.03"/>
<polygon fill="black" stroke="black" points="1924.06,-6378.33 1932.72,-6372.23 1922.14,-6371.6 1924.06,-6378.33"/>
</g>
<!-- expert_6_7 -->
<g id="node138" class="node">
<title>expert_6_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-6465.24 1841,-6465.24 1841,-6413.24 2086,-6413.24 2086,-6465.24"/>
<text text-anchor="middle" x="1963.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 7 Layer 6</text>
<text text-anchor="middle" x="1963.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 3)</text>
<text text-anchor="middle" x="1963.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_7&#45;&gt;agg_6 -->
<g id="edge236" class="edge">
<title>expert_6_7&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1992.9,-6413.11C2003.05,-6404.43 2014.88,-6394.32 2026.8,-6384.12"/>
<polygon fill="black" stroke="black" points="2029.31,-6386.58 2034.64,-6377.42 2024.76,-6381.26 2029.31,-6386.58"/>
</g>
<!-- expert_6_8 -->
<g id="node139" class="node">
<title>expert_6_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-6465.24 2104,-6465.24 2104,-6413.24 2349,-6413.24 2349,-6465.24"/>
<text text-anchor="middle" x="2226.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 8 Layer 6</text>
<text text-anchor="middle" x="2226.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 3)</text>
<text text-anchor="middle" x="2226.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_8&#45;&gt;agg_6 -->
<g id="edge238" class="edge">
<title>expert_6_8&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2196.88,-6413.11C2186.65,-6404.43 2174.73,-6394.32 2162.71,-6384.12"/>
<polygon fill="black" stroke="black" points="2164.71,-6381.22 2154.82,-6377.42 2160.18,-6386.56 2164.71,-6381.22"/>
</g>
<!-- expert_6_9 -->
<g id="node140" class="node">
<title>expert_6_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-6465.24 2367,-6465.24 2367,-6413.24 2612,-6413.24 2612,-6465.24"/>
<text text-anchor="middle" x="2489.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 9 Layer 6</text>
<text text-anchor="middle" x="2489.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 3)</text>
<text text-anchor="middle" x="2489.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_9&#45;&gt;agg_6 -->
<g id="edge240" class="edge">
<title>expert_6_9&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2400.85,-6413.11C2366.21,-6403.29 2325.08,-6391.62 2284.37,-6380.08"/>
<polygon fill="black" stroke="black" points="2285.17,-6376.67 2274.6,-6377.31 2283.26,-6383.4 2285.17,-6376.67"/>
</g>
<!-- expert_6_10 -->
<g id="node141" class="node">
<title>expert_6_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-6465.24 2630,-6465.24 2630,-6413.24 2875,-6413.24 2875,-6465.24"/>
<text text-anchor="middle" x="2752.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 10 Layer 6</text>
<text text-anchor="middle" x="2752.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 3)</text>
<text text-anchor="middle" x="2752.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_10&#45;&gt;agg_6 -->
<g id="edge242" class="edge">
<title>expert_6_10&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2629.79,-6414.73C2627,-6414.23 2624.24,-6413.73 2621.5,-6413.24 2535.88,-6398.01 2442.26,-6382.26 2357.99,-6368.42"/>
<polygon fill="black" stroke="black" points="2358.47,-6364.95 2348.03,-6366.78 2357.33,-6371.86 2358.47,-6364.95"/>
</g>
<!-- expert_6_11 -->
<g id="node142" class="node">
<title>expert_6_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-6465.24 2893,-6465.24 2893,-6413.24 3138,-6413.24 3138,-6465.24"/>
<text text-anchor="middle" x="3015.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 11 Layer 6</text>
<text text-anchor="middle" x="3015.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 3)</text>
<text text-anchor="middle" x="3015.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_11&#45;&gt;agg_6 -->
<g id="edge244" class="edge">
<title>expert_6_11&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2892.82,-6414.53C2890.03,-6414.08 2887.25,-6413.66 2884.5,-6413.24 2701.91,-6385.81 2494.36,-6363.29 2337.83,-6348.03"/>
<polygon fill="black" stroke="black" points="2337.88,-6344.52 2327.59,-6347.04 2337.21,-6351.49 2337.88,-6344.52"/>
</g>
<!-- expert_6_12 -->
<g id="node143" class="node">
<title>expert_6_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-6465.24 3156,-6465.24 3156,-6413.24 3401,-6413.24 3401,-6465.24"/>
<text text-anchor="middle" x="3278.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 12 Layer 6</text>
<text text-anchor="middle" x="3278.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 3)</text>
<text text-anchor="middle" x="3278.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_12&#45;&gt;agg_6 -->
<g id="edge246" class="edge">
<title>expert_6_12&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M3155.84,-6414.43C3153.04,-6414.01 3150.25,-6413.62 3147.5,-6413.24 2866.94,-6374.99 2541.87,-6351.24 2327.98,-6338.41"/>
<polygon fill="black" stroke="black" points="2328.07,-6334.91 2317.87,-6337.8 2327.65,-6341.89 2328.07,-6334.91"/>
</g>
<!-- expert_6_13 -->
<g id="node144" class="node">
<title>expert_6_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-6465.24 3419,-6465.24 3419,-6413.24 3664,-6413.24 3664,-6465.24"/>
<text text-anchor="middle" x="3541.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 13 Layer 6</text>
<text text-anchor="middle" x="3541.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 3)</text>
<text text-anchor="middle" x="3541.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_13&#45;&gt;agg_6 -->
<g id="edge248" class="edge">
<title>expert_6_13&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M3418.85,-6414.36C3416.04,-6413.97 3413.26,-6413.6 3410.5,-6413.24 3030.7,-6364.63 2585.55,-6342.41 2322.49,-6332.84"/>
<polygon fill="black" stroke="black" points="2322.55,-6329.34 2312.43,-6332.47 2322.3,-6336.33 2322.55,-6329.34"/>
</g>
<!-- expert_6_14 -->
<g id="node145" class="node">
<title>expert_6_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-6465.24 3682,-6465.24 3682,-6413.24 3927,-6413.24 3927,-6465.24"/>
<text text-anchor="middle" x="3804.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 14 Layer 6</text>
<text text-anchor="middle" x="3804.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 3)</text>
<text text-anchor="middle" x="3804.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_14&#45;&gt;agg_6 -->
<g id="edge250" class="edge">
<title>expert_6_14&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M3681.85,-6414.32C3679.04,-6413.94 3676.26,-6413.58 3673.5,-6413.24 3193.37,-6354.47 2626.21,-6335.39 2319.23,-6329.2"/>
<polygon fill="black" stroke="black" points="2318.94,-6325.69 2308.87,-6328.99 2318.8,-6332.69 2318.94,-6325.69"/>
</g>
<!-- expert_6_15 -->
<g id="node146" class="node">
<title>expert_6_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-6465.24 3945,-6465.24 3945,-6413.24 4190,-6413.24 4190,-6465.24"/>
<text text-anchor="middle" x="4067.5" y="-6453.24" font-family="Arial" font-size="10.00">Expert 15 Layer 6</text>
<text text-anchor="middle" x="4067.5" y="-6442.24" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 3)</text>
<text text-anchor="middle" x="4067.5" y="-6431.24" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-6420.24" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_6_15&#45;&gt;agg_6 -->
<g id="edge252" class="edge">
<title>expert_6_15&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M3944.86,-6414.29C3942.05,-6413.92 3939.26,-6413.57 3936.5,-6413.24 3354.67,-6344.33 2663.37,-6329.49 2316.45,-6326.62"/>
<polygon fill="black" stroke="black" points="2316.31,-6323.12 2306.29,-6326.54 2316.26,-6330.12 2316.31,-6323.12"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_0 -->
<g id="edge221" class="edge">
<title>all2all_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" d="M1915.5,-6533.45C1522.04,-6525.06 590.94,-6502.07 255.38,-6465.37"/>
<polygon fill="black" stroke="black" points="255.47,-6461.86 245.14,-6464.22 254.69,-6468.81 255.47,-6461.86"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_1 -->
<g id="edge223" class="edge">
<title>all2all_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" d="M1913.96,-6537.18C1622.01,-6535.59 1028.27,-6524.62 518.28,-6465.38"/>
<polygon fill="black" stroke="black" points="518.48,-6461.88 508.14,-6464.2 517.67,-6468.84 518.48,-6461.88"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_2 -->
<g id="edge225" class="edge">
<title>all2all_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" d="M1914.63,-6534.82C1662.79,-6530.03 1190.87,-6514.8 781.12,-6465.38"/>
<polygon fill="black" stroke="black" points="781.5,-6461.9 771.15,-6464.17 780.65,-6468.85 781.5,-6461.9"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_3 -->
<g id="edge227" class="edge">
<title>all2all_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" d="M1917.03,-6531.43C1709.64,-6523.41 1356.12,-6505.12 1044.3,-6465.42"/>
<polygon fill="black" stroke="black" points="1044.52,-6461.92 1034.15,-6464.11 1043.63,-6468.86 1044.52,-6461.92"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_4 -->
<g id="edge229" class="edge">
<title>all2all_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" d="M1923.49,-6526.31C1765.73,-6515.3 1524.89,-6495.64 1307.19,-6465.43"/>
<polygon fill="black" stroke="black" points="1307.55,-6461.95 1297.17,-6464.03 1306.58,-6468.88 1307.55,-6461.95"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_5 -->
<g id="edge231" class="edge">
<title>all2all_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" d="M1941.98,-6518.37C1839.48,-6505.33 1701.14,-6486.72 1570.39,-6465.52"/>
<polygon fill="black" stroke="black" points="1570.62,-6462.01 1560.19,-6463.86 1569.5,-6468.92 1570.62,-6462.01"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_6 -->
<g id="edge233" class="edge">
<title>all2all_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" d="M1981.6,-6509.28C1928.4,-6496.22 1865.13,-6480.68 1812.1,-6467.65"/>
<polygon fill="black" stroke="black" points="1812.87,-6464.24 1802.32,-6465.25 1811.2,-6471.04 1812.87,-6464.24"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_7 -->
<g id="edge235" class="edge">
<title>all2all_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" d="M2047.58,-6502.35C2033.84,-6492.2 2018.91,-6481.17 2005.49,-6471.26"/>
<polygon fill="black" stroke="black" points="2007.49,-6468.38 1997.36,-6465.26 2003.33,-6474.01 2007.49,-6468.38"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_8 -->
<g id="edge237" class="edge">
<title>all2all_6&#45;&gt;expert_6_8</title>
<path fill="none" stroke="black" d="M2141.78,-6502.35C2155.63,-6492.2 2170.67,-6481.17 2184.19,-6471.26"/>
<polygon fill="black" stroke="black" points="2186.38,-6473.99 2192.38,-6465.26 2182.25,-6468.35 2186.38,-6473.99"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_9 -->
<g id="edge239" class="edge">
<title>all2all_6&#45;&gt;expert_6_9</title>
<path fill="none" stroke="black" d="M2207.43,-6509.35C2260.77,-6496.28 2324.25,-6480.73 2377.47,-6467.69"/>
<polygon fill="black" stroke="black" points="2378.41,-6471.06 2387.29,-6465.28 2376.74,-6464.26 2378.41,-6471.06"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_10 -->
<g id="edge241" class="edge">
<title>all2all_6&#45;&gt;expert_6_10</title>
<path fill="none" stroke="black" d="M2247.31,-6518.39C2350.01,-6505.35 2488.61,-6486.75 2619.59,-6465.53"/>
<polygon fill="black" stroke="black" points="2620.5,-6468.92 2629.81,-6463.86 2619.38,-6462.01 2620.5,-6468.92"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_11 -->
<g id="edge243" class="edge">
<title>all2all_6&#45;&gt;expert_6_11</title>
<path fill="none" stroke="black" d="M2265.73,-6526.32C2423.69,-6515.32 2664.83,-6495.67 2882.8,-6465.43"/>
<polygon fill="black" stroke="black" points="2883.42,-6468.88 2892.84,-6464.03 2882.45,-6461.95 2883.42,-6468.88"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_12 -->
<g id="edge245" class="edge">
<title>all2all_6&#45;&gt;expert_6_12</title>
<path fill="none" stroke="black" d="M2272.14,-6531.44C2479.73,-6523.43 2833.58,-6505.15 3145.69,-6465.42"/>
<polygon fill="black" stroke="black" points="3146.37,-6468.86 3155.85,-6464.11 3145.48,-6461.91 3146.37,-6468.86"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_13 -->
<g id="edge247" class="edge">
<title>all2all_6&#45;&gt;expert_6_13</title>
<path fill="none" stroke="black" d="M2274.24,-6534.83C2526.2,-6530.06 2998.67,-6514.85 3408.87,-6465.38"/>
<polygon fill="black" stroke="black" points="3409.35,-6468.85 3418.85,-6464.17 3408.5,-6461.9 3409.35,-6468.85"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_14 -->
<g id="edge249" class="edge">
<title>all2all_6&#45;&gt;expert_6_14</title>
<path fill="none" stroke="black" d="M2274.85,-6537.19C2566.88,-6535.61 3161.23,-6524.67 3671.71,-6465.39"/>
<polygon fill="black" stroke="black" points="3672.33,-6468.84 3681.86,-6464.2 3671.52,-6461.88 3672.33,-6468.84"/>
</g>
<!-- all2all_6&#45;&gt;expert_6_15 -->
<g id="edge251" class="edge">
<title>all2all_6&#45;&gt;expert_6_15</title>
<path fill="none" stroke="black" d="M2273.6,-6533.45C2667.27,-6525.07 3598.88,-6502.08 3934.62,-6465.37"/>
<polygon fill="black" stroke="black" points="3935.31,-6468.81 3944.86,-6464.22 3934.53,-6461.86 3935.31,-6468.81"/>
</g>
<!-- attn_7 -->
<g id="node149" class="node">
<title>attn_7</title>
<polygon fill="lightblue" stroke="black" points="2235,-6237.24 1954,-6237.24 1954,-6185.24 2235,-6185.24 2235,-6237.24"/>
<text text-anchor="middle" x="2094.5" y="-6225.24" font-family="Arial" font-size="10.00">Attention Layer 7</text>
<text text-anchor="middle" x="2094.5" y="-6214.24" font-family="Arial" font-size="10.00">GPU: 3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-6203.24" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-6192.24" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_6&#45;&gt;attn_7 -->
<g id="edge253" class="edge">
<title>agg_6&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M2094.5,-6273.16C2094.5,-6264.49 2094.5,-6255.67 2094.5,-6247.53"/>
<polygon fill="black" stroke="black" points="2098,-6247.29 2094.5,-6237.29 2091,-6247.29 2098,-6247.29"/>
</g>
<!-- comm_attn_7 -->
<g id="node150" class="node">
<title>comm_attn_7</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-6112.47" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-6126.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-6115.47" font-family="Arial" font-size="10.00">GPU: 3 ↔ GPU: 4, 5, 6</text>
<text text-anchor="middle" x="2094.5" y="-6104.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-6093.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_7&#45;&gt;comm_attn_7 -->
<g id="edge254" class="edge">
<title>attn_7&#45;&gt;comm_attn_7</title>
<path fill="none" stroke="black" d="M2094.5,-6185.07C2094.5,-6177.26 2094.5,-6168.4 2094.5,-6159.63"/>
<polygon fill="black" stroke="black" points="2098,-6159.45 2094.5,-6149.45 2091,-6159.45 2098,-6159.45"/>
</g>
<!-- gate_7 -->
<g id="node151" class="node">
<title>gate_7</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-6039.7 1931.71,-6039.7 1818.95,-5935.7 2257.29,-5935.7 2370.05,-6039.7"/>
<text text-anchor="middle" x="2094.5" y="-6001.7" font-family="Arial" font-size="10.00">Expert Gate 7</text>
<text text-anchor="middle" x="2094.5" y="-5990.7" font-family="Arial" font-size="10.00">GPU: 3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-5979.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5968.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_7&#45;&gt;gate_7 -->
<g id="edge255" class="edge">
<title>comm_attn_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M2094.5,-6075.63C2094.5,-6067.6 2094.5,-6058.85 2094.5,-6050.1"/>
<polygon fill="black" stroke="black" points="2098,-6049.87 2094.5,-6039.87 2091,-6049.87 2098,-6049.87"/>
</g>
<!-- all2all_7 -->
<g id="node168" class="node">
<title>all2all_7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-5862.93" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-5876.93" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-5865.93" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (EP Group 3)</text>
<text text-anchor="middle" x="2094.5" y="-5854.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5843.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_7&#45;&gt;all2all_7 -->
<g id="edge256" class="edge">
<title>gate_7&#45;&gt;all2all_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-5935.35C2094.5,-5926.94 2094.5,-5918.27 2094.5,-5910"/>
<polygon fill="black" stroke="black" points="2098,-5909.79 2094.5,-5899.79 2091,-5909.79 2098,-5909.79"/>
</g>
<!-- expert_7_0 -->
<g id="node152" class="node">
<title>expert_7_0</title>
<polygon fill="lightblue" stroke="black" points="245,-5790.16 0,-5790.16 0,-5738.16 245,-5738.16 245,-5790.16"/>
<text text-anchor="middle" x="122.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 0 Layer 7</text>
<text text-anchor="middle" x="122.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 3)</text>
<text text-anchor="middle" x="122.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_7 -->
<g id="node169" class="node">
<title>agg_7</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-5702.16 1938.39,-5702.16 1830.26,-5598.16 2250.61,-5598.16 2358.74,-5702.16"/>
<text text-anchor="middle" x="2094.5" y="-5664.16" font-family="Arial" font-size="10.00">Expert Aggregation 7</text>
<text text-anchor="middle" x="2094.5" y="-5653.16" font-family="Arial" font-size="10.00">GPU: 0&#45;3 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-5642.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5631.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_0&#45;&gt;agg_7 -->
<g id="edge258" class="edge">
<title>expert_7_0&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M245.14,-5739.22C247.95,-5738.84 250.74,-5738.49 253.5,-5738.16 836.59,-5669.1 1529.68,-5654.35 1875.48,-5651.53"/>
<polygon fill="black" stroke="black" points="1875.63,-5655.03 1885.61,-5651.45 1875.58,-5648.03 1875.63,-5655.03"/>
</g>
<!-- expert_7_1 -->
<g id="node153" class="node">
<title>expert_7_1</title>
<polygon fill="lightblue" stroke="black" points="508,-5790.16 263,-5790.16 263,-5738.16 508,-5738.16 508,-5790.16"/>
<text text-anchor="middle" x="385.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 1 Layer 7</text>
<text text-anchor="middle" x="385.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 4 (EP Group 3)</text>
<text text-anchor="middle" x="385.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_1&#45;&gt;agg_7 -->
<g id="edge260" class="edge">
<title>expert_7_1&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M508.15,-5739.24C510.96,-5738.86 513.74,-5738.5 516.5,-5738.16 1000.37,-5678.92 1572.67,-5660.01 1877.6,-5653.98"/>
<polygon fill="black" stroke="black" points="1877.96,-5657.47 1887.89,-5653.78 1877.82,-5650.47 1877.96,-5657.47"/>
</g>
<!-- expert_7_2 -->
<g id="node154" class="node">
<title>expert_7_2</title>
<polygon fill="lightblue" stroke="black" points="771,-5790.16 526,-5790.16 526,-5738.16 771,-5738.16 771,-5790.16"/>
<text text-anchor="middle" x="648.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 2 Layer 7</text>
<text text-anchor="middle" x="648.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 3)</text>
<text text-anchor="middle" x="648.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_2&#45;&gt;agg_7 -->
<g id="edge262" class="edge">
<title>expert_7_2&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M771.15,-5739.29C773.96,-5738.89 776.74,-5738.52 779.5,-5738.16 1165.96,-5688.69 1620.14,-5666.54 1880.94,-5657.26"/>
<polygon fill="black" stroke="black" points="1881.42,-5660.74 1891.29,-5656.89 1881.17,-5653.74 1881.42,-5660.74"/>
</g>
<!-- expert_7_3 -->
<g id="node155" class="node">
<title>expert_7_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-5790.16 789,-5790.16 789,-5738.16 1034,-5738.16 1034,-5790.16"/>
<text text-anchor="middle" x="911.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 3 Layer 7</text>
<text text-anchor="middle" x="911.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 5 (EP Group 3)</text>
<text text-anchor="middle" x="911.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_3&#45;&gt;agg_7 -->
<g id="edge264" class="edge">
<title>expert_7_3&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1034.16,-5739.35C1036.96,-5738.94 1039.75,-5738.54 1042.5,-5738.16 1333.63,-5698.46 1672.73,-5674.36 1885.52,-5661.9"/>
<polygon fill="black" stroke="black" points="1885.78,-5665.39 1895.56,-5661.31 1885.37,-5658.4 1885.78,-5665.39"/>
</g>
<!-- expert_7_4 -->
<g id="node156" class="node">
<title>expert_7_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-5790.16 1052,-5790.16 1052,-5738.16 1297,-5738.16 1297,-5790.16"/>
<text text-anchor="middle" x="1174.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 4 Layer 7</text>
<text text-anchor="middle" x="1174.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 3)</text>
<text text-anchor="middle" x="1174.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_4&#45;&gt;agg_7 -->
<g id="edge266" class="edge">
<title>expert_7_4&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1297.18,-5739.45C1299.97,-5739.01 1302.75,-5738.58 1305.5,-5738.16 1504.19,-5708.3 1732.48,-5684.23 1892.21,-5669.05"/>
<polygon fill="black" stroke="black" points="1893.01,-5672.49 1902.63,-5668.06 1892.35,-5665.52 1893.01,-5672.49"/>
</g>
<!-- expert_7_5 -->
<g id="node157" class="node">
<title>expert_7_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-5790.16 1315,-5790.16 1315,-5738.16 1560,-5738.16 1560,-5790.16"/>
<text text-anchor="middle" x="1437.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 5 Layer 7</text>
<text text-anchor="middle" x="1437.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 6 (EP Group 3)</text>
<text text-anchor="middle" x="1437.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_5&#45;&gt;agg_7 -->
<g id="edge268" class="edge">
<title>expert_7_5&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1560.21,-5739.65C1563,-5739.15 1565.76,-5738.65 1568.5,-5738.16 1679.84,-5718.34 1804.72,-5697.62 1904.85,-5681.37"/>
<polygon fill="black" stroke="black" points="1905.46,-5684.82 1914.77,-5679.77 1904.34,-5677.91 1905.46,-5684.82"/>
</g>
<!-- expert_7_6 -->
<g id="node158" class="node">
<title>expert_7_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-5790.16 1578,-5790.16 1578,-5738.16 1823,-5738.16 1823,-5790.16"/>
<text text-anchor="middle" x="1700.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 6 Layer 7</text>
<text text-anchor="middle" x="1700.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 3)</text>
<text text-anchor="middle" x="1700.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_6&#45;&gt;agg_7 -->
<g id="edge270" class="edge">
<title>expert_7_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1788.92,-5738.03C1828.53,-5726.77 1876.66,-5713.09 1922.89,-5699.95"/>
<polygon fill="black" stroke="black" points="1924.06,-5703.25 1932.72,-5697.15 1922.14,-5696.52 1924.06,-5703.25"/>
</g>
<!-- expert_7_7 -->
<g id="node159" class="node">
<title>expert_7_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-5790.16 1841,-5790.16 1841,-5738.16 2086,-5738.16 2086,-5790.16"/>
<text text-anchor="middle" x="1963.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 7 Layer 7</text>
<text text-anchor="middle" x="1963.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 7 (EP Group 3)</text>
<text text-anchor="middle" x="1963.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_7&#45;&gt;agg_7 -->
<g id="edge272" class="edge">
<title>expert_7_7&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1992.9,-5738.03C2003.05,-5729.35 2014.88,-5719.24 2026.8,-5709.04"/>
<polygon fill="black" stroke="black" points="2029.31,-5711.5 2034.64,-5702.34 2024.76,-5706.18 2029.31,-5711.5"/>
</g>
<!-- expert_7_8 -->
<g id="node160" class="node">
<title>expert_7_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-5790.16 2104,-5790.16 2104,-5738.16 2349,-5738.16 2349,-5790.16"/>
<text text-anchor="middle" x="2226.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 8 Layer 7</text>
<text text-anchor="middle" x="2226.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 3)</text>
<text text-anchor="middle" x="2226.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_8&#45;&gt;agg_7 -->
<g id="edge274" class="edge">
<title>expert_7_8&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2196.88,-5738.03C2186.65,-5729.35 2174.73,-5719.24 2162.71,-5709.04"/>
<polygon fill="black" stroke="black" points="2164.71,-5706.14 2154.82,-5702.34 2160.18,-5711.48 2164.71,-5706.14"/>
</g>
<!-- expert_7_9 -->
<g id="node161" class="node">
<title>expert_7_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-5790.16 2367,-5790.16 2367,-5738.16 2612,-5738.16 2612,-5790.16"/>
<text text-anchor="middle" x="2489.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 9 Layer 7</text>
<text text-anchor="middle" x="2489.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 8 (EP Group 3)</text>
<text text-anchor="middle" x="2489.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_9&#45;&gt;agg_7 -->
<g id="edge276" class="edge">
<title>expert_7_9&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2400.85,-5738.03C2366.21,-5728.21 2325.08,-5716.54 2284.37,-5705"/>
<polygon fill="black" stroke="black" points="2285.17,-5701.59 2274.6,-5702.23 2283.26,-5708.32 2285.17,-5701.59"/>
</g>
<!-- expert_7_10 -->
<g id="node162" class="node">
<title>expert_7_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-5790.16 2630,-5790.16 2630,-5738.16 2875,-5738.16 2875,-5790.16"/>
<text text-anchor="middle" x="2752.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 10 Layer 7</text>
<text text-anchor="middle" x="2752.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 3)</text>
<text text-anchor="middle" x="2752.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_10&#45;&gt;agg_7 -->
<g id="edge278" class="edge">
<title>expert_7_10&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2629.79,-5739.65C2627,-5739.15 2624.24,-5738.65 2621.5,-5738.16 2535.88,-5722.93 2442.26,-5707.18 2357.99,-5693.34"/>
<polygon fill="black" stroke="black" points="2358.47,-5689.87 2348.03,-5691.7 2357.33,-5696.78 2358.47,-5689.87"/>
</g>
<!-- expert_7_11 -->
<g id="node163" class="node">
<title>expert_7_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-5790.16 2893,-5790.16 2893,-5738.16 3138,-5738.16 3138,-5790.16"/>
<text text-anchor="middle" x="3015.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 11 Layer 7</text>
<text text-anchor="middle" x="3015.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 9 (EP Group 3)</text>
<text text-anchor="middle" x="3015.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_11&#45;&gt;agg_7 -->
<g id="edge280" class="edge">
<title>expert_7_11&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2892.82,-5739.45C2890.03,-5739.01 2887.25,-5738.58 2884.5,-5738.16 2701.91,-5710.73 2494.36,-5688.21 2337.83,-5672.96"/>
<polygon fill="black" stroke="black" points="2337.88,-5669.44 2327.59,-5671.96 2337.21,-5676.41 2337.88,-5669.44"/>
</g>
<!-- expert_7_12 -->
<g id="node164" class="node">
<title>expert_7_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-5790.16 3156,-5790.16 3156,-5738.16 3401,-5738.16 3401,-5790.16"/>
<text text-anchor="middle" x="3278.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 12 Layer 7</text>
<text text-anchor="middle" x="3278.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 3)</text>
<text text-anchor="middle" x="3278.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_12&#45;&gt;agg_7 -->
<g id="edge282" class="edge">
<title>expert_7_12&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M3155.84,-5739.35C3153.04,-5738.94 3150.25,-5738.54 3147.5,-5738.16 2866.94,-5699.91 2541.87,-5676.16 2327.98,-5663.33"/>
<polygon fill="black" stroke="black" points="2328.07,-5659.83 2317.87,-5662.73 2327.65,-5666.81 2328.07,-5659.83"/>
</g>
<!-- expert_7_13 -->
<g id="node165" class="node">
<title>expert_7_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-5790.16 3419,-5790.16 3419,-5738.16 3664,-5738.16 3664,-5790.16"/>
<text text-anchor="middle" x="3541.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 13 Layer 7</text>
<text text-anchor="middle" x="3541.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 10 (EP Group 3)</text>
<text text-anchor="middle" x="3541.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_13&#45;&gt;agg_7 -->
<g id="edge284" class="edge">
<title>expert_7_13&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M3418.85,-5739.29C3416.04,-5738.89 3413.26,-5738.52 3410.5,-5738.16 3030.7,-5689.56 2585.55,-5667.33 2322.49,-5657.76"/>
<polygon fill="black" stroke="black" points="2322.55,-5654.26 2312.43,-5657.4 2322.3,-5661.25 2322.55,-5654.26"/>
</g>
<!-- expert_7_14 -->
<g id="node166" class="node">
<title>expert_7_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-5790.16 3682,-5790.16 3682,-5738.16 3927,-5738.16 3927,-5790.16"/>
<text text-anchor="middle" x="3804.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 14 Layer 7</text>
<text text-anchor="middle" x="3804.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 3)</text>
<text text-anchor="middle" x="3804.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_14&#45;&gt;agg_7 -->
<g id="edge286" class="edge">
<title>expert_7_14&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M3681.85,-5739.24C3679.04,-5738.86 3676.26,-5738.5 3673.5,-5738.16 3193.37,-5679.39 2626.21,-5660.31 2319.23,-5654.12"/>
<polygon fill="black" stroke="black" points="2318.94,-5650.62 2308.87,-5653.92 2318.8,-5657.61 2318.94,-5650.62"/>
</g>
<!-- expert_7_15 -->
<g id="node167" class="node">
<title>expert_7_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-5790.16 3945,-5790.16 3945,-5738.16 4190,-5738.16 4190,-5790.16"/>
<text text-anchor="middle" x="4067.5" y="-5778.16" font-family="Arial" font-size="10.00">Expert 15 Layer 7</text>
<text text-anchor="middle" x="4067.5" y="-5767.16" font-family="Arial" font-size="10.00">GPU: 11 (EP Group 3)</text>
<text text-anchor="middle" x="4067.5" y="-5756.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-5745.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_7_15&#45;&gt;agg_7 -->
<g id="edge288" class="edge">
<title>expert_7_15&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M3944.86,-5739.22C3942.05,-5738.84 3939.26,-5738.49 3936.5,-5738.16 3354.67,-5669.26 2663.37,-5654.41 2316.45,-5651.54"/>
<polygon fill="black" stroke="black" points="2316.31,-5648.04 2306.29,-5651.46 2316.26,-5655.04 2316.31,-5648.04"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_0 -->
<g id="edge257" class="edge">
<title>all2all_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" d="M1915.5,-5858.37C1522.04,-5849.99 590.94,-5826.99 255.38,-5790.29"/>
<polygon fill="black" stroke="black" points="255.47,-5786.78 245.14,-5789.15 254.69,-5793.74 255.47,-5786.78"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_1 -->
<g id="edge259" class="edge">
<title>all2all_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" d="M1913.96,-5862.1C1622.01,-5860.51 1028.27,-5849.54 518.28,-5790.31"/>
<polygon fill="black" stroke="black" points="518.48,-5786.81 508.14,-5789.12 517.67,-5793.76 518.48,-5786.81"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_2 -->
<g id="edge261" class="edge">
<title>all2all_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" d="M1914.63,-5859.74C1662.79,-5854.95 1190.87,-5839.72 781.12,-5790.3"/>
<polygon fill="black" stroke="black" points="781.5,-5786.82 771.15,-5789.09 780.65,-5793.77 781.5,-5786.82"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_3 -->
<g id="edge263" class="edge">
<title>all2all_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" d="M1917.03,-5856.35C1709.64,-5848.33 1356.12,-5830.04 1044.3,-5790.34"/>
<polygon fill="black" stroke="black" points="1044.52,-5786.84 1034.15,-5789.04 1043.63,-5793.78 1044.52,-5786.84"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_4 -->
<g id="edge265" class="edge">
<title>all2all_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" d="M1923.49,-5851.23C1765.73,-5840.22 1524.89,-5820.57 1307.19,-5790.35"/>
<polygon fill="black" stroke="black" points="1307.55,-5786.87 1297.17,-5788.95 1306.58,-5793.8 1307.55,-5786.87"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_5 -->
<g id="edge267" class="edge">
<title>all2all_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" d="M1941.98,-5843.29C1839.48,-5830.25 1701.14,-5811.64 1570.39,-5790.45"/>
<polygon fill="black" stroke="black" points="1570.62,-5786.94 1560.19,-5788.78 1569.5,-5793.85 1570.62,-5786.94"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_6 -->
<g id="edge269" class="edge">
<title>all2all_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" d="M1981.6,-5834.2C1928.4,-5821.14 1865.13,-5805.6 1812.1,-5792.57"/>
<polygon fill="black" stroke="black" points="1812.87,-5789.16 1802.32,-5790.17 1811.2,-5795.96 1812.87,-5789.16"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_7 -->
<g id="edge271" class="edge">
<title>all2all_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" d="M2047.58,-5827.27C2033.84,-5817.12 2018.91,-5806.09 2005.49,-5796.19"/>
<polygon fill="black" stroke="black" points="2007.49,-5793.31 1997.36,-5790.18 2003.33,-5798.94 2007.49,-5793.31"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_8 -->
<g id="edge273" class="edge">
<title>all2all_7&#45;&gt;expert_7_8</title>
<path fill="none" stroke="black" d="M2141.78,-5827.27C2155.63,-5817.12 2170.67,-5806.09 2184.19,-5796.19"/>
<polygon fill="black" stroke="black" points="2186.38,-5798.91 2192.38,-5790.18 2182.25,-5793.27 2186.38,-5798.91"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_9 -->
<g id="edge275" class="edge">
<title>all2all_7&#45;&gt;expert_7_9</title>
<path fill="none" stroke="black" d="M2207.43,-5834.27C2260.77,-5821.2 2324.25,-5805.65 2377.47,-5792.61"/>
<polygon fill="black" stroke="black" points="2378.41,-5795.98 2387.29,-5790.21 2376.74,-5789.19 2378.41,-5795.98"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_10 -->
<g id="edge277" class="edge">
<title>all2all_7&#45;&gt;expert_7_10</title>
<path fill="none" stroke="black" d="M2247.31,-5843.31C2350.01,-5830.27 2488.61,-5811.67 2619.59,-5790.45"/>
<polygon fill="black" stroke="black" points="2620.5,-5793.85 2629.81,-5788.78 2619.38,-5786.94 2620.5,-5793.85"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_11 -->
<g id="edge279" class="edge">
<title>all2all_7&#45;&gt;expert_7_11</title>
<path fill="none" stroke="black" d="M2265.73,-5851.24C2423.69,-5840.24 2664.83,-5820.59 2882.8,-5790.35"/>
<polygon fill="black" stroke="black" points="2883.42,-5793.8 2892.84,-5788.95 2882.45,-5786.87 2883.42,-5793.8"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_12 -->
<g id="edge281" class="edge">
<title>all2all_7&#45;&gt;expert_7_12</title>
<path fill="none" stroke="black" d="M2272.14,-5856.36C2479.73,-5848.35 2833.58,-5830.07 3145.69,-5790.34"/>
<polygon fill="black" stroke="black" points="3146.37,-5793.78 3155.85,-5789.04 3145.48,-5786.84 3146.37,-5793.78"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_13 -->
<g id="edge283" class="edge">
<title>all2all_7&#45;&gt;expert_7_13</title>
<path fill="none" stroke="black" d="M2274.24,-5859.75C2526.2,-5854.98 2998.67,-5839.77 3408.87,-5790.3"/>
<polygon fill="black" stroke="black" points="3409.35,-5793.77 3418.85,-5789.09 3408.5,-5786.82 3409.35,-5793.77"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_14 -->
<g id="edge285" class="edge">
<title>all2all_7&#45;&gt;expert_7_14</title>
<path fill="none" stroke="black" d="M2274.85,-5862.11C2566.88,-5860.53 3161.23,-5849.59 3671.71,-5790.31"/>
<polygon fill="black" stroke="black" points="3672.33,-5793.76 3681.86,-5789.12 3671.52,-5786.81 3672.33,-5793.76"/>
</g>
<!-- all2all_7&#45;&gt;expert_7_15 -->
<g id="edge287" class="edge">
<title>all2all_7&#45;&gt;expert_7_15</title>
<path fill="none" stroke="black" d="M2273.6,-5858.37C2667.27,-5849.99 3598.88,-5827 3934.62,-5790.29"/>
<polygon fill="black" stroke="black" points="3935.31,-5793.74 3944.86,-5789.15 3934.53,-5786.78 3935.31,-5793.74"/>
</g>
<!-- pipe_comm_0 -->
<g id="node339" class="node">
<title>pipe_comm_0</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-5525.4" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-5539.4" font-family="Arial" font-size="10.00">Pipeline Stage 0→1</text>
<text text-anchor="middle" x="2094.5" y="-5528.4" font-family="Arial" font-size="10.00">GPU: 0&#45;3 → GPU: 32&#45;35</text>
<text text-anchor="middle" x="2094.5" y="-5517.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="2094.5" y="-5506.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- agg_7&#45;&gt;pipe_comm_0 -->
<g id="edge289" class="edge">
<title>agg_7&#45;&gt;pipe_comm_0</title>
<path fill="none" stroke="black" d="M2094.5,-5597.81C2094.5,-5589.4 2094.5,-5580.74 2094.5,-5572.47"/>
<polygon fill="black" stroke="black" points="2098,-5572.25 2094.5,-5562.25 2091,-5572.25 2098,-5572.25"/>
</g>
<!-- attn_8 -->
<g id="node170" class="node">
<title>attn_8</title>
<polygon fill="lightblue" stroke="black" points="2235,-5452.63 1954,-5452.63 1954,-5400.63 2235,-5400.63 2235,-5452.63"/>
<text text-anchor="middle" x="2094.5" y="-5440.63" font-family="Arial" font-size="10.00">Attention Layer 8</text>
<text text-anchor="middle" x="2094.5" y="-5429.63" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-5418.63" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-5407.63" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- comm_attn_8 -->
<g id="node171" class="node">
<title>comm_attn_8</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-5327.86" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-5341.86" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-5330.86" font-family="Arial" font-size="10.00">GPU: 32 ↔ GPU: 33, 34, 35</text>
<text text-anchor="middle" x="2094.5" y="-5319.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5308.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_8&#45;&gt;comm_attn_8 -->
<g id="edge291" class="edge">
<title>attn_8&#45;&gt;comm_attn_8</title>
<path fill="none" stroke="black" d="M2094.5,-5400.45C2094.5,-5392.64 2094.5,-5383.78 2094.5,-5375.01"/>
<polygon fill="black" stroke="black" points="2098,-5374.83 2094.5,-5364.83 2091,-5374.83 2098,-5374.83"/>
</g>
<!-- gate_8 -->
<g id="node172" class="node">
<title>gate_8</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-5255.09 1931.71,-5255.09 1818.95,-5151.09 2257.29,-5151.09 2370.05,-5255.09"/>
<text text-anchor="middle" x="2094.5" y="-5217.09" font-family="Arial" font-size="10.00">Expert Gate 8</text>
<text text-anchor="middle" x="2094.5" y="-5206.09" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-5195.09" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5184.09" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_8&#45;&gt;gate_8 -->
<g id="edge292" class="edge">
<title>comm_attn_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M2094.5,-5291.02C2094.5,-5282.98 2094.5,-5274.23 2094.5,-5265.48"/>
<polygon fill="black" stroke="black" points="2098,-5265.25 2094.5,-5255.25 2091,-5265.25 2098,-5265.25"/>
</g>
<!-- all2all_8 -->
<g id="node189" class="node">
<title>all2all_8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-5078.32" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-5092.32" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-5081.32" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-5070.32" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-5059.32" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_8&#45;&gt;all2all_8 -->
<g id="edge293" class="edge">
<title>gate_8&#45;&gt;all2all_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-5150.73C2094.5,-5142.32 2094.5,-5133.66 2094.5,-5125.39"/>
<polygon fill="black" stroke="black" points="2098,-5125.17 2094.5,-5115.17 2091,-5125.17 2098,-5125.17"/>
</g>
<!-- expert_8_0 -->
<g id="node173" class="node">
<title>expert_8_0</title>
<polygon fill="lightblue" stroke="black" points="245,-5005.55 0,-5005.55 0,-4953.55 245,-4953.55 245,-5005.55"/>
<text text-anchor="middle" x="122.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 0 Layer 8</text>
<text text-anchor="middle" x="122.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 0)</text>
<text text-anchor="middle" x="122.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_8 -->
<g id="node190" class="node">
<title>agg_8</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-4917.55 1938.39,-4917.55 1830.26,-4813.55 2250.61,-4813.55 2358.74,-4917.55"/>
<text text-anchor="middle" x="2094.5" y="-4879.55" font-family="Arial" font-size="10.00">Expert Aggregation 8</text>
<text text-anchor="middle" x="2094.5" y="-4868.55" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4857.55" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-4846.55" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_0&#45;&gt;agg_8 -->
<g id="edge295" class="edge">
<title>expert_8_0&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M245.14,-4954.6C247.95,-4954.23 250.74,-4953.87 253.5,-4953.55 836.59,-4884.48 1529.68,-4869.73 1875.48,-4866.91"/>
<polygon fill="black" stroke="black" points="1875.63,-4870.41 1885.61,-4866.83 1875.58,-4863.41 1875.63,-4870.41"/>
</g>
<!-- expert_8_1 -->
<g id="node174" class="node">
<title>expert_8_1</title>
<polygon fill="lightblue" stroke="black" points="508,-5005.55 263,-5005.55 263,-4953.55 508,-4953.55 508,-5005.55"/>
<text text-anchor="middle" x="385.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 1 Layer 8</text>
<text text-anchor="middle" x="385.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 0)</text>
<text text-anchor="middle" x="385.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_1&#45;&gt;agg_8 -->
<g id="edge297" class="edge">
<title>expert_8_1&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M508.15,-4954.63C510.96,-4954.25 513.74,-4953.89 516.5,-4953.55 1000.37,-4894.31 1572.67,-4875.39 1877.6,-4869.36"/>
<polygon fill="black" stroke="black" points="1877.96,-4872.85 1887.89,-4869.16 1877.82,-4865.85 1877.96,-4872.85"/>
</g>
<!-- expert_8_2 -->
<g id="node175" class="node">
<title>expert_8_2</title>
<polygon fill="lightblue" stroke="black" points="771,-5005.55 526,-5005.55 526,-4953.55 771,-4953.55 771,-5005.55"/>
<text text-anchor="middle" x="648.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 2 Layer 8</text>
<text text-anchor="middle" x="648.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 0)</text>
<text text-anchor="middle" x="648.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_2&#45;&gt;agg_8 -->
<g id="edge299" class="edge">
<title>expert_8_2&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M771.15,-4954.67C773.96,-4954.27 776.74,-4953.9 779.5,-4953.55 1165.96,-4904.08 1620.14,-4881.93 1880.94,-4872.64"/>
<polygon fill="black" stroke="black" points="1881.42,-4876.12 1891.29,-4872.27 1881.17,-4869.13 1881.42,-4876.12"/>
</g>
<!-- expert_8_3 -->
<g id="node176" class="node">
<title>expert_8_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-5005.55 789,-5005.55 789,-4953.55 1034,-4953.55 1034,-5005.55"/>
<text text-anchor="middle" x="911.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 3 Layer 8</text>
<text text-anchor="middle" x="911.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 0)</text>
<text text-anchor="middle" x="911.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_3&#45;&gt;agg_8 -->
<g id="edge301" class="edge">
<title>expert_8_3&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1034.16,-4954.73C1036.96,-4954.32 1039.75,-4953.92 1042.5,-4953.55 1333.63,-4913.84 1672.73,-4889.75 1885.52,-4877.28"/>
<polygon fill="black" stroke="black" points="1885.78,-4880.77 1895.56,-4876.7 1885.37,-4873.79 1885.78,-4880.77"/>
</g>
<!-- expert_8_4 -->
<g id="node177" class="node">
<title>expert_8_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-5005.55 1052,-5005.55 1052,-4953.55 1297,-4953.55 1297,-5005.55"/>
<text text-anchor="middle" x="1174.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 4 Layer 8</text>
<text text-anchor="middle" x="1174.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 0)</text>
<text text-anchor="middle" x="1174.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_4&#45;&gt;agg_8 -->
<g id="edge303" class="edge">
<title>expert_8_4&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1297.18,-4954.83C1299.97,-4954.39 1302.75,-4953.96 1305.5,-4953.55 1504.19,-4923.68 1732.48,-4899.61 1892.21,-4884.43"/>
<polygon fill="black" stroke="black" points="1893.01,-4887.87 1902.63,-4883.44 1892.35,-4880.9 1893.01,-4887.87"/>
</g>
<!-- expert_8_5 -->
<g id="node178" class="node">
<title>expert_8_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-5005.55 1315,-5005.55 1315,-4953.55 1560,-4953.55 1560,-5005.55"/>
<text text-anchor="middle" x="1437.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 5 Layer 8</text>
<text text-anchor="middle" x="1437.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 0)</text>
<text text-anchor="middle" x="1437.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_5&#45;&gt;agg_8 -->
<g id="edge305" class="edge">
<title>expert_8_5&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1560.21,-4955.03C1563,-4954.53 1565.76,-4954.03 1568.5,-4953.55 1679.84,-4933.72 1804.72,-4913 1904.85,-4896.76"/>
<polygon fill="black" stroke="black" points="1905.46,-4900.2 1914.77,-4895.15 1904.34,-4893.29 1905.46,-4900.2"/>
</g>
<!-- expert_8_6 -->
<g id="node179" class="node">
<title>expert_8_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-5005.55 1578,-5005.55 1578,-4953.55 1823,-4953.55 1823,-5005.55"/>
<text text-anchor="middle" x="1700.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 6 Layer 8</text>
<text text-anchor="middle" x="1700.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 0)</text>
<text text-anchor="middle" x="1700.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_6&#45;&gt;agg_8 -->
<g id="edge307" class="edge">
<title>expert_8_6&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1788.92,-4953.41C1828.53,-4942.15 1876.66,-4928.47 1922.89,-4915.33"/>
<polygon fill="black" stroke="black" points="1924.06,-4918.64 1932.72,-4912.54 1922.14,-4911.9 1924.06,-4918.64"/>
</g>
<!-- expert_8_7 -->
<g id="node180" class="node">
<title>expert_8_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-5005.55 1841,-5005.55 1841,-4953.55 2086,-4953.55 2086,-5005.55"/>
<text text-anchor="middle" x="1963.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 7 Layer 8</text>
<text text-anchor="middle" x="1963.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 0)</text>
<text text-anchor="middle" x="1963.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_7&#45;&gt;agg_8 -->
<g id="edge309" class="edge">
<title>expert_8_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1992.9,-4953.41C2003.05,-4944.74 2014.88,-4934.62 2026.8,-4924.42"/>
<polygon fill="black" stroke="black" points="2029.31,-4926.88 2034.64,-4917.73 2024.76,-4921.56 2029.31,-4926.88"/>
</g>
<!-- expert_8_8 -->
<g id="node181" class="node">
<title>expert_8_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-5005.55 2104,-5005.55 2104,-4953.55 2349,-4953.55 2349,-5005.55"/>
<text text-anchor="middle" x="2226.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 8 Layer 8</text>
<text text-anchor="middle" x="2226.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 0)</text>
<text text-anchor="middle" x="2226.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_8&#45;&gt;agg_8 -->
<g id="edge311" class="edge">
<title>expert_8_8&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M2196.88,-4953.41C2186.65,-4944.74 2174.73,-4934.62 2162.71,-4924.42"/>
<polygon fill="black" stroke="black" points="2164.71,-4921.53 2154.82,-4917.73 2160.18,-4926.86 2164.71,-4921.53"/>
</g>
<!-- expert_8_9 -->
<g id="node182" class="node">
<title>expert_8_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-5005.55 2367,-5005.55 2367,-4953.55 2612,-4953.55 2612,-5005.55"/>
<text text-anchor="middle" x="2489.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 9 Layer 8</text>
<text text-anchor="middle" x="2489.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 0)</text>
<text text-anchor="middle" x="2489.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_9&#45;&gt;agg_8 -->
<g id="edge313" class="edge">
<title>expert_8_9&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M2400.85,-4953.41C2366.21,-4943.59 2325.08,-4931.93 2284.37,-4920.38"/>
<polygon fill="black" stroke="black" points="2285.17,-4916.97 2274.6,-4917.61 2283.26,-4923.71 2285.17,-4916.97"/>
</g>
<!-- expert_8_10 -->
<g id="node183" class="node">
<title>expert_8_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-5005.55 2630,-5005.55 2630,-4953.55 2875,-4953.55 2875,-5005.55"/>
<text text-anchor="middle" x="2752.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 10 Layer 8</text>
<text text-anchor="middle" x="2752.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 0)</text>
<text text-anchor="middle" x="2752.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_10&#45;&gt;agg_8 -->
<g id="edge315" class="edge">
<title>expert_8_10&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M2629.79,-4955.03C2627,-4954.53 2624.24,-4954.03 2621.5,-4953.55 2535.88,-4938.31 2442.26,-4922.56 2357.99,-4908.72"/>
<polygon fill="black" stroke="black" points="2358.47,-4905.25 2348.03,-4907.09 2357.33,-4912.16 2358.47,-4905.25"/>
</g>
<!-- expert_8_11 -->
<g id="node184" class="node">
<title>expert_8_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-5005.55 2893,-5005.55 2893,-4953.55 3138,-4953.55 3138,-5005.55"/>
<text text-anchor="middle" x="3015.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 11 Layer 8</text>
<text text-anchor="middle" x="3015.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 0)</text>
<text text-anchor="middle" x="3015.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_11&#45;&gt;agg_8 -->
<g id="edge317" class="edge">
<title>expert_8_11&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M2892.82,-4954.83C2890.03,-4954.39 2887.25,-4953.96 2884.5,-4953.55 2701.91,-4926.11 2494.36,-4903.59 2337.83,-4888.34"/>
<polygon fill="black" stroke="black" points="2337.88,-4884.83 2327.59,-4887.34 2337.21,-4891.79 2337.88,-4884.83"/>
</g>
<!-- expert_8_12 -->
<g id="node185" class="node">
<title>expert_8_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-5005.55 3156,-5005.55 3156,-4953.55 3401,-4953.55 3401,-5005.55"/>
<text text-anchor="middle" x="3278.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 12 Layer 8</text>
<text text-anchor="middle" x="3278.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 0)</text>
<text text-anchor="middle" x="3278.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_12&#45;&gt;agg_8 -->
<g id="edge319" class="edge">
<title>expert_8_12&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3155.84,-4954.73C3153.04,-4954.32 3150.25,-4953.92 3147.5,-4953.55 2866.94,-4915.3 2541.87,-4891.54 2327.98,-4878.71"/>
<polygon fill="black" stroke="black" points="2328.07,-4875.21 2317.87,-4878.11 2327.65,-4882.2 2328.07,-4875.21"/>
</g>
<!-- expert_8_13 -->
<g id="node186" class="node">
<title>expert_8_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-5005.55 3419,-5005.55 3419,-4953.55 3664,-4953.55 3664,-5005.55"/>
<text text-anchor="middle" x="3541.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 13 Layer 8</text>
<text text-anchor="middle" x="3541.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 0)</text>
<text text-anchor="middle" x="3541.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_13&#45;&gt;agg_8 -->
<g id="edge321" class="edge">
<title>expert_8_13&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3418.85,-4954.67C3416.04,-4954.27 3413.26,-4953.9 3410.5,-4953.55 3030.7,-4904.94 2585.55,-4882.71 2322.49,-4873.14"/>
<polygon fill="black" stroke="black" points="2322.55,-4869.64 2312.43,-4872.78 2322.3,-4876.64 2322.55,-4869.64"/>
</g>
<!-- expert_8_14 -->
<g id="node187" class="node">
<title>expert_8_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-5005.55 3682,-5005.55 3682,-4953.55 3927,-4953.55 3927,-5005.55"/>
<text text-anchor="middle" x="3804.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 14 Layer 8</text>
<text text-anchor="middle" x="3804.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 0)</text>
<text text-anchor="middle" x="3804.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_14&#45;&gt;agg_8 -->
<g id="edge323" class="edge">
<title>expert_8_14&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3681.85,-4954.63C3679.04,-4954.25 3676.26,-4953.89 3673.5,-4953.55 3193.37,-4894.77 2626.21,-4875.69 2319.23,-4869.51"/>
<polygon fill="black" stroke="black" points="2318.94,-4866 2308.87,-4869.3 2318.8,-4873 2318.94,-4866"/>
</g>
<!-- expert_8_15 -->
<g id="node188" class="node">
<title>expert_8_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-5005.55 3945,-5005.55 3945,-4953.55 4190,-4953.55 4190,-5005.55"/>
<text text-anchor="middle" x="4067.5" y="-4993.55" font-family="Arial" font-size="10.00">Expert 15 Layer 8</text>
<text text-anchor="middle" x="4067.5" y="-4982.55" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 0)</text>
<text text-anchor="middle" x="4067.5" y="-4971.55" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-4960.55" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_8_15&#45;&gt;agg_8 -->
<g id="edge325" class="edge">
<title>expert_8_15&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3944.86,-4954.6C3942.05,-4954.23 3939.26,-4953.87 3936.5,-4953.55 3354.67,-4884.64 2663.37,-4869.79 2316.45,-4866.93"/>
<polygon fill="black" stroke="black" points="2316.31,-4863.43 2306.29,-4866.85 2316.26,-4870.43 2316.31,-4863.43"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_0 -->
<g id="edge294" class="edge">
<title>all2all_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" d="M1915.5,-5073.75C1522.04,-5065.37 590.94,-5042.37 255.38,-5005.67"/>
<polygon fill="black" stroke="black" points="255.47,-5002.16 245.14,-5004.53 254.69,-5009.12 255.47,-5002.16"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_1 -->
<g id="edge296" class="edge">
<title>all2all_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" d="M1913.96,-5077.49C1622.01,-5075.89 1028.27,-5064.92 518.28,-5005.69"/>
<polygon fill="black" stroke="black" points="518.48,-5002.19 508.14,-5004.5 517.67,-5009.14 518.48,-5002.19"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_2 -->
<g id="edge298" class="edge">
<title>all2all_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" d="M1914.63,-5075.12C1662.79,-5070.33 1190.87,-5055.11 781.12,-5005.68"/>
<polygon fill="black" stroke="black" points="781.5,-5002.2 771.15,-5004.47 780.65,-5009.15 781.5,-5002.2"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_3 -->
<g id="edge300" class="edge">
<title>all2all_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" d="M1917.03,-5071.73C1709.64,-5063.72 1356.12,-5045.43 1044.3,-5005.72"/>
<polygon fill="black" stroke="black" points="1044.52,-5002.22 1034.15,-5004.42 1043.63,-5009.16 1044.52,-5002.22"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_4 -->
<g id="edge302" class="edge">
<title>all2all_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" d="M1923.49,-5066.61C1765.73,-5055.6 1524.89,-5035.95 1307.19,-5005.73"/>
<polygon fill="black" stroke="black" points="1307.55,-5002.25 1297.17,-5004.33 1306.58,-5009.18 1307.55,-5002.25"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_5 -->
<g id="edge304" class="edge">
<title>all2all_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" d="M1941.98,-5058.68C1839.48,-5045.63 1701.14,-5027.03 1570.39,-5005.83"/>
<polygon fill="black" stroke="black" points="1570.62,-5002.32 1560.19,-5004.17 1569.5,-5009.23 1570.62,-5002.32"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_6 -->
<g id="edge306" class="edge">
<title>all2all_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" d="M1981.6,-5049.59C1928.4,-5036.52 1865.13,-5020.98 1812.1,-5007.96"/>
<polygon fill="black" stroke="black" points="1812.87,-5004.54 1802.32,-5005.56 1811.2,-5011.34 1812.87,-5004.54"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_7 -->
<g id="edge308" class="edge">
<title>all2all_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" d="M2047.58,-5042.65C2033.84,-5032.5 2018.91,-5021.48 2005.49,-5011.57"/>
<polygon fill="black" stroke="black" points="2007.49,-5008.69 1997.36,-5005.56 2003.33,-5014.32 2007.49,-5008.69"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_8 -->
<g id="edge310" class="edge">
<title>all2all_8&#45;&gt;expert_8_8</title>
<path fill="none" stroke="black" d="M2141.78,-5042.65C2155.63,-5032.5 2170.67,-5021.48 2184.19,-5011.57"/>
<polygon fill="black" stroke="black" points="2186.38,-5014.3 2192.38,-5005.56 2182.25,-5008.65 2186.38,-5014.3"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_9 -->
<g id="edge312" class="edge">
<title>all2all_8&#45;&gt;expert_8_9</title>
<path fill="none" stroke="black" d="M2207.43,-5049.65C2260.77,-5036.58 2324.25,-5021.03 2377.47,-5007.99"/>
<polygon fill="black" stroke="black" points="2378.41,-5011.37 2387.29,-5005.59 2376.74,-5004.57 2378.41,-5011.37"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_10 -->
<g id="edge314" class="edge">
<title>all2all_8&#45;&gt;expert_8_10</title>
<path fill="none" stroke="black" d="M2247.31,-5058.69C2350.01,-5045.65 2488.61,-5027.05 2619.59,-5005.83"/>
<polygon fill="black" stroke="black" points="2620.5,-5009.23 2629.81,-5004.17 2619.38,-5002.32 2620.5,-5009.23"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_11 -->
<g id="edge316" class="edge">
<title>all2all_8&#45;&gt;expert_8_11</title>
<path fill="none" stroke="black" d="M2265.73,-5066.62C2423.69,-5055.62 2664.83,-5035.97 2882.8,-5005.74"/>
<polygon fill="black" stroke="black" points="2883.42,-5009.18 2892.84,-5004.33 2882.45,-5002.25 2883.42,-5009.18"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_12 -->
<g id="edge318" class="edge">
<title>all2all_8&#45;&gt;expert_8_12</title>
<path fill="none" stroke="black" d="M2272.14,-5071.74C2479.73,-5063.73 2833.58,-5045.45 3145.69,-5005.72"/>
<polygon fill="black" stroke="black" points="3146.37,-5009.16 3155.85,-5004.42 3145.48,-5002.22 3146.37,-5009.16"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_13 -->
<g id="edge320" class="edge">
<title>all2all_8&#45;&gt;expert_8_13</title>
<path fill="none" stroke="black" d="M2274.24,-5075.13C2526.2,-5070.36 2998.67,-5055.15 3408.87,-5005.68"/>
<polygon fill="black" stroke="black" points="3409.35,-5009.15 3418.85,-5004.47 3408.5,-5002.2 3409.35,-5009.15"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_14 -->
<g id="edge322" class="edge">
<title>all2all_8&#45;&gt;expert_8_14</title>
<path fill="none" stroke="black" d="M2274.85,-5077.49C2566.88,-5075.92 3161.23,-5064.97 3671.71,-5005.69"/>
<polygon fill="black" stroke="black" points="3672.33,-5009.14 3681.86,-5004.5 3671.52,-5002.19 3672.33,-5009.14"/>
</g>
<!-- all2all_8&#45;&gt;expert_8_15 -->
<g id="edge324" class="edge">
<title>all2all_8&#45;&gt;expert_8_15</title>
<path fill="none" stroke="black" d="M2273.6,-5073.76C2667.27,-5065.38 3598.88,-5042.39 3934.62,-5005.67"/>
<polygon fill="black" stroke="black" points="3935.31,-5009.12 3944.86,-5004.53 3934.53,-5002.16 3935.31,-5009.12"/>
</g>
<!-- attn_9 -->
<g id="node191" class="node">
<title>attn_9</title>
<polygon fill="lightblue" stroke="black" points="2235,-4777.55 1954,-4777.55 1954,-4725.55 2235,-4725.55 2235,-4777.55"/>
<text text-anchor="middle" x="2094.5" y="-4765.55" font-family="Arial" font-size="10.00">Attention Layer 9</text>
<text text-anchor="middle" x="2094.5" y="-4754.55" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4743.55" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-4732.55" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_8&#45;&gt;attn_9 -->
<g id="edge326" class="edge">
<title>agg_8&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M2094.5,-4813.46C2094.5,-4804.8 2094.5,-4795.98 2094.5,-4787.83"/>
<polygon fill="black" stroke="black" points="2098,-4787.59 2094.5,-4777.59 2091,-4787.59 2098,-4787.59"/>
</g>
<!-- comm_attn_9 -->
<g id="node192" class="node">
<title>comm_attn_9</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-4652.78" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-4666.78" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-4655.78" font-family="Arial" font-size="10.00">GPU: 33 ↔ GPU: 34, 35, 36</text>
<text text-anchor="middle" x="2094.5" y="-4644.78" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-4633.78" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_9&#45;&gt;comm_attn_9 -->
<g id="edge327" class="edge">
<title>attn_9&#45;&gt;comm_attn_9</title>
<path fill="none" stroke="black" d="M2094.5,-4725.38C2094.5,-4717.57 2094.5,-4708.7 2094.5,-4699.93"/>
<polygon fill="black" stroke="black" points="2098,-4699.75 2094.5,-4689.75 2091,-4699.75 2098,-4699.75"/>
</g>
<!-- gate_9 -->
<g id="node193" class="node">
<title>gate_9</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-4580.01 1931.71,-4580.01 1818.95,-4476.01 2257.29,-4476.01 2370.05,-4580.01"/>
<text text-anchor="middle" x="2094.5" y="-4542.01" font-family="Arial" font-size="10.00">Expert Gate 9</text>
<text text-anchor="middle" x="2094.5" y="-4531.01" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4520.01" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-4509.01" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_9&#45;&gt;gate_9 -->
<g id="edge328" class="edge">
<title>comm_attn_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M2094.5,-4615.94C2094.5,-4607.9 2094.5,-4599.15 2094.5,-4590.4"/>
<polygon fill="black" stroke="black" points="2098,-4590.17 2094.5,-4580.18 2091,-4590.18 2098,-4590.17"/>
</g>
<!-- all2all_9 -->
<g id="node210" class="node">
<title>all2all_9</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-4403.24" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-4417.24" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-4406.24" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4395.24" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-4384.24" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_9&#45;&gt;all2all_9 -->
<g id="edge329" class="edge">
<title>gate_9&#45;&gt;all2all_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-4475.65C2094.5,-4467.25 2094.5,-4458.58 2094.5,-4450.31"/>
<polygon fill="black" stroke="black" points="2098,-4450.09 2094.5,-4440.09 2091,-4450.09 2098,-4450.09"/>
</g>
<!-- expert_9_0 -->
<g id="node194" class="node">
<title>expert_9_0</title>
<polygon fill="lightblue" stroke="black" points="245,-4330.47 0,-4330.47 0,-4278.47 245,-4278.47 245,-4330.47"/>
<text text-anchor="middle" x="122.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 0 Layer 9</text>
<text text-anchor="middle" x="122.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 0)</text>
<text text-anchor="middle" x="122.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_9 -->
<g id="node211" class="node">
<title>agg_9</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-4242.47 1938.39,-4242.47 1830.26,-4138.47 2250.61,-4138.47 2358.74,-4242.47"/>
<text text-anchor="middle" x="2094.5" y="-4204.47" font-family="Arial" font-size="10.00">Expert Aggregation 9</text>
<text text-anchor="middle" x="2094.5" y="-4193.47" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4182.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-4171.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_0&#45;&gt;agg_9 -->
<g id="edge331" class="edge">
<title>expert_9_0&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M245.14,-4279.52C247.95,-4279.15 250.74,-4278.8 253.5,-4278.47 836.59,-4209.4 1529.68,-4194.65 1875.48,-4191.83"/>
<polygon fill="black" stroke="black" points="1875.63,-4195.33 1885.61,-4191.75 1875.58,-4188.33 1875.63,-4195.33"/>
</g>
<!-- expert_9_1 -->
<g id="node195" class="node">
<title>expert_9_1</title>
<polygon fill="lightblue" stroke="black" points="508,-4330.47 263,-4330.47 263,-4278.47 508,-4278.47 508,-4330.47"/>
<text text-anchor="middle" x="385.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 1 Layer 9</text>
<text text-anchor="middle" x="385.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 0)</text>
<text text-anchor="middle" x="385.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_1&#45;&gt;agg_9 -->
<g id="edge333" class="edge">
<title>expert_9_1&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M508.15,-4279.55C510.96,-4279.17 513.74,-4278.81 516.5,-4278.47 1000.37,-4219.23 1572.67,-4200.31 1877.6,-4194.28"/>
<polygon fill="black" stroke="black" points="1877.96,-4197.78 1887.89,-4194.08 1877.82,-4190.78 1877.96,-4197.78"/>
</g>
<!-- expert_9_2 -->
<g id="node196" class="node">
<title>expert_9_2</title>
<polygon fill="lightblue" stroke="black" points="771,-4330.47 526,-4330.47 526,-4278.47 771,-4278.47 771,-4330.47"/>
<text text-anchor="middle" x="648.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 2 Layer 9</text>
<text text-anchor="middle" x="648.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 0)</text>
<text text-anchor="middle" x="648.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_2&#45;&gt;agg_9 -->
<g id="edge335" class="edge">
<title>expert_9_2&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M771.15,-4279.59C773.96,-4279.2 776.74,-4278.82 779.5,-4278.47 1165.96,-4229 1620.14,-4206.85 1880.94,-4197.56"/>
<polygon fill="black" stroke="black" points="1881.42,-4201.05 1891.29,-4197.19 1881.17,-4194.05 1881.42,-4201.05"/>
</g>
<!-- expert_9_3 -->
<g id="node197" class="node">
<title>expert_9_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-4330.47 789,-4330.47 789,-4278.47 1034,-4278.47 1034,-4330.47"/>
<text text-anchor="middle" x="911.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 3 Layer 9</text>
<text text-anchor="middle" x="911.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 0)</text>
<text text-anchor="middle" x="911.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_3&#45;&gt;agg_9 -->
<g id="edge337" class="edge">
<title>expert_9_3&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1034.16,-4279.65C1036.96,-4279.24 1039.75,-4278.84 1042.5,-4278.47 1333.63,-4238.77 1672.73,-4214.67 1885.52,-4202.2"/>
<polygon fill="black" stroke="black" points="1885.78,-4205.69 1895.56,-4201.62 1885.37,-4198.71 1885.78,-4205.69"/>
</g>
<!-- expert_9_4 -->
<g id="node198" class="node">
<title>expert_9_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-4330.47 1052,-4330.47 1052,-4278.47 1297,-4278.47 1297,-4330.47"/>
<text text-anchor="middle" x="1174.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 4 Layer 9</text>
<text text-anchor="middle" x="1174.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 0)</text>
<text text-anchor="middle" x="1174.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_4&#45;&gt;agg_9 -->
<g id="edge339" class="edge">
<title>expert_9_4&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1297.18,-4279.75C1299.97,-4279.31 1302.75,-4278.88 1305.5,-4278.47 1504.19,-4248.6 1732.48,-4224.54 1892.21,-4209.35"/>
<polygon fill="black" stroke="black" points="1893.01,-4212.79 1902.63,-4208.36 1892.35,-4205.82 1893.01,-4212.79"/>
</g>
<!-- expert_9_5 -->
<g id="node199" class="node">
<title>expert_9_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-4330.47 1315,-4330.47 1315,-4278.47 1560,-4278.47 1560,-4330.47"/>
<text text-anchor="middle" x="1437.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 5 Layer 9</text>
<text text-anchor="middle" x="1437.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 0)</text>
<text text-anchor="middle" x="1437.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_5&#45;&gt;agg_9 -->
<g id="edge341" class="edge">
<title>expert_9_5&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1560.21,-4279.96C1563,-4279.45 1565.76,-4278.96 1568.5,-4278.47 1679.84,-4258.64 1804.72,-4237.92 1904.85,-4221.68"/>
<polygon fill="black" stroke="black" points="1905.46,-4225.13 1914.77,-4220.07 1904.34,-4218.22 1905.46,-4225.13"/>
</g>
<!-- expert_9_6 -->
<g id="node200" class="node">
<title>expert_9_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-4330.47 1578,-4330.47 1578,-4278.47 1823,-4278.47 1823,-4330.47"/>
<text text-anchor="middle" x="1700.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 6 Layer 9</text>
<text text-anchor="middle" x="1700.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 0)</text>
<text text-anchor="middle" x="1700.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_6&#45;&gt;agg_9 -->
<g id="edge343" class="edge">
<title>expert_9_6&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1788.92,-4278.33C1828.53,-4267.07 1876.66,-4253.39 1922.89,-4240.25"/>
<polygon fill="black" stroke="black" points="1924.06,-4243.56 1932.72,-4237.46 1922.14,-4236.83 1924.06,-4243.56"/>
</g>
<!-- expert_9_7 -->
<g id="node201" class="node">
<title>expert_9_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-4330.47 1841,-4330.47 1841,-4278.47 2086,-4278.47 2086,-4330.47"/>
<text text-anchor="middle" x="1963.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 7 Layer 9</text>
<text text-anchor="middle" x="1963.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 0)</text>
<text text-anchor="middle" x="1963.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_7&#45;&gt;agg_9 -->
<g id="edge345" class="edge">
<title>expert_9_7&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1992.9,-4278.33C2003.05,-4269.66 2014.88,-4259.54 2026.8,-4249.35"/>
<polygon fill="black" stroke="black" points="2029.31,-4251.81 2034.64,-4242.65 2024.76,-4246.49 2029.31,-4251.81"/>
</g>
<!-- expert_9_8 -->
<g id="node202" class="node">
<title>expert_9_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-4330.47 2104,-4330.47 2104,-4278.47 2349,-4278.47 2349,-4330.47"/>
<text text-anchor="middle" x="2226.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 8 Layer 9</text>
<text text-anchor="middle" x="2226.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 0)</text>
<text text-anchor="middle" x="2226.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_8&#45;&gt;agg_9 -->
<g id="edge347" class="edge">
<title>expert_9_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M2196.88,-4278.33C2186.65,-4269.66 2174.73,-4259.54 2162.71,-4249.35"/>
<polygon fill="black" stroke="black" points="2164.71,-4246.45 2154.82,-4242.65 2160.18,-4251.79 2164.71,-4246.45"/>
</g>
<!-- expert_9_9 -->
<g id="node203" class="node">
<title>expert_9_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-4330.47 2367,-4330.47 2367,-4278.47 2612,-4278.47 2612,-4330.47"/>
<text text-anchor="middle" x="2489.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 9 Layer 9</text>
<text text-anchor="middle" x="2489.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 0)</text>
<text text-anchor="middle" x="2489.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_9&#45;&gt;agg_9 -->
<g id="edge349" class="edge">
<title>expert_9_9&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M2400.85,-4278.33C2366.21,-4268.51 2325.08,-4256.85 2284.37,-4245.31"/>
<polygon fill="black" stroke="black" points="2285.17,-4241.89 2274.6,-4242.53 2283.26,-4248.63 2285.17,-4241.89"/>
</g>
<!-- expert_9_10 -->
<g id="node204" class="node">
<title>expert_9_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-4330.47 2630,-4330.47 2630,-4278.47 2875,-4278.47 2875,-4330.47"/>
<text text-anchor="middle" x="2752.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 10 Layer 9</text>
<text text-anchor="middle" x="2752.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 0)</text>
<text text-anchor="middle" x="2752.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_10&#45;&gt;agg_9 -->
<g id="edge351" class="edge">
<title>expert_9_10&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M2629.79,-4279.96C2627,-4279.45 2624.24,-4278.96 2621.5,-4278.47 2535.88,-4263.23 2442.26,-4247.48 2357.99,-4233.64"/>
<polygon fill="black" stroke="black" points="2358.47,-4230.17 2348.03,-4232.01 2357.33,-4237.08 2358.47,-4230.17"/>
</g>
<!-- expert_9_11 -->
<g id="node205" class="node">
<title>expert_9_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-4330.47 2893,-4330.47 2893,-4278.47 3138,-4278.47 3138,-4330.47"/>
<text text-anchor="middle" x="3015.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 11 Layer 9</text>
<text text-anchor="middle" x="3015.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 0)</text>
<text text-anchor="middle" x="3015.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_11&#45;&gt;agg_9 -->
<g id="edge353" class="edge">
<title>expert_9_11&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M2892.82,-4279.75C2890.03,-4279.31 2887.25,-4278.88 2884.5,-4278.47 2701.91,-4251.04 2494.36,-4228.51 2337.83,-4213.26"/>
<polygon fill="black" stroke="black" points="2337.88,-4209.75 2327.59,-4212.27 2337.21,-4216.72 2337.88,-4209.75"/>
</g>
<!-- expert_9_12 -->
<g id="node206" class="node">
<title>expert_9_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-4330.47 3156,-4330.47 3156,-4278.47 3401,-4278.47 3401,-4330.47"/>
<text text-anchor="middle" x="3278.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 12 Layer 9</text>
<text text-anchor="middle" x="3278.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 0)</text>
<text text-anchor="middle" x="3278.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_12&#45;&gt;agg_9 -->
<g id="edge355" class="edge">
<title>expert_9_12&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3155.84,-4279.65C3153.04,-4279.24 3150.25,-4278.84 3147.5,-4278.47 2866.94,-4240.22 2541.87,-4216.46 2327.98,-4203.63"/>
<polygon fill="black" stroke="black" points="2328.07,-4200.13 2317.87,-4203.03 2327.65,-4207.12 2328.07,-4200.13"/>
</g>
<!-- expert_9_13 -->
<g id="node207" class="node">
<title>expert_9_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-4330.47 3419,-4330.47 3419,-4278.47 3664,-4278.47 3664,-4330.47"/>
<text text-anchor="middle" x="3541.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 13 Layer 9</text>
<text text-anchor="middle" x="3541.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 0)</text>
<text text-anchor="middle" x="3541.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_13&#45;&gt;agg_9 -->
<g id="edge357" class="edge">
<title>expert_9_13&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3418.85,-4279.59C3416.04,-4279.2 3413.26,-4278.82 3410.5,-4278.47 3030.7,-4229.86 2585.55,-4207.63 2322.49,-4198.06"/>
<polygon fill="black" stroke="black" points="2322.55,-4194.56 2312.43,-4197.7 2322.3,-4201.56 2322.55,-4194.56"/>
</g>
<!-- expert_9_14 -->
<g id="node208" class="node">
<title>expert_9_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-4330.47 3682,-4330.47 3682,-4278.47 3927,-4278.47 3927,-4330.47"/>
<text text-anchor="middle" x="3804.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 14 Layer 9</text>
<text text-anchor="middle" x="3804.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 0)</text>
<text text-anchor="middle" x="3804.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_14&#45;&gt;agg_9 -->
<g id="edge359" class="edge">
<title>expert_9_14&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3681.85,-4279.55C3679.04,-4279.17 3676.26,-4278.81 3673.5,-4278.47 3193.37,-4219.69 2626.21,-4200.61 2319.23,-4194.43"/>
<polygon fill="black" stroke="black" points="2318.94,-4190.92 2308.87,-4194.22 2318.8,-4197.92 2318.94,-4190.92"/>
</g>
<!-- expert_9_15 -->
<g id="node209" class="node">
<title>expert_9_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-4330.47 3945,-4330.47 3945,-4278.47 4190,-4278.47 4190,-4330.47"/>
<text text-anchor="middle" x="4067.5" y="-4318.47" font-family="Arial" font-size="10.00">Expert 15 Layer 9</text>
<text text-anchor="middle" x="4067.5" y="-4307.47" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 0)</text>
<text text-anchor="middle" x="4067.5" y="-4296.47" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-4285.47" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_9_15&#45;&gt;agg_9 -->
<g id="edge361" class="edge">
<title>expert_9_15&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3944.86,-4279.52C3942.05,-4279.15 3939.26,-4278.8 3936.5,-4278.47 3354.67,-4209.56 2663.37,-4194.71 2316.45,-4191.85"/>
<polygon fill="black" stroke="black" points="2316.31,-4188.35 2306.29,-4191.77 2316.26,-4195.35 2316.31,-4188.35"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_0 -->
<g id="edge330" class="edge">
<title>all2all_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" d="M1915.5,-4398.67C1522.04,-4390.29 590.94,-4367.29 255.38,-4330.6"/>
<polygon fill="black" stroke="black" points="255.47,-4327.08 245.14,-4329.45 254.69,-4334.04 255.47,-4327.08"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_1 -->
<g id="edge332" class="edge">
<title>all2all_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" d="M1913.96,-4402.41C1622.01,-4400.81 1028.27,-4389.85 518.28,-4330.61"/>
<polygon fill="black" stroke="black" points="518.48,-4327.11 508.14,-4329.43 517.67,-4334.06 518.48,-4327.11"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_2 -->
<g id="edge334" class="edge">
<title>all2all_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" d="M1914.63,-4400.04C1662.79,-4395.25 1190.87,-4380.03 781.12,-4330.6"/>
<polygon fill="black" stroke="black" points="781.5,-4327.12 771.15,-4329.39 780.65,-4334.07 781.5,-4327.12"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_3 -->
<g id="edge336" class="edge">
<title>all2all_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" d="M1917.03,-4396.65C1709.64,-4388.64 1356.12,-4370.35 1044.3,-4330.64"/>
<polygon fill="black" stroke="black" points="1044.52,-4327.14 1034.15,-4329.34 1043.63,-4334.08 1044.52,-4327.14"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_4 -->
<g id="edge338" class="edge">
<title>all2all_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" d="M1923.49,-4391.53C1765.73,-4380.53 1524.89,-4360.87 1307.19,-4330.66"/>
<polygon fill="black" stroke="black" points="1307.55,-4327.17 1297.17,-4329.26 1306.58,-4334.11 1307.55,-4327.17"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_5 -->
<g id="edge340" class="edge">
<title>all2all_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" d="M1941.98,-4383.6C1839.48,-4370.55 1701.14,-4351.95 1570.39,-4330.75"/>
<polygon fill="black" stroke="black" points="1570.62,-4327.24 1560.19,-4329.09 1569.5,-4334.15 1570.62,-4327.24"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_6 -->
<g id="edge342" class="edge">
<title>all2all_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" d="M1981.6,-4374.51C1928.4,-4361.44 1865.13,-4345.9 1812.1,-4332.88"/>
<polygon fill="black" stroke="black" points="1812.87,-4329.46 1802.32,-4330.48 1811.2,-4336.26 1812.87,-4329.46"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_7 -->
<g id="edge344" class="edge">
<title>all2all_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" d="M2047.58,-4367.58C2033.84,-4357.43 2018.91,-4346.4 2005.49,-4336.49"/>
<polygon fill="black" stroke="black" points="2007.49,-4333.61 1997.36,-4330.48 2003.33,-4339.24 2007.49,-4333.61"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_8 -->
<g id="edge346" class="edge">
<title>all2all_9&#45;&gt;expert_9_8</title>
<path fill="none" stroke="black" d="M2141.78,-4367.58C2155.63,-4357.43 2170.67,-4346.4 2184.19,-4336.49"/>
<polygon fill="black" stroke="black" points="2186.38,-4339.22 2192.38,-4330.48 2182.25,-4333.57 2186.38,-4339.22"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_9 -->
<g id="edge348" class="edge">
<title>all2all_9&#45;&gt;expert_9_9</title>
<path fill="none" stroke="black" d="M2207.43,-4374.57C2260.77,-4361.51 2324.25,-4345.95 2377.47,-4332.91"/>
<polygon fill="black" stroke="black" points="2378.41,-4336.29 2387.29,-4330.51 2376.74,-4329.49 2378.41,-4336.29"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_10 -->
<g id="edge350" class="edge">
<title>all2all_9&#45;&gt;expert_9_10</title>
<path fill="none" stroke="black" d="M2247.31,-4383.61C2350.01,-4370.57 2488.61,-4351.97 2619.59,-4330.75"/>
<polygon fill="black" stroke="black" points="2620.5,-4334.15 2629.81,-4329.09 2619.38,-4327.24 2620.5,-4334.15"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_11 -->
<g id="edge352" class="edge">
<title>all2all_9&#45;&gt;expert_9_11</title>
<path fill="none" stroke="black" d="M2265.73,-4391.54C2423.69,-4380.54 2664.83,-4360.89 2882.8,-4330.66"/>
<polygon fill="black" stroke="black" points="2883.42,-4334.11 2892.84,-4329.26 2882.45,-4327.17 2883.42,-4334.11"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_12 -->
<g id="edge354" class="edge">
<title>all2all_9&#45;&gt;expert_9_12</title>
<path fill="none" stroke="black" d="M2272.14,-4396.66C2479.73,-4388.66 2833.58,-4370.38 3145.69,-4330.64"/>
<polygon fill="black" stroke="black" points="3146.37,-4334.08 3155.85,-4329.34 3145.48,-4327.14 3146.37,-4334.08"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_13 -->
<g id="edge356" class="edge">
<title>all2all_9&#45;&gt;expert_9_13</title>
<path fill="none" stroke="black" d="M2274.24,-4400.06C2526.2,-4395.28 2998.67,-4380.07 3408.87,-4330.6"/>
<polygon fill="black" stroke="black" points="3409.35,-4334.07 3418.85,-4329.39 3408.5,-4327.12 3409.35,-4334.07"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_14 -->
<g id="edge358" class="edge">
<title>all2all_9&#45;&gt;expert_9_14</title>
<path fill="none" stroke="black" d="M2274.85,-4402.42C2566.88,-4400.84 3161.23,-4389.89 3671.71,-4330.61"/>
<polygon fill="black" stroke="black" points="3672.33,-4334.06 3681.86,-4329.43 3671.52,-4327.11 3672.33,-4334.06"/>
</g>
<!-- all2all_9&#45;&gt;expert_9_15 -->
<g id="edge360" class="edge">
<title>all2all_9&#45;&gt;expert_9_15</title>
<path fill="none" stroke="black" d="M2273.6,-4398.68C2667.27,-4390.3 3598.88,-4367.31 3934.62,-4330.6"/>
<polygon fill="black" stroke="black" points="3935.31,-4334.04 3944.86,-4329.45 3934.53,-4327.08 3935.31,-4334.04"/>
</g>
<!-- attn_10 -->
<g id="node212" class="node">
<title>attn_10</title>
<polygon fill="lightblue" stroke="black" points="2235,-4102.47 1954,-4102.47 1954,-4050.47 2235,-4050.47 2235,-4102.47"/>
<text text-anchor="middle" x="2094.5" y="-4090.47" font-family="Arial" font-size="10.00">Attention Layer 10</text>
<text text-anchor="middle" x="2094.5" y="-4079.47" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-4068.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-4057.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_9&#45;&gt;attn_10 -->
<g id="edge362" class="edge">
<title>agg_9&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M2094.5,-4138.39C2094.5,-4129.72 2094.5,-4120.9 2094.5,-4112.75"/>
<polygon fill="black" stroke="black" points="2098,-4112.51 2094.5,-4102.51 2091,-4112.51 2098,-4112.51"/>
</g>
<!-- comm_attn_10 -->
<g id="node213" class="node">
<title>comm_attn_10</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-3977.7" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-3991.7" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-3980.7" font-family="Arial" font-size="10.00">GPU: 34 ↔ GPU: 35, 36, 37</text>
<text text-anchor="middle" x="2094.5" y="-3969.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3958.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_10&#45;&gt;comm_attn_10 -->
<g id="edge363" class="edge">
<title>attn_10&#45;&gt;comm_attn_10</title>
<path fill="none" stroke="black" d="M2094.5,-4050.3C2094.5,-4042.49 2094.5,-4033.62 2094.5,-4024.85"/>
<polygon fill="black" stroke="black" points="2098,-4024.68 2094.5,-4014.68 2091,-4024.68 2098,-4024.68"/>
</g>
<!-- gate_10 -->
<g id="node214" class="node">
<title>gate_10</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-3904.93 1931.71,-3904.93 1818.95,-3800.93 2257.29,-3800.93 2370.05,-3904.93"/>
<text text-anchor="middle" x="2094.5" y="-3866.93" font-family="Arial" font-size="10.00">Expert Gate 10</text>
<text text-anchor="middle" x="2094.5" y="-3855.93" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-3844.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3833.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_10&#45;&gt;gate_10 -->
<g id="edge364" class="edge">
<title>comm_attn_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M2094.5,-3940.86C2094.5,-3932.82 2094.5,-3924.07 2094.5,-3915.32"/>
<polygon fill="black" stroke="black" points="2098,-3915.1 2094.5,-3905.1 2091,-3915.1 2098,-3915.1"/>
</g>
<!-- all2all_10 -->
<g id="node231" class="node">
<title>all2all_10</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-3728.16" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-3742.16" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-3731.16" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-3720.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3709.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_10&#45;&gt;all2all_10 -->
<g id="edge365" class="edge">
<title>gate_10&#45;&gt;all2all_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-3800.58C2094.5,-3792.17 2094.5,-3783.5 2094.5,-3775.23"/>
<polygon fill="black" stroke="black" points="2098,-3775.02 2094.5,-3765.02 2091,-3775.02 2098,-3775.02"/>
</g>
<!-- expert_10_0 -->
<g id="node215" class="node">
<title>expert_10_0</title>
<polygon fill="lightblue" stroke="black" points="245,-3655.39 0,-3655.39 0,-3603.39 245,-3603.39 245,-3655.39"/>
<text text-anchor="middle" x="122.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 0 Layer 10</text>
<text text-anchor="middle" x="122.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 1)</text>
<text text-anchor="middle" x="122.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_10 -->
<g id="node232" class="node">
<title>agg_10</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-3567.39 1938.39,-3567.39 1830.26,-3463.39 2250.61,-3463.39 2358.74,-3567.39"/>
<text text-anchor="middle" x="2094.5" y="-3529.39" font-family="Arial" font-size="10.00">Expert Aggregation 10</text>
<text text-anchor="middle" x="2094.5" y="-3518.39" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-3507.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3496.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_0&#45;&gt;agg_10 -->
<g id="edge367" class="edge">
<title>expert_10_0&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M245.14,-3604.44C247.95,-3604.07 250.74,-3603.72 253.5,-3603.39 836.59,-3534.33 1529.68,-3519.57 1875.48,-3516.75"/>
<polygon fill="black" stroke="black" points="1875.63,-3520.25 1885.61,-3516.67 1875.58,-3513.25 1875.63,-3520.25"/>
</g>
<!-- expert_10_1 -->
<g id="node216" class="node">
<title>expert_10_1</title>
<polygon fill="lightblue" stroke="black" points="508,-3655.39 263,-3655.39 263,-3603.39 508,-3603.39 508,-3655.39"/>
<text text-anchor="middle" x="385.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 1 Layer 10</text>
<text text-anchor="middle" x="385.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 1)</text>
<text text-anchor="middle" x="385.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_1&#45;&gt;agg_10 -->
<g id="edge369" class="edge">
<title>expert_10_1&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M508.15,-3604.47C510.96,-3604.09 513.74,-3603.73 516.5,-3603.39 1000.37,-3544.15 1572.67,-3525.23 1877.6,-3519.2"/>
<polygon fill="black" stroke="black" points="1877.96,-3522.7 1887.89,-3519 1877.82,-3515.7 1877.96,-3522.7"/>
</g>
<!-- expert_10_2 -->
<g id="node217" class="node">
<title>expert_10_2</title>
<polygon fill="lightblue" stroke="black" points="771,-3655.39 526,-3655.39 526,-3603.39 771,-3603.39 771,-3655.39"/>
<text text-anchor="middle" x="648.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 2 Layer 10</text>
<text text-anchor="middle" x="648.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 1)</text>
<text text-anchor="middle" x="648.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_2&#45;&gt;agg_10 -->
<g id="edge371" class="edge">
<title>expert_10_2&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M771.15,-3604.51C773.96,-3604.12 776.74,-3603.74 779.5,-3603.39 1165.96,-3553.92 1620.14,-3531.77 1880.94,-3522.48"/>
<polygon fill="black" stroke="black" points="1881.42,-3525.97 1891.29,-3522.12 1881.17,-3518.97 1881.42,-3525.97"/>
</g>
<!-- expert_10_3 -->
<g id="node218" class="node">
<title>expert_10_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-3655.39 789,-3655.39 789,-3603.39 1034,-3603.39 1034,-3655.39"/>
<text text-anchor="middle" x="911.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 3 Layer 10</text>
<text text-anchor="middle" x="911.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 1)</text>
<text text-anchor="middle" x="911.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_3&#45;&gt;agg_10 -->
<g id="edge373" class="edge">
<title>expert_10_3&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1034.16,-3604.57C1036.96,-3604.16 1039.75,-3603.77 1042.5,-3603.39 1333.63,-3563.69 1672.73,-3539.59 1885.52,-3527.13"/>
<polygon fill="black" stroke="black" points="1885.78,-3530.62 1895.56,-3526.54 1885.37,-3523.63 1885.78,-3530.62"/>
</g>
<!-- expert_10_4 -->
<g id="node219" class="node">
<title>expert_10_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-3655.39 1052,-3655.39 1052,-3603.39 1297,-3603.39 1297,-3655.39"/>
<text text-anchor="middle" x="1174.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 4 Layer 10</text>
<text text-anchor="middle" x="1174.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 1)</text>
<text text-anchor="middle" x="1174.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_4&#45;&gt;agg_10 -->
<g id="edge375" class="edge">
<title>expert_10_4&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1297.18,-3604.68C1299.97,-3604.23 1302.75,-3603.8 1305.5,-3603.39 1504.19,-3573.52 1732.48,-3549.46 1892.21,-3534.27"/>
<polygon fill="black" stroke="black" points="1893.01,-3537.71 1902.63,-3533.29 1892.35,-3530.74 1893.01,-3537.71"/>
</g>
<!-- expert_10_5 -->
<g id="node220" class="node">
<title>expert_10_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-3655.39 1315,-3655.39 1315,-3603.39 1560,-3603.39 1560,-3655.39"/>
<text text-anchor="middle" x="1437.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 5 Layer 10</text>
<text text-anchor="middle" x="1437.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 1)</text>
<text text-anchor="middle" x="1437.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_5&#45;&gt;agg_10 -->
<g id="edge377" class="edge">
<title>expert_10_5&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1560.21,-3604.88C1563,-3604.37 1565.76,-3603.88 1568.5,-3603.39 1679.84,-3583.56 1804.72,-3562.84 1904.85,-3546.6"/>
<polygon fill="black" stroke="black" points="1905.46,-3550.05 1914.77,-3544.99 1904.34,-3543.14 1905.46,-3550.05"/>
</g>
<!-- expert_10_6 -->
<g id="node221" class="node">
<title>expert_10_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-3655.39 1578,-3655.39 1578,-3603.39 1823,-3603.39 1823,-3655.39"/>
<text text-anchor="middle" x="1700.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 6 Layer 10</text>
<text text-anchor="middle" x="1700.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 1)</text>
<text text-anchor="middle" x="1700.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_6&#45;&gt;agg_10 -->
<g id="edge379" class="edge">
<title>expert_10_6&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1788.92,-3603.26C1828.53,-3592 1876.66,-3578.32 1922.89,-3565.17"/>
<polygon fill="black" stroke="black" points="1924.06,-3568.48 1932.72,-3562.38 1922.14,-3561.75 1924.06,-3568.48"/>
</g>
<!-- expert_10_7 -->
<g id="node222" class="node">
<title>expert_10_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-3655.39 1841,-3655.39 1841,-3603.39 2086,-3603.39 2086,-3655.39"/>
<text text-anchor="middle" x="1963.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 7 Layer 10</text>
<text text-anchor="middle" x="1963.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 1)</text>
<text text-anchor="middle" x="1963.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_7&#45;&gt;agg_10 -->
<g id="edge381" class="edge">
<title>expert_10_7&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1992.9,-3603.26C2003.05,-3594.58 2014.88,-3584.47 2026.8,-3574.27"/>
<polygon fill="black" stroke="black" points="2029.31,-3576.73 2034.64,-3567.57 2024.76,-3571.41 2029.31,-3576.73"/>
</g>
<!-- expert_10_8 -->
<g id="node223" class="node">
<title>expert_10_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-3655.39 2104,-3655.39 2104,-3603.39 2349,-3603.39 2349,-3655.39"/>
<text text-anchor="middle" x="2226.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 8 Layer 10</text>
<text text-anchor="middle" x="2226.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 1)</text>
<text text-anchor="middle" x="2226.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_8&#45;&gt;agg_10 -->
<g id="edge383" class="edge">
<title>expert_10_8&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2196.88,-3603.26C2186.65,-3594.58 2174.73,-3584.47 2162.71,-3574.27"/>
<polygon fill="black" stroke="black" points="2164.71,-3571.37 2154.82,-3567.57 2160.18,-3576.71 2164.71,-3571.37"/>
</g>
<!-- expert_10_9 -->
<g id="node224" class="node">
<title>expert_10_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-3655.39 2367,-3655.39 2367,-3603.39 2612,-3603.39 2612,-3655.39"/>
<text text-anchor="middle" x="2489.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 9 Layer 10</text>
<text text-anchor="middle" x="2489.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 1)</text>
<text text-anchor="middle" x="2489.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_9&#45;&gt;agg_10 -->
<g id="edge385" class="edge">
<title>expert_10_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2400.85,-3603.26C2366.21,-3593.43 2325.08,-3581.77 2284.37,-3570.23"/>
<polygon fill="black" stroke="black" points="2285.17,-3566.82 2274.6,-3567.46 2283.26,-3573.55 2285.17,-3566.82"/>
</g>
<!-- expert_10_10 -->
<g id="node225" class="node">
<title>expert_10_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-3655.39 2630,-3655.39 2630,-3603.39 2875,-3603.39 2875,-3655.39"/>
<text text-anchor="middle" x="2752.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 10 Layer 10</text>
<text text-anchor="middle" x="2752.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 1)</text>
<text text-anchor="middle" x="2752.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_10&#45;&gt;agg_10 -->
<g id="edge387" class="edge">
<title>expert_10_10&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2629.79,-3604.88C2627,-3604.37 2624.24,-3603.88 2621.5,-3603.39 2535.88,-3588.16 2442.26,-3572.41 2357.99,-3558.56"/>
<polygon fill="black" stroke="black" points="2358.47,-3555.1 2348.03,-3556.93 2357.33,-3562 2358.47,-3555.1"/>
</g>
<!-- expert_10_11 -->
<g id="node226" class="node">
<title>expert_10_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-3655.39 2893,-3655.39 2893,-3603.39 3138,-3603.39 3138,-3655.39"/>
<text text-anchor="middle" x="3015.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 11 Layer 10</text>
<text text-anchor="middle" x="3015.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 1)</text>
<text text-anchor="middle" x="3015.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_11&#45;&gt;agg_10 -->
<g id="edge389" class="edge">
<title>expert_10_11&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2892.82,-3604.68C2890.03,-3604.23 2887.25,-3603.8 2884.5,-3603.39 2701.91,-3575.96 2494.36,-3553.43 2337.83,-3538.18"/>
<polygon fill="black" stroke="black" points="2337.88,-3534.67 2327.59,-3537.19 2337.21,-3541.64 2337.88,-3534.67"/>
</g>
<!-- expert_10_12 -->
<g id="node227" class="node">
<title>expert_10_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-3655.39 3156,-3655.39 3156,-3603.39 3401,-3603.39 3401,-3655.39"/>
<text text-anchor="middle" x="3278.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 12 Layer 10</text>
<text text-anchor="middle" x="3278.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 1)</text>
<text text-anchor="middle" x="3278.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_12&#45;&gt;agg_10 -->
<g id="edge391" class="edge">
<title>expert_10_12&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M3155.84,-3604.57C3153.04,-3604.16 3150.25,-3603.77 3147.5,-3603.39 2866.94,-3565.14 2541.87,-3541.39 2327.98,-3528.55"/>
<polygon fill="black" stroke="black" points="2328.07,-3525.05 2317.87,-3527.95 2327.65,-3532.04 2328.07,-3525.05"/>
</g>
<!-- expert_10_13 -->
<g id="node228" class="node">
<title>expert_10_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-3655.39 3419,-3655.39 3419,-3603.39 3664,-3603.39 3664,-3655.39"/>
<text text-anchor="middle" x="3541.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 13 Layer 10</text>
<text text-anchor="middle" x="3541.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 1)</text>
<text text-anchor="middle" x="3541.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_13&#45;&gt;agg_10 -->
<g id="edge393" class="edge">
<title>expert_10_13&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M3418.85,-3604.51C3416.04,-3604.12 3413.26,-3603.74 3410.5,-3603.39 3030.7,-3554.78 2585.55,-3532.56 2322.49,-3522.99"/>
<polygon fill="black" stroke="black" points="2322.55,-3519.49 2312.43,-3522.62 2322.3,-3526.48 2322.55,-3519.49"/>
</g>
<!-- expert_10_14 -->
<g id="node229" class="node">
<title>expert_10_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-3655.39 3682,-3655.39 3682,-3603.39 3927,-3603.39 3927,-3655.39"/>
<text text-anchor="middle" x="3804.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 14 Layer 10</text>
<text text-anchor="middle" x="3804.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 1)</text>
<text text-anchor="middle" x="3804.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_14&#45;&gt;agg_10 -->
<g id="edge395" class="edge">
<title>expert_10_14&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M3681.85,-3604.47C3679.04,-3604.09 3676.26,-3603.73 3673.5,-3603.39 3193.37,-3544.62 2626.21,-3525.53 2319.23,-3519.35"/>
<polygon fill="black" stroke="black" points="2318.94,-3515.84 2308.87,-3519.14 2318.8,-3522.84 2318.94,-3515.84"/>
</g>
<!-- expert_10_15 -->
<g id="node230" class="node">
<title>expert_10_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-3655.39 3945,-3655.39 3945,-3603.39 4190,-3603.39 4190,-3655.39"/>
<text text-anchor="middle" x="4067.5" y="-3643.39" font-family="Arial" font-size="10.00">Expert 15 Layer 10</text>
<text text-anchor="middle" x="4067.5" y="-3632.39" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 1)</text>
<text text-anchor="middle" x="4067.5" y="-3621.39" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-3610.39" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_10_15&#45;&gt;agg_10 -->
<g id="edge397" class="edge">
<title>expert_10_15&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M3944.86,-3604.44C3942.05,-3604.07 3939.26,-3603.72 3936.5,-3603.39 3354.67,-3534.48 2663.37,-3519.64 2316.45,-3516.77"/>
<polygon fill="black" stroke="black" points="2316.31,-3513.27 2306.29,-3516.69 2316.26,-3520.27 2316.31,-3513.27"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_0 -->
<g id="edge366" class="edge">
<title>all2all_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" d="M1915.5,-3723.6C1522.04,-3715.21 590.94,-3692.21 255.38,-3655.52"/>
<polygon fill="black" stroke="black" points="255.47,-3652.01 245.14,-3654.37 254.69,-3658.96 255.47,-3652.01"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_1 -->
<g id="edge368" class="edge">
<title>all2all_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" d="M1913.96,-3727.33C1622.01,-3725.74 1028.27,-3714.77 518.28,-3655.53"/>
<polygon fill="black" stroke="black" points="518.48,-3652.03 508.14,-3654.35 517.67,-3658.98 518.48,-3652.03"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_2 -->
<g id="edge370" class="edge">
<title>all2all_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" d="M1914.63,-3724.97C1662.79,-3720.18 1190.87,-3704.95 781.12,-3655.52"/>
<polygon fill="black" stroke="black" points="781.5,-3652.04 771.15,-3654.31 780.65,-3658.99 781.5,-3652.04"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_3 -->
<g id="edge372" class="edge">
<title>all2all_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" d="M1917.03,-3721.58C1709.64,-3713.56 1356.12,-3695.27 1044.3,-3655.56"/>
<polygon fill="black" stroke="black" points="1044.52,-3652.06 1034.15,-3654.26 1043.63,-3659.01 1044.52,-3652.06"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_4 -->
<g id="edge374" class="edge">
<title>all2all_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" d="M1923.49,-3716.45C1765.73,-3705.45 1524.89,-3685.79 1307.19,-3655.58"/>
<polygon fill="black" stroke="black" points="1307.55,-3652.1 1297.17,-3654.18 1306.58,-3659.03 1307.55,-3652.1"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_5 -->
<g id="edge376" class="edge">
<title>all2all_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" d="M1941.98,-3708.52C1839.48,-3695.47 1701.14,-3676.87 1570.39,-3655.67"/>
<polygon fill="black" stroke="black" points="1570.62,-3652.16 1560.19,-3654.01 1569.5,-3659.07 1570.62,-3652.16"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_6 -->
<g id="edge378" class="edge">
<title>all2all_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" d="M1981.6,-3699.43C1928.4,-3686.36 1865.13,-3670.83 1812.1,-3657.8"/>
<polygon fill="black" stroke="black" points="1812.87,-3654.39 1802.32,-3655.4 1811.2,-3661.18 1812.87,-3654.39"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_7 -->
<g id="edge380" class="edge">
<title>all2all_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" d="M2047.58,-3692.5C2033.84,-3682.35 2018.91,-3671.32 2005.49,-3661.41"/>
<polygon fill="black" stroke="black" points="2007.49,-3658.53 1997.36,-3655.41 2003.33,-3664.16 2007.49,-3658.53"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_8 -->
<g id="edge382" class="edge">
<title>all2all_10&#45;&gt;expert_10_8</title>
<path fill="none" stroke="black" d="M2141.78,-3692.5C2155.63,-3682.35 2170.67,-3671.32 2184.19,-3661.41"/>
<polygon fill="black" stroke="black" points="2186.38,-3664.14 2192.38,-3655.41 2182.25,-3658.49 2186.38,-3664.14"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_9 -->
<g id="edge384" class="edge">
<title>all2all_10&#45;&gt;expert_10_9</title>
<path fill="none" stroke="black" d="M2207.43,-3699.5C2260.77,-3686.43 2324.25,-3670.88 2377.47,-3657.84"/>
<polygon fill="black" stroke="black" points="2378.41,-3661.21 2387.29,-3655.43 2376.74,-3654.41 2378.41,-3661.21"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_10 -->
<g id="edge386" class="edge">
<title>all2all_10&#45;&gt;expert_10_10</title>
<path fill="none" stroke="black" d="M2247.31,-3708.53C2350.01,-3695.49 2488.61,-3676.89 2619.59,-3655.67"/>
<polygon fill="black" stroke="black" points="2620.5,-3659.07 2629.81,-3654.01 2619.38,-3652.16 2620.5,-3659.07"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_11 -->
<g id="edge388" class="edge">
<title>all2all_10&#45;&gt;expert_10_11</title>
<path fill="none" stroke="black" d="M2265.73,-3716.47C2423.69,-3705.47 2664.83,-3685.82 2882.8,-3655.58"/>
<polygon fill="black" stroke="black" points="2883.42,-3659.03 2892.84,-3654.18 2882.45,-3652.1 2883.42,-3659.03"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_12 -->
<g id="edge390" class="edge">
<title>all2all_10&#45;&gt;expert_10_12</title>
<path fill="none" stroke="black" d="M2272.14,-3721.59C2479.73,-3713.58 2833.58,-3695.3 3145.69,-3655.56"/>
<polygon fill="black" stroke="black" points="3146.37,-3659.01 3155.85,-3654.26 3145.48,-3652.06 3146.37,-3659.01"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_13 -->
<g id="edge392" class="edge">
<title>all2all_10&#45;&gt;expert_10_13</title>
<path fill="none" stroke="black" d="M2274.24,-3724.98C2526.2,-3720.2 2998.67,-3705 3408.87,-3655.53"/>
<polygon fill="black" stroke="black" points="3409.35,-3658.99 3418.85,-3654.31 3408.5,-3652.04 3409.35,-3658.99"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_14 -->
<g id="edge394" class="edge">
<title>all2all_10&#45;&gt;expert_10_14</title>
<path fill="none" stroke="black" d="M2274.85,-3727.34C2566.88,-3725.76 3161.23,-3714.82 3671.71,-3655.53"/>
<polygon fill="black" stroke="black" points="3672.33,-3658.98 3681.86,-3654.35 3671.52,-3652.03 3672.33,-3658.98"/>
</g>
<!-- all2all_10&#45;&gt;expert_10_15 -->
<g id="edge396" class="edge">
<title>all2all_10&#45;&gt;expert_10_15</title>
<path fill="none" stroke="black" d="M2273.6,-3723.6C2667.27,-3715.22 3598.88,-3692.23 3934.62,-3655.52"/>
<polygon fill="black" stroke="black" points="3935.31,-3658.96 3944.86,-3654.37 3934.53,-3652.01 3935.31,-3658.96"/>
</g>
<!-- attn_11 -->
<g id="node233" class="node">
<title>attn_11</title>
<polygon fill="lightblue" stroke="black" points="2235,-3427.39 1954,-3427.39 1954,-3375.39 2235,-3375.39 2235,-3427.39"/>
<text text-anchor="middle" x="2094.5" y="-3415.39" font-family="Arial" font-size="10.00">Attention Layer 11</text>
<text text-anchor="middle" x="2094.5" y="-3404.39" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-3393.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-3382.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_10&#45;&gt;attn_11 -->
<g id="edge398" class="edge">
<title>agg_10&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M2094.5,-3463.31C2094.5,-3454.64 2094.5,-3445.82 2094.5,-3437.68"/>
<polygon fill="black" stroke="black" points="2098,-3437.43 2094.5,-3427.43 2091,-3437.43 2098,-3437.43"/>
</g>
<!-- comm_attn_11 -->
<g id="node234" class="node">
<title>comm_attn_11</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-3302.62" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-3316.62" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-3305.62" font-family="Arial" font-size="10.00">GPU: 35 ↔ GPU: 36, 37, 38</text>
<text text-anchor="middle" x="2094.5" y="-3294.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3283.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_11&#45;&gt;comm_attn_11 -->
<g id="edge399" class="edge">
<title>attn_11&#45;&gt;comm_attn_11</title>
<path fill="none" stroke="black" d="M2094.5,-3375.22C2094.5,-3367.41 2094.5,-3358.54 2094.5,-3349.78"/>
<polygon fill="black" stroke="black" points="2098,-3349.6 2094.5,-3339.6 2091,-3349.6 2098,-3349.6"/>
</g>
<!-- gate_11 -->
<g id="node235" class="node">
<title>gate_11</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-3229.85 1931.71,-3229.85 1818.95,-3125.85 2257.29,-3125.85 2370.05,-3229.85"/>
<text text-anchor="middle" x="2094.5" y="-3191.85" font-family="Arial" font-size="10.00">Expert Gate 11</text>
<text text-anchor="middle" x="2094.5" y="-3180.85" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-3169.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3158.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_11&#45;&gt;gate_11 -->
<g id="edge400" class="edge">
<title>comm_attn_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M2094.5,-3265.78C2094.5,-3257.74 2094.5,-3249 2094.5,-3240.25"/>
<polygon fill="black" stroke="black" points="2098,-3240.02 2094.5,-3230.02 2091,-3240.02 2098,-3240.02"/>
</g>
<!-- all2all_11 -->
<g id="node252" class="node">
<title>all2all_11</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-3053.08" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-3067.08" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-3056.08" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-3045.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-3034.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_11&#45;&gt;all2all_11 -->
<g id="edge401" class="edge">
<title>gate_11&#45;&gt;all2all_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-3125.5C2094.5,-3117.09 2094.5,-3108.42 2094.5,-3100.15"/>
<polygon fill="black" stroke="black" points="2098,-3099.94 2094.5,-3089.94 2091,-3099.94 2098,-3099.94"/>
</g>
<!-- expert_11_0 -->
<g id="node236" class="node">
<title>expert_11_0</title>
<polygon fill="lightblue" stroke="black" points="245,-2980.31 0,-2980.31 0,-2928.31 245,-2928.31 245,-2980.31"/>
<text text-anchor="middle" x="122.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 0 Layer 11</text>
<text text-anchor="middle" x="122.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 1)</text>
<text text-anchor="middle" x="122.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_11 -->
<g id="node253" class="node">
<title>agg_11</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-2892.31 1938.39,-2892.31 1830.26,-2788.31 2250.61,-2788.31 2358.74,-2892.31"/>
<text text-anchor="middle" x="2094.5" y="-2854.31" font-family="Arial" font-size="10.00">Expert Aggregation 11</text>
<text text-anchor="middle" x="2094.5" y="-2843.31" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 0)</text>
<text text-anchor="middle" x="2094.5" y="-2832.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-2821.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_0&#45;&gt;agg_11 -->
<g id="edge403" class="edge">
<title>expert_11_0&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M245.14,-2929.36C247.95,-2928.99 250.74,-2928.64 253.5,-2928.31 836.59,-2859.25 1529.68,-2844.49 1875.48,-2841.68"/>
<polygon fill="black" stroke="black" points="1875.63,-2845.18 1885.61,-2841.6 1875.58,-2838.18 1875.63,-2845.18"/>
</g>
<!-- expert_11_1 -->
<g id="node237" class="node">
<title>expert_11_1</title>
<polygon fill="lightblue" stroke="black" points="508,-2980.31 263,-2980.31 263,-2928.31 508,-2928.31 508,-2980.31"/>
<text text-anchor="middle" x="385.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 1 Layer 11</text>
<text text-anchor="middle" x="385.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 1)</text>
<text text-anchor="middle" x="385.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_1&#45;&gt;agg_11 -->
<g id="edge405" class="edge">
<title>expert_11_1&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M508.15,-2929.39C510.96,-2929.01 513.74,-2928.65 516.5,-2928.31 1000.37,-2869.07 1572.67,-2850.16 1877.6,-2844.13"/>
<polygon fill="black" stroke="black" points="1877.96,-2847.62 1887.89,-2843.92 1877.82,-2840.62 1877.96,-2847.62"/>
</g>
<!-- expert_11_2 -->
<g id="node238" class="node">
<title>expert_11_2</title>
<polygon fill="lightblue" stroke="black" points="771,-2980.31 526,-2980.31 526,-2928.31 771,-2928.31 771,-2980.31"/>
<text text-anchor="middle" x="648.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 2 Layer 11</text>
<text text-anchor="middle" x="648.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 1)</text>
<text text-anchor="middle" x="648.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_2&#45;&gt;agg_11 -->
<g id="edge407" class="edge">
<title>expert_11_2&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M771.15,-2929.43C773.96,-2929.04 776.74,-2928.67 779.5,-2928.31 1165.96,-2878.84 1620.14,-2856.69 1880.94,-2847.4"/>
<polygon fill="black" stroke="black" points="1881.42,-2850.89 1891.29,-2847.04 1881.17,-2843.89 1881.42,-2850.89"/>
</g>
<!-- expert_11_3 -->
<g id="node239" class="node">
<title>expert_11_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-2980.31 789,-2980.31 789,-2928.31 1034,-2928.31 1034,-2980.31"/>
<text text-anchor="middle" x="911.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 3 Layer 11</text>
<text text-anchor="middle" x="911.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 1)</text>
<text text-anchor="middle" x="911.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_3&#45;&gt;agg_11 -->
<g id="edge409" class="edge">
<title>expert_11_3&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1034.16,-2929.5C1036.96,-2929.08 1039.75,-2928.69 1042.5,-2928.31 1333.63,-2888.61 1672.73,-2864.51 1885.52,-2852.05"/>
<polygon fill="black" stroke="black" points="1885.78,-2855.54 1895.56,-2851.46 1885.37,-2848.55 1885.78,-2855.54"/>
</g>
<!-- expert_11_4 -->
<g id="node240" class="node">
<title>expert_11_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-2980.31 1052,-2980.31 1052,-2928.31 1297,-2928.31 1297,-2980.31"/>
<text text-anchor="middle" x="1174.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 4 Layer 11</text>
<text text-anchor="middle" x="1174.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 1)</text>
<text text-anchor="middle" x="1174.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_4&#45;&gt;agg_11 -->
<g id="edge411" class="edge">
<title>expert_11_4&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1297.18,-2929.6C1299.97,-2929.16 1302.75,-2928.73 1305.5,-2928.31 1504.19,-2898.45 1732.48,-2874.38 1892.21,-2859.19"/>
<polygon fill="black" stroke="black" points="1893.01,-2862.64 1902.63,-2858.21 1892.35,-2855.67 1893.01,-2862.64"/>
</g>
<!-- expert_11_5 -->
<g id="node241" class="node">
<title>expert_11_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-2980.31 1315,-2980.31 1315,-2928.31 1560,-2928.31 1560,-2980.31"/>
<text text-anchor="middle" x="1437.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 5 Layer 11</text>
<text text-anchor="middle" x="1437.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 1)</text>
<text text-anchor="middle" x="1437.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_5&#45;&gt;agg_11 -->
<g id="edge413" class="edge">
<title>expert_11_5&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1560.21,-2929.8C1563,-2929.3 1565.76,-2928.8 1568.5,-2928.31 1679.84,-2908.48 1804.72,-2887.77 1904.85,-2871.52"/>
<polygon fill="black" stroke="black" points="1905.46,-2874.97 1914.77,-2869.92 1904.34,-2868.06 1905.46,-2874.97"/>
</g>
<!-- expert_11_6 -->
<g id="node242" class="node">
<title>expert_11_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-2980.31 1578,-2980.31 1578,-2928.31 1823,-2928.31 1823,-2980.31"/>
<text text-anchor="middle" x="1700.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 6 Layer 11</text>
<text text-anchor="middle" x="1700.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 1)</text>
<text text-anchor="middle" x="1700.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_6&#45;&gt;agg_11 -->
<g id="edge415" class="edge">
<title>expert_11_6&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1788.92,-2928.18C1828.53,-2916.92 1876.66,-2903.24 1922.89,-2890.1"/>
<polygon fill="black" stroke="black" points="1924.06,-2893.4 1932.72,-2887.3 1922.14,-2886.67 1924.06,-2893.4"/>
</g>
<!-- expert_11_7 -->
<g id="node243" class="node">
<title>expert_11_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-2980.31 1841,-2980.31 1841,-2928.31 2086,-2928.31 2086,-2980.31"/>
<text text-anchor="middle" x="1963.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 7 Layer 11</text>
<text text-anchor="middle" x="1963.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 1)</text>
<text text-anchor="middle" x="1963.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_7&#45;&gt;agg_11 -->
<g id="edge417" class="edge">
<title>expert_11_7&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1992.9,-2928.18C2003.05,-2919.5 2014.88,-2909.39 2026.8,-2899.19"/>
<polygon fill="black" stroke="black" points="2029.31,-2901.65 2034.64,-2892.49 2024.76,-2896.33 2029.31,-2901.65"/>
</g>
<!-- expert_11_8 -->
<g id="node244" class="node">
<title>expert_11_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-2980.31 2104,-2980.31 2104,-2928.31 2349,-2928.31 2349,-2980.31"/>
<text text-anchor="middle" x="2226.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 8 Layer 11</text>
<text text-anchor="middle" x="2226.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 1)</text>
<text text-anchor="middle" x="2226.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_8&#45;&gt;agg_11 -->
<g id="edge419" class="edge">
<title>expert_11_8&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2196.88,-2928.18C2186.65,-2919.5 2174.73,-2909.39 2162.71,-2899.19"/>
<polygon fill="black" stroke="black" points="2164.71,-2896.29 2154.82,-2892.49 2160.18,-2901.63 2164.71,-2896.29"/>
</g>
<!-- expert_11_9 -->
<g id="node245" class="node">
<title>expert_11_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-2980.31 2367,-2980.31 2367,-2928.31 2612,-2928.31 2612,-2980.31"/>
<text text-anchor="middle" x="2489.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 9 Layer 11</text>
<text text-anchor="middle" x="2489.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 1)</text>
<text text-anchor="middle" x="2489.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_9&#45;&gt;agg_11 -->
<g id="edge421" class="edge">
<title>expert_11_9&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2400.85,-2928.18C2366.21,-2918.36 2325.08,-2906.69 2284.37,-2895.15"/>
<polygon fill="black" stroke="black" points="2285.17,-2891.74 2274.6,-2892.38 2283.26,-2898.47 2285.17,-2891.74"/>
</g>
<!-- expert_11_10 -->
<g id="node246" class="node">
<title>expert_11_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-2980.31 2630,-2980.31 2630,-2928.31 2875,-2928.31 2875,-2980.31"/>
<text text-anchor="middle" x="2752.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 10 Layer 11</text>
<text text-anchor="middle" x="2752.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 1)</text>
<text text-anchor="middle" x="2752.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_10&#45;&gt;agg_11 -->
<g id="edge423" class="edge">
<title>expert_11_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2629.79,-2929.8C2627,-2929.3 2624.24,-2928.8 2621.5,-2928.31 2535.88,-2913.08 2442.26,-2897.33 2357.99,-2883.49"/>
<polygon fill="black" stroke="black" points="2358.47,-2880.02 2348.03,-2881.85 2357.33,-2886.92 2358.47,-2880.02"/>
</g>
<!-- expert_11_11 -->
<g id="node247" class="node">
<title>expert_11_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-2980.31 2893,-2980.31 2893,-2928.31 3138,-2928.31 3138,-2980.31"/>
<text text-anchor="middle" x="3015.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 11 Layer 11</text>
<text text-anchor="middle" x="3015.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 1)</text>
<text text-anchor="middle" x="3015.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_11&#45;&gt;agg_11 -->
<g id="edge425" class="edge">
<title>expert_11_11&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2892.82,-2929.6C2890.03,-2929.15 2887.25,-2928.73 2884.5,-2928.31 2701.91,-2900.88 2494.36,-2878.36 2337.83,-2863.1"/>
<polygon fill="black" stroke="black" points="2337.88,-2859.59 2327.59,-2862.11 2337.21,-2866.56 2337.88,-2859.59"/>
</g>
<!-- expert_11_12 -->
<g id="node248" class="node">
<title>expert_11_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-2980.31 3156,-2980.31 3156,-2928.31 3401,-2928.31 3401,-2980.31"/>
<text text-anchor="middle" x="3278.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 12 Layer 11</text>
<text text-anchor="middle" x="3278.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 1)</text>
<text text-anchor="middle" x="3278.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_12&#45;&gt;agg_11 -->
<g id="edge427" class="edge">
<title>expert_11_12&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M3155.84,-2929.5C3153.04,-2929.08 3150.25,-2928.69 3147.5,-2928.31 2866.94,-2890.06 2541.87,-2866.31 2327.98,-2853.48"/>
<polygon fill="black" stroke="black" points="2328.07,-2849.98 2317.87,-2852.87 2327.65,-2856.96 2328.07,-2849.98"/>
</g>
<!-- expert_11_13 -->
<g id="node249" class="node">
<title>expert_11_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-2980.31 3419,-2980.31 3419,-2928.31 3664,-2928.31 3664,-2980.31"/>
<text text-anchor="middle" x="3541.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 13 Layer 11</text>
<text text-anchor="middle" x="3541.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 1)</text>
<text text-anchor="middle" x="3541.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_13&#45;&gt;agg_11 -->
<g id="edge429" class="edge">
<title>expert_11_13&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M3418.85,-2929.43C3416.04,-2929.04 3413.26,-2928.67 3410.5,-2928.31 3030.7,-2879.7 2585.55,-2857.48 2322.49,-2847.91"/>
<polygon fill="black" stroke="black" points="2322.55,-2844.41 2312.43,-2847.54 2322.3,-2851.4 2322.55,-2844.41"/>
</g>
<!-- expert_11_14 -->
<g id="node250" class="node">
<title>expert_11_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-2980.31 3682,-2980.31 3682,-2928.31 3927,-2928.31 3927,-2980.31"/>
<text text-anchor="middle" x="3804.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 14 Layer 11</text>
<text text-anchor="middle" x="3804.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 1)</text>
<text text-anchor="middle" x="3804.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_14&#45;&gt;agg_11 -->
<g id="edge431" class="edge">
<title>expert_11_14&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M3681.85,-2929.39C3679.04,-2929.01 3676.26,-2928.65 3673.5,-2928.31 3193.37,-2869.54 2626.21,-2850.46 2319.23,-2844.27"/>
<polygon fill="black" stroke="black" points="2318.94,-2840.76 2308.87,-2844.06 2318.8,-2847.76 2318.94,-2840.76"/>
</g>
<!-- expert_11_15 -->
<g id="node251" class="node">
<title>expert_11_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-2980.31 3945,-2980.31 3945,-2928.31 4190,-2928.31 4190,-2980.31"/>
<text text-anchor="middle" x="4067.5" y="-2968.31" font-family="Arial" font-size="10.00">Expert 15 Layer 11</text>
<text text-anchor="middle" x="4067.5" y="-2957.31" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 1)</text>
<text text-anchor="middle" x="4067.5" y="-2946.31" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-2935.31" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_11_15&#45;&gt;agg_11 -->
<g id="edge433" class="edge">
<title>expert_11_15&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M3944.86,-2929.36C3942.05,-2928.99 3939.26,-2928.64 3936.5,-2928.31 3354.67,-2859.4 2663.37,-2844.56 2316.45,-2841.69"/>
<polygon fill="black" stroke="black" points="2316.31,-2838.19 2306.29,-2841.61 2316.26,-2845.19 2316.31,-2838.19"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_0 -->
<g id="edge402" class="edge">
<title>all2all_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" d="M1915.5,-3048.52C1522.04,-3040.13 590.94,-3017.14 255.38,-2980.44"/>
<polygon fill="black" stroke="black" points="255.47,-2976.93 245.14,-2979.29 254.69,-2983.88 255.47,-2976.93"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_1 -->
<g id="edge404" class="edge">
<title>all2all_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" d="M1913.96,-3052.25C1622.01,-3050.66 1028.27,-3039.69 518.28,-2980.45"/>
<polygon fill="black" stroke="black" points="518.48,-2976.95 508.14,-2979.27 517.67,-2983.91 518.48,-2976.95"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_2 -->
<g id="edge406" class="edge">
<title>all2all_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" d="M1914.63,-3049.89C1662.79,-3045.1 1190.87,-3029.87 781.12,-2980.45"/>
<polygon fill="black" stroke="black" points="781.5,-2976.97 771.15,-2979.24 780.65,-2983.92 781.5,-2976.97"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_3 -->
<g id="edge408" class="edge">
<title>all2all_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" d="M1917.03,-3046.5C1709.64,-3038.48 1356.12,-3020.19 1044.3,-2980.49"/>
<polygon fill="black" stroke="black" points="1044.52,-2976.98 1034.15,-2979.18 1043.63,-2983.93 1044.52,-2976.98"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_4 -->
<g id="edge410" class="edge">
<title>all2all_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" d="M1923.49,-3041.38C1765.73,-3030.37 1524.89,-3010.71 1307.19,-2980.5"/>
<polygon fill="black" stroke="black" points="1307.55,-2977.02 1297.17,-2979.1 1306.58,-2983.95 1307.55,-2977.02"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_5 -->
<g id="edge412" class="edge">
<title>all2all_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" d="M1941.98,-3033.44C1839.48,-3020.4 1701.14,-3001.79 1570.39,-2980.59"/>
<polygon fill="black" stroke="black" points="1570.62,-2977.08 1560.19,-2978.93 1569.5,-2983.99 1570.62,-2977.08"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_6 -->
<g id="edge414" class="edge">
<title>all2all_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" d="M1981.6,-3024.35C1928.4,-3011.29 1865.13,-2995.75 1812.1,-2982.72"/>
<polygon fill="black" stroke="black" points="1812.87,-2979.31 1802.32,-2980.32 1811.2,-2986.11 1812.87,-2979.31"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_7 -->
<g id="edge416" class="edge">
<title>all2all_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" d="M2047.58,-3017.42C2033.84,-3007.27 2018.91,-2996.24 2005.49,-2986.33"/>
<polygon fill="black" stroke="black" points="2007.49,-2983.45 1997.36,-2980.33 2003.33,-2989.08 2007.49,-2983.45"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_8 -->
<g id="edge418" class="edge">
<title>all2all_11&#45;&gt;expert_11_8</title>
<path fill="none" stroke="black" d="M2141.78,-3017.42C2155.63,-3007.27 2170.67,-2996.24 2184.19,-2986.33"/>
<polygon fill="black" stroke="black" points="2186.38,-2989.06 2192.38,-2980.33 2182.25,-2983.42 2186.38,-2989.06"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_9 -->
<g id="edge420" class="edge">
<title>all2all_11&#45;&gt;expert_11_9</title>
<path fill="none" stroke="black" d="M2207.43,-3024.42C2260.77,-3011.35 2324.25,-2995.8 2377.47,-2982.76"/>
<polygon fill="black" stroke="black" points="2378.41,-2986.13 2387.29,-2980.35 2376.74,-2979.33 2378.41,-2986.13"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_10 -->
<g id="edge422" class="edge">
<title>all2all_11&#45;&gt;expert_11_10</title>
<path fill="none" stroke="black" d="M2247.31,-3033.46C2350.01,-3020.42 2488.61,-3001.82 2619.59,-2980.6"/>
<polygon fill="black" stroke="black" points="2620.5,-2983.99 2629.81,-2978.93 2619.38,-2977.08 2620.5,-2983.99"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_11 -->
<g id="edge424" class="edge">
<title>all2all_11&#45;&gt;expert_11_11</title>
<path fill="none" stroke="black" d="M2265.73,-3041.39C2423.69,-3030.39 2664.83,-3010.74 2882.8,-2980.5"/>
<polygon fill="black" stroke="black" points="2883.42,-2983.95 2892.84,-2979.1 2882.45,-2977.02 2883.42,-2983.95"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_12 -->
<g id="edge426" class="edge">
<title>all2all_11&#45;&gt;expert_11_12</title>
<path fill="none" stroke="black" d="M2272.14,-3046.51C2479.73,-3038.5 2833.58,-3020.22 3145.69,-2980.49"/>
<polygon fill="black" stroke="black" points="3146.37,-2983.93 3155.85,-2979.18 3145.48,-2976.98 3146.37,-2983.93"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_13 -->
<g id="edge428" class="edge">
<title>all2all_11&#45;&gt;expert_11_13</title>
<path fill="none" stroke="black" d="M2274.24,-3049.9C2526.2,-3045.13 2998.67,-3029.92 3408.87,-2980.45"/>
<polygon fill="black" stroke="black" points="3409.35,-2983.92 3418.85,-2979.24 3408.5,-2976.97 3409.35,-2983.92"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_14 -->
<g id="edge430" class="edge">
<title>all2all_11&#45;&gt;expert_11_14</title>
<path fill="none" stroke="black" d="M2274.85,-3052.26C2566.88,-3050.68 3161.23,-3039.74 3671.71,-2980.46"/>
<polygon fill="black" stroke="black" points="3672.33,-2983.91 3681.86,-2979.27 3671.52,-2976.95 3672.33,-2983.91"/>
</g>
<!-- all2all_11&#45;&gt;expert_11_15 -->
<g id="edge432" class="edge">
<title>all2all_11&#45;&gt;expert_11_15</title>
<path fill="none" stroke="black" d="M2273.6,-3048.52C2667.27,-3040.14 3598.88,-3017.15 3934.62,-2980.44"/>
<polygon fill="black" stroke="black" points="3935.31,-2983.88 3944.86,-2979.29 3934.53,-2976.93 3935.31,-2983.88"/>
</g>
<!-- attn_12 -->
<g id="node254" class="node">
<title>attn_12</title>
<polygon fill="lightblue" stroke="black" points="2235,-2752.31 1954,-2752.31 1954,-2700.31 2235,-2700.31 2235,-2752.31"/>
<text text-anchor="middle" x="2094.5" y="-2740.31" font-family="Arial" font-size="10.00">Attention Layer 12</text>
<text text-anchor="middle" x="2094.5" y="-2729.31" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-2718.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-2707.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_11&#45;&gt;attn_12 -->
<g id="edge434" class="edge">
<title>agg_11&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M2094.5,-2788.23C2094.5,-2779.56 2094.5,-2770.74 2094.5,-2762.6"/>
<polygon fill="black" stroke="black" points="2098,-2762.36 2094.5,-2752.36 2091,-2762.36 2098,-2762.36"/>
</g>
<!-- comm_attn_12 -->
<g id="node255" class="node">
<title>comm_attn_12</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-2627.54" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-2641.54" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-2630.54" font-family="Arial" font-size="10.00">GPU: 32 ↔ GPU: 33, 34, 35</text>
<text text-anchor="middle" x="2094.5" y="-2619.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-2608.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_12&#45;&gt;comm_attn_12 -->
<g id="edge435" class="edge">
<title>attn_12&#45;&gt;comm_attn_12</title>
<path fill="none" stroke="black" d="M2094.5,-2700.14C2094.5,-2692.33 2094.5,-2683.47 2094.5,-2674.7"/>
<polygon fill="black" stroke="black" points="2098,-2674.52 2094.5,-2664.52 2091,-2674.52 2098,-2674.52"/>
</g>
<!-- gate_12 -->
<g id="node256" class="node">
<title>gate_12</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-2554.77 1931.71,-2554.77 1818.95,-2450.77 2257.29,-2450.77 2370.05,-2554.77"/>
<text text-anchor="middle" x="2094.5" y="-2516.77" font-family="Arial" font-size="10.00">Expert Gate 12</text>
<text text-anchor="middle" x="2094.5" y="-2505.77" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-2494.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-2483.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_12&#45;&gt;gate_12 -->
<g id="edge436" class="edge">
<title>comm_attn_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M2094.5,-2590.7C2094.5,-2582.67 2094.5,-2573.92 2094.5,-2565.17"/>
<polygon fill="black" stroke="black" points="2098,-2564.94 2094.5,-2554.94 2091,-2564.94 2098,-2564.94"/>
</g>
<!-- all2all_12 -->
<g id="node273" class="node">
<title>all2all_12</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-2378" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-2392" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-2381" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 2)</text>
<text text-anchor="middle" x="2094.5" y="-2370" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-2359" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_12&#45;&gt;all2all_12 -->
<g id="edge437" class="edge">
<title>gate_12&#45;&gt;all2all_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-2450.42C2094.5,-2442.01 2094.5,-2433.34 2094.5,-2425.07"/>
<polygon fill="black" stroke="black" points="2098,-2424.86 2094.5,-2414.86 2091,-2424.86 2098,-2424.86"/>
</g>
<!-- expert_12_0 -->
<g id="node257" class="node">
<title>expert_12_0</title>
<polygon fill="lightblue" stroke="black" points="245,-2305.23 0,-2305.23 0,-2253.23 245,-2253.23 245,-2305.23"/>
<text text-anchor="middle" x="122.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 0 Layer 12</text>
<text text-anchor="middle" x="122.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 2)</text>
<text text-anchor="middle" x="122.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_12 -->
<g id="node274" class="node">
<title>agg_12</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-2217.23 1938.39,-2217.23 1830.26,-2113.23 2250.61,-2113.23 2358.74,-2217.23"/>
<text text-anchor="middle" x="2094.5" y="-2179.23" font-family="Arial" font-size="10.00">Expert Aggregation 12</text>
<text text-anchor="middle" x="2094.5" y="-2168.23" font-family="Arial" font-size="10.00">GPU: 32 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-2157.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-2146.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_0&#45;&gt;agg_12 -->
<g id="edge439" class="edge">
<title>expert_12_0&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M245.14,-2254.28C247.95,-2253.91 250.74,-2253.56 253.5,-2253.23 836.59,-2184.17 1529.68,-2169.42 1875.48,-2166.6"/>
<polygon fill="black" stroke="black" points="1875.63,-2170.1 1885.61,-2166.52 1875.58,-2163.1 1875.63,-2170.1"/>
</g>
<!-- expert_12_1 -->
<g id="node258" class="node">
<title>expert_12_1</title>
<polygon fill="lightblue" stroke="black" points="508,-2305.23 263,-2305.23 263,-2253.23 508,-2253.23 508,-2305.23"/>
<text text-anchor="middle" x="385.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 1 Layer 12</text>
<text text-anchor="middle" x="385.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 2)</text>
<text text-anchor="middle" x="385.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_1&#45;&gt;agg_12 -->
<g id="edge441" class="edge">
<title>expert_12_1&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M508.15,-2254.31C510.96,-2253.93 513.74,-2253.57 516.5,-2253.23 1000.37,-2193.99 1572.67,-2175.08 1877.6,-2169.05"/>
<polygon fill="black" stroke="black" points="1877.96,-2172.54 1887.89,-2168.85 1877.82,-2165.54 1877.96,-2172.54"/>
</g>
<!-- expert_12_2 -->
<g id="node259" class="node">
<title>expert_12_2</title>
<polygon fill="lightblue" stroke="black" points="771,-2305.23 526,-2305.23 526,-2253.23 771,-2253.23 771,-2305.23"/>
<text text-anchor="middle" x="648.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 2 Layer 12</text>
<text text-anchor="middle" x="648.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 2)</text>
<text text-anchor="middle" x="648.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_2&#45;&gt;agg_12 -->
<g id="edge443" class="edge">
<title>expert_12_2&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M771.15,-2254.36C773.96,-2253.96 776.74,-2253.59 779.5,-2253.23 1165.96,-2203.76 1620.14,-2181.61 1880.94,-2172.33"/>
<polygon fill="black" stroke="black" points="1881.42,-2175.81 1891.29,-2171.96 1881.17,-2168.81 1881.42,-2175.81"/>
</g>
<!-- expert_12_3 -->
<g id="node260" class="node">
<title>expert_12_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-2305.23 789,-2305.23 789,-2253.23 1034,-2253.23 1034,-2305.23"/>
<text text-anchor="middle" x="911.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 3 Layer 12</text>
<text text-anchor="middle" x="911.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 2)</text>
<text text-anchor="middle" x="911.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_3&#45;&gt;agg_12 -->
<g id="edge445" class="edge">
<title>expert_12_3&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1034.16,-2254.42C1036.96,-2254.01 1039.75,-2253.61 1042.5,-2253.23 1333.63,-2213.53 1672.73,-2189.43 1885.52,-2176.97"/>
<polygon fill="black" stroke="black" points="1885.78,-2180.46 1895.56,-2176.38 1885.37,-2173.47 1885.78,-2180.46"/>
</g>
<!-- expert_12_4 -->
<g id="node261" class="node">
<title>expert_12_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-2305.23 1052,-2305.23 1052,-2253.23 1297,-2253.23 1297,-2305.23"/>
<text text-anchor="middle" x="1174.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 4 Layer 12</text>
<text text-anchor="middle" x="1174.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 2)</text>
<text text-anchor="middle" x="1174.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_4&#45;&gt;agg_12 -->
<g id="edge447" class="edge">
<title>expert_12_4&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1297.18,-2254.52C1299.97,-2254.08 1302.75,-2253.65 1305.5,-2253.23 1504.19,-2223.37 1732.48,-2199.3 1892.21,-2184.12"/>
<polygon fill="black" stroke="black" points="1893.01,-2187.56 1902.63,-2183.13 1892.35,-2180.59 1893.01,-2187.56"/>
</g>
<!-- expert_12_5 -->
<g id="node262" class="node">
<title>expert_12_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-2305.23 1315,-2305.23 1315,-2253.23 1560,-2253.23 1560,-2305.23"/>
<text text-anchor="middle" x="1437.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 5 Layer 12</text>
<text text-anchor="middle" x="1437.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 2)</text>
<text text-anchor="middle" x="1437.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_5&#45;&gt;agg_12 -->
<g id="edge449" class="edge">
<title>expert_12_5&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1560.21,-2254.72C1563,-2254.22 1565.76,-2253.72 1568.5,-2253.23 1679.84,-2233.41 1804.72,-2212.69 1904.85,-2196.44"/>
<polygon fill="black" stroke="black" points="1905.46,-2199.89 1914.77,-2194.84 1904.34,-2192.98 1905.46,-2199.89"/>
</g>
<!-- expert_12_6 -->
<g id="node263" class="node">
<title>expert_12_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-2305.23 1578,-2305.23 1578,-2253.23 1823,-2253.23 1823,-2305.23"/>
<text text-anchor="middle" x="1700.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 6 Layer 12</text>
<text text-anchor="middle" x="1700.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 2)</text>
<text text-anchor="middle" x="1700.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_6&#45;&gt;agg_12 -->
<g id="edge451" class="edge">
<title>expert_12_6&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1788.92,-2253.1C1828.53,-2241.84 1876.66,-2228.16 1922.89,-2215.02"/>
<polygon fill="black" stroke="black" points="1924.06,-2218.32 1932.72,-2212.22 1922.14,-2211.59 1924.06,-2218.32"/>
</g>
<!-- expert_12_7 -->
<g id="node264" class="node">
<title>expert_12_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-2305.23 1841,-2305.23 1841,-2253.23 2086,-2253.23 2086,-2305.23"/>
<text text-anchor="middle" x="1963.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 7 Layer 12</text>
<text text-anchor="middle" x="1963.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 2)</text>
<text text-anchor="middle" x="1963.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_7&#45;&gt;agg_12 -->
<g id="edge453" class="edge">
<title>expert_12_7&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1992.9,-2253.1C2003.05,-2244.42 2014.88,-2234.31 2026.8,-2224.11"/>
<polygon fill="black" stroke="black" points="2029.31,-2226.57 2034.64,-2217.41 2024.76,-2221.25 2029.31,-2226.57"/>
</g>
<!-- expert_12_8 -->
<g id="node265" class="node">
<title>expert_12_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-2305.23 2104,-2305.23 2104,-2253.23 2349,-2253.23 2349,-2305.23"/>
<text text-anchor="middle" x="2226.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 8 Layer 12</text>
<text text-anchor="middle" x="2226.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 2)</text>
<text text-anchor="middle" x="2226.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_8&#45;&gt;agg_12 -->
<g id="edge455" class="edge">
<title>expert_12_8&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M2196.88,-2253.1C2186.65,-2244.42 2174.73,-2234.31 2162.71,-2224.11"/>
<polygon fill="black" stroke="black" points="2164.71,-2221.21 2154.82,-2217.41 2160.18,-2226.55 2164.71,-2221.21"/>
</g>
<!-- expert_12_9 -->
<g id="node266" class="node">
<title>expert_12_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-2305.23 2367,-2305.23 2367,-2253.23 2612,-2253.23 2612,-2305.23"/>
<text text-anchor="middle" x="2489.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 9 Layer 12</text>
<text text-anchor="middle" x="2489.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 2)</text>
<text text-anchor="middle" x="2489.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_9&#45;&gt;agg_12 -->
<g id="edge457" class="edge">
<title>expert_12_9&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M2400.85,-2253.1C2366.21,-2243.28 2325.08,-2231.61 2284.37,-2220.07"/>
<polygon fill="black" stroke="black" points="2285.17,-2216.66 2274.6,-2217.3 2283.26,-2223.39 2285.17,-2216.66"/>
</g>
<!-- expert_12_10 -->
<g id="node267" class="node">
<title>expert_12_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-2305.23 2630,-2305.23 2630,-2253.23 2875,-2253.23 2875,-2305.23"/>
<text text-anchor="middle" x="2752.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 10 Layer 12</text>
<text text-anchor="middle" x="2752.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 2)</text>
<text text-anchor="middle" x="2752.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_10&#45;&gt;agg_12 -->
<g id="edge459" class="edge">
<title>expert_12_10&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M2629.79,-2254.72C2627,-2254.22 2624.24,-2253.72 2621.5,-2253.23 2535.88,-2238 2442.26,-2222.25 2357.99,-2208.41"/>
<polygon fill="black" stroke="black" points="2358.47,-2204.94 2348.03,-2206.77 2357.33,-2211.85 2358.47,-2204.94"/>
</g>
<!-- expert_12_11 -->
<g id="node268" class="node">
<title>expert_12_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-2305.23 2893,-2305.23 2893,-2253.23 3138,-2253.23 3138,-2305.23"/>
<text text-anchor="middle" x="3015.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 11 Layer 12</text>
<text text-anchor="middle" x="3015.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 2)</text>
<text text-anchor="middle" x="3015.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_11&#45;&gt;agg_12 -->
<g id="edge461" class="edge">
<title>expert_12_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M2892.82,-2254.52C2890.03,-2254.08 2887.25,-2253.65 2884.5,-2253.23 2701.91,-2225.8 2494.36,-2203.28 2337.83,-2188.03"/>
<polygon fill="black" stroke="black" points="2337.88,-2184.51 2327.59,-2187.03 2337.21,-2191.48 2337.88,-2184.51"/>
</g>
<!-- expert_12_12 -->
<g id="node269" class="node">
<title>expert_12_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-2305.23 3156,-2305.23 3156,-2253.23 3401,-2253.23 3401,-2305.23"/>
<text text-anchor="middle" x="3278.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 12 Layer 12</text>
<text text-anchor="middle" x="3278.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 2)</text>
<text text-anchor="middle" x="3278.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_12&#45;&gt;agg_12 -->
<g id="edge463" class="edge">
<title>expert_12_12&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3155.84,-2254.42C3153.04,-2254.01 3150.25,-2253.61 3147.5,-2253.23 2866.94,-2214.98 2541.87,-2191.23 2327.98,-2178.4"/>
<polygon fill="black" stroke="black" points="2328.07,-2174.9 2317.87,-2177.8 2327.65,-2181.88 2328.07,-2174.9"/>
</g>
<!-- expert_12_13 -->
<g id="node270" class="node">
<title>expert_12_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-2305.23 3419,-2305.23 3419,-2253.23 3664,-2253.23 3664,-2305.23"/>
<text text-anchor="middle" x="3541.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 13 Layer 12</text>
<text text-anchor="middle" x="3541.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 2)</text>
<text text-anchor="middle" x="3541.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_13&#45;&gt;agg_12 -->
<g id="edge465" class="edge">
<title>expert_12_13&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3418.85,-2254.36C3416.04,-2253.96 3413.26,-2253.59 3410.5,-2253.23 3030.7,-2204.63 2585.55,-2182.4 2322.49,-2172.83"/>
<polygon fill="black" stroke="black" points="2322.55,-2169.33 2312.43,-2172.47 2322.3,-2176.32 2322.55,-2169.33"/>
</g>
<!-- expert_12_14 -->
<g id="node271" class="node">
<title>expert_12_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-2305.23 3682,-2305.23 3682,-2253.23 3927,-2253.23 3927,-2305.23"/>
<text text-anchor="middle" x="3804.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 14 Layer 12</text>
<text text-anchor="middle" x="3804.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 2)</text>
<text text-anchor="middle" x="3804.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_14&#45;&gt;agg_12 -->
<g id="edge467" class="edge">
<title>expert_12_14&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3681.85,-2254.31C3679.04,-2253.93 3676.26,-2253.57 3673.5,-2253.23 3193.37,-2194.46 2626.21,-2175.38 2319.23,-2169.19"/>
<polygon fill="black" stroke="black" points="2318.94,-2165.69 2308.87,-2168.99 2318.8,-2172.68 2318.94,-2165.69"/>
</g>
<!-- expert_12_15 -->
<g id="node272" class="node">
<title>expert_12_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-2305.23 3945,-2305.23 3945,-2253.23 4190,-2253.23 4190,-2305.23"/>
<text text-anchor="middle" x="4067.5" y="-2293.23" font-family="Arial" font-size="10.00">Expert 15 Layer 12</text>
<text text-anchor="middle" x="4067.5" y="-2282.23" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 2)</text>
<text text-anchor="middle" x="4067.5" y="-2271.23" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-2260.23" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_12_15&#45;&gt;agg_12 -->
<g id="edge469" class="edge">
<title>expert_12_15&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3944.86,-2254.28C3942.05,-2253.91 3939.26,-2253.56 3936.5,-2253.23 3354.67,-2184.33 2663.37,-2169.48 2316.45,-2166.61"/>
<polygon fill="black" stroke="black" points="2316.31,-2163.11 2306.29,-2166.53 2316.26,-2170.11 2316.31,-2163.11"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_0 -->
<g id="edge438" class="edge">
<title>all2all_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" d="M1915.5,-2373.44C1522.04,-2365.06 590.94,-2342.06 255.38,-2305.36"/>
<polygon fill="black" stroke="black" points="255.47,-2301.85 245.14,-2304.22 254.69,-2308.81 255.47,-2301.85"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_1 -->
<g id="edge440" class="edge">
<title>all2all_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" d="M1913.96,-2377.17C1622.01,-2375.58 1028.27,-2364.61 518.28,-2305.38"/>
<polygon fill="black" stroke="black" points="518.48,-2301.88 508.14,-2304.19 517.67,-2308.83 518.48,-2301.88"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_2 -->
<g id="edge442" class="edge">
<title>all2all_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" d="M1914.63,-2374.81C1662.79,-2370.02 1190.87,-2354.79 781.12,-2305.37"/>
<polygon fill="black" stroke="black" points="781.5,-2301.89 771.15,-2304.16 780.65,-2308.84 781.5,-2301.89"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_3 -->
<g id="edge444" class="edge">
<title>all2all_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" d="M1917.03,-2371.42C1709.64,-2363.4 1356.12,-2345.11 1044.3,-2305.41"/>
<polygon fill="black" stroke="black" points="1044.52,-2301.91 1034.15,-2304.11 1043.63,-2308.85 1044.52,-2301.91"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_4 -->
<g id="edge446" class="edge">
<title>all2all_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" d="M1923.49,-2366.3C1765.73,-2355.29 1524.89,-2335.63 1307.19,-2305.42"/>
<polygon fill="black" stroke="black" points="1307.55,-2301.94 1297.17,-2304.02 1306.58,-2308.87 1307.55,-2301.94"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_5 -->
<g id="edge448" class="edge">
<title>all2all_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" d="M1941.98,-2358.36C1839.48,-2345.32 1701.14,-2326.71 1570.39,-2305.52"/>
<polygon fill="black" stroke="black" points="1570.62,-2302.01 1560.19,-2303.85 1569.5,-2308.92 1570.62,-2302.01"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_6 -->
<g id="edge450" class="edge">
<title>all2all_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" d="M1981.6,-2349.27C1928.4,-2336.21 1865.13,-2320.67 1812.1,-2307.64"/>
<polygon fill="black" stroke="black" points="1812.87,-2304.23 1802.32,-2305.24 1811.2,-2311.03 1812.87,-2304.23"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_7 -->
<g id="edge452" class="edge">
<title>all2all_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" d="M2047.58,-2342.34C2033.84,-2332.19 2018.91,-2321.16 2005.49,-2311.26"/>
<polygon fill="black" stroke="black" points="2007.49,-2308.38 1997.36,-2305.25 2003.33,-2314.01 2007.49,-2308.38"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_8 -->
<g id="edge454" class="edge">
<title>all2all_12&#45;&gt;expert_12_8</title>
<path fill="none" stroke="black" d="M2141.78,-2342.34C2155.63,-2332.19 2170.67,-2321.16 2184.19,-2311.26"/>
<polygon fill="black" stroke="black" points="2186.38,-2313.98 2192.38,-2305.25 2182.25,-2308.34 2186.38,-2313.98"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_9 -->
<g id="edge456" class="edge">
<title>all2all_12&#45;&gt;expert_12_9</title>
<path fill="none" stroke="black" d="M2207.43,-2349.34C2260.77,-2336.27 2324.25,-2320.72 2377.47,-2307.68"/>
<polygon fill="black" stroke="black" points="2378.41,-2311.05 2387.29,-2305.28 2376.74,-2304.26 2378.41,-2311.05"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_10 -->
<g id="edge458" class="edge">
<title>all2all_12&#45;&gt;expert_12_10</title>
<path fill="none" stroke="black" d="M2247.31,-2358.38C2350.01,-2345.34 2488.61,-2326.74 2619.59,-2305.52"/>
<polygon fill="black" stroke="black" points="2620.5,-2308.92 2629.81,-2303.85 2619.38,-2302.01 2620.5,-2308.92"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_11 -->
<g id="edge460" class="edge">
<title>all2all_12&#45;&gt;expert_12_11</title>
<path fill="none" stroke="black" d="M2265.73,-2366.31C2423.69,-2355.31 2664.83,-2335.66 2882.8,-2305.42"/>
<polygon fill="black" stroke="black" points="2883.42,-2308.87 2892.84,-2304.02 2882.45,-2301.94 2883.42,-2308.87"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_12 -->
<g id="edge462" class="edge">
<title>all2all_12&#45;&gt;expert_12_12</title>
<path fill="none" stroke="black" d="M2272.14,-2371.43C2479.73,-2363.42 2833.58,-2345.14 3145.69,-2305.41"/>
<polygon fill="black" stroke="black" points="3146.37,-2308.85 3155.85,-2304.11 3145.48,-2301.91 3146.37,-2308.85"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_13 -->
<g id="edge464" class="edge">
<title>all2all_12&#45;&gt;expert_12_13</title>
<path fill="none" stroke="black" d="M2274.24,-2374.82C2526.2,-2370.05 2998.67,-2354.84 3408.87,-2305.37"/>
<polygon fill="black" stroke="black" points="3409.35,-2308.84 3418.85,-2304.16 3408.5,-2301.89 3409.35,-2308.84"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_14 -->
<g id="edge466" class="edge">
<title>all2all_12&#45;&gt;expert_12_14</title>
<path fill="none" stroke="black" d="M2274.85,-2377.18C2566.88,-2375.6 3161.23,-2364.66 3671.71,-2305.38"/>
<polygon fill="black" stroke="black" points="3672.33,-2308.83 3681.86,-2304.19 3671.52,-2301.88 3672.33,-2308.83"/>
</g>
<!-- all2all_12&#45;&gt;expert_12_15 -->
<g id="edge468" class="edge">
<title>all2all_12&#45;&gt;expert_12_15</title>
<path fill="none" stroke="black" d="M2273.6,-2373.44C2667.27,-2365.06 3598.88,-2342.07 3934.62,-2305.36"/>
<polygon fill="black" stroke="black" points="3935.31,-2308.81 3944.86,-2304.22 3934.53,-2301.85 3935.31,-2308.81"/>
</g>
<!-- attn_13 -->
<g id="node275" class="node">
<title>attn_13</title>
<polygon fill="lightblue" stroke="black" points="2235,-2077.23 1954,-2077.23 1954,-2025.23 2235,-2025.23 2235,-2077.23"/>
<text text-anchor="middle" x="2094.5" y="-2065.23" font-family="Arial" font-size="10.00">Attention Layer 13</text>
<text text-anchor="middle" x="2094.5" y="-2054.23" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-2043.23" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-2032.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_12&#45;&gt;attn_13 -->
<g id="edge470" class="edge">
<title>agg_12&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M2094.5,-2113.15C2094.5,-2104.49 2094.5,-2095.66 2094.5,-2087.52"/>
<polygon fill="black" stroke="black" points="2098,-2087.28 2094.5,-2077.28 2091,-2087.28 2098,-2087.28"/>
</g>
<!-- comm_attn_13 -->
<g id="node276" class="node">
<title>comm_attn_13</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-1952.47" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-1966.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-1955.47" font-family="Arial" font-size="10.00">GPU: 33 ↔ GPU: 34, 35, 36</text>
<text text-anchor="middle" x="2094.5" y="-1944.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1933.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_13&#45;&gt;comm_attn_13 -->
<g id="edge471" class="edge">
<title>attn_13&#45;&gt;comm_attn_13</title>
<path fill="none" stroke="black" d="M2094.5,-2025.06C2094.5,-2017.25 2094.5,-2008.39 2094.5,-1999.62"/>
<polygon fill="black" stroke="black" points="2098,-1999.44 2094.5,-1989.44 2091,-1999.44 2098,-1999.44"/>
</g>
<!-- gate_13 -->
<g id="node277" class="node">
<title>gate_13</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-1879.7 1931.71,-1879.7 1818.95,-1775.7 2257.29,-1775.7 2370.05,-1879.7"/>
<text text-anchor="middle" x="2094.5" y="-1841.7" font-family="Arial" font-size="10.00">Expert Gate 13</text>
<text text-anchor="middle" x="2094.5" y="-1830.7" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-1819.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1808.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_13&#45;&gt;gate_13 -->
<g id="edge472" class="edge">
<title>comm_attn_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M2094.5,-1915.63C2094.5,-1907.59 2094.5,-1898.84 2094.5,-1890.09"/>
<polygon fill="black" stroke="black" points="2098,-1889.86 2094.5,-1879.86 2091,-1889.86 2098,-1889.86"/>
</g>
<!-- all2all_13 -->
<g id="node294" class="node">
<title>all2all_13</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-1702.93" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-1716.93" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-1705.93" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 2)</text>
<text text-anchor="middle" x="2094.5" y="-1694.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1683.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_13&#45;&gt;all2all_13 -->
<g id="edge473" class="edge">
<title>gate_13&#45;&gt;all2all_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-1775.34C2094.5,-1766.93 2094.5,-1758.27 2094.5,-1750"/>
<polygon fill="black" stroke="black" points="2098,-1749.78 2094.5,-1739.78 2091,-1749.78 2098,-1749.78"/>
</g>
<!-- expert_13_0 -->
<g id="node278" class="node">
<title>expert_13_0</title>
<polygon fill="lightblue" stroke="black" points="245,-1630.16 0,-1630.16 0,-1578.16 245,-1578.16 245,-1630.16"/>
<text text-anchor="middle" x="122.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 0 Layer 13</text>
<text text-anchor="middle" x="122.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 2)</text>
<text text-anchor="middle" x="122.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_13 -->
<g id="node295" class="node">
<title>agg_13</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-1542.16 1938.39,-1542.16 1830.26,-1438.16 2250.61,-1438.16 2358.74,-1542.16"/>
<text text-anchor="middle" x="2094.5" y="-1504.16" font-family="Arial" font-size="10.00">Expert Aggregation 13</text>
<text text-anchor="middle" x="2094.5" y="-1493.16" font-family="Arial" font-size="10.00">GPU: 33 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-1482.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1471.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_0&#45;&gt;agg_13 -->
<g id="edge475" class="edge">
<title>expert_13_0&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M245.14,-1579.21C247.95,-1578.83 250.74,-1578.48 253.5,-1578.16 836.59,-1509.09 1529.68,-1494.34 1875.48,-1491.52"/>
<polygon fill="black" stroke="black" points="1875.63,-1495.02 1885.61,-1491.44 1875.58,-1488.02 1875.63,-1495.02"/>
</g>
<!-- expert_13_1 -->
<g id="node279" class="node">
<title>expert_13_1</title>
<polygon fill="lightblue" stroke="black" points="508,-1630.16 263,-1630.16 263,-1578.16 508,-1578.16 508,-1630.16"/>
<text text-anchor="middle" x="385.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 1 Layer 13</text>
<text text-anchor="middle" x="385.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 2)</text>
<text text-anchor="middle" x="385.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_1&#45;&gt;agg_13 -->
<g id="edge477" class="edge">
<title>expert_13_1&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M508.15,-1579.24C510.96,-1578.85 513.74,-1578.49 516.5,-1578.16 1000.37,-1518.92 1572.67,-1500 1877.6,-1493.97"/>
<polygon fill="black" stroke="black" points="1877.96,-1497.46 1887.89,-1493.77 1877.82,-1490.46 1877.96,-1497.46"/>
</g>
<!-- expert_13_2 -->
<g id="node280" class="node">
<title>expert_13_2</title>
<polygon fill="lightblue" stroke="black" points="771,-1630.16 526,-1630.16 526,-1578.16 771,-1578.16 771,-1630.16"/>
<text text-anchor="middle" x="648.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 2 Layer 13</text>
<text text-anchor="middle" x="648.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 2)</text>
<text text-anchor="middle" x="648.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_2&#45;&gt;agg_13 -->
<g id="edge479" class="edge">
<title>expert_13_2&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M771.15,-1579.28C773.96,-1578.88 776.74,-1578.51 779.5,-1578.16 1165.96,-1528.69 1620.14,-1506.53 1880.94,-1497.25"/>
<polygon fill="black" stroke="black" points="1881.42,-1500.73 1891.29,-1496.88 1881.17,-1493.74 1881.42,-1500.73"/>
</g>
<!-- expert_13_3 -->
<g id="node281" class="node">
<title>expert_13_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-1630.16 789,-1630.16 789,-1578.16 1034,-1578.16 1034,-1630.16"/>
<text text-anchor="middle" x="911.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 3 Layer 13</text>
<text text-anchor="middle" x="911.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 2)</text>
<text text-anchor="middle" x="911.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_3&#45;&gt;agg_13 -->
<g id="edge481" class="edge">
<title>expert_13_3&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1034.16,-1579.34C1036.96,-1578.93 1039.75,-1578.53 1042.5,-1578.16 1333.63,-1538.45 1672.73,-1514.36 1885.52,-1501.89"/>
<polygon fill="black" stroke="black" points="1885.78,-1505.38 1895.56,-1501.31 1885.37,-1498.39 1885.78,-1505.38"/>
</g>
<!-- expert_13_4 -->
<g id="node282" class="node">
<title>expert_13_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-1630.16 1052,-1630.16 1052,-1578.16 1297,-1578.16 1297,-1630.16"/>
<text text-anchor="middle" x="1174.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 4 Layer 13</text>
<text text-anchor="middle" x="1174.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 2)</text>
<text text-anchor="middle" x="1174.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_4&#45;&gt;agg_13 -->
<g id="edge483" class="edge">
<title>expert_13_4&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1297.18,-1579.44C1299.97,-1579 1302.75,-1578.57 1305.5,-1578.16 1504.19,-1548.29 1732.48,-1524.22 1892.21,-1509.04"/>
<polygon fill="black" stroke="black" points="1893.01,-1512.48 1902.63,-1508.05 1892.35,-1505.51 1893.01,-1512.48"/>
</g>
<!-- expert_13_5 -->
<g id="node283" class="node">
<title>expert_13_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-1630.16 1315,-1630.16 1315,-1578.16 1560,-1578.16 1560,-1630.16"/>
<text text-anchor="middle" x="1437.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 5 Layer 13</text>
<text text-anchor="middle" x="1437.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 2)</text>
<text text-anchor="middle" x="1437.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_5&#45;&gt;agg_13 -->
<g id="edge485" class="edge">
<title>expert_13_5&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1560.21,-1579.64C1563,-1579.14 1565.76,-1578.64 1568.5,-1578.16 1679.84,-1558.33 1804.72,-1537.61 1904.85,-1521.37"/>
<polygon fill="black" stroke="black" points="1905.46,-1524.81 1914.77,-1519.76 1904.34,-1517.9 1905.46,-1524.81"/>
</g>
<!-- expert_13_6 -->
<g id="node284" class="node">
<title>expert_13_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-1630.16 1578,-1630.16 1578,-1578.16 1823,-1578.16 1823,-1630.16"/>
<text text-anchor="middle" x="1700.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 6 Layer 13</text>
<text text-anchor="middle" x="1700.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 2)</text>
<text text-anchor="middle" x="1700.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_6&#45;&gt;agg_13 -->
<g id="edge487" class="edge">
<title>expert_13_6&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1788.92,-1578.02C1828.53,-1566.76 1876.66,-1553.08 1922.89,-1539.94"/>
<polygon fill="black" stroke="black" points="1924.06,-1543.25 1932.72,-1537.14 1922.14,-1536.51 1924.06,-1543.25"/>
</g>
<!-- expert_13_7 -->
<g id="node285" class="node">
<title>expert_13_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-1630.16 1841,-1630.16 1841,-1578.16 2086,-1578.16 2086,-1630.16"/>
<text text-anchor="middle" x="1963.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 7 Layer 13</text>
<text text-anchor="middle" x="1963.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 2)</text>
<text text-anchor="middle" x="1963.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_7&#45;&gt;agg_13 -->
<g id="edge489" class="edge">
<title>expert_13_7&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1992.9,-1578.02C2003.05,-1569.34 2014.88,-1559.23 2026.8,-1549.03"/>
<polygon fill="black" stroke="black" points="2029.31,-1551.49 2034.64,-1542.33 2024.76,-1546.17 2029.31,-1551.49"/>
</g>
<!-- expert_13_8 -->
<g id="node286" class="node">
<title>expert_13_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-1630.16 2104,-1630.16 2104,-1578.16 2349,-1578.16 2349,-1630.16"/>
<text text-anchor="middle" x="2226.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 8 Layer 13</text>
<text text-anchor="middle" x="2226.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 2)</text>
<text text-anchor="middle" x="2226.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_8&#45;&gt;agg_13 -->
<g id="edge491" class="edge">
<title>expert_13_8&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M2196.88,-1578.02C2186.65,-1569.34 2174.73,-1559.23 2162.71,-1549.03"/>
<polygon fill="black" stroke="black" points="2164.71,-1546.14 2154.82,-1542.33 2160.18,-1551.47 2164.71,-1546.14"/>
</g>
<!-- expert_13_9 -->
<g id="node287" class="node">
<title>expert_13_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-1630.16 2367,-1630.16 2367,-1578.16 2612,-1578.16 2612,-1630.16"/>
<text text-anchor="middle" x="2489.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 9 Layer 13</text>
<text text-anchor="middle" x="2489.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 2)</text>
<text text-anchor="middle" x="2489.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_9&#45;&gt;agg_13 -->
<g id="edge493" class="edge">
<title>expert_13_9&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M2400.85,-1578.02C2366.21,-1568.2 2325.08,-1556.54 2284.37,-1544.99"/>
<polygon fill="black" stroke="black" points="2285.17,-1541.58 2274.6,-1542.22 2283.26,-1548.32 2285.17,-1541.58"/>
</g>
<!-- expert_13_10 -->
<g id="node288" class="node">
<title>expert_13_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-1630.16 2630,-1630.16 2630,-1578.16 2875,-1578.16 2875,-1630.16"/>
<text text-anchor="middle" x="2752.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 10 Layer 13</text>
<text text-anchor="middle" x="2752.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 2)</text>
<text text-anchor="middle" x="2752.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_10&#45;&gt;agg_13 -->
<g id="edge495" class="edge">
<title>expert_13_10&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M2629.79,-1579.64C2627,-1579.14 2624.24,-1578.64 2621.5,-1578.16 2535.88,-1562.92 2442.26,-1547.17 2357.99,-1533.33"/>
<polygon fill="black" stroke="black" points="2358.47,-1529.86 2348.03,-1531.7 2357.33,-1536.77 2358.47,-1529.86"/>
</g>
<!-- expert_13_11 -->
<g id="node289" class="node">
<title>expert_13_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-1630.16 2893,-1630.16 2893,-1578.16 3138,-1578.16 3138,-1630.16"/>
<text text-anchor="middle" x="3015.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 11 Layer 13</text>
<text text-anchor="middle" x="3015.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 2)</text>
<text text-anchor="middle" x="3015.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_11&#45;&gt;agg_13 -->
<g id="edge497" class="edge">
<title>expert_13_11&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M2892.82,-1579.44C2890.03,-1579 2887.25,-1578.57 2884.5,-1578.16 2701.91,-1550.72 2494.36,-1528.2 2337.83,-1512.95"/>
<polygon fill="black" stroke="black" points="2337.88,-1509.44 2327.59,-1511.95 2337.21,-1516.4 2337.88,-1509.44"/>
</g>
<!-- expert_13_12 -->
<g id="node290" class="node">
<title>expert_13_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-1630.16 3156,-1630.16 3156,-1578.16 3401,-1578.16 3401,-1630.16"/>
<text text-anchor="middle" x="3278.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 12 Layer 13</text>
<text text-anchor="middle" x="3278.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 2)</text>
<text text-anchor="middle" x="3278.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_12&#45;&gt;agg_13 -->
<g id="edge499" class="edge">
<title>expert_13_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3155.84,-1579.34C3153.04,-1578.93 3150.25,-1578.53 3147.5,-1578.16 2866.94,-1539.91 2541.87,-1516.15 2327.98,-1503.32"/>
<polygon fill="black" stroke="black" points="2328.07,-1499.82 2317.87,-1502.72 2327.65,-1506.81 2328.07,-1499.82"/>
</g>
<!-- expert_13_13 -->
<g id="node291" class="node">
<title>expert_13_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-1630.16 3419,-1630.16 3419,-1578.16 3664,-1578.16 3664,-1630.16"/>
<text text-anchor="middle" x="3541.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 13 Layer 13</text>
<text text-anchor="middle" x="3541.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 2)</text>
<text text-anchor="middle" x="3541.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_13&#45;&gt;agg_13 -->
<g id="edge501" class="edge">
<title>expert_13_13&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3418.85,-1579.28C3416.04,-1578.88 3413.26,-1578.51 3410.5,-1578.16 3030.7,-1529.55 2585.55,-1507.32 2322.49,-1497.75"/>
<polygon fill="black" stroke="black" points="2322.55,-1494.25 2312.43,-1497.39 2322.3,-1501.25 2322.55,-1494.25"/>
</g>
<!-- expert_13_14 -->
<g id="node292" class="node">
<title>expert_13_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-1630.16 3682,-1630.16 3682,-1578.16 3927,-1578.16 3927,-1630.16"/>
<text text-anchor="middle" x="3804.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 14 Layer 13</text>
<text text-anchor="middle" x="3804.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 2)</text>
<text text-anchor="middle" x="3804.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_14&#45;&gt;agg_13 -->
<g id="edge503" class="edge">
<title>expert_13_14&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3681.85,-1579.24C3679.04,-1578.85 3676.26,-1578.49 3673.5,-1578.16 3193.37,-1519.38 2626.21,-1500.3 2319.23,-1494.11"/>
<polygon fill="black" stroke="black" points="2318.94,-1490.61 2308.87,-1493.91 2318.8,-1497.61 2318.94,-1490.61"/>
</g>
<!-- expert_13_15 -->
<g id="node293" class="node">
<title>expert_13_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-1630.16 3945,-1630.16 3945,-1578.16 4190,-1578.16 4190,-1630.16"/>
<text text-anchor="middle" x="4067.5" y="-1618.16" font-family="Arial" font-size="10.00">Expert 15 Layer 13</text>
<text text-anchor="middle" x="4067.5" y="-1607.16" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 2)</text>
<text text-anchor="middle" x="4067.5" y="-1596.16" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-1585.16" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_13_15&#45;&gt;agg_13 -->
<g id="edge505" class="edge">
<title>expert_13_15&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3944.86,-1579.21C3942.05,-1578.83 3939.26,-1578.48 3936.5,-1578.16 3354.67,-1509.25 2663.37,-1494.4 2316.45,-1491.54"/>
<polygon fill="black" stroke="black" points="2316.31,-1488.03 2306.29,-1491.45 2316.26,-1495.03 2316.31,-1488.03"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_0 -->
<g id="edge474" class="edge">
<title>all2all_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" d="M1915.5,-1698.36C1522.04,-1689.98 590.94,-1666.98 255.38,-1630.28"/>
<polygon fill="black" stroke="black" points="255.47,-1626.77 245.14,-1629.14 254.69,-1633.73 255.47,-1626.77"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_1 -->
<g id="edge476" class="edge">
<title>all2all_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" d="M1913.96,-1702.09C1622.01,-1700.5 1028.27,-1689.53 518.28,-1630.3"/>
<polygon fill="black" stroke="black" points="518.48,-1626.8 508.14,-1629.11 517.67,-1633.75 518.48,-1626.8"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_2 -->
<g id="edge478" class="edge">
<title>all2all_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" d="M1914.63,-1699.73C1662.79,-1694.94 1190.87,-1679.72 781.12,-1630.29"/>
<polygon fill="black" stroke="black" points="781.5,-1626.81 771.15,-1629.08 780.65,-1633.76 781.5,-1626.81"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_3 -->
<g id="edge480" class="edge">
<title>all2all_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" d="M1917.03,-1696.34C1709.64,-1688.33 1356.12,-1670.04 1044.3,-1630.33"/>
<polygon fill="black" stroke="black" points="1044.52,-1626.83 1034.15,-1629.03 1043.63,-1633.77 1044.52,-1626.83"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_4 -->
<g id="edge482" class="edge">
<title>all2all_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" d="M1923.49,-1691.22C1765.73,-1680.21 1524.89,-1660.56 1307.19,-1630.34"/>
<polygon fill="black" stroke="black" points="1307.55,-1626.86 1297.17,-1628.94 1306.58,-1633.79 1307.55,-1626.86"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_5 -->
<g id="edge484" class="edge">
<title>all2all_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" d="M1941.98,-1683.28C1839.48,-1670.24 1701.14,-1651.64 1570.39,-1630.44"/>
<polygon fill="black" stroke="black" points="1570.62,-1626.93 1560.19,-1628.77 1569.5,-1633.84 1570.62,-1626.93"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_6 -->
<g id="edge486" class="edge">
<title>all2all_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" d="M1981.6,-1674.2C1928.4,-1661.13 1865.13,-1645.59 1812.1,-1632.57"/>
<polygon fill="black" stroke="black" points="1812.87,-1629.15 1802.32,-1630.16 1811.2,-1635.95 1812.87,-1629.15"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_7 -->
<g id="edge488" class="edge">
<title>all2all_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" d="M2047.58,-1667.26C2033.84,-1657.11 2018.91,-1646.09 2005.49,-1636.18"/>
<polygon fill="black" stroke="black" points="2007.49,-1633.3 1997.36,-1630.17 2003.33,-1638.93 2007.49,-1633.3"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_8 -->
<g id="edge490" class="edge">
<title>all2all_13&#45;&gt;expert_13_8</title>
<path fill="none" stroke="black" d="M2141.78,-1667.26C2155.63,-1657.11 2170.67,-1646.09 2184.19,-1636.18"/>
<polygon fill="black" stroke="black" points="2186.38,-1638.91 2192.38,-1630.17 2182.25,-1633.26 2186.38,-1638.91"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_9 -->
<g id="edge492" class="edge">
<title>all2all_13&#45;&gt;expert_13_9</title>
<path fill="none" stroke="black" d="M2207.43,-1674.26C2260.77,-1661.19 2324.25,-1645.64 2377.47,-1632.6"/>
<polygon fill="black" stroke="black" points="2378.41,-1635.98 2387.29,-1630.2 2376.74,-1629.18 2378.41,-1635.98"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_10 -->
<g id="edge494" class="edge">
<title>all2all_13&#45;&gt;expert_13_10</title>
<path fill="none" stroke="black" d="M2247.31,-1683.3C2350.01,-1670.26 2488.61,-1651.66 2619.59,-1630.44"/>
<polygon fill="black" stroke="black" points="2620.5,-1633.84 2629.81,-1628.78 2619.38,-1626.93 2620.5,-1633.84"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_11 -->
<g id="edge496" class="edge">
<title>all2all_13&#45;&gt;expert_13_11</title>
<path fill="none" stroke="black" d="M2265.73,-1691.23C2423.69,-1680.23 2664.83,-1660.58 2882.8,-1630.34"/>
<polygon fill="black" stroke="black" points="2883.42,-1633.79 2892.84,-1628.94 2882.45,-1626.86 2883.42,-1633.79"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_12 -->
<g id="edge498" class="edge">
<title>all2all_13&#45;&gt;expert_13_12</title>
<path fill="none" stroke="black" d="M2272.14,-1696.35C2479.73,-1688.34 2833.58,-1670.06 3145.69,-1630.33"/>
<polygon fill="black" stroke="black" points="3146.37,-1633.77 3155.85,-1629.03 3145.48,-1626.83 3146.37,-1633.77"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_13 -->
<g id="edge500" class="edge">
<title>all2all_13&#45;&gt;expert_13_13</title>
<path fill="none" stroke="black" d="M2274.24,-1699.74C2526.2,-1694.97 2998.67,-1679.76 3408.87,-1630.29"/>
<polygon fill="black" stroke="black" points="3409.35,-1633.76 3418.85,-1629.08 3408.5,-1626.81 3409.35,-1633.76"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_14 -->
<g id="edge502" class="edge">
<title>all2all_13&#45;&gt;expert_13_14</title>
<path fill="none" stroke="black" d="M2274.85,-1702.1C2566.88,-1700.53 3161.23,-1689.58 3671.71,-1630.3"/>
<polygon fill="black" stroke="black" points="3672.33,-1633.75 3681.86,-1629.11 3671.52,-1626.8 3672.33,-1633.75"/>
</g>
<!-- all2all_13&#45;&gt;expert_13_15 -->
<g id="edge504" class="edge">
<title>all2all_13&#45;&gt;expert_13_15</title>
<path fill="none" stroke="black" d="M2273.6,-1698.36C2667.27,-1689.99 3598.88,-1667 3934.62,-1630.28"/>
<polygon fill="black" stroke="black" points="3935.31,-1633.73 3944.86,-1629.14 3934.53,-1626.77 3935.31,-1633.73"/>
</g>
<!-- attn_14 -->
<g id="node296" class="node">
<title>attn_14</title>
<polygon fill="lightblue" stroke="black" points="2235,-1402.16 1954,-1402.16 1954,-1350.16 2235,-1350.16 2235,-1402.16"/>
<text text-anchor="middle" x="2094.5" y="-1390.16" font-family="Arial" font-size="10.00">Attention Layer 14</text>
<text text-anchor="middle" x="2094.5" y="-1379.16" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-1368.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-1357.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_13&#45;&gt;attn_14 -->
<g id="edge506" class="edge">
<title>agg_13&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M2094.5,-1438.07C2094.5,-1429.41 2094.5,-1420.58 2094.5,-1412.44"/>
<polygon fill="black" stroke="black" points="2098,-1412.2 2094.5,-1402.2 2091,-1412.2 2098,-1412.2"/>
</g>
<!-- comm_attn_14 -->
<g id="node297" class="node">
<title>comm_attn_14</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-1277.39" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-1291.39" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-1280.39" font-family="Arial" font-size="10.00">GPU: 34 ↔ GPU: 35, 36, 37</text>
<text text-anchor="middle" x="2094.5" y="-1269.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1258.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_14&#45;&gt;comm_attn_14 -->
<g id="edge507" class="edge">
<title>attn_14&#45;&gt;comm_attn_14</title>
<path fill="none" stroke="black" d="M2094.5,-1349.98C2094.5,-1342.18 2094.5,-1333.31 2094.5,-1324.54"/>
<polygon fill="black" stroke="black" points="2098,-1324.36 2094.5,-1314.36 2091,-1324.36 2098,-1324.36"/>
</g>
<!-- gate_14 -->
<g id="node298" class="node">
<title>gate_14</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-1204.62 1931.71,-1204.62 1818.95,-1100.62 2257.29,-1100.62 2370.05,-1204.62"/>
<text text-anchor="middle" x="2094.5" y="-1166.62" font-family="Arial" font-size="10.00">Expert Gate 14</text>
<text text-anchor="middle" x="2094.5" y="-1155.62" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-1144.62" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1133.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_14&#45;&gt;gate_14 -->
<g id="edge508" class="edge">
<title>comm_attn_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M2094.5,-1240.55C2094.5,-1232.51 2094.5,-1223.76 2094.5,-1215.01"/>
<polygon fill="black" stroke="black" points="2098,-1214.78 2094.5,-1204.78 2091,-1214.78 2098,-1214.78"/>
</g>
<!-- all2all_14 -->
<g id="node315" class="node">
<title>all2all_14</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-1027.85" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-1041.85" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-1030.85" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 3)</text>
<text text-anchor="middle" x="2094.5" y="-1019.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-1008.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_14&#45;&gt;all2all_14 -->
<g id="edge509" class="edge">
<title>gate_14&#45;&gt;all2all_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-1100.26C2094.5,-1091.85 2094.5,-1083.19 2094.5,-1074.92"/>
<polygon fill="black" stroke="black" points="2098,-1074.7 2094.5,-1064.7 2091,-1074.7 2098,-1074.7"/>
</g>
<!-- expert_14_0 -->
<g id="node299" class="node">
<title>expert_14_0</title>
<polygon fill="lightblue" stroke="black" points="245,-955.08 0,-955.08 0,-903.08 245,-903.08 245,-955.08"/>
<text text-anchor="middle" x="122.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 0 Layer 14</text>
<text text-anchor="middle" x="122.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 3)</text>
<text text-anchor="middle" x="122.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_14 -->
<g id="node316" class="node">
<title>agg_14</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-867.08 1938.39,-867.08 1830.26,-763.08 2250.61,-763.08 2358.74,-867.08"/>
<text text-anchor="middle" x="2094.5" y="-829.08" font-family="Arial" font-size="10.00">Expert Aggregation 14</text>
<text text-anchor="middle" x="2094.5" y="-818.08" font-family="Arial" font-size="10.00">GPU: 34 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-807.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-796.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_0&#45;&gt;agg_14 -->
<g id="edge511" class="edge">
<title>expert_14_0&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M245.14,-904.13C247.95,-903.76 250.74,-903.41 253.5,-903.08 836.59,-834.01 1529.68,-819.26 1875.48,-816.44"/>
<polygon fill="black" stroke="black" points="1875.63,-819.94 1885.61,-816.36 1875.58,-812.94 1875.63,-819.94"/>
</g>
<!-- expert_14_1 -->
<g id="node300" class="node">
<title>expert_14_1</title>
<polygon fill="lightblue" stroke="black" points="508,-955.08 263,-955.08 263,-903.08 508,-903.08 508,-955.08"/>
<text text-anchor="middle" x="385.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 1 Layer 14</text>
<text text-anchor="middle" x="385.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 3)</text>
<text text-anchor="middle" x="385.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_1&#45;&gt;agg_14 -->
<g id="edge513" class="edge">
<title>expert_14_1&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M508.15,-904.16C510.96,-903.78 513.74,-903.42 516.5,-903.08 1000.37,-843.84 1572.67,-824.92 1877.6,-818.89"/>
<polygon fill="black" stroke="black" points="1877.96,-822.38 1887.89,-818.69 1877.82,-815.39 1877.96,-822.38"/>
</g>
<!-- expert_14_2 -->
<g id="node301" class="node">
<title>expert_14_2</title>
<polygon fill="lightblue" stroke="black" points="771,-955.08 526,-955.08 526,-903.08 771,-903.08 771,-955.08"/>
<text text-anchor="middle" x="648.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 2 Layer 14</text>
<text text-anchor="middle" x="648.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 3)</text>
<text text-anchor="middle" x="648.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_2&#45;&gt;agg_14 -->
<g id="edge515" class="edge">
<title>expert_14_2&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M771.15,-904.2C773.96,-903.81 776.74,-903.43 779.5,-903.08 1165.96,-853.61 1620.14,-831.46 1880.94,-822.17"/>
<polygon fill="black" stroke="black" points="1881.42,-825.65 1891.29,-821.8 1881.17,-818.66 1881.42,-825.65"/>
</g>
<!-- expert_14_3 -->
<g id="node302" class="node">
<title>expert_14_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-955.08 789,-955.08 789,-903.08 1034,-903.08 1034,-955.08"/>
<text text-anchor="middle" x="911.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 3 Layer 14</text>
<text text-anchor="middle" x="911.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 3)</text>
<text text-anchor="middle" x="911.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_3&#45;&gt;agg_14 -->
<g id="edge517" class="edge">
<title>expert_14_3&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1034.16,-904.26C1036.96,-903.85 1039.75,-903.45 1042.5,-903.08 1333.63,-863.37 1672.73,-839.28 1885.52,-826.81"/>
<polygon fill="black" stroke="black" points="1885.78,-830.3 1895.56,-826.23 1885.37,-823.32 1885.78,-830.3"/>
</g>
<!-- expert_14_4 -->
<g id="node303" class="node">
<title>expert_14_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-955.08 1052,-955.08 1052,-903.08 1297,-903.08 1297,-955.08"/>
<text text-anchor="middle" x="1174.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 4 Layer 14</text>
<text text-anchor="middle" x="1174.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 3)</text>
<text text-anchor="middle" x="1174.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_4&#45;&gt;agg_14 -->
<g id="edge519" class="edge">
<title>expert_14_4&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1297.18,-904.36C1299.97,-903.92 1302.75,-903.49 1305.5,-903.08 1504.19,-873.21 1732.48,-849.15 1892.21,-833.96"/>
<polygon fill="black" stroke="black" points="1893.01,-837.4 1902.63,-832.97 1892.35,-830.43 1893.01,-837.4"/>
</g>
<!-- expert_14_5 -->
<g id="node304" class="node">
<title>expert_14_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-955.08 1315,-955.08 1315,-903.08 1560,-903.08 1560,-955.08"/>
<text text-anchor="middle" x="1437.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 5 Layer 14</text>
<text text-anchor="middle" x="1437.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 3)</text>
<text text-anchor="middle" x="1437.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_5&#45;&gt;agg_14 -->
<g id="edge521" class="edge">
<title>expert_14_5&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1560.21,-904.57C1563,-904.06 1565.76,-903.57 1568.5,-903.08 1679.84,-883.25 1804.72,-862.53 1904.85,-846.29"/>
<polygon fill="black" stroke="black" points="1905.46,-849.74 1914.77,-844.68 1904.34,-842.83 1905.46,-849.74"/>
</g>
<!-- expert_14_6 -->
<g id="node305" class="node">
<title>expert_14_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-955.08 1578,-955.08 1578,-903.08 1823,-903.08 1823,-955.08"/>
<text text-anchor="middle" x="1700.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 6 Layer 14</text>
<text text-anchor="middle" x="1700.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 3)</text>
<text text-anchor="middle" x="1700.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_6&#45;&gt;agg_14 -->
<g id="edge523" class="edge">
<title>expert_14_6&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1788.92,-902.94C1828.53,-891.68 1876.66,-878 1922.89,-864.86"/>
<polygon fill="black" stroke="black" points="1924.06,-868.17 1932.72,-862.07 1922.14,-861.43 1924.06,-868.17"/>
</g>
<!-- expert_14_7 -->
<g id="node306" class="node">
<title>expert_14_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-955.08 1841,-955.08 1841,-903.08 2086,-903.08 2086,-955.08"/>
<text text-anchor="middle" x="1963.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 7 Layer 14</text>
<text text-anchor="middle" x="1963.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 3)</text>
<text text-anchor="middle" x="1963.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_7&#45;&gt;agg_14 -->
<g id="edge525" class="edge">
<title>expert_14_7&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1992.9,-902.94C2003.05,-894.27 2014.88,-884.15 2026.8,-873.96"/>
<polygon fill="black" stroke="black" points="2029.31,-876.42 2034.64,-867.26 2024.76,-871.09 2029.31,-876.42"/>
</g>
<!-- expert_14_8 -->
<g id="node307" class="node">
<title>expert_14_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-955.08 2104,-955.08 2104,-903.08 2349,-903.08 2349,-955.08"/>
<text text-anchor="middle" x="2226.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 8 Layer 14</text>
<text text-anchor="middle" x="2226.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 3)</text>
<text text-anchor="middle" x="2226.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_8&#45;&gt;agg_14 -->
<g id="edge527" class="edge">
<title>expert_14_8&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2196.88,-902.94C2186.65,-894.27 2174.73,-884.15 2162.71,-873.96"/>
<polygon fill="black" stroke="black" points="2164.71,-871.06 2154.82,-867.26 2160.18,-876.4 2164.71,-871.06"/>
</g>
<!-- expert_14_9 -->
<g id="node308" class="node">
<title>expert_14_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-955.08 2367,-955.08 2367,-903.08 2612,-903.08 2612,-955.08"/>
<text text-anchor="middle" x="2489.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 9 Layer 14</text>
<text text-anchor="middle" x="2489.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 3)</text>
<text text-anchor="middle" x="2489.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_9&#45;&gt;agg_14 -->
<g id="edge529" class="edge">
<title>expert_14_9&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2400.85,-902.94C2366.21,-893.12 2325.08,-881.46 2284.37,-869.92"/>
<polygon fill="black" stroke="black" points="2285.17,-866.5 2274.6,-867.14 2283.26,-873.24 2285.17,-866.5"/>
</g>
<!-- expert_14_10 -->
<g id="node309" class="node">
<title>expert_14_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-955.08 2630,-955.08 2630,-903.08 2875,-903.08 2875,-955.08"/>
<text text-anchor="middle" x="2752.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 10 Layer 14</text>
<text text-anchor="middle" x="2752.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 3)</text>
<text text-anchor="middle" x="2752.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_10&#45;&gt;agg_14 -->
<g id="edge531" class="edge">
<title>expert_14_10&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2629.79,-904.56C2627,-904.06 2624.24,-903.56 2621.5,-903.08 2535.88,-887.84 2442.26,-872.09 2357.99,-858.25"/>
<polygon fill="black" stroke="black" points="2358.47,-854.78 2348.03,-856.62 2357.33,-861.69 2358.47,-854.78"/>
</g>
<!-- expert_14_11 -->
<g id="node310" class="node">
<title>expert_14_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-955.08 2893,-955.08 2893,-903.08 3138,-903.08 3138,-955.08"/>
<text text-anchor="middle" x="3015.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 11 Layer 14</text>
<text text-anchor="middle" x="3015.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 3)</text>
<text text-anchor="middle" x="3015.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_11&#45;&gt;agg_14 -->
<g id="edge533" class="edge">
<title>expert_14_11&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2892.82,-904.36C2890.03,-903.92 2887.25,-903.49 2884.5,-903.08 2701.91,-875.65 2494.36,-853.12 2337.83,-837.87"/>
<polygon fill="black" stroke="black" points="2337.88,-834.36 2327.59,-836.87 2337.21,-841.33 2337.88,-834.36"/>
</g>
<!-- expert_14_12 -->
<g id="node311" class="node">
<title>expert_14_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-955.08 3156,-955.08 3156,-903.08 3401,-903.08 3401,-955.08"/>
<text text-anchor="middle" x="3278.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 12 Layer 14</text>
<text text-anchor="middle" x="3278.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 3)</text>
<text text-anchor="middle" x="3278.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_12&#45;&gt;agg_14 -->
<g id="edge535" class="edge">
<title>expert_14_12&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M3155.84,-904.26C3153.04,-903.85 3150.25,-903.45 3147.5,-903.08 2866.94,-864.83 2541.87,-841.07 2327.98,-828.24"/>
<polygon fill="black" stroke="black" points="2328.07,-824.74 2317.87,-827.64 2327.65,-831.73 2328.07,-824.74"/>
</g>
<!-- expert_14_13 -->
<g id="node312" class="node">
<title>expert_14_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-955.08 3419,-955.08 3419,-903.08 3664,-903.08 3664,-955.08"/>
<text text-anchor="middle" x="3541.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 13 Layer 14</text>
<text text-anchor="middle" x="3541.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 3)</text>
<text text-anchor="middle" x="3541.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_13&#45;&gt;agg_14 -->
<g id="edge537" class="edge">
<title>expert_14_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M3418.85,-904.2C3416.04,-903.81 3413.26,-903.43 3410.5,-903.08 3030.7,-854.47 2585.55,-832.24 2322.49,-822.67"/>
<polygon fill="black" stroke="black" points="2322.55,-819.17 2312.43,-822.31 2322.3,-826.17 2322.55,-819.17"/>
</g>
<!-- expert_14_14 -->
<g id="node313" class="node">
<title>expert_14_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-955.08 3682,-955.08 3682,-903.08 3927,-903.08 3927,-955.08"/>
<text text-anchor="middle" x="3804.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 14 Layer 14</text>
<text text-anchor="middle" x="3804.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 3)</text>
<text text-anchor="middle" x="3804.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_14&#45;&gt;agg_14 -->
<g id="edge539" class="edge">
<title>expert_14_14&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M3681.85,-904.16C3679.04,-903.78 3676.26,-903.42 3673.5,-903.08 3193.37,-844.3 2626.21,-825.22 2319.23,-819.04"/>
<polygon fill="black" stroke="black" points="2318.94,-815.53 2308.87,-818.83 2318.8,-822.53 2318.94,-815.53"/>
</g>
<!-- expert_14_15 -->
<g id="node314" class="node">
<title>expert_14_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-955.08 3945,-955.08 3945,-903.08 4190,-903.08 4190,-955.08"/>
<text text-anchor="middle" x="4067.5" y="-943.08" font-family="Arial" font-size="10.00">Expert 15 Layer 14</text>
<text text-anchor="middle" x="4067.5" y="-932.08" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 3)</text>
<text text-anchor="middle" x="4067.5" y="-921.08" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-910.08" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_14_15&#45;&gt;agg_14 -->
<g id="edge541" class="edge">
<title>expert_14_15&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M3944.86,-904.13C3942.05,-903.76 3939.26,-903.4 3936.5,-903.08 3354.67,-834.17 2663.37,-819.32 2316.45,-816.46"/>
<polygon fill="black" stroke="black" points="2316.31,-812.96 2306.29,-816.38 2316.26,-819.96 2316.31,-812.96"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_0 -->
<g id="edge510" class="edge">
<title>all2all_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" d="M1915.5,-1023.28C1522.04,-1014.9 590.94,-991.9 255.38,-955.2"/>
<polygon fill="black" stroke="black" points="255.47,-951.69 245.14,-954.06 254.69,-958.65 255.47,-951.69"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_1 -->
<g id="edge512" class="edge">
<title>all2all_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" d="M1913.96,-1027.02C1622.01,-1025.42 1028.27,-1014.45 518.28,-955.22"/>
<polygon fill="black" stroke="black" points="518.48,-951.72 508.14,-954.03 517.67,-958.67 518.48,-951.72"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_2 -->
<g id="edge514" class="edge">
<title>all2all_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" d="M1914.63,-1024.65C1662.79,-1019.86 1190.87,-1004.64 781.12,-955.21"/>
<polygon fill="black" stroke="black" points="781.5,-951.73 771.15,-954 780.65,-958.68 781.5,-951.73"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_3 -->
<g id="edge516" class="edge">
<title>all2all_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" d="M1917.03,-1021.26C1709.64,-1013.25 1356.12,-994.96 1044.3,-955.25"/>
<polygon fill="black" stroke="black" points="1044.52,-951.75 1034.15,-953.95 1043.63,-958.69 1044.52,-951.75"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_4 -->
<g id="edge518" class="edge">
<title>all2all_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" d="M1923.49,-1016.14C1765.73,-1005.13 1524.89,-985.48 1307.19,-955.27"/>
<polygon fill="black" stroke="black" points="1307.55,-951.78 1297.17,-953.86 1306.58,-958.72 1307.55,-951.78"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_5 -->
<g id="edge520" class="edge">
<title>all2all_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" d="M1941.98,-1008.21C1839.48,-995.16 1701.14,-976.56 1570.39,-955.36"/>
<polygon fill="black" stroke="black" points="1570.62,-951.85 1560.19,-953.7 1569.5,-958.76 1570.62,-951.85"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_6 -->
<g id="edge522" class="edge">
<title>all2all_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" d="M1981.6,-999.12C1928.4,-986.05 1865.13,-970.51 1812.1,-957.49"/>
<polygon fill="black" stroke="black" points="1812.87,-954.07 1802.32,-955.09 1811.2,-960.87 1812.87,-954.07"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_7 -->
<g id="edge524" class="edge">
<title>all2all_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" d="M2047.58,-992.19C2033.84,-982.04 2018.91,-971.01 2005.49,-961.1"/>
<polygon fill="black" stroke="black" points="2007.49,-958.22 1997.36,-955.09 2003.33,-963.85 2007.49,-958.22"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_8 -->
<g id="edge526" class="edge">
<title>all2all_14&#45;&gt;expert_14_8</title>
<path fill="none" stroke="black" d="M2141.78,-992.19C2155.63,-982.04 2170.67,-971.01 2184.19,-961.1"/>
<polygon fill="black" stroke="black" points="2186.38,-963.83 2192.38,-955.09 2182.25,-958.18 2186.38,-963.83"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_9 -->
<g id="edge528" class="edge">
<title>all2all_14&#45;&gt;expert_14_9</title>
<path fill="none" stroke="black" d="M2207.43,-999.18C2260.77,-986.12 2324.25,-970.56 2377.47,-957.52"/>
<polygon fill="black" stroke="black" points="2378.41,-960.9 2387.29,-955.12 2376.74,-954.1 2378.41,-960.9"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_10 -->
<g id="edge530" class="edge">
<title>all2all_14&#45;&gt;expert_14_10</title>
<path fill="none" stroke="black" d="M2247.31,-1008.22C2350.01,-995.18 2488.61,-976.58 2619.59,-955.36"/>
<polygon fill="black" stroke="black" points="2620.5,-958.76 2629.81,-953.7 2619.38,-951.85 2620.5,-958.76"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_11 -->
<g id="edge532" class="edge">
<title>all2all_14&#45;&gt;expert_14_11</title>
<path fill="none" stroke="black" d="M2265.73,-1016.15C2423.69,-1005.15 2664.83,-985.5 2882.8,-955.27"/>
<polygon fill="black" stroke="black" points="2883.42,-958.72 2892.84,-953.87 2882.45,-951.78 2883.42,-958.72"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_12 -->
<g id="edge534" class="edge">
<title>all2all_14&#45;&gt;expert_14_12</title>
<path fill="none" stroke="black" d="M2272.14,-1021.27C2479.73,-1013.27 2833.58,-994.98 3145.69,-955.25"/>
<polygon fill="black" stroke="black" points="3146.37,-958.69 3155.85,-953.95 3145.48,-951.75 3146.37,-958.69"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_13 -->
<g id="edge536" class="edge">
<title>all2all_14&#45;&gt;expert_14_13</title>
<path fill="none" stroke="black" d="M2274.24,-1024.67C2526.2,-1019.89 2998.67,-1004.68 3408.87,-955.21"/>
<polygon fill="black" stroke="black" points="3409.35,-958.68 3418.85,-954 3408.5,-951.73 3409.35,-958.68"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_14 -->
<g id="edge538" class="edge">
<title>all2all_14&#45;&gt;expert_14_14</title>
<path fill="none" stroke="black" d="M2274.85,-1027.02C2566.88,-1025.45 3161.23,-1014.5 3671.71,-955.22"/>
<polygon fill="black" stroke="black" points="3672.33,-958.67 3681.86,-954.03 3671.52,-951.72 3672.33,-958.67"/>
</g>
<!-- all2all_14&#45;&gt;expert_14_15 -->
<g id="edge540" class="edge">
<title>all2all_14&#45;&gt;expert_14_15</title>
<path fill="none" stroke="black" d="M2273.6,-1023.29C2667.27,-1014.91 3598.88,-991.92 3934.62,-955.2"/>
<polygon fill="black" stroke="black" points="3935.31,-958.65 3944.86,-954.06 3934.53,-951.69 3935.31,-958.65"/>
</g>
<!-- attn_15 -->
<g id="node317" class="node">
<title>attn_15</title>
<polygon fill="lightblue" stroke="black" points="2235,-727.08 1954,-727.08 1954,-675.08 2235,-675.08 2235,-727.08"/>
<text text-anchor="middle" x="2094.5" y="-715.08" font-family="Arial" font-size="10.00">Attention Layer 15</text>
<text text-anchor="middle" x="2094.5" y="-704.08" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-693.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
<text text-anchor="middle" x="2094.5" y="-682.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, heads=4, d_k=64]</text>
</g>
<!-- agg_14&#45;&gt;attn_15 -->
<g id="edge542" class="edge">
<title>agg_14&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M2094.5,-762.99C2094.5,-754.33 2094.5,-745.51 2094.5,-737.36"/>
<polygon fill="black" stroke="black" points="2098,-737.12 2094.5,-727.12 2091,-737.12 2098,-737.12"/>
</g>
<!-- comm_attn_15 -->
<g id="node318" class="node">
<title>comm_attn_15</title>
<ellipse fill="lightgreen" stroke="black" cx="2094.5" cy="-602.31" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-616.31" font-family="Arial" font-size="10.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2094.5" y="-605.31" font-family="Arial" font-size="10.00">GPU: 35 ↔ GPU: 36, 37, 38</text>
<text text-anchor="middle" x="2094.5" y="-594.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-583.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- attn_15&#45;&gt;comm_attn_15 -->
<g id="edge543" class="edge">
<title>attn_15&#45;&gt;comm_attn_15</title>
<path fill="none" stroke="black" d="M2094.5,-674.91C2094.5,-667.1 2094.5,-658.23 2094.5,-649.46"/>
<polygon fill="black" stroke="black" points="2098,-649.29 2094.5,-639.29 2091,-649.29 2098,-649.29"/>
</g>
<!-- gate_15 -->
<g id="node319" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="2370.05,-529.54 1931.71,-529.54 1818.95,-425.54 2257.29,-425.54 2370.05,-529.54"/>
<text text-anchor="middle" x="2094.5" y="-491.54" font-family="Arial" font-size="10.00">Expert Gate 15</text>
<text text-anchor="middle" x="2094.5" y="-480.54" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-469.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-458.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, expert_ids=16]</text>
</g>
<!-- comm_attn_15&#45;&gt;gate_15 -->
<g id="edge544" class="edge">
<title>comm_attn_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M2094.5,-565.47C2094.5,-557.43 2094.5,-548.68 2094.5,-539.93"/>
<polygon fill="black" stroke="black" points="2098,-539.71 2094.5,-529.71 2091,-539.71 2098,-539.71"/>
</g>
<!-- all2all_15 -->
<g id="node336" class="node">
<title>all2all_15</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2094.5" cy="-352.77" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="2094.5" y="-366.77" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All</text>
<text text-anchor="middle" x="2094.5" y="-355.77" font-family="Arial" font-size="10.00">GPU: 32&#45;39 (EP Group 3)</text>
<text text-anchor="middle" x="2094.5" y="-344.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-333.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- gate_15&#45;&gt;all2all_15 -->
<g id="edge545" class="edge">
<title>gate_15&#45;&gt;all2all_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2094.5,-425.19C2094.5,-416.78 2094.5,-408.11 2094.5,-399.84"/>
<polygon fill="black" stroke="black" points="2098,-399.63 2094.5,-389.63 2091,-399.63 2098,-399.63"/>
</g>
<!-- expert_15_0 -->
<g id="node320" class="node">
<title>expert_15_0</title>
<polygon fill="lightblue" stroke="black" points="245,-280 0,-280 0,-228 245,-228 245,-280"/>
<text text-anchor="middle" x="122.5" y="-268" font-family="Arial" font-size="10.00">Expert 0 Layer 15</text>
<text text-anchor="middle" x="122.5" y="-257" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 3)</text>
<text text-anchor="middle" x="122.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="122.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- agg_15 -->
<g id="node337" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="2358.74,-192 1938.39,-192 1830.26,-88 2250.61,-88 2358.74,-192"/>
<text text-anchor="middle" x="2094.5" y="-154" font-family="Arial" font-size="10.00">Expert Aggregation 15</text>
<text text-anchor="middle" x="2094.5" y="-143" font-family="Arial" font-size="10.00">GPU: 35 (TP Group 1)</text>
<text text-anchor="middle" x="2094.5" y="-132" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-121" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_0&#45;&gt;agg_15 -->
<g id="edge547" class="edge">
<title>expert_15_0&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M245.14,-229.05C247.95,-228.68 250.74,-228.33 253.5,-228 836.59,-158.94 1529.68,-144.18 1875.48,-141.36"/>
<polygon fill="black" stroke="black" points="1875.63,-144.86 1885.61,-141.28 1875.58,-137.86 1875.63,-144.86"/>
</g>
<!-- expert_15_1 -->
<g id="node321" class="node">
<title>expert_15_1</title>
<polygon fill="lightblue" stroke="black" points="508,-280 263,-280 263,-228 508,-228 508,-280"/>
<text text-anchor="middle" x="385.5" y="-268" font-family="Arial" font-size="10.00">Expert 1 Layer 15</text>
<text text-anchor="middle" x="385.5" y="-257" font-family="Arial" font-size="10.00">GPU: 36 (EP Group 3)</text>
<text text-anchor="middle" x="385.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="385.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_1&#45;&gt;agg_15 -->
<g id="edge549" class="edge">
<title>expert_15_1&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M508.15,-229.08C510.96,-228.7 513.74,-228.34 516.5,-228 1000.37,-168.76 1572.67,-149.84 1877.6,-143.81"/>
<polygon fill="black" stroke="black" points="1877.96,-147.31 1887.89,-143.61 1877.82,-140.31 1877.96,-147.31"/>
</g>
<!-- expert_15_2 -->
<g id="node322" class="node">
<title>expert_15_2</title>
<polygon fill="lightblue" stroke="black" points="771,-280 526,-280 526,-228 771,-228 771,-280"/>
<text text-anchor="middle" x="648.5" y="-268" font-family="Arial" font-size="10.00">Expert 2 Layer 15</text>
<text text-anchor="middle" x="648.5" y="-257" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 3)</text>
<text text-anchor="middle" x="648.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="648.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_2&#45;&gt;agg_15 -->
<g id="edge551" class="edge">
<title>expert_15_2&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M771.15,-229.12C773.96,-228.73 776.74,-228.35 779.5,-228 1165.96,-178.53 1620.14,-156.38 1880.94,-147.09"/>
<polygon fill="black" stroke="black" points="1881.42,-150.58 1891.29,-146.73 1881.17,-143.58 1881.42,-150.58"/>
</g>
<!-- expert_15_3 -->
<g id="node323" class="node">
<title>expert_15_3</title>
<polygon fill="lightblue" stroke="black" points="1034,-280 789,-280 789,-228 1034,-228 1034,-280"/>
<text text-anchor="middle" x="911.5" y="-268" font-family="Arial" font-size="10.00">Expert 3 Layer 15</text>
<text text-anchor="middle" x="911.5" y="-257" font-family="Arial" font-size="10.00">GPU: 37 (EP Group 3)</text>
<text text-anchor="middle" x="911.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="911.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_3&#45;&gt;agg_15 -->
<g id="edge553" class="edge">
<title>expert_15_3&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1034.16,-229.18C1036.96,-228.77 1039.75,-228.38 1042.5,-228 1333.63,-188.3 1672.73,-164.2 1885.52,-151.73"/>
<polygon fill="black" stroke="black" points="1885.78,-155.23 1895.56,-151.15 1885.37,-148.24 1885.78,-155.23"/>
</g>
<!-- expert_15_4 -->
<g id="node324" class="node">
<title>expert_15_4</title>
<polygon fill="lightblue" stroke="black" points="1297,-280 1052,-280 1052,-228 1297,-228 1297,-280"/>
<text text-anchor="middle" x="1174.5" y="-268" font-family="Arial" font-size="10.00">Expert 4 Layer 15</text>
<text text-anchor="middle" x="1174.5" y="-257" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 3)</text>
<text text-anchor="middle" x="1174.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1174.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_4&#45;&gt;agg_15 -->
<g id="edge555" class="edge">
<title>expert_15_4&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1297.18,-229.29C1299.97,-228.84 1302.75,-228.41 1305.5,-228 1504.19,-198.13 1732.48,-174.07 1892.21,-158.88"/>
<polygon fill="black" stroke="black" points="1893.01,-162.32 1902.63,-157.89 1892.35,-155.35 1893.01,-162.32"/>
</g>
<!-- expert_15_5 -->
<g id="node325" class="node">
<title>expert_15_5</title>
<polygon fill="lightblue" stroke="black" points="1560,-280 1315,-280 1315,-228 1560,-228 1560,-280"/>
<text text-anchor="middle" x="1437.5" y="-268" font-family="Arial" font-size="10.00">Expert 5 Layer 15</text>
<text text-anchor="middle" x="1437.5" y="-257" font-family="Arial" font-size="10.00">GPU: 38 (EP Group 3)</text>
<text text-anchor="middle" x="1437.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1437.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_5&#45;&gt;agg_15 -->
<g id="edge557" class="edge">
<title>expert_15_5&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1560.21,-229.49C1563,-228.98 1565.76,-228.49 1568.5,-228 1679.84,-208.17 1804.72,-187.45 1904.85,-171.21"/>
<polygon fill="black" stroke="black" points="1905.46,-174.66 1914.77,-169.6 1904.34,-167.75 1905.46,-174.66"/>
</g>
<!-- expert_15_6 -->
<g id="node326" class="node">
<title>expert_15_6</title>
<polygon fill="lightblue" stroke="black" points="1823,-280 1578,-280 1578,-228 1823,-228 1823,-280"/>
<text text-anchor="middle" x="1700.5" y="-268" font-family="Arial" font-size="10.00">Expert 6 Layer 15</text>
<text text-anchor="middle" x="1700.5" y="-257" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 3)</text>
<text text-anchor="middle" x="1700.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1700.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_6&#45;&gt;agg_15 -->
<g id="edge559" class="edge">
<title>expert_15_6&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1788.92,-227.87C1828.53,-216.61 1876.66,-202.92 1922.89,-189.78"/>
<polygon fill="black" stroke="black" points="1924.06,-193.09 1932.72,-186.99 1922.14,-186.36 1924.06,-193.09"/>
</g>
<!-- expert_15_7 -->
<g id="node327" class="node">
<title>expert_15_7</title>
<polygon fill="lightblue" stroke="black" points="2086,-280 1841,-280 1841,-228 2086,-228 2086,-280"/>
<text text-anchor="middle" x="1963.5" y="-268" font-family="Arial" font-size="10.00">Expert 7 Layer 15</text>
<text text-anchor="middle" x="1963.5" y="-257" font-family="Arial" font-size="10.00">GPU: 39 (EP Group 3)</text>
<text text-anchor="middle" x="1963.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="1963.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_7&#45;&gt;agg_15 -->
<g id="edge561" class="edge">
<title>expert_15_7&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1992.9,-227.87C2003.05,-219.19 2014.88,-209.07 2026.8,-198.88"/>
<polygon fill="black" stroke="black" points="2029.31,-201.34 2034.64,-192.18 2024.76,-196.02 2029.31,-201.34"/>
</g>
<!-- expert_15_8 -->
<g id="node328" class="node">
<title>expert_15_8</title>
<polygon fill="lightblue" stroke="black" points="2349,-280 2104,-280 2104,-228 2349,-228 2349,-280"/>
<text text-anchor="middle" x="2226.5" y="-268" font-family="Arial" font-size="10.00">Expert 8 Layer 15</text>
<text text-anchor="middle" x="2226.5" y="-257" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 3)</text>
<text text-anchor="middle" x="2226.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2226.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_8&#45;&gt;agg_15 -->
<g id="edge563" class="edge">
<title>expert_15_8&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2196.88,-227.87C2186.65,-219.19 2174.73,-209.07 2162.71,-198.88"/>
<polygon fill="black" stroke="black" points="2164.71,-195.98 2154.82,-192.18 2160.18,-201.32 2164.71,-195.98"/>
</g>
<!-- expert_15_9 -->
<g id="node329" class="node">
<title>expert_15_9</title>
<polygon fill="lightblue" stroke="black" points="2612,-280 2367,-280 2367,-228 2612,-228 2612,-280"/>
<text text-anchor="middle" x="2489.5" y="-268" font-family="Arial" font-size="10.00">Expert 9 Layer 15</text>
<text text-anchor="middle" x="2489.5" y="-257" font-family="Arial" font-size="10.00">GPU: 40 (EP Group 3)</text>
<text text-anchor="middle" x="2489.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2489.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_9&#45;&gt;agg_15 -->
<g id="edge565" class="edge">
<title>expert_15_9&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2400.85,-227.87C2366.21,-218.04 2325.08,-206.38 2284.37,-194.84"/>
<polygon fill="black" stroke="black" points="2285.17,-191.43 2274.6,-192.06 2283.26,-198.16 2285.17,-191.43"/>
</g>
<!-- expert_15_10 -->
<g id="node330" class="node">
<title>expert_15_10</title>
<polygon fill="lightblue" stroke="black" points="2875,-280 2630,-280 2630,-228 2875,-228 2875,-280"/>
<text text-anchor="middle" x="2752.5" y="-268" font-family="Arial" font-size="10.00">Expert 10 Layer 15</text>
<text text-anchor="middle" x="2752.5" y="-257" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 3)</text>
<text text-anchor="middle" x="2752.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="2752.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_10&#45;&gt;agg_15 -->
<g id="edge567" class="edge">
<title>expert_15_10&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2629.79,-229.49C2627,-228.98 2624.24,-228.49 2621.5,-228 2535.88,-212.76 2442.26,-197.02 2357.99,-183.17"/>
<polygon fill="black" stroke="black" points="2358.47,-179.7 2348.03,-181.54 2357.33,-186.61 2358.47,-179.7"/>
</g>
<!-- expert_15_11 -->
<g id="node331" class="node">
<title>expert_15_11</title>
<polygon fill="lightblue" stroke="black" points="3138,-280 2893,-280 2893,-228 3138,-228 3138,-280"/>
<text text-anchor="middle" x="3015.5" y="-268" font-family="Arial" font-size="10.00">Expert 11 Layer 15</text>
<text text-anchor="middle" x="3015.5" y="-257" font-family="Arial" font-size="10.00">GPU: 41 (EP Group 3)</text>
<text text-anchor="middle" x="3015.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3015.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_11&#45;&gt;agg_15 -->
<g id="edge569" class="edge">
<title>expert_15_11&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2892.82,-229.28C2890.03,-228.84 2887.25,-228.41 2884.5,-228 2701.91,-200.57 2494.36,-178.04 2337.83,-162.79"/>
<polygon fill="black" stroke="black" points="2337.88,-159.28 2327.59,-161.8 2337.21,-166.25 2337.88,-159.28"/>
</g>
<!-- expert_15_12 -->
<g id="node332" class="node">
<title>expert_15_12</title>
<polygon fill="lightblue" stroke="black" points="3401,-280 3156,-280 3156,-228 3401,-228 3401,-280"/>
<text text-anchor="middle" x="3278.5" y="-268" font-family="Arial" font-size="10.00">Expert 12 Layer 15</text>
<text text-anchor="middle" x="3278.5" y="-257" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 3)</text>
<text text-anchor="middle" x="3278.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3278.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_12&#45;&gt;agg_15 -->
<g id="edge571" class="edge">
<title>expert_15_12&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M3155.84,-229.18C3153.04,-228.77 3150.25,-228.38 3147.5,-228 2866.94,-189.75 2541.87,-166 2327.98,-153.16"/>
<polygon fill="black" stroke="black" points="2328.07,-149.66 2317.87,-152.56 2327.65,-156.65 2328.07,-149.66"/>
</g>
<!-- expert_15_13 -->
<g id="node333" class="node">
<title>expert_15_13</title>
<polygon fill="lightblue" stroke="black" points="3664,-280 3419,-280 3419,-228 3664,-228 3664,-280"/>
<text text-anchor="middle" x="3541.5" y="-268" font-family="Arial" font-size="10.00">Expert 13 Layer 15</text>
<text text-anchor="middle" x="3541.5" y="-257" font-family="Arial" font-size="10.00">GPU: 42 (EP Group 3)</text>
<text text-anchor="middle" x="3541.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3541.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_13&#45;&gt;agg_15 -->
<g id="edge573" class="edge">
<title>expert_15_13&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M3418.85,-229.12C3416.04,-228.73 3413.26,-228.35 3410.5,-228 3030.7,-179.39 2585.55,-157.16 2322.49,-147.59"/>
<polygon fill="black" stroke="black" points="2322.55,-144.09 2312.43,-147.23 2322.3,-151.09 2322.55,-144.09"/>
</g>
<!-- expert_15_14 -->
<g id="node334" class="node">
<title>expert_15_14</title>
<polygon fill="lightblue" stroke="black" points="3927,-280 3682,-280 3682,-228 3927,-228 3927,-280"/>
<text text-anchor="middle" x="3804.5" y="-268" font-family="Arial" font-size="10.00">Expert 14 Layer 15</text>
<text text-anchor="middle" x="3804.5" y="-257" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 3)</text>
<text text-anchor="middle" x="3804.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="3804.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_14&#45;&gt;agg_15 -->
<g id="edge575" class="edge">
<title>expert_15_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M3681.85,-229.08C3679.04,-228.7 3676.26,-228.34 3673.5,-228 3193.37,-169.23 2626.21,-150.14 2319.23,-143.96"/>
<polygon fill="black" stroke="black" points="2318.94,-140.45 2308.87,-143.75 2318.8,-147.45 2318.94,-140.45"/>
</g>
<!-- expert_15_15 -->
<g id="node335" class="node">
<title>expert_15_15</title>
<polygon fill="lightblue" stroke="black" points="4190,-280 3945,-280 3945,-228 4190,-228 4190,-280"/>
<text text-anchor="middle" x="4067.5" y="-268" font-family="Arial" font-size="10.00">Expert 15 Layer 15</text>
<text text-anchor="middle" x="4067.5" y="-257" font-family="Arial" font-size="10.00">GPU: 43 (EP Group 3)</text>
<text text-anchor="middle" x="4067.5" y="-246" font-family="Arial" font-size="10.00">Input: [batch_size=8, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4067.5" y="-235" font-family="Arial" font-size="10.00">Output: [batch_size=8, seq_len=10240, hidden=128]</text>
</g>
<!-- expert_15_15&#45;&gt;agg_15 -->
<g id="edge577" class="edge">
<title>expert_15_15&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M3944.86,-229.05C3942.05,-228.68 3939.26,-228.33 3936.5,-228 3354.67,-159.09 2663.37,-144.24 2316.45,-141.38"/>
<polygon fill="black" stroke="black" points="2316.31,-137.88 2306.29,-141.3 2316.26,-144.88 2316.31,-137.88"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_0 -->
<g id="edge546" class="edge">
<title>all2all_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" d="M1915.5,-348.21C1522.04,-339.82 590.94,-316.82 255.38,-280.13"/>
<polygon fill="black" stroke="black" points="255.47,-276.61 245.14,-278.98 254.69,-283.57 255.47,-276.61"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_1 -->
<g id="edge548" class="edge">
<title>all2all_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" d="M1913.96,-351.94C1622.01,-350.34 1028.27,-339.38 518.28,-280.14"/>
<polygon fill="black" stroke="black" points="518.48,-276.64 508.14,-278.96 517.67,-283.59 518.48,-276.64"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_2 -->
<g id="edge550" class="edge">
<title>all2all_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" d="M1914.63,-349.57C1662.79,-344.78 1190.87,-329.56 781.12,-280.13"/>
<polygon fill="black" stroke="black" points="781.5,-276.65 771.15,-278.92 780.65,-283.6 781.5,-276.65"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_3 -->
<g id="edge552" class="edge">
<title>all2all_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" d="M1917.03,-346.18C1709.64,-338.17 1356.12,-319.88 1044.3,-280.17"/>
<polygon fill="black" stroke="black" points="1044.52,-276.67 1034.15,-278.87 1043.63,-283.62 1044.52,-276.67"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_4 -->
<g id="edge554" class="edge">
<title>all2all_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" d="M1923.49,-341.06C1765.73,-330.06 1524.89,-310.4 1307.19,-280.19"/>
<polygon fill="black" stroke="black" points="1307.55,-276.7 1297.17,-278.79 1306.58,-283.64 1307.55,-276.7"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_5 -->
<g id="edge556" class="edge">
<title>all2all_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" d="M1941.98,-333.13C1839.48,-320.08 1701.14,-301.48 1570.39,-280.28"/>
<polygon fill="black" stroke="black" points="1570.62,-276.77 1560.19,-278.62 1569.5,-283.68 1570.62,-276.77"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_6 -->
<g id="edge558" class="edge">
<title>all2all_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" d="M1981.6,-324.04C1928.4,-310.97 1865.13,-295.43 1812.1,-282.41"/>
<polygon fill="black" stroke="black" points="1812.87,-278.99 1802.32,-280.01 1811.2,-285.79 1812.87,-278.99"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_7 -->
<g id="edge560" class="edge">
<title>all2all_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" d="M2047.58,-317.11C2033.84,-306.96 2018.91,-295.93 2005.49,-286.02"/>
<polygon fill="black" stroke="black" points="2007.49,-283.14 1997.36,-280.01 2003.33,-288.77 2007.49,-283.14"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_8 -->
<g id="edge562" class="edge">
<title>all2all_15&#45;&gt;expert_15_8</title>
<path fill="none" stroke="black" d="M2141.78,-317.11C2155.63,-306.96 2170.67,-295.93 2184.19,-286.02"/>
<polygon fill="black" stroke="black" points="2186.38,-288.75 2192.38,-280.01 2182.25,-283.1 2186.38,-288.75"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_9 -->
<g id="edge564" class="edge">
<title>all2all_15&#45;&gt;expert_15_9</title>
<path fill="none" stroke="black" d="M2207.43,-324.1C2260.77,-311.04 2324.25,-295.48 2377.47,-282.44"/>
<polygon fill="black" stroke="black" points="2378.41,-285.82 2387.29,-280.04 2376.74,-279.02 2378.41,-285.82"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_10 -->
<g id="edge566" class="edge">
<title>all2all_15&#45;&gt;expert_15_10</title>
<path fill="none" stroke="black" d="M2247.31,-333.14C2350.01,-320.1 2488.61,-301.5 2619.59,-280.28"/>
<polygon fill="black" stroke="black" points="2620.5,-283.68 2629.81,-278.62 2619.38,-276.77 2620.5,-283.68"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_11 -->
<g id="edge568" class="edge">
<title>all2all_15&#45;&gt;expert_15_11</title>
<path fill="none" stroke="black" d="M2265.73,-341.07C2423.69,-330.08 2664.83,-310.43 2882.8,-280.19"/>
<polygon fill="black" stroke="black" points="2883.42,-283.64 2892.84,-278.79 2882.45,-276.7 2883.42,-283.64"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_12 -->
<g id="edge570" class="edge">
<title>all2all_15&#45;&gt;expert_15_12</title>
<path fill="none" stroke="black" d="M2272.14,-346.19C2479.73,-338.19 2833.58,-319.91 3145.69,-280.17"/>
<polygon fill="black" stroke="black" points="3146.37,-283.62 3155.85,-278.87 3145.48,-276.67 3146.37,-283.62"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_13 -->
<g id="edge572" class="edge">
<title>all2all_15&#45;&gt;expert_15_13</title>
<path fill="none" stroke="black" d="M2274.24,-349.59C2526.2,-344.81 2998.67,-329.6 3408.87,-280.13"/>
<polygon fill="black" stroke="black" points="3409.35,-283.6 3418.85,-278.92 3408.5,-276.65 3409.35,-283.6"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_14 -->
<g id="edge574" class="edge">
<title>all2all_15&#45;&gt;expert_15_14</title>
<path fill="none" stroke="black" d="M2274.85,-351.95C2566.88,-350.37 3161.23,-339.43 3671.71,-280.14"/>
<polygon fill="black" stroke="black" points="3672.33,-283.59 3681.86,-278.96 3671.52,-276.64 3672.33,-283.59"/>
</g>
<!-- all2all_15&#45;&gt;expert_15_15 -->
<g id="edge576" class="edge">
<title>all2all_15&#45;&gt;expert_15_15</title>
<path fill="none" stroke="black" d="M2273.6,-348.21C2667.27,-339.83 3598.88,-316.84 3934.62,-280.13"/>
<polygon fill="black" stroke="black" points="3935.31,-283.57 3944.86,-278.98 3934.53,-276.61 3935.31,-283.57"/>
</g>
<!-- output -->
<g id="node338" class="node">
<title>output</title>
<polygon fill="lightgray" stroke="black" points="2238,-52 1951,-52 1951,0 2238,0 2238,-52"/>
<text text-anchor="middle" x="2094.5" y="-40" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="2094.5" y="-29" font-family="Arial" font-size="10.00">GPU: 32&#45;35 (TP Group 2)</text>
<text text-anchor="middle" x="2094.5" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=128]</text>
<text text-anchor="middle" x="2094.5" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, vocab_size=50000]</text>
</g>
<!-- agg_15&#45;&gt;output -->
<g id="edge578" class="edge">
<title>agg_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2094.5,-87.92C2094.5,-79.25 2094.5,-70.43 2094.5,-62.29"/>
<polygon fill="black" stroke="black" points="2098,-62.04 2094.5,-52.04 2091,-62.04 2098,-62.04"/>
</g>
<!-- pipe_comm_0&#45;&gt;attn_8 -->
<g id="edge290" class="edge">
<title>pipe_comm_0&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M2094.5,-5488.36C2094.5,-5480.05 2094.5,-5471.22 2094.5,-5462.93"/>
<polygon fill="black" stroke="black" points="2098,-5462.82 2094.5,-5452.82 2091,-5462.82 2098,-5462.82"/>
</g>
</g>
</svg>
