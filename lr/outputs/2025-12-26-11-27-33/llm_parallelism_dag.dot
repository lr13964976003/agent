// LLM Parallelism Strategy Deployment DAG
digraph {
	concentrate=true rankdir=TB size="20,30"
	node [fontsize=10]
	node [fillcolor=lightblue shape=ellipse style=filled]
	node [fillcolor=lightgreen shape=rectangle style=filled]
	node [fillcolor=lightyellow shape=parallelogram style=filled]
	input [label="Input\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, heads=16, d_k=32]" fillcolor=lightpink shape=invhouse style=filled]
	subgraph cluster_pp_stage_0 {
		bgcolor=lightgray label="Pipeline Stage 0 (Layers 0-3)" style=rounded
		subgraph cluster_dp_0_0 {
			bgcolor=white label="DP Group 0" style=dashed
			attn_pp0_dp0_gpu0_layer0 [label="Attention L0\nGPU 0\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu0_layer0 [label="MoE Router L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu0_layer0_exp0 [label="Expert 0 L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer0_exp1 [label="Expert 1 L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer0_exp2 [label="Expert 2 L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer0_exp3 [label="Expert 3 L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu0_layer0 [label="Expert Agg L0\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu0_layer1 [label="Attention L1\nGPU 0\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu0_layer1 [label="MoE Router L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu0_layer1_exp0 [label="Expert 0 L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer1_exp1 [label="Expert 1 L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer1_exp2 [label="Expert 2 L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer1_exp3 [label="Expert 3 L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu0_layer1 [label="Expert Agg L1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu0_layer2 [label="Attention L2\nGPU 0\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu0_layer2 [label="MoE Router L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu0_layer2_exp0 [label="Expert 0 L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer2_exp1 [label="Expert 1 L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer2_exp2 [label="Expert 2 L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer2_exp3 [label="Expert 3 L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu0_layer2 [label="Expert Agg L2\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu0_layer3 [label="Attention L3\nGPU 0\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu0_layer3 [label="MoE Router L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu0_layer3_exp0 [label="Expert 0 L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer3_exp1 [label="Expert 1 L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer3_exp2 [label="Expert 2 L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu0_layer3_exp3 [label="Expert 3 L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu0_layer3 [label="Expert Agg L3\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu1_layer0 [label="Attention L0\nGPU 1\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu1_layer0 [label="MoE Router L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu1_layer0_exp4 [label="Expert 4 L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer0_exp5 [label="Expert 5 L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer0_exp6 [label="Expert 6 L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer0_exp7 [label="Expert 7 L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu1_layer0 [label="Expert Agg L0\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu1_layer1 [label="Attention L1\nGPU 1\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu1_layer1 [label="MoE Router L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu1_layer1_exp4 [label="Expert 4 L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer1_exp5 [label="Expert 5 L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer1_exp6 [label="Expert 6 L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer1_exp7 [label="Expert 7 L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu1_layer1 [label="Expert Agg L1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu1_layer2 [label="Attention L2\nGPU 1\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu1_layer2 [label="MoE Router L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu1_layer2_exp4 [label="Expert 4 L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer2_exp5 [label="Expert 5 L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer2_exp6 [label="Expert 6 L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer2_exp7 [label="Expert 7 L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu1_layer2 [label="Expert Agg L2\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu1_layer3 [label="Attention L3\nGPU 1\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu1_layer3 [label="MoE Router L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu1_layer3_exp4 [label="Expert 4 L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer3_exp5 [label="Expert 5 L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer3_exp6 [label="Expert 6 L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu1_layer3_exp7 [label="Expert 7 L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu1_layer3 [label="Expert Agg L3\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu2_layer0 [label="Attention L0\nGPU 2\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu2_layer0 [label="MoE Router L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu2_layer0_exp8 [label="Expert 8 L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer0_exp9 [label="Expert 9 L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer0_exp10 [label="Expert 10 L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer0_exp11 [label="Expert 11 L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu2_layer0 [label="Expert Agg L0\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu2_layer1 [label="Attention L1\nGPU 2\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu2_layer1 [label="MoE Router L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu2_layer1_exp8 [label="Expert 8 L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer1_exp9 [label="Expert 9 L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer1_exp10 [label="Expert 10 L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer1_exp11 [label="Expert 11 L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu2_layer1 [label="Expert Agg L1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu2_layer2 [label="Attention L2\nGPU 2\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu2_layer2 [label="MoE Router L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu2_layer2_exp8 [label="Expert 8 L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer2_exp9 [label="Expert 9 L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer2_exp10 [label="Expert 10 L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer2_exp11 [label="Expert 11 L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu2_layer2 [label="Expert Agg L2\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu2_layer3 [label="Attention L3\nGPU 2\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu2_layer3 [label="MoE Router L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu2_layer3_exp8 [label="Expert 8 L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer3_exp9 [label="Expert 9 L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer3_exp10 [label="Expert 10 L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu2_layer3_exp11 [label="Expert 11 L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu2_layer3 [label="Expert Agg L3\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu3_layer0 [label="Attention L0\nGPU 3\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu3_layer0 [label="MoE Router L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu3_layer0_exp12 [label="Expert 12 L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer0_exp13 [label="Expert 13 L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer0_exp14 [label="Expert 14 L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer0_exp15 [label="Expert 15 L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu3_layer0 [label="Expert Agg L0\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu3_layer1 [label="Attention L1\nGPU 3\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu3_layer1 [label="MoE Router L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu3_layer1_exp12 [label="Expert 12 L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer1_exp13 [label="Expert 13 L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer1_exp14 [label="Expert 14 L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer1_exp15 [label="Expert 15 L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu3_layer1 [label="Expert Agg L1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu3_layer2 [label="Attention L2\nGPU 3\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu3_layer2 [label="MoE Router L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu3_layer2_exp12 [label="Expert 12 L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer2_exp13 [label="Expert 13 L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer2_exp14 [label="Expert 14 L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer2_exp15 [label="Expert 15 L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu3_layer2 [label="Expert Agg L2\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp0_gpu3_layer3 [label="Attention L3\nGPU 3\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp0_gpu3_layer3 [label="MoE Router L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp0_gpu3_layer3_exp12 [label="Expert 12 L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer3_exp13 [label="Expert 13 L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer3_exp14 [label="Expert 14 L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp0_gpu3_layer3_exp15 [label="Expert 15 L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp0_gpu3_layer3 [label="Expert Agg L3\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_0_1 {
			bgcolor=white label="DP Group 1" style=dashed
			attn_pp0_dp1_gpu0_layer0 [label="Attention L0\nGPU 4\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu0_layer0 [label="MoE Router L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu0_layer0_exp0 [label="Expert 0 L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer0_exp1 [label="Expert 1 L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer0_exp2 [label="Expert 2 L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer0_exp3 [label="Expert 3 L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu0_layer0 [label="Expert Agg L0\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu0_layer1 [label="Attention L1\nGPU 4\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu0_layer1 [label="MoE Router L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu0_layer1_exp0 [label="Expert 0 L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer1_exp1 [label="Expert 1 L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer1_exp2 [label="Expert 2 L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer1_exp3 [label="Expert 3 L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu0_layer1 [label="Expert Agg L1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu0_layer2 [label="Attention L2\nGPU 4\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu0_layer2 [label="MoE Router L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu0_layer2_exp0 [label="Expert 0 L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer2_exp1 [label="Expert 1 L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer2_exp2 [label="Expert 2 L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer2_exp3 [label="Expert 3 L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu0_layer2 [label="Expert Agg L2\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu0_layer3 [label="Attention L3\nGPU 4\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu0_layer3 [label="MoE Router L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu0_layer3_exp0 [label="Expert 0 L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer3_exp1 [label="Expert 1 L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer3_exp2 [label="Expert 2 L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu0_layer3_exp3 [label="Expert 3 L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu0_layer3 [label="Expert Agg L3\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu1_layer0 [label="Attention L0\nGPU 5\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu1_layer0 [label="MoE Router L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu1_layer0_exp4 [label="Expert 4 L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer0_exp5 [label="Expert 5 L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer0_exp6 [label="Expert 6 L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer0_exp7 [label="Expert 7 L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu1_layer0 [label="Expert Agg L0\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu1_layer1 [label="Attention L1\nGPU 5\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu1_layer1 [label="MoE Router L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu1_layer1_exp4 [label="Expert 4 L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer1_exp5 [label="Expert 5 L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer1_exp6 [label="Expert 6 L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer1_exp7 [label="Expert 7 L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu1_layer1 [label="Expert Agg L1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu1_layer2 [label="Attention L2\nGPU 5\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu1_layer2 [label="MoE Router L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu1_layer2_exp4 [label="Expert 4 L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer2_exp5 [label="Expert 5 L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer2_exp6 [label="Expert 6 L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer2_exp7 [label="Expert 7 L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu1_layer2 [label="Expert Agg L2\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu1_layer3 [label="Attention L3\nGPU 5\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu1_layer3 [label="MoE Router L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu1_layer3_exp4 [label="Expert 4 L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer3_exp5 [label="Expert 5 L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer3_exp6 [label="Expert 6 L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu1_layer3_exp7 [label="Expert 7 L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu1_layer3 [label="Expert Agg L3\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu2_layer0 [label="Attention L0\nGPU 6\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu2_layer0 [label="MoE Router L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu2_layer0_exp8 [label="Expert 8 L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer0_exp9 [label="Expert 9 L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer0_exp10 [label="Expert 10 L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer0_exp11 [label="Expert 11 L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu2_layer0 [label="Expert Agg L0\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu2_layer1 [label="Attention L1\nGPU 6\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu2_layer1 [label="MoE Router L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu2_layer1_exp8 [label="Expert 8 L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer1_exp9 [label="Expert 9 L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer1_exp10 [label="Expert 10 L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer1_exp11 [label="Expert 11 L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu2_layer1 [label="Expert Agg L1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu2_layer2 [label="Attention L2\nGPU 6\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu2_layer2 [label="MoE Router L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu2_layer2_exp8 [label="Expert 8 L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer2_exp9 [label="Expert 9 L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer2_exp10 [label="Expert 10 L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer2_exp11 [label="Expert 11 L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu2_layer2 [label="Expert Agg L2\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu2_layer3 [label="Attention L3\nGPU 6\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu2_layer3 [label="MoE Router L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu2_layer3_exp8 [label="Expert 8 L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer3_exp9 [label="Expert 9 L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer3_exp10 [label="Expert 10 L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu2_layer3_exp11 [label="Expert 11 L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu2_layer3 [label="Expert Agg L3\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu3_layer0 [label="Attention L0\nGPU 7\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu3_layer0 [label="MoE Router L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu3_layer0_exp12 [label="Expert 12 L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer0_exp13 [label="Expert 13 L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer0_exp14 [label="Expert 14 L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer0_exp15 [label="Expert 15 L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu3_layer0 [label="Expert Agg L0\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu3_layer1 [label="Attention L1\nGPU 7\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu3_layer1 [label="MoE Router L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu3_layer1_exp12 [label="Expert 12 L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer1_exp13 [label="Expert 13 L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer1_exp14 [label="Expert 14 L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer1_exp15 [label="Expert 15 L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu3_layer1 [label="Expert Agg L1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu3_layer2 [label="Attention L2\nGPU 7\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu3_layer2 [label="MoE Router L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu3_layer2_exp12 [label="Expert 12 L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer2_exp13 [label="Expert 13 L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer2_exp14 [label="Expert 14 L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer2_exp15 [label="Expert 15 L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu3_layer2 [label="Expert Agg L2\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp1_gpu3_layer3 [label="Attention L3\nGPU 7\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp1_gpu3_layer3 [label="MoE Router L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp1_gpu3_layer3_exp12 [label="Expert 12 L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer3_exp13 [label="Expert 13 L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer3_exp14 [label="Expert 14 L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp1_gpu3_layer3_exp15 [label="Expert 15 L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp1_gpu3_layer3 [label="Expert Agg L3\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_0_2 {
			bgcolor=white label="DP Group 2" style=dashed
			attn_pp0_dp2_gpu0_layer0 [label="Attention L0\nGPU 8\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu0_layer0 [label="MoE Router L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu0_layer0_exp0 [label="Expert 0 L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer0_exp1 [label="Expert 1 L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer0_exp2 [label="Expert 2 L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer0_exp3 [label="Expert 3 L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu0_layer0 [label="Expert Agg L0\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu0_layer1 [label="Attention L1\nGPU 8\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu0_layer1 [label="MoE Router L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu0_layer1_exp0 [label="Expert 0 L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer1_exp1 [label="Expert 1 L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer1_exp2 [label="Expert 2 L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer1_exp3 [label="Expert 3 L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu0_layer1 [label="Expert Agg L1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu0_layer2 [label="Attention L2\nGPU 8\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu0_layer2 [label="MoE Router L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu0_layer2_exp0 [label="Expert 0 L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer2_exp1 [label="Expert 1 L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer2_exp2 [label="Expert 2 L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer2_exp3 [label="Expert 3 L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu0_layer2 [label="Expert Agg L2\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu0_layer3 [label="Attention L3\nGPU 8\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu0_layer3 [label="MoE Router L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu0_layer3_exp0 [label="Expert 0 L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer3_exp1 [label="Expert 1 L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer3_exp2 [label="Expert 2 L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu0_layer3_exp3 [label="Expert 3 L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu0_layer3 [label="Expert Agg L3\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu1_layer0 [label="Attention L0\nGPU 9\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu1_layer0 [label="MoE Router L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu1_layer0_exp4 [label="Expert 4 L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer0_exp5 [label="Expert 5 L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer0_exp6 [label="Expert 6 L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer0_exp7 [label="Expert 7 L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu1_layer0 [label="Expert Agg L0\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu1_layer1 [label="Attention L1\nGPU 9\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu1_layer1 [label="MoE Router L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu1_layer1_exp4 [label="Expert 4 L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer1_exp5 [label="Expert 5 L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer1_exp6 [label="Expert 6 L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer1_exp7 [label="Expert 7 L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu1_layer1 [label="Expert Agg L1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu1_layer2 [label="Attention L2\nGPU 9\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu1_layer2 [label="MoE Router L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu1_layer2_exp4 [label="Expert 4 L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer2_exp5 [label="Expert 5 L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer2_exp6 [label="Expert 6 L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer2_exp7 [label="Expert 7 L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu1_layer2 [label="Expert Agg L2\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu1_layer3 [label="Attention L3\nGPU 9\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu1_layer3 [label="MoE Router L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu1_layer3_exp4 [label="Expert 4 L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer3_exp5 [label="Expert 5 L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer3_exp6 [label="Expert 6 L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu1_layer3_exp7 [label="Expert 7 L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu1_layer3 [label="Expert Agg L3\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu2_layer0 [label="Attention L0\nGPU 10\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu2_layer0 [label="MoE Router L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu2_layer0_exp8 [label="Expert 8 L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer0_exp9 [label="Expert 9 L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer0_exp10 [label="Expert 10 L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer0_exp11 [label="Expert 11 L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu2_layer0 [label="Expert Agg L0\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu2_layer1 [label="Attention L1\nGPU 10\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu2_layer1 [label="MoE Router L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu2_layer1_exp8 [label="Expert 8 L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer1_exp9 [label="Expert 9 L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer1_exp10 [label="Expert 10 L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer1_exp11 [label="Expert 11 L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu2_layer1 [label="Expert Agg L1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu2_layer2 [label="Attention L2\nGPU 10\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu2_layer2 [label="MoE Router L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu2_layer2_exp8 [label="Expert 8 L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer2_exp9 [label="Expert 9 L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer2_exp10 [label="Expert 10 L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer2_exp11 [label="Expert 11 L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu2_layer2 [label="Expert Agg L2\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu2_layer3 [label="Attention L3\nGPU 10\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu2_layer3 [label="MoE Router L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu2_layer3_exp8 [label="Expert 8 L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer3_exp9 [label="Expert 9 L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer3_exp10 [label="Expert 10 L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu2_layer3_exp11 [label="Expert 11 L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu2_layer3 [label="Expert Agg L3\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu3_layer0 [label="Attention L0\nGPU 11\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu3_layer0 [label="MoE Router L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu3_layer0_exp12 [label="Expert 12 L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer0_exp13 [label="Expert 13 L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer0_exp14 [label="Expert 14 L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer0_exp15 [label="Expert 15 L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu3_layer0 [label="Expert Agg L0\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu3_layer1 [label="Attention L1\nGPU 11\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu3_layer1 [label="MoE Router L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu3_layer1_exp12 [label="Expert 12 L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer1_exp13 [label="Expert 13 L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer1_exp14 [label="Expert 14 L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer1_exp15 [label="Expert 15 L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu3_layer1 [label="Expert Agg L1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu3_layer2 [label="Attention L2\nGPU 11\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu3_layer2 [label="MoE Router L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu3_layer2_exp12 [label="Expert 12 L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer2_exp13 [label="Expert 13 L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer2_exp14 [label="Expert 14 L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer2_exp15 [label="Expert 15 L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu3_layer2 [label="Expert Agg L2\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp2_gpu3_layer3 [label="Attention L3\nGPU 11\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp2_gpu3_layer3 [label="MoE Router L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp2_gpu3_layer3_exp12 [label="Expert 12 L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer3_exp13 [label="Expert 13 L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer3_exp14 [label="Expert 14 L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp2_gpu3_layer3_exp15 [label="Expert 15 L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp2_gpu3_layer3 [label="Expert Agg L3\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_0_3 {
			bgcolor=white label="DP Group 3" style=dashed
			attn_pp0_dp3_gpu0_layer0 [label="Attention L0\nGPU 12\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu0_layer0 [label="MoE Router L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu0_layer0_exp0 [label="Expert 0 L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer0_exp1 [label="Expert 1 L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer0_exp2 [label="Expert 2 L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer0_exp3 [label="Expert 3 L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu0_layer0 [label="Expert Agg L0\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu0_layer1 [label="Attention L1\nGPU 12\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu0_layer1 [label="MoE Router L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu0_layer1_exp0 [label="Expert 0 L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer1_exp1 [label="Expert 1 L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer1_exp2 [label="Expert 2 L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer1_exp3 [label="Expert 3 L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu0_layer1 [label="Expert Agg L1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu0_layer2 [label="Attention L2\nGPU 12\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu0_layer2 [label="MoE Router L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu0_layer2_exp0 [label="Expert 0 L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer2_exp1 [label="Expert 1 L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer2_exp2 [label="Expert 2 L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer2_exp3 [label="Expert 3 L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu0_layer2 [label="Expert Agg L2\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu0_layer3 [label="Attention L3\nGPU 12\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu0_layer3 [label="MoE Router L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu0_layer3_exp0 [label="Expert 0 L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer3_exp1 [label="Expert 1 L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer3_exp2 [label="Expert 2 L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu0_layer3_exp3 [label="Expert 3 L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu0_layer3 [label="Expert Agg L3\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu1_layer0 [label="Attention L0\nGPU 13\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu1_layer0 [label="MoE Router L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu1_layer0_exp4 [label="Expert 4 L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer0_exp5 [label="Expert 5 L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer0_exp6 [label="Expert 6 L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer0_exp7 [label="Expert 7 L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu1_layer0 [label="Expert Agg L0\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu1_layer1 [label="Attention L1\nGPU 13\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu1_layer1 [label="MoE Router L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu1_layer1_exp4 [label="Expert 4 L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer1_exp5 [label="Expert 5 L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer1_exp6 [label="Expert 6 L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer1_exp7 [label="Expert 7 L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu1_layer1 [label="Expert Agg L1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu1_layer2 [label="Attention L2\nGPU 13\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu1_layer2 [label="MoE Router L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu1_layer2_exp4 [label="Expert 4 L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer2_exp5 [label="Expert 5 L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer2_exp6 [label="Expert 6 L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer2_exp7 [label="Expert 7 L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu1_layer2 [label="Expert Agg L2\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu1_layer3 [label="Attention L3\nGPU 13\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu1_layer3 [label="MoE Router L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu1_layer3_exp4 [label="Expert 4 L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer3_exp5 [label="Expert 5 L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer3_exp6 [label="Expert 6 L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu1_layer3_exp7 [label="Expert 7 L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu1_layer3 [label="Expert Agg L3\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu2_layer0 [label="Attention L0\nGPU 14\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu2_layer0 [label="MoE Router L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu2_layer0_exp8 [label="Expert 8 L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer0_exp9 [label="Expert 9 L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer0_exp10 [label="Expert 10 L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer0_exp11 [label="Expert 11 L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu2_layer0 [label="Expert Agg L0\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu2_layer1 [label="Attention L1\nGPU 14\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu2_layer1 [label="MoE Router L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu2_layer1_exp8 [label="Expert 8 L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer1_exp9 [label="Expert 9 L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer1_exp10 [label="Expert 10 L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer1_exp11 [label="Expert 11 L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu2_layer1 [label="Expert Agg L1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu2_layer2 [label="Attention L2\nGPU 14\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu2_layer2 [label="MoE Router L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu2_layer2_exp8 [label="Expert 8 L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer2_exp9 [label="Expert 9 L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer2_exp10 [label="Expert 10 L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer2_exp11 [label="Expert 11 L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu2_layer2 [label="Expert Agg L2\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu2_layer3 [label="Attention L3\nGPU 14\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu2_layer3 [label="MoE Router L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu2_layer3_exp8 [label="Expert 8 L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer3_exp9 [label="Expert 9 L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer3_exp10 [label="Expert 10 L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu2_layer3_exp11 [label="Expert 11 L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu2_layer3 [label="Expert Agg L3\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu3_layer0 [label="Attention L0\nGPU 15\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu3_layer0 [label="MoE Router L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu3_layer0_exp12 [label="Expert 12 L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer0_exp13 [label="Expert 13 L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer0_exp14 [label="Expert 14 L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer0_exp15 [label="Expert 15 L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu3_layer0 [label="Expert Agg L0\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu3_layer1 [label="Attention L1\nGPU 15\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu3_layer1 [label="MoE Router L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu3_layer1_exp12 [label="Expert 12 L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer1_exp13 [label="Expert 13 L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer1_exp14 [label="Expert 14 L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer1_exp15 [label="Expert 15 L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu3_layer1 [label="Expert Agg L1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu3_layer2 [label="Attention L2\nGPU 15\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu3_layer2 [label="MoE Router L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu3_layer2_exp12 [label="Expert 12 L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer2_exp13 [label="Expert 13 L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer2_exp14 [label="Expert 14 L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer2_exp15 [label="Expert 15 L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu3_layer2 [label="Expert Agg L2\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp0_dp3_gpu3_layer3 [label="Attention L3\nGPU 15\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp0_dp3_gpu3_layer3 [label="MoE Router L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp0_dp3_gpu3_layer3_exp12 [label="Expert 12 L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer3_exp13 [label="Expert 13 L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer3_exp14 [label="Expert 14 L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp0_dp3_gpu3_layer3_exp15 [label="Expert 15 L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp0_dp3_gpu3_layer3 [label="Expert Agg L3\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	subgraph cluster_pp_stage_1 {
		bgcolor=lightgray label="Pipeline Stage 1 (Layers 4-7)" style=rounded
		subgraph cluster_dp_1_0 {
			bgcolor=white label="DP Group 0" style=dashed
			attn_pp1_dp0_gpu0_layer4 [label="Attention L4\nGPU 16\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu0_layer4 [label="MoE Router L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu0_layer4_exp0 [label="Expert 0 L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer4_exp1 [label="Expert 1 L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer4_exp2 [label="Expert 2 L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer4_exp3 [label="Expert 3 L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu0_layer4 [label="Expert Agg L4\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu0_layer5 [label="Attention L5\nGPU 16\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu0_layer5 [label="MoE Router L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu0_layer5_exp0 [label="Expert 0 L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer5_exp1 [label="Expert 1 L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer5_exp2 [label="Expert 2 L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer5_exp3 [label="Expert 3 L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu0_layer5 [label="Expert Agg L5\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu0_layer6 [label="Attention L6\nGPU 16\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu0_layer6 [label="MoE Router L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu0_layer6_exp0 [label="Expert 0 L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer6_exp1 [label="Expert 1 L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer6_exp2 [label="Expert 2 L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer6_exp3 [label="Expert 3 L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu0_layer6 [label="Expert Agg L6\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu0_layer7 [label="Attention L7\nGPU 16\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu0_layer7 [label="MoE Router L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu0_layer7_exp0 [label="Expert 0 L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer7_exp1 [label="Expert 1 L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer7_exp2 [label="Expert 2 L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu0_layer7_exp3 [label="Expert 3 L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu0_layer7 [label="Expert Agg L7\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu1_layer4 [label="Attention L4\nGPU 17\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu1_layer4 [label="MoE Router L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu1_layer4_exp4 [label="Expert 4 L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer4_exp5 [label="Expert 5 L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer4_exp6 [label="Expert 6 L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer4_exp7 [label="Expert 7 L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu1_layer4 [label="Expert Agg L4\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu1_layer5 [label="Attention L5\nGPU 17\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu1_layer5 [label="MoE Router L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu1_layer5_exp4 [label="Expert 4 L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer5_exp5 [label="Expert 5 L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer5_exp6 [label="Expert 6 L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer5_exp7 [label="Expert 7 L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu1_layer5 [label="Expert Agg L5\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu1_layer6 [label="Attention L6\nGPU 17\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu1_layer6 [label="MoE Router L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu1_layer6_exp4 [label="Expert 4 L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer6_exp5 [label="Expert 5 L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer6_exp6 [label="Expert 6 L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer6_exp7 [label="Expert 7 L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu1_layer6 [label="Expert Agg L6\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu1_layer7 [label="Attention L7\nGPU 17\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu1_layer7 [label="MoE Router L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu1_layer7_exp4 [label="Expert 4 L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer7_exp5 [label="Expert 5 L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer7_exp6 [label="Expert 6 L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu1_layer7_exp7 [label="Expert 7 L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu1_layer7 [label="Expert Agg L7\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu2_layer4 [label="Attention L4\nGPU 18\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu2_layer4 [label="MoE Router L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu2_layer4_exp8 [label="Expert 8 L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer4_exp9 [label="Expert 9 L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer4_exp10 [label="Expert 10 L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer4_exp11 [label="Expert 11 L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu2_layer4 [label="Expert Agg L4\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu2_layer5 [label="Attention L5\nGPU 18\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu2_layer5 [label="MoE Router L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu2_layer5_exp8 [label="Expert 8 L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer5_exp9 [label="Expert 9 L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer5_exp10 [label="Expert 10 L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer5_exp11 [label="Expert 11 L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu2_layer5 [label="Expert Agg L5\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu2_layer6 [label="Attention L6\nGPU 18\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu2_layer6 [label="MoE Router L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu2_layer6_exp8 [label="Expert 8 L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer6_exp9 [label="Expert 9 L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer6_exp10 [label="Expert 10 L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer6_exp11 [label="Expert 11 L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu2_layer6 [label="Expert Agg L6\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu2_layer7 [label="Attention L7\nGPU 18\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu2_layer7 [label="MoE Router L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu2_layer7_exp8 [label="Expert 8 L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer7_exp9 [label="Expert 9 L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer7_exp10 [label="Expert 10 L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu2_layer7_exp11 [label="Expert 11 L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu2_layer7 [label="Expert Agg L7\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu3_layer4 [label="Attention L4\nGPU 19\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu3_layer4 [label="MoE Router L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu3_layer4_exp12 [label="Expert 12 L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer4_exp13 [label="Expert 13 L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer4_exp14 [label="Expert 14 L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer4_exp15 [label="Expert 15 L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu3_layer4 [label="Expert Agg L4\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu3_layer5 [label="Attention L5\nGPU 19\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu3_layer5 [label="MoE Router L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu3_layer5_exp12 [label="Expert 12 L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer5_exp13 [label="Expert 13 L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer5_exp14 [label="Expert 14 L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer5_exp15 [label="Expert 15 L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu3_layer5 [label="Expert Agg L5\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu3_layer6 [label="Attention L6\nGPU 19\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu3_layer6 [label="MoE Router L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu3_layer6_exp12 [label="Expert 12 L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer6_exp13 [label="Expert 13 L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer6_exp14 [label="Expert 14 L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer6_exp15 [label="Expert 15 L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu3_layer6 [label="Expert Agg L6\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp0_gpu3_layer7 [label="Attention L7\nGPU 19\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp0_gpu3_layer7 [label="MoE Router L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp0_gpu3_layer7_exp12 [label="Expert 12 L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer7_exp13 [label="Expert 13 L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer7_exp14 [label="Expert 14 L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp0_gpu3_layer7_exp15 [label="Expert 15 L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp0_gpu3_layer7 [label="Expert Agg L7\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_1_1 {
			bgcolor=white label="DP Group 1" style=dashed
			attn_pp1_dp1_gpu0_layer4 [label="Attention L4\nGPU 20\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu0_layer4 [label="MoE Router L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu0_layer4_exp0 [label="Expert 0 L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer4_exp1 [label="Expert 1 L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer4_exp2 [label="Expert 2 L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer4_exp3 [label="Expert 3 L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu0_layer4 [label="Expert Agg L4\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu0_layer5 [label="Attention L5\nGPU 20\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu0_layer5 [label="MoE Router L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu0_layer5_exp0 [label="Expert 0 L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer5_exp1 [label="Expert 1 L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer5_exp2 [label="Expert 2 L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer5_exp3 [label="Expert 3 L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu0_layer5 [label="Expert Agg L5\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu0_layer6 [label="Attention L6\nGPU 20\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu0_layer6 [label="MoE Router L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu0_layer6_exp0 [label="Expert 0 L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer6_exp1 [label="Expert 1 L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer6_exp2 [label="Expert 2 L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer6_exp3 [label="Expert 3 L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu0_layer6 [label="Expert Agg L6\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu0_layer7 [label="Attention L7\nGPU 20\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu0_layer7 [label="MoE Router L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu0_layer7_exp0 [label="Expert 0 L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer7_exp1 [label="Expert 1 L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer7_exp2 [label="Expert 2 L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu0_layer7_exp3 [label="Expert 3 L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu0_layer7 [label="Expert Agg L7\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu1_layer4 [label="Attention L4\nGPU 21\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu1_layer4 [label="MoE Router L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu1_layer4_exp4 [label="Expert 4 L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer4_exp5 [label="Expert 5 L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer4_exp6 [label="Expert 6 L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer4_exp7 [label="Expert 7 L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu1_layer4 [label="Expert Agg L4\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu1_layer5 [label="Attention L5\nGPU 21\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu1_layer5 [label="MoE Router L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu1_layer5_exp4 [label="Expert 4 L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer5_exp5 [label="Expert 5 L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer5_exp6 [label="Expert 6 L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer5_exp7 [label="Expert 7 L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu1_layer5 [label="Expert Agg L5\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu1_layer6 [label="Attention L6\nGPU 21\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu1_layer6 [label="MoE Router L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu1_layer6_exp4 [label="Expert 4 L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer6_exp5 [label="Expert 5 L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer6_exp6 [label="Expert 6 L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer6_exp7 [label="Expert 7 L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu1_layer6 [label="Expert Agg L6\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu1_layer7 [label="Attention L7\nGPU 21\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu1_layer7 [label="MoE Router L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu1_layer7_exp4 [label="Expert 4 L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer7_exp5 [label="Expert 5 L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer7_exp6 [label="Expert 6 L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu1_layer7_exp7 [label="Expert 7 L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu1_layer7 [label="Expert Agg L7\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu2_layer4 [label="Attention L4\nGPU 22\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu2_layer4 [label="MoE Router L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu2_layer4_exp8 [label="Expert 8 L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer4_exp9 [label="Expert 9 L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer4_exp10 [label="Expert 10 L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer4_exp11 [label="Expert 11 L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu2_layer4 [label="Expert Agg L4\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu2_layer5 [label="Attention L5\nGPU 22\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu2_layer5 [label="MoE Router L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu2_layer5_exp8 [label="Expert 8 L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer5_exp9 [label="Expert 9 L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer5_exp10 [label="Expert 10 L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer5_exp11 [label="Expert 11 L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu2_layer5 [label="Expert Agg L5\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu2_layer6 [label="Attention L6\nGPU 22\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu2_layer6 [label="MoE Router L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu2_layer6_exp8 [label="Expert 8 L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer6_exp9 [label="Expert 9 L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer6_exp10 [label="Expert 10 L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer6_exp11 [label="Expert 11 L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu2_layer6 [label="Expert Agg L6\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu2_layer7 [label="Attention L7\nGPU 22\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu2_layer7 [label="MoE Router L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu2_layer7_exp8 [label="Expert 8 L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer7_exp9 [label="Expert 9 L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer7_exp10 [label="Expert 10 L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu2_layer7_exp11 [label="Expert 11 L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu2_layer7 [label="Expert Agg L7\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu3_layer4 [label="Attention L4\nGPU 23\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu3_layer4 [label="MoE Router L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu3_layer4_exp12 [label="Expert 12 L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer4_exp13 [label="Expert 13 L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer4_exp14 [label="Expert 14 L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer4_exp15 [label="Expert 15 L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu3_layer4 [label="Expert Agg L4\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu3_layer5 [label="Attention L5\nGPU 23\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu3_layer5 [label="MoE Router L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu3_layer5_exp12 [label="Expert 12 L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer5_exp13 [label="Expert 13 L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer5_exp14 [label="Expert 14 L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer5_exp15 [label="Expert 15 L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu3_layer5 [label="Expert Agg L5\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu3_layer6 [label="Attention L6\nGPU 23\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu3_layer6 [label="MoE Router L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu3_layer6_exp12 [label="Expert 12 L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer6_exp13 [label="Expert 13 L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer6_exp14 [label="Expert 14 L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer6_exp15 [label="Expert 15 L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu3_layer6 [label="Expert Agg L6\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp1_gpu3_layer7 [label="Attention L7\nGPU 23\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp1_gpu3_layer7 [label="MoE Router L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp1_gpu3_layer7_exp12 [label="Expert 12 L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer7_exp13 [label="Expert 13 L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer7_exp14 [label="Expert 14 L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp1_gpu3_layer7_exp15 [label="Expert 15 L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp1_gpu3_layer7 [label="Expert Agg L7\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_1_2 {
			bgcolor=white label="DP Group 2" style=dashed
			attn_pp1_dp2_gpu0_layer4 [label="Attention L4\nGPU 24\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu0_layer4 [label="MoE Router L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu0_layer4_exp0 [label="Expert 0 L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer4_exp1 [label="Expert 1 L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer4_exp2 [label="Expert 2 L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer4_exp3 [label="Expert 3 L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu0_layer4 [label="Expert Agg L4\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu0_layer5 [label="Attention L5\nGPU 24\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu0_layer5 [label="MoE Router L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu0_layer5_exp0 [label="Expert 0 L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer5_exp1 [label="Expert 1 L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer5_exp2 [label="Expert 2 L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer5_exp3 [label="Expert 3 L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu0_layer5 [label="Expert Agg L5\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu0_layer6 [label="Attention L6\nGPU 24\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu0_layer6 [label="MoE Router L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu0_layer6_exp0 [label="Expert 0 L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer6_exp1 [label="Expert 1 L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer6_exp2 [label="Expert 2 L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer6_exp3 [label="Expert 3 L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu0_layer6 [label="Expert Agg L6\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu0_layer7 [label="Attention L7\nGPU 24\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu0_layer7 [label="MoE Router L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu0_layer7_exp0 [label="Expert 0 L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer7_exp1 [label="Expert 1 L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer7_exp2 [label="Expert 2 L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu0_layer7_exp3 [label="Expert 3 L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu0_layer7 [label="Expert Agg L7\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu1_layer4 [label="Attention L4\nGPU 25\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu1_layer4 [label="MoE Router L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu1_layer4_exp4 [label="Expert 4 L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer4_exp5 [label="Expert 5 L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer4_exp6 [label="Expert 6 L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer4_exp7 [label="Expert 7 L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu1_layer4 [label="Expert Agg L4\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu1_layer5 [label="Attention L5\nGPU 25\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu1_layer5 [label="MoE Router L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu1_layer5_exp4 [label="Expert 4 L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer5_exp5 [label="Expert 5 L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer5_exp6 [label="Expert 6 L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer5_exp7 [label="Expert 7 L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu1_layer5 [label="Expert Agg L5\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu1_layer6 [label="Attention L6\nGPU 25\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu1_layer6 [label="MoE Router L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu1_layer6_exp4 [label="Expert 4 L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer6_exp5 [label="Expert 5 L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer6_exp6 [label="Expert 6 L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer6_exp7 [label="Expert 7 L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu1_layer6 [label="Expert Agg L6\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu1_layer7 [label="Attention L7\nGPU 25\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu1_layer7 [label="MoE Router L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu1_layer7_exp4 [label="Expert 4 L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer7_exp5 [label="Expert 5 L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer7_exp6 [label="Expert 6 L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu1_layer7_exp7 [label="Expert 7 L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu1_layer7 [label="Expert Agg L7\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu2_layer4 [label="Attention L4\nGPU 26\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu2_layer4 [label="MoE Router L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu2_layer4_exp8 [label="Expert 8 L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer4_exp9 [label="Expert 9 L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer4_exp10 [label="Expert 10 L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer4_exp11 [label="Expert 11 L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu2_layer4 [label="Expert Agg L4\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu2_layer5 [label="Attention L5\nGPU 26\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu2_layer5 [label="MoE Router L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu2_layer5_exp8 [label="Expert 8 L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer5_exp9 [label="Expert 9 L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer5_exp10 [label="Expert 10 L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer5_exp11 [label="Expert 11 L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu2_layer5 [label="Expert Agg L5\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu2_layer6 [label="Attention L6\nGPU 26\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu2_layer6 [label="MoE Router L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu2_layer6_exp8 [label="Expert 8 L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer6_exp9 [label="Expert 9 L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer6_exp10 [label="Expert 10 L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer6_exp11 [label="Expert 11 L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu2_layer6 [label="Expert Agg L6\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu2_layer7 [label="Attention L7\nGPU 26\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu2_layer7 [label="MoE Router L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu2_layer7_exp8 [label="Expert 8 L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer7_exp9 [label="Expert 9 L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer7_exp10 [label="Expert 10 L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu2_layer7_exp11 [label="Expert 11 L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu2_layer7 [label="Expert Agg L7\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu3_layer4 [label="Attention L4\nGPU 27\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu3_layer4 [label="MoE Router L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu3_layer4_exp12 [label="Expert 12 L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer4_exp13 [label="Expert 13 L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer4_exp14 [label="Expert 14 L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer4_exp15 [label="Expert 15 L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu3_layer4 [label="Expert Agg L4\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu3_layer5 [label="Attention L5\nGPU 27\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu3_layer5 [label="MoE Router L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu3_layer5_exp12 [label="Expert 12 L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer5_exp13 [label="Expert 13 L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer5_exp14 [label="Expert 14 L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer5_exp15 [label="Expert 15 L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu3_layer5 [label="Expert Agg L5\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu3_layer6 [label="Attention L6\nGPU 27\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu3_layer6 [label="MoE Router L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu3_layer6_exp12 [label="Expert 12 L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer6_exp13 [label="Expert 13 L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer6_exp14 [label="Expert 14 L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer6_exp15 [label="Expert 15 L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu3_layer6 [label="Expert Agg L6\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp2_gpu3_layer7 [label="Attention L7\nGPU 27\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp2_gpu3_layer7 [label="MoE Router L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp2_gpu3_layer7_exp12 [label="Expert 12 L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer7_exp13 [label="Expert 13 L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer7_exp14 [label="Expert 14 L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp2_gpu3_layer7_exp15 [label="Expert 15 L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp2_gpu3_layer7 [label="Expert Agg L7\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_1_3 {
			bgcolor=white label="DP Group 3" style=dashed
			attn_pp1_dp3_gpu0_layer4 [label="Attention L4\nGPU 28\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu0_layer4 [label="MoE Router L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu0_layer4_exp0 [label="Expert 0 L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer4_exp1 [label="Expert 1 L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer4_exp2 [label="Expert 2 L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer4_exp3 [label="Expert 3 L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu0_layer4 [label="Expert Agg L4\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu0_layer5 [label="Attention L5\nGPU 28\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu0_layer5 [label="MoE Router L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu0_layer5_exp0 [label="Expert 0 L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer5_exp1 [label="Expert 1 L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer5_exp2 [label="Expert 2 L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer5_exp3 [label="Expert 3 L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu0_layer5 [label="Expert Agg L5\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu0_layer6 [label="Attention L6\nGPU 28\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu0_layer6 [label="MoE Router L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu0_layer6_exp0 [label="Expert 0 L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer6_exp1 [label="Expert 1 L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer6_exp2 [label="Expert 2 L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer6_exp3 [label="Expert 3 L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu0_layer6 [label="Expert Agg L6\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu0_layer7 [label="Attention L7\nGPU 28\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu0_layer7 [label="MoE Router L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu0_layer7_exp0 [label="Expert 0 L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer7_exp1 [label="Expert 1 L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer7_exp2 [label="Expert 2 L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu0_layer7_exp3 [label="Expert 3 L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu0_layer7 [label="Expert Agg L7\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu1_layer4 [label="Attention L4\nGPU 29\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu1_layer4 [label="MoE Router L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu1_layer4_exp4 [label="Expert 4 L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer4_exp5 [label="Expert 5 L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer4_exp6 [label="Expert 6 L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer4_exp7 [label="Expert 7 L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu1_layer4 [label="Expert Agg L4\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu1_layer5 [label="Attention L5\nGPU 29\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu1_layer5 [label="MoE Router L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu1_layer5_exp4 [label="Expert 4 L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer5_exp5 [label="Expert 5 L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer5_exp6 [label="Expert 6 L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer5_exp7 [label="Expert 7 L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu1_layer5 [label="Expert Agg L5\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu1_layer6 [label="Attention L6\nGPU 29\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu1_layer6 [label="MoE Router L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu1_layer6_exp4 [label="Expert 4 L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer6_exp5 [label="Expert 5 L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer6_exp6 [label="Expert 6 L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer6_exp7 [label="Expert 7 L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu1_layer6 [label="Expert Agg L6\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu1_layer7 [label="Attention L7\nGPU 29\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu1_layer7 [label="MoE Router L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu1_layer7_exp4 [label="Expert 4 L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer7_exp5 [label="Expert 5 L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer7_exp6 [label="Expert 6 L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu1_layer7_exp7 [label="Expert 7 L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu1_layer7 [label="Expert Agg L7\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu2_layer4 [label="Attention L4\nGPU 30\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu2_layer4 [label="MoE Router L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu2_layer4_exp8 [label="Expert 8 L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer4_exp9 [label="Expert 9 L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer4_exp10 [label="Expert 10 L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer4_exp11 [label="Expert 11 L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu2_layer4 [label="Expert Agg L4\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu2_layer5 [label="Attention L5\nGPU 30\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu2_layer5 [label="MoE Router L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu2_layer5_exp8 [label="Expert 8 L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer5_exp9 [label="Expert 9 L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer5_exp10 [label="Expert 10 L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer5_exp11 [label="Expert 11 L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu2_layer5 [label="Expert Agg L5\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu2_layer6 [label="Attention L6\nGPU 30\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu2_layer6 [label="MoE Router L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu2_layer6_exp8 [label="Expert 8 L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer6_exp9 [label="Expert 9 L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer6_exp10 [label="Expert 10 L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer6_exp11 [label="Expert 11 L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu2_layer6 [label="Expert Agg L6\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu2_layer7 [label="Attention L7\nGPU 30\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu2_layer7 [label="MoE Router L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu2_layer7_exp8 [label="Expert 8 L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer7_exp9 [label="Expert 9 L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer7_exp10 [label="Expert 10 L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu2_layer7_exp11 [label="Expert 11 L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu2_layer7 [label="Expert Agg L7\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu3_layer4 [label="Attention L4\nGPU 31\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu3_layer4 [label="MoE Router L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu3_layer4_exp12 [label="Expert 12 L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer4_exp13 [label="Expert 13 L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer4_exp14 [label="Expert 14 L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer4_exp15 [label="Expert 15 L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu3_layer4 [label="Expert Agg L4\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu3_layer5 [label="Attention L5\nGPU 31\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu3_layer5 [label="MoE Router L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu3_layer5_exp12 [label="Expert 12 L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer5_exp13 [label="Expert 13 L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer5_exp14 [label="Expert 14 L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer5_exp15 [label="Expert 15 L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu3_layer5 [label="Expert Agg L5\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu3_layer6 [label="Attention L6\nGPU 31\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu3_layer6 [label="MoE Router L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu3_layer6_exp12 [label="Expert 12 L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer6_exp13 [label="Expert 13 L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer6_exp14 [label="Expert 14 L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer6_exp15 [label="Expert 15 L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu3_layer6 [label="Expert Agg L6\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp1_dp3_gpu3_layer7 [label="Attention L7\nGPU 31\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp1_dp3_gpu3_layer7 [label="MoE Router L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp1_dp3_gpu3_layer7_exp12 [label="Expert 12 L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer7_exp13 [label="Expert 13 L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer7_exp14 [label="Expert 14 L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp1_dp3_gpu3_layer7_exp15 [label="Expert 15 L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp1_dp3_gpu3_layer7 [label="Expert Agg L7\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	subgraph cluster_pp_stage_2 {
		bgcolor=lightgray label="Pipeline Stage 2 (Layers 8-11)" style=rounded
		subgraph cluster_dp_2_0 {
			bgcolor=white label="DP Group 0" style=dashed
			attn_pp2_dp0_gpu0_layer8 [label="Attention L8\nGPU 32\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu0_layer8 [label="MoE Router L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu0_layer8_exp0 [label="Expert 0 L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer8_exp1 [label="Expert 1 L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer8_exp2 [label="Expert 2 L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer8_exp3 [label="Expert 3 L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu0_layer8 [label="Expert Agg L8\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu0_layer9 [label="Attention L9\nGPU 32\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu0_layer9 [label="MoE Router L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu0_layer9_exp0 [label="Expert 0 L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer9_exp1 [label="Expert 1 L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer9_exp2 [label="Expert 2 L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer9_exp3 [label="Expert 3 L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu0_layer9 [label="Expert Agg L9\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu0_layer10 [label="Attention L10\nGPU 32\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu0_layer10 [label="MoE Router L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu0_layer10_exp0 [label="Expert 0 L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer10_exp1 [label="Expert 1 L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer10_exp2 [label="Expert 2 L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer10_exp3 [label="Expert 3 L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu0_layer10 [label="Expert Agg L10\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu0_layer11 [label="Attention L11\nGPU 32\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu0_layer11 [label="MoE Router L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu0_layer11_exp0 [label="Expert 0 L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer11_exp1 [label="Expert 1 L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer11_exp2 [label="Expert 2 L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu0_layer11_exp3 [label="Expert 3 L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu0_layer11 [label="Expert Agg L11\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu1_layer8 [label="Attention L8\nGPU 33\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu1_layer8 [label="MoE Router L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu1_layer8_exp4 [label="Expert 4 L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer8_exp5 [label="Expert 5 L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer8_exp6 [label="Expert 6 L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer8_exp7 [label="Expert 7 L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu1_layer8 [label="Expert Agg L8\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu1_layer9 [label="Attention L9\nGPU 33\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu1_layer9 [label="MoE Router L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu1_layer9_exp4 [label="Expert 4 L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer9_exp5 [label="Expert 5 L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer9_exp6 [label="Expert 6 L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer9_exp7 [label="Expert 7 L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu1_layer9 [label="Expert Agg L9\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu1_layer10 [label="Attention L10\nGPU 33\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu1_layer10 [label="MoE Router L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu1_layer10_exp4 [label="Expert 4 L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer10_exp5 [label="Expert 5 L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer10_exp6 [label="Expert 6 L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer10_exp7 [label="Expert 7 L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu1_layer10 [label="Expert Agg L10\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu1_layer11 [label="Attention L11\nGPU 33\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu1_layer11 [label="MoE Router L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu1_layer11_exp4 [label="Expert 4 L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer11_exp5 [label="Expert 5 L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer11_exp6 [label="Expert 6 L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu1_layer11_exp7 [label="Expert 7 L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu1_layer11 [label="Expert Agg L11\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu2_layer8 [label="Attention L8\nGPU 34\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu2_layer8 [label="MoE Router L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu2_layer8_exp8 [label="Expert 8 L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer8_exp9 [label="Expert 9 L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer8_exp10 [label="Expert 10 L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer8_exp11 [label="Expert 11 L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu2_layer8 [label="Expert Agg L8\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu2_layer9 [label="Attention L9\nGPU 34\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu2_layer9 [label="MoE Router L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu2_layer9_exp8 [label="Expert 8 L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer9_exp9 [label="Expert 9 L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer9_exp10 [label="Expert 10 L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer9_exp11 [label="Expert 11 L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu2_layer9 [label="Expert Agg L9\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu2_layer10 [label="Attention L10\nGPU 34\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu2_layer10 [label="MoE Router L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu2_layer10_exp8 [label="Expert 8 L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer10_exp9 [label="Expert 9 L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer10_exp10 [label="Expert 10 L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer10_exp11 [label="Expert 11 L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu2_layer10 [label="Expert Agg L10\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu2_layer11 [label="Attention L11\nGPU 34\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu2_layer11 [label="MoE Router L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu2_layer11_exp8 [label="Expert 8 L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer11_exp9 [label="Expert 9 L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer11_exp10 [label="Expert 10 L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu2_layer11_exp11 [label="Expert 11 L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu2_layer11 [label="Expert Agg L11\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu3_layer8 [label="Attention L8\nGPU 35\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu3_layer8 [label="MoE Router L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu3_layer8_exp12 [label="Expert 12 L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer8_exp13 [label="Expert 13 L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer8_exp14 [label="Expert 14 L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer8_exp15 [label="Expert 15 L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu3_layer8 [label="Expert Agg L8\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu3_layer9 [label="Attention L9\nGPU 35\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu3_layer9 [label="MoE Router L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu3_layer9_exp12 [label="Expert 12 L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer9_exp13 [label="Expert 13 L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer9_exp14 [label="Expert 14 L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer9_exp15 [label="Expert 15 L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu3_layer9 [label="Expert Agg L9\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu3_layer10 [label="Attention L10\nGPU 35\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu3_layer10 [label="MoE Router L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu3_layer10_exp12 [label="Expert 12 L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer10_exp13 [label="Expert 13 L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer10_exp14 [label="Expert 14 L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer10_exp15 [label="Expert 15 L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu3_layer10 [label="Expert Agg L10\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp0_gpu3_layer11 [label="Attention L11\nGPU 35\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp0_gpu3_layer11 [label="MoE Router L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp0_gpu3_layer11_exp12 [label="Expert 12 L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer11_exp13 [label="Expert 13 L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer11_exp14 [label="Expert 14 L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp0_gpu3_layer11_exp15 [label="Expert 15 L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp0_gpu3_layer11 [label="Expert Agg L11\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_2_1 {
			bgcolor=white label="DP Group 1" style=dashed
			attn_pp2_dp1_gpu0_layer8 [label="Attention L8\nGPU 36\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu0_layer8 [label="MoE Router L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu0_layer8_exp0 [label="Expert 0 L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer8_exp1 [label="Expert 1 L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer8_exp2 [label="Expert 2 L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer8_exp3 [label="Expert 3 L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu0_layer8 [label="Expert Agg L8\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu0_layer9 [label="Attention L9\nGPU 36\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu0_layer9 [label="MoE Router L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu0_layer9_exp0 [label="Expert 0 L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer9_exp1 [label="Expert 1 L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer9_exp2 [label="Expert 2 L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer9_exp3 [label="Expert 3 L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu0_layer9 [label="Expert Agg L9\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu0_layer10 [label="Attention L10\nGPU 36\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu0_layer10 [label="MoE Router L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu0_layer10_exp0 [label="Expert 0 L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer10_exp1 [label="Expert 1 L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer10_exp2 [label="Expert 2 L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer10_exp3 [label="Expert 3 L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu0_layer10 [label="Expert Agg L10\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu0_layer11 [label="Attention L11\nGPU 36\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu0_layer11 [label="MoE Router L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu0_layer11_exp0 [label="Expert 0 L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer11_exp1 [label="Expert 1 L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer11_exp2 [label="Expert 2 L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu0_layer11_exp3 [label="Expert 3 L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu0_layer11 [label="Expert Agg L11\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu1_layer8 [label="Attention L8\nGPU 37\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu1_layer8 [label="MoE Router L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu1_layer8_exp4 [label="Expert 4 L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer8_exp5 [label="Expert 5 L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer8_exp6 [label="Expert 6 L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer8_exp7 [label="Expert 7 L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu1_layer8 [label="Expert Agg L8\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu1_layer9 [label="Attention L9\nGPU 37\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu1_layer9 [label="MoE Router L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu1_layer9_exp4 [label="Expert 4 L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer9_exp5 [label="Expert 5 L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer9_exp6 [label="Expert 6 L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer9_exp7 [label="Expert 7 L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu1_layer9 [label="Expert Agg L9\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu1_layer10 [label="Attention L10\nGPU 37\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu1_layer10 [label="MoE Router L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu1_layer10_exp4 [label="Expert 4 L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer10_exp5 [label="Expert 5 L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer10_exp6 [label="Expert 6 L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer10_exp7 [label="Expert 7 L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu1_layer10 [label="Expert Agg L10\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu1_layer11 [label="Attention L11\nGPU 37\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu1_layer11 [label="MoE Router L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu1_layer11_exp4 [label="Expert 4 L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer11_exp5 [label="Expert 5 L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer11_exp6 [label="Expert 6 L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu1_layer11_exp7 [label="Expert 7 L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu1_layer11 [label="Expert Agg L11\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu2_layer8 [label="Attention L8\nGPU 38\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu2_layer8 [label="MoE Router L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu2_layer8_exp8 [label="Expert 8 L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer8_exp9 [label="Expert 9 L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer8_exp10 [label="Expert 10 L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer8_exp11 [label="Expert 11 L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu2_layer8 [label="Expert Agg L8\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu2_layer9 [label="Attention L9\nGPU 38\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu2_layer9 [label="MoE Router L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu2_layer9_exp8 [label="Expert 8 L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer9_exp9 [label="Expert 9 L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer9_exp10 [label="Expert 10 L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer9_exp11 [label="Expert 11 L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu2_layer9 [label="Expert Agg L9\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu2_layer10 [label="Attention L10\nGPU 38\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu2_layer10 [label="MoE Router L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu2_layer10_exp8 [label="Expert 8 L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer10_exp9 [label="Expert 9 L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer10_exp10 [label="Expert 10 L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer10_exp11 [label="Expert 11 L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu2_layer10 [label="Expert Agg L10\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu2_layer11 [label="Attention L11\nGPU 38\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu2_layer11 [label="MoE Router L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu2_layer11_exp8 [label="Expert 8 L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer11_exp9 [label="Expert 9 L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer11_exp10 [label="Expert 10 L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu2_layer11_exp11 [label="Expert 11 L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu2_layer11 [label="Expert Agg L11\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu3_layer8 [label="Attention L8\nGPU 39\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu3_layer8 [label="MoE Router L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu3_layer8_exp12 [label="Expert 12 L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer8_exp13 [label="Expert 13 L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer8_exp14 [label="Expert 14 L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer8_exp15 [label="Expert 15 L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu3_layer8 [label="Expert Agg L8\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu3_layer9 [label="Attention L9\nGPU 39\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu3_layer9 [label="MoE Router L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu3_layer9_exp12 [label="Expert 12 L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer9_exp13 [label="Expert 13 L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer9_exp14 [label="Expert 14 L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer9_exp15 [label="Expert 15 L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu3_layer9 [label="Expert Agg L9\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu3_layer10 [label="Attention L10\nGPU 39\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu3_layer10 [label="MoE Router L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu3_layer10_exp12 [label="Expert 12 L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer10_exp13 [label="Expert 13 L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer10_exp14 [label="Expert 14 L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer10_exp15 [label="Expert 15 L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu3_layer10 [label="Expert Agg L10\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp1_gpu3_layer11 [label="Attention L11\nGPU 39\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp1_gpu3_layer11 [label="MoE Router L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp1_gpu3_layer11_exp12 [label="Expert 12 L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer11_exp13 [label="Expert 13 L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer11_exp14 [label="Expert 14 L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp1_gpu3_layer11_exp15 [label="Expert 15 L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp1_gpu3_layer11 [label="Expert Agg L11\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_2_2 {
			bgcolor=white label="DP Group 2" style=dashed
			attn_pp2_dp2_gpu0_layer8 [label="Attention L8\nGPU 40\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu0_layer8 [label="MoE Router L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu0_layer8_exp0 [label="Expert 0 L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer8_exp1 [label="Expert 1 L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer8_exp2 [label="Expert 2 L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer8_exp3 [label="Expert 3 L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu0_layer8 [label="Expert Agg L8\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu0_layer9 [label="Attention L9\nGPU 40\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu0_layer9 [label="MoE Router L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu0_layer9_exp0 [label="Expert 0 L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer9_exp1 [label="Expert 1 L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer9_exp2 [label="Expert 2 L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer9_exp3 [label="Expert 3 L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu0_layer9 [label="Expert Agg L9\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu0_layer10 [label="Attention L10\nGPU 40\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu0_layer10 [label="MoE Router L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu0_layer10_exp0 [label="Expert 0 L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer10_exp1 [label="Expert 1 L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer10_exp2 [label="Expert 2 L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer10_exp3 [label="Expert 3 L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu0_layer10 [label="Expert Agg L10\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu0_layer11 [label="Attention L11\nGPU 40\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu0_layer11 [label="MoE Router L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu0_layer11_exp0 [label="Expert 0 L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer11_exp1 [label="Expert 1 L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer11_exp2 [label="Expert 2 L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu0_layer11_exp3 [label="Expert 3 L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu0_layer11 [label="Expert Agg L11\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu1_layer8 [label="Attention L8\nGPU 41\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu1_layer8 [label="MoE Router L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu1_layer8_exp4 [label="Expert 4 L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer8_exp5 [label="Expert 5 L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer8_exp6 [label="Expert 6 L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer8_exp7 [label="Expert 7 L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu1_layer8 [label="Expert Agg L8\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu1_layer9 [label="Attention L9\nGPU 41\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu1_layer9 [label="MoE Router L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu1_layer9_exp4 [label="Expert 4 L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer9_exp5 [label="Expert 5 L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer9_exp6 [label="Expert 6 L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer9_exp7 [label="Expert 7 L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu1_layer9 [label="Expert Agg L9\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu1_layer10 [label="Attention L10\nGPU 41\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu1_layer10 [label="MoE Router L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu1_layer10_exp4 [label="Expert 4 L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer10_exp5 [label="Expert 5 L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer10_exp6 [label="Expert 6 L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer10_exp7 [label="Expert 7 L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu1_layer10 [label="Expert Agg L10\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu1_layer11 [label="Attention L11\nGPU 41\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu1_layer11 [label="MoE Router L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu1_layer11_exp4 [label="Expert 4 L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer11_exp5 [label="Expert 5 L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer11_exp6 [label="Expert 6 L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu1_layer11_exp7 [label="Expert 7 L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu1_layer11 [label="Expert Agg L11\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu2_layer8 [label="Attention L8\nGPU 42\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu2_layer8 [label="MoE Router L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu2_layer8_exp8 [label="Expert 8 L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer8_exp9 [label="Expert 9 L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer8_exp10 [label="Expert 10 L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer8_exp11 [label="Expert 11 L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu2_layer8 [label="Expert Agg L8\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu2_layer9 [label="Attention L9\nGPU 42\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu2_layer9 [label="MoE Router L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu2_layer9_exp8 [label="Expert 8 L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer9_exp9 [label="Expert 9 L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer9_exp10 [label="Expert 10 L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer9_exp11 [label="Expert 11 L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu2_layer9 [label="Expert Agg L9\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu2_layer10 [label="Attention L10\nGPU 42\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu2_layer10 [label="MoE Router L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu2_layer10_exp8 [label="Expert 8 L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer10_exp9 [label="Expert 9 L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer10_exp10 [label="Expert 10 L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer10_exp11 [label="Expert 11 L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu2_layer10 [label="Expert Agg L10\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu2_layer11 [label="Attention L11\nGPU 42\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu2_layer11 [label="MoE Router L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu2_layer11_exp8 [label="Expert 8 L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer11_exp9 [label="Expert 9 L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer11_exp10 [label="Expert 10 L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu2_layer11_exp11 [label="Expert 11 L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu2_layer11 [label="Expert Agg L11\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu3_layer8 [label="Attention L8\nGPU 43\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu3_layer8 [label="MoE Router L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu3_layer8_exp12 [label="Expert 12 L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer8_exp13 [label="Expert 13 L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer8_exp14 [label="Expert 14 L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer8_exp15 [label="Expert 15 L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu3_layer8 [label="Expert Agg L8\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu3_layer9 [label="Attention L9\nGPU 43\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu3_layer9 [label="MoE Router L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu3_layer9_exp12 [label="Expert 12 L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer9_exp13 [label="Expert 13 L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer9_exp14 [label="Expert 14 L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer9_exp15 [label="Expert 15 L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu3_layer9 [label="Expert Agg L9\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu3_layer10 [label="Attention L10\nGPU 43\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu3_layer10 [label="MoE Router L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu3_layer10_exp12 [label="Expert 12 L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer10_exp13 [label="Expert 13 L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer10_exp14 [label="Expert 14 L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer10_exp15 [label="Expert 15 L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu3_layer10 [label="Expert Agg L10\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp2_gpu3_layer11 [label="Attention L11\nGPU 43\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp2_gpu3_layer11 [label="MoE Router L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp2_gpu3_layer11_exp12 [label="Expert 12 L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer11_exp13 [label="Expert 13 L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer11_exp14 [label="Expert 14 L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp2_gpu3_layer11_exp15 [label="Expert 15 L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp2_gpu3_layer11 [label="Expert Agg L11\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_2_3 {
			bgcolor=white label="DP Group 3" style=dashed
			attn_pp2_dp3_gpu0_layer8 [label="Attention L8\nGPU 44\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu0_layer8 [label="MoE Router L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu0_layer8_exp0 [label="Expert 0 L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer8_exp1 [label="Expert 1 L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer8_exp2 [label="Expert 2 L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer8_exp3 [label="Expert 3 L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu0_layer8 [label="Expert Agg L8\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu0_layer9 [label="Attention L9\nGPU 44\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu0_layer9 [label="MoE Router L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu0_layer9_exp0 [label="Expert 0 L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer9_exp1 [label="Expert 1 L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer9_exp2 [label="Expert 2 L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer9_exp3 [label="Expert 3 L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu0_layer9 [label="Expert Agg L9\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu0_layer10 [label="Attention L10\nGPU 44\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu0_layer10 [label="MoE Router L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu0_layer10_exp0 [label="Expert 0 L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer10_exp1 [label="Expert 1 L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer10_exp2 [label="Expert 2 L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer10_exp3 [label="Expert 3 L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu0_layer10 [label="Expert Agg L10\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu0_layer11 [label="Attention L11\nGPU 44\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu0_layer11 [label="MoE Router L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu0_layer11_exp0 [label="Expert 0 L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer11_exp1 [label="Expert 1 L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer11_exp2 [label="Expert 2 L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu0_layer11_exp3 [label="Expert 3 L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu0_layer11 [label="Expert Agg L11\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu1_layer8 [label="Attention L8\nGPU 45\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu1_layer8 [label="MoE Router L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu1_layer8_exp4 [label="Expert 4 L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer8_exp5 [label="Expert 5 L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer8_exp6 [label="Expert 6 L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer8_exp7 [label="Expert 7 L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu1_layer8 [label="Expert Agg L8\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu1_layer9 [label="Attention L9\nGPU 45\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu1_layer9 [label="MoE Router L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu1_layer9_exp4 [label="Expert 4 L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer9_exp5 [label="Expert 5 L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer9_exp6 [label="Expert 6 L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer9_exp7 [label="Expert 7 L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu1_layer9 [label="Expert Agg L9\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu1_layer10 [label="Attention L10\nGPU 45\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu1_layer10 [label="MoE Router L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu1_layer10_exp4 [label="Expert 4 L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer10_exp5 [label="Expert 5 L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer10_exp6 [label="Expert 6 L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer10_exp7 [label="Expert 7 L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu1_layer10 [label="Expert Agg L10\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu1_layer11 [label="Attention L11\nGPU 45\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu1_layer11 [label="MoE Router L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu1_layer11_exp4 [label="Expert 4 L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer11_exp5 [label="Expert 5 L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer11_exp6 [label="Expert 6 L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu1_layer11_exp7 [label="Expert 7 L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu1_layer11 [label="Expert Agg L11\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu2_layer8 [label="Attention L8\nGPU 46\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu2_layer8 [label="MoE Router L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu2_layer8_exp8 [label="Expert 8 L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer8_exp9 [label="Expert 9 L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer8_exp10 [label="Expert 10 L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer8_exp11 [label="Expert 11 L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu2_layer8 [label="Expert Agg L8\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu2_layer9 [label="Attention L9\nGPU 46\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu2_layer9 [label="MoE Router L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu2_layer9_exp8 [label="Expert 8 L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer9_exp9 [label="Expert 9 L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer9_exp10 [label="Expert 10 L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer9_exp11 [label="Expert 11 L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu2_layer9 [label="Expert Agg L9\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu2_layer10 [label="Attention L10\nGPU 46\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu2_layer10 [label="MoE Router L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu2_layer10_exp8 [label="Expert 8 L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer10_exp9 [label="Expert 9 L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer10_exp10 [label="Expert 10 L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer10_exp11 [label="Expert 11 L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu2_layer10 [label="Expert Agg L10\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu2_layer11 [label="Attention L11\nGPU 46\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu2_layer11 [label="MoE Router L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu2_layer11_exp8 [label="Expert 8 L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer11_exp9 [label="Expert 9 L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer11_exp10 [label="Expert 10 L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu2_layer11_exp11 [label="Expert 11 L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu2_layer11 [label="Expert Agg L11\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu3_layer8 [label="Attention L8\nGPU 47\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu3_layer8 [label="MoE Router L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu3_layer8_exp12 [label="Expert 12 L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer8_exp13 [label="Expert 13 L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer8_exp14 [label="Expert 14 L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer8_exp15 [label="Expert 15 L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu3_layer8 [label="Expert Agg L8\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu3_layer9 [label="Attention L9\nGPU 47\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu3_layer9 [label="MoE Router L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu3_layer9_exp12 [label="Expert 12 L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer9_exp13 [label="Expert 13 L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer9_exp14 [label="Expert 14 L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer9_exp15 [label="Expert 15 L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu3_layer9 [label="Expert Agg L9\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu3_layer10 [label="Attention L10\nGPU 47\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu3_layer10 [label="MoE Router L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu3_layer10_exp12 [label="Expert 12 L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer10_exp13 [label="Expert 13 L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer10_exp14 [label="Expert 14 L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer10_exp15 [label="Expert 15 L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu3_layer10 [label="Expert Agg L10\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp2_dp3_gpu3_layer11 [label="Attention L11\nGPU 47\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp2_dp3_gpu3_layer11 [label="MoE Router L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp2_dp3_gpu3_layer11_exp12 [label="Expert 12 L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer11_exp13 [label="Expert 13 L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer11_exp14 [label="Expert 14 L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp2_dp3_gpu3_layer11_exp15 [label="Expert 15 L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp2_dp3_gpu3_layer11 [label="Expert Agg L11\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	subgraph cluster_pp_stage_3 {
		bgcolor=lightgray label="Pipeline Stage 3 (Layers 12-15)" style=rounded
		subgraph cluster_dp_3_0 {
			bgcolor=white label="DP Group 0" style=dashed
			attn_pp3_dp0_gpu0_layer12 [label="Attention L12\nGPU 48\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu0_layer12 [label="MoE Router L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu0_layer12_exp0 [label="Expert 0 L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer12_exp1 [label="Expert 1 L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer12_exp2 [label="Expert 2 L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer12_exp3 [label="Expert 3 L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu0_layer12 [label="Expert Agg L12\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu0_layer13 [label="Attention L13\nGPU 48\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu0_layer13 [label="MoE Router L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu0_layer13_exp0 [label="Expert 0 L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer13_exp1 [label="Expert 1 L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer13_exp2 [label="Expert 2 L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer13_exp3 [label="Expert 3 L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu0_layer13 [label="Expert Agg L13\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu0_layer14 [label="Attention L14\nGPU 48\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu0_layer14 [label="MoE Router L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu0_layer14_exp0 [label="Expert 0 L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer14_exp1 [label="Expert 1 L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer14_exp2 [label="Expert 2 L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer14_exp3 [label="Expert 3 L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu0_layer14 [label="Expert Agg L14\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu0_layer15 [label="Attention L15\nGPU 48\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu0_layer15 [label="MoE Router L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu0_layer15_exp0 [label="Expert 0 L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer15_exp1 [label="Expert 1 L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer15_exp2 [label="Expert 2 L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu0_layer15_exp3 [label="Expert 3 L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu0_layer15 [label="Expert Agg L15\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu1_layer12 [label="Attention L12\nGPU 49\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu1_layer12 [label="MoE Router L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu1_layer12_exp4 [label="Expert 4 L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer12_exp5 [label="Expert 5 L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer12_exp6 [label="Expert 6 L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer12_exp7 [label="Expert 7 L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu1_layer12 [label="Expert Agg L12\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu1_layer13 [label="Attention L13\nGPU 49\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu1_layer13 [label="MoE Router L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu1_layer13_exp4 [label="Expert 4 L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer13_exp5 [label="Expert 5 L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer13_exp6 [label="Expert 6 L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer13_exp7 [label="Expert 7 L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu1_layer13 [label="Expert Agg L13\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu1_layer14 [label="Attention L14\nGPU 49\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu1_layer14 [label="MoE Router L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu1_layer14_exp4 [label="Expert 4 L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer14_exp5 [label="Expert 5 L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer14_exp6 [label="Expert 6 L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer14_exp7 [label="Expert 7 L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu1_layer14 [label="Expert Agg L14\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu1_layer15 [label="Attention L15\nGPU 49\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu1_layer15 [label="MoE Router L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu1_layer15_exp4 [label="Expert 4 L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer15_exp5 [label="Expert 5 L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer15_exp6 [label="Expert 6 L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu1_layer15_exp7 [label="Expert 7 L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu1_layer15 [label="Expert Agg L15\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu2_layer12 [label="Attention L12\nGPU 50\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu2_layer12 [label="MoE Router L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu2_layer12_exp8 [label="Expert 8 L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer12_exp9 [label="Expert 9 L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer12_exp10 [label="Expert 10 L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer12_exp11 [label="Expert 11 L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu2_layer12 [label="Expert Agg L12\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu2_layer13 [label="Attention L13\nGPU 50\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu2_layer13 [label="MoE Router L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu2_layer13_exp8 [label="Expert 8 L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer13_exp9 [label="Expert 9 L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer13_exp10 [label="Expert 10 L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer13_exp11 [label="Expert 11 L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu2_layer13 [label="Expert Agg L13\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu2_layer14 [label="Attention L14\nGPU 50\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu2_layer14 [label="MoE Router L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu2_layer14_exp8 [label="Expert 8 L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer14_exp9 [label="Expert 9 L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer14_exp10 [label="Expert 10 L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer14_exp11 [label="Expert 11 L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu2_layer14 [label="Expert Agg L14\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu2_layer15 [label="Attention L15\nGPU 50\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu2_layer15 [label="MoE Router L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu2_layer15_exp8 [label="Expert 8 L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer15_exp9 [label="Expert 9 L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer15_exp10 [label="Expert 10 L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu2_layer15_exp11 [label="Expert 11 L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu2_layer15 [label="Expert Agg L15\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu3_layer12 [label="Attention L12\nGPU 51\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu3_layer12 [label="MoE Router L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu3_layer12_exp12 [label="Expert 12 L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer12_exp13 [label="Expert 13 L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer12_exp14 [label="Expert 14 L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer12_exp15 [label="Expert 15 L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu3_layer12 [label="Expert Agg L12\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu3_layer13 [label="Attention L13\nGPU 51\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu3_layer13 [label="MoE Router L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu3_layer13_exp12 [label="Expert 12 L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer13_exp13 [label="Expert 13 L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer13_exp14 [label="Expert 14 L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer13_exp15 [label="Expert 15 L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu3_layer13 [label="Expert Agg L13\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu3_layer14 [label="Attention L14\nGPU 51\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu3_layer14 [label="MoE Router L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu3_layer14_exp12 [label="Expert 12 L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer14_exp13 [label="Expert 13 L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer14_exp14 [label="Expert 14 L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer14_exp15 [label="Expert 15 L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu3_layer14 [label="Expert Agg L14\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp0_gpu3_layer15 [label="Attention L15\nGPU 51\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp0_gpu3_layer15 [label="MoE Router L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp0_gpu3_layer15_exp12 [label="Expert 12 L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer15_exp13 [label="Expert 13 L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer15_exp14 [label="Expert 14 L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp0_gpu3_layer15_exp15 [label="Expert 15 L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp0_gpu3_layer15 [label="Expert Agg L15\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_3_1 {
			bgcolor=white label="DP Group 1" style=dashed
			attn_pp3_dp1_gpu0_layer12 [label="Attention L12\nGPU 52\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu0_layer12 [label="MoE Router L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu0_layer12_exp0 [label="Expert 0 L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer12_exp1 [label="Expert 1 L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer12_exp2 [label="Expert 2 L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer12_exp3 [label="Expert 3 L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu0_layer12 [label="Expert Agg L12\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu0_layer13 [label="Attention L13\nGPU 52\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu0_layer13 [label="MoE Router L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu0_layer13_exp0 [label="Expert 0 L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer13_exp1 [label="Expert 1 L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer13_exp2 [label="Expert 2 L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer13_exp3 [label="Expert 3 L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu0_layer13 [label="Expert Agg L13\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu0_layer14 [label="Attention L14\nGPU 52\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu0_layer14 [label="MoE Router L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu0_layer14_exp0 [label="Expert 0 L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer14_exp1 [label="Expert 1 L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer14_exp2 [label="Expert 2 L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer14_exp3 [label="Expert 3 L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu0_layer14 [label="Expert Agg L14\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu0_layer15 [label="Attention L15\nGPU 52\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu0_layer15 [label="MoE Router L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu0_layer15_exp0 [label="Expert 0 L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer15_exp1 [label="Expert 1 L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer15_exp2 [label="Expert 2 L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu0_layer15_exp3 [label="Expert 3 L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu0_layer15 [label="Expert Agg L15\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu1_layer12 [label="Attention L12\nGPU 53\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu1_layer12 [label="MoE Router L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu1_layer12_exp4 [label="Expert 4 L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer12_exp5 [label="Expert 5 L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer12_exp6 [label="Expert 6 L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer12_exp7 [label="Expert 7 L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu1_layer12 [label="Expert Agg L12\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu1_layer13 [label="Attention L13\nGPU 53\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu1_layer13 [label="MoE Router L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu1_layer13_exp4 [label="Expert 4 L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer13_exp5 [label="Expert 5 L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer13_exp6 [label="Expert 6 L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer13_exp7 [label="Expert 7 L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu1_layer13 [label="Expert Agg L13\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu1_layer14 [label="Attention L14\nGPU 53\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu1_layer14 [label="MoE Router L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu1_layer14_exp4 [label="Expert 4 L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer14_exp5 [label="Expert 5 L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer14_exp6 [label="Expert 6 L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer14_exp7 [label="Expert 7 L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu1_layer14 [label="Expert Agg L14\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu1_layer15 [label="Attention L15\nGPU 53\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu1_layer15 [label="MoE Router L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu1_layer15_exp4 [label="Expert 4 L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer15_exp5 [label="Expert 5 L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer15_exp6 [label="Expert 6 L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu1_layer15_exp7 [label="Expert 7 L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu1_layer15 [label="Expert Agg L15\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu2_layer12 [label="Attention L12\nGPU 54\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu2_layer12 [label="MoE Router L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu2_layer12_exp8 [label="Expert 8 L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer12_exp9 [label="Expert 9 L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer12_exp10 [label="Expert 10 L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer12_exp11 [label="Expert 11 L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu2_layer12 [label="Expert Agg L12\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu2_layer13 [label="Attention L13\nGPU 54\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu2_layer13 [label="MoE Router L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu2_layer13_exp8 [label="Expert 8 L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer13_exp9 [label="Expert 9 L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer13_exp10 [label="Expert 10 L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer13_exp11 [label="Expert 11 L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu2_layer13 [label="Expert Agg L13\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu2_layer14 [label="Attention L14\nGPU 54\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu2_layer14 [label="MoE Router L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu2_layer14_exp8 [label="Expert 8 L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer14_exp9 [label="Expert 9 L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer14_exp10 [label="Expert 10 L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer14_exp11 [label="Expert 11 L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu2_layer14 [label="Expert Agg L14\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu2_layer15 [label="Attention L15\nGPU 54\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu2_layer15 [label="MoE Router L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu2_layer15_exp8 [label="Expert 8 L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer15_exp9 [label="Expert 9 L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer15_exp10 [label="Expert 10 L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu2_layer15_exp11 [label="Expert 11 L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu2_layer15 [label="Expert Agg L15\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu3_layer12 [label="Attention L12\nGPU 55\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu3_layer12 [label="MoE Router L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu3_layer12_exp12 [label="Expert 12 L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer12_exp13 [label="Expert 13 L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer12_exp14 [label="Expert 14 L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer12_exp15 [label="Expert 15 L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu3_layer12 [label="Expert Agg L12\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu3_layer13 [label="Attention L13\nGPU 55\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu3_layer13 [label="MoE Router L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu3_layer13_exp12 [label="Expert 12 L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer13_exp13 [label="Expert 13 L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer13_exp14 [label="Expert 14 L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer13_exp15 [label="Expert 15 L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu3_layer13 [label="Expert Agg L13\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu3_layer14 [label="Attention L14\nGPU 55\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu3_layer14 [label="MoE Router L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu3_layer14_exp12 [label="Expert 12 L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer14_exp13 [label="Expert 13 L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer14_exp14 [label="Expert 14 L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer14_exp15 [label="Expert 15 L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu3_layer14 [label="Expert Agg L14\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp1_gpu3_layer15 [label="Attention L15\nGPU 55\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp1_gpu3_layer15 [label="MoE Router L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp1_gpu3_layer15_exp12 [label="Expert 12 L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer15_exp13 [label="Expert 13 L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer15_exp14 [label="Expert 14 L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp1_gpu3_layer15_exp15 [label="Expert 15 L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp1_gpu3_layer15 [label="Expert Agg L15\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_3_2 {
			bgcolor=white label="DP Group 2" style=dashed
			attn_pp3_dp2_gpu0_layer12 [label="Attention L12\nGPU 56\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu0_layer12 [label="MoE Router L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu0_layer12_exp0 [label="Expert 0 L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer12_exp1 [label="Expert 1 L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer12_exp2 [label="Expert 2 L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer12_exp3 [label="Expert 3 L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu0_layer12 [label="Expert Agg L12\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu0_layer13 [label="Attention L13\nGPU 56\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu0_layer13 [label="MoE Router L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu0_layer13_exp0 [label="Expert 0 L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer13_exp1 [label="Expert 1 L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer13_exp2 [label="Expert 2 L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer13_exp3 [label="Expert 3 L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu0_layer13 [label="Expert Agg L13\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu0_layer14 [label="Attention L14\nGPU 56\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu0_layer14 [label="MoE Router L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu0_layer14_exp0 [label="Expert 0 L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer14_exp1 [label="Expert 1 L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer14_exp2 [label="Expert 2 L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer14_exp3 [label="Expert 3 L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu0_layer14 [label="Expert Agg L14\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu0_layer15 [label="Attention L15\nGPU 56\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu0_layer15 [label="MoE Router L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu0_layer15_exp0 [label="Expert 0 L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer15_exp1 [label="Expert 1 L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer15_exp2 [label="Expert 2 L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu0_layer15_exp3 [label="Expert 3 L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu0_layer15 [label="Expert Agg L15\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu1_layer12 [label="Attention L12\nGPU 57\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu1_layer12 [label="MoE Router L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu1_layer12_exp4 [label="Expert 4 L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer12_exp5 [label="Expert 5 L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer12_exp6 [label="Expert 6 L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer12_exp7 [label="Expert 7 L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu1_layer12 [label="Expert Agg L12\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu1_layer13 [label="Attention L13\nGPU 57\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu1_layer13 [label="MoE Router L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu1_layer13_exp4 [label="Expert 4 L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer13_exp5 [label="Expert 5 L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer13_exp6 [label="Expert 6 L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer13_exp7 [label="Expert 7 L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu1_layer13 [label="Expert Agg L13\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu1_layer14 [label="Attention L14\nGPU 57\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu1_layer14 [label="MoE Router L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu1_layer14_exp4 [label="Expert 4 L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer14_exp5 [label="Expert 5 L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer14_exp6 [label="Expert 6 L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer14_exp7 [label="Expert 7 L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu1_layer14 [label="Expert Agg L14\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu1_layer15 [label="Attention L15\nGPU 57\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu1_layer15 [label="MoE Router L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu1_layer15_exp4 [label="Expert 4 L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer15_exp5 [label="Expert 5 L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer15_exp6 [label="Expert 6 L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu1_layer15_exp7 [label="Expert 7 L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu1_layer15 [label="Expert Agg L15\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu2_layer12 [label="Attention L12\nGPU 58\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu2_layer12 [label="MoE Router L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu2_layer12_exp8 [label="Expert 8 L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer12_exp9 [label="Expert 9 L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer12_exp10 [label="Expert 10 L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer12_exp11 [label="Expert 11 L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu2_layer12 [label="Expert Agg L12\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu2_layer13 [label="Attention L13\nGPU 58\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu2_layer13 [label="MoE Router L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu2_layer13_exp8 [label="Expert 8 L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer13_exp9 [label="Expert 9 L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer13_exp10 [label="Expert 10 L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer13_exp11 [label="Expert 11 L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu2_layer13 [label="Expert Agg L13\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu2_layer14 [label="Attention L14\nGPU 58\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu2_layer14 [label="MoE Router L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu2_layer14_exp8 [label="Expert 8 L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer14_exp9 [label="Expert 9 L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer14_exp10 [label="Expert 10 L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer14_exp11 [label="Expert 11 L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu2_layer14 [label="Expert Agg L14\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu2_layer15 [label="Attention L15\nGPU 58\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu2_layer15 [label="MoE Router L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu2_layer15_exp8 [label="Expert 8 L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer15_exp9 [label="Expert 9 L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer15_exp10 [label="Expert 10 L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu2_layer15_exp11 [label="Expert 11 L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu2_layer15 [label="Expert Agg L15\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu3_layer12 [label="Attention L12\nGPU 59\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu3_layer12 [label="MoE Router L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu3_layer12_exp12 [label="Expert 12 L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer12_exp13 [label="Expert 13 L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer12_exp14 [label="Expert 14 L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer12_exp15 [label="Expert 15 L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu3_layer12 [label="Expert Agg L12\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu3_layer13 [label="Attention L13\nGPU 59\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu3_layer13 [label="MoE Router L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu3_layer13_exp12 [label="Expert 12 L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer13_exp13 [label="Expert 13 L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer13_exp14 [label="Expert 14 L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer13_exp15 [label="Expert 15 L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu3_layer13 [label="Expert Agg L13\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu3_layer14 [label="Attention L14\nGPU 59\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu3_layer14 [label="MoE Router L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu3_layer14_exp12 [label="Expert 12 L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer14_exp13 [label="Expert 13 L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer14_exp14 [label="Expert 14 L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer14_exp15 [label="Expert 15 L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu3_layer14 [label="Expert Agg L14\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp2_gpu3_layer15 [label="Attention L15\nGPU 59\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp2_gpu3_layer15 [label="MoE Router L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp2_gpu3_layer15_exp12 [label="Expert 12 L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer15_exp13 [label="Expert 13 L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer15_exp14 [label="Expert 14 L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp2_gpu3_layer15_exp15 [label="Expert 15 L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp2_gpu3_layer15 [label="Expert Agg L15\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
		subgraph cluster_dp_3_3 {
			bgcolor=white label="DP Group 3" style=dashed
			attn_pp3_dp3_gpu0_layer12 [label="Attention L12\nGPU 60\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu0_layer12 [label="MoE Router L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu0_layer12_exp0 [label="Expert 0 L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer12_exp1 [label="Expert 1 L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer12_exp2 [label="Expert 2 L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer12_exp3 [label="Expert 3 L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu0_layer12 [label="Expert Agg L12\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu0_layer13 [label="Attention L13\nGPU 60\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu0_layer13 [label="MoE Router L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu0_layer13_exp0 [label="Expert 0 L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer13_exp1 [label="Expert 1 L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer13_exp2 [label="Expert 2 L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer13_exp3 [label="Expert 3 L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu0_layer13 [label="Expert Agg L13\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu0_layer14 [label="Attention L14\nGPU 60\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu0_layer14 [label="MoE Router L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu0_layer14_exp0 [label="Expert 0 L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer14_exp1 [label="Expert 1 L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer14_exp2 [label="Expert 2 L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer14_exp3 [label="Expert 3 L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu0_layer14 [label="Expert Agg L14\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu0_layer15 [label="Attention L15\nGPU 60\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu0_layer15 [label="MoE Router L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu0_layer15_exp0 [label="Expert 0 L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer15_exp1 [label="Expert 1 L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer15_exp2 [label="Expert 2 L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu0_layer15_exp3 [label="Expert 3 L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu0_layer15 [label="Expert Agg L15\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu1_layer12 [label="Attention L12\nGPU 61\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu1_layer12 [label="MoE Router L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu1_layer12_exp4 [label="Expert 4 L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer12_exp5 [label="Expert 5 L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer12_exp6 [label="Expert 6 L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer12_exp7 [label="Expert 7 L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu1_layer12 [label="Expert Agg L12\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu1_layer13 [label="Attention L13\nGPU 61\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu1_layer13 [label="MoE Router L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu1_layer13_exp4 [label="Expert 4 L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer13_exp5 [label="Expert 5 L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer13_exp6 [label="Expert 6 L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer13_exp7 [label="Expert 7 L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu1_layer13 [label="Expert Agg L13\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu1_layer14 [label="Attention L14\nGPU 61\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu1_layer14 [label="MoE Router L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu1_layer14_exp4 [label="Expert 4 L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer14_exp5 [label="Expert 5 L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer14_exp6 [label="Expert 6 L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer14_exp7 [label="Expert 7 L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu1_layer14 [label="Expert Agg L14\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu1_layer15 [label="Attention L15\nGPU 61\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu1_layer15 [label="MoE Router L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu1_layer15_exp4 [label="Expert 4 L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer15_exp5 [label="Expert 5 L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer15_exp6 [label="Expert 6 L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu1_layer15_exp7 [label="Expert 7 L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu1_layer15 [label="Expert Agg L15\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu2_layer12 [label="Attention L12\nGPU 62\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu2_layer12 [label="MoE Router L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu2_layer12_exp8 [label="Expert 8 L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer12_exp9 [label="Expert 9 L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer12_exp10 [label="Expert 10 L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer12_exp11 [label="Expert 11 L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu2_layer12 [label="Expert Agg L12\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu2_layer13 [label="Attention L13\nGPU 62\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu2_layer13 [label="MoE Router L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu2_layer13_exp8 [label="Expert 8 L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer13_exp9 [label="Expert 9 L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer13_exp10 [label="Expert 10 L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer13_exp11 [label="Expert 11 L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu2_layer13 [label="Expert Agg L13\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu2_layer14 [label="Attention L14\nGPU 62\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu2_layer14 [label="MoE Router L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu2_layer14_exp8 [label="Expert 8 L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer14_exp9 [label="Expert 9 L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer14_exp10 [label="Expert 10 L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer14_exp11 [label="Expert 11 L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu2_layer14 [label="Expert Agg L14\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu2_layer15 [label="Attention L15\nGPU 62\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu2_layer15 [label="MoE Router L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu2_layer15_exp8 [label="Expert 8 L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer15_exp9 [label="Expert 9 L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer15_exp10 [label="Expert 10 L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu2_layer15_exp11 [label="Expert 11 L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu2_layer15 [label="Expert Agg L15\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu3_layer12 [label="Attention L12\nGPU 63\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu3_layer12 [label="MoE Router L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu3_layer12_exp12 [label="Expert 12 L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer12_exp13 [label="Expert 13 L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer12_exp14 [label="Expert 14 L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer12_exp15 [label="Expert 15 L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu3_layer12 [label="Expert Agg L12\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu3_layer13 [label="Attention L13\nGPU 63\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu3_layer13 [label="MoE Router L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu3_layer13_exp12 [label="Expert 12 L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer13_exp13 [label="Expert 13 L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer13_exp14 [label="Expert 14 L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer13_exp15 [label="Expert 15 L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu3_layer13 [label="Expert Agg L13\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu3_layer14 [label="Attention L14\nGPU 63\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu3_layer14 [label="MoE Router L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu3_layer14_exp12 [label="Expert 12 L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer14_exp13 [label="Expert 13 L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer14_exp14 [label="Expert 14 L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer14_exp15 [label="Expert 15 L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu3_layer14 [label="Expert Agg L14\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			attn_pp3_dp3_gpu3_layer15 [label="Attention L15\nGPU 63\nInput: [batch_size=?, seq_len=512, heads=16, d_k=32]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			route_pp3_dp3_gpu3_layer15 [label="MoE Router L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
			expert_pp3_dp3_gpu3_layer15_exp12 [label="Expert 12 L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer15_exp13 [label="Expert 13 L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer15_exp14 [label="Expert 14 L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			expert_pp3_dp3_gpu3_layer15_exp15 [label="Expert 15 L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightgreen shape=rectangle style=filled]
			agg_pp3_dp3_gpu3_layer15 [label="Expert Agg L15\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightyellow shape=parallelogram style=filled]
		}
	}
	input -> attn_pp0_dp0_gpu0_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp0_gpu1_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp0_gpu2_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp0_gpu3_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp1_gpu0_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp1_gpu1_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp1_gpu2_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp1_gpu3_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp2_gpu0_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp2_gpu1_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp2_gpu2_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp2_gpu3_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp3_gpu0_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp3_gpu1_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp3_gpu2_layer0 [label="Input Data" style=dashed]
	input -> attn_pp0_dp3_gpu3_layer0 [label="Input Data" style=dashed]
	attn_pp0_dp0_gpu0_layer0 -> route_pp0_dp0_gpu0_layer0
	route_pp0_dp0_gpu0_layer0 -> expert_pp0_dp0_gpu0_layer0_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp0_gpu0_layer0 -> expert_pp0_dp0_gpu0_layer0_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp0_gpu0_layer0 -> expert_pp0_dp0_gpu0_layer0_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp0_gpu0_layer0 -> expert_pp0_dp0_gpu0_layer0_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp0_gpu0_layer0_exp0 -> agg_pp0_dp0_gpu0_layer0
	expert_pp0_dp0_gpu0_layer0_exp1 -> agg_pp0_dp0_gpu0_layer0
	expert_pp0_dp0_gpu0_layer0_exp2 -> agg_pp0_dp0_gpu0_layer0
	expert_pp0_dp0_gpu0_layer0_exp3 -> agg_pp0_dp0_gpu0_layer0
	agg_pp0_dp0_gpu0_layer0 -> attn_pp0_dp0_gpu0_layer1
	attn_pp0_dp0_gpu0_layer1 -> route_pp0_dp0_gpu0_layer1
	route_pp0_dp0_gpu0_layer1 -> expert_pp0_dp0_gpu0_layer1_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp0_gpu0_layer1 -> expert_pp0_dp0_gpu0_layer1_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp0_gpu0_layer1 -> expert_pp0_dp0_gpu0_layer1_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp0_gpu0_layer1 -> expert_pp0_dp0_gpu0_layer1_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp0_gpu0_layer1_exp0 -> agg_pp0_dp0_gpu0_layer1
	expert_pp0_dp0_gpu0_layer1_exp1 -> agg_pp0_dp0_gpu0_layer1
	expert_pp0_dp0_gpu0_layer1_exp2 -> agg_pp0_dp0_gpu0_layer1
	expert_pp0_dp0_gpu0_layer1_exp3 -> agg_pp0_dp0_gpu0_layer1
	agg_pp0_dp0_gpu0_layer1 -> attn_pp0_dp0_gpu0_layer2
	attn_pp0_dp0_gpu0_layer2 -> route_pp0_dp0_gpu0_layer2
	route_pp0_dp0_gpu0_layer2 -> expert_pp0_dp0_gpu0_layer2_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp0_gpu0_layer2 -> expert_pp0_dp0_gpu0_layer2_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp0_gpu0_layer2 -> expert_pp0_dp0_gpu0_layer2_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp0_gpu0_layer2 -> expert_pp0_dp0_gpu0_layer2_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp0_gpu0_layer2_exp0 -> agg_pp0_dp0_gpu0_layer2
	expert_pp0_dp0_gpu0_layer2_exp1 -> agg_pp0_dp0_gpu0_layer2
	expert_pp0_dp0_gpu0_layer2_exp2 -> agg_pp0_dp0_gpu0_layer2
	expert_pp0_dp0_gpu0_layer2_exp3 -> agg_pp0_dp0_gpu0_layer2
	agg_pp0_dp0_gpu0_layer2 -> attn_pp0_dp0_gpu0_layer3
	attn_pp0_dp0_gpu0_layer3 -> route_pp0_dp0_gpu0_layer3
	route_pp0_dp0_gpu0_layer3 -> expert_pp0_dp0_gpu0_layer3_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp0_gpu0_layer3 -> expert_pp0_dp0_gpu0_layer3_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp0_gpu0_layer3 -> expert_pp0_dp0_gpu0_layer3_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp0_gpu0_layer3 -> expert_pp0_dp0_gpu0_layer3_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp0_gpu0_layer3_exp0 -> agg_pp0_dp0_gpu0_layer3
	expert_pp0_dp0_gpu0_layer3_exp1 -> agg_pp0_dp0_gpu0_layer3
	expert_pp0_dp0_gpu0_layer3_exp2 -> agg_pp0_dp0_gpu0_layer3
	expert_pp0_dp0_gpu0_layer3_exp3 -> agg_pp0_dp0_gpu0_layer3
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu0 [label="P2P Comm\nStage 0->1\nGPU 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu0_layer3 -> comm_pp0_to_pp1_dp0_gpu0
	comm_pp0_to_pp1_dp0_gpu0 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp0_gpu1_layer0 -> route_pp0_dp0_gpu1_layer0
	route_pp0_dp0_gpu1_layer0 -> expert_pp0_dp0_gpu1_layer0_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp0_gpu1_layer0 -> expert_pp0_dp0_gpu1_layer0_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp0_gpu1_layer0 -> expert_pp0_dp0_gpu1_layer0_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp0_gpu1_layer0 -> expert_pp0_dp0_gpu1_layer0_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp0_gpu1_layer0_exp4 -> agg_pp0_dp0_gpu1_layer0
	expert_pp0_dp0_gpu1_layer0_exp5 -> agg_pp0_dp0_gpu1_layer0
	expert_pp0_dp0_gpu1_layer0_exp6 -> agg_pp0_dp0_gpu1_layer0
	expert_pp0_dp0_gpu1_layer0_exp7 -> agg_pp0_dp0_gpu1_layer0
	agg_pp0_dp0_gpu1_layer0 -> attn_pp0_dp0_gpu1_layer1
	attn_pp0_dp0_gpu1_layer1 -> route_pp0_dp0_gpu1_layer1
	route_pp0_dp0_gpu1_layer1 -> expert_pp0_dp0_gpu1_layer1_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp0_gpu1_layer1 -> expert_pp0_dp0_gpu1_layer1_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp0_gpu1_layer1 -> expert_pp0_dp0_gpu1_layer1_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp0_gpu1_layer1 -> expert_pp0_dp0_gpu1_layer1_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp0_gpu1_layer1_exp4 -> agg_pp0_dp0_gpu1_layer1
	expert_pp0_dp0_gpu1_layer1_exp5 -> agg_pp0_dp0_gpu1_layer1
	expert_pp0_dp0_gpu1_layer1_exp6 -> agg_pp0_dp0_gpu1_layer1
	expert_pp0_dp0_gpu1_layer1_exp7 -> agg_pp0_dp0_gpu1_layer1
	agg_pp0_dp0_gpu1_layer1 -> attn_pp0_dp0_gpu1_layer2
	attn_pp0_dp0_gpu1_layer2 -> route_pp0_dp0_gpu1_layer2
	route_pp0_dp0_gpu1_layer2 -> expert_pp0_dp0_gpu1_layer2_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp0_gpu1_layer2 -> expert_pp0_dp0_gpu1_layer2_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp0_gpu1_layer2 -> expert_pp0_dp0_gpu1_layer2_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp0_gpu1_layer2 -> expert_pp0_dp0_gpu1_layer2_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp0_gpu1_layer2_exp4 -> agg_pp0_dp0_gpu1_layer2
	expert_pp0_dp0_gpu1_layer2_exp5 -> agg_pp0_dp0_gpu1_layer2
	expert_pp0_dp0_gpu1_layer2_exp6 -> agg_pp0_dp0_gpu1_layer2
	expert_pp0_dp0_gpu1_layer2_exp7 -> agg_pp0_dp0_gpu1_layer2
	agg_pp0_dp0_gpu1_layer2 -> attn_pp0_dp0_gpu1_layer3
	attn_pp0_dp0_gpu1_layer3 -> route_pp0_dp0_gpu1_layer3
	route_pp0_dp0_gpu1_layer3 -> expert_pp0_dp0_gpu1_layer3_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp0_gpu1_layer3 -> expert_pp0_dp0_gpu1_layer3_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp0_gpu1_layer3 -> expert_pp0_dp0_gpu1_layer3_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp0_gpu1_layer3 -> expert_pp0_dp0_gpu1_layer3_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp0_gpu1_layer3_exp4 -> agg_pp0_dp0_gpu1_layer3
	expert_pp0_dp0_gpu1_layer3_exp5 -> agg_pp0_dp0_gpu1_layer3
	expert_pp0_dp0_gpu1_layer3_exp6 -> agg_pp0_dp0_gpu1_layer3
	expert_pp0_dp0_gpu1_layer3_exp7 -> agg_pp0_dp0_gpu1_layer3
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu1 [label="P2P Comm\nStage 0->1\nGPU 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu1_layer3 -> comm_pp0_to_pp1_dp0_gpu1
	comm_pp0_to_pp1_dp0_gpu1 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp0_gpu2_layer0 -> route_pp0_dp0_gpu2_layer0
	route_pp0_dp0_gpu2_layer0 -> expert_pp0_dp0_gpu2_layer0_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp0_gpu2_layer0 -> expert_pp0_dp0_gpu2_layer0_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp0_gpu2_layer0 -> expert_pp0_dp0_gpu2_layer0_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp0_gpu2_layer0 -> expert_pp0_dp0_gpu2_layer0_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp0_gpu2_layer0_exp8 -> agg_pp0_dp0_gpu2_layer0
	expert_pp0_dp0_gpu2_layer0_exp9 -> agg_pp0_dp0_gpu2_layer0
	expert_pp0_dp0_gpu2_layer0_exp10 -> agg_pp0_dp0_gpu2_layer0
	expert_pp0_dp0_gpu2_layer0_exp11 -> agg_pp0_dp0_gpu2_layer0
	agg_pp0_dp0_gpu2_layer0 -> attn_pp0_dp0_gpu2_layer1
	attn_pp0_dp0_gpu2_layer1 -> route_pp0_dp0_gpu2_layer1
	route_pp0_dp0_gpu2_layer1 -> expert_pp0_dp0_gpu2_layer1_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp0_gpu2_layer1 -> expert_pp0_dp0_gpu2_layer1_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp0_gpu2_layer1 -> expert_pp0_dp0_gpu2_layer1_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp0_gpu2_layer1 -> expert_pp0_dp0_gpu2_layer1_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp0_gpu2_layer1_exp8 -> agg_pp0_dp0_gpu2_layer1
	expert_pp0_dp0_gpu2_layer1_exp9 -> agg_pp0_dp0_gpu2_layer1
	expert_pp0_dp0_gpu2_layer1_exp10 -> agg_pp0_dp0_gpu2_layer1
	expert_pp0_dp0_gpu2_layer1_exp11 -> agg_pp0_dp0_gpu2_layer1
	agg_pp0_dp0_gpu2_layer1 -> attn_pp0_dp0_gpu2_layer2
	attn_pp0_dp0_gpu2_layer2 -> route_pp0_dp0_gpu2_layer2
	route_pp0_dp0_gpu2_layer2 -> expert_pp0_dp0_gpu2_layer2_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp0_gpu2_layer2 -> expert_pp0_dp0_gpu2_layer2_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp0_gpu2_layer2 -> expert_pp0_dp0_gpu2_layer2_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp0_gpu2_layer2 -> expert_pp0_dp0_gpu2_layer2_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp0_gpu2_layer2_exp8 -> agg_pp0_dp0_gpu2_layer2
	expert_pp0_dp0_gpu2_layer2_exp9 -> agg_pp0_dp0_gpu2_layer2
	expert_pp0_dp0_gpu2_layer2_exp10 -> agg_pp0_dp0_gpu2_layer2
	expert_pp0_dp0_gpu2_layer2_exp11 -> agg_pp0_dp0_gpu2_layer2
	agg_pp0_dp0_gpu2_layer2 -> attn_pp0_dp0_gpu2_layer3
	attn_pp0_dp0_gpu2_layer3 -> route_pp0_dp0_gpu2_layer3
	route_pp0_dp0_gpu2_layer3 -> expert_pp0_dp0_gpu2_layer3_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp0_gpu2_layer3 -> expert_pp0_dp0_gpu2_layer3_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp0_gpu2_layer3 -> expert_pp0_dp0_gpu2_layer3_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp0_gpu2_layer3 -> expert_pp0_dp0_gpu2_layer3_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp0_gpu2_layer3_exp8 -> agg_pp0_dp0_gpu2_layer3
	expert_pp0_dp0_gpu2_layer3_exp9 -> agg_pp0_dp0_gpu2_layer3
	expert_pp0_dp0_gpu2_layer3_exp10 -> agg_pp0_dp0_gpu2_layer3
	expert_pp0_dp0_gpu2_layer3_exp11 -> agg_pp0_dp0_gpu2_layer3
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu2 [label="P2P Comm\nStage 0->1\nGPU 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu2_layer3 -> comm_pp0_to_pp1_dp0_gpu2
	comm_pp0_to_pp1_dp0_gpu2 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp0_gpu3_layer0 -> route_pp0_dp0_gpu3_layer0
	route_pp0_dp0_gpu3_layer0 -> expert_pp0_dp0_gpu3_layer0_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp0_gpu3_layer0 -> expert_pp0_dp0_gpu3_layer0_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp0_gpu3_layer0 -> expert_pp0_dp0_gpu3_layer0_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp0_gpu3_layer0 -> expert_pp0_dp0_gpu3_layer0_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp0_gpu3_layer0_exp12 -> agg_pp0_dp0_gpu3_layer0
	expert_pp0_dp0_gpu3_layer0_exp13 -> agg_pp0_dp0_gpu3_layer0
	expert_pp0_dp0_gpu3_layer0_exp14 -> agg_pp0_dp0_gpu3_layer0
	expert_pp0_dp0_gpu3_layer0_exp15 -> agg_pp0_dp0_gpu3_layer0
	agg_pp0_dp0_gpu3_layer0 -> attn_pp0_dp0_gpu3_layer1
	attn_pp0_dp0_gpu3_layer1 -> route_pp0_dp0_gpu3_layer1
	route_pp0_dp0_gpu3_layer1 -> expert_pp0_dp0_gpu3_layer1_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp0_gpu3_layer1 -> expert_pp0_dp0_gpu3_layer1_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp0_gpu3_layer1 -> expert_pp0_dp0_gpu3_layer1_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp0_gpu3_layer1 -> expert_pp0_dp0_gpu3_layer1_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp0_gpu3_layer1_exp12 -> agg_pp0_dp0_gpu3_layer1
	expert_pp0_dp0_gpu3_layer1_exp13 -> agg_pp0_dp0_gpu3_layer1
	expert_pp0_dp0_gpu3_layer1_exp14 -> agg_pp0_dp0_gpu3_layer1
	expert_pp0_dp0_gpu3_layer1_exp15 -> agg_pp0_dp0_gpu3_layer1
	agg_pp0_dp0_gpu3_layer1 -> attn_pp0_dp0_gpu3_layer2
	attn_pp0_dp0_gpu3_layer2 -> route_pp0_dp0_gpu3_layer2
	route_pp0_dp0_gpu3_layer2 -> expert_pp0_dp0_gpu3_layer2_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp0_gpu3_layer2 -> expert_pp0_dp0_gpu3_layer2_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp0_gpu3_layer2 -> expert_pp0_dp0_gpu3_layer2_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp0_gpu3_layer2 -> expert_pp0_dp0_gpu3_layer2_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp0_gpu3_layer2_exp12 -> agg_pp0_dp0_gpu3_layer2
	expert_pp0_dp0_gpu3_layer2_exp13 -> agg_pp0_dp0_gpu3_layer2
	expert_pp0_dp0_gpu3_layer2_exp14 -> agg_pp0_dp0_gpu3_layer2
	expert_pp0_dp0_gpu3_layer2_exp15 -> agg_pp0_dp0_gpu3_layer2
	agg_pp0_dp0_gpu3_layer2 -> attn_pp0_dp0_gpu3_layer3
	attn_pp0_dp0_gpu3_layer3 -> route_pp0_dp0_gpu3_layer3
	route_pp0_dp0_gpu3_layer3 -> expert_pp0_dp0_gpu3_layer3_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp0_gpu3_layer3 -> expert_pp0_dp0_gpu3_layer3_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp0_gpu3_layer3 -> expert_pp0_dp0_gpu3_layer3_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp0_gpu3_layer3 -> expert_pp0_dp0_gpu3_layer3_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp0_gpu3_layer3_exp12 -> agg_pp0_dp0_gpu3_layer3
	expert_pp0_dp0_gpu3_layer3_exp13 -> agg_pp0_dp0_gpu3_layer3
	expert_pp0_dp0_gpu3_layer3_exp14 -> agg_pp0_dp0_gpu3_layer3
	expert_pp0_dp0_gpu3_layer3_exp15 -> agg_pp0_dp0_gpu3_layer3
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp0_gpu3 [label="P2P Comm\nStage 0->1\nGPU 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp0_gpu3_layer3 -> comm_pp0_to_pp1_dp0_gpu3
	comm_pp0_to_pp1_dp0_gpu3 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp1_gpu0_layer0 -> route_pp0_dp1_gpu0_layer0
	route_pp0_dp1_gpu0_layer0 -> expert_pp0_dp1_gpu0_layer0_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp1_gpu0_layer0 -> expert_pp0_dp1_gpu0_layer0_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp1_gpu0_layer0 -> expert_pp0_dp1_gpu0_layer0_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp1_gpu0_layer0 -> expert_pp0_dp1_gpu0_layer0_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp1_gpu0_layer0_exp0 -> agg_pp0_dp1_gpu0_layer0
	expert_pp0_dp1_gpu0_layer0_exp1 -> agg_pp0_dp1_gpu0_layer0
	expert_pp0_dp1_gpu0_layer0_exp2 -> agg_pp0_dp1_gpu0_layer0
	expert_pp0_dp1_gpu0_layer0_exp3 -> agg_pp0_dp1_gpu0_layer0
	agg_pp0_dp1_gpu0_layer0 -> attn_pp0_dp1_gpu0_layer1
	attn_pp0_dp1_gpu0_layer1 -> route_pp0_dp1_gpu0_layer1
	route_pp0_dp1_gpu0_layer1 -> expert_pp0_dp1_gpu0_layer1_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp1_gpu0_layer1 -> expert_pp0_dp1_gpu0_layer1_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp1_gpu0_layer1 -> expert_pp0_dp1_gpu0_layer1_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp1_gpu0_layer1 -> expert_pp0_dp1_gpu0_layer1_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp1_gpu0_layer1_exp0 -> agg_pp0_dp1_gpu0_layer1
	expert_pp0_dp1_gpu0_layer1_exp1 -> agg_pp0_dp1_gpu0_layer1
	expert_pp0_dp1_gpu0_layer1_exp2 -> agg_pp0_dp1_gpu0_layer1
	expert_pp0_dp1_gpu0_layer1_exp3 -> agg_pp0_dp1_gpu0_layer1
	agg_pp0_dp1_gpu0_layer1 -> attn_pp0_dp1_gpu0_layer2
	attn_pp0_dp1_gpu0_layer2 -> route_pp0_dp1_gpu0_layer2
	route_pp0_dp1_gpu0_layer2 -> expert_pp0_dp1_gpu0_layer2_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp1_gpu0_layer2 -> expert_pp0_dp1_gpu0_layer2_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp1_gpu0_layer2 -> expert_pp0_dp1_gpu0_layer2_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp1_gpu0_layer2 -> expert_pp0_dp1_gpu0_layer2_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp1_gpu0_layer2_exp0 -> agg_pp0_dp1_gpu0_layer2
	expert_pp0_dp1_gpu0_layer2_exp1 -> agg_pp0_dp1_gpu0_layer2
	expert_pp0_dp1_gpu0_layer2_exp2 -> agg_pp0_dp1_gpu0_layer2
	expert_pp0_dp1_gpu0_layer2_exp3 -> agg_pp0_dp1_gpu0_layer2
	agg_pp0_dp1_gpu0_layer2 -> attn_pp0_dp1_gpu0_layer3
	attn_pp0_dp1_gpu0_layer3 -> route_pp0_dp1_gpu0_layer3
	route_pp0_dp1_gpu0_layer3 -> expert_pp0_dp1_gpu0_layer3_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp1_gpu0_layer3 -> expert_pp0_dp1_gpu0_layer3_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp1_gpu0_layer3 -> expert_pp0_dp1_gpu0_layer3_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp1_gpu0_layer3 -> expert_pp0_dp1_gpu0_layer3_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp1_gpu0_layer3_exp0 -> agg_pp0_dp1_gpu0_layer3
	expert_pp0_dp1_gpu0_layer3_exp1 -> agg_pp0_dp1_gpu0_layer3
	expert_pp0_dp1_gpu0_layer3_exp2 -> agg_pp0_dp1_gpu0_layer3
	expert_pp0_dp1_gpu0_layer3_exp3 -> agg_pp0_dp1_gpu0_layer3
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu0 [label="P2P Comm\nStage 0->1\nGPU 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu0_layer3 -> comm_pp0_to_pp1_dp1_gpu0
	comm_pp0_to_pp1_dp1_gpu0 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp1_gpu1_layer0 -> route_pp0_dp1_gpu1_layer0
	route_pp0_dp1_gpu1_layer0 -> expert_pp0_dp1_gpu1_layer0_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp1_gpu1_layer0 -> expert_pp0_dp1_gpu1_layer0_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp1_gpu1_layer0 -> expert_pp0_dp1_gpu1_layer0_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp1_gpu1_layer0 -> expert_pp0_dp1_gpu1_layer0_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp1_gpu1_layer0_exp4 -> agg_pp0_dp1_gpu1_layer0
	expert_pp0_dp1_gpu1_layer0_exp5 -> agg_pp0_dp1_gpu1_layer0
	expert_pp0_dp1_gpu1_layer0_exp6 -> agg_pp0_dp1_gpu1_layer0
	expert_pp0_dp1_gpu1_layer0_exp7 -> agg_pp0_dp1_gpu1_layer0
	agg_pp0_dp1_gpu1_layer0 -> attn_pp0_dp1_gpu1_layer1
	attn_pp0_dp1_gpu1_layer1 -> route_pp0_dp1_gpu1_layer1
	route_pp0_dp1_gpu1_layer1 -> expert_pp0_dp1_gpu1_layer1_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp1_gpu1_layer1 -> expert_pp0_dp1_gpu1_layer1_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp1_gpu1_layer1 -> expert_pp0_dp1_gpu1_layer1_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp1_gpu1_layer1 -> expert_pp0_dp1_gpu1_layer1_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp1_gpu1_layer1_exp4 -> agg_pp0_dp1_gpu1_layer1
	expert_pp0_dp1_gpu1_layer1_exp5 -> agg_pp0_dp1_gpu1_layer1
	expert_pp0_dp1_gpu1_layer1_exp6 -> agg_pp0_dp1_gpu1_layer1
	expert_pp0_dp1_gpu1_layer1_exp7 -> agg_pp0_dp1_gpu1_layer1
	agg_pp0_dp1_gpu1_layer1 -> attn_pp0_dp1_gpu1_layer2
	attn_pp0_dp1_gpu1_layer2 -> route_pp0_dp1_gpu1_layer2
	route_pp0_dp1_gpu1_layer2 -> expert_pp0_dp1_gpu1_layer2_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp1_gpu1_layer2 -> expert_pp0_dp1_gpu1_layer2_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp1_gpu1_layer2 -> expert_pp0_dp1_gpu1_layer2_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp1_gpu1_layer2 -> expert_pp0_dp1_gpu1_layer2_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp1_gpu1_layer2_exp4 -> agg_pp0_dp1_gpu1_layer2
	expert_pp0_dp1_gpu1_layer2_exp5 -> agg_pp0_dp1_gpu1_layer2
	expert_pp0_dp1_gpu1_layer2_exp6 -> agg_pp0_dp1_gpu1_layer2
	expert_pp0_dp1_gpu1_layer2_exp7 -> agg_pp0_dp1_gpu1_layer2
	agg_pp0_dp1_gpu1_layer2 -> attn_pp0_dp1_gpu1_layer3
	attn_pp0_dp1_gpu1_layer3 -> route_pp0_dp1_gpu1_layer3
	route_pp0_dp1_gpu1_layer3 -> expert_pp0_dp1_gpu1_layer3_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp1_gpu1_layer3 -> expert_pp0_dp1_gpu1_layer3_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp1_gpu1_layer3 -> expert_pp0_dp1_gpu1_layer3_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp1_gpu1_layer3 -> expert_pp0_dp1_gpu1_layer3_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp1_gpu1_layer3_exp4 -> agg_pp0_dp1_gpu1_layer3
	expert_pp0_dp1_gpu1_layer3_exp5 -> agg_pp0_dp1_gpu1_layer3
	expert_pp0_dp1_gpu1_layer3_exp6 -> agg_pp0_dp1_gpu1_layer3
	expert_pp0_dp1_gpu1_layer3_exp7 -> agg_pp0_dp1_gpu1_layer3
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu1 [label="P2P Comm\nStage 0->1\nGPU 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu1_layer3 -> comm_pp0_to_pp1_dp1_gpu1
	comm_pp0_to_pp1_dp1_gpu1 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp1_gpu2_layer0 -> route_pp0_dp1_gpu2_layer0
	route_pp0_dp1_gpu2_layer0 -> expert_pp0_dp1_gpu2_layer0_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp1_gpu2_layer0 -> expert_pp0_dp1_gpu2_layer0_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp1_gpu2_layer0 -> expert_pp0_dp1_gpu2_layer0_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp1_gpu2_layer0 -> expert_pp0_dp1_gpu2_layer0_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp1_gpu2_layer0_exp8 -> agg_pp0_dp1_gpu2_layer0
	expert_pp0_dp1_gpu2_layer0_exp9 -> agg_pp0_dp1_gpu2_layer0
	expert_pp0_dp1_gpu2_layer0_exp10 -> agg_pp0_dp1_gpu2_layer0
	expert_pp0_dp1_gpu2_layer0_exp11 -> agg_pp0_dp1_gpu2_layer0
	agg_pp0_dp1_gpu2_layer0 -> attn_pp0_dp1_gpu2_layer1
	attn_pp0_dp1_gpu2_layer1 -> route_pp0_dp1_gpu2_layer1
	route_pp0_dp1_gpu2_layer1 -> expert_pp0_dp1_gpu2_layer1_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp1_gpu2_layer1 -> expert_pp0_dp1_gpu2_layer1_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp1_gpu2_layer1 -> expert_pp0_dp1_gpu2_layer1_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp1_gpu2_layer1 -> expert_pp0_dp1_gpu2_layer1_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp1_gpu2_layer1_exp8 -> agg_pp0_dp1_gpu2_layer1
	expert_pp0_dp1_gpu2_layer1_exp9 -> agg_pp0_dp1_gpu2_layer1
	expert_pp0_dp1_gpu2_layer1_exp10 -> agg_pp0_dp1_gpu2_layer1
	expert_pp0_dp1_gpu2_layer1_exp11 -> agg_pp0_dp1_gpu2_layer1
	agg_pp0_dp1_gpu2_layer1 -> attn_pp0_dp1_gpu2_layer2
	attn_pp0_dp1_gpu2_layer2 -> route_pp0_dp1_gpu2_layer2
	route_pp0_dp1_gpu2_layer2 -> expert_pp0_dp1_gpu2_layer2_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp1_gpu2_layer2 -> expert_pp0_dp1_gpu2_layer2_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp1_gpu2_layer2 -> expert_pp0_dp1_gpu2_layer2_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp1_gpu2_layer2 -> expert_pp0_dp1_gpu2_layer2_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp1_gpu2_layer2_exp8 -> agg_pp0_dp1_gpu2_layer2
	expert_pp0_dp1_gpu2_layer2_exp9 -> agg_pp0_dp1_gpu2_layer2
	expert_pp0_dp1_gpu2_layer2_exp10 -> agg_pp0_dp1_gpu2_layer2
	expert_pp0_dp1_gpu2_layer2_exp11 -> agg_pp0_dp1_gpu2_layer2
	agg_pp0_dp1_gpu2_layer2 -> attn_pp0_dp1_gpu2_layer3
	attn_pp0_dp1_gpu2_layer3 -> route_pp0_dp1_gpu2_layer3
	route_pp0_dp1_gpu2_layer3 -> expert_pp0_dp1_gpu2_layer3_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp1_gpu2_layer3 -> expert_pp0_dp1_gpu2_layer3_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp1_gpu2_layer3 -> expert_pp0_dp1_gpu2_layer3_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp1_gpu2_layer3 -> expert_pp0_dp1_gpu2_layer3_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp1_gpu2_layer3_exp8 -> agg_pp0_dp1_gpu2_layer3
	expert_pp0_dp1_gpu2_layer3_exp9 -> agg_pp0_dp1_gpu2_layer3
	expert_pp0_dp1_gpu2_layer3_exp10 -> agg_pp0_dp1_gpu2_layer3
	expert_pp0_dp1_gpu2_layer3_exp11 -> agg_pp0_dp1_gpu2_layer3
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu2 [label="P2P Comm\nStage 0->1\nGPU 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu2_layer3 -> comm_pp0_to_pp1_dp1_gpu2
	comm_pp0_to_pp1_dp1_gpu2 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp1_gpu3_layer0 -> route_pp0_dp1_gpu3_layer0
	route_pp0_dp1_gpu3_layer0 -> expert_pp0_dp1_gpu3_layer0_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp1_gpu3_layer0 -> expert_pp0_dp1_gpu3_layer0_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp1_gpu3_layer0 -> expert_pp0_dp1_gpu3_layer0_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp1_gpu3_layer0 -> expert_pp0_dp1_gpu3_layer0_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp1_gpu3_layer0_exp12 -> agg_pp0_dp1_gpu3_layer0
	expert_pp0_dp1_gpu3_layer0_exp13 -> agg_pp0_dp1_gpu3_layer0
	expert_pp0_dp1_gpu3_layer0_exp14 -> agg_pp0_dp1_gpu3_layer0
	expert_pp0_dp1_gpu3_layer0_exp15 -> agg_pp0_dp1_gpu3_layer0
	agg_pp0_dp1_gpu3_layer0 -> attn_pp0_dp1_gpu3_layer1
	attn_pp0_dp1_gpu3_layer1 -> route_pp0_dp1_gpu3_layer1
	route_pp0_dp1_gpu3_layer1 -> expert_pp0_dp1_gpu3_layer1_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp1_gpu3_layer1 -> expert_pp0_dp1_gpu3_layer1_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp1_gpu3_layer1 -> expert_pp0_dp1_gpu3_layer1_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp1_gpu3_layer1 -> expert_pp0_dp1_gpu3_layer1_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp1_gpu3_layer1_exp12 -> agg_pp0_dp1_gpu3_layer1
	expert_pp0_dp1_gpu3_layer1_exp13 -> agg_pp0_dp1_gpu3_layer1
	expert_pp0_dp1_gpu3_layer1_exp14 -> agg_pp0_dp1_gpu3_layer1
	expert_pp0_dp1_gpu3_layer1_exp15 -> agg_pp0_dp1_gpu3_layer1
	agg_pp0_dp1_gpu3_layer1 -> attn_pp0_dp1_gpu3_layer2
	attn_pp0_dp1_gpu3_layer2 -> route_pp0_dp1_gpu3_layer2
	route_pp0_dp1_gpu3_layer2 -> expert_pp0_dp1_gpu3_layer2_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp1_gpu3_layer2 -> expert_pp0_dp1_gpu3_layer2_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp1_gpu3_layer2 -> expert_pp0_dp1_gpu3_layer2_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp1_gpu3_layer2 -> expert_pp0_dp1_gpu3_layer2_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp1_gpu3_layer2_exp12 -> agg_pp0_dp1_gpu3_layer2
	expert_pp0_dp1_gpu3_layer2_exp13 -> agg_pp0_dp1_gpu3_layer2
	expert_pp0_dp1_gpu3_layer2_exp14 -> agg_pp0_dp1_gpu3_layer2
	expert_pp0_dp1_gpu3_layer2_exp15 -> agg_pp0_dp1_gpu3_layer2
	agg_pp0_dp1_gpu3_layer2 -> attn_pp0_dp1_gpu3_layer3
	attn_pp0_dp1_gpu3_layer3 -> route_pp0_dp1_gpu3_layer3
	route_pp0_dp1_gpu3_layer3 -> expert_pp0_dp1_gpu3_layer3_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp1_gpu3_layer3 -> expert_pp0_dp1_gpu3_layer3_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp1_gpu3_layer3 -> expert_pp0_dp1_gpu3_layer3_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp1_gpu3_layer3 -> expert_pp0_dp1_gpu3_layer3_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp1_gpu3_layer3_exp12 -> agg_pp0_dp1_gpu3_layer3
	expert_pp0_dp1_gpu3_layer3_exp13 -> agg_pp0_dp1_gpu3_layer3
	expert_pp0_dp1_gpu3_layer3_exp14 -> agg_pp0_dp1_gpu3_layer3
	expert_pp0_dp1_gpu3_layer3_exp15 -> agg_pp0_dp1_gpu3_layer3
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp1_gpu3 [label="P2P Comm\nStage 0->1\nGPU 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp1_gpu3_layer3 -> comm_pp0_to_pp1_dp1_gpu3
	comm_pp0_to_pp1_dp1_gpu3 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp2_gpu0_layer0 -> route_pp0_dp2_gpu0_layer0
	route_pp0_dp2_gpu0_layer0 -> expert_pp0_dp2_gpu0_layer0_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp2_gpu0_layer0 -> expert_pp0_dp2_gpu0_layer0_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp2_gpu0_layer0 -> expert_pp0_dp2_gpu0_layer0_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp2_gpu0_layer0 -> expert_pp0_dp2_gpu0_layer0_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp2_gpu0_layer0_exp0 -> agg_pp0_dp2_gpu0_layer0
	expert_pp0_dp2_gpu0_layer0_exp1 -> agg_pp0_dp2_gpu0_layer0
	expert_pp0_dp2_gpu0_layer0_exp2 -> agg_pp0_dp2_gpu0_layer0
	expert_pp0_dp2_gpu0_layer0_exp3 -> agg_pp0_dp2_gpu0_layer0
	agg_pp0_dp2_gpu0_layer0 -> attn_pp0_dp2_gpu0_layer1
	attn_pp0_dp2_gpu0_layer1 -> route_pp0_dp2_gpu0_layer1
	route_pp0_dp2_gpu0_layer1 -> expert_pp0_dp2_gpu0_layer1_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp2_gpu0_layer1 -> expert_pp0_dp2_gpu0_layer1_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp2_gpu0_layer1 -> expert_pp0_dp2_gpu0_layer1_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp2_gpu0_layer1 -> expert_pp0_dp2_gpu0_layer1_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp2_gpu0_layer1_exp0 -> agg_pp0_dp2_gpu0_layer1
	expert_pp0_dp2_gpu0_layer1_exp1 -> agg_pp0_dp2_gpu0_layer1
	expert_pp0_dp2_gpu0_layer1_exp2 -> agg_pp0_dp2_gpu0_layer1
	expert_pp0_dp2_gpu0_layer1_exp3 -> agg_pp0_dp2_gpu0_layer1
	agg_pp0_dp2_gpu0_layer1 -> attn_pp0_dp2_gpu0_layer2
	attn_pp0_dp2_gpu0_layer2 -> route_pp0_dp2_gpu0_layer2
	route_pp0_dp2_gpu0_layer2 -> expert_pp0_dp2_gpu0_layer2_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp2_gpu0_layer2 -> expert_pp0_dp2_gpu0_layer2_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp2_gpu0_layer2 -> expert_pp0_dp2_gpu0_layer2_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp2_gpu0_layer2 -> expert_pp0_dp2_gpu0_layer2_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp2_gpu0_layer2_exp0 -> agg_pp0_dp2_gpu0_layer2
	expert_pp0_dp2_gpu0_layer2_exp1 -> agg_pp0_dp2_gpu0_layer2
	expert_pp0_dp2_gpu0_layer2_exp2 -> agg_pp0_dp2_gpu0_layer2
	expert_pp0_dp2_gpu0_layer2_exp3 -> agg_pp0_dp2_gpu0_layer2
	agg_pp0_dp2_gpu0_layer2 -> attn_pp0_dp2_gpu0_layer3
	attn_pp0_dp2_gpu0_layer3 -> route_pp0_dp2_gpu0_layer3
	route_pp0_dp2_gpu0_layer3 -> expert_pp0_dp2_gpu0_layer3_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp2_gpu0_layer3 -> expert_pp0_dp2_gpu0_layer3_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp2_gpu0_layer3 -> expert_pp0_dp2_gpu0_layer3_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp2_gpu0_layer3 -> expert_pp0_dp2_gpu0_layer3_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp2_gpu0_layer3_exp0 -> agg_pp0_dp2_gpu0_layer3
	expert_pp0_dp2_gpu0_layer3_exp1 -> agg_pp0_dp2_gpu0_layer3
	expert_pp0_dp2_gpu0_layer3_exp2 -> agg_pp0_dp2_gpu0_layer3
	expert_pp0_dp2_gpu0_layer3_exp3 -> agg_pp0_dp2_gpu0_layer3
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu0 [label="P2P Comm\nStage 0->1\nGPU 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu0_layer3 -> comm_pp0_to_pp1_dp2_gpu0
	comm_pp0_to_pp1_dp2_gpu0 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp2_gpu1_layer0 -> route_pp0_dp2_gpu1_layer0
	route_pp0_dp2_gpu1_layer0 -> expert_pp0_dp2_gpu1_layer0_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp2_gpu1_layer0 -> expert_pp0_dp2_gpu1_layer0_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp2_gpu1_layer0 -> expert_pp0_dp2_gpu1_layer0_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp2_gpu1_layer0 -> expert_pp0_dp2_gpu1_layer0_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp2_gpu1_layer0_exp4 -> agg_pp0_dp2_gpu1_layer0
	expert_pp0_dp2_gpu1_layer0_exp5 -> agg_pp0_dp2_gpu1_layer0
	expert_pp0_dp2_gpu1_layer0_exp6 -> agg_pp0_dp2_gpu1_layer0
	expert_pp0_dp2_gpu1_layer0_exp7 -> agg_pp0_dp2_gpu1_layer0
	agg_pp0_dp2_gpu1_layer0 -> attn_pp0_dp2_gpu1_layer1
	attn_pp0_dp2_gpu1_layer1 -> route_pp0_dp2_gpu1_layer1
	route_pp0_dp2_gpu1_layer1 -> expert_pp0_dp2_gpu1_layer1_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp2_gpu1_layer1 -> expert_pp0_dp2_gpu1_layer1_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp2_gpu1_layer1 -> expert_pp0_dp2_gpu1_layer1_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp2_gpu1_layer1 -> expert_pp0_dp2_gpu1_layer1_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp2_gpu1_layer1_exp4 -> agg_pp0_dp2_gpu1_layer1
	expert_pp0_dp2_gpu1_layer1_exp5 -> agg_pp0_dp2_gpu1_layer1
	expert_pp0_dp2_gpu1_layer1_exp6 -> agg_pp0_dp2_gpu1_layer1
	expert_pp0_dp2_gpu1_layer1_exp7 -> agg_pp0_dp2_gpu1_layer1
	agg_pp0_dp2_gpu1_layer1 -> attn_pp0_dp2_gpu1_layer2
	attn_pp0_dp2_gpu1_layer2 -> route_pp0_dp2_gpu1_layer2
	route_pp0_dp2_gpu1_layer2 -> expert_pp0_dp2_gpu1_layer2_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp2_gpu1_layer2 -> expert_pp0_dp2_gpu1_layer2_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp2_gpu1_layer2 -> expert_pp0_dp2_gpu1_layer2_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp2_gpu1_layer2 -> expert_pp0_dp2_gpu1_layer2_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp2_gpu1_layer2_exp4 -> agg_pp0_dp2_gpu1_layer2
	expert_pp0_dp2_gpu1_layer2_exp5 -> agg_pp0_dp2_gpu1_layer2
	expert_pp0_dp2_gpu1_layer2_exp6 -> agg_pp0_dp2_gpu1_layer2
	expert_pp0_dp2_gpu1_layer2_exp7 -> agg_pp0_dp2_gpu1_layer2
	agg_pp0_dp2_gpu1_layer2 -> attn_pp0_dp2_gpu1_layer3
	attn_pp0_dp2_gpu1_layer3 -> route_pp0_dp2_gpu1_layer3
	route_pp0_dp2_gpu1_layer3 -> expert_pp0_dp2_gpu1_layer3_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp2_gpu1_layer3 -> expert_pp0_dp2_gpu1_layer3_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp2_gpu1_layer3 -> expert_pp0_dp2_gpu1_layer3_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp2_gpu1_layer3 -> expert_pp0_dp2_gpu1_layer3_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp2_gpu1_layer3_exp4 -> agg_pp0_dp2_gpu1_layer3
	expert_pp0_dp2_gpu1_layer3_exp5 -> agg_pp0_dp2_gpu1_layer3
	expert_pp0_dp2_gpu1_layer3_exp6 -> agg_pp0_dp2_gpu1_layer3
	expert_pp0_dp2_gpu1_layer3_exp7 -> agg_pp0_dp2_gpu1_layer3
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu1 [label="P2P Comm\nStage 0->1\nGPU 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu1_layer3 -> comm_pp0_to_pp1_dp2_gpu1
	comm_pp0_to_pp1_dp2_gpu1 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp2_gpu2_layer0 -> route_pp0_dp2_gpu2_layer0
	route_pp0_dp2_gpu2_layer0 -> expert_pp0_dp2_gpu2_layer0_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp2_gpu2_layer0 -> expert_pp0_dp2_gpu2_layer0_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp2_gpu2_layer0 -> expert_pp0_dp2_gpu2_layer0_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp2_gpu2_layer0 -> expert_pp0_dp2_gpu2_layer0_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp2_gpu2_layer0_exp8 -> agg_pp0_dp2_gpu2_layer0
	expert_pp0_dp2_gpu2_layer0_exp9 -> agg_pp0_dp2_gpu2_layer0
	expert_pp0_dp2_gpu2_layer0_exp10 -> agg_pp0_dp2_gpu2_layer0
	expert_pp0_dp2_gpu2_layer0_exp11 -> agg_pp0_dp2_gpu2_layer0
	agg_pp0_dp2_gpu2_layer0 -> attn_pp0_dp2_gpu2_layer1
	attn_pp0_dp2_gpu2_layer1 -> route_pp0_dp2_gpu2_layer1
	route_pp0_dp2_gpu2_layer1 -> expert_pp0_dp2_gpu2_layer1_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp2_gpu2_layer1 -> expert_pp0_dp2_gpu2_layer1_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp2_gpu2_layer1 -> expert_pp0_dp2_gpu2_layer1_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp2_gpu2_layer1 -> expert_pp0_dp2_gpu2_layer1_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp2_gpu2_layer1_exp8 -> agg_pp0_dp2_gpu2_layer1
	expert_pp0_dp2_gpu2_layer1_exp9 -> agg_pp0_dp2_gpu2_layer1
	expert_pp0_dp2_gpu2_layer1_exp10 -> agg_pp0_dp2_gpu2_layer1
	expert_pp0_dp2_gpu2_layer1_exp11 -> agg_pp0_dp2_gpu2_layer1
	agg_pp0_dp2_gpu2_layer1 -> attn_pp0_dp2_gpu2_layer2
	attn_pp0_dp2_gpu2_layer2 -> route_pp0_dp2_gpu2_layer2
	route_pp0_dp2_gpu2_layer2 -> expert_pp0_dp2_gpu2_layer2_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp2_gpu2_layer2 -> expert_pp0_dp2_gpu2_layer2_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp2_gpu2_layer2 -> expert_pp0_dp2_gpu2_layer2_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp2_gpu2_layer2 -> expert_pp0_dp2_gpu2_layer2_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp2_gpu2_layer2_exp8 -> agg_pp0_dp2_gpu2_layer2
	expert_pp0_dp2_gpu2_layer2_exp9 -> agg_pp0_dp2_gpu2_layer2
	expert_pp0_dp2_gpu2_layer2_exp10 -> agg_pp0_dp2_gpu2_layer2
	expert_pp0_dp2_gpu2_layer2_exp11 -> agg_pp0_dp2_gpu2_layer2
	agg_pp0_dp2_gpu2_layer2 -> attn_pp0_dp2_gpu2_layer3
	attn_pp0_dp2_gpu2_layer3 -> route_pp0_dp2_gpu2_layer3
	route_pp0_dp2_gpu2_layer3 -> expert_pp0_dp2_gpu2_layer3_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp2_gpu2_layer3 -> expert_pp0_dp2_gpu2_layer3_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp2_gpu2_layer3 -> expert_pp0_dp2_gpu2_layer3_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp2_gpu2_layer3 -> expert_pp0_dp2_gpu2_layer3_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp2_gpu2_layer3_exp8 -> agg_pp0_dp2_gpu2_layer3
	expert_pp0_dp2_gpu2_layer3_exp9 -> agg_pp0_dp2_gpu2_layer3
	expert_pp0_dp2_gpu2_layer3_exp10 -> agg_pp0_dp2_gpu2_layer3
	expert_pp0_dp2_gpu2_layer3_exp11 -> agg_pp0_dp2_gpu2_layer3
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu2 [label="P2P Comm\nStage 0->1\nGPU 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu2_layer3 -> comm_pp0_to_pp1_dp2_gpu2
	comm_pp0_to_pp1_dp2_gpu2 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp2_gpu3_layer0 -> route_pp0_dp2_gpu3_layer0
	route_pp0_dp2_gpu3_layer0 -> expert_pp0_dp2_gpu3_layer0_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp2_gpu3_layer0 -> expert_pp0_dp2_gpu3_layer0_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp2_gpu3_layer0 -> expert_pp0_dp2_gpu3_layer0_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp2_gpu3_layer0 -> expert_pp0_dp2_gpu3_layer0_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp2_gpu3_layer0_exp12 -> agg_pp0_dp2_gpu3_layer0
	expert_pp0_dp2_gpu3_layer0_exp13 -> agg_pp0_dp2_gpu3_layer0
	expert_pp0_dp2_gpu3_layer0_exp14 -> agg_pp0_dp2_gpu3_layer0
	expert_pp0_dp2_gpu3_layer0_exp15 -> agg_pp0_dp2_gpu3_layer0
	agg_pp0_dp2_gpu3_layer0 -> attn_pp0_dp2_gpu3_layer1
	attn_pp0_dp2_gpu3_layer1 -> route_pp0_dp2_gpu3_layer1
	route_pp0_dp2_gpu3_layer1 -> expert_pp0_dp2_gpu3_layer1_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp2_gpu3_layer1 -> expert_pp0_dp2_gpu3_layer1_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp2_gpu3_layer1 -> expert_pp0_dp2_gpu3_layer1_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp2_gpu3_layer1 -> expert_pp0_dp2_gpu3_layer1_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp2_gpu3_layer1_exp12 -> agg_pp0_dp2_gpu3_layer1
	expert_pp0_dp2_gpu3_layer1_exp13 -> agg_pp0_dp2_gpu3_layer1
	expert_pp0_dp2_gpu3_layer1_exp14 -> agg_pp0_dp2_gpu3_layer1
	expert_pp0_dp2_gpu3_layer1_exp15 -> agg_pp0_dp2_gpu3_layer1
	agg_pp0_dp2_gpu3_layer1 -> attn_pp0_dp2_gpu3_layer2
	attn_pp0_dp2_gpu3_layer2 -> route_pp0_dp2_gpu3_layer2
	route_pp0_dp2_gpu3_layer2 -> expert_pp0_dp2_gpu3_layer2_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp2_gpu3_layer2 -> expert_pp0_dp2_gpu3_layer2_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp2_gpu3_layer2 -> expert_pp0_dp2_gpu3_layer2_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp2_gpu3_layer2 -> expert_pp0_dp2_gpu3_layer2_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp2_gpu3_layer2_exp12 -> agg_pp0_dp2_gpu3_layer2
	expert_pp0_dp2_gpu3_layer2_exp13 -> agg_pp0_dp2_gpu3_layer2
	expert_pp0_dp2_gpu3_layer2_exp14 -> agg_pp0_dp2_gpu3_layer2
	expert_pp0_dp2_gpu3_layer2_exp15 -> agg_pp0_dp2_gpu3_layer2
	agg_pp0_dp2_gpu3_layer2 -> attn_pp0_dp2_gpu3_layer3
	attn_pp0_dp2_gpu3_layer3 -> route_pp0_dp2_gpu3_layer3
	route_pp0_dp2_gpu3_layer3 -> expert_pp0_dp2_gpu3_layer3_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp2_gpu3_layer3 -> expert_pp0_dp2_gpu3_layer3_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp2_gpu3_layer3 -> expert_pp0_dp2_gpu3_layer3_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp2_gpu3_layer3 -> expert_pp0_dp2_gpu3_layer3_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp2_gpu3_layer3_exp12 -> agg_pp0_dp2_gpu3_layer3
	expert_pp0_dp2_gpu3_layer3_exp13 -> agg_pp0_dp2_gpu3_layer3
	expert_pp0_dp2_gpu3_layer3_exp14 -> agg_pp0_dp2_gpu3_layer3
	expert_pp0_dp2_gpu3_layer3_exp15 -> agg_pp0_dp2_gpu3_layer3
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp2_gpu3 [label="P2P Comm\nStage 0->1\nGPU 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp2_gpu3_layer3 -> comm_pp0_to_pp1_dp2_gpu3
	comm_pp0_to_pp1_dp2_gpu3 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp3_gpu0_layer0 -> route_pp0_dp3_gpu0_layer0
	route_pp0_dp3_gpu0_layer0 -> expert_pp0_dp3_gpu0_layer0_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp3_gpu0_layer0 -> expert_pp0_dp3_gpu0_layer0_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp3_gpu0_layer0 -> expert_pp0_dp3_gpu0_layer0_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp3_gpu0_layer0 -> expert_pp0_dp3_gpu0_layer0_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp3_gpu0_layer0_exp0 -> agg_pp0_dp3_gpu0_layer0
	expert_pp0_dp3_gpu0_layer0_exp1 -> agg_pp0_dp3_gpu0_layer0
	expert_pp0_dp3_gpu0_layer0_exp2 -> agg_pp0_dp3_gpu0_layer0
	expert_pp0_dp3_gpu0_layer0_exp3 -> agg_pp0_dp3_gpu0_layer0
	agg_pp0_dp3_gpu0_layer0 -> attn_pp0_dp3_gpu0_layer1
	attn_pp0_dp3_gpu0_layer1 -> route_pp0_dp3_gpu0_layer1
	route_pp0_dp3_gpu0_layer1 -> expert_pp0_dp3_gpu0_layer1_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp3_gpu0_layer1 -> expert_pp0_dp3_gpu0_layer1_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp3_gpu0_layer1 -> expert_pp0_dp3_gpu0_layer1_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp3_gpu0_layer1 -> expert_pp0_dp3_gpu0_layer1_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp3_gpu0_layer1_exp0 -> agg_pp0_dp3_gpu0_layer1
	expert_pp0_dp3_gpu0_layer1_exp1 -> agg_pp0_dp3_gpu0_layer1
	expert_pp0_dp3_gpu0_layer1_exp2 -> agg_pp0_dp3_gpu0_layer1
	expert_pp0_dp3_gpu0_layer1_exp3 -> agg_pp0_dp3_gpu0_layer1
	agg_pp0_dp3_gpu0_layer1 -> attn_pp0_dp3_gpu0_layer2
	attn_pp0_dp3_gpu0_layer2 -> route_pp0_dp3_gpu0_layer2
	route_pp0_dp3_gpu0_layer2 -> expert_pp0_dp3_gpu0_layer2_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp3_gpu0_layer2 -> expert_pp0_dp3_gpu0_layer2_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp3_gpu0_layer2 -> expert_pp0_dp3_gpu0_layer2_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp3_gpu0_layer2 -> expert_pp0_dp3_gpu0_layer2_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp3_gpu0_layer2_exp0 -> agg_pp0_dp3_gpu0_layer2
	expert_pp0_dp3_gpu0_layer2_exp1 -> agg_pp0_dp3_gpu0_layer2
	expert_pp0_dp3_gpu0_layer2_exp2 -> agg_pp0_dp3_gpu0_layer2
	expert_pp0_dp3_gpu0_layer2_exp3 -> agg_pp0_dp3_gpu0_layer2
	agg_pp0_dp3_gpu0_layer2 -> attn_pp0_dp3_gpu0_layer3
	attn_pp0_dp3_gpu0_layer3 -> route_pp0_dp3_gpu0_layer3
	route_pp0_dp3_gpu0_layer3 -> expert_pp0_dp3_gpu0_layer3_exp0 [label="Gated 0" style=dashed]
	route_pp0_dp3_gpu0_layer3 -> expert_pp0_dp3_gpu0_layer3_exp1 [label="Gated 1" style=dashed]
	route_pp0_dp3_gpu0_layer3 -> expert_pp0_dp3_gpu0_layer3_exp2 [label="Gated 2" style=dashed]
	route_pp0_dp3_gpu0_layer3 -> expert_pp0_dp3_gpu0_layer3_exp3 [label="Gated 3" style=dashed]
	expert_pp0_dp3_gpu0_layer3_exp0 -> agg_pp0_dp3_gpu0_layer3
	expert_pp0_dp3_gpu0_layer3_exp1 -> agg_pp0_dp3_gpu0_layer3
	expert_pp0_dp3_gpu0_layer3_exp2 -> agg_pp0_dp3_gpu0_layer3
	expert_pp0_dp3_gpu0_layer3_exp3 -> agg_pp0_dp3_gpu0_layer3
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu0 [label="P2P Comm\nStage 0->1\nGPU 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu0_layer3 -> comm_pp0_to_pp1_dp3_gpu0
	comm_pp0_to_pp1_dp3_gpu0 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp3_gpu1_layer0 -> route_pp0_dp3_gpu1_layer0
	route_pp0_dp3_gpu1_layer0 -> expert_pp0_dp3_gpu1_layer0_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp3_gpu1_layer0 -> expert_pp0_dp3_gpu1_layer0_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp3_gpu1_layer0 -> expert_pp0_dp3_gpu1_layer0_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp3_gpu1_layer0 -> expert_pp0_dp3_gpu1_layer0_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp3_gpu1_layer0_exp4 -> agg_pp0_dp3_gpu1_layer0
	expert_pp0_dp3_gpu1_layer0_exp5 -> agg_pp0_dp3_gpu1_layer0
	expert_pp0_dp3_gpu1_layer0_exp6 -> agg_pp0_dp3_gpu1_layer0
	expert_pp0_dp3_gpu1_layer0_exp7 -> agg_pp0_dp3_gpu1_layer0
	agg_pp0_dp3_gpu1_layer0 -> attn_pp0_dp3_gpu1_layer1
	attn_pp0_dp3_gpu1_layer1 -> route_pp0_dp3_gpu1_layer1
	route_pp0_dp3_gpu1_layer1 -> expert_pp0_dp3_gpu1_layer1_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp3_gpu1_layer1 -> expert_pp0_dp3_gpu1_layer1_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp3_gpu1_layer1 -> expert_pp0_dp3_gpu1_layer1_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp3_gpu1_layer1 -> expert_pp0_dp3_gpu1_layer1_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp3_gpu1_layer1_exp4 -> agg_pp0_dp3_gpu1_layer1
	expert_pp0_dp3_gpu1_layer1_exp5 -> agg_pp0_dp3_gpu1_layer1
	expert_pp0_dp3_gpu1_layer1_exp6 -> agg_pp0_dp3_gpu1_layer1
	expert_pp0_dp3_gpu1_layer1_exp7 -> agg_pp0_dp3_gpu1_layer1
	agg_pp0_dp3_gpu1_layer1 -> attn_pp0_dp3_gpu1_layer2
	attn_pp0_dp3_gpu1_layer2 -> route_pp0_dp3_gpu1_layer2
	route_pp0_dp3_gpu1_layer2 -> expert_pp0_dp3_gpu1_layer2_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp3_gpu1_layer2 -> expert_pp0_dp3_gpu1_layer2_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp3_gpu1_layer2 -> expert_pp0_dp3_gpu1_layer2_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp3_gpu1_layer2 -> expert_pp0_dp3_gpu1_layer2_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp3_gpu1_layer2_exp4 -> agg_pp0_dp3_gpu1_layer2
	expert_pp0_dp3_gpu1_layer2_exp5 -> agg_pp0_dp3_gpu1_layer2
	expert_pp0_dp3_gpu1_layer2_exp6 -> agg_pp0_dp3_gpu1_layer2
	expert_pp0_dp3_gpu1_layer2_exp7 -> agg_pp0_dp3_gpu1_layer2
	agg_pp0_dp3_gpu1_layer2 -> attn_pp0_dp3_gpu1_layer3
	attn_pp0_dp3_gpu1_layer3 -> route_pp0_dp3_gpu1_layer3
	route_pp0_dp3_gpu1_layer3 -> expert_pp0_dp3_gpu1_layer3_exp4 [label="Gated 4" style=dashed]
	route_pp0_dp3_gpu1_layer3 -> expert_pp0_dp3_gpu1_layer3_exp5 [label="Gated 5" style=dashed]
	route_pp0_dp3_gpu1_layer3 -> expert_pp0_dp3_gpu1_layer3_exp6 [label="Gated 6" style=dashed]
	route_pp0_dp3_gpu1_layer3 -> expert_pp0_dp3_gpu1_layer3_exp7 [label="Gated 7" style=dashed]
	expert_pp0_dp3_gpu1_layer3_exp4 -> agg_pp0_dp3_gpu1_layer3
	expert_pp0_dp3_gpu1_layer3_exp5 -> agg_pp0_dp3_gpu1_layer3
	expert_pp0_dp3_gpu1_layer3_exp6 -> agg_pp0_dp3_gpu1_layer3
	expert_pp0_dp3_gpu1_layer3_exp7 -> agg_pp0_dp3_gpu1_layer3
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu1 [label="P2P Comm\nStage 0->1\nGPU 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu1_layer3 -> comm_pp0_to_pp1_dp3_gpu1
	comm_pp0_to_pp1_dp3_gpu1 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp3_gpu2_layer0 -> route_pp0_dp3_gpu2_layer0
	route_pp0_dp3_gpu2_layer0 -> expert_pp0_dp3_gpu2_layer0_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp3_gpu2_layer0 -> expert_pp0_dp3_gpu2_layer0_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp3_gpu2_layer0 -> expert_pp0_dp3_gpu2_layer0_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp3_gpu2_layer0 -> expert_pp0_dp3_gpu2_layer0_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp3_gpu2_layer0_exp8 -> agg_pp0_dp3_gpu2_layer0
	expert_pp0_dp3_gpu2_layer0_exp9 -> agg_pp0_dp3_gpu2_layer0
	expert_pp0_dp3_gpu2_layer0_exp10 -> agg_pp0_dp3_gpu2_layer0
	expert_pp0_dp3_gpu2_layer0_exp11 -> agg_pp0_dp3_gpu2_layer0
	agg_pp0_dp3_gpu2_layer0 -> attn_pp0_dp3_gpu2_layer1
	attn_pp0_dp3_gpu2_layer1 -> route_pp0_dp3_gpu2_layer1
	route_pp0_dp3_gpu2_layer1 -> expert_pp0_dp3_gpu2_layer1_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp3_gpu2_layer1 -> expert_pp0_dp3_gpu2_layer1_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp3_gpu2_layer1 -> expert_pp0_dp3_gpu2_layer1_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp3_gpu2_layer1 -> expert_pp0_dp3_gpu2_layer1_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp3_gpu2_layer1_exp8 -> agg_pp0_dp3_gpu2_layer1
	expert_pp0_dp3_gpu2_layer1_exp9 -> agg_pp0_dp3_gpu2_layer1
	expert_pp0_dp3_gpu2_layer1_exp10 -> agg_pp0_dp3_gpu2_layer1
	expert_pp0_dp3_gpu2_layer1_exp11 -> agg_pp0_dp3_gpu2_layer1
	agg_pp0_dp3_gpu2_layer1 -> attn_pp0_dp3_gpu2_layer2
	attn_pp0_dp3_gpu2_layer2 -> route_pp0_dp3_gpu2_layer2
	route_pp0_dp3_gpu2_layer2 -> expert_pp0_dp3_gpu2_layer2_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp3_gpu2_layer2 -> expert_pp0_dp3_gpu2_layer2_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp3_gpu2_layer2 -> expert_pp0_dp3_gpu2_layer2_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp3_gpu2_layer2 -> expert_pp0_dp3_gpu2_layer2_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp3_gpu2_layer2_exp8 -> agg_pp0_dp3_gpu2_layer2
	expert_pp0_dp3_gpu2_layer2_exp9 -> agg_pp0_dp3_gpu2_layer2
	expert_pp0_dp3_gpu2_layer2_exp10 -> agg_pp0_dp3_gpu2_layer2
	expert_pp0_dp3_gpu2_layer2_exp11 -> agg_pp0_dp3_gpu2_layer2
	agg_pp0_dp3_gpu2_layer2 -> attn_pp0_dp3_gpu2_layer3
	attn_pp0_dp3_gpu2_layer3 -> route_pp0_dp3_gpu2_layer3
	route_pp0_dp3_gpu2_layer3 -> expert_pp0_dp3_gpu2_layer3_exp8 [label="Gated 8" style=dashed]
	route_pp0_dp3_gpu2_layer3 -> expert_pp0_dp3_gpu2_layer3_exp9 [label="Gated 9" style=dashed]
	route_pp0_dp3_gpu2_layer3 -> expert_pp0_dp3_gpu2_layer3_exp10 [label="Gated 10" style=dashed]
	route_pp0_dp3_gpu2_layer3 -> expert_pp0_dp3_gpu2_layer3_exp11 [label="Gated 11" style=dashed]
	expert_pp0_dp3_gpu2_layer3_exp8 -> agg_pp0_dp3_gpu2_layer3
	expert_pp0_dp3_gpu2_layer3_exp9 -> agg_pp0_dp3_gpu2_layer3
	expert_pp0_dp3_gpu2_layer3_exp10 -> agg_pp0_dp3_gpu2_layer3
	expert_pp0_dp3_gpu2_layer3_exp11 -> agg_pp0_dp3_gpu2_layer3
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu2 [label="P2P Comm\nStage 0->1\nGPU 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu2_layer3 -> comm_pp0_to_pp1_dp3_gpu2
	comm_pp0_to_pp1_dp3_gpu2 -> attn_pp1_dp3_gpu3_layer4
	attn_pp0_dp3_gpu3_layer0 -> route_pp0_dp3_gpu3_layer0
	route_pp0_dp3_gpu3_layer0 -> expert_pp0_dp3_gpu3_layer0_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp3_gpu3_layer0 -> expert_pp0_dp3_gpu3_layer0_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp3_gpu3_layer0 -> expert_pp0_dp3_gpu3_layer0_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp3_gpu3_layer0 -> expert_pp0_dp3_gpu3_layer0_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp3_gpu3_layer0_exp12 -> agg_pp0_dp3_gpu3_layer0
	expert_pp0_dp3_gpu3_layer0_exp13 -> agg_pp0_dp3_gpu3_layer0
	expert_pp0_dp3_gpu3_layer0_exp14 -> agg_pp0_dp3_gpu3_layer0
	expert_pp0_dp3_gpu3_layer0_exp15 -> agg_pp0_dp3_gpu3_layer0
	agg_pp0_dp3_gpu3_layer0 -> attn_pp0_dp3_gpu3_layer1
	attn_pp0_dp3_gpu3_layer1 -> route_pp0_dp3_gpu3_layer1
	route_pp0_dp3_gpu3_layer1 -> expert_pp0_dp3_gpu3_layer1_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp3_gpu3_layer1 -> expert_pp0_dp3_gpu3_layer1_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp3_gpu3_layer1 -> expert_pp0_dp3_gpu3_layer1_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp3_gpu3_layer1 -> expert_pp0_dp3_gpu3_layer1_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp3_gpu3_layer1_exp12 -> agg_pp0_dp3_gpu3_layer1
	expert_pp0_dp3_gpu3_layer1_exp13 -> agg_pp0_dp3_gpu3_layer1
	expert_pp0_dp3_gpu3_layer1_exp14 -> agg_pp0_dp3_gpu3_layer1
	expert_pp0_dp3_gpu3_layer1_exp15 -> agg_pp0_dp3_gpu3_layer1
	agg_pp0_dp3_gpu3_layer1 -> attn_pp0_dp3_gpu3_layer2
	attn_pp0_dp3_gpu3_layer2 -> route_pp0_dp3_gpu3_layer2
	route_pp0_dp3_gpu3_layer2 -> expert_pp0_dp3_gpu3_layer2_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp3_gpu3_layer2 -> expert_pp0_dp3_gpu3_layer2_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp3_gpu3_layer2 -> expert_pp0_dp3_gpu3_layer2_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp3_gpu3_layer2 -> expert_pp0_dp3_gpu3_layer2_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp3_gpu3_layer2_exp12 -> agg_pp0_dp3_gpu3_layer2
	expert_pp0_dp3_gpu3_layer2_exp13 -> agg_pp0_dp3_gpu3_layer2
	expert_pp0_dp3_gpu3_layer2_exp14 -> agg_pp0_dp3_gpu3_layer2
	expert_pp0_dp3_gpu3_layer2_exp15 -> agg_pp0_dp3_gpu3_layer2
	agg_pp0_dp3_gpu3_layer2 -> attn_pp0_dp3_gpu3_layer3
	attn_pp0_dp3_gpu3_layer3 -> route_pp0_dp3_gpu3_layer3
	route_pp0_dp3_gpu3_layer3 -> expert_pp0_dp3_gpu3_layer3_exp12 [label="Gated 12" style=dashed]
	route_pp0_dp3_gpu3_layer3 -> expert_pp0_dp3_gpu3_layer3_exp13 [label="Gated 13" style=dashed]
	route_pp0_dp3_gpu3_layer3 -> expert_pp0_dp3_gpu3_layer3_exp14 [label="Gated 14" style=dashed]
	route_pp0_dp3_gpu3_layer3 -> expert_pp0_dp3_gpu3_layer3_exp15 [label="Gated 15" style=dashed]
	expert_pp0_dp3_gpu3_layer3_exp12 -> agg_pp0_dp3_gpu3_layer3
	expert_pp0_dp3_gpu3_layer3_exp13 -> agg_pp0_dp3_gpu3_layer3
	expert_pp0_dp3_gpu3_layer3_exp14 -> agg_pp0_dp3_gpu3_layer3
	expert_pp0_dp3_gpu3_layer3_exp15 -> agg_pp0_dp3_gpu3_layer3
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp0_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp0_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp0_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp0_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp1_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp1_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp1_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp1_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp2_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp2_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp2_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp2_gpu3_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp3_gpu0_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp3_gpu1_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp3_gpu2_layer4
	comm_pp0_to_pp1_dp3_gpu3 [label="P2P Comm\nStage 0->1\nGPU 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp0_dp3_gpu3_layer3 -> comm_pp0_to_pp1_dp3_gpu3
	comm_pp0_to_pp1_dp3_gpu3 -> attn_pp1_dp3_gpu3_layer4
	attn_pp1_dp0_gpu0_layer4 -> route_pp1_dp0_gpu0_layer4
	route_pp1_dp0_gpu0_layer4 -> expert_pp1_dp0_gpu0_layer4_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp0_gpu0_layer4 -> expert_pp1_dp0_gpu0_layer4_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp0_gpu0_layer4 -> expert_pp1_dp0_gpu0_layer4_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp0_gpu0_layer4 -> expert_pp1_dp0_gpu0_layer4_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp0_gpu0_layer4_exp0 -> agg_pp1_dp0_gpu0_layer4
	expert_pp1_dp0_gpu0_layer4_exp1 -> agg_pp1_dp0_gpu0_layer4
	expert_pp1_dp0_gpu0_layer4_exp2 -> agg_pp1_dp0_gpu0_layer4
	expert_pp1_dp0_gpu0_layer4_exp3 -> agg_pp1_dp0_gpu0_layer4
	agg_pp1_dp0_gpu0_layer4 -> attn_pp1_dp0_gpu0_layer5
	attn_pp1_dp0_gpu0_layer5 -> route_pp1_dp0_gpu0_layer5
	route_pp1_dp0_gpu0_layer5 -> expert_pp1_dp0_gpu0_layer5_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp0_gpu0_layer5 -> expert_pp1_dp0_gpu0_layer5_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp0_gpu0_layer5 -> expert_pp1_dp0_gpu0_layer5_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp0_gpu0_layer5 -> expert_pp1_dp0_gpu0_layer5_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp0_gpu0_layer5_exp0 -> agg_pp1_dp0_gpu0_layer5
	expert_pp1_dp0_gpu0_layer5_exp1 -> agg_pp1_dp0_gpu0_layer5
	expert_pp1_dp0_gpu0_layer5_exp2 -> agg_pp1_dp0_gpu0_layer5
	expert_pp1_dp0_gpu0_layer5_exp3 -> agg_pp1_dp0_gpu0_layer5
	agg_pp1_dp0_gpu0_layer5 -> attn_pp1_dp0_gpu0_layer6
	attn_pp1_dp0_gpu0_layer6 -> route_pp1_dp0_gpu0_layer6
	route_pp1_dp0_gpu0_layer6 -> expert_pp1_dp0_gpu0_layer6_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp0_gpu0_layer6 -> expert_pp1_dp0_gpu0_layer6_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp0_gpu0_layer6 -> expert_pp1_dp0_gpu0_layer6_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp0_gpu0_layer6 -> expert_pp1_dp0_gpu0_layer6_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp0_gpu0_layer6_exp0 -> agg_pp1_dp0_gpu0_layer6
	expert_pp1_dp0_gpu0_layer6_exp1 -> agg_pp1_dp0_gpu0_layer6
	expert_pp1_dp0_gpu0_layer6_exp2 -> agg_pp1_dp0_gpu0_layer6
	expert_pp1_dp0_gpu0_layer6_exp3 -> agg_pp1_dp0_gpu0_layer6
	agg_pp1_dp0_gpu0_layer6 -> attn_pp1_dp0_gpu0_layer7
	attn_pp1_dp0_gpu0_layer7 -> route_pp1_dp0_gpu0_layer7
	route_pp1_dp0_gpu0_layer7 -> expert_pp1_dp0_gpu0_layer7_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp0_gpu0_layer7 -> expert_pp1_dp0_gpu0_layer7_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp0_gpu0_layer7 -> expert_pp1_dp0_gpu0_layer7_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp0_gpu0_layer7 -> expert_pp1_dp0_gpu0_layer7_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp0_gpu0_layer7_exp0 -> agg_pp1_dp0_gpu0_layer7
	expert_pp1_dp0_gpu0_layer7_exp1 -> agg_pp1_dp0_gpu0_layer7
	expert_pp1_dp0_gpu0_layer7_exp2 -> agg_pp1_dp0_gpu0_layer7
	expert_pp1_dp0_gpu0_layer7_exp3 -> agg_pp1_dp0_gpu0_layer7
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu0 [label="P2P Comm\nStage 1->2\nGPU 16\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu0_layer7 -> comm_pp1_to_pp2_dp0_gpu0
	comm_pp1_to_pp2_dp0_gpu0 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp0_gpu1_layer4 -> route_pp1_dp0_gpu1_layer4
	route_pp1_dp0_gpu1_layer4 -> expert_pp1_dp0_gpu1_layer4_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp0_gpu1_layer4 -> expert_pp1_dp0_gpu1_layer4_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp0_gpu1_layer4 -> expert_pp1_dp0_gpu1_layer4_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp0_gpu1_layer4 -> expert_pp1_dp0_gpu1_layer4_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp0_gpu1_layer4_exp4 -> agg_pp1_dp0_gpu1_layer4
	expert_pp1_dp0_gpu1_layer4_exp5 -> agg_pp1_dp0_gpu1_layer4
	expert_pp1_dp0_gpu1_layer4_exp6 -> agg_pp1_dp0_gpu1_layer4
	expert_pp1_dp0_gpu1_layer4_exp7 -> agg_pp1_dp0_gpu1_layer4
	agg_pp1_dp0_gpu1_layer4 -> attn_pp1_dp0_gpu1_layer5
	attn_pp1_dp0_gpu1_layer5 -> route_pp1_dp0_gpu1_layer5
	route_pp1_dp0_gpu1_layer5 -> expert_pp1_dp0_gpu1_layer5_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp0_gpu1_layer5 -> expert_pp1_dp0_gpu1_layer5_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp0_gpu1_layer5 -> expert_pp1_dp0_gpu1_layer5_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp0_gpu1_layer5 -> expert_pp1_dp0_gpu1_layer5_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp0_gpu1_layer5_exp4 -> agg_pp1_dp0_gpu1_layer5
	expert_pp1_dp0_gpu1_layer5_exp5 -> agg_pp1_dp0_gpu1_layer5
	expert_pp1_dp0_gpu1_layer5_exp6 -> agg_pp1_dp0_gpu1_layer5
	expert_pp1_dp0_gpu1_layer5_exp7 -> agg_pp1_dp0_gpu1_layer5
	agg_pp1_dp0_gpu1_layer5 -> attn_pp1_dp0_gpu1_layer6
	attn_pp1_dp0_gpu1_layer6 -> route_pp1_dp0_gpu1_layer6
	route_pp1_dp0_gpu1_layer6 -> expert_pp1_dp0_gpu1_layer6_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp0_gpu1_layer6 -> expert_pp1_dp0_gpu1_layer6_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp0_gpu1_layer6 -> expert_pp1_dp0_gpu1_layer6_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp0_gpu1_layer6 -> expert_pp1_dp0_gpu1_layer6_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp0_gpu1_layer6_exp4 -> agg_pp1_dp0_gpu1_layer6
	expert_pp1_dp0_gpu1_layer6_exp5 -> agg_pp1_dp0_gpu1_layer6
	expert_pp1_dp0_gpu1_layer6_exp6 -> agg_pp1_dp0_gpu1_layer6
	expert_pp1_dp0_gpu1_layer6_exp7 -> agg_pp1_dp0_gpu1_layer6
	agg_pp1_dp0_gpu1_layer6 -> attn_pp1_dp0_gpu1_layer7
	attn_pp1_dp0_gpu1_layer7 -> route_pp1_dp0_gpu1_layer7
	route_pp1_dp0_gpu1_layer7 -> expert_pp1_dp0_gpu1_layer7_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp0_gpu1_layer7 -> expert_pp1_dp0_gpu1_layer7_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp0_gpu1_layer7 -> expert_pp1_dp0_gpu1_layer7_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp0_gpu1_layer7 -> expert_pp1_dp0_gpu1_layer7_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp0_gpu1_layer7_exp4 -> agg_pp1_dp0_gpu1_layer7
	expert_pp1_dp0_gpu1_layer7_exp5 -> agg_pp1_dp0_gpu1_layer7
	expert_pp1_dp0_gpu1_layer7_exp6 -> agg_pp1_dp0_gpu1_layer7
	expert_pp1_dp0_gpu1_layer7_exp7 -> agg_pp1_dp0_gpu1_layer7
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu1 [label="P2P Comm\nStage 1->2\nGPU 17\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu1_layer7 -> comm_pp1_to_pp2_dp0_gpu1
	comm_pp1_to_pp2_dp0_gpu1 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp0_gpu2_layer4 -> route_pp1_dp0_gpu2_layer4
	route_pp1_dp0_gpu2_layer4 -> expert_pp1_dp0_gpu2_layer4_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp0_gpu2_layer4 -> expert_pp1_dp0_gpu2_layer4_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp0_gpu2_layer4 -> expert_pp1_dp0_gpu2_layer4_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp0_gpu2_layer4 -> expert_pp1_dp0_gpu2_layer4_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp0_gpu2_layer4_exp8 -> agg_pp1_dp0_gpu2_layer4
	expert_pp1_dp0_gpu2_layer4_exp9 -> agg_pp1_dp0_gpu2_layer4
	expert_pp1_dp0_gpu2_layer4_exp10 -> agg_pp1_dp0_gpu2_layer4
	expert_pp1_dp0_gpu2_layer4_exp11 -> agg_pp1_dp0_gpu2_layer4
	agg_pp1_dp0_gpu2_layer4 -> attn_pp1_dp0_gpu2_layer5
	attn_pp1_dp0_gpu2_layer5 -> route_pp1_dp0_gpu2_layer5
	route_pp1_dp0_gpu2_layer5 -> expert_pp1_dp0_gpu2_layer5_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp0_gpu2_layer5 -> expert_pp1_dp0_gpu2_layer5_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp0_gpu2_layer5 -> expert_pp1_dp0_gpu2_layer5_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp0_gpu2_layer5 -> expert_pp1_dp0_gpu2_layer5_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp0_gpu2_layer5_exp8 -> agg_pp1_dp0_gpu2_layer5
	expert_pp1_dp0_gpu2_layer5_exp9 -> agg_pp1_dp0_gpu2_layer5
	expert_pp1_dp0_gpu2_layer5_exp10 -> agg_pp1_dp0_gpu2_layer5
	expert_pp1_dp0_gpu2_layer5_exp11 -> agg_pp1_dp0_gpu2_layer5
	agg_pp1_dp0_gpu2_layer5 -> attn_pp1_dp0_gpu2_layer6
	attn_pp1_dp0_gpu2_layer6 -> route_pp1_dp0_gpu2_layer6
	route_pp1_dp0_gpu2_layer6 -> expert_pp1_dp0_gpu2_layer6_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp0_gpu2_layer6 -> expert_pp1_dp0_gpu2_layer6_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp0_gpu2_layer6 -> expert_pp1_dp0_gpu2_layer6_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp0_gpu2_layer6 -> expert_pp1_dp0_gpu2_layer6_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp0_gpu2_layer6_exp8 -> agg_pp1_dp0_gpu2_layer6
	expert_pp1_dp0_gpu2_layer6_exp9 -> agg_pp1_dp0_gpu2_layer6
	expert_pp1_dp0_gpu2_layer6_exp10 -> agg_pp1_dp0_gpu2_layer6
	expert_pp1_dp0_gpu2_layer6_exp11 -> agg_pp1_dp0_gpu2_layer6
	agg_pp1_dp0_gpu2_layer6 -> attn_pp1_dp0_gpu2_layer7
	attn_pp1_dp0_gpu2_layer7 -> route_pp1_dp0_gpu2_layer7
	route_pp1_dp0_gpu2_layer7 -> expert_pp1_dp0_gpu2_layer7_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp0_gpu2_layer7 -> expert_pp1_dp0_gpu2_layer7_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp0_gpu2_layer7 -> expert_pp1_dp0_gpu2_layer7_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp0_gpu2_layer7 -> expert_pp1_dp0_gpu2_layer7_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp0_gpu2_layer7_exp8 -> agg_pp1_dp0_gpu2_layer7
	expert_pp1_dp0_gpu2_layer7_exp9 -> agg_pp1_dp0_gpu2_layer7
	expert_pp1_dp0_gpu2_layer7_exp10 -> agg_pp1_dp0_gpu2_layer7
	expert_pp1_dp0_gpu2_layer7_exp11 -> agg_pp1_dp0_gpu2_layer7
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu2 [label="P2P Comm\nStage 1->2\nGPU 18\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu2_layer7 -> comm_pp1_to_pp2_dp0_gpu2
	comm_pp1_to_pp2_dp0_gpu2 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp0_gpu3_layer4 -> route_pp1_dp0_gpu3_layer4
	route_pp1_dp0_gpu3_layer4 -> expert_pp1_dp0_gpu3_layer4_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp0_gpu3_layer4 -> expert_pp1_dp0_gpu3_layer4_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp0_gpu3_layer4 -> expert_pp1_dp0_gpu3_layer4_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp0_gpu3_layer4 -> expert_pp1_dp0_gpu3_layer4_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp0_gpu3_layer4_exp12 -> agg_pp1_dp0_gpu3_layer4
	expert_pp1_dp0_gpu3_layer4_exp13 -> agg_pp1_dp0_gpu3_layer4
	expert_pp1_dp0_gpu3_layer4_exp14 -> agg_pp1_dp0_gpu3_layer4
	expert_pp1_dp0_gpu3_layer4_exp15 -> agg_pp1_dp0_gpu3_layer4
	agg_pp1_dp0_gpu3_layer4 -> attn_pp1_dp0_gpu3_layer5
	attn_pp1_dp0_gpu3_layer5 -> route_pp1_dp0_gpu3_layer5
	route_pp1_dp0_gpu3_layer5 -> expert_pp1_dp0_gpu3_layer5_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp0_gpu3_layer5 -> expert_pp1_dp0_gpu3_layer5_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp0_gpu3_layer5 -> expert_pp1_dp0_gpu3_layer5_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp0_gpu3_layer5 -> expert_pp1_dp0_gpu3_layer5_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp0_gpu3_layer5_exp12 -> agg_pp1_dp0_gpu3_layer5
	expert_pp1_dp0_gpu3_layer5_exp13 -> agg_pp1_dp0_gpu3_layer5
	expert_pp1_dp0_gpu3_layer5_exp14 -> agg_pp1_dp0_gpu3_layer5
	expert_pp1_dp0_gpu3_layer5_exp15 -> agg_pp1_dp0_gpu3_layer5
	agg_pp1_dp0_gpu3_layer5 -> attn_pp1_dp0_gpu3_layer6
	attn_pp1_dp0_gpu3_layer6 -> route_pp1_dp0_gpu3_layer6
	route_pp1_dp0_gpu3_layer6 -> expert_pp1_dp0_gpu3_layer6_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp0_gpu3_layer6 -> expert_pp1_dp0_gpu3_layer6_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp0_gpu3_layer6 -> expert_pp1_dp0_gpu3_layer6_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp0_gpu3_layer6 -> expert_pp1_dp0_gpu3_layer6_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp0_gpu3_layer6_exp12 -> agg_pp1_dp0_gpu3_layer6
	expert_pp1_dp0_gpu3_layer6_exp13 -> agg_pp1_dp0_gpu3_layer6
	expert_pp1_dp0_gpu3_layer6_exp14 -> agg_pp1_dp0_gpu3_layer6
	expert_pp1_dp0_gpu3_layer6_exp15 -> agg_pp1_dp0_gpu3_layer6
	agg_pp1_dp0_gpu3_layer6 -> attn_pp1_dp0_gpu3_layer7
	attn_pp1_dp0_gpu3_layer7 -> route_pp1_dp0_gpu3_layer7
	route_pp1_dp0_gpu3_layer7 -> expert_pp1_dp0_gpu3_layer7_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp0_gpu3_layer7 -> expert_pp1_dp0_gpu3_layer7_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp0_gpu3_layer7 -> expert_pp1_dp0_gpu3_layer7_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp0_gpu3_layer7 -> expert_pp1_dp0_gpu3_layer7_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp0_gpu3_layer7_exp12 -> agg_pp1_dp0_gpu3_layer7
	expert_pp1_dp0_gpu3_layer7_exp13 -> agg_pp1_dp0_gpu3_layer7
	expert_pp1_dp0_gpu3_layer7_exp14 -> agg_pp1_dp0_gpu3_layer7
	expert_pp1_dp0_gpu3_layer7_exp15 -> agg_pp1_dp0_gpu3_layer7
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp0_gpu3 [label="P2P Comm\nStage 1->2\nGPU 19\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp0_gpu3_layer7 -> comm_pp1_to_pp2_dp0_gpu3
	comm_pp1_to_pp2_dp0_gpu3 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp1_gpu0_layer4 -> route_pp1_dp1_gpu0_layer4
	route_pp1_dp1_gpu0_layer4 -> expert_pp1_dp1_gpu0_layer4_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp1_gpu0_layer4 -> expert_pp1_dp1_gpu0_layer4_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp1_gpu0_layer4 -> expert_pp1_dp1_gpu0_layer4_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp1_gpu0_layer4 -> expert_pp1_dp1_gpu0_layer4_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp1_gpu0_layer4_exp0 -> agg_pp1_dp1_gpu0_layer4
	expert_pp1_dp1_gpu0_layer4_exp1 -> agg_pp1_dp1_gpu0_layer4
	expert_pp1_dp1_gpu0_layer4_exp2 -> agg_pp1_dp1_gpu0_layer4
	expert_pp1_dp1_gpu0_layer4_exp3 -> agg_pp1_dp1_gpu0_layer4
	agg_pp1_dp1_gpu0_layer4 -> attn_pp1_dp1_gpu0_layer5
	attn_pp1_dp1_gpu0_layer5 -> route_pp1_dp1_gpu0_layer5
	route_pp1_dp1_gpu0_layer5 -> expert_pp1_dp1_gpu0_layer5_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp1_gpu0_layer5 -> expert_pp1_dp1_gpu0_layer5_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp1_gpu0_layer5 -> expert_pp1_dp1_gpu0_layer5_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp1_gpu0_layer5 -> expert_pp1_dp1_gpu0_layer5_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp1_gpu0_layer5_exp0 -> agg_pp1_dp1_gpu0_layer5
	expert_pp1_dp1_gpu0_layer5_exp1 -> agg_pp1_dp1_gpu0_layer5
	expert_pp1_dp1_gpu0_layer5_exp2 -> agg_pp1_dp1_gpu0_layer5
	expert_pp1_dp1_gpu0_layer5_exp3 -> agg_pp1_dp1_gpu0_layer5
	agg_pp1_dp1_gpu0_layer5 -> attn_pp1_dp1_gpu0_layer6
	attn_pp1_dp1_gpu0_layer6 -> route_pp1_dp1_gpu0_layer6
	route_pp1_dp1_gpu0_layer6 -> expert_pp1_dp1_gpu0_layer6_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp1_gpu0_layer6 -> expert_pp1_dp1_gpu0_layer6_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp1_gpu0_layer6 -> expert_pp1_dp1_gpu0_layer6_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp1_gpu0_layer6 -> expert_pp1_dp1_gpu0_layer6_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp1_gpu0_layer6_exp0 -> agg_pp1_dp1_gpu0_layer6
	expert_pp1_dp1_gpu0_layer6_exp1 -> agg_pp1_dp1_gpu0_layer6
	expert_pp1_dp1_gpu0_layer6_exp2 -> agg_pp1_dp1_gpu0_layer6
	expert_pp1_dp1_gpu0_layer6_exp3 -> agg_pp1_dp1_gpu0_layer6
	agg_pp1_dp1_gpu0_layer6 -> attn_pp1_dp1_gpu0_layer7
	attn_pp1_dp1_gpu0_layer7 -> route_pp1_dp1_gpu0_layer7
	route_pp1_dp1_gpu0_layer7 -> expert_pp1_dp1_gpu0_layer7_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp1_gpu0_layer7 -> expert_pp1_dp1_gpu0_layer7_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp1_gpu0_layer7 -> expert_pp1_dp1_gpu0_layer7_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp1_gpu0_layer7 -> expert_pp1_dp1_gpu0_layer7_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp1_gpu0_layer7_exp0 -> agg_pp1_dp1_gpu0_layer7
	expert_pp1_dp1_gpu0_layer7_exp1 -> agg_pp1_dp1_gpu0_layer7
	expert_pp1_dp1_gpu0_layer7_exp2 -> agg_pp1_dp1_gpu0_layer7
	expert_pp1_dp1_gpu0_layer7_exp3 -> agg_pp1_dp1_gpu0_layer7
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu0 [label="P2P Comm\nStage 1->2\nGPU 20\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu0_layer7 -> comm_pp1_to_pp2_dp1_gpu0
	comm_pp1_to_pp2_dp1_gpu0 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp1_gpu1_layer4 -> route_pp1_dp1_gpu1_layer4
	route_pp1_dp1_gpu1_layer4 -> expert_pp1_dp1_gpu1_layer4_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp1_gpu1_layer4 -> expert_pp1_dp1_gpu1_layer4_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp1_gpu1_layer4 -> expert_pp1_dp1_gpu1_layer4_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp1_gpu1_layer4 -> expert_pp1_dp1_gpu1_layer4_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp1_gpu1_layer4_exp4 -> agg_pp1_dp1_gpu1_layer4
	expert_pp1_dp1_gpu1_layer4_exp5 -> agg_pp1_dp1_gpu1_layer4
	expert_pp1_dp1_gpu1_layer4_exp6 -> agg_pp1_dp1_gpu1_layer4
	expert_pp1_dp1_gpu1_layer4_exp7 -> agg_pp1_dp1_gpu1_layer4
	agg_pp1_dp1_gpu1_layer4 -> attn_pp1_dp1_gpu1_layer5
	attn_pp1_dp1_gpu1_layer5 -> route_pp1_dp1_gpu1_layer5
	route_pp1_dp1_gpu1_layer5 -> expert_pp1_dp1_gpu1_layer5_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp1_gpu1_layer5 -> expert_pp1_dp1_gpu1_layer5_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp1_gpu1_layer5 -> expert_pp1_dp1_gpu1_layer5_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp1_gpu1_layer5 -> expert_pp1_dp1_gpu1_layer5_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp1_gpu1_layer5_exp4 -> agg_pp1_dp1_gpu1_layer5
	expert_pp1_dp1_gpu1_layer5_exp5 -> agg_pp1_dp1_gpu1_layer5
	expert_pp1_dp1_gpu1_layer5_exp6 -> agg_pp1_dp1_gpu1_layer5
	expert_pp1_dp1_gpu1_layer5_exp7 -> agg_pp1_dp1_gpu1_layer5
	agg_pp1_dp1_gpu1_layer5 -> attn_pp1_dp1_gpu1_layer6
	attn_pp1_dp1_gpu1_layer6 -> route_pp1_dp1_gpu1_layer6
	route_pp1_dp1_gpu1_layer6 -> expert_pp1_dp1_gpu1_layer6_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp1_gpu1_layer6 -> expert_pp1_dp1_gpu1_layer6_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp1_gpu1_layer6 -> expert_pp1_dp1_gpu1_layer6_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp1_gpu1_layer6 -> expert_pp1_dp1_gpu1_layer6_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp1_gpu1_layer6_exp4 -> agg_pp1_dp1_gpu1_layer6
	expert_pp1_dp1_gpu1_layer6_exp5 -> agg_pp1_dp1_gpu1_layer6
	expert_pp1_dp1_gpu1_layer6_exp6 -> agg_pp1_dp1_gpu1_layer6
	expert_pp1_dp1_gpu1_layer6_exp7 -> agg_pp1_dp1_gpu1_layer6
	agg_pp1_dp1_gpu1_layer6 -> attn_pp1_dp1_gpu1_layer7
	attn_pp1_dp1_gpu1_layer7 -> route_pp1_dp1_gpu1_layer7
	route_pp1_dp1_gpu1_layer7 -> expert_pp1_dp1_gpu1_layer7_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp1_gpu1_layer7 -> expert_pp1_dp1_gpu1_layer7_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp1_gpu1_layer7 -> expert_pp1_dp1_gpu1_layer7_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp1_gpu1_layer7 -> expert_pp1_dp1_gpu1_layer7_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp1_gpu1_layer7_exp4 -> agg_pp1_dp1_gpu1_layer7
	expert_pp1_dp1_gpu1_layer7_exp5 -> agg_pp1_dp1_gpu1_layer7
	expert_pp1_dp1_gpu1_layer7_exp6 -> agg_pp1_dp1_gpu1_layer7
	expert_pp1_dp1_gpu1_layer7_exp7 -> agg_pp1_dp1_gpu1_layer7
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu1 [label="P2P Comm\nStage 1->2\nGPU 21\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu1_layer7 -> comm_pp1_to_pp2_dp1_gpu1
	comm_pp1_to_pp2_dp1_gpu1 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp1_gpu2_layer4 -> route_pp1_dp1_gpu2_layer4
	route_pp1_dp1_gpu2_layer4 -> expert_pp1_dp1_gpu2_layer4_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp1_gpu2_layer4 -> expert_pp1_dp1_gpu2_layer4_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp1_gpu2_layer4 -> expert_pp1_dp1_gpu2_layer4_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp1_gpu2_layer4 -> expert_pp1_dp1_gpu2_layer4_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp1_gpu2_layer4_exp8 -> agg_pp1_dp1_gpu2_layer4
	expert_pp1_dp1_gpu2_layer4_exp9 -> agg_pp1_dp1_gpu2_layer4
	expert_pp1_dp1_gpu2_layer4_exp10 -> agg_pp1_dp1_gpu2_layer4
	expert_pp1_dp1_gpu2_layer4_exp11 -> agg_pp1_dp1_gpu2_layer4
	agg_pp1_dp1_gpu2_layer4 -> attn_pp1_dp1_gpu2_layer5
	attn_pp1_dp1_gpu2_layer5 -> route_pp1_dp1_gpu2_layer5
	route_pp1_dp1_gpu2_layer5 -> expert_pp1_dp1_gpu2_layer5_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp1_gpu2_layer5 -> expert_pp1_dp1_gpu2_layer5_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp1_gpu2_layer5 -> expert_pp1_dp1_gpu2_layer5_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp1_gpu2_layer5 -> expert_pp1_dp1_gpu2_layer5_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp1_gpu2_layer5_exp8 -> agg_pp1_dp1_gpu2_layer5
	expert_pp1_dp1_gpu2_layer5_exp9 -> agg_pp1_dp1_gpu2_layer5
	expert_pp1_dp1_gpu2_layer5_exp10 -> agg_pp1_dp1_gpu2_layer5
	expert_pp1_dp1_gpu2_layer5_exp11 -> agg_pp1_dp1_gpu2_layer5
	agg_pp1_dp1_gpu2_layer5 -> attn_pp1_dp1_gpu2_layer6
	attn_pp1_dp1_gpu2_layer6 -> route_pp1_dp1_gpu2_layer6
	route_pp1_dp1_gpu2_layer6 -> expert_pp1_dp1_gpu2_layer6_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp1_gpu2_layer6 -> expert_pp1_dp1_gpu2_layer6_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp1_gpu2_layer6 -> expert_pp1_dp1_gpu2_layer6_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp1_gpu2_layer6 -> expert_pp1_dp1_gpu2_layer6_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp1_gpu2_layer6_exp8 -> agg_pp1_dp1_gpu2_layer6
	expert_pp1_dp1_gpu2_layer6_exp9 -> agg_pp1_dp1_gpu2_layer6
	expert_pp1_dp1_gpu2_layer6_exp10 -> agg_pp1_dp1_gpu2_layer6
	expert_pp1_dp1_gpu2_layer6_exp11 -> agg_pp1_dp1_gpu2_layer6
	agg_pp1_dp1_gpu2_layer6 -> attn_pp1_dp1_gpu2_layer7
	attn_pp1_dp1_gpu2_layer7 -> route_pp1_dp1_gpu2_layer7
	route_pp1_dp1_gpu2_layer7 -> expert_pp1_dp1_gpu2_layer7_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp1_gpu2_layer7 -> expert_pp1_dp1_gpu2_layer7_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp1_gpu2_layer7 -> expert_pp1_dp1_gpu2_layer7_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp1_gpu2_layer7 -> expert_pp1_dp1_gpu2_layer7_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp1_gpu2_layer7_exp8 -> agg_pp1_dp1_gpu2_layer7
	expert_pp1_dp1_gpu2_layer7_exp9 -> agg_pp1_dp1_gpu2_layer7
	expert_pp1_dp1_gpu2_layer7_exp10 -> agg_pp1_dp1_gpu2_layer7
	expert_pp1_dp1_gpu2_layer7_exp11 -> agg_pp1_dp1_gpu2_layer7
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu2 [label="P2P Comm\nStage 1->2\nGPU 22\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu2_layer7 -> comm_pp1_to_pp2_dp1_gpu2
	comm_pp1_to_pp2_dp1_gpu2 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp1_gpu3_layer4 -> route_pp1_dp1_gpu3_layer4
	route_pp1_dp1_gpu3_layer4 -> expert_pp1_dp1_gpu3_layer4_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp1_gpu3_layer4 -> expert_pp1_dp1_gpu3_layer4_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp1_gpu3_layer4 -> expert_pp1_dp1_gpu3_layer4_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp1_gpu3_layer4 -> expert_pp1_dp1_gpu3_layer4_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp1_gpu3_layer4_exp12 -> agg_pp1_dp1_gpu3_layer4
	expert_pp1_dp1_gpu3_layer4_exp13 -> agg_pp1_dp1_gpu3_layer4
	expert_pp1_dp1_gpu3_layer4_exp14 -> agg_pp1_dp1_gpu3_layer4
	expert_pp1_dp1_gpu3_layer4_exp15 -> agg_pp1_dp1_gpu3_layer4
	agg_pp1_dp1_gpu3_layer4 -> attn_pp1_dp1_gpu3_layer5
	attn_pp1_dp1_gpu3_layer5 -> route_pp1_dp1_gpu3_layer5
	route_pp1_dp1_gpu3_layer5 -> expert_pp1_dp1_gpu3_layer5_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp1_gpu3_layer5 -> expert_pp1_dp1_gpu3_layer5_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp1_gpu3_layer5 -> expert_pp1_dp1_gpu3_layer5_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp1_gpu3_layer5 -> expert_pp1_dp1_gpu3_layer5_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp1_gpu3_layer5_exp12 -> agg_pp1_dp1_gpu3_layer5
	expert_pp1_dp1_gpu3_layer5_exp13 -> agg_pp1_dp1_gpu3_layer5
	expert_pp1_dp1_gpu3_layer5_exp14 -> agg_pp1_dp1_gpu3_layer5
	expert_pp1_dp1_gpu3_layer5_exp15 -> agg_pp1_dp1_gpu3_layer5
	agg_pp1_dp1_gpu3_layer5 -> attn_pp1_dp1_gpu3_layer6
	attn_pp1_dp1_gpu3_layer6 -> route_pp1_dp1_gpu3_layer6
	route_pp1_dp1_gpu3_layer6 -> expert_pp1_dp1_gpu3_layer6_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp1_gpu3_layer6 -> expert_pp1_dp1_gpu3_layer6_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp1_gpu3_layer6 -> expert_pp1_dp1_gpu3_layer6_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp1_gpu3_layer6 -> expert_pp1_dp1_gpu3_layer6_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp1_gpu3_layer6_exp12 -> agg_pp1_dp1_gpu3_layer6
	expert_pp1_dp1_gpu3_layer6_exp13 -> agg_pp1_dp1_gpu3_layer6
	expert_pp1_dp1_gpu3_layer6_exp14 -> agg_pp1_dp1_gpu3_layer6
	expert_pp1_dp1_gpu3_layer6_exp15 -> agg_pp1_dp1_gpu3_layer6
	agg_pp1_dp1_gpu3_layer6 -> attn_pp1_dp1_gpu3_layer7
	attn_pp1_dp1_gpu3_layer7 -> route_pp1_dp1_gpu3_layer7
	route_pp1_dp1_gpu3_layer7 -> expert_pp1_dp1_gpu3_layer7_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp1_gpu3_layer7 -> expert_pp1_dp1_gpu3_layer7_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp1_gpu3_layer7 -> expert_pp1_dp1_gpu3_layer7_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp1_gpu3_layer7 -> expert_pp1_dp1_gpu3_layer7_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp1_gpu3_layer7_exp12 -> agg_pp1_dp1_gpu3_layer7
	expert_pp1_dp1_gpu3_layer7_exp13 -> agg_pp1_dp1_gpu3_layer7
	expert_pp1_dp1_gpu3_layer7_exp14 -> agg_pp1_dp1_gpu3_layer7
	expert_pp1_dp1_gpu3_layer7_exp15 -> agg_pp1_dp1_gpu3_layer7
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp1_gpu3 [label="P2P Comm\nStage 1->2\nGPU 23\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp1_gpu3_layer7 -> comm_pp1_to_pp2_dp1_gpu3
	comm_pp1_to_pp2_dp1_gpu3 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp2_gpu0_layer4 -> route_pp1_dp2_gpu0_layer4
	route_pp1_dp2_gpu0_layer4 -> expert_pp1_dp2_gpu0_layer4_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp2_gpu0_layer4 -> expert_pp1_dp2_gpu0_layer4_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp2_gpu0_layer4 -> expert_pp1_dp2_gpu0_layer4_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp2_gpu0_layer4 -> expert_pp1_dp2_gpu0_layer4_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp2_gpu0_layer4_exp0 -> agg_pp1_dp2_gpu0_layer4
	expert_pp1_dp2_gpu0_layer4_exp1 -> agg_pp1_dp2_gpu0_layer4
	expert_pp1_dp2_gpu0_layer4_exp2 -> agg_pp1_dp2_gpu0_layer4
	expert_pp1_dp2_gpu0_layer4_exp3 -> agg_pp1_dp2_gpu0_layer4
	agg_pp1_dp2_gpu0_layer4 -> attn_pp1_dp2_gpu0_layer5
	attn_pp1_dp2_gpu0_layer5 -> route_pp1_dp2_gpu0_layer5
	route_pp1_dp2_gpu0_layer5 -> expert_pp1_dp2_gpu0_layer5_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp2_gpu0_layer5 -> expert_pp1_dp2_gpu0_layer5_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp2_gpu0_layer5 -> expert_pp1_dp2_gpu0_layer5_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp2_gpu0_layer5 -> expert_pp1_dp2_gpu0_layer5_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp2_gpu0_layer5_exp0 -> agg_pp1_dp2_gpu0_layer5
	expert_pp1_dp2_gpu0_layer5_exp1 -> agg_pp1_dp2_gpu0_layer5
	expert_pp1_dp2_gpu0_layer5_exp2 -> agg_pp1_dp2_gpu0_layer5
	expert_pp1_dp2_gpu0_layer5_exp3 -> agg_pp1_dp2_gpu0_layer5
	agg_pp1_dp2_gpu0_layer5 -> attn_pp1_dp2_gpu0_layer6
	attn_pp1_dp2_gpu0_layer6 -> route_pp1_dp2_gpu0_layer6
	route_pp1_dp2_gpu0_layer6 -> expert_pp1_dp2_gpu0_layer6_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp2_gpu0_layer6 -> expert_pp1_dp2_gpu0_layer6_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp2_gpu0_layer6 -> expert_pp1_dp2_gpu0_layer6_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp2_gpu0_layer6 -> expert_pp1_dp2_gpu0_layer6_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp2_gpu0_layer6_exp0 -> agg_pp1_dp2_gpu0_layer6
	expert_pp1_dp2_gpu0_layer6_exp1 -> agg_pp1_dp2_gpu0_layer6
	expert_pp1_dp2_gpu0_layer6_exp2 -> agg_pp1_dp2_gpu0_layer6
	expert_pp1_dp2_gpu0_layer6_exp3 -> agg_pp1_dp2_gpu0_layer6
	agg_pp1_dp2_gpu0_layer6 -> attn_pp1_dp2_gpu0_layer7
	attn_pp1_dp2_gpu0_layer7 -> route_pp1_dp2_gpu0_layer7
	route_pp1_dp2_gpu0_layer7 -> expert_pp1_dp2_gpu0_layer7_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp2_gpu0_layer7 -> expert_pp1_dp2_gpu0_layer7_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp2_gpu0_layer7 -> expert_pp1_dp2_gpu0_layer7_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp2_gpu0_layer7 -> expert_pp1_dp2_gpu0_layer7_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp2_gpu0_layer7_exp0 -> agg_pp1_dp2_gpu0_layer7
	expert_pp1_dp2_gpu0_layer7_exp1 -> agg_pp1_dp2_gpu0_layer7
	expert_pp1_dp2_gpu0_layer7_exp2 -> agg_pp1_dp2_gpu0_layer7
	expert_pp1_dp2_gpu0_layer7_exp3 -> agg_pp1_dp2_gpu0_layer7
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu0 [label="P2P Comm\nStage 1->2\nGPU 24\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu0_layer7 -> comm_pp1_to_pp2_dp2_gpu0
	comm_pp1_to_pp2_dp2_gpu0 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp2_gpu1_layer4 -> route_pp1_dp2_gpu1_layer4
	route_pp1_dp2_gpu1_layer4 -> expert_pp1_dp2_gpu1_layer4_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp2_gpu1_layer4 -> expert_pp1_dp2_gpu1_layer4_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp2_gpu1_layer4 -> expert_pp1_dp2_gpu1_layer4_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp2_gpu1_layer4 -> expert_pp1_dp2_gpu1_layer4_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp2_gpu1_layer4_exp4 -> agg_pp1_dp2_gpu1_layer4
	expert_pp1_dp2_gpu1_layer4_exp5 -> agg_pp1_dp2_gpu1_layer4
	expert_pp1_dp2_gpu1_layer4_exp6 -> agg_pp1_dp2_gpu1_layer4
	expert_pp1_dp2_gpu1_layer4_exp7 -> agg_pp1_dp2_gpu1_layer4
	agg_pp1_dp2_gpu1_layer4 -> attn_pp1_dp2_gpu1_layer5
	attn_pp1_dp2_gpu1_layer5 -> route_pp1_dp2_gpu1_layer5
	route_pp1_dp2_gpu1_layer5 -> expert_pp1_dp2_gpu1_layer5_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp2_gpu1_layer5 -> expert_pp1_dp2_gpu1_layer5_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp2_gpu1_layer5 -> expert_pp1_dp2_gpu1_layer5_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp2_gpu1_layer5 -> expert_pp1_dp2_gpu1_layer5_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp2_gpu1_layer5_exp4 -> agg_pp1_dp2_gpu1_layer5
	expert_pp1_dp2_gpu1_layer5_exp5 -> agg_pp1_dp2_gpu1_layer5
	expert_pp1_dp2_gpu1_layer5_exp6 -> agg_pp1_dp2_gpu1_layer5
	expert_pp1_dp2_gpu1_layer5_exp7 -> agg_pp1_dp2_gpu1_layer5
	agg_pp1_dp2_gpu1_layer5 -> attn_pp1_dp2_gpu1_layer6
	attn_pp1_dp2_gpu1_layer6 -> route_pp1_dp2_gpu1_layer6
	route_pp1_dp2_gpu1_layer6 -> expert_pp1_dp2_gpu1_layer6_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp2_gpu1_layer6 -> expert_pp1_dp2_gpu1_layer6_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp2_gpu1_layer6 -> expert_pp1_dp2_gpu1_layer6_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp2_gpu1_layer6 -> expert_pp1_dp2_gpu1_layer6_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp2_gpu1_layer6_exp4 -> agg_pp1_dp2_gpu1_layer6
	expert_pp1_dp2_gpu1_layer6_exp5 -> agg_pp1_dp2_gpu1_layer6
	expert_pp1_dp2_gpu1_layer6_exp6 -> agg_pp1_dp2_gpu1_layer6
	expert_pp1_dp2_gpu1_layer6_exp7 -> agg_pp1_dp2_gpu1_layer6
	agg_pp1_dp2_gpu1_layer6 -> attn_pp1_dp2_gpu1_layer7
	attn_pp1_dp2_gpu1_layer7 -> route_pp1_dp2_gpu1_layer7
	route_pp1_dp2_gpu1_layer7 -> expert_pp1_dp2_gpu1_layer7_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp2_gpu1_layer7 -> expert_pp1_dp2_gpu1_layer7_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp2_gpu1_layer7 -> expert_pp1_dp2_gpu1_layer7_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp2_gpu1_layer7 -> expert_pp1_dp2_gpu1_layer7_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp2_gpu1_layer7_exp4 -> agg_pp1_dp2_gpu1_layer7
	expert_pp1_dp2_gpu1_layer7_exp5 -> agg_pp1_dp2_gpu1_layer7
	expert_pp1_dp2_gpu1_layer7_exp6 -> agg_pp1_dp2_gpu1_layer7
	expert_pp1_dp2_gpu1_layer7_exp7 -> agg_pp1_dp2_gpu1_layer7
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu1 [label="P2P Comm\nStage 1->2\nGPU 25\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu1_layer7 -> comm_pp1_to_pp2_dp2_gpu1
	comm_pp1_to_pp2_dp2_gpu1 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp2_gpu2_layer4 -> route_pp1_dp2_gpu2_layer4
	route_pp1_dp2_gpu2_layer4 -> expert_pp1_dp2_gpu2_layer4_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp2_gpu2_layer4 -> expert_pp1_dp2_gpu2_layer4_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp2_gpu2_layer4 -> expert_pp1_dp2_gpu2_layer4_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp2_gpu2_layer4 -> expert_pp1_dp2_gpu2_layer4_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp2_gpu2_layer4_exp8 -> agg_pp1_dp2_gpu2_layer4
	expert_pp1_dp2_gpu2_layer4_exp9 -> agg_pp1_dp2_gpu2_layer4
	expert_pp1_dp2_gpu2_layer4_exp10 -> agg_pp1_dp2_gpu2_layer4
	expert_pp1_dp2_gpu2_layer4_exp11 -> agg_pp1_dp2_gpu2_layer4
	agg_pp1_dp2_gpu2_layer4 -> attn_pp1_dp2_gpu2_layer5
	attn_pp1_dp2_gpu2_layer5 -> route_pp1_dp2_gpu2_layer5
	route_pp1_dp2_gpu2_layer5 -> expert_pp1_dp2_gpu2_layer5_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp2_gpu2_layer5 -> expert_pp1_dp2_gpu2_layer5_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp2_gpu2_layer5 -> expert_pp1_dp2_gpu2_layer5_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp2_gpu2_layer5 -> expert_pp1_dp2_gpu2_layer5_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp2_gpu2_layer5_exp8 -> agg_pp1_dp2_gpu2_layer5
	expert_pp1_dp2_gpu2_layer5_exp9 -> agg_pp1_dp2_gpu2_layer5
	expert_pp1_dp2_gpu2_layer5_exp10 -> agg_pp1_dp2_gpu2_layer5
	expert_pp1_dp2_gpu2_layer5_exp11 -> agg_pp1_dp2_gpu2_layer5
	agg_pp1_dp2_gpu2_layer5 -> attn_pp1_dp2_gpu2_layer6
	attn_pp1_dp2_gpu2_layer6 -> route_pp1_dp2_gpu2_layer6
	route_pp1_dp2_gpu2_layer6 -> expert_pp1_dp2_gpu2_layer6_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp2_gpu2_layer6 -> expert_pp1_dp2_gpu2_layer6_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp2_gpu2_layer6 -> expert_pp1_dp2_gpu2_layer6_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp2_gpu2_layer6 -> expert_pp1_dp2_gpu2_layer6_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp2_gpu2_layer6_exp8 -> agg_pp1_dp2_gpu2_layer6
	expert_pp1_dp2_gpu2_layer6_exp9 -> agg_pp1_dp2_gpu2_layer6
	expert_pp1_dp2_gpu2_layer6_exp10 -> agg_pp1_dp2_gpu2_layer6
	expert_pp1_dp2_gpu2_layer6_exp11 -> agg_pp1_dp2_gpu2_layer6
	agg_pp1_dp2_gpu2_layer6 -> attn_pp1_dp2_gpu2_layer7
	attn_pp1_dp2_gpu2_layer7 -> route_pp1_dp2_gpu2_layer7
	route_pp1_dp2_gpu2_layer7 -> expert_pp1_dp2_gpu2_layer7_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp2_gpu2_layer7 -> expert_pp1_dp2_gpu2_layer7_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp2_gpu2_layer7 -> expert_pp1_dp2_gpu2_layer7_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp2_gpu2_layer7 -> expert_pp1_dp2_gpu2_layer7_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp2_gpu2_layer7_exp8 -> agg_pp1_dp2_gpu2_layer7
	expert_pp1_dp2_gpu2_layer7_exp9 -> agg_pp1_dp2_gpu2_layer7
	expert_pp1_dp2_gpu2_layer7_exp10 -> agg_pp1_dp2_gpu2_layer7
	expert_pp1_dp2_gpu2_layer7_exp11 -> agg_pp1_dp2_gpu2_layer7
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu2 [label="P2P Comm\nStage 1->2\nGPU 26\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu2_layer7 -> comm_pp1_to_pp2_dp2_gpu2
	comm_pp1_to_pp2_dp2_gpu2 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp2_gpu3_layer4 -> route_pp1_dp2_gpu3_layer4
	route_pp1_dp2_gpu3_layer4 -> expert_pp1_dp2_gpu3_layer4_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp2_gpu3_layer4 -> expert_pp1_dp2_gpu3_layer4_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp2_gpu3_layer4 -> expert_pp1_dp2_gpu3_layer4_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp2_gpu3_layer4 -> expert_pp1_dp2_gpu3_layer4_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp2_gpu3_layer4_exp12 -> agg_pp1_dp2_gpu3_layer4
	expert_pp1_dp2_gpu3_layer4_exp13 -> agg_pp1_dp2_gpu3_layer4
	expert_pp1_dp2_gpu3_layer4_exp14 -> agg_pp1_dp2_gpu3_layer4
	expert_pp1_dp2_gpu3_layer4_exp15 -> agg_pp1_dp2_gpu3_layer4
	agg_pp1_dp2_gpu3_layer4 -> attn_pp1_dp2_gpu3_layer5
	attn_pp1_dp2_gpu3_layer5 -> route_pp1_dp2_gpu3_layer5
	route_pp1_dp2_gpu3_layer5 -> expert_pp1_dp2_gpu3_layer5_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp2_gpu3_layer5 -> expert_pp1_dp2_gpu3_layer5_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp2_gpu3_layer5 -> expert_pp1_dp2_gpu3_layer5_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp2_gpu3_layer5 -> expert_pp1_dp2_gpu3_layer5_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp2_gpu3_layer5_exp12 -> agg_pp1_dp2_gpu3_layer5
	expert_pp1_dp2_gpu3_layer5_exp13 -> agg_pp1_dp2_gpu3_layer5
	expert_pp1_dp2_gpu3_layer5_exp14 -> agg_pp1_dp2_gpu3_layer5
	expert_pp1_dp2_gpu3_layer5_exp15 -> agg_pp1_dp2_gpu3_layer5
	agg_pp1_dp2_gpu3_layer5 -> attn_pp1_dp2_gpu3_layer6
	attn_pp1_dp2_gpu3_layer6 -> route_pp1_dp2_gpu3_layer6
	route_pp1_dp2_gpu3_layer6 -> expert_pp1_dp2_gpu3_layer6_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp2_gpu3_layer6 -> expert_pp1_dp2_gpu3_layer6_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp2_gpu3_layer6 -> expert_pp1_dp2_gpu3_layer6_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp2_gpu3_layer6 -> expert_pp1_dp2_gpu3_layer6_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp2_gpu3_layer6_exp12 -> agg_pp1_dp2_gpu3_layer6
	expert_pp1_dp2_gpu3_layer6_exp13 -> agg_pp1_dp2_gpu3_layer6
	expert_pp1_dp2_gpu3_layer6_exp14 -> agg_pp1_dp2_gpu3_layer6
	expert_pp1_dp2_gpu3_layer6_exp15 -> agg_pp1_dp2_gpu3_layer6
	agg_pp1_dp2_gpu3_layer6 -> attn_pp1_dp2_gpu3_layer7
	attn_pp1_dp2_gpu3_layer7 -> route_pp1_dp2_gpu3_layer7
	route_pp1_dp2_gpu3_layer7 -> expert_pp1_dp2_gpu3_layer7_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp2_gpu3_layer7 -> expert_pp1_dp2_gpu3_layer7_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp2_gpu3_layer7 -> expert_pp1_dp2_gpu3_layer7_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp2_gpu3_layer7 -> expert_pp1_dp2_gpu3_layer7_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp2_gpu3_layer7_exp12 -> agg_pp1_dp2_gpu3_layer7
	expert_pp1_dp2_gpu3_layer7_exp13 -> agg_pp1_dp2_gpu3_layer7
	expert_pp1_dp2_gpu3_layer7_exp14 -> agg_pp1_dp2_gpu3_layer7
	expert_pp1_dp2_gpu3_layer7_exp15 -> agg_pp1_dp2_gpu3_layer7
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp2_gpu3 [label="P2P Comm\nStage 1->2\nGPU 27\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp2_gpu3_layer7 -> comm_pp1_to_pp2_dp2_gpu3
	comm_pp1_to_pp2_dp2_gpu3 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp3_gpu0_layer4 -> route_pp1_dp3_gpu0_layer4
	route_pp1_dp3_gpu0_layer4 -> expert_pp1_dp3_gpu0_layer4_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp3_gpu0_layer4 -> expert_pp1_dp3_gpu0_layer4_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp3_gpu0_layer4 -> expert_pp1_dp3_gpu0_layer4_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp3_gpu0_layer4 -> expert_pp1_dp3_gpu0_layer4_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp3_gpu0_layer4_exp0 -> agg_pp1_dp3_gpu0_layer4
	expert_pp1_dp3_gpu0_layer4_exp1 -> agg_pp1_dp3_gpu0_layer4
	expert_pp1_dp3_gpu0_layer4_exp2 -> agg_pp1_dp3_gpu0_layer4
	expert_pp1_dp3_gpu0_layer4_exp3 -> agg_pp1_dp3_gpu0_layer4
	agg_pp1_dp3_gpu0_layer4 -> attn_pp1_dp3_gpu0_layer5
	attn_pp1_dp3_gpu0_layer5 -> route_pp1_dp3_gpu0_layer5
	route_pp1_dp3_gpu0_layer5 -> expert_pp1_dp3_gpu0_layer5_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp3_gpu0_layer5 -> expert_pp1_dp3_gpu0_layer5_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp3_gpu0_layer5 -> expert_pp1_dp3_gpu0_layer5_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp3_gpu0_layer5 -> expert_pp1_dp3_gpu0_layer5_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp3_gpu0_layer5_exp0 -> agg_pp1_dp3_gpu0_layer5
	expert_pp1_dp3_gpu0_layer5_exp1 -> agg_pp1_dp3_gpu0_layer5
	expert_pp1_dp3_gpu0_layer5_exp2 -> agg_pp1_dp3_gpu0_layer5
	expert_pp1_dp3_gpu0_layer5_exp3 -> agg_pp1_dp3_gpu0_layer5
	agg_pp1_dp3_gpu0_layer5 -> attn_pp1_dp3_gpu0_layer6
	attn_pp1_dp3_gpu0_layer6 -> route_pp1_dp3_gpu0_layer6
	route_pp1_dp3_gpu0_layer6 -> expert_pp1_dp3_gpu0_layer6_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp3_gpu0_layer6 -> expert_pp1_dp3_gpu0_layer6_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp3_gpu0_layer6 -> expert_pp1_dp3_gpu0_layer6_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp3_gpu0_layer6 -> expert_pp1_dp3_gpu0_layer6_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp3_gpu0_layer6_exp0 -> agg_pp1_dp3_gpu0_layer6
	expert_pp1_dp3_gpu0_layer6_exp1 -> agg_pp1_dp3_gpu0_layer6
	expert_pp1_dp3_gpu0_layer6_exp2 -> agg_pp1_dp3_gpu0_layer6
	expert_pp1_dp3_gpu0_layer6_exp3 -> agg_pp1_dp3_gpu0_layer6
	agg_pp1_dp3_gpu0_layer6 -> attn_pp1_dp3_gpu0_layer7
	attn_pp1_dp3_gpu0_layer7 -> route_pp1_dp3_gpu0_layer7
	route_pp1_dp3_gpu0_layer7 -> expert_pp1_dp3_gpu0_layer7_exp0 [label="Gated 0" style=dashed]
	route_pp1_dp3_gpu0_layer7 -> expert_pp1_dp3_gpu0_layer7_exp1 [label="Gated 1" style=dashed]
	route_pp1_dp3_gpu0_layer7 -> expert_pp1_dp3_gpu0_layer7_exp2 [label="Gated 2" style=dashed]
	route_pp1_dp3_gpu0_layer7 -> expert_pp1_dp3_gpu0_layer7_exp3 [label="Gated 3" style=dashed]
	expert_pp1_dp3_gpu0_layer7_exp0 -> agg_pp1_dp3_gpu0_layer7
	expert_pp1_dp3_gpu0_layer7_exp1 -> agg_pp1_dp3_gpu0_layer7
	expert_pp1_dp3_gpu0_layer7_exp2 -> agg_pp1_dp3_gpu0_layer7
	expert_pp1_dp3_gpu0_layer7_exp3 -> agg_pp1_dp3_gpu0_layer7
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu0 [label="P2P Comm\nStage 1->2\nGPU 28\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu0_layer7 -> comm_pp1_to_pp2_dp3_gpu0
	comm_pp1_to_pp2_dp3_gpu0 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp3_gpu1_layer4 -> route_pp1_dp3_gpu1_layer4
	route_pp1_dp3_gpu1_layer4 -> expert_pp1_dp3_gpu1_layer4_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp3_gpu1_layer4 -> expert_pp1_dp3_gpu1_layer4_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp3_gpu1_layer4 -> expert_pp1_dp3_gpu1_layer4_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp3_gpu1_layer4 -> expert_pp1_dp3_gpu1_layer4_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp3_gpu1_layer4_exp4 -> agg_pp1_dp3_gpu1_layer4
	expert_pp1_dp3_gpu1_layer4_exp5 -> agg_pp1_dp3_gpu1_layer4
	expert_pp1_dp3_gpu1_layer4_exp6 -> agg_pp1_dp3_gpu1_layer4
	expert_pp1_dp3_gpu1_layer4_exp7 -> agg_pp1_dp3_gpu1_layer4
	agg_pp1_dp3_gpu1_layer4 -> attn_pp1_dp3_gpu1_layer5
	attn_pp1_dp3_gpu1_layer5 -> route_pp1_dp3_gpu1_layer5
	route_pp1_dp3_gpu1_layer5 -> expert_pp1_dp3_gpu1_layer5_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp3_gpu1_layer5 -> expert_pp1_dp3_gpu1_layer5_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp3_gpu1_layer5 -> expert_pp1_dp3_gpu1_layer5_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp3_gpu1_layer5 -> expert_pp1_dp3_gpu1_layer5_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp3_gpu1_layer5_exp4 -> agg_pp1_dp3_gpu1_layer5
	expert_pp1_dp3_gpu1_layer5_exp5 -> agg_pp1_dp3_gpu1_layer5
	expert_pp1_dp3_gpu1_layer5_exp6 -> agg_pp1_dp3_gpu1_layer5
	expert_pp1_dp3_gpu1_layer5_exp7 -> agg_pp1_dp3_gpu1_layer5
	agg_pp1_dp3_gpu1_layer5 -> attn_pp1_dp3_gpu1_layer6
	attn_pp1_dp3_gpu1_layer6 -> route_pp1_dp3_gpu1_layer6
	route_pp1_dp3_gpu1_layer6 -> expert_pp1_dp3_gpu1_layer6_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp3_gpu1_layer6 -> expert_pp1_dp3_gpu1_layer6_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp3_gpu1_layer6 -> expert_pp1_dp3_gpu1_layer6_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp3_gpu1_layer6 -> expert_pp1_dp3_gpu1_layer6_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp3_gpu1_layer6_exp4 -> agg_pp1_dp3_gpu1_layer6
	expert_pp1_dp3_gpu1_layer6_exp5 -> agg_pp1_dp3_gpu1_layer6
	expert_pp1_dp3_gpu1_layer6_exp6 -> agg_pp1_dp3_gpu1_layer6
	expert_pp1_dp3_gpu1_layer6_exp7 -> agg_pp1_dp3_gpu1_layer6
	agg_pp1_dp3_gpu1_layer6 -> attn_pp1_dp3_gpu1_layer7
	attn_pp1_dp3_gpu1_layer7 -> route_pp1_dp3_gpu1_layer7
	route_pp1_dp3_gpu1_layer7 -> expert_pp1_dp3_gpu1_layer7_exp4 [label="Gated 4" style=dashed]
	route_pp1_dp3_gpu1_layer7 -> expert_pp1_dp3_gpu1_layer7_exp5 [label="Gated 5" style=dashed]
	route_pp1_dp3_gpu1_layer7 -> expert_pp1_dp3_gpu1_layer7_exp6 [label="Gated 6" style=dashed]
	route_pp1_dp3_gpu1_layer7 -> expert_pp1_dp3_gpu1_layer7_exp7 [label="Gated 7" style=dashed]
	expert_pp1_dp3_gpu1_layer7_exp4 -> agg_pp1_dp3_gpu1_layer7
	expert_pp1_dp3_gpu1_layer7_exp5 -> agg_pp1_dp3_gpu1_layer7
	expert_pp1_dp3_gpu1_layer7_exp6 -> agg_pp1_dp3_gpu1_layer7
	expert_pp1_dp3_gpu1_layer7_exp7 -> agg_pp1_dp3_gpu1_layer7
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu1 [label="P2P Comm\nStage 1->2\nGPU 29\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu1_layer7 -> comm_pp1_to_pp2_dp3_gpu1
	comm_pp1_to_pp2_dp3_gpu1 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp3_gpu2_layer4 -> route_pp1_dp3_gpu2_layer4
	route_pp1_dp3_gpu2_layer4 -> expert_pp1_dp3_gpu2_layer4_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp3_gpu2_layer4 -> expert_pp1_dp3_gpu2_layer4_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp3_gpu2_layer4 -> expert_pp1_dp3_gpu2_layer4_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp3_gpu2_layer4 -> expert_pp1_dp3_gpu2_layer4_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp3_gpu2_layer4_exp8 -> agg_pp1_dp3_gpu2_layer4
	expert_pp1_dp3_gpu2_layer4_exp9 -> agg_pp1_dp3_gpu2_layer4
	expert_pp1_dp3_gpu2_layer4_exp10 -> agg_pp1_dp3_gpu2_layer4
	expert_pp1_dp3_gpu2_layer4_exp11 -> agg_pp1_dp3_gpu2_layer4
	agg_pp1_dp3_gpu2_layer4 -> attn_pp1_dp3_gpu2_layer5
	attn_pp1_dp3_gpu2_layer5 -> route_pp1_dp3_gpu2_layer5
	route_pp1_dp3_gpu2_layer5 -> expert_pp1_dp3_gpu2_layer5_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp3_gpu2_layer5 -> expert_pp1_dp3_gpu2_layer5_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp3_gpu2_layer5 -> expert_pp1_dp3_gpu2_layer5_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp3_gpu2_layer5 -> expert_pp1_dp3_gpu2_layer5_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp3_gpu2_layer5_exp8 -> agg_pp1_dp3_gpu2_layer5
	expert_pp1_dp3_gpu2_layer5_exp9 -> agg_pp1_dp3_gpu2_layer5
	expert_pp1_dp3_gpu2_layer5_exp10 -> agg_pp1_dp3_gpu2_layer5
	expert_pp1_dp3_gpu2_layer5_exp11 -> agg_pp1_dp3_gpu2_layer5
	agg_pp1_dp3_gpu2_layer5 -> attn_pp1_dp3_gpu2_layer6
	attn_pp1_dp3_gpu2_layer6 -> route_pp1_dp3_gpu2_layer6
	route_pp1_dp3_gpu2_layer6 -> expert_pp1_dp3_gpu2_layer6_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp3_gpu2_layer6 -> expert_pp1_dp3_gpu2_layer6_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp3_gpu2_layer6 -> expert_pp1_dp3_gpu2_layer6_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp3_gpu2_layer6 -> expert_pp1_dp3_gpu2_layer6_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp3_gpu2_layer6_exp8 -> agg_pp1_dp3_gpu2_layer6
	expert_pp1_dp3_gpu2_layer6_exp9 -> agg_pp1_dp3_gpu2_layer6
	expert_pp1_dp3_gpu2_layer6_exp10 -> agg_pp1_dp3_gpu2_layer6
	expert_pp1_dp3_gpu2_layer6_exp11 -> agg_pp1_dp3_gpu2_layer6
	agg_pp1_dp3_gpu2_layer6 -> attn_pp1_dp3_gpu2_layer7
	attn_pp1_dp3_gpu2_layer7 -> route_pp1_dp3_gpu2_layer7
	route_pp1_dp3_gpu2_layer7 -> expert_pp1_dp3_gpu2_layer7_exp8 [label="Gated 8" style=dashed]
	route_pp1_dp3_gpu2_layer7 -> expert_pp1_dp3_gpu2_layer7_exp9 [label="Gated 9" style=dashed]
	route_pp1_dp3_gpu2_layer7 -> expert_pp1_dp3_gpu2_layer7_exp10 [label="Gated 10" style=dashed]
	route_pp1_dp3_gpu2_layer7 -> expert_pp1_dp3_gpu2_layer7_exp11 [label="Gated 11" style=dashed]
	expert_pp1_dp3_gpu2_layer7_exp8 -> agg_pp1_dp3_gpu2_layer7
	expert_pp1_dp3_gpu2_layer7_exp9 -> agg_pp1_dp3_gpu2_layer7
	expert_pp1_dp3_gpu2_layer7_exp10 -> agg_pp1_dp3_gpu2_layer7
	expert_pp1_dp3_gpu2_layer7_exp11 -> agg_pp1_dp3_gpu2_layer7
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu2 [label="P2P Comm\nStage 1->2\nGPU 30\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu2_layer7 -> comm_pp1_to_pp2_dp3_gpu2
	comm_pp1_to_pp2_dp3_gpu2 -> attn_pp2_dp3_gpu3_layer8
	attn_pp1_dp3_gpu3_layer4 -> route_pp1_dp3_gpu3_layer4
	route_pp1_dp3_gpu3_layer4 -> expert_pp1_dp3_gpu3_layer4_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp3_gpu3_layer4 -> expert_pp1_dp3_gpu3_layer4_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp3_gpu3_layer4 -> expert_pp1_dp3_gpu3_layer4_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp3_gpu3_layer4 -> expert_pp1_dp3_gpu3_layer4_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp3_gpu3_layer4_exp12 -> agg_pp1_dp3_gpu3_layer4
	expert_pp1_dp3_gpu3_layer4_exp13 -> agg_pp1_dp3_gpu3_layer4
	expert_pp1_dp3_gpu3_layer4_exp14 -> agg_pp1_dp3_gpu3_layer4
	expert_pp1_dp3_gpu3_layer4_exp15 -> agg_pp1_dp3_gpu3_layer4
	agg_pp1_dp3_gpu3_layer4 -> attn_pp1_dp3_gpu3_layer5
	attn_pp1_dp3_gpu3_layer5 -> route_pp1_dp3_gpu3_layer5
	route_pp1_dp3_gpu3_layer5 -> expert_pp1_dp3_gpu3_layer5_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp3_gpu3_layer5 -> expert_pp1_dp3_gpu3_layer5_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp3_gpu3_layer5 -> expert_pp1_dp3_gpu3_layer5_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp3_gpu3_layer5 -> expert_pp1_dp3_gpu3_layer5_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp3_gpu3_layer5_exp12 -> agg_pp1_dp3_gpu3_layer5
	expert_pp1_dp3_gpu3_layer5_exp13 -> agg_pp1_dp3_gpu3_layer5
	expert_pp1_dp3_gpu3_layer5_exp14 -> agg_pp1_dp3_gpu3_layer5
	expert_pp1_dp3_gpu3_layer5_exp15 -> agg_pp1_dp3_gpu3_layer5
	agg_pp1_dp3_gpu3_layer5 -> attn_pp1_dp3_gpu3_layer6
	attn_pp1_dp3_gpu3_layer6 -> route_pp1_dp3_gpu3_layer6
	route_pp1_dp3_gpu3_layer6 -> expert_pp1_dp3_gpu3_layer6_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp3_gpu3_layer6 -> expert_pp1_dp3_gpu3_layer6_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp3_gpu3_layer6 -> expert_pp1_dp3_gpu3_layer6_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp3_gpu3_layer6 -> expert_pp1_dp3_gpu3_layer6_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp3_gpu3_layer6_exp12 -> agg_pp1_dp3_gpu3_layer6
	expert_pp1_dp3_gpu3_layer6_exp13 -> agg_pp1_dp3_gpu3_layer6
	expert_pp1_dp3_gpu3_layer6_exp14 -> agg_pp1_dp3_gpu3_layer6
	expert_pp1_dp3_gpu3_layer6_exp15 -> agg_pp1_dp3_gpu3_layer6
	agg_pp1_dp3_gpu3_layer6 -> attn_pp1_dp3_gpu3_layer7
	attn_pp1_dp3_gpu3_layer7 -> route_pp1_dp3_gpu3_layer7
	route_pp1_dp3_gpu3_layer7 -> expert_pp1_dp3_gpu3_layer7_exp12 [label="Gated 12" style=dashed]
	route_pp1_dp3_gpu3_layer7 -> expert_pp1_dp3_gpu3_layer7_exp13 [label="Gated 13" style=dashed]
	route_pp1_dp3_gpu3_layer7 -> expert_pp1_dp3_gpu3_layer7_exp14 [label="Gated 14" style=dashed]
	route_pp1_dp3_gpu3_layer7 -> expert_pp1_dp3_gpu3_layer7_exp15 [label="Gated 15" style=dashed]
	expert_pp1_dp3_gpu3_layer7_exp12 -> agg_pp1_dp3_gpu3_layer7
	expert_pp1_dp3_gpu3_layer7_exp13 -> agg_pp1_dp3_gpu3_layer7
	expert_pp1_dp3_gpu3_layer7_exp14 -> agg_pp1_dp3_gpu3_layer7
	expert_pp1_dp3_gpu3_layer7_exp15 -> agg_pp1_dp3_gpu3_layer7
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp0_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp0_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp0_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp0_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp1_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp1_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp1_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp1_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp2_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp2_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp2_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp2_gpu3_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp3_gpu0_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp3_gpu1_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp3_gpu2_layer8
	comm_pp1_to_pp2_dp3_gpu3 [label="P2P Comm\nStage 1->2\nGPU 31\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp1_dp3_gpu3_layer7 -> comm_pp1_to_pp2_dp3_gpu3
	comm_pp1_to_pp2_dp3_gpu3 -> attn_pp2_dp3_gpu3_layer8
	attn_pp2_dp0_gpu0_layer8 -> route_pp2_dp0_gpu0_layer8
	route_pp2_dp0_gpu0_layer8 -> expert_pp2_dp0_gpu0_layer8_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp0_gpu0_layer8 -> expert_pp2_dp0_gpu0_layer8_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp0_gpu0_layer8 -> expert_pp2_dp0_gpu0_layer8_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp0_gpu0_layer8 -> expert_pp2_dp0_gpu0_layer8_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp0_gpu0_layer8_exp0 -> agg_pp2_dp0_gpu0_layer8
	expert_pp2_dp0_gpu0_layer8_exp1 -> agg_pp2_dp0_gpu0_layer8
	expert_pp2_dp0_gpu0_layer8_exp2 -> agg_pp2_dp0_gpu0_layer8
	expert_pp2_dp0_gpu0_layer8_exp3 -> agg_pp2_dp0_gpu0_layer8
	agg_pp2_dp0_gpu0_layer8 -> attn_pp2_dp0_gpu0_layer9
	attn_pp2_dp0_gpu0_layer9 -> route_pp2_dp0_gpu0_layer9
	route_pp2_dp0_gpu0_layer9 -> expert_pp2_dp0_gpu0_layer9_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp0_gpu0_layer9 -> expert_pp2_dp0_gpu0_layer9_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp0_gpu0_layer9 -> expert_pp2_dp0_gpu0_layer9_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp0_gpu0_layer9 -> expert_pp2_dp0_gpu0_layer9_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp0_gpu0_layer9_exp0 -> agg_pp2_dp0_gpu0_layer9
	expert_pp2_dp0_gpu0_layer9_exp1 -> agg_pp2_dp0_gpu0_layer9
	expert_pp2_dp0_gpu0_layer9_exp2 -> agg_pp2_dp0_gpu0_layer9
	expert_pp2_dp0_gpu0_layer9_exp3 -> agg_pp2_dp0_gpu0_layer9
	agg_pp2_dp0_gpu0_layer9 -> attn_pp2_dp0_gpu0_layer10
	attn_pp2_dp0_gpu0_layer10 -> route_pp2_dp0_gpu0_layer10
	route_pp2_dp0_gpu0_layer10 -> expert_pp2_dp0_gpu0_layer10_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp0_gpu0_layer10 -> expert_pp2_dp0_gpu0_layer10_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp0_gpu0_layer10 -> expert_pp2_dp0_gpu0_layer10_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp0_gpu0_layer10 -> expert_pp2_dp0_gpu0_layer10_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp0_gpu0_layer10_exp0 -> agg_pp2_dp0_gpu0_layer10
	expert_pp2_dp0_gpu0_layer10_exp1 -> agg_pp2_dp0_gpu0_layer10
	expert_pp2_dp0_gpu0_layer10_exp2 -> agg_pp2_dp0_gpu0_layer10
	expert_pp2_dp0_gpu0_layer10_exp3 -> agg_pp2_dp0_gpu0_layer10
	agg_pp2_dp0_gpu0_layer10 -> attn_pp2_dp0_gpu0_layer11
	attn_pp2_dp0_gpu0_layer11 -> route_pp2_dp0_gpu0_layer11
	route_pp2_dp0_gpu0_layer11 -> expert_pp2_dp0_gpu0_layer11_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp0_gpu0_layer11 -> expert_pp2_dp0_gpu0_layer11_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp0_gpu0_layer11 -> expert_pp2_dp0_gpu0_layer11_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp0_gpu0_layer11 -> expert_pp2_dp0_gpu0_layer11_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp0_gpu0_layer11_exp0 -> agg_pp2_dp0_gpu0_layer11
	expert_pp2_dp0_gpu0_layer11_exp1 -> agg_pp2_dp0_gpu0_layer11
	expert_pp2_dp0_gpu0_layer11_exp2 -> agg_pp2_dp0_gpu0_layer11
	expert_pp2_dp0_gpu0_layer11_exp3 -> agg_pp2_dp0_gpu0_layer11
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu0 [label="P2P Comm\nStage 2->3\nGPU 32\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu0_layer11 -> comm_pp2_to_pp3_dp0_gpu0
	comm_pp2_to_pp3_dp0_gpu0 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp0_gpu1_layer8 -> route_pp2_dp0_gpu1_layer8
	route_pp2_dp0_gpu1_layer8 -> expert_pp2_dp0_gpu1_layer8_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp0_gpu1_layer8 -> expert_pp2_dp0_gpu1_layer8_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp0_gpu1_layer8 -> expert_pp2_dp0_gpu1_layer8_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp0_gpu1_layer8 -> expert_pp2_dp0_gpu1_layer8_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp0_gpu1_layer8_exp4 -> agg_pp2_dp0_gpu1_layer8
	expert_pp2_dp0_gpu1_layer8_exp5 -> agg_pp2_dp0_gpu1_layer8
	expert_pp2_dp0_gpu1_layer8_exp6 -> agg_pp2_dp0_gpu1_layer8
	expert_pp2_dp0_gpu1_layer8_exp7 -> agg_pp2_dp0_gpu1_layer8
	agg_pp2_dp0_gpu1_layer8 -> attn_pp2_dp0_gpu1_layer9
	attn_pp2_dp0_gpu1_layer9 -> route_pp2_dp0_gpu1_layer9
	route_pp2_dp0_gpu1_layer9 -> expert_pp2_dp0_gpu1_layer9_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp0_gpu1_layer9 -> expert_pp2_dp0_gpu1_layer9_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp0_gpu1_layer9 -> expert_pp2_dp0_gpu1_layer9_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp0_gpu1_layer9 -> expert_pp2_dp0_gpu1_layer9_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp0_gpu1_layer9_exp4 -> agg_pp2_dp0_gpu1_layer9
	expert_pp2_dp0_gpu1_layer9_exp5 -> agg_pp2_dp0_gpu1_layer9
	expert_pp2_dp0_gpu1_layer9_exp6 -> agg_pp2_dp0_gpu1_layer9
	expert_pp2_dp0_gpu1_layer9_exp7 -> agg_pp2_dp0_gpu1_layer9
	agg_pp2_dp0_gpu1_layer9 -> attn_pp2_dp0_gpu1_layer10
	attn_pp2_dp0_gpu1_layer10 -> route_pp2_dp0_gpu1_layer10
	route_pp2_dp0_gpu1_layer10 -> expert_pp2_dp0_gpu1_layer10_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp0_gpu1_layer10 -> expert_pp2_dp0_gpu1_layer10_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp0_gpu1_layer10 -> expert_pp2_dp0_gpu1_layer10_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp0_gpu1_layer10 -> expert_pp2_dp0_gpu1_layer10_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp0_gpu1_layer10_exp4 -> agg_pp2_dp0_gpu1_layer10
	expert_pp2_dp0_gpu1_layer10_exp5 -> agg_pp2_dp0_gpu1_layer10
	expert_pp2_dp0_gpu1_layer10_exp6 -> agg_pp2_dp0_gpu1_layer10
	expert_pp2_dp0_gpu1_layer10_exp7 -> agg_pp2_dp0_gpu1_layer10
	agg_pp2_dp0_gpu1_layer10 -> attn_pp2_dp0_gpu1_layer11
	attn_pp2_dp0_gpu1_layer11 -> route_pp2_dp0_gpu1_layer11
	route_pp2_dp0_gpu1_layer11 -> expert_pp2_dp0_gpu1_layer11_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp0_gpu1_layer11 -> expert_pp2_dp0_gpu1_layer11_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp0_gpu1_layer11 -> expert_pp2_dp0_gpu1_layer11_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp0_gpu1_layer11 -> expert_pp2_dp0_gpu1_layer11_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp0_gpu1_layer11_exp4 -> agg_pp2_dp0_gpu1_layer11
	expert_pp2_dp0_gpu1_layer11_exp5 -> agg_pp2_dp0_gpu1_layer11
	expert_pp2_dp0_gpu1_layer11_exp6 -> agg_pp2_dp0_gpu1_layer11
	expert_pp2_dp0_gpu1_layer11_exp7 -> agg_pp2_dp0_gpu1_layer11
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu1 [label="P2P Comm\nStage 2->3\nGPU 33\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu1_layer11 -> comm_pp2_to_pp3_dp0_gpu1
	comm_pp2_to_pp3_dp0_gpu1 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp0_gpu2_layer8 -> route_pp2_dp0_gpu2_layer8
	route_pp2_dp0_gpu2_layer8 -> expert_pp2_dp0_gpu2_layer8_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp0_gpu2_layer8 -> expert_pp2_dp0_gpu2_layer8_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp0_gpu2_layer8 -> expert_pp2_dp0_gpu2_layer8_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp0_gpu2_layer8 -> expert_pp2_dp0_gpu2_layer8_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp0_gpu2_layer8_exp8 -> agg_pp2_dp0_gpu2_layer8
	expert_pp2_dp0_gpu2_layer8_exp9 -> agg_pp2_dp0_gpu2_layer8
	expert_pp2_dp0_gpu2_layer8_exp10 -> agg_pp2_dp0_gpu2_layer8
	expert_pp2_dp0_gpu2_layer8_exp11 -> agg_pp2_dp0_gpu2_layer8
	agg_pp2_dp0_gpu2_layer8 -> attn_pp2_dp0_gpu2_layer9
	attn_pp2_dp0_gpu2_layer9 -> route_pp2_dp0_gpu2_layer9
	route_pp2_dp0_gpu2_layer9 -> expert_pp2_dp0_gpu2_layer9_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp0_gpu2_layer9 -> expert_pp2_dp0_gpu2_layer9_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp0_gpu2_layer9 -> expert_pp2_dp0_gpu2_layer9_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp0_gpu2_layer9 -> expert_pp2_dp0_gpu2_layer9_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp0_gpu2_layer9_exp8 -> agg_pp2_dp0_gpu2_layer9
	expert_pp2_dp0_gpu2_layer9_exp9 -> agg_pp2_dp0_gpu2_layer9
	expert_pp2_dp0_gpu2_layer9_exp10 -> agg_pp2_dp0_gpu2_layer9
	expert_pp2_dp0_gpu2_layer9_exp11 -> agg_pp2_dp0_gpu2_layer9
	agg_pp2_dp0_gpu2_layer9 -> attn_pp2_dp0_gpu2_layer10
	attn_pp2_dp0_gpu2_layer10 -> route_pp2_dp0_gpu2_layer10
	route_pp2_dp0_gpu2_layer10 -> expert_pp2_dp0_gpu2_layer10_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp0_gpu2_layer10 -> expert_pp2_dp0_gpu2_layer10_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp0_gpu2_layer10 -> expert_pp2_dp0_gpu2_layer10_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp0_gpu2_layer10 -> expert_pp2_dp0_gpu2_layer10_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp0_gpu2_layer10_exp8 -> agg_pp2_dp0_gpu2_layer10
	expert_pp2_dp0_gpu2_layer10_exp9 -> agg_pp2_dp0_gpu2_layer10
	expert_pp2_dp0_gpu2_layer10_exp10 -> agg_pp2_dp0_gpu2_layer10
	expert_pp2_dp0_gpu2_layer10_exp11 -> agg_pp2_dp0_gpu2_layer10
	agg_pp2_dp0_gpu2_layer10 -> attn_pp2_dp0_gpu2_layer11
	attn_pp2_dp0_gpu2_layer11 -> route_pp2_dp0_gpu2_layer11
	route_pp2_dp0_gpu2_layer11 -> expert_pp2_dp0_gpu2_layer11_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp0_gpu2_layer11 -> expert_pp2_dp0_gpu2_layer11_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp0_gpu2_layer11 -> expert_pp2_dp0_gpu2_layer11_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp0_gpu2_layer11 -> expert_pp2_dp0_gpu2_layer11_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp0_gpu2_layer11_exp8 -> agg_pp2_dp0_gpu2_layer11
	expert_pp2_dp0_gpu2_layer11_exp9 -> agg_pp2_dp0_gpu2_layer11
	expert_pp2_dp0_gpu2_layer11_exp10 -> agg_pp2_dp0_gpu2_layer11
	expert_pp2_dp0_gpu2_layer11_exp11 -> agg_pp2_dp0_gpu2_layer11
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu2 [label="P2P Comm\nStage 2->3\nGPU 34\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu2_layer11 -> comm_pp2_to_pp3_dp0_gpu2
	comm_pp2_to_pp3_dp0_gpu2 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp0_gpu3_layer8 -> route_pp2_dp0_gpu3_layer8
	route_pp2_dp0_gpu3_layer8 -> expert_pp2_dp0_gpu3_layer8_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp0_gpu3_layer8 -> expert_pp2_dp0_gpu3_layer8_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp0_gpu3_layer8 -> expert_pp2_dp0_gpu3_layer8_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp0_gpu3_layer8 -> expert_pp2_dp0_gpu3_layer8_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp0_gpu3_layer8_exp12 -> agg_pp2_dp0_gpu3_layer8
	expert_pp2_dp0_gpu3_layer8_exp13 -> agg_pp2_dp0_gpu3_layer8
	expert_pp2_dp0_gpu3_layer8_exp14 -> agg_pp2_dp0_gpu3_layer8
	expert_pp2_dp0_gpu3_layer8_exp15 -> agg_pp2_dp0_gpu3_layer8
	agg_pp2_dp0_gpu3_layer8 -> attn_pp2_dp0_gpu3_layer9
	attn_pp2_dp0_gpu3_layer9 -> route_pp2_dp0_gpu3_layer9
	route_pp2_dp0_gpu3_layer9 -> expert_pp2_dp0_gpu3_layer9_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp0_gpu3_layer9 -> expert_pp2_dp0_gpu3_layer9_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp0_gpu3_layer9 -> expert_pp2_dp0_gpu3_layer9_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp0_gpu3_layer9 -> expert_pp2_dp0_gpu3_layer9_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp0_gpu3_layer9_exp12 -> agg_pp2_dp0_gpu3_layer9
	expert_pp2_dp0_gpu3_layer9_exp13 -> agg_pp2_dp0_gpu3_layer9
	expert_pp2_dp0_gpu3_layer9_exp14 -> agg_pp2_dp0_gpu3_layer9
	expert_pp2_dp0_gpu3_layer9_exp15 -> agg_pp2_dp0_gpu3_layer9
	agg_pp2_dp0_gpu3_layer9 -> attn_pp2_dp0_gpu3_layer10
	attn_pp2_dp0_gpu3_layer10 -> route_pp2_dp0_gpu3_layer10
	route_pp2_dp0_gpu3_layer10 -> expert_pp2_dp0_gpu3_layer10_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp0_gpu3_layer10 -> expert_pp2_dp0_gpu3_layer10_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp0_gpu3_layer10 -> expert_pp2_dp0_gpu3_layer10_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp0_gpu3_layer10 -> expert_pp2_dp0_gpu3_layer10_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp0_gpu3_layer10_exp12 -> agg_pp2_dp0_gpu3_layer10
	expert_pp2_dp0_gpu3_layer10_exp13 -> agg_pp2_dp0_gpu3_layer10
	expert_pp2_dp0_gpu3_layer10_exp14 -> agg_pp2_dp0_gpu3_layer10
	expert_pp2_dp0_gpu3_layer10_exp15 -> agg_pp2_dp0_gpu3_layer10
	agg_pp2_dp0_gpu3_layer10 -> attn_pp2_dp0_gpu3_layer11
	attn_pp2_dp0_gpu3_layer11 -> route_pp2_dp0_gpu3_layer11
	route_pp2_dp0_gpu3_layer11 -> expert_pp2_dp0_gpu3_layer11_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp0_gpu3_layer11 -> expert_pp2_dp0_gpu3_layer11_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp0_gpu3_layer11 -> expert_pp2_dp0_gpu3_layer11_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp0_gpu3_layer11 -> expert_pp2_dp0_gpu3_layer11_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp0_gpu3_layer11_exp12 -> agg_pp2_dp0_gpu3_layer11
	expert_pp2_dp0_gpu3_layer11_exp13 -> agg_pp2_dp0_gpu3_layer11
	expert_pp2_dp0_gpu3_layer11_exp14 -> agg_pp2_dp0_gpu3_layer11
	expert_pp2_dp0_gpu3_layer11_exp15 -> agg_pp2_dp0_gpu3_layer11
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp0_gpu3 [label="P2P Comm\nStage 2->3\nGPU 35\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp0_gpu3_layer11 -> comm_pp2_to_pp3_dp0_gpu3
	comm_pp2_to_pp3_dp0_gpu3 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp1_gpu0_layer8 -> route_pp2_dp1_gpu0_layer8
	route_pp2_dp1_gpu0_layer8 -> expert_pp2_dp1_gpu0_layer8_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp1_gpu0_layer8 -> expert_pp2_dp1_gpu0_layer8_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp1_gpu0_layer8 -> expert_pp2_dp1_gpu0_layer8_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp1_gpu0_layer8 -> expert_pp2_dp1_gpu0_layer8_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp1_gpu0_layer8_exp0 -> agg_pp2_dp1_gpu0_layer8
	expert_pp2_dp1_gpu0_layer8_exp1 -> agg_pp2_dp1_gpu0_layer8
	expert_pp2_dp1_gpu0_layer8_exp2 -> agg_pp2_dp1_gpu0_layer8
	expert_pp2_dp1_gpu0_layer8_exp3 -> agg_pp2_dp1_gpu0_layer8
	agg_pp2_dp1_gpu0_layer8 -> attn_pp2_dp1_gpu0_layer9
	attn_pp2_dp1_gpu0_layer9 -> route_pp2_dp1_gpu0_layer9
	route_pp2_dp1_gpu0_layer9 -> expert_pp2_dp1_gpu0_layer9_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp1_gpu0_layer9 -> expert_pp2_dp1_gpu0_layer9_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp1_gpu0_layer9 -> expert_pp2_dp1_gpu0_layer9_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp1_gpu0_layer9 -> expert_pp2_dp1_gpu0_layer9_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp1_gpu0_layer9_exp0 -> agg_pp2_dp1_gpu0_layer9
	expert_pp2_dp1_gpu0_layer9_exp1 -> agg_pp2_dp1_gpu0_layer9
	expert_pp2_dp1_gpu0_layer9_exp2 -> agg_pp2_dp1_gpu0_layer9
	expert_pp2_dp1_gpu0_layer9_exp3 -> agg_pp2_dp1_gpu0_layer9
	agg_pp2_dp1_gpu0_layer9 -> attn_pp2_dp1_gpu0_layer10
	attn_pp2_dp1_gpu0_layer10 -> route_pp2_dp1_gpu0_layer10
	route_pp2_dp1_gpu0_layer10 -> expert_pp2_dp1_gpu0_layer10_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp1_gpu0_layer10 -> expert_pp2_dp1_gpu0_layer10_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp1_gpu0_layer10 -> expert_pp2_dp1_gpu0_layer10_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp1_gpu0_layer10 -> expert_pp2_dp1_gpu0_layer10_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp1_gpu0_layer10_exp0 -> agg_pp2_dp1_gpu0_layer10
	expert_pp2_dp1_gpu0_layer10_exp1 -> agg_pp2_dp1_gpu0_layer10
	expert_pp2_dp1_gpu0_layer10_exp2 -> agg_pp2_dp1_gpu0_layer10
	expert_pp2_dp1_gpu0_layer10_exp3 -> agg_pp2_dp1_gpu0_layer10
	agg_pp2_dp1_gpu0_layer10 -> attn_pp2_dp1_gpu0_layer11
	attn_pp2_dp1_gpu0_layer11 -> route_pp2_dp1_gpu0_layer11
	route_pp2_dp1_gpu0_layer11 -> expert_pp2_dp1_gpu0_layer11_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp1_gpu0_layer11 -> expert_pp2_dp1_gpu0_layer11_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp1_gpu0_layer11 -> expert_pp2_dp1_gpu0_layer11_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp1_gpu0_layer11 -> expert_pp2_dp1_gpu0_layer11_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp1_gpu0_layer11_exp0 -> agg_pp2_dp1_gpu0_layer11
	expert_pp2_dp1_gpu0_layer11_exp1 -> agg_pp2_dp1_gpu0_layer11
	expert_pp2_dp1_gpu0_layer11_exp2 -> agg_pp2_dp1_gpu0_layer11
	expert_pp2_dp1_gpu0_layer11_exp3 -> agg_pp2_dp1_gpu0_layer11
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu0 [label="P2P Comm\nStage 2->3\nGPU 36\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu0_layer11 -> comm_pp2_to_pp3_dp1_gpu0
	comm_pp2_to_pp3_dp1_gpu0 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp1_gpu1_layer8 -> route_pp2_dp1_gpu1_layer8
	route_pp2_dp1_gpu1_layer8 -> expert_pp2_dp1_gpu1_layer8_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp1_gpu1_layer8 -> expert_pp2_dp1_gpu1_layer8_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp1_gpu1_layer8 -> expert_pp2_dp1_gpu1_layer8_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp1_gpu1_layer8 -> expert_pp2_dp1_gpu1_layer8_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp1_gpu1_layer8_exp4 -> agg_pp2_dp1_gpu1_layer8
	expert_pp2_dp1_gpu1_layer8_exp5 -> agg_pp2_dp1_gpu1_layer8
	expert_pp2_dp1_gpu1_layer8_exp6 -> agg_pp2_dp1_gpu1_layer8
	expert_pp2_dp1_gpu1_layer8_exp7 -> agg_pp2_dp1_gpu1_layer8
	agg_pp2_dp1_gpu1_layer8 -> attn_pp2_dp1_gpu1_layer9
	attn_pp2_dp1_gpu1_layer9 -> route_pp2_dp1_gpu1_layer9
	route_pp2_dp1_gpu1_layer9 -> expert_pp2_dp1_gpu1_layer9_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp1_gpu1_layer9 -> expert_pp2_dp1_gpu1_layer9_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp1_gpu1_layer9 -> expert_pp2_dp1_gpu1_layer9_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp1_gpu1_layer9 -> expert_pp2_dp1_gpu1_layer9_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp1_gpu1_layer9_exp4 -> agg_pp2_dp1_gpu1_layer9
	expert_pp2_dp1_gpu1_layer9_exp5 -> agg_pp2_dp1_gpu1_layer9
	expert_pp2_dp1_gpu1_layer9_exp6 -> agg_pp2_dp1_gpu1_layer9
	expert_pp2_dp1_gpu1_layer9_exp7 -> agg_pp2_dp1_gpu1_layer9
	agg_pp2_dp1_gpu1_layer9 -> attn_pp2_dp1_gpu1_layer10
	attn_pp2_dp1_gpu1_layer10 -> route_pp2_dp1_gpu1_layer10
	route_pp2_dp1_gpu1_layer10 -> expert_pp2_dp1_gpu1_layer10_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp1_gpu1_layer10 -> expert_pp2_dp1_gpu1_layer10_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp1_gpu1_layer10 -> expert_pp2_dp1_gpu1_layer10_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp1_gpu1_layer10 -> expert_pp2_dp1_gpu1_layer10_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp1_gpu1_layer10_exp4 -> agg_pp2_dp1_gpu1_layer10
	expert_pp2_dp1_gpu1_layer10_exp5 -> agg_pp2_dp1_gpu1_layer10
	expert_pp2_dp1_gpu1_layer10_exp6 -> agg_pp2_dp1_gpu1_layer10
	expert_pp2_dp1_gpu1_layer10_exp7 -> agg_pp2_dp1_gpu1_layer10
	agg_pp2_dp1_gpu1_layer10 -> attn_pp2_dp1_gpu1_layer11
	attn_pp2_dp1_gpu1_layer11 -> route_pp2_dp1_gpu1_layer11
	route_pp2_dp1_gpu1_layer11 -> expert_pp2_dp1_gpu1_layer11_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp1_gpu1_layer11 -> expert_pp2_dp1_gpu1_layer11_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp1_gpu1_layer11 -> expert_pp2_dp1_gpu1_layer11_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp1_gpu1_layer11 -> expert_pp2_dp1_gpu1_layer11_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp1_gpu1_layer11_exp4 -> agg_pp2_dp1_gpu1_layer11
	expert_pp2_dp1_gpu1_layer11_exp5 -> agg_pp2_dp1_gpu1_layer11
	expert_pp2_dp1_gpu1_layer11_exp6 -> agg_pp2_dp1_gpu1_layer11
	expert_pp2_dp1_gpu1_layer11_exp7 -> agg_pp2_dp1_gpu1_layer11
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu1 [label="P2P Comm\nStage 2->3\nGPU 37\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu1_layer11 -> comm_pp2_to_pp3_dp1_gpu1
	comm_pp2_to_pp3_dp1_gpu1 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp1_gpu2_layer8 -> route_pp2_dp1_gpu2_layer8
	route_pp2_dp1_gpu2_layer8 -> expert_pp2_dp1_gpu2_layer8_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp1_gpu2_layer8 -> expert_pp2_dp1_gpu2_layer8_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp1_gpu2_layer8 -> expert_pp2_dp1_gpu2_layer8_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp1_gpu2_layer8 -> expert_pp2_dp1_gpu2_layer8_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp1_gpu2_layer8_exp8 -> agg_pp2_dp1_gpu2_layer8
	expert_pp2_dp1_gpu2_layer8_exp9 -> agg_pp2_dp1_gpu2_layer8
	expert_pp2_dp1_gpu2_layer8_exp10 -> agg_pp2_dp1_gpu2_layer8
	expert_pp2_dp1_gpu2_layer8_exp11 -> agg_pp2_dp1_gpu2_layer8
	agg_pp2_dp1_gpu2_layer8 -> attn_pp2_dp1_gpu2_layer9
	attn_pp2_dp1_gpu2_layer9 -> route_pp2_dp1_gpu2_layer9
	route_pp2_dp1_gpu2_layer9 -> expert_pp2_dp1_gpu2_layer9_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp1_gpu2_layer9 -> expert_pp2_dp1_gpu2_layer9_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp1_gpu2_layer9 -> expert_pp2_dp1_gpu2_layer9_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp1_gpu2_layer9 -> expert_pp2_dp1_gpu2_layer9_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp1_gpu2_layer9_exp8 -> agg_pp2_dp1_gpu2_layer9
	expert_pp2_dp1_gpu2_layer9_exp9 -> agg_pp2_dp1_gpu2_layer9
	expert_pp2_dp1_gpu2_layer9_exp10 -> agg_pp2_dp1_gpu2_layer9
	expert_pp2_dp1_gpu2_layer9_exp11 -> agg_pp2_dp1_gpu2_layer9
	agg_pp2_dp1_gpu2_layer9 -> attn_pp2_dp1_gpu2_layer10
	attn_pp2_dp1_gpu2_layer10 -> route_pp2_dp1_gpu2_layer10
	route_pp2_dp1_gpu2_layer10 -> expert_pp2_dp1_gpu2_layer10_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp1_gpu2_layer10 -> expert_pp2_dp1_gpu2_layer10_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp1_gpu2_layer10 -> expert_pp2_dp1_gpu2_layer10_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp1_gpu2_layer10 -> expert_pp2_dp1_gpu2_layer10_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp1_gpu2_layer10_exp8 -> agg_pp2_dp1_gpu2_layer10
	expert_pp2_dp1_gpu2_layer10_exp9 -> agg_pp2_dp1_gpu2_layer10
	expert_pp2_dp1_gpu2_layer10_exp10 -> agg_pp2_dp1_gpu2_layer10
	expert_pp2_dp1_gpu2_layer10_exp11 -> agg_pp2_dp1_gpu2_layer10
	agg_pp2_dp1_gpu2_layer10 -> attn_pp2_dp1_gpu2_layer11
	attn_pp2_dp1_gpu2_layer11 -> route_pp2_dp1_gpu2_layer11
	route_pp2_dp1_gpu2_layer11 -> expert_pp2_dp1_gpu2_layer11_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp1_gpu2_layer11 -> expert_pp2_dp1_gpu2_layer11_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp1_gpu2_layer11 -> expert_pp2_dp1_gpu2_layer11_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp1_gpu2_layer11 -> expert_pp2_dp1_gpu2_layer11_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp1_gpu2_layer11_exp8 -> agg_pp2_dp1_gpu2_layer11
	expert_pp2_dp1_gpu2_layer11_exp9 -> agg_pp2_dp1_gpu2_layer11
	expert_pp2_dp1_gpu2_layer11_exp10 -> agg_pp2_dp1_gpu2_layer11
	expert_pp2_dp1_gpu2_layer11_exp11 -> agg_pp2_dp1_gpu2_layer11
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu2 [label="P2P Comm\nStage 2->3\nGPU 38\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu2_layer11 -> comm_pp2_to_pp3_dp1_gpu2
	comm_pp2_to_pp3_dp1_gpu2 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp1_gpu3_layer8 -> route_pp2_dp1_gpu3_layer8
	route_pp2_dp1_gpu3_layer8 -> expert_pp2_dp1_gpu3_layer8_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp1_gpu3_layer8 -> expert_pp2_dp1_gpu3_layer8_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp1_gpu3_layer8 -> expert_pp2_dp1_gpu3_layer8_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp1_gpu3_layer8 -> expert_pp2_dp1_gpu3_layer8_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp1_gpu3_layer8_exp12 -> agg_pp2_dp1_gpu3_layer8
	expert_pp2_dp1_gpu3_layer8_exp13 -> agg_pp2_dp1_gpu3_layer8
	expert_pp2_dp1_gpu3_layer8_exp14 -> agg_pp2_dp1_gpu3_layer8
	expert_pp2_dp1_gpu3_layer8_exp15 -> agg_pp2_dp1_gpu3_layer8
	agg_pp2_dp1_gpu3_layer8 -> attn_pp2_dp1_gpu3_layer9
	attn_pp2_dp1_gpu3_layer9 -> route_pp2_dp1_gpu3_layer9
	route_pp2_dp1_gpu3_layer9 -> expert_pp2_dp1_gpu3_layer9_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp1_gpu3_layer9 -> expert_pp2_dp1_gpu3_layer9_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp1_gpu3_layer9 -> expert_pp2_dp1_gpu3_layer9_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp1_gpu3_layer9 -> expert_pp2_dp1_gpu3_layer9_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp1_gpu3_layer9_exp12 -> agg_pp2_dp1_gpu3_layer9
	expert_pp2_dp1_gpu3_layer9_exp13 -> agg_pp2_dp1_gpu3_layer9
	expert_pp2_dp1_gpu3_layer9_exp14 -> agg_pp2_dp1_gpu3_layer9
	expert_pp2_dp1_gpu3_layer9_exp15 -> agg_pp2_dp1_gpu3_layer9
	agg_pp2_dp1_gpu3_layer9 -> attn_pp2_dp1_gpu3_layer10
	attn_pp2_dp1_gpu3_layer10 -> route_pp2_dp1_gpu3_layer10
	route_pp2_dp1_gpu3_layer10 -> expert_pp2_dp1_gpu3_layer10_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp1_gpu3_layer10 -> expert_pp2_dp1_gpu3_layer10_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp1_gpu3_layer10 -> expert_pp2_dp1_gpu3_layer10_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp1_gpu3_layer10 -> expert_pp2_dp1_gpu3_layer10_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp1_gpu3_layer10_exp12 -> agg_pp2_dp1_gpu3_layer10
	expert_pp2_dp1_gpu3_layer10_exp13 -> agg_pp2_dp1_gpu3_layer10
	expert_pp2_dp1_gpu3_layer10_exp14 -> agg_pp2_dp1_gpu3_layer10
	expert_pp2_dp1_gpu3_layer10_exp15 -> agg_pp2_dp1_gpu3_layer10
	agg_pp2_dp1_gpu3_layer10 -> attn_pp2_dp1_gpu3_layer11
	attn_pp2_dp1_gpu3_layer11 -> route_pp2_dp1_gpu3_layer11
	route_pp2_dp1_gpu3_layer11 -> expert_pp2_dp1_gpu3_layer11_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp1_gpu3_layer11 -> expert_pp2_dp1_gpu3_layer11_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp1_gpu3_layer11 -> expert_pp2_dp1_gpu3_layer11_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp1_gpu3_layer11 -> expert_pp2_dp1_gpu3_layer11_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp1_gpu3_layer11_exp12 -> agg_pp2_dp1_gpu3_layer11
	expert_pp2_dp1_gpu3_layer11_exp13 -> agg_pp2_dp1_gpu3_layer11
	expert_pp2_dp1_gpu3_layer11_exp14 -> agg_pp2_dp1_gpu3_layer11
	expert_pp2_dp1_gpu3_layer11_exp15 -> agg_pp2_dp1_gpu3_layer11
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp1_gpu3 [label="P2P Comm\nStage 2->3\nGPU 39\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp1_gpu3_layer11 -> comm_pp2_to_pp3_dp1_gpu3
	comm_pp2_to_pp3_dp1_gpu3 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp2_gpu0_layer8 -> route_pp2_dp2_gpu0_layer8
	route_pp2_dp2_gpu0_layer8 -> expert_pp2_dp2_gpu0_layer8_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp2_gpu0_layer8 -> expert_pp2_dp2_gpu0_layer8_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp2_gpu0_layer8 -> expert_pp2_dp2_gpu0_layer8_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp2_gpu0_layer8 -> expert_pp2_dp2_gpu0_layer8_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp2_gpu0_layer8_exp0 -> agg_pp2_dp2_gpu0_layer8
	expert_pp2_dp2_gpu0_layer8_exp1 -> agg_pp2_dp2_gpu0_layer8
	expert_pp2_dp2_gpu0_layer8_exp2 -> agg_pp2_dp2_gpu0_layer8
	expert_pp2_dp2_gpu0_layer8_exp3 -> agg_pp2_dp2_gpu0_layer8
	agg_pp2_dp2_gpu0_layer8 -> attn_pp2_dp2_gpu0_layer9
	attn_pp2_dp2_gpu0_layer9 -> route_pp2_dp2_gpu0_layer9
	route_pp2_dp2_gpu0_layer9 -> expert_pp2_dp2_gpu0_layer9_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp2_gpu0_layer9 -> expert_pp2_dp2_gpu0_layer9_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp2_gpu0_layer9 -> expert_pp2_dp2_gpu0_layer9_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp2_gpu0_layer9 -> expert_pp2_dp2_gpu0_layer9_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp2_gpu0_layer9_exp0 -> agg_pp2_dp2_gpu0_layer9
	expert_pp2_dp2_gpu0_layer9_exp1 -> agg_pp2_dp2_gpu0_layer9
	expert_pp2_dp2_gpu0_layer9_exp2 -> agg_pp2_dp2_gpu0_layer9
	expert_pp2_dp2_gpu0_layer9_exp3 -> agg_pp2_dp2_gpu0_layer9
	agg_pp2_dp2_gpu0_layer9 -> attn_pp2_dp2_gpu0_layer10
	attn_pp2_dp2_gpu0_layer10 -> route_pp2_dp2_gpu0_layer10
	route_pp2_dp2_gpu0_layer10 -> expert_pp2_dp2_gpu0_layer10_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp2_gpu0_layer10 -> expert_pp2_dp2_gpu0_layer10_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp2_gpu0_layer10 -> expert_pp2_dp2_gpu0_layer10_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp2_gpu0_layer10 -> expert_pp2_dp2_gpu0_layer10_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp2_gpu0_layer10_exp0 -> agg_pp2_dp2_gpu0_layer10
	expert_pp2_dp2_gpu0_layer10_exp1 -> agg_pp2_dp2_gpu0_layer10
	expert_pp2_dp2_gpu0_layer10_exp2 -> agg_pp2_dp2_gpu0_layer10
	expert_pp2_dp2_gpu0_layer10_exp3 -> agg_pp2_dp2_gpu0_layer10
	agg_pp2_dp2_gpu0_layer10 -> attn_pp2_dp2_gpu0_layer11
	attn_pp2_dp2_gpu0_layer11 -> route_pp2_dp2_gpu0_layer11
	route_pp2_dp2_gpu0_layer11 -> expert_pp2_dp2_gpu0_layer11_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp2_gpu0_layer11 -> expert_pp2_dp2_gpu0_layer11_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp2_gpu0_layer11 -> expert_pp2_dp2_gpu0_layer11_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp2_gpu0_layer11 -> expert_pp2_dp2_gpu0_layer11_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp2_gpu0_layer11_exp0 -> agg_pp2_dp2_gpu0_layer11
	expert_pp2_dp2_gpu0_layer11_exp1 -> agg_pp2_dp2_gpu0_layer11
	expert_pp2_dp2_gpu0_layer11_exp2 -> agg_pp2_dp2_gpu0_layer11
	expert_pp2_dp2_gpu0_layer11_exp3 -> agg_pp2_dp2_gpu0_layer11
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu0 [label="P2P Comm\nStage 2->3\nGPU 40\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu0_layer11 -> comm_pp2_to_pp3_dp2_gpu0
	comm_pp2_to_pp3_dp2_gpu0 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp2_gpu1_layer8 -> route_pp2_dp2_gpu1_layer8
	route_pp2_dp2_gpu1_layer8 -> expert_pp2_dp2_gpu1_layer8_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp2_gpu1_layer8 -> expert_pp2_dp2_gpu1_layer8_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp2_gpu1_layer8 -> expert_pp2_dp2_gpu1_layer8_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp2_gpu1_layer8 -> expert_pp2_dp2_gpu1_layer8_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp2_gpu1_layer8_exp4 -> agg_pp2_dp2_gpu1_layer8
	expert_pp2_dp2_gpu1_layer8_exp5 -> agg_pp2_dp2_gpu1_layer8
	expert_pp2_dp2_gpu1_layer8_exp6 -> agg_pp2_dp2_gpu1_layer8
	expert_pp2_dp2_gpu1_layer8_exp7 -> agg_pp2_dp2_gpu1_layer8
	agg_pp2_dp2_gpu1_layer8 -> attn_pp2_dp2_gpu1_layer9
	attn_pp2_dp2_gpu1_layer9 -> route_pp2_dp2_gpu1_layer9
	route_pp2_dp2_gpu1_layer9 -> expert_pp2_dp2_gpu1_layer9_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp2_gpu1_layer9 -> expert_pp2_dp2_gpu1_layer9_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp2_gpu1_layer9 -> expert_pp2_dp2_gpu1_layer9_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp2_gpu1_layer9 -> expert_pp2_dp2_gpu1_layer9_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp2_gpu1_layer9_exp4 -> agg_pp2_dp2_gpu1_layer9
	expert_pp2_dp2_gpu1_layer9_exp5 -> agg_pp2_dp2_gpu1_layer9
	expert_pp2_dp2_gpu1_layer9_exp6 -> agg_pp2_dp2_gpu1_layer9
	expert_pp2_dp2_gpu1_layer9_exp7 -> agg_pp2_dp2_gpu1_layer9
	agg_pp2_dp2_gpu1_layer9 -> attn_pp2_dp2_gpu1_layer10
	attn_pp2_dp2_gpu1_layer10 -> route_pp2_dp2_gpu1_layer10
	route_pp2_dp2_gpu1_layer10 -> expert_pp2_dp2_gpu1_layer10_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp2_gpu1_layer10 -> expert_pp2_dp2_gpu1_layer10_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp2_gpu1_layer10 -> expert_pp2_dp2_gpu1_layer10_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp2_gpu1_layer10 -> expert_pp2_dp2_gpu1_layer10_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp2_gpu1_layer10_exp4 -> agg_pp2_dp2_gpu1_layer10
	expert_pp2_dp2_gpu1_layer10_exp5 -> agg_pp2_dp2_gpu1_layer10
	expert_pp2_dp2_gpu1_layer10_exp6 -> agg_pp2_dp2_gpu1_layer10
	expert_pp2_dp2_gpu1_layer10_exp7 -> agg_pp2_dp2_gpu1_layer10
	agg_pp2_dp2_gpu1_layer10 -> attn_pp2_dp2_gpu1_layer11
	attn_pp2_dp2_gpu1_layer11 -> route_pp2_dp2_gpu1_layer11
	route_pp2_dp2_gpu1_layer11 -> expert_pp2_dp2_gpu1_layer11_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp2_gpu1_layer11 -> expert_pp2_dp2_gpu1_layer11_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp2_gpu1_layer11 -> expert_pp2_dp2_gpu1_layer11_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp2_gpu1_layer11 -> expert_pp2_dp2_gpu1_layer11_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp2_gpu1_layer11_exp4 -> agg_pp2_dp2_gpu1_layer11
	expert_pp2_dp2_gpu1_layer11_exp5 -> agg_pp2_dp2_gpu1_layer11
	expert_pp2_dp2_gpu1_layer11_exp6 -> agg_pp2_dp2_gpu1_layer11
	expert_pp2_dp2_gpu1_layer11_exp7 -> agg_pp2_dp2_gpu1_layer11
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu1 [label="P2P Comm\nStage 2->3\nGPU 41\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu1_layer11 -> comm_pp2_to_pp3_dp2_gpu1
	comm_pp2_to_pp3_dp2_gpu1 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp2_gpu2_layer8 -> route_pp2_dp2_gpu2_layer8
	route_pp2_dp2_gpu2_layer8 -> expert_pp2_dp2_gpu2_layer8_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp2_gpu2_layer8 -> expert_pp2_dp2_gpu2_layer8_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp2_gpu2_layer8 -> expert_pp2_dp2_gpu2_layer8_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp2_gpu2_layer8 -> expert_pp2_dp2_gpu2_layer8_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp2_gpu2_layer8_exp8 -> agg_pp2_dp2_gpu2_layer8
	expert_pp2_dp2_gpu2_layer8_exp9 -> agg_pp2_dp2_gpu2_layer8
	expert_pp2_dp2_gpu2_layer8_exp10 -> agg_pp2_dp2_gpu2_layer8
	expert_pp2_dp2_gpu2_layer8_exp11 -> agg_pp2_dp2_gpu2_layer8
	agg_pp2_dp2_gpu2_layer8 -> attn_pp2_dp2_gpu2_layer9
	attn_pp2_dp2_gpu2_layer9 -> route_pp2_dp2_gpu2_layer9
	route_pp2_dp2_gpu2_layer9 -> expert_pp2_dp2_gpu2_layer9_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp2_gpu2_layer9 -> expert_pp2_dp2_gpu2_layer9_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp2_gpu2_layer9 -> expert_pp2_dp2_gpu2_layer9_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp2_gpu2_layer9 -> expert_pp2_dp2_gpu2_layer9_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp2_gpu2_layer9_exp8 -> agg_pp2_dp2_gpu2_layer9
	expert_pp2_dp2_gpu2_layer9_exp9 -> agg_pp2_dp2_gpu2_layer9
	expert_pp2_dp2_gpu2_layer9_exp10 -> agg_pp2_dp2_gpu2_layer9
	expert_pp2_dp2_gpu2_layer9_exp11 -> agg_pp2_dp2_gpu2_layer9
	agg_pp2_dp2_gpu2_layer9 -> attn_pp2_dp2_gpu2_layer10
	attn_pp2_dp2_gpu2_layer10 -> route_pp2_dp2_gpu2_layer10
	route_pp2_dp2_gpu2_layer10 -> expert_pp2_dp2_gpu2_layer10_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp2_gpu2_layer10 -> expert_pp2_dp2_gpu2_layer10_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp2_gpu2_layer10 -> expert_pp2_dp2_gpu2_layer10_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp2_gpu2_layer10 -> expert_pp2_dp2_gpu2_layer10_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp2_gpu2_layer10_exp8 -> agg_pp2_dp2_gpu2_layer10
	expert_pp2_dp2_gpu2_layer10_exp9 -> agg_pp2_dp2_gpu2_layer10
	expert_pp2_dp2_gpu2_layer10_exp10 -> agg_pp2_dp2_gpu2_layer10
	expert_pp2_dp2_gpu2_layer10_exp11 -> agg_pp2_dp2_gpu2_layer10
	agg_pp2_dp2_gpu2_layer10 -> attn_pp2_dp2_gpu2_layer11
	attn_pp2_dp2_gpu2_layer11 -> route_pp2_dp2_gpu2_layer11
	route_pp2_dp2_gpu2_layer11 -> expert_pp2_dp2_gpu2_layer11_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp2_gpu2_layer11 -> expert_pp2_dp2_gpu2_layer11_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp2_gpu2_layer11 -> expert_pp2_dp2_gpu2_layer11_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp2_gpu2_layer11 -> expert_pp2_dp2_gpu2_layer11_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp2_gpu2_layer11_exp8 -> agg_pp2_dp2_gpu2_layer11
	expert_pp2_dp2_gpu2_layer11_exp9 -> agg_pp2_dp2_gpu2_layer11
	expert_pp2_dp2_gpu2_layer11_exp10 -> agg_pp2_dp2_gpu2_layer11
	expert_pp2_dp2_gpu2_layer11_exp11 -> agg_pp2_dp2_gpu2_layer11
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu2 [label="P2P Comm\nStage 2->3\nGPU 42\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu2_layer11 -> comm_pp2_to_pp3_dp2_gpu2
	comm_pp2_to_pp3_dp2_gpu2 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp2_gpu3_layer8 -> route_pp2_dp2_gpu3_layer8
	route_pp2_dp2_gpu3_layer8 -> expert_pp2_dp2_gpu3_layer8_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp2_gpu3_layer8 -> expert_pp2_dp2_gpu3_layer8_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp2_gpu3_layer8 -> expert_pp2_dp2_gpu3_layer8_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp2_gpu3_layer8 -> expert_pp2_dp2_gpu3_layer8_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp2_gpu3_layer8_exp12 -> agg_pp2_dp2_gpu3_layer8
	expert_pp2_dp2_gpu3_layer8_exp13 -> agg_pp2_dp2_gpu3_layer8
	expert_pp2_dp2_gpu3_layer8_exp14 -> agg_pp2_dp2_gpu3_layer8
	expert_pp2_dp2_gpu3_layer8_exp15 -> agg_pp2_dp2_gpu3_layer8
	agg_pp2_dp2_gpu3_layer8 -> attn_pp2_dp2_gpu3_layer9
	attn_pp2_dp2_gpu3_layer9 -> route_pp2_dp2_gpu3_layer9
	route_pp2_dp2_gpu3_layer9 -> expert_pp2_dp2_gpu3_layer9_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp2_gpu3_layer9 -> expert_pp2_dp2_gpu3_layer9_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp2_gpu3_layer9 -> expert_pp2_dp2_gpu3_layer9_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp2_gpu3_layer9 -> expert_pp2_dp2_gpu3_layer9_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp2_gpu3_layer9_exp12 -> agg_pp2_dp2_gpu3_layer9
	expert_pp2_dp2_gpu3_layer9_exp13 -> agg_pp2_dp2_gpu3_layer9
	expert_pp2_dp2_gpu3_layer9_exp14 -> agg_pp2_dp2_gpu3_layer9
	expert_pp2_dp2_gpu3_layer9_exp15 -> agg_pp2_dp2_gpu3_layer9
	agg_pp2_dp2_gpu3_layer9 -> attn_pp2_dp2_gpu3_layer10
	attn_pp2_dp2_gpu3_layer10 -> route_pp2_dp2_gpu3_layer10
	route_pp2_dp2_gpu3_layer10 -> expert_pp2_dp2_gpu3_layer10_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp2_gpu3_layer10 -> expert_pp2_dp2_gpu3_layer10_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp2_gpu3_layer10 -> expert_pp2_dp2_gpu3_layer10_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp2_gpu3_layer10 -> expert_pp2_dp2_gpu3_layer10_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp2_gpu3_layer10_exp12 -> agg_pp2_dp2_gpu3_layer10
	expert_pp2_dp2_gpu3_layer10_exp13 -> agg_pp2_dp2_gpu3_layer10
	expert_pp2_dp2_gpu3_layer10_exp14 -> agg_pp2_dp2_gpu3_layer10
	expert_pp2_dp2_gpu3_layer10_exp15 -> agg_pp2_dp2_gpu3_layer10
	agg_pp2_dp2_gpu3_layer10 -> attn_pp2_dp2_gpu3_layer11
	attn_pp2_dp2_gpu3_layer11 -> route_pp2_dp2_gpu3_layer11
	route_pp2_dp2_gpu3_layer11 -> expert_pp2_dp2_gpu3_layer11_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp2_gpu3_layer11 -> expert_pp2_dp2_gpu3_layer11_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp2_gpu3_layer11 -> expert_pp2_dp2_gpu3_layer11_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp2_gpu3_layer11 -> expert_pp2_dp2_gpu3_layer11_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp2_gpu3_layer11_exp12 -> agg_pp2_dp2_gpu3_layer11
	expert_pp2_dp2_gpu3_layer11_exp13 -> agg_pp2_dp2_gpu3_layer11
	expert_pp2_dp2_gpu3_layer11_exp14 -> agg_pp2_dp2_gpu3_layer11
	expert_pp2_dp2_gpu3_layer11_exp15 -> agg_pp2_dp2_gpu3_layer11
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp2_gpu3 [label="P2P Comm\nStage 2->3\nGPU 43\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp2_gpu3_layer11 -> comm_pp2_to_pp3_dp2_gpu3
	comm_pp2_to_pp3_dp2_gpu3 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp3_gpu0_layer8 -> route_pp2_dp3_gpu0_layer8
	route_pp2_dp3_gpu0_layer8 -> expert_pp2_dp3_gpu0_layer8_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp3_gpu0_layer8 -> expert_pp2_dp3_gpu0_layer8_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp3_gpu0_layer8 -> expert_pp2_dp3_gpu0_layer8_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp3_gpu0_layer8 -> expert_pp2_dp3_gpu0_layer8_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp3_gpu0_layer8_exp0 -> agg_pp2_dp3_gpu0_layer8
	expert_pp2_dp3_gpu0_layer8_exp1 -> agg_pp2_dp3_gpu0_layer8
	expert_pp2_dp3_gpu0_layer8_exp2 -> agg_pp2_dp3_gpu0_layer8
	expert_pp2_dp3_gpu0_layer8_exp3 -> agg_pp2_dp3_gpu0_layer8
	agg_pp2_dp3_gpu0_layer8 -> attn_pp2_dp3_gpu0_layer9
	attn_pp2_dp3_gpu0_layer9 -> route_pp2_dp3_gpu0_layer9
	route_pp2_dp3_gpu0_layer9 -> expert_pp2_dp3_gpu0_layer9_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp3_gpu0_layer9 -> expert_pp2_dp3_gpu0_layer9_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp3_gpu0_layer9 -> expert_pp2_dp3_gpu0_layer9_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp3_gpu0_layer9 -> expert_pp2_dp3_gpu0_layer9_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp3_gpu0_layer9_exp0 -> agg_pp2_dp3_gpu0_layer9
	expert_pp2_dp3_gpu0_layer9_exp1 -> agg_pp2_dp3_gpu0_layer9
	expert_pp2_dp3_gpu0_layer9_exp2 -> agg_pp2_dp3_gpu0_layer9
	expert_pp2_dp3_gpu0_layer9_exp3 -> agg_pp2_dp3_gpu0_layer9
	agg_pp2_dp3_gpu0_layer9 -> attn_pp2_dp3_gpu0_layer10
	attn_pp2_dp3_gpu0_layer10 -> route_pp2_dp3_gpu0_layer10
	route_pp2_dp3_gpu0_layer10 -> expert_pp2_dp3_gpu0_layer10_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp3_gpu0_layer10 -> expert_pp2_dp3_gpu0_layer10_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp3_gpu0_layer10 -> expert_pp2_dp3_gpu0_layer10_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp3_gpu0_layer10 -> expert_pp2_dp3_gpu0_layer10_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp3_gpu0_layer10_exp0 -> agg_pp2_dp3_gpu0_layer10
	expert_pp2_dp3_gpu0_layer10_exp1 -> agg_pp2_dp3_gpu0_layer10
	expert_pp2_dp3_gpu0_layer10_exp2 -> agg_pp2_dp3_gpu0_layer10
	expert_pp2_dp3_gpu0_layer10_exp3 -> agg_pp2_dp3_gpu0_layer10
	agg_pp2_dp3_gpu0_layer10 -> attn_pp2_dp3_gpu0_layer11
	attn_pp2_dp3_gpu0_layer11 -> route_pp2_dp3_gpu0_layer11
	route_pp2_dp3_gpu0_layer11 -> expert_pp2_dp3_gpu0_layer11_exp0 [label="Gated 0" style=dashed]
	route_pp2_dp3_gpu0_layer11 -> expert_pp2_dp3_gpu0_layer11_exp1 [label="Gated 1" style=dashed]
	route_pp2_dp3_gpu0_layer11 -> expert_pp2_dp3_gpu0_layer11_exp2 [label="Gated 2" style=dashed]
	route_pp2_dp3_gpu0_layer11 -> expert_pp2_dp3_gpu0_layer11_exp3 [label="Gated 3" style=dashed]
	expert_pp2_dp3_gpu0_layer11_exp0 -> agg_pp2_dp3_gpu0_layer11
	expert_pp2_dp3_gpu0_layer11_exp1 -> agg_pp2_dp3_gpu0_layer11
	expert_pp2_dp3_gpu0_layer11_exp2 -> agg_pp2_dp3_gpu0_layer11
	expert_pp2_dp3_gpu0_layer11_exp3 -> agg_pp2_dp3_gpu0_layer11
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu0 [label="P2P Comm\nStage 2->3\nGPU 44\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu0_layer11 -> comm_pp2_to_pp3_dp3_gpu0
	comm_pp2_to_pp3_dp3_gpu0 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp3_gpu1_layer8 -> route_pp2_dp3_gpu1_layer8
	route_pp2_dp3_gpu1_layer8 -> expert_pp2_dp3_gpu1_layer8_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp3_gpu1_layer8 -> expert_pp2_dp3_gpu1_layer8_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp3_gpu1_layer8 -> expert_pp2_dp3_gpu1_layer8_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp3_gpu1_layer8 -> expert_pp2_dp3_gpu1_layer8_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp3_gpu1_layer8_exp4 -> agg_pp2_dp3_gpu1_layer8
	expert_pp2_dp3_gpu1_layer8_exp5 -> agg_pp2_dp3_gpu1_layer8
	expert_pp2_dp3_gpu1_layer8_exp6 -> agg_pp2_dp3_gpu1_layer8
	expert_pp2_dp3_gpu1_layer8_exp7 -> agg_pp2_dp3_gpu1_layer8
	agg_pp2_dp3_gpu1_layer8 -> attn_pp2_dp3_gpu1_layer9
	attn_pp2_dp3_gpu1_layer9 -> route_pp2_dp3_gpu1_layer9
	route_pp2_dp3_gpu1_layer9 -> expert_pp2_dp3_gpu1_layer9_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp3_gpu1_layer9 -> expert_pp2_dp3_gpu1_layer9_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp3_gpu1_layer9 -> expert_pp2_dp3_gpu1_layer9_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp3_gpu1_layer9 -> expert_pp2_dp3_gpu1_layer9_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp3_gpu1_layer9_exp4 -> agg_pp2_dp3_gpu1_layer9
	expert_pp2_dp3_gpu1_layer9_exp5 -> agg_pp2_dp3_gpu1_layer9
	expert_pp2_dp3_gpu1_layer9_exp6 -> agg_pp2_dp3_gpu1_layer9
	expert_pp2_dp3_gpu1_layer9_exp7 -> agg_pp2_dp3_gpu1_layer9
	agg_pp2_dp3_gpu1_layer9 -> attn_pp2_dp3_gpu1_layer10
	attn_pp2_dp3_gpu1_layer10 -> route_pp2_dp3_gpu1_layer10
	route_pp2_dp3_gpu1_layer10 -> expert_pp2_dp3_gpu1_layer10_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp3_gpu1_layer10 -> expert_pp2_dp3_gpu1_layer10_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp3_gpu1_layer10 -> expert_pp2_dp3_gpu1_layer10_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp3_gpu1_layer10 -> expert_pp2_dp3_gpu1_layer10_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp3_gpu1_layer10_exp4 -> agg_pp2_dp3_gpu1_layer10
	expert_pp2_dp3_gpu1_layer10_exp5 -> agg_pp2_dp3_gpu1_layer10
	expert_pp2_dp3_gpu1_layer10_exp6 -> agg_pp2_dp3_gpu1_layer10
	expert_pp2_dp3_gpu1_layer10_exp7 -> agg_pp2_dp3_gpu1_layer10
	agg_pp2_dp3_gpu1_layer10 -> attn_pp2_dp3_gpu1_layer11
	attn_pp2_dp3_gpu1_layer11 -> route_pp2_dp3_gpu1_layer11
	route_pp2_dp3_gpu1_layer11 -> expert_pp2_dp3_gpu1_layer11_exp4 [label="Gated 4" style=dashed]
	route_pp2_dp3_gpu1_layer11 -> expert_pp2_dp3_gpu1_layer11_exp5 [label="Gated 5" style=dashed]
	route_pp2_dp3_gpu1_layer11 -> expert_pp2_dp3_gpu1_layer11_exp6 [label="Gated 6" style=dashed]
	route_pp2_dp3_gpu1_layer11 -> expert_pp2_dp3_gpu1_layer11_exp7 [label="Gated 7" style=dashed]
	expert_pp2_dp3_gpu1_layer11_exp4 -> agg_pp2_dp3_gpu1_layer11
	expert_pp2_dp3_gpu1_layer11_exp5 -> agg_pp2_dp3_gpu1_layer11
	expert_pp2_dp3_gpu1_layer11_exp6 -> agg_pp2_dp3_gpu1_layer11
	expert_pp2_dp3_gpu1_layer11_exp7 -> agg_pp2_dp3_gpu1_layer11
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu1 [label="P2P Comm\nStage 2->3\nGPU 45\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu1_layer11 -> comm_pp2_to_pp3_dp3_gpu1
	comm_pp2_to_pp3_dp3_gpu1 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp3_gpu2_layer8 -> route_pp2_dp3_gpu2_layer8
	route_pp2_dp3_gpu2_layer8 -> expert_pp2_dp3_gpu2_layer8_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp3_gpu2_layer8 -> expert_pp2_dp3_gpu2_layer8_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp3_gpu2_layer8 -> expert_pp2_dp3_gpu2_layer8_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp3_gpu2_layer8 -> expert_pp2_dp3_gpu2_layer8_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp3_gpu2_layer8_exp8 -> agg_pp2_dp3_gpu2_layer8
	expert_pp2_dp3_gpu2_layer8_exp9 -> agg_pp2_dp3_gpu2_layer8
	expert_pp2_dp3_gpu2_layer8_exp10 -> agg_pp2_dp3_gpu2_layer8
	expert_pp2_dp3_gpu2_layer8_exp11 -> agg_pp2_dp3_gpu2_layer8
	agg_pp2_dp3_gpu2_layer8 -> attn_pp2_dp3_gpu2_layer9
	attn_pp2_dp3_gpu2_layer9 -> route_pp2_dp3_gpu2_layer9
	route_pp2_dp3_gpu2_layer9 -> expert_pp2_dp3_gpu2_layer9_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp3_gpu2_layer9 -> expert_pp2_dp3_gpu2_layer9_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp3_gpu2_layer9 -> expert_pp2_dp3_gpu2_layer9_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp3_gpu2_layer9 -> expert_pp2_dp3_gpu2_layer9_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp3_gpu2_layer9_exp8 -> agg_pp2_dp3_gpu2_layer9
	expert_pp2_dp3_gpu2_layer9_exp9 -> agg_pp2_dp3_gpu2_layer9
	expert_pp2_dp3_gpu2_layer9_exp10 -> agg_pp2_dp3_gpu2_layer9
	expert_pp2_dp3_gpu2_layer9_exp11 -> agg_pp2_dp3_gpu2_layer9
	agg_pp2_dp3_gpu2_layer9 -> attn_pp2_dp3_gpu2_layer10
	attn_pp2_dp3_gpu2_layer10 -> route_pp2_dp3_gpu2_layer10
	route_pp2_dp3_gpu2_layer10 -> expert_pp2_dp3_gpu2_layer10_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp3_gpu2_layer10 -> expert_pp2_dp3_gpu2_layer10_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp3_gpu2_layer10 -> expert_pp2_dp3_gpu2_layer10_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp3_gpu2_layer10 -> expert_pp2_dp3_gpu2_layer10_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp3_gpu2_layer10_exp8 -> agg_pp2_dp3_gpu2_layer10
	expert_pp2_dp3_gpu2_layer10_exp9 -> agg_pp2_dp3_gpu2_layer10
	expert_pp2_dp3_gpu2_layer10_exp10 -> agg_pp2_dp3_gpu2_layer10
	expert_pp2_dp3_gpu2_layer10_exp11 -> agg_pp2_dp3_gpu2_layer10
	agg_pp2_dp3_gpu2_layer10 -> attn_pp2_dp3_gpu2_layer11
	attn_pp2_dp3_gpu2_layer11 -> route_pp2_dp3_gpu2_layer11
	route_pp2_dp3_gpu2_layer11 -> expert_pp2_dp3_gpu2_layer11_exp8 [label="Gated 8" style=dashed]
	route_pp2_dp3_gpu2_layer11 -> expert_pp2_dp3_gpu2_layer11_exp9 [label="Gated 9" style=dashed]
	route_pp2_dp3_gpu2_layer11 -> expert_pp2_dp3_gpu2_layer11_exp10 [label="Gated 10" style=dashed]
	route_pp2_dp3_gpu2_layer11 -> expert_pp2_dp3_gpu2_layer11_exp11 [label="Gated 11" style=dashed]
	expert_pp2_dp3_gpu2_layer11_exp8 -> agg_pp2_dp3_gpu2_layer11
	expert_pp2_dp3_gpu2_layer11_exp9 -> agg_pp2_dp3_gpu2_layer11
	expert_pp2_dp3_gpu2_layer11_exp10 -> agg_pp2_dp3_gpu2_layer11
	expert_pp2_dp3_gpu2_layer11_exp11 -> agg_pp2_dp3_gpu2_layer11
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu2 [label="P2P Comm\nStage 2->3\nGPU 46\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu2_layer11 -> comm_pp2_to_pp3_dp3_gpu2
	comm_pp2_to_pp3_dp3_gpu2 -> attn_pp3_dp3_gpu3_layer12
	attn_pp2_dp3_gpu3_layer8 -> route_pp2_dp3_gpu3_layer8
	route_pp2_dp3_gpu3_layer8 -> expert_pp2_dp3_gpu3_layer8_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp3_gpu3_layer8 -> expert_pp2_dp3_gpu3_layer8_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp3_gpu3_layer8 -> expert_pp2_dp3_gpu3_layer8_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp3_gpu3_layer8 -> expert_pp2_dp3_gpu3_layer8_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp3_gpu3_layer8_exp12 -> agg_pp2_dp3_gpu3_layer8
	expert_pp2_dp3_gpu3_layer8_exp13 -> agg_pp2_dp3_gpu3_layer8
	expert_pp2_dp3_gpu3_layer8_exp14 -> agg_pp2_dp3_gpu3_layer8
	expert_pp2_dp3_gpu3_layer8_exp15 -> agg_pp2_dp3_gpu3_layer8
	agg_pp2_dp3_gpu3_layer8 -> attn_pp2_dp3_gpu3_layer9
	attn_pp2_dp3_gpu3_layer9 -> route_pp2_dp3_gpu3_layer9
	route_pp2_dp3_gpu3_layer9 -> expert_pp2_dp3_gpu3_layer9_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp3_gpu3_layer9 -> expert_pp2_dp3_gpu3_layer9_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp3_gpu3_layer9 -> expert_pp2_dp3_gpu3_layer9_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp3_gpu3_layer9 -> expert_pp2_dp3_gpu3_layer9_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp3_gpu3_layer9_exp12 -> agg_pp2_dp3_gpu3_layer9
	expert_pp2_dp3_gpu3_layer9_exp13 -> agg_pp2_dp3_gpu3_layer9
	expert_pp2_dp3_gpu3_layer9_exp14 -> agg_pp2_dp3_gpu3_layer9
	expert_pp2_dp3_gpu3_layer9_exp15 -> agg_pp2_dp3_gpu3_layer9
	agg_pp2_dp3_gpu3_layer9 -> attn_pp2_dp3_gpu3_layer10
	attn_pp2_dp3_gpu3_layer10 -> route_pp2_dp3_gpu3_layer10
	route_pp2_dp3_gpu3_layer10 -> expert_pp2_dp3_gpu3_layer10_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp3_gpu3_layer10 -> expert_pp2_dp3_gpu3_layer10_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp3_gpu3_layer10 -> expert_pp2_dp3_gpu3_layer10_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp3_gpu3_layer10 -> expert_pp2_dp3_gpu3_layer10_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp3_gpu3_layer10_exp12 -> agg_pp2_dp3_gpu3_layer10
	expert_pp2_dp3_gpu3_layer10_exp13 -> agg_pp2_dp3_gpu3_layer10
	expert_pp2_dp3_gpu3_layer10_exp14 -> agg_pp2_dp3_gpu3_layer10
	expert_pp2_dp3_gpu3_layer10_exp15 -> agg_pp2_dp3_gpu3_layer10
	agg_pp2_dp3_gpu3_layer10 -> attn_pp2_dp3_gpu3_layer11
	attn_pp2_dp3_gpu3_layer11 -> route_pp2_dp3_gpu3_layer11
	route_pp2_dp3_gpu3_layer11 -> expert_pp2_dp3_gpu3_layer11_exp12 [label="Gated 12" style=dashed]
	route_pp2_dp3_gpu3_layer11 -> expert_pp2_dp3_gpu3_layer11_exp13 [label="Gated 13" style=dashed]
	route_pp2_dp3_gpu3_layer11 -> expert_pp2_dp3_gpu3_layer11_exp14 [label="Gated 14" style=dashed]
	route_pp2_dp3_gpu3_layer11 -> expert_pp2_dp3_gpu3_layer11_exp15 [label="Gated 15" style=dashed]
	expert_pp2_dp3_gpu3_layer11_exp12 -> agg_pp2_dp3_gpu3_layer11
	expert_pp2_dp3_gpu3_layer11_exp13 -> agg_pp2_dp3_gpu3_layer11
	expert_pp2_dp3_gpu3_layer11_exp14 -> agg_pp2_dp3_gpu3_layer11
	expert_pp2_dp3_gpu3_layer11_exp15 -> agg_pp2_dp3_gpu3_layer11
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp0_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp0_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp0_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp0_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp1_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp1_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp1_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp1_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp2_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp2_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp2_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp2_gpu3_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp3_gpu0_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp3_gpu1_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp3_gpu2_layer12
	comm_pp2_to_pp3_dp3_gpu3 [label="P2P Comm\nStage 2->3\nGPU 47\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	agg_pp2_dp3_gpu3_layer11 -> comm_pp2_to_pp3_dp3_gpu3
	comm_pp2_to_pp3_dp3_gpu3 -> attn_pp3_dp3_gpu3_layer12
	attn_pp3_dp0_gpu0_layer12 -> route_pp3_dp0_gpu0_layer12
	route_pp3_dp0_gpu0_layer12 -> expert_pp3_dp0_gpu0_layer12_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp0_gpu0_layer12 -> expert_pp3_dp0_gpu0_layer12_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp0_gpu0_layer12 -> expert_pp3_dp0_gpu0_layer12_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp0_gpu0_layer12 -> expert_pp3_dp0_gpu0_layer12_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp0_gpu0_layer12_exp0 -> agg_pp3_dp0_gpu0_layer12
	expert_pp3_dp0_gpu0_layer12_exp1 -> agg_pp3_dp0_gpu0_layer12
	expert_pp3_dp0_gpu0_layer12_exp2 -> agg_pp3_dp0_gpu0_layer12
	expert_pp3_dp0_gpu0_layer12_exp3 -> agg_pp3_dp0_gpu0_layer12
	agg_pp3_dp0_gpu0_layer12 -> attn_pp3_dp0_gpu0_layer13
	attn_pp3_dp0_gpu0_layer13 -> route_pp3_dp0_gpu0_layer13
	route_pp3_dp0_gpu0_layer13 -> expert_pp3_dp0_gpu0_layer13_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp0_gpu0_layer13 -> expert_pp3_dp0_gpu0_layer13_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp0_gpu0_layer13 -> expert_pp3_dp0_gpu0_layer13_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp0_gpu0_layer13 -> expert_pp3_dp0_gpu0_layer13_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp0_gpu0_layer13_exp0 -> agg_pp3_dp0_gpu0_layer13
	expert_pp3_dp0_gpu0_layer13_exp1 -> agg_pp3_dp0_gpu0_layer13
	expert_pp3_dp0_gpu0_layer13_exp2 -> agg_pp3_dp0_gpu0_layer13
	expert_pp3_dp0_gpu0_layer13_exp3 -> agg_pp3_dp0_gpu0_layer13
	agg_pp3_dp0_gpu0_layer13 -> attn_pp3_dp0_gpu0_layer14
	attn_pp3_dp0_gpu0_layer14 -> route_pp3_dp0_gpu0_layer14
	route_pp3_dp0_gpu0_layer14 -> expert_pp3_dp0_gpu0_layer14_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp0_gpu0_layer14 -> expert_pp3_dp0_gpu0_layer14_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp0_gpu0_layer14 -> expert_pp3_dp0_gpu0_layer14_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp0_gpu0_layer14 -> expert_pp3_dp0_gpu0_layer14_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp0_gpu0_layer14_exp0 -> agg_pp3_dp0_gpu0_layer14
	expert_pp3_dp0_gpu0_layer14_exp1 -> agg_pp3_dp0_gpu0_layer14
	expert_pp3_dp0_gpu0_layer14_exp2 -> agg_pp3_dp0_gpu0_layer14
	expert_pp3_dp0_gpu0_layer14_exp3 -> agg_pp3_dp0_gpu0_layer14
	agg_pp3_dp0_gpu0_layer14 -> attn_pp3_dp0_gpu0_layer15
	attn_pp3_dp0_gpu0_layer15 -> route_pp3_dp0_gpu0_layer15
	route_pp3_dp0_gpu0_layer15 -> expert_pp3_dp0_gpu0_layer15_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp0_gpu0_layer15 -> expert_pp3_dp0_gpu0_layer15_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp0_gpu0_layer15 -> expert_pp3_dp0_gpu0_layer15_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp0_gpu0_layer15 -> expert_pp3_dp0_gpu0_layer15_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp0_gpu0_layer15_exp0 -> agg_pp3_dp0_gpu0_layer15
	expert_pp3_dp0_gpu0_layer15_exp1 -> agg_pp3_dp0_gpu0_layer15
	expert_pp3_dp0_gpu0_layer15_exp2 -> agg_pp3_dp0_gpu0_layer15
	expert_pp3_dp0_gpu0_layer15_exp3 -> agg_pp3_dp0_gpu0_layer15
	output_dp0_gpu0 [label="Output\nGPU 48\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp0_gpu0_layer15 -> output_dp0_gpu0
	attn_pp3_dp0_gpu1_layer12 -> route_pp3_dp0_gpu1_layer12
	route_pp3_dp0_gpu1_layer12 -> expert_pp3_dp0_gpu1_layer12_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp0_gpu1_layer12 -> expert_pp3_dp0_gpu1_layer12_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp0_gpu1_layer12 -> expert_pp3_dp0_gpu1_layer12_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp0_gpu1_layer12 -> expert_pp3_dp0_gpu1_layer12_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp0_gpu1_layer12_exp4 -> agg_pp3_dp0_gpu1_layer12
	expert_pp3_dp0_gpu1_layer12_exp5 -> agg_pp3_dp0_gpu1_layer12
	expert_pp3_dp0_gpu1_layer12_exp6 -> agg_pp3_dp0_gpu1_layer12
	expert_pp3_dp0_gpu1_layer12_exp7 -> agg_pp3_dp0_gpu1_layer12
	agg_pp3_dp0_gpu1_layer12 -> attn_pp3_dp0_gpu1_layer13
	attn_pp3_dp0_gpu1_layer13 -> route_pp3_dp0_gpu1_layer13
	route_pp3_dp0_gpu1_layer13 -> expert_pp3_dp0_gpu1_layer13_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp0_gpu1_layer13 -> expert_pp3_dp0_gpu1_layer13_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp0_gpu1_layer13 -> expert_pp3_dp0_gpu1_layer13_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp0_gpu1_layer13 -> expert_pp3_dp0_gpu1_layer13_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp0_gpu1_layer13_exp4 -> agg_pp3_dp0_gpu1_layer13
	expert_pp3_dp0_gpu1_layer13_exp5 -> agg_pp3_dp0_gpu1_layer13
	expert_pp3_dp0_gpu1_layer13_exp6 -> agg_pp3_dp0_gpu1_layer13
	expert_pp3_dp0_gpu1_layer13_exp7 -> agg_pp3_dp0_gpu1_layer13
	agg_pp3_dp0_gpu1_layer13 -> attn_pp3_dp0_gpu1_layer14
	attn_pp3_dp0_gpu1_layer14 -> route_pp3_dp0_gpu1_layer14
	route_pp3_dp0_gpu1_layer14 -> expert_pp3_dp0_gpu1_layer14_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp0_gpu1_layer14 -> expert_pp3_dp0_gpu1_layer14_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp0_gpu1_layer14 -> expert_pp3_dp0_gpu1_layer14_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp0_gpu1_layer14 -> expert_pp3_dp0_gpu1_layer14_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp0_gpu1_layer14_exp4 -> agg_pp3_dp0_gpu1_layer14
	expert_pp3_dp0_gpu1_layer14_exp5 -> agg_pp3_dp0_gpu1_layer14
	expert_pp3_dp0_gpu1_layer14_exp6 -> agg_pp3_dp0_gpu1_layer14
	expert_pp3_dp0_gpu1_layer14_exp7 -> agg_pp3_dp0_gpu1_layer14
	agg_pp3_dp0_gpu1_layer14 -> attn_pp3_dp0_gpu1_layer15
	attn_pp3_dp0_gpu1_layer15 -> route_pp3_dp0_gpu1_layer15
	route_pp3_dp0_gpu1_layer15 -> expert_pp3_dp0_gpu1_layer15_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp0_gpu1_layer15 -> expert_pp3_dp0_gpu1_layer15_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp0_gpu1_layer15 -> expert_pp3_dp0_gpu1_layer15_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp0_gpu1_layer15 -> expert_pp3_dp0_gpu1_layer15_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp0_gpu1_layer15_exp4 -> agg_pp3_dp0_gpu1_layer15
	expert_pp3_dp0_gpu1_layer15_exp5 -> agg_pp3_dp0_gpu1_layer15
	expert_pp3_dp0_gpu1_layer15_exp6 -> agg_pp3_dp0_gpu1_layer15
	expert_pp3_dp0_gpu1_layer15_exp7 -> agg_pp3_dp0_gpu1_layer15
	output_dp0_gpu1 [label="Output\nGPU 49\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp0_gpu1_layer15 -> output_dp0_gpu1
	attn_pp3_dp0_gpu2_layer12 -> route_pp3_dp0_gpu2_layer12
	route_pp3_dp0_gpu2_layer12 -> expert_pp3_dp0_gpu2_layer12_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp0_gpu2_layer12 -> expert_pp3_dp0_gpu2_layer12_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp0_gpu2_layer12 -> expert_pp3_dp0_gpu2_layer12_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp0_gpu2_layer12 -> expert_pp3_dp0_gpu2_layer12_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp0_gpu2_layer12_exp8 -> agg_pp3_dp0_gpu2_layer12
	expert_pp3_dp0_gpu2_layer12_exp9 -> agg_pp3_dp0_gpu2_layer12
	expert_pp3_dp0_gpu2_layer12_exp10 -> agg_pp3_dp0_gpu2_layer12
	expert_pp3_dp0_gpu2_layer12_exp11 -> agg_pp3_dp0_gpu2_layer12
	agg_pp3_dp0_gpu2_layer12 -> attn_pp3_dp0_gpu2_layer13
	attn_pp3_dp0_gpu2_layer13 -> route_pp3_dp0_gpu2_layer13
	route_pp3_dp0_gpu2_layer13 -> expert_pp3_dp0_gpu2_layer13_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp0_gpu2_layer13 -> expert_pp3_dp0_gpu2_layer13_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp0_gpu2_layer13 -> expert_pp3_dp0_gpu2_layer13_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp0_gpu2_layer13 -> expert_pp3_dp0_gpu2_layer13_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp0_gpu2_layer13_exp8 -> agg_pp3_dp0_gpu2_layer13
	expert_pp3_dp0_gpu2_layer13_exp9 -> agg_pp3_dp0_gpu2_layer13
	expert_pp3_dp0_gpu2_layer13_exp10 -> agg_pp3_dp0_gpu2_layer13
	expert_pp3_dp0_gpu2_layer13_exp11 -> agg_pp3_dp0_gpu2_layer13
	agg_pp3_dp0_gpu2_layer13 -> attn_pp3_dp0_gpu2_layer14
	attn_pp3_dp0_gpu2_layer14 -> route_pp3_dp0_gpu2_layer14
	route_pp3_dp0_gpu2_layer14 -> expert_pp3_dp0_gpu2_layer14_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp0_gpu2_layer14 -> expert_pp3_dp0_gpu2_layer14_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp0_gpu2_layer14 -> expert_pp3_dp0_gpu2_layer14_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp0_gpu2_layer14 -> expert_pp3_dp0_gpu2_layer14_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp0_gpu2_layer14_exp8 -> agg_pp3_dp0_gpu2_layer14
	expert_pp3_dp0_gpu2_layer14_exp9 -> agg_pp3_dp0_gpu2_layer14
	expert_pp3_dp0_gpu2_layer14_exp10 -> agg_pp3_dp0_gpu2_layer14
	expert_pp3_dp0_gpu2_layer14_exp11 -> agg_pp3_dp0_gpu2_layer14
	agg_pp3_dp0_gpu2_layer14 -> attn_pp3_dp0_gpu2_layer15
	attn_pp3_dp0_gpu2_layer15 -> route_pp3_dp0_gpu2_layer15
	route_pp3_dp0_gpu2_layer15 -> expert_pp3_dp0_gpu2_layer15_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp0_gpu2_layer15 -> expert_pp3_dp0_gpu2_layer15_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp0_gpu2_layer15 -> expert_pp3_dp0_gpu2_layer15_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp0_gpu2_layer15 -> expert_pp3_dp0_gpu2_layer15_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp0_gpu2_layer15_exp8 -> agg_pp3_dp0_gpu2_layer15
	expert_pp3_dp0_gpu2_layer15_exp9 -> agg_pp3_dp0_gpu2_layer15
	expert_pp3_dp0_gpu2_layer15_exp10 -> agg_pp3_dp0_gpu2_layer15
	expert_pp3_dp0_gpu2_layer15_exp11 -> agg_pp3_dp0_gpu2_layer15
	output_dp0_gpu2 [label="Output\nGPU 50\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp0_gpu2_layer15 -> output_dp0_gpu2
	attn_pp3_dp0_gpu3_layer12 -> route_pp3_dp0_gpu3_layer12
	route_pp3_dp0_gpu3_layer12 -> expert_pp3_dp0_gpu3_layer12_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp0_gpu3_layer12 -> expert_pp3_dp0_gpu3_layer12_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp0_gpu3_layer12 -> expert_pp3_dp0_gpu3_layer12_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp0_gpu3_layer12 -> expert_pp3_dp0_gpu3_layer12_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp0_gpu3_layer12_exp12 -> agg_pp3_dp0_gpu3_layer12
	expert_pp3_dp0_gpu3_layer12_exp13 -> agg_pp3_dp0_gpu3_layer12
	expert_pp3_dp0_gpu3_layer12_exp14 -> agg_pp3_dp0_gpu3_layer12
	expert_pp3_dp0_gpu3_layer12_exp15 -> agg_pp3_dp0_gpu3_layer12
	agg_pp3_dp0_gpu3_layer12 -> attn_pp3_dp0_gpu3_layer13
	attn_pp3_dp0_gpu3_layer13 -> route_pp3_dp0_gpu3_layer13
	route_pp3_dp0_gpu3_layer13 -> expert_pp3_dp0_gpu3_layer13_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp0_gpu3_layer13 -> expert_pp3_dp0_gpu3_layer13_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp0_gpu3_layer13 -> expert_pp3_dp0_gpu3_layer13_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp0_gpu3_layer13 -> expert_pp3_dp0_gpu3_layer13_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp0_gpu3_layer13_exp12 -> agg_pp3_dp0_gpu3_layer13
	expert_pp3_dp0_gpu3_layer13_exp13 -> agg_pp3_dp0_gpu3_layer13
	expert_pp3_dp0_gpu3_layer13_exp14 -> agg_pp3_dp0_gpu3_layer13
	expert_pp3_dp0_gpu3_layer13_exp15 -> agg_pp3_dp0_gpu3_layer13
	agg_pp3_dp0_gpu3_layer13 -> attn_pp3_dp0_gpu3_layer14
	attn_pp3_dp0_gpu3_layer14 -> route_pp3_dp0_gpu3_layer14
	route_pp3_dp0_gpu3_layer14 -> expert_pp3_dp0_gpu3_layer14_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp0_gpu3_layer14 -> expert_pp3_dp0_gpu3_layer14_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp0_gpu3_layer14 -> expert_pp3_dp0_gpu3_layer14_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp0_gpu3_layer14 -> expert_pp3_dp0_gpu3_layer14_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp0_gpu3_layer14_exp12 -> agg_pp3_dp0_gpu3_layer14
	expert_pp3_dp0_gpu3_layer14_exp13 -> agg_pp3_dp0_gpu3_layer14
	expert_pp3_dp0_gpu3_layer14_exp14 -> agg_pp3_dp0_gpu3_layer14
	expert_pp3_dp0_gpu3_layer14_exp15 -> agg_pp3_dp0_gpu3_layer14
	agg_pp3_dp0_gpu3_layer14 -> attn_pp3_dp0_gpu3_layer15
	attn_pp3_dp0_gpu3_layer15 -> route_pp3_dp0_gpu3_layer15
	route_pp3_dp0_gpu3_layer15 -> expert_pp3_dp0_gpu3_layer15_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp0_gpu3_layer15 -> expert_pp3_dp0_gpu3_layer15_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp0_gpu3_layer15 -> expert_pp3_dp0_gpu3_layer15_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp0_gpu3_layer15 -> expert_pp3_dp0_gpu3_layer15_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp0_gpu3_layer15_exp12 -> agg_pp3_dp0_gpu3_layer15
	expert_pp3_dp0_gpu3_layer15_exp13 -> agg_pp3_dp0_gpu3_layer15
	expert_pp3_dp0_gpu3_layer15_exp14 -> agg_pp3_dp0_gpu3_layer15
	expert_pp3_dp0_gpu3_layer15_exp15 -> agg_pp3_dp0_gpu3_layer15
	output_dp0_gpu3 [label="Output\nGPU 51\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp0_gpu3_layer15 -> output_dp0_gpu3
	attn_pp3_dp1_gpu0_layer12 -> route_pp3_dp1_gpu0_layer12
	route_pp3_dp1_gpu0_layer12 -> expert_pp3_dp1_gpu0_layer12_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp1_gpu0_layer12 -> expert_pp3_dp1_gpu0_layer12_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp1_gpu0_layer12 -> expert_pp3_dp1_gpu0_layer12_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp1_gpu0_layer12 -> expert_pp3_dp1_gpu0_layer12_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp1_gpu0_layer12_exp0 -> agg_pp3_dp1_gpu0_layer12
	expert_pp3_dp1_gpu0_layer12_exp1 -> agg_pp3_dp1_gpu0_layer12
	expert_pp3_dp1_gpu0_layer12_exp2 -> agg_pp3_dp1_gpu0_layer12
	expert_pp3_dp1_gpu0_layer12_exp3 -> agg_pp3_dp1_gpu0_layer12
	agg_pp3_dp1_gpu0_layer12 -> attn_pp3_dp1_gpu0_layer13
	attn_pp3_dp1_gpu0_layer13 -> route_pp3_dp1_gpu0_layer13
	route_pp3_dp1_gpu0_layer13 -> expert_pp3_dp1_gpu0_layer13_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp1_gpu0_layer13 -> expert_pp3_dp1_gpu0_layer13_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp1_gpu0_layer13 -> expert_pp3_dp1_gpu0_layer13_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp1_gpu0_layer13 -> expert_pp3_dp1_gpu0_layer13_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp1_gpu0_layer13_exp0 -> agg_pp3_dp1_gpu0_layer13
	expert_pp3_dp1_gpu0_layer13_exp1 -> agg_pp3_dp1_gpu0_layer13
	expert_pp3_dp1_gpu0_layer13_exp2 -> agg_pp3_dp1_gpu0_layer13
	expert_pp3_dp1_gpu0_layer13_exp3 -> agg_pp3_dp1_gpu0_layer13
	agg_pp3_dp1_gpu0_layer13 -> attn_pp3_dp1_gpu0_layer14
	attn_pp3_dp1_gpu0_layer14 -> route_pp3_dp1_gpu0_layer14
	route_pp3_dp1_gpu0_layer14 -> expert_pp3_dp1_gpu0_layer14_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp1_gpu0_layer14 -> expert_pp3_dp1_gpu0_layer14_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp1_gpu0_layer14 -> expert_pp3_dp1_gpu0_layer14_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp1_gpu0_layer14 -> expert_pp3_dp1_gpu0_layer14_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp1_gpu0_layer14_exp0 -> agg_pp3_dp1_gpu0_layer14
	expert_pp3_dp1_gpu0_layer14_exp1 -> agg_pp3_dp1_gpu0_layer14
	expert_pp3_dp1_gpu0_layer14_exp2 -> agg_pp3_dp1_gpu0_layer14
	expert_pp3_dp1_gpu0_layer14_exp3 -> agg_pp3_dp1_gpu0_layer14
	agg_pp3_dp1_gpu0_layer14 -> attn_pp3_dp1_gpu0_layer15
	attn_pp3_dp1_gpu0_layer15 -> route_pp3_dp1_gpu0_layer15
	route_pp3_dp1_gpu0_layer15 -> expert_pp3_dp1_gpu0_layer15_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp1_gpu0_layer15 -> expert_pp3_dp1_gpu0_layer15_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp1_gpu0_layer15 -> expert_pp3_dp1_gpu0_layer15_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp1_gpu0_layer15 -> expert_pp3_dp1_gpu0_layer15_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp1_gpu0_layer15_exp0 -> agg_pp3_dp1_gpu0_layer15
	expert_pp3_dp1_gpu0_layer15_exp1 -> agg_pp3_dp1_gpu0_layer15
	expert_pp3_dp1_gpu0_layer15_exp2 -> agg_pp3_dp1_gpu0_layer15
	expert_pp3_dp1_gpu0_layer15_exp3 -> agg_pp3_dp1_gpu0_layer15
	output_dp1_gpu0 [label="Output\nGPU 52\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp1_gpu0_layer15 -> output_dp1_gpu0
	attn_pp3_dp1_gpu1_layer12 -> route_pp3_dp1_gpu1_layer12
	route_pp3_dp1_gpu1_layer12 -> expert_pp3_dp1_gpu1_layer12_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp1_gpu1_layer12 -> expert_pp3_dp1_gpu1_layer12_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp1_gpu1_layer12 -> expert_pp3_dp1_gpu1_layer12_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp1_gpu1_layer12 -> expert_pp3_dp1_gpu1_layer12_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp1_gpu1_layer12_exp4 -> agg_pp3_dp1_gpu1_layer12
	expert_pp3_dp1_gpu1_layer12_exp5 -> agg_pp3_dp1_gpu1_layer12
	expert_pp3_dp1_gpu1_layer12_exp6 -> agg_pp3_dp1_gpu1_layer12
	expert_pp3_dp1_gpu1_layer12_exp7 -> agg_pp3_dp1_gpu1_layer12
	agg_pp3_dp1_gpu1_layer12 -> attn_pp3_dp1_gpu1_layer13
	attn_pp3_dp1_gpu1_layer13 -> route_pp3_dp1_gpu1_layer13
	route_pp3_dp1_gpu1_layer13 -> expert_pp3_dp1_gpu1_layer13_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp1_gpu1_layer13 -> expert_pp3_dp1_gpu1_layer13_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp1_gpu1_layer13 -> expert_pp3_dp1_gpu1_layer13_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp1_gpu1_layer13 -> expert_pp3_dp1_gpu1_layer13_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp1_gpu1_layer13_exp4 -> agg_pp3_dp1_gpu1_layer13
	expert_pp3_dp1_gpu1_layer13_exp5 -> agg_pp3_dp1_gpu1_layer13
	expert_pp3_dp1_gpu1_layer13_exp6 -> agg_pp3_dp1_gpu1_layer13
	expert_pp3_dp1_gpu1_layer13_exp7 -> agg_pp3_dp1_gpu1_layer13
	agg_pp3_dp1_gpu1_layer13 -> attn_pp3_dp1_gpu1_layer14
	attn_pp3_dp1_gpu1_layer14 -> route_pp3_dp1_gpu1_layer14
	route_pp3_dp1_gpu1_layer14 -> expert_pp3_dp1_gpu1_layer14_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp1_gpu1_layer14 -> expert_pp3_dp1_gpu1_layer14_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp1_gpu1_layer14 -> expert_pp3_dp1_gpu1_layer14_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp1_gpu1_layer14 -> expert_pp3_dp1_gpu1_layer14_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp1_gpu1_layer14_exp4 -> agg_pp3_dp1_gpu1_layer14
	expert_pp3_dp1_gpu1_layer14_exp5 -> agg_pp3_dp1_gpu1_layer14
	expert_pp3_dp1_gpu1_layer14_exp6 -> agg_pp3_dp1_gpu1_layer14
	expert_pp3_dp1_gpu1_layer14_exp7 -> agg_pp3_dp1_gpu1_layer14
	agg_pp3_dp1_gpu1_layer14 -> attn_pp3_dp1_gpu1_layer15
	attn_pp3_dp1_gpu1_layer15 -> route_pp3_dp1_gpu1_layer15
	route_pp3_dp1_gpu1_layer15 -> expert_pp3_dp1_gpu1_layer15_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp1_gpu1_layer15 -> expert_pp3_dp1_gpu1_layer15_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp1_gpu1_layer15 -> expert_pp3_dp1_gpu1_layer15_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp1_gpu1_layer15 -> expert_pp3_dp1_gpu1_layer15_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp1_gpu1_layer15_exp4 -> agg_pp3_dp1_gpu1_layer15
	expert_pp3_dp1_gpu1_layer15_exp5 -> agg_pp3_dp1_gpu1_layer15
	expert_pp3_dp1_gpu1_layer15_exp6 -> agg_pp3_dp1_gpu1_layer15
	expert_pp3_dp1_gpu1_layer15_exp7 -> agg_pp3_dp1_gpu1_layer15
	output_dp1_gpu1 [label="Output\nGPU 53\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp1_gpu1_layer15 -> output_dp1_gpu1
	attn_pp3_dp1_gpu2_layer12 -> route_pp3_dp1_gpu2_layer12
	route_pp3_dp1_gpu2_layer12 -> expert_pp3_dp1_gpu2_layer12_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp1_gpu2_layer12 -> expert_pp3_dp1_gpu2_layer12_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp1_gpu2_layer12 -> expert_pp3_dp1_gpu2_layer12_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp1_gpu2_layer12 -> expert_pp3_dp1_gpu2_layer12_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp1_gpu2_layer12_exp8 -> agg_pp3_dp1_gpu2_layer12
	expert_pp3_dp1_gpu2_layer12_exp9 -> agg_pp3_dp1_gpu2_layer12
	expert_pp3_dp1_gpu2_layer12_exp10 -> agg_pp3_dp1_gpu2_layer12
	expert_pp3_dp1_gpu2_layer12_exp11 -> agg_pp3_dp1_gpu2_layer12
	agg_pp3_dp1_gpu2_layer12 -> attn_pp3_dp1_gpu2_layer13
	attn_pp3_dp1_gpu2_layer13 -> route_pp3_dp1_gpu2_layer13
	route_pp3_dp1_gpu2_layer13 -> expert_pp3_dp1_gpu2_layer13_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp1_gpu2_layer13 -> expert_pp3_dp1_gpu2_layer13_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp1_gpu2_layer13 -> expert_pp3_dp1_gpu2_layer13_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp1_gpu2_layer13 -> expert_pp3_dp1_gpu2_layer13_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp1_gpu2_layer13_exp8 -> agg_pp3_dp1_gpu2_layer13
	expert_pp3_dp1_gpu2_layer13_exp9 -> agg_pp3_dp1_gpu2_layer13
	expert_pp3_dp1_gpu2_layer13_exp10 -> agg_pp3_dp1_gpu2_layer13
	expert_pp3_dp1_gpu2_layer13_exp11 -> agg_pp3_dp1_gpu2_layer13
	agg_pp3_dp1_gpu2_layer13 -> attn_pp3_dp1_gpu2_layer14
	attn_pp3_dp1_gpu2_layer14 -> route_pp3_dp1_gpu2_layer14
	route_pp3_dp1_gpu2_layer14 -> expert_pp3_dp1_gpu2_layer14_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp1_gpu2_layer14 -> expert_pp3_dp1_gpu2_layer14_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp1_gpu2_layer14 -> expert_pp3_dp1_gpu2_layer14_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp1_gpu2_layer14 -> expert_pp3_dp1_gpu2_layer14_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp1_gpu2_layer14_exp8 -> agg_pp3_dp1_gpu2_layer14
	expert_pp3_dp1_gpu2_layer14_exp9 -> agg_pp3_dp1_gpu2_layer14
	expert_pp3_dp1_gpu2_layer14_exp10 -> agg_pp3_dp1_gpu2_layer14
	expert_pp3_dp1_gpu2_layer14_exp11 -> agg_pp3_dp1_gpu2_layer14
	agg_pp3_dp1_gpu2_layer14 -> attn_pp3_dp1_gpu2_layer15
	attn_pp3_dp1_gpu2_layer15 -> route_pp3_dp1_gpu2_layer15
	route_pp3_dp1_gpu2_layer15 -> expert_pp3_dp1_gpu2_layer15_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp1_gpu2_layer15 -> expert_pp3_dp1_gpu2_layer15_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp1_gpu2_layer15 -> expert_pp3_dp1_gpu2_layer15_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp1_gpu2_layer15 -> expert_pp3_dp1_gpu2_layer15_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp1_gpu2_layer15_exp8 -> agg_pp3_dp1_gpu2_layer15
	expert_pp3_dp1_gpu2_layer15_exp9 -> agg_pp3_dp1_gpu2_layer15
	expert_pp3_dp1_gpu2_layer15_exp10 -> agg_pp3_dp1_gpu2_layer15
	expert_pp3_dp1_gpu2_layer15_exp11 -> agg_pp3_dp1_gpu2_layer15
	output_dp1_gpu2 [label="Output\nGPU 54\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp1_gpu2_layer15 -> output_dp1_gpu2
	attn_pp3_dp1_gpu3_layer12 -> route_pp3_dp1_gpu3_layer12
	route_pp3_dp1_gpu3_layer12 -> expert_pp3_dp1_gpu3_layer12_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp1_gpu3_layer12 -> expert_pp3_dp1_gpu3_layer12_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp1_gpu3_layer12 -> expert_pp3_dp1_gpu3_layer12_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp1_gpu3_layer12 -> expert_pp3_dp1_gpu3_layer12_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp1_gpu3_layer12_exp12 -> agg_pp3_dp1_gpu3_layer12
	expert_pp3_dp1_gpu3_layer12_exp13 -> agg_pp3_dp1_gpu3_layer12
	expert_pp3_dp1_gpu3_layer12_exp14 -> agg_pp3_dp1_gpu3_layer12
	expert_pp3_dp1_gpu3_layer12_exp15 -> agg_pp3_dp1_gpu3_layer12
	agg_pp3_dp1_gpu3_layer12 -> attn_pp3_dp1_gpu3_layer13
	attn_pp3_dp1_gpu3_layer13 -> route_pp3_dp1_gpu3_layer13
	route_pp3_dp1_gpu3_layer13 -> expert_pp3_dp1_gpu3_layer13_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp1_gpu3_layer13 -> expert_pp3_dp1_gpu3_layer13_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp1_gpu3_layer13 -> expert_pp3_dp1_gpu3_layer13_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp1_gpu3_layer13 -> expert_pp3_dp1_gpu3_layer13_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp1_gpu3_layer13_exp12 -> agg_pp3_dp1_gpu3_layer13
	expert_pp3_dp1_gpu3_layer13_exp13 -> agg_pp3_dp1_gpu3_layer13
	expert_pp3_dp1_gpu3_layer13_exp14 -> agg_pp3_dp1_gpu3_layer13
	expert_pp3_dp1_gpu3_layer13_exp15 -> agg_pp3_dp1_gpu3_layer13
	agg_pp3_dp1_gpu3_layer13 -> attn_pp3_dp1_gpu3_layer14
	attn_pp3_dp1_gpu3_layer14 -> route_pp3_dp1_gpu3_layer14
	route_pp3_dp1_gpu3_layer14 -> expert_pp3_dp1_gpu3_layer14_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp1_gpu3_layer14 -> expert_pp3_dp1_gpu3_layer14_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp1_gpu3_layer14 -> expert_pp3_dp1_gpu3_layer14_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp1_gpu3_layer14 -> expert_pp3_dp1_gpu3_layer14_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp1_gpu3_layer14_exp12 -> agg_pp3_dp1_gpu3_layer14
	expert_pp3_dp1_gpu3_layer14_exp13 -> agg_pp3_dp1_gpu3_layer14
	expert_pp3_dp1_gpu3_layer14_exp14 -> agg_pp3_dp1_gpu3_layer14
	expert_pp3_dp1_gpu3_layer14_exp15 -> agg_pp3_dp1_gpu3_layer14
	agg_pp3_dp1_gpu3_layer14 -> attn_pp3_dp1_gpu3_layer15
	attn_pp3_dp1_gpu3_layer15 -> route_pp3_dp1_gpu3_layer15
	route_pp3_dp1_gpu3_layer15 -> expert_pp3_dp1_gpu3_layer15_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp1_gpu3_layer15 -> expert_pp3_dp1_gpu3_layer15_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp1_gpu3_layer15 -> expert_pp3_dp1_gpu3_layer15_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp1_gpu3_layer15 -> expert_pp3_dp1_gpu3_layer15_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp1_gpu3_layer15_exp12 -> agg_pp3_dp1_gpu3_layer15
	expert_pp3_dp1_gpu3_layer15_exp13 -> agg_pp3_dp1_gpu3_layer15
	expert_pp3_dp1_gpu3_layer15_exp14 -> agg_pp3_dp1_gpu3_layer15
	expert_pp3_dp1_gpu3_layer15_exp15 -> agg_pp3_dp1_gpu3_layer15
	output_dp1_gpu3 [label="Output\nGPU 55\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp1_gpu3_layer15 -> output_dp1_gpu3
	attn_pp3_dp2_gpu0_layer12 -> route_pp3_dp2_gpu0_layer12
	route_pp3_dp2_gpu0_layer12 -> expert_pp3_dp2_gpu0_layer12_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp2_gpu0_layer12 -> expert_pp3_dp2_gpu0_layer12_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp2_gpu0_layer12 -> expert_pp3_dp2_gpu0_layer12_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp2_gpu0_layer12 -> expert_pp3_dp2_gpu0_layer12_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp2_gpu0_layer12_exp0 -> agg_pp3_dp2_gpu0_layer12
	expert_pp3_dp2_gpu0_layer12_exp1 -> agg_pp3_dp2_gpu0_layer12
	expert_pp3_dp2_gpu0_layer12_exp2 -> agg_pp3_dp2_gpu0_layer12
	expert_pp3_dp2_gpu0_layer12_exp3 -> agg_pp3_dp2_gpu0_layer12
	agg_pp3_dp2_gpu0_layer12 -> attn_pp3_dp2_gpu0_layer13
	attn_pp3_dp2_gpu0_layer13 -> route_pp3_dp2_gpu0_layer13
	route_pp3_dp2_gpu0_layer13 -> expert_pp3_dp2_gpu0_layer13_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp2_gpu0_layer13 -> expert_pp3_dp2_gpu0_layer13_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp2_gpu0_layer13 -> expert_pp3_dp2_gpu0_layer13_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp2_gpu0_layer13 -> expert_pp3_dp2_gpu0_layer13_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp2_gpu0_layer13_exp0 -> agg_pp3_dp2_gpu0_layer13
	expert_pp3_dp2_gpu0_layer13_exp1 -> agg_pp3_dp2_gpu0_layer13
	expert_pp3_dp2_gpu0_layer13_exp2 -> agg_pp3_dp2_gpu0_layer13
	expert_pp3_dp2_gpu0_layer13_exp3 -> agg_pp3_dp2_gpu0_layer13
	agg_pp3_dp2_gpu0_layer13 -> attn_pp3_dp2_gpu0_layer14
	attn_pp3_dp2_gpu0_layer14 -> route_pp3_dp2_gpu0_layer14
	route_pp3_dp2_gpu0_layer14 -> expert_pp3_dp2_gpu0_layer14_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp2_gpu0_layer14 -> expert_pp3_dp2_gpu0_layer14_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp2_gpu0_layer14 -> expert_pp3_dp2_gpu0_layer14_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp2_gpu0_layer14 -> expert_pp3_dp2_gpu0_layer14_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp2_gpu0_layer14_exp0 -> agg_pp3_dp2_gpu0_layer14
	expert_pp3_dp2_gpu0_layer14_exp1 -> agg_pp3_dp2_gpu0_layer14
	expert_pp3_dp2_gpu0_layer14_exp2 -> agg_pp3_dp2_gpu0_layer14
	expert_pp3_dp2_gpu0_layer14_exp3 -> agg_pp3_dp2_gpu0_layer14
	agg_pp3_dp2_gpu0_layer14 -> attn_pp3_dp2_gpu0_layer15
	attn_pp3_dp2_gpu0_layer15 -> route_pp3_dp2_gpu0_layer15
	route_pp3_dp2_gpu0_layer15 -> expert_pp3_dp2_gpu0_layer15_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp2_gpu0_layer15 -> expert_pp3_dp2_gpu0_layer15_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp2_gpu0_layer15 -> expert_pp3_dp2_gpu0_layer15_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp2_gpu0_layer15 -> expert_pp3_dp2_gpu0_layer15_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp2_gpu0_layer15_exp0 -> agg_pp3_dp2_gpu0_layer15
	expert_pp3_dp2_gpu0_layer15_exp1 -> agg_pp3_dp2_gpu0_layer15
	expert_pp3_dp2_gpu0_layer15_exp2 -> agg_pp3_dp2_gpu0_layer15
	expert_pp3_dp2_gpu0_layer15_exp3 -> agg_pp3_dp2_gpu0_layer15
	output_dp2_gpu0 [label="Output\nGPU 56\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp2_gpu0_layer15 -> output_dp2_gpu0
	attn_pp3_dp2_gpu1_layer12 -> route_pp3_dp2_gpu1_layer12
	route_pp3_dp2_gpu1_layer12 -> expert_pp3_dp2_gpu1_layer12_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp2_gpu1_layer12 -> expert_pp3_dp2_gpu1_layer12_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp2_gpu1_layer12 -> expert_pp3_dp2_gpu1_layer12_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp2_gpu1_layer12 -> expert_pp3_dp2_gpu1_layer12_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp2_gpu1_layer12_exp4 -> agg_pp3_dp2_gpu1_layer12
	expert_pp3_dp2_gpu1_layer12_exp5 -> agg_pp3_dp2_gpu1_layer12
	expert_pp3_dp2_gpu1_layer12_exp6 -> agg_pp3_dp2_gpu1_layer12
	expert_pp3_dp2_gpu1_layer12_exp7 -> agg_pp3_dp2_gpu1_layer12
	agg_pp3_dp2_gpu1_layer12 -> attn_pp3_dp2_gpu1_layer13
	attn_pp3_dp2_gpu1_layer13 -> route_pp3_dp2_gpu1_layer13
	route_pp3_dp2_gpu1_layer13 -> expert_pp3_dp2_gpu1_layer13_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp2_gpu1_layer13 -> expert_pp3_dp2_gpu1_layer13_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp2_gpu1_layer13 -> expert_pp3_dp2_gpu1_layer13_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp2_gpu1_layer13 -> expert_pp3_dp2_gpu1_layer13_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp2_gpu1_layer13_exp4 -> agg_pp3_dp2_gpu1_layer13
	expert_pp3_dp2_gpu1_layer13_exp5 -> agg_pp3_dp2_gpu1_layer13
	expert_pp3_dp2_gpu1_layer13_exp6 -> agg_pp3_dp2_gpu1_layer13
	expert_pp3_dp2_gpu1_layer13_exp7 -> agg_pp3_dp2_gpu1_layer13
	agg_pp3_dp2_gpu1_layer13 -> attn_pp3_dp2_gpu1_layer14
	attn_pp3_dp2_gpu1_layer14 -> route_pp3_dp2_gpu1_layer14
	route_pp3_dp2_gpu1_layer14 -> expert_pp3_dp2_gpu1_layer14_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp2_gpu1_layer14 -> expert_pp3_dp2_gpu1_layer14_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp2_gpu1_layer14 -> expert_pp3_dp2_gpu1_layer14_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp2_gpu1_layer14 -> expert_pp3_dp2_gpu1_layer14_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp2_gpu1_layer14_exp4 -> agg_pp3_dp2_gpu1_layer14
	expert_pp3_dp2_gpu1_layer14_exp5 -> agg_pp3_dp2_gpu1_layer14
	expert_pp3_dp2_gpu1_layer14_exp6 -> agg_pp3_dp2_gpu1_layer14
	expert_pp3_dp2_gpu1_layer14_exp7 -> agg_pp3_dp2_gpu1_layer14
	agg_pp3_dp2_gpu1_layer14 -> attn_pp3_dp2_gpu1_layer15
	attn_pp3_dp2_gpu1_layer15 -> route_pp3_dp2_gpu1_layer15
	route_pp3_dp2_gpu1_layer15 -> expert_pp3_dp2_gpu1_layer15_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp2_gpu1_layer15 -> expert_pp3_dp2_gpu1_layer15_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp2_gpu1_layer15 -> expert_pp3_dp2_gpu1_layer15_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp2_gpu1_layer15 -> expert_pp3_dp2_gpu1_layer15_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp2_gpu1_layer15_exp4 -> agg_pp3_dp2_gpu1_layer15
	expert_pp3_dp2_gpu1_layer15_exp5 -> agg_pp3_dp2_gpu1_layer15
	expert_pp3_dp2_gpu1_layer15_exp6 -> agg_pp3_dp2_gpu1_layer15
	expert_pp3_dp2_gpu1_layer15_exp7 -> agg_pp3_dp2_gpu1_layer15
	output_dp2_gpu1 [label="Output\nGPU 57\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp2_gpu1_layer15 -> output_dp2_gpu1
	attn_pp3_dp2_gpu2_layer12 -> route_pp3_dp2_gpu2_layer12
	route_pp3_dp2_gpu2_layer12 -> expert_pp3_dp2_gpu2_layer12_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp2_gpu2_layer12 -> expert_pp3_dp2_gpu2_layer12_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp2_gpu2_layer12 -> expert_pp3_dp2_gpu2_layer12_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp2_gpu2_layer12 -> expert_pp3_dp2_gpu2_layer12_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp2_gpu2_layer12_exp8 -> agg_pp3_dp2_gpu2_layer12
	expert_pp3_dp2_gpu2_layer12_exp9 -> agg_pp3_dp2_gpu2_layer12
	expert_pp3_dp2_gpu2_layer12_exp10 -> agg_pp3_dp2_gpu2_layer12
	expert_pp3_dp2_gpu2_layer12_exp11 -> agg_pp3_dp2_gpu2_layer12
	agg_pp3_dp2_gpu2_layer12 -> attn_pp3_dp2_gpu2_layer13
	attn_pp3_dp2_gpu2_layer13 -> route_pp3_dp2_gpu2_layer13
	route_pp3_dp2_gpu2_layer13 -> expert_pp3_dp2_gpu2_layer13_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp2_gpu2_layer13 -> expert_pp3_dp2_gpu2_layer13_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp2_gpu2_layer13 -> expert_pp3_dp2_gpu2_layer13_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp2_gpu2_layer13 -> expert_pp3_dp2_gpu2_layer13_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp2_gpu2_layer13_exp8 -> agg_pp3_dp2_gpu2_layer13
	expert_pp3_dp2_gpu2_layer13_exp9 -> agg_pp3_dp2_gpu2_layer13
	expert_pp3_dp2_gpu2_layer13_exp10 -> agg_pp3_dp2_gpu2_layer13
	expert_pp3_dp2_gpu2_layer13_exp11 -> agg_pp3_dp2_gpu2_layer13
	agg_pp3_dp2_gpu2_layer13 -> attn_pp3_dp2_gpu2_layer14
	attn_pp3_dp2_gpu2_layer14 -> route_pp3_dp2_gpu2_layer14
	route_pp3_dp2_gpu2_layer14 -> expert_pp3_dp2_gpu2_layer14_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp2_gpu2_layer14 -> expert_pp3_dp2_gpu2_layer14_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp2_gpu2_layer14 -> expert_pp3_dp2_gpu2_layer14_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp2_gpu2_layer14 -> expert_pp3_dp2_gpu2_layer14_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp2_gpu2_layer14_exp8 -> agg_pp3_dp2_gpu2_layer14
	expert_pp3_dp2_gpu2_layer14_exp9 -> agg_pp3_dp2_gpu2_layer14
	expert_pp3_dp2_gpu2_layer14_exp10 -> agg_pp3_dp2_gpu2_layer14
	expert_pp3_dp2_gpu2_layer14_exp11 -> agg_pp3_dp2_gpu2_layer14
	agg_pp3_dp2_gpu2_layer14 -> attn_pp3_dp2_gpu2_layer15
	attn_pp3_dp2_gpu2_layer15 -> route_pp3_dp2_gpu2_layer15
	route_pp3_dp2_gpu2_layer15 -> expert_pp3_dp2_gpu2_layer15_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp2_gpu2_layer15 -> expert_pp3_dp2_gpu2_layer15_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp2_gpu2_layer15 -> expert_pp3_dp2_gpu2_layer15_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp2_gpu2_layer15 -> expert_pp3_dp2_gpu2_layer15_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp2_gpu2_layer15_exp8 -> agg_pp3_dp2_gpu2_layer15
	expert_pp3_dp2_gpu2_layer15_exp9 -> agg_pp3_dp2_gpu2_layer15
	expert_pp3_dp2_gpu2_layer15_exp10 -> agg_pp3_dp2_gpu2_layer15
	expert_pp3_dp2_gpu2_layer15_exp11 -> agg_pp3_dp2_gpu2_layer15
	output_dp2_gpu2 [label="Output\nGPU 58\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp2_gpu2_layer15 -> output_dp2_gpu2
	attn_pp3_dp2_gpu3_layer12 -> route_pp3_dp2_gpu3_layer12
	route_pp3_dp2_gpu3_layer12 -> expert_pp3_dp2_gpu3_layer12_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp2_gpu3_layer12 -> expert_pp3_dp2_gpu3_layer12_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp2_gpu3_layer12 -> expert_pp3_dp2_gpu3_layer12_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp2_gpu3_layer12 -> expert_pp3_dp2_gpu3_layer12_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp2_gpu3_layer12_exp12 -> agg_pp3_dp2_gpu3_layer12
	expert_pp3_dp2_gpu3_layer12_exp13 -> agg_pp3_dp2_gpu3_layer12
	expert_pp3_dp2_gpu3_layer12_exp14 -> agg_pp3_dp2_gpu3_layer12
	expert_pp3_dp2_gpu3_layer12_exp15 -> agg_pp3_dp2_gpu3_layer12
	agg_pp3_dp2_gpu3_layer12 -> attn_pp3_dp2_gpu3_layer13
	attn_pp3_dp2_gpu3_layer13 -> route_pp3_dp2_gpu3_layer13
	route_pp3_dp2_gpu3_layer13 -> expert_pp3_dp2_gpu3_layer13_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp2_gpu3_layer13 -> expert_pp3_dp2_gpu3_layer13_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp2_gpu3_layer13 -> expert_pp3_dp2_gpu3_layer13_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp2_gpu3_layer13 -> expert_pp3_dp2_gpu3_layer13_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp2_gpu3_layer13_exp12 -> agg_pp3_dp2_gpu3_layer13
	expert_pp3_dp2_gpu3_layer13_exp13 -> agg_pp3_dp2_gpu3_layer13
	expert_pp3_dp2_gpu3_layer13_exp14 -> agg_pp3_dp2_gpu3_layer13
	expert_pp3_dp2_gpu3_layer13_exp15 -> agg_pp3_dp2_gpu3_layer13
	agg_pp3_dp2_gpu3_layer13 -> attn_pp3_dp2_gpu3_layer14
	attn_pp3_dp2_gpu3_layer14 -> route_pp3_dp2_gpu3_layer14
	route_pp3_dp2_gpu3_layer14 -> expert_pp3_dp2_gpu3_layer14_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp2_gpu3_layer14 -> expert_pp3_dp2_gpu3_layer14_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp2_gpu3_layer14 -> expert_pp3_dp2_gpu3_layer14_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp2_gpu3_layer14 -> expert_pp3_dp2_gpu3_layer14_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp2_gpu3_layer14_exp12 -> agg_pp3_dp2_gpu3_layer14
	expert_pp3_dp2_gpu3_layer14_exp13 -> agg_pp3_dp2_gpu3_layer14
	expert_pp3_dp2_gpu3_layer14_exp14 -> agg_pp3_dp2_gpu3_layer14
	expert_pp3_dp2_gpu3_layer14_exp15 -> agg_pp3_dp2_gpu3_layer14
	agg_pp3_dp2_gpu3_layer14 -> attn_pp3_dp2_gpu3_layer15
	attn_pp3_dp2_gpu3_layer15 -> route_pp3_dp2_gpu3_layer15
	route_pp3_dp2_gpu3_layer15 -> expert_pp3_dp2_gpu3_layer15_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp2_gpu3_layer15 -> expert_pp3_dp2_gpu3_layer15_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp2_gpu3_layer15 -> expert_pp3_dp2_gpu3_layer15_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp2_gpu3_layer15 -> expert_pp3_dp2_gpu3_layer15_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp2_gpu3_layer15_exp12 -> agg_pp3_dp2_gpu3_layer15
	expert_pp3_dp2_gpu3_layer15_exp13 -> agg_pp3_dp2_gpu3_layer15
	expert_pp3_dp2_gpu3_layer15_exp14 -> agg_pp3_dp2_gpu3_layer15
	expert_pp3_dp2_gpu3_layer15_exp15 -> agg_pp3_dp2_gpu3_layer15
	output_dp2_gpu3 [label="Output\nGPU 59\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp2_gpu3_layer15 -> output_dp2_gpu3
	attn_pp3_dp3_gpu0_layer12 -> route_pp3_dp3_gpu0_layer12
	route_pp3_dp3_gpu0_layer12 -> expert_pp3_dp3_gpu0_layer12_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp3_gpu0_layer12 -> expert_pp3_dp3_gpu0_layer12_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp3_gpu0_layer12 -> expert_pp3_dp3_gpu0_layer12_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp3_gpu0_layer12 -> expert_pp3_dp3_gpu0_layer12_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp3_gpu0_layer12_exp0 -> agg_pp3_dp3_gpu0_layer12
	expert_pp3_dp3_gpu0_layer12_exp1 -> agg_pp3_dp3_gpu0_layer12
	expert_pp3_dp3_gpu0_layer12_exp2 -> agg_pp3_dp3_gpu0_layer12
	expert_pp3_dp3_gpu0_layer12_exp3 -> agg_pp3_dp3_gpu0_layer12
	agg_pp3_dp3_gpu0_layer12 -> attn_pp3_dp3_gpu0_layer13
	attn_pp3_dp3_gpu0_layer13 -> route_pp3_dp3_gpu0_layer13
	route_pp3_dp3_gpu0_layer13 -> expert_pp3_dp3_gpu0_layer13_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp3_gpu0_layer13 -> expert_pp3_dp3_gpu0_layer13_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp3_gpu0_layer13 -> expert_pp3_dp3_gpu0_layer13_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp3_gpu0_layer13 -> expert_pp3_dp3_gpu0_layer13_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp3_gpu0_layer13_exp0 -> agg_pp3_dp3_gpu0_layer13
	expert_pp3_dp3_gpu0_layer13_exp1 -> agg_pp3_dp3_gpu0_layer13
	expert_pp3_dp3_gpu0_layer13_exp2 -> agg_pp3_dp3_gpu0_layer13
	expert_pp3_dp3_gpu0_layer13_exp3 -> agg_pp3_dp3_gpu0_layer13
	agg_pp3_dp3_gpu0_layer13 -> attn_pp3_dp3_gpu0_layer14
	attn_pp3_dp3_gpu0_layer14 -> route_pp3_dp3_gpu0_layer14
	route_pp3_dp3_gpu0_layer14 -> expert_pp3_dp3_gpu0_layer14_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp3_gpu0_layer14 -> expert_pp3_dp3_gpu0_layer14_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp3_gpu0_layer14 -> expert_pp3_dp3_gpu0_layer14_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp3_gpu0_layer14 -> expert_pp3_dp3_gpu0_layer14_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp3_gpu0_layer14_exp0 -> agg_pp3_dp3_gpu0_layer14
	expert_pp3_dp3_gpu0_layer14_exp1 -> agg_pp3_dp3_gpu0_layer14
	expert_pp3_dp3_gpu0_layer14_exp2 -> agg_pp3_dp3_gpu0_layer14
	expert_pp3_dp3_gpu0_layer14_exp3 -> agg_pp3_dp3_gpu0_layer14
	agg_pp3_dp3_gpu0_layer14 -> attn_pp3_dp3_gpu0_layer15
	attn_pp3_dp3_gpu0_layer15 -> route_pp3_dp3_gpu0_layer15
	route_pp3_dp3_gpu0_layer15 -> expert_pp3_dp3_gpu0_layer15_exp0 [label="Gated 0" style=dashed]
	route_pp3_dp3_gpu0_layer15 -> expert_pp3_dp3_gpu0_layer15_exp1 [label="Gated 1" style=dashed]
	route_pp3_dp3_gpu0_layer15 -> expert_pp3_dp3_gpu0_layer15_exp2 [label="Gated 2" style=dashed]
	route_pp3_dp3_gpu0_layer15 -> expert_pp3_dp3_gpu0_layer15_exp3 [label="Gated 3" style=dashed]
	expert_pp3_dp3_gpu0_layer15_exp0 -> agg_pp3_dp3_gpu0_layer15
	expert_pp3_dp3_gpu0_layer15_exp1 -> agg_pp3_dp3_gpu0_layer15
	expert_pp3_dp3_gpu0_layer15_exp2 -> agg_pp3_dp3_gpu0_layer15
	expert_pp3_dp3_gpu0_layer15_exp3 -> agg_pp3_dp3_gpu0_layer15
	output_dp3_gpu0 [label="Output\nGPU 60\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp3_gpu0_layer15 -> output_dp3_gpu0
	attn_pp3_dp3_gpu1_layer12 -> route_pp3_dp3_gpu1_layer12
	route_pp3_dp3_gpu1_layer12 -> expert_pp3_dp3_gpu1_layer12_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp3_gpu1_layer12 -> expert_pp3_dp3_gpu1_layer12_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp3_gpu1_layer12 -> expert_pp3_dp3_gpu1_layer12_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp3_gpu1_layer12 -> expert_pp3_dp3_gpu1_layer12_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp3_gpu1_layer12_exp4 -> agg_pp3_dp3_gpu1_layer12
	expert_pp3_dp3_gpu1_layer12_exp5 -> agg_pp3_dp3_gpu1_layer12
	expert_pp3_dp3_gpu1_layer12_exp6 -> agg_pp3_dp3_gpu1_layer12
	expert_pp3_dp3_gpu1_layer12_exp7 -> agg_pp3_dp3_gpu1_layer12
	agg_pp3_dp3_gpu1_layer12 -> attn_pp3_dp3_gpu1_layer13
	attn_pp3_dp3_gpu1_layer13 -> route_pp3_dp3_gpu1_layer13
	route_pp3_dp3_gpu1_layer13 -> expert_pp3_dp3_gpu1_layer13_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp3_gpu1_layer13 -> expert_pp3_dp3_gpu1_layer13_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp3_gpu1_layer13 -> expert_pp3_dp3_gpu1_layer13_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp3_gpu1_layer13 -> expert_pp3_dp3_gpu1_layer13_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp3_gpu1_layer13_exp4 -> agg_pp3_dp3_gpu1_layer13
	expert_pp3_dp3_gpu1_layer13_exp5 -> agg_pp3_dp3_gpu1_layer13
	expert_pp3_dp3_gpu1_layer13_exp6 -> agg_pp3_dp3_gpu1_layer13
	expert_pp3_dp3_gpu1_layer13_exp7 -> agg_pp3_dp3_gpu1_layer13
	agg_pp3_dp3_gpu1_layer13 -> attn_pp3_dp3_gpu1_layer14
	attn_pp3_dp3_gpu1_layer14 -> route_pp3_dp3_gpu1_layer14
	route_pp3_dp3_gpu1_layer14 -> expert_pp3_dp3_gpu1_layer14_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp3_gpu1_layer14 -> expert_pp3_dp3_gpu1_layer14_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp3_gpu1_layer14 -> expert_pp3_dp3_gpu1_layer14_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp3_gpu1_layer14 -> expert_pp3_dp3_gpu1_layer14_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp3_gpu1_layer14_exp4 -> agg_pp3_dp3_gpu1_layer14
	expert_pp3_dp3_gpu1_layer14_exp5 -> agg_pp3_dp3_gpu1_layer14
	expert_pp3_dp3_gpu1_layer14_exp6 -> agg_pp3_dp3_gpu1_layer14
	expert_pp3_dp3_gpu1_layer14_exp7 -> agg_pp3_dp3_gpu1_layer14
	agg_pp3_dp3_gpu1_layer14 -> attn_pp3_dp3_gpu1_layer15
	attn_pp3_dp3_gpu1_layer15 -> route_pp3_dp3_gpu1_layer15
	route_pp3_dp3_gpu1_layer15 -> expert_pp3_dp3_gpu1_layer15_exp4 [label="Gated 4" style=dashed]
	route_pp3_dp3_gpu1_layer15 -> expert_pp3_dp3_gpu1_layer15_exp5 [label="Gated 5" style=dashed]
	route_pp3_dp3_gpu1_layer15 -> expert_pp3_dp3_gpu1_layer15_exp6 [label="Gated 6" style=dashed]
	route_pp3_dp3_gpu1_layer15 -> expert_pp3_dp3_gpu1_layer15_exp7 [label="Gated 7" style=dashed]
	expert_pp3_dp3_gpu1_layer15_exp4 -> agg_pp3_dp3_gpu1_layer15
	expert_pp3_dp3_gpu1_layer15_exp5 -> agg_pp3_dp3_gpu1_layer15
	expert_pp3_dp3_gpu1_layer15_exp6 -> agg_pp3_dp3_gpu1_layer15
	expert_pp3_dp3_gpu1_layer15_exp7 -> agg_pp3_dp3_gpu1_layer15
	output_dp3_gpu1 [label="Output\nGPU 61\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp3_gpu1_layer15 -> output_dp3_gpu1
	attn_pp3_dp3_gpu2_layer12 -> route_pp3_dp3_gpu2_layer12
	route_pp3_dp3_gpu2_layer12 -> expert_pp3_dp3_gpu2_layer12_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp3_gpu2_layer12 -> expert_pp3_dp3_gpu2_layer12_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp3_gpu2_layer12 -> expert_pp3_dp3_gpu2_layer12_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp3_gpu2_layer12 -> expert_pp3_dp3_gpu2_layer12_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp3_gpu2_layer12_exp8 -> agg_pp3_dp3_gpu2_layer12
	expert_pp3_dp3_gpu2_layer12_exp9 -> agg_pp3_dp3_gpu2_layer12
	expert_pp3_dp3_gpu2_layer12_exp10 -> agg_pp3_dp3_gpu2_layer12
	expert_pp3_dp3_gpu2_layer12_exp11 -> agg_pp3_dp3_gpu2_layer12
	agg_pp3_dp3_gpu2_layer12 -> attn_pp3_dp3_gpu2_layer13
	attn_pp3_dp3_gpu2_layer13 -> route_pp3_dp3_gpu2_layer13
	route_pp3_dp3_gpu2_layer13 -> expert_pp3_dp3_gpu2_layer13_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp3_gpu2_layer13 -> expert_pp3_dp3_gpu2_layer13_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp3_gpu2_layer13 -> expert_pp3_dp3_gpu2_layer13_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp3_gpu2_layer13 -> expert_pp3_dp3_gpu2_layer13_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp3_gpu2_layer13_exp8 -> agg_pp3_dp3_gpu2_layer13
	expert_pp3_dp3_gpu2_layer13_exp9 -> agg_pp3_dp3_gpu2_layer13
	expert_pp3_dp3_gpu2_layer13_exp10 -> agg_pp3_dp3_gpu2_layer13
	expert_pp3_dp3_gpu2_layer13_exp11 -> agg_pp3_dp3_gpu2_layer13
	agg_pp3_dp3_gpu2_layer13 -> attn_pp3_dp3_gpu2_layer14
	attn_pp3_dp3_gpu2_layer14 -> route_pp3_dp3_gpu2_layer14
	route_pp3_dp3_gpu2_layer14 -> expert_pp3_dp3_gpu2_layer14_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp3_gpu2_layer14 -> expert_pp3_dp3_gpu2_layer14_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp3_gpu2_layer14 -> expert_pp3_dp3_gpu2_layer14_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp3_gpu2_layer14 -> expert_pp3_dp3_gpu2_layer14_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp3_gpu2_layer14_exp8 -> agg_pp3_dp3_gpu2_layer14
	expert_pp3_dp3_gpu2_layer14_exp9 -> agg_pp3_dp3_gpu2_layer14
	expert_pp3_dp3_gpu2_layer14_exp10 -> agg_pp3_dp3_gpu2_layer14
	expert_pp3_dp3_gpu2_layer14_exp11 -> agg_pp3_dp3_gpu2_layer14
	agg_pp3_dp3_gpu2_layer14 -> attn_pp3_dp3_gpu2_layer15
	attn_pp3_dp3_gpu2_layer15 -> route_pp3_dp3_gpu2_layer15
	route_pp3_dp3_gpu2_layer15 -> expert_pp3_dp3_gpu2_layer15_exp8 [label="Gated 8" style=dashed]
	route_pp3_dp3_gpu2_layer15 -> expert_pp3_dp3_gpu2_layer15_exp9 [label="Gated 9" style=dashed]
	route_pp3_dp3_gpu2_layer15 -> expert_pp3_dp3_gpu2_layer15_exp10 [label="Gated 10" style=dashed]
	route_pp3_dp3_gpu2_layer15 -> expert_pp3_dp3_gpu2_layer15_exp11 [label="Gated 11" style=dashed]
	expert_pp3_dp3_gpu2_layer15_exp8 -> agg_pp3_dp3_gpu2_layer15
	expert_pp3_dp3_gpu2_layer15_exp9 -> agg_pp3_dp3_gpu2_layer15
	expert_pp3_dp3_gpu2_layer15_exp10 -> agg_pp3_dp3_gpu2_layer15
	expert_pp3_dp3_gpu2_layer15_exp11 -> agg_pp3_dp3_gpu2_layer15
	output_dp3_gpu2 [label="Output\nGPU 62\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp3_gpu2_layer15 -> output_dp3_gpu2
	attn_pp3_dp3_gpu3_layer12 -> route_pp3_dp3_gpu3_layer12
	route_pp3_dp3_gpu3_layer12 -> expert_pp3_dp3_gpu3_layer12_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp3_gpu3_layer12 -> expert_pp3_dp3_gpu3_layer12_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp3_gpu3_layer12 -> expert_pp3_dp3_gpu3_layer12_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp3_gpu3_layer12 -> expert_pp3_dp3_gpu3_layer12_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp3_gpu3_layer12_exp12 -> agg_pp3_dp3_gpu3_layer12
	expert_pp3_dp3_gpu3_layer12_exp13 -> agg_pp3_dp3_gpu3_layer12
	expert_pp3_dp3_gpu3_layer12_exp14 -> agg_pp3_dp3_gpu3_layer12
	expert_pp3_dp3_gpu3_layer12_exp15 -> agg_pp3_dp3_gpu3_layer12
	agg_pp3_dp3_gpu3_layer12 -> attn_pp3_dp3_gpu3_layer13
	attn_pp3_dp3_gpu3_layer13 -> route_pp3_dp3_gpu3_layer13
	route_pp3_dp3_gpu3_layer13 -> expert_pp3_dp3_gpu3_layer13_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp3_gpu3_layer13 -> expert_pp3_dp3_gpu3_layer13_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp3_gpu3_layer13 -> expert_pp3_dp3_gpu3_layer13_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp3_gpu3_layer13 -> expert_pp3_dp3_gpu3_layer13_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp3_gpu3_layer13_exp12 -> agg_pp3_dp3_gpu3_layer13
	expert_pp3_dp3_gpu3_layer13_exp13 -> agg_pp3_dp3_gpu3_layer13
	expert_pp3_dp3_gpu3_layer13_exp14 -> agg_pp3_dp3_gpu3_layer13
	expert_pp3_dp3_gpu3_layer13_exp15 -> agg_pp3_dp3_gpu3_layer13
	agg_pp3_dp3_gpu3_layer13 -> attn_pp3_dp3_gpu3_layer14
	attn_pp3_dp3_gpu3_layer14 -> route_pp3_dp3_gpu3_layer14
	route_pp3_dp3_gpu3_layer14 -> expert_pp3_dp3_gpu3_layer14_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp3_gpu3_layer14 -> expert_pp3_dp3_gpu3_layer14_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp3_gpu3_layer14 -> expert_pp3_dp3_gpu3_layer14_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp3_gpu3_layer14 -> expert_pp3_dp3_gpu3_layer14_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp3_gpu3_layer14_exp12 -> agg_pp3_dp3_gpu3_layer14
	expert_pp3_dp3_gpu3_layer14_exp13 -> agg_pp3_dp3_gpu3_layer14
	expert_pp3_dp3_gpu3_layer14_exp14 -> agg_pp3_dp3_gpu3_layer14
	expert_pp3_dp3_gpu3_layer14_exp15 -> agg_pp3_dp3_gpu3_layer14
	agg_pp3_dp3_gpu3_layer14 -> attn_pp3_dp3_gpu3_layer15
	attn_pp3_dp3_gpu3_layer15 -> route_pp3_dp3_gpu3_layer15
	route_pp3_dp3_gpu3_layer15 -> expert_pp3_dp3_gpu3_layer15_exp12 [label="Gated 12" style=dashed]
	route_pp3_dp3_gpu3_layer15 -> expert_pp3_dp3_gpu3_layer15_exp13 [label="Gated 13" style=dashed]
	route_pp3_dp3_gpu3_layer15 -> expert_pp3_dp3_gpu3_layer15_exp14 [label="Gated 14" style=dashed]
	route_pp3_dp3_gpu3_layer15 -> expert_pp3_dp3_gpu3_layer15_exp15 [label="Gated 15" style=dashed]
	expert_pp3_dp3_gpu3_layer15_exp12 -> agg_pp3_dp3_gpu3_layer15
	expert_pp3_dp3_gpu3_layer15_exp13 -> agg_pp3_dp3_gpu3_layer15
	expert_pp3_dp3_gpu3_layer15_exp14 -> agg_pp3_dp3_gpu3_layer15
	expert_pp3_dp3_gpu3_layer15_exp15 -> agg_pp3_dp3_gpu3_layer15
	output_dp3_gpu3 [label="Output\nGPU 63\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightcoral shape=house style=filled]
	agg_pp3_dp3_gpu3_layer15 -> output_dp3_gpu3
	expert_all2all_pp0_dp0_layer0_gpu0_to_1 [label="Expert A2A\nGPU 0->1\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer0 -> expert_all2all_pp0_dp0_layer0_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu0_to_1 -> expert_pp0_dp0_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu0_to_2 [label="Expert A2A\nGPU 0->2\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer0 -> expert_all2all_pp0_dp0_layer0_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu0_to_2 -> expert_pp0_dp0_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu0_to_3 [label="Expert A2A\nGPU 0->3\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer0 -> expert_all2all_pp0_dp0_layer0_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu0_to_3 -> expert_pp0_dp0_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_0 [label="Expert A2A\nGPU 1->0\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer0 -> expert_all2all_pp0_dp0_layer0_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_0 -> expert_pp0_dp0_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_2 [label="Expert A2A\nGPU 1->2\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer0 -> expert_all2all_pp0_dp0_layer0_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_2 -> expert_pp0_dp0_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_3 [label="Expert A2A\nGPU 1->3\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer0 -> expert_all2all_pp0_dp0_layer0_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu1_to_3 -> expert_pp0_dp0_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_0 [label="Expert A2A\nGPU 2->0\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer0 -> expert_all2all_pp0_dp0_layer0_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_0 -> expert_pp0_dp0_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_1 [label="Expert A2A\nGPU 2->1\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer0 -> expert_all2all_pp0_dp0_layer0_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_1 -> expert_pp0_dp0_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_3 [label="Expert A2A\nGPU 2->3\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer0 -> expert_all2all_pp0_dp0_layer0_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu2_to_3 -> expert_pp0_dp0_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_0 [label="Expert A2A\nGPU 3->0\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer0 -> expert_all2all_pp0_dp0_layer0_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_0 -> expert_pp0_dp0_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_1 [label="Expert A2A\nGPU 3->1\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer0 -> expert_all2all_pp0_dp0_layer0_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_1 -> expert_pp0_dp0_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_2 [label="Expert A2A\nGPU 3->2\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer0 -> expert_all2all_pp0_dp0_layer0_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer0_gpu3_to_2 -> expert_pp0_dp0_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_1 [label="Expert A2A\nGPU 4->5\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer0 -> expert_all2all_pp0_dp1_layer0_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_1 -> expert_pp0_dp1_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_2 [label="Expert A2A\nGPU 4->6\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer0 -> expert_all2all_pp0_dp1_layer0_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_2 -> expert_pp0_dp1_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_3 [label="Expert A2A\nGPU 4->7\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer0 -> expert_all2all_pp0_dp1_layer0_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu0_to_3 -> expert_pp0_dp1_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_0 [label="Expert A2A\nGPU 5->4\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer0 -> expert_all2all_pp0_dp1_layer0_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_0 -> expert_pp0_dp1_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_2 [label="Expert A2A\nGPU 5->6\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer0 -> expert_all2all_pp0_dp1_layer0_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_2 -> expert_pp0_dp1_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_3 [label="Expert A2A\nGPU 5->7\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer0 -> expert_all2all_pp0_dp1_layer0_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu1_to_3 -> expert_pp0_dp1_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_0 [label="Expert A2A\nGPU 6->4\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer0 -> expert_all2all_pp0_dp1_layer0_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_0 -> expert_pp0_dp1_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_1 [label="Expert A2A\nGPU 6->5\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer0 -> expert_all2all_pp0_dp1_layer0_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_1 -> expert_pp0_dp1_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_3 [label="Expert A2A\nGPU 6->7\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer0 -> expert_all2all_pp0_dp1_layer0_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu2_to_3 -> expert_pp0_dp1_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_0 [label="Expert A2A\nGPU 7->4\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer0 -> expert_all2all_pp0_dp1_layer0_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_0 -> expert_pp0_dp1_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_1 [label="Expert A2A\nGPU 7->5\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer0 -> expert_all2all_pp0_dp1_layer0_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_1 -> expert_pp0_dp1_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_2 [label="Expert A2A\nGPU 7->6\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer0 -> expert_all2all_pp0_dp1_layer0_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer0_gpu3_to_2 -> expert_pp0_dp1_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_1 [label="Expert A2A\nGPU 8->9\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer0 -> expert_all2all_pp0_dp2_layer0_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_1 -> expert_pp0_dp2_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_2 [label="Expert A2A\nGPU 8->10\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer0 -> expert_all2all_pp0_dp2_layer0_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_2 -> expert_pp0_dp2_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_3 [label="Expert A2A\nGPU 8->11\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer0 -> expert_all2all_pp0_dp2_layer0_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu0_to_3 -> expert_pp0_dp2_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_0 [label="Expert A2A\nGPU 9->8\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer0 -> expert_all2all_pp0_dp2_layer0_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_0 -> expert_pp0_dp2_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_2 [label="Expert A2A\nGPU 9->10\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer0 -> expert_all2all_pp0_dp2_layer0_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_2 -> expert_pp0_dp2_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_3 [label="Expert A2A\nGPU 9->11\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer0 -> expert_all2all_pp0_dp2_layer0_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu1_to_3 -> expert_pp0_dp2_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_0 [label="Expert A2A\nGPU 10->8\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer0 -> expert_all2all_pp0_dp2_layer0_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_0 -> expert_pp0_dp2_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_1 [label="Expert A2A\nGPU 10->9\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer0 -> expert_all2all_pp0_dp2_layer0_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_1 -> expert_pp0_dp2_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_3 [label="Expert A2A\nGPU 10->11\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer0 -> expert_all2all_pp0_dp2_layer0_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu2_to_3 -> expert_pp0_dp2_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_0 [label="Expert A2A\nGPU 11->8\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer0 -> expert_all2all_pp0_dp2_layer0_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_0 -> expert_pp0_dp2_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_1 [label="Expert A2A\nGPU 11->9\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer0 -> expert_all2all_pp0_dp2_layer0_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_1 -> expert_pp0_dp2_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_2 [label="Expert A2A\nGPU 11->10\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer0 -> expert_all2all_pp0_dp2_layer0_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer0_gpu3_to_2 -> expert_pp0_dp2_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_1 [label="Expert A2A\nGPU 12->13\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer0 -> expert_all2all_pp0_dp3_layer0_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_1 -> expert_pp0_dp3_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_2 [label="Expert A2A\nGPU 12->14\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer0 -> expert_all2all_pp0_dp3_layer0_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_2 -> expert_pp0_dp3_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_3 [label="Expert A2A\nGPU 12->15\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer0 -> expert_all2all_pp0_dp3_layer0_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu0_to_3 -> expert_pp0_dp3_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_0 [label="Expert A2A\nGPU 13->12\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer0 -> expert_all2all_pp0_dp3_layer0_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_0 -> expert_pp0_dp3_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_2 [label="Expert A2A\nGPU 13->14\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer0 -> expert_all2all_pp0_dp3_layer0_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_2 -> expert_pp0_dp3_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_3 [label="Expert A2A\nGPU 13->15\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer0 -> expert_all2all_pp0_dp3_layer0_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu1_to_3 -> expert_pp0_dp3_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_0 [label="Expert A2A\nGPU 14->12\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer0 -> expert_all2all_pp0_dp3_layer0_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_0 -> expert_pp0_dp3_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_1 [label="Expert A2A\nGPU 14->13\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer0 -> expert_all2all_pp0_dp3_layer0_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_1 -> expert_pp0_dp3_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_3 [label="Expert A2A\nGPU 14->15\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer0 -> expert_all2all_pp0_dp3_layer0_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu2_to_3 -> expert_pp0_dp3_gpu3_layer0_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_0 [label="Expert A2A\nGPU 15->12\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer0 -> expert_all2all_pp0_dp3_layer0_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_0 -> expert_pp0_dp3_gpu0_layer0_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_1 [label="Expert A2A\nGPU 15->13\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer0 -> expert_all2all_pp0_dp3_layer0_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_1 -> expert_pp0_dp3_gpu1_layer0_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_2 [label="Expert A2A\nGPU 15->14\nLayer 0\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer0 -> expert_all2all_pp0_dp3_layer0_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer0_gpu3_to_2 -> expert_pp0_dp3_gpu2_layer0_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_1 [label="Expert A2A\nGPU 0->1\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer1 -> expert_all2all_pp0_dp0_layer1_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_1 -> expert_pp0_dp0_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_2 [label="Expert A2A\nGPU 0->2\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer1 -> expert_all2all_pp0_dp0_layer1_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_2 -> expert_pp0_dp0_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_3 [label="Expert A2A\nGPU 0->3\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer1 -> expert_all2all_pp0_dp0_layer1_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu0_to_3 -> expert_pp0_dp0_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_0 [label="Expert A2A\nGPU 1->0\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer1 -> expert_all2all_pp0_dp0_layer1_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_0 -> expert_pp0_dp0_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_2 [label="Expert A2A\nGPU 1->2\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer1 -> expert_all2all_pp0_dp0_layer1_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_2 -> expert_pp0_dp0_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_3 [label="Expert A2A\nGPU 1->3\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer1 -> expert_all2all_pp0_dp0_layer1_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu1_to_3 -> expert_pp0_dp0_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_0 [label="Expert A2A\nGPU 2->0\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer1 -> expert_all2all_pp0_dp0_layer1_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_0 -> expert_pp0_dp0_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_1 [label="Expert A2A\nGPU 2->1\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer1 -> expert_all2all_pp0_dp0_layer1_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_1 -> expert_pp0_dp0_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_3 [label="Expert A2A\nGPU 2->3\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer1 -> expert_all2all_pp0_dp0_layer1_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu2_to_3 -> expert_pp0_dp0_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_0 [label="Expert A2A\nGPU 3->0\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer1 -> expert_all2all_pp0_dp0_layer1_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_0 -> expert_pp0_dp0_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_1 [label="Expert A2A\nGPU 3->1\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer1 -> expert_all2all_pp0_dp0_layer1_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_1 -> expert_pp0_dp0_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_2 [label="Expert A2A\nGPU 3->2\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer1 -> expert_all2all_pp0_dp0_layer1_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer1_gpu3_to_2 -> expert_pp0_dp0_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_1 [label="Expert A2A\nGPU 4->5\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer1 -> expert_all2all_pp0_dp1_layer1_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_1 -> expert_pp0_dp1_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_2 [label="Expert A2A\nGPU 4->6\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer1 -> expert_all2all_pp0_dp1_layer1_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_2 -> expert_pp0_dp1_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_3 [label="Expert A2A\nGPU 4->7\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer1 -> expert_all2all_pp0_dp1_layer1_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu0_to_3 -> expert_pp0_dp1_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_0 [label="Expert A2A\nGPU 5->4\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer1 -> expert_all2all_pp0_dp1_layer1_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_0 -> expert_pp0_dp1_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_2 [label="Expert A2A\nGPU 5->6\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer1 -> expert_all2all_pp0_dp1_layer1_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_2 -> expert_pp0_dp1_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_3 [label="Expert A2A\nGPU 5->7\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer1 -> expert_all2all_pp0_dp1_layer1_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu1_to_3 -> expert_pp0_dp1_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_0 [label="Expert A2A\nGPU 6->4\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer1 -> expert_all2all_pp0_dp1_layer1_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_0 -> expert_pp0_dp1_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_1 [label="Expert A2A\nGPU 6->5\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer1 -> expert_all2all_pp0_dp1_layer1_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_1 -> expert_pp0_dp1_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_3 [label="Expert A2A\nGPU 6->7\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer1 -> expert_all2all_pp0_dp1_layer1_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu2_to_3 -> expert_pp0_dp1_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_0 [label="Expert A2A\nGPU 7->4\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer1 -> expert_all2all_pp0_dp1_layer1_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_0 -> expert_pp0_dp1_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_1 [label="Expert A2A\nGPU 7->5\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer1 -> expert_all2all_pp0_dp1_layer1_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_1 -> expert_pp0_dp1_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_2 [label="Expert A2A\nGPU 7->6\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer1 -> expert_all2all_pp0_dp1_layer1_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer1_gpu3_to_2 -> expert_pp0_dp1_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_1 [label="Expert A2A\nGPU 8->9\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer1 -> expert_all2all_pp0_dp2_layer1_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_1 -> expert_pp0_dp2_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_2 [label="Expert A2A\nGPU 8->10\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer1 -> expert_all2all_pp0_dp2_layer1_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_2 -> expert_pp0_dp2_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_3 [label="Expert A2A\nGPU 8->11\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer1 -> expert_all2all_pp0_dp2_layer1_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu0_to_3 -> expert_pp0_dp2_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_0 [label="Expert A2A\nGPU 9->8\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer1 -> expert_all2all_pp0_dp2_layer1_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_0 -> expert_pp0_dp2_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_2 [label="Expert A2A\nGPU 9->10\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer1 -> expert_all2all_pp0_dp2_layer1_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_2 -> expert_pp0_dp2_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_3 [label="Expert A2A\nGPU 9->11\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer1 -> expert_all2all_pp0_dp2_layer1_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu1_to_3 -> expert_pp0_dp2_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_0 [label="Expert A2A\nGPU 10->8\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer1 -> expert_all2all_pp0_dp2_layer1_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_0 -> expert_pp0_dp2_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_1 [label="Expert A2A\nGPU 10->9\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer1 -> expert_all2all_pp0_dp2_layer1_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_1 -> expert_pp0_dp2_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_3 [label="Expert A2A\nGPU 10->11\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer1 -> expert_all2all_pp0_dp2_layer1_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu2_to_3 -> expert_pp0_dp2_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_0 [label="Expert A2A\nGPU 11->8\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer1 -> expert_all2all_pp0_dp2_layer1_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_0 -> expert_pp0_dp2_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_1 [label="Expert A2A\nGPU 11->9\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer1 -> expert_all2all_pp0_dp2_layer1_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_1 -> expert_pp0_dp2_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_2 [label="Expert A2A\nGPU 11->10\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer1 -> expert_all2all_pp0_dp2_layer1_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer1_gpu3_to_2 -> expert_pp0_dp2_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_1 [label="Expert A2A\nGPU 12->13\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer1 -> expert_all2all_pp0_dp3_layer1_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_1 -> expert_pp0_dp3_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_2 [label="Expert A2A\nGPU 12->14\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer1 -> expert_all2all_pp0_dp3_layer1_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_2 -> expert_pp0_dp3_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_3 [label="Expert A2A\nGPU 12->15\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer1 -> expert_all2all_pp0_dp3_layer1_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu0_to_3 -> expert_pp0_dp3_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_0 [label="Expert A2A\nGPU 13->12\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer1 -> expert_all2all_pp0_dp3_layer1_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_0 -> expert_pp0_dp3_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_2 [label="Expert A2A\nGPU 13->14\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer1 -> expert_all2all_pp0_dp3_layer1_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_2 -> expert_pp0_dp3_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_3 [label="Expert A2A\nGPU 13->15\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer1 -> expert_all2all_pp0_dp3_layer1_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu1_to_3 -> expert_pp0_dp3_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_0 [label="Expert A2A\nGPU 14->12\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer1 -> expert_all2all_pp0_dp3_layer1_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_0 -> expert_pp0_dp3_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_1 [label="Expert A2A\nGPU 14->13\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer1 -> expert_all2all_pp0_dp3_layer1_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_1 -> expert_pp0_dp3_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_3 [label="Expert A2A\nGPU 14->15\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer1 -> expert_all2all_pp0_dp3_layer1_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu2_to_3 -> expert_pp0_dp3_gpu3_layer1_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_0 [label="Expert A2A\nGPU 15->12\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer1 -> expert_all2all_pp0_dp3_layer1_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_0 -> expert_pp0_dp3_gpu0_layer1_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_1 [label="Expert A2A\nGPU 15->13\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer1 -> expert_all2all_pp0_dp3_layer1_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_1 -> expert_pp0_dp3_gpu1_layer1_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_2 [label="Expert A2A\nGPU 15->14\nLayer 1\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer1 -> expert_all2all_pp0_dp3_layer1_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer1_gpu3_to_2 -> expert_pp0_dp3_gpu2_layer1_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_1 [label="Expert A2A\nGPU 0->1\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer2 -> expert_all2all_pp0_dp0_layer2_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_1 -> expert_pp0_dp0_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_2 [label="Expert A2A\nGPU 0->2\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer2 -> expert_all2all_pp0_dp0_layer2_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_2 -> expert_pp0_dp0_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_3 [label="Expert A2A\nGPU 0->3\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer2 -> expert_all2all_pp0_dp0_layer2_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu0_to_3 -> expert_pp0_dp0_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_0 [label="Expert A2A\nGPU 1->0\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer2 -> expert_all2all_pp0_dp0_layer2_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_0 -> expert_pp0_dp0_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_2 [label="Expert A2A\nGPU 1->2\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer2 -> expert_all2all_pp0_dp0_layer2_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_2 -> expert_pp0_dp0_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_3 [label="Expert A2A\nGPU 1->3\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer2 -> expert_all2all_pp0_dp0_layer2_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu1_to_3 -> expert_pp0_dp0_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_0 [label="Expert A2A\nGPU 2->0\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer2 -> expert_all2all_pp0_dp0_layer2_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_0 -> expert_pp0_dp0_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_1 [label="Expert A2A\nGPU 2->1\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer2 -> expert_all2all_pp0_dp0_layer2_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_1 -> expert_pp0_dp0_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_3 [label="Expert A2A\nGPU 2->3\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer2 -> expert_all2all_pp0_dp0_layer2_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu2_to_3 -> expert_pp0_dp0_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_0 [label="Expert A2A\nGPU 3->0\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer2 -> expert_all2all_pp0_dp0_layer2_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_0 -> expert_pp0_dp0_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_1 [label="Expert A2A\nGPU 3->1\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer2 -> expert_all2all_pp0_dp0_layer2_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_1 -> expert_pp0_dp0_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_2 [label="Expert A2A\nGPU 3->2\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer2 -> expert_all2all_pp0_dp0_layer2_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer2_gpu3_to_2 -> expert_pp0_dp0_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_1 [label="Expert A2A\nGPU 4->5\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer2 -> expert_all2all_pp0_dp1_layer2_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_1 -> expert_pp0_dp1_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_2 [label="Expert A2A\nGPU 4->6\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer2 -> expert_all2all_pp0_dp1_layer2_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_2 -> expert_pp0_dp1_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_3 [label="Expert A2A\nGPU 4->7\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer2 -> expert_all2all_pp0_dp1_layer2_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu0_to_3 -> expert_pp0_dp1_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_0 [label="Expert A2A\nGPU 5->4\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer2 -> expert_all2all_pp0_dp1_layer2_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_0 -> expert_pp0_dp1_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_2 [label="Expert A2A\nGPU 5->6\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer2 -> expert_all2all_pp0_dp1_layer2_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_2 -> expert_pp0_dp1_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_3 [label="Expert A2A\nGPU 5->7\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer2 -> expert_all2all_pp0_dp1_layer2_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu1_to_3 -> expert_pp0_dp1_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_0 [label="Expert A2A\nGPU 6->4\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer2 -> expert_all2all_pp0_dp1_layer2_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_0 -> expert_pp0_dp1_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_1 [label="Expert A2A\nGPU 6->5\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer2 -> expert_all2all_pp0_dp1_layer2_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_1 -> expert_pp0_dp1_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_3 [label="Expert A2A\nGPU 6->7\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer2 -> expert_all2all_pp0_dp1_layer2_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu2_to_3 -> expert_pp0_dp1_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_0 [label="Expert A2A\nGPU 7->4\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer2 -> expert_all2all_pp0_dp1_layer2_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_0 -> expert_pp0_dp1_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_1 [label="Expert A2A\nGPU 7->5\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer2 -> expert_all2all_pp0_dp1_layer2_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_1 -> expert_pp0_dp1_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_2 [label="Expert A2A\nGPU 7->6\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer2 -> expert_all2all_pp0_dp1_layer2_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer2_gpu3_to_2 -> expert_pp0_dp1_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_1 [label="Expert A2A\nGPU 8->9\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer2 -> expert_all2all_pp0_dp2_layer2_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_1 -> expert_pp0_dp2_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_2 [label="Expert A2A\nGPU 8->10\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer2 -> expert_all2all_pp0_dp2_layer2_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_2 -> expert_pp0_dp2_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_3 [label="Expert A2A\nGPU 8->11\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer2 -> expert_all2all_pp0_dp2_layer2_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu0_to_3 -> expert_pp0_dp2_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_0 [label="Expert A2A\nGPU 9->8\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer2 -> expert_all2all_pp0_dp2_layer2_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_0 -> expert_pp0_dp2_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_2 [label="Expert A2A\nGPU 9->10\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer2 -> expert_all2all_pp0_dp2_layer2_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_2 -> expert_pp0_dp2_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_3 [label="Expert A2A\nGPU 9->11\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer2 -> expert_all2all_pp0_dp2_layer2_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu1_to_3 -> expert_pp0_dp2_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_0 [label="Expert A2A\nGPU 10->8\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer2 -> expert_all2all_pp0_dp2_layer2_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_0 -> expert_pp0_dp2_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_1 [label="Expert A2A\nGPU 10->9\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer2 -> expert_all2all_pp0_dp2_layer2_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_1 -> expert_pp0_dp2_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_3 [label="Expert A2A\nGPU 10->11\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer2 -> expert_all2all_pp0_dp2_layer2_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu2_to_3 -> expert_pp0_dp2_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_0 [label="Expert A2A\nGPU 11->8\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer2 -> expert_all2all_pp0_dp2_layer2_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_0 -> expert_pp0_dp2_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_1 [label="Expert A2A\nGPU 11->9\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer2 -> expert_all2all_pp0_dp2_layer2_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_1 -> expert_pp0_dp2_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_2 [label="Expert A2A\nGPU 11->10\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer2 -> expert_all2all_pp0_dp2_layer2_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer2_gpu3_to_2 -> expert_pp0_dp2_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_1 [label="Expert A2A\nGPU 12->13\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer2 -> expert_all2all_pp0_dp3_layer2_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_1 -> expert_pp0_dp3_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_2 [label="Expert A2A\nGPU 12->14\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer2 -> expert_all2all_pp0_dp3_layer2_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_2 -> expert_pp0_dp3_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_3 [label="Expert A2A\nGPU 12->15\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer2 -> expert_all2all_pp0_dp3_layer2_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu0_to_3 -> expert_pp0_dp3_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_0 [label="Expert A2A\nGPU 13->12\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer2 -> expert_all2all_pp0_dp3_layer2_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_0 -> expert_pp0_dp3_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_2 [label="Expert A2A\nGPU 13->14\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer2 -> expert_all2all_pp0_dp3_layer2_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_2 -> expert_pp0_dp3_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_3 [label="Expert A2A\nGPU 13->15\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer2 -> expert_all2all_pp0_dp3_layer2_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu1_to_3 -> expert_pp0_dp3_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_0 [label="Expert A2A\nGPU 14->12\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer2 -> expert_all2all_pp0_dp3_layer2_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_0 -> expert_pp0_dp3_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_1 [label="Expert A2A\nGPU 14->13\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer2 -> expert_all2all_pp0_dp3_layer2_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_1 -> expert_pp0_dp3_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_3 [label="Expert A2A\nGPU 14->15\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer2 -> expert_all2all_pp0_dp3_layer2_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu2_to_3 -> expert_pp0_dp3_gpu3_layer2_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_0 [label="Expert A2A\nGPU 15->12\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer2 -> expert_all2all_pp0_dp3_layer2_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_0 -> expert_pp0_dp3_gpu0_layer2_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_1 [label="Expert A2A\nGPU 15->13\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer2 -> expert_all2all_pp0_dp3_layer2_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_1 -> expert_pp0_dp3_gpu1_layer2_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_2 [label="Expert A2A\nGPU 15->14\nLayer 2\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer2 -> expert_all2all_pp0_dp3_layer2_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer2_gpu3_to_2 -> expert_pp0_dp3_gpu2_layer2_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_1 [label="Expert A2A\nGPU 0->1\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer3 -> expert_all2all_pp0_dp0_layer3_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_1 -> expert_pp0_dp0_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_2 [label="Expert A2A\nGPU 0->2\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer3 -> expert_all2all_pp0_dp0_layer3_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_2 -> expert_pp0_dp0_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_3 [label="Expert A2A\nGPU 0->3\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu0_layer3 -> expert_all2all_pp0_dp0_layer3_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu0_to_3 -> expert_pp0_dp0_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_0 [label="Expert A2A\nGPU 1->0\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer3 -> expert_all2all_pp0_dp0_layer3_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_0 -> expert_pp0_dp0_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_2 [label="Expert A2A\nGPU 1->2\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer3 -> expert_all2all_pp0_dp0_layer3_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_2 -> expert_pp0_dp0_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_3 [label="Expert A2A\nGPU 1->3\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu1_layer3 -> expert_all2all_pp0_dp0_layer3_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu1_to_3 -> expert_pp0_dp0_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_0 [label="Expert A2A\nGPU 2->0\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer3 -> expert_all2all_pp0_dp0_layer3_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_0 -> expert_pp0_dp0_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_1 [label="Expert A2A\nGPU 2->1\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer3 -> expert_all2all_pp0_dp0_layer3_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_1 -> expert_pp0_dp0_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_3 [label="Expert A2A\nGPU 2->3\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu2_layer3 -> expert_all2all_pp0_dp0_layer3_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu2_to_3 -> expert_pp0_dp0_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_0 [label="Expert A2A\nGPU 3->0\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer3 -> expert_all2all_pp0_dp0_layer3_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_0 -> expert_pp0_dp0_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_1 [label="Expert A2A\nGPU 3->1\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer3 -> expert_all2all_pp0_dp0_layer3_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_1 -> expert_pp0_dp0_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_2 [label="Expert A2A\nGPU 3->2\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp0_gpu3_layer3 -> expert_all2all_pp0_dp0_layer3_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp0_layer3_gpu3_to_2 -> expert_pp0_dp0_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_1 [label="Expert A2A\nGPU 4->5\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer3 -> expert_all2all_pp0_dp1_layer3_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_1 -> expert_pp0_dp1_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_2 [label="Expert A2A\nGPU 4->6\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer3 -> expert_all2all_pp0_dp1_layer3_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_2 -> expert_pp0_dp1_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_3 [label="Expert A2A\nGPU 4->7\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu0_layer3 -> expert_all2all_pp0_dp1_layer3_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu0_to_3 -> expert_pp0_dp1_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_0 [label="Expert A2A\nGPU 5->4\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer3 -> expert_all2all_pp0_dp1_layer3_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_0 -> expert_pp0_dp1_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_2 [label="Expert A2A\nGPU 5->6\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer3 -> expert_all2all_pp0_dp1_layer3_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_2 -> expert_pp0_dp1_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_3 [label="Expert A2A\nGPU 5->7\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu1_layer3 -> expert_all2all_pp0_dp1_layer3_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu1_to_3 -> expert_pp0_dp1_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_0 [label="Expert A2A\nGPU 6->4\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer3 -> expert_all2all_pp0_dp1_layer3_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_0 -> expert_pp0_dp1_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_1 [label="Expert A2A\nGPU 6->5\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer3 -> expert_all2all_pp0_dp1_layer3_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_1 -> expert_pp0_dp1_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_3 [label="Expert A2A\nGPU 6->7\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu2_layer3 -> expert_all2all_pp0_dp1_layer3_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu2_to_3 -> expert_pp0_dp1_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_0 [label="Expert A2A\nGPU 7->4\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer3 -> expert_all2all_pp0_dp1_layer3_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_0 -> expert_pp0_dp1_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_1 [label="Expert A2A\nGPU 7->5\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer3 -> expert_all2all_pp0_dp1_layer3_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_1 -> expert_pp0_dp1_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_2 [label="Expert A2A\nGPU 7->6\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp1_gpu3_layer3 -> expert_all2all_pp0_dp1_layer3_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp1_layer3_gpu3_to_2 -> expert_pp0_dp1_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_1 [label="Expert A2A\nGPU 8->9\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer3 -> expert_all2all_pp0_dp2_layer3_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_1 -> expert_pp0_dp2_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_2 [label="Expert A2A\nGPU 8->10\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer3 -> expert_all2all_pp0_dp2_layer3_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_2 -> expert_pp0_dp2_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_3 [label="Expert A2A\nGPU 8->11\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu0_layer3 -> expert_all2all_pp0_dp2_layer3_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu0_to_3 -> expert_pp0_dp2_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_0 [label="Expert A2A\nGPU 9->8\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer3 -> expert_all2all_pp0_dp2_layer3_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_0 -> expert_pp0_dp2_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_2 [label="Expert A2A\nGPU 9->10\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer3 -> expert_all2all_pp0_dp2_layer3_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_2 -> expert_pp0_dp2_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_3 [label="Expert A2A\nGPU 9->11\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu1_layer3 -> expert_all2all_pp0_dp2_layer3_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu1_to_3 -> expert_pp0_dp2_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_0 [label="Expert A2A\nGPU 10->8\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer3 -> expert_all2all_pp0_dp2_layer3_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_0 -> expert_pp0_dp2_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_1 [label="Expert A2A\nGPU 10->9\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer3 -> expert_all2all_pp0_dp2_layer3_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_1 -> expert_pp0_dp2_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_3 [label="Expert A2A\nGPU 10->11\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu2_layer3 -> expert_all2all_pp0_dp2_layer3_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu2_to_3 -> expert_pp0_dp2_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_0 [label="Expert A2A\nGPU 11->8\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer3 -> expert_all2all_pp0_dp2_layer3_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_0 -> expert_pp0_dp2_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_1 [label="Expert A2A\nGPU 11->9\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer3 -> expert_all2all_pp0_dp2_layer3_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_1 -> expert_pp0_dp2_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_2 [label="Expert A2A\nGPU 11->10\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp2_gpu3_layer3 -> expert_all2all_pp0_dp2_layer3_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp2_layer3_gpu3_to_2 -> expert_pp0_dp2_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_1 [label="Expert A2A\nGPU 12->13\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer3 -> expert_all2all_pp0_dp3_layer3_gpu0_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_1 -> expert_pp0_dp3_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_2 [label="Expert A2A\nGPU 12->14\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer3 -> expert_all2all_pp0_dp3_layer3_gpu0_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_2 -> expert_pp0_dp3_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_3 [label="Expert A2A\nGPU 12->15\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu0_layer3 -> expert_all2all_pp0_dp3_layer3_gpu0_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu0_to_3 -> expert_pp0_dp3_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_0 [label="Expert A2A\nGPU 13->12\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer3 -> expert_all2all_pp0_dp3_layer3_gpu1_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_0 -> expert_pp0_dp3_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_2 [label="Expert A2A\nGPU 13->14\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer3 -> expert_all2all_pp0_dp3_layer3_gpu1_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_2 -> expert_pp0_dp3_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_3 [label="Expert A2A\nGPU 13->15\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu1_layer3 -> expert_all2all_pp0_dp3_layer3_gpu1_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu1_to_3 -> expert_pp0_dp3_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_0 [label="Expert A2A\nGPU 14->12\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer3 -> expert_all2all_pp0_dp3_layer3_gpu2_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_0 -> expert_pp0_dp3_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_1 [label="Expert A2A\nGPU 14->13\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer3 -> expert_all2all_pp0_dp3_layer3_gpu2_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_1 -> expert_pp0_dp3_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_3 [label="Expert A2A\nGPU 14->15\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu2_layer3 -> expert_all2all_pp0_dp3_layer3_gpu2_to_3 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu2_to_3 -> expert_pp0_dp3_gpu3_layer3_exp12 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_0 [label="Expert A2A\nGPU 15->12\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer3 -> expert_all2all_pp0_dp3_layer3_gpu3_to_0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_0 -> expert_pp0_dp3_gpu0_layer3_exp0 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_1 [label="Expert A2A\nGPU 15->13\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer3 -> expert_all2all_pp0_dp3_layer3_gpu3_to_1 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_1 -> expert_pp0_dp3_gpu1_layer3_exp4 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_2 [label="Expert A2A\nGPU 15->14\nLayer 3\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp0_dp3_gpu3_layer3 -> expert_all2all_pp0_dp3_layer3_gpu3_to_2 [style=dotted]
	expert_all2all_pp0_dp3_layer3_gpu3_to_2 -> expert_pp0_dp3_gpu2_layer3_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_1 [label="Expert A2A\nGPU 16->17\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer4 -> expert_all2all_pp1_dp0_layer4_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_1 -> expert_pp1_dp0_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_2 [label="Expert A2A\nGPU 16->18\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer4 -> expert_all2all_pp1_dp0_layer4_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_2 -> expert_pp1_dp0_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_3 [label="Expert A2A\nGPU 16->19\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer4 -> expert_all2all_pp1_dp0_layer4_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu0_to_3 -> expert_pp1_dp0_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_0 [label="Expert A2A\nGPU 17->16\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer4 -> expert_all2all_pp1_dp0_layer4_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_0 -> expert_pp1_dp0_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_2 [label="Expert A2A\nGPU 17->18\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer4 -> expert_all2all_pp1_dp0_layer4_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_2 -> expert_pp1_dp0_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_3 [label="Expert A2A\nGPU 17->19\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer4 -> expert_all2all_pp1_dp0_layer4_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu1_to_3 -> expert_pp1_dp0_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_0 [label="Expert A2A\nGPU 18->16\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer4 -> expert_all2all_pp1_dp0_layer4_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_0 -> expert_pp1_dp0_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_1 [label="Expert A2A\nGPU 18->17\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer4 -> expert_all2all_pp1_dp0_layer4_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_1 -> expert_pp1_dp0_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_3 [label="Expert A2A\nGPU 18->19\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer4 -> expert_all2all_pp1_dp0_layer4_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu2_to_3 -> expert_pp1_dp0_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_0 [label="Expert A2A\nGPU 19->16\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer4 -> expert_all2all_pp1_dp0_layer4_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_0 -> expert_pp1_dp0_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_1 [label="Expert A2A\nGPU 19->17\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer4 -> expert_all2all_pp1_dp0_layer4_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_1 -> expert_pp1_dp0_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_2 [label="Expert A2A\nGPU 19->18\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer4 -> expert_all2all_pp1_dp0_layer4_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer4_gpu3_to_2 -> expert_pp1_dp0_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_1 [label="Expert A2A\nGPU 20->21\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer4 -> expert_all2all_pp1_dp1_layer4_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_1 -> expert_pp1_dp1_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_2 [label="Expert A2A\nGPU 20->22\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer4 -> expert_all2all_pp1_dp1_layer4_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_2 -> expert_pp1_dp1_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_3 [label="Expert A2A\nGPU 20->23\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer4 -> expert_all2all_pp1_dp1_layer4_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu0_to_3 -> expert_pp1_dp1_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_0 [label="Expert A2A\nGPU 21->20\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer4 -> expert_all2all_pp1_dp1_layer4_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_0 -> expert_pp1_dp1_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_2 [label="Expert A2A\nGPU 21->22\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer4 -> expert_all2all_pp1_dp1_layer4_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_2 -> expert_pp1_dp1_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_3 [label="Expert A2A\nGPU 21->23\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer4 -> expert_all2all_pp1_dp1_layer4_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu1_to_3 -> expert_pp1_dp1_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_0 [label="Expert A2A\nGPU 22->20\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer4 -> expert_all2all_pp1_dp1_layer4_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_0 -> expert_pp1_dp1_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_1 [label="Expert A2A\nGPU 22->21\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer4 -> expert_all2all_pp1_dp1_layer4_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_1 -> expert_pp1_dp1_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_3 [label="Expert A2A\nGPU 22->23\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer4 -> expert_all2all_pp1_dp1_layer4_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu2_to_3 -> expert_pp1_dp1_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_0 [label="Expert A2A\nGPU 23->20\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer4 -> expert_all2all_pp1_dp1_layer4_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_0 -> expert_pp1_dp1_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_1 [label="Expert A2A\nGPU 23->21\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer4 -> expert_all2all_pp1_dp1_layer4_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_1 -> expert_pp1_dp1_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_2 [label="Expert A2A\nGPU 23->22\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer4 -> expert_all2all_pp1_dp1_layer4_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer4_gpu3_to_2 -> expert_pp1_dp1_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_1 [label="Expert A2A\nGPU 24->25\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer4 -> expert_all2all_pp1_dp2_layer4_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_1 -> expert_pp1_dp2_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_2 [label="Expert A2A\nGPU 24->26\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer4 -> expert_all2all_pp1_dp2_layer4_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_2 -> expert_pp1_dp2_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_3 [label="Expert A2A\nGPU 24->27\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer4 -> expert_all2all_pp1_dp2_layer4_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu0_to_3 -> expert_pp1_dp2_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_0 [label="Expert A2A\nGPU 25->24\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer4 -> expert_all2all_pp1_dp2_layer4_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_0 -> expert_pp1_dp2_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_2 [label="Expert A2A\nGPU 25->26\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer4 -> expert_all2all_pp1_dp2_layer4_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_2 -> expert_pp1_dp2_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_3 [label="Expert A2A\nGPU 25->27\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer4 -> expert_all2all_pp1_dp2_layer4_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu1_to_3 -> expert_pp1_dp2_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_0 [label="Expert A2A\nGPU 26->24\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer4 -> expert_all2all_pp1_dp2_layer4_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_0 -> expert_pp1_dp2_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_1 [label="Expert A2A\nGPU 26->25\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer4 -> expert_all2all_pp1_dp2_layer4_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_1 -> expert_pp1_dp2_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_3 [label="Expert A2A\nGPU 26->27\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer4 -> expert_all2all_pp1_dp2_layer4_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu2_to_3 -> expert_pp1_dp2_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_0 [label="Expert A2A\nGPU 27->24\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer4 -> expert_all2all_pp1_dp2_layer4_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_0 -> expert_pp1_dp2_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_1 [label="Expert A2A\nGPU 27->25\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer4 -> expert_all2all_pp1_dp2_layer4_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_1 -> expert_pp1_dp2_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_2 [label="Expert A2A\nGPU 27->26\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer4 -> expert_all2all_pp1_dp2_layer4_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer4_gpu3_to_2 -> expert_pp1_dp2_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_1 [label="Expert A2A\nGPU 28->29\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer4 -> expert_all2all_pp1_dp3_layer4_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_1 -> expert_pp1_dp3_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_2 [label="Expert A2A\nGPU 28->30\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer4 -> expert_all2all_pp1_dp3_layer4_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_2 -> expert_pp1_dp3_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_3 [label="Expert A2A\nGPU 28->31\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer4 -> expert_all2all_pp1_dp3_layer4_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu0_to_3 -> expert_pp1_dp3_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_0 [label="Expert A2A\nGPU 29->28\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer4 -> expert_all2all_pp1_dp3_layer4_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_0 -> expert_pp1_dp3_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_2 [label="Expert A2A\nGPU 29->30\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer4 -> expert_all2all_pp1_dp3_layer4_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_2 -> expert_pp1_dp3_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_3 [label="Expert A2A\nGPU 29->31\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer4 -> expert_all2all_pp1_dp3_layer4_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu1_to_3 -> expert_pp1_dp3_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_0 [label="Expert A2A\nGPU 30->28\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer4 -> expert_all2all_pp1_dp3_layer4_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_0 -> expert_pp1_dp3_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_1 [label="Expert A2A\nGPU 30->29\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer4 -> expert_all2all_pp1_dp3_layer4_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_1 -> expert_pp1_dp3_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_3 [label="Expert A2A\nGPU 30->31\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer4 -> expert_all2all_pp1_dp3_layer4_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu2_to_3 -> expert_pp1_dp3_gpu3_layer4_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_0 [label="Expert A2A\nGPU 31->28\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer4 -> expert_all2all_pp1_dp3_layer4_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_0 -> expert_pp1_dp3_gpu0_layer4_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_1 [label="Expert A2A\nGPU 31->29\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer4 -> expert_all2all_pp1_dp3_layer4_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_1 -> expert_pp1_dp3_gpu1_layer4_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_2 [label="Expert A2A\nGPU 31->30\nLayer 4\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer4 -> expert_all2all_pp1_dp3_layer4_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer4_gpu3_to_2 -> expert_pp1_dp3_gpu2_layer4_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_1 [label="Expert A2A\nGPU 16->17\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer5 -> expert_all2all_pp1_dp0_layer5_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_1 -> expert_pp1_dp0_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_2 [label="Expert A2A\nGPU 16->18\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer5 -> expert_all2all_pp1_dp0_layer5_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_2 -> expert_pp1_dp0_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_3 [label="Expert A2A\nGPU 16->19\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer5 -> expert_all2all_pp1_dp0_layer5_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu0_to_3 -> expert_pp1_dp0_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_0 [label="Expert A2A\nGPU 17->16\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer5 -> expert_all2all_pp1_dp0_layer5_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_0 -> expert_pp1_dp0_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_2 [label="Expert A2A\nGPU 17->18\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer5 -> expert_all2all_pp1_dp0_layer5_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_2 -> expert_pp1_dp0_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_3 [label="Expert A2A\nGPU 17->19\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer5 -> expert_all2all_pp1_dp0_layer5_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu1_to_3 -> expert_pp1_dp0_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_0 [label="Expert A2A\nGPU 18->16\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer5 -> expert_all2all_pp1_dp0_layer5_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_0 -> expert_pp1_dp0_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_1 [label="Expert A2A\nGPU 18->17\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer5 -> expert_all2all_pp1_dp0_layer5_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_1 -> expert_pp1_dp0_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_3 [label="Expert A2A\nGPU 18->19\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer5 -> expert_all2all_pp1_dp0_layer5_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu2_to_3 -> expert_pp1_dp0_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_0 [label="Expert A2A\nGPU 19->16\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer5 -> expert_all2all_pp1_dp0_layer5_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_0 -> expert_pp1_dp0_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_1 [label="Expert A2A\nGPU 19->17\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer5 -> expert_all2all_pp1_dp0_layer5_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_1 -> expert_pp1_dp0_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_2 [label="Expert A2A\nGPU 19->18\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer5 -> expert_all2all_pp1_dp0_layer5_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer5_gpu3_to_2 -> expert_pp1_dp0_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_1 [label="Expert A2A\nGPU 20->21\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer5 -> expert_all2all_pp1_dp1_layer5_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_1 -> expert_pp1_dp1_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_2 [label="Expert A2A\nGPU 20->22\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer5 -> expert_all2all_pp1_dp1_layer5_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_2 -> expert_pp1_dp1_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_3 [label="Expert A2A\nGPU 20->23\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer5 -> expert_all2all_pp1_dp1_layer5_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu0_to_3 -> expert_pp1_dp1_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_0 [label="Expert A2A\nGPU 21->20\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer5 -> expert_all2all_pp1_dp1_layer5_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_0 -> expert_pp1_dp1_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_2 [label="Expert A2A\nGPU 21->22\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer5 -> expert_all2all_pp1_dp1_layer5_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_2 -> expert_pp1_dp1_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_3 [label="Expert A2A\nGPU 21->23\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer5 -> expert_all2all_pp1_dp1_layer5_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu1_to_3 -> expert_pp1_dp1_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_0 [label="Expert A2A\nGPU 22->20\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer5 -> expert_all2all_pp1_dp1_layer5_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_0 -> expert_pp1_dp1_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_1 [label="Expert A2A\nGPU 22->21\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer5 -> expert_all2all_pp1_dp1_layer5_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_1 -> expert_pp1_dp1_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_3 [label="Expert A2A\nGPU 22->23\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer5 -> expert_all2all_pp1_dp1_layer5_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu2_to_3 -> expert_pp1_dp1_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_0 [label="Expert A2A\nGPU 23->20\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer5 -> expert_all2all_pp1_dp1_layer5_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_0 -> expert_pp1_dp1_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_1 [label="Expert A2A\nGPU 23->21\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer5 -> expert_all2all_pp1_dp1_layer5_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_1 -> expert_pp1_dp1_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_2 [label="Expert A2A\nGPU 23->22\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer5 -> expert_all2all_pp1_dp1_layer5_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer5_gpu3_to_2 -> expert_pp1_dp1_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_1 [label="Expert A2A\nGPU 24->25\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer5 -> expert_all2all_pp1_dp2_layer5_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_1 -> expert_pp1_dp2_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_2 [label="Expert A2A\nGPU 24->26\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer5 -> expert_all2all_pp1_dp2_layer5_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_2 -> expert_pp1_dp2_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_3 [label="Expert A2A\nGPU 24->27\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer5 -> expert_all2all_pp1_dp2_layer5_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu0_to_3 -> expert_pp1_dp2_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_0 [label="Expert A2A\nGPU 25->24\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer5 -> expert_all2all_pp1_dp2_layer5_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_0 -> expert_pp1_dp2_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_2 [label="Expert A2A\nGPU 25->26\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer5 -> expert_all2all_pp1_dp2_layer5_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_2 -> expert_pp1_dp2_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_3 [label="Expert A2A\nGPU 25->27\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer5 -> expert_all2all_pp1_dp2_layer5_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu1_to_3 -> expert_pp1_dp2_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_0 [label="Expert A2A\nGPU 26->24\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer5 -> expert_all2all_pp1_dp2_layer5_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_0 -> expert_pp1_dp2_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_1 [label="Expert A2A\nGPU 26->25\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer5 -> expert_all2all_pp1_dp2_layer5_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_1 -> expert_pp1_dp2_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_3 [label="Expert A2A\nGPU 26->27\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer5 -> expert_all2all_pp1_dp2_layer5_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu2_to_3 -> expert_pp1_dp2_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_0 [label="Expert A2A\nGPU 27->24\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer5 -> expert_all2all_pp1_dp2_layer5_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_0 -> expert_pp1_dp2_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_1 [label="Expert A2A\nGPU 27->25\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer5 -> expert_all2all_pp1_dp2_layer5_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_1 -> expert_pp1_dp2_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_2 [label="Expert A2A\nGPU 27->26\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer5 -> expert_all2all_pp1_dp2_layer5_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer5_gpu3_to_2 -> expert_pp1_dp2_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_1 [label="Expert A2A\nGPU 28->29\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer5 -> expert_all2all_pp1_dp3_layer5_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_1 -> expert_pp1_dp3_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_2 [label="Expert A2A\nGPU 28->30\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer5 -> expert_all2all_pp1_dp3_layer5_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_2 -> expert_pp1_dp3_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_3 [label="Expert A2A\nGPU 28->31\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer5 -> expert_all2all_pp1_dp3_layer5_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu0_to_3 -> expert_pp1_dp3_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_0 [label="Expert A2A\nGPU 29->28\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer5 -> expert_all2all_pp1_dp3_layer5_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_0 -> expert_pp1_dp3_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_2 [label="Expert A2A\nGPU 29->30\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer5 -> expert_all2all_pp1_dp3_layer5_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_2 -> expert_pp1_dp3_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_3 [label="Expert A2A\nGPU 29->31\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer5 -> expert_all2all_pp1_dp3_layer5_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu1_to_3 -> expert_pp1_dp3_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_0 [label="Expert A2A\nGPU 30->28\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer5 -> expert_all2all_pp1_dp3_layer5_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_0 -> expert_pp1_dp3_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_1 [label="Expert A2A\nGPU 30->29\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer5 -> expert_all2all_pp1_dp3_layer5_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_1 -> expert_pp1_dp3_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_3 [label="Expert A2A\nGPU 30->31\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer5 -> expert_all2all_pp1_dp3_layer5_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu2_to_3 -> expert_pp1_dp3_gpu3_layer5_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_0 [label="Expert A2A\nGPU 31->28\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer5 -> expert_all2all_pp1_dp3_layer5_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_0 -> expert_pp1_dp3_gpu0_layer5_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_1 [label="Expert A2A\nGPU 31->29\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer5 -> expert_all2all_pp1_dp3_layer5_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_1 -> expert_pp1_dp3_gpu1_layer5_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_2 [label="Expert A2A\nGPU 31->30\nLayer 5\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer5 -> expert_all2all_pp1_dp3_layer5_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer5_gpu3_to_2 -> expert_pp1_dp3_gpu2_layer5_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_1 [label="Expert A2A\nGPU 16->17\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer6 -> expert_all2all_pp1_dp0_layer6_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_1 -> expert_pp1_dp0_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_2 [label="Expert A2A\nGPU 16->18\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer6 -> expert_all2all_pp1_dp0_layer6_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_2 -> expert_pp1_dp0_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_3 [label="Expert A2A\nGPU 16->19\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer6 -> expert_all2all_pp1_dp0_layer6_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu0_to_3 -> expert_pp1_dp0_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_0 [label="Expert A2A\nGPU 17->16\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer6 -> expert_all2all_pp1_dp0_layer6_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_0 -> expert_pp1_dp0_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_2 [label="Expert A2A\nGPU 17->18\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer6 -> expert_all2all_pp1_dp0_layer6_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_2 -> expert_pp1_dp0_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_3 [label="Expert A2A\nGPU 17->19\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer6 -> expert_all2all_pp1_dp0_layer6_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu1_to_3 -> expert_pp1_dp0_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_0 [label="Expert A2A\nGPU 18->16\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer6 -> expert_all2all_pp1_dp0_layer6_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_0 -> expert_pp1_dp0_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_1 [label="Expert A2A\nGPU 18->17\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer6 -> expert_all2all_pp1_dp0_layer6_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_1 -> expert_pp1_dp0_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_3 [label="Expert A2A\nGPU 18->19\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer6 -> expert_all2all_pp1_dp0_layer6_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu2_to_3 -> expert_pp1_dp0_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_0 [label="Expert A2A\nGPU 19->16\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer6 -> expert_all2all_pp1_dp0_layer6_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_0 -> expert_pp1_dp0_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_1 [label="Expert A2A\nGPU 19->17\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer6 -> expert_all2all_pp1_dp0_layer6_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_1 -> expert_pp1_dp0_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_2 [label="Expert A2A\nGPU 19->18\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer6 -> expert_all2all_pp1_dp0_layer6_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer6_gpu3_to_2 -> expert_pp1_dp0_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_1 [label="Expert A2A\nGPU 20->21\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer6 -> expert_all2all_pp1_dp1_layer6_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_1 -> expert_pp1_dp1_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_2 [label="Expert A2A\nGPU 20->22\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer6 -> expert_all2all_pp1_dp1_layer6_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_2 -> expert_pp1_dp1_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_3 [label="Expert A2A\nGPU 20->23\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer6 -> expert_all2all_pp1_dp1_layer6_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu0_to_3 -> expert_pp1_dp1_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_0 [label="Expert A2A\nGPU 21->20\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer6 -> expert_all2all_pp1_dp1_layer6_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_0 -> expert_pp1_dp1_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_2 [label="Expert A2A\nGPU 21->22\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer6 -> expert_all2all_pp1_dp1_layer6_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_2 -> expert_pp1_dp1_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_3 [label="Expert A2A\nGPU 21->23\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer6 -> expert_all2all_pp1_dp1_layer6_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu1_to_3 -> expert_pp1_dp1_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_0 [label="Expert A2A\nGPU 22->20\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer6 -> expert_all2all_pp1_dp1_layer6_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_0 -> expert_pp1_dp1_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_1 [label="Expert A2A\nGPU 22->21\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer6 -> expert_all2all_pp1_dp1_layer6_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_1 -> expert_pp1_dp1_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_3 [label="Expert A2A\nGPU 22->23\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer6 -> expert_all2all_pp1_dp1_layer6_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu2_to_3 -> expert_pp1_dp1_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_0 [label="Expert A2A\nGPU 23->20\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer6 -> expert_all2all_pp1_dp1_layer6_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_0 -> expert_pp1_dp1_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_1 [label="Expert A2A\nGPU 23->21\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer6 -> expert_all2all_pp1_dp1_layer6_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_1 -> expert_pp1_dp1_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_2 [label="Expert A2A\nGPU 23->22\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer6 -> expert_all2all_pp1_dp1_layer6_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer6_gpu3_to_2 -> expert_pp1_dp1_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_1 [label="Expert A2A\nGPU 24->25\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer6 -> expert_all2all_pp1_dp2_layer6_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_1 -> expert_pp1_dp2_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_2 [label="Expert A2A\nGPU 24->26\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer6 -> expert_all2all_pp1_dp2_layer6_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_2 -> expert_pp1_dp2_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_3 [label="Expert A2A\nGPU 24->27\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer6 -> expert_all2all_pp1_dp2_layer6_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu0_to_3 -> expert_pp1_dp2_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_0 [label="Expert A2A\nGPU 25->24\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer6 -> expert_all2all_pp1_dp2_layer6_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_0 -> expert_pp1_dp2_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_2 [label="Expert A2A\nGPU 25->26\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer6 -> expert_all2all_pp1_dp2_layer6_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_2 -> expert_pp1_dp2_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_3 [label="Expert A2A\nGPU 25->27\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer6 -> expert_all2all_pp1_dp2_layer6_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu1_to_3 -> expert_pp1_dp2_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_0 [label="Expert A2A\nGPU 26->24\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer6 -> expert_all2all_pp1_dp2_layer6_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_0 -> expert_pp1_dp2_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_1 [label="Expert A2A\nGPU 26->25\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer6 -> expert_all2all_pp1_dp2_layer6_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_1 -> expert_pp1_dp2_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_3 [label="Expert A2A\nGPU 26->27\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer6 -> expert_all2all_pp1_dp2_layer6_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu2_to_3 -> expert_pp1_dp2_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_0 [label="Expert A2A\nGPU 27->24\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer6 -> expert_all2all_pp1_dp2_layer6_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_0 -> expert_pp1_dp2_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_1 [label="Expert A2A\nGPU 27->25\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer6 -> expert_all2all_pp1_dp2_layer6_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_1 -> expert_pp1_dp2_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_2 [label="Expert A2A\nGPU 27->26\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer6 -> expert_all2all_pp1_dp2_layer6_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer6_gpu3_to_2 -> expert_pp1_dp2_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_1 [label="Expert A2A\nGPU 28->29\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer6 -> expert_all2all_pp1_dp3_layer6_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_1 -> expert_pp1_dp3_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_2 [label="Expert A2A\nGPU 28->30\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer6 -> expert_all2all_pp1_dp3_layer6_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_2 -> expert_pp1_dp3_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_3 [label="Expert A2A\nGPU 28->31\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer6 -> expert_all2all_pp1_dp3_layer6_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu0_to_3 -> expert_pp1_dp3_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_0 [label="Expert A2A\nGPU 29->28\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer6 -> expert_all2all_pp1_dp3_layer6_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_0 -> expert_pp1_dp3_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_2 [label="Expert A2A\nGPU 29->30\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer6 -> expert_all2all_pp1_dp3_layer6_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_2 -> expert_pp1_dp3_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_3 [label="Expert A2A\nGPU 29->31\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer6 -> expert_all2all_pp1_dp3_layer6_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu1_to_3 -> expert_pp1_dp3_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_0 [label="Expert A2A\nGPU 30->28\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer6 -> expert_all2all_pp1_dp3_layer6_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_0 -> expert_pp1_dp3_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_1 [label="Expert A2A\nGPU 30->29\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer6 -> expert_all2all_pp1_dp3_layer6_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_1 -> expert_pp1_dp3_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_3 [label="Expert A2A\nGPU 30->31\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer6 -> expert_all2all_pp1_dp3_layer6_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu2_to_3 -> expert_pp1_dp3_gpu3_layer6_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_0 [label="Expert A2A\nGPU 31->28\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer6 -> expert_all2all_pp1_dp3_layer6_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_0 -> expert_pp1_dp3_gpu0_layer6_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_1 [label="Expert A2A\nGPU 31->29\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer6 -> expert_all2all_pp1_dp3_layer6_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_1 -> expert_pp1_dp3_gpu1_layer6_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_2 [label="Expert A2A\nGPU 31->30\nLayer 6\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer6 -> expert_all2all_pp1_dp3_layer6_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer6_gpu3_to_2 -> expert_pp1_dp3_gpu2_layer6_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_1 [label="Expert A2A\nGPU 16->17\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer7 -> expert_all2all_pp1_dp0_layer7_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_1 -> expert_pp1_dp0_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_2 [label="Expert A2A\nGPU 16->18\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer7 -> expert_all2all_pp1_dp0_layer7_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_2 -> expert_pp1_dp0_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_3 [label="Expert A2A\nGPU 16->19\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu0_layer7 -> expert_all2all_pp1_dp0_layer7_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu0_to_3 -> expert_pp1_dp0_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_0 [label="Expert A2A\nGPU 17->16\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer7 -> expert_all2all_pp1_dp0_layer7_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_0 -> expert_pp1_dp0_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_2 [label="Expert A2A\nGPU 17->18\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer7 -> expert_all2all_pp1_dp0_layer7_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_2 -> expert_pp1_dp0_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_3 [label="Expert A2A\nGPU 17->19\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu1_layer7 -> expert_all2all_pp1_dp0_layer7_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu1_to_3 -> expert_pp1_dp0_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_0 [label="Expert A2A\nGPU 18->16\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer7 -> expert_all2all_pp1_dp0_layer7_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_0 -> expert_pp1_dp0_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_1 [label="Expert A2A\nGPU 18->17\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer7 -> expert_all2all_pp1_dp0_layer7_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_1 -> expert_pp1_dp0_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_3 [label="Expert A2A\nGPU 18->19\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu2_layer7 -> expert_all2all_pp1_dp0_layer7_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu2_to_3 -> expert_pp1_dp0_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_0 [label="Expert A2A\nGPU 19->16\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer7 -> expert_all2all_pp1_dp0_layer7_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_0 -> expert_pp1_dp0_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_1 [label="Expert A2A\nGPU 19->17\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer7 -> expert_all2all_pp1_dp0_layer7_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_1 -> expert_pp1_dp0_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_2 [label="Expert A2A\nGPU 19->18\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp0_gpu3_layer7 -> expert_all2all_pp1_dp0_layer7_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp0_layer7_gpu3_to_2 -> expert_pp1_dp0_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_1 [label="Expert A2A\nGPU 20->21\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer7 -> expert_all2all_pp1_dp1_layer7_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_1 -> expert_pp1_dp1_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_2 [label="Expert A2A\nGPU 20->22\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer7 -> expert_all2all_pp1_dp1_layer7_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_2 -> expert_pp1_dp1_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_3 [label="Expert A2A\nGPU 20->23\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu0_layer7 -> expert_all2all_pp1_dp1_layer7_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu0_to_3 -> expert_pp1_dp1_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_0 [label="Expert A2A\nGPU 21->20\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer7 -> expert_all2all_pp1_dp1_layer7_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_0 -> expert_pp1_dp1_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_2 [label="Expert A2A\nGPU 21->22\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer7 -> expert_all2all_pp1_dp1_layer7_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_2 -> expert_pp1_dp1_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_3 [label="Expert A2A\nGPU 21->23\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu1_layer7 -> expert_all2all_pp1_dp1_layer7_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu1_to_3 -> expert_pp1_dp1_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_0 [label="Expert A2A\nGPU 22->20\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer7 -> expert_all2all_pp1_dp1_layer7_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_0 -> expert_pp1_dp1_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_1 [label="Expert A2A\nGPU 22->21\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer7 -> expert_all2all_pp1_dp1_layer7_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_1 -> expert_pp1_dp1_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_3 [label="Expert A2A\nGPU 22->23\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu2_layer7 -> expert_all2all_pp1_dp1_layer7_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu2_to_3 -> expert_pp1_dp1_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_0 [label="Expert A2A\nGPU 23->20\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer7 -> expert_all2all_pp1_dp1_layer7_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_0 -> expert_pp1_dp1_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_1 [label="Expert A2A\nGPU 23->21\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer7 -> expert_all2all_pp1_dp1_layer7_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_1 -> expert_pp1_dp1_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_2 [label="Expert A2A\nGPU 23->22\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp1_gpu3_layer7 -> expert_all2all_pp1_dp1_layer7_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp1_layer7_gpu3_to_2 -> expert_pp1_dp1_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_1 [label="Expert A2A\nGPU 24->25\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer7 -> expert_all2all_pp1_dp2_layer7_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_1 -> expert_pp1_dp2_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_2 [label="Expert A2A\nGPU 24->26\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer7 -> expert_all2all_pp1_dp2_layer7_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_2 -> expert_pp1_dp2_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_3 [label="Expert A2A\nGPU 24->27\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu0_layer7 -> expert_all2all_pp1_dp2_layer7_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu0_to_3 -> expert_pp1_dp2_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_0 [label="Expert A2A\nGPU 25->24\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer7 -> expert_all2all_pp1_dp2_layer7_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_0 -> expert_pp1_dp2_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_2 [label="Expert A2A\nGPU 25->26\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer7 -> expert_all2all_pp1_dp2_layer7_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_2 -> expert_pp1_dp2_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_3 [label="Expert A2A\nGPU 25->27\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu1_layer7 -> expert_all2all_pp1_dp2_layer7_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu1_to_3 -> expert_pp1_dp2_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_0 [label="Expert A2A\nGPU 26->24\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer7 -> expert_all2all_pp1_dp2_layer7_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_0 -> expert_pp1_dp2_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_1 [label="Expert A2A\nGPU 26->25\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer7 -> expert_all2all_pp1_dp2_layer7_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_1 -> expert_pp1_dp2_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_3 [label="Expert A2A\nGPU 26->27\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu2_layer7 -> expert_all2all_pp1_dp2_layer7_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu2_to_3 -> expert_pp1_dp2_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_0 [label="Expert A2A\nGPU 27->24\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer7 -> expert_all2all_pp1_dp2_layer7_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_0 -> expert_pp1_dp2_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_1 [label="Expert A2A\nGPU 27->25\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer7 -> expert_all2all_pp1_dp2_layer7_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_1 -> expert_pp1_dp2_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_2 [label="Expert A2A\nGPU 27->26\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp2_gpu3_layer7 -> expert_all2all_pp1_dp2_layer7_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp2_layer7_gpu3_to_2 -> expert_pp1_dp2_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_1 [label="Expert A2A\nGPU 28->29\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer7 -> expert_all2all_pp1_dp3_layer7_gpu0_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_1 -> expert_pp1_dp3_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_2 [label="Expert A2A\nGPU 28->30\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer7 -> expert_all2all_pp1_dp3_layer7_gpu0_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_2 -> expert_pp1_dp3_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_3 [label="Expert A2A\nGPU 28->31\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu0_layer7 -> expert_all2all_pp1_dp3_layer7_gpu0_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu0_to_3 -> expert_pp1_dp3_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_0 [label="Expert A2A\nGPU 29->28\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer7 -> expert_all2all_pp1_dp3_layer7_gpu1_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_0 -> expert_pp1_dp3_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_2 [label="Expert A2A\nGPU 29->30\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer7 -> expert_all2all_pp1_dp3_layer7_gpu1_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_2 -> expert_pp1_dp3_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_3 [label="Expert A2A\nGPU 29->31\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu1_layer7 -> expert_all2all_pp1_dp3_layer7_gpu1_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu1_to_3 -> expert_pp1_dp3_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_0 [label="Expert A2A\nGPU 30->28\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer7 -> expert_all2all_pp1_dp3_layer7_gpu2_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_0 -> expert_pp1_dp3_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_1 [label="Expert A2A\nGPU 30->29\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer7 -> expert_all2all_pp1_dp3_layer7_gpu2_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_1 -> expert_pp1_dp3_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_3 [label="Expert A2A\nGPU 30->31\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu2_layer7 -> expert_all2all_pp1_dp3_layer7_gpu2_to_3 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu2_to_3 -> expert_pp1_dp3_gpu3_layer7_exp12 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_0 [label="Expert A2A\nGPU 31->28\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer7 -> expert_all2all_pp1_dp3_layer7_gpu3_to_0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_0 -> expert_pp1_dp3_gpu0_layer7_exp0 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_1 [label="Expert A2A\nGPU 31->29\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer7 -> expert_all2all_pp1_dp3_layer7_gpu3_to_1 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_1 -> expert_pp1_dp3_gpu1_layer7_exp4 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_2 [label="Expert A2A\nGPU 31->30\nLayer 7\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp1_dp3_gpu3_layer7 -> expert_all2all_pp1_dp3_layer7_gpu3_to_2 [style=dotted]
	expert_all2all_pp1_dp3_layer7_gpu3_to_2 -> expert_pp1_dp3_gpu2_layer7_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_1 [label="Expert A2A\nGPU 32->33\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer8 -> expert_all2all_pp2_dp0_layer8_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_1 -> expert_pp2_dp0_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_2 [label="Expert A2A\nGPU 32->34\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer8 -> expert_all2all_pp2_dp0_layer8_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_2 -> expert_pp2_dp0_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_3 [label="Expert A2A\nGPU 32->35\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer8 -> expert_all2all_pp2_dp0_layer8_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu0_to_3 -> expert_pp2_dp0_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_0 [label="Expert A2A\nGPU 33->32\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer8 -> expert_all2all_pp2_dp0_layer8_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_0 -> expert_pp2_dp0_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_2 [label="Expert A2A\nGPU 33->34\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer8 -> expert_all2all_pp2_dp0_layer8_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_2 -> expert_pp2_dp0_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_3 [label="Expert A2A\nGPU 33->35\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer8 -> expert_all2all_pp2_dp0_layer8_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu1_to_3 -> expert_pp2_dp0_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_0 [label="Expert A2A\nGPU 34->32\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer8 -> expert_all2all_pp2_dp0_layer8_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_0 -> expert_pp2_dp0_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_1 [label="Expert A2A\nGPU 34->33\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer8 -> expert_all2all_pp2_dp0_layer8_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_1 -> expert_pp2_dp0_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_3 [label="Expert A2A\nGPU 34->35\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer8 -> expert_all2all_pp2_dp0_layer8_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu2_to_3 -> expert_pp2_dp0_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_0 [label="Expert A2A\nGPU 35->32\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer8 -> expert_all2all_pp2_dp0_layer8_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_0 -> expert_pp2_dp0_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_1 [label="Expert A2A\nGPU 35->33\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer8 -> expert_all2all_pp2_dp0_layer8_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_1 -> expert_pp2_dp0_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_2 [label="Expert A2A\nGPU 35->34\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer8 -> expert_all2all_pp2_dp0_layer8_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer8_gpu3_to_2 -> expert_pp2_dp0_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_1 [label="Expert A2A\nGPU 36->37\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer8 -> expert_all2all_pp2_dp1_layer8_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_1 -> expert_pp2_dp1_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_2 [label="Expert A2A\nGPU 36->38\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer8 -> expert_all2all_pp2_dp1_layer8_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_2 -> expert_pp2_dp1_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_3 [label="Expert A2A\nGPU 36->39\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer8 -> expert_all2all_pp2_dp1_layer8_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu0_to_3 -> expert_pp2_dp1_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_0 [label="Expert A2A\nGPU 37->36\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer8 -> expert_all2all_pp2_dp1_layer8_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_0 -> expert_pp2_dp1_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_2 [label="Expert A2A\nGPU 37->38\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer8 -> expert_all2all_pp2_dp1_layer8_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_2 -> expert_pp2_dp1_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_3 [label="Expert A2A\nGPU 37->39\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer8 -> expert_all2all_pp2_dp1_layer8_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu1_to_3 -> expert_pp2_dp1_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_0 [label="Expert A2A\nGPU 38->36\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer8 -> expert_all2all_pp2_dp1_layer8_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_0 -> expert_pp2_dp1_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_1 [label="Expert A2A\nGPU 38->37\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer8 -> expert_all2all_pp2_dp1_layer8_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_1 -> expert_pp2_dp1_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_3 [label="Expert A2A\nGPU 38->39\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer8 -> expert_all2all_pp2_dp1_layer8_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu2_to_3 -> expert_pp2_dp1_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_0 [label="Expert A2A\nGPU 39->36\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer8 -> expert_all2all_pp2_dp1_layer8_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_0 -> expert_pp2_dp1_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_1 [label="Expert A2A\nGPU 39->37\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer8 -> expert_all2all_pp2_dp1_layer8_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_1 -> expert_pp2_dp1_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_2 [label="Expert A2A\nGPU 39->38\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer8 -> expert_all2all_pp2_dp1_layer8_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer8_gpu3_to_2 -> expert_pp2_dp1_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_1 [label="Expert A2A\nGPU 40->41\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer8 -> expert_all2all_pp2_dp2_layer8_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_1 -> expert_pp2_dp2_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_2 [label="Expert A2A\nGPU 40->42\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer8 -> expert_all2all_pp2_dp2_layer8_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_2 -> expert_pp2_dp2_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_3 [label="Expert A2A\nGPU 40->43\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer8 -> expert_all2all_pp2_dp2_layer8_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu0_to_3 -> expert_pp2_dp2_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_0 [label="Expert A2A\nGPU 41->40\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer8 -> expert_all2all_pp2_dp2_layer8_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_0 -> expert_pp2_dp2_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_2 [label="Expert A2A\nGPU 41->42\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer8 -> expert_all2all_pp2_dp2_layer8_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_2 -> expert_pp2_dp2_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_3 [label="Expert A2A\nGPU 41->43\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer8 -> expert_all2all_pp2_dp2_layer8_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu1_to_3 -> expert_pp2_dp2_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_0 [label="Expert A2A\nGPU 42->40\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer8 -> expert_all2all_pp2_dp2_layer8_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_0 -> expert_pp2_dp2_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_1 [label="Expert A2A\nGPU 42->41\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer8 -> expert_all2all_pp2_dp2_layer8_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_1 -> expert_pp2_dp2_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_3 [label="Expert A2A\nGPU 42->43\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer8 -> expert_all2all_pp2_dp2_layer8_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu2_to_3 -> expert_pp2_dp2_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_0 [label="Expert A2A\nGPU 43->40\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer8 -> expert_all2all_pp2_dp2_layer8_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_0 -> expert_pp2_dp2_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_1 [label="Expert A2A\nGPU 43->41\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer8 -> expert_all2all_pp2_dp2_layer8_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_1 -> expert_pp2_dp2_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_2 [label="Expert A2A\nGPU 43->42\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer8 -> expert_all2all_pp2_dp2_layer8_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer8_gpu3_to_2 -> expert_pp2_dp2_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_1 [label="Expert A2A\nGPU 44->45\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer8 -> expert_all2all_pp2_dp3_layer8_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_1 -> expert_pp2_dp3_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_2 [label="Expert A2A\nGPU 44->46\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer8 -> expert_all2all_pp2_dp3_layer8_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_2 -> expert_pp2_dp3_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_3 [label="Expert A2A\nGPU 44->47\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer8 -> expert_all2all_pp2_dp3_layer8_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu0_to_3 -> expert_pp2_dp3_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_0 [label="Expert A2A\nGPU 45->44\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer8 -> expert_all2all_pp2_dp3_layer8_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_0 -> expert_pp2_dp3_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_2 [label="Expert A2A\nGPU 45->46\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer8 -> expert_all2all_pp2_dp3_layer8_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_2 -> expert_pp2_dp3_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_3 [label="Expert A2A\nGPU 45->47\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer8 -> expert_all2all_pp2_dp3_layer8_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu1_to_3 -> expert_pp2_dp3_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_0 [label="Expert A2A\nGPU 46->44\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer8 -> expert_all2all_pp2_dp3_layer8_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_0 -> expert_pp2_dp3_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_1 [label="Expert A2A\nGPU 46->45\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer8 -> expert_all2all_pp2_dp3_layer8_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_1 -> expert_pp2_dp3_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_3 [label="Expert A2A\nGPU 46->47\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer8 -> expert_all2all_pp2_dp3_layer8_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu2_to_3 -> expert_pp2_dp3_gpu3_layer8_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_0 [label="Expert A2A\nGPU 47->44\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer8 -> expert_all2all_pp2_dp3_layer8_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_0 -> expert_pp2_dp3_gpu0_layer8_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_1 [label="Expert A2A\nGPU 47->45\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer8 -> expert_all2all_pp2_dp3_layer8_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_1 -> expert_pp2_dp3_gpu1_layer8_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_2 [label="Expert A2A\nGPU 47->46\nLayer 8\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer8 -> expert_all2all_pp2_dp3_layer8_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer8_gpu3_to_2 -> expert_pp2_dp3_gpu2_layer8_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_1 [label="Expert A2A\nGPU 32->33\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer9 -> expert_all2all_pp2_dp0_layer9_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_1 -> expert_pp2_dp0_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_2 [label="Expert A2A\nGPU 32->34\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer9 -> expert_all2all_pp2_dp0_layer9_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_2 -> expert_pp2_dp0_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_3 [label="Expert A2A\nGPU 32->35\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer9 -> expert_all2all_pp2_dp0_layer9_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu0_to_3 -> expert_pp2_dp0_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_0 [label="Expert A2A\nGPU 33->32\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer9 -> expert_all2all_pp2_dp0_layer9_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_0 -> expert_pp2_dp0_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_2 [label="Expert A2A\nGPU 33->34\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer9 -> expert_all2all_pp2_dp0_layer9_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_2 -> expert_pp2_dp0_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_3 [label="Expert A2A\nGPU 33->35\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer9 -> expert_all2all_pp2_dp0_layer9_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu1_to_3 -> expert_pp2_dp0_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_0 [label="Expert A2A\nGPU 34->32\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer9 -> expert_all2all_pp2_dp0_layer9_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_0 -> expert_pp2_dp0_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_1 [label="Expert A2A\nGPU 34->33\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer9 -> expert_all2all_pp2_dp0_layer9_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_1 -> expert_pp2_dp0_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_3 [label="Expert A2A\nGPU 34->35\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer9 -> expert_all2all_pp2_dp0_layer9_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu2_to_3 -> expert_pp2_dp0_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_0 [label="Expert A2A\nGPU 35->32\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer9 -> expert_all2all_pp2_dp0_layer9_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_0 -> expert_pp2_dp0_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_1 [label="Expert A2A\nGPU 35->33\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer9 -> expert_all2all_pp2_dp0_layer9_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_1 -> expert_pp2_dp0_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_2 [label="Expert A2A\nGPU 35->34\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer9 -> expert_all2all_pp2_dp0_layer9_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer9_gpu3_to_2 -> expert_pp2_dp0_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_1 [label="Expert A2A\nGPU 36->37\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer9 -> expert_all2all_pp2_dp1_layer9_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_1 -> expert_pp2_dp1_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_2 [label="Expert A2A\nGPU 36->38\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer9 -> expert_all2all_pp2_dp1_layer9_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_2 -> expert_pp2_dp1_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_3 [label="Expert A2A\nGPU 36->39\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer9 -> expert_all2all_pp2_dp1_layer9_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu0_to_3 -> expert_pp2_dp1_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_0 [label="Expert A2A\nGPU 37->36\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer9 -> expert_all2all_pp2_dp1_layer9_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_0 -> expert_pp2_dp1_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_2 [label="Expert A2A\nGPU 37->38\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer9 -> expert_all2all_pp2_dp1_layer9_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_2 -> expert_pp2_dp1_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_3 [label="Expert A2A\nGPU 37->39\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer9 -> expert_all2all_pp2_dp1_layer9_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu1_to_3 -> expert_pp2_dp1_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_0 [label="Expert A2A\nGPU 38->36\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer9 -> expert_all2all_pp2_dp1_layer9_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_0 -> expert_pp2_dp1_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_1 [label="Expert A2A\nGPU 38->37\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer9 -> expert_all2all_pp2_dp1_layer9_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_1 -> expert_pp2_dp1_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_3 [label="Expert A2A\nGPU 38->39\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer9 -> expert_all2all_pp2_dp1_layer9_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu2_to_3 -> expert_pp2_dp1_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_0 [label="Expert A2A\nGPU 39->36\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer9 -> expert_all2all_pp2_dp1_layer9_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_0 -> expert_pp2_dp1_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_1 [label="Expert A2A\nGPU 39->37\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer9 -> expert_all2all_pp2_dp1_layer9_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_1 -> expert_pp2_dp1_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_2 [label="Expert A2A\nGPU 39->38\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer9 -> expert_all2all_pp2_dp1_layer9_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer9_gpu3_to_2 -> expert_pp2_dp1_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_1 [label="Expert A2A\nGPU 40->41\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer9 -> expert_all2all_pp2_dp2_layer9_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_1 -> expert_pp2_dp2_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_2 [label="Expert A2A\nGPU 40->42\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer9 -> expert_all2all_pp2_dp2_layer9_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_2 -> expert_pp2_dp2_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_3 [label="Expert A2A\nGPU 40->43\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer9 -> expert_all2all_pp2_dp2_layer9_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu0_to_3 -> expert_pp2_dp2_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_0 [label="Expert A2A\nGPU 41->40\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer9 -> expert_all2all_pp2_dp2_layer9_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_0 -> expert_pp2_dp2_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_2 [label="Expert A2A\nGPU 41->42\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer9 -> expert_all2all_pp2_dp2_layer9_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_2 -> expert_pp2_dp2_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_3 [label="Expert A2A\nGPU 41->43\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer9 -> expert_all2all_pp2_dp2_layer9_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu1_to_3 -> expert_pp2_dp2_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_0 [label="Expert A2A\nGPU 42->40\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer9 -> expert_all2all_pp2_dp2_layer9_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_0 -> expert_pp2_dp2_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_1 [label="Expert A2A\nGPU 42->41\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer9 -> expert_all2all_pp2_dp2_layer9_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_1 -> expert_pp2_dp2_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_3 [label="Expert A2A\nGPU 42->43\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer9 -> expert_all2all_pp2_dp2_layer9_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu2_to_3 -> expert_pp2_dp2_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_0 [label="Expert A2A\nGPU 43->40\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer9 -> expert_all2all_pp2_dp2_layer9_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_0 -> expert_pp2_dp2_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_1 [label="Expert A2A\nGPU 43->41\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer9 -> expert_all2all_pp2_dp2_layer9_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_1 -> expert_pp2_dp2_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_2 [label="Expert A2A\nGPU 43->42\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer9 -> expert_all2all_pp2_dp2_layer9_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer9_gpu3_to_2 -> expert_pp2_dp2_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_1 [label="Expert A2A\nGPU 44->45\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer9 -> expert_all2all_pp2_dp3_layer9_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_1 -> expert_pp2_dp3_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_2 [label="Expert A2A\nGPU 44->46\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer9 -> expert_all2all_pp2_dp3_layer9_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_2 -> expert_pp2_dp3_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_3 [label="Expert A2A\nGPU 44->47\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer9 -> expert_all2all_pp2_dp3_layer9_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu0_to_3 -> expert_pp2_dp3_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_0 [label="Expert A2A\nGPU 45->44\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer9 -> expert_all2all_pp2_dp3_layer9_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_0 -> expert_pp2_dp3_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_2 [label="Expert A2A\nGPU 45->46\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer9 -> expert_all2all_pp2_dp3_layer9_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_2 -> expert_pp2_dp3_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_3 [label="Expert A2A\nGPU 45->47\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer9 -> expert_all2all_pp2_dp3_layer9_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu1_to_3 -> expert_pp2_dp3_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_0 [label="Expert A2A\nGPU 46->44\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer9 -> expert_all2all_pp2_dp3_layer9_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_0 -> expert_pp2_dp3_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_1 [label="Expert A2A\nGPU 46->45\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer9 -> expert_all2all_pp2_dp3_layer9_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_1 -> expert_pp2_dp3_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_3 [label="Expert A2A\nGPU 46->47\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer9 -> expert_all2all_pp2_dp3_layer9_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu2_to_3 -> expert_pp2_dp3_gpu3_layer9_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_0 [label="Expert A2A\nGPU 47->44\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer9 -> expert_all2all_pp2_dp3_layer9_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_0 -> expert_pp2_dp3_gpu0_layer9_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_1 [label="Expert A2A\nGPU 47->45\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer9 -> expert_all2all_pp2_dp3_layer9_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_1 -> expert_pp2_dp3_gpu1_layer9_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_2 [label="Expert A2A\nGPU 47->46\nLayer 9\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer9 -> expert_all2all_pp2_dp3_layer9_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer9_gpu3_to_2 -> expert_pp2_dp3_gpu2_layer9_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_1 [label="Expert A2A\nGPU 32->33\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer10 -> expert_all2all_pp2_dp0_layer10_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_1 -> expert_pp2_dp0_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_2 [label="Expert A2A\nGPU 32->34\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer10 -> expert_all2all_pp2_dp0_layer10_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_2 -> expert_pp2_dp0_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_3 [label="Expert A2A\nGPU 32->35\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer10 -> expert_all2all_pp2_dp0_layer10_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu0_to_3 -> expert_pp2_dp0_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_0 [label="Expert A2A\nGPU 33->32\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer10 -> expert_all2all_pp2_dp0_layer10_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_0 -> expert_pp2_dp0_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_2 [label="Expert A2A\nGPU 33->34\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer10 -> expert_all2all_pp2_dp0_layer10_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_2 -> expert_pp2_dp0_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_3 [label="Expert A2A\nGPU 33->35\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer10 -> expert_all2all_pp2_dp0_layer10_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu1_to_3 -> expert_pp2_dp0_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_0 [label="Expert A2A\nGPU 34->32\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer10 -> expert_all2all_pp2_dp0_layer10_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_0 -> expert_pp2_dp0_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_1 [label="Expert A2A\nGPU 34->33\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer10 -> expert_all2all_pp2_dp0_layer10_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_1 -> expert_pp2_dp0_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_3 [label="Expert A2A\nGPU 34->35\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer10 -> expert_all2all_pp2_dp0_layer10_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu2_to_3 -> expert_pp2_dp0_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_0 [label="Expert A2A\nGPU 35->32\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer10 -> expert_all2all_pp2_dp0_layer10_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_0 -> expert_pp2_dp0_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_1 [label="Expert A2A\nGPU 35->33\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer10 -> expert_all2all_pp2_dp0_layer10_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_1 -> expert_pp2_dp0_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_2 [label="Expert A2A\nGPU 35->34\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer10 -> expert_all2all_pp2_dp0_layer10_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer10_gpu3_to_2 -> expert_pp2_dp0_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_1 [label="Expert A2A\nGPU 36->37\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer10 -> expert_all2all_pp2_dp1_layer10_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_1 -> expert_pp2_dp1_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_2 [label="Expert A2A\nGPU 36->38\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer10 -> expert_all2all_pp2_dp1_layer10_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_2 -> expert_pp2_dp1_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_3 [label="Expert A2A\nGPU 36->39\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer10 -> expert_all2all_pp2_dp1_layer10_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu0_to_3 -> expert_pp2_dp1_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_0 [label="Expert A2A\nGPU 37->36\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer10 -> expert_all2all_pp2_dp1_layer10_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_0 -> expert_pp2_dp1_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_2 [label="Expert A2A\nGPU 37->38\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer10 -> expert_all2all_pp2_dp1_layer10_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_2 -> expert_pp2_dp1_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_3 [label="Expert A2A\nGPU 37->39\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer10 -> expert_all2all_pp2_dp1_layer10_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu1_to_3 -> expert_pp2_dp1_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_0 [label="Expert A2A\nGPU 38->36\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer10 -> expert_all2all_pp2_dp1_layer10_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_0 -> expert_pp2_dp1_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_1 [label="Expert A2A\nGPU 38->37\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer10 -> expert_all2all_pp2_dp1_layer10_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_1 -> expert_pp2_dp1_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_3 [label="Expert A2A\nGPU 38->39\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer10 -> expert_all2all_pp2_dp1_layer10_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu2_to_3 -> expert_pp2_dp1_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_0 [label="Expert A2A\nGPU 39->36\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer10 -> expert_all2all_pp2_dp1_layer10_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_0 -> expert_pp2_dp1_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_1 [label="Expert A2A\nGPU 39->37\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer10 -> expert_all2all_pp2_dp1_layer10_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_1 -> expert_pp2_dp1_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_2 [label="Expert A2A\nGPU 39->38\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer10 -> expert_all2all_pp2_dp1_layer10_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer10_gpu3_to_2 -> expert_pp2_dp1_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_1 [label="Expert A2A\nGPU 40->41\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer10 -> expert_all2all_pp2_dp2_layer10_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_1 -> expert_pp2_dp2_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_2 [label="Expert A2A\nGPU 40->42\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer10 -> expert_all2all_pp2_dp2_layer10_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_2 -> expert_pp2_dp2_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_3 [label="Expert A2A\nGPU 40->43\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer10 -> expert_all2all_pp2_dp2_layer10_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu0_to_3 -> expert_pp2_dp2_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_0 [label="Expert A2A\nGPU 41->40\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer10 -> expert_all2all_pp2_dp2_layer10_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_0 -> expert_pp2_dp2_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_2 [label="Expert A2A\nGPU 41->42\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer10 -> expert_all2all_pp2_dp2_layer10_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_2 -> expert_pp2_dp2_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_3 [label="Expert A2A\nGPU 41->43\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer10 -> expert_all2all_pp2_dp2_layer10_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu1_to_3 -> expert_pp2_dp2_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_0 [label="Expert A2A\nGPU 42->40\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer10 -> expert_all2all_pp2_dp2_layer10_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_0 -> expert_pp2_dp2_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_1 [label="Expert A2A\nGPU 42->41\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer10 -> expert_all2all_pp2_dp2_layer10_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_1 -> expert_pp2_dp2_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_3 [label="Expert A2A\nGPU 42->43\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer10 -> expert_all2all_pp2_dp2_layer10_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu2_to_3 -> expert_pp2_dp2_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_0 [label="Expert A2A\nGPU 43->40\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer10 -> expert_all2all_pp2_dp2_layer10_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_0 -> expert_pp2_dp2_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_1 [label="Expert A2A\nGPU 43->41\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer10 -> expert_all2all_pp2_dp2_layer10_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_1 -> expert_pp2_dp2_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_2 [label="Expert A2A\nGPU 43->42\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer10 -> expert_all2all_pp2_dp2_layer10_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer10_gpu3_to_2 -> expert_pp2_dp2_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_1 [label="Expert A2A\nGPU 44->45\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer10 -> expert_all2all_pp2_dp3_layer10_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_1 -> expert_pp2_dp3_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_2 [label="Expert A2A\nGPU 44->46\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer10 -> expert_all2all_pp2_dp3_layer10_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_2 -> expert_pp2_dp3_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_3 [label="Expert A2A\nGPU 44->47\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer10 -> expert_all2all_pp2_dp3_layer10_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu0_to_3 -> expert_pp2_dp3_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_0 [label="Expert A2A\nGPU 45->44\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer10 -> expert_all2all_pp2_dp3_layer10_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_0 -> expert_pp2_dp3_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_2 [label="Expert A2A\nGPU 45->46\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer10 -> expert_all2all_pp2_dp3_layer10_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_2 -> expert_pp2_dp3_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_3 [label="Expert A2A\nGPU 45->47\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer10 -> expert_all2all_pp2_dp3_layer10_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu1_to_3 -> expert_pp2_dp3_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_0 [label="Expert A2A\nGPU 46->44\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer10 -> expert_all2all_pp2_dp3_layer10_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_0 -> expert_pp2_dp3_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_1 [label="Expert A2A\nGPU 46->45\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer10 -> expert_all2all_pp2_dp3_layer10_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_1 -> expert_pp2_dp3_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_3 [label="Expert A2A\nGPU 46->47\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer10 -> expert_all2all_pp2_dp3_layer10_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu2_to_3 -> expert_pp2_dp3_gpu3_layer10_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_0 [label="Expert A2A\nGPU 47->44\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer10 -> expert_all2all_pp2_dp3_layer10_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_0 -> expert_pp2_dp3_gpu0_layer10_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_1 [label="Expert A2A\nGPU 47->45\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer10 -> expert_all2all_pp2_dp3_layer10_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_1 -> expert_pp2_dp3_gpu1_layer10_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_2 [label="Expert A2A\nGPU 47->46\nLayer 10\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer10 -> expert_all2all_pp2_dp3_layer10_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer10_gpu3_to_2 -> expert_pp2_dp3_gpu2_layer10_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_1 [label="Expert A2A\nGPU 32->33\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer11 -> expert_all2all_pp2_dp0_layer11_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_1 -> expert_pp2_dp0_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_2 [label="Expert A2A\nGPU 32->34\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer11 -> expert_all2all_pp2_dp0_layer11_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_2 -> expert_pp2_dp0_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_3 [label="Expert A2A\nGPU 32->35\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu0_layer11 -> expert_all2all_pp2_dp0_layer11_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu0_to_3 -> expert_pp2_dp0_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_0 [label="Expert A2A\nGPU 33->32\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer11 -> expert_all2all_pp2_dp0_layer11_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_0 -> expert_pp2_dp0_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_2 [label="Expert A2A\nGPU 33->34\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer11 -> expert_all2all_pp2_dp0_layer11_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_2 -> expert_pp2_dp0_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_3 [label="Expert A2A\nGPU 33->35\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu1_layer11 -> expert_all2all_pp2_dp0_layer11_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu1_to_3 -> expert_pp2_dp0_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_0 [label="Expert A2A\nGPU 34->32\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer11 -> expert_all2all_pp2_dp0_layer11_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_0 -> expert_pp2_dp0_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_1 [label="Expert A2A\nGPU 34->33\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer11 -> expert_all2all_pp2_dp0_layer11_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_1 -> expert_pp2_dp0_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_3 [label="Expert A2A\nGPU 34->35\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu2_layer11 -> expert_all2all_pp2_dp0_layer11_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu2_to_3 -> expert_pp2_dp0_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_0 [label="Expert A2A\nGPU 35->32\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer11 -> expert_all2all_pp2_dp0_layer11_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_0 -> expert_pp2_dp0_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_1 [label="Expert A2A\nGPU 35->33\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer11 -> expert_all2all_pp2_dp0_layer11_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_1 -> expert_pp2_dp0_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_2 [label="Expert A2A\nGPU 35->34\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp0_gpu3_layer11 -> expert_all2all_pp2_dp0_layer11_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp0_layer11_gpu3_to_2 -> expert_pp2_dp0_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_1 [label="Expert A2A\nGPU 36->37\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer11 -> expert_all2all_pp2_dp1_layer11_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_1 -> expert_pp2_dp1_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_2 [label="Expert A2A\nGPU 36->38\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer11 -> expert_all2all_pp2_dp1_layer11_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_2 -> expert_pp2_dp1_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_3 [label="Expert A2A\nGPU 36->39\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu0_layer11 -> expert_all2all_pp2_dp1_layer11_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu0_to_3 -> expert_pp2_dp1_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_0 [label="Expert A2A\nGPU 37->36\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer11 -> expert_all2all_pp2_dp1_layer11_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_0 -> expert_pp2_dp1_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_2 [label="Expert A2A\nGPU 37->38\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer11 -> expert_all2all_pp2_dp1_layer11_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_2 -> expert_pp2_dp1_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_3 [label="Expert A2A\nGPU 37->39\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu1_layer11 -> expert_all2all_pp2_dp1_layer11_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu1_to_3 -> expert_pp2_dp1_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_0 [label="Expert A2A\nGPU 38->36\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer11 -> expert_all2all_pp2_dp1_layer11_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_0 -> expert_pp2_dp1_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_1 [label="Expert A2A\nGPU 38->37\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer11 -> expert_all2all_pp2_dp1_layer11_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_1 -> expert_pp2_dp1_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_3 [label="Expert A2A\nGPU 38->39\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu2_layer11 -> expert_all2all_pp2_dp1_layer11_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu2_to_3 -> expert_pp2_dp1_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_0 [label="Expert A2A\nGPU 39->36\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer11 -> expert_all2all_pp2_dp1_layer11_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_0 -> expert_pp2_dp1_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_1 [label="Expert A2A\nGPU 39->37\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer11 -> expert_all2all_pp2_dp1_layer11_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_1 -> expert_pp2_dp1_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_2 [label="Expert A2A\nGPU 39->38\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp1_gpu3_layer11 -> expert_all2all_pp2_dp1_layer11_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp1_layer11_gpu3_to_2 -> expert_pp2_dp1_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_1 [label="Expert A2A\nGPU 40->41\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer11 -> expert_all2all_pp2_dp2_layer11_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_1 -> expert_pp2_dp2_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_2 [label="Expert A2A\nGPU 40->42\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer11 -> expert_all2all_pp2_dp2_layer11_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_2 -> expert_pp2_dp2_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_3 [label="Expert A2A\nGPU 40->43\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu0_layer11 -> expert_all2all_pp2_dp2_layer11_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu0_to_3 -> expert_pp2_dp2_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_0 [label="Expert A2A\nGPU 41->40\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer11 -> expert_all2all_pp2_dp2_layer11_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_0 -> expert_pp2_dp2_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_2 [label="Expert A2A\nGPU 41->42\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer11 -> expert_all2all_pp2_dp2_layer11_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_2 -> expert_pp2_dp2_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_3 [label="Expert A2A\nGPU 41->43\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu1_layer11 -> expert_all2all_pp2_dp2_layer11_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu1_to_3 -> expert_pp2_dp2_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_0 [label="Expert A2A\nGPU 42->40\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer11 -> expert_all2all_pp2_dp2_layer11_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_0 -> expert_pp2_dp2_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_1 [label="Expert A2A\nGPU 42->41\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer11 -> expert_all2all_pp2_dp2_layer11_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_1 -> expert_pp2_dp2_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_3 [label="Expert A2A\nGPU 42->43\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu2_layer11 -> expert_all2all_pp2_dp2_layer11_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu2_to_3 -> expert_pp2_dp2_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_0 [label="Expert A2A\nGPU 43->40\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer11 -> expert_all2all_pp2_dp2_layer11_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_0 -> expert_pp2_dp2_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_1 [label="Expert A2A\nGPU 43->41\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer11 -> expert_all2all_pp2_dp2_layer11_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_1 -> expert_pp2_dp2_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_2 [label="Expert A2A\nGPU 43->42\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp2_gpu3_layer11 -> expert_all2all_pp2_dp2_layer11_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp2_layer11_gpu3_to_2 -> expert_pp2_dp2_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_1 [label="Expert A2A\nGPU 44->45\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer11 -> expert_all2all_pp2_dp3_layer11_gpu0_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_1 -> expert_pp2_dp3_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_2 [label="Expert A2A\nGPU 44->46\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer11 -> expert_all2all_pp2_dp3_layer11_gpu0_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_2 -> expert_pp2_dp3_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_3 [label="Expert A2A\nGPU 44->47\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu0_layer11 -> expert_all2all_pp2_dp3_layer11_gpu0_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu0_to_3 -> expert_pp2_dp3_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_0 [label="Expert A2A\nGPU 45->44\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer11 -> expert_all2all_pp2_dp3_layer11_gpu1_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_0 -> expert_pp2_dp3_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_2 [label="Expert A2A\nGPU 45->46\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer11 -> expert_all2all_pp2_dp3_layer11_gpu1_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_2 -> expert_pp2_dp3_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_3 [label="Expert A2A\nGPU 45->47\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu1_layer11 -> expert_all2all_pp2_dp3_layer11_gpu1_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu1_to_3 -> expert_pp2_dp3_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_0 [label="Expert A2A\nGPU 46->44\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer11 -> expert_all2all_pp2_dp3_layer11_gpu2_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_0 -> expert_pp2_dp3_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_1 [label="Expert A2A\nGPU 46->45\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer11 -> expert_all2all_pp2_dp3_layer11_gpu2_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_1 -> expert_pp2_dp3_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_3 [label="Expert A2A\nGPU 46->47\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu2_layer11 -> expert_all2all_pp2_dp3_layer11_gpu2_to_3 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu2_to_3 -> expert_pp2_dp3_gpu3_layer11_exp12 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_0 [label="Expert A2A\nGPU 47->44\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer11 -> expert_all2all_pp2_dp3_layer11_gpu3_to_0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_0 -> expert_pp2_dp3_gpu0_layer11_exp0 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_1 [label="Expert A2A\nGPU 47->45\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer11 -> expert_all2all_pp2_dp3_layer11_gpu3_to_1 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_1 -> expert_pp2_dp3_gpu1_layer11_exp4 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_2 [label="Expert A2A\nGPU 47->46\nLayer 11\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp2_dp3_gpu3_layer11 -> expert_all2all_pp2_dp3_layer11_gpu3_to_2 [style=dotted]
	expert_all2all_pp2_dp3_layer11_gpu3_to_2 -> expert_pp2_dp3_gpu2_layer11_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_1 [label="Expert A2A\nGPU 48->49\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer12 -> expert_all2all_pp3_dp0_layer12_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_1 -> expert_pp3_dp0_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_2 [label="Expert A2A\nGPU 48->50\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer12 -> expert_all2all_pp3_dp0_layer12_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_2 -> expert_pp3_dp0_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_3 [label="Expert A2A\nGPU 48->51\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer12 -> expert_all2all_pp3_dp0_layer12_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu0_to_3 -> expert_pp3_dp0_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_0 [label="Expert A2A\nGPU 49->48\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer12 -> expert_all2all_pp3_dp0_layer12_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_0 -> expert_pp3_dp0_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_2 [label="Expert A2A\nGPU 49->50\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer12 -> expert_all2all_pp3_dp0_layer12_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_2 -> expert_pp3_dp0_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_3 [label="Expert A2A\nGPU 49->51\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer12 -> expert_all2all_pp3_dp0_layer12_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu1_to_3 -> expert_pp3_dp0_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_0 [label="Expert A2A\nGPU 50->48\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer12 -> expert_all2all_pp3_dp0_layer12_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_0 -> expert_pp3_dp0_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_1 [label="Expert A2A\nGPU 50->49\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer12 -> expert_all2all_pp3_dp0_layer12_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_1 -> expert_pp3_dp0_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_3 [label="Expert A2A\nGPU 50->51\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer12 -> expert_all2all_pp3_dp0_layer12_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu2_to_3 -> expert_pp3_dp0_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_0 [label="Expert A2A\nGPU 51->48\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer12 -> expert_all2all_pp3_dp0_layer12_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_0 -> expert_pp3_dp0_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_1 [label="Expert A2A\nGPU 51->49\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer12 -> expert_all2all_pp3_dp0_layer12_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_1 -> expert_pp3_dp0_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_2 [label="Expert A2A\nGPU 51->50\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer12 -> expert_all2all_pp3_dp0_layer12_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer12_gpu3_to_2 -> expert_pp3_dp0_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_1 [label="Expert A2A\nGPU 52->53\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer12 -> expert_all2all_pp3_dp1_layer12_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_1 -> expert_pp3_dp1_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_2 [label="Expert A2A\nGPU 52->54\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer12 -> expert_all2all_pp3_dp1_layer12_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_2 -> expert_pp3_dp1_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_3 [label="Expert A2A\nGPU 52->55\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer12 -> expert_all2all_pp3_dp1_layer12_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu0_to_3 -> expert_pp3_dp1_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_0 [label="Expert A2A\nGPU 53->52\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer12 -> expert_all2all_pp3_dp1_layer12_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_0 -> expert_pp3_dp1_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_2 [label="Expert A2A\nGPU 53->54\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer12 -> expert_all2all_pp3_dp1_layer12_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_2 -> expert_pp3_dp1_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_3 [label="Expert A2A\nGPU 53->55\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer12 -> expert_all2all_pp3_dp1_layer12_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu1_to_3 -> expert_pp3_dp1_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_0 [label="Expert A2A\nGPU 54->52\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer12 -> expert_all2all_pp3_dp1_layer12_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_0 -> expert_pp3_dp1_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_1 [label="Expert A2A\nGPU 54->53\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer12 -> expert_all2all_pp3_dp1_layer12_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_1 -> expert_pp3_dp1_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_3 [label="Expert A2A\nGPU 54->55\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer12 -> expert_all2all_pp3_dp1_layer12_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu2_to_3 -> expert_pp3_dp1_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_0 [label="Expert A2A\nGPU 55->52\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer12 -> expert_all2all_pp3_dp1_layer12_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_0 -> expert_pp3_dp1_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_1 [label="Expert A2A\nGPU 55->53\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer12 -> expert_all2all_pp3_dp1_layer12_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_1 -> expert_pp3_dp1_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_2 [label="Expert A2A\nGPU 55->54\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer12 -> expert_all2all_pp3_dp1_layer12_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer12_gpu3_to_2 -> expert_pp3_dp1_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_1 [label="Expert A2A\nGPU 56->57\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer12 -> expert_all2all_pp3_dp2_layer12_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_1 -> expert_pp3_dp2_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_2 [label="Expert A2A\nGPU 56->58\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer12 -> expert_all2all_pp3_dp2_layer12_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_2 -> expert_pp3_dp2_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_3 [label="Expert A2A\nGPU 56->59\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer12 -> expert_all2all_pp3_dp2_layer12_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu0_to_3 -> expert_pp3_dp2_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_0 [label="Expert A2A\nGPU 57->56\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer12 -> expert_all2all_pp3_dp2_layer12_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_0 -> expert_pp3_dp2_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_2 [label="Expert A2A\nGPU 57->58\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer12 -> expert_all2all_pp3_dp2_layer12_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_2 -> expert_pp3_dp2_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_3 [label="Expert A2A\nGPU 57->59\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer12 -> expert_all2all_pp3_dp2_layer12_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu1_to_3 -> expert_pp3_dp2_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_0 [label="Expert A2A\nGPU 58->56\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer12 -> expert_all2all_pp3_dp2_layer12_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_0 -> expert_pp3_dp2_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_1 [label="Expert A2A\nGPU 58->57\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer12 -> expert_all2all_pp3_dp2_layer12_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_1 -> expert_pp3_dp2_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_3 [label="Expert A2A\nGPU 58->59\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer12 -> expert_all2all_pp3_dp2_layer12_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu2_to_3 -> expert_pp3_dp2_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_0 [label="Expert A2A\nGPU 59->56\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer12 -> expert_all2all_pp3_dp2_layer12_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_0 -> expert_pp3_dp2_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_1 [label="Expert A2A\nGPU 59->57\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer12 -> expert_all2all_pp3_dp2_layer12_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_1 -> expert_pp3_dp2_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_2 [label="Expert A2A\nGPU 59->58\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer12 -> expert_all2all_pp3_dp2_layer12_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer12_gpu3_to_2 -> expert_pp3_dp2_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_1 [label="Expert A2A\nGPU 60->61\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer12 -> expert_all2all_pp3_dp3_layer12_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_1 -> expert_pp3_dp3_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_2 [label="Expert A2A\nGPU 60->62\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer12 -> expert_all2all_pp3_dp3_layer12_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_2 -> expert_pp3_dp3_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_3 [label="Expert A2A\nGPU 60->63\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer12 -> expert_all2all_pp3_dp3_layer12_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu0_to_3 -> expert_pp3_dp3_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_0 [label="Expert A2A\nGPU 61->60\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer12 -> expert_all2all_pp3_dp3_layer12_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_0 -> expert_pp3_dp3_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_2 [label="Expert A2A\nGPU 61->62\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer12 -> expert_all2all_pp3_dp3_layer12_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_2 -> expert_pp3_dp3_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_3 [label="Expert A2A\nGPU 61->63\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer12 -> expert_all2all_pp3_dp3_layer12_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu1_to_3 -> expert_pp3_dp3_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_0 [label="Expert A2A\nGPU 62->60\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer12 -> expert_all2all_pp3_dp3_layer12_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_0 -> expert_pp3_dp3_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_1 [label="Expert A2A\nGPU 62->61\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer12 -> expert_all2all_pp3_dp3_layer12_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_1 -> expert_pp3_dp3_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_3 [label="Expert A2A\nGPU 62->63\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer12 -> expert_all2all_pp3_dp3_layer12_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu2_to_3 -> expert_pp3_dp3_gpu3_layer12_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_0 [label="Expert A2A\nGPU 63->60\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer12 -> expert_all2all_pp3_dp3_layer12_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_0 -> expert_pp3_dp3_gpu0_layer12_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_1 [label="Expert A2A\nGPU 63->61\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer12 -> expert_all2all_pp3_dp3_layer12_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_1 -> expert_pp3_dp3_gpu1_layer12_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_2 [label="Expert A2A\nGPU 63->62\nLayer 12\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer12 -> expert_all2all_pp3_dp3_layer12_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer12_gpu3_to_2 -> expert_pp3_dp3_gpu2_layer12_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_1 [label="Expert A2A\nGPU 48->49\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer13 -> expert_all2all_pp3_dp0_layer13_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_1 -> expert_pp3_dp0_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_2 [label="Expert A2A\nGPU 48->50\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer13 -> expert_all2all_pp3_dp0_layer13_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_2 -> expert_pp3_dp0_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_3 [label="Expert A2A\nGPU 48->51\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer13 -> expert_all2all_pp3_dp0_layer13_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu0_to_3 -> expert_pp3_dp0_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_0 [label="Expert A2A\nGPU 49->48\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer13 -> expert_all2all_pp3_dp0_layer13_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_0 -> expert_pp3_dp0_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_2 [label="Expert A2A\nGPU 49->50\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer13 -> expert_all2all_pp3_dp0_layer13_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_2 -> expert_pp3_dp0_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_3 [label="Expert A2A\nGPU 49->51\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer13 -> expert_all2all_pp3_dp0_layer13_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu1_to_3 -> expert_pp3_dp0_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_0 [label="Expert A2A\nGPU 50->48\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer13 -> expert_all2all_pp3_dp0_layer13_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_0 -> expert_pp3_dp0_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_1 [label="Expert A2A\nGPU 50->49\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer13 -> expert_all2all_pp3_dp0_layer13_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_1 -> expert_pp3_dp0_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_3 [label="Expert A2A\nGPU 50->51\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer13 -> expert_all2all_pp3_dp0_layer13_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu2_to_3 -> expert_pp3_dp0_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_0 [label="Expert A2A\nGPU 51->48\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer13 -> expert_all2all_pp3_dp0_layer13_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_0 -> expert_pp3_dp0_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_1 [label="Expert A2A\nGPU 51->49\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer13 -> expert_all2all_pp3_dp0_layer13_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_1 -> expert_pp3_dp0_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_2 [label="Expert A2A\nGPU 51->50\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer13 -> expert_all2all_pp3_dp0_layer13_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer13_gpu3_to_2 -> expert_pp3_dp0_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_1 [label="Expert A2A\nGPU 52->53\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer13 -> expert_all2all_pp3_dp1_layer13_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_1 -> expert_pp3_dp1_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_2 [label="Expert A2A\nGPU 52->54\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer13 -> expert_all2all_pp3_dp1_layer13_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_2 -> expert_pp3_dp1_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_3 [label="Expert A2A\nGPU 52->55\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer13 -> expert_all2all_pp3_dp1_layer13_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu0_to_3 -> expert_pp3_dp1_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_0 [label="Expert A2A\nGPU 53->52\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer13 -> expert_all2all_pp3_dp1_layer13_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_0 -> expert_pp3_dp1_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_2 [label="Expert A2A\nGPU 53->54\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer13 -> expert_all2all_pp3_dp1_layer13_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_2 -> expert_pp3_dp1_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_3 [label="Expert A2A\nGPU 53->55\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer13 -> expert_all2all_pp3_dp1_layer13_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu1_to_3 -> expert_pp3_dp1_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_0 [label="Expert A2A\nGPU 54->52\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer13 -> expert_all2all_pp3_dp1_layer13_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_0 -> expert_pp3_dp1_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_1 [label="Expert A2A\nGPU 54->53\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer13 -> expert_all2all_pp3_dp1_layer13_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_1 -> expert_pp3_dp1_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_3 [label="Expert A2A\nGPU 54->55\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer13 -> expert_all2all_pp3_dp1_layer13_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu2_to_3 -> expert_pp3_dp1_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_0 [label="Expert A2A\nGPU 55->52\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer13 -> expert_all2all_pp3_dp1_layer13_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_0 -> expert_pp3_dp1_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_1 [label="Expert A2A\nGPU 55->53\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer13 -> expert_all2all_pp3_dp1_layer13_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_1 -> expert_pp3_dp1_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_2 [label="Expert A2A\nGPU 55->54\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer13 -> expert_all2all_pp3_dp1_layer13_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer13_gpu3_to_2 -> expert_pp3_dp1_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_1 [label="Expert A2A\nGPU 56->57\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer13 -> expert_all2all_pp3_dp2_layer13_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_1 -> expert_pp3_dp2_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_2 [label="Expert A2A\nGPU 56->58\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer13 -> expert_all2all_pp3_dp2_layer13_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_2 -> expert_pp3_dp2_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_3 [label="Expert A2A\nGPU 56->59\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer13 -> expert_all2all_pp3_dp2_layer13_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu0_to_3 -> expert_pp3_dp2_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_0 [label="Expert A2A\nGPU 57->56\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer13 -> expert_all2all_pp3_dp2_layer13_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_0 -> expert_pp3_dp2_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_2 [label="Expert A2A\nGPU 57->58\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer13 -> expert_all2all_pp3_dp2_layer13_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_2 -> expert_pp3_dp2_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_3 [label="Expert A2A\nGPU 57->59\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer13 -> expert_all2all_pp3_dp2_layer13_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu1_to_3 -> expert_pp3_dp2_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_0 [label="Expert A2A\nGPU 58->56\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer13 -> expert_all2all_pp3_dp2_layer13_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_0 -> expert_pp3_dp2_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_1 [label="Expert A2A\nGPU 58->57\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer13 -> expert_all2all_pp3_dp2_layer13_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_1 -> expert_pp3_dp2_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_3 [label="Expert A2A\nGPU 58->59\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer13 -> expert_all2all_pp3_dp2_layer13_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu2_to_3 -> expert_pp3_dp2_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_0 [label="Expert A2A\nGPU 59->56\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer13 -> expert_all2all_pp3_dp2_layer13_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_0 -> expert_pp3_dp2_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_1 [label="Expert A2A\nGPU 59->57\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer13 -> expert_all2all_pp3_dp2_layer13_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_1 -> expert_pp3_dp2_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_2 [label="Expert A2A\nGPU 59->58\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer13 -> expert_all2all_pp3_dp2_layer13_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer13_gpu3_to_2 -> expert_pp3_dp2_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_1 [label="Expert A2A\nGPU 60->61\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer13 -> expert_all2all_pp3_dp3_layer13_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_1 -> expert_pp3_dp3_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_2 [label="Expert A2A\nGPU 60->62\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer13 -> expert_all2all_pp3_dp3_layer13_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_2 -> expert_pp3_dp3_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_3 [label="Expert A2A\nGPU 60->63\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer13 -> expert_all2all_pp3_dp3_layer13_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu0_to_3 -> expert_pp3_dp3_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_0 [label="Expert A2A\nGPU 61->60\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer13 -> expert_all2all_pp3_dp3_layer13_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_0 -> expert_pp3_dp3_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_2 [label="Expert A2A\nGPU 61->62\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer13 -> expert_all2all_pp3_dp3_layer13_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_2 -> expert_pp3_dp3_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_3 [label="Expert A2A\nGPU 61->63\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer13 -> expert_all2all_pp3_dp3_layer13_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu1_to_3 -> expert_pp3_dp3_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_0 [label="Expert A2A\nGPU 62->60\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer13 -> expert_all2all_pp3_dp3_layer13_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_0 -> expert_pp3_dp3_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_1 [label="Expert A2A\nGPU 62->61\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer13 -> expert_all2all_pp3_dp3_layer13_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_1 -> expert_pp3_dp3_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_3 [label="Expert A2A\nGPU 62->63\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer13 -> expert_all2all_pp3_dp3_layer13_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu2_to_3 -> expert_pp3_dp3_gpu3_layer13_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_0 [label="Expert A2A\nGPU 63->60\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer13 -> expert_all2all_pp3_dp3_layer13_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_0 -> expert_pp3_dp3_gpu0_layer13_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_1 [label="Expert A2A\nGPU 63->61\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer13 -> expert_all2all_pp3_dp3_layer13_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_1 -> expert_pp3_dp3_gpu1_layer13_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_2 [label="Expert A2A\nGPU 63->62\nLayer 13\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer13 -> expert_all2all_pp3_dp3_layer13_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer13_gpu3_to_2 -> expert_pp3_dp3_gpu2_layer13_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_1 [label="Expert A2A\nGPU 48->49\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer14 -> expert_all2all_pp3_dp0_layer14_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_1 -> expert_pp3_dp0_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_2 [label="Expert A2A\nGPU 48->50\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer14 -> expert_all2all_pp3_dp0_layer14_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_2 -> expert_pp3_dp0_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_3 [label="Expert A2A\nGPU 48->51\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer14 -> expert_all2all_pp3_dp0_layer14_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu0_to_3 -> expert_pp3_dp0_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_0 [label="Expert A2A\nGPU 49->48\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer14 -> expert_all2all_pp3_dp0_layer14_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_0 -> expert_pp3_dp0_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_2 [label="Expert A2A\nGPU 49->50\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer14 -> expert_all2all_pp3_dp0_layer14_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_2 -> expert_pp3_dp0_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_3 [label="Expert A2A\nGPU 49->51\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer14 -> expert_all2all_pp3_dp0_layer14_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu1_to_3 -> expert_pp3_dp0_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_0 [label="Expert A2A\nGPU 50->48\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer14 -> expert_all2all_pp3_dp0_layer14_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_0 -> expert_pp3_dp0_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_1 [label="Expert A2A\nGPU 50->49\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer14 -> expert_all2all_pp3_dp0_layer14_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_1 -> expert_pp3_dp0_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_3 [label="Expert A2A\nGPU 50->51\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer14 -> expert_all2all_pp3_dp0_layer14_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu2_to_3 -> expert_pp3_dp0_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_0 [label="Expert A2A\nGPU 51->48\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer14 -> expert_all2all_pp3_dp0_layer14_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_0 -> expert_pp3_dp0_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_1 [label="Expert A2A\nGPU 51->49\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer14 -> expert_all2all_pp3_dp0_layer14_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_1 -> expert_pp3_dp0_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_2 [label="Expert A2A\nGPU 51->50\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer14 -> expert_all2all_pp3_dp0_layer14_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer14_gpu3_to_2 -> expert_pp3_dp0_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_1 [label="Expert A2A\nGPU 52->53\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer14 -> expert_all2all_pp3_dp1_layer14_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_1 -> expert_pp3_dp1_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_2 [label="Expert A2A\nGPU 52->54\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer14 -> expert_all2all_pp3_dp1_layer14_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_2 -> expert_pp3_dp1_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_3 [label="Expert A2A\nGPU 52->55\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer14 -> expert_all2all_pp3_dp1_layer14_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu0_to_3 -> expert_pp3_dp1_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_0 [label="Expert A2A\nGPU 53->52\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer14 -> expert_all2all_pp3_dp1_layer14_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_0 -> expert_pp3_dp1_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_2 [label="Expert A2A\nGPU 53->54\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer14 -> expert_all2all_pp3_dp1_layer14_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_2 -> expert_pp3_dp1_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_3 [label="Expert A2A\nGPU 53->55\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer14 -> expert_all2all_pp3_dp1_layer14_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu1_to_3 -> expert_pp3_dp1_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_0 [label="Expert A2A\nGPU 54->52\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer14 -> expert_all2all_pp3_dp1_layer14_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_0 -> expert_pp3_dp1_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_1 [label="Expert A2A\nGPU 54->53\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer14 -> expert_all2all_pp3_dp1_layer14_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_1 -> expert_pp3_dp1_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_3 [label="Expert A2A\nGPU 54->55\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer14 -> expert_all2all_pp3_dp1_layer14_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu2_to_3 -> expert_pp3_dp1_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_0 [label="Expert A2A\nGPU 55->52\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer14 -> expert_all2all_pp3_dp1_layer14_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_0 -> expert_pp3_dp1_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_1 [label="Expert A2A\nGPU 55->53\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer14 -> expert_all2all_pp3_dp1_layer14_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_1 -> expert_pp3_dp1_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_2 [label="Expert A2A\nGPU 55->54\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer14 -> expert_all2all_pp3_dp1_layer14_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer14_gpu3_to_2 -> expert_pp3_dp1_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_1 [label="Expert A2A\nGPU 56->57\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer14 -> expert_all2all_pp3_dp2_layer14_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_1 -> expert_pp3_dp2_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_2 [label="Expert A2A\nGPU 56->58\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer14 -> expert_all2all_pp3_dp2_layer14_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_2 -> expert_pp3_dp2_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_3 [label="Expert A2A\nGPU 56->59\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer14 -> expert_all2all_pp3_dp2_layer14_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu0_to_3 -> expert_pp3_dp2_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_0 [label="Expert A2A\nGPU 57->56\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer14 -> expert_all2all_pp3_dp2_layer14_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_0 -> expert_pp3_dp2_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_2 [label="Expert A2A\nGPU 57->58\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer14 -> expert_all2all_pp3_dp2_layer14_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_2 -> expert_pp3_dp2_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_3 [label="Expert A2A\nGPU 57->59\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer14 -> expert_all2all_pp3_dp2_layer14_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu1_to_3 -> expert_pp3_dp2_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_0 [label="Expert A2A\nGPU 58->56\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer14 -> expert_all2all_pp3_dp2_layer14_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_0 -> expert_pp3_dp2_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_1 [label="Expert A2A\nGPU 58->57\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer14 -> expert_all2all_pp3_dp2_layer14_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_1 -> expert_pp3_dp2_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_3 [label="Expert A2A\nGPU 58->59\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer14 -> expert_all2all_pp3_dp2_layer14_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu2_to_3 -> expert_pp3_dp2_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_0 [label="Expert A2A\nGPU 59->56\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer14 -> expert_all2all_pp3_dp2_layer14_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_0 -> expert_pp3_dp2_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_1 [label="Expert A2A\nGPU 59->57\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer14 -> expert_all2all_pp3_dp2_layer14_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_1 -> expert_pp3_dp2_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_2 [label="Expert A2A\nGPU 59->58\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer14 -> expert_all2all_pp3_dp2_layer14_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer14_gpu3_to_2 -> expert_pp3_dp2_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_1 [label="Expert A2A\nGPU 60->61\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer14 -> expert_all2all_pp3_dp3_layer14_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_1 -> expert_pp3_dp3_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_2 [label="Expert A2A\nGPU 60->62\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer14 -> expert_all2all_pp3_dp3_layer14_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_2 -> expert_pp3_dp3_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_3 [label="Expert A2A\nGPU 60->63\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer14 -> expert_all2all_pp3_dp3_layer14_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu0_to_3 -> expert_pp3_dp3_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_0 [label="Expert A2A\nGPU 61->60\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer14 -> expert_all2all_pp3_dp3_layer14_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_0 -> expert_pp3_dp3_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_2 [label="Expert A2A\nGPU 61->62\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer14 -> expert_all2all_pp3_dp3_layer14_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_2 -> expert_pp3_dp3_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_3 [label="Expert A2A\nGPU 61->63\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer14 -> expert_all2all_pp3_dp3_layer14_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu1_to_3 -> expert_pp3_dp3_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_0 [label="Expert A2A\nGPU 62->60\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer14 -> expert_all2all_pp3_dp3_layer14_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_0 -> expert_pp3_dp3_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_1 [label="Expert A2A\nGPU 62->61\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer14 -> expert_all2all_pp3_dp3_layer14_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_1 -> expert_pp3_dp3_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_3 [label="Expert A2A\nGPU 62->63\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer14 -> expert_all2all_pp3_dp3_layer14_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu2_to_3 -> expert_pp3_dp3_gpu3_layer14_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_0 [label="Expert A2A\nGPU 63->60\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer14 -> expert_all2all_pp3_dp3_layer14_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_0 -> expert_pp3_dp3_gpu0_layer14_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_1 [label="Expert A2A\nGPU 63->61\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer14 -> expert_all2all_pp3_dp3_layer14_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_1 -> expert_pp3_dp3_gpu1_layer14_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_2 [label="Expert A2A\nGPU 63->62\nLayer 14\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer14 -> expert_all2all_pp3_dp3_layer14_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer14_gpu3_to_2 -> expert_pp3_dp3_gpu2_layer14_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_1 [label="Expert A2A\nGPU 48->49\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer15 -> expert_all2all_pp3_dp0_layer15_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_1 -> expert_pp3_dp0_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_2 [label="Expert A2A\nGPU 48->50\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer15 -> expert_all2all_pp3_dp0_layer15_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_2 -> expert_pp3_dp0_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_3 [label="Expert A2A\nGPU 48->51\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu0_layer15 -> expert_all2all_pp3_dp0_layer15_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu0_to_3 -> expert_pp3_dp0_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_0 [label="Expert A2A\nGPU 49->48\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer15 -> expert_all2all_pp3_dp0_layer15_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_0 -> expert_pp3_dp0_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_2 [label="Expert A2A\nGPU 49->50\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer15 -> expert_all2all_pp3_dp0_layer15_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_2 -> expert_pp3_dp0_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_3 [label="Expert A2A\nGPU 49->51\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu1_layer15 -> expert_all2all_pp3_dp0_layer15_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu1_to_3 -> expert_pp3_dp0_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_0 [label="Expert A2A\nGPU 50->48\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer15 -> expert_all2all_pp3_dp0_layer15_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_0 -> expert_pp3_dp0_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_1 [label="Expert A2A\nGPU 50->49\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer15 -> expert_all2all_pp3_dp0_layer15_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_1 -> expert_pp3_dp0_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_3 [label="Expert A2A\nGPU 50->51\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu2_layer15 -> expert_all2all_pp3_dp0_layer15_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu2_to_3 -> expert_pp3_dp0_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_0 [label="Expert A2A\nGPU 51->48\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer15 -> expert_all2all_pp3_dp0_layer15_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_0 -> expert_pp3_dp0_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_1 [label="Expert A2A\nGPU 51->49\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer15 -> expert_all2all_pp3_dp0_layer15_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_1 -> expert_pp3_dp0_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_2 [label="Expert A2A\nGPU 51->50\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp0_gpu3_layer15 -> expert_all2all_pp3_dp0_layer15_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp0_layer15_gpu3_to_2 -> expert_pp3_dp0_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_1 [label="Expert A2A\nGPU 52->53\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer15 -> expert_all2all_pp3_dp1_layer15_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_1 -> expert_pp3_dp1_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_2 [label="Expert A2A\nGPU 52->54\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer15 -> expert_all2all_pp3_dp1_layer15_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_2 -> expert_pp3_dp1_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_3 [label="Expert A2A\nGPU 52->55\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu0_layer15 -> expert_all2all_pp3_dp1_layer15_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu0_to_3 -> expert_pp3_dp1_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_0 [label="Expert A2A\nGPU 53->52\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer15 -> expert_all2all_pp3_dp1_layer15_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_0 -> expert_pp3_dp1_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_2 [label="Expert A2A\nGPU 53->54\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer15 -> expert_all2all_pp3_dp1_layer15_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_2 -> expert_pp3_dp1_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_3 [label="Expert A2A\nGPU 53->55\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu1_layer15 -> expert_all2all_pp3_dp1_layer15_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu1_to_3 -> expert_pp3_dp1_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_0 [label="Expert A2A\nGPU 54->52\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer15 -> expert_all2all_pp3_dp1_layer15_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_0 -> expert_pp3_dp1_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_1 [label="Expert A2A\nGPU 54->53\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer15 -> expert_all2all_pp3_dp1_layer15_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_1 -> expert_pp3_dp1_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_3 [label="Expert A2A\nGPU 54->55\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu2_layer15 -> expert_all2all_pp3_dp1_layer15_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu2_to_3 -> expert_pp3_dp1_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_0 [label="Expert A2A\nGPU 55->52\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer15 -> expert_all2all_pp3_dp1_layer15_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_0 -> expert_pp3_dp1_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_1 [label="Expert A2A\nGPU 55->53\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer15 -> expert_all2all_pp3_dp1_layer15_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_1 -> expert_pp3_dp1_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_2 [label="Expert A2A\nGPU 55->54\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp1_gpu3_layer15 -> expert_all2all_pp3_dp1_layer15_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp1_layer15_gpu3_to_2 -> expert_pp3_dp1_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_1 [label="Expert A2A\nGPU 56->57\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer15 -> expert_all2all_pp3_dp2_layer15_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_1 -> expert_pp3_dp2_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_2 [label="Expert A2A\nGPU 56->58\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer15 -> expert_all2all_pp3_dp2_layer15_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_2 -> expert_pp3_dp2_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_3 [label="Expert A2A\nGPU 56->59\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu0_layer15 -> expert_all2all_pp3_dp2_layer15_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu0_to_3 -> expert_pp3_dp2_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_0 [label="Expert A2A\nGPU 57->56\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer15 -> expert_all2all_pp3_dp2_layer15_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_0 -> expert_pp3_dp2_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_2 [label="Expert A2A\nGPU 57->58\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer15 -> expert_all2all_pp3_dp2_layer15_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_2 -> expert_pp3_dp2_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_3 [label="Expert A2A\nGPU 57->59\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu1_layer15 -> expert_all2all_pp3_dp2_layer15_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu1_to_3 -> expert_pp3_dp2_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_0 [label="Expert A2A\nGPU 58->56\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer15 -> expert_all2all_pp3_dp2_layer15_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_0 -> expert_pp3_dp2_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_1 [label="Expert A2A\nGPU 58->57\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer15 -> expert_all2all_pp3_dp2_layer15_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_1 -> expert_pp3_dp2_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_3 [label="Expert A2A\nGPU 58->59\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu2_layer15 -> expert_all2all_pp3_dp2_layer15_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu2_to_3 -> expert_pp3_dp2_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_0 [label="Expert A2A\nGPU 59->56\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer15 -> expert_all2all_pp3_dp2_layer15_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_0 -> expert_pp3_dp2_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_1 [label="Expert A2A\nGPU 59->57\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer15 -> expert_all2all_pp3_dp2_layer15_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_1 -> expert_pp3_dp2_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_2 [label="Expert A2A\nGPU 59->58\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp2_gpu3_layer15 -> expert_all2all_pp3_dp2_layer15_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp2_layer15_gpu3_to_2 -> expert_pp3_dp2_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_1 [label="Expert A2A\nGPU 60->61\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer15 -> expert_all2all_pp3_dp3_layer15_gpu0_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_1 -> expert_pp3_dp3_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_2 [label="Expert A2A\nGPU 60->62\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer15 -> expert_all2all_pp3_dp3_layer15_gpu0_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_2 -> expert_pp3_dp3_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_3 [label="Expert A2A\nGPU 60->63\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu0_layer15 -> expert_all2all_pp3_dp3_layer15_gpu0_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu0_to_3 -> expert_pp3_dp3_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_0 [label="Expert A2A\nGPU 61->60\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer15 -> expert_all2all_pp3_dp3_layer15_gpu1_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_0 -> expert_pp3_dp3_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_2 [label="Expert A2A\nGPU 61->62\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer15 -> expert_all2all_pp3_dp3_layer15_gpu1_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_2 -> expert_pp3_dp3_gpu2_layer15_exp8 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_3 [label="Expert A2A\nGPU 61->63\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu1_layer15 -> expert_all2all_pp3_dp3_layer15_gpu1_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu1_to_3 -> expert_pp3_dp3_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_0 [label="Expert A2A\nGPU 62->60\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer15 -> expert_all2all_pp3_dp3_layer15_gpu2_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_0 -> expert_pp3_dp3_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_1 [label="Expert A2A\nGPU 62->61\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer15 -> expert_all2all_pp3_dp3_layer15_gpu2_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_1 -> expert_pp3_dp3_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_3 [label="Expert A2A\nGPU 62->63\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu2_layer15 -> expert_all2all_pp3_dp3_layer15_gpu2_to_3 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu2_to_3 -> expert_pp3_dp3_gpu3_layer15_exp12 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_0 [label="Expert A2A\nGPU 63->60\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer15 -> expert_all2all_pp3_dp3_layer15_gpu3_to_0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_0 -> expert_pp3_dp3_gpu0_layer15_exp0 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_1 [label="Expert A2A\nGPU 63->61\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer15 -> expert_all2all_pp3_dp3_layer15_gpu3_to_1 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_1 -> expert_pp3_dp3_gpu1_layer15_exp4 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_2 [label="Expert A2A\nGPU 63->62\nLayer 15\nInput: [batch_size=?, seq_len=512, hidden_size=1024]\nOutput: [batch_size=?, seq_len=512, hidden_size=1024]" fillcolor=lightblue shape=ellipse style=filled]
	route_pp3_dp3_gpu3_layer15 -> expert_all2all_pp3_dp3_layer15_gpu3_to_2 [style=dotted]
	expert_all2all_pp3_dp3_layer15_gpu3_to_2 -> expert_pp3_dp3_gpu2_layer15_exp8 [style=dotted]
}
