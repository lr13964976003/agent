<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="60000pt" height="5645pt"
 viewBox="0.00 0.00 14400.00 1354.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(3.47 3.47) rotate(0) translate(4 1622.74)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1622.74 17285,-1622.74 17285,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_pipeline_0</title>
<path fill="lightcyan" stroke="black" d="M20,-866.14C20,-866.14 16892,-866.14 16892,-866.14 16898,-866.14 16904,-872.14 16904,-878.14 16904,-878.14 16904,-1431.22 16904,-1431.22 16904,-1437.22 16898,-1443.22 16892,-1443.22 16892,-1443.22 20,-1443.22 20,-1443.22 14,-1443.22 8,-1437.22 8,-1431.22 8,-1431.22 8,-878.14 8,-878.14 8,-872.14 14,-866.14 20,-866.14"/>
<text text-anchor="middle" x="8456" y="-1428.02" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_expert_0_p0</title>
<path fill="lightpink" stroke="black" d="M14805,-874.14C14805,-874.14 16884,-874.14 16884,-874.14 16890,-874.14 16896,-880.14 16896,-886.14 16896,-886.14 16896,-1400.22 16896,-1400.22 16896,-1406.22 16890,-1412.22 16884,-1412.22 16884,-1412.22 14805,-1412.22 14805,-1412.22 14799,-1412.22 14793,-1406.22 14793,-1400.22 14793,-1400.22 14793,-886.14 14793,-886.14 14793,-880.14 14799,-874.14 14805,-874.14"/>
<text text-anchor="middle" x="15844.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 0 (GPU 0&#45;3)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_expert_1_p0</title>
<path fill="lightpink" stroke="black" d="M12694,-874.14C12694,-874.14 14773,-874.14 14773,-874.14 14779,-874.14 14785,-880.14 14785,-886.14 14785,-886.14 14785,-1400.22 14785,-1400.22 14785,-1406.22 14779,-1412.22 14773,-1412.22 14773,-1412.22 12694,-1412.22 12694,-1412.22 12688,-1412.22 12682,-1406.22 12682,-1400.22 12682,-1400.22 12682,-886.14 12682,-886.14 12682,-880.14 12688,-874.14 12694,-874.14"/>
<text text-anchor="middle" x="13733.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 1 (GPU 4&#45;7)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_expert_2_p0</title>
<path fill="lightpink" stroke="black" d="M10583,-874.14C10583,-874.14 12662,-874.14 12662,-874.14 12668,-874.14 12674,-880.14 12674,-886.14 12674,-886.14 12674,-1400.22 12674,-1400.22 12674,-1406.22 12668,-1412.22 12662,-1412.22 12662,-1412.22 10583,-1412.22 10583,-1412.22 10577,-1412.22 10571,-1406.22 10571,-1400.22 10571,-1400.22 10571,-886.14 10571,-886.14 10571,-880.14 10577,-874.14 10583,-874.14"/>
<text text-anchor="middle" x="11622.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 2 (GPU 8&#45;11)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_3_p0</title>
<path fill="lightpink" stroke="black" d="M8472,-874.14C8472,-874.14 10551,-874.14 10551,-874.14 10557,-874.14 10563,-880.14 10563,-886.14 10563,-886.14 10563,-1400.22 10563,-1400.22 10563,-1406.22 10557,-1412.22 10551,-1412.22 10551,-1412.22 8472,-1412.22 8472,-1412.22 8466,-1412.22 8460,-1406.22 8460,-1400.22 8460,-1400.22 8460,-886.14 8460,-886.14 8460,-880.14 8466,-874.14 8472,-874.14"/>
<text text-anchor="middle" x="9511.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 3 (GPU 12&#45;15)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_4_p0</title>
<path fill="lightpink" stroke="black" d="M6361,-874.14C6361,-874.14 8440,-874.14 8440,-874.14 8446,-874.14 8452,-880.14 8452,-886.14 8452,-886.14 8452,-1400.22 8452,-1400.22 8452,-1406.22 8446,-1412.22 8440,-1412.22 8440,-1412.22 6361,-1412.22 6361,-1412.22 6355,-1412.22 6349,-1406.22 6349,-1400.22 6349,-1400.22 6349,-886.14 6349,-886.14 6349,-880.14 6355,-874.14 6361,-874.14"/>
<text text-anchor="middle" x="7400.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 4 (GPU 16&#45;19)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_5_p0</title>
<path fill="lightpink" stroke="black" d="M4250,-874.14C4250,-874.14 6329,-874.14 6329,-874.14 6335,-874.14 6341,-880.14 6341,-886.14 6341,-886.14 6341,-1400.22 6341,-1400.22 6341,-1406.22 6335,-1412.22 6329,-1412.22 6329,-1412.22 4250,-1412.22 4250,-1412.22 4244,-1412.22 4238,-1406.22 4238,-1400.22 4238,-1400.22 4238,-886.14 4238,-886.14 4238,-880.14 4244,-874.14 4250,-874.14"/>
<text text-anchor="middle" x="5289.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 5 (GPU 20&#45;23)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_6_p0</title>
<path fill="lightpink" stroke="black" d="M2139,-874.14C2139,-874.14 4218,-874.14 4218,-874.14 4224,-874.14 4230,-880.14 4230,-886.14 4230,-886.14 4230,-1400.22 4230,-1400.22 4230,-1406.22 4224,-1412.22 4218,-1412.22 4218,-1412.22 2139,-1412.22 2139,-1412.22 2133,-1412.22 2127,-1406.22 2127,-1400.22 2127,-1400.22 2127,-886.14 2127,-886.14 2127,-880.14 2133,-874.14 2139,-874.14"/>
<text text-anchor="middle" x="3178.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 6 (GPU 24&#45;27)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert_7_p0</title>
<path fill="lightpink" stroke="black" d="M28,-874.14C28,-874.14 2107,-874.14 2107,-874.14 2113,-874.14 2119,-880.14 2119,-886.14 2119,-886.14 2119,-1400.22 2119,-1400.22 2119,-1406.22 2113,-1412.22 2107,-1412.22 2107,-1412.22 28,-1412.22 28,-1412.22 22,-1412.22 16,-1406.22 16,-1400.22 16,-1400.22 16,-886.14 16,-886.14 16,-880.14 22,-874.14 28,-874.14"/>
<text text-anchor="middle" x="1067.5" y="-1397.02" font-family="Times,serif" font-size="14.00">Expert Group 7 (GPU 28&#45;31)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_pipeline_1</title>
<path fill="lightsteelblue" stroke="black" d="M389,-77.98C389,-77.98 17261,-77.98 17261,-77.98 17267,-77.98 17273,-83.98 17273,-89.98 17273,-89.98 17273,-643.06 17273,-643.06 17273,-649.06 17267,-655.06 17261,-655.06 17261,-655.06 389,-655.06 389,-655.06 383,-655.06 377,-649.06 377,-643.06 377,-643.06 377,-89.98 377,-89.98 377,-83.98 383,-77.98 389,-77.98"/>
<text text-anchor="middle" x="8825" y="-639.86" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 8&#45;15)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_expert_0_p1</title>
<path fill="lightcoral" stroke="black" d="M15174,-85.98C15174,-85.98 17253,-85.98 17253,-85.98 17259,-85.98 17265,-91.98 17265,-97.98 17265,-97.98 17265,-612.06 17265,-612.06 17265,-618.06 17259,-624.06 17253,-624.06 17253,-624.06 15174,-624.06 15174,-624.06 15168,-624.06 15162,-618.06 15162,-612.06 15162,-612.06 15162,-97.98 15162,-97.98 15162,-91.98 15168,-85.98 15174,-85.98"/>
<text text-anchor="middle" x="16213.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 0 (GPU 32&#45;35)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_expert_1_p1</title>
<path fill="lightcoral" stroke="black" d="M13063,-85.98C13063,-85.98 15142,-85.98 15142,-85.98 15148,-85.98 15154,-91.98 15154,-97.98 15154,-97.98 15154,-612.06 15154,-612.06 15154,-618.06 15148,-624.06 15142,-624.06 15142,-624.06 13063,-624.06 13063,-624.06 13057,-624.06 13051,-618.06 13051,-612.06 13051,-612.06 13051,-97.98 13051,-97.98 13051,-91.98 13057,-85.98 13063,-85.98"/>
<text text-anchor="middle" x="14102.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 1 (GPU 36&#45;39)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_expert_2_p1</title>
<path fill="lightcoral" stroke="black" d="M10952,-85.98C10952,-85.98 13031,-85.98 13031,-85.98 13037,-85.98 13043,-91.98 13043,-97.98 13043,-97.98 13043,-612.06 13043,-612.06 13043,-618.06 13037,-624.06 13031,-624.06 13031,-624.06 10952,-624.06 10952,-624.06 10946,-624.06 10940,-618.06 10940,-612.06 10940,-612.06 10940,-97.98 10940,-97.98 10940,-91.98 10946,-85.98 10952,-85.98"/>
<text text-anchor="middle" x="11991.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 2 (GPU 40&#45;43)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_expert_3_p1</title>
<path fill="lightcoral" stroke="black" d="M8841,-85.98C8841,-85.98 10920,-85.98 10920,-85.98 10926,-85.98 10932,-91.98 10932,-97.98 10932,-97.98 10932,-612.06 10932,-612.06 10932,-618.06 10926,-624.06 10920,-624.06 10920,-624.06 8841,-624.06 8841,-624.06 8835,-624.06 8829,-618.06 8829,-612.06 8829,-612.06 8829,-97.98 8829,-97.98 8829,-91.98 8835,-85.98 8841,-85.98"/>
<text text-anchor="middle" x="9880.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 3 (GPU 44&#45;47)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_expert_4_p1</title>
<path fill="lightcoral" stroke="black" d="M6730,-85.98C6730,-85.98 8809,-85.98 8809,-85.98 8815,-85.98 8821,-91.98 8821,-97.98 8821,-97.98 8821,-612.06 8821,-612.06 8821,-618.06 8815,-624.06 8809,-624.06 8809,-624.06 6730,-624.06 6730,-624.06 6724,-624.06 6718,-618.06 6718,-612.06 6718,-612.06 6718,-97.98 6718,-97.98 6718,-91.98 6724,-85.98 6730,-85.98"/>
<text text-anchor="middle" x="7769.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 4 (GPU 48&#45;51)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_expert_5_p1</title>
<path fill="lightcoral" stroke="black" d="M4619,-85.98C4619,-85.98 6698,-85.98 6698,-85.98 6704,-85.98 6710,-91.98 6710,-97.98 6710,-97.98 6710,-612.06 6710,-612.06 6710,-618.06 6704,-624.06 6698,-624.06 6698,-624.06 4619,-624.06 4619,-624.06 4613,-624.06 4607,-618.06 4607,-612.06 4607,-612.06 4607,-97.98 4607,-97.98 4607,-91.98 4613,-85.98 4619,-85.98"/>
<text text-anchor="middle" x="5658.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 5 (GPU 52&#45;55)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_expert_6_p1</title>
<path fill="lightcoral" stroke="black" d="M2508,-85.98C2508,-85.98 4587,-85.98 4587,-85.98 4593,-85.98 4599,-91.98 4599,-97.98 4599,-97.98 4599,-612.06 4599,-612.06 4599,-618.06 4593,-624.06 4587,-624.06 4587,-624.06 2508,-624.06 2508,-624.06 2502,-624.06 2496,-618.06 2496,-612.06 2496,-612.06 2496,-97.98 2496,-97.98 2496,-91.98 2502,-85.98 2508,-85.98"/>
<text text-anchor="middle" x="3547.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 6 (GPU 56&#45;59)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_expert_7_p1</title>
<path fill="lightcoral" stroke="black" d="M397,-85.98C397,-85.98 2476,-85.98 2476,-85.98 2482,-85.98 2488,-91.98 2488,-97.98 2488,-97.98 2488,-612.06 2488,-612.06 2488,-618.06 2482,-624.06 2476,-624.06 2476,-624.06 397,-624.06 397,-624.06 391,-624.06 385,-618.06 385,-612.06 385,-612.06 385,-97.98 385,-97.98 385,-91.98 391,-85.98 397,-85.98"/>
<text text-anchor="middle" x="1436.5" y="-608.86" font-family="Times,serif" font-size="14.00">Expert Group 7 (GPU 60&#45;63)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgray" stroke="black" cx="8552" cy="-1589.75" rx="180.12" ry="28.98"/>
<text text-anchor="middle" x="8552" y="-1598.25" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="8552" y="-1587.25" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="8552" y="-1576.25" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_global_p0 -->
<g id="node290" class="node">
<title>all2all_global_p0</title>
<ellipse fill="lightblue" stroke="black" cx="8552" cy="-1487.99" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="8552" y="-1501.99" font-family="Arial" font-size="10.00">Global All&#45;to&#45;All</text>
<text text-anchor="middle" x="8552" y="-1490.99" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="8552" y="-1479.99" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="8552" y="-1468.99" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- input&#45;&gt;all2all_global_p0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;all2all_global_p0</title>
<path fill="none" stroke="black" d="M8552,-1560.69C8552,-1552.74 8552,-1543.87 8552,-1535.14"/>
<polygon fill="black" stroke="black" points="8555.5,-1535.04 8552,-1525.04 8548.5,-1535.04 8555.5,-1535.04"/>
</g>
<!-- gate_e0_p0 -->
<g id="node2" class="node">
<title>gate_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="16003.24,-1381.22 15582.89,-1381.22 15474.76,-1277.22 15895.11,-1277.22 16003.24,-1381.22"/>
<text text-anchor="middle" x="15739" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="15739" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="15739" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="15739" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e0_p0 -->
<g id="node3" class="node">
<title>all2all_local_e0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="15641" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="15641" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="15641" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 0&#45;3</text>
<text text-anchor="middle" x="15641" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="15641" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e0_p0&#45;&gt;all2all_local_e0_p0 -->
<g id="edge10" class="edge">
<title>gate_e0_p0&#45;&gt;all2all_local_e0_p0</title>
<path fill="none" stroke="black" d="M15698.01,-1276.86C15690.54,-1267.51 15682.82,-1257.84 15675.57,-1248.75"/>
<polygon fill="black" stroke="black" points="15678.3,-1246.57 15669.33,-1240.94 15672.83,-1250.94 15678.3,-1246.57"/>
</g>
<!-- moe_e0_t0_e0_p0 -->
<g id="node5" class="node">
<title>moe_e0_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="15046.5,-1043.68 14801.5,-1043.68 14801.5,-991.68 15046.5,-991.68 15046.5,-1043.68"/>
<text text-anchor="middle" x="14924" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="14924" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="14924" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14924" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t0_e0_p0 -->
<g id="edge419" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15502.27,-1303.97C15378.49,-1288.74 15241.28,-1267.09 15185,-1241.22 15085.88,-1195.65 14994.96,-1101.34 14951.27,-1051.38"/>
<polygon fill="black" stroke="black" points="14953.86,-1049.02 14944.67,-1043.76 14948.57,-1053.61 14953.86,-1049.02"/>
</g>
<!-- moe_e0_t0_e1_p0 -->
<g id="node6" class="node">
<title>moe_e0_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="15309.5,-1043.68 15064.5,-1043.68 15064.5,-991.68 15309.5,-991.68 15309.5,-1043.68"/>
<text text-anchor="middle" x="15187" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="15187" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="15187" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15187" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t0_e1_p0 -->
<g id="edge421" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15490.28,-1277.14C15347.3,-1242.06 15188.07,-1191.16 15147,-1131.68 15130.36,-1107.58 15144.1,-1075.83 15159.85,-1052.12"/>
<polygon fill="black" stroke="black" points="15162.82,-1053.98 15165.69,-1043.78 15157.09,-1049.97 15162.82,-1053.98"/>
</g>
<!-- moe_e0_t1_e0_p0 -->
<g id="node9" class="node">
<title>moe_e0_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="15572.5,-1043.68 15327.5,-1043.68 15327.5,-991.68 15572.5,-991.68 15572.5,-1043.68"/>
<text text-anchor="middle" x="15450" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="15450" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15450" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15450" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t1_e0_p0 -->
<g id="edge423" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15516.52,-1277.14C15487.87,-1266.48 15465,-1254.43 15455,-1241.22 15433.42,-1212.71 15440.43,-1109.11 15445.97,-1053.89"/>
<polygon fill="black" stroke="black" points="15449.46,-1054.16 15447.01,-1043.85 15442.5,-1053.44 15449.46,-1054.16"/>
</g>
<!-- moe_e0_t1_e1_p0 -->
<g id="node10" class="node">
<title>moe_e0_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="15835.5,-1043.68 15590.5,-1043.68 15590.5,-991.68 15835.5,-991.68 15835.5,-1043.68"/>
<text text-anchor="middle" x="15713" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="15713" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15713" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15713" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t1_e1_p0 -->
<g id="edge425" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15803.44,-1277.21C15813.04,-1266.42 15821.54,-1254.3 15827,-1241.22 15839.59,-1211.06 15834.22,-1199.56 15827,-1167.68 15817.43,-1125.41 15811.45,-1114 15785,-1079.68 15776.87,-1069.13 15766.65,-1059.13 15756.48,-1050.4"/>
<polygon fill="black" stroke="black" points="15758.67,-1047.67 15748.74,-1043.97 15754.2,-1053.06 15758.67,-1047.67"/>
</g>
<!-- moe_e0_t2_e0_p0 -->
<g id="node13" class="node">
<title>moe_e0_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="16098.5,-1043.68 15853.5,-1043.68 15853.5,-991.68 16098.5,-991.68 16098.5,-1043.68"/>
<text text-anchor="middle" x="15976" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="15976" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15976" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15976" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t2_e0_p0 -->
<g id="edge427" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15906.15,-1287.34C15987.14,-1258.2 16077.05,-1209.9 16125,-1131.68 16137.08,-1111.97 16137.88,-1098.87 16125,-1079.68 16116.37,-1066.83 16104.51,-1056.68 16091.21,-1048.67"/>
<polygon fill="black" stroke="black" points="16092.72,-1045.51 16082.28,-1043.71 16089.32,-1051.63 16092.72,-1045.51"/>
</g>
<!-- moe_e0_t2_e1_p0 -->
<g id="node14" class="node">
<title>moe_e0_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="16361.5,-1043.68 16116.5,-1043.68 16116.5,-991.68 16361.5,-991.68 16361.5,-1043.68"/>
<text text-anchor="middle" x="16239" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="16239" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="16239" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16239" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t2_e1_p0 -->
<g id="edge429" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15919.04,-1299.82C15966.76,-1286.92 16016.51,-1268.23 16058,-1241.22 16097.12,-1215.75 16176.01,-1108.24 16215.44,-1052.51"/>
<polygon fill="black" stroke="black" points="16218.52,-1054.22 16221.42,-1044.03 16212.8,-1050.18 16218.52,-1054.22"/>
</g>
<!-- moe_e0_t3_e0_p0 -->
<g id="node17" class="node">
<title>moe_e0_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="16624.5,-1043.68 16379.5,-1043.68 16379.5,-991.68 16624.5,-991.68 16624.5,-1043.68"/>
<text text-anchor="middle" x="16502" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="16502" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16502" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16502" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t3_e0_p0 -->
<g id="edge431" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15923.92,-1304.71C16122.71,-1275.34 16419.98,-1218.18 16492,-1131.68 16509.75,-1110.36 16510.99,-1078.28 16508.52,-1053.75"/>
<polygon fill="black" stroke="black" points="16511.99,-1053.23 16507.27,-1043.75 16505.04,-1054.1 16511.99,-1053.23"/>
</g>
<!-- moe_e0_t3_e1_p0 -->
<g id="node18" class="node">
<title>moe_e0_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="16887.5,-1043.68 16642.5,-1043.68 16642.5,-991.68 16887.5,-991.68 16887.5,-1043.68"/>
<text text-anchor="middle" x="16765" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="16765" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16765" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16765" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p0&#45;&gt;moe_e0_t3_e1_p0 -->
<g id="edge433" class="edge">
<title>gate_e0_p0&#45;&gt;moe_e0_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15937.65,-1317.94C16059.89,-1307.27 16218.39,-1285.53 16353,-1241.22 16496.03,-1194.14 16647.76,-1098.69 16720.73,-1049.51"/>
<polygon fill="black" stroke="black" points="16722.92,-1052.25 16729.23,-1043.75 16718.99,-1046.46 16722.92,-1052.25"/>
</g>
<!-- attention_e0_t0_p0 -->
<g id="node4" class="node">
<title>attention_e0_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="15426,-1131.68 15156,-1131.68 15156,-1079.68 15426,-1079.68 15426,-1131.68"/>
<text text-anchor="middle" x="15291" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15291" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="15291" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15291" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p0&#45;&gt;attention_e0_t0_p0 -->
<g id="edge11" class="edge">
<title>all2all_local_e0_p0&#45;&gt;attention_e0_t0_p0</title>
<path fill="none" stroke="black" d="M15536.94,-1174.68C15490.94,-1161.96 15437.08,-1147.07 15391.5,-1134.47"/>
<polygon fill="black" stroke="black" points="15392.18,-1131.02 15381.61,-1131.73 15390.32,-1137.77 15392.18,-1131.02"/>
</g>
<!-- attention_e0_t1_p0 -->
<g id="node8" class="node">
<title>attention_e0_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="15776,-1131.68 15506,-1131.68 15506,-1079.68 15776,-1079.68 15776,-1131.68"/>
<text text-anchor="middle" x="15641" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15641" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15641" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15641" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p0&#45;&gt;attention_e0_t1_p0 -->
<g id="edge16" class="edge">
<title>all2all_local_e0_p0&#45;&gt;attention_e0_t1_p0</title>
<path fill="none" stroke="black" d="M15641,-1167.41C15641,-1159.1 15641,-1150.27 15641,-1141.99"/>
<polygon fill="black" stroke="black" points="15644.5,-1141.87 15641,-1131.87 15637.5,-1141.87 15644.5,-1141.87"/>
</g>
<!-- attention_e0_t2_p0 -->
<g id="node12" class="node">
<title>attention_e0_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="16116,-1131.68 15846,-1131.68 15846,-1079.68 16116,-1079.68 16116,-1131.68"/>
<text text-anchor="middle" x="15981" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15981" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15981" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15981" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p0&#45;&gt;attention_e0_t2_p0 -->
<g id="edge21" class="edge">
<title>all2all_local_e0_p0&#45;&gt;attention_e0_t2_p0</title>
<path fill="none" stroke="black" d="M15743.01,-1174.41C15787.47,-1161.76 15839.36,-1146.99 15883.33,-1134.48"/>
<polygon fill="black" stroke="black" points="15884.5,-1137.78 15893.16,-1131.68 15882.58,-1131.05 15884.5,-1137.78"/>
</g>
<!-- attention_e0_t3_p0 -->
<g id="node16" class="node">
<title>attention_e0_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="16483,-1131.68 16213,-1131.68 16213,-1079.68 16483,-1079.68 16483,-1131.68"/>
<text text-anchor="middle" x="16348" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16348" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16348" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="16348" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p0&#45;&gt;attention_e0_t3_p0 -->
<g id="edge26" class="edge">
<title>all2all_local_e0_p0&#45;&gt;attention_e0_t3_p0</title>
<path fill="none" stroke="black" d="M15786.63,-1183.51C15908.32,-1166.86 16080.98,-1143.23 16202.6,-1126.58"/>
<polygon fill="black" stroke="black" points="16203.3,-1130.02 16212.73,-1125.19 16202.35,-1123.08 16203.3,-1130.02"/>
</g>
<!-- attention_e0_t0_p0&#45;&gt;moe_e0_t0_e0_p0 -->
<g id="edge12" class="edge">
<title>attention_e0_t0_p0&#45;&gt;moe_e0_t0_e0_p0</title>
<path fill="none" stroke="black" d="M15183.86,-1079.57C15139.02,-1069.06 15086.77,-1056.82 15040.93,-1046.08"/>
<polygon fill="black" stroke="black" points="15041.49,-1042.61 15030.95,-1043.74 15039.89,-1049.43 15041.49,-1042.61"/>
</g>
<!-- attention_e0_t0_p0&#45;&gt;moe_e0_t0_e1_p0 -->
<g id="edge13" class="edge">
<title>attention_e0_t0_p0&#45;&gt;moe_e0_t0_e1_p0</title>
<path fill="none" stroke="black" d="M15260.64,-1079.57C15249.63,-1070.47 15237.05,-1060.06 15225.43,-1050.46"/>
<polygon fill="black" stroke="black" points="15227.52,-1047.64 15217.58,-1043.96 15223.05,-1053.03 15227.52,-1047.64"/>
</g>
<!-- tensor_reduce_e0_t0_p0 -->
<g id="node7" class="node">
<title>tensor_reduce_e0_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="14974" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="14974" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="14974" y="-921.91" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="14974" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14974" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t0_e0_p0&#45;&gt;tensor_reduce_e0_t0_p0 -->
<g id="edge14" class="edge">
<title>moe_e0_t0_e0_p0&#45;&gt;tensor_reduce_e0_t0_p0</title>
<path fill="none" stroke="black" d="M14937.01,-991.51C14941.26,-983.27 14946.12,-973.87 14950.89,-964.64"/>
<polygon fill="black" stroke="black" points="14954.12,-966.01 14955.6,-955.52 14947.9,-962.8 14954.12,-966.01"/>
</g>
<!-- moe_e0_t0_e1_p0&#45;&gt;tensor_reduce_e0_t0_p0 -->
<g id="edge15" class="edge">
<title>moe_e0_t0_e1_p0&#45;&gt;tensor_reduce_e0_t0_p0</title>
<path fill="none" stroke="black" d="M15131.87,-991.63C15108.49,-981.01 15080.76,-968.41 15055.12,-956.76"/>
<polygon fill="black" stroke="black" points="15056.33,-953.47 15045.77,-952.52 15053.43,-959.84 15056.33,-953.47"/>
</g>
<!-- pipeline_transfer -->
<g id="node292" class="node">
<title>pipeline_transfer</title>
<ellipse fill="orange" stroke="black" cx="8456" cy="-809.37" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="8456" y="-823.37" font-family="Arial" font-size="10.00">Pipeline Transfer</text>
<text text-anchor="middle" x="8456" y="-812.37" font-family="Arial" font-size="10.00">GPU: 0&#45;31 â†’ 32&#45;63</text>
<text text-anchor="middle" x="8456" y="-801.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="8456" y="-790.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- tensor_reduce_e0_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge178" class="edge">
<title>tensor_reduce_e0_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M14883.74,-887.51C14853.93,-878.86 14820.37,-870.59 14789,-866.14 14477.81,-822.02 9669.1,-812.22 8646.33,-810.63"/>
<polygon fill="black" stroke="black" points="8646.32,-807.13 8636.31,-810.62 8646.31,-814.13 8646.32,-807.13"/>
</g>
<!-- attention_e0_t1_p0&#45;&gt;moe_e0_t1_e0_p0 -->
<g id="edge17" class="edge">
<title>attention_e0_t1_p0&#45;&gt;moe_e0_t1_e0_p0</title>
<path fill="none" stroke="black" d="M15585.24,-1079.57C15563.27,-1069.68 15537.89,-1058.25 15515.09,-1047.99"/>
<polygon fill="black" stroke="black" points="15516.38,-1044.73 15505.83,-1043.82 15513.51,-1051.11 15516.38,-1044.73"/>
</g>
<!-- attention_e0_t1_p0&#45;&gt;moe_e0_t1_e1_p0 -->
<g id="edge18" class="edge">
<title>attention_e0_t1_p0&#45;&gt;moe_e0_t1_e1_p0</title>
<path fill="none" stroke="black" d="M15662.21,-1079.34C15669.46,-1070.68 15677.68,-1060.86 15685.36,-1051.69"/>
<polygon fill="black" stroke="black" points="15688.2,-1053.75 15691.94,-1043.83 15682.84,-1049.26 15688.2,-1053.75"/>
</g>
<!-- tensor_reduce_e0_t1_p0 -->
<g id="node11" class="node">
<title>tensor_reduce_e0_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="15450" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="15450" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="15450" y="-921.91" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="15450" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15450" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t1_e0_p0&#45;&gt;tensor_reduce_e0_t1_p0 -->
<g id="edge19" class="edge">
<title>moe_e0_t1_e0_p0&#45;&gt;tensor_reduce_e0_t1_p0</title>
<path fill="none" stroke="black" d="M15450,-991.51C15450,-983.7 15450,-974.83 15450,-966.06"/>
<polygon fill="black" stroke="black" points="15453.5,-965.89 15450,-955.89 15446.5,-965.89 15453.5,-965.89"/>
</g>
<!-- moe_e0_t1_e1_p0&#45;&gt;tensor_reduce_e0_t1_p0 -->
<g id="edge20" class="edge">
<title>moe_e0_t1_e1_p0&#45;&gt;tensor_reduce_e0_t1_p0</title>
<path fill="none" stroke="black" d="M15644.93,-991.63C15614.31,-980.37 15577.67,-966.88 15544.46,-954.66"/>
<polygon fill="black" stroke="black" points="15545.32,-951.25 15534.73,-951.09 15542.91,-957.82 15545.32,-951.25"/>
</g>
<!-- tensor_reduce_e0_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge179" class="edge">
<title>tensor_reduce_e0_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M15330.45,-892.22C15277.3,-882 15213.8,-871.43 15156,-866.14 14493.84,-805.51 9669.64,-808.69 8646.4,-810.07"/>
<polygon fill="black" stroke="black" points="8646.37,-806.57 8636.38,-810.08 8646.38,-813.57 8646.37,-806.57"/>
</g>
<!-- attention_e0_t2_p0&#45;&gt;moe_e0_t2_e0_p0 -->
<g id="edge22" class="edge">
<title>attention_e0_t2_p0&#45;&gt;moe_e0_t2_e0_p0</title>
<path fill="none" stroke="black" d="M15979.53,-1079.34C15979.06,-1071.38 15978.54,-1062.44 15978.05,-1053.92"/>
<polygon fill="black" stroke="black" points="15981.54,-1053.61 15977.46,-1043.83 15974.55,-1054.02 15981.54,-1053.61"/>
</g>
<!-- attention_e0_t2_p0&#45;&gt;moe_e0_t2_e1_p0 -->
<g id="edge23" class="edge">
<title>attention_e0_t2_p0&#45;&gt;moe_e0_t2_e1_p0</title>
<path fill="none" stroke="black" d="M16056.32,-1079.57C16086.92,-1069.37 16122.42,-1057.54 16153.94,-1047.03"/>
<polygon fill="black" stroke="black" points="16155.21,-1050.3 16163.59,-1043.82 16152.99,-1043.66 16155.21,-1050.3"/>
</g>
<!-- tensor_reduce_e0_t2_p0 -->
<g id="node15" class="node">
<title>tensor_reduce_e0_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="15976" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="15976" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="15976" y="-921.91" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="15976" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15976" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t2_e0_p0&#45;&gt;tensor_reduce_e0_t2_p0 -->
<g id="edge24" class="edge">
<title>moe_e0_t2_e0_p0&#45;&gt;tensor_reduce_e0_t2_p0</title>
<path fill="none" stroke="black" d="M15976,-991.51C15976,-983.7 15976,-974.83 15976,-966.06"/>
<polygon fill="black" stroke="black" points="15979.5,-965.89 15976,-955.89 15972.5,-965.89 15979.5,-965.89"/>
</g>
<!-- moe_e0_t2_e1_p0&#45;&gt;tensor_reduce_e0_t2_p0 -->
<g id="edge25" class="edge">
<title>moe_e0_t2_e1_p0&#45;&gt;tensor_reduce_e0_t2_p0</title>
<path fill="none" stroke="black" d="M16170.93,-991.63C16140.31,-980.37 16103.67,-966.88 16070.46,-954.66"/>
<polygon fill="black" stroke="black" points="16071.32,-951.25 16060.73,-951.09 16068.91,-957.82 16071.32,-951.25"/>
</g>
<!-- tensor_reduce_e0_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge180" class="edge">
<title>tensor_reduce_e0_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M15847.45,-894.15C15783.02,-883.36 15703.65,-871.78 15632,-866.14 14919.13,-810.01 9713.53,-809.7 8646.72,-810.24"/>
<polygon fill="black" stroke="black" points="8646.65,-806.74 8636.65,-810.24 8646.66,-813.74 8646.65,-806.74"/>
</g>
<!-- attention_e0_t3_p0&#45;&gt;moe_e0_t3_e0_p0 -->
<g id="edge27" class="edge">
<title>attention_e0_t3_p0&#45;&gt;moe_e0_t3_e0_p0</title>
<path fill="none" stroke="black" d="M16392.96,-1079.57C16410.12,-1069.99 16429.86,-1058.96 16447.8,-1048.95"/>
<polygon fill="black" stroke="black" points="16449.96,-1051.75 16456.99,-1043.82 16446.55,-1045.64 16449.96,-1051.75"/>
</g>
<!-- attention_e0_t3_p0&#45;&gt;moe_e0_t3_e1_p0 -->
<g id="edge28" class="edge">
<title>attention_e0_t3_p0&#45;&gt;moe_e0_t3_e1_p0</title>
<path fill="none" stroke="black" d="M16469.45,-1079.63C16520.95,-1069.01 16581.09,-1056.61 16633.62,-1045.77"/>
<polygon fill="black" stroke="black" points="16634.59,-1049.15 16643.68,-1043.7 16633.18,-1042.29 16634.59,-1049.15"/>
</g>
<!-- tensor_reduce_e0_t3_p0 -->
<g id="node19" class="node">
<title>tensor_reduce_e0_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="16502" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="16502" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="16502" y="-921.91" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="16502" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16502" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t3_e0_p0&#45;&gt;tensor_reduce_e0_t3_p0 -->
<g id="edge29" class="edge">
<title>moe_e0_t3_e0_p0&#45;&gt;tensor_reduce_e0_t3_p0</title>
<path fill="none" stroke="black" d="M16502,-991.51C16502,-983.7 16502,-974.83 16502,-966.06"/>
<polygon fill="black" stroke="black" points="16505.5,-965.89 16502,-955.89 16498.5,-965.89 16505.5,-965.89"/>
</g>
<!-- moe_e0_t3_e1_p0&#45;&gt;tensor_reduce_e0_t3_p0 -->
<g id="edge30" class="edge">
<title>moe_e0_t3_e1_p0&#45;&gt;tensor_reduce_e0_t3_p0</title>
<path fill="none" stroke="black" d="M16696.93,-991.63C16666.31,-980.37 16629.67,-966.88 16596.46,-954.66"/>
<polygon fill="black" stroke="black" points="16597.32,-951.25 16586.73,-951.09 16594.91,-957.82 16597.32,-951.25"/>
</g>
<!-- tensor_reduce_e0_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge181" class="edge">
<title>tensor_reduce_e0_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M16373.45,-894.13C16309.02,-883.34 16229.65,-871.76 16158,-866.14 15389.66,-805.85 9758.76,-808.92 8646.53,-810.13"/>
<polygon fill="black" stroke="black" points="8646.44,-806.63 8636.44,-810.14 8646.44,-813.63 8646.44,-806.63"/>
</g>
<!-- gate_e1_p0 -->
<g id="node20" class="node">
<title>gate_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="13892.24,-1381.22 13471.89,-1381.22 13363.76,-1277.22 13784.11,-1277.22 13892.24,-1381.22"/>
<text text-anchor="middle" x="13628" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="13628" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="13628" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="13628" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e1_p0 -->
<g id="node21" class="node">
<title>all2all_local_e1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="13530" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="13530" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="13530" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 4&#45;7</text>
<text text-anchor="middle" x="13530" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="13530" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e1_p0&#45;&gt;all2all_local_e1_p0 -->
<g id="edge31" class="edge">
<title>gate_e1_p0&#45;&gt;all2all_local_e1_p0</title>
<path fill="none" stroke="black" d="M13587.01,-1276.86C13579.54,-1267.51 13571.82,-1257.84 13564.57,-1248.75"/>
<polygon fill="black" stroke="black" points="13567.3,-1246.57 13558.33,-1240.94 13561.83,-1250.94 13567.3,-1246.57"/>
</g>
<!-- moe_e1_t0_e0_p0 -->
<g id="node23" class="node">
<title>moe_e1_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="12935.5,-1043.68 12690.5,-1043.68 12690.5,-991.68 12935.5,-991.68 12935.5,-1043.68"/>
<text text-anchor="middle" x="12813" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="12813" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="12813" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12813" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t0_e0_p0 -->
<g id="edge435" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13391.27,-1303.97C13267.49,-1288.74 13130.28,-1267.09 13074,-1241.22 12974.88,-1195.65 12883.96,-1101.34 12840.27,-1051.38"/>
<polygon fill="black" stroke="black" points="12842.86,-1049.02 12833.67,-1043.76 12837.57,-1053.61 12842.86,-1049.02"/>
</g>
<!-- moe_e1_t0_e1_p0 -->
<g id="node24" class="node">
<title>moe_e1_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="13198.5,-1043.68 12953.5,-1043.68 12953.5,-991.68 13198.5,-991.68 13198.5,-1043.68"/>
<text text-anchor="middle" x="13076" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="13076" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="13076" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13076" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t0_e1_p0 -->
<g id="edge437" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13379.28,-1277.14C13236.3,-1242.06 13077.07,-1191.16 13036,-1131.68 13019.36,-1107.58 13033.1,-1075.83 13048.85,-1052.12"/>
<polygon fill="black" stroke="black" points="13051.82,-1053.98 13054.69,-1043.78 13046.09,-1049.97 13051.82,-1053.98"/>
</g>
<!-- moe_e1_t1_e0_p0 -->
<g id="node27" class="node">
<title>moe_e1_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="13461.5,-1043.68 13216.5,-1043.68 13216.5,-991.68 13461.5,-991.68 13461.5,-1043.68"/>
<text text-anchor="middle" x="13339" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="13339" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="13339" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13339" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t1_e0_p0 -->
<g id="edge439" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13405.52,-1277.14C13376.87,-1266.48 13354,-1254.43 13344,-1241.22 13322.42,-1212.71 13329.43,-1109.11 13334.97,-1053.89"/>
<polygon fill="black" stroke="black" points="13338.46,-1054.16 13336.01,-1043.85 13331.5,-1053.44 13338.46,-1054.16"/>
</g>
<!-- moe_e1_t1_e1_p0 -->
<g id="node28" class="node">
<title>moe_e1_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="13724.5,-1043.68 13479.5,-1043.68 13479.5,-991.68 13724.5,-991.68 13724.5,-1043.68"/>
<text text-anchor="middle" x="13602" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="13602" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="13602" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13602" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t1_e1_p0 -->
<g id="edge441" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13692.44,-1277.21C13702.04,-1266.42 13710.54,-1254.3 13716,-1241.22 13728.59,-1211.06 13723.22,-1199.56 13716,-1167.68 13706.43,-1125.41 13700.45,-1114 13674,-1079.68 13665.87,-1069.13 13655.65,-1059.13 13645.48,-1050.4"/>
<polygon fill="black" stroke="black" points="13647.67,-1047.67 13637.74,-1043.97 13643.2,-1053.06 13647.67,-1047.67"/>
</g>
<!-- moe_e1_t2_e0_p0 -->
<g id="node31" class="node">
<title>moe_e1_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="13987.5,-1043.68 13742.5,-1043.68 13742.5,-991.68 13987.5,-991.68 13987.5,-1043.68"/>
<text text-anchor="middle" x="13865" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="13865" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13865" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13865" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t2_e0_p0 -->
<g id="edge443" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13795.15,-1287.34C13876.14,-1258.2 13966.05,-1209.9 14014,-1131.68 14026.08,-1111.97 14026.88,-1098.87 14014,-1079.68 14005.37,-1066.83 13993.51,-1056.68 13980.21,-1048.67"/>
<polygon fill="black" stroke="black" points="13981.72,-1045.51 13971.28,-1043.71 13978.32,-1051.63 13981.72,-1045.51"/>
</g>
<!-- moe_e1_t2_e1_p0 -->
<g id="node32" class="node">
<title>moe_e1_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="14250.5,-1043.68 14005.5,-1043.68 14005.5,-991.68 14250.5,-991.68 14250.5,-1043.68"/>
<text text-anchor="middle" x="14128" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="14128" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="14128" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14128" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t2_e1_p0 -->
<g id="edge445" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13808.04,-1299.82C13855.76,-1286.92 13905.51,-1268.23 13947,-1241.22 13986.12,-1215.75 14065.01,-1108.24 14104.44,-1052.51"/>
<polygon fill="black" stroke="black" points="14107.52,-1054.22 14110.42,-1044.03 14101.8,-1050.18 14107.52,-1054.22"/>
</g>
<!-- moe_e1_t3_e0_p0 -->
<g id="node35" class="node">
<title>moe_e1_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="14513.5,-1043.68 14268.5,-1043.68 14268.5,-991.68 14513.5,-991.68 14513.5,-1043.68"/>
<text text-anchor="middle" x="14391" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="14391" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="14391" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14391" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t3_e0_p0 -->
<g id="edge447" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13812.92,-1304.71C14011.71,-1275.34 14308.98,-1218.18 14381,-1131.68 14398.75,-1110.36 14399.99,-1078.28 14397.52,-1053.75"/>
<polygon fill="black" stroke="black" points="14400.99,-1053.23 14396.27,-1043.75 14394.04,-1054.1 14400.99,-1053.23"/>
</g>
<!-- moe_e1_t3_e1_p0 -->
<g id="node36" class="node">
<title>moe_e1_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="14776.5,-1043.68 14531.5,-1043.68 14531.5,-991.68 14776.5,-991.68 14776.5,-1043.68"/>
<text text-anchor="middle" x="14654" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="14654" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="14654" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14654" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p0&#45;&gt;moe_e1_t3_e1_p0 -->
<g id="edge449" class="edge">
<title>gate_e1_p0&#45;&gt;moe_e1_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13826.65,-1317.94C13948.89,-1307.27 14107.39,-1285.53 14242,-1241.22 14385.03,-1194.14 14536.76,-1098.69 14609.73,-1049.51"/>
<polygon fill="black" stroke="black" points="14611.92,-1052.25 14618.23,-1043.75 14607.99,-1046.46 14611.92,-1052.25"/>
</g>
<!-- attention_e1_t0_p0 -->
<g id="node22" class="node">
<title>attention_e1_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="13315,-1131.68 13045,-1131.68 13045,-1079.68 13315,-1079.68 13315,-1131.68"/>
<text text-anchor="middle" x="13180" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13180" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="13180" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="13180" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p0&#45;&gt;attention_e1_t0_p0 -->
<g id="edge32" class="edge">
<title>all2all_local_e1_p0&#45;&gt;attention_e1_t0_p0</title>
<path fill="none" stroke="black" d="M13425.94,-1174.68C13379.94,-1161.96 13326.08,-1147.07 13280.5,-1134.47"/>
<polygon fill="black" stroke="black" points="13281.18,-1131.02 13270.61,-1131.73 13279.32,-1137.77 13281.18,-1131.02"/>
</g>
<!-- attention_e1_t1_p0 -->
<g id="node26" class="node">
<title>attention_e1_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="13665,-1131.68 13395,-1131.68 13395,-1079.68 13665,-1079.68 13665,-1131.68"/>
<text text-anchor="middle" x="13530" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13530" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="13530" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="13530" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p0&#45;&gt;attention_e1_t1_p0 -->
<g id="edge37" class="edge">
<title>all2all_local_e1_p0&#45;&gt;attention_e1_t1_p0</title>
<path fill="none" stroke="black" d="M13530,-1167.41C13530,-1159.1 13530,-1150.27 13530,-1141.99"/>
<polygon fill="black" stroke="black" points="13533.5,-1141.87 13530,-1131.87 13526.5,-1141.87 13533.5,-1141.87"/>
</g>
<!-- attention_e1_t2_p0 -->
<g id="node30" class="node">
<title>attention_e1_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="14005,-1131.68 13735,-1131.68 13735,-1079.68 14005,-1079.68 14005,-1131.68"/>
<text text-anchor="middle" x="13870" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13870" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13870" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="13870" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p0&#45;&gt;attention_e1_t2_p0 -->
<g id="edge42" class="edge">
<title>all2all_local_e1_p0&#45;&gt;attention_e1_t2_p0</title>
<path fill="none" stroke="black" d="M13632.01,-1174.41C13676.47,-1161.76 13728.36,-1146.99 13772.33,-1134.48"/>
<polygon fill="black" stroke="black" points="13773.5,-1137.78 13782.16,-1131.68 13771.58,-1131.05 13773.5,-1137.78"/>
</g>
<!-- attention_e1_t3_p0 -->
<g id="node34" class="node">
<title>attention_e1_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="14372,-1131.68 14102,-1131.68 14102,-1079.68 14372,-1079.68 14372,-1131.68"/>
<text text-anchor="middle" x="14237" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14237" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="14237" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="14237" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p0&#45;&gt;attention_e1_t3_p0 -->
<g id="edge47" class="edge">
<title>all2all_local_e1_p0&#45;&gt;attention_e1_t3_p0</title>
<path fill="none" stroke="black" d="M13675.63,-1183.51C13797.32,-1166.86 13969.98,-1143.23 14091.6,-1126.58"/>
<polygon fill="black" stroke="black" points="14092.3,-1130.02 14101.73,-1125.19 14091.35,-1123.08 14092.3,-1130.02"/>
</g>
<!-- attention_e1_t0_p0&#45;&gt;moe_e1_t0_e0_p0 -->
<g id="edge33" class="edge">
<title>attention_e1_t0_p0&#45;&gt;moe_e1_t0_e0_p0</title>
<path fill="none" stroke="black" d="M13072.86,-1079.57C13028.02,-1069.06 12975.77,-1056.82 12929.93,-1046.08"/>
<polygon fill="black" stroke="black" points="12930.49,-1042.61 12919.95,-1043.74 12928.89,-1049.43 12930.49,-1042.61"/>
</g>
<!-- attention_e1_t0_p0&#45;&gt;moe_e1_t0_e1_p0 -->
<g id="edge34" class="edge">
<title>attention_e1_t0_p0&#45;&gt;moe_e1_t0_e1_p0</title>
<path fill="none" stroke="black" d="M13149.64,-1079.57C13138.63,-1070.47 13126.05,-1060.06 13114.43,-1050.46"/>
<polygon fill="black" stroke="black" points="13116.52,-1047.64 13106.58,-1043.96 13112.05,-1053.03 13116.52,-1047.64"/>
</g>
<!-- tensor_reduce_e1_t0_p0 -->
<g id="node25" class="node">
<title>tensor_reduce_e1_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="12863" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="12863" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="12863" y="-921.91" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="12863" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12863" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t0_e0_p0&#45;&gt;tensor_reduce_e1_t0_p0 -->
<g id="edge35" class="edge">
<title>moe_e1_t0_e0_p0&#45;&gt;tensor_reduce_e1_t0_p0</title>
<path fill="none" stroke="black" d="M12826.01,-991.51C12830.26,-983.27 12835.12,-973.87 12839.89,-964.64"/>
<polygon fill="black" stroke="black" points="12843.12,-966.01 12844.6,-955.52 12836.9,-962.8 12843.12,-966.01"/>
</g>
<!-- moe_e1_t0_e1_p0&#45;&gt;tensor_reduce_e1_t0_p0 -->
<g id="edge36" class="edge">
<title>moe_e1_t0_e1_p0&#45;&gt;tensor_reduce_e1_t0_p0</title>
<path fill="none" stroke="black" d="M13020.87,-991.63C12997.49,-981.01 12969.76,-968.41 12944.12,-956.76"/>
<polygon fill="black" stroke="black" points="12945.33,-953.47 12934.77,-952.52 12942.43,-959.84 12945.33,-953.47"/>
</g>
<!-- tensor_reduce_e1_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge182" class="edge">
<title>tensor_reduce_e1_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M12772.26,-887.46C12742.57,-878.86 12709.2,-870.63 12678,-866.14 12276.74,-808.35 9416.46,-808.79 8646.48,-809.98"/>
<polygon fill="black" stroke="black" points="8646.41,-806.48 8636.41,-809.99 8646.42,-813.48 8646.41,-806.48"/>
</g>
<!-- attention_e1_t1_p0&#45;&gt;moe_e1_t1_e0_p0 -->
<g id="edge38" class="edge">
<title>attention_e1_t1_p0&#45;&gt;moe_e1_t1_e0_p0</title>
<path fill="none" stroke="black" d="M13474.24,-1079.57C13452.27,-1069.68 13426.89,-1058.25 13404.09,-1047.99"/>
<polygon fill="black" stroke="black" points="13405.38,-1044.73 13394.83,-1043.82 13402.51,-1051.11 13405.38,-1044.73"/>
</g>
<!-- attention_e1_t1_p0&#45;&gt;moe_e1_t1_e1_p0 -->
<g id="edge39" class="edge">
<title>attention_e1_t1_p0&#45;&gt;moe_e1_t1_e1_p0</title>
<path fill="none" stroke="black" d="M13551.21,-1079.34C13558.46,-1070.68 13566.68,-1060.86 13574.36,-1051.69"/>
<polygon fill="black" stroke="black" points="13577.2,-1053.75 13580.94,-1043.83 13571.84,-1049.26 13577.2,-1053.75"/>
</g>
<!-- tensor_reduce_e1_t1_p0 -->
<g id="node29" class="node">
<title>tensor_reduce_e1_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="13339" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="13339" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="13339" y="-921.91" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="13339" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13339" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t1_e0_p0&#45;&gt;tensor_reduce_e1_t1_p0 -->
<g id="edge40" class="edge">
<title>moe_e1_t1_e0_p0&#45;&gt;tensor_reduce_e1_t1_p0</title>
<path fill="none" stroke="black" d="M13339,-991.51C13339,-983.7 13339,-974.83 13339,-966.06"/>
<polygon fill="black" stroke="black" points="13342.5,-965.89 13339,-955.89 13335.5,-965.89 13342.5,-965.89"/>
</g>
<!-- moe_e1_t1_e1_p0&#45;&gt;tensor_reduce_e1_t1_p0 -->
<g id="edge41" class="edge">
<title>moe_e1_t1_e1_p0&#45;&gt;tensor_reduce_e1_t1_p0</title>
<path fill="none" stroke="black" d="M13533.93,-991.63C13503.31,-980.37 13466.67,-966.88 13433.46,-954.66"/>
<polygon fill="black" stroke="black" points="13434.32,-951.25 13423.73,-951.09 13431.91,-957.82 13434.32,-951.25"/>
</g>
<!-- tensor_reduce_e1_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge183" class="edge">
<title>tensor_reduce_e1_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M13219.08,-892.26C13166.01,-882.08 13102.67,-871.53 13045,-866.14 12603.34,-824.84 9457.39,-813.19 8646.36,-810.86"/>
<polygon fill="black" stroke="black" points="8646.35,-807.36 8636.34,-810.83 8646.33,-814.36 8646.35,-807.36"/>
</g>
<!-- attention_e1_t2_p0&#45;&gt;moe_e1_t2_e0_p0 -->
<g id="edge43" class="edge">
<title>attention_e1_t2_p0&#45;&gt;moe_e1_t2_e0_p0</title>
<path fill="none" stroke="black" d="M13868.53,-1079.34C13868.06,-1071.38 13867.54,-1062.44 13867.05,-1053.92"/>
<polygon fill="black" stroke="black" points="13870.54,-1053.61 13866.46,-1043.83 13863.55,-1054.02 13870.54,-1053.61"/>
</g>
<!-- attention_e1_t2_p0&#45;&gt;moe_e1_t2_e1_p0 -->
<g id="edge44" class="edge">
<title>attention_e1_t2_p0&#45;&gt;moe_e1_t2_e1_p0</title>
<path fill="none" stroke="black" d="M13945.32,-1079.57C13975.92,-1069.37 14011.42,-1057.54 14042.94,-1047.03"/>
<polygon fill="black" stroke="black" points="14044.21,-1050.3 14052.59,-1043.82 14041.99,-1043.66 14044.21,-1050.3"/>
</g>
<!-- tensor_reduce_e1_t2_p0 -->
<g id="node33" class="node">
<title>tensor_reduce_e1_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="13865" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="13865" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="13865" y="-921.91" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="13865" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13865" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t2_e0_p0&#45;&gt;tensor_reduce_e1_t2_p0 -->
<g id="edge45" class="edge">
<title>moe_e1_t2_e0_p0&#45;&gt;tensor_reduce_e1_t2_p0</title>
<path fill="none" stroke="black" d="M13865,-991.51C13865,-983.7 13865,-974.83 13865,-966.06"/>
<polygon fill="black" stroke="black" points="13868.5,-965.89 13865,-955.89 13861.5,-965.89 13868.5,-965.89"/>
</g>
<!-- moe_e1_t2_e1_p0&#45;&gt;tensor_reduce_e1_t2_p0 -->
<g id="edge46" class="edge">
<title>moe_e1_t2_e1_p0&#45;&gt;tensor_reduce_e1_t2_p0</title>
<path fill="none" stroke="black" d="M14059.93,-991.63C14029.31,-980.37 13992.67,-966.88 13959.46,-954.66"/>
<polygon fill="black" stroke="black" points="13960.32,-951.25 13949.73,-951.09 13957.91,-957.82 13960.32,-951.25"/>
</g>
<!-- tensor_reduce_e1_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge184" class="edge">
<title>tensor_reduce_e1_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M13736.44,-894.24C13672.01,-883.49 13592.64,-871.9 13521,-866.14 13029.31,-826.63 9508.78,-813.54 8646.34,-810.9"/>
<polygon fill="black" stroke="black" points="8646.32,-807.4 8636.31,-810.87 8646.3,-814.4 8646.32,-807.4"/>
</g>
<!-- attention_e1_t3_p0&#45;&gt;moe_e1_t3_e0_p0 -->
<g id="edge48" class="edge">
<title>attention_e1_t3_p0&#45;&gt;moe_e1_t3_e0_p0</title>
<path fill="none" stroke="black" d="M14281.96,-1079.57C14299.12,-1069.99 14318.86,-1058.96 14336.8,-1048.95"/>
<polygon fill="black" stroke="black" points="14338.96,-1051.75 14345.99,-1043.82 14335.55,-1045.64 14338.96,-1051.75"/>
</g>
<!-- attention_e1_t3_p0&#45;&gt;moe_e1_t3_e1_p0 -->
<g id="edge49" class="edge">
<title>attention_e1_t3_p0&#45;&gt;moe_e1_t3_e1_p0</title>
<path fill="none" stroke="black" d="M14358.45,-1079.63C14409.95,-1069.01 14470.09,-1056.61 14522.62,-1045.77"/>
<polygon fill="black" stroke="black" points="14523.59,-1049.15 14532.68,-1043.7 14522.18,-1042.29 14523.59,-1049.15"/>
</g>
<!-- tensor_reduce_e1_t3_p0 -->
<g id="node37" class="node">
<title>tensor_reduce_e1_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="14391" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="14391" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="14391" y="-921.91" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="14391" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14391" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t3_e0_p0&#45;&gt;tensor_reduce_e1_t3_p0 -->
<g id="edge50" class="edge">
<title>moe_e1_t3_e0_p0&#45;&gt;tensor_reduce_e1_t3_p0</title>
<path fill="none" stroke="black" d="M14391,-991.51C14391,-983.7 14391,-974.83 14391,-966.06"/>
<polygon fill="black" stroke="black" points="14394.5,-965.89 14391,-955.89 14387.5,-965.89 14394.5,-965.89"/>
</g>
<!-- moe_e1_t3_e1_p0&#45;&gt;tensor_reduce_e1_t3_p0 -->
<g id="edge51" class="edge">
<title>moe_e1_t3_e1_p0&#45;&gt;tensor_reduce_e1_t3_p0</title>
<path fill="none" stroke="black" d="M14585.93,-991.63C14555.31,-980.37 14518.67,-966.88 14485.46,-954.66"/>
<polygon fill="black" stroke="black" points="14486.32,-951.25 14475.73,-951.09 14483.91,-957.82 14486.32,-951.25"/>
</g>
<!-- tensor_reduce_e1_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge185" class="edge">
<title>tensor_reduce_e1_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M14262.44,-894.21C14198.01,-883.45 14118.64,-871.86 14047,-866.14 13500.48,-822.5 9564.16,-812.45 8646.76,-810.69"/>
<polygon fill="black" stroke="black" points="8646.44,-807.19 8636.44,-810.67 8646.43,-814.19 8646.44,-807.19"/>
</g>
<!-- gate_e2_p0 -->
<g id="node38" class="node">
<title>gate_e2_p0</title>
<polygon fill="lightyellow" stroke="black" points="11781.24,-1381.22 11360.89,-1381.22 11252.76,-1277.22 11673.11,-1277.22 11781.24,-1381.22"/>
<text text-anchor="middle" x="11517" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="11517" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
<text text-anchor="middle" x="11517" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="11517" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e2_p0 -->
<g id="node39" class="node">
<title>all2all_local_e2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="11419" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="11419" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="11419" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 8&#45;11</text>
<text text-anchor="middle" x="11419" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="11419" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e2_p0&#45;&gt;all2all_local_e2_p0 -->
<g id="edge52" class="edge">
<title>gate_e2_p0&#45;&gt;all2all_local_e2_p0</title>
<path fill="none" stroke="black" d="M11476.01,-1276.86C11468.54,-1267.51 11460.82,-1257.84 11453.57,-1248.75"/>
<polygon fill="black" stroke="black" points="11456.3,-1246.57 11447.33,-1240.94 11450.83,-1250.94 11456.3,-1246.57"/>
</g>
<!-- moe_e2_t0_e0_p0 -->
<g id="node41" class="node">
<title>moe_e2_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="10824.5,-1043.68 10579.5,-1043.68 10579.5,-991.68 10824.5,-991.68 10824.5,-1043.68"/>
<text text-anchor="middle" x="10702" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="10702" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="10702" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10702" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t0_e0_p0 -->
<g id="edge451" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11280.27,-1303.97C11156.49,-1288.74 11019.28,-1267.09 10963,-1241.22 10863.88,-1195.65 10772.96,-1101.34 10729.27,-1051.38"/>
<polygon fill="black" stroke="black" points="10731.86,-1049.02 10722.67,-1043.76 10726.57,-1053.61 10731.86,-1049.02"/>
</g>
<!-- moe_e2_t0_e1_p0 -->
<g id="node42" class="node">
<title>moe_e2_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="11087.5,-1043.68 10842.5,-1043.68 10842.5,-991.68 11087.5,-991.68 11087.5,-1043.68"/>
<text text-anchor="middle" x="10965" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="10965" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="10965" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10965" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t0_e1_p0 -->
<g id="edge453" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11268.28,-1277.14C11125.3,-1242.06 10966.07,-1191.16 10925,-1131.68 10908.36,-1107.58 10922.1,-1075.83 10937.85,-1052.12"/>
<polygon fill="black" stroke="black" points="10940.82,-1053.98 10943.69,-1043.78 10935.09,-1049.97 10940.82,-1053.98"/>
</g>
<!-- moe_e2_t1_e0_p0 -->
<g id="node45" class="node">
<title>moe_e2_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="11350.5,-1043.68 11105.5,-1043.68 11105.5,-991.68 11350.5,-991.68 11350.5,-1043.68"/>
<text text-anchor="middle" x="11228" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="11228" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="11228" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11228" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t1_e0_p0 -->
<g id="edge455" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11294.52,-1277.14C11265.87,-1266.48 11243,-1254.43 11233,-1241.22 11211.42,-1212.71 11218.43,-1109.11 11223.97,-1053.89"/>
<polygon fill="black" stroke="black" points="11227.46,-1054.16 11225.01,-1043.85 11220.5,-1053.44 11227.46,-1054.16"/>
</g>
<!-- moe_e2_t1_e1_p0 -->
<g id="node46" class="node">
<title>moe_e2_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="11613.5,-1043.68 11368.5,-1043.68 11368.5,-991.68 11613.5,-991.68 11613.5,-1043.68"/>
<text text-anchor="middle" x="11491" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="11491" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="11491" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11491" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t1_e1_p0 -->
<g id="edge457" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11581.44,-1277.21C11591.04,-1266.42 11599.54,-1254.3 11605,-1241.22 11617.59,-1211.06 11612.22,-1199.56 11605,-1167.68 11595.43,-1125.41 11589.45,-1114 11563,-1079.68 11554.87,-1069.13 11544.65,-1059.13 11534.48,-1050.4"/>
<polygon fill="black" stroke="black" points="11536.67,-1047.67 11526.74,-1043.97 11532.2,-1053.06 11536.67,-1047.67"/>
</g>
<!-- moe_e2_t2_e0_p0 -->
<g id="node49" class="node">
<title>moe_e2_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="11876.5,-1043.68 11631.5,-1043.68 11631.5,-991.68 11876.5,-991.68 11876.5,-1043.68"/>
<text text-anchor="middle" x="11754" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="11754" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="11754" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11754" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t2_e0_p0 -->
<g id="edge459" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11684.99,-1288.34C11767.34,-1259.41 11859.1,-1210.98 11908,-1131.68 11920.13,-1112.01 11920.99,-1098.79 11908,-1079.68 11899.32,-1066.9 11887.49,-1056.8 11874.23,-1048.81"/>
<polygon fill="black" stroke="black" points="11875.77,-1045.66 11865.33,-1043.86 11872.37,-1051.78 11875.77,-1045.66"/>
</g>
<!-- moe_e2_t2_e1_p0 -->
<g id="node50" class="node">
<title>moe_e2_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="12139.5,-1043.68 11894.5,-1043.68 11894.5,-991.68 12139.5,-991.68 12139.5,-1043.68"/>
<text text-anchor="middle" x="12017" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="12017" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="12017" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12017" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t2_e1_p0 -->
<g id="edge461" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11697.8,-1300.9C11746.64,-1287.99 11797.64,-1269.03 11840,-1241.22 11878.68,-1215.82 11955.63,-1108.28 11994.05,-1052.52"/>
<polygon fill="black" stroke="black" points="11997.1,-1054.26 11999.88,-1044.04 11991.33,-1050.3 11997.1,-1054.26"/>
</g>
<!-- moe_e2_t3_e0_p0 -->
<g id="node53" class="node">
<title>moe_e2_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="12402.5,-1043.68 12157.5,-1043.68 12157.5,-991.68 12402.5,-991.68 12402.5,-1043.68"/>
<text text-anchor="middle" x="12280" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="12280" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="12280" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12280" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t3_e0_p0 -->
<g id="edge463" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11701.96,-1304.74C11900.79,-1275.41 12198.09,-1218.28 12270,-1131.68 12287.72,-1110.33 12288.97,-1078.26 12286.51,-1053.73"/>
<polygon fill="black" stroke="black" points="12289.97,-1053.22 12285.26,-1043.73 12283.02,-1054.09 12289.97,-1053.22"/>
</g>
<!-- moe_e2_t3_e1_p0 -->
<g id="node54" class="node">
<title>moe_e2_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="12665.5,-1043.68 12420.5,-1043.68 12420.5,-991.68 12665.5,-991.68 12665.5,-1043.68"/>
<text text-anchor="middle" x="12543" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="12543" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="12543" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12543" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p0&#45;&gt;moe_e2_t3_e1_p0 -->
<g id="edge465" class="edge">
<title>gate_e2_p0&#45;&gt;moe_e2_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11715.65,-1317.94C11837.89,-1307.27 11996.39,-1285.53 12131,-1241.22 12274.03,-1194.14 12425.76,-1098.69 12498.73,-1049.51"/>
<polygon fill="black" stroke="black" points="12500.92,-1052.25 12507.23,-1043.75 12496.99,-1046.46 12500.92,-1052.25"/>
</g>
<!-- attention_e2_t0_p0 -->
<g id="node40" class="node">
<title>attention_e2_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="11204,-1131.68 10934,-1131.68 10934,-1079.68 11204,-1079.68 11204,-1131.68"/>
<text text-anchor="middle" x="11069" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11069" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="11069" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="11069" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p0&#45;&gt;attention_e2_t0_p0 -->
<g id="edge53" class="edge">
<title>all2all_local_e2_p0&#45;&gt;attention_e2_t0_p0</title>
<path fill="none" stroke="black" d="M11314.94,-1174.68C11268.94,-1161.96 11215.08,-1147.07 11169.5,-1134.47"/>
<polygon fill="black" stroke="black" points="11170.18,-1131.02 11159.61,-1131.73 11168.32,-1137.77 11170.18,-1131.02"/>
</g>
<!-- attention_e2_t1_p0 -->
<g id="node44" class="node">
<title>attention_e2_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="11554,-1131.68 11284,-1131.68 11284,-1079.68 11554,-1079.68 11554,-1131.68"/>
<text text-anchor="middle" x="11419" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11419" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="11419" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="11419" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p0&#45;&gt;attention_e2_t1_p0 -->
<g id="edge58" class="edge">
<title>all2all_local_e2_p0&#45;&gt;attention_e2_t1_p0</title>
<path fill="none" stroke="black" d="M11419,-1167.41C11419,-1159.1 11419,-1150.27 11419,-1141.99"/>
<polygon fill="black" stroke="black" points="11422.5,-1141.87 11419,-1131.87 11415.5,-1141.87 11422.5,-1141.87"/>
</g>
<!-- attention_e2_t2_p0 -->
<g id="node48" class="node">
<title>attention_e2_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="11899,-1131.68 11629,-1131.68 11629,-1079.68 11899,-1079.68 11899,-1131.68"/>
<text text-anchor="middle" x="11764" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11764" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="11764" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="11764" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p0&#45;&gt;attention_e2_t2_p0 -->
<g id="edge63" class="edge">
<title>all2all_local_e2_p0&#45;&gt;attention_e2_t2_p0</title>
<path fill="none" stroke="black" d="M11522.04,-1174.54C11567.27,-1161.86 11620.15,-1147.03 11664.91,-1134.47"/>
<polygon fill="black" stroke="black" points="11665.95,-1137.82 11674.63,-1131.75 11664.06,-1131.08 11665.95,-1137.82"/>
</g>
<!-- attention_e2_t3_p0 -->
<g id="node52" class="node">
<title>attention_e2_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="12261,-1131.68 11991,-1131.68 11991,-1079.68 12261,-1079.68 12261,-1131.68"/>
<text text-anchor="middle" x="12126" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12126" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="12126" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="12126" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p0&#45;&gt;attention_e2_t3_p0 -->
<g id="edge68" class="edge">
<title>all2all_local_e2_p0&#45;&gt;attention_e2_t3_p0</title>
<path fill="none" stroke="black" d="M11564.63,-1183.51C11686.32,-1166.86 11858.98,-1143.23 11980.6,-1126.58"/>
<polygon fill="black" stroke="black" points="11981.3,-1130.02 11990.73,-1125.19 11980.35,-1123.08 11981.3,-1130.02"/>
</g>
<!-- attention_e2_t0_p0&#45;&gt;moe_e2_t0_e0_p0 -->
<g id="edge54" class="edge">
<title>attention_e2_t0_p0&#45;&gt;moe_e2_t0_e0_p0</title>
<path fill="none" stroke="black" d="M10961.86,-1079.57C10917.02,-1069.06 10864.77,-1056.82 10818.93,-1046.08"/>
<polygon fill="black" stroke="black" points="10819.49,-1042.61 10808.95,-1043.74 10817.89,-1049.43 10819.49,-1042.61"/>
</g>
<!-- attention_e2_t0_p0&#45;&gt;moe_e2_t0_e1_p0 -->
<g id="edge55" class="edge">
<title>attention_e2_t0_p0&#45;&gt;moe_e2_t0_e1_p0</title>
<path fill="none" stroke="black" d="M11038.64,-1079.57C11027.63,-1070.47 11015.05,-1060.06 11003.43,-1050.46"/>
<polygon fill="black" stroke="black" points="11005.52,-1047.64 10995.58,-1043.96 11001.05,-1053.03 11005.52,-1047.64"/>
</g>
<!-- tensor_reduce_e2_t0_p0 -->
<g id="node43" class="node">
<title>tensor_reduce_e2_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="10752" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="10752" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="10752" y="-921.91" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="10752" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10752" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t0_e0_p0&#45;&gt;tensor_reduce_e2_t0_p0 -->
<g id="edge56" class="edge">
<title>moe_e2_t0_e0_p0&#45;&gt;tensor_reduce_e2_t0_p0</title>
<path fill="none" stroke="black" d="M10715.01,-991.51C10719.26,-983.27 10724.12,-973.87 10728.89,-964.64"/>
<polygon fill="black" stroke="black" points="10732.12,-966.01 10733.6,-955.52 10725.9,-962.8 10732.12,-966.01"/>
</g>
<!-- moe_e2_t0_e1_p0&#45;&gt;tensor_reduce_e2_t0_p0 -->
<g id="edge57" class="edge">
<title>moe_e2_t0_e1_p0&#45;&gt;tensor_reduce_e2_t0_p0</title>
<path fill="none" stroke="black" d="M10909.87,-991.63C10886.49,-981.01 10858.76,-968.41 10833.12,-956.76"/>
<polygon fill="black" stroke="black" points="10834.33,-953.47 10823.77,-952.52 10831.43,-959.84 10834.33,-953.47"/>
</g>
<!-- tensor_reduce_e2_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge186" class="edge">
<title>tensor_reduce_e2_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M10660.75,-887.57C10631.18,-879.03 10598,-870.81 10567,-866.14 10380.44,-838.01 9129.04,-819.06 8645.85,-812.71"/>
<polygon fill="black" stroke="black" points="8645.68,-809.21 8635.64,-812.58 8645.59,-816.21 8645.68,-809.21"/>
</g>
<!-- attention_e2_t1_p0&#45;&gt;moe_e2_t1_e0_p0 -->
<g id="edge59" class="edge">
<title>attention_e2_t1_p0&#45;&gt;moe_e2_t1_e0_p0</title>
<path fill="none" stroke="black" d="M11363.24,-1079.57C11341.27,-1069.68 11315.89,-1058.25 11293.09,-1047.99"/>
<polygon fill="black" stroke="black" points="11294.38,-1044.73 11283.83,-1043.82 11291.51,-1051.11 11294.38,-1044.73"/>
</g>
<!-- attention_e2_t1_p0&#45;&gt;moe_e2_t1_e1_p0 -->
<g id="edge60" class="edge">
<title>attention_e2_t1_p0&#45;&gt;moe_e2_t1_e1_p0</title>
<path fill="none" stroke="black" d="M11440.21,-1079.34C11447.46,-1070.68 11455.68,-1060.86 11463.36,-1051.69"/>
<polygon fill="black" stroke="black" points="11466.2,-1053.75 11469.94,-1043.83 11460.84,-1049.26 11466.2,-1053.75"/>
</g>
<!-- tensor_reduce_e2_t1_p0 -->
<g id="node47" class="node">
<title>tensor_reduce_e2_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="11228" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="11228" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="11228" y="-921.91" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="11228" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11228" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t1_e0_p0&#45;&gt;tensor_reduce_e2_t1_p0 -->
<g id="edge61" class="edge">
<title>moe_e2_t1_e0_p0&#45;&gt;tensor_reduce_e2_t1_p0</title>
<path fill="none" stroke="black" d="M11228,-991.51C11228,-983.7 11228,-974.83 11228,-966.06"/>
<polygon fill="black" stroke="black" points="11231.5,-965.89 11228,-955.89 11224.5,-965.89 11231.5,-965.89"/>
</g>
<!-- moe_e2_t1_e1_p0&#45;&gt;tensor_reduce_e2_t1_p0 -->
<g id="edge62" class="edge">
<title>moe_e2_t1_e1_p0&#45;&gt;tensor_reduce_e2_t1_p0</title>
<path fill="none" stroke="black" d="M11422.93,-991.63C11392.31,-980.37 11355.67,-966.88 11322.46,-954.66"/>
<polygon fill="black" stroke="black" points="11323.32,-951.25 11312.73,-951.09 11320.91,-957.82 11323.32,-951.25"/>
</g>
<!-- tensor_reduce_e2_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge187" class="edge">
<title>tensor_reduce_e2_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M11107.34,-892.4C11054.41,-882.32 10991.38,-871.8 10934,-866.14 10491.28,-822.43 9147.22,-812.95 8646.6,-810.91"/>
<polygon fill="black" stroke="black" points="8646.39,-807.41 8636.38,-810.87 8646.36,-814.41 8646.39,-807.41"/>
</g>
<!-- attention_e2_t2_p0&#45;&gt;moe_e2_t2_e0_p0 -->
<g id="edge64" class="edge">
<title>attention_e2_t2_p0&#45;&gt;moe_e2_t2_e0_p0</title>
<path fill="none" stroke="black" d="M11761.05,-1079.34C11760.13,-1071.38 11759.09,-1062.44 11758.1,-1053.92"/>
<polygon fill="black" stroke="black" points="11761.56,-1053.36 11756.93,-1043.83 11754.6,-1054.17 11761.56,-1053.36"/>
</g>
<!-- attention_e2_t2_p0&#45;&gt;moe_e2_t2_e1_p0 -->
<g id="edge65" class="edge">
<title>attention_e2_t2_p0&#45;&gt;moe_e2_t2_e1_p0</title>
<path fill="none" stroke="black" d="M11837.86,-1079.57C11867.73,-1069.42 11902.38,-1057.64 11933.19,-1047.17"/>
<polygon fill="black" stroke="black" points="11934.71,-1050.35 11943.05,-1043.82 11932.46,-1043.72 11934.71,-1050.35"/>
</g>
<!-- tensor_reduce_e2_t2_p0 -->
<g id="node51" class="node">
<title>tensor_reduce_e2_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="11754" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="11754" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="11754" y="-921.91" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="11754" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11754" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t2_e0_p0&#45;&gt;tensor_reduce_e2_t2_p0 -->
<g id="edge66" class="edge">
<title>moe_e2_t2_e0_p0&#45;&gt;tensor_reduce_e2_t2_p0</title>
<path fill="none" stroke="black" d="M11754,-991.51C11754,-983.7 11754,-974.83 11754,-966.06"/>
<polygon fill="black" stroke="black" points="11757.5,-965.89 11754,-955.89 11750.5,-965.89 11757.5,-965.89"/>
</g>
<!-- moe_e2_t2_e1_p0&#45;&gt;tensor_reduce_e2_t2_p0 -->
<g id="edge67" class="edge">
<title>moe_e2_t2_e1_p0&#45;&gt;tensor_reduce_e2_t2_p0</title>
<path fill="none" stroke="black" d="M11948.93,-991.63C11918.31,-980.37 11881.67,-966.88 11848.46,-954.66"/>
<polygon fill="black" stroke="black" points="11849.32,-951.25 11838.73,-951.09 11846.91,-957.82 11849.32,-951.25"/>
</g>
<!-- tensor_reduce_e2_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge188" class="edge">
<title>tensor_reduce_e2_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M11624.61,-894.35C11560.32,-883.69 11481.31,-872.15 11410,-866.14 10870.4,-820.64 9211.45,-812.26 8646.62,-810.72"/>
<polygon fill="black" stroke="black" points="8646.35,-807.21 8636.34,-810.69 8646.33,-814.21 8646.35,-807.21"/>
</g>
<!-- attention_e2_t3_p0&#45;&gt;moe_e2_t3_e0_p0 -->
<g id="edge69" class="edge">
<title>attention_e2_t3_p0&#45;&gt;moe_e2_t3_e0_p0</title>
<path fill="none" stroke="black" d="M12170.96,-1079.57C12188.12,-1069.99 12207.86,-1058.96 12225.8,-1048.95"/>
<polygon fill="black" stroke="black" points="12227.96,-1051.75 12234.99,-1043.82 12224.55,-1045.64 12227.96,-1051.75"/>
</g>
<!-- attention_e2_t3_p0&#45;&gt;moe_e2_t3_e1_p0 -->
<g id="edge70" class="edge">
<title>attention_e2_t3_p0&#45;&gt;moe_e2_t3_e1_p0</title>
<path fill="none" stroke="black" d="M12247.45,-1079.63C12298.95,-1069.01 12359.09,-1056.61 12411.62,-1045.77"/>
<polygon fill="black" stroke="black" points="12412.59,-1049.15 12421.68,-1043.7 12411.18,-1042.29 12412.59,-1049.15"/>
</g>
<!-- tensor_reduce_e2_t3_p0 -->
<g id="node55" class="node">
<title>tensor_reduce_e2_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="12280" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="12280" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="12280" y="-921.91" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="12280" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12280" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t3_e0_p0&#45;&gt;tensor_reduce_e2_t3_p0 -->
<g id="edge71" class="edge">
<title>moe_e2_t3_e0_p0&#45;&gt;tensor_reduce_e2_t3_p0</title>
<path fill="none" stroke="black" d="M12280,-991.51C12280,-983.7 12280,-974.83 12280,-966.06"/>
<polygon fill="black" stroke="black" points="12283.5,-965.89 12280,-955.89 12276.5,-965.89 12283.5,-965.89"/>
</g>
<!-- moe_e2_t3_e1_p0&#45;&gt;tensor_reduce_e2_t3_p0 -->
<g id="edge72" class="edge">
<title>moe_e2_t3_e1_p0&#45;&gt;tensor_reduce_e2_t3_p0</title>
<path fill="none" stroke="black" d="M12474.93,-991.63C12444.31,-980.37 12407.67,-966.88 12374.46,-954.66"/>
<polygon fill="black" stroke="black" points="12375.32,-951.25 12364.73,-951.09 12372.91,-957.82 12375.32,-951.25"/>
</g>
<!-- tensor_reduce_e2_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge189" class="edge">
<title>tensor_reduce_e2_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M12151.02,-894.33C12086.66,-883.63 12007.47,-872.06 11936,-866.14 11289.05,-812.51 9276.49,-809.62 8646.52,-810.07"/>
<polygon fill="black" stroke="black" points="8646.43,-806.57 8636.43,-810.08 8646.43,-813.57 8646.43,-806.57"/>
</g>
<!-- gate_e3_p0 -->
<g id="node56" class="node">
<title>gate_e3_p0</title>
<polygon fill="lightyellow" stroke="black" points="9670.24,-1381.22 9249.89,-1381.22 9141.76,-1277.22 9562.11,-1277.22 9670.24,-1381.22"/>
<text text-anchor="middle" x="9406" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="9406" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 12&#45;15</text>
<text text-anchor="middle" x="9406" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="9406" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e3_p0 -->
<g id="node57" class="node">
<title>all2all_local_e3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="9308" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="9308" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="9308" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 12&#45;15</text>
<text text-anchor="middle" x="9308" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="9308" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e3_p0&#45;&gt;all2all_local_e3_p0 -->
<g id="edge73" class="edge">
<title>gate_e3_p0&#45;&gt;all2all_local_e3_p0</title>
<path fill="none" stroke="black" d="M9365.01,-1276.86C9357.54,-1267.51 9349.82,-1257.84 9342.57,-1248.75"/>
<polygon fill="black" stroke="black" points="9345.3,-1246.57 9336.33,-1240.94 9339.83,-1250.94 9345.3,-1246.57"/>
</g>
<!-- moe_e3_t0_e0_p0 -->
<g id="node59" class="node">
<title>moe_e3_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="8713.5,-1043.68 8468.5,-1043.68 8468.5,-991.68 8713.5,-991.68 8713.5,-1043.68"/>
<text text-anchor="middle" x="8591" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="8591" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="8591" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8591" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t0_e0_p0 -->
<g id="edge467" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9169.27,-1303.97C9045.49,-1288.74 8908.28,-1267.09 8852,-1241.22 8752.88,-1195.65 8661.96,-1101.34 8618.27,-1051.38"/>
<polygon fill="black" stroke="black" points="8620.86,-1049.02 8611.67,-1043.76 8615.57,-1053.61 8620.86,-1049.02"/>
</g>
<!-- moe_e3_t0_e1_p0 -->
<g id="node60" class="node">
<title>moe_e3_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="8976.5,-1043.68 8731.5,-1043.68 8731.5,-991.68 8976.5,-991.68 8976.5,-1043.68"/>
<text text-anchor="middle" x="8854" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="8854" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="8854" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8854" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t0_e1_p0 -->
<g id="edge469" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9157.28,-1277.14C9014.3,-1242.06 8855.07,-1191.16 8814,-1131.68 8797.36,-1107.58 8811.1,-1075.83 8826.85,-1052.12"/>
<polygon fill="black" stroke="black" points="8829.82,-1053.98 8832.69,-1043.78 8824.09,-1049.97 8829.82,-1053.98"/>
</g>
<!-- moe_e3_t1_e0_p0 -->
<g id="node63" class="node">
<title>moe_e3_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="9239.5,-1043.68 8994.5,-1043.68 8994.5,-991.68 9239.5,-991.68 9239.5,-1043.68"/>
<text text-anchor="middle" x="9117" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="9117" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="9117" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9117" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t1_e0_p0 -->
<g id="edge471" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9183.52,-1277.14C9154.87,-1266.48 9132,-1254.43 9122,-1241.22 9100.42,-1212.71 9107.43,-1109.11 9112.97,-1053.89"/>
<polygon fill="black" stroke="black" points="9116.46,-1054.16 9114.01,-1043.85 9109.5,-1053.44 9116.46,-1054.16"/>
</g>
<!-- moe_e3_t1_e1_p0 -->
<g id="node64" class="node">
<title>moe_e3_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="9502.5,-1043.68 9257.5,-1043.68 9257.5,-991.68 9502.5,-991.68 9502.5,-1043.68"/>
<text text-anchor="middle" x="9380" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="9380" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="9380" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9380" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t1_e1_p0 -->
<g id="edge473" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9470.44,-1277.21C9480.04,-1266.42 9488.54,-1254.3 9494,-1241.22 9506.59,-1211.06 9501.22,-1199.56 9494,-1167.68 9484.43,-1125.41 9478.45,-1114 9452,-1079.68 9443.87,-1069.13 9433.65,-1059.13 9423.48,-1050.4"/>
<polygon fill="black" stroke="black" points="9425.67,-1047.67 9415.74,-1043.97 9421.2,-1053.06 9425.67,-1047.67"/>
</g>
<!-- moe_e3_t2_e0_p0 -->
<g id="node67" class="node">
<title>moe_e3_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="9765.5,-1043.68 9520.5,-1043.68 9520.5,-991.68 9765.5,-991.68 9765.5,-1043.68"/>
<text text-anchor="middle" x="9643" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="9643" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="9643" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9643" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t2_e0_p0 -->
<g id="edge475" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9573.15,-1287.34C9654.14,-1258.2 9744.05,-1209.9 9792,-1131.68 9804.08,-1111.97 9804.88,-1098.87 9792,-1079.68 9783.37,-1066.83 9771.51,-1056.68 9758.21,-1048.67"/>
<polygon fill="black" stroke="black" points="9759.72,-1045.51 9749.28,-1043.71 9756.32,-1051.63 9759.72,-1045.51"/>
</g>
<!-- moe_e3_t2_e1_p0 -->
<g id="node68" class="node">
<title>moe_e3_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="10028.5,-1043.68 9783.5,-1043.68 9783.5,-991.68 10028.5,-991.68 10028.5,-1043.68"/>
<text text-anchor="middle" x="9906" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="9906" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="9906" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9906" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t2_e1_p0 -->
<g id="edge477" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9586.04,-1299.82C9633.76,-1286.92 9683.51,-1268.23 9725,-1241.22 9764.12,-1215.75 9843.01,-1108.24 9882.44,-1052.51"/>
<polygon fill="black" stroke="black" points="9885.52,-1054.22 9888.42,-1044.03 9879.8,-1050.18 9885.52,-1054.22"/>
</g>
<!-- moe_e3_t3_e0_p0 -->
<g id="node71" class="node">
<title>moe_e3_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="10291.5,-1043.68 10046.5,-1043.68 10046.5,-991.68 10291.5,-991.68 10291.5,-1043.68"/>
<text text-anchor="middle" x="10169" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="10169" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="10169" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10169" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t3_e0_p0 -->
<g id="edge479" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9590.92,-1304.71C9789.71,-1275.34 10086.98,-1218.18 10159,-1131.68 10176.75,-1110.36 10177.99,-1078.28 10175.52,-1053.75"/>
<polygon fill="black" stroke="black" points="10178.99,-1053.23 10174.27,-1043.75 10172.04,-1054.1 10178.99,-1053.23"/>
</g>
<!-- moe_e3_t3_e1_p0 -->
<g id="node72" class="node">
<title>moe_e3_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="10554.5,-1043.68 10309.5,-1043.68 10309.5,-991.68 10554.5,-991.68 10554.5,-1043.68"/>
<text text-anchor="middle" x="10432" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="10432" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="10432" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10432" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p0&#45;&gt;moe_e3_t3_e1_p0 -->
<g id="edge481" class="edge">
<title>gate_e3_p0&#45;&gt;moe_e3_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9604.65,-1317.94C9726.89,-1307.27 9885.39,-1285.53 10020,-1241.22 10163.03,-1194.14 10314.76,-1098.69 10387.73,-1049.51"/>
<polygon fill="black" stroke="black" points="10389.92,-1052.25 10396.23,-1043.75 10385.99,-1046.46 10389.92,-1052.25"/>
</g>
<!-- attention_e3_t0_p0 -->
<g id="node58" class="node">
<title>attention_e3_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="9093,-1131.68 8823,-1131.68 8823,-1079.68 9093,-1079.68 9093,-1131.68"/>
<text text-anchor="middle" x="8958" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="8958" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="8958" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="8958" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p0&#45;&gt;attention_e3_t0_p0 -->
<g id="edge74" class="edge">
<title>all2all_local_e3_p0&#45;&gt;attention_e3_t0_p0</title>
<path fill="none" stroke="black" d="M9203.94,-1174.68C9157.94,-1161.96 9104.08,-1147.07 9058.5,-1134.47"/>
<polygon fill="black" stroke="black" points="9059.18,-1131.02 9048.61,-1131.73 9057.32,-1137.77 9059.18,-1131.02"/>
</g>
<!-- attention_e3_t1_p0 -->
<g id="node62" class="node">
<title>attention_e3_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="9443,-1131.68 9173,-1131.68 9173,-1079.68 9443,-1079.68 9443,-1131.68"/>
<text text-anchor="middle" x="9308" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9308" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="9308" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9308" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p0&#45;&gt;attention_e3_t1_p0 -->
<g id="edge79" class="edge">
<title>all2all_local_e3_p0&#45;&gt;attention_e3_t1_p0</title>
<path fill="none" stroke="black" d="M9308,-1167.41C9308,-1159.1 9308,-1150.27 9308,-1141.99"/>
<polygon fill="black" stroke="black" points="9311.5,-1141.87 9308,-1131.87 9304.5,-1141.87 9311.5,-1141.87"/>
</g>
<!-- attention_e3_t2_p0 -->
<g id="node66" class="node">
<title>attention_e3_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="9783,-1131.68 9513,-1131.68 9513,-1079.68 9783,-1079.68 9783,-1131.68"/>
<text text-anchor="middle" x="9648" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9648" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="9648" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9648" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p0&#45;&gt;attention_e3_t2_p0 -->
<g id="edge84" class="edge">
<title>all2all_local_e3_p0&#45;&gt;attention_e3_t2_p0</title>
<path fill="none" stroke="black" d="M9410.01,-1174.41C9454.47,-1161.76 9506.36,-1146.99 9550.33,-1134.48"/>
<polygon fill="black" stroke="black" points="9551.5,-1137.78 9560.16,-1131.68 9549.58,-1131.05 9551.5,-1137.78"/>
</g>
<!-- attention_e3_t3_p0 -->
<g id="node70" class="node">
<title>attention_e3_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="10150,-1131.68 9880,-1131.68 9880,-1079.68 10150,-1079.68 10150,-1131.68"/>
<text text-anchor="middle" x="10015" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10015" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="10015" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="10015" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p0&#45;&gt;attention_e3_t3_p0 -->
<g id="edge89" class="edge">
<title>all2all_local_e3_p0&#45;&gt;attention_e3_t3_p0</title>
<path fill="none" stroke="black" d="M9453.63,-1183.51C9575.32,-1166.86 9747.98,-1143.23 9869.6,-1126.58"/>
<polygon fill="black" stroke="black" points="9870.3,-1130.02 9879.73,-1125.19 9869.35,-1123.08 9870.3,-1130.02"/>
</g>
<!-- attention_e3_t0_p0&#45;&gt;moe_e3_t0_e0_p0 -->
<g id="edge75" class="edge">
<title>attention_e3_t0_p0&#45;&gt;moe_e3_t0_e0_p0</title>
<path fill="none" stroke="black" d="M8850.86,-1079.57C8806.02,-1069.06 8753.77,-1056.82 8707.93,-1046.08"/>
<polygon fill="black" stroke="black" points="8708.49,-1042.61 8697.95,-1043.74 8706.89,-1049.43 8708.49,-1042.61"/>
</g>
<!-- attention_e3_t0_p0&#45;&gt;moe_e3_t0_e1_p0 -->
<g id="edge76" class="edge">
<title>attention_e3_t0_p0&#45;&gt;moe_e3_t0_e1_p0</title>
<path fill="none" stroke="black" d="M8927.64,-1079.57C8916.63,-1070.47 8904.05,-1060.06 8892.43,-1050.46"/>
<polygon fill="black" stroke="black" points="8894.52,-1047.64 8884.58,-1043.96 8890.05,-1053.03 8894.52,-1047.64"/>
</g>
<!-- tensor_reduce_e3_t0_p0 -->
<g id="node61" class="node">
<title>tensor_reduce_e3_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="8641" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="8641" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="8641" y="-921.91" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="8641" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8641" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t0_e0_p0&#45;&gt;tensor_reduce_e3_t0_p0 -->
<g id="edge77" class="edge">
<title>moe_e3_t0_e0_p0&#45;&gt;tensor_reduce_e3_t0_p0</title>
<path fill="none" stroke="black" d="M8604.01,-991.51C8608.26,-983.27 8613.12,-973.87 8617.89,-964.64"/>
<polygon fill="black" stroke="black" points="8621.12,-966.01 8622.6,-955.52 8614.9,-962.8 8621.12,-966.01"/>
</g>
<!-- moe_e3_t0_e1_p0&#45;&gt;tensor_reduce_e3_t0_p0 -->
<g id="edge78" class="edge">
<title>moe_e3_t0_e1_p0&#45;&gt;tensor_reduce_e3_t0_p0</title>
<path fill="none" stroke="black" d="M8798.87,-991.63C8775.49,-981.01 8747.76,-968.41 8722.12,-956.76"/>
<polygon fill="black" stroke="black" points="8723.33,-953.47 8712.77,-952.52 8720.43,-959.84 8723.33,-953.47"/>
</g>
<!-- tensor_reduce_e3_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge190" class="edge">
<title>tensor_reduce_e3_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M8582.97,-884.18C8564.04,-873.17 8542.87,-860.86 8523.31,-849.5"/>
<polygon fill="black" stroke="black" points="8524.86,-846.35 8514.46,-844.35 8521.34,-852.4 8524.86,-846.35"/>
</g>
<!-- attention_e3_t1_p0&#45;&gt;moe_e3_t1_e0_p0 -->
<g id="edge80" class="edge">
<title>attention_e3_t1_p0&#45;&gt;moe_e3_t1_e0_p0</title>
<path fill="none" stroke="black" d="M9252.24,-1079.57C9230.27,-1069.68 9204.89,-1058.25 9182.09,-1047.99"/>
<polygon fill="black" stroke="black" points="9183.38,-1044.73 9172.83,-1043.82 9180.51,-1051.11 9183.38,-1044.73"/>
</g>
<!-- attention_e3_t1_p0&#45;&gt;moe_e3_t1_e1_p0 -->
<g id="edge81" class="edge">
<title>attention_e3_t1_p0&#45;&gt;moe_e3_t1_e1_p0</title>
<path fill="none" stroke="black" d="M9329.21,-1079.34C9336.46,-1070.68 9344.68,-1060.86 9352.36,-1051.69"/>
<polygon fill="black" stroke="black" points="9355.2,-1053.75 9358.94,-1043.83 9349.84,-1049.26 9355.2,-1053.75"/>
</g>
<!-- tensor_reduce_e3_t1_p0 -->
<g id="node65" class="node">
<title>tensor_reduce_e3_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="9117" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="9117" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="9117" y="-921.91" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="9117" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9117" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t1_e0_p0&#45;&gt;tensor_reduce_e3_t1_p0 -->
<g id="edge82" class="edge">
<title>moe_e3_t1_e0_p0&#45;&gt;tensor_reduce_e3_t1_p0</title>
<path fill="none" stroke="black" d="M9117,-991.51C9117,-983.7 9117,-974.83 9117,-966.06"/>
<polygon fill="black" stroke="black" points="9120.5,-965.89 9117,-955.89 9113.5,-965.89 9120.5,-965.89"/>
</g>
<!-- moe_e3_t1_e1_p0&#45;&gt;tensor_reduce_e3_t1_p0 -->
<g id="edge83" class="edge">
<title>moe_e3_t1_e1_p0&#45;&gt;tensor_reduce_e3_t1_p0</title>
<path fill="none" stroke="black" d="M9311.93,-991.63C9281.31,-980.37 9244.67,-966.88 9211.46,-954.66"/>
<polygon fill="black" stroke="black" points="9212.32,-951.25 9201.73,-951.09 9209.91,-957.82 9212.32,-951.25"/>
</g>
<!-- tensor_reduce_e3_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge191" class="edge">
<title>tensor_reduce_e3_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M8987.58,-894.44C8936.37,-885.34 8876.96,-874.99 8823,-866.14 8753.28,-854.71 8675.98,-842.84 8610.37,-833"/>
<polygon fill="black" stroke="black" points="8610.77,-829.52 8600.36,-831.51 8609.73,-836.45 8610.77,-829.52"/>
</g>
<!-- attention_e3_t2_p0&#45;&gt;moe_e3_t2_e0_p0 -->
<g id="edge85" class="edge">
<title>attention_e3_t2_p0&#45;&gt;moe_e3_t2_e0_p0</title>
<path fill="none" stroke="black" d="M9646.53,-1079.34C9646.06,-1071.38 9645.54,-1062.44 9645.05,-1053.92"/>
<polygon fill="black" stroke="black" points="9648.54,-1053.61 9644.46,-1043.83 9641.55,-1054.02 9648.54,-1053.61"/>
</g>
<!-- attention_e3_t2_p0&#45;&gt;moe_e3_t2_e1_p0 -->
<g id="edge86" class="edge">
<title>attention_e3_t2_p0&#45;&gt;moe_e3_t2_e1_p0</title>
<path fill="none" stroke="black" d="M9723.32,-1079.57C9753.92,-1069.37 9789.42,-1057.54 9820.94,-1047.03"/>
<polygon fill="black" stroke="black" points="9822.21,-1050.3 9830.59,-1043.82 9819.99,-1043.66 9822.21,-1050.3"/>
</g>
<!-- tensor_reduce_e3_t2_p0 -->
<g id="node69" class="node">
<title>tensor_reduce_e3_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="9643" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="9643" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="9643" y="-921.91" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="9643" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9643" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t2_e0_p0&#45;&gt;tensor_reduce_e3_t2_p0 -->
<g id="edge87" class="edge">
<title>moe_e3_t2_e0_p0&#45;&gt;tensor_reduce_e3_t2_p0</title>
<path fill="none" stroke="black" d="M9643,-991.51C9643,-983.7 9643,-974.83 9643,-966.06"/>
<polygon fill="black" stroke="black" points="9646.5,-965.89 9643,-955.89 9639.5,-965.89 9646.5,-965.89"/>
</g>
<!-- moe_e3_t2_e1_p0&#45;&gt;tensor_reduce_e3_t2_p0 -->
<g id="edge88" class="edge">
<title>moe_e3_t2_e1_p0&#45;&gt;tensor_reduce_e3_t2_p0</title>
<path fill="none" stroke="black" d="M9837.93,-991.63C9807.31,-980.37 9770.67,-966.88 9737.46,-954.66"/>
<polygon fill="black" stroke="black" points="9738.32,-951.25 9727.73,-951.09 9735.91,-957.82 9738.32,-951.25"/>
</g>
<!-- tensor_reduce_e3_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge192" class="edge">
<title>tensor_reduce_e3_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M9510.2,-895.28C9446.48,-885.1 9368.95,-873.7 9299,-866.14 9073.63,-841.77 8813.14,-826.5 8642.07,-818.22"/>
<polygon fill="black" stroke="black" points="8642.11,-814.72 8631.95,-817.74 8641.77,-821.71 8642.11,-814.72"/>
</g>
<!-- attention_e3_t3_p0&#45;&gt;moe_e3_t3_e0_p0 -->
<g id="edge90" class="edge">
<title>attention_e3_t3_p0&#45;&gt;moe_e3_t3_e0_p0</title>
<path fill="none" stroke="black" d="M10059.96,-1079.57C10077.12,-1069.99 10096.86,-1058.96 10114.8,-1048.95"/>
<polygon fill="black" stroke="black" points="10116.96,-1051.75 10123.99,-1043.82 10113.55,-1045.64 10116.96,-1051.75"/>
</g>
<!-- attention_e3_t3_p0&#45;&gt;moe_e3_t3_e1_p0 -->
<g id="edge91" class="edge">
<title>attention_e3_t3_p0&#45;&gt;moe_e3_t3_e1_p0</title>
<path fill="none" stroke="black" d="M10136.45,-1079.63C10187.95,-1069.01 10248.09,-1056.61 10300.62,-1045.77"/>
<polygon fill="black" stroke="black" points="10301.59,-1049.15 10310.68,-1043.7 10300.18,-1042.29 10301.59,-1049.15"/>
</g>
<!-- tensor_reduce_e3_t3_p0 -->
<g id="node73" class="node">
<title>tensor_reduce_e3_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="10169" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="10169" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="10169" y="-921.91" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="10169" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10169" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t3_e0_p0&#45;&gt;tensor_reduce_e3_t3_p0 -->
<g id="edge92" class="edge">
<title>moe_e3_t3_e0_p0&#45;&gt;tensor_reduce_e3_t3_p0</title>
<path fill="none" stroke="black" d="M10169,-991.51C10169,-983.7 10169,-974.83 10169,-966.06"/>
<polygon fill="black" stroke="black" points="10172.5,-965.89 10169,-955.89 10165.5,-965.89 10172.5,-965.89"/>
</g>
<!-- moe_e3_t3_e1_p0&#45;&gt;tensor_reduce_e3_t3_p0 -->
<g id="edge93" class="edge">
<title>moe_e3_t3_e1_p0&#45;&gt;tensor_reduce_e3_t3_p0</title>
<path fill="none" stroke="black" d="M10363.93,-991.63C10333.31,-980.37 10296.67,-966.88 10263.46,-954.66"/>
<polygon fill="black" stroke="black" points="10264.32,-951.25 10253.73,-951.09 10261.91,-957.82 10264.32,-951.25"/>
</g>
<!-- tensor_reduce_e3_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge193" class="edge">
<title>tensor_reduce_e3_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M10037.92,-894.76C9973.91,-884.33 9895.64,-872.87 9825,-866.14 9405.49,-826.15 8910.99,-814.8 8646.19,-811.6"/>
<polygon fill="black" stroke="black" points="8646.13,-808.1 8636.09,-811.48 8646.05,-815.1 8646.13,-808.1"/>
</g>
<!-- gate_e4_p0 -->
<g id="node74" class="node">
<title>gate_e4_p0</title>
<polygon fill="lightyellow" stroke="black" points="7815.24,-1381.22 7394.89,-1381.22 7286.76,-1277.22 7707.11,-1277.22 7815.24,-1381.22"/>
<text text-anchor="middle" x="7551" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="7551" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 16&#45;19</text>
<text text-anchor="middle" x="7551" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="7551" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e4_p0 -->
<g id="node75" class="node">
<title>all2all_local_e4_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="7208" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="7208" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="7208" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 16&#45;19</text>
<text text-anchor="middle" x="7208" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="7208" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e4_p0&#45;&gt;all2all_local_e4_p0 -->
<g id="edge94" class="edge">
<title>gate_e4_p0&#45;&gt;all2all_local_e4_p0</title>
<path fill="none" stroke="black" d="M7408.02,-1277.04C7373.2,-1264.58 7336.77,-1251.54 7304.69,-1240.06"/>
<polygon fill="black" stroke="black" points="7305.47,-1236.62 7294.88,-1236.54 7303.11,-1243.21 7305.47,-1236.62"/>
</g>
<!-- moe_e4_t0_e0_p0 -->
<g id="node77" class="node">
<title>moe_e4_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="6602.5,-1043.68 6357.5,-1043.68 6357.5,-991.68 6602.5,-991.68 6602.5,-1043.68"/>
<text text-anchor="middle" x="6480" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="6480" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="6480" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6480" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t0_e0_p0 -->
<g id="edge483" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7329.2,-1318.35C7129.09,-1306.88 6851.11,-1283.82 6750,-1241.22 6647.18,-1197.9 6552.91,-1102.18 6507.86,-1051.56"/>
<polygon fill="black" stroke="black" points="6510.29,-1049.02 6501.05,-1043.83 6505.04,-1053.65 6510.29,-1049.02"/>
</g>
<!-- moe_e4_t0_e1_p0 -->
<g id="node78" class="node">
<title>moe_e4_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="6865.5,-1043.68 6620.5,-1043.68 6620.5,-991.68 6865.5,-991.68 6865.5,-1043.68"/>
<text text-anchor="middle" x="6743" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="6743" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="6743" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6743" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t0_e1_p0 -->
<g id="edge485" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7318.49,-1307.87C7095.32,-1282.66 6782.33,-1230.41 6714,-1131.68 6697.85,-1108.35 6708.06,-1076.71 6720.62,-1052.84"/>
<polygon fill="black" stroke="black" points="6723.68,-1054.55 6725.5,-1044.11 6717.57,-1051.13 6723.68,-1054.55"/>
</g>
<!-- moe_e4_t1_e0_p0 -->
<g id="node81" class="node">
<title>moe_e4_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="7128.5,-1043.68 6883.5,-1043.68 6883.5,-991.68 7128.5,-991.68 7128.5,-1043.68"/>
<text text-anchor="middle" x="7006" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="7006" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="7006" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7006" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t1_e0_p0 -->
<g id="edge487" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7329.82,-1318.84C7204.08,-1308.51 7063.61,-1286.8 7022,-1241.22 7009.68,-1227.72 7006.83,-1113.24 7006.18,-1053.96"/>
<polygon fill="black" stroke="black" points="7009.68,-1053.88 7006.09,-1043.91 7002.68,-1053.94 7009.68,-1053.88"/>
</g>
<!-- moe_e4_t1_e1_p0 -->
<g id="node82" class="node">
<title>moe_e4_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="7391.5,-1043.68 7146.5,-1043.68 7146.5,-991.68 7391.5,-991.68 7391.5,-1043.68"/>
<text text-anchor="middle" x="7269" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="7269" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="7269" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7269" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t1_e1_p0 -->
<g id="edge489" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7512.48,-1276.95C7465.02,-1214.35 7386.45,-1112.73 7352,-1079.68 7340.99,-1069.12 7328.1,-1058.82 7315.81,-1049.78"/>
<polygon fill="black" stroke="black" points="7317.58,-1046.75 7307.42,-1043.74 7313.49,-1052.43 7317.58,-1046.75"/>
</g>
<!-- moe_e4_t2_e0_p0 -->
<g id="node85" class="node">
<title>moe_e4_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="7654.5,-1043.68 7409.5,-1043.68 7409.5,-991.68 7654.5,-991.68 7654.5,-1043.68"/>
<text text-anchor="middle" x="7532" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="7532" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="7532" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7532" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t2_e0_p0 -->
<g id="edge491" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7613.48,-1277.07C7668.54,-1225.64 7733.6,-1144.85 7689,-1079.68 7680.19,-1066.81 7668.25,-1056.66 7654.85,-1048.64"/>
<polygon fill="black" stroke="black" points="7656.3,-1045.45 7645.85,-1043.68 7652.92,-1051.58 7656.3,-1045.45"/>
</g>
<!-- moe_e4_t2_e1_p0 -->
<g id="node86" class="node">
<title>moe_e4_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="7917.5,-1043.68 7672.5,-1043.68 7672.5,-991.68 7917.5,-991.68 7917.5,-1043.68"/>
<text text-anchor="middle" x="7795" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="7795" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="7795" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7795" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t2_e1_p0 -->
<g id="edge493" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7637.39,-1277.12C7651.65,-1266.39 7665.51,-1254.3 7677,-1241.22 7730.26,-1180.56 7721.46,-1150.6 7760,-1079.68 7764.8,-1070.84 7770.14,-1061.37 7775.17,-1052.6"/>
<polygon fill="black" stroke="black" points="7778.3,-1054.17 7780.26,-1043.76 7772.24,-1050.67 7778.3,-1054.17"/>
</g>
<!-- moe_e4_t3_e0_p0 -->
<g id="node89" class="node">
<title>moe_e4_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="8180.5,-1043.68 7935.5,-1043.68 7935.5,-991.68 8180.5,-991.68 8180.5,-1043.68"/>
<text text-anchor="middle" x="8058" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="8058" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="8058" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8058" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t3_e0_p0 -->
<g id="edge495" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7735.05,-1303.91C7843.9,-1279.39 7974.46,-1230.2 8048,-1131.68 8064.42,-1109.68 8065.92,-1078.14 8063.89,-1053.97"/>
<polygon fill="black" stroke="black" points="8067.34,-1053.35 8062.79,-1043.78 8060.38,-1054.1 8067.34,-1053.35"/>
</g>
<!-- moe_e4_t3_e1_p0 -->
<g id="node90" class="node">
<title>moe_e4_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="8443.5,-1043.68 8198.5,-1043.68 8198.5,-991.68 8443.5,-991.68 8443.5,-1043.68"/>
<text text-anchor="middle" x="8321" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="8321" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="8321" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8321" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p0&#45;&gt;moe_e4_t3_e1_p0 -->
<g id="edge497" class="edge">
<title>gate_e4_p0&#45;&gt;moe_e4_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7735.47,-1304.48C7809.79,-1291.19 7895.22,-1271.07 7969,-1241.22 8092.15,-1191.39 8219.86,-1098.44 8282.14,-1049.94"/>
<polygon fill="black" stroke="black" points="8284.41,-1052.61 8290.13,-1043.69 8280.1,-1047.1 8284.41,-1052.61"/>
</g>
<!-- attention_e4_t0_p0 -->
<g id="node76" class="node">
<title>attention_e4_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="6993,-1131.68 6723,-1131.68 6723,-1079.68 6993,-1079.68 6993,-1131.68"/>
<text text-anchor="middle" x="6858" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="6858" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="6858" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="6858" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p0&#45;&gt;attention_e4_t0_p0 -->
<g id="edge95" class="edge">
<title>all2all_local_e4_p0&#45;&gt;attention_e4_t0_p0</title>
<path fill="none" stroke="black" d="M7103.94,-1174.68C7057.94,-1161.96 7004.08,-1147.07 6958.5,-1134.47"/>
<polygon fill="black" stroke="black" points="6959.18,-1131.02 6948.61,-1131.73 6957.32,-1137.77 6959.18,-1131.02"/>
</g>
<!-- attention_e4_t1_p0 -->
<g id="node80" class="node">
<title>attention_e4_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="7343,-1131.68 7073,-1131.68 7073,-1079.68 7343,-1079.68 7343,-1131.68"/>
<text text-anchor="middle" x="7208" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7208" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="7208" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7208" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p0&#45;&gt;attention_e4_t1_p0 -->
<g id="edge100" class="edge">
<title>all2all_local_e4_p0&#45;&gt;attention_e4_t1_p0</title>
<path fill="none" stroke="black" d="M7208,-1167.41C7208,-1159.1 7208,-1150.27 7208,-1141.99"/>
<polygon fill="black" stroke="black" points="7211.5,-1141.87 7208,-1131.87 7204.5,-1141.87 7211.5,-1141.87"/>
</g>
<!-- attention_e4_t2_p0 -->
<g id="node84" class="node">
<title>attention_e4_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="7680,-1131.68 7410,-1131.68 7410,-1079.68 7680,-1079.68 7680,-1131.68"/>
<text text-anchor="middle" x="7545" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7545" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="7545" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7545" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p0&#45;&gt;attention_e4_t2_p0 -->
<g id="edge105" class="edge">
<title>all2all_local_e4_p0&#45;&gt;attention_e4_t2_p0</title>
<path fill="none" stroke="black" d="M7309.57,-1174.28C7353.53,-1161.66 7404.75,-1146.95 7448.17,-1134.48"/>
<polygon fill="black" stroke="black" points="7449.24,-1137.82 7457.88,-1131.69 7447.3,-1131.09 7449.24,-1137.82"/>
</g>
<!-- attention_e4_t3_p0 -->
<g id="node88" class="node">
<title>attention_e4_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="8039,-1131.68 7769,-1131.68 7769,-1079.68 8039,-1079.68 8039,-1131.68"/>
<text text-anchor="middle" x="7904" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7904" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="7904" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7904" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p0&#45;&gt;attention_e4_t3_p0 -->
<g id="edge110" class="edge">
<title>all2all_local_e4_p0&#45;&gt;attention_e4_t3_p0</title>
<path fill="none" stroke="black" d="M7353.06,-1183.28C7472.12,-1166.73 7639.89,-1143.4 7758.95,-1126.85"/>
<polygon fill="black" stroke="black" points="7759.45,-1130.31 7768.87,-1125.47 7758.49,-1123.38 7759.45,-1130.31"/>
</g>
<!-- attention_e4_t0_p0&#45;&gt;moe_e4_t0_e0_p0 -->
<g id="edge96" class="edge">
<title>attention_e4_t0_p0&#45;&gt;moe_e4_t0_e0_p0</title>
<path fill="none" stroke="black" d="M6747.9,-1079.63C6701.51,-1069.08 6647.39,-1056.76 6599.98,-1045.98"/>
<polygon fill="black" stroke="black" points="6600.5,-1042.5 6589.97,-1043.7 6598.95,-1049.33 6600.5,-1042.5"/>
</g>
<!-- attention_e4_t0_p0&#45;&gt;moe_e4_t0_e1_p0 -->
<g id="edge97" class="edge">
<title>attention_e4_t0_p0&#45;&gt;moe_e4_t0_e1_p0</title>
<path fill="none" stroke="black" d="M6824.43,-1079.57C6812.14,-1070.38 6798.07,-1059.86 6785.13,-1050.18"/>
<polygon fill="black" stroke="black" points="6786.92,-1047.15 6776.81,-1043.96 6782.72,-1052.76 6786.92,-1047.15"/>
</g>
<!-- tensor_reduce_e4_t0_p0 -->
<g id="node79" class="node">
<title>tensor_reduce_e4_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="6743" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="6743" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="6743" y="-921.91" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="6743" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6743" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t0_e0_p0&#45;&gt;tensor_reduce_e4_t0_p0 -->
<g id="edge98" class="edge">
<title>moe_e4_t0_e0_p0&#45;&gt;tensor_reduce_e4_t0_p0</title>
<path fill="none" stroke="black" d="M6548.07,-991.63C6578.69,-980.37 6615.33,-966.88 6648.54,-954.66"/>
<polygon fill="black" stroke="black" points="6650.09,-957.82 6658.27,-951.09 6647.68,-951.25 6650.09,-957.82"/>
</g>
<!-- moe_e4_t0_e1_p0&#45;&gt;tensor_reduce_e4_t0_p0 -->
<g id="edge99" class="edge">
<title>moe_e4_t0_e1_p0&#45;&gt;tensor_reduce_e4_t0_p0</title>
<path fill="none" stroke="black" d="M6743,-991.51C6743,-983.7 6743,-974.83 6743,-966.06"/>
<polygon fill="black" stroke="black" points="6746.5,-965.89 6743,-955.89 6739.5,-965.89 6746.5,-965.89"/>
</g>
<!-- tensor_reduce_e4_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge194" class="edge">
<title>tensor_reduce_e4_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M6874.08,-894.76C6938.09,-884.33 7016.36,-872.87 7087,-866.14 7506.51,-826.15 8001.01,-814.8 8265.81,-811.6"/>
<polygon fill="black" stroke="black" points="8265.95,-815.1 8275.91,-811.48 8265.87,-808.1 8265.95,-815.1"/>
</g>
<!-- attention_e4_t1_p0&#45;&gt;moe_e4_t1_e0_p0 -->
<g id="edge101" class="edge">
<title>attention_e4_t1_p0&#45;&gt;moe_e4_t1_e0_p0</title>
<path fill="none" stroke="black" d="M7149.03,-1079.57C7125.69,-1069.64 7098.71,-1058.15 7074.52,-1047.85"/>
<polygon fill="black" stroke="black" points="7075.61,-1044.51 7065.04,-1043.82 7072.87,-1050.95 7075.61,-1044.51"/>
</g>
<!-- attention_e4_t1_p0&#45;&gt;moe_e4_t1_e1_p0 -->
<g id="edge102" class="edge">
<title>attention_e4_t1_p0&#45;&gt;moe_e4_t1_e1_p0</title>
<path fill="none" stroke="black" d="M7225.97,-1079.34C7231.99,-1070.85 7238.8,-1061.26 7245.19,-1052.24"/>
<polygon fill="black" stroke="black" points="7248.23,-1054.02 7251.16,-1043.83 7242.52,-1049.97 7248.23,-1054.02"/>
</g>
<!-- tensor_reduce_e4_t1_p0 -->
<g id="node83" class="node">
<title>tensor_reduce_e4_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="7269" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="7269" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="7269" y="-921.91" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="7269" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7269" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t1_e0_p0&#45;&gt;tensor_reduce_e4_t1_p0 -->
<g id="edge103" class="edge">
<title>moe_e4_t1_e0_p0&#45;&gt;tensor_reduce_e4_t1_p0</title>
<path fill="none" stroke="black" d="M7074.07,-991.63C7104.69,-980.37 7141.33,-966.88 7174.54,-954.66"/>
<polygon fill="black" stroke="black" points="7176.09,-957.82 7184.27,-951.09 7173.68,-951.25 7176.09,-957.82"/>
</g>
<!-- moe_e4_t1_e1_p0&#45;&gt;tensor_reduce_e4_t1_p0 -->
<g id="edge104" class="edge">
<title>moe_e4_t1_e1_p0&#45;&gt;tensor_reduce_e4_t1_p0</title>
<path fill="none" stroke="black" d="M7269,-991.51C7269,-983.7 7269,-974.83 7269,-966.06"/>
<polygon fill="black" stroke="black" points="7272.5,-965.89 7269,-955.89 7265.5,-965.89 7272.5,-965.89"/>
</g>
<!-- tensor_reduce_e4_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge195" class="edge">
<title>tensor_reduce_e4_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M7401.8,-895.28C7465.52,-885.1 7543.05,-873.7 7613,-866.14 7838.37,-841.77 8098.86,-826.5 8269.93,-818.22"/>
<polygon fill="black" stroke="black" points="8270.23,-821.71 8280.05,-817.74 8269.89,-814.72 8270.23,-821.71"/>
</g>
<!-- attention_e4_t2_p0&#45;&gt;moe_e4_t2_e0_p0 -->
<g id="edge106" class="edge">
<title>attention_e4_t2_p0&#45;&gt;moe_e4_t2_e0_p0</title>
<path fill="none" stroke="black" d="M7541.17,-1079.34C7539.97,-1071.38 7538.62,-1062.44 7537.33,-1053.92"/>
<polygon fill="black" stroke="black" points="7540.76,-1053.2 7535.8,-1043.83 7533.84,-1054.25 7540.76,-1053.2"/>
</g>
<!-- attention_e4_t2_p0&#45;&gt;moe_e4_t2_e1_p0 -->
<g id="edge107" class="edge">
<title>attention_e4_t2_p0&#45;&gt;moe_e4_t2_e1_p0</title>
<path fill="none" stroke="black" d="M7617.98,-1079.57C7647.5,-1069.42 7681.74,-1057.64 7712.18,-1047.17"/>
<polygon fill="black" stroke="black" points="7713.61,-1050.38 7721.93,-1043.82 7711.33,-1043.76 7713.61,-1050.38"/>
</g>
<!-- tensor_reduce_e4_t2_p0 -->
<g id="node87" class="node">
<title>tensor_reduce_e4_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="7795" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="7795" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="7795" y="-921.91" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="7795" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7795" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t2_e0_p0&#45;&gt;tensor_reduce_e4_t2_p0 -->
<g id="edge108" class="edge">
<title>moe_e4_t2_e0_p0&#45;&gt;tensor_reduce_e4_t2_p0</title>
<path fill="none" stroke="black" d="M7600.07,-991.63C7630.69,-980.37 7667.33,-966.88 7700.54,-954.66"/>
<polygon fill="black" stroke="black" points="7702.09,-957.82 7710.27,-951.09 7699.68,-951.25 7702.09,-957.82"/>
</g>
<!-- moe_e4_t2_e1_p0&#45;&gt;tensor_reduce_e4_t2_p0 -->
<g id="edge109" class="edge">
<title>moe_e4_t2_e1_p0&#45;&gt;tensor_reduce_e4_t2_p0</title>
<path fill="none" stroke="black" d="M7795,-991.51C7795,-983.7 7795,-974.83 7795,-966.06"/>
<polygon fill="black" stroke="black" points="7798.5,-965.89 7795,-955.89 7791.5,-965.89 7798.5,-965.89"/>
</g>
<!-- tensor_reduce_e4_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge196" class="edge">
<title>tensor_reduce_e4_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M7924.42,-894.44C7975.63,-885.34 8035.04,-874.99 8089,-866.14 8158.72,-854.71 8236.02,-842.84 8301.63,-833"/>
<polygon fill="black" stroke="black" points="8302.27,-836.45 8311.64,-831.51 8301.23,-829.52 8302.27,-836.45"/>
</g>
<!-- attention_e4_t3_p0&#45;&gt;moe_e4_t3_e0_p0 -->
<g id="edge111" class="edge">
<title>attention_e4_t3_p0&#45;&gt;moe_e4_t3_e0_p0</title>
<path fill="none" stroke="black" d="M7948.96,-1079.57C7966.12,-1069.99 7985.86,-1058.96 8003.8,-1048.95"/>
<polygon fill="black" stroke="black" points="8005.96,-1051.75 8012.99,-1043.82 8002.55,-1045.64 8005.96,-1051.75"/>
</g>
<!-- attention_e4_t3_p0&#45;&gt;moe_e4_t3_e1_p0 -->
<g id="edge112" class="edge">
<title>attention_e4_t3_p0&#45;&gt;moe_e4_t3_e1_p0</title>
<path fill="none" stroke="black" d="M8025.45,-1079.63C8076.95,-1069.01 8137.09,-1056.61 8189.62,-1045.77"/>
<polygon fill="black" stroke="black" points="8190.59,-1049.15 8199.68,-1043.7 8189.18,-1042.29 8190.59,-1049.15"/>
</g>
<!-- tensor_reduce_e4_t3_p0 -->
<g id="node91" class="node">
<title>tensor_reduce_e4_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="8271" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="8271" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="8271" y="-921.91" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="8271" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8271" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t3_e0_p0&#45;&gt;tensor_reduce_e4_t3_p0 -->
<g id="edge113" class="edge">
<title>moe_e4_t3_e0_p0&#45;&gt;tensor_reduce_e4_t3_p0</title>
<path fill="none" stroke="black" d="M8113.13,-991.63C8136.51,-981.01 8164.24,-968.41 8189.88,-956.76"/>
<polygon fill="black" stroke="black" points="8191.57,-959.84 8199.23,-952.52 8188.67,-953.47 8191.57,-959.84"/>
</g>
<!-- moe_e4_t3_e1_p0&#45;&gt;tensor_reduce_e4_t3_p0 -->
<g id="edge114" class="edge">
<title>moe_e4_t3_e1_p0&#45;&gt;tensor_reduce_e4_t3_p0</title>
<path fill="none" stroke="black" d="M8307.99,-991.51C8303.74,-983.27 8298.88,-973.87 8294.11,-964.64"/>
<polygon fill="black" stroke="black" points="8297.1,-962.8 8289.4,-955.52 8290.88,-966.01 8297.1,-962.8"/>
</g>
<!-- tensor_reduce_e4_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge197" class="edge">
<title>tensor_reduce_e4_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M8329.03,-884.18C8347.96,-873.17 8369.13,-860.86 8388.69,-849.5"/>
<polygon fill="black" stroke="black" points="8390.66,-852.4 8397.54,-844.35 8387.14,-846.35 8390.66,-852.4"/>
</g>
<!-- gate_e5_p0 -->
<g id="node92" class="node">
<title>gate_e5_p0</title>
<polygon fill="lightyellow" stroke="black" points="5721.24,-1381.22 5300.89,-1381.22 5192.76,-1277.22 5613.11,-1277.22 5721.24,-1381.22"/>
<text text-anchor="middle" x="5457" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="5457" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 20&#45;23</text>
<text text-anchor="middle" x="5457" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="5457" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e5_p0 -->
<g id="node93" class="node">
<title>all2all_local_e5_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="5116" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="5116" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="5116" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 20&#45;23</text>
<text text-anchor="middle" x="5116" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="5116" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e5_p0&#45;&gt;all2all_local_e5_p0 -->
<g id="edge115" class="edge">
<title>gate_e5_p0&#45;&gt;all2all_local_e5_p0</title>
<path fill="none" stroke="black" d="M5314.85,-1277.04C5280.24,-1264.58 5244.02,-1251.54 5212.13,-1240.06"/>
<polygon fill="black" stroke="black" points="5212.97,-1236.64 5202.37,-1236.54 5210.59,-1243.22 5212.97,-1236.64"/>
</g>
<!-- moe_e5_t0_e0_p0 -->
<g id="node95" class="node">
<title>moe_e5_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="4491.5,-1043.68 4246.5,-1043.68 4246.5,-991.68 4491.5,-991.68 4491.5,-1043.68"/>
<text text-anchor="middle" x="4369" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="4369" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="4369" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4369" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t0_e0_p0 -->
<g id="edge499" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5235.17,-1318.11C5033.59,-1306.43 4752.53,-1283.2 4650,-1241.22 4544,-1197.82 4445.17,-1101.8 4397.99,-1051.25"/>
<polygon fill="black" stroke="black" points="4400.5,-1048.8 4391.14,-1043.84 4395.36,-1053.56 4400.5,-1048.8"/>
</g>
<!-- moe_e5_t0_e1_p0 -->
<g id="node96" class="node">
<title>moe_e5_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="4754.5,-1043.68 4509.5,-1043.68 4509.5,-991.68 4754.5,-991.68 4754.5,-1043.68"/>
<text text-anchor="middle" x="4632" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="4632" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="4632" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4632" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t0_e1_p0 -->
<g id="edge501" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5218.89,-1302.61C5119.58,-1288.94 5003.67,-1269.04 4901,-1241.22 4772.42,-1206.37 4697.04,-1241.75 4622,-1131.68 4606.57,-1109.04 4610.86,-1077.63 4618,-1053.67"/>
<polygon fill="black" stroke="black" points="4621.41,-1054.5 4621.18,-1043.91 4614.76,-1052.33 4621.41,-1054.5"/>
</g>
<!-- moe_e5_t1_e0_p0 -->
<g id="node99" class="node">
<title>moe_e5_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="5017.5,-1043.68 4772.5,-1043.68 4772.5,-991.68 5017.5,-991.68 5017.5,-1043.68"/>
<text text-anchor="middle" x="4895" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="4895" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="4895" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4895" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t1_e0_p0 -->
<g id="edge503" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5234.62,-1317.73C5110.39,-1306.99 4972.27,-1285.23 4930,-1241.22 4879.89,-1189.04 4923.1,-1150.82 4910,-1079.68 4908.44,-1071.21 4906.42,-1062.17 4904.36,-1053.71"/>
<polygon fill="black" stroke="black" points="4907.7,-1052.61 4901.87,-1043.76 4900.91,-1054.31 4907.7,-1052.61"/>
</g>
<!-- moe_e5_t1_e1_p0 -->
<g id="node100" class="node">
<title>moe_e5_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="5280.5,-1043.68 5035.5,-1043.68 5035.5,-991.68 5280.5,-991.68 5280.5,-1043.68"/>
<text text-anchor="middle" x="5158" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="5158" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="5158" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5158" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t1_e1_p0 -->
<g id="edge505" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5417.23,-1277.08C5362.41,-1206.74 5269.29,-1087.82 5260,-1079.68 5246.97,-1068.25 5231.5,-1057.75 5216.6,-1048.81"/>
<polygon fill="black" stroke="black" points="5218.32,-1045.76 5207.92,-1043.73 5214.78,-1051.8 5218.32,-1045.76"/>
</g>
<!-- moe_e5_t2_e0_p0 -->
<g id="node103" class="node">
<title>moe_e5_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="5543.5,-1043.68 5298.5,-1043.68 5298.5,-991.68 5543.5,-991.68 5543.5,-1043.68"/>
<text text-anchor="middle" x="5421" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="5421" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="5421" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5421" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t2_e0_p0 -->
<g id="edge507" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5517.93,-1277.12C5572.11,-1225.38 5636.27,-1144.03 5591,-1079.68 5581.12,-1065.64 5567.69,-1054.81 5552.68,-1046.47"/>
<polygon fill="black" stroke="black" points="5554.17,-1043.3 5543.67,-1041.84 5550.97,-1049.52 5554.17,-1043.3"/>
</g>
<!-- moe_e5_t2_e1_p0 -->
<g id="node104" class="node">
<title>moe_e5_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="5806.5,-1043.68 5561.5,-1043.68 5561.5,-991.68 5806.5,-991.68 5806.5,-1043.68"/>
<text text-anchor="middle" x="5684" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="5684" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="5684" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5684" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t2_e1_p0 -->
<g id="edge509" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5543.48,-1277.17C5557.2,-1266.49 5570.35,-1254.42 5581,-1241.22 5629.9,-1180.58 5614.44,-1149.49 5649,-1079.68 5653.42,-1070.74 5658.58,-1061.31 5663.56,-1052.59"/>
<polygon fill="black" stroke="black" points="5666.66,-1054.23 5668.65,-1043.82 5660.6,-1050.72 5666.66,-1054.23"/>
</g>
<!-- moe_e5_t3_e0_p0 -->
<g id="node107" class="node">
<title>moe_e5_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="6069.5,-1043.68 5824.5,-1043.68 5824.5,-991.68 6069.5,-991.68 6069.5,-1043.68"/>
<text text-anchor="middle" x="5947" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="5947" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="5947" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5947" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t3_e0_p0 -->
<g id="edge511" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5638.5,-1301.32C5742.96,-1275.87 5867.01,-1226.63 5937,-1131.68 5953.29,-1109.58 5954.8,-1078.05 5952.81,-1053.91"/>
<polygon fill="black" stroke="black" points="5956.26,-1053.31 5951.72,-1043.73 5949.3,-1054.05 5956.26,-1053.31"/>
</g>
<!-- moe_e5_t3_e1_p0 -->
<g id="node108" class="node">
<title>moe_e5_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="6332.5,-1043.68 6087.5,-1043.68 6087.5,-991.68 6332.5,-991.68 6332.5,-1043.68"/>
<text text-anchor="middle" x="6210" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="6210" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="6210" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6210" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p0&#45;&gt;moe_e5_t3_e1_p0 -->
<g id="edge513" class="edge">
<title>gate_e5_p0&#45;&gt;moe_e5_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5640.13,-1303C5710.83,-1289.63 5791.32,-1269.85 5861,-1241.22 5982.82,-1191.16 6109.08,-1098.72 6171,-1050.24"/>
<polygon fill="black" stroke="black" points="6173.25,-1052.92 6178.94,-1043.98 6168.92,-1047.42 6173.25,-1052.92"/>
</g>
<!-- attention_e5_t0_p0 -->
<g id="node94" class="node">
<title>attention_e5_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="4901,-1131.68 4631,-1131.68 4631,-1079.68 4901,-1079.68 4901,-1131.68"/>
<text text-anchor="middle" x="4766" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4766" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="4766" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="4766" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p0&#45;&gt;attention_e5_t0_p0 -->
<g id="edge116" class="edge">
<title>all2all_local_e5_p0&#45;&gt;attention_e5_t0_p0</title>
<path fill="none" stroke="black" d="M5011.94,-1174.68C4965.94,-1161.96 4912.08,-1147.07 4866.5,-1134.47"/>
<polygon fill="black" stroke="black" points="4867.18,-1131.02 4856.61,-1131.73 4865.32,-1137.77 4867.18,-1131.02"/>
</g>
<!-- attention_e5_t1_p0 -->
<g id="node98" class="node">
<title>attention_e5_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="5251,-1131.68 4981,-1131.68 4981,-1079.68 5251,-1079.68 5251,-1131.68"/>
<text text-anchor="middle" x="5116" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5116" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="5116" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5116" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p0&#45;&gt;attention_e5_t1_p0 -->
<g id="edge121" class="edge">
<title>all2all_local_e5_p0&#45;&gt;attention_e5_t1_p0</title>
<path fill="none" stroke="black" d="M5116,-1167.41C5116,-1159.1 5116,-1150.27 5116,-1141.99"/>
<polygon fill="black" stroke="black" points="5119.5,-1141.87 5116,-1131.87 5112.5,-1141.87 5119.5,-1141.87"/>
</g>
<!-- attention_e5_t2_p0 -->
<g id="node102" class="node">
<title>attention_e5_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="5582,-1131.68 5312,-1131.68 5312,-1079.68 5582,-1079.68 5582,-1131.68"/>
<text text-anchor="middle" x="5447" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5447" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="5447" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5447" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p0&#45;&gt;attention_e5_t2_p0 -->
<g id="edge126" class="edge">
<title>all2all_local_e5_p0&#45;&gt;attention_e5_t2_p0</title>
<path fill="none" stroke="black" d="M5216.21,-1174.15C5259.19,-1161.58 5309.18,-1146.97 5351.61,-1134.57"/>
<polygon fill="black" stroke="black" points="5352.77,-1137.87 5361.39,-1131.71 5350.8,-1131.15 5352.77,-1137.87"/>
</g>
<!-- attention_e5_t3_p0 -->
<g id="node106" class="node">
<title>attention_e5_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="5928,-1131.68 5658,-1131.68 5658,-1079.68 5928,-1079.68 5928,-1131.68"/>
<text text-anchor="middle" x="5793" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5793" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="5793" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5793" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p0&#45;&gt;attention_e5_t3_p0 -->
<g id="edge131" class="edge">
<title>all2all_local_e5_p0&#45;&gt;attention_e5_t3_p0</title>
<path fill="none" stroke="black" d="M5259.57,-1182.93C5373.94,-1166.58 5533.35,-1143.79 5648.07,-1127.39"/>
<polygon fill="black" stroke="black" points="5648.58,-1130.86 5657.99,-1125.98 5647.59,-1123.93 5648.58,-1130.86"/>
</g>
<!-- attention_e5_t0_p0&#45;&gt;moe_e5_t0_e0_p0 -->
<g id="edge117" class="edge">
<title>attention_e5_t0_p0&#45;&gt;moe_e5_t0_e0_p0</title>
<path fill="none" stroke="black" d="M4650.37,-1079.63C4601.44,-1069.03 4544.33,-1056.66 4494.39,-1045.84"/>
<polygon fill="black" stroke="black" points="4495.02,-1042.4 4484.5,-1043.7 4493.53,-1049.24 4495.02,-1042.4"/>
</g>
<!-- attention_e5_t0_p0&#45;&gt;moe_e5_t0_e1_p0 -->
<g id="edge118" class="edge">
<title>attention_e5_t0_p0&#45;&gt;moe_e5_t0_e1_p0</title>
<path fill="none" stroke="black" d="M4726.88,-1079.57C4712.29,-1070.21 4695.54,-1059.46 4680.23,-1049.63"/>
<polygon fill="black" stroke="black" points="4681.71,-1046.42 4671.4,-1043.96 4677.92,-1052.31 4681.71,-1046.42"/>
</g>
<!-- tensor_reduce_e5_t0_p0 -->
<g id="node97" class="node">
<title>tensor_reduce_e5_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="4632" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="4632" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="4632" y="-921.91" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="4632" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4632" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t0_e0_p0&#45;&gt;tensor_reduce_e5_t0_p0 -->
<g id="edge119" class="edge">
<title>moe_e5_t0_e0_p0&#45;&gt;tensor_reduce_e5_t0_p0</title>
<path fill="none" stroke="black" d="M4437.07,-991.63C4467.69,-980.37 4504.33,-966.88 4537.54,-954.66"/>
<polygon fill="black" stroke="black" points="4539.09,-957.82 4547.27,-951.09 4536.68,-951.25 4539.09,-957.82"/>
</g>
<!-- moe_e5_t0_e1_p0&#45;&gt;tensor_reduce_e5_t0_p0 -->
<g id="edge120" class="edge">
<title>moe_e5_t0_e1_p0&#45;&gt;tensor_reduce_e5_t0_p0</title>
<path fill="none" stroke="black" d="M4632,-991.51C4632,-983.7 4632,-974.83 4632,-966.06"/>
<polygon fill="black" stroke="black" points="4635.5,-965.89 4632,-955.89 4628.5,-965.89 4635.5,-965.89"/>
</g>
<!-- tensor_reduce_e5_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge198" class="edge">
<title>tensor_reduce_e5_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M4760.98,-894.33C4825.34,-883.63 4904.53,-872.06 4976,-866.14 5622.95,-812.51 7635.51,-809.62 8265.48,-810.07"/>
<polygon fill="black" stroke="black" points="8265.57,-813.57 8275.57,-810.08 8265.57,-806.57 8265.57,-813.57"/>
</g>
<!-- attention_e5_t1_p0&#45;&gt;moe_e5_t1_e0_p0 -->
<g id="edge122" class="edge">
<title>attention_e5_t1_p0&#45;&gt;moe_e5_t1_e0_p0</title>
<path fill="none" stroke="black" d="M5051.48,-1079.57C5025.73,-1069.55 4995.91,-1057.95 4969.26,-1047.58"/>
<polygon fill="black" stroke="black" points="4970.19,-1044.18 4959.6,-1043.82 4967.65,-1050.7 4970.19,-1044.18"/>
</g>
<!-- attention_e5_t1_p0&#45;&gt;moe_e5_t1_e1_p0 -->
<g id="edge123" class="edge">
<title>attention_e5_t1_p0&#45;&gt;moe_e5_t1_e1_p0</title>
<path fill="none" stroke="black" d="M5128.37,-1079.34C5132.39,-1071.12 5136.92,-1061.85 5141.2,-1053.08"/>
<polygon fill="black" stroke="black" points="5144.47,-1054.36 5145.71,-1043.83 5138.18,-1051.28 5144.47,-1054.36"/>
</g>
<!-- tensor_reduce_e5_t1_p0 -->
<g id="node101" class="node">
<title>tensor_reduce_e5_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="5158" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="5158" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="5158" y="-921.91" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="5158" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5158" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t1_e0_p0&#45;&gt;tensor_reduce_e5_t1_p0 -->
<g id="edge124" class="edge">
<title>moe_e5_t1_e0_p0&#45;&gt;tensor_reduce_e5_t1_p0</title>
<path fill="none" stroke="black" d="M4963.07,-991.63C4993.69,-980.37 5030.33,-966.88 5063.54,-954.66"/>
<polygon fill="black" stroke="black" points="5065.09,-957.82 5073.27,-951.09 5062.68,-951.25 5065.09,-957.82"/>
</g>
<!-- moe_e5_t1_e1_p0&#45;&gt;tensor_reduce_e5_t1_p0 -->
<g id="edge125" class="edge">
<title>moe_e5_t1_e1_p0&#45;&gt;tensor_reduce_e5_t1_p0</title>
<path fill="none" stroke="black" d="M5158,-991.51C5158,-983.7 5158,-974.83 5158,-966.06"/>
<polygon fill="black" stroke="black" points="5161.5,-965.89 5158,-955.89 5154.5,-965.89 5161.5,-965.89"/>
</g>
<!-- tensor_reduce_e5_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge199" class="edge">
<title>tensor_reduce_e5_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M5287.39,-894.35C5351.68,-883.69 5430.69,-872.15 5502,-866.14 6041.6,-820.64 7700.55,-812.26 8265.38,-810.72"/>
<polygon fill="black" stroke="black" points="8265.67,-814.21 8275.66,-810.69 8265.65,-807.21 8265.67,-814.21"/>
</g>
<!-- attention_e5_t2_p0&#45;&gt;moe_e5_t2_e0_p0 -->
<g id="edge127" class="edge">
<title>attention_e5_t2_p0&#45;&gt;moe_e5_t2_e0_p0</title>
<path fill="none" stroke="black" d="M5439.34,-1079.34C5436.91,-1071.29 5434.17,-1062.24 5431.57,-1053.64"/>
<polygon fill="black" stroke="black" points="5434.85,-1052.39 5428.61,-1043.83 5428.15,-1054.42 5434.85,-1052.39"/>
</g>
<!-- attention_e5_t2_p0&#45;&gt;moe_e5_t2_e1_p0 -->
<g id="edge128" class="edge">
<title>attention_e5_t2_p0&#45;&gt;moe_e5_t2_e1_p0</title>
<path fill="none" stroke="black" d="M5516.19,-1079.57C5544.05,-1069.46 5576.34,-1057.74 5605.12,-1047.3"/>
<polygon fill="black" stroke="black" points="5606.52,-1050.52 5614.73,-1043.82 5604.13,-1043.94 5606.52,-1050.52"/>
</g>
<!-- tensor_reduce_e5_t2_p0 -->
<g id="node105" class="node">
<title>tensor_reduce_e5_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="5684" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="5684" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="5684" y="-921.91" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="5684" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5684" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t2_e0_p0&#45;&gt;tensor_reduce_e5_t2_p0 -->
<g id="edge129" class="edge">
<title>moe_e5_t2_e0_p0&#45;&gt;tensor_reduce_e5_t2_p0</title>
<path fill="none" stroke="black" d="M5489.07,-991.63C5519.69,-980.37 5556.33,-966.88 5589.54,-954.66"/>
<polygon fill="black" stroke="black" points="5591.09,-957.82 5599.27,-951.09 5588.68,-951.25 5591.09,-957.82"/>
</g>
<!-- moe_e5_t2_e1_p0&#45;&gt;tensor_reduce_e5_t2_p0 -->
<g id="edge130" class="edge">
<title>moe_e5_t2_e1_p0&#45;&gt;tensor_reduce_e5_t2_p0</title>
<path fill="none" stroke="black" d="M5684,-991.51C5684,-983.7 5684,-974.83 5684,-966.06"/>
<polygon fill="black" stroke="black" points="5687.5,-965.89 5684,-955.89 5680.5,-965.89 5687.5,-965.89"/>
</g>
<!-- tensor_reduce_e5_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge200" class="edge">
<title>tensor_reduce_e5_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M5804.66,-892.4C5857.59,-882.32 5920.62,-871.8 5978,-866.14 6420.72,-822.43 7764.78,-812.95 8265.4,-810.91"/>
<polygon fill="black" stroke="black" points="8265.64,-814.41 8275.62,-810.87 8265.61,-807.41 8265.64,-814.41"/>
</g>
<!-- attention_e5_t3_p0&#45;&gt;moe_e5_t3_e0_p0 -->
<g id="edge132" class="edge">
<title>attention_e5_t3_p0&#45;&gt;moe_e5_t3_e0_p0</title>
<path fill="none" stroke="black" d="M5837.96,-1079.57C5855.12,-1069.99 5874.86,-1058.96 5892.8,-1048.95"/>
<polygon fill="black" stroke="black" points="5894.96,-1051.75 5901.99,-1043.82 5891.55,-1045.64 5894.96,-1051.75"/>
</g>
<!-- attention_e5_t3_p0&#45;&gt;moe_e5_t3_e1_p0 -->
<g id="edge133" class="edge">
<title>attention_e5_t3_p0&#45;&gt;moe_e5_t3_e1_p0</title>
<path fill="none" stroke="black" d="M5914.45,-1079.63C5965.95,-1069.01 6026.09,-1056.61 6078.62,-1045.77"/>
<polygon fill="black" stroke="black" points="6079.59,-1049.15 6088.68,-1043.7 6078.18,-1042.29 6079.59,-1049.15"/>
</g>
<!-- tensor_reduce_e5_t3_p0 -->
<g id="node109" class="node">
<title>tensor_reduce_e5_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="6160" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="6160" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="6160" y="-921.91" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="6160" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6160" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t3_e0_p0&#45;&gt;tensor_reduce_e5_t3_p0 -->
<g id="edge134" class="edge">
<title>moe_e5_t3_e0_p0&#45;&gt;tensor_reduce_e5_t3_p0</title>
<path fill="none" stroke="black" d="M6002.13,-991.63C6025.51,-981.01 6053.24,-968.41 6078.88,-956.76"/>
<polygon fill="black" stroke="black" points="6080.57,-959.84 6088.23,-952.52 6077.67,-953.47 6080.57,-959.84"/>
</g>
<!-- moe_e5_t3_e1_p0&#45;&gt;tensor_reduce_e5_t3_p0 -->
<g id="edge135" class="edge">
<title>moe_e5_t3_e1_p0&#45;&gt;tensor_reduce_e5_t3_p0</title>
<path fill="none" stroke="black" d="M6196.99,-991.51C6192.74,-983.27 6187.88,-973.87 6183.11,-964.64"/>
<polygon fill="black" stroke="black" points="6186.1,-962.8 6178.4,-955.52 6179.88,-966.01 6186.1,-962.8"/>
</g>
<!-- tensor_reduce_e5_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge201" class="edge">
<title>tensor_reduce_e5_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M6251.25,-887.57C6280.82,-879.03 6314,-870.81 6345,-866.14 6531.56,-838.01 7782.96,-819.06 8266.15,-812.71"/>
<polygon fill="black" stroke="black" points="8266.41,-816.21 8276.36,-812.58 8266.32,-809.21 8266.41,-816.21"/>
</g>
<!-- gate_e6_p0 -->
<g id="node110" class="node">
<title>gate_e6_p0</title>
<polygon fill="lightyellow" stroke="black" points="3609.24,-1381.22 3188.89,-1381.22 3080.76,-1277.22 3501.11,-1277.22 3609.24,-1381.22"/>
<text text-anchor="middle" x="3345" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="3345" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 24&#45;27</text>
<text text-anchor="middle" x="3345" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="3345" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e6_p0 -->
<g id="node111" class="node">
<title>all2all_local_e6_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="3005" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="3005" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="3005" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 24&#45;27</text>
<text text-anchor="middle" x="3005" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="3005" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e6_p0&#45;&gt;all2all_local_e6_p0 -->
<g id="edge136" class="edge">
<title>gate_e6_p0&#45;&gt;all2all_local_e6_p0</title>
<path fill="none" stroke="black" d="M3203.27,-1277.04C3168.92,-1264.64 3132.99,-1251.66 3101.3,-1240.22"/>
<polygon fill="black" stroke="black" points="3102.2,-1236.82 3091.61,-1236.72 3099.82,-1243.41 3102.2,-1236.82"/>
</g>
<!-- moe_e6_t0_e0_p0 -->
<g id="node113" class="node">
<title>moe_e6_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="2380.5,-1043.68 2135.5,-1043.68 2135.5,-991.68 2380.5,-991.68 2380.5,-1043.68"/>
<text text-anchor="middle" x="2258" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="2258" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="2258" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2258" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t0_e0_p0 -->
<g id="edge515" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3122.97,-1318.06C2921.67,-1306.36 2641.32,-1283.12 2539,-1241.22 2433.01,-1197.81 2334.17,-1101.79 2286.99,-1051.25"/>
<polygon fill="black" stroke="black" points="2289.5,-1048.8 2280.14,-1043.83 2284.36,-1053.55 2289.5,-1048.8"/>
</g>
<!-- moe_e6_t0_e1_p0 -->
<g id="node114" class="node">
<title>moe_e6_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="2643.5,-1043.68 2398.5,-1043.68 2398.5,-991.68 2643.5,-991.68 2643.5,-1043.68"/>
<text text-anchor="middle" x="2521" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="2521" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="2521" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2521" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t0_e1_p0 -->
<g id="edge517" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3106.98,-1302.53C3007.92,-1288.85 2892.37,-1268.98 2790,-1241.22 2661.43,-1206.35 2586.04,-1241.75 2511,-1131.68 2495.57,-1109.04 2499.86,-1077.63 2507,-1053.67"/>
<polygon fill="black" stroke="black" points="2510.41,-1054.5 2510.18,-1043.91 2503.76,-1052.33 2510.41,-1054.5"/>
</g>
<!-- moe_e6_t1_e0_p0 -->
<g id="node117" class="node">
<title>moe_e6_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="2906.5,-1043.68 2661.5,-1043.68 2661.5,-991.68 2906.5,-991.68 2906.5,-1043.68"/>
<text text-anchor="middle" x="2784" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="2784" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="2784" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2784" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t1_e0_p0 -->
<g id="edge519" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3122.69,-1317.65C2998.79,-1306.87 2861.15,-1285.12 2819,-1241.22 2768.9,-1189.03 2812.1,-1150.82 2799,-1079.68 2797.44,-1071.21 2795.42,-1062.17 2793.36,-1053.71"/>
<polygon fill="black" stroke="black" points="2796.7,-1052.61 2790.87,-1043.76 2789.91,-1054.31 2796.7,-1052.61"/>
</g>
<!-- moe_e6_t1_e1_p0 -->
<g id="node118" class="node">
<title>moe_e6_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="3169.5,-1043.68 2924.5,-1043.68 2924.5,-991.68 3169.5,-991.68 3169.5,-1043.68"/>
<text text-anchor="middle" x="3047" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="3047" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="3047" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3047" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t1_e1_p0 -->
<g id="edge521" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3305.43,-1277.08C3250.9,-1206.74 3158.26,-1087.82 3149,-1079.68 3135.98,-1068.24 3120.52,-1057.73 3105.62,-1048.79"/>
<polygon fill="black" stroke="black" points="3107.34,-1045.74 3096.94,-1043.7 3103.8,-1051.78 3107.34,-1045.74"/>
</g>
<!-- moe_e6_t2_e0_p0 -->
<g id="node121" class="node">
<title>moe_e6_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="3432.5,-1043.68 3187.5,-1043.68 3187.5,-991.68 3432.5,-991.68 3432.5,-1043.68"/>
<text text-anchor="middle" x="3310" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="3310" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="3310" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3310" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t2_e0_p0 -->
<g id="edge523" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3406.28,-1277.17C3460.77,-1225.46 3525.35,-1144.13 3480,-1079.68 3470.12,-1065.64 3456.69,-1054.81 3441.68,-1046.47"/>
<polygon fill="black" stroke="black" points="3443.17,-1043.3 3432.67,-1041.84 3439.97,-1049.52 3443.17,-1043.3"/>
</g>
<!-- moe_e6_t2_e1_p0 -->
<g id="node122" class="node">
<title>moe_e6_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="3695.5,-1043.68 3450.5,-1043.68 3450.5,-991.68 3695.5,-991.68 3695.5,-1043.68"/>
<text text-anchor="middle" x="3573" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="3573" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="3573" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3573" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t2_e1_p0 -->
<g id="edge525" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3432.5,-1277C3446.22,-1266.38 3459.35,-1254.37 3470,-1241.22 3519.02,-1180.68 3503.44,-1149.49 3538,-1079.68 3542.42,-1070.74 3547.58,-1061.31 3552.56,-1052.59"/>
<polygon fill="black" stroke="black" points="3555.66,-1054.23 3557.65,-1043.82 3549.6,-1050.72 3555.66,-1054.23"/>
</g>
<!-- moe_e6_t3_e0_p0 -->
<g id="node125" class="node">
<title>moe_e6_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="3958.5,-1043.68 3713.5,-1043.68 3713.5,-991.68 3958.5,-991.68 3958.5,-1043.68"/>
<text text-anchor="middle" x="3836" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="3836" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="3836" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3836" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t3_e0_p0 -->
<g id="edge527" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.57,-1301.49C3631.3,-1276.11 3755.78,-1226.87 3826,-1131.68 3842.3,-1109.59 3843.81,-1078.06 3841.81,-1053.91"/>
<polygon fill="black" stroke="black" points="3845.27,-1053.31 3840.73,-1043.73 3838.31,-1054.05 3845.27,-1053.31"/>
</g>
<!-- moe_e6_t3_e1_p0 -->
<g id="node126" class="node">
<title>moe_e6_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="4221.5,-1043.68 3976.5,-1043.68 3976.5,-991.68 4221.5,-991.68 4221.5,-1043.68"/>
<text text-anchor="middle" x="4099" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="4099" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="4099" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4099" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p0&#45;&gt;moe_e6_t3_e1_p0 -->
<g id="edge529" class="edge">
<title>gate_e6_p0&#45;&gt;moe_e6_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3528.08,-1303.15C3599.08,-1289.78 3679.98,-1269.97 3750,-1241.22 3871.83,-1191.19 3998.09,-1098.74 4060,-1050.24"/>
<polygon fill="black" stroke="black" points="4062.25,-1052.92 4067.94,-1043.99 4057.92,-1047.43 4062.25,-1052.92"/>
</g>
<!-- attention_e6_t0_p0 -->
<g id="node112" class="node">
<title>attention_e6_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="2790,-1131.68 2520,-1131.68 2520,-1079.68 2790,-1079.68 2790,-1131.68"/>
<text text-anchor="middle" x="2655" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2655" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="2655" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="2655" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p0&#45;&gt;attention_e6_t0_p0 -->
<g id="edge137" class="edge">
<title>all2all_local_e6_p0&#45;&gt;attention_e6_t0_p0</title>
<path fill="none" stroke="black" d="M2900.94,-1174.68C2854.94,-1161.96 2801.08,-1147.07 2755.5,-1134.47"/>
<polygon fill="black" stroke="black" points="2756.18,-1131.02 2745.61,-1131.73 2754.32,-1137.77 2756.18,-1131.02"/>
</g>
<!-- attention_e6_t1_p0 -->
<g id="node116" class="node">
<title>attention_e6_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="3140,-1131.68 2870,-1131.68 2870,-1079.68 3140,-1079.68 3140,-1131.68"/>
<text text-anchor="middle" x="3005" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3005" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="3005" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3005" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p0&#45;&gt;attention_e6_t1_p0 -->
<g id="edge142" class="edge">
<title>all2all_local_e6_p0&#45;&gt;attention_e6_t1_p0</title>
<path fill="none" stroke="black" d="M3005,-1167.41C3005,-1159.1 3005,-1150.27 3005,-1141.99"/>
<polygon fill="black" stroke="black" points="3008.5,-1141.87 3005,-1131.87 3001.5,-1141.87 3008.5,-1141.87"/>
</g>
<!-- attention_e6_t2_p0 -->
<g id="node120" class="node">
<title>attention_e6_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="3471,-1131.68 3201,-1131.68 3201,-1079.68 3471,-1079.68 3471,-1131.68"/>
<text text-anchor="middle" x="3336" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3336" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="3336" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3336" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p0&#45;&gt;attention_e6_t2_p0 -->
<g id="edge147" class="edge">
<title>all2all_local_e6_p0&#45;&gt;attention_e6_t2_p0</title>
<path fill="none" stroke="black" d="M3105.21,-1174.15C3148.19,-1161.58 3198.18,-1146.97 3240.61,-1134.57"/>
<polygon fill="black" stroke="black" points="3241.77,-1137.87 3250.39,-1131.71 3239.8,-1131.15 3241.77,-1137.87"/>
</g>
<!-- attention_e6_t3_p0 -->
<g id="node124" class="node">
<title>attention_e6_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="3817,-1131.68 3547,-1131.68 3547,-1079.68 3817,-1079.68 3817,-1131.68"/>
<text text-anchor="middle" x="3682" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3682" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="3682" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3682" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p0&#45;&gt;attention_e6_t3_p0 -->
<g id="edge152" class="edge">
<title>all2all_local_e6_p0&#45;&gt;attention_e6_t3_p0</title>
<path fill="none" stroke="black" d="M3148.57,-1182.93C3262.94,-1166.58 3422.35,-1143.79 3537.07,-1127.39"/>
<polygon fill="black" stroke="black" points="3537.58,-1130.86 3546.99,-1125.98 3536.59,-1123.93 3537.58,-1130.86"/>
</g>
<!-- attention_e6_t0_p0&#45;&gt;moe_e6_t0_e0_p0 -->
<g id="edge138" class="edge">
<title>attention_e6_t0_p0&#45;&gt;moe_e6_t0_e0_p0</title>
<path fill="none" stroke="black" d="M2539.37,-1079.63C2490.44,-1069.03 2433.33,-1056.66 2383.39,-1045.84"/>
<polygon fill="black" stroke="black" points="2384.02,-1042.4 2373.5,-1043.7 2382.53,-1049.24 2384.02,-1042.4"/>
</g>
<!-- attention_e6_t0_p0&#45;&gt;moe_e6_t0_e1_p0 -->
<g id="edge139" class="edge">
<title>attention_e6_t0_p0&#45;&gt;moe_e6_t0_e1_p0</title>
<path fill="none" stroke="black" d="M2615.88,-1079.57C2601.29,-1070.21 2584.54,-1059.46 2569.23,-1049.63"/>
<polygon fill="black" stroke="black" points="2570.71,-1046.42 2560.4,-1043.96 2566.92,-1052.31 2570.71,-1046.42"/>
</g>
<!-- tensor_reduce_e6_t0_p0 -->
<g id="node115" class="node">
<title>tensor_reduce_e6_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="2521" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="2521" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="2521" y="-921.91" font-family="Arial" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="2521" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2521" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t0_e0_p0&#45;&gt;tensor_reduce_e6_t0_p0 -->
<g id="edge140" class="edge">
<title>moe_e6_t0_e0_p0&#45;&gt;tensor_reduce_e6_t0_p0</title>
<path fill="none" stroke="black" d="M2326.07,-991.63C2356.69,-980.37 2393.33,-966.88 2426.54,-954.66"/>
<polygon fill="black" stroke="black" points="2428.09,-957.82 2436.27,-951.09 2425.68,-951.25 2428.09,-957.82"/>
</g>
<!-- moe_e6_t0_e1_p0&#45;&gt;tensor_reduce_e6_t0_p0 -->
<g id="edge141" class="edge">
<title>moe_e6_t0_e1_p0&#45;&gt;tensor_reduce_e6_t0_p0</title>
<path fill="none" stroke="black" d="M2521,-991.51C2521,-983.7 2521,-974.83 2521,-966.06"/>
<polygon fill="black" stroke="black" points="2524.5,-965.89 2521,-955.89 2517.5,-965.89 2524.5,-965.89"/>
</g>
<!-- tensor_reduce_e6_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge202" class="edge">
<title>tensor_reduce_e6_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M2649.56,-894.21C2713.99,-883.45 2793.36,-871.86 2865,-866.14 3411.52,-822.5 7347.84,-812.45 8265.24,-810.69"/>
<polygon fill="black" stroke="black" points="8265.57,-814.19 8275.56,-810.67 8265.56,-807.19 8265.57,-814.19"/>
</g>
<!-- attention_e6_t1_p0&#45;&gt;moe_e6_t1_e0_p0 -->
<g id="edge143" class="edge">
<title>attention_e6_t1_p0&#45;&gt;moe_e6_t1_e0_p0</title>
<path fill="none" stroke="black" d="M2940.48,-1079.57C2914.73,-1069.55 2884.91,-1057.95 2858.26,-1047.58"/>
<polygon fill="black" stroke="black" points="2859.19,-1044.18 2848.6,-1043.82 2856.65,-1050.7 2859.19,-1044.18"/>
</g>
<!-- attention_e6_t1_p0&#45;&gt;moe_e6_t1_e1_p0 -->
<g id="edge144" class="edge">
<title>attention_e6_t1_p0&#45;&gt;moe_e6_t1_e1_p0</title>
<path fill="none" stroke="black" d="M3017.37,-1079.34C3021.39,-1071.12 3025.92,-1061.85 3030.2,-1053.08"/>
<polygon fill="black" stroke="black" points="3033.47,-1054.36 3034.71,-1043.83 3027.18,-1051.28 3033.47,-1054.36"/>
</g>
<!-- tensor_reduce_e6_t1_p0 -->
<g id="node119" class="node">
<title>tensor_reduce_e6_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="3047" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="3047" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="3047" y="-921.91" font-family="Arial" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="3047" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3047" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t1_e0_p0&#45;&gt;tensor_reduce_e6_t1_p0 -->
<g id="edge145" class="edge">
<title>moe_e6_t1_e0_p0&#45;&gt;tensor_reduce_e6_t1_p0</title>
<path fill="none" stroke="black" d="M2852.07,-991.63C2882.69,-980.37 2919.33,-966.88 2952.54,-954.66"/>
<polygon fill="black" stroke="black" points="2954.09,-957.82 2962.27,-951.09 2951.68,-951.25 2954.09,-957.82"/>
</g>
<!-- moe_e6_t1_e1_p0&#45;&gt;tensor_reduce_e6_t1_p0 -->
<g id="edge146" class="edge">
<title>moe_e6_t1_e1_p0&#45;&gt;tensor_reduce_e6_t1_p0</title>
<path fill="none" stroke="black" d="M3047,-991.51C3047,-983.7 3047,-974.83 3047,-966.06"/>
<polygon fill="black" stroke="black" points="3050.5,-965.89 3047,-955.89 3043.5,-965.89 3050.5,-965.89"/>
</g>
<!-- tensor_reduce_e6_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge203" class="edge">
<title>tensor_reduce_e6_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M3175.56,-894.24C3239.99,-883.49 3319.36,-871.9 3391,-866.14 3882.69,-826.63 7403.22,-813.54 8265.66,-810.9"/>
<polygon fill="black" stroke="black" points="8265.7,-814.4 8275.69,-810.87 8265.68,-807.4 8265.7,-814.4"/>
</g>
<!-- attention_e6_t2_p0&#45;&gt;moe_e6_t2_e0_p0 -->
<g id="edge148" class="edge">
<title>attention_e6_t2_p0&#45;&gt;moe_e6_t2_e0_p0</title>
<path fill="none" stroke="black" d="M3328.34,-1079.34C3325.91,-1071.29 3323.17,-1062.24 3320.57,-1053.64"/>
<polygon fill="black" stroke="black" points="3323.85,-1052.39 3317.61,-1043.83 3317.15,-1054.42 3323.85,-1052.39"/>
</g>
<!-- attention_e6_t2_p0&#45;&gt;moe_e6_t2_e1_p0 -->
<g id="edge149" class="edge">
<title>attention_e6_t2_p0&#45;&gt;moe_e6_t2_e1_p0</title>
<path fill="none" stroke="black" d="M3405.19,-1079.57C3433.05,-1069.46 3465.34,-1057.74 3494.12,-1047.3"/>
<polygon fill="black" stroke="black" points="3495.52,-1050.52 3503.73,-1043.82 3493.13,-1043.94 3495.52,-1050.52"/>
</g>
<!-- tensor_reduce_e6_t2_p0 -->
<g id="node123" class="node">
<title>tensor_reduce_e6_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="3573" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="3573" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="3573" y="-921.91" font-family="Arial" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="3573" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3573" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t2_e0_p0&#45;&gt;tensor_reduce_e6_t2_p0 -->
<g id="edge150" class="edge">
<title>moe_e6_t2_e0_p0&#45;&gt;tensor_reduce_e6_t2_p0</title>
<path fill="none" stroke="black" d="M3378.07,-991.63C3408.69,-980.37 3445.33,-966.88 3478.54,-954.66"/>
<polygon fill="black" stroke="black" points="3480.09,-957.82 3488.27,-951.09 3477.68,-951.25 3480.09,-957.82"/>
</g>
<!-- moe_e6_t2_e1_p0&#45;&gt;tensor_reduce_e6_t2_p0 -->
<g id="edge151" class="edge">
<title>moe_e6_t2_e1_p0&#45;&gt;tensor_reduce_e6_t2_p0</title>
<path fill="none" stroke="black" d="M3573,-991.51C3573,-983.7 3573,-974.83 3573,-966.06"/>
<polygon fill="black" stroke="black" points="3576.5,-965.89 3573,-955.89 3569.5,-965.89 3576.5,-965.89"/>
</g>
<!-- tensor_reduce_e6_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge204" class="edge">
<title>tensor_reduce_e6_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M3692.92,-892.26C3745.99,-882.08 3809.33,-871.53 3867,-866.14 4308.66,-824.84 7454.61,-813.19 8265.64,-810.86"/>
<polygon fill="black" stroke="black" points="8265.67,-814.36 8275.66,-810.83 8265.65,-807.36 8265.67,-814.36"/>
</g>
<!-- attention_e6_t3_p0&#45;&gt;moe_e6_t3_e0_p0 -->
<g id="edge153" class="edge">
<title>attention_e6_t3_p0&#45;&gt;moe_e6_t3_e0_p0</title>
<path fill="none" stroke="black" d="M3726.96,-1079.57C3744.12,-1069.99 3763.86,-1058.96 3781.8,-1048.95"/>
<polygon fill="black" stroke="black" points="3783.96,-1051.75 3790.99,-1043.82 3780.55,-1045.64 3783.96,-1051.75"/>
</g>
<!-- attention_e6_t3_p0&#45;&gt;moe_e6_t3_e1_p0 -->
<g id="edge154" class="edge">
<title>attention_e6_t3_p0&#45;&gt;moe_e6_t3_e1_p0</title>
<path fill="none" stroke="black" d="M3803.45,-1079.63C3854.95,-1069.01 3915.09,-1056.61 3967.62,-1045.77"/>
<polygon fill="black" stroke="black" points="3968.59,-1049.15 3977.68,-1043.7 3967.18,-1042.29 3968.59,-1049.15"/>
</g>
<!-- tensor_reduce_e6_t3_p0 -->
<g id="node127" class="node">
<title>tensor_reduce_e6_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="4049" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="4049" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="4049" y="-921.91" font-family="Arial" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="4049" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4049" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t3_e0_p0&#45;&gt;tensor_reduce_e6_t3_p0 -->
<g id="edge155" class="edge">
<title>moe_e6_t3_e0_p0&#45;&gt;tensor_reduce_e6_t3_p0</title>
<path fill="none" stroke="black" d="M3891.13,-991.63C3914.51,-981.01 3942.24,-968.41 3967.88,-956.76"/>
<polygon fill="black" stroke="black" points="3969.57,-959.84 3977.23,-952.52 3966.67,-953.47 3969.57,-959.84"/>
</g>
<!-- moe_e6_t3_e1_p0&#45;&gt;tensor_reduce_e6_t3_p0 -->
<g id="edge156" class="edge">
<title>moe_e6_t3_e1_p0&#45;&gt;tensor_reduce_e6_t3_p0</title>
<path fill="none" stroke="black" d="M4085.99,-991.51C4081.74,-983.27 4076.88,-973.87 4072.11,-964.64"/>
<polygon fill="black" stroke="black" points="4075.1,-962.8 4067.4,-955.52 4068.88,-966.01 4075.1,-962.8"/>
</g>
<!-- tensor_reduce_e6_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge205" class="edge">
<title>tensor_reduce_e6_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M4139.74,-887.46C4169.43,-878.86 4202.8,-870.63 4234,-866.14 4635.26,-808.35 7495.54,-808.79 8265.52,-809.98"/>
<polygon fill="black" stroke="black" points="8265.58,-813.48 8275.59,-809.99 8265.59,-806.48 8265.58,-813.48"/>
</g>
<!-- gate_e7_p0 -->
<g id="node128" class="node">
<title>gate_e7_p0</title>
<polygon fill="lightyellow" stroke="black" points="1482.24,-1381.22 1061.89,-1381.22 953.76,-1277.22 1374.11,-1277.22 1482.24,-1381.22"/>
<text text-anchor="middle" x="1218" y="-1343.22" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="1218" y="-1332.22" font-family="Arial" font-size="10.00">GPU: 28&#45;31</text>
<text text-anchor="middle" x="1218" y="-1321.22" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="1218" y="-1310.22" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e7_p0 -->
<g id="node129" class="node">
<title>all2all_local_e7_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="875" cy="-1204.45" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="875" y="-1218.45" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="875" y="-1207.45" font-family="Arial" font-size="10.00">GPU: 28&#45;31</text>
<text text-anchor="middle" x="875" y="-1196.45" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="875" y="-1185.45" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e7_p0&#45;&gt;all2all_local_e7_p0 -->
<g id="edge157" class="edge">
<title>gate_e7_p0&#45;&gt;all2all_local_e7_p0</title>
<path fill="none" stroke="black" d="M1075.02,-1277.04C1040.2,-1264.58 1003.77,-1251.54 971.69,-1240.06"/>
<polygon fill="black" stroke="black" points="972.47,-1236.62 961.88,-1236.54 970.11,-1243.21 972.47,-1236.62"/>
</g>
<!-- moe_e7_t0_e0_p0 -->
<g id="node131" class="node">
<title>moe_e7_t0_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="269.5,-1043.68 24.5,-1043.68 24.5,-991.68 269.5,-991.68 269.5,-1043.68"/>
<text text-anchor="middle" x="147" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="147" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="147" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="147" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t0_e0_p0 -->
<g id="edge531" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t0_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M996.02,-1318.26C796.2,-1306.74 518.94,-1283.65 418,-1241.22 314.92,-1197.89 220.25,-1102.18 174.99,-1051.55"/>
<polygon fill="black" stroke="black" points="177.4,-1049 168.15,-1043.83 172.16,-1053.64 177.4,-1049"/>
</g>
<!-- moe_e7_t0_e1_p0 -->
<g id="node132" class="node">
<title>moe_e7_t0_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="532.5,-1043.68 287.5,-1043.68 287.5,-991.68 532.5,-991.68 532.5,-1043.68"/>
<text text-anchor="middle" x="410" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="410" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="410" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="410" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t0_e1_p0 -->
<g id="edge533" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t0_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M985.49,-1307.87C762.32,-1282.66 449.33,-1230.41 381,-1131.68 364.85,-1108.35 375.06,-1076.71 387.62,-1052.84"/>
<polygon fill="black" stroke="black" points="390.68,-1054.55 392.5,-1044.11 384.57,-1051.13 390.68,-1054.55"/>
</g>
<!-- moe_e7_t1_e0_p0 -->
<g id="node135" class="node">
<title>moe_e7_t1_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="795.5,-1043.68 550.5,-1043.68 550.5,-991.68 795.5,-991.68 795.5,-1043.68"/>
<text text-anchor="middle" x="673" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="673" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="673" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="673" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t1_e0_p0 -->
<g id="edge535" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t1_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M996.82,-1318.84C871.08,-1308.51 730.61,-1286.8 689,-1241.22 676.68,-1227.72 673.83,-1113.24 673.18,-1053.96"/>
<polygon fill="black" stroke="black" points="676.68,-1053.88 673.09,-1043.91 669.68,-1053.94 676.68,-1053.88"/>
</g>
<!-- moe_e7_t1_e1_p0 -->
<g id="node136" class="node">
<title>moe_e7_t1_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="1058.5,-1043.68 813.5,-1043.68 813.5,-991.68 1058.5,-991.68 1058.5,-1043.68"/>
<text text-anchor="middle" x="936" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="936" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="936" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="936" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t1_e1_p0 -->
<g id="edge537" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t1_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1179.48,-1276.95C1132.02,-1214.35 1053.45,-1112.73 1019,-1079.68 1007.99,-1069.12 995.1,-1058.82 982.81,-1049.78"/>
<polygon fill="black" stroke="black" points="984.58,-1046.75 974.42,-1043.74 980.49,-1052.43 984.58,-1046.75"/>
</g>
<!-- moe_e7_t2_e0_p0 -->
<g id="node139" class="node">
<title>moe_e7_t2_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="1321.5,-1043.68 1076.5,-1043.68 1076.5,-991.68 1321.5,-991.68 1321.5,-1043.68"/>
<text text-anchor="middle" x="1199" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="1199" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="1199" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1199" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t2_e0_p0 -->
<g id="edge539" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t2_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1280.48,-1277.07C1335.54,-1225.64 1400.6,-1144.85 1356,-1079.68 1347.19,-1066.81 1335.25,-1056.66 1321.85,-1048.64"/>
<polygon fill="black" stroke="black" points="1323.3,-1045.45 1312.85,-1043.68 1319.92,-1051.58 1323.3,-1045.45"/>
</g>
<!-- moe_e7_t2_e1_p0 -->
<g id="node140" class="node">
<title>moe_e7_t2_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="1584.5,-1043.68 1339.5,-1043.68 1339.5,-991.68 1584.5,-991.68 1584.5,-1043.68"/>
<text text-anchor="middle" x="1462" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="1462" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="1462" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1462" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t2_e1_p0 -->
<g id="edge541" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t2_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1304.39,-1277.12C1318.65,-1266.39 1332.51,-1254.3 1344,-1241.22 1397.26,-1180.56 1388.46,-1150.6 1427,-1079.68 1431.8,-1070.84 1437.14,-1061.37 1442.17,-1052.6"/>
<polygon fill="black" stroke="black" points="1445.3,-1054.17 1447.26,-1043.76 1439.24,-1050.67 1445.3,-1054.17"/>
</g>
<!-- moe_e7_t3_e0_p0 -->
<g id="node143" class="node">
<title>moe_e7_t3_e0_p0</title>
<polygon fill="lightyellow" stroke="black" points="1847.5,-1043.68 1602.5,-1043.68 1602.5,-991.68 1847.5,-991.68 1847.5,-1043.68"/>
<text text-anchor="middle" x="1725" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="1725" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="1725" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1725" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t3_e0_p0 -->
<g id="edge543" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t3_e0_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1402.05,-1303.91C1510.9,-1279.39 1641.46,-1230.2 1715,-1131.68 1731.42,-1109.68 1732.92,-1078.14 1730.89,-1053.97"/>
<polygon fill="black" stroke="black" points="1734.34,-1053.35 1729.79,-1043.78 1727.38,-1054.1 1734.34,-1053.35"/>
</g>
<!-- moe_e7_t3_e1_p0 -->
<g id="node144" class="node">
<title>moe_e7_t3_e1_p0</title>
<polygon fill="lightyellow" stroke="black" points="2110.5,-1043.68 1865.5,-1043.68 1865.5,-991.68 2110.5,-991.68 2110.5,-1043.68"/>
<text text-anchor="middle" x="1988" y="-1031.68" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="1988" y="-1020.68" font-family="Arial" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="1988" y="-1009.68" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1988" y="-998.68" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p0&#45;&gt;moe_e7_t3_e1_p0 -->
<g id="edge545" class="edge">
<title>gate_e7_p0&#45;&gt;moe_e7_t3_e1_p0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1402.47,-1304.48C1476.79,-1291.19 1562.22,-1271.07 1636,-1241.22 1759.15,-1191.39 1886.86,-1098.44 1949.14,-1049.94"/>
<polygon fill="black" stroke="black" points="1951.41,-1052.61 1957.13,-1043.69 1947.1,-1047.1 1951.41,-1052.61"/>
</g>
<!-- attention_e7_t0_p0 -->
<g id="node130" class="node">
<title>attention_e7_t0_p0</title>
<polygon fill="lightyellow" stroke="black" points="660,-1131.68 390,-1131.68 390,-1079.68 660,-1079.68 660,-1131.68"/>
<text text-anchor="middle" x="525" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="525" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="525" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="525" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p0&#45;&gt;attention_e7_t0_p0 -->
<g id="edge158" class="edge">
<title>all2all_local_e7_p0&#45;&gt;attention_e7_t0_p0</title>
<path fill="none" stroke="black" d="M770.94,-1174.68C724.94,-1161.96 671.08,-1147.07 625.5,-1134.47"/>
<polygon fill="black" stroke="black" points="626.18,-1131.02 615.61,-1131.73 624.32,-1137.77 626.18,-1131.02"/>
</g>
<!-- attention_e7_t1_p0 -->
<g id="node134" class="node">
<title>attention_e7_t1_p0</title>
<polygon fill="lightyellow" stroke="black" points="1010,-1131.68 740,-1131.68 740,-1079.68 1010,-1079.68 1010,-1131.68"/>
<text text-anchor="middle" x="875" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="875" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="875" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="875" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p0&#45;&gt;attention_e7_t1_p0 -->
<g id="edge163" class="edge">
<title>all2all_local_e7_p0&#45;&gt;attention_e7_t1_p0</title>
<path fill="none" stroke="black" d="M875,-1167.41C875,-1159.1 875,-1150.27 875,-1141.99"/>
<polygon fill="black" stroke="black" points="878.5,-1141.87 875,-1131.87 871.5,-1141.87 878.5,-1141.87"/>
</g>
<!-- attention_e7_t2_p0 -->
<g id="node138" class="node">
<title>attention_e7_t2_p0</title>
<polygon fill="lightyellow" stroke="black" points="1347,-1131.68 1077,-1131.68 1077,-1079.68 1347,-1079.68 1347,-1131.68"/>
<text text-anchor="middle" x="1212" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1212" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="1212" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1212" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p0&#45;&gt;attention_e7_t2_p0 -->
<g id="edge168" class="edge">
<title>all2all_local_e7_p0&#45;&gt;attention_e7_t2_p0</title>
<path fill="none" stroke="black" d="M976.57,-1174.28C1020.53,-1161.66 1071.75,-1146.95 1115.17,-1134.48"/>
<polygon fill="black" stroke="black" points="1116.24,-1137.82 1124.88,-1131.69 1114.3,-1131.09 1116.24,-1137.82"/>
</g>
<!-- attention_e7_t3_p0 -->
<g id="node142" class="node">
<title>attention_e7_t3_p0</title>
<polygon fill="lightyellow" stroke="black" points="1706,-1131.68 1436,-1131.68 1436,-1079.68 1706,-1079.68 1706,-1131.68"/>
<text text-anchor="middle" x="1571" y="-1119.68" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1571" y="-1108.68" font-family="Arial" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="1571" y="-1097.68" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1571" y="-1086.68" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p0&#45;&gt;attention_e7_t3_p0 -->
<g id="edge173" class="edge">
<title>all2all_local_e7_p0&#45;&gt;attention_e7_t3_p0</title>
<path fill="none" stroke="black" d="M1020.06,-1183.28C1139.12,-1166.73 1306.89,-1143.4 1425.95,-1126.85"/>
<polygon fill="black" stroke="black" points="1426.45,-1130.31 1435.87,-1125.47 1425.49,-1123.38 1426.45,-1130.31"/>
</g>
<!-- attention_e7_t0_p0&#45;&gt;moe_e7_t0_e0_p0 -->
<g id="edge159" class="edge">
<title>attention_e7_t0_p0&#45;&gt;moe_e7_t0_e0_p0</title>
<path fill="none" stroke="black" d="M414.9,-1079.63C368.51,-1069.08 314.39,-1056.76 266.98,-1045.98"/>
<polygon fill="black" stroke="black" points="267.5,-1042.5 256.97,-1043.7 265.95,-1049.33 267.5,-1042.5"/>
</g>
<!-- attention_e7_t0_p0&#45;&gt;moe_e7_t0_e1_p0 -->
<g id="edge160" class="edge">
<title>attention_e7_t0_p0&#45;&gt;moe_e7_t0_e1_p0</title>
<path fill="none" stroke="black" d="M491.43,-1079.57C479.14,-1070.38 465.07,-1059.86 452.13,-1050.18"/>
<polygon fill="black" stroke="black" points="453.92,-1047.15 443.81,-1043.96 449.72,-1052.76 453.92,-1047.15"/>
</g>
<!-- tensor_reduce_e7_t0_p0 -->
<g id="node133" class="node">
<title>tensor_reduce_e7_t0_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="410" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="410" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="410" y="-921.91" font-family="Arial" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="410" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="410" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t0_e0_p0&#45;&gt;tensor_reduce_e7_t0_p0 -->
<g id="edge161" class="edge">
<title>moe_e7_t0_e0_p0&#45;&gt;tensor_reduce_e7_t0_p0</title>
<path fill="none" stroke="black" d="M215.07,-991.63C245.69,-980.37 282.33,-966.88 315.54,-954.66"/>
<polygon fill="black" stroke="black" points="317.09,-957.82 325.27,-951.09 314.68,-951.25 317.09,-957.82"/>
</g>
<!-- moe_e7_t0_e1_p0&#45;&gt;tensor_reduce_e7_t0_p0 -->
<g id="edge162" class="edge">
<title>moe_e7_t0_e1_p0&#45;&gt;tensor_reduce_e7_t0_p0</title>
<path fill="none" stroke="black" d="M410,-991.51C410,-983.7 410,-974.83 410,-966.06"/>
<polygon fill="black" stroke="black" points="413.5,-965.89 410,-955.89 406.5,-965.89 413.5,-965.89"/>
</g>
<!-- tensor_reduce_e7_t0_p0&#45;&gt;pipeline_transfer -->
<g id="edge206" class="edge">
<title>tensor_reduce_e7_t0_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M538.55,-894.13C602.98,-883.34 682.35,-871.76 754,-866.14 1522.34,-805.85 7153.24,-808.92 8265.47,-810.13"/>
<polygon fill="black" stroke="black" points="8265.56,-813.63 8275.56,-810.14 8265.56,-806.63 8265.56,-813.63"/>
</g>
<!-- attention_e7_t1_p0&#45;&gt;moe_e7_t1_e0_p0 -->
<g id="edge164" class="edge">
<title>attention_e7_t1_p0&#45;&gt;moe_e7_t1_e0_p0</title>
<path fill="none" stroke="black" d="M816.03,-1079.57C792.69,-1069.64 765.71,-1058.15 741.52,-1047.85"/>
<polygon fill="black" stroke="black" points="742.61,-1044.51 732.04,-1043.82 739.87,-1050.95 742.61,-1044.51"/>
</g>
<!-- attention_e7_t1_p0&#45;&gt;moe_e7_t1_e1_p0 -->
<g id="edge165" class="edge">
<title>attention_e7_t1_p0&#45;&gt;moe_e7_t1_e1_p0</title>
<path fill="none" stroke="black" d="M892.97,-1079.34C898.99,-1070.85 905.8,-1061.26 912.19,-1052.24"/>
<polygon fill="black" stroke="black" points="915.23,-1054.02 918.16,-1043.83 909.52,-1049.97 915.23,-1054.02"/>
</g>
<!-- tensor_reduce_e7_t1_p0 -->
<g id="node137" class="node">
<title>tensor_reduce_e7_t1_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="936" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="936" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="936" y="-921.91" font-family="Arial" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="936" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="936" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t1_e0_p0&#45;&gt;tensor_reduce_e7_t1_p0 -->
<g id="edge166" class="edge">
<title>moe_e7_t1_e0_p0&#45;&gt;tensor_reduce_e7_t1_p0</title>
<path fill="none" stroke="black" d="M741.07,-991.63C771.69,-980.37 808.33,-966.88 841.54,-954.66"/>
<polygon fill="black" stroke="black" points="843.09,-957.82 851.27,-951.09 840.68,-951.25 843.09,-957.82"/>
</g>
<!-- moe_e7_t1_e1_p0&#45;&gt;tensor_reduce_e7_t1_p0 -->
<g id="edge167" class="edge">
<title>moe_e7_t1_e1_p0&#45;&gt;tensor_reduce_e7_t1_p0</title>
<path fill="none" stroke="black" d="M936,-991.51C936,-983.7 936,-974.83 936,-966.06"/>
<polygon fill="black" stroke="black" points="939.5,-965.89 936,-955.89 932.5,-965.89 939.5,-965.89"/>
</g>
<!-- tensor_reduce_e7_t1_p0&#45;&gt;pipeline_transfer -->
<g id="edge207" class="edge">
<title>tensor_reduce_e7_t1_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M1064.55,-894.15C1128.98,-883.36 1208.35,-871.78 1280,-866.14 1992.87,-810.01 7198.47,-809.7 8265.28,-810.24"/>
<polygon fill="black" stroke="black" points="8265.34,-813.74 8275.35,-810.24 8265.35,-806.74 8265.34,-813.74"/>
</g>
<!-- attention_e7_t2_p0&#45;&gt;moe_e7_t2_e0_p0 -->
<g id="edge169" class="edge">
<title>attention_e7_t2_p0&#45;&gt;moe_e7_t2_e0_p0</title>
<path fill="none" stroke="black" d="M1208.17,-1079.34C1206.97,-1071.38 1205.62,-1062.44 1204.33,-1053.92"/>
<polygon fill="black" stroke="black" points="1207.76,-1053.2 1202.8,-1043.83 1200.84,-1054.25 1207.76,-1053.2"/>
</g>
<!-- attention_e7_t2_p0&#45;&gt;moe_e7_t2_e1_p0 -->
<g id="edge170" class="edge">
<title>attention_e7_t2_p0&#45;&gt;moe_e7_t2_e1_p0</title>
<path fill="none" stroke="black" d="M1284.98,-1079.57C1314.5,-1069.42 1348.74,-1057.64 1379.18,-1047.17"/>
<polygon fill="black" stroke="black" points="1380.61,-1050.38 1388.93,-1043.82 1378.33,-1043.76 1380.61,-1050.38"/>
</g>
<!-- tensor_reduce_e7_t2_p0 -->
<g id="node141" class="node">
<title>tensor_reduce_e7_t2_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="1462" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1462" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="1462" y="-921.91" font-family="Arial" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="1462" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1462" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t2_e0_p0&#45;&gt;tensor_reduce_e7_t2_p0 -->
<g id="edge171" class="edge">
<title>moe_e7_t2_e0_p0&#45;&gt;tensor_reduce_e7_t2_p0</title>
<path fill="none" stroke="black" d="M1267.07,-991.63C1297.69,-980.37 1334.33,-966.88 1367.54,-954.66"/>
<polygon fill="black" stroke="black" points="1369.09,-957.82 1377.27,-951.09 1366.68,-951.25 1369.09,-957.82"/>
</g>
<!-- moe_e7_t2_e1_p0&#45;&gt;tensor_reduce_e7_t2_p0 -->
<g id="edge172" class="edge">
<title>moe_e7_t2_e1_p0&#45;&gt;tensor_reduce_e7_t2_p0</title>
<path fill="none" stroke="black" d="M1462,-991.51C1462,-983.7 1462,-974.83 1462,-966.06"/>
<polygon fill="black" stroke="black" points="1465.5,-965.89 1462,-955.89 1458.5,-965.89 1465.5,-965.89"/>
</g>
<!-- tensor_reduce_e7_t2_p0&#45;&gt;pipeline_transfer -->
<g id="edge208" class="edge">
<title>tensor_reduce_e7_t2_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M1581.55,-892.22C1634.7,-882 1698.2,-871.43 1756,-866.14 2418.16,-805.51 7242.36,-808.69 8265.6,-810.07"/>
<polygon fill="black" stroke="black" points="8265.62,-813.57 8275.62,-810.08 8265.63,-806.57 8265.62,-813.57"/>
</g>
<!-- attention_e7_t3_p0&#45;&gt;moe_e7_t3_e0_p0 -->
<g id="edge174" class="edge">
<title>attention_e7_t3_p0&#45;&gt;moe_e7_t3_e0_p0</title>
<path fill="none" stroke="black" d="M1615.96,-1079.57C1633.12,-1069.99 1652.86,-1058.96 1670.8,-1048.95"/>
<polygon fill="black" stroke="black" points="1672.96,-1051.75 1679.99,-1043.82 1669.55,-1045.64 1672.96,-1051.75"/>
</g>
<!-- attention_e7_t3_p0&#45;&gt;moe_e7_t3_e1_p0 -->
<g id="edge175" class="edge">
<title>attention_e7_t3_p0&#45;&gt;moe_e7_t3_e1_p0</title>
<path fill="none" stroke="black" d="M1692.45,-1079.63C1743.95,-1069.01 1804.09,-1056.61 1856.62,-1045.77"/>
<polygon fill="black" stroke="black" points="1857.59,-1049.15 1866.68,-1043.7 1856.18,-1042.29 1857.59,-1049.15"/>
</g>
<!-- tensor_reduce_e7_t3_p0 -->
<g id="node145" class="node">
<title>tensor_reduce_e7_t3_p0</title>
<ellipse fill="lightyellow" stroke="black" cx="1938" cy="-918.91" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1938" y="-932.91" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="1938" y="-921.91" font-family="Arial" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="1938" y="-910.91" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1938" y="-899.91" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t3_e0_p0&#45;&gt;tensor_reduce_e7_t3_p0 -->
<g id="edge176" class="edge">
<title>moe_e7_t3_e0_p0&#45;&gt;tensor_reduce_e7_t3_p0</title>
<path fill="none" stroke="black" d="M1780.13,-991.63C1803.51,-981.01 1831.24,-968.41 1856.88,-956.76"/>
<polygon fill="black" stroke="black" points="1858.57,-959.84 1866.23,-952.52 1855.67,-953.47 1858.57,-959.84"/>
</g>
<!-- moe_e7_t3_e1_p0&#45;&gt;tensor_reduce_e7_t3_p0 -->
<g id="edge177" class="edge">
<title>moe_e7_t3_e1_p0&#45;&gt;tensor_reduce_e7_t3_p0</title>
<path fill="none" stroke="black" d="M1974.99,-991.51C1970.74,-983.27 1965.88,-973.87 1961.11,-964.64"/>
<polygon fill="black" stroke="black" points="1964.1,-962.8 1956.4,-955.52 1957.88,-966.01 1964.1,-962.8"/>
</g>
<!-- tensor_reduce_e7_t3_p0&#45;&gt;pipeline_transfer -->
<g id="edge209" class="edge">
<title>tensor_reduce_e7_t3_p0&#45;&gt;pipeline_transfer</title>
<path fill="none" stroke="black" d="M2028.26,-887.51C2058.07,-878.86 2091.63,-870.59 2123,-866.14 2434.19,-822.02 7242.9,-812.22 8265.67,-810.63"/>
<polygon fill="black" stroke="black" points="8265.69,-814.13 8275.69,-810.62 8265.68,-807.13 8265.69,-814.13"/>
</g>
<!-- gate_e0_p1 -->
<g id="node146" class="node">
<title>gate_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="16367.24,-593.06 15946.89,-593.06 15838.76,-489.06 16259.11,-489.06 16367.24,-593.06"/>
<text text-anchor="middle" x="16103" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="16103" y="-544.06" font-family="Arial" font-size="10.00">GPU: 32&#45;35</text>
<text text-anchor="middle" x="16103" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="16103" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e0_p1 -->
<g id="node147" class="node">
<title>all2all_local_e0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="16005" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="16005" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="16005" y="-419.29" font-family="Arial" font-size="10.00">GPU: 32&#45;35</text>
<text text-anchor="middle" x="16005" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="16005" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e0_p1&#45;&gt;all2all_local_e0_p1 -->
<g id="edge219" class="edge">
<title>gate_e0_p1&#45;&gt;all2all_local_e0_p1</title>
<path fill="none" stroke="black" d="M16062.01,-488.71C16054.54,-479.36 16046.82,-469.69 16039.57,-460.6"/>
<polygon fill="black" stroke="black" points="16042.3,-458.41 16033.33,-452.78 16036.83,-462.78 16042.3,-458.41"/>
</g>
<!-- moe_e0_t0_e0_p1 -->
<g id="node149" class="node">
<title>moe_e0_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="15415.5,-255.52 15170.5,-255.52 15170.5,-203.52 15415.5,-203.52 15415.5,-255.52"/>
<text text-anchor="middle" x="15293" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="15293" y="-232.52" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="15293" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15293" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t0_e0_p1 -->
<g id="edge420" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15866.54,-516.06C15742.64,-500.89 15605.21,-479.23 15549,-453.06 15451.39,-407.62 15362.64,-313.59 15319.87,-263.54"/>
<polygon fill="black" stroke="black" points="15322.29,-260.98 15313.16,-255.61 15316.94,-265.5 15322.29,-260.98"/>
</g>
<!-- moe_e0_t0_e1_p1 -->
<g id="node150" class="node">
<title>moe_e0_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="15678.5,-255.52 15433.5,-255.52 15433.5,-203.52 15678.5,-203.52 15678.5,-255.52"/>
<text text-anchor="middle" x="15556" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="15556" y="-232.52" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="15556" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15556" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t0_e1_p1 -->
<g id="edge422" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15854.3,-488.97C15711.33,-453.88 15552.1,-402.98 15511,-343.52 15494.14,-319.13 15509.32,-287.49 15526.46,-263.9"/>
<polygon fill="black" stroke="black" points="15529.27,-265.99 15532.56,-255.91 15523.71,-261.74 15529.27,-265.99"/>
</g>
<!-- moe_e0_t1_e0_p1 -->
<g id="node153" class="node">
<title>moe_e0_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="15941.5,-255.52 15696.5,-255.52 15696.5,-203.52 15941.5,-203.52 15941.5,-255.52"/>
<text text-anchor="middle" x="15819" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="15819" y="-232.52" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="15819" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15819" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t1_e0_p1 -->
<g id="edge424" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15879.93,-489.04C15851.47,-478.4 15828.81,-466.33 15819,-453.06 15797.74,-424.32 15807.22,-320.82 15814.1,-265.68"/>
<polygon fill="black" stroke="black" points="15817.59,-266.02 15815.39,-255.66 15810.65,-265.13 15817.59,-266.02"/>
</g>
<!-- moe_e0_t1_e1_p1 -->
<g id="node154" class="node">
<title>moe_e0_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="16204.5,-255.52 15959.5,-255.52 15959.5,-203.52 16204.5,-203.52 16204.5,-255.52"/>
<text text-anchor="middle" x="16082" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="16082" y="-232.52" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="16082" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16082" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t1_e1_p1 -->
<g id="edge426" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16167.44,-489.05C16177.04,-478.27 16185.54,-466.15 16191,-453.06 16203.59,-422.9 16198.22,-411.4 16191,-379.52 16181.43,-337.25 16174.84,-326.31 16149,-291.52 16141.3,-281.16 16131.66,-271.17 16122.1,-262.38"/>
<polygon fill="black" stroke="black" points="16124.29,-259.65 16114.5,-255.61 16119.63,-264.87 16124.29,-259.65"/>
</g>
<!-- moe_e0_t2_e0_p1 -->
<g id="node157" class="node">
<title>moe_e0_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="16467.5,-255.52 16222.5,-255.52 16222.5,-203.52 16467.5,-203.52 16467.5,-255.52"/>
<text text-anchor="middle" x="16345" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="16345" y="-232.52" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="16345" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16345" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t2_e0_p1 -->
<g id="edge428" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16270.99,-500.18C16353.34,-471.25 16445.1,-422.82 16494,-343.52 16506.13,-323.85 16506.88,-310.71 16494,-291.52 16485.37,-278.67 16473.51,-268.53 16460.21,-260.52"/>
<polygon fill="black" stroke="black" points="16461.72,-257.35 16451.28,-255.55 16458.32,-263.47 16461.72,-257.35"/>
</g>
<!-- moe_e0_t2_e1_p1 -->
<g id="node158" class="node">
<title>moe_e0_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="16730.5,-255.52 16485.5,-255.52 16485.5,-203.52 16730.5,-203.52 16730.5,-255.52"/>
<text text-anchor="middle" x="16608" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="16608" y="-232.52" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="16608" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16608" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t2_e1_p1 -->
<g id="edge430" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16283.56,-512.37C16332.39,-499.45 16383.46,-480.58 16426,-453.06 16465.28,-427.65 16544.63,-320.11 16584.3,-264.36"/>
<polygon fill="black" stroke="black" points="16587.39,-266.06 16590.31,-255.88 16581.68,-262.01 16587.39,-266.06"/>
</g>
<!-- moe_e0_t3_e0_p1 -->
<g id="node161" class="node">
<title>moe_e0_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="16993.5,-255.52 16748.5,-255.52 16748.5,-203.52 16993.5,-203.52 16993.5,-255.52"/>
<text text-anchor="middle" x="16871" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="16871" y="-232.52" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="16871" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16871" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t3_e0_p1 -->
<g id="edge432" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16288.25,-516.87C16488.36,-487.72 16788.39,-430.67 16861,-343.52 16878.76,-322.21 16880,-290.13 16877.53,-265.59"/>
<polygon fill="black" stroke="black" points="16880.99,-265.08 16876.28,-255.59 16874.04,-265.95 16880.99,-265.08"/>
</g>
<!-- moe_e0_t3_e1_p1 -->
<g id="node162" class="node">
<title>moe_e0_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="17256.5,-255.52 17011.5,-255.52 17011.5,-203.52 17256.5,-203.52 17256.5,-255.52"/>
<text text-anchor="middle" x="17134" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="17134" y="-232.52" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="17134" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="17134" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e0_p1&#45;&gt;moe_e0_t3_e1_p1 -->
<g id="edge434" class="edge">
<title>gate_e0_p1&#45;&gt;moe_e0_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16301.87,-529.98C16425.05,-519.39 16585.11,-497.65 16721,-453.06 16864.34,-406.03 17016.46,-310.56 17089.62,-261.36"/>
<polygon fill="black" stroke="black" points="17091.82,-264.1 17098.14,-255.6 17087.9,-258.3 17091.82,-264.1"/>
</g>
<!-- attention_e0_t0_p1 -->
<g id="node148" class="node">
<title>attention_e0_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="15790,-343.52 15520,-343.52 15520,-291.52 15790,-291.52 15790,-343.52"/>
<text text-anchor="middle" x="15655" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15655" y="-320.52" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="15655" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="15655" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p1&#45;&gt;attention_e0_t0_p1 -->
<g id="edge220" class="edge">
<title>all2all_local_e0_p1&#45;&gt;attention_e0_t0_p1</title>
<path fill="none" stroke="black" d="M15900.94,-386.52C15854.94,-373.8 15801.08,-358.91 15755.5,-346.31"/>
<polygon fill="black" stroke="black" points="15756.18,-342.87 15745.61,-343.57 15754.32,-349.61 15756.18,-342.87"/>
</g>
<!-- attention_e0_t1_p1 -->
<g id="node152" class="node">
<title>attention_e0_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="16140,-343.52 15870,-343.52 15870,-291.52 16140,-291.52 16140,-343.52"/>
<text text-anchor="middle" x="16005" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16005" y="-320.52" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="16005" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="16005" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p1&#45;&gt;attention_e0_t1_p1 -->
<g id="edge225" class="edge">
<title>all2all_local_e0_p1&#45;&gt;attention_e0_t1_p1</title>
<path fill="none" stroke="black" d="M16005,-379.26C16005,-370.95 16005,-362.11 16005,-353.83"/>
<polygon fill="black" stroke="black" points="16008.5,-353.72 16005,-343.72 16001.5,-353.72 16008.5,-353.72"/>
</g>
<!-- attention_e0_t2_p1 -->
<g id="node156" class="node">
<title>attention_e0_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="16485,-343.52 16215,-343.52 16215,-291.52 16485,-291.52 16485,-343.52"/>
<text text-anchor="middle" x="16350" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16350" y="-320.52" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="16350" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="16350" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p1&#45;&gt;attention_e0_t2_p1 -->
<g id="edge230" class="edge">
<title>all2all_local_e0_p1&#45;&gt;attention_e0_t2_p1</title>
<path fill="none" stroke="black" d="M16108.04,-386.39C16153.27,-373.7 16206.15,-358.87 16250.91,-346.31"/>
<polygon fill="black" stroke="black" points="16251.95,-349.66 16260.63,-343.59 16250.06,-342.92 16251.95,-349.66"/>
</g>
<!-- attention_e0_t3_p1 -->
<g id="node160" class="node">
<title>attention_e0_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="16852,-343.52 16582,-343.52 16582,-291.52 16852,-291.52 16852,-343.52"/>
<text text-anchor="middle" x="16717" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16717" y="-320.52" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="16717" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="16717" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e0_p1&#45;&gt;attention_e0_t3_p1 -->
<g id="edge235" class="edge">
<title>all2all_local_e0_p1&#45;&gt;attention_e0_t3_p1</title>
<path fill="none" stroke="black" d="M16150.8,-395.48C16273.77,-378.76 16448.87,-354.96 16571.7,-338.27"/>
<polygon fill="black" stroke="black" points="16572.5,-341.69 16581.93,-336.88 16571.55,-334.76 16572.5,-341.69"/>
</g>
<!-- attention_e0_t0_p1&#45;&gt;moe_e0_t0_e0_p1 -->
<g id="edge221" class="edge">
<title>attention_e0_t0_p1&#45;&gt;moe_e0_t0_e0_p1</title>
<path fill="none" stroke="black" d="M15549.32,-291.42C15505.09,-280.91 15453.55,-268.66 15408.34,-257.92"/>
<polygon fill="black" stroke="black" points="15409.04,-254.49 15398.5,-255.58 15407.42,-261.3 15409.04,-254.49"/>
</g>
<!-- attention_e0_t0_p1&#45;&gt;moe_e0_t0_e1_p1 -->
<g id="edge222" class="edge">
<title>attention_e0_t0_p1&#45;&gt;moe_e0_t0_e1_p1</title>
<path fill="none" stroke="black" d="M15626.1,-291.42C15615.72,-282.4 15603.87,-272.11 15592.9,-262.58"/>
<polygon fill="black" stroke="black" points="15594.95,-259.72 15585.11,-255.81 15590.36,-265.01 15594.95,-259.72"/>
</g>
<!-- tensor_reduce_e0_t0_p1 -->
<g id="node151" class="node">
<title>tensor_reduce_e0_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="15343" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="15343" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="15343" y="-133.75" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="15343" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15343" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t0_e0_p1&#45;&gt;tensor_reduce_e0_t0_p1 -->
<g id="edge223" class="edge">
<title>moe_e0_t0_e0_p1&#45;&gt;tensor_reduce_e0_t0_p1</title>
<path fill="none" stroke="black" d="M15306.01,-203.35C15310.26,-195.12 15315.12,-185.71 15319.89,-176.48"/>
<polygon fill="black" stroke="black" points="15323.12,-177.85 15324.6,-167.36 15316.9,-174.64 15323.12,-177.85"/>
</g>
<!-- moe_e0_t0_e1_p1&#45;&gt;tensor_reduce_e0_t0_p1 -->
<g id="edge224" class="edge">
<title>moe_e0_t0_e1_p1&#45;&gt;tensor_reduce_e0_t0_p1</title>
<path fill="none" stroke="black" d="M15500.87,-203.48C15477.49,-192.85 15449.76,-180.25 15424.12,-168.6"/>
<polygon fill="black" stroke="black" points="15425.33,-165.31 15414.77,-164.36 15422.43,-171.68 15425.33,-165.31"/>
</g>
<!-- output -->
<g id="node293" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="8825" cy="-28.99" rx="202.88" ry="28.98"/>
<text text-anchor="middle" x="8825" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="8825" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="8825" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, vocab_size=50000]</text>
</g>
<!-- tensor_reduce_e0_t0_p1&#45;&gt;output -->
<g id="edge387" class="edge">
<title>tensor_reduce_e0_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15252.75,-99.33C15222.94,-90.68 15189.37,-82.41 15158,-77.98 14849.04,-34.37 10107.43,-30.37 9038.12,-30.02"/>
<polygon fill="black" stroke="black" points="9038.02,-26.52 9028.02,-30.02 9038.01,-33.52 9038.02,-26.52"/>
</g>
<!-- attention_e0_t1_p1&#45;&gt;moe_e0_t1_e0_p1 -->
<g id="edge226" class="edge">
<title>attention_e0_t1_p1&#45;&gt;moe_e0_t1_e0_p1</title>
<path fill="none" stroke="black" d="M15950.7,-291.42C15929.4,-281.57 15904.81,-270.2 15882.68,-259.97"/>
<polygon fill="black" stroke="black" points="15883.91,-256.68 15873.37,-255.66 15880.97,-263.03 15883.91,-256.68"/>
</g>
<!-- attention_e0_t1_p1&#45;&gt;moe_e0_t1_e1_p1 -->
<g id="edge227" class="edge">
<title>attention_e0_t1_p1&#45;&gt;moe_e0_t1_e1_p1</title>
<path fill="none" stroke="black" d="M16027.69,-291.18C16035.52,-282.44 16044.41,-272.51 16052.69,-263.25"/>
<polygon fill="black" stroke="black" points="16055.41,-265.46 16059.48,-255.68 16050.2,-260.79 16055.41,-265.46"/>
</g>
<!-- tensor_reduce_e0_t1_p1 -->
<g id="node155" class="node">
<title>tensor_reduce_e0_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="15819" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="15819" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="15819" y="-133.75" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="15819" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15819" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t1_e0_p1&#45;&gt;tensor_reduce_e0_t1_p1 -->
<g id="edge228" class="edge">
<title>moe_e0_t1_e0_p1&#45;&gt;tensor_reduce_e0_t1_p1</title>
<path fill="none" stroke="black" d="M15819,-203.35C15819,-195.54 15819,-186.68 15819,-177.91"/>
<polygon fill="black" stroke="black" points="15822.5,-177.73 15819,-167.73 15815.5,-177.73 15822.5,-177.73"/>
</g>
<!-- moe_e0_t1_e1_p1&#45;&gt;tensor_reduce_e0_t1_p1 -->
<g id="edge229" class="edge">
<title>moe_e0_t1_e1_p1&#45;&gt;tensor_reduce_e0_t1_p1</title>
<path fill="none" stroke="black" d="M16013.93,-203.48C15983.31,-192.21 15946.67,-178.73 15913.46,-166.51"/>
<polygon fill="black" stroke="black" points="15914.32,-163.1 15903.73,-162.93 15911.91,-169.67 15914.32,-163.1"/>
</g>
<!-- tensor_reduce_e0_t1_p1&#45;&gt;output -->
<g id="edge388" class="edge">
<title>tensor_reduce_e0_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M15699.45,-104.03C15646.31,-93.81 15582.81,-83.24 15525,-77.98 15195.04,-47.96 10144.24,-33.36 9038.03,-30.52"/>
<polygon fill="black" stroke="black" points="9038,-27.02 9027.99,-30.49 9037.98,-34.02 9038,-27.02"/>
</g>
<!-- attention_e0_t2_p1&#45;&gt;moe_e0_t2_e0_p1 -->
<g id="edge231" class="edge">
<title>attention_e0_t2_p1&#45;&gt;moe_e0_t2_e0_p1</title>
<path fill="none" stroke="black" d="M16348.53,-291.18C16348.06,-283.22 16347.54,-274.29 16347.05,-265.77"/>
<polygon fill="black" stroke="black" points="16350.54,-265.46 16346.46,-255.68 16343.55,-265.86 16350.54,-265.46"/>
</g>
<!-- attention_e0_t2_p1&#45;&gt;moe_e0_t2_e1_p1 -->
<g id="edge232" class="edge">
<title>attention_e0_t2_p1&#45;&gt;moe_e0_t2_e1_p1</title>
<path fill="none" stroke="black" d="M16425.32,-291.42C16455.92,-281.22 16491.42,-269.38 16522.94,-258.87"/>
<polygon fill="black" stroke="black" points="16524.21,-262.14 16532.59,-255.66 16521.99,-255.5 16524.21,-262.14"/>
</g>
<!-- tensor_reduce_e0_t2_p1 -->
<g id="node159" class="node">
<title>tensor_reduce_e0_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="16345" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="16345" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="16345" y="-133.75" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="16345" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16345" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t2_e0_p1&#45;&gt;tensor_reduce_e0_t2_p1 -->
<g id="edge233" class="edge">
<title>moe_e0_t2_e0_p1&#45;&gt;tensor_reduce_e0_t2_p1</title>
<path fill="none" stroke="black" d="M16345,-203.35C16345,-195.54 16345,-186.68 16345,-177.91"/>
<polygon fill="black" stroke="black" points="16348.5,-177.73 16345,-167.73 16341.5,-177.73 16348.5,-177.73"/>
</g>
<!-- moe_e0_t2_e1_p1&#45;&gt;tensor_reduce_e0_t2_p1 -->
<g id="edge234" class="edge">
<title>moe_e0_t2_e1_p1&#45;&gt;tensor_reduce_e0_t2_p1</title>
<path fill="none" stroke="black" d="M16539.93,-203.48C16509.31,-192.21 16472.67,-178.73 16439.46,-166.51"/>
<polygon fill="black" stroke="black" points="16440.32,-163.1 16429.73,-162.93 16437.91,-169.67 16440.32,-163.1"/>
</g>
<!-- tensor_reduce_e0_t2_p1&#45;&gt;output -->
<g id="edge389" class="edge">
<title>tensor_reduce_e0_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16216.45,-105.96C16152.02,-95.17 16072.65,-83.59 16001,-77.98 15645.68,-50.2 10190.6,-33.74 9037.9,-30.56"/>
<polygon fill="black" stroke="black" points="9037.86,-27.06 9027.85,-30.53 9037.84,-34.06 9037.86,-27.06"/>
</g>
<!-- attention_e0_t3_p1&#45;&gt;moe_e0_t3_e0_p1 -->
<g id="edge236" class="edge">
<title>attention_e0_t3_p1&#45;&gt;moe_e0_t3_e0_p1</title>
<path fill="none" stroke="black" d="M16761.96,-291.42C16779.12,-281.83 16798.86,-270.81 16816.8,-260.79"/>
<polygon fill="black" stroke="black" points="16818.96,-263.59 16825.99,-255.66 16815.55,-257.48 16818.96,-263.59"/>
</g>
<!-- attention_e0_t3_p1&#45;&gt;moe_e0_t3_e1_p1 -->
<g id="edge237" class="edge">
<title>attention_e0_t3_p1&#45;&gt;moe_e0_t3_e1_p1</title>
<path fill="none" stroke="black" d="M16838.45,-291.47C16889.95,-280.85 16950.09,-268.45 17002.62,-257.62"/>
<polygon fill="black" stroke="black" points="17003.59,-260.99 17012.68,-255.54 17002.18,-254.13 17003.59,-260.99"/>
</g>
<!-- tensor_reduce_e0_t3_p1 -->
<g id="node163" class="node">
<title>tensor_reduce_e0_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="16871" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="16871" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="16871" y="-133.75" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="16871" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="16871" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e0_t3_e0_p1&#45;&gt;tensor_reduce_e0_t3_p1 -->
<g id="edge238" class="edge">
<title>moe_e0_t3_e0_p1&#45;&gt;tensor_reduce_e0_t3_p1</title>
<path fill="none" stroke="black" d="M16871,-203.35C16871,-195.54 16871,-186.68 16871,-177.91"/>
<polygon fill="black" stroke="black" points="16874.5,-177.73 16871,-167.73 16867.5,-177.73 16874.5,-177.73"/>
</g>
<!-- moe_e0_t3_e1_p1&#45;&gt;tensor_reduce_e0_t3_p1 -->
<g id="edge239" class="edge">
<title>moe_e0_t3_e1_p1&#45;&gt;tensor_reduce_e0_t3_p1</title>
<path fill="none" stroke="black" d="M17065.93,-203.48C17035.31,-192.21 16998.67,-178.73 16965.46,-166.51"/>
<polygon fill="black" stroke="black" points="16966.32,-163.1 16955.73,-162.93 16963.91,-169.67 16966.32,-163.1"/>
</g>
<!-- tensor_reduce_e0_t3_p1&#45;&gt;output -->
<g id="edge390" class="edge">
<title>tensor_reduce_e0_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M16742.45,-105.94C16678.02,-95.15 16598.65,-83.57 16527,-77.98 16144.02,-48.13 10241.33,-33.2 9038.13,-30.46"/>
<polygon fill="black" stroke="black" points="9038.09,-26.96 9028.08,-30.43 9038.07,-33.96 9038.09,-26.96"/>
</g>
<!-- gate_e1_p1 -->
<g id="node164" class="node">
<title>gate_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="14256.24,-593.06 13835.89,-593.06 13727.76,-489.06 14148.11,-489.06 14256.24,-593.06"/>
<text text-anchor="middle" x="13992" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="13992" y="-544.06" font-family="Arial" font-size="10.00">GPU: 36&#45;39</text>
<text text-anchor="middle" x="13992" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="13992" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e1_p1 -->
<g id="node165" class="node">
<title>all2all_local_e1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="13894" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="13894" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="13894" y="-419.29" font-family="Arial" font-size="10.00">GPU: 36&#45;39</text>
<text text-anchor="middle" x="13894" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="13894" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e1_p1&#45;&gt;all2all_local_e1_p1 -->
<g id="edge240" class="edge">
<title>gate_e1_p1&#45;&gt;all2all_local_e1_p1</title>
<path fill="none" stroke="black" d="M13951.01,-488.71C13943.54,-479.36 13935.82,-469.69 13928.57,-460.6"/>
<polygon fill="black" stroke="black" points="13931.3,-458.41 13922.33,-452.78 13925.83,-462.78 13931.3,-458.41"/>
</g>
<!-- moe_e1_t0_e0_p1 -->
<g id="node167" class="node">
<title>moe_e1_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="13304.5,-255.52 13059.5,-255.52 13059.5,-203.52 13304.5,-203.52 13304.5,-255.52"/>
<text text-anchor="middle" x="13182" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="13182" y="-232.52" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="13182" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13182" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t0_e0_p1 -->
<g id="edge436" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13755.54,-516.06C13631.64,-500.89 13494.21,-479.23 13438,-453.06 13340.39,-407.62 13251.64,-313.59 13208.87,-263.54"/>
<polygon fill="black" stroke="black" points="13211.29,-260.98 13202.16,-255.61 13205.94,-265.5 13211.29,-260.98"/>
</g>
<!-- moe_e1_t0_e1_p1 -->
<g id="node168" class="node">
<title>moe_e1_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="13567.5,-255.52 13322.5,-255.52 13322.5,-203.52 13567.5,-203.52 13567.5,-255.52"/>
<text text-anchor="middle" x="13445" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="13445" y="-232.52" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="13445" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13445" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t0_e1_p1 -->
<g id="edge438" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13743.3,-488.97C13600.33,-453.88 13441.1,-402.98 13400,-343.52 13383.14,-319.13 13398.32,-287.49 13415.46,-263.9"/>
<polygon fill="black" stroke="black" points="13418.27,-265.99 13421.56,-255.91 13412.71,-261.74 13418.27,-265.99"/>
</g>
<!-- moe_e1_t1_e0_p1 -->
<g id="node171" class="node">
<title>moe_e1_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="13830.5,-255.52 13585.5,-255.52 13585.5,-203.52 13830.5,-203.52 13830.5,-255.52"/>
<text text-anchor="middle" x="13708" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="13708" y="-232.52" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="13708" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13708" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t1_e0_p1 -->
<g id="edge440" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13768.93,-489.04C13740.47,-478.4 13717.81,-466.33 13708,-453.06 13686.74,-424.32 13696.22,-320.82 13703.1,-265.68"/>
<polygon fill="black" stroke="black" points="13706.59,-266.02 13704.39,-255.66 13699.65,-265.13 13706.59,-266.02"/>
</g>
<!-- moe_e1_t1_e1_p1 -->
<g id="node172" class="node">
<title>moe_e1_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="14093.5,-255.52 13848.5,-255.52 13848.5,-203.52 14093.5,-203.52 14093.5,-255.52"/>
<text text-anchor="middle" x="13971" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="13971" y="-232.52" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="13971" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13971" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t1_e1_p1 -->
<g id="edge442" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14056.44,-489.05C14066.04,-478.27 14074.54,-466.15 14080,-453.06 14092.59,-422.9 14087.22,-411.4 14080,-379.52 14070.43,-337.25 14063.84,-326.31 14038,-291.52 14030.3,-281.16 14020.66,-271.17 14011.1,-262.38"/>
<polygon fill="black" stroke="black" points="14013.29,-259.65 14003.5,-255.61 14008.63,-264.87 14013.29,-259.65"/>
</g>
<!-- moe_e1_t2_e0_p1 -->
<g id="node175" class="node">
<title>moe_e1_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="14356.5,-255.52 14111.5,-255.52 14111.5,-203.52 14356.5,-203.52 14356.5,-255.52"/>
<text text-anchor="middle" x="14234" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="14234" y="-232.52" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="14234" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14234" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t2_e0_p1 -->
<g id="edge444" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14159.99,-500.18C14242.34,-471.25 14334.1,-422.82 14383,-343.52 14395.13,-323.85 14395.88,-310.71 14383,-291.52 14374.37,-278.67 14362.51,-268.53 14349.21,-260.52"/>
<polygon fill="black" stroke="black" points="14350.72,-257.35 14340.28,-255.55 14347.32,-263.47 14350.72,-257.35"/>
</g>
<!-- moe_e1_t2_e1_p1 -->
<g id="node176" class="node">
<title>moe_e1_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="14619.5,-255.52 14374.5,-255.52 14374.5,-203.52 14619.5,-203.52 14619.5,-255.52"/>
<text text-anchor="middle" x="14497" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="14497" y="-232.52" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="14497" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14497" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t2_e1_p1 -->
<g id="edge446" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14172.56,-512.37C14221.39,-499.45 14272.46,-480.58 14315,-453.06 14354.28,-427.65 14433.63,-320.11 14473.3,-264.36"/>
<polygon fill="black" stroke="black" points="14476.39,-266.06 14479.31,-255.88 14470.68,-262.01 14476.39,-266.06"/>
</g>
<!-- moe_e1_t3_e0_p1 -->
<g id="node179" class="node">
<title>moe_e1_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="14882.5,-255.52 14637.5,-255.52 14637.5,-203.52 14882.5,-203.52 14882.5,-255.52"/>
<text text-anchor="middle" x="14760" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="14760" y="-232.52" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="14760" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14760" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t3_e0_p1 -->
<g id="edge448" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14177.25,-516.87C14377.36,-487.72 14677.39,-430.67 14750,-343.52 14767.76,-322.21 14769,-290.13 14766.53,-265.59"/>
<polygon fill="black" stroke="black" points="14769.99,-265.08 14765.28,-255.59 14763.04,-265.95 14769.99,-265.08"/>
</g>
<!-- moe_e1_t3_e1_p1 -->
<g id="node180" class="node">
<title>moe_e1_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="15145.5,-255.52 14900.5,-255.52 14900.5,-203.52 15145.5,-203.52 15145.5,-255.52"/>
<text text-anchor="middle" x="15023" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="15023" y="-232.52" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="15023" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="15023" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e1_p1&#45;&gt;moe_e1_t3_e1_p1 -->
<g id="edge450" class="edge">
<title>gate_e1_p1&#45;&gt;moe_e1_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14190.87,-529.98C14314.05,-519.39 14474.11,-497.65 14610,-453.06 14753.34,-406.03 14905.46,-310.56 14978.62,-261.36"/>
<polygon fill="black" stroke="black" points="14980.82,-264.1 14987.14,-255.6 14976.9,-258.3 14980.82,-264.1"/>
</g>
<!-- attention_e1_t0_p1 -->
<g id="node166" class="node">
<title>attention_e1_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="13679,-343.52 13409,-343.52 13409,-291.52 13679,-291.52 13679,-343.52"/>
<text text-anchor="middle" x="13544" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13544" y="-320.52" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="13544" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="13544" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p1&#45;&gt;attention_e1_t0_p1 -->
<g id="edge241" class="edge">
<title>all2all_local_e1_p1&#45;&gt;attention_e1_t0_p1</title>
<path fill="none" stroke="black" d="M13789.94,-386.52C13743.94,-373.8 13690.08,-358.91 13644.5,-346.31"/>
<polygon fill="black" stroke="black" points="13645.18,-342.87 13634.61,-343.57 13643.32,-349.61 13645.18,-342.87"/>
</g>
<!-- attention_e1_t1_p1 -->
<g id="node170" class="node">
<title>attention_e1_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="14029,-343.52 13759,-343.52 13759,-291.52 14029,-291.52 14029,-343.52"/>
<text text-anchor="middle" x="13894" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13894" y="-320.52" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="13894" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="13894" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p1&#45;&gt;attention_e1_t1_p1 -->
<g id="edge246" class="edge">
<title>all2all_local_e1_p1&#45;&gt;attention_e1_t1_p1</title>
<path fill="none" stroke="black" d="M13894,-379.26C13894,-370.95 13894,-362.11 13894,-353.83"/>
<polygon fill="black" stroke="black" points="13897.5,-353.72 13894,-343.72 13890.5,-353.72 13897.5,-353.72"/>
</g>
<!-- attention_e1_t2_p1 -->
<g id="node174" class="node">
<title>attention_e1_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="14374,-343.52 14104,-343.52 14104,-291.52 14374,-291.52 14374,-343.52"/>
<text text-anchor="middle" x="14239" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14239" y="-320.52" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="14239" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="14239" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p1&#45;&gt;attention_e1_t2_p1 -->
<g id="edge251" class="edge">
<title>all2all_local_e1_p1&#45;&gt;attention_e1_t2_p1</title>
<path fill="none" stroke="black" d="M13997.04,-386.39C14042.27,-373.7 14095.15,-358.87 14139.91,-346.31"/>
<polygon fill="black" stroke="black" points="14140.95,-349.66 14149.63,-343.59 14139.06,-342.92 14140.95,-349.66"/>
</g>
<!-- attention_e1_t3_p1 -->
<g id="node178" class="node">
<title>attention_e1_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="14741,-343.52 14471,-343.52 14471,-291.52 14741,-291.52 14741,-343.52"/>
<text text-anchor="middle" x="14606" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14606" y="-320.52" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="14606" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="14606" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e1_p1&#45;&gt;attention_e1_t3_p1 -->
<g id="edge256" class="edge">
<title>all2all_local_e1_p1&#45;&gt;attention_e1_t3_p1</title>
<path fill="none" stroke="black" d="M14039.8,-395.48C14162.77,-378.76 14337.87,-354.96 14460.7,-338.27"/>
<polygon fill="black" stroke="black" points="14461.5,-341.69 14470.93,-336.88 14460.55,-334.76 14461.5,-341.69"/>
</g>
<!-- attention_e1_t0_p1&#45;&gt;moe_e1_t0_e0_p1 -->
<g id="edge242" class="edge">
<title>attention_e1_t0_p1&#45;&gt;moe_e1_t0_e0_p1</title>
<path fill="none" stroke="black" d="M13438.32,-291.42C13394.09,-280.91 13342.55,-268.66 13297.34,-257.92"/>
<polygon fill="black" stroke="black" points="13298.04,-254.49 13287.5,-255.58 13296.42,-261.3 13298.04,-254.49"/>
</g>
<!-- attention_e1_t0_p1&#45;&gt;moe_e1_t0_e1_p1 -->
<g id="edge243" class="edge">
<title>attention_e1_t0_p1&#45;&gt;moe_e1_t0_e1_p1</title>
<path fill="none" stroke="black" d="M13515.1,-291.42C13504.72,-282.4 13492.87,-272.11 13481.9,-262.58"/>
<polygon fill="black" stroke="black" points="13483.95,-259.72 13474.11,-255.81 13479.36,-265.01 13483.95,-259.72"/>
</g>
<!-- tensor_reduce_e1_t0_p1 -->
<g id="node169" class="node">
<title>tensor_reduce_e1_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="13232" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="13232" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="13232" y="-133.75" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="13232" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13232" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t0_e0_p1&#45;&gt;tensor_reduce_e1_t0_p1 -->
<g id="edge244" class="edge">
<title>moe_e1_t0_e0_p1&#45;&gt;tensor_reduce_e1_t0_p1</title>
<path fill="none" stroke="black" d="M13195.01,-203.35C13199.26,-195.12 13204.12,-185.71 13208.89,-176.48"/>
<polygon fill="black" stroke="black" points="13212.12,-177.85 13213.6,-167.36 13205.9,-174.64 13212.12,-177.85"/>
</g>
<!-- moe_e1_t0_e1_p1&#45;&gt;tensor_reduce_e1_t0_p1 -->
<g id="edge245" class="edge">
<title>moe_e1_t0_e1_p1&#45;&gt;tensor_reduce_e1_t0_p1</title>
<path fill="none" stroke="black" d="M13389.87,-203.48C13366.49,-192.85 13338.76,-180.25 13313.12,-168.6"/>
<polygon fill="black" stroke="black" points="13314.33,-165.31 13303.77,-164.36 13311.43,-171.68 13314.33,-165.31"/>
</g>
<!-- tensor_reduce_e1_t0_p1&#45;&gt;output -->
<g id="edge391" class="edge">
<title>tensor_reduce_e1_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13141.27,-99.27C13111.57,-90.67 13078.2,-82.45 13047,-77.98 12847.26,-49.4 9867.21,-34.48 9037.81,-30.87"/>
<polygon fill="black" stroke="black" points="9037.56,-27.37 9027.55,-30.82 9037.53,-34.37 9037.56,-27.37"/>
</g>
<!-- attention_e1_t1_p1&#45;&gt;moe_e1_t1_e0_p1 -->
<g id="edge247" class="edge">
<title>attention_e1_t1_p1&#45;&gt;moe_e1_t1_e0_p1</title>
<path fill="none" stroke="black" d="M13839.7,-291.42C13818.4,-281.57 13793.81,-270.2 13771.68,-259.97"/>
<polygon fill="black" stroke="black" points="13772.91,-256.68 13762.37,-255.66 13769.97,-263.03 13772.91,-256.68"/>
</g>
<!-- attention_e1_t1_p1&#45;&gt;moe_e1_t1_e1_p1 -->
<g id="edge248" class="edge">
<title>attention_e1_t1_p1&#45;&gt;moe_e1_t1_e1_p1</title>
<path fill="none" stroke="black" d="M13916.69,-291.18C13924.52,-282.44 13933.41,-272.51 13941.69,-263.25"/>
<polygon fill="black" stroke="black" points="13944.41,-265.46 13948.48,-255.68 13939.2,-260.79 13944.41,-265.46"/>
</g>
<!-- tensor_reduce_e1_t1_p1 -->
<g id="node173" class="node">
<title>tensor_reduce_e1_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="13708" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="13708" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="13708" y="-133.75" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="13708" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="13708" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t1_e0_p1&#45;&gt;tensor_reduce_e1_t1_p1 -->
<g id="edge249" class="edge">
<title>moe_e1_t1_e0_p1&#45;&gt;tensor_reduce_e1_t1_p1</title>
<path fill="none" stroke="black" d="M13708,-203.35C13708,-195.54 13708,-186.68 13708,-177.91"/>
<polygon fill="black" stroke="black" points="13711.5,-177.73 13708,-167.73 13704.5,-177.73 13711.5,-177.73"/>
</g>
<!-- moe_e1_t1_e1_p1&#45;&gt;tensor_reduce_e1_t1_p1 -->
<g id="edge250" class="edge">
<title>moe_e1_t1_e1_p1&#45;&gt;tensor_reduce_e1_t1_p1</title>
<path fill="none" stroke="black" d="M13902.93,-203.48C13872.31,-192.21 13835.67,-178.73 13802.46,-166.51"/>
<polygon fill="black" stroke="black" points="13803.32,-163.1 13792.73,-162.93 13800.91,-169.67 13803.32,-163.1"/>
</g>
<!-- tensor_reduce_e1_t1_p1&#45;&gt;output -->
<g id="edge392" class="edge">
<title>tensor_reduce_e1_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M13588.44,-104.12C13535.3,-93.92 13471.8,-83.34 13414,-77.98 12976.33,-37.44 9883.43,-31.13 9038.08,-30.16"/>
<polygon fill="black" stroke="black" points="9037.93,-26.66 9027.93,-30.15 9037.93,-33.66 9037.93,-26.66"/>
</g>
<!-- attention_e1_t2_p1&#45;&gt;moe_e1_t2_e0_p1 -->
<g id="edge252" class="edge">
<title>attention_e1_t2_p1&#45;&gt;moe_e1_t2_e0_p1</title>
<path fill="none" stroke="black" d="M14237.53,-291.18C14237.06,-283.22 14236.54,-274.29 14236.05,-265.77"/>
<polygon fill="black" stroke="black" points="14239.54,-265.46 14235.46,-255.68 14232.55,-265.86 14239.54,-265.46"/>
</g>
<!-- attention_e1_t2_p1&#45;&gt;moe_e1_t2_e1_p1 -->
<g id="edge253" class="edge">
<title>attention_e1_t2_p1&#45;&gt;moe_e1_t2_e1_p1</title>
<path fill="none" stroke="black" d="M14314.32,-291.42C14344.92,-281.22 14380.42,-269.38 14411.94,-258.87"/>
<polygon fill="black" stroke="black" points="14413.21,-262.14 14421.59,-255.66 14410.99,-255.5 14413.21,-262.14"/>
</g>
<!-- tensor_reduce_e1_t2_p1 -->
<g id="node177" class="node">
<title>tensor_reduce_e1_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="14234" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="14234" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="14234" y="-133.75" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="14234" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14234" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t2_e0_p1&#45;&gt;tensor_reduce_e1_t2_p1 -->
<g id="edge254" class="edge">
<title>moe_e1_t2_e0_p1&#45;&gt;tensor_reduce_e1_t2_p1</title>
<path fill="none" stroke="black" d="M14234,-203.35C14234,-195.54 14234,-186.68 14234,-177.91"/>
<polygon fill="black" stroke="black" points="14237.5,-177.73 14234,-167.73 14230.5,-177.73 14237.5,-177.73"/>
</g>
<!-- moe_e1_t2_e1_p1&#45;&gt;tensor_reduce_e1_t2_p1 -->
<g id="edge255" class="edge">
<title>moe_e1_t2_e1_p1&#45;&gt;tensor_reduce_e1_t2_p1</title>
<path fill="none" stroke="black" d="M14428.93,-203.48C14398.31,-192.21 14361.67,-178.73 14328.46,-166.51"/>
<polygon fill="black" stroke="black" points="14329.32,-163.1 14318.73,-162.93 14326.91,-169.67 14329.32,-163.1"/>
</g>
<!-- tensor_reduce_e1_t2_p1&#45;&gt;output -->
<g id="edge393" class="edge">
<title>tensor_reduce_e1_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14105.44,-106.04C14041.01,-95.27 13961.64,-83.68 13890,-77.98 13402.53,-39.18 9938.24,-31.58 9038.22,-30.25"/>
<polygon fill="black" stroke="black" points="9038.08,-26.75 9028.08,-30.23 9038.07,-33.75 9038.08,-26.75"/>
</g>
<!-- attention_e1_t3_p1&#45;&gt;moe_e1_t3_e0_p1 -->
<g id="edge257" class="edge">
<title>attention_e1_t3_p1&#45;&gt;moe_e1_t3_e0_p1</title>
<path fill="none" stroke="black" d="M14650.96,-291.42C14668.12,-281.83 14687.86,-270.81 14705.8,-260.79"/>
<polygon fill="black" stroke="black" points="14707.96,-263.59 14714.99,-255.66 14704.55,-257.48 14707.96,-263.59"/>
</g>
<!-- attention_e1_t3_p1&#45;&gt;moe_e1_t3_e1_p1 -->
<g id="edge258" class="edge">
<title>attention_e1_t3_p1&#45;&gt;moe_e1_t3_e1_p1</title>
<path fill="none" stroke="black" d="M14727.45,-291.47C14778.95,-280.85 14839.09,-268.45 14891.62,-257.62"/>
<polygon fill="black" stroke="black" points="14892.59,-260.99 14901.68,-255.54 14891.18,-254.13 14892.59,-260.99"/>
</g>
<!-- tensor_reduce_e1_t3_p1 -->
<g id="node181" class="node">
<title>tensor_reduce_e1_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="14760" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="14760" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="14760" y="-133.75" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="14760" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="14760" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e1_t3_e0_p1&#45;&gt;tensor_reduce_e1_t3_p1 -->
<g id="edge259" class="edge">
<title>moe_e1_t3_e0_p1&#45;&gt;tensor_reduce_e1_t3_p1</title>
<path fill="none" stroke="black" d="M14760,-203.35C14760,-195.54 14760,-186.68 14760,-177.91"/>
<polygon fill="black" stroke="black" points="14763.5,-177.73 14760,-167.73 14756.5,-177.73 14763.5,-177.73"/>
</g>
<!-- moe_e1_t3_e1_p1&#45;&gt;tensor_reduce_e1_t3_p1 -->
<g id="edge260" class="edge">
<title>moe_e1_t3_e1_p1&#45;&gt;tensor_reduce_e1_t3_p1</title>
<path fill="none" stroke="black" d="M14954.93,-203.48C14924.31,-192.21 14887.67,-178.73 14854.46,-166.51"/>
<polygon fill="black" stroke="black" points="14855.32,-163.1 14844.73,-162.93 14852.91,-169.67 14855.32,-163.1"/>
</g>
<!-- tensor_reduce_e1_t3_p1&#45;&gt;output -->
<g id="edge394" class="edge">
<title>tensor_reduce_e1_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14631.45,-106.01C14567.01,-95.24 14487.65,-83.65 14416,-77.98 13873.76,-35.07 9995.03,-30.51 9038.02,-30.04"/>
<polygon fill="black" stroke="black" points="9037.94,-26.54 9027.94,-30.04 9037.93,-33.54 9037.94,-26.54"/>
</g>
<!-- gate_e2_p1 -->
<g id="node182" class="node">
<title>gate_e2_p1</title>
<polygon fill="lightyellow" stroke="black" points="12150.24,-593.06 11729.89,-593.06 11621.76,-489.06 12042.11,-489.06 12150.24,-593.06"/>
<text text-anchor="middle" x="11886" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="11886" y="-544.06" font-family="Arial" font-size="10.00">GPU: 40&#45;43</text>
<text text-anchor="middle" x="11886" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="11886" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e2_p1 -->
<g id="node183" class="node">
<title>all2all_local_e2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="11788" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="11788" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="11788" y="-419.29" font-family="Arial" font-size="10.00">GPU: 40&#45;43</text>
<text text-anchor="middle" x="11788" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="11788" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e2_p1&#45;&gt;all2all_local_e2_p1 -->
<g id="edge261" class="edge">
<title>gate_e2_p1&#45;&gt;all2all_local_e2_p1</title>
<path fill="none" stroke="black" d="M11845.01,-488.71C11837.54,-479.36 11829.82,-469.69 11822.57,-460.6"/>
<polygon fill="black" stroke="black" points="11825.3,-458.41 11816.33,-452.78 11819.83,-462.78 11825.3,-458.41"/>
</g>
<!-- moe_e2_t0_e0_p1 -->
<g id="node185" class="node">
<title>moe_e2_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="11193.5,-255.52 10948.5,-255.52 10948.5,-203.52 11193.5,-203.52 11193.5,-255.52"/>
<text text-anchor="middle" x="11071" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="11071" y="-232.52" font-family="Arial" font-size="10.00">GPU: 40</text>
<text text-anchor="middle" x="11071" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11071" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t0_e0_p1 -->
<g id="edge452" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11649.27,-515.81C11525.49,-500.58 11388.28,-478.93 11332,-453.06 11232.88,-407.5 11141.96,-313.18 11098.27,-263.22"/>
<polygon fill="black" stroke="black" points="11100.86,-260.87 11091.67,-255.6 11095.57,-265.45 11100.86,-260.87"/>
</g>
<!-- moe_e2_t0_e1_p1 -->
<g id="node186" class="node">
<title>moe_e2_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="11456.5,-255.52 11211.5,-255.52 11211.5,-203.52 11456.5,-203.52 11456.5,-255.52"/>
<text text-anchor="middle" x="11334" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="11334" y="-232.52" font-family="Arial" font-size="10.00">GPU: 40</text>
<text text-anchor="middle" x="11334" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11334" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t0_e1_p1 -->
<g id="edge454" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11637.28,-488.98C11494.3,-453.9 11335.07,-403.01 11294,-343.52 11277.36,-319.42 11291.1,-287.67 11306.85,-263.97"/>
<polygon fill="black" stroke="black" points="11309.82,-265.83 11312.69,-255.63 11304.09,-261.81 11309.82,-265.83"/>
</g>
<!-- moe_e2_t1_e0_p1 -->
<g id="node189" class="node">
<title>moe_e2_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="11719.5,-255.52 11474.5,-255.52 11474.5,-203.52 11719.5,-203.52 11719.5,-255.52"/>
<text text-anchor="middle" x="11597" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="11597" y="-232.52" font-family="Arial" font-size="10.00">GPU: 41</text>
<text text-anchor="middle" x="11597" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11597" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t1_e0_p1 -->
<g id="edge456" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11663.52,-488.98C11634.87,-478.33 11612,-466.27 11602,-453.06 11580.42,-424.55 11587.43,-320.95 11592.97,-265.74"/>
<polygon fill="black" stroke="black" points="11596.46,-266.01 11594.01,-255.7 11589.5,-265.28 11596.46,-266.01"/>
</g>
<!-- moe_e2_t1_e1_p1 -->
<g id="node190" class="node">
<title>moe_e2_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="11982.5,-255.52 11737.5,-255.52 11737.5,-203.52 11982.5,-203.52 11982.5,-255.52"/>
<text text-anchor="middle" x="11860" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="11860" y="-232.52" font-family="Arial" font-size="10.00">GPU: 41</text>
<text text-anchor="middle" x="11860" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11860" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t1_e1_p1 -->
<g id="edge458" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11950.44,-489.05C11960.04,-478.27 11968.54,-466.15 11974,-453.06 11986.59,-422.9 11981.22,-411.4 11974,-379.52 11964.43,-337.25 11958.45,-325.85 11932,-291.52 11923.87,-280.97 11913.65,-270.98 11903.48,-262.24"/>
<polygon fill="black" stroke="black" points="11905.67,-259.51 11895.74,-255.82 11901.2,-264.9 11905.67,-259.51"/>
</g>
<!-- moe_e2_t2_e0_p1 -->
<g id="node193" class="node">
<title>moe_e2_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="12245.5,-255.52 12000.5,-255.52 12000.5,-203.52 12245.5,-203.52 12245.5,-255.52"/>
<text text-anchor="middle" x="12123" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="12123" y="-232.52" font-family="Arial" font-size="10.00">GPU: 42</text>
<text text-anchor="middle" x="12123" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12123" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t2_e0_p1 -->
<g id="edge460" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12053.99,-500.18C12136.34,-471.25 12228.1,-422.82 12277,-343.52 12289.13,-323.85 12289.99,-310.64 12277,-291.52 12268.32,-278.74 12256.49,-268.64 12243.23,-260.65"/>
<polygon fill="black" stroke="black" points="12244.77,-257.5 12234.33,-255.7 12241.37,-263.62 12244.77,-257.5"/>
</g>
<!-- moe_e2_t2_e1_p1 -->
<g id="node194" class="node">
<title>moe_e2_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="12508.5,-255.52 12263.5,-255.52 12263.5,-203.52 12508.5,-203.52 12508.5,-255.52"/>
<text text-anchor="middle" x="12386" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="12386" y="-232.52" font-family="Arial" font-size="10.00">GPU: 42</text>
<text text-anchor="middle" x="12386" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12386" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t2_e1_p1 -->
<g id="edge462" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12066.8,-512.74C12115.64,-499.83 12166.64,-480.87 12209,-453.06 12247.68,-427.66 12324.63,-320.12 12363.05,-264.37"/>
<polygon fill="black" stroke="black" points="12366.1,-266.11 12368.88,-255.88 12360.33,-262.14 12366.1,-266.11"/>
</g>
<!-- moe_e2_t3_e0_p1 -->
<g id="node197" class="node">
<title>moe_e2_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="12771.5,-255.52 12526.5,-255.52 12526.5,-203.52 12771.5,-203.52 12771.5,-255.52"/>
<text text-anchor="middle" x="12649" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="12649" y="-232.52" font-family="Arial" font-size="10.00">GPU: 43</text>
<text text-anchor="middle" x="12649" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12649" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t3_e0_p1 -->
<g id="edge464" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12070.96,-516.59C12269.79,-487.25 12567.09,-430.12 12639,-343.52 12656.72,-322.18 12657.97,-290.1 12655.51,-265.58"/>
<polygon fill="black" stroke="black" points="12658.97,-265.07 12654.26,-255.58 12652.02,-265.93 12658.97,-265.07"/>
</g>
<!-- moe_e2_t3_e1_p1 -->
<g id="node198" class="node">
<title>moe_e2_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="13034.5,-255.52 12789.5,-255.52 12789.5,-203.52 13034.5,-203.52 13034.5,-255.52"/>
<text text-anchor="middle" x="12912" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="12912" y="-232.52" font-family="Arial" font-size="10.00">GPU: 43</text>
<text text-anchor="middle" x="12912" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12912" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e2_p1&#45;&gt;moe_e2_t3_e1_p1 -->
<g id="edge466" class="edge">
<title>gate_e2_p1&#45;&gt;moe_e2_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.65,-529.78C12206.89,-519.11 12365.39,-497.37 12500,-453.06 12643.03,-405.98 12794.76,-310.53 12867.73,-261.35"/>
<polygon fill="black" stroke="black" points="12869.92,-264.1 12876.23,-255.59 12865.99,-258.3 12869.92,-264.1"/>
</g>
<!-- attention_e2_t0_p1 -->
<g id="node184" class="node">
<title>attention_e2_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="11573,-343.52 11303,-343.52 11303,-291.52 11573,-291.52 11573,-343.52"/>
<text text-anchor="middle" x="11438" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11438" y="-320.52" font-family="Arial" font-size="10.00">GPU: 40</text>
<text text-anchor="middle" x="11438" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="11438" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p1&#45;&gt;attention_e2_t0_p1 -->
<g id="edge262" class="edge">
<title>all2all_local_e2_p1&#45;&gt;attention_e2_t0_p1</title>
<path fill="none" stroke="black" d="M11683.94,-386.52C11637.94,-373.8 11584.08,-358.91 11538.5,-346.31"/>
<polygon fill="black" stroke="black" points="11539.18,-342.87 11528.61,-343.57 11537.32,-349.61 11539.18,-342.87"/>
</g>
<!-- attention_e2_t1_p1 -->
<g id="node188" class="node">
<title>attention_e2_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="11923,-343.52 11653,-343.52 11653,-291.52 11923,-291.52 11923,-343.52"/>
<text text-anchor="middle" x="11788" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11788" y="-320.52" font-family="Arial" font-size="10.00">GPU: 41</text>
<text text-anchor="middle" x="11788" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="11788" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p1&#45;&gt;attention_e2_t1_p1 -->
<g id="edge267" class="edge">
<title>all2all_local_e2_p1&#45;&gt;attention_e2_t1_p1</title>
<path fill="none" stroke="black" d="M11788,-379.26C11788,-370.95 11788,-362.11 11788,-353.83"/>
<polygon fill="black" stroke="black" points="11791.5,-353.72 11788,-343.72 11784.5,-353.72 11791.5,-353.72"/>
</g>
<!-- attention_e2_t2_p1 -->
<g id="node192" class="node">
<title>attention_e2_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="12268,-343.52 11998,-343.52 11998,-291.52 12268,-291.52 12268,-343.52"/>
<text text-anchor="middle" x="12133" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12133" y="-320.52" font-family="Arial" font-size="10.00">GPU: 42</text>
<text text-anchor="middle" x="12133" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="12133" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p1&#45;&gt;attention_e2_t2_p1 -->
<g id="edge272" class="edge">
<title>all2all_local_e2_p1&#45;&gt;attention_e2_t2_p1</title>
<path fill="none" stroke="black" d="M11891.04,-386.39C11936.27,-373.7 11989.15,-358.87 12033.91,-346.31"/>
<polygon fill="black" stroke="black" points="12034.95,-349.66 12043.63,-343.59 12033.06,-342.92 12034.95,-349.66"/>
</g>
<!-- attention_e2_t3_p1 -->
<g id="node196" class="node">
<title>attention_e2_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="12630,-343.52 12360,-343.52 12360,-291.52 12630,-291.52 12630,-343.52"/>
<text text-anchor="middle" x="12495" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12495" y="-320.52" font-family="Arial" font-size="10.00">GPU: 43</text>
<text text-anchor="middle" x="12495" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="12495" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e2_p1&#45;&gt;attention_e2_t3_p1 -->
<g id="edge277" class="edge">
<title>all2all_local_e2_p1&#45;&gt;attention_e2_t3_p1</title>
<path fill="none" stroke="black" d="M11933.63,-395.36C12055.32,-378.7 12227.98,-355.07 12349.6,-338.42"/>
<polygon fill="black" stroke="black" points="12350.3,-341.86 12359.73,-337.04 12349.35,-334.92 12350.3,-341.86"/>
</g>
<!-- attention_e2_t0_p1&#45;&gt;moe_e2_t0_e0_p1 -->
<g id="edge263" class="edge">
<title>attention_e2_t0_p1&#45;&gt;moe_e2_t0_e0_p1</title>
<path fill="none" stroke="black" d="M11330.86,-291.42C11286.02,-280.91 11233.77,-268.66 11187.93,-257.92"/>
<polygon fill="black" stroke="black" points="11188.49,-254.46 11177.95,-255.58 11186.89,-261.27 11188.49,-254.46"/>
</g>
<!-- attention_e2_t0_p1&#45;&gt;moe_e2_t0_e1_p1 -->
<g id="edge264" class="edge">
<title>attention_e2_t0_p1&#45;&gt;moe_e2_t0_e1_p1</title>
<path fill="none" stroke="black" d="M11407.64,-291.42C11396.63,-282.31 11384.05,-271.91 11372.43,-262.3"/>
<polygon fill="black" stroke="black" points="11374.52,-259.48 11364.58,-255.81 11370.05,-264.88 11374.52,-259.48"/>
</g>
<!-- tensor_reduce_e2_t0_p1 -->
<g id="node187" class="node">
<title>tensor_reduce_e2_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="11121" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="11121" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="11121" y="-133.75" font-family="Arial" font-size="10.00">GPU: 40</text>
<text text-anchor="middle" x="11121" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11121" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t0_e0_p1&#45;&gt;tensor_reduce_e2_t0_p1 -->
<g id="edge265" class="edge">
<title>moe_e2_t0_e0_p1&#45;&gt;tensor_reduce_e2_t0_p1</title>
<path fill="none" stroke="black" d="M11084.01,-203.35C11088.26,-195.12 11093.12,-185.71 11097.89,-176.48"/>
<polygon fill="black" stroke="black" points="11101.12,-177.85 11102.6,-167.36 11094.9,-174.64 11101.12,-177.85"/>
</g>
<!-- moe_e2_t0_e1_p1&#45;&gt;tensor_reduce_e2_t0_p1 -->
<g id="edge266" class="edge">
<title>moe_e2_t0_e1_p1&#45;&gt;tensor_reduce_e2_t0_p1</title>
<path fill="none" stroke="black" d="M11278.87,-203.48C11255.49,-192.85 11227.76,-180.25 11202.12,-168.6"/>
<polygon fill="black" stroke="black" points="11203.33,-165.31 11192.77,-164.36 11200.43,-171.68 11203.33,-165.31"/>
</g>
<!-- tensor_reduce_e2_t0_p1&#45;&gt;output -->
<g id="edge395" class="edge">
<title>tensor_reduce_e2_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11029.76,-99.34C11000.19,-90.81 10967.01,-82.6 10936,-77.98 10752.23,-50.62 9535.66,-36.5 9037.31,-31.81"/>
<polygon fill="black" stroke="black" points="9037.15,-28.31 9027.12,-31.71 9037.09,-35.3 9037.15,-28.31"/>
</g>
<!-- attention_e2_t1_p1&#45;&gt;moe_e2_t1_e0_p1 -->
<g id="edge268" class="edge">
<title>attention_e2_t1_p1&#45;&gt;moe_e2_t1_e0_p1</title>
<path fill="none" stroke="black" d="M11732.24,-291.42C11710.27,-281.52 11684.89,-270.1 11662.09,-259.83"/>
<polygon fill="black" stroke="black" points="11663.38,-256.57 11652.83,-255.66 11660.51,-262.96 11663.38,-256.57"/>
</g>
<!-- attention_e2_t1_p1&#45;&gt;moe_e2_t1_e1_p1 -->
<g id="edge269" class="edge">
<title>attention_e2_t1_p1&#45;&gt;moe_e2_t1_e1_p1</title>
<path fill="none" stroke="black" d="M11809.21,-291.18C11816.46,-282.52 11824.68,-272.71 11832.36,-263.53"/>
<polygon fill="black" stroke="black" points="11835.2,-265.59 11838.94,-255.68 11829.84,-261.1 11835.2,-265.59"/>
</g>
<!-- tensor_reduce_e2_t1_p1 -->
<g id="node191" class="node">
<title>tensor_reduce_e2_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="11597" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="11597" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="11597" y="-133.75" font-family="Arial" font-size="10.00">GPU: 41</text>
<text text-anchor="middle" x="11597" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="11597" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t1_e0_p1&#45;&gt;tensor_reduce_e2_t1_p1 -->
<g id="edge270" class="edge">
<title>moe_e2_t1_e0_p1&#45;&gt;tensor_reduce_e2_t1_p1</title>
<path fill="none" stroke="black" d="M11597,-203.35C11597,-195.54 11597,-186.68 11597,-177.91"/>
<polygon fill="black" stroke="black" points="11600.5,-177.73 11597,-167.73 11593.5,-177.73 11600.5,-177.73"/>
</g>
<!-- moe_e2_t1_e1_p1&#45;&gt;tensor_reduce_e2_t1_p1 -->
<g id="edge271" class="edge">
<title>moe_e2_t1_e1_p1&#45;&gt;tensor_reduce_e2_t1_p1</title>
<path fill="none" stroke="black" d="M11791.93,-203.48C11761.31,-192.21 11724.67,-178.73 11691.46,-166.51"/>
<polygon fill="black" stroke="black" points="11692.32,-163.1 11681.73,-162.93 11689.91,-169.67 11692.32,-163.1"/>
</g>
<!-- tensor_reduce_e2_t1_p1&#45;&gt;output -->
<g id="edge396" class="edge">
<title>tensor_reduce_e2_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11476.71,-104.23C11423.7,-94.11 11360.52,-83.57 11303,-77.98 10866.78,-35.61 9555.7,-30.28 9038.32,-29.88"/>
<polygon fill="black" stroke="black" points="9038.13,-26.38 9028.12,-29.87 9038.12,-33.38 9038.13,-26.38"/>
</g>
<!-- attention_e2_t2_p1&#45;&gt;moe_e2_t2_e0_p1 -->
<g id="edge273" class="edge">
<title>attention_e2_t2_p1&#45;&gt;moe_e2_t2_e0_p1</title>
<path fill="none" stroke="black" d="M12130.05,-291.18C12129.13,-283.22 12128.09,-274.29 12127.1,-265.77"/>
<polygon fill="black" stroke="black" points="12130.56,-265.21 12125.93,-255.68 12123.6,-266.02 12130.56,-265.21"/>
</g>
<!-- attention_e2_t2_p1&#45;&gt;moe_e2_t2_e1_p1 -->
<g id="edge274" class="edge">
<title>attention_e2_t2_p1&#45;&gt;moe_e2_t2_e1_p1</title>
<path fill="none" stroke="black" d="M12206.86,-291.42C12236.73,-281.26 12271.38,-269.48 12302.19,-259.01"/>
<polygon fill="black" stroke="black" points="12303.71,-262.19 12312.05,-255.66 12301.46,-255.56 12303.71,-262.19"/>
</g>
<!-- tensor_reduce_e2_t2_p1 -->
<g id="node195" class="node">
<title>tensor_reduce_e2_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="12123" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="12123" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="12123" y="-133.75" font-family="Arial" font-size="10.00">GPU: 42</text>
<text text-anchor="middle" x="12123" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12123" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t2_e0_p1&#45;&gt;tensor_reduce_e2_t2_p1 -->
<g id="edge275" class="edge">
<title>moe_e2_t2_e0_p1&#45;&gt;tensor_reduce_e2_t2_p1</title>
<path fill="none" stroke="black" d="M12123,-203.35C12123,-195.54 12123,-186.68 12123,-177.91"/>
<polygon fill="black" stroke="black" points="12126.5,-177.73 12123,-167.73 12119.5,-177.73 12126.5,-177.73"/>
</g>
<!-- moe_e2_t2_e1_p1&#45;&gt;tensor_reduce_e2_t2_p1 -->
<g id="edge276" class="edge">
<title>moe_e2_t2_e1_p1&#45;&gt;tensor_reduce_e2_t2_p1</title>
<path fill="none" stroke="black" d="M12317.93,-203.48C12287.31,-192.21 12250.67,-178.73 12217.46,-166.51"/>
<polygon fill="black" stroke="black" points="12218.32,-163.1 12207.73,-162.93 12215.91,-169.67 12218.32,-163.1"/>
</g>
<!-- tensor_reduce_e2_t2_p1&#45;&gt;output -->
<g id="edge397" class="edge">
<title>tensor_reduce_e2_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M11994.02,-106.18C11929.66,-95.48 11850.47,-83.91 11779,-77.98 11246.38,-33.78 9623.37,-29.74 9038.19,-29.77"/>
<polygon fill="black" stroke="black" points="9037.95,-26.27 9027.95,-29.77 9037.95,-33.27 9037.95,-26.27"/>
</g>
<!-- attention_e2_t3_p1&#45;&gt;moe_e2_t3_e0_p1 -->
<g id="edge278" class="edge">
<title>attention_e2_t3_p1&#45;&gt;moe_e2_t3_e0_p1</title>
<path fill="none" stroke="black" d="M12539.96,-291.42C12557.12,-281.83 12576.86,-270.81 12594.8,-260.79"/>
<polygon fill="black" stroke="black" points="12596.96,-263.59 12603.99,-255.66 12593.55,-257.48 12596.96,-263.59"/>
</g>
<!-- attention_e2_t3_p1&#45;&gt;moe_e2_t3_e1_p1 -->
<g id="edge279" class="edge">
<title>attention_e2_t3_p1&#45;&gt;moe_e2_t3_e1_p1</title>
<path fill="none" stroke="black" d="M12616.45,-291.47C12667.95,-280.85 12728.09,-268.45 12780.62,-257.62"/>
<polygon fill="black" stroke="black" points="12781.59,-260.99 12790.68,-255.54 12780.18,-254.13 12781.59,-260.99"/>
</g>
<!-- tensor_reduce_e2_t3_p1 -->
<g id="node199" class="node">
<title>tensor_reduce_e2_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="12649" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="12649" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="12649" y="-133.75" font-family="Arial" font-size="10.00">GPU: 43</text>
<text text-anchor="middle" x="12649" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="12649" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e2_t3_e0_p1&#45;&gt;tensor_reduce_e2_t3_p1 -->
<g id="edge280" class="edge">
<title>moe_e2_t3_e0_p1&#45;&gt;tensor_reduce_e2_t3_p1</title>
<path fill="none" stroke="black" d="M12649,-203.35C12649,-195.54 12649,-186.68 12649,-177.91"/>
<polygon fill="black" stroke="black" points="12652.5,-177.73 12649,-167.73 12645.5,-177.73 12652.5,-177.73"/>
</g>
<!-- moe_e2_t3_e1_p1&#45;&gt;tensor_reduce_e2_t3_p1 -->
<g id="edge281" class="edge">
<title>moe_e2_t3_e1_p1&#45;&gt;tensor_reduce_e2_t3_p1</title>
<path fill="none" stroke="black" d="M12843.93,-203.48C12813.31,-192.21 12776.67,-178.73 12743.46,-166.51"/>
<polygon fill="black" stroke="black" points="12744.32,-163.1 12733.73,-162.93 12741.91,-169.67 12744.32,-163.1"/>
</g>
<!-- tensor_reduce_e2_t3_p1&#45;&gt;output -->
<g id="edge398" class="edge">
<title>tensor_reduce_e2_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12520.03,-106.11C12455.67,-95.39 12376.48,-83.83 12305,-77.98 11981.02,-51.49 9742.81,-35.63 9037.42,-31.24"/>
<polygon fill="black" stroke="black" points="9037.43,-27.74 9027.4,-31.18 9037.38,-34.74 9037.43,-27.74"/>
</g>
<!-- gate_e3_p1 -->
<g id="node200" class="node">
<title>gate_e3_p1</title>
<polygon fill="lightyellow" stroke="black" points="10039.24,-593.06 9618.89,-593.06 9510.76,-489.06 9931.11,-489.06 10039.24,-593.06"/>
<text text-anchor="middle" x="9775" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="9775" y="-544.06" font-family="Arial" font-size="10.00">GPU: 44&#45;47</text>
<text text-anchor="middle" x="9775" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="9775" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e3_p1 -->
<g id="node201" class="node">
<title>all2all_local_e3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="9677" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="9677" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="9677" y="-419.29" font-family="Arial" font-size="10.00">GPU: 44&#45;47</text>
<text text-anchor="middle" x="9677" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="9677" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e3_p1&#45;&gt;all2all_local_e3_p1 -->
<g id="edge282" class="edge">
<title>gate_e3_p1&#45;&gt;all2all_local_e3_p1</title>
<path fill="none" stroke="black" d="M9734.01,-488.71C9726.54,-479.36 9718.82,-469.69 9711.57,-460.6"/>
<polygon fill="black" stroke="black" points="9714.3,-458.41 9705.33,-452.78 9708.83,-462.78 9714.3,-458.41"/>
</g>
<!-- moe_e3_t0_e0_p1 -->
<g id="node203" class="node">
<title>moe_e3_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="9082.5,-255.52 8837.5,-255.52 8837.5,-203.52 9082.5,-203.52 9082.5,-255.52"/>
<text text-anchor="middle" x="8960" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="8960" y="-232.52" font-family="Arial" font-size="10.00">GPU: 44</text>
<text text-anchor="middle" x="8960" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8960" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t0_e0_p1 -->
<g id="edge468" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9538.27,-515.81C9414.49,-500.58 9277.28,-478.93 9221,-453.06 9121.88,-407.5 9030.96,-313.18 8987.27,-263.22"/>
<polygon fill="black" stroke="black" points="8989.86,-260.87 8980.67,-255.6 8984.57,-265.45 8989.86,-260.87"/>
</g>
<!-- moe_e3_t0_e1_p1 -->
<g id="node204" class="node">
<title>moe_e3_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="9345.5,-255.52 9100.5,-255.52 9100.5,-203.52 9345.5,-203.52 9345.5,-255.52"/>
<text text-anchor="middle" x="9223" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="9223" y="-232.52" font-family="Arial" font-size="10.00">GPU: 44</text>
<text text-anchor="middle" x="9223" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9223" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t0_e1_p1 -->
<g id="edge470" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9526.28,-488.98C9383.3,-453.9 9224.07,-403.01 9183,-343.52 9166.36,-319.42 9180.1,-287.67 9195.85,-263.97"/>
<polygon fill="black" stroke="black" points="9198.82,-265.83 9201.69,-255.63 9193.09,-261.81 9198.82,-265.83"/>
</g>
<!-- moe_e3_t1_e0_p1 -->
<g id="node207" class="node">
<title>moe_e3_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="9608.5,-255.52 9363.5,-255.52 9363.5,-203.52 9608.5,-203.52 9608.5,-255.52"/>
<text text-anchor="middle" x="9486" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="9486" y="-232.52" font-family="Arial" font-size="10.00">GPU: 45</text>
<text text-anchor="middle" x="9486" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9486" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t1_e0_p1 -->
<g id="edge472" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9552.52,-488.98C9523.87,-478.33 9501,-466.27 9491,-453.06 9469.42,-424.55 9476.43,-320.95 9481.97,-265.74"/>
<polygon fill="black" stroke="black" points="9485.46,-266.01 9483.01,-255.7 9478.5,-265.28 9485.46,-266.01"/>
</g>
<!-- moe_e3_t1_e1_p1 -->
<g id="node208" class="node">
<title>moe_e3_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="9871.5,-255.52 9626.5,-255.52 9626.5,-203.52 9871.5,-203.52 9871.5,-255.52"/>
<text text-anchor="middle" x="9749" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="9749" y="-232.52" font-family="Arial" font-size="10.00">GPU: 45</text>
<text text-anchor="middle" x="9749" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9749" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t1_e1_p1 -->
<g id="edge474" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9839.44,-489.05C9849.04,-478.27 9857.54,-466.15 9863,-453.06 9875.59,-422.9 9870.22,-411.4 9863,-379.52 9853.43,-337.25 9847.45,-325.85 9821,-291.52 9812.87,-280.97 9802.65,-270.98 9792.48,-262.24"/>
<polygon fill="black" stroke="black" points="9794.67,-259.51 9784.74,-255.82 9790.2,-264.9 9794.67,-259.51"/>
</g>
<!-- moe_e3_t2_e0_p1 -->
<g id="node211" class="node">
<title>moe_e3_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="10134.5,-255.52 9889.5,-255.52 9889.5,-203.52 10134.5,-203.52 10134.5,-255.52"/>
<text text-anchor="middle" x="10012" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="10012" y="-232.52" font-family="Arial" font-size="10.00">GPU: 46</text>
<text text-anchor="middle" x="10012" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10012" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t2_e0_p1 -->
<g id="edge476" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9942.15,-499.18C10023.14,-470.04 10113.05,-421.74 10161,-343.52 10173.08,-323.82 10173.88,-310.71 10161,-291.52 10152.37,-278.67 10140.51,-268.53 10127.21,-260.52"/>
<polygon fill="black" stroke="black" points="10128.72,-257.35 10118.28,-255.55 10125.32,-263.47 10128.72,-257.35"/>
</g>
<!-- moe_e3_t2_e1_p1 -->
<g id="node212" class="node">
<title>moe_e3_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="10397.5,-255.52 10152.5,-255.52 10152.5,-203.52 10397.5,-203.52 10397.5,-255.52"/>
<text text-anchor="middle" x="10275" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="10275" y="-232.52" font-family="Arial" font-size="10.00">GPU: 46</text>
<text text-anchor="middle" x="10275" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10275" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t2_e1_p1 -->
<g id="edge478" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9955.04,-511.67C10002.76,-498.76 10052.51,-480.07 10094,-453.06 10133.12,-427.59 10212.01,-320.08 10251.44,-264.35"/>
<polygon fill="black" stroke="black" points="10254.52,-266.06 10257.42,-255.87 10248.8,-262.03 10254.52,-266.06"/>
</g>
<!-- moe_e3_t3_e0_p1 -->
<g id="node215" class="node">
<title>moe_e3_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="10660.5,-255.52 10415.5,-255.52 10415.5,-203.52 10660.5,-203.52 10660.5,-255.52"/>
<text text-anchor="middle" x="10538" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="10538" y="-232.52" font-family="Arial" font-size="10.00">GPU: 47</text>
<text text-anchor="middle" x="10538" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10538" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t3_e0_p1 -->
<g id="edge480" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9959.92,-516.55C10158.71,-487.19 10455.98,-430.03 10528,-343.52 10545.75,-322.2 10546.99,-290.13 10544.52,-265.59"/>
<polygon fill="black" stroke="black" points="10547.99,-265.08 10543.27,-255.59 10541.04,-265.95 10547.99,-265.08"/>
</g>
<!-- moe_e3_t3_e1_p1 -->
<g id="node216" class="node">
<title>moe_e3_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="10923.5,-255.52 10678.5,-255.52 10678.5,-203.52 10923.5,-203.52 10923.5,-255.52"/>
<text text-anchor="middle" x="10801" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="10801" y="-232.52" font-family="Arial" font-size="10.00">GPU: 47</text>
<text text-anchor="middle" x="10801" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10801" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e3_p1&#45;&gt;moe_e3_t3_e1_p1 -->
<g id="edge482" class="edge">
<title>gate_e3_p1&#45;&gt;moe_e3_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9973.65,-529.78C10095.89,-519.11 10254.39,-497.37 10389,-453.06 10532.03,-405.98 10683.76,-310.53 10756.73,-261.35"/>
<polygon fill="black" stroke="black" points="10758.92,-264.1 10765.23,-255.59 10754.99,-258.3 10758.92,-264.1"/>
</g>
<!-- attention_e3_t0_p1 -->
<g id="node202" class="node">
<title>attention_e3_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="9462,-343.52 9192,-343.52 9192,-291.52 9462,-291.52 9462,-343.52"/>
<text text-anchor="middle" x="9327" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9327" y="-320.52" font-family="Arial" font-size="10.00">GPU: 44</text>
<text text-anchor="middle" x="9327" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9327" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p1&#45;&gt;attention_e3_t0_p1 -->
<g id="edge283" class="edge">
<title>all2all_local_e3_p1&#45;&gt;attention_e3_t0_p1</title>
<path fill="none" stroke="black" d="M9572.94,-386.52C9526.94,-373.8 9473.08,-358.91 9427.5,-346.31"/>
<polygon fill="black" stroke="black" points="9428.18,-342.87 9417.61,-343.57 9426.32,-349.61 9428.18,-342.87"/>
</g>
<!-- attention_e3_t1_p1 -->
<g id="node206" class="node">
<title>attention_e3_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="9812,-343.52 9542,-343.52 9542,-291.52 9812,-291.52 9812,-343.52"/>
<text text-anchor="middle" x="9677" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9677" y="-320.52" font-family="Arial" font-size="10.00">GPU: 45</text>
<text text-anchor="middle" x="9677" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="9677" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p1&#45;&gt;attention_e3_t1_p1 -->
<g id="edge288" class="edge">
<title>all2all_local_e3_p1&#45;&gt;attention_e3_t1_p1</title>
<path fill="none" stroke="black" d="M9677,-379.26C9677,-370.95 9677,-362.11 9677,-353.83"/>
<polygon fill="black" stroke="black" points="9680.5,-353.72 9677,-343.72 9673.5,-353.72 9680.5,-353.72"/>
</g>
<!-- attention_e3_t2_p1 -->
<g id="node210" class="node">
<title>attention_e3_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="10152,-343.52 9882,-343.52 9882,-291.52 10152,-291.52 10152,-343.52"/>
<text text-anchor="middle" x="10017" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10017" y="-320.52" font-family="Arial" font-size="10.00">GPU: 46</text>
<text text-anchor="middle" x="10017" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="10017" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p1&#45;&gt;attention_e3_t2_p1 -->
<g id="edge293" class="edge">
<title>all2all_local_e3_p1&#45;&gt;attention_e3_t2_p1</title>
<path fill="none" stroke="black" d="M9779.01,-386.26C9823.47,-373.6 9875.36,-358.83 9919.33,-346.32"/>
<polygon fill="black" stroke="black" points="9920.5,-349.63 9929.16,-343.52 9918.58,-342.89 9920.5,-349.63"/>
</g>
<!-- attention_e3_t3_p1 -->
<g id="node214" class="node">
<title>attention_e3_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="10519,-343.52 10249,-343.52 10249,-291.52 10519,-291.52 10519,-343.52"/>
<text text-anchor="middle" x="10384" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10384" y="-320.52" font-family="Arial" font-size="10.00">GPU: 47</text>
<text text-anchor="middle" x="10384" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="10384" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e3_p1&#45;&gt;attention_e3_t3_p1 -->
<g id="edge298" class="edge">
<title>all2all_local_e3_p1&#45;&gt;attention_e3_t3_p1</title>
<path fill="none" stroke="black" d="M9822.63,-395.36C9944.32,-378.7 10116.98,-355.07 10238.6,-338.42"/>
<polygon fill="black" stroke="black" points="10239.3,-341.86 10248.73,-337.04 10238.35,-334.92 10239.3,-341.86"/>
</g>
<!-- attention_e3_t0_p1&#45;&gt;moe_e3_t0_e0_p1 -->
<g id="edge284" class="edge">
<title>attention_e3_t0_p1&#45;&gt;moe_e3_t0_e0_p1</title>
<path fill="none" stroke="black" d="M9219.86,-291.42C9175.02,-280.91 9122.77,-268.66 9076.93,-257.92"/>
<polygon fill="black" stroke="black" points="9077.49,-254.46 9066.95,-255.58 9075.89,-261.27 9077.49,-254.46"/>
</g>
<!-- attention_e3_t0_p1&#45;&gt;moe_e3_t0_e1_p1 -->
<g id="edge285" class="edge">
<title>attention_e3_t0_p1&#45;&gt;moe_e3_t0_e1_p1</title>
<path fill="none" stroke="black" d="M9296.64,-291.42C9285.63,-282.31 9273.05,-271.91 9261.43,-262.3"/>
<polygon fill="black" stroke="black" points="9263.52,-259.48 9253.58,-255.81 9259.05,-264.88 9263.52,-259.48"/>
</g>
<!-- tensor_reduce_e3_t0_p1 -->
<g id="node205" class="node">
<title>tensor_reduce_e3_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="9010" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="9010" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="9010" y="-133.75" font-family="Arial" font-size="10.00">GPU: 44</text>
<text text-anchor="middle" x="9010" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9010" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t0_e0_p1&#45;&gt;tensor_reduce_e3_t0_p1 -->
<g id="edge286" class="edge">
<title>moe_e3_t0_e0_p1&#45;&gt;tensor_reduce_e3_t0_p1</title>
<path fill="none" stroke="black" d="M8973.01,-203.35C8977.26,-195.12 8982.12,-185.71 8986.89,-176.48"/>
<polygon fill="black" stroke="black" points="8990.12,-177.85 8991.6,-167.36 8983.9,-174.64 8990.12,-177.85"/>
</g>
<!-- moe_e3_t0_e1_p1&#45;&gt;tensor_reduce_e3_t0_p1 -->
<g id="edge287" class="edge">
<title>moe_e3_t0_e1_p1&#45;&gt;tensor_reduce_e3_t0_p1</title>
<path fill="none" stroke="black" d="M9167.87,-203.48C9144.49,-192.85 9116.76,-180.25 9091.12,-168.6"/>
<polygon fill="black" stroke="black" points="9092.33,-165.31 9081.77,-164.36 9089.43,-171.68 9092.33,-165.31"/>
</g>
<!-- tensor_reduce_e3_t0_p1&#45;&gt;output -->
<g id="edge399" class="edge">
<title>tensor_reduce_e3_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8948.14,-96.39C8927.55,-85.29 8904.68,-72.96 8884.29,-61.97"/>
<polygon fill="black" stroke="black" points="8885.88,-58.85 8875.42,-57.18 8882.56,-65.01 8885.88,-58.85"/>
</g>
<!-- attention_e3_t1_p1&#45;&gt;moe_e3_t1_e0_p1 -->
<g id="edge289" class="edge">
<title>attention_e3_t1_p1&#45;&gt;moe_e3_t1_e0_p1</title>
<path fill="none" stroke="black" d="M9621.24,-291.42C9599.27,-281.52 9573.89,-270.1 9551.09,-259.83"/>
<polygon fill="black" stroke="black" points="9552.38,-256.57 9541.83,-255.66 9549.51,-262.96 9552.38,-256.57"/>
</g>
<!-- attention_e3_t1_p1&#45;&gt;moe_e3_t1_e1_p1 -->
<g id="edge290" class="edge">
<title>attention_e3_t1_p1&#45;&gt;moe_e3_t1_e1_p1</title>
<path fill="none" stroke="black" d="M9698.21,-291.18C9705.46,-282.52 9713.68,-272.71 9721.36,-263.53"/>
<polygon fill="black" stroke="black" points="9724.2,-265.59 9727.94,-255.68 9718.84,-261.1 9724.2,-265.59"/>
</g>
<!-- tensor_reduce_e3_t1_p1 -->
<g id="node209" class="node">
<title>tensor_reduce_e3_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="9486" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="9486" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="9486" y="-133.75" font-family="Arial" font-size="10.00">GPU: 45</text>
<text text-anchor="middle" x="9486" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="9486" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t1_e0_p1&#45;&gt;tensor_reduce_e3_t1_p1 -->
<g id="edge291" class="edge">
<title>moe_e3_t1_e0_p1&#45;&gt;tensor_reduce_e3_t1_p1</title>
<path fill="none" stroke="black" d="M9486,-203.35C9486,-195.54 9486,-186.68 9486,-177.91"/>
<polygon fill="black" stroke="black" points="9489.5,-177.73 9486,-167.73 9482.5,-177.73 9489.5,-177.73"/>
</g>
<!-- moe_e3_t1_e1_p1&#45;&gt;tensor_reduce_e3_t1_p1 -->
<g id="edge292" class="edge">
<title>moe_e3_t1_e1_p1&#45;&gt;tensor_reduce_e3_t1_p1</title>
<path fill="none" stroke="black" d="M9680.93,-203.48C9650.31,-192.21 9613.67,-178.73 9580.46,-166.51"/>
<polygon fill="black" stroke="black" points="9581.32,-163.1 9570.73,-162.93 9578.91,-169.67 9581.32,-163.1"/>
</g>
<!-- tensor_reduce_e3_t1_p1&#45;&gt;output -->
<g id="edge400" class="edge">
<title>tensor_reduce_e3_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9357.77,-105.9C9306.32,-96.67 9246.43,-86.33 9192,-77.98 9124.93,-67.7 9050.74,-57.73 8986.72,-49.57"/>
<polygon fill="black" stroke="black" points="8986.9,-46.07 8976.54,-48.28 8986.02,-53.01 8986.9,-46.07"/>
</g>
<!-- attention_e3_t2_p1&#45;&gt;moe_e3_t2_e0_p1 -->
<g id="edge294" class="edge">
<title>attention_e3_t2_p1&#45;&gt;moe_e3_t2_e0_p1</title>
<path fill="none" stroke="black" d="M10015.53,-291.18C10015.06,-283.22 10014.54,-274.29 10014.05,-265.77"/>
<polygon fill="black" stroke="black" points="10017.54,-265.46 10013.46,-255.68 10010.55,-265.86 10017.54,-265.46"/>
</g>
<!-- attention_e3_t2_p1&#45;&gt;moe_e3_t2_e1_p1 -->
<g id="edge295" class="edge">
<title>attention_e3_t2_p1&#45;&gt;moe_e3_t2_e1_p1</title>
<path fill="none" stroke="black" d="M10092.32,-291.42C10122.92,-281.22 10158.42,-269.38 10189.94,-258.87"/>
<polygon fill="black" stroke="black" points="10191.21,-262.14 10199.59,-255.66 10188.99,-255.5 10191.21,-262.14"/>
</g>
<!-- tensor_reduce_e3_t2_p1 -->
<g id="node213" class="node">
<title>tensor_reduce_e3_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="10012" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="10012" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="10012" y="-133.75" font-family="Arial" font-size="10.00">GPU: 46</text>
<text text-anchor="middle" x="10012" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10012" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t2_e0_p1&#45;&gt;tensor_reduce_e3_t2_p1 -->
<g id="edge296" class="edge">
<title>moe_e3_t2_e0_p1&#45;&gt;tensor_reduce_e3_t2_p1</title>
<path fill="none" stroke="black" d="M10012,-203.35C10012,-195.54 10012,-186.68 10012,-177.91"/>
<polygon fill="black" stroke="black" points="10015.5,-177.73 10012,-167.73 10008.5,-177.73 10015.5,-177.73"/>
</g>
<!-- moe_e3_t2_e1_p1&#45;&gt;tensor_reduce_e3_t2_p1 -->
<g id="edge297" class="edge">
<title>moe_e3_t2_e1_p1&#45;&gt;tensor_reduce_e3_t2_p1</title>
<path fill="none" stroke="black" d="M10206.93,-203.48C10176.31,-192.21 10139.67,-178.73 10106.46,-166.51"/>
<polygon fill="black" stroke="black" points="10107.32,-163.1 10096.73,-162.93 10104.91,-169.67 10107.32,-163.1"/>
</g>
<!-- tensor_reduce_e3_t2_p1&#45;&gt;output -->
<g id="edge401" class="edge">
<title>tensor_reduce_e3_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9879.64,-106.91C9815.85,-96.65 9738.14,-85.24 9668,-77.98 9451.77,-55.61 9203.17,-43.05 9032.27,-36.44"/>
<polygon fill="black" stroke="black" points="9032.27,-32.94 9022.15,-36.06 9032.01,-39.94 9032.27,-32.94"/>
</g>
<!-- attention_e3_t3_p1&#45;&gt;moe_e3_t3_e0_p1 -->
<g id="edge299" class="edge">
<title>attention_e3_t3_p1&#45;&gt;moe_e3_t3_e0_p1</title>
<path fill="none" stroke="black" d="M10428.96,-291.42C10446.12,-281.83 10465.86,-270.81 10483.8,-260.79"/>
<polygon fill="black" stroke="black" points="10485.96,-263.59 10492.99,-255.66 10482.55,-257.48 10485.96,-263.59"/>
</g>
<!-- attention_e3_t3_p1&#45;&gt;moe_e3_t3_e1_p1 -->
<g id="edge300" class="edge">
<title>attention_e3_t3_p1&#45;&gt;moe_e3_t3_e1_p1</title>
<path fill="none" stroke="black" d="M10505.45,-291.47C10556.95,-280.85 10617.09,-268.45 10669.62,-257.62"/>
<polygon fill="black" stroke="black" points="10670.59,-260.99 10679.68,-255.54 10669.18,-254.13 10670.59,-260.99"/>
</g>
<!-- tensor_reduce_e3_t3_p1 -->
<g id="node217" class="node">
<title>tensor_reduce_e3_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="10538" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="10538" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="10538" y="-133.75" font-family="Arial" font-size="10.00">GPU: 47</text>
<text text-anchor="middle" x="10538" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="10538" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e3_t3_e0_p1&#45;&gt;tensor_reduce_e3_t3_p1 -->
<g id="edge301" class="edge">
<title>moe_e3_t3_e0_p1&#45;&gt;tensor_reduce_e3_t3_p1</title>
<path fill="none" stroke="black" d="M10538,-203.35C10538,-195.54 10538,-186.68 10538,-177.91"/>
<polygon fill="black" stroke="black" points="10541.5,-177.73 10538,-167.73 10534.5,-177.73 10541.5,-177.73"/>
</g>
<!-- moe_e3_t3_e1_p1&#45;&gt;tensor_reduce_e3_t3_p1 -->
<g id="edge302" class="edge">
<title>moe_e3_t3_e1_p1&#45;&gt;tensor_reduce_e3_t3_p1</title>
<path fill="none" stroke="black" d="M10732.93,-203.48C10702.31,-192.21 10665.67,-178.73 10632.46,-166.51"/>
<polygon fill="black" stroke="black" points="10633.32,-163.1 10622.73,-162.93 10630.91,-169.67 10633.32,-163.1"/>
</g>
<!-- tensor_reduce_e3_t3_p1&#45;&gt;output -->
<g id="edge402" class="edge">
<title>tensor_reduce_e3_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10407.34,-106.49C10343.26,-96.01 10264.81,-84.53 10194,-77.98 9786.45,-40.3 9308.16,-31.59 9038.43,-29.93"/>
<polygon fill="black" stroke="black" points="9038.15,-26.43 9028.13,-29.87 9038.11,-33.43 9038.15,-26.43"/>
</g>
<!-- gate_e4_p1 -->
<g id="node218" class="node">
<title>gate_e4_p1</title>
<polygon fill="lightyellow" stroke="black" points="8191.24,-593.06 7770.89,-593.06 7662.76,-489.06 8083.11,-489.06 8191.24,-593.06"/>
<text text-anchor="middle" x="7927" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="7927" y="-544.06" font-family="Arial" font-size="10.00">GPU: 48&#45;51</text>
<text text-anchor="middle" x="7927" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="7927" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e4_p1 -->
<g id="node219" class="node">
<title>all2all_local_e4_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="7582" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="7582" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="7582" y="-419.29" font-family="Arial" font-size="10.00">GPU: 48&#45;51</text>
<text text-anchor="middle" x="7582" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="7582" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e4_p1&#45;&gt;all2all_local_e4_p1 -->
<g id="edge303" class="edge">
<title>gate_e4_p1&#45;&gt;all2all_local_e4_p1</title>
<path fill="none" stroke="black" d="M7783.19,-488.88C7748.02,-476.37 7711.21,-463.27 7678.84,-451.75"/>
<polygon fill="black" stroke="black" points="7679.98,-448.44 7669.38,-448.39 7677.63,-455.04 7679.98,-448.44"/>
</g>
<!-- moe_e4_t0_e0_p1 -->
<g id="node221" class="node">
<title>moe_e4_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="6971.5,-255.52 6726.5,-255.52 6726.5,-203.52 6971.5,-203.52 6971.5,-255.52"/>
<text text-anchor="middle" x="6849" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="6849" y="-232.52" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="6849" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6849" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t0_e0_p1 -->
<g id="edge484" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7706.15,-530.89C7502.68,-519.84 7217.18,-497 7114,-453.06 7012.47,-409.83 6920.22,-314.08 6876.19,-263.42"/>
<polygon fill="black" stroke="black" points="6878.72,-260.99 6869.55,-255.69 6873.41,-265.56 6878.72,-260.99"/>
</g>
<!-- moe_e4_t0_e1_p1 -->
<g id="node222" class="node">
<title>moe_e4_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="7234.5,-255.52 6989.5,-255.52 6989.5,-203.52 7234.5,-203.52 7234.5,-255.52"/>
<text text-anchor="middle" x="7112" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="7112" y="-232.52" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="7112" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7112" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t0_e1_p1 -->
<g id="edge486" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7687.33,-512.89C7590.36,-499.11 7477.93,-479.55 7378,-453.06 7244.82,-417.75 7166.34,-456.86 7088,-343.52 7071.99,-320.36 7080.75,-288.63 7091.94,-264.68"/>
<polygon fill="black" stroke="black" points="7095.14,-266.11 7096.46,-255.6 7088.87,-262.99 7095.14,-266.11"/>
</g>
<!-- moe_e4_t1_e0_p1 -->
<g id="node225" class="node">
<title>moe_e4_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="7497.5,-255.52 7252.5,-255.52 7252.5,-203.52 7497.5,-203.52 7497.5,-255.52"/>
<text text-anchor="middle" x="7375" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="7375" y="-232.52" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="7375" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7375" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t1_e0_p1 -->
<g id="edge488" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7705.7,-530.49C7579.54,-520.09 7438.32,-498.38 7396,-453.06 7383.51,-439.68 7378.02,-325.15 7376,-265.83"/>
<polygon fill="black" stroke="black" points="7379.5,-265.65 7375.67,-255.77 7372.5,-265.88 7379.5,-265.65"/>
</g>
<!-- moe_e4_t1_e1_p1 -->
<g id="node226" class="node">
<title>moe_e4_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="7760.5,-255.52 7515.5,-255.52 7515.5,-203.52 7760.5,-203.52 7760.5,-255.52"/>
<text text-anchor="middle" x="7638" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="7638" y="-232.52" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="7638" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7638" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t1_e1_p1 -->
<g id="edge490" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7892.25,-488.89C7854.87,-435.98 7791.87,-352.7 7726,-291.52 7714.38,-280.73 7700.73,-270.36 7687.7,-261.32"/>
<polygon fill="black" stroke="black" points="7689.49,-258.31 7679.25,-255.59 7685.56,-264.1 7689.49,-258.31"/>
</g>
<!-- moe_e4_t2_e0_p1 -->
<g id="node229" class="node">
<title>moe_e4_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="8023.5,-255.52 7778.5,-255.52 7778.5,-203.52 8023.5,-203.52 8023.5,-255.52"/>
<text text-anchor="middle" x="7901" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="7901" y="-232.52" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="7901" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7901" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t2_e0_p1 -->
<g id="edge492" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7989.79,-489.05C8045.4,-437.54 8111.28,-356.53 8066,-291.52 8057.05,-278.67 8045.07,-268.52 8031.63,-260.51"/>
<polygon fill="black" stroke="black" points="8033.05,-257.3 8022.6,-255.54 8029.67,-263.43 8033.05,-257.3"/>
</g>
<!-- moe_e4_t2_e1_p1 -->
<g id="node230" class="node">
<title>moe_e4_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="8286.5,-255.52 8041.5,-255.52 8041.5,-203.52 8286.5,-203.52 8286.5,-255.52"/>
<text text-anchor="middle" x="8164" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="8164" y="-232.52" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="8164" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8164" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t2_e1_p1 -->
<g id="edge494" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8015.18,-488.93C8029.28,-478.27 8042.86,-466.22 8054,-453.06 8105.14,-392.64 8092.6,-361.81 8129,-291.52 8133.58,-282.67 8138.8,-273.26 8143.79,-264.55"/>
<polygon fill="black" stroke="black" points="8146.88,-266.18 8148.86,-255.78 8140.82,-262.68 8146.88,-266.18"/>
</g>
<!-- moe_e4_t3_e0_p1 -->
<g id="node233" class="node">
<title>moe_e4_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="8549.5,-255.52 8304.5,-255.52 8304.5,-203.52 8549.5,-203.52 8549.5,-255.52"/>
<text text-anchor="middle" x="8427" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="8427" y="-232.52" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="8427" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8427" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t3_e0_p1 -->
<g id="edge496" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8110.05,-514.69C8217.08,-489.78 8344.93,-440.56 8417,-343.52 8433.37,-321.49 8434.88,-289.95 8432.85,-265.79"/>
<polygon fill="black" stroke="black" points="8436.31,-265.17 8431.76,-255.6 8429.35,-265.92 8436.31,-265.17"/>
</g>
<!-- moe_e4_t3_e1_p1 -->
<g id="node234" class="node">
<title>moe_e4_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="8812.5,-255.52 8567.5,-255.52 8567.5,-203.52 8812.5,-203.52 8812.5,-255.52"/>
<text text-anchor="middle" x="8690" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="8690" y="-232.52" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="8690" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8690" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e4_p1&#45;&gt;moe_e4_t3_e1_p1 -->
<g id="edge498" class="edge">
<title>gate_e4_p1&#45;&gt;moe_e4_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8110.89,-515.69C8183.67,-502.36 8266.97,-482.38 8339,-453.06 8461.48,-403.2 8588.48,-310.68 8650.76,-262.13"/>
<polygon fill="black" stroke="black" points="8653.05,-264.79 8658.75,-255.86 8648.73,-259.28 8653.05,-264.79"/>
</g>
<!-- attention_e4_t0_p1 -->
<g id="node220" class="node">
<title>attention_e4_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="7367,-343.52 7097,-343.52 7097,-291.52 7367,-291.52 7367,-343.52"/>
<text text-anchor="middle" x="7232" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7232" y="-320.52" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="7232" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7232" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p1&#45;&gt;attention_e4_t0_p1 -->
<g id="edge304" class="edge">
<title>all2all_local_e4_p1&#45;&gt;attention_e4_t0_p1</title>
<path fill="none" stroke="black" d="M7477.94,-386.52C7431.94,-373.8 7378.08,-358.91 7332.5,-346.31"/>
<polygon fill="black" stroke="black" points="7333.18,-342.87 7322.61,-343.57 7331.32,-349.61 7333.18,-342.87"/>
</g>
<!-- attention_e4_t1_p1 -->
<g id="node224" class="node">
<title>attention_e4_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="7717,-343.52 7447,-343.52 7447,-291.52 7717,-291.52 7717,-343.52"/>
<text text-anchor="middle" x="7582" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7582" y="-320.52" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="7582" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7582" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p1&#45;&gt;attention_e4_t1_p1 -->
<g id="edge309" class="edge">
<title>all2all_local_e4_p1&#45;&gt;attention_e4_t1_p1</title>
<path fill="none" stroke="black" d="M7582,-379.26C7582,-370.95 7582,-362.11 7582,-353.83"/>
<polygon fill="black" stroke="black" points="7585.5,-353.72 7582,-343.72 7578.5,-353.72 7585.5,-353.72"/>
</g>
<!-- attention_e4_t2_p1 -->
<g id="node228" class="node">
<title>attention_e4_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="8057,-343.52 7787,-343.52 7787,-291.52 8057,-291.52 8057,-343.52"/>
<text text-anchor="middle" x="7922" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7922" y="-320.52" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="7922" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="7922" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p1&#45;&gt;attention_e4_t2_p1 -->
<g id="edge314" class="edge">
<title>all2all_local_e4_p1&#45;&gt;attention_e4_t2_p1</title>
<path fill="none" stroke="black" d="M7684.01,-386.26C7728.47,-373.6 7780.36,-358.83 7824.33,-346.32"/>
<polygon fill="black" stroke="black" points="7825.5,-349.63 7834.16,-343.52 7823.58,-342.89 7825.5,-349.63"/>
</g>
<!-- attention_e4_t3_p1 -->
<g id="node232" class="node">
<title>attention_e4_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="8408,-343.52 8138,-343.52 8138,-291.52 8408,-291.52 8408,-343.52"/>
<text text-anchor="middle" x="8273" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="8273" y="-320.52" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="8273" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="8273" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e4_p1&#45;&gt;attention_e4_t3_p1 -->
<g id="edge319" class="edge">
<title>all2all_local_e4_p1&#45;&gt;attention_e4_t3_p1</title>
<path fill="none" stroke="black" d="M7726.44,-395.06C7844.17,-378.58 8009.68,-355.4 8127.66,-338.88"/>
<polygon fill="black" stroke="black" points="8128.43,-342.3 8137.85,-337.45 8127.46,-335.37 8128.43,-342.3"/>
</g>
<!-- attention_e4_t0_p1&#45;&gt;moe_e4_t0_e0_p1 -->
<g id="edge305" class="edge">
<title>attention_e4_t0_p1&#45;&gt;moe_e4_t0_e0_p1</title>
<path fill="none" stroke="black" d="M7120.45,-291.47C7073.34,-280.9 7018.37,-268.55 6970.27,-257.75"/>
<polygon fill="black" stroke="black" points="6970.95,-254.32 6960.43,-255.54 6969.42,-261.15 6970.95,-254.32"/>
</g>
<!-- attention_e4_t0_p1&#45;&gt;moe_e4_t0_e1_p1 -->
<g id="edge306" class="edge">
<title>attention_e4_t0_p1&#45;&gt;moe_e4_t0_e1_p1</title>
<path fill="none" stroke="black" d="M7196.97,-291.42C7184.02,-282.14 7169.19,-271.51 7155.57,-261.75"/>
<polygon fill="black" stroke="black" points="7157.45,-258.79 7147.28,-255.81 7153.37,-264.48 7157.45,-258.79"/>
</g>
<!-- tensor_reduce_e4_t0_p1 -->
<g id="node223" class="node">
<title>tensor_reduce_e4_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="7112" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="7112" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="7112" y="-133.75" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="7112" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7112" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t0_e0_p1&#45;&gt;tensor_reduce_e4_t0_p1 -->
<g id="edge307" class="edge">
<title>moe_e4_t0_e0_p1&#45;&gt;tensor_reduce_e4_t0_p1</title>
<path fill="none" stroke="black" d="M6917.07,-203.48C6947.69,-192.21 6984.33,-178.73 7017.54,-166.51"/>
<polygon fill="black" stroke="black" points="7019.09,-169.67 7027.27,-162.93 7016.68,-163.1 7019.09,-169.67"/>
</g>
<!-- moe_e4_t0_e1_p1&#45;&gt;tensor_reduce_e4_t0_p1 -->
<g id="edge308" class="edge">
<title>moe_e4_t0_e1_p1&#45;&gt;tensor_reduce_e4_t0_p1</title>
<path fill="none" stroke="black" d="M7112,-203.35C7112,-195.54 7112,-186.68 7112,-177.91"/>
<polygon fill="black" stroke="black" points="7115.5,-177.73 7112,-167.73 7108.5,-177.73 7115.5,-177.73"/>
</g>
<!-- tensor_reduce_e4_t0_p1&#45;&gt;output -->
<g id="edge403" class="edge">
<title>tensor_reduce_e4_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7242.66,-106.49C7306.74,-96.01 7385.19,-84.53 7456,-77.98 7863.55,-40.3 8341.84,-31.59 8611.57,-29.93"/>
<polygon fill="black" stroke="black" points="8611.89,-33.43 8621.87,-29.87 8611.85,-26.43 8611.89,-33.43"/>
</g>
<!-- attention_e4_t1_p1&#45;&gt;moe_e4_t1_e0_p1 -->
<g id="edge310" class="edge">
<title>attention_e4_t1_p1&#45;&gt;moe_e4_t1_e0_p1</title>
<path fill="none" stroke="black" d="M7521.57,-291.42C7497.55,-281.44 7469.76,-269.89 7444.88,-259.56"/>
<polygon fill="black" stroke="black" points="7446.08,-256.26 7435.5,-255.66 7443.4,-262.73 7446.08,-256.26"/>
</g>
<!-- attention_e4_t1_p1&#45;&gt;moe_e4_t1_e1_p1 -->
<g id="edge311" class="edge">
<title>attention_e4_t1_p1&#45;&gt;moe_e4_t1_e1_p1</title>
<path fill="none" stroke="black" d="M7598.5,-291.18C7604.02,-282.7 7610.27,-273.1 7616.14,-264.09"/>
<polygon fill="black" stroke="black" points="7619.1,-265.97 7621.62,-255.68 7613.23,-262.15 7619.1,-265.97"/>
</g>
<!-- tensor_reduce_e4_t1_p1 -->
<g id="node227" class="node">
<title>tensor_reduce_e4_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="7638" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="7638" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="7638" y="-133.75" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="7638" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="7638" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t1_e0_p1&#45;&gt;tensor_reduce_e4_t1_p1 -->
<g id="edge312" class="edge">
<title>moe_e4_t1_e0_p1&#45;&gt;tensor_reduce_e4_t1_p1</title>
<path fill="none" stroke="black" d="M7443.07,-203.48C7473.69,-192.21 7510.33,-178.73 7543.54,-166.51"/>
<polygon fill="black" stroke="black" points="7545.09,-169.67 7553.27,-162.93 7542.68,-163.1 7545.09,-169.67"/>
</g>
<!-- moe_e4_t1_e1_p1&#45;&gt;tensor_reduce_e4_t1_p1 -->
<g id="edge313" class="edge">
<title>moe_e4_t1_e1_p1&#45;&gt;tensor_reduce_e4_t1_p1</title>
<path fill="none" stroke="black" d="M7638,-203.35C7638,-195.54 7638,-186.68 7638,-177.91"/>
<polygon fill="black" stroke="black" points="7641.5,-177.73 7638,-167.73 7634.5,-177.73 7641.5,-177.73"/>
</g>
<!-- tensor_reduce_e4_t1_p1&#45;&gt;output -->
<g id="edge404" class="edge">
<title>tensor_reduce_e4_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7770.36,-106.91C7834.15,-96.65 7911.86,-85.24 7982,-77.98 8198.23,-55.61 8446.83,-43.05 8617.73,-36.44"/>
<polygon fill="black" stroke="black" points="8617.99,-39.94 8627.85,-36.06 8617.73,-32.94 8617.99,-39.94"/>
</g>
<!-- attention_e4_t2_p1&#45;&gt;moe_e4_t2_e0_p1 -->
<g id="edge315" class="edge">
<title>attention_e4_t2_p1&#45;&gt;moe_e4_t2_e0_p1</title>
<path fill="none" stroke="black" d="M7915.81,-291.18C7913.85,-283.14 7911.64,-274.09 7909.54,-265.49"/>
<polygon fill="black" stroke="black" points="7912.92,-264.56 7907.14,-255.68 7906.12,-266.22 7912.92,-264.56"/>
</g>
<!-- attention_e4_t2_p1&#45;&gt;moe_e4_t2_e1_p1 -->
<g id="edge316" class="edge">
<title>attention_e4_t2_p1&#45;&gt;moe_e4_t2_e1_p1</title>
<path fill="none" stroke="black" d="M7992.65,-291.42C8021.22,-281.26 8054.36,-269.48 8083.83,-259.01"/>
<polygon fill="black" stroke="black" points="8085.01,-262.31 8093.27,-255.66 8082.67,-255.71 8085.01,-262.31"/>
</g>
<!-- tensor_reduce_e4_t2_p1 -->
<g id="node231" class="node">
<title>tensor_reduce_e4_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="8164" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="8164" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="8164" y="-133.75" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="8164" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8164" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t2_e0_p1&#45;&gt;tensor_reduce_e4_t2_p1 -->
<g id="edge317" class="edge">
<title>moe_e4_t2_e0_p1&#45;&gt;tensor_reduce_e4_t2_p1</title>
<path fill="none" stroke="black" d="M7969.07,-203.48C7999.69,-192.21 8036.33,-178.73 8069.54,-166.51"/>
<polygon fill="black" stroke="black" points="8071.09,-169.67 8079.27,-162.93 8068.68,-163.1 8071.09,-169.67"/>
</g>
<!-- moe_e4_t2_e1_p1&#45;&gt;tensor_reduce_e4_t2_p1 -->
<g id="edge318" class="edge">
<title>moe_e4_t2_e1_p1&#45;&gt;tensor_reduce_e4_t2_p1</title>
<path fill="none" stroke="black" d="M8164,-203.35C8164,-195.54 8164,-186.68 8164,-177.91"/>
<polygon fill="black" stroke="black" points="8167.5,-177.73 8164,-167.73 8160.5,-177.73 8167.5,-177.73"/>
</g>
<!-- tensor_reduce_e4_t2_p1&#45;&gt;output -->
<g id="edge405" class="edge">
<title>tensor_reduce_e4_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8292.23,-105.9C8343.68,-96.67 8403.57,-86.33 8458,-77.98 8525.07,-67.7 8599.26,-57.73 8663.28,-49.57"/>
<polygon fill="black" stroke="black" points="8663.98,-53.01 8673.46,-48.28 8663.1,-46.07 8663.98,-53.01"/>
</g>
<!-- attention_e4_t3_p1&#45;&gt;moe_e4_t3_e0_p1 -->
<g id="edge320" class="edge">
<title>attention_e4_t3_p1&#45;&gt;moe_e4_t3_e0_p1</title>
<path fill="none" stroke="black" d="M8317.96,-291.42C8335.12,-281.83 8354.86,-270.81 8372.8,-260.79"/>
<polygon fill="black" stroke="black" points="8374.96,-263.59 8381.99,-255.66 8371.55,-257.48 8374.96,-263.59"/>
</g>
<!-- attention_e4_t3_p1&#45;&gt;moe_e4_t3_e1_p1 -->
<g id="edge321" class="edge">
<title>attention_e4_t3_p1&#45;&gt;moe_e4_t3_e1_p1</title>
<path fill="none" stroke="black" d="M8394.45,-291.47C8445.95,-280.85 8506.09,-268.45 8558.62,-257.62"/>
<polygon fill="black" stroke="black" points="8559.59,-260.99 8568.68,-255.54 8558.18,-254.13 8559.59,-260.99"/>
</g>
<!-- tensor_reduce_e4_t3_p1 -->
<g id="node235" class="node">
<title>tensor_reduce_e4_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="8640" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="8640" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="8640" y="-133.75" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="8640" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="8640" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e4_t3_e0_p1&#45;&gt;tensor_reduce_e4_t3_p1 -->
<g id="edge322" class="edge">
<title>moe_e4_t3_e0_p1&#45;&gt;tensor_reduce_e4_t3_p1</title>
<path fill="none" stroke="black" d="M8482.13,-203.48C8505.51,-192.85 8533.24,-180.25 8558.88,-168.6"/>
<polygon fill="black" stroke="black" points="8560.57,-171.68 8568.23,-164.36 8557.67,-165.31 8560.57,-171.68"/>
</g>
<!-- moe_e4_t3_e1_p1&#45;&gt;tensor_reduce_e4_t3_p1 -->
<g id="edge323" class="edge">
<title>moe_e4_t3_e1_p1&#45;&gt;tensor_reduce_e4_t3_p1</title>
<path fill="none" stroke="black" d="M8676.99,-203.35C8672.74,-195.12 8667.88,-185.71 8663.11,-176.48"/>
<polygon fill="black" stroke="black" points="8666.1,-174.64 8658.4,-167.36 8659.88,-177.85 8666.1,-174.64"/>
</g>
<!-- tensor_reduce_e4_t3_p1&#45;&gt;output -->
<g id="edge406" class="edge">
<title>tensor_reduce_e4_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M8701.86,-96.39C8722.45,-85.29 8745.32,-72.96 8765.71,-61.97"/>
<polygon fill="black" stroke="black" points="8767.44,-65.01 8774.58,-57.18 8764.12,-58.85 8767.44,-65.01"/>
</g>
<!-- gate_e5_p1 -->
<g id="node236" class="node">
<title>gate_e5_p1</title>
<polygon fill="lightyellow" stroke="black" points="6073.24,-593.06 5652.89,-593.06 5544.76,-489.06 5965.11,-489.06 6073.24,-593.06"/>
<text text-anchor="middle" x="5809" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="5809" y="-544.06" font-family="Arial" font-size="10.00">GPU: 52&#45;55</text>
<text text-anchor="middle" x="5809" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="5809" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e5_p1 -->
<g id="node237" class="node">
<title>all2all_local_e5_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="5466" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="5466" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="5466" y="-419.29" font-family="Arial" font-size="10.00">GPU: 52&#45;55</text>
<text text-anchor="middle" x="5466" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="5466" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e5_p1&#45;&gt;all2all_local_e5_p1 -->
<g id="edge324" class="edge">
<title>gate_e5_p1&#45;&gt;all2all_local_e5_p1</title>
<path fill="none" stroke="black" d="M5666.02,-488.88C5631.2,-476.42 5594.77,-463.38 5562.69,-451.9"/>
<polygon fill="black" stroke="black" points="5563.47,-448.46 5552.88,-448.39 5561.11,-455.05 5563.47,-448.46"/>
</g>
<!-- moe_e5_t0_e0_p1 -->
<g id="node239" class="node">
<title>moe_e5_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="4860.5,-255.52 4615.5,-255.52 4615.5,-203.52 4860.5,-203.52 4860.5,-255.52"/>
<text text-anchor="middle" x="4738" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="4738" y="-232.52" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="4738" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4738" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t0_e0_p1 -->
<g id="edge500" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5587.2,-530.19C5387.09,-518.72 5109.11,-495.66 5008,-453.06 4905.18,-409.74 4810.91,-314.03 4765.86,-263.4"/>
<polygon fill="black" stroke="black" points="4768.29,-260.87 4759.05,-255.68 4763.04,-265.49 4768.29,-260.87"/>
</g>
<!-- moe_e5_t0_e1_p1 -->
<g id="node240" class="node">
<title>moe_e5_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="5123.5,-255.52 4878.5,-255.52 4878.5,-203.52 5123.5,-203.52 5123.5,-255.52"/>
<text text-anchor="middle" x="5001" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="5001" y="-232.52" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="5001" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5001" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t0_e1_p1 -->
<g id="edge502" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5576.49,-519.71C5353.32,-494.51 5040.33,-442.25 4972,-343.52 4955.85,-320.19 4966.06,-288.55 4978.62,-264.69"/>
<polygon fill="black" stroke="black" points="4981.68,-266.39 4983.5,-255.95 4975.57,-262.98 4981.68,-266.39"/>
</g>
<!-- moe_e5_t1_e0_p1 -->
<g id="node243" class="node">
<title>moe_e5_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="5386.5,-255.52 5141.5,-255.52 5141.5,-203.52 5386.5,-203.52 5386.5,-255.52"/>
<text text-anchor="middle" x="5264" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="5264" y="-232.52" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="5264" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5264" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t1_e0_p1 -->
<g id="edge504" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5587.82,-530.68C5462.08,-520.35 5321.61,-498.65 5280,-453.06 5267.68,-439.57 5264.83,-325.09 5264.18,-265.8"/>
<polygon fill="black" stroke="black" points="5267.68,-265.72 5264.09,-255.76 5260.68,-265.79 5267.68,-265.72"/>
</g>
<!-- moe_e5_t1_e1_p1 -->
<g id="node244" class="node">
<title>moe_e5_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="5649.5,-255.52 5404.5,-255.52 5404.5,-203.52 5649.5,-203.52 5649.5,-255.52"/>
<text text-anchor="middle" x="5527" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="5527" y="-232.52" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="5527" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5527" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t1_e1_p1 -->
<g id="edge506" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.48,-488.79C5723.02,-426.2 5644.45,-324.58 5610,-291.52 5598.99,-280.96 5586.1,-270.66 5573.81,-261.63"/>
<polygon fill="black" stroke="black" points="5575.58,-258.59 5565.42,-255.59 5571.49,-264.27 5575.58,-258.59"/>
</g>
<!-- moe_e5_t2_e0_p1 -->
<g id="node247" class="node">
<title>moe_e5_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="5912.5,-255.52 5667.5,-255.52 5667.5,-203.52 5912.5,-203.52 5912.5,-255.52"/>
<text text-anchor="middle" x="5790" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="5790" y="-232.52" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="5790" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5790" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t2_e0_p1 -->
<g id="edge508" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5871.48,-488.92C5926.54,-437.48 5991.6,-356.69 5947,-291.52 5938.19,-278.65 5926.25,-268.5 5912.85,-260.49"/>
<polygon fill="black" stroke="black" points="5914.3,-257.29 5903.85,-255.53 5910.92,-263.42 5914.3,-257.29"/>
</g>
<!-- moe_e5_t2_e1_p1 -->
<g id="node248" class="node">
<title>moe_e5_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="6175.5,-255.52 5930.5,-255.52 5930.5,-203.52 6175.5,-203.52 6175.5,-255.52"/>
<text text-anchor="middle" x="6053" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="6053" y="-232.52" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="6053" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6053" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t2_e1_p1 -->
<g id="edge510" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5895.39,-488.97C5909.65,-478.23 5923.51,-466.14 5935,-453.06 5988.26,-392.41 5979.46,-362.44 6018,-291.52 6022.8,-282.68 6028.14,-273.22 6033.17,-264.44"/>
<polygon fill="black" stroke="black" points="6036.3,-266.01 6038.26,-255.6 6030.24,-262.52 6036.3,-266.01"/>
</g>
<!-- moe_e5_t3_e0_p1 -->
<g id="node251" class="node">
<title>moe_e5_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="6438.5,-255.52 6193.5,-255.52 6193.5,-203.52 6438.5,-203.52 6438.5,-255.52"/>
<text text-anchor="middle" x="6316" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="6316" y="-232.52" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="6316" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6316" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t3_e0_p1 -->
<g id="edge512" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5993.05,-515.76C6101.9,-491.23 6232.46,-442.04 6306,-343.52 6322.42,-321.53 6323.92,-289.99 6321.89,-265.81"/>
<polygon fill="black" stroke="black" points="6325.34,-265.19 6320.79,-255.62 6318.38,-265.94 6325.34,-265.19"/>
</g>
<!-- moe_e5_t3_e1_p1 -->
<g id="node252" class="node">
<title>moe_e5_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="6701.5,-255.52 6456.5,-255.52 6456.5,-203.52 6701.5,-203.52 6701.5,-255.52"/>
<text text-anchor="middle" x="6579" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="6579" y="-232.52" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="6579" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6579" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e5_p1&#45;&gt;moe_e5_t3_e1_p1 -->
<g id="edge514" class="edge">
<title>gate_e5_p1&#45;&gt;moe_e5_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5993.47,-516.32C6067.79,-503.03 6153.22,-482.91 6227,-453.06 6350.15,-403.23 6477.86,-310.28 6540.14,-261.79"/>
<polygon fill="black" stroke="black" points="6542.41,-264.45 6548.13,-255.53 6538.1,-258.94 6542.41,-264.45"/>
</g>
<!-- attention_e5_t0_p1 -->
<g id="node238" class="node">
<title>attention_e5_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="5251,-343.52 4981,-343.52 4981,-291.52 5251,-291.52 5251,-343.52"/>
<text text-anchor="middle" x="5116" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5116" y="-320.52" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="5116" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5116" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p1&#45;&gt;attention_e5_t0_p1 -->
<g id="edge325" class="edge">
<title>all2all_local_e5_p1&#45;&gt;attention_e5_t0_p1</title>
<path fill="none" stroke="black" d="M5361.94,-386.52C5315.94,-373.8 5262.08,-358.91 5216.5,-346.31"/>
<polygon fill="black" stroke="black" points="5217.18,-342.87 5206.61,-343.57 5215.32,-349.61 5217.18,-342.87"/>
</g>
<!-- attention_e5_t1_p1 -->
<g id="node242" class="node">
<title>attention_e5_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="5601,-343.52 5331,-343.52 5331,-291.52 5601,-291.52 5601,-343.52"/>
<text text-anchor="middle" x="5466" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5466" y="-320.52" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="5466" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5466" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p1&#45;&gt;attention_e5_t1_p1 -->
<g id="edge330" class="edge">
<title>all2all_local_e5_p1&#45;&gt;attention_e5_t1_p1</title>
<path fill="none" stroke="black" d="M5466,-379.26C5466,-370.95 5466,-362.11 5466,-353.83"/>
<polygon fill="black" stroke="black" points="5469.5,-353.72 5466,-343.72 5462.5,-353.72 5469.5,-353.72"/>
</g>
<!-- attention_e5_t2_p1 -->
<g id="node246" class="node">
<title>attention_e5_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="5938,-343.52 5668,-343.52 5668,-291.52 5938,-291.52 5938,-343.52"/>
<text text-anchor="middle" x="5803" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5803" y="-320.52" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="5803" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="5803" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p1&#45;&gt;attention_e5_t2_p1 -->
<g id="edge335" class="edge">
<title>all2all_local_e5_p1&#45;&gt;attention_e5_t2_p1</title>
<path fill="none" stroke="black" d="M5567.57,-386.13C5611.53,-373.5 5662.75,-358.79 5706.17,-346.33"/>
<polygon fill="black" stroke="black" points="5707.24,-349.66 5715.88,-343.54 5705.3,-342.93 5707.24,-349.66"/>
</g>
<!-- attention_e5_t3_p1 -->
<g id="node250" class="node">
<title>attention_e5_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="6297,-343.52 6027,-343.52 6027,-291.52 6297,-291.52 6297,-343.52"/>
<text text-anchor="middle" x="6162" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="6162" y="-320.52" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="6162" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="6162" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e5_p1&#45;&gt;attention_e5_t3_p1 -->
<g id="edge340" class="edge">
<title>all2all_local_e5_p1&#45;&gt;attention_e5_t3_p1</title>
<path fill="none" stroke="black" d="M5611.06,-395.12C5730.12,-378.57 5897.89,-355.24 6016.95,-338.69"/>
<polygon fill="black" stroke="black" points="6017.45,-342.15 6026.87,-337.31 6016.49,-335.22 6017.45,-342.15"/>
</g>
<!-- attention_e5_t0_p1&#45;&gt;moe_e5_t0_e0_p1 -->
<g id="edge326" class="edge">
<title>attention_e5_t0_p1&#45;&gt;moe_e5_t0_e0_p1</title>
<path fill="none" stroke="black" d="M5005.9,-291.47C4959.51,-280.92 4905.39,-268.61 4857.98,-257.82"/>
<polygon fill="black" stroke="black" points="4858.5,-254.35 4847.97,-255.54 4856.95,-261.17 4858.5,-254.35"/>
</g>
<!-- attention_e5_t0_p1&#45;&gt;moe_e5_t0_e1_p1 -->
<g id="edge327" class="edge">
<title>attention_e5_t0_p1&#45;&gt;moe_e5_t0_e1_p1</title>
<path fill="none" stroke="black" d="M5082.43,-291.42C5070.14,-282.22 5056.07,-271.71 5043.13,-262.03"/>
<polygon fill="black" stroke="black" points="5044.92,-258.99 5034.81,-255.81 5040.72,-264.6 5044.92,-258.99"/>
</g>
<!-- tensor_reduce_e5_t0_p1 -->
<g id="node241" class="node">
<title>tensor_reduce_e5_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="5001" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="5001" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="5001" y="-133.75" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="5001" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5001" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t0_e0_p1&#45;&gt;tensor_reduce_e5_t0_p1 -->
<g id="edge328" class="edge">
<title>moe_e5_t0_e0_p1&#45;&gt;tensor_reduce_e5_t0_p1</title>
<path fill="none" stroke="black" d="M4806.07,-203.48C4836.69,-192.21 4873.33,-178.73 4906.54,-166.51"/>
<polygon fill="black" stroke="black" points="4908.09,-169.67 4916.27,-162.93 4905.68,-163.1 4908.09,-169.67"/>
</g>
<!-- moe_e5_t0_e1_p1&#45;&gt;tensor_reduce_e5_t0_p1 -->
<g id="edge329" class="edge">
<title>moe_e5_t0_e1_p1&#45;&gt;tensor_reduce_e5_t0_p1</title>
<path fill="none" stroke="black" d="M5001,-203.35C5001,-195.54 5001,-186.68 5001,-177.91"/>
<polygon fill="black" stroke="black" points="5004.5,-177.73 5001,-167.73 4997.5,-177.73 5004.5,-177.73"/>
</g>
<!-- tensor_reduce_e5_t0_p1&#45;&gt;output -->
<g id="edge407" class="edge">
<title>tensor_reduce_e5_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5129.97,-106.11C5194.33,-95.39 5273.52,-83.83 5345,-77.98 5668.98,-51.49 7907.19,-35.63 8612.58,-31.24"/>
<polygon fill="black" stroke="black" points="8612.62,-34.74 8622.6,-31.18 8612.57,-27.74 8612.62,-34.74"/>
</g>
<!-- attention_e5_t1_p1&#45;&gt;moe_e5_t1_e0_p1 -->
<g id="edge331" class="edge">
<title>attention_e5_t1_p1&#45;&gt;moe_e5_t1_e0_p1</title>
<path fill="none" stroke="black" d="M5407.03,-291.42C5383.69,-281.48 5356.71,-269.99 5332.52,-259.69"/>
<polygon fill="black" stroke="black" points="5333.61,-256.36 5323.04,-255.66 5330.87,-262.8 5333.61,-256.36"/>
</g>
<!-- attention_e5_t1_p1&#45;&gt;moe_e5_t1_e1_p1 -->
<g id="edge332" class="edge">
<title>attention_e5_t1_p1&#45;&gt;moe_e5_t1_e1_p1</title>
<path fill="none" stroke="black" d="M5483.97,-291.18C5489.99,-282.7 5496.8,-273.1 5503.19,-264.09"/>
<polygon fill="black" stroke="black" points="5506.23,-265.86 5509.16,-255.68 5500.52,-261.81 5506.23,-265.86"/>
</g>
<!-- tensor_reduce_e5_t1_p1 -->
<g id="node245" class="node">
<title>tensor_reduce_e5_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="5527" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="5527" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="5527" y="-133.75" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="5527" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="5527" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t1_e0_p1&#45;&gt;tensor_reduce_e5_t1_p1 -->
<g id="edge333" class="edge">
<title>moe_e5_t1_e0_p1&#45;&gt;tensor_reduce_e5_t1_p1</title>
<path fill="none" stroke="black" d="M5332.07,-203.48C5362.69,-192.21 5399.33,-178.73 5432.54,-166.51"/>
<polygon fill="black" stroke="black" points="5434.09,-169.67 5442.27,-162.93 5431.68,-163.1 5434.09,-169.67"/>
</g>
<!-- moe_e5_t1_e1_p1&#45;&gt;tensor_reduce_e5_t1_p1 -->
<g id="edge334" class="edge">
<title>moe_e5_t1_e1_p1&#45;&gt;tensor_reduce_e5_t1_p1</title>
<path fill="none" stroke="black" d="M5527,-203.35C5527,-195.54 5527,-186.68 5527,-177.91"/>
<polygon fill="black" stroke="black" points="5530.5,-177.73 5527,-167.73 5523.5,-177.73 5530.5,-177.73"/>
</g>
<!-- tensor_reduce_e5_t1_p1&#45;&gt;output -->
<g id="edge408" class="edge">
<title>tensor_reduce_e5_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5655.98,-106.18C5720.34,-95.48 5799.53,-83.91 5871,-77.98 6403.62,-33.78 8026.63,-29.74 8611.81,-29.77"/>
<polygon fill="black" stroke="black" points="8612.05,-33.27 8622.05,-29.77 8612.05,-26.27 8612.05,-33.27"/>
</g>
<!-- attention_e5_t2_p1&#45;&gt;moe_e5_t2_e0_p1 -->
<g id="edge336" class="edge">
<title>attention_e5_t2_p1&#45;&gt;moe_e5_t2_e0_p1</title>
<path fill="none" stroke="black" d="M5799.17,-291.18C5797.97,-283.22 5796.62,-274.29 5795.33,-265.77"/>
<polygon fill="black" stroke="black" points="5798.76,-265.04 5793.8,-255.68 5791.84,-266.09 5798.76,-265.04"/>
</g>
<!-- attention_e5_t2_p1&#45;&gt;moe_e5_t2_e1_p1 -->
<g id="edge337" class="edge">
<title>attention_e5_t2_p1&#45;&gt;moe_e5_t2_e1_p1</title>
<path fill="none" stroke="black" d="M5875.98,-291.42C5905.5,-281.26 5939.74,-269.48 5970.18,-259.01"/>
<polygon fill="black" stroke="black" points="5971.61,-262.22 5979.93,-255.66 5969.33,-255.6 5971.61,-262.22"/>
</g>
<!-- tensor_reduce_e5_t2_p1 -->
<g id="node249" class="node">
<title>tensor_reduce_e5_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="6053" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="6053" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="6053" y="-133.75" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="6053" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6053" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t2_e0_p1&#45;&gt;tensor_reduce_e5_t2_p1 -->
<g id="edge338" class="edge">
<title>moe_e5_t2_e0_p1&#45;&gt;tensor_reduce_e5_t2_p1</title>
<path fill="none" stroke="black" d="M5858.07,-203.48C5888.69,-192.21 5925.33,-178.73 5958.54,-166.51"/>
<polygon fill="black" stroke="black" points="5960.09,-169.67 5968.27,-162.93 5957.68,-163.1 5960.09,-169.67"/>
</g>
<!-- moe_e5_t2_e1_p1&#45;&gt;tensor_reduce_e5_t2_p1 -->
<g id="edge339" class="edge">
<title>moe_e5_t2_e1_p1&#45;&gt;tensor_reduce_e5_t2_p1</title>
<path fill="none" stroke="black" d="M6053,-203.35C6053,-195.54 6053,-186.68 6053,-177.91"/>
<polygon fill="black" stroke="black" points="6056.5,-177.73 6053,-167.73 6049.5,-177.73 6056.5,-177.73"/>
</g>
<!-- tensor_reduce_e5_t2_p1&#45;&gt;output -->
<g id="edge409" class="edge">
<title>tensor_reduce_e5_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6173.29,-104.23C6226.3,-94.11 6289.48,-83.57 6347,-77.98 6783.22,-35.61 8094.3,-30.28 8611.68,-29.88"/>
<polygon fill="black" stroke="black" points="8611.88,-33.38 8621.88,-29.87 8611.87,-26.38 8611.88,-33.38"/>
</g>
<!-- attention_e5_t3_p1&#45;&gt;moe_e5_t3_e0_p1 -->
<g id="edge341" class="edge">
<title>attention_e5_t3_p1&#45;&gt;moe_e5_t3_e0_p1</title>
<path fill="none" stroke="black" d="M6206.96,-291.42C6224.12,-281.83 6243.86,-270.81 6261.8,-260.79"/>
<polygon fill="black" stroke="black" points="6263.96,-263.59 6270.99,-255.66 6260.55,-257.48 6263.96,-263.59"/>
</g>
<!-- attention_e5_t3_p1&#45;&gt;moe_e5_t3_e1_p1 -->
<g id="edge342" class="edge">
<title>attention_e5_t3_p1&#45;&gt;moe_e5_t3_e1_p1</title>
<path fill="none" stroke="black" d="M6283.45,-291.47C6334.95,-280.85 6395.09,-268.45 6447.62,-257.62"/>
<polygon fill="black" stroke="black" points="6448.59,-260.99 6457.68,-255.54 6447.18,-254.13 6448.59,-260.99"/>
</g>
<!-- tensor_reduce_e5_t3_p1 -->
<g id="node253" class="node">
<title>tensor_reduce_e5_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="6529" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="6529" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="6529" y="-133.75" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="6529" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="6529" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e5_t3_e0_p1&#45;&gt;tensor_reduce_e5_t3_p1 -->
<g id="edge343" class="edge">
<title>moe_e5_t3_e0_p1&#45;&gt;tensor_reduce_e5_t3_p1</title>
<path fill="none" stroke="black" d="M6371.13,-203.48C6394.51,-192.85 6422.24,-180.25 6447.88,-168.6"/>
<polygon fill="black" stroke="black" points="6449.57,-171.68 6457.23,-164.36 6446.67,-165.31 6449.57,-171.68"/>
</g>
<!-- moe_e5_t3_e1_p1&#45;&gt;tensor_reduce_e5_t3_p1 -->
<g id="edge344" class="edge">
<title>moe_e5_t3_e1_p1&#45;&gt;tensor_reduce_e5_t3_p1</title>
<path fill="none" stroke="black" d="M6565.99,-203.35C6561.74,-195.12 6556.88,-185.71 6552.11,-176.48"/>
<polygon fill="black" stroke="black" points="6555.1,-174.64 6547.4,-167.36 6548.88,-177.85 6555.1,-174.64"/>
</g>
<!-- tensor_reduce_e5_t3_p1&#45;&gt;output -->
<g id="edge410" class="edge">
<title>tensor_reduce_e5_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6620.24,-99.34C6649.81,-90.81 6682.99,-82.6 6714,-77.98 6897.77,-50.62 8114.34,-36.5 8612.69,-31.81"/>
<polygon fill="black" stroke="black" points="8612.91,-35.3 8622.88,-31.71 8612.85,-28.31 8612.91,-35.3"/>
</g>
<!-- gate_e6_p1 -->
<g id="node254" class="node">
<title>gate_e6_p1</title>
<polygon fill="lightyellow" stroke="black" points="3962.24,-593.06 3541.89,-593.06 3433.76,-489.06 3854.11,-489.06 3962.24,-593.06"/>
<text text-anchor="middle" x="3698" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="3698" y="-544.06" font-family="Arial" font-size="10.00">GPU: 56&#45;59</text>
<text text-anchor="middle" x="3698" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="3698" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e6_p1 -->
<g id="node255" class="node">
<title>all2all_local_e6_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="3355" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="3355" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="3355" y="-419.29" font-family="Arial" font-size="10.00">GPU: 56&#45;59</text>
<text text-anchor="middle" x="3355" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="3355" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e6_p1&#45;&gt;all2all_local_e6_p1 -->
<g id="edge345" class="edge">
<title>gate_e6_p1&#45;&gt;all2all_local_e6_p1</title>
<path fill="none" stroke="black" d="M3555.02,-488.88C3520.2,-476.42 3483.77,-463.38 3451.69,-451.9"/>
<polygon fill="black" stroke="black" points="3452.47,-448.46 3441.88,-448.39 3450.11,-455.05 3452.47,-448.46"/>
</g>
<!-- moe_e6_t0_e0_p1 -->
<g id="node257" class="node">
<title>moe_e6_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="2749.5,-255.52 2504.5,-255.52 2504.5,-203.52 2749.5,-203.52 2749.5,-255.52"/>
<text text-anchor="middle" x="2627" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="2627" y="-232.52" font-family="Arial" font-size="10.00">GPU: 56</text>
<text text-anchor="middle" x="2627" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2627" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t0_e0_p1 -->
<g id="edge516" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3476.2,-530.19C3276.09,-518.72 2998.11,-495.66 2897,-453.06 2794.18,-409.74 2699.91,-314.03 2654.86,-263.4"/>
<polygon fill="black" stroke="black" points="2657.29,-260.87 2648.05,-255.68 2652.04,-265.49 2657.29,-260.87"/>
</g>
<!-- moe_e6_t0_e1_p1 -->
<g id="node258" class="node">
<title>moe_e6_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="3012.5,-255.52 2767.5,-255.52 2767.5,-203.52 3012.5,-203.52 3012.5,-255.52"/>
<text text-anchor="middle" x="2890" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="2890" y="-232.52" font-family="Arial" font-size="10.00">GPU: 56</text>
<text text-anchor="middle" x="2890" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2890" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t0_e1_p1 -->
<g id="edge518" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3465.49,-519.71C3242.32,-494.51 2929.33,-442.25 2861,-343.52 2844.85,-320.19 2855.06,-288.55 2867.62,-264.69"/>
<polygon fill="black" stroke="black" points="2870.68,-266.39 2872.5,-255.95 2864.57,-262.98 2870.68,-266.39"/>
</g>
<!-- moe_e6_t1_e0_p1 -->
<g id="node261" class="node">
<title>moe_e6_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="3275.5,-255.52 3030.5,-255.52 3030.5,-203.52 3275.5,-203.52 3275.5,-255.52"/>
<text text-anchor="middle" x="3153" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="3153" y="-232.52" font-family="Arial" font-size="10.00">GPU: 57</text>
<text text-anchor="middle" x="3153" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3153" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t1_e0_p1 -->
<g id="edge520" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3476.82,-530.68C3351.08,-520.35 3210.61,-498.65 3169,-453.06 3156.68,-439.57 3153.83,-325.09 3153.18,-265.8"/>
<polygon fill="black" stroke="black" points="3156.68,-265.72 3153.09,-255.76 3149.68,-265.79 3156.68,-265.72"/>
</g>
<!-- moe_e6_t1_e1_p1 -->
<g id="node262" class="node">
<title>moe_e6_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="3538.5,-255.52 3293.5,-255.52 3293.5,-203.52 3538.5,-203.52 3538.5,-255.52"/>
<text text-anchor="middle" x="3416" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="3416" y="-232.52" font-family="Arial" font-size="10.00">GPU: 57</text>
<text text-anchor="middle" x="3416" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3416" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t1_e1_p1 -->
<g id="edge522" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3659.48,-488.79C3612.02,-426.2 3533.45,-324.58 3499,-291.52 3487.99,-280.96 3475.1,-270.66 3462.81,-261.63"/>
<polygon fill="black" stroke="black" points="3464.58,-258.59 3454.42,-255.59 3460.49,-264.27 3464.58,-258.59"/>
</g>
<!-- moe_e6_t2_e0_p1 -->
<g id="node265" class="node">
<title>moe_e6_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="3801.5,-255.52 3556.5,-255.52 3556.5,-203.52 3801.5,-203.52 3801.5,-255.52"/>
<text text-anchor="middle" x="3679" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="3679" y="-232.52" font-family="Arial" font-size="10.00">GPU: 58</text>
<text text-anchor="middle" x="3679" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3679" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t2_e0_p1 -->
<g id="edge524" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3760.48,-488.92C3815.54,-437.48 3880.6,-356.69 3836,-291.52 3827.19,-278.65 3815.25,-268.5 3801.85,-260.49"/>
<polygon fill="black" stroke="black" points="3803.3,-257.29 3792.85,-255.53 3799.92,-263.42 3803.3,-257.29"/>
</g>
<!-- moe_e6_t2_e1_p1 -->
<g id="node266" class="node">
<title>moe_e6_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="4064.5,-255.52 3819.5,-255.52 3819.5,-203.52 4064.5,-203.52 4064.5,-255.52"/>
<text text-anchor="middle" x="3942" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="3942" y="-232.52" font-family="Arial" font-size="10.00">GPU: 58</text>
<text text-anchor="middle" x="3942" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3942" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t2_e1_p1 -->
<g id="edge526" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3784.39,-488.97C3798.65,-478.23 3812.51,-466.14 3824,-453.06 3877.26,-392.41 3868.46,-362.44 3907,-291.52 3911.8,-282.68 3917.14,-273.22 3922.17,-264.44"/>
<polygon fill="black" stroke="black" points="3925.3,-266.01 3927.26,-255.6 3919.24,-262.52 3925.3,-266.01"/>
</g>
<!-- moe_e6_t3_e0_p1 -->
<g id="node269" class="node">
<title>moe_e6_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="4327.5,-255.52 4082.5,-255.52 4082.5,-203.52 4327.5,-203.52 4327.5,-255.52"/>
<text text-anchor="middle" x="4205" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="4205" y="-232.52" font-family="Arial" font-size="10.00">GPU: 59</text>
<text text-anchor="middle" x="4205" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4205" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t3_e0_p1 -->
<g id="edge528" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3882.05,-515.76C3990.9,-491.23 4121.46,-442.04 4195,-343.52 4211.42,-321.53 4212.92,-289.99 4210.89,-265.81"/>
<polygon fill="black" stroke="black" points="4214.34,-265.19 4209.79,-255.62 4207.38,-265.94 4214.34,-265.19"/>
</g>
<!-- moe_e6_t3_e1_p1 -->
<g id="node270" class="node">
<title>moe_e6_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="4590.5,-255.52 4345.5,-255.52 4345.5,-203.52 4590.5,-203.52 4590.5,-255.52"/>
<text text-anchor="middle" x="4468" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="4468" y="-232.52" font-family="Arial" font-size="10.00">GPU: 59</text>
<text text-anchor="middle" x="4468" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4468" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e6_p1&#45;&gt;moe_e6_t3_e1_p1 -->
<g id="edge530" class="edge">
<title>gate_e6_p1&#45;&gt;moe_e6_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3882.47,-516.32C3956.79,-503.03 4042.22,-482.91 4116,-453.06 4239.15,-403.23 4366.86,-310.28 4429.14,-261.79"/>
<polygon fill="black" stroke="black" points="4431.41,-264.45 4437.13,-255.53 4427.1,-258.94 4431.41,-264.45"/>
</g>
<!-- attention_e6_t0_p1 -->
<g id="node256" class="node">
<title>attention_e6_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="3140,-343.52 2870,-343.52 2870,-291.52 3140,-291.52 3140,-343.52"/>
<text text-anchor="middle" x="3005" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3005" y="-320.52" font-family="Arial" font-size="10.00">GPU: 56</text>
<text text-anchor="middle" x="3005" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3005" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p1&#45;&gt;attention_e6_t0_p1 -->
<g id="edge346" class="edge">
<title>all2all_local_e6_p1&#45;&gt;attention_e6_t0_p1</title>
<path fill="none" stroke="black" d="M3250.94,-386.52C3204.94,-373.8 3151.08,-358.91 3105.5,-346.31"/>
<polygon fill="black" stroke="black" points="3106.18,-342.87 3095.61,-343.57 3104.32,-349.61 3106.18,-342.87"/>
</g>
<!-- attention_e6_t1_p1 -->
<g id="node260" class="node">
<title>attention_e6_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="3490,-343.52 3220,-343.52 3220,-291.52 3490,-291.52 3490,-343.52"/>
<text text-anchor="middle" x="3355" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3355" y="-320.52" font-family="Arial" font-size="10.00">GPU: 57</text>
<text text-anchor="middle" x="3355" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3355" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p1&#45;&gt;attention_e6_t1_p1 -->
<g id="edge351" class="edge">
<title>all2all_local_e6_p1&#45;&gt;attention_e6_t1_p1</title>
<path fill="none" stroke="black" d="M3355,-379.26C3355,-370.95 3355,-362.11 3355,-353.83"/>
<polygon fill="black" stroke="black" points="3358.5,-353.72 3355,-343.72 3351.5,-353.72 3358.5,-353.72"/>
</g>
<!-- attention_e6_t2_p1 -->
<g id="node264" class="node">
<title>attention_e6_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="3827,-343.52 3557,-343.52 3557,-291.52 3827,-291.52 3827,-343.52"/>
<text text-anchor="middle" x="3692" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3692" y="-320.52" font-family="Arial" font-size="10.00">GPU: 58</text>
<text text-anchor="middle" x="3692" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="3692" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p1&#45;&gt;attention_e6_t2_p1 -->
<g id="edge356" class="edge">
<title>all2all_local_e6_p1&#45;&gt;attention_e6_t2_p1</title>
<path fill="none" stroke="black" d="M3456.57,-386.13C3500.53,-373.5 3551.75,-358.79 3595.17,-346.33"/>
<polygon fill="black" stroke="black" points="3596.24,-349.66 3604.88,-343.54 3594.3,-342.93 3596.24,-349.66"/>
</g>
<!-- attention_e6_t3_p1 -->
<g id="node268" class="node">
<title>attention_e6_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="4186,-343.52 3916,-343.52 3916,-291.52 4186,-291.52 4186,-343.52"/>
<text text-anchor="middle" x="4051" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4051" y="-320.52" font-family="Arial" font-size="10.00">GPU: 59</text>
<text text-anchor="middle" x="4051" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="4051" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e6_p1&#45;&gt;attention_e6_t3_p1 -->
<g id="edge361" class="edge">
<title>all2all_local_e6_p1&#45;&gt;attention_e6_t3_p1</title>
<path fill="none" stroke="black" d="M3500.06,-395.12C3619.12,-378.57 3786.89,-355.24 3905.95,-338.69"/>
<polygon fill="black" stroke="black" points="3906.45,-342.15 3915.87,-337.31 3905.49,-335.22 3906.45,-342.15"/>
</g>
<!-- attention_e6_t0_p1&#45;&gt;moe_e6_t0_e0_p1 -->
<g id="edge347" class="edge">
<title>attention_e6_t0_p1&#45;&gt;moe_e6_t0_e0_p1</title>
<path fill="none" stroke="black" d="M2894.9,-291.47C2848.51,-280.92 2794.39,-268.61 2746.98,-257.82"/>
<polygon fill="black" stroke="black" points="2747.5,-254.35 2736.97,-255.54 2745.95,-261.17 2747.5,-254.35"/>
</g>
<!-- attention_e6_t0_p1&#45;&gt;moe_e6_t0_e1_p1 -->
<g id="edge348" class="edge">
<title>attention_e6_t0_p1&#45;&gt;moe_e6_t0_e1_p1</title>
<path fill="none" stroke="black" d="M2971.43,-291.42C2959.14,-282.22 2945.07,-271.71 2932.13,-262.03"/>
<polygon fill="black" stroke="black" points="2933.92,-258.99 2923.81,-255.81 2929.72,-264.6 2933.92,-258.99"/>
</g>
<!-- tensor_reduce_e6_t0_p1 -->
<g id="node259" class="node">
<title>tensor_reduce_e6_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="2890" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="2890" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="2890" y="-133.75" font-family="Arial" font-size="10.00">GPU: 56</text>
<text text-anchor="middle" x="2890" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2890" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t0_e0_p1&#45;&gt;tensor_reduce_e6_t0_p1 -->
<g id="edge349" class="edge">
<title>moe_e6_t0_e0_p1&#45;&gt;tensor_reduce_e6_t0_p1</title>
<path fill="none" stroke="black" d="M2695.07,-203.48C2725.69,-192.21 2762.33,-178.73 2795.54,-166.51"/>
<polygon fill="black" stroke="black" points="2797.09,-169.67 2805.27,-162.93 2794.68,-163.1 2797.09,-169.67"/>
</g>
<!-- moe_e6_t0_e1_p1&#45;&gt;tensor_reduce_e6_t0_p1 -->
<g id="edge350" class="edge">
<title>moe_e6_t0_e1_p1&#45;&gt;tensor_reduce_e6_t0_p1</title>
<path fill="none" stroke="black" d="M2890,-203.35C2890,-195.54 2890,-186.68 2890,-177.91"/>
<polygon fill="black" stroke="black" points="2893.5,-177.73 2890,-167.73 2886.5,-177.73 2893.5,-177.73"/>
</g>
<!-- tensor_reduce_e6_t0_p1&#45;&gt;output -->
<g id="edge411" class="edge">
<title>tensor_reduce_e6_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3018.55,-106.01C3082.99,-95.24 3162.35,-83.65 3234,-77.98 3776.24,-35.07 7654.97,-30.51 8611.98,-30.04"/>
<polygon fill="black" stroke="black" points="8612.07,-33.54 8622.06,-30.04 8612.06,-26.54 8612.07,-33.54"/>
</g>
<!-- attention_e6_t1_p1&#45;&gt;moe_e6_t1_e0_p1 -->
<g id="edge352" class="edge">
<title>attention_e6_t1_p1&#45;&gt;moe_e6_t1_e0_p1</title>
<path fill="none" stroke="black" d="M3296.03,-291.42C3272.69,-281.48 3245.71,-269.99 3221.52,-259.69"/>
<polygon fill="black" stroke="black" points="3222.61,-256.36 3212.04,-255.66 3219.87,-262.8 3222.61,-256.36"/>
</g>
<!-- attention_e6_t1_p1&#45;&gt;moe_e6_t1_e1_p1 -->
<g id="edge353" class="edge">
<title>attention_e6_t1_p1&#45;&gt;moe_e6_t1_e1_p1</title>
<path fill="none" stroke="black" d="M3372.97,-291.18C3378.99,-282.7 3385.8,-273.1 3392.19,-264.09"/>
<polygon fill="black" stroke="black" points="3395.23,-265.86 3398.16,-255.68 3389.52,-261.81 3395.23,-265.86"/>
</g>
<!-- tensor_reduce_e6_t1_p1 -->
<g id="node263" class="node">
<title>tensor_reduce_e6_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="3416" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="3416" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="3416" y="-133.75" font-family="Arial" font-size="10.00">GPU: 57</text>
<text text-anchor="middle" x="3416" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3416" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t1_e0_p1&#45;&gt;tensor_reduce_e6_t1_p1 -->
<g id="edge354" class="edge">
<title>moe_e6_t1_e0_p1&#45;&gt;tensor_reduce_e6_t1_p1</title>
<path fill="none" stroke="black" d="M3221.07,-203.48C3251.69,-192.21 3288.33,-178.73 3321.54,-166.51"/>
<polygon fill="black" stroke="black" points="3323.09,-169.67 3331.27,-162.93 3320.68,-163.1 3323.09,-169.67"/>
</g>
<!-- moe_e6_t1_e1_p1&#45;&gt;tensor_reduce_e6_t1_p1 -->
<g id="edge355" class="edge">
<title>moe_e6_t1_e1_p1&#45;&gt;tensor_reduce_e6_t1_p1</title>
<path fill="none" stroke="black" d="M3416,-203.35C3416,-195.54 3416,-186.68 3416,-177.91"/>
<polygon fill="black" stroke="black" points="3419.5,-177.73 3416,-167.73 3412.5,-177.73 3419.5,-177.73"/>
</g>
<!-- tensor_reduce_e6_t1_p1&#45;&gt;output -->
<g id="edge412" class="edge">
<title>tensor_reduce_e6_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3544.56,-106.04C3608.99,-95.27 3688.36,-83.68 3760,-77.98 4247.47,-39.18 7711.76,-31.58 8611.78,-30.25"/>
<polygon fill="black" stroke="black" points="8611.93,-33.75 8621.92,-30.23 8611.92,-26.75 8611.93,-33.75"/>
</g>
<!-- attention_e6_t2_p1&#45;&gt;moe_e6_t2_e0_p1 -->
<g id="edge357" class="edge">
<title>attention_e6_t2_p1&#45;&gt;moe_e6_t2_e0_p1</title>
<path fill="none" stroke="black" d="M3688.17,-291.18C3686.97,-283.22 3685.62,-274.29 3684.33,-265.77"/>
<polygon fill="black" stroke="black" points="3687.76,-265.04 3682.8,-255.68 3680.84,-266.09 3687.76,-265.04"/>
</g>
<!-- attention_e6_t2_p1&#45;&gt;moe_e6_t2_e1_p1 -->
<g id="edge358" class="edge">
<title>attention_e6_t2_p1&#45;&gt;moe_e6_t2_e1_p1</title>
<path fill="none" stroke="black" d="M3764.98,-291.42C3794.5,-281.26 3828.74,-269.48 3859.18,-259.01"/>
<polygon fill="black" stroke="black" points="3860.61,-262.22 3868.93,-255.66 3858.33,-255.6 3860.61,-262.22"/>
</g>
<!-- tensor_reduce_e6_t2_p1 -->
<g id="node267" class="node">
<title>tensor_reduce_e6_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="3942" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="3942" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="3942" y="-133.75" font-family="Arial" font-size="10.00">GPU: 58</text>
<text text-anchor="middle" x="3942" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="3942" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t2_e0_p1&#45;&gt;tensor_reduce_e6_t2_p1 -->
<g id="edge359" class="edge">
<title>moe_e6_t2_e0_p1&#45;&gt;tensor_reduce_e6_t2_p1</title>
<path fill="none" stroke="black" d="M3747.07,-203.48C3777.69,-192.21 3814.33,-178.73 3847.54,-166.51"/>
<polygon fill="black" stroke="black" points="3849.09,-169.67 3857.27,-162.93 3846.68,-163.1 3849.09,-169.67"/>
</g>
<!-- moe_e6_t2_e1_p1&#45;&gt;tensor_reduce_e6_t2_p1 -->
<g id="edge360" class="edge">
<title>moe_e6_t2_e1_p1&#45;&gt;tensor_reduce_e6_t2_p1</title>
<path fill="none" stroke="black" d="M3942,-203.35C3942,-195.54 3942,-186.68 3942,-177.91"/>
<polygon fill="black" stroke="black" points="3945.5,-177.73 3942,-167.73 3938.5,-177.73 3945.5,-177.73"/>
</g>
<!-- tensor_reduce_e6_t2_p1&#45;&gt;output -->
<g id="edge413" class="edge">
<title>tensor_reduce_e6_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4061.56,-104.12C4114.7,-93.92 4178.2,-83.34 4236,-77.98 4673.67,-37.44 7766.57,-31.13 8611.92,-30.16"/>
<polygon fill="black" stroke="black" points="8612.07,-33.66 8622.07,-30.15 8612.07,-26.66 8612.07,-33.66"/>
</g>
<!-- attention_e6_t3_p1&#45;&gt;moe_e6_t3_e0_p1 -->
<g id="edge362" class="edge">
<title>attention_e6_t3_p1&#45;&gt;moe_e6_t3_e0_p1</title>
<path fill="none" stroke="black" d="M4095.96,-291.42C4113.12,-281.83 4132.86,-270.81 4150.8,-260.79"/>
<polygon fill="black" stroke="black" points="4152.96,-263.59 4159.99,-255.66 4149.55,-257.48 4152.96,-263.59"/>
</g>
<!-- attention_e6_t3_p1&#45;&gt;moe_e6_t3_e1_p1 -->
<g id="edge363" class="edge">
<title>attention_e6_t3_p1&#45;&gt;moe_e6_t3_e1_p1</title>
<path fill="none" stroke="black" d="M4172.45,-291.47C4223.95,-280.85 4284.09,-268.45 4336.62,-257.62"/>
<polygon fill="black" stroke="black" points="4337.59,-260.99 4346.68,-255.54 4336.18,-254.13 4337.59,-260.99"/>
</g>
<!-- tensor_reduce_e6_t3_p1 -->
<g id="node271" class="node">
<title>tensor_reduce_e6_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="4418" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="4418" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="4418" y="-133.75" font-family="Arial" font-size="10.00">GPU: 59</text>
<text text-anchor="middle" x="4418" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="4418" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e6_t3_e0_p1&#45;&gt;tensor_reduce_e6_t3_p1 -->
<g id="edge364" class="edge">
<title>moe_e6_t3_e0_p1&#45;&gt;tensor_reduce_e6_t3_p1</title>
<path fill="none" stroke="black" d="M4260.13,-203.48C4283.51,-192.85 4311.24,-180.25 4336.88,-168.6"/>
<polygon fill="black" stroke="black" points="4338.57,-171.68 4346.23,-164.36 4335.67,-165.31 4338.57,-171.68"/>
</g>
<!-- moe_e6_t3_e1_p1&#45;&gt;tensor_reduce_e6_t3_p1 -->
<g id="edge365" class="edge">
<title>moe_e6_t3_e1_p1&#45;&gt;tensor_reduce_e6_t3_p1</title>
<path fill="none" stroke="black" d="M4454.99,-203.35C4450.74,-195.12 4445.88,-185.71 4441.11,-176.48"/>
<polygon fill="black" stroke="black" points="4444.1,-174.64 4436.4,-167.36 4437.88,-177.85 4444.1,-174.64"/>
</g>
<!-- tensor_reduce_e6_t3_p1&#45;&gt;output -->
<g id="edge414" class="edge">
<title>tensor_reduce_e6_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4508.73,-99.27C4538.43,-90.67 4571.8,-82.45 4603,-77.98 4802.74,-49.4 7782.79,-34.48 8612.19,-30.87"/>
<polygon fill="black" stroke="black" points="8612.47,-34.37 8622.45,-30.82 8612.44,-27.37 8612.47,-34.37"/>
</g>
<!-- gate_e7_p1 -->
<g id="node272" class="node">
<title>gate_e7_p1</title>
<polygon fill="lightyellow" stroke="black" points="1858.24,-593.06 1437.89,-593.06 1329.76,-489.06 1750.11,-489.06 1858.24,-593.06"/>
<text text-anchor="middle" x="1594" y="-555.06" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="1594" y="-544.06" font-family="Arial" font-size="10.00">GPU: 60&#45;63</text>
<text text-anchor="middle" x="1594" y="-533.06" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="1594" y="-522.06" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_local_e7_p1 -->
<g id="node273" class="node">
<title>all2all_local_e7_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="1260" cy="-416.29" rx="176.55" ry="36.54"/>
<text text-anchor="middle" x="1260" y="-430.29" font-family="Arial" font-size="10.00">Local All&#45;to&#45;All</text>
<text text-anchor="middle" x="1260" y="-419.29" font-family="Arial" font-size="10.00">GPU: 60&#45;63</text>
<text text-anchor="middle" x="1260" y="-408.29" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="1260" y="-397.29" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2560, hidden=512]</text>
</g>
<!-- gate_e7_p1&#45;&gt;all2all_local_e7_p1 -->
<g id="edge366" class="edge">
<title>gate_e7_p1&#45;&gt;all2all_local_e7_p1</title>
<path fill="none" stroke="black" d="M1454.77,-488.88C1421.03,-476.48 1385.73,-463.51 1354.6,-452.06"/>
<polygon fill="black" stroke="black" points="1355.67,-448.73 1345.08,-448.56 1353.26,-455.3 1355.67,-448.73"/>
</g>
<!-- moe_e7_t0_e0_p1 -->
<g id="node275" class="node">
<title>moe_e7_t0_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="638.5,-255.52 393.5,-255.52 393.5,-203.52 638.5,-203.52 638.5,-255.52"/>
<text text-anchor="middle" x="516" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="516" y="-232.52" font-family="Arial" font-size="10.00">GPU: 60</text>
<text text-anchor="middle" x="516" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="516" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t0_e0_p1 -->
<g id="edge532" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t0_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1371.66,-529.79C1171.96,-518.05 895.12,-494.83 794,-453.06 688.83,-409.62 591.19,-313.62 544.61,-263.08"/>
<polygon fill="black" stroke="black" points="547.18,-260.7 537.85,-255.67 542,-265.42 547.18,-260.7"/>
</g>
<!-- moe_e7_t0_e1_p1 -->
<g id="node276" class="node">
<title>moe_e7_t0_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="901.5,-255.52 656.5,-255.52 656.5,-203.52 901.5,-203.52 901.5,-255.52"/>
<text text-anchor="middle" x="779" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="779" y="-232.52" font-family="Arial" font-size="10.00">GPU: 60</text>
<text text-anchor="middle" x="779" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="779" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t0_e1_p1 -->
<g id="edge534" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t0_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1355.4,-513.88C1257.83,-500.2 1144.5,-480.45 1044,-453.06 915.87,-418.14 840.74,-453.3 766,-343.52 750.47,-320.71 755.77,-289.13 763.78,-265.15"/>
<polygon fill="black" stroke="black" points="767.09,-266.31 767.2,-255.72 760.51,-263.93 767.09,-266.31"/>
</g>
<!-- moe_e7_t1_e0_p1 -->
<g id="node279" class="node">
<title>moe_e7_t1_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="1164.5,-255.52 919.5,-255.52 919.5,-203.52 1164.5,-203.52 1164.5,-255.52"/>
<text text-anchor="middle" x="1042" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="1042" y="-232.52" font-family="Arial" font-size="10.00">GPU: 61</text>
<text text-anchor="middle" x="1042" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1042" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t1_e0_p1 -->
<g id="edge536" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t1_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1371.06,-528.89C1249.39,-517.91 1115.28,-496.14 1074,-453.06 1023.95,-400.83 1065.43,-362.96 1054,-291.52 1052.65,-283.11 1051,-274.09 1049.35,-265.63"/>
<polygon fill="black" stroke="black" points="1052.75,-264.8 1047.37,-255.68 1045.89,-266.17 1052.75,-264.8"/>
</g>
<!-- moe_e7_t1_e1_p1 -->
<g id="node280" class="node">
<title>moe_e7_t1_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="1427.5,-255.52 1182.5,-255.52 1182.5,-203.52 1427.5,-203.52 1427.5,-255.52"/>
<text text-anchor="middle" x="1305" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="1305" y="-232.52" font-family="Arial" font-size="10.00">GPU: 61</text>
<text text-anchor="middle" x="1305" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1305" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t1_e1_p1 -->
<g id="edge538" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t1_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1549.05,-488.67C1515.99,-449.91 1470.77,-394.82 1435,-343.52 1419.61,-321.45 1422.89,-310.69 1404,-291.52 1392.56,-279.91 1378.49,-269.56 1364.58,-260.82"/>
<polygon fill="black" stroke="black" points="1366.33,-257.79 1355.97,-255.59 1362.7,-263.77 1366.33,-257.79"/>
</g>
<!-- moe_e7_t2_e0_p1 -->
<g id="node283" class="node">
<title>moe_e7_t2_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="1690.5,-255.52 1445.5,-255.52 1445.5,-203.52 1690.5,-203.52 1690.5,-255.52"/>
<text text-anchor="middle" x="1568" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="1568" y="-232.52" font-family="Arial" font-size="10.00">GPU: 62</text>
<text text-anchor="middle" x="1568" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1568" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t2_e0_p1 -->
<g id="edge540" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t2_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1652.8,-489.03C1705.07,-437.33 1766.92,-356.01 1723,-291.52 1714.25,-278.68 1702.35,-268.54 1689,-260.54"/>
<polygon fill="black" stroke="black" points="1690.48,-257.36 1680.04,-255.58 1687.09,-263.48 1690.48,-257.36"/>
</g>
<!-- moe_e7_t2_e1_p1 -->
<g id="node284" class="node">
<title>moe_e7_t2_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="1953.5,-255.52 1708.5,-255.52 1708.5,-203.52 1953.5,-203.52 1953.5,-255.52"/>
<text text-anchor="middle" x="1831" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="1831" y="-232.52" font-family="Arial" font-size="10.00">GPU: 62</text>
<text text-anchor="middle" x="1831" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1831" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t2_e1_p1 -->
<g id="edge542" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t2_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1675.65,-489.02C1689.45,-478.2 1702.89,-466.08 1714,-453.06 1766.28,-391.82 1757.73,-362.36 1796,-291.52 1800.78,-282.67 1806.11,-273.2 1811.14,-264.42"/>
<polygon fill="black" stroke="black" points="1814.27,-266 1816.23,-255.59 1808.21,-262.5 1814.27,-266"/>
</g>
<!-- moe_e7_t3_e0_p1 -->
<g id="node287" class="node">
<title>moe_e7_t3_e0_p1</title>
<polygon fill="lightyellow" stroke="black" points="2216.5,-255.52 1971.5,-255.52 1971.5,-203.52 2216.5,-203.52 2216.5,-255.52"/>
<text text-anchor="middle" x="2094" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 0</text>
<text text-anchor="middle" x="2094" y="-232.52" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="2094" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2094" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t3_e0_p1 -->
<g id="edge544" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t3_e0_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1777.05,-514.69C1884.08,-489.78 2011.93,-440.56 2084,-343.52 2100.37,-321.49 2101.88,-289.95 2099.85,-265.79"/>
<polygon fill="black" stroke="black" points="2103.31,-265.17 2098.76,-255.6 2096.35,-265.92 2103.31,-265.17"/>
</g>
<!-- moe_e7_t3_e1_p1 -->
<g id="node288" class="node">
<title>moe_e7_t3_e1_p1</title>
<polygon fill="lightyellow" stroke="black" points="2479.5,-255.52 2234.5,-255.52 2234.5,-203.52 2479.5,-203.52 2479.5,-255.52"/>
<text text-anchor="middle" x="2357" y="-243.52" font-family="Arial" font-size="10.00">MoE Expert 1</text>
<text text-anchor="middle" x="2357" y="-232.52" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="2357" y="-221.52" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2357" y="-210.52" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2560, hidden=256]</text>
</g>
<!-- gate_e7_p1&#45;&gt;moe_e7_t3_e1_p1 -->
<g id="edge546" class="edge">
<title>gate_e7_p1&#45;&gt;moe_e7_t3_e1_p1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1777.89,-515.69C1850.67,-502.36 1933.97,-482.38 2006,-453.06 2128.48,-403.2 2255.48,-310.68 2317.76,-262.13"/>
<polygon fill="black" stroke="black" points="2320.05,-264.79 2325.75,-255.86 2315.73,-259.28 2320.05,-264.79"/>
</g>
<!-- attention_e7_t0_p1 -->
<g id="node274" class="node">
<title>attention_e7_t0_p1</title>
<polygon fill="lightyellow" stroke="black" points="1045,-343.52 775,-343.52 775,-291.52 1045,-291.52 1045,-343.52"/>
<text text-anchor="middle" x="910" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="910" y="-320.52" font-family="Arial" font-size="10.00">GPU: 60</text>
<text text-anchor="middle" x="910" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="910" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p1&#45;&gt;attention_e7_t0_p1 -->
<g id="edge367" class="edge">
<title>all2all_local_e7_p1&#45;&gt;attention_e7_t0_p1</title>
<path fill="none" stroke="black" d="M1155.94,-386.52C1109.94,-373.8 1056.08,-358.91 1010.5,-346.31"/>
<polygon fill="black" stroke="black" points="1011.18,-342.87 1000.61,-343.57 1009.32,-349.61 1011.18,-342.87"/>
</g>
<!-- attention_e7_t1_p1 -->
<g id="node278" class="node">
<title>attention_e7_t1_p1</title>
<polygon fill="lightyellow" stroke="black" points="1395,-343.52 1125,-343.52 1125,-291.52 1395,-291.52 1395,-343.52"/>
<text text-anchor="middle" x="1260" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1260" y="-320.52" font-family="Arial" font-size="10.00">GPU: 61</text>
<text text-anchor="middle" x="1260" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1260" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p1&#45;&gt;attention_e7_t1_p1 -->
<g id="edge372" class="edge">
<title>all2all_local_e7_p1&#45;&gt;attention_e7_t1_p1</title>
<path fill="none" stroke="black" d="M1260,-379.26C1260,-370.95 1260,-362.11 1260,-353.83"/>
<polygon fill="black" stroke="black" points="1263.5,-353.72 1260,-343.72 1256.5,-353.72 1263.5,-353.72"/>
</g>
<!-- attention_e7_t2_p1 -->
<g id="node282" class="node">
<title>attention_e7_t2_p1</title>
<polygon fill="lightyellow" stroke="black" points="1714,-343.52 1444,-343.52 1444,-291.52 1714,-291.52 1714,-343.52"/>
<text text-anchor="middle" x="1579" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1579" y="-320.52" font-family="Arial" font-size="10.00">GPU: 62</text>
<text text-anchor="middle" x="1579" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1579" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p1&#45;&gt;attention_e7_t2_p1 -->
<g id="edge377" class="edge">
<title>all2all_local_e7_p1&#45;&gt;attention_e7_t2_p1</title>
<path fill="none" stroke="black" d="M1357.88,-385.6C1398.91,-373.15 1446.37,-358.75 1486.78,-346.5"/>
<polygon fill="black" stroke="black" points="1487.8,-349.84 1496.36,-343.59 1485.77,-343.15 1487.8,-349.84"/>
</g>
<!-- attention_e7_t3_p1 -->
<g id="node286" class="node">
<title>attention_e7_t3_p1</title>
<polygon fill="lightyellow" stroke="black" points="2075,-343.52 1805,-343.52 1805,-291.52 2075,-291.52 2075,-343.52"/>
<text text-anchor="middle" x="1940" y="-331.52" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1940" y="-320.52" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="1940" y="-309.52" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
<text text-anchor="middle" x="1940" y="-298.52" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, heads=4, d_k=32]</text>
</g>
<!-- all2all_local_e7_p1&#45;&gt;attention_e7_t3_p1 -->
<g id="edge382" class="edge">
<title>all2all_local_e7_p1&#45;&gt;attention_e7_t3_p1</title>
<path fill="none" stroke="black" d="M1403.79,-394.83C1518.83,-378.46 1679.42,-355.6 1794.82,-339.18"/>
<polygon fill="black" stroke="black" points="1795.39,-342.64 1804.8,-337.76 1794.4,-335.71 1795.39,-342.64"/>
</g>
<!-- attention_e7_t0_p1&#45;&gt;moe_e7_t0_e0_p1 -->
<g id="edge368" class="edge">
<title>attention_e7_t0_p1&#45;&gt;moe_e7_t0_e0_p1</title>
<path fill="none" stroke="black" d="M795.24,-291.47C746.69,-280.87 690,-268.5 640.44,-257.68"/>
<polygon fill="black" stroke="black" points="641.15,-254.26 630.63,-255.54 639.65,-261.09 641.15,-254.26"/>
</g>
<!-- attention_e7_t0_p1&#45;&gt;moe_e7_t0_e1_p1 -->
<g id="edge369" class="edge">
<title>attention_e7_t0_p1&#45;&gt;moe_e7_t0_e1_p1</title>
<path fill="none" stroke="black" d="M871.76,-291.42C857.49,-282.05 841.12,-271.3 826.15,-261.47"/>
<polygon fill="black" stroke="black" points="827.8,-258.37 817.52,-255.81 823.96,-264.22 827.8,-258.37"/>
</g>
<!-- tensor_reduce_e7_t0_p1 -->
<g id="node277" class="node">
<title>tensor_reduce_e7_t0_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="779" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="779" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="779" y="-133.75" font-family="Arial" font-size="10.00">GPU: 60</text>
<text text-anchor="middle" x="779" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="779" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t0_e0_p1&#45;&gt;tensor_reduce_e7_t0_p1 -->
<g id="edge370" class="edge">
<title>moe_e7_t0_e0_p1&#45;&gt;tensor_reduce_e7_t0_p1</title>
<path fill="none" stroke="black" d="M584.07,-203.48C614.69,-192.21 651.33,-178.73 684.54,-166.51"/>
<polygon fill="black" stroke="black" points="686.09,-169.67 694.27,-162.93 683.68,-163.1 686.09,-169.67"/>
</g>
<!-- moe_e7_t0_e1_p1&#45;&gt;tensor_reduce_e7_t0_p1 -->
<g id="edge371" class="edge">
<title>moe_e7_t0_e1_p1&#45;&gt;tensor_reduce_e7_t0_p1</title>
<path fill="none" stroke="black" d="M779,-203.35C779,-195.54 779,-186.68 779,-177.91"/>
<polygon fill="black" stroke="black" points="782.5,-177.73 779,-167.73 775.5,-177.73 782.5,-177.73"/>
</g>
<!-- tensor_reduce_e7_t0_p1&#45;&gt;output -->
<g id="edge415" class="edge">
<title>tensor_reduce_e7_t0_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M907.55,-105.94C971.98,-95.15 1051.35,-83.57 1123,-77.98 1505.98,-48.13 7408.67,-33.2 8611.87,-30.46"/>
<polygon fill="black" stroke="black" points="8611.93,-33.96 8621.92,-30.43 8611.91,-26.96 8611.93,-33.96"/>
</g>
<!-- attention_e7_t1_p1&#45;&gt;moe_e7_t1_e0_p1 -->
<g id="edge373" class="edge">
<title>attention_e7_t1_p1&#45;&gt;moe_e7_t1_e0_p1</title>
<path fill="none" stroke="black" d="M1196.36,-291.42C1170.95,-281.39 1141.54,-269.79 1115.25,-259.42"/>
<polygon fill="black" stroke="black" points="1116.31,-256.07 1105.72,-255.66 1113.74,-262.58 1116.31,-256.07"/>
</g>
<!-- attention_e7_t1_p1&#45;&gt;moe_e7_t1_e1_p1 -->
<g id="edge374" class="edge">
<title>attention_e7_t1_p1&#45;&gt;moe_e7_t1_e1_p1</title>
<path fill="none" stroke="black" d="M1273.26,-291.18C1277.61,-282.87 1282.51,-273.5 1287.14,-264.65"/>
<polygon fill="black" stroke="black" points="1290.3,-266.16 1291.84,-255.68 1284.1,-262.92 1290.3,-266.16"/>
</g>
<!-- tensor_reduce_e7_t1_p1 -->
<g id="node281" class="node">
<title>tensor_reduce_e7_t1_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="1305" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1305" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="1305" y="-133.75" font-family="Arial" font-size="10.00">GPU: 61</text>
<text text-anchor="middle" x="1305" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1305" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t1_e0_p1&#45;&gt;tensor_reduce_e7_t1_p1 -->
<g id="edge375" class="edge">
<title>moe_e7_t1_e0_p1&#45;&gt;tensor_reduce_e7_t1_p1</title>
<path fill="none" stroke="black" d="M1110.07,-203.48C1140.69,-192.21 1177.33,-178.73 1210.54,-166.51"/>
<polygon fill="black" stroke="black" points="1212.09,-169.67 1220.27,-162.93 1209.68,-163.1 1212.09,-169.67"/>
</g>
<!-- moe_e7_t1_e1_p1&#45;&gt;tensor_reduce_e7_t1_p1 -->
<g id="edge376" class="edge">
<title>moe_e7_t1_e1_p1&#45;&gt;tensor_reduce_e7_t1_p1</title>
<path fill="none" stroke="black" d="M1305,-203.35C1305,-195.54 1305,-186.68 1305,-177.91"/>
<polygon fill="black" stroke="black" points="1308.5,-177.73 1305,-167.73 1301.5,-177.73 1308.5,-177.73"/>
</g>
<!-- tensor_reduce_e7_t1_p1&#45;&gt;output -->
<g id="edge416" class="edge">
<title>tensor_reduce_e7_t1_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1433.55,-105.96C1497.98,-95.17 1577.35,-83.59 1649,-77.98 2004.32,-50.2 7459.4,-33.74 8612.1,-30.56"/>
<polygon fill="black" stroke="black" points="8612.16,-34.06 8622.15,-30.53 8612.14,-27.06 8612.16,-34.06"/>
</g>
<!-- attention_e7_t2_p1&#45;&gt;moe_e7_t2_e0_p1 -->
<g id="edge378" class="edge">
<title>attention_e7_t2_p1&#45;&gt;moe_e7_t2_e0_p1</title>
<path fill="none" stroke="black" d="M1575.76,-291.18C1574.74,-283.22 1573.6,-274.29 1572.51,-265.77"/>
<polygon fill="black" stroke="black" points="1575.96,-265.15 1571.22,-255.68 1569.01,-266.04 1575.96,-265.15"/>
</g>
<!-- attention_e7_t2_p1&#45;&gt;moe_e7_t2_e1_p1 -->
<g id="edge379" class="edge">
<title>attention_e7_t2_p1&#45;&gt;moe_e7_t2_e1_p1</title>
<path fill="none" stroke="black" d="M1652.57,-291.42C1682.32,-281.26 1716.83,-269.48 1747.52,-259.01"/>
<polygon fill="black" stroke="black" points="1749.01,-262.2 1757.34,-255.66 1746.75,-255.58 1749.01,-262.2"/>
</g>
<!-- tensor_reduce_e7_t2_p1 -->
<g id="node285" class="node">
<title>tensor_reduce_e7_t2_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="1831" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="1831" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="1831" y="-133.75" font-family="Arial" font-size="10.00">GPU: 62</text>
<text text-anchor="middle" x="1831" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="1831" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t2_e0_p1&#45;&gt;tensor_reduce_e7_t2_p1 -->
<g id="edge380" class="edge">
<title>moe_e7_t2_e0_p1&#45;&gt;tensor_reduce_e7_t2_p1</title>
<path fill="none" stroke="black" d="M1636.07,-203.48C1666.69,-192.21 1703.33,-178.73 1736.54,-166.51"/>
<polygon fill="black" stroke="black" points="1738.09,-169.67 1746.27,-162.93 1735.68,-163.1 1738.09,-169.67"/>
</g>
<!-- moe_e7_t2_e1_p1&#45;&gt;tensor_reduce_e7_t2_p1 -->
<g id="edge381" class="edge">
<title>moe_e7_t2_e1_p1&#45;&gt;tensor_reduce_e7_t2_p1</title>
<path fill="none" stroke="black" d="M1831,-203.35C1831,-195.54 1831,-186.68 1831,-177.91"/>
<polygon fill="black" stroke="black" points="1834.5,-177.73 1831,-167.73 1827.5,-177.73 1834.5,-177.73"/>
</g>
<!-- tensor_reduce_e7_t2_p1&#45;&gt;output -->
<g id="edge417" class="edge">
<title>tensor_reduce_e7_t2_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1950.55,-104.03C2003.69,-93.81 2067.19,-83.24 2125,-77.98 2454.96,-47.96 7505.76,-33.36 8611.97,-30.52"/>
<polygon fill="black" stroke="black" points="8612.02,-34.02 8622.01,-30.49 8612,-27.02 8612.02,-34.02"/>
</g>
<!-- attention_e7_t3_p1&#45;&gt;moe_e7_t3_e0_p1 -->
<g id="edge383" class="edge">
<title>attention_e7_t3_p1&#45;&gt;moe_e7_t3_e0_p1</title>
<path fill="none" stroke="black" d="M1984.96,-291.42C2002.12,-281.83 2021.86,-270.81 2039.8,-260.79"/>
<polygon fill="black" stroke="black" points="2041.96,-263.59 2048.99,-255.66 2038.55,-257.48 2041.96,-263.59"/>
</g>
<!-- attention_e7_t3_p1&#45;&gt;moe_e7_t3_e1_p1 -->
<g id="edge384" class="edge">
<title>attention_e7_t3_p1&#45;&gt;moe_e7_t3_e1_p1</title>
<path fill="none" stroke="black" d="M2061.45,-291.47C2112.95,-280.85 2173.09,-268.45 2225.62,-257.62"/>
<polygon fill="black" stroke="black" points="2226.59,-260.99 2235.68,-255.54 2225.18,-254.13 2226.59,-260.99"/>
</g>
<!-- tensor_reduce_e7_t3_p1 -->
<g id="node289" class="node">
<title>tensor_reduce_e7_t3_p1</title>
<ellipse fill="lightyellow" stroke="black" cx="2307" cy="-130.75" rx="173.48" ry="36.54"/>
<text text-anchor="middle" x="2307" y="-144.75" font-family="Arial" font-size="10.00">Tensor Reduction</text>
<text text-anchor="middle" x="2307" y="-133.75" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="2307" y="-122.75" font-family="Arial" font-size="10.00">Input: [batch_size=32, seq_len=2560, hidden=256]</text>
<text text-anchor="middle" x="2307" y="-111.75" font-family="Arial" font-size="10.00">Output: [batch_size=32, seq_len=2560, hidden=256]</text>
</g>
<!-- moe_e7_t3_e0_p1&#45;&gt;tensor_reduce_e7_t3_p1 -->
<g id="edge385" class="edge">
<title>moe_e7_t3_e0_p1&#45;&gt;tensor_reduce_e7_t3_p1</title>
<path fill="none" stroke="black" d="M2149.13,-203.48C2172.51,-192.85 2200.24,-180.25 2225.88,-168.6"/>
<polygon fill="black" stroke="black" points="2227.57,-171.68 2235.23,-164.36 2224.67,-165.31 2227.57,-171.68"/>
</g>
<!-- moe_e7_t3_e1_p1&#45;&gt;tensor_reduce_e7_t3_p1 -->
<g id="edge386" class="edge">
<title>moe_e7_t3_e1_p1&#45;&gt;tensor_reduce_e7_t3_p1</title>
<path fill="none" stroke="black" d="M2343.99,-203.35C2339.74,-195.12 2334.88,-185.71 2330.11,-176.48"/>
<polygon fill="black" stroke="black" points="2333.1,-174.64 2325.4,-167.36 2326.88,-177.85 2333.1,-174.64"/>
</g>
<!-- tensor_reduce_e7_t3_p1&#45;&gt;output -->
<g id="edge418" class="edge">
<title>tensor_reduce_e7_t3_p1&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2397.25,-99.33C2427.06,-90.68 2460.63,-82.41 2492,-77.98 2800.96,-34.37 7542.57,-30.37 8611.88,-30.02"/>
<polygon fill="black" stroke="black" points="8611.99,-33.52 8621.98,-30.02 8611.98,-26.52 8611.99,-33.52"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e0_p0 -->
<g id="edge2" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e0_p0</title>
<path fill="none" stroke="black" d="M8732.26,-1486.92C9691.05,-1486.41 14171.9,-1481.96 14789,-1443.22 15053.23,-1426.63 15356.72,-1386.89 15548.14,-1359.26"/>
<polygon fill="black" stroke="black" points="15548.91,-1362.68 15558.31,-1357.79 15547.91,-1355.76 15548.91,-1362.68"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e1_p0 -->
<g id="edge3" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e1_p0</title>
<path fill="none" stroke="black" d="M8732.2,-1486.22C9475.34,-1482.91 12281.64,-1468.82 12678,-1443.22 12942.2,-1426.15 13245.7,-1386.53 13437.13,-1359.06"/>
<polygon fill="black" stroke="black" points="13437.9,-1362.48 13447.3,-1357.59 13436.9,-1355.55 13437.9,-1362.48"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e2_p0 -->
<g id="edge4" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e2_p0</title>
<path fill="none" stroke="black" d="M8732.14,-1485.31C9157.18,-1480.99 10213.37,-1468.03 10567,-1443.22 10830.69,-1424.71 11133.69,-1385.54 11325.2,-1358.55"/>
<polygon fill="black" stroke="black" points="11325.96,-1361.98 11335.37,-1357.12 11324.98,-1355.05 11325.96,-1361.98"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e3_p0 -->
<g id="edge5" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e3_p0</title>
<path fill="none" stroke="black" d="M8683.57,-1462.84C8827.12,-1436.48 9058.06,-1394.09 9220.1,-1364.34"/>
<polygon fill="black" stroke="black" points="9220.98,-1367.74 9230.19,-1362.49 9219.72,-1360.85 9220.98,-1367.74"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e4_p0 -->
<g id="edge6" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e4_p0</title>
<path fill="none" stroke="black" d="M8411.23,-1464.94C8256.55,-1440.72 8004.66,-1401.27 7813.32,-1371.3"/>
<polygon fill="black" stroke="black" points="7813.82,-1367.84 7803.4,-1369.75 7812.74,-1374.75 7813.82,-1367.84"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e5_p0 -->
<g id="edge7" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e5_p0</title>
<path fill="none" stroke="black" d="M8371.6,-1485.89C7917.77,-1482.74 6737,-1471.96 6345,-1443.22 6133.75,-1427.73 5895.72,-1396.7 5719.32,-1371.07"/>
<polygon fill="black" stroke="black" points="5719.78,-1367.6 5709.38,-1369.62 5718.77,-1374.53 5719.78,-1367.6"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e6_p0 -->
<g id="edge8" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e6_p0</title>
<path fill="none" stroke="black" d="M8371.54,-1486.4C7606.39,-1483.73 4650.16,-1471.68 4234,-1443.22 4022.63,-1428.76 3784.58,-1397.71 3608.05,-1371.81"/>
<polygon fill="black" stroke="black" points="3608.5,-1368.34 3598.1,-1370.35 3607.49,-1375.27 3608.5,-1368.34"/>
</g>
<!-- all2all_global_p0&#45;&gt;gate_e7_p0 -->
<g id="edge9" class="edge">
<title>all2all_global_p0&#45;&gt;gate_e7_p0</title>
<path fill="none" stroke="black" d="M8371.43,-1487.03C7394.3,-1487.06 2760.12,-1485.02 2123,-1443.22 1905.91,-1428.97 1661.14,-1397.47 1480.95,-1371.33"/>
<polygon fill="black" stroke="black" points="1481.2,-1367.83 1470.8,-1369.86 1480.2,-1374.76 1481.2,-1367.83"/>
</g>
<!-- all2all_global_p1 -->
<g id="node291" class="node">
<title>all2all_global_p1</title>
<ellipse fill="lightblue" stroke="black" cx="8456" cy="-699.83" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="8456" y="-713.83" font-family="Arial" font-size="10.00">Global All&#45;to&#45;All</text>
<text text-anchor="middle" x="8456" y="-702.83" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="8456" y="-691.83" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10240, hidden=512]</text>
<text text-anchor="middle" x="8456" y="-680.83" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10240, hidden=512]</text>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e0_p1 -->
<g id="edge211" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e0_p1</title>
<path fill="none" stroke="black" d="M8636.38,-698.87C9637.74,-698.91 14491.99,-696.92 15158,-655.06 15420.45,-638.56 15721.82,-598.91 15912.27,-571.26"/>
<polygon fill="black" stroke="black" points="15913,-574.69 15922.39,-569.79 15911.99,-567.76 15913,-574.69"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e1_p1 -->
<g id="edge212" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e1_p1</title>
<path fill="none" stroke="black" d="M8636.37,-698.28C9431.3,-695.7 12602.3,-683.68 13047,-655.06 13309.43,-638.17 13610.8,-598.61 13801.26,-571.09"/>
<polygon fill="black" stroke="black" points="13801.98,-574.52 13811.38,-569.62 13800.98,-567.59 13801.98,-574.52"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e2_p1 -->
<g id="edge213" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e2_p1</title>
<path fill="none" stroke="black" d="M8636.41,-698.01C9128.81,-695.39 10488.79,-685.53 10936,-655.06 11199.93,-637.08 11503.18,-597.73 11694.66,-570.57"/>
<polygon fill="black" stroke="black" points="11695.42,-573.99 11704.83,-569.12 11694.44,-567.06 11695.42,-573.99"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e3_p1 -->
<g id="edge214" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e3_p1</title>
<path fill="none" stroke="black" d="M8609.95,-680.58C8676.14,-672.73 8754.37,-663.45 8825,-655.06 9085.67,-624.1 9386.57,-588.3 9578.67,-565.43"/>
<polygon fill="black" stroke="black" points="9579.36,-568.88 9588.88,-564.22 9578.54,-561.92 9579.36,-568.88"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e4_p1 -->
<g id="edge215" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e4_p1</title>
<path fill="none" stroke="black" d="M8355.88,-669.16C8286.37,-648.56 8191.76,-620.52 8109.09,-596.02"/>
<polygon fill="black" stroke="black" points="8109.91,-592.62 8099.33,-593.13 8107.92,-599.33 8109.91,-592.62"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e5_p1 -->
<g id="edge216" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e5_p1</title>
<path fill="none" stroke="black" d="M8276.07,-696.57C7894.18,-691.41 7013.14,-677.44 6714,-655.06 6496.27,-638.77 6250.52,-607.25 6070.11,-581.62"/>
<polygon fill="black" stroke="black" points="6070.35,-578.12 6059.95,-580.18 6069.36,-585.05 6070.35,-578.12"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e6_p1 -->
<g id="edge217" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e6_p1</title>
<path fill="none" stroke="black" d="M8275.8,-697.98C7564.26,-694.46 4970.97,-680.04 4603,-655.06 4385.75,-640.31 4140.74,-608.8 3960.49,-582.79"/>
<polygon fill="black" stroke="black" points="3960.74,-579.29 3950.34,-581.32 3959.73,-586.22 3960.74,-579.29"/>
</g>
<!-- all2all_global_p1&#45;&gt;gate_e7_p1 -->
<g id="edge218" class="edge">
<title>all2all_global_p1&#45;&gt;gate_e7_p1</title>
<path fill="none" stroke="black" d="M8275.64,-698.78C7342.18,-698.32 3080.26,-694.1 2492,-655.06 2277.34,-640.82 2035.44,-609.49 1856.83,-583.42"/>
<polygon fill="black" stroke="black" points="1857.17,-579.94 1846.77,-581.95 1856.15,-586.86 1857.17,-579.94"/>
</g>
<!-- pipeline_transfer&#45;&gt;all2all_global_p1 -->
<g id="edge210" class="edge">
<title>pipeline_transfer&#45;&gt;all2all_global_p1</title>
<path fill="none" stroke="black" d="M8456,-772.56C8456,-764.39 8456,-755.6 8456,-747.07"/>
<polygon fill="black" stroke="black" points="8459.5,-746.85 8456,-736.85 8452.5,-746.85 8459.5,-746.85"/>
</g>
</g>
</svg>
