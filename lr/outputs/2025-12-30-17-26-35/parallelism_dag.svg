<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="15000pt" height="571pt"
 viewBox="0.00 0.00 3600.00 137.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.28 0.28) rotate(0) translate(4 2037.84)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2037.84 53620,-2037.84 53620,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="lightgray" stroke="black" d="M20,-1653.86C20,-1653.86 53596,-1653.86 53596,-1653.86 53602,-1653.86 53608,-1659.86 53608,-1665.86 53608,-1665.86 53608,-1955.86 53608,-1955.86 53608,-1961.86 53602,-1967.86 53596,-1967.86 53596,-1967.86 20,-1967.86 20,-1967.86 14,-1967.86 8,-1961.86 8,-1955.86 8,-1955.86 8,-1665.86 8,-1665.86 8,-1659.86 14,-1653.86 20,-1653.86"/>
<text text-anchor="middle" x="26808" y="-1952.66" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (GPUs 0&#45;31)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage0_tp0</title>
<path fill="white" stroke="black" d="M28,-1661.86C28,-1661.86 13394,-1661.86 13394,-1661.86 13400,-1661.86 13406,-1667.86 13406,-1673.86 13406,-1673.86 13406,-1924.86 13406,-1924.86 13406,-1930.86 13400,-1936.86 13394,-1936.86 13394,-1936.86 28,-1936.86 28,-1936.86 22,-1936.86 16,-1930.86 16,-1924.86 16,-1924.86 16,-1673.86 16,-1673.86 16,-1667.86 22,-1661.86 28,-1661.86"/>
<text text-anchor="middle" x="6711" y="-1921.66" font-family="Times,serif" font-size="14.00">TP Group 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage0_tp1</title>
<path fill="white" stroke="black" d="M13426,-1661.86C13426,-1661.86 26792,-1661.86 26792,-1661.86 26798,-1661.86 26804,-1667.86 26804,-1673.86 26804,-1673.86 26804,-1924.86 26804,-1924.86 26804,-1930.86 26798,-1936.86 26792,-1936.86 26792,-1936.86 13426,-1936.86 13426,-1936.86 13420,-1936.86 13414,-1930.86 13414,-1924.86 13414,-1924.86 13414,-1673.86 13414,-1673.86 13414,-1667.86 13420,-1661.86 13426,-1661.86"/>
<text text-anchor="middle" x="20109" y="-1921.66" font-family="Times,serif" font-size="14.00">TP Group 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage0_tp2</title>
<path fill="white" stroke="black" d="M26824,-1661.86C26824,-1661.86 40190,-1661.86 40190,-1661.86 40196,-1661.86 40202,-1667.86 40202,-1673.86 40202,-1673.86 40202,-1924.86 40202,-1924.86 40202,-1930.86 40196,-1936.86 40190,-1936.86 40190,-1936.86 26824,-1936.86 26824,-1936.86 26818,-1936.86 26812,-1930.86 26812,-1924.86 26812,-1924.86 26812,-1673.86 26812,-1673.86 26812,-1667.86 26818,-1661.86 26824,-1661.86"/>
<text text-anchor="middle" x="33507" y="-1921.66" font-family="Times,serif" font-size="14.00">TP Group 2 (GPUs 16&#45;23)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage0_tp3</title>
<path fill="white" stroke="black" d="M40222,-1661.86C40222,-1661.86 53588,-1661.86 53588,-1661.86 53594,-1661.86 53600,-1667.86 53600,-1673.86 53600,-1673.86 53600,-1924.86 53600,-1924.86 53600,-1930.86 53594,-1936.86 53588,-1936.86 53588,-1936.86 40222,-1936.86 40222,-1936.86 40216,-1936.86 40210,-1930.86 40210,-1924.86 40210,-1924.86 40210,-1673.86 40210,-1673.86 40210,-1667.86 40216,-1661.86 40222,-1661.86"/>
<text text-anchor="middle" x="46905" y="-1921.66" font-family="Times,serif" font-size="14.00">TP Group 3 (GPUs 24&#45;31)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage1</title>
<path fill="lightgray" stroke="black" d="M20,-1159.9C20,-1159.9 53596,-1159.9 53596,-1159.9 53602,-1159.9 53608,-1165.9 53608,-1171.9 53608,-1171.9 53608,-1461.9 53608,-1461.9 53608,-1467.9 53602,-1473.9 53596,-1473.9 53596,-1473.9 20,-1473.9 20,-1473.9 14,-1473.9 8,-1467.9 8,-1461.9 8,-1461.9 8,-1171.9 8,-1171.9 8,-1165.9 14,-1159.9 20,-1159.9"/>
<text text-anchor="middle" x="26808" y="-1458.7" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 32&#45;63)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage1_tp0</title>
<path fill="white" stroke="black" d="M28,-1167.9C28,-1167.9 13394,-1167.9 13394,-1167.9 13400,-1167.9 13406,-1173.9 13406,-1179.9 13406,-1179.9 13406,-1430.9 13406,-1430.9 13406,-1436.9 13400,-1442.9 13394,-1442.9 13394,-1442.9 28,-1442.9 28,-1442.9 22,-1442.9 16,-1436.9 16,-1430.9 16,-1430.9 16,-1179.9 16,-1179.9 16,-1173.9 22,-1167.9 28,-1167.9"/>
<text text-anchor="middle" x="6711" y="-1427.7" font-family="Times,serif" font-size="14.00">TP Group 0 (GPUs 32&#45;39)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_stage1_tp1</title>
<path fill="white" stroke="black" d="M13426,-1167.9C13426,-1167.9 26792,-1167.9 26792,-1167.9 26798,-1167.9 26804,-1173.9 26804,-1179.9 26804,-1179.9 26804,-1430.9 26804,-1430.9 26804,-1436.9 26798,-1442.9 26792,-1442.9 26792,-1442.9 13426,-1442.9 13426,-1442.9 13420,-1442.9 13414,-1436.9 13414,-1430.9 13414,-1430.9 13414,-1179.9 13414,-1179.9 13414,-1173.9 13420,-1167.9 13426,-1167.9"/>
<text text-anchor="middle" x="20109" y="-1427.7" font-family="Times,serif" font-size="14.00">TP Group 1 (GPUs 40&#45;47)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_stage1_tp2</title>
<path fill="white" stroke="black" d="M26824,-1167.9C26824,-1167.9 40190,-1167.9 40190,-1167.9 40196,-1167.9 40202,-1173.9 40202,-1179.9 40202,-1179.9 40202,-1430.9 40202,-1430.9 40202,-1436.9 40196,-1442.9 40190,-1442.9 40190,-1442.9 26824,-1442.9 26824,-1442.9 26818,-1442.9 26812,-1436.9 26812,-1430.9 26812,-1430.9 26812,-1179.9 26812,-1179.9 26812,-1173.9 26818,-1167.9 26824,-1167.9"/>
<text text-anchor="middle" x="33507" y="-1427.7" font-family="Times,serif" font-size="14.00">TP Group 2 (GPUs 48&#45;55)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_stage1_tp3</title>
<path fill="white" stroke="black" d="M40222,-1167.9C40222,-1167.9 53588,-1167.9 53588,-1167.9 53594,-1167.9 53600,-1173.9 53600,-1179.9 53600,-1179.9 53600,-1430.9 53600,-1430.9 53600,-1436.9 53594,-1442.9 53588,-1442.9 53588,-1442.9 40222,-1442.9 40222,-1442.9 40216,-1442.9 40210,-1436.9 40210,-1430.9 40210,-1430.9 40210,-1179.9 40210,-1179.9 40210,-1173.9 40216,-1167.9 40222,-1167.9"/>
<text text-anchor="middle" x="46905" y="-1427.7" font-family="Times,serif" font-size="14.00">TP Group 3 (GPUs 56&#45;63)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_stage2</title>
<path fill="lightgray" stroke="black" d="M20,-665.93C20,-665.93 53596,-665.93 53596,-665.93 53602,-665.93 53608,-671.93 53608,-677.93 53608,-677.93 53608,-967.93 53608,-967.93 53608,-973.93 53602,-979.93 53596,-979.93 53596,-979.93 20,-979.93 20,-979.93 14,-979.93 8,-973.93 8,-967.93 8,-967.93 8,-677.93 8,-677.93 8,-671.93 14,-665.93 20,-665.93"/>
<text text-anchor="middle" x="26808" y="-964.73" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (GPUs 64&#45;95)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_stage2_tp0</title>
<path fill="white" stroke="black" d="M28,-673.93C28,-673.93 13394,-673.93 13394,-673.93 13400,-673.93 13406,-679.93 13406,-685.93 13406,-685.93 13406,-936.93 13406,-936.93 13406,-942.93 13400,-948.93 13394,-948.93 13394,-948.93 28,-948.93 28,-948.93 22,-948.93 16,-942.93 16,-936.93 16,-936.93 16,-685.93 16,-685.93 16,-679.93 22,-673.93 28,-673.93"/>
<text text-anchor="middle" x="6711" y="-933.73" font-family="Times,serif" font-size="14.00">TP Group 0 (GPUs 64&#45;71)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_stage2_tp1</title>
<path fill="white" stroke="black" d="M13426,-673.93C13426,-673.93 26792,-673.93 26792,-673.93 26798,-673.93 26804,-679.93 26804,-685.93 26804,-685.93 26804,-936.93 26804,-936.93 26804,-942.93 26798,-948.93 26792,-948.93 26792,-948.93 13426,-948.93 13426,-948.93 13420,-948.93 13414,-942.93 13414,-936.93 13414,-936.93 13414,-685.93 13414,-685.93 13414,-679.93 13420,-673.93 13426,-673.93"/>
<text text-anchor="middle" x="20109" y="-933.73" font-family="Times,serif" font-size="14.00">TP Group 1 (GPUs 72&#45;79)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_stage2_tp2</title>
<path fill="white" stroke="black" d="M26824,-673.93C26824,-673.93 40190,-673.93 40190,-673.93 40196,-673.93 40202,-679.93 40202,-685.93 40202,-685.93 40202,-936.93 40202,-936.93 40202,-942.93 40196,-948.93 40190,-948.93 40190,-948.93 26824,-948.93 26824,-948.93 26818,-948.93 26812,-942.93 26812,-936.93 26812,-936.93 26812,-685.93 26812,-685.93 26812,-679.93 26818,-673.93 26824,-673.93"/>
<text text-anchor="middle" x="33507" y="-933.73" font-family="Times,serif" font-size="14.00">TP Group 2 (GPUs 80&#45;87)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_stage2_tp3</title>
<path fill="white" stroke="black" d="M40222,-673.93C40222,-673.93 53588,-673.93 53588,-673.93 53594,-673.93 53600,-679.93 53600,-685.93 53600,-685.93 53600,-936.93 53600,-936.93 53600,-942.93 53594,-948.93 53588,-948.93 53588,-948.93 40222,-948.93 40222,-948.93 40216,-948.93 40210,-942.93 40210,-936.93 40210,-936.93 40210,-685.93 40210,-685.93 40210,-679.93 40216,-673.93 40222,-673.93"/>
<text text-anchor="middle" x="46905" y="-933.73" font-family="Times,serif" font-size="14.00">TP Group 3 (GPUs 88&#45;95)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_stage3</title>
<path fill="lightgray" stroke="black" d="M20,-171.97C20,-171.97 53596,-171.97 53596,-171.97 53602,-171.97 53608,-177.97 53608,-183.97 53608,-183.97 53608,-473.97 53608,-473.97 53608,-479.97 53602,-485.97 53596,-485.97 53596,-485.97 20,-485.97 20,-485.97 14,-485.97 8,-479.97 8,-473.97 8,-473.97 8,-183.97 8,-183.97 8,-177.97 14,-171.97 20,-171.97"/>
<text text-anchor="middle" x="26808" y="-470.77" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (GPUs 96&#45;127)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_stage3_tp0</title>
<path fill="white" stroke="black" d="M28,-179.97C28,-179.97 13394,-179.97 13394,-179.97 13400,-179.97 13406,-185.97 13406,-191.97 13406,-191.97 13406,-442.97 13406,-442.97 13406,-448.97 13400,-454.97 13394,-454.97 13394,-454.97 28,-454.97 28,-454.97 22,-454.97 16,-448.97 16,-442.97 16,-442.97 16,-191.97 16,-191.97 16,-185.97 22,-179.97 28,-179.97"/>
<text text-anchor="middle" x="6711" y="-439.77" font-family="Times,serif" font-size="14.00">TP Group 0 (GPUs 96&#45;103)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_stage3_tp1</title>
<path fill="white" stroke="black" d="M13426,-179.97C13426,-179.97 26792,-179.97 26792,-179.97 26798,-179.97 26804,-185.97 26804,-191.97 26804,-191.97 26804,-442.97 26804,-442.97 26804,-448.97 26798,-454.97 26792,-454.97 26792,-454.97 13426,-454.97 13426,-454.97 13420,-454.97 13414,-448.97 13414,-442.97 13414,-442.97 13414,-191.97 13414,-191.97 13414,-185.97 13420,-179.97 13426,-179.97"/>
<text text-anchor="middle" x="20109" y="-439.77" font-family="Times,serif" font-size="14.00">TP Group 1 (GPUs 104&#45;111)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_stage3_tp2</title>
<path fill="white" stroke="black" d="M26824,-179.97C26824,-179.97 40190,-179.97 40190,-179.97 40196,-179.97 40202,-185.97 40202,-191.97 40202,-191.97 40202,-442.97 40202,-442.97 40202,-448.97 40196,-454.97 40190,-454.97 40190,-454.97 26824,-454.97 26824,-454.97 26818,-454.97 26812,-448.97 26812,-442.97 26812,-442.97 26812,-191.97 26812,-191.97 26812,-185.97 26818,-179.97 26824,-179.97"/>
<text text-anchor="middle" x="33507" y="-439.77" font-family="Times,serif" font-size="14.00">TP Group 2 (GPUs 112&#45;119)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_stage3_tp3</title>
<path fill="white" stroke="black" d="M40222,-179.97C40222,-179.97 53588,-179.97 53588,-179.97 53594,-179.97 53600,-185.97 53600,-191.97 53600,-191.97 53600,-442.97 53600,-442.97 53600,-448.97 53594,-454.97 53588,-454.97 53588,-454.97 40222,-454.97 40222,-454.97 40216,-454.97 40210,-448.97 40210,-442.97 40210,-442.97 40210,-191.97 40210,-191.97 40210,-185.97 40216,-179.97 40222,-179.97"/>
<text text-anchor="middle" x="46905" y="-439.77" font-family="Times,serif" font-size="14.00">TP Group 3 (GPUs 120&#45;127)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-2004.85" rx="198.89" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-2013.35" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="1542" y="-2002.35" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-1991.35" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- attn_s0_t0_g0 -->
<g id="node2" class="node">
<title>attn_s0_t0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1679.5,-1905.86 1404.5,-1905.86 1404.5,-1864.86 1679.5,-1864.86 1679.5,-1905.86"/>
<text text-anchor="middle" x="1542" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;0</text>
<text text-anchor="middle" x="1542" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- input&#45;&gt;attn_s0_t0_g0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;attn_s0_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1975.71C1542,-1957.78 1542,-1934.57 1542,-1916.3"/>
<polygon fill="black" stroke="black" points="1545.5,-1916.19 1542,-1906.19 1538.5,-1916.19 1545.5,-1916.19"/>
</g>
<!-- gate_s0_t0_g0 -->
<g id="node3" class="node">
<title>gate_s0_t0_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="1807.32,-1828.86 1385.26,-1828.86 1276.68,-1746.86 1698.74,-1746.86 1807.32,-1828.86"/>
<text text-anchor="middle" x="1542" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;0</text>
<text text-anchor="middle" x="1542" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g0&#45;&gt;gate_s0_t0_g0 -->
<g id="edge2" class="edge">
<title>attn_s0_t0_g0&#45;&gt;gate_s0_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1864.57C1542,-1857.11 1542,-1848.24 1542,-1839.25"/>
<polygon fill="black" stroke="black" points="1545.5,-1839.11 1542,-1829.11 1538.5,-1839.11 1545.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g0_l0 -->
<g id="node4" class="node">
<title>expert_s0_t0_g0_l0</title>
<polygon fill="lightgreen" stroke="black" points="1671,-1710.86 1413,-1710.86 1413,-1669.86 1671,-1669.86 1671,-1710.86"/>
<text text-anchor="middle" x="1542" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;0 GPU&#45;0</text>
<text text-anchor="middle" x="1542" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g0&#45;&gt;expert_s0_t0_g0_l0 -->
<g id="edge3" class="edge">
<title>gate_s0_t0_g0&#45;&gt;expert_s0_t0_g0_l0</title>
<path fill="none" stroke="black" d="M1542,-1746.64C1542,-1738.06 1542,-1729.15 1542,-1721.05"/>
<polygon fill="black" stroke="black" points="1545.5,-1720.97 1542,-1710.97 1538.5,-1720.97 1545.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g0 -->
<g id="node258" class="node">
<title>comm_s0_t0_g0</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;0</text>
<text text-anchor="middle" x="1542" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g0_l0&#45;&gt;comm_s0_t0_g0 -->
<g id="edge4" class="edge">
<title>expert_s0_t0_g0_l0&#45;&gt;comm_s0_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1669.58C1542,-1661.95 1542,-1652.96 1542,-1644.17"/>
<polygon fill="black" stroke="black" points="1545.5,-1644.05 1542,-1634.05 1538.5,-1644.05 1545.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g0_l1 -->
<g id="node5" class="node">
<title>expert_s0_t0_g0_l1</title>
<polygon fill="lightgreen" stroke="black" points="13104,-1905.86 12846,-1905.86 12846,-1864.86 13104,-1864.86 13104,-1905.86"/>
<text text-anchor="middle" x="12975" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;1 GPU&#45;0</text>
<text text-anchor="middle" x="12975" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12975" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g0_l2 -->
<g id="node6" class="node">
<title>expert_s0_t0_g0_l2</title>
<polygon fill="lightgreen" stroke="black" points="12828,-1905.86 12570,-1905.86 12570,-1864.86 12828,-1864.86 12828,-1905.86"/>
<text text-anchor="middle" x="12699" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;2 GPU&#45;0</text>
<text text-anchor="middle" x="12699" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12699" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g0_l3 -->
<g id="node7" class="node">
<title>expert_s0_t0_g0_l3</title>
<polygon fill="lightgreen" stroke="black" points="12552,-1905.86 12294,-1905.86 12294,-1864.86 12552,-1864.86 12552,-1905.86"/>
<text text-anchor="middle" x="12423" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;3 GPU&#45;0</text>
<text text-anchor="middle" x="12423" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12423" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g0_l4 -->
<g id="node8" class="node">
<title>expert_s0_t0_g0_l4</title>
<polygon fill="lightgreen" stroke="black" points="12276,-1905.86 12018,-1905.86 12018,-1864.86 12276,-1864.86 12276,-1905.86"/>
<text text-anchor="middle" x="12147" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;4 GPU&#45;0</text>
<text text-anchor="middle" x="12147" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12147" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g0_l5 -->
<g id="node9" class="node">
<title>expert_s0_t0_g0_l5</title>
<polygon fill="lightgreen" stroke="black" points="12000,-1905.86 11742,-1905.86 11742,-1864.86 12000,-1864.86 12000,-1905.86"/>
<text text-anchor="middle" x="11871" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;0 Layer&#45;5 GPU&#45;0</text>
<text text-anchor="middle" x="11871" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11871" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g1 -->
<g id="node10" class="node">
<title>attn_s0_t0_g1</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-1905.86 3078.5,-1905.86 3078.5,-1864.86 3353.5,-1864.86 3353.5,-1905.86"/>
<text text-anchor="middle" x="3216" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;1</text>
<text text-anchor="middle" x="3216" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g1 -->
<g id="node11" class="node">
<title>gate_s0_t0_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="3481.32,-1828.86 3059.26,-1828.86 2950.68,-1746.86 3372.74,-1746.86 3481.32,-1828.86"/>
<text text-anchor="middle" x="3216" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;1</text>
<text text-anchor="middle" x="3216" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g1&#45;&gt;gate_s0_t0_g1 -->
<g id="edge5" class="edge">
<title>attn_s0_t0_g1&#45;&gt;gate_s0_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-1864.57C3216,-1857.11 3216,-1848.24 3216,-1839.25"/>
<polygon fill="black" stroke="black" points="3219.5,-1839.11 3216,-1829.11 3212.5,-1839.11 3219.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g1_l0 -->
<g id="node12" class="node">
<title>expert_s0_t0_g1_l0</title>
<polygon fill="lightgreen" stroke="black" points="3345,-1710.86 3087,-1710.86 3087,-1669.86 3345,-1669.86 3345,-1710.86"/>
<text text-anchor="middle" x="3216" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;0 GPU&#45;1</text>
<text text-anchor="middle" x="3216" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g1&#45;&gt;expert_s0_t0_g1_l0 -->
<g id="edge6" class="edge">
<title>gate_s0_t0_g1&#45;&gt;expert_s0_t0_g1_l0</title>
<path fill="none" stroke="black" d="M3216,-1746.64C3216,-1738.06 3216,-1729.15 3216,-1721.05"/>
<polygon fill="black" stroke="black" points="3219.5,-1720.97 3216,-1710.97 3212.5,-1720.97 3219.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g1 -->
<g id="node259" class="node">
<title>comm_s0_t0_g1</title>
<ellipse fill="lightblue" stroke="black" cx="3216" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="3216" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;1</text>
<text text-anchor="middle" x="3216" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g1_l0&#45;&gt;comm_s0_t0_g1 -->
<g id="edge7" class="edge">
<title>expert_s0_t0_g1_l0&#45;&gt;comm_s0_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-1669.58C3216,-1661.95 3216,-1652.96 3216,-1644.17"/>
<polygon fill="black" stroke="black" points="3219.5,-1644.05 3216,-1634.05 3212.5,-1644.05 3219.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g1_l1 -->
<g id="node13" class="node">
<title>expert_s0_t0_g1_l1</title>
<polygon fill="lightgreen" stroke="black" points="11430,-1905.86 11172,-1905.86 11172,-1864.86 11430,-1864.86 11430,-1905.86"/>
<text text-anchor="middle" x="11301" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;1 GPU&#45;1</text>
<text text-anchor="middle" x="11301" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11301" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g1_l2 -->
<g id="node14" class="node">
<title>expert_s0_t0_g1_l2</title>
<polygon fill="lightgreen" stroke="black" points="11154,-1905.86 10896,-1905.86 10896,-1864.86 11154,-1864.86 11154,-1905.86"/>
<text text-anchor="middle" x="11025" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;2 GPU&#45;1</text>
<text text-anchor="middle" x="11025" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11025" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g1_l3 -->
<g id="node15" class="node">
<title>expert_s0_t0_g1_l3</title>
<polygon fill="lightgreen" stroke="black" points="10878,-1905.86 10620,-1905.86 10620,-1864.86 10878,-1864.86 10878,-1905.86"/>
<text text-anchor="middle" x="10749" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;3 GPU&#45;1</text>
<text text-anchor="middle" x="10749" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10749" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g1_l4 -->
<g id="node16" class="node">
<title>expert_s0_t0_g1_l4</title>
<polygon fill="lightgreen" stroke="black" points="10602,-1905.86 10344,-1905.86 10344,-1864.86 10602,-1864.86 10602,-1905.86"/>
<text text-anchor="middle" x="10473" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;4 GPU&#45;1</text>
<text text-anchor="middle" x="10473" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10473" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g1_l5 -->
<g id="node17" class="node">
<title>expert_s0_t0_g1_l5</title>
<polygon fill="lightgreen" stroke="black" points="10326,-1905.86 10068,-1905.86 10068,-1864.86 10326,-1864.86 10326,-1905.86"/>
<text text-anchor="middle" x="10197" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;1 Layer&#45;5 GPU&#45;1</text>
<text text-anchor="middle" x="10197" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10197" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g2 -->
<g id="node18" class="node">
<title>attn_s0_t0_g2</title>
<polygon fill="lightgreen" stroke="black" points="5027.5,-1905.86 4752.5,-1905.86 4752.5,-1864.86 5027.5,-1864.86 5027.5,-1905.86"/>
<text text-anchor="middle" x="4890" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;2</text>
<text text-anchor="middle" x="4890" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g2 -->
<g id="node19" class="node">
<title>gate_s0_t0_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5155.32,-1828.86 4733.26,-1828.86 4624.68,-1746.86 5046.74,-1746.86 5155.32,-1828.86"/>
<text text-anchor="middle" x="4890" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;2</text>
<text text-anchor="middle" x="4890" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g2&#45;&gt;gate_s0_t0_g2 -->
<g id="edge8" class="edge">
<title>attn_s0_t0_g2&#45;&gt;gate_s0_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-1864.57C4890,-1857.11 4890,-1848.24 4890,-1839.25"/>
<polygon fill="black" stroke="black" points="4893.5,-1839.11 4890,-1829.11 4886.5,-1839.11 4893.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g2_l0 -->
<g id="node20" class="node">
<title>expert_s0_t0_g2_l0</title>
<polygon fill="lightgreen" stroke="black" points="5019,-1710.86 4761,-1710.86 4761,-1669.86 5019,-1669.86 5019,-1710.86"/>
<text text-anchor="middle" x="4890" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;0 GPU&#45;2</text>
<text text-anchor="middle" x="4890" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g2&#45;&gt;expert_s0_t0_g2_l0 -->
<g id="edge9" class="edge">
<title>gate_s0_t0_g2&#45;&gt;expert_s0_t0_g2_l0</title>
<path fill="none" stroke="black" d="M4890,-1746.64C4890,-1738.06 4890,-1729.15 4890,-1721.05"/>
<polygon fill="black" stroke="black" points="4893.5,-1720.97 4890,-1710.97 4886.5,-1720.97 4893.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g2 -->
<g id="node260" class="node">
<title>comm_s0_t0_g2</title>
<ellipse fill="lightblue" stroke="black" cx="4890" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="4890" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;2</text>
<text text-anchor="middle" x="4890" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g2_l0&#45;&gt;comm_s0_t0_g2 -->
<g id="edge10" class="edge">
<title>expert_s0_t0_g2_l0&#45;&gt;comm_s0_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-1669.58C4890,-1661.95 4890,-1652.96 4890,-1644.17"/>
<polygon fill="black" stroke="black" points="4893.5,-1644.05 4890,-1634.05 4886.5,-1644.05 4893.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g2_l1 -->
<g id="node21" class="node">
<title>expert_s0_t0_g2_l1</title>
<polygon fill="lightgreen" stroke="black" points="9756,-1905.86 9498,-1905.86 9498,-1864.86 9756,-1864.86 9756,-1905.86"/>
<text text-anchor="middle" x="9627" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;1 GPU&#45;2</text>
<text text-anchor="middle" x="9627" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9627" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g2_l2 -->
<g id="node22" class="node">
<title>expert_s0_t0_g2_l2</title>
<polygon fill="lightgreen" stroke="black" points="9480,-1905.86 9222,-1905.86 9222,-1864.86 9480,-1864.86 9480,-1905.86"/>
<text text-anchor="middle" x="9351" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;2 GPU&#45;2</text>
<text text-anchor="middle" x="9351" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9351" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g2_l3 -->
<g id="node23" class="node">
<title>expert_s0_t0_g2_l3</title>
<polygon fill="lightgreen" stroke="black" points="9204,-1905.86 8946,-1905.86 8946,-1864.86 9204,-1864.86 9204,-1905.86"/>
<text text-anchor="middle" x="9075" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;3 GPU&#45;2</text>
<text text-anchor="middle" x="9075" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9075" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g2_l4 -->
<g id="node24" class="node">
<title>expert_s0_t0_g2_l4</title>
<polygon fill="lightgreen" stroke="black" points="8928,-1905.86 8670,-1905.86 8670,-1864.86 8928,-1864.86 8928,-1905.86"/>
<text text-anchor="middle" x="8799" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;4 GPU&#45;2</text>
<text text-anchor="middle" x="8799" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8799" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g2_l5 -->
<g id="node25" class="node">
<title>expert_s0_t0_g2_l5</title>
<polygon fill="lightgreen" stroke="black" points="8652,-1905.86 8394,-1905.86 8394,-1864.86 8652,-1864.86 8652,-1905.86"/>
<text text-anchor="middle" x="8523" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;2 Layer&#45;5 GPU&#45;2</text>
<text text-anchor="middle" x="8523" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8523" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g3 -->
<g id="node26" class="node">
<title>attn_s0_t0_g3</title>
<polygon fill="lightgreen" stroke="black" points="6701.5,-1905.86 6426.5,-1905.86 6426.5,-1864.86 6701.5,-1864.86 6701.5,-1905.86"/>
<text text-anchor="middle" x="6564" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;3</text>
<text text-anchor="middle" x="6564" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g3 -->
<g id="node27" class="node">
<title>gate_s0_t0_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="6829.32,-1828.86 6407.26,-1828.86 6298.68,-1746.86 6720.74,-1746.86 6829.32,-1828.86"/>
<text text-anchor="middle" x="6564" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;3</text>
<text text-anchor="middle" x="6564" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g3&#45;&gt;gate_s0_t0_g3 -->
<g id="edge11" class="edge">
<title>attn_s0_t0_g3&#45;&gt;gate_s0_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-1864.57C6564,-1857.11 6564,-1848.24 6564,-1839.25"/>
<polygon fill="black" stroke="black" points="6567.5,-1839.11 6564,-1829.11 6560.5,-1839.11 6567.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g3_l0 -->
<g id="node28" class="node">
<title>expert_s0_t0_g3_l0</title>
<polygon fill="lightgreen" stroke="black" points="6693,-1710.86 6435,-1710.86 6435,-1669.86 6693,-1669.86 6693,-1710.86"/>
<text text-anchor="middle" x="6564" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;0 GPU&#45;3</text>
<text text-anchor="middle" x="6564" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g3&#45;&gt;expert_s0_t0_g3_l0 -->
<g id="edge12" class="edge">
<title>gate_s0_t0_g3&#45;&gt;expert_s0_t0_g3_l0</title>
<path fill="none" stroke="black" d="M6564,-1746.64C6564,-1738.06 6564,-1729.15 6564,-1721.05"/>
<polygon fill="black" stroke="black" points="6567.5,-1720.97 6564,-1710.97 6560.5,-1720.97 6567.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g3 -->
<g id="node261" class="node">
<title>comm_s0_t0_g3</title>
<ellipse fill="lightblue" stroke="black" cx="6564" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="6564" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;3</text>
<text text-anchor="middle" x="6564" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g3_l0&#45;&gt;comm_s0_t0_g3 -->
<g id="edge13" class="edge">
<title>expert_s0_t0_g3_l0&#45;&gt;comm_s0_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-1669.58C6564,-1661.95 6564,-1652.96 6564,-1644.17"/>
<polygon fill="black" stroke="black" points="6567.5,-1644.05 6564,-1634.05 6560.5,-1644.05 6567.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g3_l1 -->
<g id="node29" class="node">
<title>expert_s0_t0_g3_l1</title>
<polygon fill="lightgreen" stroke="black" points="8082,-1905.86 7824,-1905.86 7824,-1864.86 8082,-1864.86 8082,-1905.86"/>
<text text-anchor="middle" x="7953" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;1 GPU&#45;3</text>
<text text-anchor="middle" x="7953" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7953" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g3_l2 -->
<g id="node30" class="node">
<title>expert_s0_t0_g3_l2</title>
<polygon fill="lightgreen" stroke="black" points="7806,-1905.86 7548,-1905.86 7548,-1864.86 7806,-1864.86 7806,-1905.86"/>
<text text-anchor="middle" x="7677" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;2 GPU&#45;3</text>
<text text-anchor="middle" x="7677" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7677" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g3_l3 -->
<g id="node31" class="node">
<title>expert_s0_t0_g3_l3</title>
<polygon fill="lightgreen" stroke="black" points="7530,-1905.86 7272,-1905.86 7272,-1864.86 7530,-1864.86 7530,-1905.86"/>
<text text-anchor="middle" x="7401" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;3 GPU&#45;3</text>
<text text-anchor="middle" x="7401" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7401" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g3_l4 -->
<g id="node32" class="node">
<title>expert_s0_t0_g3_l4</title>
<polygon fill="lightgreen" stroke="black" points="7254,-1905.86 6996,-1905.86 6996,-1864.86 7254,-1864.86 7254,-1905.86"/>
<text text-anchor="middle" x="7125" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;4 GPU&#45;3</text>
<text text-anchor="middle" x="7125" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7125" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g3_l5 -->
<g id="node33" class="node">
<title>expert_s0_t0_g3_l5</title>
<polygon fill="lightgreen" stroke="black" points="6978,-1905.86 6720,-1905.86 6720,-1864.86 6978,-1864.86 6978,-1905.86"/>
<text text-anchor="middle" x="6849" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;3 Layer&#45;5 GPU&#45;3</text>
<text text-anchor="middle" x="6849" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6849" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g4 -->
<g id="node34" class="node">
<title>attn_s0_t0_g4</title>
<polygon fill="lightgreen" stroke="black" points="8375.5,-1905.86 8100.5,-1905.86 8100.5,-1864.86 8375.5,-1864.86 8375.5,-1905.86"/>
<text text-anchor="middle" x="8238" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;4</text>
<text text-anchor="middle" x="8238" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g4 -->
<g id="node35" class="node">
<title>gate_s0_t0_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="8503.32,-1828.86 8081.26,-1828.86 7972.68,-1746.86 8394.74,-1746.86 8503.32,-1828.86"/>
<text text-anchor="middle" x="8238" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;4</text>
<text text-anchor="middle" x="8238" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g4&#45;&gt;gate_s0_t0_g4 -->
<g id="edge14" class="edge">
<title>attn_s0_t0_g4&#45;&gt;gate_s0_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-1864.57C8238,-1857.11 8238,-1848.24 8238,-1839.25"/>
<polygon fill="black" stroke="black" points="8241.5,-1839.11 8238,-1829.11 8234.5,-1839.11 8241.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g4_l0 -->
<g id="node36" class="node">
<title>expert_s0_t0_g4_l0</title>
<polygon fill="lightgreen" stroke="black" points="8367,-1710.86 8109,-1710.86 8109,-1669.86 8367,-1669.86 8367,-1710.86"/>
<text text-anchor="middle" x="8238" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;0 GPU&#45;4</text>
<text text-anchor="middle" x="8238" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g4&#45;&gt;expert_s0_t0_g4_l0 -->
<g id="edge15" class="edge">
<title>gate_s0_t0_g4&#45;&gt;expert_s0_t0_g4_l0</title>
<path fill="none" stroke="black" d="M8238,-1746.64C8238,-1738.06 8238,-1729.15 8238,-1721.05"/>
<polygon fill="black" stroke="black" points="8241.5,-1720.97 8238,-1710.97 8234.5,-1720.97 8241.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g4 -->
<g id="node262" class="node">
<title>comm_s0_t0_g4</title>
<ellipse fill="lightblue" stroke="black" cx="8238" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8238" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;4</text>
<text text-anchor="middle" x="8238" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g4_l0&#45;&gt;comm_s0_t0_g4 -->
<g id="edge16" class="edge">
<title>expert_s0_t0_g4_l0&#45;&gt;comm_s0_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-1669.58C8238,-1661.95 8238,-1652.96 8238,-1644.17"/>
<polygon fill="black" stroke="black" points="8241.5,-1644.05 8238,-1634.05 8234.5,-1644.05 8241.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g4_l1 -->
<g id="node37" class="node">
<title>expert_s0_t0_g4_l1</title>
<polygon fill="lightgreen" stroke="black" points="6408,-1905.86 6150,-1905.86 6150,-1864.86 6408,-1864.86 6408,-1905.86"/>
<text text-anchor="middle" x="6279" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;1 GPU&#45;4</text>
<text text-anchor="middle" x="6279" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6279" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g4_l2 -->
<g id="node38" class="node">
<title>expert_s0_t0_g4_l2</title>
<polygon fill="lightgreen" stroke="black" points="6132,-1905.86 5874,-1905.86 5874,-1864.86 6132,-1864.86 6132,-1905.86"/>
<text text-anchor="middle" x="6003" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;2 GPU&#45;4</text>
<text text-anchor="middle" x="6003" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6003" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g4_l3 -->
<g id="node39" class="node">
<title>expert_s0_t0_g4_l3</title>
<polygon fill="lightgreen" stroke="black" points="5856,-1905.86 5598,-1905.86 5598,-1864.86 5856,-1864.86 5856,-1905.86"/>
<text text-anchor="middle" x="5727" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;3 GPU&#45;4</text>
<text text-anchor="middle" x="5727" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5727" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g4_l4 -->
<g id="node40" class="node">
<title>expert_s0_t0_g4_l4</title>
<polygon fill="lightgreen" stroke="black" points="5580,-1905.86 5322,-1905.86 5322,-1864.86 5580,-1864.86 5580,-1905.86"/>
<text text-anchor="middle" x="5451" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;4 GPU&#45;4</text>
<text text-anchor="middle" x="5451" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5451" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g4_l5 -->
<g id="node41" class="node">
<title>expert_s0_t0_g4_l5</title>
<polygon fill="lightgreen" stroke="black" points="5304,-1905.86 5046,-1905.86 5046,-1864.86 5304,-1864.86 5304,-1905.86"/>
<text text-anchor="middle" x="5175" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;4 Layer&#45;5 GPU&#45;4</text>
<text text-anchor="middle" x="5175" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5175" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g5 -->
<g id="node42" class="node">
<title>attn_s0_t0_g5</title>
<polygon fill="lightgreen" stroke="black" points="10049.5,-1905.86 9774.5,-1905.86 9774.5,-1864.86 10049.5,-1864.86 10049.5,-1905.86"/>
<text text-anchor="middle" x="9912" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;5</text>
<text text-anchor="middle" x="9912" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g5 -->
<g id="node43" class="node">
<title>gate_s0_t0_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="10177.32,-1828.86 9755.26,-1828.86 9646.68,-1746.86 10068.74,-1746.86 10177.32,-1828.86"/>
<text text-anchor="middle" x="9912" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;5</text>
<text text-anchor="middle" x="9912" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g5&#45;&gt;gate_s0_t0_g5 -->
<g id="edge17" class="edge">
<title>attn_s0_t0_g5&#45;&gt;gate_s0_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-1864.57C9912,-1857.11 9912,-1848.24 9912,-1839.25"/>
<polygon fill="black" stroke="black" points="9915.5,-1839.11 9912,-1829.11 9908.5,-1839.11 9915.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g5_l0 -->
<g id="node44" class="node">
<title>expert_s0_t0_g5_l0</title>
<polygon fill="lightgreen" stroke="black" points="10041,-1710.86 9783,-1710.86 9783,-1669.86 10041,-1669.86 10041,-1710.86"/>
<text text-anchor="middle" x="9912" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;0 GPU&#45;5</text>
<text text-anchor="middle" x="9912" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g5&#45;&gt;expert_s0_t0_g5_l0 -->
<g id="edge18" class="edge">
<title>gate_s0_t0_g5&#45;&gt;expert_s0_t0_g5_l0</title>
<path fill="none" stroke="black" d="M9912,-1746.64C9912,-1738.06 9912,-1729.15 9912,-1721.05"/>
<polygon fill="black" stroke="black" points="9915.5,-1720.97 9912,-1710.97 9908.5,-1720.97 9915.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g5 -->
<g id="node263" class="node">
<title>comm_s0_t0_g5</title>
<ellipse fill="lightblue" stroke="black" cx="9912" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9912" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;5</text>
<text text-anchor="middle" x="9912" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g5_l0&#45;&gt;comm_s0_t0_g5 -->
<g id="edge19" class="edge">
<title>expert_s0_t0_g5_l0&#45;&gt;comm_s0_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-1669.58C9912,-1661.95 9912,-1652.96 9912,-1644.17"/>
<polygon fill="black" stroke="black" points="9915.5,-1644.05 9912,-1634.05 9908.5,-1644.05 9915.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g5_l1 -->
<g id="node45" class="node">
<title>expert_s0_t0_g5_l1</title>
<polygon fill="lightgreen" stroke="black" points="4734,-1905.86 4476,-1905.86 4476,-1864.86 4734,-1864.86 4734,-1905.86"/>
<text text-anchor="middle" x="4605" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;1 GPU&#45;5</text>
<text text-anchor="middle" x="4605" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4605" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g5_l2 -->
<g id="node46" class="node">
<title>expert_s0_t0_g5_l2</title>
<polygon fill="lightgreen" stroke="black" points="4458,-1905.86 4200,-1905.86 4200,-1864.86 4458,-1864.86 4458,-1905.86"/>
<text text-anchor="middle" x="4329" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;2 GPU&#45;5</text>
<text text-anchor="middle" x="4329" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4329" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g5_l3 -->
<g id="node47" class="node">
<title>expert_s0_t0_g5_l3</title>
<polygon fill="lightgreen" stroke="black" points="4182,-1905.86 3924,-1905.86 3924,-1864.86 4182,-1864.86 4182,-1905.86"/>
<text text-anchor="middle" x="4053" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;3 GPU&#45;5</text>
<text text-anchor="middle" x="4053" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4053" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g5_l4 -->
<g id="node48" class="node">
<title>expert_s0_t0_g5_l4</title>
<polygon fill="lightgreen" stroke="black" points="3906,-1905.86 3648,-1905.86 3648,-1864.86 3906,-1864.86 3906,-1905.86"/>
<text text-anchor="middle" x="3777" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;4 GPU&#45;5</text>
<text text-anchor="middle" x="3777" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3777" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g5_l5 -->
<g id="node49" class="node">
<title>expert_s0_t0_g5_l5</title>
<polygon fill="lightgreen" stroke="black" points="3630,-1905.86 3372,-1905.86 3372,-1864.86 3630,-1864.86 3630,-1905.86"/>
<text text-anchor="middle" x="3501" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;5 Layer&#45;5 GPU&#45;5</text>
<text text-anchor="middle" x="3501" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3501" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g6 -->
<g id="node50" class="node">
<title>attn_s0_t0_g6</title>
<polygon fill="lightgreen" stroke="black" points="11723.5,-1905.86 11448.5,-1905.86 11448.5,-1864.86 11723.5,-1864.86 11723.5,-1905.86"/>
<text text-anchor="middle" x="11586" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;6</text>
<text text-anchor="middle" x="11586" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g6 -->
<g id="node51" class="node">
<title>gate_s0_t0_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11851.32,-1828.86 11429.26,-1828.86 11320.68,-1746.86 11742.74,-1746.86 11851.32,-1828.86"/>
<text text-anchor="middle" x="11586" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;6</text>
<text text-anchor="middle" x="11586" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g6&#45;&gt;gate_s0_t0_g6 -->
<g id="edge20" class="edge">
<title>attn_s0_t0_g6&#45;&gt;gate_s0_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-1864.57C11586,-1857.11 11586,-1848.24 11586,-1839.25"/>
<polygon fill="black" stroke="black" points="11589.5,-1839.11 11586,-1829.11 11582.5,-1839.11 11589.5,-1839.11"/>
</g>
<!-- expert_s0_t0_g6_l0 -->
<g id="node52" class="node">
<title>expert_s0_t0_g6_l0</title>
<polygon fill="lightgreen" stroke="black" points="11715,-1710.86 11457,-1710.86 11457,-1669.86 11715,-1669.86 11715,-1710.86"/>
<text text-anchor="middle" x="11586" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;0 GPU&#45;6</text>
<text text-anchor="middle" x="11586" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g6&#45;&gt;expert_s0_t0_g6_l0 -->
<g id="edge21" class="edge">
<title>gate_s0_t0_g6&#45;&gt;expert_s0_t0_g6_l0</title>
<path fill="none" stroke="black" d="M11586,-1746.64C11586,-1738.06 11586,-1729.15 11586,-1721.05"/>
<polygon fill="black" stroke="black" points="11589.5,-1720.97 11586,-1710.97 11582.5,-1720.97 11589.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g6 -->
<g id="node264" class="node">
<title>comm_s0_t0_g6</title>
<ellipse fill="lightblue" stroke="black" cx="11586" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="11586" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;6</text>
<text text-anchor="middle" x="11586" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g6_l0&#45;&gt;comm_s0_t0_g6 -->
<g id="edge22" class="edge">
<title>expert_s0_t0_g6_l0&#45;&gt;comm_s0_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-1669.58C11586,-1661.95 11586,-1652.96 11586,-1644.17"/>
<polygon fill="black" stroke="black" points="11589.5,-1644.05 11586,-1634.05 11582.5,-1644.05 11589.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g6_l1 -->
<g id="node53" class="node">
<title>expert_s0_t0_g6_l1</title>
<polygon fill="lightgreen" stroke="black" points="3060,-1905.86 2802,-1905.86 2802,-1864.86 3060,-1864.86 3060,-1905.86"/>
<text text-anchor="middle" x="2931" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;1 GPU&#45;6</text>
<text text-anchor="middle" x="2931" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2931" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g6_l2 -->
<g id="node54" class="node">
<title>expert_s0_t0_g6_l2</title>
<polygon fill="lightgreen" stroke="black" points="2784,-1905.86 2526,-1905.86 2526,-1864.86 2784,-1864.86 2784,-1905.86"/>
<text text-anchor="middle" x="2655" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;2 GPU&#45;6</text>
<text text-anchor="middle" x="2655" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2655" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g6_l3 -->
<g id="node55" class="node">
<title>expert_s0_t0_g6_l3</title>
<polygon fill="lightgreen" stroke="black" points="2508,-1905.86 2250,-1905.86 2250,-1864.86 2508,-1864.86 2508,-1905.86"/>
<text text-anchor="middle" x="2379" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;3 GPU&#45;6</text>
<text text-anchor="middle" x="2379" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2379" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g6_l4 -->
<g id="node56" class="node">
<title>expert_s0_t0_g6_l4</title>
<polygon fill="lightgreen" stroke="black" points="2232,-1905.86 1974,-1905.86 1974,-1864.86 2232,-1864.86 2232,-1905.86"/>
<text text-anchor="middle" x="2103" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;4 GPU&#45;6</text>
<text text-anchor="middle" x="2103" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2103" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g6_l5 -->
<g id="node57" class="node">
<title>expert_s0_t0_g6_l5</title>
<polygon fill="lightgreen" stroke="black" points="1956,-1905.86 1698,-1905.86 1698,-1864.86 1956,-1864.86 1956,-1905.86"/>
<text text-anchor="middle" x="1827" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;6 Layer&#45;5 GPU&#45;6</text>
<text text-anchor="middle" x="1827" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1827" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t0_g7 -->
<g id="node58" class="node">
<title>attn_s0_t0_g7</title>
<polygon fill="lightgreen" stroke="black" points="13397.5,-1905.86 13122.5,-1905.86 13122.5,-1864.86 13397.5,-1864.86 13397.5,-1905.86"/>
<text text-anchor="middle" x="13260" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;7</text>
<text text-anchor="middle" x="13260" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13260" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t0_g7 -->
<g id="node59" class="node">
<title>gate_s0_t0_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="13398.32,-1828.86 12976.26,-1828.86 12867.68,-1746.86 13289.74,-1746.86 13398.32,-1828.86"/>
<text text-anchor="middle" x="13133" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;7</text>
<text text-anchor="middle" x="13133" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t0_g7&#45;&gt;gate_s0_t0_g7 -->
<g id="edge23" class="edge">
<title>attn_s0_t0_g7&#45;&gt;gate_s0_t0_g7</title>
<path fill="none" stroke="black" d="M13233.99,-1864.81C13222.47,-1856.14 13208.37,-1845.54 13194.41,-1835.04"/>
<polygon fill="black" stroke="black" points="13196.33,-1832.1 13186.23,-1828.89 13192.12,-1837.7 13196.33,-1832.1"/>
</g>
<!-- expert_s0_t0_g7_l0 -->
<g id="node60" class="node">
<title>expert_s0_t0_g7_l0</title>
<polygon fill="lightgreen" stroke="black" points="13262,-1710.86 13004,-1710.86 13004,-1669.86 13262,-1669.86 13262,-1710.86"/>
<text text-anchor="middle" x="13133" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;0 GPU&#45;7</text>
<text text-anchor="middle" x="13133" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t0_g7&#45;&gt;expert_s0_t0_g7_l0 -->
<g id="edge24" class="edge">
<title>gate_s0_t0_g7&#45;&gt;expert_s0_t0_g7_l0</title>
<path fill="none" stroke="black" d="M13133,-1746.64C13133,-1738.06 13133,-1729.15 13133,-1721.05"/>
<polygon fill="black" stroke="black" points="13136.5,-1720.97 13133,-1710.97 13129.5,-1720.97 13136.5,-1720.97"/>
</g>
<!-- comm_s0_t0_g7 -->
<g id="node265" class="node">
<title>comm_s0_t0_g7</title>
<ellipse fill="lightblue" stroke="black" cx="13133" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="13133" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;7</text>
<text text-anchor="middle" x="13133" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13133" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t0_g7_l0&#45;&gt;comm_s0_t0_g7 -->
<g id="edge25" class="edge">
<title>expert_s0_t0_g7_l0&#45;&gt;comm_s0_t0_g7</title>
<path fill="none" stroke="black" d="M13133,-1669.58C13133,-1661.95 13133,-1652.96 13133,-1644.17"/>
<polygon fill="black" stroke="black" points="13136.5,-1644.05 13133,-1634.05 13129.5,-1644.05 13136.5,-1644.05"/>
</g>
<!-- expert_s0_t0_g7_l1 -->
<g id="node61" class="node">
<title>expert_s0_t0_g7_l1</title>
<polygon fill="lightgreen" stroke="black" points="1386,-1905.86 1128,-1905.86 1128,-1864.86 1386,-1864.86 1386,-1905.86"/>
<text text-anchor="middle" x="1257" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;1 GPU&#45;7</text>
<text text-anchor="middle" x="1257" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1257" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g7_l2 -->
<g id="node62" class="node">
<title>expert_s0_t0_g7_l2</title>
<polygon fill="lightgreen" stroke="black" points="1110,-1905.86 852,-1905.86 852,-1864.86 1110,-1864.86 1110,-1905.86"/>
<text text-anchor="middle" x="981" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;2 GPU&#45;7</text>
<text text-anchor="middle" x="981" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="981" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g7_l3 -->
<g id="node63" class="node">
<title>expert_s0_t0_g7_l3</title>
<polygon fill="lightgreen" stroke="black" points="834,-1905.86 576,-1905.86 576,-1864.86 834,-1864.86 834,-1905.86"/>
<text text-anchor="middle" x="705" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;3 GPU&#45;7</text>
<text text-anchor="middle" x="705" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="705" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g7_l4 -->
<g id="node64" class="node">
<title>expert_s0_t0_g7_l4</title>
<polygon fill="lightgreen" stroke="black" points="558,-1905.86 300,-1905.86 300,-1864.86 558,-1864.86 558,-1905.86"/>
<text text-anchor="middle" x="429" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;4 GPU&#45;7</text>
<text text-anchor="middle" x="429" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="429" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t0_g7_l5 -->
<g id="node65" class="node">
<title>expert_s0_t0_g7_l5</title>
<polygon fill="lightgreen" stroke="black" points="282,-1905.86 24,-1905.86 24,-1864.86 282,-1864.86 282,-1905.86"/>
<text text-anchor="middle" x="153" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;7 Layer&#45;5 GPU&#45;7</text>
<text text-anchor="middle" x="153" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="153" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g0 -->
<g id="node66" class="node">
<title>attn_s0_t1_g0</title>
<polygon fill="lightgreen" stroke="black" points="15077.5,-1905.86 14802.5,-1905.86 14802.5,-1864.86 15077.5,-1864.86 15077.5,-1905.86"/>
<text text-anchor="middle" x="14940" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;8</text>
<text text-anchor="middle" x="14940" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g0 -->
<g id="node67" class="node">
<title>gate_s0_t1_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="15205.32,-1828.86 14783.26,-1828.86 14674.68,-1746.86 15096.74,-1746.86 15205.32,-1828.86"/>
<text text-anchor="middle" x="14940" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;8</text>
<text text-anchor="middle" x="14940" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g0&#45;&gt;gate_s0_t1_g0 -->
<g id="edge26" class="edge">
<title>attn_s0_t1_g0&#45;&gt;gate_s0_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-1864.57C14940,-1857.11 14940,-1848.24 14940,-1839.25"/>
<polygon fill="black" stroke="black" points="14943.5,-1839.11 14940,-1829.11 14936.5,-1839.11 14943.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g0_l0 -->
<g id="node68" class="node">
<title>expert_s0_t1_g0_l0</title>
<polygon fill="lightgreen" stroke="black" points="15069,-1710.86 14811,-1710.86 14811,-1669.86 15069,-1669.86 15069,-1710.86"/>
<text text-anchor="middle" x="14940" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;0 GPU&#45;8</text>
<text text-anchor="middle" x="14940" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g0&#45;&gt;expert_s0_t1_g0_l0 -->
<g id="edge27" class="edge">
<title>gate_s0_t1_g0&#45;&gt;expert_s0_t1_g0_l0</title>
<path fill="none" stroke="black" d="M14940,-1746.64C14940,-1738.06 14940,-1729.15 14940,-1721.05"/>
<polygon fill="black" stroke="black" points="14943.5,-1720.97 14940,-1710.97 14936.5,-1720.97 14943.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g0 -->
<g id="node266" class="node">
<title>comm_s0_t1_g0</title>
<ellipse fill="lightblue" stroke="black" cx="14940" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="14940" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;8</text>
<text text-anchor="middle" x="14940" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g0_l0&#45;&gt;comm_s0_t1_g0 -->
<g id="edge28" class="edge">
<title>expert_s0_t1_g0_l0&#45;&gt;comm_s0_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-1669.58C14940,-1661.95 14940,-1652.96 14940,-1644.17"/>
<polygon fill="black" stroke="black" points="14943.5,-1644.05 14940,-1634.05 14936.5,-1644.05 14943.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g0_l1 -->
<g id="node69" class="node">
<title>expert_s0_t1_g0_l1</title>
<polygon fill="lightgreen" stroke="black" points="26502,-1905.86 26244,-1905.86 26244,-1864.86 26502,-1864.86 26502,-1905.86"/>
<text text-anchor="middle" x="26373" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;1 GPU&#45;8</text>
<text text-anchor="middle" x="26373" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26373" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g0_l2 -->
<g id="node70" class="node">
<title>expert_s0_t1_g0_l2</title>
<polygon fill="lightgreen" stroke="black" points="26226,-1905.86 25968,-1905.86 25968,-1864.86 26226,-1864.86 26226,-1905.86"/>
<text text-anchor="middle" x="26097" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;2 GPU&#45;8</text>
<text text-anchor="middle" x="26097" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26097" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g0_l3 -->
<g id="node71" class="node">
<title>expert_s0_t1_g0_l3</title>
<polygon fill="lightgreen" stroke="black" points="25950,-1905.86 25692,-1905.86 25692,-1864.86 25950,-1864.86 25950,-1905.86"/>
<text text-anchor="middle" x="25821" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;3 GPU&#45;8</text>
<text text-anchor="middle" x="25821" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25821" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g0_l4 -->
<g id="node72" class="node">
<title>expert_s0_t1_g0_l4</title>
<polygon fill="lightgreen" stroke="black" points="25674,-1905.86 25416,-1905.86 25416,-1864.86 25674,-1864.86 25674,-1905.86"/>
<text text-anchor="middle" x="25545" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;4 GPU&#45;8</text>
<text text-anchor="middle" x="25545" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25545" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g0_l5 -->
<g id="node73" class="node">
<title>expert_s0_t1_g0_l5</title>
<polygon fill="lightgreen" stroke="black" points="25398,-1905.86 25140,-1905.86 25140,-1864.86 25398,-1864.86 25398,-1905.86"/>
<text text-anchor="middle" x="25269" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;8 Layer&#45;5 GPU&#45;8</text>
<text text-anchor="middle" x="25269" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25269" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g1 -->
<g id="node74" class="node">
<title>attn_s0_t1_g1</title>
<polygon fill="lightgreen" stroke="black" points="16751.5,-1905.86 16476.5,-1905.86 16476.5,-1864.86 16751.5,-1864.86 16751.5,-1905.86"/>
<text text-anchor="middle" x="16614" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;9</text>
<text text-anchor="middle" x="16614" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g1 -->
<g id="node75" class="node">
<title>gate_s0_t1_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="16879.32,-1828.86 16457.26,-1828.86 16348.68,-1746.86 16770.74,-1746.86 16879.32,-1828.86"/>
<text text-anchor="middle" x="16614" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;9</text>
<text text-anchor="middle" x="16614" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g1&#45;&gt;gate_s0_t1_g1 -->
<g id="edge29" class="edge">
<title>attn_s0_t1_g1&#45;&gt;gate_s0_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-1864.57C16614,-1857.11 16614,-1848.24 16614,-1839.25"/>
<polygon fill="black" stroke="black" points="16617.5,-1839.11 16614,-1829.11 16610.5,-1839.11 16617.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g1_l0 -->
<g id="node76" class="node">
<title>expert_s0_t1_g1_l0</title>
<polygon fill="lightgreen" stroke="black" points="16743,-1710.86 16485,-1710.86 16485,-1669.86 16743,-1669.86 16743,-1710.86"/>
<text text-anchor="middle" x="16614" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;0 GPU&#45;9</text>
<text text-anchor="middle" x="16614" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g1&#45;&gt;expert_s0_t1_g1_l0 -->
<g id="edge30" class="edge">
<title>gate_s0_t1_g1&#45;&gt;expert_s0_t1_g1_l0</title>
<path fill="none" stroke="black" d="M16614,-1746.64C16614,-1738.06 16614,-1729.15 16614,-1721.05"/>
<polygon fill="black" stroke="black" points="16617.5,-1720.97 16614,-1710.97 16610.5,-1720.97 16617.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g1 -->
<g id="node267" class="node">
<title>comm_s0_t1_g1</title>
<ellipse fill="lightblue" stroke="black" cx="16614" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="16614" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;9</text>
<text text-anchor="middle" x="16614" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g1_l0&#45;&gt;comm_s0_t1_g1 -->
<g id="edge31" class="edge">
<title>expert_s0_t1_g1_l0&#45;&gt;comm_s0_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-1669.58C16614,-1661.95 16614,-1652.96 16614,-1644.17"/>
<polygon fill="black" stroke="black" points="16617.5,-1644.05 16614,-1634.05 16610.5,-1644.05 16617.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g1_l1 -->
<g id="node77" class="node">
<title>expert_s0_t1_g1_l1</title>
<polygon fill="lightgreen" stroke="black" points="24828,-1905.86 24570,-1905.86 24570,-1864.86 24828,-1864.86 24828,-1905.86"/>
<text text-anchor="middle" x="24699" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;1 GPU&#45;9</text>
<text text-anchor="middle" x="24699" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24699" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g1_l2 -->
<g id="node78" class="node">
<title>expert_s0_t1_g1_l2</title>
<polygon fill="lightgreen" stroke="black" points="24552,-1905.86 24294,-1905.86 24294,-1864.86 24552,-1864.86 24552,-1905.86"/>
<text text-anchor="middle" x="24423" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;2 GPU&#45;9</text>
<text text-anchor="middle" x="24423" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24423" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g1_l3 -->
<g id="node79" class="node">
<title>expert_s0_t1_g1_l3</title>
<polygon fill="lightgreen" stroke="black" points="24276,-1905.86 24018,-1905.86 24018,-1864.86 24276,-1864.86 24276,-1905.86"/>
<text text-anchor="middle" x="24147" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;3 GPU&#45;9</text>
<text text-anchor="middle" x="24147" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24147" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g1_l4 -->
<g id="node80" class="node">
<title>expert_s0_t1_g1_l4</title>
<polygon fill="lightgreen" stroke="black" points="24000,-1905.86 23742,-1905.86 23742,-1864.86 24000,-1864.86 24000,-1905.86"/>
<text text-anchor="middle" x="23871" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;4 GPU&#45;9</text>
<text text-anchor="middle" x="23871" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23871" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g1_l5 -->
<g id="node81" class="node">
<title>expert_s0_t1_g1_l5</title>
<polygon fill="lightgreen" stroke="black" points="23724,-1905.86 23466,-1905.86 23466,-1864.86 23724,-1864.86 23724,-1905.86"/>
<text text-anchor="middle" x="23595" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;9 Layer&#45;5 GPU&#45;9</text>
<text text-anchor="middle" x="23595" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23595" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g2 -->
<g id="node82" class="node">
<title>attn_s0_t1_g2</title>
<polygon fill="lightgreen" stroke="black" points="18425.5,-1905.86 18150.5,-1905.86 18150.5,-1864.86 18425.5,-1864.86 18425.5,-1905.86"/>
<text text-anchor="middle" x="18288" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;10</text>
<text text-anchor="middle" x="18288" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g2 -->
<g id="node83" class="node">
<title>gate_s0_t1_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="18553.32,-1828.86 18131.26,-1828.86 18022.68,-1746.86 18444.74,-1746.86 18553.32,-1828.86"/>
<text text-anchor="middle" x="18288" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;10</text>
<text text-anchor="middle" x="18288" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g2&#45;&gt;gate_s0_t1_g2 -->
<g id="edge32" class="edge">
<title>attn_s0_t1_g2&#45;&gt;gate_s0_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-1864.57C18288,-1857.11 18288,-1848.24 18288,-1839.25"/>
<polygon fill="black" stroke="black" points="18291.5,-1839.11 18288,-1829.11 18284.5,-1839.11 18291.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g2_l0 -->
<g id="node84" class="node">
<title>expert_s0_t1_g2_l0</title>
<polygon fill="lightgreen" stroke="black" points="18417,-1710.86 18159,-1710.86 18159,-1669.86 18417,-1669.86 18417,-1710.86"/>
<text text-anchor="middle" x="18288" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;0 GPU&#45;10</text>
<text text-anchor="middle" x="18288" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g2&#45;&gt;expert_s0_t1_g2_l0 -->
<g id="edge33" class="edge">
<title>gate_s0_t1_g2&#45;&gt;expert_s0_t1_g2_l0</title>
<path fill="none" stroke="black" d="M18288,-1746.64C18288,-1738.06 18288,-1729.15 18288,-1721.05"/>
<polygon fill="black" stroke="black" points="18291.5,-1720.97 18288,-1710.97 18284.5,-1720.97 18291.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g2 -->
<g id="node268" class="node">
<title>comm_s0_t1_g2</title>
<ellipse fill="lightblue" stroke="black" cx="18288" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="18288" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;10</text>
<text text-anchor="middle" x="18288" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g2_l0&#45;&gt;comm_s0_t1_g2 -->
<g id="edge34" class="edge">
<title>expert_s0_t1_g2_l0&#45;&gt;comm_s0_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-1669.58C18288,-1661.95 18288,-1652.96 18288,-1644.17"/>
<polygon fill="black" stroke="black" points="18291.5,-1644.05 18288,-1634.05 18284.5,-1644.05 18291.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g2_l1 -->
<g id="node85" class="node">
<title>expert_s0_t1_g2_l1</title>
<polygon fill="lightgreen" stroke="black" points="23154,-1905.86 22896,-1905.86 22896,-1864.86 23154,-1864.86 23154,-1905.86"/>
<text text-anchor="middle" x="23025" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;1 GPU&#45;10</text>
<text text-anchor="middle" x="23025" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23025" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g2_l2 -->
<g id="node86" class="node">
<title>expert_s0_t1_g2_l2</title>
<polygon fill="lightgreen" stroke="black" points="22878,-1905.86 22620,-1905.86 22620,-1864.86 22878,-1864.86 22878,-1905.86"/>
<text text-anchor="middle" x="22749" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;2 GPU&#45;10</text>
<text text-anchor="middle" x="22749" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22749" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g2_l3 -->
<g id="node87" class="node">
<title>expert_s0_t1_g2_l3</title>
<polygon fill="lightgreen" stroke="black" points="22602,-1905.86 22344,-1905.86 22344,-1864.86 22602,-1864.86 22602,-1905.86"/>
<text text-anchor="middle" x="22473" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;3 GPU&#45;10</text>
<text text-anchor="middle" x="22473" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22473" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g2_l4 -->
<g id="node88" class="node">
<title>expert_s0_t1_g2_l4</title>
<polygon fill="lightgreen" stroke="black" points="22326,-1905.86 22068,-1905.86 22068,-1864.86 22326,-1864.86 22326,-1905.86"/>
<text text-anchor="middle" x="22197" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;4 GPU&#45;10</text>
<text text-anchor="middle" x="22197" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22197" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g2_l5 -->
<g id="node89" class="node">
<title>expert_s0_t1_g2_l5</title>
<polygon fill="lightgreen" stroke="black" points="22050,-1905.86 21792,-1905.86 21792,-1864.86 22050,-1864.86 22050,-1905.86"/>
<text text-anchor="middle" x="21921" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;10 Layer&#45;5 GPU&#45;10</text>
<text text-anchor="middle" x="21921" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21921" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g3 -->
<g id="node90" class="node">
<title>attn_s0_t1_g3</title>
<polygon fill="lightgreen" stroke="black" points="20099.5,-1905.86 19824.5,-1905.86 19824.5,-1864.86 20099.5,-1864.86 20099.5,-1905.86"/>
<text text-anchor="middle" x="19962" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;11</text>
<text text-anchor="middle" x="19962" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g3 -->
<g id="node91" class="node">
<title>gate_s0_t1_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="20227.32,-1828.86 19805.26,-1828.86 19696.68,-1746.86 20118.74,-1746.86 20227.32,-1828.86"/>
<text text-anchor="middle" x="19962" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;11</text>
<text text-anchor="middle" x="19962" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g3&#45;&gt;gate_s0_t1_g3 -->
<g id="edge35" class="edge">
<title>attn_s0_t1_g3&#45;&gt;gate_s0_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-1864.57C19962,-1857.11 19962,-1848.24 19962,-1839.25"/>
<polygon fill="black" stroke="black" points="19965.5,-1839.11 19962,-1829.11 19958.5,-1839.11 19965.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g3_l0 -->
<g id="node92" class="node">
<title>expert_s0_t1_g3_l0</title>
<polygon fill="lightgreen" stroke="black" points="20091,-1710.86 19833,-1710.86 19833,-1669.86 20091,-1669.86 20091,-1710.86"/>
<text text-anchor="middle" x="19962" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;0 GPU&#45;11</text>
<text text-anchor="middle" x="19962" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g3&#45;&gt;expert_s0_t1_g3_l0 -->
<g id="edge36" class="edge">
<title>gate_s0_t1_g3&#45;&gt;expert_s0_t1_g3_l0</title>
<path fill="none" stroke="black" d="M19962,-1746.64C19962,-1738.06 19962,-1729.15 19962,-1721.05"/>
<polygon fill="black" stroke="black" points="19965.5,-1720.97 19962,-1710.97 19958.5,-1720.97 19965.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g3 -->
<g id="node269" class="node">
<title>comm_s0_t1_g3</title>
<ellipse fill="lightblue" stroke="black" cx="19962" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="19962" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;11</text>
<text text-anchor="middle" x="19962" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g3_l0&#45;&gt;comm_s0_t1_g3 -->
<g id="edge37" class="edge">
<title>expert_s0_t1_g3_l0&#45;&gt;comm_s0_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-1669.58C19962,-1661.95 19962,-1652.96 19962,-1644.17"/>
<polygon fill="black" stroke="black" points="19965.5,-1644.05 19962,-1634.05 19958.5,-1644.05 19965.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g3_l1 -->
<g id="node93" class="node">
<title>expert_s0_t1_g3_l1</title>
<polygon fill="lightgreen" stroke="black" points="21480,-1905.86 21222,-1905.86 21222,-1864.86 21480,-1864.86 21480,-1905.86"/>
<text text-anchor="middle" x="21351" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;1 GPU&#45;11</text>
<text text-anchor="middle" x="21351" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21351" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g3_l2 -->
<g id="node94" class="node">
<title>expert_s0_t1_g3_l2</title>
<polygon fill="lightgreen" stroke="black" points="21204,-1905.86 20946,-1905.86 20946,-1864.86 21204,-1864.86 21204,-1905.86"/>
<text text-anchor="middle" x="21075" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;2 GPU&#45;11</text>
<text text-anchor="middle" x="21075" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21075" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g3_l3 -->
<g id="node95" class="node">
<title>expert_s0_t1_g3_l3</title>
<polygon fill="lightgreen" stroke="black" points="20928,-1905.86 20670,-1905.86 20670,-1864.86 20928,-1864.86 20928,-1905.86"/>
<text text-anchor="middle" x="20799" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;3 GPU&#45;11</text>
<text text-anchor="middle" x="20799" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20799" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g3_l4 -->
<g id="node96" class="node">
<title>expert_s0_t1_g3_l4</title>
<polygon fill="lightgreen" stroke="black" points="20652,-1905.86 20394,-1905.86 20394,-1864.86 20652,-1864.86 20652,-1905.86"/>
<text text-anchor="middle" x="20523" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;4 GPU&#45;11</text>
<text text-anchor="middle" x="20523" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20523" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g3_l5 -->
<g id="node97" class="node">
<title>expert_s0_t1_g3_l5</title>
<polygon fill="lightgreen" stroke="black" points="20376,-1905.86 20118,-1905.86 20118,-1864.86 20376,-1864.86 20376,-1905.86"/>
<text text-anchor="middle" x="20247" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;11 Layer&#45;5 GPU&#45;11</text>
<text text-anchor="middle" x="20247" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20247" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g4 -->
<g id="node98" class="node">
<title>attn_s0_t1_g4</title>
<polygon fill="lightgreen" stroke="black" points="21773.5,-1905.86 21498.5,-1905.86 21498.5,-1864.86 21773.5,-1864.86 21773.5,-1905.86"/>
<text text-anchor="middle" x="21636" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;12</text>
<text text-anchor="middle" x="21636" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g4 -->
<g id="node99" class="node">
<title>gate_s0_t1_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="21901.32,-1828.86 21479.26,-1828.86 21370.68,-1746.86 21792.74,-1746.86 21901.32,-1828.86"/>
<text text-anchor="middle" x="21636" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;12</text>
<text text-anchor="middle" x="21636" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g4&#45;&gt;gate_s0_t1_g4 -->
<g id="edge38" class="edge">
<title>attn_s0_t1_g4&#45;&gt;gate_s0_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-1864.57C21636,-1857.11 21636,-1848.24 21636,-1839.25"/>
<polygon fill="black" stroke="black" points="21639.5,-1839.11 21636,-1829.11 21632.5,-1839.11 21639.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g4_l0 -->
<g id="node100" class="node">
<title>expert_s0_t1_g4_l0</title>
<polygon fill="lightgreen" stroke="black" points="21765,-1710.86 21507,-1710.86 21507,-1669.86 21765,-1669.86 21765,-1710.86"/>
<text text-anchor="middle" x="21636" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;0 GPU&#45;12</text>
<text text-anchor="middle" x="21636" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g4&#45;&gt;expert_s0_t1_g4_l0 -->
<g id="edge39" class="edge">
<title>gate_s0_t1_g4&#45;&gt;expert_s0_t1_g4_l0</title>
<path fill="none" stroke="black" d="M21636,-1746.64C21636,-1738.06 21636,-1729.15 21636,-1721.05"/>
<polygon fill="black" stroke="black" points="21639.5,-1720.97 21636,-1710.97 21632.5,-1720.97 21639.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g4 -->
<g id="node270" class="node">
<title>comm_s0_t1_g4</title>
<ellipse fill="lightblue" stroke="black" cx="21636" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="21636" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;12</text>
<text text-anchor="middle" x="21636" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g4_l0&#45;&gt;comm_s0_t1_g4 -->
<g id="edge40" class="edge">
<title>expert_s0_t1_g4_l0&#45;&gt;comm_s0_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-1669.58C21636,-1661.95 21636,-1652.96 21636,-1644.17"/>
<polygon fill="black" stroke="black" points="21639.5,-1644.05 21636,-1634.05 21632.5,-1644.05 21639.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g4_l1 -->
<g id="node101" class="node">
<title>expert_s0_t1_g4_l1</title>
<polygon fill="lightgreen" stroke="black" points="19806,-1905.86 19548,-1905.86 19548,-1864.86 19806,-1864.86 19806,-1905.86"/>
<text text-anchor="middle" x="19677" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;1 GPU&#45;12</text>
<text text-anchor="middle" x="19677" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19677" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g4_l2 -->
<g id="node102" class="node">
<title>expert_s0_t1_g4_l2</title>
<polygon fill="lightgreen" stroke="black" points="19530,-1905.86 19272,-1905.86 19272,-1864.86 19530,-1864.86 19530,-1905.86"/>
<text text-anchor="middle" x="19401" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;2 GPU&#45;12</text>
<text text-anchor="middle" x="19401" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19401" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g4_l3 -->
<g id="node103" class="node">
<title>expert_s0_t1_g4_l3</title>
<polygon fill="lightgreen" stroke="black" points="19254,-1905.86 18996,-1905.86 18996,-1864.86 19254,-1864.86 19254,-1905.86"/>
<text text-anchor="middle" x="19125" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;3 GPU&#45;12</text>
<text text-anchor="middle" x="19125" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19125" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g4_l4 -->
<g id="node104" class="node">
<title>expert_s0_t1_g4_l4</title>
<polygon fill="lightgreen" stroke="black" points="18978,-1905.86 18720,-1905.86 18720,-1864.86 18978,-1864.86 18978,-1905.86"/>
<text text-anchor="middle" x="18849" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;4 GPU&#45;12</text>
<text text-anchor="middle" x="18849" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18849" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g4_l5 -->
<g id="node105" class="node">
<title>expert_s0_t1_g4_l5</title>
<polygon fill="lightgreen" stroke="black" points="18702,-1905.86 18444,-1905.86 18444,-1864.86 18702,-1864.86 18702,-1905.86"/>
<text text-anchor="middle" x="18573" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;12 Layer&#45;5 GPU&#45;12</text>
<text text-anchor="middle" x="18573" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18573" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g5 -->
<g id="node106" class="node">
<title>attn_s0_t1_g5</title>
<polygon fill="lightgreen" stroke="black" points="23447.5,-1905.86 23172.5,-1905.86 23172.5,-1864.86 23447.5,-1864.86 23447.5,-1905.86"/>
<text text-anchor="middle" x="23310" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;13</text>
<text text-anchor="middle" x="23310" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g5 -->
<g id="node107" class="node">
<title>gate_s0_t1_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="23575.32,-1828.86 23153.26,-1828.86 23044.68,-1746.86 23466.74,-1746.86 23575.32,-1828.86"/>
<text text-anchor="middle" x="23310" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;13</text>
<text text-anchor="middle" x="23310" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g5&#45;&gt;gate_s0_t1_g5 -->
<g id="edge41" class="edge">
<title>attn_s0_t1_g5&#45;&gt;gate_s0_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-1864.57C23310,-1857.11 23310,-1848.24 23310,-1839.25"/>
<polygon fill="black" stroke="black" points="23313.5,-1839.11 23310,-1829.11 23306.5,-1839.11 23313.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g5_l0 -->
<g id="node108" class="node">
<title>expert_s0_t1_g5_l0</title>
<polygon fill="lightgreen" stroke="black" points="23439,-1710.86 23181,-1710.86 23181,-1669.86 23439,-1669.86 23439,-1710.86"/>
<text text-anchor="middle" x="23310" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;0 GPU&#45;13</text>
<text text-anchor="middle" x="23310" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g5&#45;&gt;expert_s0_t1_g5_l0 -->
<g id="edge42" class="edge">
<title>gate_s0_t1_g5&#45;&gt;expert_s0_t1_g5_l0</title>
<path fill="none" stroke="black" d="M23310,-1746.64C23310,-1738.06 23310,-1729.15 23310,-1721.05"/>
<polygon fill="black" stroke="black" points="23313.5,-1720.97 23310,-1710.97 23306.5,-1720.97 23313.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g5 -->
<g id="node271" class="node">
<title>comm_s0_t1_g5</title>
<ellipse fill="lightblue" stroke="black" cx="23310" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="23310" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;13</text>
<text text-anchor="middle" x="23310" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g5_l0&#45;&gt;comm_s0_t1_g5 -->
<g id="edge43" class="edge">
<title>expert_s0_t1_g5_l0&#45;&gt;comm_s0_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-1669.58C23310,-1661.95 23310,-1652.96 23310,-1644.17"/>
<polygon fill="black" stroke="black" points="23313.5,-1644.05 23310,-1634.05 23306.5,-1644.05 23313.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g5_l1 -->
<g id="node109" class="node">
<title>expert_s0_t1_g5_l1</title>
<polygon fill="lightgreen" stroke="black" points="18132,-1905.86 17874,-1905.86 17874,-1864.86 18132,-1864.86 18132,-1905.86"/>
<text text-anchor="middle" x="18003" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;1 GPU&#45;13</text>
<text text-anchor="middle" x="18003" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18003" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g5_l2 -->
<g id="node110" class="node">
<title>expert_s0_t1_g5_l2</title>
<polygon fill="lightgreen" stroke="black" points="17856,-1905.86 17598,-1905.86 17598,-1864.86 17856,-1864.86 17856,-1905.86"/>
<text text-anchor="middle" x="17727" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;2 GPU&#45;13</text>
<text text-anchor="middle" x="17727" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17727" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g5_l3 -->
<g id="node111" class="node">
<title>expert_s0_t1_g5_l3</title>
<polygon fill="lightgreen" stroke="black" points="17580,-1905.86 17322,-1905.86 17322,-1864.86 17580,-1864.86 17580,-1905.86"/>
<text text-anchor="middle" x="17451" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;3 GPU&#45;13</text>
<text text-anchor="middle" x="17451" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17451" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g5_l4 -->
<g id="node112" class="node">
<title>expert_s0_t1_g5_l4</title>
<polygon fill="lightgreen" stroke="black" points="17304,-1905.86 17046,-1905.86 17046,-1864.86 17304,-1864.86 17304,-1905.86"/>
<text text-anchor="middle" x="17175" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;4 GPU&#45;13</text>
<text text-anchor="middle" x="17175" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17175" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g5_l5 -->
<g id="node113" class="node">
<title>expert_s0_t1_g5_l5</title>
<polygon fill="lightgreen" stroke="black" points="17028,-1905.86 16770,-1905.86 16770,-1864.86 17028,-1864.86 17028,-1905.86"/>
<text text-anchor="middle" x="16899" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;13 Layer&#45;5 GPU&#45;13</text>
<text text-anchor="middle" x="16899" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16899" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g6 -->
<g id="node114" class="node">
<title>attn_s0_t1_g6</title>
<polygon fill="lightgreen" stroke="black" points="25121.5,-1905.86 24846.5,-1905.86 24846.5,-1864.86 25121.5,-1864.86 25121.5,-1905.86"/>
<text text-anchor="middle" x="24984" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;14</text>
<text text-anchor="middle" x="24984" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g6 -->
<g id="node115" class="node">
<title>gate_s0_t1_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="25249.32,-1828.86 24827.26,-1828.86 24718.68,-1746.86 25140.74,-1746.86 25249.32,-1828.86"/>
<text text-anchor="middle" x="24984" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;14</text>
<text text-anchor="middle" x="24984" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g6&#45;&gt;gate_s0_t1_g6 -->
<g id="edge44" class="edge">
<title>attn_s0_t1_g6&#45;&gt;gate_s0_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-1864.57C24984,-1857.11 24984,-1848.24 24984,-1839.25"/>
<polygon fill="black" stroke="black" points="24987.5,-1839.11 24984,-1829.11 24980.5,-1839.11 24987.5,-1839.11"/>
</g>
<!-- expert_s0_t1_g6_l0 -->
<g id="node116" class="node">
<title>expert_s0_t1_g6_l0</title>
<polygon fill="lightgreen" stroke="black" points="25113,-1710.86 24855,-1710.86 24855,-1669.86 25113,-1669.86 25113,-1710.86"/>
<text text-anchor="middle" x="24984" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;0 GPU&#45;14</text>
<text text-anchor="middle" x="24984" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g6&#45;&gt;expert_s0_t1_g6_l0 -->
<g id="edge45" class="edge">
<title>gate_s0_t1_g6&#45;&gt;expert_s0_t1_g6_l0</title>
<path fill="none" stroke="black" d="M24984,-1746.64C24984,-1738.06 24984,-1729.15 24984,-1721.05"/>
<polygon fill="black" stroke="black" points="24987.5,-1720.97 24984,-1710.97 24980.5,-1720.97 24987.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g6 -->
<g id="node272" class="node">
<title>comm_s0_t1_g6</title>
<ellipse fill="lightblue" stroke="black" cx="24984" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="24984" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;14</text>
<text text-anchor="middle" x="24984" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g6_l0&#45;&gt;comm_s0_t1_g6 -->
<g id="edge46" class="edge">
<title>expert_s0_t1_g6_l0&#45;&gt;comm_s0_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-1669.58C24984,-1661.95 24984,-1652.96 24984,-1644.17"/>
<polygon fill="black" stroke="black" points="24987.5,-1644.05 24984,-1634.05 24980.5,-1644.05 24987.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g6_l1 -->
<g id="node117" class="node">
<title>expert_s0_t1_g6_l1</title>
<polygon fill="lightgreen" stroke="black" points="16458,-1905.86 16200,-1905.86 16200,-1864.86 16458,-1864.86 16458,-1905.86"/>
<text text-anchor="middle" x="16329" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;1 GPU&#45;14</text>
<text text-anchor="middle" x="16329" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16329" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g6_l2 -->
<g id="node118" class="node">
<title>expert_s0_t1_g6_l2</title>
<polygon fill="lightgreen" stroke="black" points="16182,-1905.86 15924,-1905.86 15924,-1864.86 16182,-1864.86 16182,-1905.86"/>
<text text-anchor="middle" x="16053" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;2 GPU&#45;14</text>
<text text-anchor="middle" x="16053" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16053" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g6_l3 -->
<g id="node119" class="node">
<title>expert_s0_t1_g6_l3</title>
<polygon fill="lightgreen" stroke="black" points="15906,-1905.86 15648,-1905.86 15648,-1864.86 15906,-1864.86 15906,-1905.86"/>
<text text-anchor="middle" x="15777" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;3 GPU&#45;14</text>
<text text-anchor="middle" x="15777" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15777" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g6_l4 -->
<g id="node120" class="node">
<title>expert_s0_t1_g6_l4</title>
<polygon fill="lightgreen" stroke="black" points="15630,-1905.86 15372,-1905.86 15372,-1864.86 15630,-1864.86 15630,-1905.86"/>
<text text-anchor="middle" x="15501" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;4 GPU&#45;14</text>
<text text-anchor="middle" x="15501" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15501" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g6_l5 -->
<g id="node121" class="node">
<title>expert_s0_t1_g6_l5</title>
<polygon fill="lightgreen" stroke="black" points="15354,-1905.86 15096,-1905.86 15096,-1864.86 15354,-1864.86 15354,-1905.86"/>
<text text-anchor="middle" x="15225" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;14 Layer&#45;5 GPU&#45;14</text>
<text text-anchor="middle" x="15225" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15225" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t1_g7 -->
<g id="node122" class="node">
<title>attn_s0_t1_g7</title>
<polygon fill="lightgreen" stroke="black" points="26795.5,-1905.86 26520.5,-1905.86 26520.5,-1864.86 26795.5,-1864.86 26795.5,-1905.86"/>
<text text-anchor="middle" x="26658" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;15</text>
<text text-anchor="middle" x="26658" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26658" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t1_g7 -->
<g id="node123" class="node">
<title>gate_s0_t1_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="26796.32,-1828.86 26374.26,-1828.86 26265.68,-1746.86 26687.74,-1746.86 26796.32,-1828.86"/>
<text text-anchor="middle" x="26531" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;15</text>
<text text-anchor="middle" x="26531" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t1_g7&#45;&gt;gate_s0_t1_g7 -->
<g id="edge47" class="edge">
<title>attn_s0_t1_g7&#45;&gt;gate_s0_t1_g7</title>
<path fill="none" stroke="black" d="M26631.99,-1864.81C26620.47,-1856.14 26606.37,-1845.54 26592.41,-1835.04"/>
<polygon fill="black" stroke="black" points="26594.33,-1832.1 26584.23,-1828.89 26590.12,-1837.7 26594.33,-1832.1"/>
</g>
<!-- expert_s0_t1_g7_l0 -->
<g id="node124" class="node">
<title>expert_s0_t1_g7_l0</title>
<polygon fill="lightgreen" stroke="black" points="26660,-1710.86 26402,-1710.86 26402,-1669.86 26660,-1669.86 26660,-1710.86"/>
<text text-anchor="middle" x="26531" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;0 GPU&#45;15</text>
<text text-anchor="middle" x="26531" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t1_g7&#45;&gt;expert_s0_t1_g7_l0 -->
<g id="edge48" class="edge">
<title>gate_s0_t1_g7&#45;&gt;expert_s0_t1_g7_l0</title>
<path fill="none" stroke="black" d="M26531,-1746.64C26531,-1738.06 26531,-1729.15 26531,-1721.05"/>
<polygon fill="black" stroke="black" points="26534.5,-1720.97 26531,-1710.97 26527.5,-1720.97 26534.5,-1720.97"/>
</g>
<!-- comm_s0_t1_g7 -->
<g id="node273" class="node">
<title>comm_s0_t1_g7</title>
<ellipse fill="lightblue" stroke="black" cx="26531" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="26531" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;15</text>
<text text-anchor="middle" x="26531" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26531" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t1_g7_l0&#45;&gt;comm_s0_t1_g7 -->
<g id="edge49" class="edge">
<title>expert_s0_t1_g7_l0&#45;&gt;comm_s0_t1_g7</title>
<path fill="none" stroke="black" d="M26531,-1669.58C26531,-1661.95 26531,-1652.96 26531,-1644.17"/>
<polygon fill="black" stroke="black" points="26534.5,-1644.05 26531,-1634.05 26527.5,-1644.05 26534.5,-1644.05"/>
</g>
<!-- expert_s0_t1_g7_l1 -->
<g id="node125" class="node">
<title>expert_s0_t1_g7_l1</title>
<polygon fill="lightgreen" stroke="black" points="14784,-1905.86 14526,-1905.86 14526,-1864.86 14784,-1864.86 14784,-1905.86"/>
<text text-anchor="middle" x="14655" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;1 GPU&#45;15</text>
<text text-anchor="middle" x="14655" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14655" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g7_l2 -->
<g id="node126" class="node">
<title>expert_s0_t1_g7_l2</title>
<polygon fill="lightgreen" stroke="black" points="14508,-1905.86 14250,-1905.86 14250,-1864.86 14508,-1864.86 14508,-1905.86"/>
<text text-anchor="middle" x="14379" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;2 GPU&#45;15</text>
<text text-anchor="middle" x="14379" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14379" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g7_l3 -->
<g id="node127" class="node">
<title>expert_s0_t1_g7_l3</title>
<polygon fill="lightgreen" stroke="black" points="14232,-1905.86 13974,-1905.86 13974,-1864.86 14232,-1864.86 14232,-1905.86"/>
<text text-anchor="middle" x="14103" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;3 GPU&#45;15</text>
<text text-anchor="middle" x="14103" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14103" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g7_l4 -->
<g id="node128" class="node">
<title>expert_s0_t1_g7_l4</title>
<polygon fill="lightgreen" stroke="black" points="13956,-1905.86 13698,-1905.86 13698,-1864.86 13956,-1864.86 13956,-1905.86"/>
<text text-anchor="middle" x="13827" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;4 GPU&#45;15</text>
<text text-anchor="middle" x="13827" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13827" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t1_g7_l5 -->
<g id="node129" class="node">
<title>expert_s0_t1_g7_l5</title>
<polygon fill="lightgreen" stroke="black" points="13680,-1905.86 13422,-1905.86 13422,-1864.86 13680,-1864.86 13680,-1905.86"/>
<text text-anchor="middle" x="13551" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;15 Layer&#45;5 GPU&#45;15</text>
<text text-anchor="middle" x="13551" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13551" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g0 -->
<g id="node130" class="node">
<title>attn_s0_t2_g0</title>
<polygon fill="lightgreen" stroke="black" points="28475.5,-1905.86 28200.5,-1905.86 28200.5,-1864.86 28475.5,-1864.86 28475.5,-1905.86"/>
<text text-anchor="middle" x="28338" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;16</text>
<text text-anchor="middle" x="28338" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g0 -->
<g id="node131" class="node">
<title>gate_s0_t2_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="28603.32,-1828.86 28181.26,-1828.86 28072.68,-1746.86 28494.74,-1746.86 28603.32,-1828.86"/>
<text text-anchor="middle" x="28338" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;16</text>
<text text-anchor="middle" x="28338" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g0&#45;&gt;gate_s0_t2_g0 -->
<g id="edge50" class="edge">
<title>attn_s0_t2_g0&#45;&gt;gate_s0_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-1864.57C28338,-1857.11 28338,-1848.24 28338,-1839.25"/>
<polygon fill="black" stroke="black" points="28341.5,-1839.11 28338,-1829.11 28334.5,-1839.11 28341.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g0_l0 -->
<g id="node132" class="node">
<title>expert_s0_t2_g0_l0</title>
<polygon fill="lightgreen" stroke="black" points="28467,-1710.86 28209,-1710.86 28209,-1669.86 28467,-1669.86 28467,-1710.86"/>
<text text-anchor="middle" x="28338" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;0 GPU&#45;16</text>
<text text-anchor="middle" x="28338" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g0&#45;&gt;expert_s0_t2_g0_l0 -->
<g id="edge51" class="edge">
<title>gate_s0_t2_g0&#45;&gt;expert_s0_t2_g0_l0</title>
<path fill="none" stroke="black" d="M28338,-1746.64C28338,-1738.06 28338,-1729.15 28338,-1721.05"/>
<polygon fill="black" stroke="black" points="28341.5,-1720.97 28338,-1710.97 28334.5,-1720.97 28341.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g0 -->
<g id="node274" class="node">
<title>comm_s0_t2_g0</title>
<ellipse fill="lightblue" stroke="black" cx="28338" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="28338" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;16</text>
<text text-anchor="middle" x="28338" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g0_l0&#45;&gt;comm_s0_t2_g0 -->
<g id="edge52" class="edge">
<title>expert_s0_t2_g0_l0&#45;&gt;comm_s0_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-1669.58C28338,-1661.95 28338,-1652.96 28338,-1644.17"/>
<polygon fill="black" stroke="black" points="28341.5,-1644.05 28338,-1634.05 28334.5,-1644.05 28341.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g0_l1 -->
<g id="node133" class="node">
<title>expert_s0_t2_g0_l1</title>
<polygon fill="lightgreen" stroke="black" points="39900,-1905.86 39642,-1905.86 39642,-1864.86 39900,-1864.86 39900,-1905.86"/>
<text text-anchor="middle" x="39771" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;1 GPU&#45;16</text>
<text text-anchor="middle" x="39771" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39771" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g0_l2 -->
<g id="node134" class="node">
<title>expert_s0_t2_g0_l2</title>
<polygon fill="lightgreen" stroke="black" points="39624,-1905.86 39366,-1905.86 39366,-1864.86 39624,-1864.86 39624,-1905.86"/>
<text text-anchor="middle" x="39495" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;2 GPU&#45;16</text>
<text text-anchor="middle" x="39495" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39495" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g0_l3 -->
<g id="node135" class="node">
<title>expert_s0_t2_g0_l3</title>
<polygon fill="lightgreen" stroke="black" points="39348,-1905.86 39090,-1905.86 39090,-1864.86 39348,-1864.86 39348,-1905.86"/>
<text text-anchor="middle" x="39219" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;3 GPU&#45;16</text>
<text text-anchor="middle" x="39219" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39219" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g0_l4 -->
<g id="node136" class="node">
<title>expert_s0_t2_g0_l4</title>
<polygon fill="lightgreen" stroke="black" points="39072,-1905.86 38814,-1905.86 38814,-1864.86 39072,-1864.86 39072,-1905.86"/>
<text text-anchor="middle" x="38943" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;4 GPU&#45;16</text>
<text text-anchor="middle" x="38943" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38943" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g0_l5 -->
<g id="node137" class="node">
<title>expert_s0_t2_g0_l5</title>
<polygon fill="lightgreen" stroke="black" points="38796,-1905.86 38538,-1905.86 38538,-1864.86 38796,-1864.86 38796,-1905.86"/>
<text text-anchor="middle" x="38667" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;16 Layer&#45;5 GPU&#45;16</text>
<text text-anchor="middle" x="38667" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38667" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g1 -->
<g id="node138" class="node">
<title>attn_s0_t2_g1</title>
<polygon fill="lightgreen" stroke="black" points="30149.5,-1905.86 29874.5,-1905.86 29874.5,-1864.86 30149.5,-1864.86 30149.5,-1905.86"/>
<text text-anchor="middle" x="30012" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;17</text>
<text text-anchor="middle" x="30012" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g1 -->
<g id="node139" class="node">
<title>gate_s0_t2_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="30277.32,-1828.86 29855.26,-1828.86 29746.68,-1746.86 30168.74,-1746.86 30277.32,-1828.86"/>
<text text-anchor="middle" x="30012" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;17</text>
<text text-anchor="middle" x="30012" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g1&#45;&gt;gate_s0_t2_g1 -->
<g id="edge53" class="edge">
<title>attn_s0_t2_g1&#45;&gt;gate_s0_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-1864.57C30012,-1857.11 30012,-1848.24 30012,-1839.25"/>
<polygon fill="black" stroke="black" points="30015.5,-1839.11 30012,-1829.11 30008.5,-1839.11 30015.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g1_l0 -->
<g id="node140" class="node">
<title>expert_s0_t2_g1_l0</title>
<polygon fill="lightgreen" stroke="black" points="30141,-1710.86 29883,-1710.86 29883,-1669.86 30141,-1669.86 30141,-1710.86"/>
<text text-anchor="middle" x="30012" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;0 GPU&#45;17</text>
<text text-anchor="middle" x="30012" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g1&#45;&gt;expert_s0_t2_g1_l0 -->
<g id="edge54" class="edge">
<title>gate_s0_t2_g1&#45;&gt;expert_s0_t2_g1_l0</title>
<path fill="none" stroke="black" d="M30012,-1746.64C30012,-1738.06 30012,-1729.15 30012,-1721.05"/>
<polygon fill="black" stroke="black" points="30015.5,-1720.97 30012,-1710.97 30008.5,-1720.97 30015.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g1 -->
<g id="node275" class="node">
<title>comm_s0_t2_g1</title>
<ellipse fill="lightblue" stroke="black" cx="30012" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="30012" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;17</text>
<text text-anchor="middle" x="30012" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g1_l0&#45;&gt;comm_s0_t2_g1 -->
<g id="edge55" class="edge">
<title>expert_s0_t2_g1_l0&#45;&gt;comm_s0_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-1669.58C30012,-1661.95 30012,-1652.96 30012,-1644.17"/>
<polygon fill="black" stroke="black" points="30015.5,-1644.05 30012,-1634.05 30008.5,-1644.05 30015.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g1_l1 -->
<g id="node141" class="node">
<title>expert_s0_t2_g1_l1</title>
<polygon fill="lightgreen" stroke="black" points="38226,-1905.86 37968,-1905.86 37968,-1864.86 38226,-1864.86 38226,-1905.86"/>
<text text-anchor="middle" x="38097" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;1 GPU&#45;17</text>
<text text-anchor="middle" x="38097" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38097" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g1_l2 -->
<g id="node142" class="node">
<title>expert_s0_t2_g1_l2</title>
<polygon fill="lightgreen" stroke="black" points="37950,-1905.86 37692,-1905.86 37692,-1864.86 37950,-1864.86 37950,-1905.86"/>
<text text-anchor="middle" x="37821" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;2 GPU&#45;17</text>
<text text-anchor="middle" x="37821" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37821" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g1_l3 -->
<g id="node143" class="node">
<title>expert_s0_t2_g1_l3</title>
<polygon fill="lightgreen" stroke="black" points="37674,-1905.86 37416,-1905.86 37416,-1864.86 37674,-1864.86 37674,-1905.86"/>
<text text-anchor="middle" x="37545" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;3 GPU&#45;17</text>
<text text-anchor="middle" x="37545" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37545" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g1_l4 -->
<g id="node144" class="node">
<title>expert_s0_t2_g1_l4</title>
<polygon fill="lightgreen" stroke="black" points="37398,-1905.86 37140,-1905.86 37140,-1864.86 37398,-1864.86 37398,-1905.86"/>
<text text-anchor="middle" x="37269" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;4 GPU&#45;17</text>
<text text-anchor="middle" x="37269" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37269" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g1_l5 -->
<g id="node145" class="node">
<title>expert_s0_t2_g1_l5</title>
<polygon fill="lightgreen" stroke="black" points="37122,-1905.86 36864,-1905.86 36864,-1864.86 37122,-1864.86 37122,-1905.86"/>
<text text-anchor="middle" x="36993" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;17 Layer&#45;5 GPU&#45;17</text>
<text text-anchor="middle" x="36993" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36993" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g2 -->
<g id="node146" class="node">
<title>attn_s0_t2_g2</title>
<polygon fill="lightgreen" stroke="black" points="31823.5,-1905.86 31548.5,-1905.86 31548.5,-1864.86 31823.5,-1864.86 31823.5,-1905.86"/>
<text text-anchor="middle" x="31686" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;18</text>
<text text-anchor="middle" x="31686" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g2 -->
<g id="node147" class="node">
<title>gate_s0_t2_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="31951.32,-1828.86 31529.26,-1828.86 31420.68,-1746.86 31842.74,-1746.86 31951.32,-1828.86"/>
<text text-anchor="middle" x="31686" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;18</text>
<text text-anchor="middle" x="31686" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g2&#45;&gt;gate_s0_t2_g2 -->
<g id="edge56" class="edge">
<title>attn_s0_t2_g2&#45;&gt;gate_s0_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-1864.57C31686,-1857.11 31686,-1848.24 31686,-1839.25"/>
<polygon fill="black" stroke="black" points="31689.5,-1839.11 31686,-1829.11 31682.5,-1839.11 31689.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g2_l0 -->
<g id="node148" class="node">
<title>expert_s0_t2_g2_l0</title>
<polygon fill="lightgreen" stroke="black" points="31815,-1710.86 31557,-1710.86 31557,-1669.86 31815,-1669.86 31815,-1710.86"/>
<text text-anchor="middle" x="31686" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;0 GPU&#45;18</text>
<text text-anchor="middle" x="31686" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g2&#45;&gt;expert_s0_t2_g2_l0 -->
<g id="edge57" class="edge">
<title>gate_s0_t2_g2&#45;&gt;expert_s0_t2_g2_l0</title>
<path fill="none" stroke="black" d="M31686,-1746.64C31686,-1738.06 31686,-1729.15 31686,-1721.05"/>
<polygon fill="black" stroke="black" points="31689.5,-1720.97 31686,-1710.97 31682.5,-1720.97 31689.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g2 -->
<g id="node276" class="node">
<title>comm_s0_t2_g2</title>
<ellipse fill="lightblue" stroke="black" cx="31686" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="31686" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;18</text>
<text text-anchor="middle" x="31686" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g2_l0&#45;&gt;comm_s0_t2_g2 -->
<g id="edge58" class="edge">
<title>expert_s0_t2_g2_l0&#45;&gt;comm_s0_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-1669.58C31686,-1661.95 31686,-1652.96 31686,-1644.17"/>
<polygon fill="black" stroke="black" points="31689.5,-1644.05 31686,-1634.05 31682.5,-1644.05 31689.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g2_l1 -->
<g id="node149" class="node">
<title>expert_s0_t2_g2_l1</title>
<polygon fill="lightgreen" stroke="black" points="36552,-1905.86 36294,-1905.86 36294,-1864.86 36552,-1864.86 36552,-1905.86"/>
<text text-anchor="middle" x="36423" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;1 GPU&#45;18</text>
<text text-anchor="middle" x="36423" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36423" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g2_l2 -->
<g id="node150" class="node">
<title>expert_s0_t2_g2_l2</title>
<polygon fill="lightgreen" stroke="black" points="36276,-1905.86 36018,-1905.86 36018,-1864.86 36276,-1864.86 36276,-1905.86"/>
<text text-anchor="middle" x="36147" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;2 GPU&#45;18</text>
<text text-anchor="middle" x="36147" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36147" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g2_l3 -->
<g id="node151" class="node">
<title>expert_s0_t2_g2_l3</title>
<polygon fill="lightgreen" stroke="black" points="36000,-1905.86 35742,-1905.86 35742,-1864.86 36000,-1864.86 36000,-1905.86"/>
<text text-anchor="middle" x="35871" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;3 GPU&#45;18</text>
<text text-anchor="middle" x="35871" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35871" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g2_l4 -->
<g id="node152" class="node">
<title>expert_s0_t2_g2_l4</title>
<polygon fill="lightgreen" stroke="black" points="35724,-1905.86 35466,-1905.86 35466,-1864.86 35724,-1864.86 35724,-1905.86"/>
<text text-anchor="middle" x="35595" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;4 GPU&#45;18</text>
<text text-anchor="middle" x="35595" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35595" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g2_l5 -->
<g id="node153" class="node">
<title>expert_s0_t2_g2_l5</title>
<polygon fill="lightgreen" stroke="black" points="35448,-1905.86 35190,-1905.86 35190,-1864.86 35448,-1864.86 35448,-1905.86"/>
<text text-anchor="middle" x="35319" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;18 Layer&#45;5 GPU&#45;18</text>
<text text-anchor="middle" x="35319" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35319" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g3 -->
<g id="node154" class="node">
<title>attn_s0_t2_g3</title>
<polygon fill="lightgreen" stroke="black" points="33497.5,-1905.86 33222.5,-1905.86 33222.5,-1864.86 33497.5,-1864.86 33497.5,-1905.86"/>
<text text-anchor="middle" x="33360" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;19</text>
<text text-anchor="middle" x="33360" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g3 -->
<g id="node155" class="node">
<title>gate_s0_t2_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="33625.32,-1828.86 33203.26,-1828.86 33094.68,-1746.86 33516.74,-1746.86 33625.32,-1828.86"/>
<text text-anchor="middle" x="33360" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;19</text>
<text text-anchor="middle" x="33360" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g3&#45;&gt;gate_s0_t2_g3 -->
<g id="edge59" class="edge">
<title>attn_s0_t2_g3&#45;&gt;gate_s0_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-1864.57C33360,-1857.11 33360,-1848.24 33360,-1839.25"/>
<polygon fill="black" stroke="black" points="33363.5,-1839.11 33360,-1829.11 33356.5,-1839.11 33363.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g3_l0 -->
<g id="node156" class="node">
<title>expert_s0_t2_g3_l0</title>
<polygon fill="lightgreen" stroke="black" points="33489,-1710.86 33231,-1710.86 33231,-1669.86 33489,-1669.86 33489,-1710.86"/>
<text text-anchor="middle" x="33360" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;0 GPU&#45;19</text>
<text text-anchor="middle" x="33360" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g3&#45;&gt;expert_s0_t2_g3_l0 -->
<g id="edge60" class="edge">
<title>gate_s0_t2_g3&#45;&gt;expert_s0_t2_g3_l0</title>
<path fill="none" stroke="black" d="M33360,-1746.64C33360,-1738.06 33360,-1729.15 33360,-1721.05"/>
<polygon fill="black" stroke="black" points="33363.5,-1720.97 33360,-1710.97 33356.5,-1720.97 33363.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g3 -->
<g id="node277" class="node">
<title>comm_s0_t2_g3</title>
<ellipse fill="lightblue" stroke="black" cx="33360" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="33360" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;19</text>
<text text-anchor="middle" x="33360" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g3_l0&#45;&gt;comm_s0_t2_g3 -->
<g id="edge61" class="edge">
<title>expert_s0_t2_g3_l0&#45;&gt;comm_s0_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-1669.58C33360,-1661.95 33360,-1652.96 33360,-1644.17"/>
<polygon fill="black" stroke="black" points="33363.5,-1644.05 33360,-1634.05 33356.5,-1644.05 33363.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g3_l1 -->
<g id="node157" class="node">
<title>expert_s0_t2_g3_l1</title>
<polygon fill="lightgreen" stroke="black" points="34878,-1905.86 34620,-1905.86 34620,-1864.86 34878,-1864.86 34878,-1905.86"/>
<text text-anchor="middle" x="34749" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;1 GPU&#45;19</text>
<text text-anchor="middle" x="34749" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34749" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g3_l2 -->
<g id="node158" class="node">
<title>expert_s0_t2_g3_l2</title>
<polygon fill="lightgreen" stroke="black" points="34602,-1905.86 34344,-1905.86 34344,-1864.86 34602,-1864.86 34602,-1905.86"/>
<text text-anchor="middle" x="34473" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;2 GPU&#45;19</text>
<text text-anchor="middle" x="34473" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34473" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g3_l3 -->
<g id="node159" class="node">
<title>expert_s0_t2_g3_l3</title>
<polygon fill="lightgreen" stroke="black" points="34326,-1905.86 34068,-1905.86 34068,-1864.86 34326,-1864.86 34326,-1905.86"/>
<text text-anchor="middle" x="34197" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;3 GPU&#45;19</text>
<text text-anchor="middle" x="34197" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34197" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g3_l4 -->
<g id="node160" class="node">
<title>expert_s0_t2_g3_l4</title>
<polygon fill="lightgreen" stroke="black" points="34050,-1905.86 33792,-1905.86 33792,-1864.86 34050,-1864.86 34050,-1905.86"/>
<text text-anchor="middle" x="33921" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;4 GPU&#45;19</text>
<text text-anchor="middle" x="33921" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33921" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g3_l5 -->
<g id="node161" class="node">
<title>expert_s0_t2_g3_l5</title>
<polygon fill="lightgreen" stroke="black" points="33774,-1905.86 33516,-1905.86 33516,-1864.86 33774,-1864.86 33774,-1905.86"/>
<text text-anchor="middle" x="33645" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;19 Layer&#45;5 GPU&#45;19</text>
<text text-anchor="middle" x="33645" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33645" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g4 -->
<g id="node162" class="node">
<title>attn_s0_t2_g4</title>
<polygon fill="lightgreen" stroke="black" points="35171.5,-1905.86 34896.5,-1905.86 34896.5,-1864.86 35171.5,-1864.86 35171.5,-1905.86"/>
<text text-anchor="middle" x="35034" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;20</text>
<text text-anchor="middle" x="35034" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g4 -->
<g id="node163" class="node">
<title>gate_s0_t2_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="35299.32,-1828.86 34877.26,-1828.86 34768.68,-1746.86 35190.74,-1746.86 35299.32,-1828.86"/>
<text text-anchor="middle" x="35034" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;20</text>
<text text-anchor="middle" x="35034" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g4&#45;&gt;gate_s0_t2_g4 -->
<g id="edge62" class="edge">
<title>attn_s0_t2_g4&#45;&gt;gate_s0_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-1864.57C35034,-1857.11 35034,-1848.24 35034,-1839.25"/>
<polygon fill="black" stroke="black" points="35037.5,-1839.11 35034,-1829.11 35030.5,-1839.11 35037.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g4_l0 -->
<g id="node164" class="node">
<title>expert_s0_t2_g4_l0</title>
<polygon fill="lightgreen" stroke="black" points="35163,-1710.86 34905,-1710.86 34905,-1669.86 35163,-1669.86 35163,-1710.86"/>
<text text-anchor="middle" x="35034" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;0 GPU&#45;20</text>
<text text-anchor="middle" x="35034" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g4&#45;&gt;expert_s0_t2_g4_l0 -->
<g id="edge63" class="edge">
<title>gate_s0_t2_g4&#45;&gt;expert_s0_t2_g4_l0</title>
<path fill="none" stroke="black" d="M35034,-1746.64C35034,-1738.06 35034,-1729.15 35034,-1721.05"/>
<polygon fill="black" stroke="black" points="35037.5,-1720.97 35034,-1710.97 35030.5,-1720.97 35037.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g4 -->
<g id="node278" class="node">
<title>comm_s0_t2_g4</title>
<ellipse fill="lightblue" stroke="black" cx="35034" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="35034" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;20</text>
<text text-anchor="middle" x="35034" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g4_l0&#45;&gt;comm_s0_t2_g4 -->
<g id="edge64" class="edge">
<title>expert_s0_t2_g4_l0&#45;&gt;comm_s0_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-1669.58C35034,-1661.95 35034,-1652.96 35034,-1644.17"/>
<polygon fill="black" stroke="black" points="35037.5,-1644.05 35034,-1634.05 35030.5,-1644.05 35037.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g4_l1 -->
<g id="node165" class="node">
<title>expert_s0_t2_g4_l1</title>
<polygon fill="lightgreen" stroke="black" points="33204,-1905.86 32946,-1905.86 32946,-1864.86 33204,-1864.86 33204,-1905.86"/>
<text text-anchor="middle" x="33075" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;1 GPU&#45;20</text>
<text text-anchor="middle" x="33075" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33075" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g4_l2 -->
<g id="node166" class="node">
<title>expert_s0_t2_g4_l2</title>
<polygon fill="lightgreen" stroke="black" points="32928,-1905.86 32670,-1905.86 32670,-1864.86 32928,-1864.86 32928,-1905.86"/>
<text text-anchor="middle" x="32799" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;2 GPU&#45;20</text>
<text text-anchor="middle" x="32799" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32799" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g4_l3 -->
<g id="node167" class="node">
<title>expert_s0_t2_g4_l3</title>
<polygon fill="lightgreen" stroke="black" points="32652,-1905.86 32394,-1905.86 32394,-1864.86 32652,-1864.86 32652,-1905.86"/>
<text text-anchor="middle" x="32523" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;3 GPU&#45;20</text>
<text text-anchor="middle" x="32523" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32523" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g4_l4 -->
<g id="node168" class="node">
<title>expert_s0_t2_g4_l4</title>
<polygon fill="lightgreen" stroke="black" points="32376,-1905.86 32118,-1905.86 32118,-1864.86 32376,-1864.86 32376,-1905.86"/>
<text text-anchor="middle" x="32247" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;4 GPU&#45;20</text>
<text text-anchor="middle" x="32247" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32247" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g4_l5 -->
<g id="node169" class="node">
<title>expert_s0_t2_g4_l5</title>
<polygon fill="lightgreen" stroke="black" points="32100,-1905.86 31842,-1905.86 31842,-1864.86 32100,-1864.86 32100,-1905.86"/>
<text text-anchor="middle" x="31971" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;20 Layer&#45;5 GPU&#45;20</text>
<text text-anchor="middle" x="31971" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31971" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g5 -->
<g id="node170" class="node">
<title>attn_s0_t2_g5</title>
<polygon fill="lightgreen" stroke="black" points="36845.5,-1905.86 36570.5,-1905.86 36570.5,-1864.86 36845.5,-1864.86 36845.5,-1905.86"/>
<text text-anchor="middle" x="36708" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;21</text>
<text text-anchor="middle" x="36708" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g5 -->
<g id="node171" class="node">
<title>gate_s0_t2_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="36973.32,-1828.86 36551.26,-1828.86 36442.68,-1746.86 36864.74,-1746.86 36973.32,-1828.86"/>
<text text-anchor="middle" x="36708" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;21</text>
<text text-anchor="middle" x="36708" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g5&#45;&gt;gate_s0_t2_g5 -->
<g id="edge65" class="edge">
<title>attn_s0_t2_g5&#45;&gt;gate_s0_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-1864.57C36708,-1857.11 36708,-1848.24 36708,-1839.25"/>
<polygon fill="black" stroke="black" points="36711.5,-1839.11 36708,-1829.11 36704.5,-1839.11 36711.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g5_l0 -->
<g id="node172" class="node">
<title>expert_s0_t2_g5_l0</title>
<polygon fill="lightgreen" stroke="black" points="36837,-1710.86 36579,-1710.86 36579,-1669.86 36837,-1669.86 36837,-1710.86"/>
<text text-anchor="middle" x="36708" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;0 GPU&#45;21</text>
<text text-anchor="middle" x="36708" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g5&#45;&gt;expert_s0_t2_g5_l0 -->
<g id="edge66" class="edge">
<title>gate_s0_t2_g5&#45;&gt;expert_s0_t2_g5_l0</title>
<path fill="none" stroke="black" d="M36708,-1746.64C36708,-1738.06 36708,-1729.15 36708,-1721.05"/>
<polygon fill="black" stroke="black" points="36711.5,-1720.97 36708,-1710.97 36704.5,-1720.97 36711.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g5 -->
<g id="node279" class="node">
<title>comm_s0_t2_g5</title>
<ellipse fill="lightblue" stroke="black" cx="36708" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="36708" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;21</text>
<text text-anchor="middle" x="36708" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g5_l0&#45;&gt;comm_s0_t2_g5 -->
<g id="edge67" class="edge">
<title>expert_s0_t2_g5_l0&#45;&gt;comm_s0_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-1669.58C36708,-1661.95 36708,-1652.96 36708,-1644.17"/>
<polygon fill="black" stroke="black" points="36711.5,-1644.05 36708,-1634.05 36704.5,-1644.05 36711.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g5_l1 -->
<g id="node173" class="node">
<title>expert_s0_t2_g5_l1</title>
<polygon fill="lightgreen" stroke="black" points="31530,-1905.86 31272,-1905.86 31272,-1864.86 31530,-1864.86 31530,-1905.86"/>
<text text-anchor="middle" x="31401" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;1 GPU&#45;21</text>
<text text-anchor="middle" x="31401" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31401" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g5_l2 -->
<g id="node174" class="node">
<title>expert_s0_t2_g5_l2</title>
<polygon fill="lightgreen" stroke="black" points="31254,-1905.86 30996,-1905.86 30996,-1864.86 31254,-1864.86 31254,-1905.86"/>
<text text-anchor="middle" x="31125" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;2 GPU&#45;21</text>
<text text-anchor="middle" x="31125" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31125" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g5_l3 -->
<g id="node175" class="node">
<title>expert_s0_t2_g5_l3</title>
<polygon fill="lightgreen" stroke="black" points="30978,-1905.86 30720,-1905.86 30720,-1864.86 30978,-1864.86 30978,-1905.86"/>
<text text-anchor="middle" x="30849" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;3 GPU&#45;21</text>
<text text-anchor="middle" x="30849" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30849" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g5_l4 -->
<g id="node176" class="node">
<title>expert_s0_t2_g5_l4</title>
<polygon fill="lightgreen" stroke="black" points="30702,-1905.86 30444,-1905.86 30444,-1864.86 30702,-1864.86 30702,-1905.86"/>
<text text-anchor="middle" x="30573" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;4 GPU&#45;21</text>
<text text-anchor="middle" x="30573" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30573" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g5_l5 -->
<g id="node177" class="node">
<title>expert_s0_t2_g5_l5</title>
<polygon fill="lightgreen" stroke="black" points="30426,-1905.86 30168,-1905.86 30168,-1864.86 30426,-1864.86 30426,-1905.86"/>
<text text-anchor="middle" x="30297" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;21 Layer&#45;5 GPU&#45;21</text>
<text text-anchor="middle" x="30297" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30297" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g6 -->
<g id="node178" class="node">
<title>attn_s0_t2_g6</title>
<polygon fill="lightgreen" stroke="black" points="38519.5,-1905.86 38244.5,-1905.86 38244.5,-1864.86 38519.5,-1864.86 38519.5,-1905.86"/>
<text text-anchor="middle" x="38382" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;22</text>
<text text-anchor="middle" x="38382" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g6 -->
<g id="node179" class="node">
<title>gate_s0_t2_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="38647.32,-1828.86 38225.26,-1828.86 38116.68,-1746.86 38538.74,-1746.86 38647.32,-1828.86"/>
<text text-anchor="middle" x="38382" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;22</text>
<text text-anchor="middle" x="38382" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g6&#45;&gt;gate_s0_t2_g6 -->
<g id="edge68" class="edge">
<title>attn_s0_t2_g6&#45;&gt;gate_s0_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-1864.57C38382,-1857.11 38382,-1848.24 38382,-1839.25"/>
<polygon fill="black" stroke="black" points="38385.5,-1839.11 38382,-1829.11 38378.5,-1839.11 38385.5,-1839.11"/>
</g>
<!-- expert_s0_t2_g6_l0 -->
<g id="node180" class="node">
<title>expert_s0_t2_g6_l0</title>
<polygon fill="lightgreen" stroke="black" points="38511,-1710.86 38253,-1710.86 38253,-1669.86 38511,-1669.86 38511,-1710.86"/>
<text text-anchor="middle" x="38382" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;0 GPU&#45;22</text>
<text text-anchor="middle" x="38382" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g6&#45;&gt;expert_s0_t2_g6_l0 -->
<g id="edge69" class="edge">
<title>gate_s0_t2_g6&#45;&gt;expert_s0_t2_g6_l0</title>
<path fill="none" stroke="black" d="M38382,-1746.64C38382,-1738.06 38382,-1729.15 38382,-1721.05"/>
<polygon fill="black" stroke="black" points="38385.5,-1720.97 38382,-1710.97 38378.5,-1720.97 38385.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g6 -->
<g id="node280" class="node">
<title>comm_s0_t2_g6</title>
<ellipse fill="lightblue" stroke="black" cx="38382" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="38382" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;22</text>
<text text-anchor="middle" x="38382" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g6_l0&#45;&gt;comm_s0_t2_g6 -->
<g id="edge70" class="edge">
<title>expert_s0_t2_g6_l0&#45;&gt;comm_s0_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-1669.58C38382,-1661.95 38382,-1652.96 38382,-1644.17"/>
<polygon fill="black" stroke="black" points="38385.5,-1644.05 38382,-1634.05 38378.5,-1644.05 38385.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g6_l1 -->
<g id="node181" class="node">
<title>expert_s0_t2_g6_l1</title>
<polygon fill="lightgreen" stroke="black" points="29856,-1905.86 29598,-1905.86 29598,-1864.86 29856,-1864.86 29856,-1905.86"/>
<text text-anchor="middle" x="29727" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;1 GPU&#45;22</text>
<text text-anchor="middle" x="29727" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29727" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g6_l2 -->
<g id="node182" class="node">
<title>expert_s0_t2_g6_l2</title>
<polygon fill="lightgreen" stroke="black" points="29580,-1905.86 29322,-1905.86 29322,-1864.86 29580,-1864.86 29580,-1905.86"/>
<text text-anchor="middle" x="29451" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;2 GPU&#45;22</text>
<text text-anchor="middle" x="29451" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29451" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g6_l3 -->
<g id="node183" class="node">
<title>expert_s0_t2_g6_l3</title>
<polygon fill="lightgreen" stroke="black" points="29304,-1905.86 29046,-1905.86 29046,-1864.86 29304,-1864.86 29304,-1905.86"/>
<text text-anchor="middle" x="29175" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;3 GPU&#45;22</text>
<text text-anchor="middle" x="29175" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29175" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g6_l4 -->
<g id="node184" class="node">
<title>expert_s0_t2_g6_l4</title>
<polygon fill="lightgreen" stroke="black" points="29028,-1905.86 28770,-1905.86 28770,-1864.86 29028,-1864.86 29028,-1905.86"/>
<text text-anchor="middle" x="28899" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;4 GPU&#45;22</text>
<text text-anchor="middle" x="28899" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28899" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g6_l5 -->
<g id="node185" class="node">
<title>expert_s0_t2_g6_l5</title>
<polygon fill="lightgreen" stroke="black" points="28752,-1905.86 28494,-1905.86 28494,-1864.86 28752,-1864.86 28752,-1905.86"/>
<text text-anchor="middle" x="28623" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;22 Layer&#45;5 GPU&#45;22</text>
<text text-anchor="middle" x="28623" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28623" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t2_g7 -->
<g id="node186" class="node">
<title>attn_s0_t2_g7</title>
<polygon fill="lightgreen" stroke="black" points="40193.5,-1905.86 39918.5,-1905.86 39918.5,-1864.86 40193.5,-1864.86 40193.5,-1905.86"/>
<text text-anchor="middle" x="40056" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;23</text>
<text text-anchor="middle" x="40056" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="40056" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t2_g7 -->
<g id="node187" class="node">
<title>gate_s0_t2_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="40194.32,-1828.86 39772.26,-1828.86 39663.68,-1746.86 40085.74,-1746.86 40194.32,-1828.86"/>
<text text-anchor="middle" x="39929" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;23</text>
<text text-anchor="middle" x="39929" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t2_g7&#45;&gt;gate_s0_t2_g7 -->
<g id="edge71" class="edge">
<title>attn_s0_t2_g7&#45;&gt;gate_s0_t2_g7</title>
<path fill="none" stroke="black" d="M40029.99,-1864.81C40018.47,-1856.14 40004.37,-1845.54 39990.41,-1835.04"/>
<polygon fill="black" stroke="black" points="39992.33,-1832.1 39982.23,-1828.89 39988.12,-1837.7 39992.33,-1832.1"/>
</g>
<!-- expert_s0_t2_g7_l0 -->
<g id="node188" class="node">
<title>expert_s0_t2_g7_l0</title>
<polygon fill="lightgreen" stroke="black" points="40058,-1710.86 39800,-1710.86 39800,-1669.86 40058,-1669.86 40058,-1710.86"/>
<text text-anchor="middle" x="39929" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;0 GPU&#45;23</text>
<text text-anchor="middle" x="39929" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t2_g7&#45;&gt;expert_s0_t2_g7_l0 -->
<g id="edge72" class="edge">
<title>gate_s0_t2_g7&#45;&gt;expert_s0_t2_g7_l0</title>
<path fill="none" stroke="black" d="M39929,-1746.64C39929,-1738.06 39929,-1729.15 39929,-1721.05"/>
<polygon fill="black" stroke="black" points="39932.5,-1720.97 39929,-1710.97 39925.5,-1720.97 39932.5,-1720.97"/>
</g>
<!-- comm_s0_t2_g7 -->
<g id="node281" class="node">
<title>comm_s0_t2_g7</title>
<ellipse fill="lightblue" stroke="black" cx="39929" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="39929" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;23</text>
<text text-anchor="middle" x="39929" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="39929" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t2_g7_l0&#45;&gt;comm_s0_t2_g7 -->
<g id="edge73" class="edge">
<title>expert_s0_t2_g7_l0&#45;&gt;comm_s0_t2_g7</title>
<path fill="none" stroke="black" d="M39929,-1669.58C39929,-1661.95 39929,-1652.96 39929,-1644.17"/>
<polygon fill="black" stroke="black" points="39932.5,-1644.05 39929,-1634.05 39925.5,-1644.05 39932.5,-1644.05"/>
</g>
<!-- expert_s0_t2_g7_l1 -->
<g id="node189" class="node">
<title>expert_s0_t2_g7_l1</title>
<polygon fill="lightgreen" stroke="black" points="28182,-1905.86 27924,-1905.86 27924,-1864.86 28182,-1864.86 28182,-1905.86"/>
<text text-anchor="middle" x="28053" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;1 GPU&#45;23</text>
<text text-anchor="middle" x="28053" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28053" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g7_l2 -->
<g id="node190" class="node">
<title>expert_s0_t2_g7_l2</title>
<polygon fill="lightgreen" stroke="black" points="27906,-1905.86 27648,-1905.86 27648,-1864.86 27906,-1864.86 27906,-1905.86"/>
<text text-anchor="middle" x="27777" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;2 GPU&#45;23</text>
<text text-anchor="middle" x="27777" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27777" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g7_l3 -->
<g id="node191" class="node">
<title>expert_s0_t2_g7_l3</title>
<polygon fill="lightgreen" stroke="black" points="27630,-1905.86 27372,-1905.86 27372,-1864.86 27630,-1864.86 27630,-1905.86"/>
<text text-anchor="middle" x="27501" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;3 GPU&#45;23</text>
<text text-anchor="middle" x="27501" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27501" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g7_l4 -->
<g id="node192" class="node">
<title>expert_s0_t2_g7_l4</title>
<polygon fill="lightgreen" stroke="black" points="27354,-1905.86 27096,-1905.86 27096,-1864.86 27354,-1864.86 27354,-1905.86"/>
<text text-anchor="middle" x="27225" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;4 GPU&#45;23</text>
<text text-anchor="middle" x="27225" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27225" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t2_g7_l5 -->
<g id="node193" class="node">
<title>expert_s0_t2_g7_l5</title>
<polygon fill="lightgreen" stroke="black" points="27078,-1905.86 26820,-1905.86 26820,-1864.86 27078,-1864.86 27078,-1905.86"/>
<text text-anchor="middle" x="26949" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;23 Layer&#45;5 GPU&#45;23</text>
<text text-anchor="middle" x="26949" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26949" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g0 -->
<g id="node194" class="node">
<title>attn_s0_t3_g0</title>
<polygon fill="lightgreen" stroke="black" points="41873.5,-1905.86 41598.5,-1905.86 41598.5,-1864.86 41873.5,-1864.86 41873.5,-1905.86"/>
<text text-anchor="middle" x="41736" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;24</text>
<text text-anchor="middle" x="41736" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g0 -->
<g id="node195" class="node">
<title>gate_s0_t3_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="42001.32,-1828.86 41579.26,-1828.86 41470.68,-1746.86 41892.74,-1746.86 42001.32,-1828.86"/>
<text text-anchor="middle" x="41736" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;24</text>
<text text-anchor="middle" x="41736" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g0&#45;&gt;gate_s0_t3_g0 -->
<g id="edge74" class="edge">
<title>attn_s0_t3_g0&#45;&gt;gate_s0_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-1864.57C41736,-1857.11 41736,-1848.24 41736,-1839.25"/>
<polygon fill="black" stroke="black" points="41739.5,-1839.11 41736,-1829.11 41732.5,-1839.11 41739.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g0_l0 -->
<g id="node196" class="node">
<title>expert_s0_t3_g0_l0</title>
<polygon fill="lightgreen" stroke="black" points="41865,-1710.86 41607,-1710.86 41607,-1669.86 41865,-1669.86 41865,-1710.86"/>
<text text-anchor="middle" x="41736" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;0 GPU&#45;24</text>
<text text-anchor="middle" x="41736" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g0&#45;&gt;expert_s0_t3_g0_l0 -->
<g id="edge75" class="edge">
<title>gate_s0_t3_g0&#45;&gt;expert_s0_t3_g0_l0</title>
<path fill="none" stroke="black" d="M41736,-1746.64C41736,-1738.06 41736,-1729.15 41736,-1721.05"/>
<polygon fill="black" stroke="black" points="41739.5,-1720.97 41736,-1710.97 41732.5,-1720.97 41739.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g0 -->
<g id="node282" class="node">
<title>comm_s0_t3_g0</title>
<ellipse fill="lightblue" stroke="black" cx="41736" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="41736" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;24</text>
<text text-anchor="middle" x="41736" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g0_l0&#45;&gt;comm_s0_t3_g0 -->
<g id="edge76" class="edge">
<title>expert_s0_t3_g0_l0&#45;&gt;comm_s0_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-1669.58C41736,-1661.95 41736,-1652.96 41736,-1644.17"/>
<polygon fill="black" stroke="black" points="41739.5,-1644.05 41736,-1634.05 41732.5,-1644.05 41739.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g0_l1 -->
<g id="node197" class="node">
<title>expert_s0_t3_g0_l1</title>
<polygon fill="lightgreen" stroke="black" points="53298,-1905.86 53040,-1905.86 53040,-1864.86 53298,-1864.86 53298,-1905.86"/>
<text text-anchor="middle" x="53169" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;1 GPU&#45;24</text>
<text text-anchor="middle" x="53169" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53169" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g0_l2 -->
<g id="node198" class="node">
<title>expert_s0_t3_g0_l2</title>
<polygon fill="lightgreen" stroke="black" points="53022,-1905.86 52764,-1905.86 52764,-1864.86 53022,-1864.86 53022,-1905.86"/>
<text text-anchor="middle" x="52893" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;2 GPU&#45;24</text>
<text text-anchor="middle" x="52893" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52893" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g0_l3 -->
<g id="node199" class="node">
<title>expert_s0_t3_g0_l3</title>
<polygon fill="lightgreen" stroke="black" points="52746,-1905.86 52488,-1905.86 52488,-1864.86 52746,-1864.86 52746,-1905.86"/>
<text text-anchor="middle" x="52617" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;3 GPU&#45;24</text>
<text text-anchor="middle" x="52617" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52617" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g0_l4 -->
<g id="node200" class="node">
<title>expert_s0_t3_g0_l4</title>
<polygon fill="lightgreen" stroke="black" points="52470,-1905.86 52212,-1905.86 52212,-1864.86 52470,-1864.86 52470,-1905.86"/>
<text text-anchor="middle" x="52341" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;4 GPU&#45;24</text>
<text text-anchor="middle" x="52341" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52341" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g0_l5 -->
<g id="node201" class="node">
<title>expert_s0_t3_g0_l5</title>
<polygon fill="lightgreen" stroke="black" points="52194,-1905.86 51936,-1905.86 51936,-1864.86 52194,-1864.86 52194,-1905.86"/>
<text text-anchor="middle" x="52065" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;24 Layer&#45;5 GPU&#45;24</text>
<text text-anchor="middle" x="52065" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52065" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g1 -->
<g id="node202" class="node">
<title>attn_s0_t3_g1</title>
<polygon fill="lightgreen" stroke="black" points="43547.5,-1905.86 43272.5,-1905.86 43272.5,-1864.86 43547.5,-1864.86 43547.5,-1905.86"/>
<text text-anchor="middle" x="43410" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;25</text>
<text text-anchor="middle" x="43410" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g1 -->
<g id="node203" class="node">
<title>gate_s0_t3_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="43675.32,-1828.86 43253.26,-1828.86 43144.68,-1746.86 43566.74,-1746.86 43675.32,-1828.86"/>
<text text-anchor="middle" x="43410" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;25</text>
<text text-anchor="middle" x="43410" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g1&#45;&gt;gate_s0_t3_g1 -->
<g id="edge77" class="edge">
<title>attn_s0_t3_g1&#45;&gt;gate_s0_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-1864.57C43410,-1857.11 43410,-1848.24 43410,-1839.25"/>
<polygon fill="black" stroke="black" points="43413.5,-1839.11 43410,-1829.11 43406.5,-1839.11 43413.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g1_l0 -->
<g id="node204" class="node">
<title>expert_s0_t3_g1_l0</title>
<polygon fill="lightgreen" stroke="black" points="43539,-1710.86 43281,-1710.86 43281,-1669.86 43539,-1669.86 43539,-1710.86"/>
<text text-anchor="middle" x="43410" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;0 GPU&#45;25</text>
<text text-anchor="middle" x="43410" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g1&#45;&gt;expert_s0_t3_g1_l0 -->
<g id="edge78" class="edge">
<title>gate_s0_t3_g1&#45;&gt;expert_s0_t3_g1_l0</title>
<path fill="none" stroke="black" d="M43410,-1746.64C43410,-1738.06 43410,-1729.15 43410,-1721.05"/>
<polygon fill="black" stroke="black" points="43413.5,-1720.97 43410,-1710.97 43406.5,-1720.97 43413.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g1 -->
<g id="node283" class="node">
<title>comm_s0_t3_g1</title>
<ellipse fill="lightblue" stroke="black" cx="43410" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="43410" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;25</text>
<text text-anchor="middle" x="43410" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g1_l0&#45;&gt;comm_s0_t3_g1 -->
<g id="edge79" class="edge">
<title>expert_s0_t3_g1_l0&#45;&gt;comm_s0_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-1669.58C43410,-1661.95 43410,-1652.96 43410,-1644.17"/>
<polygon fill="black" stroke="black" points="43413.5,-1644.05 43410,-1634.05 43406.5,-1644.05 43413.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g1_l1 -->
<g id="node205" class="node">
<title>expert_s0_t3_g1_l1</title>
<polygon fill="lightgreen" stroke="black" points="51624,-1905.86 51366,-1905.86 51366,-1864.86 51624,-1864.86 51624,-1905.86"/>
<text text-anchor="middle" x="51495" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;1 GPU&#45;25</text>
<text text-anchor="middle" x="51495" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51495" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g1_l2 -->
<g id="node206" class="node">
<title>expert_s0_t3_g1_l2</title>
<polygon fill="lightgreen" stroke="black" points="51348,-1905.86 51090,-1905.86 51090,-1864.86 51348,-1864.86 51348,-1905.86"/>
<text text-anchor="middle" x="51219" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;2 GPU&#45;25</text>
<text text-anchor="middle" x="51219" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51219" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g1_l3 -->
<g id="node207" class="node">
<title>expert_s0_t3_g1_l3</title>
<polygon fill="lightgreen" stroke="black" points="51072,-1905.86 50814,-1905.86 50814,-1864.86 51072,-1864.86 51072,-1905.86"/>
<text text-anchor="middle" x="50943" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;3 GPU&#45;25</text>
<text text-anchor="middle" x="50943" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50943" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g1_l4 -->
<g id="node208" class="node">
<title>expert_s0_t3_g1_l4</title>
<polygon fill="lightgreen" stroke="black" points="50796,-1905.86 50538,-1905.86 50538,-1864.86 50796,-1864.86 50796,-1905.86"/>
<text text-anchor="middle" x="50667" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;4 GPU&#45;25</text>
<text text-anchor="middle" x="50667" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50667" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g1_l5 -->
<g id="node209" class="node">
<title>expert_s0_t3_g1_l5</title>
<polygon fill="lightgreen" stroke="black" points="50520,-1905.86 50262,-1905.86 50262,-1864.86 50520,-1864.86 50520,-1905.86"/>
<text text-anchor="middle" x="50391" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;25 Layer&#45;5 GPU&#45;25</text>
<text text-anchor="middle" x="50391" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50391" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g2 -->
<g id="node210" class="node">
<title>attn_s0_t3_g2</title>
<polygon fill="lightgreen" stroke="black" points="45221.5,-1905.86 44946.5,-1905.86 44946.5,-1864.86 45221.5,-1864.86 45221.5,-1905.86"/>
<text text-anchor="middle" x="45084" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;26</text>
<text text-anchor="middle" x="45084" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g2 -->
<g id="node211" class="node">
<title>gate_s0_t3_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="45349.32,-1828.86 44927.26,-1828.86 44818.68,-1746.86 45240.74,-1746.86 45349.32,-1828.86"/>
<text text-anchor="middle" x="45084" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;26</text>
<text text-anchor="middle" x="45084" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g2&#45;&gt;gate_s0_t3_g2 -->
<g id="edge80" class="edge">
<title>attn_s0_t3_g2&#45;&gt;gate_s0_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-1864.57C45084,-1857.11 45084,-1848.24 45084,-1839.25"/>
<polygon fill="black" stroke="black" points="45087.5,-1839.11 45084,-1829.11 45080.5,-1839.11 45087.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g2_l0 -->
<g id="node212" class="node">
<title>expert_s0_t3_g2_l0</title>
<polygon fill="lightgreen" stroke="black" points="45213,-1710.86 44955,-1710.86 44955,-1669.86 45213,-1669.86 45213,-1710.86"/>
<text text-anchor="middle" x="45084" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;0 GPU&#45;26</text>
<text text-anchor="middle" x="45084" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g2&#45;&gt;expert_s0_t3_g2_l0 -->
<g id="edge81" class="edge">
<title>gate_s0_t3_g2&#45;&gt;expert_s0_t3_g2_l0</title>
<path fill="none" stroke="black" d="M45084,-1746.64C45084,-1738.06 45084,-1729.15 45084,-1721.05"/>
<polygon fill="black" stroke="black" points="45087.5,-1720.97 45084,-1710.97 45080.5,-1720.97 45087.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g2 -->
<g id="node284" class="node">
<title>comm_s0_t3_g2</title>
<ellipse fill="lightblue" stroke="black" cx="45084" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="45084" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;26</text>
<text text-anchor="middle" x="45084" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g2_l0&#45;&gt;comm_s0_t3_g2 -->
<g id="edge82" class="edge">
<title>expert_s0_t3_g2_l0&#45;&gt;comm_s0_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-1669.58C45084,-1661.95 45084,-1652.96 45084,-1644.17"/>
<polygon fill="black" stroke="black" points="45087.5,-1644.05 45084,-1634.05 45080.5,-1644.05 45087.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g2_l1 -->
<g id="node213" class="node">
<title>expert_s0_t3_g2_l1</title>
<polygon fill="lightgreen" stroke="black" points="49950,-1905.86 49692,-1905.86 49692,-1864.86 49950,-1864.86 49950,-1905.86"/>
<text text-anchor="middle" x="49821" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;1 GPU&#45;26</text>
<text text-anchor="middle" x="49821" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49821" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g2_l2 -->
<g id="node214" class="node">
<title>expert_s0_t3_g2_l2</title>
<polygon fill="lightgreen" stroke="black" points="49674,-1905.86 49416,-1905.86 49416,-1864.86 49674,-1864.86 49674,-1905.86"/>
<text text-anchor="middle" x="49545" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;2 GPU&#45;26</text>
<text text-anchor="middle" x="49545" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49545" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g2_l3 -->
<g id="node215" class="node">
<title>expert_s0_t3_g2_l3</title>
<polygon fill="lightgreen" stroke="black" points="49398,-1905.86 49140,-1905.86 49140,-1864.86 49398,-1864.86 49398,-1905.86"/>
<text text-anchor="middle" x="49269" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;3 GPU&#45;26</text>
<text text-anchor="middle" x="49269" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49269" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g2_l4 -->
<g id="node216" class="node">
<title>expert_s0_t3_g2_l4</title>
<polygon fill="lightgreen" stroke="black" points="49122,-1905.86 48864,-1905.86 48864,-1864.86 49122,-1864.86 49122,-1905.86"/>
<text text-anchor="middle" x="48993" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;4 GPU&#45;26</text>
<text text-anchor="middle" x="48993" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48993" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g2_l5 -->
<g id="node217" class="node">
<title>expert_s0_t3_g2_l5</title>
<polygon fill="lightgreen" stroke="black" points="48846,-1905.86 48588,-1905.86 48588,-1864.86 48846,-1864.86 48846,-1905.86"/>
<text text-anchor="middle" x="48717" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;26 Layer&#45;5 GPU&#45;26</text>
<text text-anchor="middle" x="48717" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48717" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g3 -->
<g id="node218" class="node">
<title>attn_s0_t3_g3</title>
<polygon fill="lightgreen" stroke="black" points="46895.5,-1905.86 46620.5,-1905.86 46620.5,-1864.86 46895.5,-1864.86 46895.5,-1905.86"/>
<text text-anchor="middle" x="46758" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;27</text>
<text text-anchor="middle" x="46758" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g3 -->
<g id="node219" class="node">
<title>gate_s0_t3_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="47023.32,-1828.86 46601.26,-1828.86 46492.68,-1746.86 46914.74,-1746.86 47023.32,-1828.86"/>
<text text-anchor="middle" x="46758" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;27</text>
<text text-anchor="middle" x="46758" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g3&#45;&gt;gate_s0_t3_g3 -->
<g id="edge83" class="edge">
<title>attn_s0_t3_g3&#45;&gt;gate_s0_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-1864.57C46758,-1857.11 46758,-1848.24 46758,-1839.25"/>
<polygon fill="black" stroke="black" points="46761.5,-1839.11 46758,-1829.11 46754.5,-1839.11 46761.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g3_l0 -->
<g id="node220" class="node">
<title>expert_s0_t3_g3_l0</title>
<polygon fill="lightgreen" stroke="black" points="46887,-1710.86 46629,-1710.86 46629,-1669.86 46887,-1669.86 46887,-1710.86"/>
<text text-anchor="middle" x="46758" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;0 GPU&#45;27</text>
<text text-anchor="middle" x="46758" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g3&#45;&gt;expert_s0_t3_g3_l0 -->
<g id="edge84" class="edge">
<title>gate_s0_t3_g3&#45;&gt;expert_s0_t3_g3_l0</title>
<path fill="none" stroke="black" d="M46758,-1746.64C46758,-1738.06 46758,-1729.15 46758,-1721.05"/>
<polygon fill="black" stroke="black" points="46761.5,-1720.97 46758,-1710.97 46754.5,-1720.97 46761.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g3 -->
<g id="node285" class="node">
<title>comm_s0_t3_g3</title>
<ellipse fill="lightblue" stroke="black" cx="46758" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="46758" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;27</text>
<text text-anchor="middle" x="46758" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g3_l0&#45;&gt;comm_s0_t3_g3 -->
<g id="edge85" class="edge">
<title>expert_s0_t3_g3_l0&#45;&gt;comm_s0_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-1669.58C46758,-1661.95 46758,-1652.96 46758,-1644.17"/>
<polygon fill="black" stroke="black" points="46761.5,-1644.05 46758,-1634.05 46754.5,-1644.05 46761.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g3_l1 -->
<g id="node221" class="node">
<title>expert_s0_t3_g3_l1</title>
<polygon fill="lightgreen" stroke="black" points="48276,-1905.86 48018,-1905.86 48018,-1864.86 48276,-1864.86 48276,-1905.86"/>
<text text-anchor="middle" x="48147" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;1 GPU&#45;27</text>
<text text-anchor="middle" x="48147" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48147" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g3_l2 -->
<g id="node222" class="node">
<title>expert_s0_t3_g3_l2</title>
<polygon fill="lightgreen" stroke="black" points="48000,-1905.86 47742,-1905.86 47742,-1864.86 48000,-1864.86 48000,-1905.86"/>
<text text-anchor="middle" x="47871" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;2 GPU&#45;27</text>
<text text-anchor="middle" x="47871" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47871" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g3_l3 -->
<g id="node223" class="node">
<title>expert_s0_t3_g3_l3</title>
<polygon fill="lightgreen" stroke="black" points="47724,-1905.86 47466,-1905.86 47466,-1864.86 47724,-1864.86 47724,-1905.86"/>
<text text-anchor="middle" x="47595" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;3 GPU&#45;27</text>
<text text-anchor="middle" x="47595" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47595" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g3_l4 -->
<g id="node224" class="node">
<title>expert_s0_t3_g3_l4</title>
<polygon fill="lightgreen" stroke="black" points="47448,-1905.86 47190,-1905.86 47190,-1864.86 47448,-1864.86 47448,-1905.86"/>
<text text-anchor="middle" x="47319" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;4 GPU&#45;27</text>
<text text-anchor="middle" x="47319" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47319" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g3_l5 -->
<g id="node225" class="node">
<title>expert_s0_t3_g3_l5</title>
<polygon fill="lightgreen" stroke="black" points="47172,-1905.86 46914,-1905.86 46914,-1864.86 47172,-1864.86 47172,-1905.86"/>
<text text-anchor="middle" x="47043" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;27 Layer&#45;5 GPU&#45;27</text>
<text text-anchor="middle" x="47043" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47043" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g4 -->
<g id="node226" class="node">
<title>attn_s0_t3_g4</title>
<polygon fill="lightgreen" stroke="black" points="48569.5,-1905.86 48294.5,-1905.86 48294.5,-1864.86 48569.5,-1864.86 48569.5,-1905.86"/>
<text text-anchor="middle" x="48432" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;28</text>
<text text-anchor="middle" x="48432" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g4 -->
<g id="node227" class="node">
<title>gate_s0_t3_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="48697.32,-1828.86 48275.26,-1828.86 48166.68,-1746.86 48588.74,-1746.86 48697.32,-1828.86"/>
<text text-anchor="middle" x="48432" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;28</text>
<text text-anchor="middle" x="48432" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g4&#45;&gt;gate_s0_t3_g4 -->
<g id="edge86" class="edge">
<title>attn_s0_t3_g4&#45;&gt;gate_s0_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-1864.57C48432,-1857.11 48432,-1848.24 48432,-1839.25"/>
<polygon fill="black" stroke="black" points="48435.5,-1839.11 48432,-1829.11 48428.5,-1839.11 48435.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g4_l0 -->
<g id="node228" class="node">
<title>expert_s0_t3_g4_l0</title>
<polygon fill="lightgreen" stroke="black" points="48561,-1710.86 48303,-1710.86 48303,-1669.86 48561,-1669.86 48561,-1710.86"/>
<text text-anchor="middle" x="48432" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;0 GPU&#45;28</text>
<text text-anchor="middle" x="48432" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g4&#45;&gt;expert_s0_t3_g4_l0 -->
<g id="edge87" class="edge">
<title>gate_s0_t3_g4&#45;&gt;expert_s0_t3_g4_l0</title>
<path fill="none" stroke="black" d="M48432,-1746.64C48432,-1738.06 48432,-1729.15 48432,-1721.05"/>
<polygon fill="black" stroke="black" points="48435.5,-1720.97 48432,-1710.97 48428.5,-1720.97 48435.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g4 -->
<g id="node286" class="node">
<title>comm_s0_t3_g4</title>
<ellipse fill="lightblue" stroke="black" cx="48432" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="48432" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;28</text>
<text text-anchor="middle" x="48432" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g4_l0&#45;&gt;comm_s0_t3_g4 -->
<g id="edge88" class="edge">
<title>expert_s0_t3_g4_l0&#45;&gt;comm_s0_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-1669.58C48432,-1661.95 48432,-1652.96 48432,-1644.17"/>
<polygon fill="black" stroke="black" points="48435.5,-1644.05 48432,-1634.05 48428.5,-1644.05 48435.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g4_l1 -->
<g id="node229" class="node">
<title>expert_s0_t3_g4_l1</title>
<polygon fill="lightgreen" stroke="black" points="46602,-1905.86 46344,-1905.86 46344,-1864.86 46602,-1864.86 46602,-1905.86"/>
<text text-anchor="middle" x="46473" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;1 GPU&#45;28</text>
<text text-anchor="middle" x="46473" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46473" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g4_l2 -->
<g id="node230" class="node">
<title>expert_s0_t3_g4_l2</title>
<polygon fill="lightgreen" stroke="black" points="46326,-1905.86 46068,-1905.86 46068,-1864.86 46326,-1864.86 46326,-1905.86"/>
<text text-anchor="middle" x="46197" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;2 GPU&#45;28</text>
<text text-anchor="middle" x="46197" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46197" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g4_l3 -->
<g id="node231" class="node">
<title>expert_s0_t3_g4_l3</title>
<polygon fill="lightgreen" stroke="black" points="46050,-1905.86 45792,-1905.86 45792,-1864.86 46050,-1864.86 46050,-1905.86"/>
<text text-anchor="middle" x="45921" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;3 GPU&#45;28</text>
<text text-anchor="middle" x="45921" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45921" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g4_l4 -->
<g id="node232" class="node">
<title>expert_s0_t3_g4_l4</title>
<polygon fill="lightgreen" stroke="black" points="45774,-1905.86 45516,-1905.86 45516,-1864.86 45774,-1864.86 45774,-1905.86"/>
<text text-anchor="middle" x="45645" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;4 GPU&#45;28</text>
<text text-anchor="middle" x="45645" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45645" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g4_l5 -->
<g id="node233" class="node">
<title>expert_s0_t3_g4_l5</title>
<polygon fill="lightgreen" stroke="black" points="45498,-1905.86 45240,-1905.86 45240,-1864.86 45498,-1864.86 45498,-1905.86"/>
<text text-anchor="middle" x="45369" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;28 Layer&#45;5 GPU&#45;28</text>
<text text-anchor="middle" x="45369" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45369" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g5 -->
<g id="node234" class="node">
<title>attn_s0_t3_g5</title>
<polygon fill="lightgreen" stroke="black" points="50243.5,-1905.86 49968.5,-1905.86 49968.5,-1864.86 50243.5,-1864.86 50243.5,-1905.86"/>
<text text-anchor="middle" x="50106" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;29</text>
<text text-anchor="middle" x="50106" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g5 -->
<g id="node235" class="node">
<title>gate_s0_t3_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="50371.32,-1828.86 49949.26,-1828.86 49840.68,-1746.86 50262.74,-1746.86 50371.32,-1828.86"/>
<text text-anchor="middle" x="50106" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;29</text>
<text text-anchor="middle" x="50106" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g5&#45;&gt;gate_s0_t3_g5 -->
<g id="edge89" class="edge">
<title>attn_s0_t3_g5&#45;&gt;gate_s0_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-1864.57C50106,-1857.11 50106,-1848.24 50106,-1839.25"/>
<polygon fill="black" stroke="black" points="50109.5,-1839.11 50106,-1829.11 50102.5,-1839.11 50109.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g5_l0 -->
<g id="node236" class="node">
<title>expert_s0_t3_g5_l0</title>
<polygon fill="lightgreen" stroke="black" points="50235,-1710.86 49977,-1710.86 49977,-1669.86 50235,-1669.86 50235,-1710.86"/>
<text text-anchor="middle" x="50106" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;0 GPU&#45;29</text>
<text text-anchor="middle" x="50106" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g5&#45;&gt;expert_s0_t3_g5_l0 -->
<g id="edge90" class="edge">
<title>gate_s0_t3_g5&#45;&gt;expert_s0_t3_g5_l0</title>
<path fill="none" stroke="black" d="M50106,-1746.64C50106,-1738.06 50106,-1729.15 50106,-1721.05"/>
<polygon fill="black" stroke="black" points="50109.5,-1720.97 50106,-1710.97 50102.5,-1720.97 50109.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g5 -->
<g id="node287" class="node">
<title>comm_s0_t3_g5</title>
<ellipse fill="lightblue" stroke="black" cx="50106" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="50106" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;29</text>
<text text-anchor="middle" x="50106" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g5_l0&#45;&gt;comm_s0_t3_g5 -->
<g id="edge91" class="edge">
<title>expert_s0_t3_g5_l0&#45;&gt;comm_s0_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-1669.58C50106,-1661.95 50106,-1652.96 50106,-1644.17"/>
<polygon fill="black" stroke="black" points="50109.5,-1644.05 50106,-1634.05 50102.5,-1644.05 50109.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g5_l1 -->
<g id="node237" class="node">
<title>expert_s0_t3_g5_l1</title>
<polygon fill="lightgreen" stroke="black" points="44928,-1905.86 44670,-1905.86 44670,-1864.86 44928,-1864.86 44928,-1905.86"/>
<text text-anchor="middle" x="44799" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;1 GPU&#45;29</text>
<text text-anchor="middle" x="44799" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44799" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g5_l2 -->
<g id="node238" class="node">
<title>expert_s0_t3_g5_l2</title>
<polygon fill="lightgreen" stroke="black" points="44652,-1905.86 44394,-1905.86 44394,-1864.86 44652,-1864.86 44652,-1905.86"/>
<text text-anchor="middle" x="44523" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;2 GPU&#45;29</text>
<text text-anchor="middle" x="44523" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44523" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g5_l3 -->
<g id="node239" class="node">
<title>expert_s0_t3_g5_l3</title>
<polygon fill="lightgreen" stroke="black" points="44376,-1905.86 44118,-1905.86 44118,-1864.86 44376,-1864.86 44376,-1905.86"/>
<text text-anchor="middle" x="44247" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;3 GPU&#45;29</text>
<text text-anchor="middle" x="44247" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44247" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g5_l4 -->
<g id="node240" class="node">
<title>expert_s0_t3_g5_l4</title>
<polygon fill="lightgreen" stroke="black" points="44100,-1905.86 43842,-1905.86 43842,-1864.86 44100,-1864.86 44100,-1905.86"/>
<text text-anchor="middle" x="43971" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;4 GPU&#45;29</text>
<text text-anchor="middle" x="43971" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43971" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g5_l5 -->
<g id="node241" class="node">
<title>expert_s0_t3_g5_l5</title>
<polygon fill="lightgreen" stroke="black" points="43824,-1905.86 43566,-1905.86 43566,-1864.86 43824,-1864.86 43824,-1905.86"/>
<text text-anchor="middle" x="43695" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;29 Layer&#45;5 GPU&#45;29</text>
<text text-anchor="middle" x="43695" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43695" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g6 -->
<g id="node242" class="node">
<title>attn_s0_t3_g6</title>
<polygon fill="lightgreen" stroke="black" points="51917.5,-1905.86 51642.5,-1905.86 51642.5,-1864.86 51917.5,-1864.86 51917.5,-1905.86"/>
<text text-anchor="middle" x="51780" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;30</text>
<text text-anchor="middle" x="51780" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g6 -->
<g id="node243" class="node">
<title>gate_s0_t3_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="52045.32,-1828.86 51623.26,-1828.86 51514.68,-1746.86 51936.74,-1746.86 52045.32,-1828.86"/>
<text text-anchor="middle" x="51780" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;30</text>
<text text-anchor="middle" x="51780" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g6&#45;&gt;gate_s0_t3_g6 -->
<g id="edge92" class="edge">
<title>attn_s0_t3_g6&#45;&gt;gate_s0_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-1864.57C51780,-1857.11 51780,-1848.24 51780,-1839.25"/>
<polygon fill="black" stroke="black" points="51783.5,-1839.11 51780,-1829.11 51776.5,-1839.11 51783.5,-1839.11"/>
</g>
<!-- expert_s0_t3_g6_l0 -->
<g id="node244" class="node">
<title>expert_s0_t3_g6_l0</title>
<polygon fill="lightgreen" stroke="black" points="51909,-1710.86 51651,-1710.86 51651,-1669.86 51909,-1669.86 51909,-1710.86"/>
<text text-anchor="middle" x="51780" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;0 GPU&#45;30</text>
<text text-anchor="middle" x="51780" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g6&#45;&gt;expert_s0_t3_g6_l0 -->
<g id="edge93" class="edge">
<title>gate_s0_t3_g6&#45;&gt;expert_s0_t3_g6_l0</title>
<path fill="none" stroke="black" d="M51780,-1746.64C51780,-1738.06 51780,-1729.15 51780,-1721.05"/>
<polygon fill="black" stroke="black" points="51783.5,-1720.97 51780,-1710.97 51776.5,-1720.97 51783.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g6 -->
<g id="node288" class="node">
<title>comm_s0_t3_g6</title>
<ellipse fill="lightblue" stroke="black" cx="51780" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="51780" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;30</text>
<text text-anchor="middle" x="51780" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g6_l0&#45;&gt;comm_s0_t3_g6 -->
<g id="edge94" class="edge">
<title>expert_s0_t3_g6_l0&#45;&gt;comm_s0_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-1669.58C51780,-1661.95 51780,-1652.96 51780,-1644.17"/>
<polygon fill="black" stroke="black" points="51783.5,-1644.05 51780,-1634.05 51776.5,-1644.05 51783.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g6_l1 -->
<g id="node245" class="node">
<title>expert_s0_t3_g6_l1</title>
<polygon fill="lightgreen" stroke="black" points="43254,-1905.86 42996,-1905.86 42996,-1864.86 43254,-1864.86 43254,-1905.86"/>
<text text-anchor="middle" x="43125" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;1 GPU&#45;30</text>
<text text-anchor="middle" x="43125" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43125" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g6_l2 -->
<g id="node246" class="node">
<title>expert_s0_t3_g6_l2</title>
<polygon fill="lightgreen" stroke="black" points="42978,-1905.86 42720,-1905.86 42720,-1864.86 42978,-1864.86 42978,-1905.86"/>
<text text-anchor="middle" x="42849" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;2 GPU&#45;30</text>
<text text-anchor="middle" x="42849" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42849" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g6_l3 -->
<g id="node247" class="node">
<title>expert_s0_t3_g6_l3</title>
<polygon fill="lightgreen" stroke="black" points="42702,-1905.86 42444,-1905.86 42444,-1864.86 42702,-1864.86 42702,-1905.86"/>
<text text-anchor="middle" x="42573" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;3 GPU&#45;30</text>
<text text-anchor="middle" x="42573" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42573" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g6_l4 -->
<g id="node248" class="node">
<title>expert_s0_t3_g6_l4</title>
<polygon fill="lightgreen" stroke="black" points="42426,-1905.86 42168,-1905.86 42168,-1864.86 42426,-1864.86 42426,-1905.86"/>
<text text-anchor="middle" x="42297" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;4 GPU&#45;30</text>
<text text-anchor="middle" x="42297" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42297" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g6_l5 -->
<g id="node249" class="node">
<title>expert_s0_t3_g6_l5</title>
<polygon fill="lightgreen" stroke="black" points="42150,-1905.86 41892,-1905.86 41892,-1864.86 42150,-1864.86 42150,-1905.86"/>
<text text-anchor="middle" x="42021" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;30 Layer&#45;5 GPU&#45;30</text>
<text text-anchor="middle" x="42021" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42021" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s0_t3_g7 -->
<g id="node250" class="node">
<title>attn_s0_t3_g7</title>
<polygon fill="lightgreen" stroke="black" points="53591.5,-1905.86 53316.5,-1905.86 53316.5,-1864.86 53591.5,-1864.86 53591.5,-1905.86"/>
<text text-anchor="middle" x="53454" y="-1893.86" font-family="Arial" font-size="10.00">Attention GPU&#45;31</text>
<text text-anchor="middle" x="53454" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53454" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s0_t3_g7 -->
<g id="node251" class="node">
<title>gate_s0_t3_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="53592.32,-1828.86 53170.26,-1828.86 53061.68,-1746.86 53483.74,-1746.86 53592.32,-1828.86"/>
<text text-anchor="middle" x="53327" y="-1796.36" font-family="Arial" font-size="10.00">Gate GPU&#45;31</text>
<text text-anchor="middle" x="53327" y="-1785.36" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-1774.36" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s0_t3_g7&#45;&gt;gate_s0_t3_g7 -->
<g id="edge95" class="edge">
<title>attn_s0_t3_g7&#45;&gt;gate_s0_t3_g7</title>
<path fill="none" stroke="black" d="M53427.99,-1864.81C53416.47,-1856.14 53402.37,-1845.54 53388.41,-1835.04"/>
<polygon fill="black" stroke="black" points="53390.33,-1832.1 53380.23,-1828.89 53386.12,-1837.7 53390.33,-1832.1"/>
</g>
<!-- expert_s0_t3_g7_l0 -->
<g id="node252" class="node">
<title>expert_s0_t3_g7_l0</title>
<polygon fill="lightgreen" stroke="black" points="53456,-1710.86 53198,-1710.86 53198,-1669.86 53456,-1669.86 53456,-1710.86"/>
<text text-anchor="middle" x="53327" y="-1698.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;0 GPU&#45;31</text>
<text text-anchor="middle" x="53327" y="-1687.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-1676.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s0_t3_g7&#45;&gt;expert_s0_t3_g7_l0 -->
<g id="edge96" class="edge">
<title>gate_s0_t3_g7&#45;&gt;expert_s0_t3_g7_l0</title>
<path fill="none" stroke="black" d="M53327,-1746.64C53327,-1738.06 53327,-1729.15 53327,-1721.05"/>
<polygon fill="black" stroke="black" points="53330.5,-1720.97 53327,-1710.97 53323.5,-1720.97 53330.5,-1720.97"/>
</g>
<!-- comm_s0_t3_g7 -->
<g id="node289" class="node">
<title>comm_s0_t3_g7</title>
<ellipse fill="lightblue" stroke="black" cx="53327" cy="-1604.87" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="53327" y="-1613.37" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;31</text>
<text text-anchor="middle" x="53327" y="-1602.37" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53327" y="-1591.37" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s0_t3_g7_l0&#45;&gt;comm_s0_t3_g7 -->
<g id="edge97" class="edge">
<title>expert_s0_t3_g7_l0&#45;&gt;comm_s0_t3_g7</title>
<path fill="none" stroke="black" d="M53327,-1669.58C53327,-1661.95 53327,-1652.96 53327,-1644.17"/>
<polygon fill="black" stroke="black" points="53330.5,-1644.05 53327,-1634.05 53323.5,-1644.05 53330.5,-1644.05"/>
</g>
<!-- expert_s0_t3_g7_l1 -->
<g id="node253" class="node">
<title>expert_s0_t3_g7_l1</title>
<polygon fill="lightgreen" stroke="black" points="41580,-1905.86 41322,-1905.86 41322,-1864.86 41580,-1864.86 41580,-1905.86"/>
<text text-anchor="middle" x="41451" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;1 GPU&#45;31</text>
<text text-anchor="middle" x="41451" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41451" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g7_l2 -->
<g id="node254" class="node">
<title>expert_s0_t3_g7_l2</title>
<polygon fill="lightgreen" stroke="black" points="41304,-1905.86 41046,-1905.86 41046,-1864.86 41304,-1864.86 41304,-1905.86"/>
<text text-anchor="middle" x="41175" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;2 GPU&#45;31</text>
<text text-anchor="middle" x="41175" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41175" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g7_l3 -->
<g id="node255" class="node">
<title>expert_s0_t3_g7_l3</title>
<polygon fill="lightgreen" stroke="black" points="41028,-1905.86 40770,-1905.86 40770,-1864.86 41028,-1864.86 41028,-1905.86"/>
<text text-anchor="middle" x="40899" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;3 GPU&#45;31</text>
<text text-anchor="middle" x="40899" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40899" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g7_l4 -->
<g id="node256" class="node">
<title>expert_s0_t3_g7_l4</title>
<polygon fill="lightgreen" stroke="black" points="40752,-1905.86 40494,-1905.86 40494,-1864.86 40752,-1864.86 40752,-1905.86"/>
<text text-anchor="middle" x="40623" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;4 GPU&#45;31</text>
<text text-anchor="middle" x="40623" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40623" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s0_t3_g7_l5 -->
<g id="node257" class="node">
<title>expert_s0_t3_g7_l5</title>
<polygon fill="lightgreen" stroke="black" points="40476,-1905.86 40218,-1905.86 40218,-1864.86 40476,-1864.86 40476,-1905.86"/>
<text text-anchor="middle" x="40347" y="-1893.86" font-family="Arial" font-size="10.00">Expert&#45;31 Layer&#45;5 GPU&#45;31</text>
<text text-anchor="middle" x="40347" y="-1882.86" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40347" y="-1871.86" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- pipeline_comm_s0 -->
<g id="node1154" class="node">
<title>pipeline_comm_s0</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-1510.89" rx="185.94" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-1519.39" font-family="Arial" font-size="10.00">Pipeline Communication Stage 0&#45;&gt;1</text>
<text text-anchor="middle" x="1542" y="-1508.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="1542" y="-1497.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- comm_s0_t0_g0&#45;&gt;pipeline_comm_s0 -->
<g id="edge98" class="edge">
<title>comm_s0_t0_g0&#45;&gt;pipeline_comm_s0</title>
<path fill="none" stroke="black" d="M1542,-1575.77C1542,-1567.73 1542,-1558.83 1542,-1550.29"/>
<polygon fill="black" stroke="black" points="1545.5,-1550.13 1542,-1540.13 1538.5,-1550.13 1545.5,-1550.13"/>
</g>
<!-- attn_s1_t0_g0 -->
<g id="node290" class="node">
<title>attn_s1_t0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1679.5,-1411.9 1404.5,-1411.9 1404.5,-1370.9 1679.5,-1370.9 1679.5,-1411.9"/>
<text text-anchor="middle" x="1542" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;32</text>
<text text-anchor="middle" x="1542" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g0 -->
<g id="node291" class="node">
<title>gate_s1_t0_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="1807.32,-1334.9 1385.26,-1334.9 1276.68,-1252.9 1698.74,-1252.9 1807.32,-1334.9"/>
<text text-anchor="middle" x="1542" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;32</text>
<text text-anchor="middle" x="1542" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g0&#45;&gt;gate_s1_t0_g0 -->
<g id="edge100" class="edge">
<title>attn_s1_t0_g0&#45;&gt;gate_s1_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1370.61C1542,-1363.15 1542,-1354.28 1542,-1345.28"/>
<polygon fill="black" stroke="black" points="1545.5,-1345.14 1542,-1335.14 1538.5,-1345.14 1545.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g0_l6 -->
<g id="node292" class="node">
<title>expert_s1_t0_g0_l6</title>
<polygon fill="lightgreen" stroke="black" points="1671,-1216.9 1413,-1216.9 1413,-1175.9 1671,-1175.9 1671,-1216.9"/>
<text text-anchor="middle" x="1542" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;6 GPU&#45;32</text>
<text text-anchor="middle" x="1542" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g0&#45;&gt;expert_s1_t0_g0_l6 -->
<g id="edge101" class="edge">
<title>gate_s1_t0_g0&#45;&gt;expert_s1_t0_g0_l6</title>
<path fill="none" stroke="black" d="M1542,-1252.67C1542,-1244.1 1542,-1235.19 1542,-1227.09"/>
<polygon fill="black" stroke="black" points="1545.5,-1227.01 1542,-1217.01 1538.5,-1227.01 1545.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g0 -->
<g id="node546" class="node">
<title>comm_s1_t0_g0</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;32</text>
<text text-anchor="middle" x="1542" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g0_l6&#45;&gt;comm_s1_t0_g0 -->
<g id="edge102" class="edge">
<title>expert_s1_t0_g0_l6&#45;&gt;comm_s1_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1175.61C1542,-1167.99 1542,-1158.99 1542,-1150.21"/>
<polygon fill="black" stroke="black" points="1545.5,-1150.08 1542,-1140.08 1538.5,-1150.08 1545.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g0_l7 -->
<g id="node293" class="node">
<title>expert_s1_t0_g0_l7</title>
<polygon fill="lightgreen" stroke="black" points="13104,-1411.9 12846,-1411.9 12846,-1370.9 13104,-1370.9 13104,-1411.9"/>
<text text-anchor="middle" x="12975" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;7 GPU&#45;32</text>
<text text-anchor="middle" x="12975" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12975" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g0_l8 -->
<g id="node294" class="node">
<title>expert_s1_t0_g0_l8</title>
<polygon fill="lightgreen" stroke="black" points="12828,-1411.9 12570,-1411.9 12570,-1370.9 12828,-1370.9 12828,-1411.9"/>
<text text-anchor="middle" x="12699" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;8 GPU&#45;32</text>
<text text-anchor="middle" x="12699" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12699" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g0_l9 -->
<g id="node295" class="node">
<title>expert_s1_t0_g0_l9</title>
<polygon fill="lightgreen" stroke="black" points="12552,-1411.9 12294,-1411.9 12294,-1370.9 12552,-1370.9 12552,-1411.9"/>
<text text-anchor="middle" x="12423" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;9 GPU&#45;32</text>
<text text-anchor="middle" x="12423" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12423" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g0_l10 -->
<g id="node296" class="node">
<title>expert_s1_t0_g0_l10</title>
<polygon fill="lightgreen" stroke="black" points="12276,-1411.9 12018,-1411.9 12018,-1370.9 12276,-1370.9 12276,-1411.9"/>
<text text-anchor="middle" x="12147" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;10 GPU&#45;32</text>
<text text-anchor="middle" x="12147" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12147" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g0_l11 -->
<g id="node297" class="node">
<title>expert_s1_t0_g0_l11</title>
<polygon fill="lightgreen" stroke="black" points="12000,-1411.9 11742,-1411.9 11742,-1370.9 12000,-1370.9 12000,-1411.9"/>
<text text-anchor="middle" x="11871" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;32 Layer&#45;11 GPU&#45;32</text>
<text text-anchor="middle" x="11871" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11871" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g1 -->
<g id="node298" class="node">
<title>attn_s1_t0_g1</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-1411.9 3078.5,-1411.9 3078.5,-1370.9 3353.5,-1370.9 3353.5,-1411.9"/>
<text text-anchor="middle" x="3216" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;33</text>
<text text-anchor="middle" x="3216" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g1 -->
<g id="node299" class="node">
<title>gate_s1_t0_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="3481.32,-1334.9 3059.26,-1334.9 2950.68,-1252.9 3372.74,-1252.9 3481.32,-1334.9"/>
<text text-anchor="middle" x="3216" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;33</text>
<text text-anchor="middle" x="3216" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g1&#45;&gt;gate_s1_t0_g1 -->
<g id="edge103" class="edge">
<title>attn_s1_t0_g1&#45;&gt;gate_s1_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-1370.61C3216,-1363.15 3216,-1354.28 3216,-1345.28"/>
<polygon fill="black" stroke="black" points="3219.5,-1345.14 3216,-1335.14 3212.5,-1345.14 3219.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g1_l6 -->
<g id="node300" class="node">
<title>expert_s1_t0_g1_l6</title>
<polygon fill="lightgreen" stroke="black" points="3345,-1216.9 3087,-1216.9 3087,-1175.9 3345,-1175.9 3345,-1216.9"/>
<text text-anchor="middle" x="3216" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;6 GPU&#45;33</text>
<text text-anchor="middle" x="3216" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g1&#45;&gt;expert_s1_t0_g1_l6 -->
<g id="edge104" class="edge">
<title>gate_s1_t0_g1&#45;&gt;expert_s1_t0_g1_l6</title>
<path fill="none" stroke="black" d="M3216,-1252.67C3216,-1244.1 3216,-1235.19 3216,-1227.09"/>
<polygon fill="black" stroke="black" points="3219.5,-1227.01 3216,-1217.01 3212.5,-1227.01 3219.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g1 -->
<g id="node547" class="node">
<title>comm_s1_t0_g1</title>
<ellipse fill="lightblue" stroke="black" cx="3216" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="3216" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;33</text>
<text text-anchor="middle" x="3216" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g1_l6&#45;&gt;comm_s1_t0_g1 -->
<g id="edge105" class="edge">
<title>expert_s1_t0_g1_l6&#45;&gt;comm_s1_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-1175.61C3216,-1167.99 3216,-1158.99 3216,-1150.21"/>
<polygon fill="black" stroke="black" points="3219.5,-1150.08 3216,-1140.08 3212.5,-1150.08 3219.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g1_l7 -->
<g id="node301" class="node">
<title>expert_s1_t0_g1_l7</title>
<polygon fill="lightgreen" stroke="black" points="11430,-1411.9 11172,-1411.9 11172,-1370.9 11430,-1370.9 11430,-1411.9"/>
<text text-anchor="middle" x="11301" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;7 GPU&#45;33</text>
<text text-anchor="middle" x="11301" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11301" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g1_l8 -->
<g id="node302" class="node">
<title>expert_s1_t0_g1_l8</title>
<polygon fill="lightgreen" stroke="black" points="11154,-1411.9 10896,-1411.9 10896,-1370.9 11154,-1370.9 11154,-1411.9"/>
<text text-anchor="middle" x="11025" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;8 GPU&#45;33</text>
<text text-anchor="middle" x="11025" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11025" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g1_l9 -->
<g id="node303" class="node">
<title>expert_s1_t0_g1_l9</title>
<polygon fill="lightgreen" stroke="black" points="10878,-1411.9 10620,-1411.9 10620,-1370.9 10878,-1370.9 10878,-1411.9"/>
<text text-anchor="middle" x="10749" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;9 GPU&#45;33</text>
<text text-anchor="middle" x="10749" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10749" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g1_l10 -->
<g id="node304" class="node">
<title>expert_s1_t0_g1_l10</title>
<polygon fill="lightgreen" stroke="black" points="10602,-1411.9 10344,-1411.9 10344,-1370.9 10602,-1370.9 10602,-1411.9"/>
<text text-anchor="middle" x="10473" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;10 GPU&#45;33</text>
<text text-anchor="middle" x="10473" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10473" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g1_l11 -->
<g id="node305" class="node">
<title>expert_s1_t0_g1_l11</title>
<polygon fill="lightgreen" stroke="black" points="10326,-1411.9 10068,-1411.9 10068,-1370.9 10326,-1370.9 10326,-1411.9"/>
<text text-anchor="middle" x="10197" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;33 Layer&#45;11 GPU&#45;33</text>
<text text-anchor="middle" x="10197" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10197" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g2 -->
<g id="node306" class="node">
<title>attn_s1_t0_g2</title>
<polygon fill="lightgreen" stroke="black" points="5027.5,-1411.9 4752.5,-1411.9 4752.5,-1370.9 5027.5,-1370.9 5027.5,-1411.9"/>
<text text-anchor="middle" x="4890" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;34</text>
<text text-anchor="middle" x="4890" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g2 -->
<g id="node307" class="node">
<title>gate_s1_t0_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5155.32,-1334.9 4733.26,-1334.9 4624.68,-1252.9 5046.74,-1252.9 5155.32,-1334.9"/>
<text text-anchor="middle" x="4890" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;34</text>
<text text-anchor="middle" x="4890" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g2&#45;&gt;gate_s1_t0_g2 -->
<g id="edge106" class="edge">
<title>attn_s1_t0_g2&#45;&gt;gate_s1_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-1370.61C4890,-1363.15 4890,-1354.28 4890,-1345.28"/>
<polygon fill="black" stroke="black" points="4893.5,-1345.14 4890,-1335.14 4886.5,-1345.14 4893.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g2_l6 -->
<g id="node308" class="node">
<title>expert_s1_t0_g2_l6</title>
<polygon fill="lightgreen" stroke="black" points="5019,-1216.9 4761,-1216.9 4761,-1175.9 5019,-1175.9 5019,-1216.9"/>
<text text-anchor="middle" x="4890" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;6 GPU&#45;34</text>
<text text-anchor="middle" x="4890" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g2&#45;&gt;expert_s1_t0_g2_l6 -->
<g id="edge107" class="edge">
<title>gate_s1_t0_g2&#45;&gt;expert_s1_t0_g2_l6</title>
<path fill="none" stroke="black" d="M4890,-1252.67C4890,-1244.1 4890,-1235.19 4890,-1227.09"/>
<polygon fill="black" stroke="black" points="4893.5,-1227.01 4890,-1217.01 4886.5,-1227.01 4893.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g2 -->
<g id="node548" class="node">
<title>comm_s1_t0_g2</title>
<ellipse fill="lightblue" stroke="black" cx="4890" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="4890" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;34</text>
<text text-anchor="middle" x="4890" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g2_l6&#45;&gt;comm_s1_t0_g2 -->
<g id="edge108" class="edge">
<title>expert_s1_t0_g2_l6&#45;&gt;comm_s1_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-1175.61C4890,-1167.99 4890,-1158.99 4890,-1150.21"/>
<polygon fill="black" stroke="black" points="4893.5,-1150.08 4890,-1140.08 4886.5,-1150.08 4893.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g2_l7 -->
<g id="node309" class="node">
<title>expert_s1_t0_g2_l7</title>
<polygon fill="lightgreen" stroke="black" points="9756,-1411.9 9498,-1411.9 9498,-1370.9 9756,-1370.9 9756,-1411.9"/>
<text text-anchor="middle" x="9627" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;7 GPU&#45;34</text>
<text text-anchor="middle" x="9627" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9627" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g2_l8 -->
<g id="node310" class="node">
<title>expert_s1_t0_g2_l8</title>
<polygon fill="lightgreen" stroke="black" points="9480,-1411.9 9222,-1411.9 9222,-1370.9 9480,-1370.9 9480,-1411.9"/>
<text text-anchor="middle" x="9351" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;8 GPU&#45;34</text>
<text text-anchor="middle" x="9351" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9351" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g2_l9 -->
<g id="node311" class="node">
<title>expert_s1_t0_g2_l9</title>
<polygon fill="lightgreen" stroke="black" points="9204,-1411.9 8946,-1411.9 8946,-1370.9 9204,-1370.9 9204,-1411.9"/>
<text text-anchor="middle" x="9075" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;9 GPU&#45;34</text>
<text text-anchor="middle" x="9075" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9075" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g2_l10 -->
<g id="node312" class="node">
<title>expert_s1_t0_g2_l10</title>
<polygon fill="lightgreen" stroke="black" points="8928,-1411.9 8670,-1411.9 8670,-1370.9 8928,-1370.9 8928,-1411.9"/>
<text text-anchor="middle" x="8799" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;10 GPU&#45;34</text>
<text text-anchor="middle" x="8799" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8799" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g2_l11 -->
<g id="node313" class="node">
<title>expert_s1_t0_g2_l11</title>
<polygon fill="lightgreen" stroke="black" points="8652,-1411.9 8394,-1411.9 8394,-1370.9 8652,-1370.9 8652,-1411.9"/>
<text text-anchor="middle" x="8523" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;34 Layer&#45;11 GPU&#45;34</text>
<text text-anchor="middle" x="8523" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8523" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g3 -->
<g id="node314" class="node">
<title>attn_s1_t0_g3</title>
<polygon fill="lightgreen" stroke="black" points="6701.5,-1411.9 6426.5,-1411.9 6426.5,-1370.9 6701.5,-1370.9 6701.5,-1411.9"/>
<text text-anchor="middle" x="6564" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;35</text>
<text text-anchor="middle" x="6564" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g3 -->
<g id="node315" class="node">
<title>gate_s1_t0_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="6829.32,-1334.9 6407.26,-1334.9 6298.68,-1252.9 6720.74,-1252.9 6829.32,-1334.9"/>
<text text-anchor="middle" x="6564" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;35</text>
<text text-anchor="middle" x="6564" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g3&#45;&gt;gate_s1_t0_g3 -->
<g id="edge109" class="edge">
<title>attn_s1_t0_g3&#45;&gt;gate_s1_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-1370.61C6564,-1363.15 6564,-1354.28 6564,-1345.28"/>
<polygon fill="black" stroke="black" points="6567.5,-1345.14 6564,-1335.14 6560.5,-1345.14 6567.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g3_l6 -->
<g id="node316" class="node">
<title>expert_s1_t0_g3_l6</title>
<polygon fill="lightgreen" stroke="black" points="6693,-1216.9 6435,-1216.9 6435,-1175.9 6693,-1175.9 6693,-1216.9"/>
<text text-anchor="middle" x="6564" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;6 GPU&#45;35</text>
<text text-anchor="middle" x="6564" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g3&#45;&gt;expert_s1_t0_g3_l6 -->
<g id="edge110" class="edge">
<title>gate_s1_t0_g3&#45;&gt;expert_s1_t0_g3_l6</title>
<path fill="none" stroke="black" d="M6564,-1252.67C6564,-1244.1 6564,-1235.19 6564,-1227.09"/>
<polygon fill="black" stroke="black" points="6567.5,-1227.01 6564,-1217.01 6560.5,-1227.01 6567.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g3 -->
<g id="node549" class="node">
<title>comm_s1_t0_g3</title>
<ellipse fill="lightblue" stroke="black" cx="6564" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="6564" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;35</text>
<text text-anchor="middle" x="6564" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g3_l6&#45;&gt;comm_s1_t0_g3 -->
<g id="edge111" class="edge">
<title>expert_s1_t0_g3_l6&#45;&gt;comm_s1_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-1175.61C6564,-1167.99 6564,-1158.99 6564,-1150.21"/>
<polygon fill="black" stroke="black" points="6567.5,-1150.08 6564,-1140.08 6560.5,-1150.08 6567.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g3_l7 -->
<g id="node317" class="node">
<title>expert_s1_t0_g3_l7</title>
<polygon fill="lightgreen" stroke="black" points="8082,-1411.9 7824,-1411.9 7824,-1370.9 8082,-1370.9 8082,-1411.9"/>
<text text-anchor="middle" x="7953" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;7 GPU&#45;35</text>
<text text-anchor="middle" x="7953" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7953" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g3_l8 -->
<g id="node318" class="node">
<title>expert_s1_t0_g3_l8</title>
<polygon fill="lightgreen" stroke="black" points="7806,-1411.9 7548,-1411.9 7548,-1370.9 7806,-1370.9 7806,-1411.9"/>
<text text-anchor="middle" x="7677" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;8 GPU&#45;35</text>
<text text-anchor="middle" x="7677" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7677" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g3_l9 -->
<g id="node319" class="node">
<title>expert_s1_t0_g3_l9</title>
<polygon fill="lightgreen" stroke="black" points="7530,-1411.9 7272,-1411.9 7272,-1370.9 7530,-1370.9 7530,-1411.9"/>
<text text-anchor="middle" x="7401" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;9 GPU&#45;35</text>
<text text-anchor="middle" x="7401" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7401" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g3_l10 -->
<g id="node320" class="node">
<title>expert_s1_t0_g3_l10</title>
<polygon fill="lightgreen" stroke="black" points="7254,-1411.9 6996,-1411.9 6996,-1370.9 7254,-1370.9 7254,-1411.9"/>
<text text-anchor="middle" x="7125" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;10 GPU&#45;35</text>
<text text-anchor="middle" x="7125" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7125" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g3_l11 -->
<g id="node321" class="node">
<title>expert_s1_t0_g3_l11</title>
<polygon fill="lightgreen" stroke="black" points="6978,-1411.9 6720,-1411.9 6720,-1370.9 6978,-1370.9 6978,-1411.9"/>
<text text-anchor="middle" x="6849" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;35 Layer&#45;11 GPU&#45;35</text>
<text text-anchor="middle" x="6849" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6849" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g4 -->
<g id="node322" class="node">
<title>attn_s1_t0_g4</title>
<polygon fill="lightgreen" stroke="black" points="8375.5,-1411.9 8100.5,-1411.9 8100.5,-1370.9 8375.5,-1370.9 8375.5,-1411.9"/>
<text text-anchor="middle" x="8238" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;36</text>
<text text-anchor="middle" x="8238" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g4 -->
<g id="node323" class="node">
<title>gate_s1_t0_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="8503.32,-1334.9 8081.26,-1334.9 7972.68,-1252.9 8394.74,-1252.9 8503.32,-1334.9"/>
<text text-anchor="middle" x="8238" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;36</text>
<text text-anchor="middle" x="8238" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g4&#45;&gt;gate_s1_t0_g4 -->
<g id="edge112" class="edge">
<title>attn_s1_t0_g4&#45;&gt;gate_s1_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-1370.61C8238,-1363.15 8238,-1354.28 8238,-1345.28"/>
<polygon fill="black" stroke="black" points="8241.5,-1345.14 8238,-1335.14 8234.5,-1345.14 8241.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g4_l6 -->
<g id="node324" class="node">
<title>expert_s1_t0_g4_l6</title>
<polygon fill="lightgreen" stroke="black" points="8367,-1216.9 8109,-1216.9 8109,-1175.9 8367,-1175.9 8367,-1216.9"/>
<text text-anchor="middle" x="8238" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;6 GPU&#45;36</text>
<text text-anchor="middle" x="8238" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g4&#45;&gt;expert_s1_t0_g4_l6 -->
<g id="edge113" class="edge">
<title>gate_s1_t0_g4&#45;&gt;expert_s1_t0_g4_l6</title>
<path fill="none" stroke="black" d="M8238,-1252.67C8238,-1244.1 8238,-1235.19 8238,-1227.09"/>
<polygon fill="black" stroke="black" points="8241.5,-1227.01 8238,-1217.01 8234.5,-1227.01 8241.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g4 -->
<g id="node550" class="node">
<title>comm_s1_t0_g4</title>
<ellipse fill="lightblue" stroke="black" cx="8238" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8238" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;36</text>
<text text-anchor="middle" x="8238" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g4_l6&#45;&gt;comm_s1_t0_g4 -->
<g id="edge114" class="edge">
<title>expert_s1_t0_g4_l6&#45;&gt;comm_s1_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-1175.61C8238,-1167.99 8238,-1158.99 8238,-1150.21"/>
<polygon fill="black" stroke="black" points="8241.5,-1150.08 8238,-1140.08 8234.5,-1150.08 8241.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g4_l7 -->
<g id="node325" class="node">
<title>expert_s1_t0_g4_l7</title>
<polygon fill="lightgreen" stroke="black" points="6408,-1411.9 6150,-1411.9 6150,-1370.9 6408,-1370.9 6408,-1411.9"/>
<text text-anchor="middle" x="6279" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;7 GPU&#45;36</text>
<text text-anchor="middle" x="6279" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6279" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g4_l8 -->
<g id="node326" class="node">
<title>expert_s1_t0_g4_l8</title>
<polygon fill="lightgreen" stroke="black" points="6132,-1411.9 5874,-1411.9 5874,-1370.9 6132,-1370.9 6132,-1411.9"/>
<text text-anchor="middle" x="6003" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;8 GPU&#45;36</text>
<text text-anchor="middle" x="6003" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6003" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g4_l9 -->
<g id="node327" class="node">
<title>expert_s1_t0_g4_l9</title>
<polygon fill="lightgreen" stroke="black" points="5856,-1411.9 5598,-1411.9 5598,-1370.9 5856,-1370.9 5856,-1411.9"/>
<text text-anchor="middle" x="5727" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;9 GPU&#45;36</text>
<text text-anchor="middle" x="5727" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5727" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g4_l10 -->
<g id="node328" class="node">
<title>expert_s1_t0_g4_l10</title>
<polygon fill="lightgreen" stroke="black" points="5580,-1411.9 5322,-1411.9 5322,-1370.9 5580,-1370.9 5580,-1411.9"/>
<text text-anchor="middle" x="5451" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;10 GPU&#45;36</text>
<text text-anchor="middle" x="5451" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5451" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g4_l11 -->
<g id="node329" class="node">
<title>expert_s1_t0_g4_l11</title>
<polygon fill="lightgreen" stroke="black" points="5304,-1411.9 5046,-1411.9 5046,-1370.9 5304,-1370.9 5304,-1411.9"/>
<text text-anchor="middle" x="5175" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;36 Layer&#45;11 GPU&#45;36</text>
<text text-anchor="middle" x="5175" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5175" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g5 -->
<g id="node330" class="node">
<title>attn_s1_t0_g5</title>
<polygon fill="lightgreen" stroke="black" points="10049.5,-1411.9 9774.5,-1411.9 9774.5,-1370.9 10049.5,-1370.9 10049.5,-1411.9"/>
<text text-anchor="middle" x="9912" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;37</text>
<text text-anchor="middle" x="9912" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g5 -->
<g id="node331" class="node">
<title>gate_s1_t0_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="10177.32,-1334.9 9755.26,-1334.9 9646.68,-1252.9 10068.74,-1252.9 10177.32,-1334.9"/>
<text text-anchor="middle" x="9912" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;37</text>
<text text-anchor="middle" x="9912" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g5&#45;&gt;gate_s1_t0_g5 -->
<g id="edge115" class="edge">
<title>attn_s1_t0_g5&#45;&gt;gate_s1_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-1370.61C9912,-1363.15 9912,-1354.28 9912,-1345.28"/>
<polygon fill="black" stroke="black" points="9915.5,-1345.14 9912,-1335.14 9908.5,-1345.14 9915.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g5_l6 -->
<g id="node332" class="node">
<title>expert_s1_t0_g5_l6</title>
<polygon fill="lightgreen" stroke="black" points="10041,-1216.9 9783,-1216.9 9783,-1175.9 10041,-1175.9 10041,-1216.9"/>
<text text-anchor="middle" x="9912" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;6 GPU&#45;37</text>
<text text-anchor="middle" x="9912" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g5&#45;&gt;expert_s1_t0_g5_l6 -->
<g id="edge116" class="edge">
<title>gate_s1_t0_g5&#45;&gt;expert_s1_t0_g5_l6</title>
<path fill="none" stroke="black" d="M9912,-1252.67C9912,-1244.1 9912,-1235.19 9912,-1227.09"/>
<polygon fill="black" stroke="black" points="9915.5,-1227.01 9912,-1217.01 9908.5,-1227.01 9915.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g5 -->
<g id="node551" class="node">
<title>comm_s1_t0_g5</title>
<ellipse fill="lightblue" stroke="black" cx="9912" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9912" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;37</text>
<text text-anchor="middle" x="9912" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g5_l6&#45;&gt;comm_s1_t0_g5 -->
<g id="edge117" class="edge">
<title>expert_s1_t0_g5_l6&#45;&gt;comm_s1_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-1175.61C9912,-1167.99 9912,-1158.99 9912,-1150.21"/>
<polygon fill="black" stroke="black" points="9915.5,-1150.08 9912,-1140.08 9908.5,-1150.08 9915.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g5_l7 -->
<g id="node333" class="node">
<title>expert_s1_t0_g5_l7</title>
<polygon fill="lightgreen" stroke="black" points="4734,-1411.9 4476,-1411.9 4476,-1370.9 4734,-1370.9 4734,-1411.9"/>
<text text-anchor="middle" x="4605" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;7 GPU&#45;37</text>
<text text-anchor="middle" x="4605" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4605" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g5_l8 -->
<g id="node334" class="node">
<title>expert_s1_t0_g5_l8</title>
<polygon fill="lightgreen" stroke="black" points="4458,-1411.9 4200,-1411.9 4200,-1370.9 4458,-1370.9 4458,-1411.9"/>
<text text-anchor="middle" x="4329" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;8 GPU&#45;37</text>
<text text-anchor="middle" x="4329" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4329" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g5_l9 -->
<g id="node335" class="node">
<title>expert_s1_t0_g5_l9</title>
<polygon fill="lightgreen" stroke="black" points="4182,-1411.9 3924,-1411.9 3924,-1370.9 4182,-1370.9 4182,-1411.9"/>
<text text-anchor="middle" x="4053" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;9 GPU&#45;37</text>
<text text-anchor="middle" x="4053" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4053" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g5_l10 -->
<g id="node336" class="node">
<title>expert_s1_t0_g5_l10</title>
<polygon fill="lightgreen" stroke="black" points="3906,-1411.9 3648,-1411.9 3648,-1370.9 3906,-1370.9 3906,-1411.9"/>
<text text-anchor="middle" x="3777" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;10 GPU&#45;37</text>
<text text-anchor="middle" x="3777" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3777" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g5_l11 -->
<g id="node337" class="node">
<title>expert_s1_t0_g5_l11</title>
<polygon fill="lightgreen" stroke="black" points="3630,-1411.9 3372,-1411.9 3372,-1370.9 3630,-1370.9 3630,-1411.9"/>
<text text-anchor="middle" x="3501" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;37 Layer&#45;11 GPU&#45;37</text>
<text text-anchor="middle" x="3501" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3501" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g6 -->
<g id="node338" class="node">
<title>attn_s1_t0_g6</title>
<polygon fill="lightgreen" stroke="black" points="11723.5,-1411.9 11448.5,-1411.9 11448.5,-1370.9 11723.5,-1370.9 11723.5,-1411.9"/>
<text text-anchor="middle" x="11586" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;38</text>
<text text-anchor="middle" x="11586" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g6 -->
<g id="node339" class="node">
<title>gate_s1_t0_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11851.32,-1334.9 11429.26,-1334.9 11320.68,-1252.9 11742.74,-1252.9 11851.32,-1334.9"/>
<text text-anchor="middle" x="11586" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;38</text>
<text text-anchor="middle" x="11586" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g6&#45;&gt;gate_s1_t0_g6 -->
<g id="edge118" class="edge">
<title>attn_s1_t0_g6&#45;&gt;gate_s1_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-1370.61C11586,-1363.15 11586,-1354.28 11586,-1345.28"/>
<polygon fill="black" stroke="black" points="11589.5,-1345.14 11586,-1335.14 11582.5,-1345.14 11589.5,-1345.14"/>
</g>
<!-- expert_s1_t0_g6_l6 -->
<g id="node340" class="node">
<title>expert_s1_t0_g6_l6</title>
<polygon fill="lightgreen" stroke="black" points="11715,-1216.9 11457,-1216.9 11457,-1175.9 11715,-1175.9 11715,-1216.9"/>
<text text-anchor="middle" x="11586" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;6 GPU&#45;38</text>
<text text-anchor="middle" x="11586" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g6&#45;&gt;expert_s1_t0_g6_l6 -->
<g id="edge119" class="edge">
<title>gate_s1_t0_g6&#45;&gt;expert_s1_t0_g6_l6</title>
<path fill="none" stroke="black" d="M11586,-1252.67C11586,-1244.1 11586,-1235.19 11586,-1227.09"/>
<polygon fill="black" stroke="black" points="11589.5,-1227.01 11586,-1217.01 11582.5,-1227.01 11589.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g6 -->
<g id="node552" class="node">
<title>comm_s1_t0_g6</title>
<ellipse fill="lightblue" stroke="black" cx="11586" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="11586" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;38</text>
<text text-anchor="middle" x="11586" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g6_l6&#45;&gt;comm_s1_t0_g6 -->
<g id="edge120" class="edge">
<title>expert_s1_t0_g6_l6&#45;&gt;comm_s1_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-1175.61C11586,-1167.99 11586,-1158.99 11586,-1150.21"/>
<polygon fill="black" stroke="black" points="11589.5,-1150.08 11586,-1140.08 11582.5,-1150.08 11589.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g6_l7 -->
<g id="node341" class="node">
<title>expert_s1_t0_g6_l7</title>
<polygon fill="lightgreen" stroke="black" points="3060,-1411.9 2802,-1411.9 2802,-1370.9 3060,-1370.9 3060,-1411.9"/>
<text text-anchor="middle" x="2931" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;7 GPU&#45;38</text>
<text text-anchor="middle" x="2931" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2931" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g6_l8 -->
<g id="node342" class="node">
<title>expert_s1_t0_g6_l8</title>
<polygon fill="lightgreen" stroke="black" points="2784,-1411.9 2526,-1411.9 2526,-1370.9 2784,-1370.9 2784,-1411.9"/>
<text text-anchor="middle" x="2655" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;8 GPU&#45;38</text>
<text text-anchor="middle" x="2655" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2655" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g6_l9 -->
<g id="node343" class="node">
<title>expert_s1_t0_g6_l9</title>
<polygon fill="lightgreen" stroke="black" points="2508,-1411.9 2250,-1411.9 2250,-1370.9 2508,-1370.9 2508,-1411.9"/>
<text text-anchor="middle" x="2379" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;9 GPU&#45;38</text>
<text text-anchor="middle" x="2379" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2379" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g6_l10 -->
<g id="node344" class="node">
<title>expert_s1_t0_g6_l10</title>
<polygon fill="lightgreen" stroke="black" points="2232,-1411.9 1974,-1411.9 1974,-1370.9 2232,-1370.9 2232,-1411.9"/>
<text text-anchor="middle" x="2103" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;10 GPU&#45;38</text>
<text text-anchor="middle" x="2103" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2103" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g6_l11 -->
<g id="node345" class="node">
<title>expert_s1_t0_g6_l11</title>
<polygon fill="lightgreen" stroke="black" points="1956,-1411.9 1698,-1411.9 1698,-1370.9 1956,-1370.9 1956,-1411.9"/>
<text text-anchor="middle" x="1827" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;38 Layer&#45;11 GPU&#45;38</text>
<text text-anchor="middle" x="1827" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1827" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t0_g7 -->
<g id="node346" class="node">
<title>attn_s1_t0_g7</title>
<polygon fill="lightgreen" stroke="black" points="13397.5,-1411.9 13122.5,-1411.9 13122.5,-1370.9 13397.5,-1370.9 13397.5,-1411.9"/>
<text text-anchor="middle" x="13260" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;39</text>
<text text-anchor="middle" x="13260" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13260" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t0_g7 -->
<g id="node347" class="node">
<title>gate_s1_t0_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="13398.32,-1334.9 12976.26,-1334.9 12867.68,-1252.9 13289.74,-1252.9 13398.32,-1334.9"/>
<text text-anchor="middle" x="13133" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;39</text>
<text text-anchor="middle" x="13133" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t0_g7&#45;&gt;gate_s1_t0_g7 -->
<g id="edge121" class="edge">
<title>attn_s1_t0_g7&#45;&gt;gate_s1_t0_g7</title>
<path fill="none" stroke="black" d="M13233.99,-1370.84C13222.47,-1362.17 13208.37,-1351.57 13194.41,-1341.08"/>
<polygon fill="black" stroke="black" points="13196.33,-1338.14 13186.23,-1334.92 13192.12,-1343.73 13196.33,-1338.14"/>
</g>
<!-- expert_s1_t0_g7_l6 -->
<g id="node348" class="node">
<title>expert_s1_t0_g7_l6</title>
<polygon fill="lightgreen" stroke="black" points="13262,-1216.9 13004,-1216.9 13004,-1175.9 13262,-1175.9 13262,-1216.9"/>
<text text-anchor="middle" x="13133" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;6 GPU&#45;39</text>
<text text-anchor="middle" x="13133" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t0_g7&#45;&gt;expert_s1_t0_g7_l6 -->
<g id="edge122" class="edge">
<title>gate_s1_t0_g7&#45;&gt;expert_s1_t0_g7_l6</title>
<path fill="none" stroke="black" d="M13133,-1252.67C13133,-1244.1 13133,-1235.19 13133,-1227.09"/>
<polygon fill="black" stroke="black" points="13136.5,-1227.01 13133,-1217.01 13129.5,-1227.01 13136.5,-1227.01"/>
</g>
<!-- comm_s1_t0_g7 -->
<g id="node553" class="node">
<title>comm_s1_t0_g7</title>
<ellipse fill="lightblue" stroke="black" cx="13133" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="13133" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;39</text>
<text text-anchor="middle" x="13133" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13133" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t0_g7_l6&#45;&gt;comm_s1_t0_g7 -->
<g id="edge123" class="edge">
<title>expert_s1_t0_g7_l6&#45;&gt;comm_s1_t0_g7</title>
<path fill="none" stroke="black" d="M13133,-1175.61C13133,-1167.99 13133,-1158.99 13133,-1150.21"/>
<polygon fill="black" stroke="black" points="13136.5,-1150.08 13133,-1140.08 13129.5,-1150.08 13136.5,-1150.08"/>
</g>
<!-- expert_s1_t0_g7_l7 -->
<g id="node349" class="node">
<title>expert_s1_t0_g7_l7</title>
<polygon fill="lightgreen" stroke="black" points="1386,-1411.9 1128,-1411.9 1128,-1370.9 1386,-1370.9 1386,-1411.9"/>
<text text-anchor="middle" x="1257" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;7 GPU&#45;39</text>
<text text-anchor="middle" x="1257" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1257" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g7_l8 -->
<g id="node350" class="node">
<title>expert_s1_t0_g7_l8</title>
<polygon fill="lightgreen" stroke="black" points="1110,-1411.9 852,-1411.9 852,-1370.9 1110,-1370.9 1110,-1411.9"/>
<text text-anchor="middle" x="981" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;8 GPU&#45;39</text>
<text text-anchor="middle" x="981" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="981" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g7_l9 -->
<g id="node351" class="node">
<title>expert_s1_t0_g7_l9</title>
<polygon fill="lightgreen" stroke="black" points="834,-1411.9 576,-1411.9 576,-1370.9 834,-1370.9 834,-1411.9"/>
<text text-anchor="middle" x="705" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;9 GPU&#45;39</text>
<text text-anchor="middle" x="705" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="705" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g7_l10 -->
<g id="node352" class="node">
<title>expert_s1_t0_g7_l10</title>
<polygon fill="lightgreen" stroke="black" points="558,-1411.9 300,-1411.9 300,-1370.9 558,-1370.9 558,-1411.9"/>
<text text-anchor="middle" x="429" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;10 GPU&#45;39</text>
<text text-anchor="middle" x="429" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="429" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t0_g7_l11 -->
<g id="node353" class="node">
<title>expert_s1_t0_g7_l11</title>
<polygon fill="lightgreen" stroke="black" points="282,-1411.9 24,-1411.9 24,-1370.9 282,-1370.9 282,-1411.9"/>
<text text-anchor="middle" x="153" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;39 Layer&#45;11 GPU&#45;39</text>
<text text-anchor="middle" x="153" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="153" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g0 -->
<g id="node354" class="node">
<title>attn_s1_t1_g0</title>
<polygon fill="lightgreen" stroke="black" points="15077.5,-1411.9 14802.5,-1411.9 14802.5,-1370.9 15077.5,-1370.9 15077.5,-1411.9"/>
<text text-anchor="middle" x="14940" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;40</text>
<text text-anchor="middle" x="14940" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g0 -->
<g id="node355" class="node">
<title>gate_s1_t1_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="15205.32,-1334.9 14783.26,-1334.9 14674.68,-1252.9 15096.74,-1252.9 15205.32,-1334.9"/>
<text text-anchor="middle" x="14940" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;40</text>
<text text-anchor="middle" x="14940" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g0&#45;&gt;gate_s1_t1_g0 -->
<g id="edge124" class="edge">
<title>attn_s1_t1_g0&#45;&gt;gate_s1_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-1370.61C14940,-1363.15 14940,-1354.28 14940,-1345.28"/>
<polygon fill="black" stroke="black" points="14943.5,-1345.14 14940,-1335.14 14936.5,-1345.14 14943.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g0_l6 -->
<g id="node356" class="node">
<title>expert_s1_t1_g0_l6</title>
<polygon fill="lightgreen" stroke="black" points="15069,-1216.9 14811,-1216.9 14811,-1175.9 15069,-1175.9 15069,-1216.9"/>
<text text-anchor="middle" x="14940" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;6 GPU&#45;40</text>
<text text-anchor="middle" x="14940" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g0&#45;&gt;expert_s1_t1_g0_l6 -->
<g id="edge125" class="edge">
<title>gate_s1_t1_g0&#45;&gt;expert_s1_t1_g0_l6</title>
<path fill="none" stroke="black" d="M14940,-1252.67C14940,-1244.1 14940,-1235.19 14940,-1227.09"/>
<polygon fill="black" stroke="black" points="14943.5,-1227.01 14940,-1217.01 14936.5,-1227.01 14943.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g0 -->
<g id="node554" class="node">
<title>comm_s1_t1_g0</title>
<ellipse fill="lightblue" stroke="black" cx="14940" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="14940" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;40</text>
<text text-anchor="middle" x="14940" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g0_l6&#45;&gt;comm_s1_t1_g0 -->
<g id="edge126" class="edge">
<title>expert_s1_t1_g0_l6&#45;&gt;comm_s1_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-1175.61C14940,-1167.99 14940,-1158.99 14940,-1150.21"/>
<polygon fill="black" stroke="black" points="14943.5,-1150.08 14940,-1140.08 14936.5,-1150.08 14943.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g0_l7 -->
<g id="node357" class="node">
<title>expert_s1_t1_g0_l7</title>
<polygon fill="lightgreen" stroke="black" points="26502,-1411.9 26244,-1411.9 26244,-1370.9 26502,-1370.9 26502,-1411.9"/>
<text text-anchor="middle" x="26373" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;7 GPU&#45;40</text>
<text text-anchor="middle" x="26373" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26373" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g0_l8 -->
<g id="node358" class="node">
<title>expert_s1_t1_g0_l8</title>
<polygon fill="lightgreen" stroke="black" points="26226,-1411.9 25968,-1411.9 25968,-1370.9 26226,-1370.9 26226,-1411.9"/>
<text text-anchor="middle" x="26097" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;8 GPU&#45;40</text>
<text text-anchor="middle" x="26097" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26097" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g0_l9 -->
<g id="node359" class="node">
<title>expert_s1_t1_g0_l9</title>
<polygon fill="lightgreen" stroke="black" points="25950,-1411.9 25692,-1411.9 25692,-1370.9 25950,-1370.9 25950,-1411.9"/>
<text text-anchor="middle" x="25821" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;9 GPU&#45;40</text>
<text text-anchor="middle" x="25821" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25821" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g0_l10 -->
<g id="node360" class="node">
<title>expert_s1_t1_g0_l10</title>
<polygon fill="lightgreen" stroke="black" points="25674,-1411.9 25416,-1411.9 25416,-1370.9 25674,-1370.9 25674,-1411.9"/>
<text text-anchor="middle" x="25545" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;10 GPU&#45;40</text>
<text text-anchor="middle" x="25545" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25545" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g0_l11 -->
<g id="node361" class="node">
<title>expert_s1_t1_g0_l11</title>
<polygon fill="lightgreen" stroke="black" points="25398,-1411.9 25140,-1411.9 25140,-1370.9 25398,-1370.9 25398,-1411.9"/>
<text text-anchor="middle" x="25269" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;40 Layer&#45;11 GPU&#45;40</text>
<text text-anchor="middle" x="25269" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25269" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g1 -->
<g id="node362" class="node">
<title>attn_s1_t1_g1</title>
<polygon fill="lightgreen" stroke="black" points="16751.5,-1411.9 16476.5,-1411.9 16476.5,-1370.9 16751.5,-1370.9 16751.5,-1411.9"/>
<text text-anchor="middle" x="16614" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;41</text>
<text text-anchor="middle" x="16614" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g1 -->
<g id="node363" class="node">
<title>gate_s1_t1_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="16879.32,-1334.9 16457.26,-1334.9 16348.68,-1252.9 16770.74,-1252.9 16879.32,-1334.9"/>
<text text-anchor="middle" x="16614" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;41</text>
<text text-anchor="middle" x="16614" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g1&#45;&gt;gate_s1_t1_g1 -->
<g id="edge127" class="edge">
<title>attn_s1_t1_g1&#45;&gt;gate_s1_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-1370.61C16614,-1363.15 16614,-1354.28 16614,-1345.28"/>
<polygon fill="black" stroke="black" points="16617.5,-1345.14 16614,-1335.14 16610.5,-1345.14 16617.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g1_l6 -->
<g id="node364" class="node">
<title>expert_s1_t1_g1_l6</title>
<polygon fill="lightgreen" stroke="black" points="16743,-1216.9 16485,-1216.9 16485,-1175.9 16743,-1175.9 16743,-1216.9"/>
<text text-anchor="middle" x="16614" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;6 GPU&#45;41</text>
<text text-anchor="middle" x="16614" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g1&#45;&gt;expert_s1_t1_g1_l6 -->
<g id="edge128" class="edge">
<title>gate_s1_t1_g1&#45;&gt;expert_s1_t1_g1_l6</title>
<path fill="none" stroke="black" d="M16614,-1252.67C16614,-1244.1 16614,-1235.19 16614,-1227.09"/>
<polygon fill="black" stroke="black" points="16617.5,-1227.01 16614,-1217.01 16610.5,-1227.01 16617.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g1 -->
<g id="node555" class="node">
<title>comm_s1_t1_g1</title>
<ellipse fill="lightblue" stroke="black" cx="16614" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="16614" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;41</text>
<text text-anchor="middle" x="16614" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g1_l6&#45;&gt;comm_s1_t1_g1 -->
<g id="edge129" class="edge">
<title>expert_s1_t1_g1_l6&#45;&gt;comm_s1_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-1175.61C16614,-1167.99 16614,-1158.99 16614,-1150.21"/>
<polygon fill="black" stroke="black" points="16617.5,-1150.08 16614,-1140.08 16610.5,-1150.08 16617.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g1_l7 -->
<g id="node365" class="node">
<title>expert_s1_t1_g1_l7</title>
<polygon fill="lightgreen" stroke="black" points="24828,-1411.9 24570,-1411.9 24570,-1370.9 24828,-1370.9 24828,-1411.9"/>
<text text-anchor="middle" x="24699" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;7 GPU&#45;41</text>
<text text-anchor="middle" x="24699" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24699" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g1_l8 -->
<g id="node366" class="node">
<title>expert_s1_t1_g1_l8</title>
<polygon fill="lightgreen" stroke="black" points="24552,-1411.9 24294,-1411.9 24294,-1370.9 24552,-1370.9 24552,-1411.9"/>
<text text-anchor="middle" x="24423" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;8 GPU&#45;41</text>
<text text-anchor="middle" x="24423" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24423" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g1_l9 -->
<g id="node367" class="node">
<title>expert_s1_t1_g1_l9</title>
<polygon fill="lightgreen" stroke="black" points="24276,-1411.9 24018,-1411.9 24018,-1370.9 24276,-1370.9 24276,-1411.9"/>
<text text-anchor="middle" x="24147" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;9 GPU&#45;41</text>
<text text-anchor="middle" x="24147" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24147" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g1_l10 -->
<g id="node368" class="node">
<title>expert_s1_t1_g1_l10</title>
<polygon fill="lightgreen" stroke="black" points="24000,-1411.9 23742,-1411.9 23742,-1370.9 24000,-1370.9 24000,-1411.9"/>
<text text-anchor="middle" x="23871" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;10 GPU&#45;41</text>
<text text-anchor="middle" x="23871" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23871" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g1_l11 -->
<g id="node369" class="node">
<title>expert_s1_t1_g1_l11</title>
<polygon fill="lightgreen" stroke="black" points="23724,-1411.9 23466,-1411.9 23466,-1370.9 23724,-1370.9 23724,-1411.9"/>
<text text-anchor="middle" x="23595" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;41 Layer&#45;11 GPU&#45;41</text>
<text text-anchor="middle" x="23595" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23595" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g2 -->
<g id="node370" class="node">
<title>attn_s1_t1_g2</title>
<polygon fill="lightgreen" stroke="black" points="18425.5,-1411.9 18150.5,-1411.9 18150.5,-1370.9 18425.5,-1370.9 18425.5,-1411.9"/>
<text text-anchor="middle" x="18288" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;42</text>
<text text-anchor="middle" x="18288" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g2 -->
<g id="node371" class="node">
<title>gate_s1_t1_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="18553.32,-1334.9 18131.26,-1334.9 18022.68,-1252.9 18444.74,-1252.9 18553.32,-1334.9"/>
<text text-anchor="middle" x="18288" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;42</text>
<text text-anchor="middle" x="18288" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g2&#45;&gt;gate_s1_t1_g2 -->
<g id="edge130" class="edge">
<title>attn_s1_t1_g2&#45;&gt;gate_s1_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-1370.61C18288,-1363.15 18288,-1354.28 18288,-1345.28"/>
<polygon fill="black" stroke="black" points="18291.5,-1345.14 18288,-1335.14 18284.5,-1345.14 18291.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g2_l6 -->
<g id="node372" class="node">
<title>expert_s1_t1_g2_l6</title>
<polygon fill="lightgreen" stroke="black" points="18417,-1216.9 18159,-1216.9 18159,-1175.9 18417,-1175.9 18417,-1216.9"/>
<text text-anchor="middle" x="18288" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;6 GPU&#45;42</text>
<text text-anchor="middle" x="18288" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g2&#45;&gt;expert_s1_t1_g2_l6 -->
<g id="edge131" class="edge">
<title>gate_s1_t1_g2&#45;&gt;expert_s1_t1_g2_l6</title>
<path fill="none" stroke="black" d="M18288,-1252.67C18288,-1244.1 18288,-1235.19 18288,-1227.09"/>
<polygon fill="black" stroke="black" points="18291.5,-1227.01 18288,-1217.01 18284.5,-1227.01 18291.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g2 -->
<g id="node556" class="node">
<title>comm_s1_t1_g2</title>
<ellipse fill="lightblue" stroke="black" cx="18288" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="18288" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;42</text>
<text text-anchor="middle" x="18288" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g2_l6&#45;&gt;comm_s1_t1_g2 -->
<g id="edge132" class="edge">
<title>expert_s1_t1_g2_l6&#45;&gt;comm_s1_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-1175.61C18288,-1167.99 18288,-1158.99 18288,-1150.21"/>
<polygon fill="black" stroke="black" points="18291.5,-1150.08 18288,-1140.08 18284.5,-1150.08 18291.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g2_l7 -->
<g id="node373" class="node">
<title>expert_s1_t1_g2_l7</title>
<polygon fill="lightgreen" stroke="black" points="23154,-1411.9 22896,-1411.9 22896,-1370.9 23154,-1370.9 23154,-1411.9"/>
<text text-anchor="middle" x="23025" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;7 GPU&#45;42</text>
<text text-anchor="middle" x="23025" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23025" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g2_l8 -->
<g id="node374" class="node">
<title>expert_s1_t1_g2_l8</title>
<polygon fill="lightgreen" stroke="black" points="22878,-1411.9 22620,-1411.9 22620,-1370.9 22878,-1370.9 22878,-1411.9"/>
<text text-anchor="middle" x="22749" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;8 GPU&#45;42</text>
<text text-anchor="middle" x="22749" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22749" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g2_l9 -->
<g id="node375" class="node">
<title>expert_s1_t1_g2_l9</title>
<polygon fill="lightgreen" stroke="black" points="22602,-1411.9 22344,-1411.9 22344,-1370.9 22602,-1370.9 22602,-1411.9"/>
<text text-anchor="middle" x="22473" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;9 GPU&#45;42</text>
<text text-anchor="middle" x="22473" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22473" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g2_l10 -->
<g id="node376" class="node">
<title>expert_s1_t1_g2_l10</title>
<polygon fill="lightgreen" stroke="black" points="22326,-1411.9 22068,-1411.9 22068,-1370.9 22326,-1370.9 22326,-1411.9"/>
<text text-anchor="middle" x="22197" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;10 GPU&#45;42</text>
<text text-anchor="middle" x="22197" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22197" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g2_l11 -->
<g id="node377" class="node">
<title>expert_s1_t1_g2_l11</title>
<polygon fill="lightgreen" stroke="black" points="22050,-1411.9 21792,-1411.9 21792,-1370.9 22050,-1370.9 22050,-1411.9"/>
<text text-anchor="middle" x="21921" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;42 Layer&#45;11 GPU&#45;42</text>
<text text-anchor="middle" x="21921" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21921" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g3 -->
<g id="node378" class="node">
<title>attn_s1_t1_g3</title>
<polygon fill="lightgreen" stroke="black" points="20099.5,-1411.9 19824.5,-1411.9 19824.5,-1370.9 20099.5,-1370.9 20099.5,-1411.9"/>
<text text-anchor="middle" x="19962" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;43</text>
<text text-anchor="middle" x="19962" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g3 -->
<g id="node379" class="node">
<title>gate_s1_t1_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="20227.32,-1334.9 19805.26,-1334.9 19696.68,-1252.9 20118.74,-1252.9 20227.32,-1334.9"/>
<text text-anchor="middle" x="19962" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;43</text>
<text text-anchor="middle" x="19962" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g3&#45;&gt;gate_s1_t1_g3 -->
<g id="edge133" class="edge">
<title>attn_s1_t1_g3&#45;&gt;gate_s1_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-1370.61C19962,-1363.15 19962,-1354.28 19962,-1345.28"/>
<polygon fill="black" stroke="black" points="19965.5,-1345.14 19962,-1335.14 19958.5,-1345.14 19965.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g3_l6 -->
<g id="node380" class="node">
<title>expert_s1_t1_g3_l6</title>
<polygon fill="lightgreen" stroke="black" points="20091,-1216.9 19833,-1216.9 19833,-1175.9 20091,-1175.9 20091,-1216.9"/>
<text text-anchor="middle" x="19962" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;6 GPU&#45;43</text>
<text text-anchor="middle" x="19962" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g3&#45;&gt;expert_s1_t1_g3_l6 -->
<g id="edge134" class="edge">
<title>gate_s1_t1_g3&#45;&gt;expert_s1_t1_g3_l6</title>
<path fill="none" stroke="black" d="M19962,-1252.67C19962,-1244.1 19962,-1235.19 19962,-1227.09"/>
<polygon fill="black" stroke="black" points="19965.5,-1227.01 19962,-1217.01 19958.5,-1227.01 19965.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g3 -->
<g id="node557" class="node">
<title>comm_s1_t1_g3</title>
<ellipse fill="lightblue" stroke="black" cx="19962" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="19962" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;43</text>
<text text-anchor="middle" x="19962" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g3_l6&#45;&gt;comm_s1_t1_g3 -->
<g id="edge135" class="edge">
<title>expert_s1_t1_g3_l6&#45;&gt;comm_s1_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-1175.61C19962,-1167.99 19962,-1158.99 19962,-1150.21"/>
<polygon fill="black" stroke="black" points="19965.5,-1150.08 19962,-1140.08 19958.5,-1150.08 19965.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g3_l7 -->
<g id="node381" class="node">
<title>expert_s1_t1_g3_l7</title>
<polygon fill="lightgreen" stroke="black" points="21480,-1411.9 21222,-1411.9 21222,-1370.9 21480,-1370.9 21480,-1411.9"/>
<text text-anchor="middle" x="21351" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;7 GPU&#45;43</text>
<text text-anchor="middle" x="21351" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21351" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g3_l8 -->
<g id="node382" class="node">
<title>expert_s1_t1_g3_l8</title>
<polygon fill="lightgreen" stroke="black" points="21204,-1411.9 20946,-1411.9 20946,-1370.9 21204,-1370.9 21204,-1411.9"/>
<text text-anchor="middle" x="21075" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;8 GPU&#45;43</text>
<text text-anchor="middle" x="21075" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21075" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g3_l9 -->
<g id="node383" class="node">
<title>expert_s1_t1_g3_l9</title>
<polygon fill="lightgreen" stroke="black" points="20928,-1411.9 20670,-1411.9 20670,-1370.9 20928,-1370.9 20928,-1411.9"/>
<text text-anchor="middle" x="20799" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;9 GPU&#45;43</text>
<text text-anchor="middle" x="20799" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20799" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g3_l10 -->
<g id="node384" class="node">
<title>expert_s1_t1_g3_l10</title>
<polygon fill="lightgreen" stroke="black" points="20652,-1411.9 20394,-1411.9 20394,-1370.9 20652,-1370.9 20652,-1411.9"/>
<text text-anchor="middle" x="20523" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;10 GPU&#45;43</text>
<text text-anchor="middle" x="20523" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20523" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g3_l11 -->
<g id="node385" class="node">
<title>expert_s1_t1_g3_l11</title>
<polygon fill="lightgreen" stroke="black" points="20376,-1411.9 20118,-1411.9 20118,-1370.9 20376,-1370.9 20376,-1411.9"/>
<text text-anchor="middle" x="20247" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;43 Layer&#45;11 GPU&#45;43</text>
<text text-anchor="middle" x="20247" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20247" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g4 -->
<g id="node386" class="node">
<title>attn_s1_t1_g4</title>
<polygon fill="lightgreen" stroke="black" points="21773.5,-1411.9 21498.5,-1411.9 21498.5,-1370.9 21773.5,-1370.9 21773.5,-1411.9"/>
<text text-anchor="middle" x="21636" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;44</text>
<text text-anchor="middle" x="21636" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g4 -->
<g id="node387" class="node">
<title>gate_s1_t1_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="21901.32,-1334.9 21479.26,-1334.9 21370.68,-1252.9 21792.74,-1252.9 21901.32,-1334.9"/>
<text text-anchor="middle" x="21636" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;44</text>
<text text-anchor="middle" x="21636" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g4&#45;&gt;gate_s1_t1_g4 -->
<g id="edge136" class="edge">
<title>attn_s1_t1_g4&#45;&gt;gate_s1_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-1370.61C21636,-1363.15 21636,-1354.28 21636,-1345.28"/>
<polygon fill="black" stroke="black" points="21639.5,-1345.14 21636,-1335.14 21632.5,-1345.14 21639.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g4_l6 -->
<g id="node388" class="node">
<title>expert_s1_t1_g4_l6</title>
<polygon fill="lightgreen" stroke="black" points="21765,-1216.9 21507,-1216.9 21507,-1175.9 21765,-1175.9 21765,-1216.9"/>
<text text-anchor="middle" x="21636" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;6 GPU&#45;44</text>
<text text-anchor="middle" x="21636" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g4&#45;&gt;expert_s1_t1_g4_l6 -->
<g id="edge137" class="edge">
<title>gate_s1_t1_g4&#45;&gt;expert_s1_t1_g4_l6</title>
<path fill="none" stroke="black" d="M21636,-1252.67C21636,-1244.1 21636,-1235.19 21636,-1227.09"/>
<polygon fill="black" stroke="black" points="21639.5,-1227.01 21636,-1217.01 21632.5,-1227.01 21639.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g4 -->
<g id="node558" class="node">
<title>comm_s1_t1_g4</title>
<ellipse fill="lightblue" stroke="black" cx="21636" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="21636" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;44</text>
<text text-anchor="middle" x="21636" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g4_l6&#45;&gt;comm_s1_t1_g4 -->
<g id="edge138" class="edge">
<title>expert_s1_t1_g4_l6&#45;&gt;comm_s1_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-1175.61C21636,-1167.99 21636,-1158.99 21636,-1150.21"/>
<polygon fill="black" stroke="black" points="21639.5,-1150.08 21636,-1140.08 21632.5,-1150.08 21639.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g4_l7 -->
<g id="node389" class="node">
<title>expert_s1_t1_g4_l7</title>
<polygon fill="lightgreen" stroke="black" points="19806,-1411.9 19548,-1411.9 19548,-1370.9 19806,-1370.9 19806,-1411.9"/>
<text text-anchor="middle" x="19677" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;7 GPU&#45;44</text>
<text text-anchor="middle" x="19677" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19677" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g4_l8 -->
<g id="node390" class="node">
<title>expert_s1_t1_g4_l8</title>
<polygon fill="lightgreen" stroke="black" points="19530,-1411.9 19272,-1411.9 19272,-1370.9 19530,-1370.9 19530,-1411.9"/>
<text text-anchor="middle" x="19401" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;8 GPU&#45;44</text>
<text text-anchor="middle" x="19401" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19401" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g4_l9 -->
<g id="node391" class="node">
<title>expert_s1_t1_g4_l9</title>
<polygon fill="lightgreen" stroke="black" points="19254,-1411.9 18996,-1411.9 18996,-1370.9 19254,-1370.9 19254,-1411.9"/>
<text text-anchor="middle" x="19125" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;9 GPU&#45;44</text>
<text text-anchor="middle" x="19125" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19125" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g4_l10 -->
<g id="node392" class="node">
<title>expert_s1_t1_g4_l10</title>
<polygon fill="lightgreen" stroke="black" points="18978,-1411.9 18720,-1411.9 18720,-1370.9 18978,-1370.9 18978,-1411.9"/>
<text text-anchor="middle" x="18849" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;10 GPU&#45;44</text>
<text text-anchor="middle" x="18849" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18849" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g4_l11 -->
<g id="node393" class="node">
<title>expert_s1_t1_g4_l11</title>
<polygon fill="lightgreen" stroke="black" points="18702,-1411.9 18444,-1411.9 18444,-1370.9 18702,-1370.9 18702,-1411.9"/>
<text text-anchor="middle" x="18573" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;44 Layer&#45;11 GPU&#45;44</text>
<text text-anchor="middle" x="18573" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18573" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g5 -->
<g id="node394" class="node">
<title>attn_s1_t1_g5</title>
<polygon fill="lightgreen" stroke="black" points="23447.5,-1411.9 23172.5,-1411.9 23172.5,-1370.9 23447.5,-1370.9 23447.5,-1411.9"/>
<text text-anchor="middle" x="23310" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;45</text>
<text text-anchor="middle" x="23310" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g5 -->
<g id="node395" class="node">
<title>gate_s1_t1_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="23575.32,-1334.9 23153.26,-1334.9 23044.68,-1252.9 23466.74,-1252.9 23575.32,-1334.9"/>
<text text-anchor="middle" x="23310" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;45</text>
<text text-anchor="middle" x="23310" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g5&#45;&gt;gate_s1_t1_g5 -->
<g id="edge139" class="edge">
<title>attn_s1_t1_g5&#45;&gt;gate_s1_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-1370.61C23310,-1363.15 23310,-1354.28 23310,-1345.28"/>
<polygon fill="black" stroke="black" points="23313.5,-1345.14 23310,-1335.14 23306.5,-1345.14 23313.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g5_l6 -->
<g id="node396" class="node">
<title>expert_s1_t1_g5_l6</title>
<polygon fill="lightgreen" stroke="black" points="23439,-1216.9 23181,-1216.9 23181,-1175.9 23439,-1175.9 23439,-1216.9"/>
<text text-anchor="middle" x="23310" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;6 GPU&#45;45</text>
<text text-anchor="middle" x="23310" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g5&#45;&gt;expert_s1_t1_g5_l6 -->
<g id="edge140" class="edge">
<title>gate_s1_t1_g5&#45;&gt;expert_s1_t1_g5_l6</title>
<path fill="none" stroke="black" d="M23310,-1252.67C23310,-1244.1 23310,-1235.19 23310,-1227.09"/>
<polygon fill="black" stroke="black" points="23313.5,-1227.01 23310,-1217.01 23306.5,-1227.01 23313.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g5 -->
<g id="node559" class="node">
<title>comm_s1_t1_g5</title>
<ellipse fill="lightblue" stroke="black" cx="23310" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="23310" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;45</text>
<text text-anchor="middle" x="23310" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g5_l6&#45;&gt;comm_s1_t1_g5 -->
<g id="edge141" class="edge">
<title>expert_s1_t1_g5_l6&#45;&gt;comm_s1_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-1175.61C23310,-1167.99 23310,-1158.99 23310,-1150.21"/>
<polygon fill="black" stroke="black" points="23313.5,-1150.08 23310,-1140.08 23306.5,-1150.08 23313.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g5_l7 -->
<g id="node397" class="node">
<title>expert_s1_t1_g5_l7</title>
<polygon fill="lightgreen" stroke="black" points="18132,-1411.9 17874,-1411.9 17874,-1370.9 18132,-1370.9 18132,-1411.9"/>
<text text-anchor="middle" x="18003" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;7 GPU&#45;45</text>
<text text-anchor="middle" x="18003" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18003" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g5_l8 -->
<g id="node398" class="node">
<title>expert_s1_t1_g5_l8</title>
<polygon fill="lightgreen" stroke="black" points="17856,-1411.9 17598,-1411.9 17598,-1370.9 17856,-1370.9 17856,-1411.9"/>
<text text-anchor="middle" x="17727" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;8 GPU&#45;45</text>
<text text-anchor="middle" x="17727" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17727" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g5_l9 -->
<g id="node399" class="node">
<title>expert_s1_t1_g5_l9</title>
<polygon fill="lightgreen" stroke="black" points="17580,-1411.9 17322,-1411.9 17322,-1370.9 17580,-1370.9 17580,-1411.9"/>
<text text-anchor="middle" x="17451" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;9 GPU&#45;45</text>
<text text-anchor="middle" x="17451" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17451" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g5_l10 -->
<g id="node400" class="node">
<title>expert_s1_t1_g5_l10</title>
<polygon fill="lightgreen" stroke="black" points="17304,-1411.9 17046,-1411.9 17046,-1370.9 17304,-1370.9 17304,-1411.9"/>
<text text-anchor="middle" x="17175" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;10 GPU&#45;45</text>
<text text-anchor="middle" x="17175" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17175" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g5_l11 -->
<g id="node401" class="node">
<title>expert_s1_t1_g5_l11</title>
<polygon fill="lightgreen" stroke="black" points="17028,-1411.9 16770,-1411.9 16770,-1370.9 17028,-1370.9 17028,-1411.9"/>
<text text-anchor="middle" x="16899" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;45 Layer&#45;11 GPU&#45;45</text>
<text text-anchor="middle" x="16899" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16899" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g6 -->
<g id="node402" class="node">
<title>attn_s1_t1_g6</title>
<polygon fill="lightgreen" stroke="black" points="25121.5,-1411.9 24846.5,-1411.9 24846.5,-1370.9 25121.5,-1370.9 25121.5,-1411.9"/>
<text text-anchor="middle" x="24984" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;46</text>
<text text-anchor="middle" x="24984" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g6 -->
<g id="node403" class="node">
<title>gate_s1_t1_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="25249.32,-1334.9 24827.26,-1334.9 24718.68,-1252.9 25140.74,-1252.9 25249.32,-1334.9"/>
<text text-anchor="middle" x="24984" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;46</text>
<text text-anchor="middle" x="24984" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g6&#45;&gt;gate_s1_t1_g6 -->
<g id="edge142" class="edge">
<title>attn_s1_t1_g6&#45;&gt;gate_s1_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-1370.61C24984,-1363.15 24984,-1354.28 24984,-1345.28"/>
<polygon fill="black" stroke="black" points="24987.5,-1345.14 24984,-1335.14 24980.5,-1345.14 24987.5,-1345.14"/>
</g>
<!-- expert_s1_t1_g6_l6 -->
<g id="node404" class="node">
<title>expert_s1_t1_g6_l6</title>
<polygon fill="lightgreen" stroke="black" points="25113,-1216.9 24855,-1216.9 24855,-1175.9 25113,-1175.9 25113,-1216.9"/>
<text text-anchor="middle" x="24984" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;6 GPU&#45;46</text>
<text text-anchor="middle" x="24984" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g6&#45;&gt;expert_s1_t1_g6_l6 -->
<g id="edge143" class="edge">
<title>gate_s1_t1_g6&#45;&gt;expert_s1_t1_g6_l6</title>
<path fill="none" stroke="black" d="M24984,-1252.67C24984,-1244.1 24984,-1235.19 24984,-1227.09"/>
<polygon fill="black" stroke="black" points="24987.5,-1227.01 24984,-1217.01 24980.5,-1227.01 24987.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g6 -->
<g id="node560" class="node">
<title>comm_s1_t1_g6</title>
<ellipse fill="lightblue" stroke="black" cx="24984" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="24984" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;46</text>
<text text-anchor="middle" x="24984" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g6_l6&#45;&gt;comm_s1_t1_g6 -->
<g id="edge144" class="edge">
<title>expert_s1_t1_g6_l6&#45;&gt;comm_s1_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-1175.61C24984,-1167.99 24984,-1158.99 24984,-1150.21"/>
<polygon fill="black" stroke="black" points="24987.5,-1150.08 24984,-1140.08 24980.5,-1150.08 24987.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g6_l7 -->
<g id="node405" class="node">
<title>expert_s1_t1_g6_l7</title>
<polygon fill="lightgreen" stroke="black" points="16458,-1411.9 16200,-1411.9 16200,-1370.9 16458,-1370.9 16458,-1411.9"/>
<text text-anchor="middle" x="16329" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;7 GPU&#45;46</text>
<text text-anchor="middle" x="16329" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16329" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g6_l8 -->
<g id="node406" class="node">
<title>expert_s1_t1_g6_l8</title>
<polygon fill="lightgreen" stroke="black" points="16182,-1411.9 15924,-1411.9 15924,-1370.9 16182,-1370.9 16182,-1411.9"/>
<text text-anchor="middle" x="16053" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;8 GPU&#45;46</text>
<text text-anchor="middle" x="16053" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16053" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g6_l9 -->
<g id="node407" class="node">
<title>expert_s1_t1_g6_l9</title>
<polygon fill="lightgreen" stroke="black" points="15906,-1411.9 15648,-1411.9 15648,-1370.9 15906,-1370.9 15906,-1411.9"/>
<text text-anchor="middle" x="15777" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;9 GPU&#45;46</text>
<text text-anchor="middle" x="15777" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15777" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g6_l10 -->
<g id="node408" class="node">
<title>expert_s1_t1_g6_l10</title>
<polygon fill="lightgreen" stroke="black" points="15630,-1411.9 15372,-1411.9 15372,-1370.9 15630,-1370.9 15630,-1411.9"/>
<text text-anchor="middle" x="15501" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;10 GPU&#45;46</text>
<text text-anchor="middle" x="15501" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15501" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g6_l11 -->
<g id="node409" class="node">
<title>expert_s1_t1_g6_l11</title>
<polygon fill="lightgreen" stroke="black" points="15354,-1411.9 15096,-1411.9 15096,-1370.9 15354,-1370.9 15354,-1411.9"/>
<text text-anchor="middle" x="15225" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;46 Layer&#45;11 GPU&#45;46</text>
<text text-anchor="middle" x="15225" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15225" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t1_g7 -->
<g id="node410" class="node">
<title>attn_s1_t1_g7</title>
<polygon fill="lightgreen" stroke="black" points="26795.5,-1411.9 26520.5,-1411.9 26520.5,-1370.9 26795.5,-1370.9 26795.5,-1411.9"/>
<text text-anchor="middle" x="26658" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;47</text>
<text text-anchor="middle" x="26658" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26658" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t1_g7 -->
<g id="node411" class="node">
<title>gate_s1_t1_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="26796.32,-1334.9 26374.26,-1334.9 26265.68,-1252.9 26687.74,-1252.9 26796.32,-1334.9"/>
<text text-anchor="middle" x="26531" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;47</text>
<text text-anchor="middle" x="26531" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t1_g7&#45;&gt;gate_s1_t1_g7 -->
<g id="edge145" class="edge">
<title>attn_s1_t1_g7&#45;&gt;gate_s1_t1_g7</title>
<path fill="none" stroke="black" d="M26631.99,-1370.84C26620.47,-1362.17 26606.37,-1351.57 26592.41,-1341.08"/>
<polygon fill="black" stroke="black" points="26594.33,-1338.14 26584.23,-1334.92 26590.12,-1343.73 26594.33,-1338.14"/>
</g>
<!-- expert_s1_t1_g7_l6 -->
<g id="node412" class="node">
<title>expert_s1_t1_g7_l6</title>
<polygon fill="lightgreen" stroke="black" points="26660,-1216.9 26402,-1216.9 26402,-1175.9 26660,-1175.9 26660,-1216.9"/>
<text text-anchor="middle" x="26531" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;6 GPU&#45;47</text>
<text text-anchor="middle" x="26531" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t1_g7&#45;&gt;expert_s1_t1_g7_l6 -->
<g id="edge146" class="edge">
<title>gate_s1_t1_g7&#45;&gt;expert_s1_t1_g7_l6</title>
<path fill="none" stroke="black" d="M26531,-1252.67C26531,-1244.1 26531,-1235.19 26531,-1227.09"/>
<polygon fill="black" stroke="black" points="26534.5,-1227.01 26531,-1217.01 26527.5,-1227.01 26534.5,-1227.01"/>
</g>
<!-- comm_s1_t1_g7 -->
<g id="node561" class="node">
<title>comm_s1_t1_g7</title>
<ellipse fill="lightblue" stroke="black" cx="26531" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="26531" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;47</text>
<text text-anchor="middle" x="26531" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26531" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t1_g7_l6&#45;&gt;comm_s1_t1_g7 -->
<g id="edge147" class="edge">
<title>expert_s1_t1_g7_l6&#45;&gt;comm_s1_t1_g7</title>
<path fill="none" stroke="black" d="M26531,-1175.61C26531,-1167.99 26531,-1158.99 26531,-1150.21"/>
<polygon fill="black" stroke="black" points="26534.5,-1150.08 26531,-1140.08 26527.5,-1150.08 26534.5,-1150.08"/>
</g>
<!-- expert_s1_t1_g7_l7 -->
<g id="node413" class="node">
<title>expert_s1_t1_g7_l7</title>
<polygon fill="lightgreen" stroke="black" points="14784,-1411.9 14526,-1411.9 14526,-1370.9 14784,-1370.9 14784,-1411.9"/>
<text text-anchor="middle" x="14655" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;7 GPU&#45;47</text>
<text text-anchor="middle" x="14655" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14655" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g7_l8 -->
<g id="node414" class="node">
<title>expert_s1_t1_g7_l8</title>
<polygon fill="lightgreen" stroke="black" points="14508,-1411.9 14250,-1411.9 14250,-1370.9 14508,-1370.9 14508,-1411.9"/>
<text text-anchor="middle" x="14379" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;8 GPU&#45;47</text>
<text text-anchor="middle" x="14379" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14379" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g7_l9 -->
<g id="node415" class="node">
<title>expert_s1_t1_g7_l9</title>
<polygon fill="lightgreen" stroke="black" points="14232,-1411.9 13974,-1411.9 13974,-1370.9 14232,-1370.9 14232,-1411.9"/>
<text text-anchor="middle" x="14103" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;9 GPU&#45;47</text>
<text text-anchor="middle" x="14103" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14103" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g7_l10 -->
<g id="node416" class="node">
<title>expert_s1_t1_g7_l10</title>
<polygon fill="lightgreen" stroke="black" points="13956,-1411.9 13698,-1411.9 13698,-1370.9 13956,-1370.9 13956,-1411.9"/>
<text text-anchor="middle" x="13827" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;10 GPU&#45;47</text>
<text text-anchor="middle" x="13827" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13827" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t1_g7_l11 -->
<g id="node417" class="node">
<title>expert_s1_t1_g7_l11</title>
<polygon fill="lightgreen" stroke="black" points="13680,-1411.9 13422,-1411.9 13422,-1370.9 13680,-1370.9 13680,-1411.9"/>
<text text-anchor="middle" x="13551" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;47 Layer&#45;11 GPU&#45;47</text>
<text text-anchor="middle" x="13551" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13551" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g0 -->
<g id="node418" class="node">
<title>attn_s1_t2_g0</title>
<polygon fill="lightgreen" stroke="black" points="28475.5,-1411.9 28200.5,-1411.9 28200.5,-1370.9 28475.5,-1370.9 28475.5,-1411.9"/>
<text text-anchor="middle" x="28338" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;48</text>
<text text-anchor="middle" x="28338" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g0 -->
<g id="node419" class="node">
<title>gate_s1_t2_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="28603.32,-1334.9 28181.26,-1334.9 28072.68,-1252.9 28494.74,-1252.9 28603.32,-1334.9"/>
<text text-anchor="middle" x="28338" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;48</text>
<text text-anchor="middle" x="28338" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g0&#45;&gt;gate_s1_t2_g0 -->
<g id="edge148" class="edge">
<title>attn_s1_t2_g0&#45;&gt;gate_s1_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-1370.61C28338,-1363.15 28338,-1354.28 28338,-1345.28"/>
<polygon fill="black" stroke="black" points="28341.5,-1345.14 28338,-1335.14 28334.5,-1345.14 28341.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g0_l6 -->
<g id="node420" class="node">
<title>expert_s1_t2_g0_l6</title>
<polygon fill="lightgreen" stroke="black" points="28467,-1216.9 28209,-1216.9 28209,-1175.9 28467,-1175.9 28467,-1216.9"/>
<text text-anchor="middle" x="28338" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;6 GPU&#45;48</text>
<text text-anchor="middle" x="28338" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g0&#45;&gt;expert_s1_t2_g0_l6 -->
<g id="edge149" class="edge">
<title>gate_s1_t2_g0&#45;&gt;expert_s1_t2_g0_l6</title>
<path fill="none" stroke="black" d="M28338,-1252.67C28338,-1244.1 28338,-1235.19 28338,-1227.09"/>
<polygon fill="black" stroke="black" points="28341.5,-1227.01 28338,-1217.01 28334.5,-1227.01 28341.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g0 -->
<g id="node562" class="node">
<title>comm_s1_t2_g0</title>
<ellipse fill="lightblue" stroke="black" cx="28338" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="28338" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;48</text>
<text text-anchor="middle" x="28338" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g0_l6&#45;&gt;comm_s1_t2_g0 -->
<g id="edge150" class="edge">
<title>expert_s1_t2_g0_l6&#45;&gt;comm_s1_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-1175.61C28338,-1167.99 28338,-1158.99 28338,-1150.21"/>
<polygon fill="black" stroke="black" points="28341.5,-1150.08 28338,-1140.08 28334.5,-1150.08 28341.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g0_l7 -->
<g id="node421" class="node">
<title>expert_s1_t2_g0_l7</title>
<polygon fill="lightgreen" stroke="black" points="39900,-1411.9 39642,-1411.9 39642,-1370.9 39900,-1370.9 39900,-1411.9"/>
<text text-anchor="middle" x="39771" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;7 GPU&#45;48</text>
<text text-anchor="middle" x="39771" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39771" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g0_l8 -->
<g id="node422" class="node">
<title>expert_s1_t2_g0_l8</title>
<polygon fill="lightgreen" stroke="black" points="39624,-1411.9 39366,-1411.9 39366,-1370.9 39624,-1370.9 39624,-1411.9"/>
<text text-anchor="middle" x="39495" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;8 GPU&#45;48</text>
<text text-anchor="middle" x="39495" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39495" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g0_l9 -->
<g id="node423" class="node">
<title>expert_s1_t2_g0_l9</title>
<polygon fill="lightgreen" stroke="black" points="39348,-1411.9 39090,-1411.9 39090,-1370.9 39348,-1370.9 39348,-1411.9"/>
<text text-anchor="middle" x="39219" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;9 GPU&#45;48</text>
<text text-anchor="middle" x="39219" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39219" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g0_l10 -->
<g id="node424" class="node">
<title>expert_s1_t2_g0_l10</title>
<polygon fill="lightgreen" stroke="black" points="39072,-1411.9 38814,-1411.9 38814,-1370.9 39072,-1370.9 39072,-1411.9"/>
<text text-anchor="middle" x="38943" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;10 GPU&#45;48</text>
<text text-anchor="middle" x="38943" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38943" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g0_l11 -->
<g id="node425" class="node">
<title>expert_s1_t2_g0_l11</title>
<polygon fill="lightgreen" stroke="black" points="38796,-1411.9 38538,-1411.9 38538,-1370.9 38796,-1370.9 38796,-1411.9"/>
<text text-anchor="middle" x="38667" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;48 Layer&#45;11 GPU&#45;48</text>
<text text-anchor="middle" x="38667" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38667" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g1 -->
<g id="node426" class="node">
<title>attn_s1_t2_g1</title>
<polygon fill="lightgreen" stroke="black" points="30149.5,-1411.9 29874.5,-1411.9 29874.5,-1370.9 30149.5,-1370.9 30149.5,-1411.9"/>
<text text-anchor="middle" x="30012" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;49</text>
<text text-anchor="middle" x="30012" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g1 -->
<g id="node427" class="node">
<title>gate_s1_t2_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="30277.32,-1334.9 29855.26,-1334.9 29746.68,-1252.9 30168.74,-1252.9 30277.32,-1334.9"/>
<text text-anchor="middle" x="30012" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;49</text>
<text text-anchor="middle" x="30012" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g1&#45;&gt;gate_s1_t2_g1 -->
<g id="edge151" class="edge">
<title>attn_s1_t2_g1&#45;&gt;gate_s1_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-1370.61C30012,-1363.15 30012,-1354.28 30012,-1345.28"/>
<polygon fill="black" stroke="black" points="30015.5,-1345.14 30012,-1335.14 30008.5,-1345.14 30015.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g1_l6 -->
<g id="node428" class="node">
<title>expert_s1_t2_g1_l6</title>
<polygon fill="lightgreen" stroke="black" points="30141,-1216.9 29883,-1216.9 29883,-1175.9 30141,-1175.9 30141,-1216.9"/>
<text text-anchor="middle" x="30012" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;6 GPU&#45;49</text>
<text text-anchor="middle" x="30012" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g1&#45;&gt;expert_s1_t2_g1_l6 -->
<g id="edge152" class="edge">
<title>gate_s1_t2_g1&#45;&gt;expert_s1_t2_g1_l6</title>
<path fill="none" stroke="black" d="M30012,-1252.67C30012,-1244.1 30012,-1235.19 30012,-1227.09"/>
<polygon fill="black" stroke="black" points="30015.5,-1227.01 30012,-1217.01 30008.5,-1227.01 30015.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g1 -->
<g id="node563" class="node">
<title>comm_s1_t2_g1</title>
<ellipse fill="lightblue" stroke="black" cx="30012" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="30012" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;49</text>
<text text-anchor="middle" x="30012" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g1_l6&#45;&gt;comm_s1_t2_g1 -->
<g id="edge153" class="edge">
<title>expert_s1_t2_g1_l6&#45;&gt;comm_s1_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-1175.61C30012,-1167.99 30012,-1158.99 30012,-1150.21"/>
<polygon fill="black" stroke="black" points="30015.5,-1150.08 30012,-1140.08 30008.5,-1150.08 30015.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g1_l7 -->
<g id="node429" class="node">
<title>expert_s1_t2_g1_l7</title>
<polygon fill="lightgreen" stroke="black" points="38226,-1411.9 37968,-1411.9 37968,-1370.9 38226,-1370.9 38226,-1411.9"/>
<text text-anchor="middle" x="38097" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;7 GPU&#45;49</text>
<text text-anchor="middle" x="38097" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38097" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g1_l8 -->
<g id="node430" class="node">
<title>expert_s1_t2_g1_l8</title>
<polygon fill="lightgreen" stroke="black" points="37950,-1411.9 37692,-1411.9 37692,-1370.9 37950,-1370.9 37950,-1411.9"/>
<text text-anchor="middle" x="37821" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;8 GPU&#45;49</text>
<text text-anchor="middle" x="37821" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37821" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g1_l9 -->
<g id="node431" class="node">
<title>expert_s1_t2_g1_l9</title>
<polygon fill="lightgreen" stroke="black" points="37674,-1411.9 37416,-1411.9 37416,-1370.9 37674,-1370.9 37674,-1411.9"/>
<text text-anchor="middle" x="37545" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;9 GPU&#45;49</text>
<text text-anchor="middle" x="37545" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37545" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g1_l10 -->
<g id="node432" class="node">
<title>expert_s1_t2_g1_l10</title>
<polygon fill="lightgreen" stroke="black" points="37398,-1411.9 37140,-1411.9 37140,-1370.9 37398,-1370.9 37398,-1411.9"/>
<text text-anchor="middle" x="37269" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;10 GPU&#45;49</text>
<text text-anchor="middle" x="37269" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37269" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g1_l11 -->
<g id="node433" class="node">
<title>expert_s1_t2_g1_l11</title>
<polygon fill="lightgreen" stroke="black" points="37122,-1411.9 36864,-1411.9 36864,-1370.9 37122,-1370.9 37122,-1411.9"/>
<text text-anchor="middle" x="36993" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;49 Layer&#45;11 GPU&#45;49</text>
<text text-anchor="middle" x="36993" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36993" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g2 -->
<g id="node434" class="node">
<title>attn_s1_t2_g2</title>
<polygon fill="lightgreen" stroke="black" points="31823.5,-1411.9 31548.5,-1411.9 31548.5,-1370.9 31823.5,-1370.9 31823.5,-1411.9"/>
<text text-anchor="middle" x="31686" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;50</text>
<text text-anchor="middle" x="31686" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g2 -->
<g id="node435" class="node">
<title>gate_s1_t2_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="31951.32,-1334.9 31529.26,-1334.9 31420.68,-1252.9 31842.74,-1252.9 31951.32,-1334.9"/>
<text text-anchor="middle" x="31686" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;50</text>
<text text-anchor="middle" x="31686" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g2&#45;&gt;gate_s1_t2_g2 -->
<g id="edge154" class="edge">
<title>attn_s1_t2_g2&#45;&gt;gate_s1_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-1370.61C31686,-1363.15 31686,-1354.28 31686,-1345.28"/>
<polygon fill="black" stroke="black" points="31689.5,-1345.14 31686,-1335.14 31682.5,-1345.14 31689.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g2_l6 -->
<g id="node436" class="node">
<title>expert_s1_t2_g2_l6</title>
<polygon fill="lightgreen" stroke="black" points="31815,-1216.9 31557,-1216.9 31557,-1175.9 31815,-1175.9 31815,-1216.9"/>
<text text-anchor="middle" x="31686" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;6 GPU&#45;50</text>
<text text-anchor="middle" x="31686" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g2&#45;&gt;expert_s1_t2_g2_l6 -->
<g id="edge155" class="edge">
<title>gate_s1_t2_g2&#45;&gt;expert_s1_t2_g2_l6</title>
<path fill="none" stroke="black" d="M31686,-1252.67C31686,-1244.1 31686,-1235.19 31686,-1227.09"/>
<polygon fill="black" stroke="black" points="31689.5,-1227.01 31686,-1217.01 31682.5,-1227.01 31689.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g2 -->
<g id="node564" class="node">
<title>comm_s1_t2_g2</title>
<ellipse fill="lightblue" stroke="black" cx="31686" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="31686" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;50</text>
<text text-anchor="middle" x="31686" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g2_l6&#45;&gt;comm_s1_t2_g2 -->
<g id="edge156" class="edge">
<title>expert_s1_t2_g2_l6&#45;&gt;comm_s1_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-1175.61C31686,-1167.99 31686,-1158.99 31686,-1150.21"/>
<polygon fill="black" stroke="black" points="31689.5,-1150.08 31686,-1140.08 31682.5,-1150.08 31689.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g2_l7 -->
<g id="node437" class="node">
<title>expert_s1_t2_g2_l7</title>
<polygon fill="lightgreen" stroke="black" points="36552,-1411.9 36294,-1411.9 36294,-1370.9 36552,-1370.9 36552,-1411.9"/>
<text text-anchor="middle" x="36423" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;7 GPU&#45;50</text>
<text text-anchor="middle" x="36423" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36423" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g2_l8 -->
<g id="node438" class="node">
<title>expert_s1_t2_g2_l8</title>
<polygon fill="lightgreen" stroke="black" points="36276,-1411.9 36018,-1411.9 36018,-1370.9 36276,-1370.9 36276,-1411.9"/>
<text text-anchor="middle" x="36147" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;8 GPU&#45;50</text>
<text text-anchor="middle" x="36147" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36147" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g2_l9 -->
<g id="node439" class="node">
<title>expert_s1_t2_g2_l9</title>
<polygon fill="lightgreen" stroke="black" points="36000,-1411.9 35742,-1411.9 35742,-1370.9 36000,-1370.9 36000,-1411.9"/>
<text text-anchor="middle" x="35871" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;9 GPU&#45;50</text>
<text text-anchor="middle" x="35871" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35871" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g2_l10 -->
<g id="node440" class="node">
<title>expert_s1_t2_g2_l10</title>
<polygon fill="lightgreen" stroke="black" points="35724,-1411.9 35466,-1411.9 35466,-1370.9 35724,-1370.9 35724,-1411.9"/>
<text text-anchor="middle" x="35595" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;10 GPU&#45;50</text>
<text text-anchor="middle" x="35595" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35595" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g2_l11 -->
<g id="node441" class="node">
<title>expert_s1_t2_g2_l11</title>
<polygon fill="lightgreen" stroke="black" points="35448,-1411.9 35190,-1411.9 35190,-1370.9 35448,-1370.9 35448,-1411.9"/>
<text text-anchor="middle" x="35319" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;50 Layer&#45;11 GPU&#45;50</text>
<text text-anchor="middle" x="35319" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35319" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g3 -->
<g id="node442" class="node">
<title>attn_s1_t2_g3</title>
<polygon fill="lightgreen" stroke="black" points="33497.5,-1411.9 33222.5,-1411.9 33222.5,-1370.9 33497.5,-1370.9 33497.5,-1411.9"/>
<text text-anchor="middle" x="33360" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;51</text>
<text text-anchor="middle" x="33360" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g3 -->
<g id="node443" class="node">
<title>gate_s1_t2_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="33625.32,-1334.9 33203.26,-1334.9 33094.68,-1252.9 33516.74,-1252.9 33625.32,-1334.9"/>
<text text-anchor="middle" x="33360" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;51</text>
<text text-anchor="middle" x="33360" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g3&#45;&gt;gate_s1_t2_g3 -->
<g id="edge157" class="edge">
<title>attn_s1_t2_g3&#45;&gt;gate_s1_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-1370.61C33360,-1363.15 33360,-1354.28 33360,-1345.28"/>
<polygon fill="black" stroke="black" points="33363.5,-1345.14 33360,-1335.14 33356.5,-1345.14 33363.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g3_l6 -->
<g id="node444" class="node">
<title>expert_s1_t2_g3_l6</title>
<polygon fill="lightgreen" stroke="black" points="33489,-1216.9 33231,-1216.9 33231,-1175.9 33489,-1175.9 33489,-1216.9"/>
<text text-anchor="middle" x="33360" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;6 GPU&#45;51</text>
<text text-anchor="middle" x="33360" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g3&#45;&gt;expert_s1_t2_g3_l6 -->
<g id="edge158" class="edge">
<title>gate_s1_t2_g3&#45;&gt;expert_s1_t2_g3_l6</title>
<path fill="none" stroke="black" d="M33360,-1252.67C33360,-1244.1 33360,-1235.19 33360,-1227.09"/>
<polygon fill="black" stroke="black" points="33363.5,-1227.01 33360,-1217.01 33356.5,-1227.01 33363.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g3 -->
<g id="node565" class="node">
<title>comm_s1_t2_g3</title>
<ellipse fill="lightblue" stroke="black" cx="33360" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="33360" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;51</text>
<text text-anchor="middle" x="33360" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g3_l6&#45;&gt;comm_s1_t2_g3 -->
<g id="edge159" class="edge">
<title>expert_s1_t2_g3_l6&#45;&gt;comm_s1_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-1175.61C33360,-1167.99 33360,-1158.99 33360,-1150.21"/>
<polygon fill="black" stroke="black" points="33363.5,-1150.08 33360,-1140.08 33356.5,-1150.08 33363.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g3_l7 -->
<g id="node445" class="node">
<title>expert_s1_t2_g3_l7</title>
<polygon fill="lightgreen" stroke="black" points="34878,-1411.9 34620,-1411.9 34620,-1370.9 34878,-1370.9 34878,-1411.9"/>
<text text-anchor="middle" x="34749" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;7 GPU&#45;51</text>
<text text-anchor="middle" x="34749" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34749" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g3_l8 -->
<g id="node446" class="node">
<title>expert_s1_t2_g3_l8</title>
<polygon fill="lightgreen" stroke="black" points="34602,-1411.9 34344,-1411.9 34344,-1370.9 34602,-1370.9 34602,-1411.9"/>
<text text-anchor="middle" x="34473" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;8 GPU&#45;51</text>
<text text-anchor="middle" x="34473" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34473" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g3_l9 -->
<g id="node447" class="node">
<title>expert_s1_t2_g3_l9</title>
<polygon fill="lightgreen" stroke="black" points="34326,-1411.9 34068,-1411.9 34068,-1370.9 34326,-1370.9 34326,-1411.9"/>
<text text-anchor="middle" x="34197" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;9 GPU&#45;51</text>
<text text-anchor="middle" x="34197" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34197" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g3_l10 -->
<g id="node448" class="node">
<title>expert_s1_t2_g3_l10</title>
<polygon fill="lightgreen" stroke="black" points="34050,-1411.9 33792,-1411.9 33792,-1370.9 34050,-1370.9 34050,-1411.9"/>
<text text-anchor="middle" x="33921" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;10 GPU&#45;51</text>
<text text-anchor="middle" x="33921" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33921" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g3_l11 -->
<g id="node449" class="node">
<title>expert_s1_t2_g3_l11</title>
<polygon fill="lightgreen" stroke="black" points="33774,-1411.9 33516,-1411.9 33516,-1370.9 33774,-1370.9 33774,-1411.9"/>
<text text-anchor="middle" x="33645" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;51 Layer&#45;11 GPU&#45;51</text>
<text text-anchor="middle" x="33645" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33645" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g4 -->
<g id="node450" class="node">
<title>attn_s1_t2_g4</title>
<polygon fill="lightgreen" stroke="black" points="35171.5,-1411.9 34896.5,-1411.9 34896.5,-1370.9 35171.5,-1370.9 35171.5,-1411.9"/>
<text text-anchor="middle" x="35034" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;52</text>
<text text-anchor="middle" x="35034" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g4 -->
<g id="node451" class="node">
<title>gate_s1_t2_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="35299.32,-1334.9 34877.26,-1334.9 34768.68,-1252.9 35190.74,-1252.9 35299.32,-1334.9"/>
<text text-anchor="middle" x="35034" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;52</text>
<text text-anchor="middle" x="35034" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g4&#45;&gt;gate_s1_t2_g4 -->
<g id="edge160" class="edge">
<title>attn_s1_t2_g4&#45;&gt;gate_s1_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-1370.61C35034,-1363.15 35034,-1354.28 35034,-1345.28"/>
<polygon fill="black" stroke="black" points="35037.5,-1345.14 35034,-1335.14 35030.5,-1345.14 35037.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g4_l6 -->
<g id="node452" class="node">
<title>expert_s1_t2_g4_l6</title>
<polygon fill="lightgreen" stroke="black" points="35163,-1216.9 34905,-1216.9 34905,-1175.9 35163,-1175.9 35163,-1216.9"/>
<text text-anchor="middle" x="35034" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;6 GPU&#45;52</text>
<text text-anchor="middle" x="35034" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g4&#45;&gt;expert_s1_t2_g4_l6 -->
<g id="edge161" class="edge">
<title>gate_s1_t2_g4&#45;&gt;expert_s1_t2_g4_l6</title>
<path fill="none" stroke="black" d="M35034,-1252.67C35034,-1244.1 35034,-1235.19 35034,-1227.09"/>
<polygon fill="black" stroke="black" points="35037.5,-1227.01 35034,-1217.01 35030.5,-1227.01 35037.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g4 -->
<g id="node566" class="node">
<title>comm_s1_t2_g4</title>
<ellipse fill="lightblue" stroke="black" cx="35034" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="35034" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;52</text>
<text text-anchor="middle" x="35034" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g4_l6&#45;&gt;comm_s1_t2_g4 -->
<g id="edge162" class="edge">
<title>expert_s1_t2_g4_l6&#45;&gt;comm_s1_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-1175.61C35034,-1167.99 35034,-1158.99 35034,-1150.21"/>
<polygon fill="black" stroke="black" points="35037.5,-1150.08 35034,-1140.08 35030.5,-1150.08 35037.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g4_l7 -->
<g id="node453" class="node">
<title>expert_s1_t2_g4_l7</title>
<polygon fill="lightgreen" stroke="black" points="33204,-1411.9 32946,-1411.9 32946,-1370.9 33204,-1370.9 33204,-1411.9"/>
<text text-anchor="middle" x="33075" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;7 GPU&#45;52</text>
<text text-anchor="middle" x="33075" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33075" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g4_l8 -->
<g id="node454" class="node">
<title>expert_s1_t2_g4_l8</title>
<polygon fill="lightgreen" stroke="black" points="32928,-1411.9 32670,-1411.9 32670,-1370.9 32928,-1370.9 32928,-1411.9"/>
<text text-anchor="middle" x="32799" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;8 GPU&#45;52</text>
<text text-anchor="middle" x="32799" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32799" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g4_l9 -->
<g id="node455" class="node">
<title>expert_s1_t2_g4_l9</title>
<polygon fill="lightgreen" stroke="black" points="32652,-1411.9 32394,-1411.9 32394,-1370.9 32652,-1370.9 32652,-1411.9"/>
<text text-anchor="middle" x="32523" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;9 GPU&#45;52</text>
<text text-anchor="middle" x="32523" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32523" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g4_l10 -->
<g id="node456" class="node">
<title>expert_s1_t2_g4_l10</title>
<polygon fill="lightgreen" stroke="black" points="32376,-1411.9 32118,-1411.9 32118,-1370.9 32376,-1370.9 32376,-1411.9"/>
<text text-anchor="middle" x="32247" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;10 GPU&#45;52</text>
<text text-anchor="middle" x="32247" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32247" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g4_l11 -->
<g id="node457" class="node">
<title>expert_s1_t2_g4_l11</title>
<polygon fill="lightgreen" stroke="black" points="32100,-1411.9 31842,-1411.9 31842,-1370.9 32100,-1370.9 32100,-1411.9"/>
<text text-anchor="middle" x="31971" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;52 Layer&#45;11 GPU&#45;52</text>
<text text-anchor="middle" x="31971" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31971" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g5 -->
<g id="node458" class="node">
<title>attn_s1_t2_g5</title>
<polygon fill="lightgreen" stroke="black" points="36845.5,-1411.9 36570.5,-1411.9 36570.5,-1370.9 36845.5,-1370.9 36845.5,-1411.9"/>
<text text-anchor="middle" x="36708" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;53</text>
<text text-anchor="middle" x="36708" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g5 -->
<g id="node459" class="node">
<title>gate_s1_t2_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="36973.32,-1334.9 36551.26,-1334.9 36442.68,-1252.9 36864.74,-1252.9 36973.32,-1334.9"/>
<text text-anchor="middle" x="36708" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;53</text>
<text text-anchor="middle" x="36708" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g5&#45;&gt;gate_s1_t2_g5 -->
<g id="edge163" class="edge">
<title>attn_s1_t2_g5&#45;&gt;gate_s1_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-1370.61C36708,-1363.15 36708,-1354.28 36708,-1345.28"/>
<polygon fill="black" stroke="black" points="36711.5,-1345.14 36708,-1335.14 36704.5,-1345.14 36711.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g5_l6 -->
<g id="node460" class="node">
<title>expert_s1_t2_g5_l6</title>
<polygon fill="lightgreen" stroke="black" points="36837,-1216.9 36579,-1216.9 36579,-1175.9 36837,-1175.9 36837,-1216.9"/>
<text text-anchor="middle" x="36708" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;6 GPU&#45;53</text>
<text text-anchor="middle" x="36708" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g5&#45;&gt;expert_s1_t2_g5_l6 -->
<g id="edge164" class="edge">
<title>gate_s1_t2_g5&#45;&gt;expert_s1_t2_g5_l6</title>
<path fill="none" stroke="black" d="M36708,-1252.67C36708,-1244.1 36708,-1235.19 36708,-1227.09"/>
<polygon fill="black" stroke="black" points="36711.5,-1227.01 36708,-1217.01 36704.5,-1227.01 36711.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g5 -->
<g id="node567" class="node">
<title>comm_s1_t2_g5</title>
<ellipse fill="lightblue" stroke="black" cx="36708" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="36708" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;53</text>
<text text-anchor="middle" x="36708" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g5_l6&#45;&gt;comm_s1_t2_g5 -->
<g id="edge165" class="edge">
<title>expert_s1_t2_g5_l6&#45;&gt;comm_s1_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-1175.61C36708,-1167.99 36708,-1158.99 36708,-1150.21"/>
<polygon fill="black" stroke="black" points="36711.5,-1150.08 36708,-1140.08 36704.5,-1150.08 36711.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g5_l7 -->
<g id="node461" class="node">
<title>expert_s1_t2_g5_l7</title>
<polygon fill="lightgreen" stroke="black" points="31530,-1411.9 31272,-1411.9 31272,-1370.9 31530,-1370.9 31530,-1411.9"/>
<text text-anchor="middle" x="31401" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;7 GPU&#45;53</text>
<text text-anchor="middle" x="31401" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31401" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g5_l8 -->
<g id="node462" class="node">
<title>expert_s1_t2_g5_l8</title>
<polygon fill="lightgreen" stroke="black" points="31254,-1411.9 30996,-1411.9 30996,-1370.9 31254,-1370.9 31254,-1411.9"/>
<text text-anchor="middle" x="31125" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;8 GPU&#45;53</text>
<text text-anchor="middle" x="31125" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31125" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g5_l9 -->
<g id="node463" class="node">
<title>expert_s1_t2_g5_l9</title>
<polygon fill="lightgreen" stroke="black" points="30978,-1411.9 30720,-1411.9 30720,-1370.9 30978,-1370.9 30978,-1411.9"/>
<text text-anchor="middle" x="30849" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;9 GPU&#45;53</text>
<text text-anchor="middle" x="30849" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30849" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g5_l10 -->
<g id="node464" class="node">
<title>expert_s1_t2_g5_l10</title>
<polygon fill="lightgreen" stroke="black" points="30702,-1411.9 30444,-1411.9 30444,-1370.9 30702,-1370.9 30702,-1411.9"/>
<text text-anchor="middle" x="30573" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;10 GPU&#45;53</text>
<text text-anchor="middle" x="30573" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30573" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g5_l11 -->
<g id="node465" class="node">
<title>expert_s1_t2_g5_l11</title>
<polygon fill="lightgreen" stroke="black" points="30426,-1411.9 30168,-1411.9 30168,-1370.9 30426,-1370.9 30426,-1411.9"/>
<text text-anchor="middle" x="30297" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;53 Layer&#45;11 GPU&#45;53</text>
<text text-anchor="middle" x="30297" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30297" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g6 -->
<g id="node466" class="node">
<title>attn_s1_t2_g6</title>
<polygon fill="lightgreen" stroke="black" points="38519.5,-1411.9 38244.5,-1411.9 38244.5,-1370.9 38519.5,-1370.9 38519.5,-1411.9"/>
<text text-anchor="middle" x="38382" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;54</text>
<text text-anchor="middle" x="38382" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g6 -->
<g id="node467" class="node">
<title>gate_s1_t2_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="38647.32,-1334.9 38225.26,-1334.9 38116.68,-1252.9 38538.74,-1252.9 38647.32,-1334.9"/>
<text text-anchor="middle" x="38382" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;54</text>
<text text-anchor="middle" x="38382" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g6&#45;&gt;gate_s1_t2_g6 -->
<g id="edge166" class="edge">
<title>attn_s1_t2_g6&#45;&gt;gate_s1_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-1370.61C38382,-1363.15 38382,-1354.28 38382,-1345.28"/>
<polygon fill="black" stroke="black" points="38385.5,-1345.14 38382,-1335.14 38378.5,-1345.14 38385.5,-1345.14"/>
</g>
<!-- expert_s1_t2_g6_l6 -->
<g id="node468" class="node">
<title>expert_s1_t2_g6_l6</title>
<polygon fill="lightgreen" stroke="black" points="38511,-1216.9 38253,-1216.9 38253,-1175.9 38511,-1175.9 38511,-1216.9"/>
<text text-anchor="middle" x="38382" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;6 GPU&#45;54</text>
<text text-anchor="middle" x="38382" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g6&#45;&gt;expert_s1_t2_g6_l6 -->
<g id="edge167" class="edge">
<title>gate_s1_t2_g6&#45;&gt;expert_s1_t2_g6_l6</title>
<path fill="none" stroke="black" d="M38382,-1252.67C38382,-1244.1 38382,-1235.19 38382,-1227.09"/>
<polygon fill="black" stroke="black" points="38385.5,-1227.01 38382,-1217.01 38378.5,-1227.01 38385.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g6 -->
<g id="node568" class="node">
<title>comm_s1_t2_g6</title>
<ellipse fill="lightblue" stroke="black" cx="38382" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="38382" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;54</text>
<text text-anchor="middle" x="38382" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g6_l6&#45;&gt;comm_s1_t2_g6 -->
<g id="edge168" class="edge">
<title>expert_s1_t2_g6_l6&#45;&gt;comm_s1_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-1175.61C38382,-1167.99 38382,-1158.99 38382,-1150.21"/>
<polygon fill="black" stroke="black" points="38385.5,-1150.08 38382,-1140.08 38378.5,-1150.08 38385.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g6_l7 -->
<g id="node469" class="node">
<title>expert_s1_t2_g6_l7</title>
<polygon fill="lightgreen" stroke="black" points="29856,-1411.9 29598,-1411.9 29598,-1370.9 29856,-1370.9 29856,-1411.9"/>
<text text-anchor="middle" x="29727" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;7 GPU&#45;54</text>
<text text-anchor="middle" x="29727" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29727" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g6_l8 -->
<g id="node470" class="node">
<title>expert_s1_t2_g6_l8</title>
<polygon fill="lightgreen" stroke="black" points="29580,-1411.9 29322,-1411.9 29322,-1370.9 29580,-1370.9 29580,-1411.9"/>
<text text-anchor="middle" x="29451" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;8 GPU&#45;54</text>
<text text-anchor="middle" x="29451" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29451" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g6_l9 -->
<g id="node471" class="node">
<title>expert_s1_t2_g6_l9</title>
<polygon fill="lightgreen" stroke="black" points="29304,-1411.9 29046,-1411.9 29046,-1370.9 29304,-1370.9 29304,-1411.9"/>
<text text-anchor="middle" x="29175" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;9 GPU&#45;54</text>
<text text-anchor="middle" x="29175" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29175" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g6_l10 -->
<g id="node472" class="node">
<title>expert_s1_t2_g6_l10</title>
<polygon fill="lightgreen" stroke="black" points="29028,-1411.9 28770,-1411.9 28770,-1370.9 29028,-1370.9 29028,-1411.9"/>
<text text-anchor="middle" x="28899" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;10 GPU&#45;54</text>
<text text-anchor="middle" x="28899" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28899" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g6_l11 -->
<g id="node473" class="node">
<title>expert_s1_t2_g6_l11</title>
<polygon fill="lightgreen" stroke="black" points="28752,-1411.9 28494,-1411.9 28494,-1370.9 28752,-1370.9 28752,-1411.9"/>
<text text-anchor="middle" x="28623" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;54 Layer&#45;11 GPU&#45;54</text>
<text text-anchor="middle" x="28623" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28623" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t2_g7 -->
<g id="node474" class="node">
<title>attn_s1_t2_g7</title>
<polygon fill="lightgreen" stroke="black" points="40193.5,-1411.9 39918.5,-1411.9 39918.5,-1370.9 40193.5,-1370.9 40193.5,-1411.9"/>
<text text-anchor="middle" x="40056" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;55</text>
<text text-anchor="middle" x="40056" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="40056" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t2_g7 -->
<g id="node475" class="node">
<title>gate_s1_t2_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="40194.32,-1334.9 39772.26,-1334.9 39663.68,-1252.9 40085.74,-1252.9 40194.32,-1334.9"/>
<text text-anchor="middle" x="39929" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;55</text>
<text text-anchor="middle" x="39929" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t2_g7&#45;&gt;gate_s1_t2_g7 -->
<g id="edge169" class="edge">
<title>attn_s1_t2_g7&#45;&gt;gate_s1_t2_g7</title>
<path fill="none" stroke="black" d="M40029.99,-1370.84C40018.47,-1362.17 40004.37,-1351.57 39990.41,-1341.08"/>
<polygon fill="black" stroke="black" points="39992.33,-1338.14 39982.23,-1334.92 39988.12,-1343.73 39992.33,-1338.14"/>
</g>
<!-- expert_s1_t2_g7_l6 -->
<g id="node476" class="node">
<title>expert_s1_t2_g7_l6</title>
<polygon fill="lightgreen" stroke="black" points="40058,-1216.9 39800,-1216.9 39800,-1175.9 40058,-1175.9 40058,-1216.9"/>
<text text-anchor="middle" x="39929" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;6 GPU&#45;55</text>
<text text-anchor="middle" x="39929" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t2_g7&#45;&gt;expert_s1_t2_g7_l6 -->
<g id="edge170" class="edge">
<title>gate_s1_t2_g7&#45;&gt;expert_s1_t2_g7_l6</title>
<path fill="none" stroke="black" d="M39929,-1252.67C39929,-1244.1 39929,-1235.19 39929,-1227.09"/>
<polygon fill="black" stroke="black" points="39932.5,-1227.01 39929,-1217.01 39925.5,-1227.01 39932.5,-1227.01"/>
</g>
<!-- comm_s1_t2_g7 -->
<g id="node569" class="node">
<title>comm_s1_t2_g7</title>
<ellipse fill="lightblue" stroke="black" cx="39929" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="39929" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;55</text>
<text text-anchor="middle" x="39929" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="39929" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t2_g7_l6&#45;&gt;comm_s1_t2_g7 -->
<g id="edge171" class="edge">
<title>expert_s1_t2_g7_l6&#45;&gt;comm_s1_t2_g7</title>
<path fill="none" stroke="black" d="M39929,-1175.61C39929,-1167.99 39929,-1158.99 39929,-1150.21"/>
<polygon fill="black" stroke="black" points="39932.5,-1150.08 39929,-1140.08 39925.5,-1150.08 39932.5,-1150.08"/>
</g>
<!-- expert_s1_t2_g7_l7 -->
<g id="node477" class="node">
<title>expert_s1_t2_g7_l7</title>
<polygon fill="lightgreen" stroke="black" points="28182,-1411.9 27924,-1411.9 27924,-1370.9 28182,-1370.9 28182,-1411.9"/>
<text text-anchor="middle" x="28053" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;7 GPU&#45;55</text>
<text text-anchor="middle" x="28053" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28053" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g7_l8 -->
<g id="node478" class="node">
<title>expert_s1_t2_g7_l8</title>
<polygon fill="lightgreen" stroke="black" points="27906,-1411.9 27648,-1411.9 27648,-1370.9 27906,-1370.9 27906,-1411.9"/>
<text text-anchor="middle" x="27777" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;8 GPU&#45;55</text>
<text text-anchor="middle" x="27777" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27777" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g7_l9 -->
<g id="node479" class="node">
<title>expert_s1_t2_g7_l9</title>
<polygon fill="lightgreen" stroke="black" points="27630,-1411.9 27372,-1411.9 27372,-1370.9 27630,-1370.9 27630,-1411.9"/>
<text text-anchor="middle" x="27501" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;9 GPU&#45;55</text>
<text text-anchor="middle" x="27501" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27501" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g7_l10 -->
<g id="node480" class="node">
<title>expert_s1_t2_g7_l10</title>
<polygon fill="lightgreen" stroke="black" points="27354,-1411.9 27096,-1411.9 27096,-1370.9 27354,-1370.9 27354,-1411.9"/>
<text text-anchor="middle" x="27225" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;10 GPU&#45;55</text>
<text text-anchor="middle" x="27225" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27225" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t2_g7_l11 -->
<g id="node481" class="node">
<title>expert_s1_t2_g7_l11</title>
<polygon fill="lightgreen" stroke="black" points="27078,-1411.9 26820,-1411.9 26820,-1370.9 27078,-1370.9 27078,-1411.9"/>
<text text-anchor="middle" x="26949" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;55 Layer&#45;11 GPU&#45;55</text>
<text text-anchor="middle" x="26949" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26949" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g0 -->
<g id="node482" class="node">
<title>attn_s1_t3_g0</title>
<polygon fill="lightgreen" stroke="black" points="41873.5,-1411.9 41598.5,-1411.9 41598.5,-1370.9 41873.5,-1370.9 41873.5,-1411.9"/>
<text text-anchor="middle" x="41736" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;56</text>
<text text-anchor="middle" x="41736" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g0 -->
<g id="node483" class="node">
<title>gate_s1_t3_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="42001.32,-1334.9 41579.26,-1334.9 41470.68,-1252.9 41892.74,-1252.9 42001.32,-1334.9"/>
<text text-anchor="middle" x="41736" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;56</text>
<text text-anchor="middle" x="41736" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g0&#45;&gt;gate_s1_t3_g0 -->
<g id="edge172" class="edge">
<title>attn_s1_t3_g0&#45;&gt;gate_s1_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-1370.61C41736,-1363.15 41736,-1354.28 41736,-1345.28"/>
<polygon fill="black" stroke="black" points="41739.5,-1345.14 41736,-1335.14 41732.5,-1345.14 41739.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g0_l6 -->
<g id="node484" class="node">
<title>expert_s1_t3_g0_l6</title>
<polygon fill="lightgreen" stroke="black" points="41865,-1216.9 41607,-1216.9 41607,-1175.9 41865,-1175.9 41865,-1216.9"/>
<text text-anchor="middle" x="41736" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;6 GPU&#45;56</text>
<text text-anchor="middle" x="41736" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g0&#45;&gt;expert_s1_t3_g0_l6 -->
<g id="edge173" class="edge">
<title>gate_s1_t3_g0&#45;&gt;expert_s1_t3_g0_l6</title>
<path fill="none" stroke="black" d="M41736,-1252.67C41736,-1244.1 41736,-1235.19 41736,-1227.09"/>
<polygon fill="black" stroke="black" points="41739.5,-1227.01 41736,-1217.01 41732.5,-1227.01 41739.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g0 -->
<g id="node570" class="node">
<title>comm_s1_t3_g0</title>
<ellipse fill="lightblue" stroke="black" cx="41736" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="41736" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;56</text>
<text text-anchor="middle" x="41736" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g0_l6&#45;&gt;comm_s1_t3_g0 -->
<g id="edge174" class="edge">
<title>expert_s1_t3_g0_l6&#45;&gt;comm_s1_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-1175.61C41736,-1167.99 41736,-1158.99 41736,-1150.21"/>
<polygon fill="black" stroke="black" points="41739.5,-1150.08 41736,-1140.08 41732.5,-1150.08 41739.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g0_l7 -->
<g id="node485" class="node">
<title>expert_s1_t3_g0_l7</title>
<polygon fill="lightgreen" stroke="black" points="53298,-1411.9 53040,-1411.9 53040,-1370.9 53298,-1370.9 53298,-1411.9"/>
<text text-anchor="middle" x="53169" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;7 GPU&#45;56</text>
<text text-anchor="middle" x="53169" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53169" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g0_l8 -->
<g id="node486" class="node">
<title>expert_s1_t3_g0_l8</title>
<polygon fill="lightgreen" stroke="black" points="53022,-1411.9 52764,-1411.9 52764,-1370.9 53022,-1370.9 53022,-1411.9"/>
<text text-anchor="middle" x="52893" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;8 GPU&#45;56</text>
<text text-anchor="middle" x="52893" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52893" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g0_l9 -->
<g id="node487" class="node">
<title>expert_s1_t3_g0_l9</title>
<polygon fill="lightgreen" stroke="black" points="52746,-1411.9 52488,-1411.9 52488,-1370.9 52746,-1370.9 52746,-1411.9"/>
<text text-anchor="middle" x="52617" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;9 GPU&#45;56</text>
<text text-anchor="middle" x="52617" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52617" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g0_l10 -->
<g id="node488" class="node">
<title>expert_s1_t3_g0_l10</title>
<polygon fill="lightgreen" stroke="black" points="52470,-1411.9 52212,-1411.9 52212,-1370.9 52470,-1370.9 52470,-1411.9"/>
<text text-anchor="middle" x="52341" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;10 GPU&#45;56</text>
<text text-anchor="middle" x="52341" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52341" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g0_l11 -->
<g id="node489" class="node">
<title>expert_s1_t3_g0_l11</title>
<polygon fill="lightgreen" stroke="black" points="52194,-1411.9 51936,-1411.9 51936,-1370.9 52194,-1370.9 52194,-1411.9"/>
<text text-anchor="middle" x="52065" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;56 Layer&#45;11 GPU&#45;56</text>
<text text-anchor="middle" x="52065" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52065" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g1 -->
<g id="node490" class="node">
<title>attn_s1_t3_g1</title>
<polygon fill="lightgreen" stroke="black" points="43547.5,-1411.9 43272.5,-1411.9 43272.5,-1370.9 43547.5,-1370.9 43547.5,-1411.9"/>
<text text-anchor="middle" x="43410" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;57</text>
<text text-anchor="middle" x="43410" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g1 -->
<g id="node491" class="node">
<title>gate_s1_t3_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="43675.32,-1334.9 43253.26,-1334.9 43144.68,-1252.9 43566.74,-1252.9 43675.32,-1334.9"/>
<text text-anchor="middle" x="43410" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;57</text>
<text text-anchor="middle" x="43410" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g1&#45;&gt;gate_s1_t3_g1 -->
<g id="edge175" class="edge">
<title>attn_s1_t3_g1&#45;&gt;gate_s1_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-1370.61C43410,-1363.15 43410,-1354.28 43410,-1345.28"/>
<polygon fill="black" stroke="black" points="43413.5,-1345.14 43410,-1335.14 43406.5,-1345.14 43413.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g1_l6 -->
<g id="node492" class="node">
<title>expert_s1_t3_g1_l6</title>
<polygon fill="lightgreen" stroke="black" points="43539,-1216.9 43281,-1216.9 43281,-1175.9 43539,-1175.9 43539,-1216.9"/>
<text text-anchor="middle" x="43410" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;6 GPU&#45;57</text>
<text text-anchor="middle" x="43410" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g1&#45;&gt;expert_s1_t3_g1_l6 -->
<g id="edge176" class="edge">
<title>gate_s1_t3_g1&#45;&gt;expert_s1_t3_g1_l6</title>
<path fill="none" stroke="black" d="M43410,-1252.67C43410,-1244.1 43410,-1235.19 43410,-1227.09"/>
<polygon fill="black" stroke="black" points="43413.5,-1227.01 43410,-1217.01 43406.5,-1227.01 43413.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g1 -->
<g id="node571" class="node">
<title>comm_s1_t3_g1</title>
<ellipse fill="lightblue" stroke="black" cx="43410" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="43410" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;57</text>
<text text-anchor="middle" x="43410" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g1_l6&#45;&gt;comm_s1_t3_g1 -->
<g id="edge177" class="edge">
<title>expert_s1_t3_g1_l6&#45;&gt;comm_s1_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-1175.61C43410,-1167.99 43410,-1158.99 43410,-1150.21"/>
<polygon fill="black" stroke="black" points="43413.5,-1150.08 43410,-1140.08 43406.5,-1150.08 43413.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g1_l7 -->
<g id="node493" class="node">
<title>expert_s1_t3_g1_l7</title>
<polygon fill="lightgreen" stroke="black" points="51624,-1411.9 51366,-1411.9 51366,-1370.9 51624,-1370.9 51624,-1411.9"/>
<text text-anchor="middle" x="51495" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;7 GPU&#45;57</text>
<text text-anchor="middle" x="51495" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51495" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g1_l8 -->
<g id="node494" class="node">
<title>expert_s1_t3_g1_l8</title>
<polygon fill="lightgreen" stroke="black" points="51348,-1411.9 51090,-1411.9 51090,-1370.9 51348,-1370.9 51348,-1411.9"/>
<text text-anchor="middle" x="51219" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;8 GPU&#45;57</text>
<text text-anchor="middle" x="51219" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51219" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g1_l9 -->
<g id="node495" class="node">
<title>expert_s1_t3_g1_l9</title>
<polygon fill="lightgreen" stroke="black" points="51072,-1411.9 50814,-1411.9 50814,-1370.9 51072,-1370.9 51072,-1411.9"/>
<text text-anchor="middle" x="50943" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;9 GPU&#45;57</text>
<text text-anchor="middle" x="50943" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50943" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g1_l10 -->
<g id="node496" class="node">
<title>expert_s1_t3_g1_l10</title>
<polygon fill="lightgreen" stroke="black" points="50796,-1411.9 50538,-1411.9 50538,-1370.9 50796,-1370.9 50796,-1411.9"/>
<text text-anchor="middle" x="50667" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;10 GPU&#45;57</text>
<text text-anchor="middle" x="50667" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50667" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g1_l11 -->
<g id="node497" class="node">
<title>expert_s1_t3_g1_l11</title>
<polygon fill="lightgreen" stroke="black" points="50520,-1411.9 50262,-1411.9 50262,-1370.9 50520,-1370.9 50520,-1411.9"/>
<text text-anchor="middle" x="50391" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;57 Layer&#45;11 GPU&#45;57</text>
<text text-anchor="middle" x="50391" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50391" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g2 -->
<g id="node498" class="node">
<title>attn_s1_t3_g2</title>
<polygon fill="lightgreen" stroke="black" points="45221.5,-1411.9 44946.5,-1411.9 44946.5,-1370.9 45221.5,-1370.9 45221.5,-1411.9"/>
<text text-anchor="middle" x="45084" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;58</text>
<text text-anchor="middle" x="45084" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g2 -->
<g id="node499" class="node">
<title>gate_s1_t3_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="45349.32,-1334.9 44927.26,-1334.9 44818.68,-1252.9 45240.74,-1252.9 45349.32,-1334.9"/>
<text text-anchor="middle" x="45084" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;58</text>
<text text-anchor="middle" x="45084" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g2&#45;&gt;gate_s1_t3_g2 -->
<g id="edge178" class="edge">
<title>attn_s1_t3_g2&#45;&gt;gate_s1_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-1370.61C45084,-1363.15 45084,-1354.28 45084,-1345.28"/>
<polygon fill="black" stroke="black" points="45087.5,-1345.14 45084,-1335.14 45080.5,-1345.14 45087.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g2_l6 -->
<g id="node500" class="node">
<title>expert_s1_t3_g2_l6</title>
<polygon fill="lightgreen" stroke="black" points="45213,-1216.9 44955,-1216.9 44955,-1175.9 45213,-1175.9 45213,-1216.9"/>
<text text-anchor="middle" x="45084" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;6 GPU&#45;58</text>
<text text-anchor="middle" x="45084" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g2&#45;&gt;expert_s1_t3_g2_l6 -->
<g id="edge179" class="edge">
<title>gate_s1_t3_g2&#45;&gt;expert_s1_t3_g2_l6</title>
<path fill="none" stroke="black" d="M45084,-1252.67C45084,-1244.1 45084,-1235.19 45084,-1227.09"/>
<polygon fill="black" stroke="black" points="45087.5,-1227.01 45084,-1217.01 45080.5,-1227.01 45087.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g2 -->
<g id="node572" class="node">
<title>comm_s1_t3_g2</title>
<ellipse fill="lightblue" stroke="black" cx="45084" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="45084" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;58</text>
<text text-anchor="middle" x="45084" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g2_l6&#45;&gt;comm_s1_t3_g2 -->
<g id="edge180" class="edge">
<title>expert_s1_t3_g2_l6&#45;&gt;comm_s1_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-1175.61C45084,-1167.99 45084,-1158.99 45084,-1150.21"/>
<polygon fill="black" stroke="black" points="45087.5,-1150.08 45084,-1140.08 45080.5,-1150.08 45087.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g2_l7 -->
<g id="node501" class="node">
<title>expert_s1_t3_g2_l7</title>
<polygon fill="lightgreen" stroke="black" points="49950,-1411.9 49692,-1411.9 49692,-1370.9 49950,-1370.9 49950,-1411.9"/>
<text text-anchor="middle" x="49821" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;7 GPU&#45;58</text>
<text text-anchor="middle" x="49821" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49821" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g2_l8 -->
<g id="node502" class="node">
<title>expert_s1_t3_g2_l8</title>
<polygon fill="lightgreen" stroke="black" points="49674,-1411.9 49416,-1411.9 49416,-1370.9 49674,-1370.9 49674,-1411.9"/>
<text text-anchor="middle" x="49545" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;8 GPU&#45;58</text>
<text text-anchor="middle" x="49545" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49545" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g2_l9 -->
<g id="node503" class="node">
<title>expert_s1_t3_g2_l9</title>
<polygon fill="lightgreen" stroke="black" points="49398,-1411.9 49140,-1411.9 49140,-1370.9 49398,-1370.9 49398,-1411.9"/>
<text text-anchor="middle" x="49269" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;9 GPU&#45;58</text>
<text text-anchor="middle" x="49269" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49269" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g2_l10 -->
<g id="node504" class="node">
<title>expert_s1_t3_g2_l10</title>
<polygon fill="lightgreen" stroke="black" points="49122,-1411.9 48864,-1411.9 48864,-1370.9 49122,-1370.9 49122,-1411.9"/>
<text text-anchor="middle" x="48993" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;10 GPU&#45;58</text>
<text text-anchor="middle" x="48993" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48993" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g2_l11 -->
<g id="node505" class="node">
<title>expert_s1_t3_g2_l11</title>
<polygon fill="lightgreen" stroke="black" points="48846,-1411.9 48588,-1411.9 48588,-1370.9 48846,-1370.9 48846,-1411.9"/>
<text text-anchor="middle" x="48717" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;58 Layer&#45;11 GPU&#45;58</text>
<text text-anchor="middle" x="48717" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48717" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g3 -->
<g id="node506" class="node">
<title>attn_s1_t3_g3</title>
<polygon fill="lightgreen" stroke="black" points="46895.5,-1411.9 46620.5,-1411.9 46620.5,-1370.9 46895.5,-1370.9 46895.5,-1411.9"/>
<text text-anchor="middle" x="46758" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;59</text>
<text text-anchor="middle" x="46758" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g3 -->
<g id="node507" class="node">
<title>gate_s1_t3_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="47023.32,-1334.9 46601.26,-1334.9 46492.68,-1252.9 46914.74,-1252.9 47023.32,-1334.9"/>
<text text-anchor="middle" x="46758" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;59</text>
<text text-anchor="middle" x="46758" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g3&#45;&gt;gate_s1_t3_g3 -->
<g id="edge181" class="edge">
<title>attn_s1_t3_g3&#45;&gt;gate_s1_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-1370.61C46758,-1363.15 46758,-1354.28 46758,-1345.28"/>
<polygon fill="black" stroke="black" points="46761.5,-1345.14 46758,-1335.14 46754.5,-1345.14 46761.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g3_l6 -->
<g id="node508" class="node">
<title>expert_s1_t3_g3_l6</title>
<polygon fill="lightgreen" stroke="black" points="46887,-1216.9 46629,-1216.9 46629,-1175.9 46887,-1175.9 46887,-1216.9"/>
<text text-anchor="middle" x="46758" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;6 GPU&#45;59</text>
<text text-anchor="middle" x="46758" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g3&#45;&gt;expert_s1_t3_g3_l6 -->
<g id="edge182" class="edge">
<title>gate_s1_t3_g3&#45;&gt;expert_s1_t3_g3_l6</title>
<path fill="none" stroke="black" d="M46758,-1252.67C46758,-1244.1 46758,-1235.19 46758,-1227.09"/>
<polygon fill="black" stroke="black" points="46761.5,-1227.01 46758,-1217.01 46754.5,-1227.01 46761.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g3 -->
<g id="node573" class="node">
<title>comm_s1_t3_g3</title>
<ellipse fill="lightblue" stroke="black" cx="46758" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="46758" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;59</text>
<text text-anchor="middle" x="46758" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g3_l6&#45;&gt;comm_s1_t3_g3 -->
<g id="edge183" class="edge">
<title>expert_s1_t3_g3_l6&#45;&gt;comm_s1_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-1175.61C46758,-1167.99 46758,-1158.99 46758,-1150.21"/>
<polygon fill="black" stroke="black" points="46761.5,-1150.08 46758,-1140.08 46754.5,-1150.08 46761.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g3_l7 -->
<g id="node509" class="node">
<title>expert_s1_t3_g3_l7</title>
<polygon fill="lightgreen" stroke="black" points="48276,-1411.9 48018,-1411.9 48018,-1370.9 48276,-1370.9 48276,-1411.9"/>
<text text-anchor="middle" x="48147" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;7 GPU&#45;59</text>
<text text-anchor="middle" x="48147" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48147" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g3_l8 -->
<g id="node510" class="node">
<title>expert_s1_t3_g3_l8</title>
<polygon fill="lightgreen" stroke="black" points="48000,-1411.9 47742,-1411.9 47742,-1370.9 48000,-1370.9 48000,-1411.9"/>
<text text-anchor="middle" x="47871" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;8 GPU&#45;59</text>
<text text-anchor="middle" x="47871" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47871" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g3_l9 -->
<g id="node511" class="node">
<title>expert_s1_t3_g3_l9</title>
<polygon fill="lightgreen" stroke="black" points="47724,-1411.9 47466,-1411.9 47466,-1370.9 47724,-1370.9 47724,-1411.9"/>
<text text-anchor="middle" x="47595" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;9 GPU&#45;59</text>
<text text-anchor="middle" x="47595" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47595" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g3_l10 -->
<g id="node512" class="node">
<title>expert_s1_t3_g3_l10</title>
<polygon fill="lightgreen" stroke="black" points="47448,-1411.9 47190,-1411.9 47190,-1370.9 47448,-1370.9 47448,-1411.9"/>
<text text-anchor="middle" x="47319" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;10 GPU&#45;59</text>
<text text-anchor="middle" x="47319" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47319" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g3_l11 -->
<g id="node513" class="node">
<title>expert_s1_t3_g3_l11</title>
<polygon fill="lightgreen" stroke="black" points="47172,-1411.9 46914,-1411.9 46914,-1370.9 47172,-1370.9 47172,-1411.9"/>
<text text-anchor="middle" x="47043" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;59 Layer&#45;11 GPU&#45;59</text>
<text text-anchor="middle" x="47043" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47043" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g4 -->
<g id="node514" class="node">
<title>attn_s1_t3_g4</title>
<polygon fill="lightgreen" stroke="black" points="48569.5,-1411.9 48294.5,-1411.9 48294.5,-1370.9 48569.5,-1370.9 48569.5,-1411.9"/>
<text text-anchor="middle" x="48432" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;60</text>
<text text-anchor="middle" x="48432" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g4 -->
<g id="node515" class="node">
<title>gate_s1_t3_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="48697.32,-1334.9 48275.26,-1334.9 48166.68,-1252.9 48588.74,-1252.9 48697.32,-1334.9"/>
<text text-anchor="middle" x="48432" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;60</text>
<text text-anchor="middle" x="48432" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g4&#45;&gt;gate_s1_t3_g4 -->
<g id="edge184" class="edge">
<title>attn_s1_t3_g4&#45;&gt;gate_s1_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-1370.61C48432,-1363.15 48432,-1354.28 48432,-1345.28"/>
<polygon fill="black" stroke="black" points="48435.5,-1345.14 48432,-1335.14 48428.5,-1345.14 48435.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g4_l6 -->
<g id="node516" class="node">
<title>expert_s1_t3_g4_l6</title>
<polygon fill="lightgreen" stroke="black" points="48561,-1216.9 48303,-1216.9 48303,-1175.9 48561,-1175.9 48561,-1216.9"/>
<text text-anchor="middle" x="48432" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;6 GPU&#45;60</text>
<text text-anchor="middle" x="48432" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g4&#45;&gt;expert_s1_t3_g4_l6 -->
<g id="edge185" class="edge">
<title>gate_s1_t3_g4&#45;&gt;expert_s1_t3_g4_l6</title>
<path fill="none" stroke="black" d="M48432,-1252.67C48432,-1244.1 48432,-1235.19 48432,-1227.09"/>
<polygon fill="black" stroke="black" points="48435.5,-1227.01 48432,-1217.01 48428.5,-1227.01 48435.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g4 -->
<g id="node574" class="node">
<title>comm_s1_t3_g4</title>
<ellipse fill="lightblue" stroke="black" cx="48432" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="48432" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;60</text>
<text text-anchor="middle" x="48432" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g4_l6&#45;&gt;comm_s1_t3_g4 -->
<g id="edge186" class="edge">
<title>expert_s1_t3_g4_l6&#45;&gt;comm_s1_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-1175.61C48432,-1167.99 48432,-1158.99 48432,-1150.21"/>
<polygon fill="black" stroke="black" points="48435.5,-1150.08 48432,-1140.08 48428.5,-1150.08 48435.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g4_l7 -->
<g id="node517" class="node">
<title>expert_s1_t3_g4_l7</title>
<polygon fill="lightgreen" stroke="black" points="46602,-1411.9 46344,-1411.9 46344,-1370.9 46602,-1370.9 46602,-1411.9"/>
<text text-anchor="middle" x="46473" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;7 GPU&#45;60</text>
<text text-anchor="middle" x="46473" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46473" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g4_l8 -->
<g id="node518" class="node">
<title>expert_s1_t3_g4_l8</title>
<polygon fill="lightgreen" stroke="black" points="46326,-1411.9 46068,-1411.9 46068,-1370.9 46326,-1370.9 46326,-1411.9"/>
<text text-anchor="middle" x="46197" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;8 GPU&#45;60</text>
<text text-anchor="middle" x="46197" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46197" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g4_l9 -->
<g id="node519" class="node">
<title>expert_s1_t3_g4_l9</title>
<polygon fill="lightgreen" stroke="black" points="46050,-1411.9 45792,-1411.9 45792,-1370.9 46050,-1370.9 46050,-1411.9"/>
<text text-anchor="middle" x="45921" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;9 GPU&#45;60</text>
<text text-anchor="middle" x="45921" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45921" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g4_l10 -->
<g id="node520" class="node">
<title>expert_s1_t3_g4_l10</title>
<polygon fill="lightgreen" stroke="black" points="45774,-1411.9 45516,-1411.9 45516,-1370.9 45774,-1370.9 45774,-1411.9"/>
<text text-anchor="middle" x="45645" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;10 GPU&#45;60</text>
<text text-anchor="middle" x="45645" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45645" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g4_l11 -->
<g id="node521" class="node">
<title>expert_s1_t3_g4_l11</title>
<polygon fill="lightgreen" stroke="black" points="45498,-1411.9 45240,-1411.9 45240,-1370.9 45498,-1370.9 45498,-1411.9"/>
<text text-anchor="middle" x="45369" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;60 Layer&#45;11 GPU&#45;60</text>
<text text-anchor="middle" x="45369" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45369" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g5 -->
<g id="node522" class="node">
<title>attn_s1_t3_g5</title>
<polygon fill="lightgreen" stroke="black" points="50243.5,-1411.9 49968.5,-1411.9 49968.5,-1370.9 50243.5,-1370.9 50243.5,-1411.9"/>
<text text-anchor="middle" x="50106" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;61</text>
<text text-anchor="middle" x="50106" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g5 -->
<g id="node523" class="node">
<title>gate_s1_t3_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="50371.32,-1334.9 49949.26,-1334.9 49840.68,-1252.9 50262.74,-1252.9 50371.32,-1334.9"/>
<text text-anchor="middle" x="50106" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;61</text>
<text text-anchor="middle" x="50106" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g5&#45;&gt;gate_s1_t3_g5 -->
<g id="edge187" class="edge">
<title>attn_s1_t3_g5&#45;&gt;gate_s1_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-1370.61C50106,-1363.15 50106,-1354.28 50106,-1345.28"/>
<polygon fill="black" stroke="black" points="50109.5,-1345.14 50106,-1335.14 50102.5,-1345.14 50109.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g5_l6 -->
<g id="node524" class="node">
<title>expert_s1_t3_g5_l6</title>
<polygon fill="lightgreen" stroke="black" points="50235,-1216.9 49977,-1216.9 49977,-1175.9 50235,-1175.9 50235,-1216.9"/>
<text text-anchor="middle" x="50106" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;6 GPU&#45;61</text>
<text text-anchor="middle" x="50106" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g5&#45;&gt;expert_s1_t3_g5_l6 -->
<g id="edge188" class="edge">
<title>gate_s1_t3_g5&#45;&gt;expert_s1_t3_g5_l6</title>
<path fill="none" stroke="black" d="M50106,-1252.67C50106,-1244.1 50106,-1235.19 50106,-1227.09"/>
<polygon fill="black" stroke="black" points="50109.5,-1227.01 50106,-1217.01 50102.5,-1227.01 50109.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g5 -->
<g id="node575" class="node">
<title>comm_s1_t3_g5</title>
<ellipse fill="lightblue" stroke="black" cx="50106" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="50106" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;61</text>
<text text-anchor="middle" x="50106" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g5_l6&#45;&gt;comm_s1_t3_g5 -->
<g id="edge189" class="edge">
<title>expert_s1_t3_g5_l6&#45;&gt;comm_s1_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-1175.61C50106,-1167.99 50106,-1158.99 50106,-1150.21"/>
<polygon fill="black" stroke="black" points="50109.5,-1150.08 50106,-1140.08 50102.5,-1150.08 50109.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g5_l7 -->
<g id="node525" class="node">
<title>expert_s1_t3_g5_l7</title>
<polygon fill="lightgreen" stroke="black" points="44928,-1411.9 44670,-1411.9 44670,-1370.9 44928,-1370.9 44928,-1411.9"/>
<text text-anchor="middle" x="44799" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;7 GPU&#45;61</text>
<text text-anchor="middle" x="44799" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44799" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g5_l8 -->
<g id="node526" class="node">
<title>expert_s1_t3_g5_l8</title>
<polygon fill="lightgreen" stroke="black" points="44652,-1411.9 44394,-1411.9 44394,-1370.9 44652,-1370.9 44652,-1411.9"/>
<text text-anchor="middle" x="44523" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;8 GPU&#45;61</text>
<text text-anchor="middle" x="44523" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44523" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g5_l9 -->
<g id="node527" class="node">
<title>expert_s1_t3_g5_l9</title>
<polygon fill="lightgreen" stroke="black" points="44376,-1411.9 44118,-1411.9 44118,-1370.9 44376,-1370.9 44376,-1411.9"/>
<text text-anchor="middle" x="44247" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;9 GPU&#45;61</text>
<text text-anchor="middle" x="44247" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44247" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g5_l10 -->
<g id="node528" class="node">
<title>expert_s1_t3_g5_l10</title>
<polygon fill="lightgreen" stroke="black" points="44100,-1411.9 43842,-1411.9 43842,-1370.9 44100,-1370.9 44100,-1411.9"/>
<text text-anchor="middle" x="43971" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;10 GPU&#45;61</text>
<text text-anchor="middle" x="43971" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43971" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g5_l11 -->
<g id="node529" class="node">
<title>expert_s1_t3_g5_l11</title>
<polygon fill="lightgreen" stroke="black" points="43824,-1411.9 43566,-1411.9 43566,-1370.9 43824,-1370.9 43824,-1411.9"/>
<text text-anchor="middle" x="43695" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;61 Layer&#45;11 GPU&#45;61</text>
<text text-anchor="middle" x="43695" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43695" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g6 -->
<g id="node530" class="node">
<title>attn_s1_t3_g6</title>
<polygon fill="lightgreen" stroke="black" points="51917.5,-1411.9 51642.5,-1411.9 51642.5,-1370.9 51917.5,-1370.9 51917.5,-1411.9"/>
<text text-anchor="middle" x="51780" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;62</text>
<text text-anchor="middle" x="51780" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g6 -->
<g id="node531" class="node">
<title>gate_s1_t3_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="52045.32,-1334.9 51623.26,-1334.9 51514.68,-1252.9 51936.74,-1252.9 52045.32,-1334.9"/>
<text text-anchor="middle" x="51780" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;62</text>
<text text-anchor="middle" x="51780" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g6&#45;&gt;gate_s1_t3_g6 -->
<g id="edge190" class="edge">
<title>attn_s1_t3_g6&#45;&gt;gate_s1_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-1370.61C51780,-1363.15 51780,-1354.28 51780,-1345.28"/>
<polygon fill="black" stroke="black" points="51783.5,-1345.14 51780,-1335.14 51776.5,-1345.14 51783.5,-1345.14"/>
</g>
<!-- expert_s1_t3_g6_l6 -->
<g id="node532" class="node">
<title>expert_s1_t3_g6_l6</title>
<polygon fill="lightgreen" stroke="black" points="51909,-1216.9 51651,-1216.9 51651,-1175.9 51909,-1175.9 51909,-1216.9"/>
<text text-anchor="middle" x="51780" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;6 GPU&#45;62</text>
<text text-anchor="middle" x="51780" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g6&#45;&gt;expert_s1_t3_g6_l6 -->
<g id="edge191" class="edge">
<title>gate_s1_t3_g6&#45;&gt;expert_s1_t3_g6_l6</title>
<path fill="none" stroke="black" d="M51780,-1252.67C51780,-1244.1 51780,-1235.19 51780,-1227.09"/>
<polygon fill="black" stroke="black" points="51783.5,-1227.01 51780,-1217.01 51776.5,-1227.01 51783.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g6 -->
<g id="node576" class="node">
<title>comm_s1_t3_g6</title>
<ellipse fill="lightblue" stroke="black" cx="51780" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="51780" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;62</text>
<text text-anchor="middle" x="51780" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g6_l6&#45;&gt;comm_s1_t3_g6 -->
<g id="edge192" class="edge">
<title>expert_s1_t3_g6_l6&#45;&gt;comm_s1_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-1175.61C51780,-1167.99 51780,-1158.99 51780,-1150.21"/>
<polygon fill="black" stroke="black" points="51783.5,-1150.08 51780,-1140.08 51776.5,-1150.08 51783.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g6_l7 -->
<g id="node533" class="node">
<title>expert_s1_t3_g6_l7</title>
<polygon fill="lightgreen" stroke="black" points="43254,-1411.9 42996,-1411.9 42996,-1370.9 43254,-1370.9 43254,-1411.9"/>
<text text-anchor="middle" x="43125" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;7 GPU&#45;62</text>
<text text-anchor="middle" x="43125" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43125" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g6_l8 -->
<g id="node534" class="node">
<title>expert_s1_t3_g6_l8</title>
<polygon fill="lightgreen" stroke="black" points="42978,-1411.9 42720,-1411.9 42720,-1370.9 42978,-1370.9 42978,-1411.9"/>
<text text-anchor="middle" x="42849" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;8 GPU&#45;62</text>
<text text-anchor="middle" x="42849" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42849" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g6_l9 -->
<g id="node535" class="node">
<title>expert_s1_t3_g6_l9</title>
<polygon fill="lightgreen" stroke="black" points="42702,-1411.9 42444,-1411.9 42444,-1370.9 42702,-1370.9 42702,-1411.9"/>
<text text-anchor="middle" x="42573" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;9 GPU&#45;62</text>
<text text-anchor="middle" x="42573" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42573" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g6_l10 -->
<g id="node536" class="node">
<title>expert_s1_t3_g6_l10</title>
<polygon fill="lightgreen" stroke="black" points="42426,-1411.9 42168,-1411.9 42168,-1370.9 42426,-1370.9 42426,-1411.9"/>
<text text-anchor="middle" x="42297" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;10 GPU&#45;62</text>
<text text-anchor="middle" x="42297" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42297" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g6_l11 -->
<g id="node537" class="node">
<title>expert_s1_t3_g6_l11</title>
<polygon fill="lightgreen" stroke="black" points="42150,-1411.9 41892,-1411.9 41892,-1370.9 42150,-1370.9 42150,-1411.9"/>
<text text-anchor="middle" x="42021" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;62 Layer&#45;11 GPU&#45;62</text>
<text text-anchor="middle" x="42021" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42021" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s1_t3_g7 -->
<g id="node538" class="node">
<title>attn_s1_t3_g7</title>
<polygon fill="lightgreen" stroke="black" points="53591.5,-1411.9 53316.5,-1411.9 53316.5,-1370.9 53591.5,-1370.9 53591.5,-1411.9"/>
<text text-anchor="middle" x="53454" y="-1399.9" font-family="Arial" font-size="10.00">Attention GPU&#45;63</text>
<text text-anchor="middle" x="53454" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53454" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s1_t3_g7 -->
<g id="node539" class="node">
<title>gate_s1_t3_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="53592.32,-1334.9 53170.26,-1334.9 53061.68,-1252.9 53483.74,-1252.9 53592.32,-1334.9"/>
<text text-anchor="middle" x="53327" y="-1302.4" font-family="Arial" font-size="10.00">Gate GPU&#45;63</text>
<text text-anchor="middle" x="53327" y="-1291.4" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-1280.4" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s1_t3_g7&#45;&gt;gate_s1_t3_g7 -->
<g id="edge193" class="edge">
<title>attn_s1_t3_g7&#45;&gt;gate_s1_t3_g7</title>
<path fill="none" stroke="black" d="M53427.99,-1370.84C53416.47,-1362.17 53402.37,-1351.57 53388.41,-1341.08"/>
<polygon fill="black" stroke="black" points="53390.33,-1338.14 53380.23,-1334.92 53386.12,-1343.73 53390.33,-1338.14"/>
</g>
<!-- expert_s1_t3_g7_l6 -->
<g id="node540" class="node">
<title>expert_s1_t3_g7_l6</title>
<polygon fill="lightgreen" stroke="black" points="53456,-1216.9 53198,-1216.9 53198,-1175.9 53456,-1175.9 53456,-1216.9"/>
<text text-anchor="middle" x="53327" y="-1204.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;6 GPU&#45;63</text>
<text text-anchor="middle" x="53327" y="-1193.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-1182.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s1_t3_g7&#45;&gt;expert_s1_t3_g7_l6 -->
<g id="edge194" class="edge">
<title>gate_s1_t3_g7&#45;&gt;expert_s1_t3_g7_l6</title>
<path fill="none" stroke="black" d="M53327,-1252.67C53327,-1244.1 53327,-1235.19 53327,-1227.09"/>
<polygon fill="black" stroke="black" points="53330.5,-1227.01 53327,-1217.01 53323.5,-1227.01 53330.5,-1227.01"/>
</g>
<!-- comm_s1_t3_g7 -->
<g id="node577" class="node">
<title>comm_s1_t3_g7</title>
<ellipse fill="lightblue" stroke="black" cx="53327" cy="-1110.91" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="53327" y="-1119.41" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;63</text>
<text text-anchor="middle" x="53327" y="-1108.41" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53327" y="-1097.41" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s1_t3_g7_l6&#45;&gt;comm_s1_t3_g7 -->
<g id="edge195" class="edge">
<title>expert_s1_t3_g7_l6&#45;&gt;comm_s1_t3_g7</title>
<path fill="none" stroke="black" d="M53327,-1175.61C53327,-1167.99 53327,-1158.99 53327,-1150.21"/>
<polygon fill="black" stroke="black" points="53330.5,-1150.08 53327,-1140.08 53323.5,-1150.08 53330.5,-1150.08"/>
</g>
<!-- expert_s1_t3_g7_l7 -->
<g id="node541" class="node">
<title>expert_s1_t3_g7_l7</title>
<polygon fill="lightgreen" stroke="black" points="41580,-1411.9 41322,-1411.9 41322,-1370.9 41580,-1370.9 41580,-1411.9"/>
<text text-anchor="middle" x="41451" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;7 GPU&#45;63</text>
<text text-anchor="middle" x="41451" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41451" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g7_l8 -->
<g id="node542" class="node">
<title>expert_s1_t3_g7_l8</title>
<polygon fill="lightgreen" stroke="black" points="41304,-1411.9 41046,-1411.9 41046,-1370.9 41304,-1370.9 41304,-1411.9"/>
<text text-anchor="middle" x="41175" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;8 GPU&#45;63</text>
<text text-anchor="middle" x="41175" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41175" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g7_l9 -->
<g id="node543" class="node">
<title>expert_s1_t3_g7_l9</title>
<polygon fill="lightgreen" stroke="black" points="41028,-1411.9 40770,-1411.9 40770,-1370.9 41028,-1370.9 41028,-1411.9"/>
<text text-anchor="middle" x="40899" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;9 GPU&#45;63</text>
<text text-anchor="middle" x="40899" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40899" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g7_l10 -->
<g id="node544" class="node">
<title>expert_s1_t3_g7_l10</title>
<polygon fill="lightgreen" stroke="black" points="40752,-1411.9 40494,-1411.9 40494,-1370.9 40752,-1370.9 40752,-1411.9"/>
<text text-anchor="middle" x="40623" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;10 GPU&#45;63</text>
<text text-anchor="middle" x="40623" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40623" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s1_t3_g7_l11 -->
<g id="node545" class="node">
<title>expert_s1_t3_g7_l11</title>
<polygon fill="lightgreen" stroke="black" points="40476,-1411.9 40218,-1411.9 40218,-1370.9 40476,-1370.9 40476,-1411.9"/>
<text text-anchor="middle" x="40347" y="-1399.9" font-family="Arial" font-size="10.00">Expert&#45;63 Layer&#45;11 GPU&#45;63</text>
<text text-anchor="middle" x="40347" y="-1388.9" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40347" y="-1377.9" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- pipeline_comm_s1 -->
<g id="node1155" class="node">
<title>pipeline_comm_s1</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-1016.92" rx="185.94" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-1025.42" font-family="Arial" font-size="10.00">Pipeline Communication Stage 1&#45;&gt;2</text>
<text text-anchor="middle" x="1542" y="-1014.42" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="1542" y="-1003.42" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- comm_s1_t0_g0&#45;&gt;pipeline_comm_s1 -->
<g id="edge196" class="edge">
<title>comm_s1_t0_g0&#45;&gt;pipeline_comm_s1</title>
<path fill="none" stroke="black" d="M1542,-1081.81C1542,-1073.77 1542,-1064.87 1542,-1056.32"/>
<polygon fill="black" stroke="black" points="1545.5,-1056.16 1542,-1046.16 1538.5,-1056.16 1545.5,-1056.16"/>
</g>
<!-- attn_s2_t0_g0 -->
<g id="node578" class="node">
<title>attn_s2_t0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1679.5,-917.93 1404.5,-917.93 1404.5,-876.93 1679.5,-876.93 1679.5,-917.93"/>
<text text-anchor="middle" x="1542" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;64</text>
<text text-anchor="middle" x="1542" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g0 -->
<g id="node579" class="node">
<title>gate_s2_t0_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="1807.32,-840.93 1385.26,-840.93 1276.68,-758.93 1698.74,-758.93 1807.32,-840.93"/>
<text text-anchor="middle" x="1542" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;64</text>
<text text-anchor="middle" x="1542" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g0&#45;&gt;gate_s2_t0_g0 -->
<g id="edge198" class="edge">
<title>attn_s2_t0_g0&#45;&gt;gate_s2_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-876.64C1542,-869.18 1542,-860.31 1542,-851.32"/>
<polygon fill="black" stroke="black" points="1545.5,-851.18 1542,-841.18 1538.5,-851.18 1545.5,-851.18"/>
</g>
<!-- expert_s2_t0_g0_l12 -->
<g id="node580" class="node">
<title>expert_s2_t0_g0_l12</title>
<polygon fill="lightgreen" stroke="black" points="1671,-722.93 1413,-722.93 1413,-681.93 1671,-681.93 1671,-722.93"/>
<text text-anchor="middle" x="1542" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;12 GPU&#45;64</text>
<text text-anchor="middle" x="1542" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g0&#45;&gt;expert_s2_t0_g0_l12 -->
<g id="edge199" class="edge">
<title>gate_s2_t0_g0&#45;&gt;expert_s2_t0_g0_l12</title>
<path fill="none" stroke="black" d="M1542,-758.71C1542,-750.13 1542,-741.22 1542,-733.12"/>
<polygon fill="black" stroke="black" points="1545.5,-733.04 1542,-723.04 1538.5,-733.04 1545.5,-733.04"/>
</g>
<!-- comm_s2_t0_g0 -->
<g id="node834" class="node">
<title>comm_s2_t0_g0</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;64</text>
<text text-anchor="middle" x="1542" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g0_l12&#45;&gt;comm_s2_t0_g0 -->
<g id="edge200" class="edge">
<title>expert_s2_t0_g0_l12&#45;&gt;comm_s2_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-681.64C1542,-674.02 1542,-665.03 1542,-656.24"/>
<polygon fill="black" stroke="black" points="1545.5,-656.12 1542,-646.12 1538.5,-656.12 1545.5,-656.12"/>
</g>
<!-- expert_s2_t0_g0_l13 -->
<g id="node581" class="node">
<title>expert_s2_t0_g0_l13</title>
<polygon fill="lightgreen" stroke="black" points="13104,-917.93 12846,-917.93 12846,-876.93 13104,-876.93 13104,-917.93"/>
<text text-anchor="middle" x="12975" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;13 GPU&#45;64</text>
<text text-anchor="middle" x="12975" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12975" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g0_l14 -->
<g id="node582" class="node">
<title>expert_s2_t0_g0_l14</title>
<polygon fill="lightgreen" stroke="black" points="12828,-917.93 12570,-917.93 12570,-876.93 12828,-876.93 12828,-917.93"/>
<text text-anchor="middle" x="12699" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;14 GPU&#45;64</text>
<text text-anchor="middle" x="12699" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12699" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g0_l15 -->
<g id="node583" class="node">
<title>expert_s2_t0_g0_l15</title>
<polygon fill="lightgreen" stroke="black" points="12552,-917.93 12294,-917.93 12294,-876.93 12552,-876.93 12552,-917.93"/>
<text text-anchor="middle" x="12423" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;15 GPU&#45;64</text>
<text text-anchor="middle" x="12423" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12423" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g0_l16 -->
<g id="node584" class="node">
<title>expert_s2_t0_g0_l16</title>
<polygon fill="lightgreen" stroke="black" points="12276,-917.93 12018,-917.93 12018,-876.93 12276,-876.93 12276,-917.93"/>
<text text-anchor="middle" x="12147" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;16 GPU&#45;64</text>
<text text-anchor="middle" x="12147" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12147" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g0_l17 -->
<g id="node585" class="node">
<title>expert_s2_t0_g0_l17</title>
<polygon fill="lightgreen" stroke="black" points="12000,-917.93 11742,-917.93 11742,-876.93 12000,-876.93 12000,-917.93"/>
<text text-anchor="middle" x="11871" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;64 Layer&#45;17 GPU&#45;64</text>
<text text-anchor="middle" x="11871" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11871" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g1 -->
<g id="node586" class="node">
<title>attn_s2_t0_g1</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-917.93 3078.5,-917.93 3078.5,-876.93 3353.5,-876.93 3353.5,-917.93"/>
<text text-anchor="middle" x="3216" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;65</text>
<text text-anchor="middle" x="3216" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g1 -->
<g id="node587" class="node">
<title>gate_s2_t0_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="3481.32,-840.93 3059.26,-840.93 2950.68,-758.93 3372.74,-758.93 3481.32,-840.93"/>
<text text-anchor="middle" x="3216" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;65</text>
<text text-anchor="middle" x="3216" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g1&#45;&gt;gate_s2_t0_g1 -->
<g id="edge201" class="edge">
<title>attn_s2_t0_g1&#45;&gt;gate_s2_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-876.64C3216,-869.18 3216,-860.31 3216,-851.32"/>
<polygon fill="black" stroke="black" points="3219.5,-851.18 3216,-841.18 3212.5,-851.18 3219.5,-851.18"/>
</g>
<!-- expert_s2_t0_g1_l12 -->
<g id="node588" class="node">
<title>expert_s2_t0_g1_l12</title>
<polygon fill="lightgreen" stroke="black" points="3345,-722.93 3087,-722.93 3087,-681.93 3345,-681.93 3345,-722.93"/>
<text text-anchor="middle" x="3216" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;12 GPU&#45;65</text>
<text text-anchor="middle" x="3216" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g1&#45;&gt;expert_s2_t0_g1_l12 -->
<g id="edge202" class="edge">
<title>gate_s2_t0_g1&#45;&gt;expert_s2_t0_g1_l12</title>
<path fill="none" stroke="black" d="M3216,-758.71C3216,-750.13 3216,-741.22 3216,-733.12"/>
<polygon fill="black" stroke="black" points="3219.5,-733.04 3216,-723.04 3212.5,-733.04 3219.5,-733.04"/>
</g>
<!-- comm_s2_t0_g1 -->
<g id="node835" class="node">
<title>comm_s2_t0_g1</title>
<ellipse fill="lightblue" stroke="black" cx="3216" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="3216" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;65</text>
<text text-anchor="middle" x="3216" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g1_l12&#45;&gt;comm_s2_t0_g1 -->
<g id="edge203" class="edge">
<title>expert_s2_t0_g1_l12&#45;&gt;comm_s2_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-681.64C3216,-674.02 3216,-665.03 3216,-656.24"/>
<polygon fill="black" stroke="black" points="3219.5,-656.12 3216,-646.12 3212.5,-656.12 3219.5,-656.12"/>
</g>
<!-- expert_s2_t0_g1_l13 -->
<g id="node589" class="node">
<title>expert_s2_t0_g1_l13</title>
<polygon fill="lightgreen" stroke="black" points="11430,-917.93 11172,-917.93 11172,-876.93 11430,-876.93 11430,-917.93"/>
<text text-anchor="middle" x="11301" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;13 GPU&#45;65</text>
<text text-anchor="middle" x="11301" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11301" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g1_l14 -->
<g id="node590" class="node">
<title>expert_s2_t0_g1_l14</title>
<polygon fill="lightgreen" stroke="black" points="11154,-917.93 10896,-917.93 10896,-876.93 11154,-876.93 11154,-917.93"/>
<text text-anchor="middle" x="11025" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;14 GPU&#45;65</text>
<text text-anchor="middle" x="11025" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11025" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g1_l15 -->
<g id="node591" class="node">
<title>expert_s2_t0_g1_l15</title>
<polygon fill="lightgreen" stroke="black" points="10878,-917.93 10620,-917.93 10620,-876.93 10878,-876.93 10878,-917.93"/>
<text text-anchor="middle" x="10749" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;15 GPU&#45;65</text>
<text text-anchor="middle" x="10749" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10749" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g1_l16 -->
<g id="node592" class="node">
<title>expert_s2_t0_g1_l16</title>
<polygon fill="lightgreen" stroke="black" points="10602,-917.93 10344,-917.93 10344,-876.93 10602,-876.93 10602,-917.93"/>
<text text-anchor="middle" x="10473" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;16 GPU&#45;65</text>
<text text-anchor="middle" x="10473" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10473" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g1_l17 -->
<g id="node593" class="node">
<title>expert_s2_t0_g1_l17</title>
<polygon fill="lightgreen" stroke="black" points="10326,-917.93 10068,-917.93 10068,-876.93 10326,-876.93 10326,-917.93"/>
<text text-anchor="middle" x="10197" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;65 Layer&#45;17 GPU&#45;65</text>
<text text-anchor="middle" x="10197" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10197" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g2 -->
<g id="node594" class="node">
<title>attn_s2_t0_g2</title>
<polygon fill="lightgreen" stroke="black" points="5027.5,-917.93 4752.5,-917.93 4752.5,-876.93 5027.5,-876.93 5027.5,-917.93"/>
<text text-anchor="middle" x="4890" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;66</text>
<text text-anchor="middle" x="4890" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g2 -->
<g id="node595" class="node">
<title>gate_s2_t0_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5155.32,-840.93 4733.26,-840.93 4624.68,-758.93 5046.74,-758.93 5155.32,-840.93"/>
<text text-anchor="middle" x="4890" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;66</text>
<text text-anchor="middle" x="4890" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g2&#45;&gt;gate_s2_t0_g2 -->
<g id="edge204" class="edge">
<title>attn_s2_t0_g2&#45;&gt;gate_s2_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-876.64C4890,-869.18 4890,-860.31 4890,-851.32"/>
<polygon fill="black" stroke="black" points="4893.5,-851.18 4890,-841.18 4886.5,-851.18 4893.5,-851.18"/>
</g>
<!-- expert_s2_t0_g2_l12 -->
<g id="node596" class="node">
<title>expert_s2_t0_g2_l12</title>
<polygon fill="lightgreen" stroke="black" points="5019,-722.93 4761,-722.93 4761,-681.93 5019,-681.93 5019,-722.93"/>
<text text-anchor="middle" x="4890" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;12 GPU&#45;66</text>
<text text-anchor="middle" x="4890" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g2&#45;&gt;expert_s2_t0_g2_l12 -->
<g id="edge205" class="edge">
<title>gate_s2_t0_g2&#45;&gt;expert_s2_t0_g2_l12</title>
<path fill="none" stroke="black" d="M4890,-758.71C4890,-750.13 4890,-741.22 4890,-733.12"/>
<polygon fill="black" stroke="black" points="4893.5,-733.04 4890,-723.04 4886.5,-733.04 4893.5,-733.04"/>
</g>
<!-- comm_s2_t0_g2 -->
<g id="node836" class="node">
<title>comm_s2_t0_g2</title>
<ellipse fill="lightblue" stroke="black" cx="4890" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="4890" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;66</text>
<text text-anchor="middle" x="4890" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g2_l12&#45;&gt;comm_s2_t0_g2 -->
<g id="edge206" class="edge">
<title>expert_s2_t0_g2_l12&#45;&gt;comm_s2_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-681.64C4890,-674.02 4890,-665.03 4890,-656.24"/>
<polygon fill="black" stroke="black" points="4893.5,-656.12 4890,-646.12 4886.5,-656.12 4893.5,-656.12"/>
</g>
<!-- expert_s2_t0_g2_l13 -->
<g id="node597" class="node">
<title>expert_s2_t0_g2_l13</title>
<polygon fill="lightgreen" stroke="black" points="9756,-917.93 9498,-917.93 9498,-876.93 9756,-876.93 9756,-917.93"/>
<text text-anchor="middle" x="9627" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;13 GPU&#45;66</text>
<text text-anchor="middle" x="9627" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9627" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g2_l14 -->
<g id="node598" class="node">
<title>expert_s2_t0_g2_l14</title>
<polygon fill="lightgreen" stroke="black" points="9480,-917.93 9222,-917.93 9222,-876.93 9480,-876.93 9480,-917.93"/>
<text text-anchor="middle" x="9351" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;14 GPU&#45;66</text>
<text text-anchor="middle" x="9351" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9351" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g2_l15 -->
<g id="node599" class="node">
<title>expert_s2_t0_g2_l15</title>
<polygon fill="lightgreen" stroke="black" points="9204,-917.93 8946,-917.93 8946,-876.93 9204,-876.93 9204,-917.93"/>
<text text-anchor="middle" x="9075" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;15 GPU&#45;66</text>
<text text-anchor="middle" x="9075" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9075" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g2_l16 -->
<g id="node600" class="node">
<title>expert_s2_t0_g2_l16</title>
<polygon fill="lightgreen" stroke="black" points="8928,-917.93 8670,-917.93 8670,-876.93 8928,-876.93 8928,-917.93"/>
<text text-anchor="middle" x="8799" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;16 GPU&#45;66</text>
<text text-anchor="middle" x="8799" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8799" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g2_l17 -->
<g id="node601" class="node">
<title>expert_s2_t0_g2_l17</title>
<polygon fill="lightgreen" stroke="black" points="8652,-917.93 8394,-917.93 8394,-876.93 8652,-876.93 8652,-917.93"/>
<text text-anchor="middle" x="8523" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;66 Layer&#45;17 GPU&#45;66</text>
<text text-anchor="middle" x="8523" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8523" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g3 -->
<g id="node602" class="node">
<title>attn_s2_t0_g3</title>
<polygon fill="lightgreen" stroke="black" points="6701.5,-917.93 6426.5,-917.93 6426.5,-876.93 6701.5,-876.93 6701.5,-917.93"/>
<text text-anchor="middle" x="6564" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;67</text>
<text text-anchor="middle" x="6564" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g3 -->
<g id="node603" class="node">
<title>gate_s2_t0_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="6829.32,-840.93 6407.26,-840.93 6298.68,-758.93 6720.74,-758.93 6829.32,-840.93"/>
<text text-anchor="middle" x="6564" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;67</text>
<text text-anchor="middle" x="6564" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g3&#45;&gt;gate_s2_t0_g3 -->
<g id="edge207" class="edge">
<title>attn_s2_t0_g3&#45;&gt;gate_s2_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-876.64C6564,-869.18 6564,-860.31 6564,-851.32"/>
<polygon fill="black" stroke="black" points="6567.5,-851.18 6564,-841.18 6560.5,-851.18 6567.5,-851.18"/>
</g>
<!-- expert_s2_t0_g3_l12 -->
<g id="node604" class="node">
<title>expert_s2_t0_g3_l12</title>
<polygon fill="lightgreen" stroke="black" points="6693,-722.93 6435,-722.93 6435,-681.93 6693,-681.93 6693,-722.93"/>
<text text-anchor="middle" x="6564" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;12 GPU&#45;67</text>
<text text-anchor="middle" x="6564" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g3&#45;&gt;expert_s2_t0_g3_l12 -->
<g id="edge208" class="edge">
<title>gate_s2_t0_g3&#45;&gt;expert_s2_t0_g3_l12</title>
<path fill="none" stroke="black" d="M6564,-758.71C6564,-750.13 6564,-741.22 6564,-733.12"/>
<polygon fill="black" stroke="black" points="6567.5,-733.04 6564,-723.04 6560.5,-733.04 6567.5,-733.04"/>
</g>
<!-- comm_s2_t0_g3 -->
<g id="node837" class="node">
<title>comm_s2_t0_g3</title>
<ellipse fill="lightblue" stroke="black" cx="6564" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="6564" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;67</text>
<text text-anchor="middle" x="6564" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g3_l12&#45;&gt;comm_s2_t0_g3 -->
<g id="edge209" class="edge">
<title>expert_s2_t0_g3_l12&#45;&gt;comm_s2_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-681.64C6564,-674.02 6564,-665.03 6564,-656.24"/>
<polygon fill="black" stroke="black" points="6567.5,-656.12 6564,-646.12 6560.5,-656.12 6567.5,-656.12"/>
</g>
<!-- expert_s2_t0_g3_l13 -->
<g id="node605" class="node">
<title>expert_s2_t0_g3_l13</title>
<polygon fill="lightgreen" stroke="black" points="8082,-917.93 7824,-917.93 7824,-876.93 8082,-876.93 8082,-917.93"/>
<text text-anchor="middle" x="7953" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;13 GPU&#45;67</text>
<text text-anchor="middle" x="7953" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7953" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g3_l14 -->
<g id="node606" class="node">
<title>expert_s2_t0_g3_l14</title>
<polygon fill="lightgreen" stroke="black" points="7806,-917.93 7548,-917.93 7548,-876.93 7806,-876.93 7806,-917.93"/>
<text text-anchor="middle" x="7677" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;14 GPU&#45;67</text>
<text text-anchor="middle" x="7677" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7677" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g3_l15 -->
<g id="node607" class="node">
<title>expert_s2_t0_g3_l15</title>
<polygon fill="lightgreen" stroke="black" points="7530,-917.93 7272,-917.93 7272,-876.93 7530,-876.93 7530,-917.93"/>
<text text-anchor="middle" x="7401" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;15 GPU&#45;67</text>
<text text-anchor="middle" x="7401" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7401" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g3_l16 -->
<g id="node608" class="node">
<title>expert_s2_t0_g3_l16</title>
<polygon fill="lightgreen" stroke="black" points="7254,-917.93 6996,-917.93 6996,-876.93 7254,-876.93 7254,-917.93"/>
<text text-anchor="middle" x="7125" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;16 GPU&#45;67</text>
<text text-anchor="middle" x="7125" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7125" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g3_l17 -->
<g id="node609" class="node">
<title>expert_s2_t0_g3_l17</title>
<polygon fill="lightgreen" stroke="black" points="6978,-917.93 6720,-917.93 6720,-876.93 6978,-876.93 6978,-917.93"/>
<text text-anchor="middle" x="6849" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;67 Layer&#45;17 GPU&#45;67</text>
<text text-anchor="middle" x="6849" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6849" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g4 -->
<g id="node610" class="node">
<title>attn_s2_t0_g4</title>
<polygon fill="lightgreen" stroke="black" points="8375.5,-917.93 8100.5,-917.93 8100.5,-876.93 8375.5,-876.93 8375.5,-917.93"/>
<text text-anchor="middle" x="8238" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;68</text>
<text text-anchor="middle" x="8238" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g4 -->
<g id="node611" class="node">
<title>gate_s2_t0_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="8503.32,-840.93 8081.26,-840.93 7972.68,-758.93 8394.74,-758.93 8503.32,-840.93"/>
<text text-anchor="middle" x="8238" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;68</text>
<text text-anchor="middle" x="8238" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g4&#45;&gt;gate_s2_t0_g4 -->
<g id="edge210" class="edge">
<title>attn_s2_t0_g4&#45;&gt;gate_s2_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-876.64C8238,-869.18 8238,-860.31 8238,-851.32"/>
<polygon fill="black" stroke="black" points="8241.5,-851.18 8238,-841.18 8234.5,-851.18 8241.5,-851.18"/>
</g>
<!-- expert_s2_t0_g4_l12 -->
<g id="node612" class="node">
<title>expert_s2_t0_g4_l12</title>
<polygon fill="lightgreen" stroke="black" points="8367,-722.93 8109,-722.93 8109,-681.93 8367,-681.93 8367,-722.93"/>
<text text-anchor="middle" x="8238" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;12 GPU&#45;68</text>
<text text-anchor="middle" x="8238" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g4&#45;&gt;expert_s2_t0_g4_l12 -->
<g id="edge211" class="edge">
<title>gate_s2_t0_g4&#45;&gt;expert_s2_t0_g4_l12</title>
<path fill="none" stroke="black" d="M8238,-758.71C8238,-750.13 8238,-741.22 8238,-733.12"/>
<polygon fill="black" stroke="black" points="8241.5,-733.04 8238,-723.04 8234.5,-733.04 8241.5,-733.04"/>
</g>
<!-- comm_s2_t0_g4 -->
<g id="node838" class="node">
<title>comm_s2_t0_g4</title>
<ellipse fill="lightblue" stroke="black" cx="8238" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8238" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;68</text>
<text text-anchor="middle" x="8238" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g4_l12&#45;&gt;comm_s2_t0_g4 -->
<g id="edge212" class="edge">
<title>expert_s2_t0_g4_l12&#45;&gt;comm_s2_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-681.64C8238,-674.02 8238,-665.03 8238,-656.24"/>
<polygon fill="black" stroke="black" points="8241.5,-656.12 8238,-646.12 8234.5,-656.12 8241.5,-656.12"/>
</g>
<!-- expert_s2_t0_g4_l13 -->
<g id="node613" class="node">
<title>expert_s2_t0_g4_l13</title>
<polygon fill="lightgreen" stroke="black" points="6408,-917.93 6150,-917.93 6150,-876.93 6408,-876.93 6408,-917.93"/>
<text text-anchor="middle" x="6279" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;13 GPU&#45;68</text>
<text text-anchor="middle" x="6279" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6279" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g4_l14 -->
<g id="node614" class="node">
<title>expert_s2_t0_g4_l14</title>
<polygon fill="lightgreen" stroke="black" points="6132,-917.93 5874,-917.93 5874,-876.93 6132,-876.93 6132,-917.93"/>
<text text-anchor="middle" x="6003" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;14 GPU&#45;68</text>
<text text-anchor="middle" x="6003" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6003" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g4_l15 -->
<g id="node615" class="node">
<title>expert_s2_t0_g4_l15</title>
<polygon fill="lightgreen" stroke="black" points="5856,-917.93 5598,-917.93 5598,-876.93 5856,-876.93 5856,-917.93"/>
<text text-anchor="middle" x="5727" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;15 GPU&#45;68</text>
<text text-anchor="middle" x="5727" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5727" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g4_l16 -->
<g id="node616" class="node">
<title>expert_s2_t0_g4_l16</title>
<polygon fill="lightgreen" stroke="black" points="5580,-917.93 5322,-917.93 5322,-876.93 5580,-876.93 5580,-917.93"/>
<text text-anchor="middle" x="5451" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;16 GPU&#45;68</text>
<text text-anchor="middle" x="5451" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5451" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g4_l17 -->
<g id="node617" class="node">
<title>expert_s2_t0_g4_l17</title>
<polygon fill="lightgreen" stroke="black" points="5304,-917.93 5046,-917.93 5046,-876.93 5304,-876.93 5304,-917.93"/>
<text text-anchor="middle" x="5175" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;68 Layer&#45;17 GPU&#45;68</text>
<text text-anchor="middle" x="5175" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5175" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g5 -->
<g id="node618" class="node">
<title>attn_s2_t0_g5</title>
<polygon fill="lightgreen" stroke="black" points="10049.5,-917.93 9774.5,-917.93 9774.5,-876.93 10049.5,-876.93 10049.5,-917.93"/>
<text text-anchor="middle" x="9912" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;69</text>
<text text-anchor="middle" x="9912" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g5 -->
<g id="node619" class="node">
<title>gate_s2_t0_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="10177.32,-840.93 9755.26,-840.93 9646.68,-758.93 10068.74,-758.93 10177.32,-840.93"/>
<text text-anchor="middle" x="9912" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;69</text>
<text text-anchor="middle" x="9912" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g5&#45;&gt;gate_s2_t0_g5 -->
<g id="edge213" class="edge">
<title>attn_s2_t0_g5&#45;&gt;gate_s2_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-876.64C9912,-869.18 9912,-860.31 9912,-851.32"/>
<polygon fill="black" stroke="black" points="9915.5,-851.18 9912,-841.18 9908.5,-851.18 9915.5,-851.18"/>
</g>
<!-- expert_s2_t0_g5_l12 -->
<g id="node620" class="node">
<title>expert_s2_t0_g5_l12</title>
<polygon fill="lightgreen" stroke="black" points="10041,-722.93 9783,-722.93 9783,-681.93 10041,-681.93 10041,-722.93"/>
<text text-anchor="middle" x="9912" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;12 GPU&#45;69</text>
<text text-anchor="middle" x="9912" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g5&#45;&gt;expert_s2_t0_g5_l12 -->
<g id="edge214" class="edge">
<title>gate_s2_t0_g5&#45;&gt;expert_s2_t0_g5_l12</title>
<path fill="none" stroke="black" d="M9912,-758.71C9912,-750.13 9912,-741.22 9912,-733.12"/>
<polygon fill="black" stroke="black" points="9915.5,-733.04 9912,-723.04 9908.5,-733.04 9915.5,-733.04"/>
</g>
<!-- comm_s2_t0_g5 -->
<g id="node839" class="node">
<title>comm_s2_t0_g5</title>
<ellipse fill="lightblue" stroke="black" cx="9912" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9912" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;69</text>
<text text-anchor="middle" x="9912" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g5_l12&#45;&gt;comm_s2_t0_g5 -->
<g id="edge215" class="edge">
<title>expert_s2_t0_g5_l12&#45;&gt;comm_s2_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-681.64C9912,-674.02 9912,-665.03 9912,-656.24"/>
<polygon fill="black" stroke="black" points="9915.5,-656.12 9912,-646.12 9908.5,-656.12 9915.5,-656.12"/>
</g>
<!-- expert_s2_t0_g5_l13 -->
<g id="node621" class="node">
<title>expert_s2_t0_g5_l13</title>
<polygon fill="lightgreen" stroke="black" points="4734,-917.93 4476,-917.93 4476,-876.93 4734,-876.93 4734,-917.93"/>
<text text-anchor="middle" x="4605" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;13 GPU&#45;69</text>
<text text-anchor="middle" x="4605" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4605" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g5_l14 -->
<g id="node622" class="node">
<title>expert_s2_t0_g5_l14</title>
<polygon fill="lightgreen" stroke="black" points="4458,-917.93 4200,-917.93 4200,-876.93 4458,-876.93 4458,-917.93"/>
<text text-anchor="middle" x="4329" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;14 GPU&#45;69</text>
<text text-anchor="middle" x="4329" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4329" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g5_l15 -->
<g id="node623" class="node">
<title>expert_s2_t0_g5_l15</title>
<polygon fill="lightgreen" stroke="black" points="4182,-917.93 3924,-917.93 3924,-876.93 4182,-876.93 4182,-917.93"/>
<text text-anchor="middle" x="4053" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;15 GPU&#45;69</text>
<text text-anchor="middle" x="4053" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4053" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g5_l16 -->
<g id="node624" class="node">
<title>expert_s2_t0_g5_l16</title>
<polygon fill="lightgreen" stroke="black" points="3906,-917.93 3648,-917.93 3648,-876.93 3906,-876.93 3906,-917.93"/>
<text text-anchor="middle" x="3777" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;16 GPU&#45;69</text>
<text text-anchor="middle" x="3777" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3777" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g5_l17 -->
<g id="node625" class="node">
<title>expert_s2_t0_g5_l17</title>
<polygon fill="lightgreen" stroke="black" points="3630,-917.93 3372,-917.93 3372,-876.93 3630,-876.93 3630,-917.93"/>
<text text-anchor="middle" x="3501" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;69 Layer&#45;17 GPU&#45;69</text>
<text text-anchor="middle" x="3501" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3501" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g6 -->
<g id="node626" class="node">
<title>attn_s2_t0_g6</title>
<polygon fill="lightgreen" stroke="black" points="11723.5,-917.93 11448.5,-917.93 11448.5,-876.93 11723.5,-876.93 11723.5,-917.93"/>
<text text-anchor="middle" x="11586" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;70</text>
<text text-anchor="middle" x="11586" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g6 -->
<g id="node627" class="node">
<title>gate_s2_t0_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11851.32,-840.93 11429.26,-840.93 11320.68,-758.93 11742.74,-758.93 11851.32,-840.93"/>
<text text-anchor="middle" x="11586" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;70</text>
<text text-anchor="middle" x="11586" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g6&#45;&gt;gate_s2_t0_g6 -->
<g id="edge216" class="edge">
<title>attn_s2_t0_g6&#45;&gt;gate_s2_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-876.64C11586,-869.18 11586,-860.31 11586,-851.32"/>
<polygon fill="black" stroke="black" points="11589.5,-851.18 11586,-841.18 11582.5,-851.18 11589.5,-851.18"/>
</g>
<!-- expert_s2_t0_g6_l12 -->
<g id="node628" class="node">
<title>expert_s2_t0_g6_l12</title>
<polygon fill="lightgreen" stroke="black" points="11715,-722.93 11457,-722.93 11457,-681.93 11715,-681.93 11715,-722.93"/>
<text text-anchor="middle" x="11586" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;12 GPU&#45;70</text>
<text text-anchor="middle" x="11586" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g6&#45;&gt;expert_s2_t0_g6_l12 -->
<g id="edge217" class="edge">
<title>gate_s2_t0_g6&#45;&gt;expert_s2_t0_g6_l12</title>
<path fill="none" stroke="black" d="M11586,-758.71C11586,-750.13 11586,-741.22 11586,-733.12"/>
<polygon fill="black" stroke="black" points="11589.5,-733.04 11586,-723.04 11582.5,-733.04 11589.5,-733.04"/>
</g>
<!-- comm_s2_t0_g6 -->
<g id="node840" class="node">
<title>comm_s2_t0_g6</title>
<ellipse fill="lightblue" stroke="black" cx="11586" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="11586" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;70</text>
<text text-anchor="middle" x="11586" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g6_l12&#45;&gt;comm_s2_t0_g6 -->
<g id="edge218" class="edge">
<title>expert_s2_t0_g6_l12&#45;&gt;comm_s2_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-681.64C11586,-674.02 11586,-665.03 11586,-656.24"/>
<polygon fill="black" stroke="black" points="11589.5,-656.12 11586,-646.12 11582.5,-656.12 11589.5,-656.12"/>
</g>
<!-- expert_s2_t0_g6_l13 -->
<g id="node629" class="node">
<title>expert_s2_t0_g6_l13</title>
<polygon fill="lightgreen" stroke="black" points="3060,-917.93 2802,-917.93 2802,-876.93 3060,-876.93 3060,-917.93"/>
<text text-anchor="middle" x="2931" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;13 GPU&#45;70</text>
<text text-anchor="middle" x="2931" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2931" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g6_l14 -->
<g id="node630" class="node">
<title>expert_s2_t0_g6_l14</title>
<polygon fill="lightgreen" stroke="black" points="2784,-917.93 2526,-917.93 2526,-876.93 2784,-876.93 2784,-917.93"/>
<text text-anchor="middle" x="2655" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;14 GPU&#45;70</text>
<text text-anchor="middle" x="2655" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2655" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g6_l15 -->
<g id="node631" class="node">
<title>expert_s2_t0_g6_l15</title>
<polygon fill="lightgreen" stroke="black" points="2508,-917.93 2250,-917.93 2250,-876.93 2508,-876.93 2508,-917.93"/>
<text text-anchor="middle" x="2379" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;15 GPU&#45;70</text>
<text text-anchor="middle" x="2379" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2379" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g6_l16 -->
<g id="node632" class="node">
<title>expert_s2_t0_g6_l16</title>
<polygon fill="lightgreen" stroke="black" points="2232,-917.93 1974,-917.93 1974,-876.93 2232,-876.93 2232,-917.93"/>
<text text-anchor="middle" x="2103" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;16 GPU&#45;70</text>
<text text-anchor="middle" x="2103" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2103" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g6_l17 -->
<g id="node633" class="node">
<title>expert_s2_t0_g6_l17</title>
<polygon fill="lightgreen" stroke="black" points="1956,-917.93 1698,-917.93 1698,-876.93 1956,-876.93 1956,-917.93"/>
<text text-anchor="middle" x="1827" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;70 Layer&#45;17 GPU&#45;70</text>
<text text-anchor="middle" x="1827" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1827" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t0_g7 -->
<g id="node634" class="node">
<title>attn_s2_t0_g7</title>
<polygon fill="lightgreen" stroke="black" points="13397.5,-917.93 13122.5,-917.93 13122.5,-876.93 13397.5,-876.93 13397.5,-917.93"/>
<text text-anchor="middle" x="13260" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;71</text>
<text text-anchor="middle" x="13260" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13260" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t0_g7 -->
<g id="node635" class="node">
<title>gate_s2_t0_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="13398.32,-840.93 12976.26,-840.93 12867.68,-758.93 13289.74,-758.93 13398.32,-840.93"/>
<text text-anchor="middle" x="13133" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;71</text>
<text text-anchor="middle" x="13133" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t0_g7&#45;&gt;gate_s2_t0_g7 -->
<g id="edge219" class="edge">
<title>attn_s2_t0_g7&#45;&gt;gate_s2_t0_g7</title>
<path fill="none" stroke="black" d="M13233.99,-876.87C13222.47,-868.21 13208.37,-857.61 13194.41,-847.11"/>
<polygon fill="black" stroke="black" points="13196.33,-844.17 13186.23,-840.96 13192.12,-849.77 13196.33,-844.17"/>
</g>
<!-- expert_s2_t0_g7_l12 -->
<g id="node636" class="node">
<title>expert_s2_t0_g7_l12</title>
<polygon fill="lightgreen" stroke="black" points="13262,-722.93 13004,-722.93 13004,-681.93 13262,-681.93 13262,-722.93"/>
<text text-anchor="middle" x="13133" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;12 GPU&#45;71</text>
<text text-anchor="middle" x="13133" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t0_g7&#45;&gt;expert_s2_t0_g7_l12 -->
<g id="edge220" class="edge">
<title>gate_s2_t0_g7&#45;&gt;expert_s2_t0_g7_l12</title>
<path fill="none" stroke="black" d="M13133,-758.71C13133,-750.13 13133,-741.22 13133,-733.12"/>
<polygon fill="black" stroke="black" points="13136.5,-733.04 13133,-723.04 13129.5,-733.04 13136.5,-733.04"/>
</g>
<!-- comm_s2_t0_g7 -->
<g id="node841" class="node">
<title>comm_s2_t0_g7</title>
<ellipse fill="lightblue" stroke="black" cx="13133" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="13133" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;71</text>
<text text-anchor="middle" x="13133" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13133" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t0_g7_l12&#45;&gt;comm_s2_t0_g7 -->
<g id="edge221" class="edge">
<title>expert_s2_t0_g7_l12&#45;&gt;comm_s2_t0_g7</title>
<path fill="none" stroke="black" d="M13133,-681.64C13133,-674.02 13133,-665.03 13133,-656.24"/>
<polygon fill="black" stroke="black" points="13136.5,-656.12 13133,-646.12 13129.5,-656.12 13136.5,-656.12"/>
</g>
<!-- expert_s2_t0_g7_l13 -->
<g id="node637" class="node">
<title>expert_s2_t0_g7_l13</title>
<polygon fill="lightgreen" stroke="black" points="1386,-917.93 1128,-917.93 1128,-876.93 1386,-876.93 1386,-917.93"/>
<text text-anchor="middle" x="1257" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;13 GPU&#45;71</text>
<text text-anchor="middle" x="1257" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1257" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g7_l14 -->
<g id="node638" class="node">
<title>expert_s2_t0_g7_l14</title>
<polygon fill="lightgreen" stroke="black" points="1110,-917.93 852,-917.93 852,-876.93 1110,-876.93 1110,-917.93"/>
<text text-anchor="middle" x="981" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;14 GPU&#45;71</text>
<text text-anchor="middle" x="981" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="981" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g7_l15 -->
<g id="node639" class="node">
<title>expert_s2_t0_g7_l15</title>
<polygon fill="lightgreen" stroke="black" points="834,-917.93 576,-917.93 576,-876.93 834,-876.93 834,-917.93"/>
<text text-anchor="middle" x="705" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;15 GPU&#45;71</text>
<text text-anchor="middle" x="705" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="705" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g7_l16 -->
<g id="node640" class="node">
<title>expert_s2_t0_g7_l16</title>
<polygon fill="lightgreen" stroke="black" points="558,-917.93 300,-917.93 300,-876.93 558,-876.93 558,-917.93"/>
<text text-anchor="middle" x="429" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;16 GPU&#45;71</text>
<text text-anchor="middle" x="429" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="429" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t0_g7_l17 -->
<g id="node641" class="node">
<title>expert_s2_t0_g7_l17</title>
<polygon fill="lightgreen" stroke="black" points="282,-917.93 24,-917.93 24,-876.93 282,-876.93 282,-917.93"/>
<text text-anchor="middle" x="153" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;71 Layer&#45;17 GPU&#45;71</text>
<text text-anchor="middle" x="153" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="153" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g0 -->
<g id="node642" class="node">
<title>attn_s2_t1_g0</title>
<polygon fill="lightgreen" stroke="black" points="15077.5,-917.93 14802.5,-917.93 14802.5,-876.93 15077.5,-876.93 15077.5,-917.93"/>
<text text-anchor="middle" x="14940" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;72</text>
<text text-anchor="middle" x="14940" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g0 -->
<g id="node643" class="node">
<title>gate_s2_t1_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="15205.32,-840.93 14783.26,-840.93 14674.68,-758.93 15096.74,-758.93 15205.32,-840.93"/>
<text text-anchor="middle" x="14940" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;72</text>
<text text-anchor="middle" x="14940" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g0&#45;&gt;gate_s2_t1_g0 -->
<g id="edge222" class="edge">
<title>attn_s2_t1_g0&#45;&gt;gate_s2_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-876.64C14940,-869.18 14940,-860.31 14940,-851.32"/>
<polygon fill="black" stroke="black" points="14943.5,-851.18 14940,-841.18 14936.5,-851.18 14943.5,-851.18"/>
</g>
<!-- expert_s2_t1_g0_l12 -->
<g id="node644" class="node">
<title>expert_s2_t1_g0_l12</title>
<polygon fill="lightgreen" stroke="black" points="15069,-722.93 14811,-722.93 14811,-681.93 15069,-681.93 15069,-722.93"/>
<text text-anchor="middle" x="14940" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;12 GPU&#45;72</text>
<text text-anchor="middle" x="14940" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g0&#45;&gt;expert_s2_t1_g0_l12 -->
<g id="edge223" class="edge">
<title>gate_s2_t1_g0&#45;&gt;expert_s2_t1_g0_l12</title>
<path fill="none" stroke="black" d="M14940,-758.71C14940,-750.13 14940,-741.22 14940,-733.12"/>
<polygon fill="black" stroke="black" points="14943.5,-733.04 14940,-723.04 14936.5,-733.04 14943.5,-733.04"/>
</g>
<!-- comm_s2_t1_g0 -->
<g id="node842" class="node">
<title>comm_s2_t1_g0</title>
<ellipse fill="lightblue" stroke="black" cx="14940" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="14940" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;72</text>
<text text-anchor="middle" x="14940" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g0_l12&#45;&gt;comm_s2_t1_g0 -->
<g id="edge224" class="edge">
<title>expert_s2_t1_g0_l12&#45;&gt;comm_s2_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-681.64C14940,-674.02 14940,-665.03 14940,-656.24"/>
<polygon fill="black" stroke="black" points="14943.5,-656.12 14940,-646.12 14936.5,-656.12 14943.5,-656.12"/>
</g>
<!-- expert_s2_t1_g0_l13 -->
<g id="node645" class="node">
<title>expert_s2_t1_g0_l13</title>
<polygon fill="lightgreen" stroke="black" points="26502,-917.93 26244,-917.93 26244,-876.93 26502,-876.93 26502,-917.93"/>
<text text-anchor="middle" x="26373" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;13 GPU&#45;72</text>
<text text-anchor="middle" x="26373" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26373" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g0_l14 -->
<g id="node646" class="node">
<title>expert_s2_t1_g0_l14</title>
<polygon fill="lightgreen" stroke="black" points="26226,-917.93 25968,-917.93 25968,-876.93 26226,-876.93 26226,-917.93"/>
<text text-anchor="middle" x="26097" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;14 GPU&#45;72</text>
<text text-anchor="middle" x="26097" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26097" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g0_l15 -->
<g id="node647" class="node">
<title>expert_s2_t1_g0_l15</title>
<polygon fill="lightgreen" stroke="black" points="25950,-917.93 25692,-917.93 25692,-876.93 25950,-876.93 25950,-917.93"/>
<text text-anchor="middle" x="25821" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;15 GPU&#45;72</text>
<text text-anchor="middle" x="25821" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25821" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g0_l16 -->
<g id="node648" class="node">
<title>expert_s2_t1_g0_l16</title>
<polygon fill="lightgreen" stroke="black" points="25674,-917.93 25416,-917.93 25416,-876.93 25674,-876.93 25674,-917.93"/>
<text text-anchor="middle" x="25545" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;16 GPU&#45;72</text>
<text text-anchor="middle" x="25545" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25545" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g0_l17 -->
<g id="node649" class="node">
<title>expert_s2_t1_g0_l17</title>
<polygon fill="lightgreen" stroke="black" points="25398,-917.93 25140,-917.93 25140,-876.93 25398,-876.93 25398,-917.93"/>
<text text-anchor="middle" x="25269" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;72 Layer&#45;17 GPU&#45;72</text>
<text text-anchor="middle" x="25269" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25269" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g1 -->
<g id="node650" class="node">
<title>attn_s2_t1_g1</title>
<polygon fill="lightgreen" stroke="black" points="16751.5,-917.93 16476.5,-917.93 16476.5,-876.93 16751.5,-876.93 16751.5,-917.93"/>
<text text-anchor="middle" x="16614" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;73</text>
<text text-anchor="middle" x="16614" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g1 -->
<g id="node651" class="node">
<title>gate_s2_t1_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="16879.32,-840.93 16457.26,-840.93 16348.68,-758.93 16770.74,-758.93 16879.32,-840.93"/>
<text text-anchor="middle" x="16614" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;73</text>
<text text-anchor="middle" x="16614" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g1&#45;&gt;gate_s2_t1_g1 -->
<g id="edge225" class="edge">
<title>attn_s2_t1_g1&#45;&gt;gate_s2_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-876.64C16614,-869.18 16614,-860.31 16614,-851.32"/>
<polygon fill="black" stroke="black" points="16617.5,-851.18 16614,-841.18 16610.5,-851.18 16617.5,-851.18"/>
</g>
<!-- expert_s2_t1_g1_l12 -->
<g id="node652" class="node">
<title>expert_s2_t1_g1_l12</title>
<polygon fill="lightgreen" stroke="black" points="16743,-722.93 16485,-722.93 16485,-681.93 16743,-681.93 16743,-722.93"/>
<text text-anchor="middle" x="16614" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;12 GPU&#45;73</text>
<text text-anchor="middle" x="16614" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g1&#45;&gt;expert_s2_t1_g1_l12 -->
<g id="edge226" class="edge">
<title>gate_s2_t1_g1&#45;&gt;expert_s2_t1_g1_l12</title>
<path fill="none" stroke="black" d="M16614,-758.71C16614,-750.13 16614,-741.22 16614,-733.12"/>
<polygon fill="black" stroke="black" points="16617.5,-733.04 16614,-723.04 16610.5,-733.04 16617.5,-733.04"/>
</g>
<!-- comm_s2_t1_g1 -->
<g id="node843" class="node">
<title>comm_s2_t1_g1</title>
<ellipse fill="lightblue" stroke="black" cx="16614" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="16614" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;73</text>
<text text-anchor="middle" x="16614" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g1_l12&#45;&gt;comm_s2_t1_g1 -->
<g id="edge227" class="edge">
<title>expert_s2_t1_g1_l12&#45;&gt;comm_s2_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-681.64C16614,-674.02 16614,-665.03 16614,-656.24"/>
<polygon fill="black" stroke="black" points="16617.5,-656.12 16614,-646.12 16610.5,-656.12 16617.5,-656.12"/>
</g>
<!-- expert_s2_t1_g1_l13 -->
<g id="node653" class="node">
<title>expert_s2_t1_g1_l13</title>
<polygon fill="lightgreen" stroke="black" points="24828,-917.93 24570,-917.93 24570,-876.93 24828,-876.93 24828,-917.93"/>
<text text-anchor="middle" x="24699" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;13 GPU&#45;73</text>
<text text-anchor="middle" x="24699" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24699" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g1_l14 -->
<g id="node654" class="node">
<title>expert_s2_t1_g1_l14</title>
<polygon fill="lightgreen" stroke="black" points="24552,-917.93 24294,-917.93 24294,-876.93 24552,-876.93 24552,-917.93"/>
<text text-anchor="middle" x="24423" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;14 GPU&#45;73</text>
<text text-anchor="middle" x="24423" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24423" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g1_l15 -->
<g id="node655" class="node">
<title>expert_s2_t1_g1_l15</title>
<polygon fill="lightgreen" stroke="black" points="24276,-917.93 24018,-917.93 24018,-876.93 24276,-876.93 24276,-917.93"/>
<text text-anchor="middle" x="24147" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;15 GPU&#45;73</text>
<text text-anchor="middle" x="24147" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24147" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g1_l16 -->
<g id="node656" class="node">
<title>expert_s2_t1_g1_l16</title>
<polygon fill="lightgreen" stroke="black" points="24000,-917.93 23742,-917.93 23742,-876.93 24000,-876.93 24000,-917.93"/>
<text text-anchor="middle" x="23871" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;16 GPU&#45;73</text>
<text text-anchor="middle" x="23871" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23871" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g1_l17 -->
<g id="node657" class="node">
<title>expert_s2_t1_g1_l17</title>
<polygon fill="lightgreen" stroke="black" points="23724,-917.93 23466,-917.93 23466,-876.93 23724,-876.93 23724,-917.93"/>
<text text-anchor="middle" x="23595" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;73 Layer&#45;17 GPU&#45;73</text>
<text text-anchor="middle" x="23595" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23595" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g2 -->
<g id="node658" class="node">
<title>attn_s2_t1_g2</title>
<polygon fill="lightgreen" stroke="black" points="18425.5,-917.93 18150.5,-917.93 18150.5,-876.93 18425.5,-876.93 18425.5,-917.93"/>
<text text-anchor="middle" x="18288" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;74</text>
<text text-anchor="middle" x="18288" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g2 -->
<g id="node659" class="node">
<title>gate_s2_t1_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="18553.32,-840.93 18131.26,-840.93 18022.68,-758.93 18444.74,-758.93 18553.32,-840.93"/>
<text text-anchor="middle" x="18288" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;74</text>
<text text-anchor="middle" x="18288" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g2&#45;&gt;gate_s2_t1_g2 -->
<g id="edge228" class="edge">
<title>attn_s2_t1_g2&#45;&gt;gate_s2_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-876.64C18288,-869.18 18288,-860.31 18288,-851.32"/>
<polygon fill="black" stroke="black" points="18291.5,-851.18 18288,-841.18 18284.5,-851.18 18291.5,-851.18"/>
</g>
<!-- expert_s2_t1_g2_l12 -->
<g id="node660" class="node">
<title>expert_s2_t1_g2_l12</title>
<polygon fill="lightgreen" stroke="black" points="18417,-722.93 18159,-722.93 18159,-681.93 18417,-681.93 18417,-722.93"/>
<text text-anchor="middle" x="18288" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;12 GPU&#45;74</text>
<text text-anchor="middle" x="18288" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g2&#45;&gt;expert_s2_t1_g2_l12 -->
<g id="edge229" class="edge">
<title>gate_s2_t1_g2&#45;&gt;expert_s2_t1_g2_l12</title>
<path fill="none" stroke="black" d="M18288,-758.71C18288,-750.13 18288,-741.22 18288,-733.12"/>
<polygon fill="black" stroke="black" points="18291.5,-733.04 18288,-723.04 18284.5,-733.04 18291.5,-733.04"/>
</g>
<!-- comm_s2_t1_g2 -->
<g id="node844" class="node">
<title>comm_s2_t1_g2</title>
<ellipse fill="lightblue" stroke="black" cx="18288" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="18288" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;74</text>
<text text-anchor="middle" x="18288" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g2_l12&#45;&gt;comm_s2_t1_g2 -->
<g id="edge230" class="edge">
<title>expert_s2_t1_g2_l12&#45;&gt;comm_s2_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-681.64C18288,-674.02 18288,-665.03 18288,-656.24"/>
<polygon fill="black" stroke="black" points="18291.5,-656.12 18288,-646.12 18284.5,-656.12 18291.5,-656.12"/>
</g>
<!-- expert_s2_t1_g2_l13 -->
<g id="node661" class="node">
<title>expert_s2_t1_g2_l13</title>
<polygon fill="lightgreen" stroke="black" points="23154,-917.93 22896,-917.93 22896,-876.93 23154,-876.93 23154,-917.93"/>
<text text-anchor="middle" x="23025" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;13 GPU&#45;74</text>
<text text-anchor="middle" x="23025" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23025" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g2_l14 -->
<g id="node662" class="node">
<title>expert_s2_t1_g2_l14</title>
<polygon fill="lightgreen" stroke="black" points="22878,-917.93 22620,-917.93 22620,-876.93 22878,-876.93 22878,-917.93"/>
<text text-anchor="middle" x="22749" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;14 GPU&#45;74</text>
<text text-anchor="middle" x="22749" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22749" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g2_l15 -->
<g id="node663" class="node">
<title>expert_s2_t1_g2_l15</title>
<polygon fill="lightgreen" stroke="black" points="22602,-917.93 22344,-917.93 22344,-876.93 22602,-876.93 22602,-917.93"/>
<text text-anchor="middle" x="22473" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;15 GPU&#45;74</text>
<text text-anchor="middle" x="22473" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22473" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g2_l16 -->
<g id="node664" class="node">
<title>expert_s2_t1_g2_l16</title>
<polygon fill="lightgreen" stroke="black" points="22326,-917.93 22068,-917.93 22068,-876.93 22326,-876.93 22326,-917.93"/>
<text text-anchor="middle" x="22197" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;16 GPU&#45;74</text>
<text text-anchor="middle" x="22197" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22197" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g2_l17 -->
<g id="node665" class="node">
<title>expert_s2_t1_g2_l17</title>
<polygon fill="lightgreen" stroke="black" points="22050,-917.93 21792,-917.93 21792,-876.93 22050,-876.93 22050,-917.93"/>
<text text-anchor="middle" x="21921" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;74 Layer&#45;17 GPU&#45;74</text>
<text text-anchor="middle" x="21921" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21921" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g3 -->
<g id="node666" class="node">
<title>attn_s2_t1_g3</title>
<polygon fill="lightgreen" stroke="black" points="20099.5,-917.93 19824.5,-917.93 19824.5,-876.93 20099.5,-876.93 20099.5,-917.93"/>
<text text-anchor="middle" x="19962" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;75</text>
<text text-anchor="middle" x="19962" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g3 -->
<g id="node667" class="node">
<title>gate_s2_t1_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="20227.32,-840.93 19805.26,-840.93 19696.68,-758.93 20118.74,-758.93 20227.32,-840.93"/>
<text text-anchor="middle" x="19962" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;75</text>
<text text-anchor="middle" x="19962" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g3&#45;&gt;gate_s2_t1_g3 -->
<g id="edge231" class="edge">
<title>attn_s2_t1_g3&#45;&gt;gate_s2_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-876.64C19962,-869.18 19962,-860.31 19962,-851.32"/>
<polygon fill="black" stroke="black" points="19965.5,-851.18 19962,-841.18 19958.5,-851.18 19965.5,-851.18"/>
</g>
<!-- expert_s2_t1_g3_l12 -->
<g id="node668" class="node">
<title>expert_s2_t1_g3_l12</title>
<polygon fill="lightgreen" stroke="black" points="20091,-722.93 19833,-722.93 19833,-681.93 20091,-681.93 20091,-722.93"/>
<text text-anchor="middle" x="19962" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;12 GPU&#45;75</text>
<text text-anchor="middle" x="19962" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g3&#45;&gt;expert_s2_t1_g3_l12 -->
<g id="edge232" class="edge">
<title>gate_s2_t1_g3&#45;&gt;expert_s2_t1_g3_l12</title>
<path fill="none" stroke="black" d="M19962,-758.71C19962,-750.13 19962,-741.22 19962,-733.12"/>
<polygon fill="black" stroke="black" points="19965.5,-733.04 19962,-723.04 19958.5,-733.04 19965.5,-733.04"/>
</g>
<!-- comm_s2_t1_g3 -->
<g id="node845" class="node">
<title>comm_s2_t1_g3</title>
<ellipse fill="lightblue" stroke="black" cx="19962" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="19962" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;75</text>
<text text-anchor="middle" x="19962" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g3_l12&#45;&gt;comm_s2_t1_g3 -->
<g id="edge233" class="edge">
<title>expert_s2_t1_g3_l12&#45;&gt;comm_s2_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-681.64C19962,-674.02 19962,-665.03 19962,-656.24"/>
<polygon fill="black" stroke="black" points="19965.5,-656.12 19962,-646.12 19958.5,-656.12 19965.5,-656.12"/>
</g>
<!-- expert_s2_t1_g3_l13 -->
<g id="node669" class="node">
<title>expert_s2_t1_g3_l13</title>
<polygon fill="lightgreen" stroke="black" points="21480,-917.93 21222,-917.93 21222,-876.93 21480,-876.93 21480,-917.93"/>
<text text-anchor="middle" x="21351" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;13 GPU&#45;75</text>
<text text-anchor="middle" x="21351" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21351" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g3_l14 -->
<g id="node670" class="node">
<title>expert_s2_t1_g3_l14</title>
<polygon fill="lightgreen" stroke="black" points="21204,-917.93 20946,-917.93 20946,-876.93 21204,-876.93 21204,-917.93"/>
<text text-anchor="middle" x="21075" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;14 GPU&#45;75</text>
<text text-anchor="middle" x="21075" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21075" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g3_l15 -->
<g id="node671" class="node">
<title>expert_s2_t1_g3_l15</title>
<polygon fill="lightgreen" stroke="black" points="20928,-917.93 20670,-917.93 20670,-876.93 20928,-876.93 20928,-917.93"/>
<text text-anchor="middle" x="20799" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;15 GPU&#45;75</text>
<text text-anchor="middle" x="20799" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20799" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g3_l16 -->
<g id="node672" class="node">
<title>expert_s2_t1_g3_l16</title>
<polygon fill="lightgreen" stroke="black" points="20652,-917.93 20394,-917.93 20394,-876.93 20652,-876.93 20652,-917.93"/>
<text text-anchor="middle" x="20523" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;16 GPU&#45;75</text>
<text text-anchor="middle" x="20523" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20523" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g3_l17 -->
<g id="node673" class="node">
<title>expert_s2_t1_g3_l17</title>
<polygon fill="lightgreen" stroke="black" points="20376,-917.93 20118,-917.93 20118,-876.93 20376,-876.93 20376,-917.93"/>
<text text-anchor="middle" x="20247" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;75 Layer&#45;17 GPU&#45;75</text>
<text text-anchor="middle" x="20247" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20247" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g4 -->
<g id="node674" class="node">
<title>attn_s2_t1_g4</title>
<polygon fill="lightgreen" stroke="black" points="21773.5,-917.93 21498.5,-917.93 21498.5,-876.93 21773.5,-876.93 21773.5,-917.93"/>
<text text-anchor="middle" x="21636" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;76</text>
<text text-anchor="middle" x="21636" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g4 -->
<g id="node675" class="node">
<title>gate_s2_t1_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="21901.32,-840.93 21479.26,-840.93 21370.68,-758.93 21792.74,-758.93 21901.32,-840.93"/>
<text text-anchor="middle" x="21636" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;76</text>
<text text-anchor="middle" x="21636" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g4&#45;&gt;gate_s2_t1_g4 -->
<g id="edge234" class="edge">
<title>attn_s2_t1_g4&#45;&gt;gate_s2_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-876.64C21636,-869.18 21636,-860.31 21636,-851.32"/>
<polygon fill="black" stroke="black" points="21639.5,-851.18 21636,-841.18 21632.5,-851.18 21639.5,-851.18"/>
</g>
<!-- expert_s2_t1_g4_l12 -->
<g id="node676" class="node">
<title>expert_s2_t1_g4_l12</title>
<polygon fill="lightgreen" stroke="black" points="21765,-722.93 21507,-722.93 21507,-681.93 21765,-681.93 21765,-722.93"/>
<text text-anchor="middle" x="21636" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;12 GPU&#45;76</text>
<text text-anchor="middle" x="21636" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g4&#45;&gt;expert_s2_t1_g4_l12 -->
<g id="edge235" class="edge">
<title>gate_s2_t1_g4&#45;&gt;expert_s2_t1_g4_l12</title>
<path fill="none" stroke="black" d="M21636,-758.71C21636,-750.13 21636,-741.22 21636,-733.12"/>
<polygon fill="black" stroke="black" points="21639.5,-733.04 21636,-723.04 21632.5,-733.04 21639.5,-733.04"/>
</g>
<!-- comm_s2_t1_g4 -->
<g id="node846" class="node">
<title>comm_s2_t1_g4</title>
<ellipse fill="lightblue" stroke="black" cx="21636" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="21636" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;76</text>
<text text-anchor="middle" x="21636" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g4_l12&#45;&gt;comm_s2_t1_g4 -->
<g id="edge236" class="edge">
<title>expert_s2_t1_g4_l12&#45;&gt;comm_s2_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-681.64C21636,-674.02 21636,-665.03 21636,-656.24"/>
<polygon fill="black" stroke="black" points="21639.5,-656.12 21636,-646.12 21632.5,-656.12 21639.5,-656.12"/>
</g>
<!-- expert_s2_t1_g4_l13 -->
<g id="node677" class="node">
<title>expert_s2_t1_g4_l13</title>
<polygon fill="lightgreen" stroke="black" points="19806,-917.93 19548,-917.93 19548,-876.93 19806,-876.93 19806,-917.93"/>
<text text-anchor="middle" x="19677" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;13 GPU&#45;76</text>
<text text-anchor="middle" x="19677" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19677" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g4_l14 -->
<g id="node678" class="node">
<title>expert_s2_t1_g4_l14</title>
<polygon fill="lightgreen" stroke="black" points="19530,-917.93 19272,-917.93 19272,-876.93 19530,-876.93 19530,-917.93"/>
<text text-anchor="middle" x="19401" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;14 GPU&#45;76</text>
<text text-anchor="middle" x="19401" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19401" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g4_l15 -->
<g id="node679" class="node">
<title>expert_s2_t1_g4_l15</title>
<polygon fill="lightgreen" stroke="black" points="19254,-917.93 18996,-917.93 18996,-876.93 19254,-876.93 19254,-917.93"/>
<text text-anchor="middle" x="19125" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;15 GPU&#45;76</text>
<text text-anchor="middle" x="19125" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19125" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g4_l16 -->
<g id="node680" class="node">
<title>expert_s2_t1_g4_l16</title>
<polygon fill="lightgreen" stroke="black" points="18978,-917.93 18720,-917.93 18720,-876.93 18978,-876.93 18978,-917.93"/>
<text text-anchor="middle" x="18849" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;16 GPU&#45;76</text>
<text text-anchor="middle" x="18849" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18849" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g4_l17 -->
<g id="node681" class="node">
<title>expert_s2_t1_g4_l17</title>
<polygon fill="lightgreen" stroke="black" points="18702,-917.93 18444,-917.93 18444,-876.93 18702,-876.93 18702,-917.93"/>
<text text-anchor="middle" x="18573" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;76 Layer&#45;17 GPU&#45;76</text>
<text text-anchor="middle" x="18573" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18573" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g5 -->
<g id="node682" class="node">
<title>attn_s2_t1_g5</title>
<polygon fill="lightgreen" stroke="black" points="23447.5,-917.93 23172.5,-917.93 23172.5,-876.93 23447.5,-876.93 23447.5,-917.93"/>
<text text-anchor="middle" x="23310" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;77</text>
<text text-anchor="middle" x="23310" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g5 -->
<g id="node683" class="node">
<title>gate_s2_t1_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="23575.32,-840.93 23153.26,-840.93 23044.68,-758.93 23466.74,-758.93 23575.32,-840.93"/>
<text text-anchor="middle" x="23310" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;77</text>
<text text-anchor="middle" x="23310" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g5&#45;&gt;gate_s2_t1_g5 -->
<g id="edge237" class="edge">
<title>attn_s2_t1_g5&#45;&gt;gate_s2_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-876.64C23310,-869.18 23310,-860.31 23310,-851.32"/>
<polygon fill="black" stroke="black" points="23313.5,-851.18 23310,-841.18 23306.5,-851.18 23313.5,-851.18"/>
</g>
<!-- expert_s2_t1_g5_l12 -->
<g id="node684" class="node">
<title>expert_s2_t1_g5_l12</title>
<polygon fill="lightgreen" stroke="black" points="23439,-722.93 23181,-722.93 23181,-681.93 23439,-681.93 23439,-722.93"/>
<text text-anchor="middle" x="23310" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;12 GPU&#45;77</text>
<text text-anchor="middle" x="23310" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g5&#45;&gt;expert_s2_t1_g5_l12 -->
<g id="edge238" class="edge">
<title>gate_s2_t1_g5&#45;&gt;expert_s2_t1_g5_l12</title>
<path fill="none" stroke="black" d="M23310,-758.71C23310,-750.13 23310,-741.22 23310,-733.12"/>
<polygon fill="black" stroke="black" points="23313.5,-733.04 23310,-723.04 23306.5,-733.04 23313.5,-733.04"/>
</g>
<!-- comm_s2_t1_g5 -->
<g id="node847" class="node">
<title>comm_s2_t1_g5</title>
<ellipse fill="lightblue" stroke="black" cx="23310" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="23310" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;77</text>
<text text-anchor="middle" x="23310" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g5_l12&#45;&gt;comm_s2_t1_g5 -->
<g id="edge239" class="edge">
<title>expert_s2_t1_g5_l12&#45;&gt;comm_s2_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-681.64C23310,-674.02 23310,-665.03 23310,-656.24"/>
<polygon fill="black" stroke="black" points="23313.5,-656.12 23310,-646.12 23306.5,-656.12 23313.5,-656.12"/>
</g>
<!-- expert_s2_t1_g5_l13 -->
<g id="node685" class="node">
<title>expert_s2_t1_g5_l13</title>
<polygon fill="lightgreen" stroke="black" points="18132,-917.93 17874,-917.93 17874,-876.93 18132,-876.93 18132,-917.93"/>
<text text-anchor="middle" x="18003" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;13 GPU&#45;77</text>
<text text-anchor="middle" x="18003" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18003" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g5_l14 -->
<g id="node686" class="node">
<title>expert_s2_t1_g5_l14</title>
<polygon fill="lightgreen" stroke="black" points="17856,-917.93 17598,-917.93 17598,-876.93 17856,-876.93 17856,-917.93"/>
<text text-anchor="middle" x="17727" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;14 GPU&#45;77</text>
<text text-anchor="middle" x="17727" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17727" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g5_l15 -->
<g id="node687" class="node">
<title>expert_s2_t1_g5_l15</title>
<polygon fill="lightgreen" stroke="black" points="17580,-917.93 17322,-917.93 17322,-876.93 17580,-876.93 17580,-917.93"/>
<text text-anchor="middle" x="17451" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;15 GPU&#45;77</text>
<text text-anchor="middle" x="17451" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17451" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g5_l16 -->
<g id="node688" class="node">
<title>expert_s2_t1_g5_l16</title>
<polygon fill="lightgreen" stroke="black" points="17304,-917.93 17046,-917.93 17046,-876.93 17304,-876.93 17304,-917.93"/>
<text text-anchor="middle" x="17175" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;16 GPU&#45;77</text>
<text text-anchor="middle" x="17175" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17175" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g5_l17 -->
<g id="node689" class="node">
<title>expert_s2_t1_g5_l17</title>
<polygon fill="lightgreen" stroke="black" points="17028,-917.93 16770,-917.93 16770,-876.93 17028,-876.93 17028,-917.93"/>
<text text-anchor="middle" x="16899" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;77 Layer&#45;17 GPU&#45;77</text>
<text text-anchor="middle" x="16899" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16899" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g6 -->
<g id="node690" class="node">
<title>attn_s2_t1_g6</title>
<polygon fill="lightgreen" stroke="black" points="25121.5,-917.93 24846.5,-917.93 24846.5,-876.93 25121.5,-876.93 25121.5,-917.93"/>
<text text-anchor="middle" x="24984" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;78</text>
<text text-anchor="middle" x="24984" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g6 -->
<g id="node691" class="node">
<title>gate_s2_t1_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="25249.32,-840.93 24827.26,-840.93 24718.68,-758.93 25140.74,-758.93 25249.32,-840.93"/>
<text text-anchor="middle" x="24984" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;78</text>
<text text-anchor="middle" x="24984" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g6&#45;&gt;gate_s2_t1_g6 -->
<g id="edge240" class="edge">
<title>attn_s2_t1_g6&#45;&gt;gate_s2_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-876.64C24984,-869.18 24984,-860.31 24984,-851.32"/>
<polygon fill="black" stroke="black" points="24987.5,-851.18 24984,-841.18 24980.5,-851.18 24987.5,-851.18"/>
</g>
<!-- expert_s2_t1_g6_l12 -->
<g id="node692" class="node">
<title>expert_s2_t1_g6_l12</title>
<polygon fill="lightgreen" stroke="black" points="25113,-722.93 24855,-722.93 24855,-681.93 25113,-681.93 25113,-722.93"/>
<text text-anchor="middle" x="24984" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;12 GPU&#45;78</text>
<text text-anchor="middle" x="24984" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g6&#45;&gt;expert_s2_t1_g6_l12 -->
<g id="edge241" class="edge">
<title>gate_s2_t1_g6&#45;&gt;expert_s2_t1_g6_l12</title>
<path fill="none" stroke="black" d="M24984,-758.71C24984,-750.13 24984,-741.22 24984,-733.12"/>
<polygon fill="black" stroke="black" points="24987.5,-733.04 24984,-723.04 24980.5,-733.04 24987.5,-733.04"/>
</g>
<!-- comm_s2_t1_g6 -->
<g id="node848" class="node">
<title>comm_s2_t1_g6</title>
<ellipse fill="lightblue" stroke="black" cx="24984" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="24984" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;78</text>
<text text-anchor="middle" x="24984" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g6_l12&#45;&gt;comm_s2_t1_g6 -->
<g id="edge242" class="edge">
<title>expert_s2_t1_g6_l12&#45;&gt;comm_s2_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-681.64C24984,-674.02 24984,-665.03 24984,-656.24"/>
<polygon fill="black" stroke="black" points="24987.5,-656.12 24984,-646.12 24980.5,-656.12 24987.5,-656.12"/>
</g>
<!-- expert_s2_t1_g6_l13 -->
<g id="node693" class="node">
<title>expert_s2_t1_g6_l13</title>
<polygon fill="lightgreen" stroke="black" points="16458,-917.93 16200,-917.93 16200,-876.93 16458,-876.93 16458,-917.93"/>
<text text-anchor="middle" x="16329" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;13 GPU&#45;78</text>
<text text-anchor="middle" x="16329" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16329" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g6_l14 -->
<g id="node694" class="node">
<title>expert_s2_t1_g6_l14</title>
<polygon fill="lightgreen" stroke="black" points="16182,-917.93 15924,-917.93 15924,-876.93 16182,-876.93 16182,-917.93"/>
<text text-anchor="middle" x="16053" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;14 GPU&#45;78</text>
<text text-anchor="middle" x="16053" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16053" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g6_l15 -->
<g id="node695" class="node">
<title>expert_s2_t1_g6_l15</title>
<polygon fill="lightgreen" stroke="black" points="15906,-917.93 15648,-917.93 15648,-876.93 15906,-876.93 15906,-917.93"/>
<text text-anchor="middle" x="15777" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;15 GPU&#45;78</text>
<text text-anchor="middle" x="15777" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15777" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g6_l16 -->
<g id="node696" class="node">
<title>expert_s2_t1_g6_l16</title>
<polygon fill="lightgreen" stroke="black" points="15630,-917.93 15372,-917.93 15372,-876.93 15630,-876.93 15630,-917.93"/>
<text text-anchor="middle" x="15501" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;16 GPU&#45;78</text>
<text text-anchor="middle" x="15501" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15501" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g6_l17 -->
<g id="node697" class="node">
<title>expert_s2_t1_g6_l17</title>
<polygon fill="lightgreen" stroke="black" points="15354,-917.93 15096,-917.93 15096,-876.93 15354,-876.93 15354,-917.93"/>
<text text-anchor="middle" x="15225" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;78 Layer&#45;17 GPU&#45;78</text>
<text text-anchor="middle" x="15225" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15225" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t1_g7 -->
<g id="node698" class="node">
<title>attn_s2_t1_g7</title>
<polygon fill="lightgreen" stroke="black" points="26795.5,-917.93 26520.5,-917.93 26520.5,-876.93 26795.5,-876.93 26795.5,-917.93"/>
<text text-anchor="middle" x="26658" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;79</text>
<text text-anchor="middle" x="26658" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26658" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t1_g7 -->
<g id="node699" class="node">
<title>gate_s2_t1_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="26796.32,-840.93 26374.26,-840.93 26265.68,-758.93 26687.74,-758.93 26796.32,-840.93"/>
<text text-anchor="middle" x="26531" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;79</text>
<text text-anchor="middle" x="26531" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t1_g7&#45;&gt;gate_s2_t1_g7 -->
<g id="edge243" class="edge">
<title>attn_s2_t1_g7&#45;&gt;gate_s2_t1_g7</title>
<path fill="none" stroke="black" d="M26631.99,-876.87C26620.47,-868.21 26606.37,-857.61 26592.41,-847.11"/>
<polygon fill="black" stroke="black" points="26594.33,-844.17 26584.23,-840.96 26590.12,-849.77 26594.33,-844.17"/>
</g>
<!-- expert_s2_t1_g7_l12 -->
<g id="node700" class="node">
<title>expert_s2_t1_g7_l12</title>
<polygon fill="lightgreen" stroke="black" points="26660,-722.93 26402,-722.93 26402,-681.93 26660,-681.93 26660,-722.93"/>
<text text-anchor="middle" x="26531" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;12 GPU&#45;79</text>
<text text-anchor="middle" x="26531" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t1_g7&#45;&gt;expert_s2_t1_g7_l12 -->
<g id="edge244" class="edge">
<title>gate_s2_t1_g7&#45;&gt;expert_s2_t1_g7_l12</title>
<path fill="none" stroke="black" d="M26531,-758.71C26531,-750.13 26531,-741.22 26531,-733.12"/>
<polygon fill="black" stroke="black" points="26534.5,-733.04 26531,-723.04 26527.5,-733.04 26534.5,-733.04"/>
</g>
<!-- comm_s2_t1_g7 -->
<g id="node849" class="node">
<title>comm_s2_t1_g7</title>
<ellipse fill="lightblue" stroke="black" cx="26531" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="26531" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;79</text>
<text text-anchor="middle" x="26531" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26531" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t1_g7_l12&#45;&gt;comm_s2_t1_g7 -->
<g id="edge245" class="edge">
<title>expert_s2_t1_g7_l12&#45;&gt;comm_s2_t1_g7</title>
<path fill="none" stroke="black" d="M26531,-681.64C26531,-674.02 26531,-665.03 26531,-656.24"/>
<polygon fill="black" stroke="black" points="26534.5,-656.12 26531,-646.12 26527.5,-656.12 26534.5,-656.12"/>
</g>
<!-- expert_s2_t1_g7_l13 -->
<g id="node701" class="node">
<title>expert_s2_t1_g7_l13</title>
<polygon fill="lightgreen" stroke="black" points="14784,-917.93 14526,-917.93 14526,-876.93 14784,-876.93 14784,-917.93"/>
<text text-anchor="middle" x="14655" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;13 GPU&#45;79</text>
<text text-anchor="middle" x="14655" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14655" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g7_l14 -->
<g id="node702" class="node">
<title>expert_s2_t1_g7_l14</title>
<polygon fill="lightgreen" stroke="black" points="14508,-917.93 14250,-917.93 14250,-876.93 14508,-876.93 14508,-917.93"/>
<text text-anchor="middle" x="14379" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;14 GPU&#45;79</text>
<text text-anchor="middle" x="14379" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14379" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g7_l15 -->
<g id="node703" class="node">
<title>expert_s2_t1_g7_l15</title>
<polygon fill="lightgreen" stroke="black" points="14232,-917.93 13974,-917.93 13974,-876.93 14232,-876.93 14232,-917.93"/>
<text text-anchor="middle" x="14103" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;15 GPU&#45;79</text>
<text text-anchor="middle" x="14103" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14103" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g7_l16 -->
<g id="node704" class="node">
<title>expert_s2_t1_g7_l16</title>
<polygon fill="lightgreen" stroke="black" points="13956,-917.93 13698,-917.93 13698,-876.93 13956,-876.93 13956,-917.93"/>
<text text-anchor="middle" x="13827" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;16 GPU&#45;79</text>
<text text-anchor="middle" x="13827" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13827" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t1_g7_l17 -->
<g id="node705" class="node">
<title>expert_s2_t1_g7_l17</title>
<polygon fill="lightgreen" stroke="black" points="13680,-917.93 13422,-917.93 13422,-876.93 13680,-876.93 13680,-917.93"/>
<text text-anchor="middle" x="13551" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;79 Layer&#45;17 GPU&#45;79</text>
<text text-anchor="middle" x="13551" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13551" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g0 -->
<g id="node706" class="node">
<title>attn_s2_t2_g0</title>
<polygon fill="lightgreen" stroke="black" points="28475.5,-917.93 28200.5,-917.93 28200.5,-876.93 28475.5,-876.93 28475.5,-917.93"/>
<text text-anchor="middle" x="28338" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;80</text>
<text text-anchor="middle" x="28338" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g0 -->
<g id="node707" class="node">
<title>gate_s2_t2_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="28603.32,-840.93 28181.26,-840.93 28072.68,-758.93 28494.74,-758.93 28603.32,-840.93"/>
<text text-anchor="middle" x="28338" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;80</text>
<text text-anchor="middle" x="28338" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g0&#45;&gt;gate_s2_t2_g0 -->
<g id="edge246" class="edge">
<title>attn_s2_t2_g0&#45;&gt;gate_s2_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-876.64C28338,-869.18 28338,-860.31 28338,-851.32"/>
<polygon fill="black" stroke="black" points="28341.5,-851.18 28338,-841.18 28334.5,-851.18 28341.5,-851.18"/>
</g>
<!-- expert_s2_t2_g0_l12 -->
<g id="node708" class="node">
<title>expert_s2_t2_g0_l12</title>
<polygon fill="lightgreen" stroke="black" points="28467,-722.93 28209,-722.93 28209,-681.93 28467,-681.93 28467,-722.93"/>
<text text-anchor="middle" x="28338" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;12 GPU&#45;80</text>
<text text-anchor="middle" x="28338" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g0&#45;&gt;expert_s2_t2_g0_l12 -->
<g id="edge247" class="edge">
<title>gate_s2_t2_g0&#45;&gt;expert_s2_t2_g0_l12</title>
<path fill="none" stroke="black" d="M28338,-758.71C28338,-750.13 28338,-741.22 28338,-733.12"/>
<polygon fill="black" stroke="black" points="28341.5,-733.04 28338,-723.04 28334.5,-733.04 28341.5,-733.04"/>
</g>
<!-- comm_s2_t2_g0 -->
<g id="node850" class="node">
<title>comm_s2_t2_g0</title>
<ellipse fill="lightblue" stroke="black" cx="28338" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="28338" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;80</text>
<text text-anchor="middle" x="28338" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g0_l12&#45;&gt;comm_s2_t2_g0 -->
<g id="edge248" class="edge">
<title>expert_s2_t2_g0_l12&#45;&gt;comm_s2_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-681.64C28338,-674.02 28338,-665.03 28338,-656.24"/>
<polygon fill="black" stroke="black" points="28341.5,-656.12 28338,-646.12 28334.5,-656.12 28341.5,-656.12"/>
</g>
<!-- expert_s2_t2_g0_l13 -->
<g id="node709" class="node">
<title>expert_s2_t2_g0_l13</title>
<polygon fill="lightgreen" stroke="black" points="39900,-917.93 39642,-917.93 39642,-876.93 39900,-876.93 39900,-917.93"/>
<text text-anchor="middle" x="39771" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;13 GPU&#45;80</text>
<text text-anchor="middle" x="39771" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39771" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g0_l14 -->
<g id="node710" class="node">
<title>expert_s2_t2_g0_l14</title>
<polygon fill="lightgreen" stroke="black" points="39624,-917.93 39366,-917.93 39366,-876.93 39624,-876.93 39624,-917.93"/>
<text text-anchor="middle" x="39495" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;14 GPU&#45;80</text>
<text text-anchor="middle" x="39495" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39495" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g0_l15 -->
<g id="node711" class="node">
<title>expert_s2_t2_g0_l15</title>
<polygon fill="lightgreen" stroke="black" points="39348,-917.93 39090,-917.93 39090,-876.93 39348,-876.93 39348,-917.93"/>
<text text-anchor="middle" x="39219" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;15 GPU&#45;80</text>
<text text-anchor="middle" x="39219" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39219" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g0_l16 -->
<g id="node712" class="node">
<title>expert_s2_t2_g0_l16</title>
<polygon fill="lightgreen" stroke="black" points="39072,-917.93 38814,-917.93 38814,-876.93 39072,-876.93 39072,-917.93"/>
<text text-anchor="middle" x="38943" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;16 GPU&#45;80</text>
<text text-anchor="middle" x="38943" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38943" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g0_l17 -->
<g id="node713" class="node">
<title>expert_s2_t2_g0_l17</title>
<polygon fill="lightgreen" stroke="black" points="38796,-917.93 38538,-917.93 38538,-876.93 38796,-876.93 38796,-917.93"/>
<text text-anchor="middle" x="38667" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;80 Layer&#45;17 GPU&#45;80</text>
<text text-anchor="middle" x="38667" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38667" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g1 -->
<g id="node714" class="node">
<title>attn_s2_t2_g1</title>
<polygon fill="lightgreen" stroke="black" points="30149.5,-917.93 29874.5,-917.93 29874.5,-876.93 30149.5,-876.93 30149.5,-917.93"/>
<text text-anchor="middle" x="30012" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;81</text>
<text text-anchor="middle" x="30012" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g1 -->
<g id="node715" class="node">
<title>gate_s2_t2_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="30277.32,-840.93 29855.26,-840.93 29746.68,-758.93 30168.74,-758.93 30277.32,-840.93"/>
<text text-anchor="middle" x="30012" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;81</text>
<text text-anchor="middle" x="30012" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g1&#45;&gt;gate_s2_t2_g1 -->
<g id="edge249" class="edge">
<title>attn_s2_t2_g1&#45;&gt;gate_s2_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-876.64C30012,-869.18 30012,-860.31 30012,-851.32"/>
<polygon fill="black" stroke="black" points="30015.5,-851.18 30012,-841.18 30008.5,-851.18 30015.5,-851.18"/>
</g>
<!-- expert_s2_t2_g1_l12 -->
<g id="node716" class="node">
<title>expert_s2_t2_g1_l12</title>
<polygon fill="lightgreen" stroke="black" points="30141,-722.93 29883,-722.93 29883,-681.93 30141,-681.93 30141,-722.93"/>
<text text-anchor="middle" x="30012" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;12 GPU&#45;81</text>
<text text-anchor="middle" x="30012" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g1&#45;&gt;expert_s2_t2_g1_l12 -->
<g id="edge250" class="edge">
<title>gate_s2_t2_g1&#45;&gt;expert_s2_t2_g1_l12</title>
<path fill="none" stroke="black" d="M30012,-758.71C30012,-750.13 30012,-741.22 30012,-733.12"/>
<polygon fill="black" stroke="black" points="30015.5,-733.04 30012,-723.04 30008.5,-733.04 30015.5,-733.04"/>
</g>
<!-- comm_s2_t2_g1 -->
<g id="node851" class="node">
<title>comm_s2_t2_g1</title>
<ellipse fill="lightblue" stroke="black" cx="30012" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="30012" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;81</text>
<text text-anchor="middle" x="30012" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g1_l12&#45;&gt;comm_s2_t2_g1 -->
<g id="edge251" class="edge">
<title>expert_s2_t2_g1_l12&#45;&gt;comm_s2_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-681.64C30012,-674.02 30012,-665.03 30012,-656.24"/>
<polygon fill="black" stroke="black" points="30015.5,-656.12 30012,-646.12 30008.5,-656.12 30015.5,-656.12"/>
</g>
<!-- expert_s2_t2_g1_l13 -->
<g id="node717" class="node">
<title>expert_s2_t2_g1_l13</title>
<polygon fill="lightgreen" stroke="black" points="38226,-917.93 37968,-917.93 37968,-876.93 38226,-876.93 38226,-917.93"/>
<text text-anchor="middle" x="38097" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;13 GPU&#45;81</text>
<text text-anchor="middle" x="38097" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38097" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g1_l14 -->
<g id="node718" class="node">
<title>expert_s2_t2_g1_l14</title>
<polygon fill="lightgreen" stroke="black" points="37950,-917.93 37692,-917.93 37692,-876.93 37950,-876.93 37950,-917.93"/>
<text text-anchor="middle" x="37821" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;14 GPU&#45;81</text>
<text text-anchor="middle" x="37821" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37821" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g1_l15 -->
<g id="node719" class="node">
<title>expert_s2_t2_g1_l15</title>
<polygon fill="lightgreen" stroke="black" points="37674,-917.93 37416,-917.93 37416,-876.93 37674,-876.93 37674,-917.93"/>
<text text-anchor="middle" x="37545" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;15 GPU&#45;81</text>
<text text-anchor="middle" x="37545" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37545" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g1_l16 -->
<g id="node720" class="node">
<title>expert_s2_t2_g1_l16</title>
<polygon fill="lightgreen" stroke="black" points="37398,-917.93 37140,-917.93 37140,-876.93 37398,-876.93 37398,-917.93"/>
<text text-anchor="middle" x="37269" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;16 GPU&#45;81</text>
<text text-anchor="middle" x="37269" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37269" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g1_l17 -->
<g id="node721" class="node">
<title>expert_s2_t2_g1_l17</title>
<polygon fill="lightgreen" stroke="black" points="37122,-917.93 36864,-917.93 36864,-876.93 37122,-876.93 37122,-917.93"/>
<text text-anchor="middle" x="36993" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;81 Layer&#45;17 GPU&#45;81</text>
<text text-anchor="middle" x="36993" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36993" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g2 -->
<g id="node722" class="node">
<title>attn_s2_t2_g2</title>
<polygon fill="lightgreen" stroke="black" points="31823.5,-917.93 31548.5,-917.93 31548.5,-876.93 31823.5,-876.93 31823.5,-917.93"/>
<text text-anchor="middle" x="31686" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;82</text>
<text text-anchor="middle" x="31686" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g2 -->
<g id="node723" class="node">
<title>gate_s2_t2_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="31951.32,-840.93 31529.26,-840.93 31420.68,-758.93 31842.74,-758.93 31951.32,-840.93"/>
<text text-anchor="middle" x="31686" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;82</text>
<text text-anchor="middle" x="31686" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g2&#45;&gt;gate_s2_t2_g2 -->
<g id="edge252" class="edge">
<title>attn_s2_t2_g2&#45;&gt;gate_s2_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-876.64C31686,-869.18 31686,-860.31 31686,-851.32"/>
<polygon fill="black" stroke="black" points="31689.5,-851.18 31686,-841.18 31682.5,-851.18 31689.5,-851.18"/>
</g>
<!-- expert_s2_t2_g2_l12 -->
<g id="node724" class="node">
<title>expert_s2_t2_g2_l12</title>
<polygon fill="lightgreen" stroke="black" points="31815,-722.93 31557,-722.93 31557,-681.93 31815,-681.93 31815,-722.93"/>
<text text-anchor="middle" x="31686" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;12 GPU&#45;82</text>
<text text-anchor="middle" x="31686" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g2&#45;&gt;expert_s2_t2_g2_l12 -->
<g id="edge253" class="edge">
<title>gate_s2_t2_g2&#45;&gt;expert_s2_t2_g2_l12</title>
<path fill="none" stroke="black" d="M31686,-758.71C31686,-750.13 31686,-741.22 31686,-733.12"/>
<polygon fill="black" stroke="black" points="31689.5,-733.04 31686,-723.04 31682.5,-733.04 31689.5,-733.04"/>
</g>
<!-- comm_s2_t2_g2 -->
<g id="node852" class="node">
<title>comm_s2_t2_g2</title>
<ellipse fill="lightblue" stroke="black" cx="31686" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="31686" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;82</text>
<text text-anchor="middle" x="31686" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g2_l12&#45;&gt;comm_s2_t2_g2 -->
<g id="edge254" class="edge">
<title>expert_s2_t2_g2_l12&#45;&gt;comm_s2_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-681.64C31686,-674.02 31686,-665.03 31686,-656.24"/>
<polygon fill="black" stroke="black" points="31689.5,-656.12 31686,-646.12 31682.5,-656.12 31689.5,-656.12"/>
</g>
<!-- expert_s2_t2_g2_l13 -->
<g id="node725" class="node">
<title>expert_s2_t2_g2_l13</title>
<polygon fill="lightgreen" stroke="black" points="36552,-917.93 36294,-917.93 36294,-876.93 36552,-876.93 36552,-917.93"/>
<text text-anchor="middle" x="36423" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;13 GPU&#45;82</text>
<text text-anchor="middle" x="36423" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36423" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g2_l14 -->
<g id="node726" class="node">
<title>expert_s2_t2_g2_l14</title>
<polygon fill="lightgreen" stroke="black" points="36276,-917.93 36018,-917.93 36018,-876.93 36276,-876.93 36276,-917.93"/>
<text text-anchor="middle" x="36147" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;14 GPU&#45;82</text>
<text text-anchor="middle" x="36147" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36147" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g2_l15 -->
<g id="node727" class="node">
<title>expert_s2_t2_g2_l15</title>
<polygon fill="lightgreen" stroke="black" points="36000,-917.93 35742,-917.93 35742,-876.93 36000,-876.93 36000,-917.93"/>
<text text-anchor="middle" x="35871" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;15 GPU&#45;82</text>
<text text-anchor="middle" x="35871" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35871" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g2_l16 -->
<g id="node728" class="node">
<title>expert_s2_t2_g2_l16</title>
<polygon fill="lightgreen" stroke="black" points="35724,-917.93 35466,-917.93 35466,-876.93 35724,-876.93 35724,-917.93"/>
<text text-anchor="middle" x="35595" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;16 GPU&#45;82</text>
<text text-anchor="middle" x="35595" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35595" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g2_l17 -->
<g id="node729" class="node">
<title>expert_s2_t2_g2_l17</title>
<polygon fill="lightgreen" stroke="black" points="35448,-917.93 35190,-917.93 35190,-876.93 35448,-876.93 35448,-917.93"/>
<text text-anchor="middle" x="35319" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;82 Layer&#45;17 GPU&#45;82</text>
<text text-anchor="middle" x="35319" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35319" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g3 -->
<g id="node730" class="node">
<title>attn_s2_t2_g3</title>
<polygon fill="lightgreen" stroke="black" points="33497.5,-917.93 33222.5,-917.93 33222.5,-876.93 33497.5,-876.93 33497.5,-917.93"/>
<text text-anchor="middle" x="33360" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;83</text>
<text text-anchor="middle" x="33360" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g3 -->
<g id="node731" class="node">
<title>gate_s2_t2_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="33625.32,-840.93 33203.26,-840.93 33094.68,-758.93 33516.74,-758.93 33625.32,-840.93"/>
<text text-anchor="middle" x="33360" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;83</text>
<text text-anchor="middle" x="33360" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g3&#45;&gt;gate_s2_t2_g3 -->
<g id="edge255" class="edge">
<title>attn_s2_t2_g3&#45;&gt;gate_s2_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-876.64C33360,-869.18 33360,-860.31 33360,-851.32"/>
<polygon fill="black" stroke="black" points="33363.5,-851.18 33360,-841.18 33356.5,-851.18 33363.5,-851.18"/>
</g>
<!-- expert_s2_t2_g3_l12 -->
<g id="node732" class="node">
<title>expert_s2_t2_g3_l12</title>
<polygon fill="lightgreen" stroke="black" points="33489,-722.93 33231,-722.93 33231,-681.93 33489,-681.93 33489,-722.93"/>
<text text-anchor="middle" x="33360" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;12 GPU&#45;83</text>
<text text-anchor="middle" x="33360" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g3&#45;&gt;expert_s2_t2_g3_l12 -->
<g id="edge256" class="edge">
<title>gate_s2_t2_g3&#45;&gt;expert_s2_t2_g3_l12</title>
<path fill="none" stroke="black" d="M33360,-758.71C33360,-750.13 33360,-741.22 33360,-733.12"/>
<polygon fill="black" stroke="black" points="33363.5,-733.04 33360,-723.04 33356.5,-733.04 33363.5,-733.04"/>
</g>
<!-- comm_s2_t2_g3 -->
<g id="node853" class="node">
<title>comm_s2_t2_g3</title>
<ellipse fill="lightblue" stroke="black" cx="33360" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="33360" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;83</text>
<text text-anchor="middle" x="33360" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g3_l12&#45;&gt;comm_s2_t2_g3 -->
<g id="edge257" class="edge">
<title>expert_s2_t2_g3_l12&#45;&gt;comm_s2_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-681.64C33360,-674.02 33360,-665.03 33360,-656.24"/>
<polygon fill="black" stroke="black" points="33363.5,-656.12 33360,-646.12 33356.5,-656.12 33363.5,-656.12"/>
</g>
<!-- expert_s2_t2_g3_l13 -->
<g id="node733" class="node">
<title>expert_s2_t2_g3_l13</title>
<polygon fill="lightgreen" stroke="black" points="34878,-917.93 34620,-917.93 34620,-876.93 34878,-876.93 34878,-917.93"/>
<text text-anchor="middle" x="34749" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;13 GPU&#45;83</text>
<text text-anchor="middle" x="34749" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34749" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g3_l14 -->
<g id="node734" class="node">
<title>expert_s2_t2_g3_l14</title>
<polygon fill="lightgreen" stroke="black" points="34602,-917.93 34344,-917.93 34344,-876.93 34602,-876.93 34602,-917.93"/>
<text text-anchor="middle" x="34473" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;14 GPU&#45;83</text>
<text text-anchor="middle" x="34473" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34473" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g3_l15 -->
<g id="node735" class="node">
<title>expert_s2_t2_g3_l15</title>
<polygon fill="lightgreen" stroke="black" points="34326,-917.93 34068,-917.93 34068,-876.93 34326,-876.93 34326,-917.93"/>
<text text-anchor="middle" x="34197" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;15 GPU&#45;83</text>
<text text-anchor="middle" x="34197" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34197" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g3_l16 -->
<g id="node736" class="node">
<title>expert_s2_t2_g3_l16</title>
<polygon fill="lightgreen" stroke="black" points="34050,-917.93 33792,-917.93 33792,-876.93 34050,-876.93 34050,-917.93"/>
<text text-anchor="middle" x="33921" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;16 GPU&#45;83</text>
<text text-anchor="middle" x="33921" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33921" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g3_l17 -->
<g id="node737" class="node">
<title>expert_s2_t2_g3_l17</title>
<polygon fill="lightgreen" stroke="black" points="33774,-917.93 33516,-917.93 33516,-876.93 33774,-876.93 33774,-917.93"/>
<text text-anchor="middle" x="33645" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;83 Layer&#45;17 GPU&#45;83</text>
<text text-anchor="middle" x="33645" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33645" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g4 -->
<g id="node738" class="node">
<title>attn_s2_t2_g4</title>
<polygon fill="lightgreen" stroke="black" points="35171.5,-917.93 34896.5,-917.93 34896.5,-876.93 35171.5,-876.93 35171.5,-917.93"/>
<text text-anchor="middle" x="35034" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;84</text>
<text text-anchor="middle" x="35034" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g4 -->
<g id="node739" class="node">
<title>gate_s2_t2_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="35299.32,-840.93 34877.26,-840.93 34768.68,-758.93 35190.74,-758.93 35299.32,-840.93"/>
<text text-anchor="middle" x="35034" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;84</text>
<text text-anchor="middle" x="35034" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g4&#45;&gt;gate_s2_t2_g4 -->
<g id="edge258" class="edge">
<title>attn_s2_t2_g4&#45;&gt;gate_s2_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-876.64C35034,-869.18 35034,-860.31 35034,-851.32"/>
<polygon fill="black" stroke="black" points="35037.5,-851.18 35034,-841.18 35030.5,-851.18 35037.5,-851.18"/>
</g>
<!-- expert_s2_t2_g4_l12 -->
<g id="node740" class="node">
<title>expert_s2_t2_g4_l12</title>
<polygon fill="lightgreen" stroke="black" points="35163,-722.93 34905,-722.93 34905,-681.93 35163,-681.93 35163,-722.93"/>
<text text-anchor="middle" x="35034" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;12 GPU&#45;84</text>
<text text-anchor="middle" x="35034" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g4&#45;&gt;expert_s2_t2_g4_l12 -->
<g id="edge259" class="edge">
<title>gate_s2_t2_g4&#45;&gt;expert_s2_t2_g4_l12</title>
<path fill="none" stroke="black" d="M35034,-758.71C35034,-750.13 35034,-741.22 35034,-733.12"/>
<polygon fill="black" stroke="black" points="35037.5,-733.04 35034,-723.04 35030.5,-733.04 35037.5,-733.04"/>
</g>
<!-- comm_s2_t2_g4 -->
<g id="node854" class="node">
<title>comm_s2_t2_g4</title>
<ellipse fill="lightblue" stroke="black" cx="35034" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="35034" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;84</text>
<text text-anchor="middle" x="35034" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g4_l12&#45;&gt;comm_s2_t2_g4 -->
<g id="edge260" class="edge">
<title>expert_s2_t2_g4_l12&#45;&gt;comm_s2_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-681.64C35034,-674.02 35034,-665.03 35034,-656.24"/>
<polygon fill="black" stroke="black" points="35037.5,-656.12 35034,-646.12 35030.5,-656.12 35037.5,-656.12"/>
</g>
<!-- expert_s2_t2_g4_l13 -->
<g id="node741" class="node">
<title>expert_s2_t2_g4_l13</title>
<polygon fill="lightgreen" stroke="black" points="33204,-917.93 32946,-917.93 32946,-876.93 33204,-876.93 33204,-917.93"/>
<text text-anchor="middle" x="33075" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;13 GPU&#45;84</text>
<text text-anchor="middle" x="33075" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33075" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g4_l14 -->
<g id="node742" class="node">
<title>expert_s2_t2_g4_l14</title>
<polygon fill="lightgreen" stroke="black" points="32928,-917.93 32670,-917.93 32670,-876.93 32928,-876.93 32928,-917.93"/>
<text text-anchor="middle" x="32799" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;14 GPU&#45;84</text>
<text text-anchor="middle" x="32799" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32799" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g4_l15 -->
<g id="node743" class="node">
<title>expert_s2_t2_g4_l15</title>
<polygon fill="lightgreen" stroke="black" points="32652,-917.93 32394,-917.93 32394,-876.93 32652,-876.93 32652,-917.93"/>
<text text-anchor="middle" x="32523" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;15 GPU&#45;84</text>
<text text-anchor="middle" x="32523" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32523" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g4_l16 -->
<g id="node744" class="node">
<title>expert_s2_t2_g4_l16</title>
<polygon fill="lightgreen" stroke="black" points="32376,-917.93 32118,-917.93 32118,-876.93 32376,-876.93 32376,-917.93"/>
<text text-anchor="middle" x="32247" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;16 GPU&#45;84</text>
<text text-anchor="middle" x="32247" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32247" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g4_l17 -->
<g id="node745" class="node">
<title>expert_s2_t2_g4_l17</title>
<polygon fill="lightgreen" stroke="black" points="32100,-917.93 31842,-917.93 31842,-876.93 32100,-876.93 32100,-917.93"/>
<text text-anchor="middle" x="31971" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;84 Layer&#45;17 GPU&#45;84</text>
<text text-anchor="middle" x="31971" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31971" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g5 -->
<g id="node746" class="node">
<title>attn_s2_t2_g5</title>
<polygon fill="lightgreen" stroke="black" points="36845.5,-917.93 36570.5,-917.93 36570.5,-876.93 36845.5,-876.93 36845.5,-917.93"/>
<text text-anchor="middle" x="36708" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;85</text>
<text text-anchor="middle" x="36708" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g5 -->
<g id="node747" class="node">
<title>gate_s2_t2_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="36973.32,-840.93 36551.26,-840.93 36442.68,-758.93 36864.74,-758.93 36973.32,-840.93"/>
<text text-anchor="middle" x="36708" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;85</text>
<text text-anchor="middle" x="36708" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g5&#45;&gt;gate_s2_t2_g5 -->
<g id="edge261" class="edge">
<title>attn_s2_t2_g5&#45;&gt;gate_s2_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-876.64C36708,-869.18 36708,-860.31 36708,-851.32"/>
<polygon fill="black" stroke="black" points="36711.5,-851.18 36708,-841.18 36704.5,-851.18 36711.5,-851.18"/>
</g>
<!-- expert_s2_t2_g5_l12 -->
<g id="node748" class="node">
<title>expert_s2_t2_g5_l12</title>
<polygon fill="lightgreen" stroke="black" points="36837,-722.93 36579,-722.93 36579,-681.93 36837,-681.93 36837,-722.93"/>
<text text-anchor="middle" x="36708" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;12 GPU&#45;85</text>
<text text-anchor="middle" x="36708" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g5&#45;&gt;expert_s2_t2_g5_l12 -->
<g id="edge262" class="edge">
<title>gate_s2_t2_g5&#45;&gt;expert_s2_t2_g5_l12</title>
<path fill="none" stroke="black" d="M36708,-758.71C36708,-750.13 36708,-741.22 36708,-733.12"/>
<polygon fill="black" stroke="black" points="36711.5,-733.04 36708,-723.04 36704.5,-733.04 36711.5,-733.04"/>
</g>
<!-- comm_s2_t2_g5 -->
<g id="node855" class="node">
<title>comm_s2_t2_g5</title>
<ellipse fill="lightblue" stroke="black" cx="36708" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="36708" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;85</text>
<text text-anchor="middle" x="36708" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g5_l12&#45;&gt;comm_s2_t2_g5 -->
<g id="edge263" class="edge">
<title>expert_s2_t2_g5_l12&#45;&gt;comm_s2_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-681.64C36708,-674.02 36708,-665.03 36708,-656.24"/>
<polygon fill="black" stroke="black" points="36711.5,-656.12 36708,-646.12 36704.5,-656.12 36711.5,-656.12"/>
</g>
<!-- expert_s2_t2_g5_l13 -->
<g id="node749" class="node">
<title>expert_s2_t2_g5_l13</title>
<polygon fill="lightgreen" stroke="black" points="31530,-917.93 31272,-917.93 31272,-876.93 31530,-876.93 31530,-917.93"/>
<text text-anchor="middle" x="31401" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;13 GPU&#45;85</text>
<text text-anchor="middle" x="31401" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31401" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g5_l14 -->
<g id="node750" class="node">
<title>expert_s2_t2_g5_l14</title>
<polygon fill="lightgreen" stroke="black" points="31254,-917.93 30996,-917.93 30996,-876.93 31254,-876.93 31254,-917.93"/>
<text text-anchor="middle" x="31125" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;14 GPU&#45;85</text>
<text text-anchor="middle" x="31125" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31125" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g5_l15 -->
<g id="node751" class="node">
<title>expert_s2_t2_g5_l15</title>
<polygon fill="lightgreen" stroke="black" points="30978,-917.93 30720,-917.93 30720,-876.93 30978,-876.93 30978,-917.93"/>
<text text-anchor="middle" x="30849" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;15 GPU&#45;85</text>
<text text-anchor="middle" x="30849" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30849" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g5_l16 -->
<g id="node752" class="node">
<title>expert_s2_t2_g5_l16</title>
<polygon fill="lightgreen" stroke="black" points="30702,-917.93 30444,-917.93 30444,-876.93 30702,-876.93 30702,-917.93"/>
<text text-anchor="middle" x="30573" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;16 GPU&#45;85</text>
<text text-anchor="middle" x="30573" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30573" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g5_l17 -->
<g id="node753" class="node">
<title>expert_s2_t2_g5_l17</title>
<polygon fill="lightgreen" stroke="black" points="30426,-917.93 30168,-917.93 30168,-876.93 30426,-876.93 30426,-917.93"/>
<text text-anchor="middle" x="30297" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;85 Layer&#45;17 GPU&#45;85</text>
<text text-anchor="middle" x="30297" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30297" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g6 -->
<g id="node754" class="node">
<title>attn_s2_t2_g6</title>
<polygon fill="lightgreen" stroke="black" points="38519.5,-917.93 38244.5,-917.93 38244.5,-876.93 38519.5,-876.93 38519.5,-917.93"/>
<text text-anchor="middle" x="38382" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;86</text>
<text text-anchor="middle" x="38382" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g6 -->
<g id="node755" class="node">
<title>gate_s2_t2_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="38647.32,-840.93 38225.26,-840.93 38116.68,-758.93 38538.74,-758.93 38647.32,-840.93"/>
<text text-anchor="middle" x="38382" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;86</text>
<text text-anchor="middle" x="38382" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g6&#45;&gt;gate_s2_t2_g6 -->
<g id="edge264" class="edge">
<title>attn_s2_t2_g6&#45;&gt;gate_s2_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-876.64C38382,-869.18 38382,-860.31 38382,-851.32"/>
<polygon fill="black" stroke="black" points="38385.5,-851.18 38382,-841.18 38378.5,-851.18 38385.5,-851.18"/>
</g>
<!-- expert_s2_t2_g6_l12 -->
<g id="node756" class="node">
<title>expert_s2_t2_g6_l12</title>
<polygon fill="lightgreen" stroke="black" points="38511,-722.93 38253,-722.93 38253,-681.93 38511,-681.93 38511,-722.93"/>
<text text-anchor="middle" x="38382" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;12 GPU&#45;86</text>
<text text-anchor="middle" x="38382" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g6&#45;&gt;expert_s2_t2_g6_l12 -->
<g id="edge265" class="edge">
<title>gate_s2_t2_g6&#45;&gt;expert_s2_t2_g6_l12</title>
<path fill="none" stroke="black" d="M38382,-758.71C38382,-750.13 38382,-741.22 38382,-733.12"/>
<polygon fill="black" stroke="black" points="38385.5,-733.04 38382,-723.04 38378.5,-733.04 38385.5,-733.04"/>
</g>
<!-- comm_s2_t2_g6 -->
<g id="node856" class="node">
<title>comm_s2_t2_g6</title>
<ellipse fill="lightblue" stroke="black" cx="38382" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="38382" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;86</text>
<text text-anchor="middle" x="38382" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g6_l12&#45;&gt;comm_s2_t2_g6 -->
<g id="edge266" class="edge">
<title>expert_s2_t2_g6_l12&#45;&gt;comm_s2_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-681.64C38382,-674.02 38382,-665.03 38382,-656.24"/>
<polygon fill="black" stroke="black" points="38385.5,-656.12 38382,-646.12 38378.5,-656.12 38385.5,-656.12"/>
</g>
<!-- expert_s2_t2_g6_l13 -->
<g id="node757" class="node">
<title>expert_s2_t2_g6_l13</title>
<polygon fill="lightgreen" stroke="black" points="29856,-917.93 29598,-917.93 29598,-876.93 29856,-876.93 29856,-917.93"/>
<text text-anchor="middle" x="29727" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;13 GPU&#45;86</text>
<text text-anchor="middle" x="29727" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29727" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g6_l14 -->
<g id="node758" class="node">
<title>expert_s2_t2_g6_l14</title>
<polygon fill="lightgreen" stroke="black" points="29580,-917.93 29322,-917.93 29322,-876.93 29580,-876.93 29580,-917.93"/>
<text text-anchor="middle" x="29451" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;14 GPU&#45;86</text>
<text text-anchor="middle" x="29451" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29451" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g6_l15 -->
<g id="node759" class="node">
<title>expert_s2_t2_g6_l15</title>
<polygon fill="lightgreen" stroke="black" points="29304,-917.93 29046,-917.93 29046,-876.93 29304,-876.93 29304,-917.93"/>
<text text-anchor="middle" x="29175" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;15 GPU&#45;86</text>
<text text-anchor="middle" x="29175" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29175" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g6_l16 -->
<g id="node760" class="node">
<title>expert_s2_t2_g6_l16</title>
<polygon fill="lightgreen" stroke="black" points="29028,-917.93 28770,-917.93 28770,-876.93 29028,-876.93 29028,-917.93"/>
<text text-anchor="middle" x="28899" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;16 GPU&#45;86</text>
<text text-anchor="middle" x="28899" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28899" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g6_l17 -->
<g id="node761" class="node">
<title>expert_s2_t2_g6_l17</title>
<polygon fill="lightgreen" stroke="black" points="28752,-917.93 28494,-917.93 28494,-876.93 28752,-876.93 28752,-917.93"/>
<text text-anchor="middle" x="28623" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;86 Layer&#45;17 GPU&#45;86</text>
<text text-anchor="middle" x="28623" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28623" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t2_g7 -->
<g id="node762" class="node">
<title>attn_s2_t2_g7</title>
<polygon fill="lightgreen" stroke="black" points="40193.5,-917.93 39918.5,-917.93 39918.5,-876.93 40193.5,-876.93 40193.5,-917.93"/>
<text text-anchor="middle" x="40056" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;87</text>
<text text-anchor="middle" x="40056" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="40056" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t2_g7 -->
<g id="node763" class="node">
<title>gate_s2_t2_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="40194.32,-840.93 39772.26,-840.93 39663.68,-758.93 40085.74,-758.93 40194.32,-840.93"/>
<text text-anchor="middle" x="39929" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;87</text>
<text text-anchor="middle" x="39929" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t2_g7&#45;&gt;gate_s2_t2_g7 -->
<g id="edge267" class="edge">
<title>attn_s2_t2_g7&#45;&gt;gate_s2_t2_g7</title>
<path fill="none" stroke="black" d="M40029.99,-876.87C40018.47,-868.21 40004.37,-857.61 39990.41,-847.11"/>
<polygon fill="black" stroke="black" points="39992.33,-844.17 39982.23,-840.96 39988.12,-849.77 39992.33,-844.17"/>
</g>
<!-- expert_s2_t2_g7_l12 -->
<g id="node764" class="node">
<title>expert_s2_t2_g7_l12</title>
<polygon fill="lightgreen" stroke="black" points="40058,-722.93 39800,-722.93 39800,-681.93 40058,-681.93 40058,-722.93"/>
<text text-anchor="middle" x="39929" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;12 GPU&#45;87</text>
<text text-anchor="middle" x="39929" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t2_g7&#45;&gt;expert_s2_t2_g7_l12 -->
<g id="edge268" class="edge">
<title>gate_s2_t2_g7&#45;&gt;expert_s2_t2_g7_l12</title>
<path fill="none" stroke="black" d="M39929,-758.71C39929,-750.13 39929,-741.22 39929,-733.12"/>
<polygon fill="black" stroke="black" points="39932.5,-733.04 39929,-723.04 39925.5,-733.04 39932.5,-733.04"/>
</g>
<!-- comm_s2_t2_g7 -->
<g id="node857" class="node">
<title>comm_s2_t2_g7</title>
<ellipse fill="lightblue" stroke="black" cx="39929" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="39929" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;87</text>
<text text-anchor="middle" x="39929" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="39929" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t2_g7_l12&#45;&gt;comm_s2_t2_g7 -->
<g id="edge269" class="edge">
<title>expert_s2_t2_g7_l12&#45;&gt;comm_s2_t2_g7</title>
<path fill="none" stroke="black" d="M39929,-681.64C39929,-674.02 39929,-665.03 39929,-656.24"/>
<polygon fill="black" stroke="black" points="39932.5,-656.12 39929,-646.12 39925.5,-656.12 39932.5,-656.12"/>
</g>
<!-- expert_s2_t2_g7_l13 -->
<g id="node765" class="node">
<title>expert_s2_t2_g7_l13</title>
<polygon fill="lightgreen" stroke="black" points="28182,-917.93 27924,-917.93 27924,-876.93 28182,-876.93 28182,-917.93"/>
<text text-anchor="middle" x="28053" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;13 GPU&#45;87</text>
<text text-anchor="middle" x="28053" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28053" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g7_l14 -->
<g id="node766" class="node">
<title>expert_s2_t2_g7_l14</title>
<polygon fill="lightgreen" stroke="black" points="27906,-917.93 27648,-917.93 27648,-876.93 27906,-876.93 27906,-917.93"/>
<text text-anchor="middle" x="27777" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;14 GPU&#45;87</text>
<text text-anchor="middle" x="27777" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27777" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g7_l15 -->
<g id="node767" class="node">
<title>expert_s2_t2_g7_l15</title>
<polygon fill="lightgreen" stroke="black" points="27630,-917.93 27372,-917.93 27372,-876.93 27630,-876.93 27630,-917.93"/>
<text text-anchor="middle" x="27501" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;15 GPU&#45;87</text>
<text text-anchor="middle" x="27501" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27501" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g7_l16 -->
<g id="node768" class="node">
<title>expert_s2_t2_g7_l16</title>
<polygon fill="lightgreen" stroke="black" points="27354,-917.93 27096,-917.93 27096,-876.93 27354,-876.93 27354,-917.93"/>
<text text-anchor="middle" x="27225" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;16 GPU&#45;87</text>
<text text-anchor="middle" x="27225" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27225" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t2_g7_l17 -->
<g id="node769" class="node">
<title>expert_s2_t2_g7_l17</title>
<polygon fill="lightgreen" stroke="black" points="27078,-917.93 26820,-917.93 26820,-876.93 27078,-876.93 27078,-917.93"/>
<text text-anchor="middle" x="26949" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;87 Layer&#45;17 GPU&#45;87</text>
<text text-anchor="middle" x="26949" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26949" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g0 -->
<g id="node770" class="node">
<title>attn_s2_t3_g0</title>
<polygon fill="lightgreen" stroke="black" points="41873.5,-917.93 41598.5,-917.93 41598.5,-876.93 41873.5,-876.93 41873.5,-917.93"/>
<text text-anchor="middle" x="41736" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;88</text>
<text text-anchor="middle" x="41736" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g0 -->
<g id="node771" class="node">
<title>gate_s2_t3_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="42001.32,-840.93 41579.26,-840.93 41470.68,-758.93 41892.74,-758.93 42001.32,-840.93"/>
<text text-anchor="middle" x="41736" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;88</text>
<text text-anchor="middle" x="41736" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g0&#45;&gt;gate_s2_t3_g0 -->
<g id="edge270" class="edge">
<title>attn_s2_t3_g0&#45;&gt;gate_s2_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-876.64C41736,-869.18 41736,-860.31 41736,-851.32"/>
<polygon fill="black" stroke="black" points="41739.5,-851.18 41736,-841.18 41732.5,-851.18 41739.5,-851.18"/>
</g>
<!-- expert_s2_t3_g0_l12 -->
<g id="node772" class="node">
<title>expert_s2_t3_g0_l12</title>
<polygon fill="lightgreen" stroke="black" points="41865,-722.93 41607,-722.93 41607,-681.93 41865,-681.93 41865,-722.93"/>
<text text-anchor="middle" x="41736" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;12 GPU&#45;88</text>
<text text-anchor="middle" x="41736" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g0&#45;&gt;expert_s2_t3_g0_l12 -->
<g id="edge271" class="edge">
<title>gate_s2_t3_g0&#45;&gt;expert_s2_t3_g0_l12</title>
<path fill="none" stroke="black" d="M41736,-758.71C41736,-750.13 41736,-741.22 41736,-733.12"/>
<polygon fill="black" stroke="black" points="41739.5,-733.04 41736,-723.04 41732.5,-733.04 41739.5,-733.04"/>
</g>
<!-- comm_s2_t3_g0 -->
<g id="node858" class="node">
<title>comm_s2_t3_g0</title>
<ellipse fill="lightblue" stroke="black" cx="41736" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="41736" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;88</text>
<text text-anchor="middle" x="41736" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g0_l12&#45;&gt;comm_s2_t3_g0 -->
<g id="edge272" class="edge">
<title>expert_s2_t3_g0_l12&#45;&gt;comm_s2_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-681.64C41736,-674.02 41736,-665.03 41736,-656.24"/>
<polygon fill="black" stroke="black" points="41739.5,-656.12 41736,-646.12 41732.5,-656.12 41739.5,-656.12"/>
</g>
<!-- expert_s2_t3_g0_l13 -->
<g id="node773" class="node">
<title>expert_s2_t3_g0_l13</title>
<polygon fill="lightgreen" stroke="black" points="53298,-917.93 53040,-917.93 53040,-876.93 53298,-876.93 53298,-917.93"/>
<text text-anchor="middle" x="53169" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;13 GPU&#45;88</text>
<text text-anchor="middle" x="53169" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53169" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g0_l14 -->
<g id="node774" class="node">
<title>expert_s2_t3_g0_l14</title>
<polygon fill="lightgreen" stroke="black" points="53022,-917.93 52764,-917.93 52764,-876.93 53022,-876.93 53022,-917.93"/>
<text text-anchor="middle" x="52893" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;14 GPU&#45;88</text>
<text text-anchor="middle" x="52893" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52893" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g0_l15 -->
<g id="node775" class="node">
<title>expert_s2_t3_g0_l15</title>
<polygon fill="lightgreen" stroke="black" points="52746,-917.93 52488,-917.93 52488,-876.93 52746,-876.93 52746,-917.93"/>
<text text-anchor="middle" x="52617" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;15 GPU&#45;88</text>
<text text-anchor="middle" x="52617" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52617" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g0_l16 -->
<g id="node776" class="node">
<title>expert_s2_t3_g0_l16</title>
<polygon fill="lightgreen" stroke="black" points="52470,-917.93 52212,-917.93 52212,-876.93 52470,-876.93 52470,-917.93"/>
<text text-anchor="middle" x="52341" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;16 GPU&#45;88</text>
<text text-anchor="middle" x="52341" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52341" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g0_l17 -->
<g id="node777" class="node">
<title>expert_s2_t3_g0_l17</title>
<polygon fill="lightgreen" stroke="black" points="52194,-917.93 51936,-917.93 51936,-876.93 52194,-876.93 52194,-917.93"/>
<text text-anchor="middle" x="52065" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;88 Layer&#45;17 GPU&#45;88</text>
<text text-anchor="middle" x="52065" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52065" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g1 -->
<g id="node778" class="node">
<title>attn_s2_t3_g1</title>
<polygon fill="lightgreen" stroke="black" points="43547.5,-917.93 43272.5,-917.93 43272.5,-876.93 43547.5,-876.93 43547.5,-917.93"/>
<text text-anchor="middle" x="43410" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;89</text>
<text text-anchor="middle" x="43410" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g1 -->
<g id="node779" class="node">
<title>gate_s2_t3_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="43675.32,-840.93 43253.26,-840.93 43144.68,-758.93 43566.74,-758.93 43675.32,-840.93"/>
<text text-anchor="middle" x="43410" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;89</text>
<text text-anchor="middle" x="43410" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g1&#45;&gt;gate_s2_t3_g1 -->
<g id="edge273" class="edge">
<title>attn_s2_t3_g1&#45;&gt;gate_s2_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-876.64C43410,-869.18 43410,-860.31 43410,-851.32"/>
<polygon fill="black" stroke="black" points="43413.5,-851.18 43410,-841.18 43406.5,-851.18 43413.5,-851.18"/>
</g>
<!-- expert_s2_t3_g1_l12 -->
<g id="node780" class="node">
<title>expert_s2_t3_g1_l12</title>
<polygon fill="lightgreen" stroke="black" points="43539,-722.93 43281,-722.93 43281,-681.93 43539,-681.93 43539,-722.93"/>
<text text-anchor="middle" x="43410" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;12 GPU&#45;89</text>
<text text-anchor="middle" x="43410" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g1&#45;&gt;expert_s2_t3_g1_l12 -->
<g id="edge274" class="edge">
<title>gate_s2_t3_g1&#45;&gt;expert_s2_t3_g1_l12</title>
<path fill="none" stroke="black" d="M43410,-758.71C43410,-750.13 43410,-741.22 43410,-733.12"/>
<polygon fill="black" stroke="black" points="43413.5,-733.04 43410,-723.04 43406.5,-733.04 43413.5,-733.04"/>
</g>
<!-- comm_s2_t3_g1 -->
<g id="node859" class="node">
<title>comm_s2_t3_g1</title>
<ellipse fill="lightblue" stroke="black" cx="43410" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="43410" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;89</text>
<text text-anchor="middle" x="43410" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g1_l12&#45;&gt;comm_s2_t3_g1 -->
<g id="edge275" class="edge">
<title>expert_s2_t3_g1_l12&#45;&gt;comm_s2_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-681.64C43410,-674.02 43410,-665.03 43410,-656.24"/>
<polygon fill="black" stroke="black" points="43413.5,-656.12 43410,-646.12 43406.5,-656.12 43413.5,-656.12"/>
</g>
<!-- expert_s2_t3_g1_l13 -->
<g id="node781" class="node">
<title>expert_s2_t3_g1_l13</title>
<polygon fill="lightgreen" stroke="black" points="51624,-917.93 51366,-917.93 51366,-876.93 51624,-876.93 51624,-917.93"/>
<text text-anchor="middle" x="51495" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;13 GPU&#45;89</text>
<text text-anchor="middle" x="51495" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51495" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g1_l14 -->
<g id="node782" class="node">
<title>expert_s2_t3_g1_l14</title>
<polygon fill="lightgreen" stroke="black" points="51348,-917.93 51090,-917.93 51090,-876.93 51348,-876.93 51348,-917.93"/>
<text text-anchor="middle" x="51219" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;14 GPU&#45;89</text>
<text text-anchor="middle" x="51219" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51219" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g1_l15 -->
<g id="node783" class="node">
<title>expert_s2_t3_g1_l15</title>
<polygon fill="lightgreen" stroke="black" points="51072,-917.93 50814,-917.93 50814,-876.93 51072,-876.93 51072,-917.93"/>
<text text-anchor="middle" x="50943" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;15 GPU&#45;89</text>
<text text-anchor="middle" x="50943" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50943" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g1_l16 -->
<g id="node784" class="node">
<title>expert_s2_t3_g1_l16</title>
<polygon fill="lightgreen" stroke="black" points="50796,-917.93 50538,-917.93 50538,-876.93 50796,-876.93 50796,-917.93"/>
<text text-anchor="middle" x="50667" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;16 GPU&#45;89</text>
<text text-anchor="middle" x="50667" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50667" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g1_l17 -->
<g id="node785" class="node">
<title>expert_s2_t3_g1_l17</title>
<polygon fill="lightgreen" stroke="black" points="50520,-917.93 50262,-917.93 50262,-876.93 50520,-876.93 50520,-917.93"/>
<text text-anchor="middle" x="50391" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;89 Layer&#45;17 GPU&#45;89</text>
<text text-anchor="middle" x="50391" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50391" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g2 -->
<g id="node786" class="node">
<title>attn_s2_t3_g2</title>
<polygon fill="lightgreen" stroke="black" points="45221.5,-917.93 44946.5,-917.93 44946.5,-876.93 45221.5,-876.93 45221.5,-917.93"/>
<text text-anchor="middle" x="45084" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;90</text>
<text text-anchor="middle" x="45084" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g2 -->
<g id="node787" class="node">
<title>gate_s2_t3_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="45349.32,-840.93 44927.26,-840.93 44818.68,-758.93 45240.74,-758.93 45349.32,-840.93"/>
<text text-anchor="middle" x="45084" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;90</text>
<text text-anchor="middle" x="45084" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g2&#45;&gt;gate_s2_t3_g2 -->
<g id="edge276" class="edge">
<title>attn_s2_t3_g2&#45;&gt;gate_s2_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-876.64C45084,-869.18 45084,-860.31 45084,-851.32"/>
<polygon fill="black" stroke="black" points="45087.5,-851.18 45084,-841.18 45080.5,-851.18 45087.5,-851.18"/>
</g>
<!-- expert_s2_t3_g2_l12 -->
<g id="node788" class="node">
<title>expert_s2_t3_g2_l12</title>
<polygon fill="lightgreen" stroke="black" points="45213,-722.93 44955,-722.93 44955,-681.93 45213,-681.93 45213,-722.93"/>
<text text-anchor="middle" x="45084" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;12 GPU&#45;90</text>
<text text-anchor="middle" x="45084" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g2&#45;&gt;expert_s2_t3_g2_l12 -->
<g id="edge277" class="edge">
<title>gate_s2_t3_g2&#45;&gt;expert_s2_t3_g2_l12</title>
<path fill="none" stroke="black" d="M45084,-758.71C45084,-750.13 45084,-741.22 45084,-733.12"/>
<polygon fill="black" stroke="black" points="45087.5,-733.04 45084,-723.04 45080.5,-733.04 45087.5,-733.04"/>
</g>
<!-- comm_s2_t3_g2 -->
<g id="node860" class="node">
<title>comm_s2_t3_g2</title>
<ellipse fill="lightblue" stroke="black" cx="45084" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="45084" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;90</text>
<text text-anchor="middle" x="45084" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g2_l12&#45;&gt;comm_s2_t3_g2 -->
<g id="edge278" class="edge">
<title>expert_s2_t3_g2_l12&#45;&gt;comm_s2_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-681.64C45084,-674.02 45084,-665.03 45084,-656.24"/>
<polygon fill="black" stroke="black" points="45087.5,-656.12 45084,-646.12 45080.5,-656.12 45087.5,-656.12"/>
</g>
<!-- expert_s2_t3_g2_l13 -->
<g id="node789" class="node">
<title>expert_s2_t3_g2_l13</title>
<polygon fill="lightgreen" stroke="black" points="49950,-917.93 49692,-917.93 49692,-876.93 49950,-876.93 49950,-917.93"/>
<text text-anchor="middle" x="49821" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;13 GPU&#45;90</text>
<text text-anchor="middle" x="49821" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49821" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g2_l14 -->
<g id="node790" class="node">
<title>expert_s2_t3_g2_l14</title>
<polygon fill="lightgreen" stroke="black" points="49674,-917.93 49416,-917.93 49416,-876.93 49674,-876.93 49674,-917.93"/>
<text text-anchor="middle" x="49545" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;14 GPU&#45;90</text>
<text text-anchor="middle" x="49545" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49545" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g2_l15 -->
<g id="node791" class="node">
<title>expert_s2_t3_g2_l15</title>
<polygon fill="lightgreen" stroke="black" points="49398,-917.93 49140,-917.93 49140,-876.93 49398,-876.93 49398,-917.93"/>
<text text-anchor="middle" x="49269" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;15 GPU&#45;90</text>
<text text-anchor="middle" x="49269" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49269" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g2_l16 -->
<g id="node792" class="node">
<title>expert_s2_t3_g2_l16</title>
<polygon fill="lightgreen" stroke="black" points="49122,-917.93 48864,-917.93 48864,-876.93 49122,-876.93 49122,-917.93"/>
<text text-anchor="middle" x="48993" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;16 GPU&#45;90</text>
<text text-anchor="middle" x="48993" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48993" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g2_l17 -->
<g id="node793" class="node">
<title>expert_s2_t3_g2_l17</title>
<polygon fill="lightgreen" stroke="black" points="48846,-917.93 48588,-917.93 48588,-876.93 48846,-876.93 48846,-917.93"/>
<text text-anchor="middle" x="48717" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;90 Layer&#45;17 GPU&#45;90</text>
<text text-anchor="middle" x="48717" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48717" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g3 -->
<g id="node794" class="node">
<title>attn_s2_t3_g3</title>
<polygon fill="lightgreen" stroke="black" points="46895.5,-917.93 46620.5,-917.93 46620.5,-876.93 46895.5,-876.93 46895.5,-917.93"/>
<text text-anchor="middle" x="46758" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;91</text>
<text text-anchor="middle" x="46758" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g3 -->
<g id="node795" class="node">
<title>gate_s2_t3_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="47023.32,-840.93 46601.26,-840.93 46492.68,-758.93 46914.74,-758.93 47023.32,-840.93"/>
<text text-anchor="middle" x="46758" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;91</text>
<text text-anchor="middle" x="46758" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g3&#45;&gt;gate_s2_t3_g3 -->
<g id="edge279" class="edge">
<title>attn_s2_t3_g3&#45;&gt;gate_s2_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-876.64C46758,-869.18 46758,-860.31 46758,-851.32"/>
<polygon fill="black" stroke="black" points="46761.5,-851.18 46758,-841.18 46754.5,-851.18 46761.5,-851.18"/>
</g>
<!-- expert_s2_t3_g3_l12 -->
<g id="node796" class="node">
<title>expert_s2_t3_g3_l12</title>
<polygon fill="lightgreen" stroke="black" points="46887,-722.93 46629,-722.93 46629,-681.93 46887,-681.93 46887,-722.93"/>
<text text-anchor="middle" x="46758" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;12 GPU&#45;91</text>
<text text-anchor="middle" x="46758" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g3&#45;&gt;expert_s2_t3_g3_l12 -->
<g id="edge280" class="edge">
<title>gate_s2_t3_g3&#45;&gt;expert_s2_t3_g3_l12</title>
<path fill="none" stroke="black" d="M46758,-758.71C46758,-750.13 46758,-741.22 46758,-733.12"/>
<polygon fill="black" stroke="black" points="46761.5,-733.04 46758,-723.04 46754.5,-733.04 46761.5,-733.04"/>
</g>
<!-- comm_s2_t3_g3 -->
<g id="node861" class="node">
<title>comm_s2_t3_g3</title>
<ellipse fill="lightblue" stroke="black" cx="46758" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="46758" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;91</text>
<text text-anchor="middle" x="46758" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g3_l12&#45;&gt;comm_s2_t3_g3 -->
<g id="edge281" class="edge">
<title>expert_s2_t3_g3_l12&#45;&gt;comm_s2_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-681.64C46758,-674.02 46758,-665.03 46758,-656.24"/>
<polygon fill="black" stroke="black" points="46761.5,-656.12 46758,-646.12 46754.5,-656.12 46761.5,-656.12"/>
</g>
<!-- expert_s2_t3_g3_l13 -->
<g id="node797" class="node">
<title>expert_s2_t3_g3_l13</title>
<polygon fill="lightgreen" stroke="black" points="48276,-917.93 48018,-917.93 48018,-876.93 48276,-876.93 48276,-917.93"/>
<text text-anchor="middle" x="48147" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;13 GPU&#45;91</text>
<text text-anchor="middle" x="48147" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48147" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g3_l14 -->
<g id="node798" class="node">
<title>expert_s2_t3_g3_l14</title>
<polygon fill="lightgreen" stroke="black" points="48000,-917.93 47742,-917.93 47742,-876.93 48000,-876.93 48000,-917.93"/>
<text text-anchor="middle" x="47871" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;14 GPU&#45;91</text>
<text text-anchor="middle" x="47871" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47871" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g3_l15 -->
<g id="node799" class="node">
<title>expert_s2_t3_g3_l15</title>
<polygon fill="lightgreen" stroke="black" points="47724,-917.93 47466,-917.93 47466,-876.93 47724,-876.93 47724,-917.93"/>
<text text-anchor="middle" x="47595" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;15 GPU&#45;91</text>
<text text-anchor="middle" x="47595" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47595" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g3_l16 -->
<g id="node800" class="node">
<title>expert_s2_t3_g3_l16</title>
<polygon fill="lightgreen" stroke="black" points="47448,-917.93 47190,-917.93 47190,-876.93 47448,-876.93 47448,-917.93"/>
<text text-anchor="middle" x="47319" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;16 GPU&#45;91</text>
<text text-anchor="middle" x="47319" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47319" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g3_l17 -->
<g id="node801" class="node">
<title>expert_s2_t3_g3_l17</title>
<polygon fill="lightgreen" stroke="black" points="47172,-917.93 46914,-917.93 46914,-876.93 47172,-876.93 47172,-917.93"/>
<text text-anchor="middle" x="47043" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;91 Layer&#45;17 GPU&#45;91</text>
<text text-anchor="middle" x="47043" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47043" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g4 -->
<g id="node802" class="node">
<title>attn_s2_t3_g4</title>
<polygon fill="lightgreen" stroke="black" points="48569.5,-917.93 48294.5,-917.93 48294.5,-876.93 48569.5,-876.93 48569.5,-917.93"/>
<text text-anchor="middle" x="48432" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;92</text>
<text text-anchor="middle" x="48432" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g4 -->
<g id="node803" class="node">
<title>gate_s2_t3_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="48697.32,-840.93 48275.26,-840.93 48166.68,-758.93 48588.74,-758.93 48697.32,-840.93"/>
<text text-anchor="middle" x="48432" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;92</text>
<text text-anchor="middle" x="48432" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g4&#45;&gt;gate_s2_t3_g4 -->
<g id="edge282" class="edge">
<title>attn_s2_t3_g4&#45;&gt;gate_s2_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-876.64C48432,-869.18 48432,-860.31 48432,-851.32"/>
<polygon fill="black" stroke="black" points="48435.5,-851.18 48432,-841.18 48428.5,-851.18 48435.5,-851.18"/>
</g>
<!-- expert_s2_t3_g4_l12 -->
<g id="node804" class="node">
<title>expert_s2_t3_g4_l12</title>
<polygon fill="lightgreen" stroke="black" points="48561,-722.93 48303,-722.93 48303,-681.93 48561,-681.93 48561,-722.93"/>
<text text-anchor="middle" x="48432" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;12 GPU&#45;92</text>
<text text-anchor="middle" x="48432" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g4&#45;&gt;expert_s2_t3_g4_l12 -->
<g id="edge283" class="edge">
<title>gate_s2_t3_g4&#45;&gt;expert_s2_t3_g4_l12</title>
<path fill="none" stroke="black" d="M48432,-758.71C48432,-750.13 48432,-741.22 48432,-733.12"/>
<polygon fill="black" stroke="black" points="48435.5,-733.04 48432,-723.04 48428.5,-733.04 48435.5,-733.04"/>
</g>
<!-- comm_s2_t3_g4 -->
<g id="node862" class="node">
<title>comm_s2_t3_g4</title>
<ellipse fill="lightblue" stroke="black" cx="48432" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="48432" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;92</text>
<text text-anchor="middle" x="48432" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g4_l12&#45;&gt;comm_s2_t3_g4 -->
<g id="edge284" class="edge">
<title>expert_s2_t3_g4_l12&#45;&gt;comm_s2_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-681.64C48432,-674.02 48432,-665.03 48432,-656.24"/>
<polygon fill="black" stroke="black" points="48435.5,-656.12 48432,-646.12 48428.5,-656.12 48435.5,-656.12"/>
</g>
<!-- expert_s2_t3_g4_l13 -->
<g id="node805" class="node">
<title>expert_s2_t3_g4_l13</title>
<polygon fill="lightgreen" stroke="black" points="46602,-917.93 46344,-917.93 46344,-876.93 46602,-876.93 46602,-917.93"/>
<text text-anchor="middle" x="46473" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;13 GPU&#45;92</text>
<text text-anchor="middle" x="46473" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46473" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g4_l14 -->
<g id="node806" class="node">
<title>expert_s2_t3_g4_l14</title>
<polygon fill="lightgreen" stroke="black" points="46326,-917.93 46068,-917.93 46068,-876.93 46326,-876.93 46326,-917.93"/>
<text text-anchor="middle" x="46197" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;14 GPU&#45;92</text>
<text text-anchor="middle" x="46197" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46197" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g4_l15 -->
<g id="node807" class="node">
<title>expert_s2_t3_g4_l15</title>
<polygon fill="lightgreen" stroke="black" points="46050,-917.93 45792,-917.93 45792,-876.93 46050,-876.93 46050,-917.93"/>
<text text-anchor="middle" x="45921" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;15 GPU&#45;92</text>
<text text-anchor="middle" x="45921" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45921" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g4_l16 -->
<g id="node808" class="node">
<title>expert_s2_t3_g4_l16</title>
<polygon fill="lightgreen" stroke="black" points="45774,-917.93 45516,-917.93 45516,-876.93 45774,-876.93 45774,-917.93"/>
<text text-anchor="middle" x="45645" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;16 GPU&#45;92</text>
<text text-anchor="middle" x="45645" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45645" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g4_l17 -->
<g id="node809" class="node">
<title>expert_s2_t3_g4_l17</title>
<polygon fill="lightgreen" stroke="black" points="45498,-917.93 45240,-917.93 45240,-876.93 45498,-876.93 45498,-917.93"/>
<text text-anchor="middle" x="45369" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;92 Layer&#45;17 GPU&#45;92</text>
<text text-anchor="middle" x="45369" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45369" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g5 -->
<g id="node810" class="node">
<title>attn_s2_t3_g5</title>
<polygon fill="lightgreen" stroke="black" points="50243.5,-917.93 49968.5,-917.93 49968.5,-876.93 50243.5,-876.93 50243.5,-917.93"/>
<text text-anchor="middle" x="50106" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;93</text>
<text text-anchor="middle" x="50106" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g5 -->
<g id="node811" class="node">
<title>gate_s2_t3_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="50371.32,-840.93 49949.26,-840.93 49840.68,-758.93 50262.74,-758.93 50371.32,-840.93"/>
<text text-anchor="middle" x="50106" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;93</text>
<text text-anchor="middle" x="50106" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g5&#45;&gt;gate_s2_t3_g5 -->
<g id="edge285" class="edge">
<title>attn_s2_t3_g5&#45;&gt;gate_s2_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-876.64C50106,-869.18 50106,-860.31 50106,-851.32"/>
<polygon fill="black" stroke="black" points="50109.5,-851.18 50106,-841.18 50102.5,-851.18 50109.5,-851.18"/>
</g>
<!-- expert_s2_t3_g5_l12 -->
<g id="node812" class="node">
<title>expert_s2_t3_g5_l12</title>
<polygon fill="lightgreen" stroke="black" points="50235,-722.93 49977,-722.93 49977,-681.93 50235,-681.93 50235,-722.93"/>
<text text-anchor="middle" x="50106" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;12 GPU&#45;93</text>
<text text-anchor="middle" x="50106" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g5&#45;&gt;expert_s2_t3_g5_l12 -->
<g id="edge286" class="edge">
<title>gate_s2_t3_g5&#45;&gt;expert_s2_t3_g5_l12</title>
<path fill="none" stroke="black" d="M50106,-758.71C50106,-750.13 50106,-741.22 50106,-733.12"/>
<polygon fill="black" stroke="black" points="50109.5,-733.04 50106,-723.04 50102.5,-733.04 50109.5,-733.04"/>
</g>
<!-- comm_s2_t3_g5 -->
<g id="node863" class="node">
<title>comm_s2_t3_g5</title>
<ellipse fill="lightblue" stroke="black" cx="50106" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="50106" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;93</text>
<text text-anchor="middle" x="50106" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g5_l12&#45;&gt;comm_s2_t3_g5 -->
<g id="edge287" class="edge">
<title>expert_s2_t3_g5_l12&#45;&gt;comm_s2_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-681.64C50106,-674.02 50106,-665.03 50106,-656.24"/>
<polygon fill="black" stroke="black" points="50109.5,-656.12 50106,-646.12 50102.5,-656.12 50109.5,-656.12"/>
</g>
<!-- expert_s2_t3_g5_l13 -->
<g id="node813" class="node">
<title>expert_s2_t3_g5_l13</title>
<polygon fill="lightgreen" stroke="black" points="44928,-917.93 44670,-917.93 44670,-876.93 44928,-876.93 44928,-917.93"/>
<text text-anchor="middle" x="44799" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;13 GPU&#45;93</text>
<text text-anchor="middle" x="44799" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44799" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g5_l14 -->
<g id="node814" class="node">
<title>expert_s2_t3_g5_l14</title>
<polygon fill="lightgreen" stroke="black" points="44652,-917.93 44394,-917.93 44394,-876.93 44652,-876.93 44652,-917.93"/>
<text text-anchor="middle" x="44523" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;14 GPU&#45;93</text>
<text text-anchor="middle" x="44523" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44523" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g5_l15 -->
<g id="node815" class="node">
<title>expert_s2_t3_g5_l15</title>
<polygon fill="lightgreen" stroke="black" points="44376,-917.93 44118,-917.93 44118,-876.93 44376,-876.93 44376,-917.93"/>
<text text-anchor="middle" x="44247" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;15 GPU&#45;93</text>
<text text-anchor="middle" x="44247" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44247" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g5_l16 -->
<g id="node816" class="node">
<title>expert_s2_t3_g5_l16</title>
<polygon fill="lightgreen" stroke="black" points="44100,-917.93 43842,-917.93 43842,-876.93 44100,-876.93 44100,-917.93"/>
<text text-anchor="middle" x="43971" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;16 GPU&#45;93</text>
<text text-anchor="middle" x="43971" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43971" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g5_l17 -->
<g id="node817" class="node">
<title>expert_s2_t3_g5_l17</title>
<polygon fill="lightgreen" stroke="black" points="43824,-917.93 43566,-917.93 43566,-876.93 43824,-876.93 43824,-917.93"/>
<text text-anchor="middle" x="43695" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;93 Layer&#45;17 GPU&#45;93</text>
<text text-anchor="middle" x="43695" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43695" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g6 -->
<g id="node818" class="node">
<title>attn_s2_t3_g6</title>
<polygon fill="lightgreen" stroke="black" points="51917.5,-917.93 51642.5,-917.93 51642.5,-876.93 51917.5,-876.93 51917.5,-917.93"/>
<text text-anchor="middle" x="51780" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;94</text>
<text text-anchor="middle" x="51780" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g6 -->
<g id="node819" class="node">
<title>gate_s2_t3_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="52045.32,-840.93 51623.26,-840.93 51514.68,-758.93 51936.74,-758.93 52045.32,-840.93"/>
<text text-anchor="middle" x="51780" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;94</text>
<text text-anchor="middle" x="51780" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g6&#45;&gt;gate_s2_t3_g6 -->
<g id="edge288" class="edge">
<title>attn_s2_t3_g6&#45;&gt;gate_s2_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-876.64C51780,-869.18 51780,-860.31 51780,-851.32"/>
<polygon fill="black" stroke="black" points="51783.5,-851.18 51780,-841.18 51776.5,-851.18 51783.5,-851.18"/>
</g>
<!-- expert_s2_t3_g6_l12 -->
<g id="node820" class="node">
<title>expert_s2_t3_g6_l12</title>
<polygon fill="lightgreen" stroke="black" points="51909,-722.93 51651,-722.93 51651,-681.93 51909,-681.93 51909,-722.93"/>
<text text-anchor="middle" x="51780" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;12 GPU&#45;94</text>
<text text-anchor="middle" x="51780" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g6&#45;&gt;expert_s2_t3_g6_l12 -->
<g id="edge289" class="edge">
<title>gate_s2_t3_g6&#45;&gt;expert_s2_t3_g6_l12</title>
<path fill="none" stroke="black" d="M51780,-758.71C51780,-750.13 51780,-741.22 51780,-733.12"/>
<polygon fill="black" stroke="black" points="51783.5,-733.04 51780,-723.04 51776.5,-733.04 51783.5,-733.04"/>
</g>
<!-- comm_s2_t3_g6 -->
<g id="node864" class="node">
<title>comm_s2_t3_g6</title>
<ellipse fill="lightblue" stroke="black" cx="51780" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="51780" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;94</text>
<text text-anchor="middle" x="51780" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g6_l12&#45;&gt;comm_s2_t3_g6 -->
<g id="edge290" class="edge">
<title>expert_s2_t3_g6_l12&#45;&gt;comm_s2_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-681.64C51780,-674.02 51780,-665.03 51780,-656.24"/>
<polygon fill="black" stroke="black" points="51783.5,-656.12 51780,-646.12 51776.5,-656.12 51783.5,-656.12"/>
</g>
<!-- expert_s2_t3_g6_l13 -->
<g id="node821" class="node">
<title>expert_s2_t3_g6_l13</title>
<polygon fill="lightgreen" stroke="black" points="43254,-917.93 42996,-917.93 42996,-876.93 43254,-876.93 43254,-917.93"/>
<text text-anchor="middle" x="43125" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;13 GPU&#45;94</text>
<text text-anchor="middle" x="43125" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43125" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g6_l14 -->
<g id="node822" class="node">
<title>expert_s2_t3_g6_l14</title>
<polygon fill="lightgreen" stroke="black" points="42978,-917.93 42720,-917.93 42720,-876.93 42978,-876.93 42978,-917.93"/>
<text text-anchor="middle" x="42849" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;14 GPU&#45;94</text>
<text text-anchor="middle" x="42849" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42849" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g6_l15 -->
<g id="node823" class="node">
<title>expert_s2_t3_g6_l15</title>
<polygon fill="lightgreen" stroke="black" points="42702,-917.93 42444,-917.93 42444,-876.93 42702,-876.93 42702,-917.93"/>
<text text-anchor="middle" x="42573" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;15 GPU&#45;94</text>
<text text-anchor="middle" x="42573" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42573" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g6_l16 -->
<g id="node824" class="node">
<title>expert_s2_t3_g6_l16</title>
<polygon fill="lightgreen" stroke="black" points="42426,-917.93 42168,-917.93 42168,-876.93 42426,-876.93 42426,-917.93"/>
<text text-anchor="middle" x="42297" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;16 GPU&#45;94</text>
<text text-anchor="middle" x="42297" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42297" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g6_l17 -->
<g id="node825" class="node">
<title>expert_s2_t3_g6_l17</title>
<polygon fill="lightgreen" stroke="black" points="42150,-917.93 41892,-917.93 41892,-876.93 42150,-876.93 42150,-917.93"/>
<text text-anchor="middle" x="42021" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;94 Layer&#45;17 GPU&#45;94</text>
<text text-anchor="middle" x="42021" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42021" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s2_t3_g7 -->
<g id="node826" class="node">
<title>attn_s2_t3_g7</title>
<polygon fill="lightgreen" stroke="black" points="53591.5,-917.93 53316.5,-917.93 53316.5,-876.93 53591.5,-876.93 53591.5,-917.93"/>
<text text-anchor="middle" x="53454" y="-905.93" font-family="Arial" font-size="10.00">Attention GPU&#45;95</text>
<text text-anchor="middle" x="53454" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53454" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s2_t3_g7 -->
<g id="node827" class="node">
<title>gate_s2_t3_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="53592.32,-840.93 53170.26,-840.93 53061.68,-758.93 53483.74,-758.93 53592.32,-840.93"/>
<text text-anchor="middle" x="53327" y="-808.43" font-family="Arial" font-size="10.00">Gate GPU&#45;95</text>
<text text-anchor="middle" x="53327" y="-797.43" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-786.43" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s2_t3_g7&#45;&gt;gate_s2_t3_g7 -->
<g id="edge291" class="edge">
<title>attn_s2_t3_g7&#45;&gt;gate_s2_t3_g7</title>
<path fill="none" stroke="black" d="M53427.99,-876.87C53416.47,-868.21 53402.37,-857.61 53388.41,-847.11"/>
<polygon fill="black" stroke="black" points="53390.33,-844.17 53380.23,-840.96 53386.12,-849.77 53390.33,-844.17"/>
</g>
<!-- expert_s2_t3_g7_l12 -->
<g id="node828" class="node">
<title>expert_s2_t3_g7_l12</title>
<polygon fill="lightgreen" stroke="black" points="53456,-722.93 53198,-722.93 53198,-681.93 53456,-681.93 53456,-722.93"/>
<text text-anchor="middle" x="53327" y="-710.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;12 GPU&#45;95</text>
<text text-anchor="middle" x="53327" y="-699.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-688.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s2_t3_g7&#45;&gt;expert_s2_t3_g7_l12 -->
<g id="edge292" class="edge">
<title>gate_s2_t3_g7&#45;&gt;expert_s2_t3_g7_l12</title>
<path fill="none" stroke="black" d="M53327,-758.71C53327,-750.13 53327,-741.22 53327,-733.12"/>
<polygon fill="black" stroke="black" points="53330.5,-733.04 53327,-723.04 53323.5,-733.04 53330.5,-733.04"/>
</g>
<!-- comm_s2_t3_g7 -->
<g id="node865" class="node">
<title>comm_s2_t3_g7</title>
<ellipse fill="lightblue" stroke="black" cx="53327" cy="-616.94" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="53327" y="-625.44" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;95</text>
<text text-anchor="middle" x="53327" y="-614.44" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53327" y="-603.44" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s2_t3_g7_l12&#45;&gt;comm_s2_t3_g7 -->
<g id="edge293" class="edge">
<title>expert_s2_t3_g7_l12&#45;&gt;comm_s2_t3_g7</title>
<path fill="none" stroke="black" d="M53327,-681.64C53327,-674.02 53327,-665.03 53327,-656.24"/>
<polygon fill="black" stroke="black" points="53330.5,-656.12 53327,-646.12 53323.5,-656.12 53330.5,-656.12"/>
</g>
<!-- expert_s2_t3_g7_l13 -->
<g id="node829" class="node">
<title>expert_s2_t3_g7_l13</title>
<polygon fill="lightgreen" stroke="black" points="41580,-917.93 41322,-917.93 41322,-876.93 41580,-876.93 41580,-917.93"/>
<text text-anchor="middle" x="41451" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;13 GPU&#45;95</text>
<text text-anchor="middle" x="41451" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41451" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g7_l14 -->
<g id="node830" class="node">
<title>expert_s2_t3_g7_l14</title>
<polygon fill="lightgreen" stroke="black" points="41304,-917.93 41046,-917.93 41046,-876.93 41304,-876.93 41304,-917.93"/>
<text text-anchor="middle" x="41175" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;14 GPU&#45;95</text>
<text text-anchor="middle" x="41175" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41175" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g7_l15 -->
<g id="node831" class="node">
<title>expert_s2_t3_g7_l15</title>
<polygon fill="lightgreen" stroke="black" points="41028,-917.93 40770,-917.93 40770,-876.93 41028,-876.93 41028,-917.93"/>
<text text-anchor="middle" x="40899" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;15 GPU&#45;95</text>
<text text-anchor="middle" x="40899" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40899" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g7_l16 -->
<g id="node832" class="node">
<title>expert_s2_t3_g7_l16</title>
<polygon fill="lightgreen" stroke="black" points="40752,-917.93 40494,-917.93 40494,-876.93 40752,-876.93 40752,-917.93"/>
<text text-anchor="middle" x="40623" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;16 GPU&#45;95</text>
<text text-anchor="middle" x="40623" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40623" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s2_t3_g7_l17 -->
<g id="node833" class="node">
<title>expert_s2_t3_g7_l17</title>
<polygon fill="lightgreen" stroke="black" points="40476,-917.93 40218,-917.93 40218,-876.93 40476,-876.93 40476,-917.93"/>
<text text-anchor="middle" x="40347" y="-905.93" font-family="Arial" font-size="10.00">Expert&#45;95 Layer&#45;17 GPU&#45;95</text>
<text text-anchor="middle" x="40347" y="-894.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40347" y="-883.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- pipeline_comm_s2 -->
<g id="node1156" class="node">
<title>pipeline_comm_s2</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-522.96" rx="185.94" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-531.46" font-family="Arial" font-size="10.00">Pipeline Communication Stage 2&#45;&gt;3</text>
<text text-anchor="middle" x="1542" y="-520.46" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, d_model=4096]</text>
<text text-anchor="middle" x="1542" y="-509.46" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, d_model=4096]</text>
</g>
<!-- comm_s2_t0_g0&#45;&gt;pipeline_comm_s2 -->
<g id="edge294" class="edge">
<title>comm_s2_t0_g0&#45;&gt;pipeline_comm_s2</title>
<path fill="none" stroke="black" d="M1542,-587.84C1542,-579.8 1542,-570.9 1542,-562.36"/>
<polygon fill="black" stroke="black" points="1545.5,-562.2 1542,-552.2 1538.5,-562.2 1545.5,-562.2"/>
</g>
<!-- attn_s3_t0_g0 -->
<g id="node866" class="node">
<title>attn_s3_t0_g0</title>
<polygon fill="lightgreen" stroke="black" points="1679.5,-423.97 1404.5,-423.97 1404.5,-382.97 1679.5,-382.97 1679.5,-423.97"/>
<text text-anchor="middle" x="1542" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;96</text>
<text text-anchor="middle" x="1542" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g0 -->
<g id="node867" class="node">
<title>gate_s3_t0_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="1807.32,-346.97 1385.26,-346.97 1276.68,-264.97 1698.74,-264.97 1807.32,-346.97"/>
<text text-anchor="middle" x="1542" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;96</text>
<text text-anchor="middle" x="1542" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g0&#45;&gt;gate_s3_t0_g0 -->
<g id="edge296" class="edge">
<title>attn_s3_t0_g0&#45;&gt;gate_s3_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-382.68C1542,-375.22 1542,-366.35 1542,-357.35"/>
<polygon fill="black" stroke="black" points="1545.5,-357.21 1542,-347.21 1538.5,-357.21 1545.5,-357.21"/>
</g>
<!-- expert_s3_t0_g0_l18 -->
<g id="node868" class="node">
<title>expert_s3_t0_g0_l18</title>
<polygon fill="lightgreen" stroke="black" points="1671,-228.97 1413,-228.97 1413,-187.97 1671,-187.97 1671,-228.97"/>
<text text-anchor="middle" x="1542" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;18 GPU&#45;96</text>
<text text-anchor="middle" x="1542" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1542" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g0&#45;&gt;expert_s3_t0_g0_l18 -->
<g id="edge297" class="edge">
<title>gate_s3_t0_g0&#45;&gt;expert_s3_t0_g0_l18</title>
<path fill="none" stroke="black" d="M1542,-264.74C1542,-256.16 1542,-247.25 1542,-239.16"/>
<polygon fill="black" stroke="black" points="1545.5,-239.08 1542,-229.08 1538.5,-239.08 1545.5,-239.08"/>
</g>
<!-- comm_s3_t0_g0 -->
<g id="node1122" class="node">
<title>comm_s3_t0_g0</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;96</text>
<text text-anchor="middle" x="1542" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g0_l18&#45;&gt;comm_s3_t0_g0 -->
<g id="edge298" class="edge">
<title>expert_s3_t0_g0_l18&#45;&gt;comm_s3_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-187.68C1542,-180.05 1542,-171.06 1542,-162.28"/>
<polygon fill="black" stroke="black" points="1545.5,-162.15 1542,-152.15 1538.5,-162.15 1545.5,-162.15"/>
</g>
<!-- expert_s3_t0_g0_l19 -->
<g id="node869" class="node">
<title>expert_s3_t0_g0_l19</title>
<polygon fill="lightgreen" stroke="black" points="13104,-423.97 12846,-423.97 12846,-382.97 13104,-382.97 13104,-423.97"/>
<text text-anchor="middle" x="12975" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;19 GPU&#45;96</text>
<text text-anchor="middle" x="12975" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12975" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g0_l20 -->
<g id="node870" class="node">
<title>expert_s3_t0_g0_l20</title>
<polygon fill="lightgreen" stroke="black" points="12828,-423.97 12570,-423.97 12570,-382.97 12828,-382.97 12828,-423.97"/>
<text text-anchor="middle" x="12699" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;20 GPU&#45;96</text>
<text text-anchor="middle" x="12699" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12699" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g0_l21 -->
<g id="node871" class="node">
<title>expert_s3_t0_g0_l21</title>
<polygon fill="lightgreen" stroke="black" points="12552,-423.97 12294,-423.97 12294,-382.97 12552,-382.97 12552,-423.97"/>
<text text-anchor="middle" x="12423" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;21 GPU&#45;96</text>
<text text-anchor="middle" x="12423" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12423" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g0_l22 -->
<g id="node872" class="node">
<title>expert_s3_t0_g0_l22</title>
<polygon fill="lightgreen" stroke="black" points="12276,-423.97 12018,-423.97 12018,-382.97 12276,-382.97 12276,-423.97"/>
<text text-anchor="middle" x="12147" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;22 GPU&#45;96</text>
<text text-anchor="middle" x="12147" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="12147" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g0_l23 -->
<g id="node873" class="node">
<title>expert_s3_t0_g0_l23</title>
<polygon fill="lightgreen" stroke="black" points="12000,-423.97 11742,-423.97 11742,-382.97 12000,-382.97 12000,-423.97"/>
<text text-anchor="middle" x="11871" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;96 Layer&#45;23 GPU&#45;96</text>
<text text-anchor="middle" x="11871" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11871" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g1 -->
<g id="node874" class="node">
<title>attn_s3_t0_g1</title>
<polygon fill="lightgreen" stroke="black" points="3353.5,-423.97 3078.5,-423.97 3078.5,-382.97 3353.5,-382.97 3353.5,-423.97"/>
<text text-anchor="middle" x="3216" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;97</text>
<text text-anchor="middle" x="3216" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g1 -->
<g id="node875" class="node">
<title>gate_s3_t0_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="3481.32,-346.97 3059.26,-346.97 2950.68,-264.97 3372.74,-264.97 3481.32,-346.97"/>
<text text-anchor="middle" x="3216" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;97</text>
<text text-anchor="middle" x="3216" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g1&#45;&gt;gate_s3_t0_g1 -->
<g id="edge299" class="edge">
<title>attn_s3_t0_g1&#45;&gt;gate_s3_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-382.68C3216,-375.22 3216,-366.35 3216,-357.35"/>
<polygon fill="black" stroke="black" points="3219.5,-357.21 3216,-347.21 3212.5,-357.21 3219.5,-357.21"/>
</g>
<!-- expert_s3_t0_g1_l18 -->
<g id="node876" class="node">
<title>expert_s3_t0_g1_l18</title>
<polygon fill="lightgreen" stroke="black" points="3345,-228.97 3087,-228.97 3087,-187.97 3345,-187.97 3345,-228.97"/>
<text text-anchor="middle" x="3216" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;18 GPU&#45;97</text>
<text text-anchor="middle" x="3216" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3216" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g1&#45;&gt;expert_s3_t0_g1_l18 -->
<g id="edge300" class="edge">
<title>gate_s3_t0_g1&#45;&gt;expert_s3_t0_g1_l18</title>
<path fill="none" stroke="black" d="M3216,-264.74C3216,-256.16 3216,-247.25 3216,-239.16"/>
<polygon fill="black" stroke="black" points="3219.5,-239.08 3216,-229.08 3212.5,-239.08 3219.5,-239.08"/>
</g>
<!-- comm_s3_t0_g1 -->
<g id="node1123" class="node">
<title>comm_s3_t0_g1</title>
<ellipse fill="lightblue" stroke="black" cx="3216" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="3216" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;97</text>
<text text-anchor="middle" x="3216" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="3216" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g1_l18&#45;&gt;comm_s3_t0_g1 -->
<g id="edge301" class="edge">
<title>expert_s3_t0_g1_l18&#45;&gt;comm_s3_t0_g1</title>
<path fill="none" stroke="black" d="M3216,-187.68C3216,-180.05 3216,-171.06 3216,-162.28"/>
<polygon fill="black" stroke="black" points="3219.5,-162.15 3216,-152.15 3212.5,-162.15 3219.5,-162.15"/>
</g>
<!-- expert_s3_t0_g1_l19 -->
<g id="node877" class="node">
<title>expert_s3_t0_g1_l19</title>
<polygon fill="lightgreen" stroke="black" points="11430,-423.97 11172,-423.97 11172,-382.97 11430,-382.97 11430,-423.97"/>
<text text-anchor="middle" x="11301" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;19 GPU&#45;97</text>
<text text-anchor="middle" x="11301" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11301" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g1_l20 -->
<g id="node878" class="node">
<title>expert_s3_t0_g1_l20</title>
<polygon fill="lightgreen" stroke="black" points="11154,-423.97 10896,-423.97 10896,-382.97 11154,-382.97 11154,-423.97"/>
<text text-anchor="middle" x="11025" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;20 GPU&#45;97</text>
<text text-anchor="middle" x="11025" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11025" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g1_l21 -->
<g id="node879" class="node">
<title>expert_s3_t0_g1_l21</title>
<polygon fill="lightgreen" stroke="black" points="10878,-423.97 10620,-423.97 10620,-382.97 10878,-382.97 10878,-423.97"/>
<text text-anchor="middle" x="10749" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;21 GPU&#45;97</text>
<text text-anchor="middle" x="10749" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10749" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g1_l22 -->
<g id="node880" class="node">
<title>expert_s3_t0_g1_l22</title>
<polygon fill="lightgreen" stroke="black" points="10602,-423.97 10344,-423.97 10344,-382.97 10602,-382.97 10602,-423.97"/>
<text text-anchor="middle" x="10473" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;22 GPU&#45;97</text>
<text text-anchor="middle" x="10473" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10473" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g1_l23 -->
<g id="node881" class="node">
<title>expert_s3_t0_g1_l23</title>
<polygon fill="lightgreen" stroke="black" points="10326,-423.97 10068,-423.97 10068,-382.97 10326,-382.97 10326,-423.97"/>
<text text-anchor="middle" x="10197" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;97 Layer&#45;23 GPU&#45;97</text>
<text text-anchor="middle" x="10197" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="10197" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g2 -->
<g id="node882" class="node">
<title>attn_s3_t0_g2</title>
<polygon fill="lightgreen" stroke="black" points="5027.5,-423.97 4752.5,-423.97 4752.5,-382.97 5027.5,-382.97 5027.5,-423.97"/>
<text text-anchor="middle" x="4890" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;98</text>
<text text-anchor="middle" x="4890" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g2 -->
<g id="node883" class="node">
<title>gate_s3_t0_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="5155.32,-346.97 4733.26,-346.97 4624.68,-264.97 5046.74,-264.97 5155.32,-346.97"/>
<text text-anchor="middle" x="4890" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;98</text>
<text text-anchor="middle" x="4890" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g2&#45;&gt;gate_s3_t0_g2 -->
<g id="edge302" class="edge">
<title>attn_s3_t0_g2&#45;&gt;gate_s3_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-382.68C4890,-375.22 4890,-366.35 4890,-357.35"/>
<polygon fill="black" stroke="black" points="4893.5,-357.21 4890,-347.21 4886.5,-357.21 4893.5,-357.21"/>
</g>
<!-- expert_s3_t0_g2_l18 -->
<g id="node884" class="node">
<title>expert_s3_t0_g2_l18</title>
<polygon fill="lightgreen" stroke="black" points="5019,-228.97 4761,-228.97 4761,-187.97 5019,-187.97 5019,-228.97"/>
<text text-anchor="middle" x="4890" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;18 GPU&#45;98</text>
<text text-anchor="middle" x="4890" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4890" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g2&#45;&gt;expert_s3_t0_g2_l18 -->
<g id="edge303" class="edge">
<title>gate_s3_t0_g2&#45;&gt;expert_s3_t0_g2_l18</title>
<path fill="none" stroke="black" d="M4890,-264.74C4890,-256.16 4890,-247.25 4890,-239.16"/>
<polygon fill="black" stroke="black" points="4893.5,-239.08 4890,-229.08 4886.5,-239.08 4893.5,-239.08"/>
</g>
<!-- comm_s3_t0_g2 -->
<g id="node1124" class="node">
<title>comm_s3_t0_g2</title>
<ellipse fill="lightblue" stroke="black" cx="4890" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="4890" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;98</text>
<text text-anchor="middle" x="4890" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4890" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g2_l18&#45;&gt;comm_s3_t0_g2 -->
<g id="edge304" class="edge">
<title>expert_s3_t0_g2_l18&#45;&gt;comm_s3_t0_g2</title>
<path fill="none" stroke="black" d="M4890,-187.68C4890,-180.05 4890,-171.06 4890,-162.28"/>
<polygon fill="black" stroke="black" points="4893.5,-162.15 4890,-152.15 4886.5,-162.15 4893.5,-162.15"/>
</g>
<!-- expert_s3_t0_g2_l19 -->
<g id="node885" class="node">
<title>expert_s3_t0_g2_l19</title>
<polygon fill="lightgreen" stroke="black" points="9756,-423.97 9498,-423.97 9498,-382.97 9756,-382.97 9756,-423.97"/>
<text text-anchor="middle" x="9627" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;19 GPU&#45;98</text>
<text text-anchor="middle" x="9627" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9627" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g2_l20 -->
<g id="node886" class="node">
<title>expert_s3_t0_g2_l20</title>
<polygon fill="lightgreen" stroke="black" points="9480,-423.97 9222,-423.97 9222,-382.97 9480,-382.97 9480,-423.97"/>
<text text-anchor="middle" x="9351" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;20 GPU&#45;98</text>
<text text-anchor="middle" x="9351" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9351" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g2_l21 -->
<g id="node887" class="node">
<title>expert_s3_t0_g2_l21</title>
<polygon fill="lightgreen" stroke="black" points="9204,-423.97 8946,-423.97 8946,-382.97 9204,-382.97 9204,-423.97"/>
<text text-anchor="middle" x="9075" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;21 GPU&#45;98</text>
<text text-anchor="middle" x="9075" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9075" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g2_l22 -->
<g id="node888" class="node">
<title>expert_s3_t0_g2_l22</title>
<polygon fill="lightgreen" stroke="black" points="8928,-423.97 8670,-423.97 8670,-382.97 8928,-382.97 8928,-423.97"/>
<text text-anchor="middle" x="8799" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;22 GPU&#45;98</text>
<text text-anchor="middle" x="8799" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8799" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g2_l23 -->
<g id="node889" class="node">
<title>expert_s3_t0_g2_l23</title>
<polygon fill="lightgreen" stroke="black" points="8652,-423.97 8394,-423.97 8394,-382.97 8652,-382.97 8652,-423.97"/>
<text text-anchor="middle" x="8523" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;98 Layer&#45;23 GPU&#45;98</text>
<text text-anchor="middle" x="8523" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8523" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g3 -->
<g id="node890" class="node">
<title>attn_s3_t0_g3</title>
<polygon fill="lightgreen" stroke="black" points="6701.5,-423.97 6426.5,-423.97 6426.5,-382.97 6701.5,-382.97 6701.5,-423.97"/>
<text text-anchor="middle" x="6564" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;99</text>
<text text-anchor="middle" x="6564" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g3 -->
<g id="node891" class="node">
<title>gate_s3_t0_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="6829.32,-346.97 6407.26,-346.97 6298.68,-264.97 6720.74,-264.97 6829.32,-346.97"/>
<text text-anchor="middle" x="6564" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;99</text>
<text text-anchor="middle" x="6564" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g3&#45;&gt;gate_s3_t0_g3 -->
<g id="edge305" class="edge">
<title>attn_s3_t0_g3&#45;&gt;gate_s3_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-382.68C6564,-375.22 6564,-366.35 6564,-357.35"/>
<polygon fill="black" stroke="black" points="6567.5,-357.21 6564,-347.21 6560.5,-357.21 6567.5,-357.21"/>
</g>
<!-- expert_s3_t0_g3_l18 -->
<g id="node892" class="node">
<title>expert_s3_t0_g3_l18</title>
<polygon fill="lightgreen" stroke="black" points="6693,-228.97 6435,-228.97 6435,-187.97 6693,-187.97 6693,-228.97"/>
<text text-anchor="middle" x="6564" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;18 GPU&#45;99</text>
<text text-anchor="middle" x="6564" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6564" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g3&#45;&gt;expert_s3_t0_g3_l18 -->
<g id="edge306" class="edge">
<title>gate_s3_t0_g3&#45;&gt;expert_s3_t0_g3_l18</title>
<path fill="none" stroke="black" d="M6564,-264.74C6564,-256.16 6564,-247.25 6564,-239.16"/>
<polygon fill="black" stroke="black" points="6567.5,-239.08 6564,-229.08 6560.5,-239.08 6567.5,-239.08"/>
</g>
<!-- comm_s3_t0_g3 -->
<g id="node1125" class="node">
<title>comm_s3_t0_g3</title>
<ellipse fill="lightblue" stroke="black" cx="6564" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="6564" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;99</text>
<text text-anchor="middle" x="6564" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="6564" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g3_l18&#45;&gt;comm_s3_t0_g3 -->
<g id="edge307" class="edge">
<title>expert_s3_t0_g3_l18&#45;&gt;comm_s3_t0_g3</title>
<path fill="none" stroke="black" d="M6564,-187.68C6564,-180.05 6564,-171.06 6564,-162.28"/>
<polygon fill="black" stroke="black" points="6567.5,-162.15 6564,-152.15 6560.5,-162.15 6567.5,-162.15"/>
</g>
<!-- expert_s3_t0_g3_l19 -->
<g id="node893" class="node">
<title>expert_s3_t0_g3_l19</title>
<polygon fill="lightgreen" stroke="black" points="8082,-423.97 7824,-423.97 7824,-382.97 8082,-382.97 8082,-423.97"/>
<text text-anchor="middle" x="7953" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;19 GPU&#45;99</text>
<text text-anchor="middle" x="7953" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7953" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g3_l20 -->
<g id="node894" class="node">
<title>expert_s3_t0_g3_l20</title>
<polygon fill="lightgreen" stroke="black" points="7806,-423.97 7548,-423.97 7548,-382.97 7806,-382.97 7806,-423.97"/>
<text text-anchor="middle" x="7677" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;20 GPU&#45;99</text>
<text text-anchor="middle" x="7677" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7677" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g3_l21 -->
<g id="node895" class="node">
<title>expert_s3_t0_g3_l21</title>
<polygon fill="lightgreen" stroke="black" points="7530,-423.97 7272,-423.97 7272,-382.97 7530,-382.97 7530,-423.97"/>
<text text-anchor="middle" x="7401" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;21 GPU&#45;99</text>
<text text-anchor="middle" x="7401" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7401" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g3_l22 -->
<g id="node896" class="node">
<title>expert_s3_t0_g3_l22</title>
<polygon fill="lightgreen" stroke="black" points="7254,-423.97 6996,-423.97 6996,-382.97 7254,-382.97 7254,-423.97"/>
<text text-anchor="middle" x="7125" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;22 GPU&#45;99</text>
<text text-anchor="middle" x="7125" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="7125" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g3_l23 -->
<g id="node897" class="node">
<title>expert_s3_t0_g3_l23</title>
<polygon fill="lightgreen" stroke="black" points="6978,-423.97 6720,-423.97 6720,-382.97 6978,-382.97 6978,-423.97"/>
<text text-anchor="middle" x="6849" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;99 Layer&#45;23 GPU&#45;99</text>
<text text-anchor="middle" x="6849" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6849" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g4 -->
<g id="node898" class="node">
<title>attn_s3_t0_g4</title>
<polygon fill="lightgreen" stroke="black" points="8375.5,-423.97 8100.5,-423.97 8100.5,-382.97 8375.5,-382.97 8375.5,-423.97"/>
<text text-anchor="middle" x="8238" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;100</text>
<text text-anchor="middle" x="8238" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g4 -->
<g id="node899" class="node">
<title>gate_s3_t0_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="8503.32,-346.97 8081.26,-346.97 7972.68,-264.97 8394.74,-264.97 8503.32,-346.97"/>
<text text-anchor="middle" x="8238" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;100</text>
<text text-anchor="middle" x="8238" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g4&#45;&gt;gate_s3_t0_g4 -->
<g id="edge308" class="edge">
<title>attn_s3_t0_g4&#45;&gt;gate_s3_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-382.68C8238,-375.22 8238,-366.35 8238,-357.35"/>
<polygon fill="black" stroke="black" points="8241.5,-357.21 8238,-347.21 8234.5,-357.21 8241.5,-357.21"/>
</g>
<!-- expert_s3_t0_g4_l18 -->
<g id="node900" class="node">
<title>expert_s3_t0_g4_l18</title>
<polygon fill="lightgreen" stroke="black" points="8367,-228.97 8109,-228.97 8109,-187.97 8367,-187.97 8367,-228.97"/>
<text text-anchor="middle" x="8238" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;18 GPU&#45;100</text>
<text text-anchor="middle" x="8238" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="8238" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g4&#45;&gt;expert_s3_t0_g4_l18 -->
<g id="edge309" class="edge">
<title>gate_s3_t0_g4&#45;&gt;expert_s3_t0_g4_l18</title>
<path fill="none" stroke="black" d="M8238,-264.74C8238,-256.16 8238,-247.25 8238,-239.16"/>
<polygon fill="black" stroke="black" points="8241.5,-239.08 8238,-229.08 8234.5,-239.08 8241.5,-239.08"/>
</g>
<!-- comm_s3_t0_g4 -->
<g id="node1126" class="node">
<title>comm_s3_t0_g4</title>
<ellipse fill="lightblue" stroke="black" cx="8238" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="8238" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;100</text>
<text text-anchor="middle" x="8238" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="8238" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g4_l18&#45;&gt;comm_s3_t0_g4 -->
<g id="edge310" class="edge">
<title>expert_s3_t0_g4_l18&#45;&gt;comm_s3_t0_g4</title>
<path fill="none" stroke="black" d="M8238,-187.68C8238,-180.05 8238,-171.06 8238,-162.28"/>
<polygon fill="black" stroke="black" points="8241.5,-162.15 8238,-152.15 8234.5,-162.15 8241.5,-162.15"/>
</g>
<!-- expert_s3_t0_g4_l19 -->
<g id="node901" class="node">
<title>expert_s3_t0_g4_l19</title>
<polygon fill="lightgreen" stroke="black" points="6408,-423.97 6150,-423.97 6150,-382.97 6408,-382.97 6408,-423.97"/>
<text text-anchor="middle" x="6279" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;19 GPU&#45;100</text>
<text text-anchor="middle" x="6279" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6279" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g4_l20 -->
<g id="node902" class="node">
<title>expert_s3_t0_g4_l20</title>
<polygon fill="lightgreen" stroke="black" points="6132,-423.97 5874,-423.97 5874,-382.97 6132,-382.97 6132,-423.97"/>
<text text-anchor="middle" x="6003" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;20 GPU&#45;100</text>
<text text-anchor="middle" x="6003" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="6003" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g4_l21 -->
<g id="node903" class="node">
<title>expert_s3_t0_g4_l21</title>
<polygon fill="lightgreen" stroke="black" points="5856,-423.97 5598,-423.97 5598,-382.97 5856,-382.97 5856,-423.97"/>
<text text-anchor="middle" x="5727" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;21 GPU&#45;100</text>
<text text-anchor="middle" x="5727" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5727" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g4_l22 -->
<g id="node904" class="node">
<title>expert_s3_t0_g4_l22</title>
<polygon fill="lightgreen" stroke="black" points="5580,-423.97 5322,-423.97 5322,-382.97 5580,-382.97 5580,-423.97"/>
<text text-anchor="middle" x="5451" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;22 GPU&#45;100</text>
<text text-anchor="middle" x="5451" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5451" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g4_l23 -->
<g id="node905" class="node">
<title>expert_s3_t0_g4_l23</title>
<polygon fill="lightgreen" stroke="black" points="5304,-423.97 5046,-423.97 5046,-382.97 5304,-382.97 5304,-423.97"/>
<text text-anchor="middle" x="5175" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;100 Layer&#45;23 GPU&#45;100</text>
<text text-anchor="middle" x="5175" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="5175" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g5 -->
<g id="node906" class="node">
<title>attn_s3_t0_g5</title>
<polygon fill="lightgreen" stroke="black" points="10049.5,-423.97 9774.5,-423.97 9774.5,-382.97 10049.5,-382.97 10049.5,-423.97"/>
<text text-anchor="middle" x="9912" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;101</text>
<text text-anchor="middle" x="9912" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g5 -->
<g id="node907" class="node">
<title>gate_s3_t0_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="10177.32,-346.97 9755.26,-346.97 9646.68,-264.97 10068.74,-264.97 10177.32,-346.97"/>
<text text-anchor="middle" x="9912" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;101</text>
<text text-anchor="middle" x="9912" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g5&#45;&gt;gate_s3_t0_g5 -->
<g id="edge311" class="edge">
<title>attn_s3_t0_g5&#45;&gt;gate_s3_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-382.68C9912,-375.22 9912,-366.35 9912,-357.35"/>
<polygon fill="black" stroke="black" points="9915.5,-357.21 9912,-347.21 9908.5,-357.21 9915.5,-357.21"/>
</g>
<!-- expert_s3_t0_g5_l18 -->
<g id="node908" class="node">
<title>expert_s3_t0_g5_l18</title>
<polygon fill="lightgreen" stroke="black" points="10041,-228.97 9783,-228.97 9783,-187.97 10041,-187.97 10041,-228.97"/>
<text text-anchor="middle" x="9912" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;18 GPU&#45;101</text>
<text text-anchor="middle" x="9912" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="9912" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g5&#45;&gt;expert_s3_t0_g5_l18 -->
<g id="edge312" class="edge">
<title>gate_s3_t0_g5&#45;&gt;expert_s3_t0_g5_l18</title>
<path fill="none" stroke="black" d="M9912,-264.74C9912,-256.16 9912,-247.25 9912,-239.16"/>
<polygon fill="black" stroke="black" points="9915.5,-239.08 9912,-229.08 9908.5,-239.08 9915.5,-239.08"/>
</g>
<!-- comm_s3_t0_g5 -->
<g id="node1127" class="node">
<title>comm_s3_t0_g5</title>
<ellipse fill="lightblue" stroke="black" cx="9912" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="9912" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;101</text>
<text text-anchor="middle" x="9912" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="9912" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g5_l18&#45;&gt;comm_s3_t0_g5 -->
<g id="edge313" class="edge">
<title>expert_s3_t0_g5_l18&#45;&gt;comm_s3_t0_g5</title>
<path fill="none" stroke="black" d="M9912,-187.68C9912,-180.05 9912,-171.06 9912,-162.28"/>
<polygon fill="black" stroke="black" points="9915.5,-162.15 9912,-152.15 9908.5,-162.15 9915.5,-162.15"/>
</g>
<!-- expert_s3_t0_g5_l19 -->
<g id="node909" class="node">
<title>expert_s3_t0_g5_l19</title>
<polygon fill="lightgreen" stroke="black" points="4734,-423.97 4476,-423.97 4476,-382.97 4734,-382.97 4734,-423.97"/>
<text text-anchor="middle" x="4605" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;19 GPU&#45;101</text>
<text text-anchor="middle" x="4605" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4605" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g5_l20 -->
<g id="node910" class="node">
<title>expert_s3_t0_g5_l20</title>
<polygon fill="lightgreen" stroke="black" points="4458,-423.97 4200,-423.97 4200,-382.97 4458,-382.97 4458,-423.97"/>
<text text-anchor="middle" x="4329" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;20 GPU&#45;101</text>
<text text-anchor="middle" x="4329" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4329" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g5_l21 -->
<g id="node911" class="node">
<title>expert_s3_t0_g5_l21</title>
<polygon fill="lightgreen" stroke="black" points="4182,-423.97 3924,-423.97 3924,-382.97 4182,-382.97 4182,-423.97"/>
<text text-anchor="middle" x="4053" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;21 GPU&#45;101</text>
<text text-anchor="middle" x="4053" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="4053" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g5_l22 -->
<g id="node912" class="node">
<title>expert_s3_t0_g5_l22</title>
<polygon fill="lightgreen" stroke="black" points="3906,-423.97 3648,-423.97 3648,-382.97 3906,-382.97 3906,-423.97"/>
<text text-anchor="middle" x="3777" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;22 GPU&#45;101</text>
<text text-anchor="middle" x="3777" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3777" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g5_l23 -->
<g id="node913" class="node">
<title>expert_s3_t0_g5_l23</title>
<polygon fill="lightgreen" stroke="black" points="3630,-423.97 3372,-423.97 3372,-382.97 3630,-382.97 3630,-423.97"/>
<text text-anchor="middle" x="3501" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;101 Layer&#45;23 GPU&#45;101</text>
<text text-anchor="middle" x="3501" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="3501" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g6 -->
<g id="node914" class="node">
<title>attn_s3_t0_g6</title>
<polygon fill="lightgreen" stroke="black" points="11723.5,-423.97 11448.5,-423.97 11448.5,-382.97 11723.5,-382.97 11723.5,-423.97"/>
<text text-anchor="middle" x="11586" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;102</text>
<text text-anchor="middle" x="11586" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g6 -->
<g id="node915" class="node">
<title>gate_s3_t0_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="11851.32,-346.97 11429.26,-346.97 11320.68,-264.97 11742.74,-264.97 11851.32,-346.97"/>
<text text-anchor="middle" x="11586" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;102</text>
<text text-anchor="middle" x="11586" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g6&#45;&gt;gate_s3_t0_g6 -->
<g id="edge314" class="edge">
<title>attn_s3_t0_g6&#45;&gt;gate_s3_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-382.68C11586,-375.22 11586,-366.35 11586,-357.35"/>
<polygon fill="black" stroke="black" points="11589.5,-357.21 11586,-347.21 11582.5,-357.21 11589.5,-357.21"/>
</g>
<!-- expert_s3_t0_g6_l18 -->
<g id="node916" class="node">
<title>expert_s3_t0_g6_l18</title>
<polygon fill="lightgreen" stroke="black" points="11715,-228.97 11457,-228.97 11457,-187.97 11715,-187.97 11715,-228.97"/>
<text text-anchor="middle" x="11586" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;18 GPU&#45;102</text>
<text text-anchor="middle" x="11586" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="11586" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g6&#45;&gt;expert_s3_t0_g6_l18 -->
<g id="edge315" class="edge">
<title>gate_s3_t0_g6&#45;&gt;expert_s3_t0_g6_l18</title>
<path fill="none" stroke="black" d="M11586,-264.74C11586,-256.16 11586,-247.25 11586,-239.16"/>
<polygon fill="black" stroke="black" points="11589.5,-239.08 11586,-229.08 11582.5,-239.08 11589.5,-239.08"/>
</g>
<!-- comm_s3_t0_g6 -->
<g id="node1128" class="node">
<title>comm_s3_t0_g6</title>
<ellipse fill="lightblue" stroke="black" cx="11586" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="11586" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;102</text>
<text text-anchor="middle" x="11586" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="11586" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g6_l18&#45;&gt;comm_s3_t0_g6 -->
<g id="edge316" class="edge">
<title>expert_s3_t0_g6_l18&#45;&gt;comm_s3_t0_g6</title>
<path fill="none" stroke="black" d="M11586,-187.68C11586,-180.05 11586,-171.06 11586,-162.28"/>
<polygon fill="black" stroke="black" points="11589.5,-162.15 11586,-152.15 11582.5,-162.15 11589.5,-162.15"/>
</g>
<!-- expert_s3_t0_g6_l19 -->
<g id="node917" class="node">
<title>expert_s3_t0_g6_l19</title>
<polygon fill="lightgreen" stroke="black" points="3060,-423.97 2802,-423.97 2802,-382.97 3060,-382.97 3060,-423.97"/>
<text text-anchor="middle" x="2931" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;19 GPU&#45;102</text>
<text text-anchor="middle" x="2931" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2931" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g6_l20 -->
<g id="node918" class="node">
<title>expert_s3_t0_g6_l20</title>
<polygon fill="lightgreen" stroke="black" points="2784,-423.97 2526,-423.97 2526,-382.97 2784,-382.97 2784,-423.97"/>
<text text-anchor="middle" x="2655" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;20 GPU&#45;102</text>
<text text-anchor="middle" x="2655" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2655" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g6_l21 -->
<g id="node919" class="node">
<title>expert_s3_t0_g6_l21</title>
<polygon fill="lightgreen" stroke="black" points="2508,-423.97 2250,-423.97 2250,-382.97 2508,-382.97 2508,-423.97"/>
<text text-anchor="middle" x="2379" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;21 GPU&#45;102</text>
<text text-anchor="middle" x="2379" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2379" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g6_l22 -->
<g id="node920" class="node">
<title>expert_s3_t0_g6_l22</title>
<polygon fill="lightgreen" stroke="black" points="2232,-423.97 1974,-423.97 1974,-382.97 2232,-382.97 2232,-423.97"/>
<text text-anchor="middle" x="2103" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;22 GPU&#45;102</text>
<text text-anchor="middle" x="2103" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="2103" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g6_l23 -->
<g id="node921" class="node">
<title>expert_s3_t0_g6_l23</title>
<polygon fill="lightgreen" stroke="black" points="1956,-423.97 1698,-423.97 1698,-382.97 1956,-382.97 1956,-423.97"/>
<text text-anchor="middle" x="1827" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;102 Layer&#45;23 GPU&#45;102</text>
<text text-anchor="middle" x="1827" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1827" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t0_g7 -->
<g id="node922" class="node">
<title>attn_s3_t0_g7</title>
<polygon fill="lightgreen" stroke="black" points="13397.5,-423.97 13122.5,-423.97 13122.5,-382.97 13397.5,-382.97 13397.5,-423.97"/>
<text text-anchor="middle" x="13260" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;103</text>
<text text-anchor="middle" x="13260" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13260" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t0_g7 -->
<g id="node923" class="node">
<title>gate_s3_t0_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="13398.32,-346.97 12976.26,-346.97 12867.68,-264.97 13289.74,-264.97 13398.32,-346.97"/>
<text text-anchor="middle" x="13133" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;103</text>
<text text-anchor="middle" x="13133" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t0_g7&#45;&gt;gate_s3_t0_g7 -->
<g id="edge317" class="edge">
<title>attn_s3_t0_g7&#45;&gt;gate_s3_t0_g7</title>
<path fill="none" stroke="black" d="M13233.99,-382.91C13222.47,-374.24 13208.37,-363.64 13194.41,-353.15"/>
<polygon fill="black" stroke="black" points="13196.33,-350.21 13186.23,-346.99 13192.12,-355.8 13196.33,-350.21"/>
</g>
<!-- expert_s3_t0_g7_l18 -->
<g id="node924" class="node">
<title>expert_s3_t0_g7_l18</title>
<polygon fill="lightgreen" stroke="black" points="13262,-228.97 13004,-228.97 13004,-187.97 13262,-187.97 13262,-228.97"/>
<text text-anchor="middle" x="13133" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;18 GPU&#45;103</text>
<text text-anchor="middle" x="13133" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13133" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t0_g7&#45;&gt;expert_s3_t0_g7_l18 -->
<g id="edge318" class="edge">
<title>gate_s3_t0_g7&#45;&gt;expert_s3_t0_g7_l18</title>
<path fill="none" stroke="black" d="M13133,-264.74C13133,-256.16 13133,-247.25 13133,-239.16"/>
<polygon fill="black" stroke="black" points="13136.5,-239.08 13133,-229.08 13129.5,-239.08 13136.5,-239.08"/>
</g>
<!-- comm_s3_t0_g7 -->
<g id="node1129" class="node">
<title>comm_s3_t0_g7</title>
<ellipse fill="lightblue" stroke="black" cx="13133" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="13133" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;103</text>
<text text-anchor="middle" x="13133" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="13133" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t0_g7_l18&#45;&gt;comm_s3_t0_g7 -->
<g id="edge319" class="edge">
<title>expert_s3_t0_g7_l18&#45;&gt;comm_s3_t0_g7</title>
<path fill="none" stroke="black" d="M13133,-187.68C13133,-180.05 13133,-171.06 13133,-162.28"/>
<polygon fill="black" stroke="black" points="13136.5,-162.15 13133,-152.15 13129.5,-162.15 13136.5,-162.15"/>
</g>
<!-- expert_s3_t0_g7_l19 -->
<g id="node925" class="node">
<title>expert_s3_t0_g7_l19</title>
<polygon fill="lightgreen" stroke="black" points="1386,-423.97 1128,-423.97 1128,-382.97 1386,-382.97 1386,-423.97"/>
<text text-anchor="middle" x="1257" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;19 GPU&#45;103</text>
<text text-anchor="middle" x="1257" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="1257" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g7_l20 -->
<g id="node926" class="node">
<title>expert_s3_t0_g7_l20</title>
<polygon fill="lightgreen" stroke="black" points="1110,-423.97 852,-423.97 852,-382.97 1110,-382.97 1110,-423.97"/>
<text text-anchor="middle" x="981" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;20 GPU&#45;103</text>
<text text-anchor="middle" x="981" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="981" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g7_l21 -->
<g id="node927" class="node">
<title>expert_s3_t0_g7_l21</title>
<polygon fill="lightgreen" stroke="black" points="834,-423.97 576,-423.97 576,-382.97 834,-382.97 834,-423.97"/>
<text text-anchor="middle" x="705" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;21 GPU&#45;103</text>
<text text-anchor="middle" x="705" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="705" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g7_l22 -->
<g id="node928" class="node">
<title>expert_s3_t0_g7_l22</title>
<polygon fill="lightgreen" stroke="black" points="558,-423.97 300,-423.97 300,-382.97 558,-382.97 558,-423.97"/>
<text text-anchor="middle" x="429" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;22 GPU&#45;103</text>
<text text-anchor="middle" x="429" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="429" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t0_g7_l23 -->
<g id="node929" class="node">
<title>expert_s3_t0_g7_l23</title>
<polygon fill="lightgreen" stroke="black" points="282,-423.97 24,-423.97 24,-382.97 282,-382.97 282,-423.97"/>
<text text-anchor="middle" x="153" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;103 Layer&#45;23 GPU&#45;103</text>
<text text-anchor="middle" x="153" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="153" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g0 -->
<g id="node930" class="node">
<title>attn_s3_t1_g0</title>
<polygon fill="lightgreen" stroke="black" points="15077.5,-423.97 14802.5,-423.97 14802.5,-382.97 15077.5,-382.97 15077.5,-423.97"/>
<text text-anchor="middle" x="14940" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;104</text>
<text text-anchor="middle" x="14940" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g0 -->
<g id="node931" class="node">
<title>gate_s3_t1_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="15205.32,-346.97 14783.26,-346.97 14674.68,-264.97 15096.74,-264.97 15205.32,-346.97"/>
<text text-anchor="middle" x="14940" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;104</text>
<text text-anchor="middle" x="14940" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g0&#45;&gt;gate_s3_t1_g0 -->
<g id="edge320" class="edge">
<title>attn_s3_t1_g0&#45;&gt;gate_s3_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-382.68C14940,-375.22 14940,-366.35 14940,-357.35"/>
<polygon fill="black" stroke="black" points="14943.5,-357.21 14940,-347.21 14936.5,-357.21 14943.5,-357.21"/>
</g>
<!-- expert_s3_t1_g0_l18 -->
<g id="node932" class="node">
<title>expert_s3_t1_g0_l18</title>
<polygon fill="lightgreen" stroke="black" points="15069,-228.97 14811,-228.97 14811,-187.97 15069,-187.97 15069,-228.97"/>
<text text-anchor="middle" x="14940" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;18 GPU&#45;104</text>
<text text-anchor="middle" x="14940" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14940" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g0&#45;&gt;expert_s3_t1_g0_l18 -->
<g id="edge321" class="edge">
<title>gate_s3_t1_g0&#45;&gt;expert_s3_t1_g0_l18</title>
<path fill="none" stroke="black" d="M14940,-264.74C14940,-256.16 14940,-247.25 14940,-239.16"/>
<polygon fill="black" stroke="black" points="14943.5,-239.08 14940,-229.08 14936.5,-239.08 14943.5,-239.08"/>
</g>
<!-- comm_s3_t1_g0 -->
<g id="node1130" class="node">
<title>comm_s3_t1_g0</title>
<ellipse fill="lightblue" stroke="black" cx="14940" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="14940" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;104</text>
<text text-anchor="middle" x="14940" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="14940" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g0_l18&#45;&gt;comm_s3_t1_g0 -->
<g id="edge322" class="edge">
<title>expert_s3_t1_g0_l18&#45;&gt;comm_s3_t1_g0</title>
<path fill="none" stroke="black" d="M14940,-187.68C14940,-180.05 14940,-171.06 14940,-162.28"/>
<polygon fill="black" stroke="black" points="14943.5,-162.15 14940,-152.15 14936.5,-162.15 14943.5,-162.15"/>
</g>
<!-- expert_s3_t1_g0_l19 -->
<g id="node933" class="node">
<title>expert_s3_t1_g0_l19</title>
<polygon fill="lightgreen" stroke="black" points="26502,-423.97 26244,-423.97 26244,-382.97 26502,-382.97 26502,-423.97"/>
<text text-anchor="middle" x="26373" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;19 GPU&#45;104</text>
<text text-anchor="middle" x="26373" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26373" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g0_l20 -->
<g id="node934" class="node">
<title>expert_s3_t1_g0_l20</title>
<polygon fill="lightgreen" stroke="black" points="26226,-423.97 25968,-423.97 25968,-382.97 26226,-382.97 26226,-423.97"/>
<text text-anchor="middle" x="26097" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;20 GPU&#45;104</text>
<text text-anchor="middle" x="26097" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26097" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g0_l21 -->
<g id="node935" class="node">
<title>expert_s3_t1_g0_l21</title>
<polygon fill="lightgreen" stroke="black" points="25950,-423.97 25692,-423.97 25692,-382.97 25950,-382.97 25950,-423.97"/>
<text text-anchor="middle" x="25821" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;21 GPU&#45;104</text>
<text text-anchor="middle" x="25821" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25821" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g0_l22 -->
<g id="node936" class="node">
<title>expert_s3_t1_g0_l22</title>
<polygon fill="lightgreen" stroke="black" points="25674,-423.97 25416,-423.97 25416,-382.97 25674,-382.97 25674,-423.97"/>
<text text-anchor="middle" x="25545" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;22 GPU&#45;104</text>
<text text-anchor="middle" x="25545" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25545" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g0_l23 -->
<g id="node937" class="node">
<title>expert_s3_t1_g0_l23</title>
<polygon fill="lightgreen" stroke="black" points="25398,-423.97 25140,-423.97 25140,-382.97 25398,-382.97 25398,-423.97"/>
<text text-anchor="middle" x="25269" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;104 Layer&#45;23 GPU&#45;104</text>
<text text-anchor="middle" x="25269" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="25269" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g1 -->
<g id="node938" class="node">
<title>attn_s3_t1_g1</title>
<polygon fill="lightgreen" stroke="black" points="16751.5,-423.97 16476.5,-423.97 16476.5,-382.97 16751.5,-382.97 16751.5,-423.97"/>
<text text-anchor="middle" x="16614" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;105</text>
<text text-anchor="middle" x="16614" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g1 -->
<g id="node939" class="node">
<title>gate_s3_t1_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="16879.32,-346.97 16457.26,-346.97 16348.68,-264.97 16770.74,-264.97 16879.32,-346.97"/>
<text text-anchor="middle" x="16614" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;105</text>
<text text-anchor="middle" x="16614" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g1&#45;&gt;gate_s3_t1_g1 -->
<g id="edge323" class="edge">
<title>attn_s3_t1_g1&#45;&gt;gate_s3_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-382.68C16614,-375.22 16614,-366.35 16614,-357.35"/>
<polygon fill="black" stroke="black" points="16617.5,-357.21 16614,-347.21 16610.5,-357.21 16617.5,-357.21"/>
</g>
<!-- expert_s3_t1_g1_l18 -->
<g id="node940" class="node">
<title>expert_s3_t1_g1_l18</title>
<polygon fill="lightgreen" stroke="black" points="16743,-228.97 16485,-228.97 16485,-187.97 16743,-187.97 16743,-228.97"/>
<text text-anchor="middle" x="16614" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;18 GPU&#45;105</text>
<text text-anchor="middle" x="16614" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16614" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g1&#45;&gt;expert_s3_t1_g1_l18 -->
<g id="edge324" class="edge">
<title>gate_s3_t1_g1&#45;&gt;expert_s3_t1_g1_l18</title>
<path fill="none" stroke="black" d="M16614,-264.74C16614,-256.16 16614,-247.25 16614,-239.16"/>
<polygon fill="black" stroke="black" points="16617.5,-239.08 16614,-229.08 16610.5,-239.08 16617.5,-239.08"/>
</g>
<!-- comm_s3_t1_g1 -->
<g id="node1131" class="node">
<title>comm_s3_t1_g1</title>
<ellipse fill="lightblue" stroke="black" cx="16614" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="16614" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;105</text>
<text text-anchor="middle" x="16614" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="16614" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g1_l18&#45;&gt;comm_s3_t1_g1 -->
<g id="edge325" class="edge">
<title>expert_s3_t1_g1_l18&#45;&gt;comm_s3_t1_g1</title>
<path fill="none" stroke="black" d="M16614,-187.68C16614,-180.05 16614,-171.06 16614,-162.28"/>
<polygon fill="black" stroke="black" points="16617.5,-162.15 16614,-152.15 16610.5,-162.15 16617.5,-162.15"/>
</g>
<!-- expert_s3_t1_g1_l19 -->
<g id="node941" class="node">
<title>expert_s3_t1_g1_l19</title>
<polygon fill="lightgreen" stroke="black" points="24828,-423.97 24570,-423.97 24570,-382.97 24828,-382.97 24828,-423.97"/>
<text text-anchor="middle" x="24699" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;19 GPU&#45;105</text>
<text text-anchor="middle" x="24699" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24699" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g1_l20 -->
<g id="node942" class="node">
<title>expert_s3_t1_g1_l20</title>
<polygon fill="lightgreen" stroke="black" points="24552,-423.97 24294,-423.97 24294,-382.97 24552,-382.97 24552,-423.97"/>
<text text-anchor="middle" x="24423" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;20 GPU&#45;105</text>
<text text-anchor="middle" x="24423" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24423" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g1_l21 -->
<g id="node943" class="node">
<title>expert_s3_t1_g1_l21</title>
<polygon fill="lightgreen" stroke="black" points="24276,-423.97 24018,-423.97 24018,-382.97 24276,-382.97 24276,-423.97"/>
<text text-anchor="middle" x="24147" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;21 GPU&#45;105</text>
<text text-anchor="middle" x="24147" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24147" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g1_l22 -->
<g id="node944" class="node">
<title>expert_s3_t1_g1_l22</title>
<polygon fill="lightgreen" stroke="black" points="24000,-423.97 23742,-423.97 23742,-382.97 24000,-382.97 24000,-423.97"/>
<text text-anchor="middle" x="23871" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;22 GPU&#45;105</text>
<text text-anchor="middle" x="23871" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23871" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g1_l23 -->
<g id="node945" class="node">
<title>expert_s3_t1_g1_l23</title>
<polygon fill="lightgreen" stroke="black" points="23724,-423.97 23466,-423.97 23466,-382.97 23724,-382.97 23724,-423.97"/>
<text text-anchor="middle" x="23595" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;105 Layer&#45;23 GPU&#45;105</text>
<text text-anchor="middle" x="23595" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23595" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g2 -->
<g id="node946" class="node">
<title>attn_s3_t1_g2</title>
<polygon fill="lightgreen" stroke="black" points="18425.5,-423.97 18150.5,-423.97 18150.5,-382.97 18425.5,-382.97 18425.5,-423.97"/>
<text text-anchor="middle" x="18288" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;106</text>
<text text-anchor="middle" x="18288" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g2 -->
<g id="node947" class="node">
<title>gate_s3_t1_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="18553.32,-346.97 18131.26,-346.97 18022.68,-264.97 18444.74,-264.97 18553.32,-346.97"/>
<text text-anchor="middle" x="18288" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;106</text>
<text text-anchor="middle" x="18288" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g2&#45;&gt;gate_s3_t1_g2 -->
<g id="edge326" class="edge">
<title>attn_s3_t1_g2&#45;&gt;gate_s3_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-382.68C18288,-375.22 18288,-366.35 18288,-357.35"/>
<polygon fill="black" stroke="black" points="18291.5,-357.21 18288,-347.21 18284.5,-357.21 18291.5,-357.21"/>
</g>
<!-- expert_s3_t1_g2_l18 -->
<g id="node948" class="node">
<title>expert_s3_t1_g2_l18</title>
<polygon fill="lightgreen" stroke="black" points="18417,-228.97 18159,-228.97 18159,-187.97 18417,-187.97 18417,-228.97"/>
<text text-anchor="middle" x="18288" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;18 GPU&#45;106</text>
<text text-anchor="middle" x="18288" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18288" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g2&#45;&gt;expert_s3_t1_g2_l18 -->
<g id="edge327" class="edge">
<title>gate_s3_t1_g2&#45;&gt;expert_s3_t1_g2_l18</title>
<path fill="none" stroke="black" d="M18288,-264.74C18288,-256.16 18288,-247.25 18288,-239.16"/>
<polygon fill="black" stroke="black" points="18291.5,-239.08 18288,-229.08 18284.5,-239.08 18291.5,-239.08"/>
</g>
<!-- comm_s3_t1_g2 -->
<g id="node1132" class="node">
<title>comm_s3_t1_g2</title>
<ellipse fill="lightblue" stroke="black" cx="18288" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="18288" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;106</text>
<text text-anchor="middle" x="18288" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="18288" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g2_l18&#45;&gt;comm_s3_t1_g2 -->
<g id="edge328" class="edge">
<title>expert_s3_t1_g2_l18&#45;&gt;comm_s3_t1_g2</title>
<path fill="none" stroke="black" d="M18288,-187.68C18288,-180.05 18288,-171.06 18288,-162.28"/>
<polygon fill="black" stroke="black" points="18291.5,-162.15 18288,-152.15 18284.5,-162.15 18291.5,-162.15"/>
</g>
<!-- expert_s3_t1_g2_l19 -->
<g id="node949" class="node">
<title>expert_s3_t1_g2_l19</title>
<polygon fill="lightgreen" stroke="black" points="23154,-423.97 22896,-423.97 22896,-382.97 23154,-382.97 23154,-423.97"/>
<text text-anchor="middle" x="23025" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;19 GPU&#45;106</text>
<text text-anchor="middle" x="23025" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23025" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g2_l20 -->
<g id="node950" class="node">
<title>expert_s3_t1_g2_l20</title>
<polygon fill="lightgreen" stroke="black" points="22878,-423.97 22620,-423.97 22620,-382.97 22878,-382.97 22878,-423.97"/>
<text text-anchor="middle" x="22749" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;20 GPU&#45;106</text>
<text text-anchor="middle" x="22749" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22749" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g2_l21 -->
<g id="node951" class="node">
<title>expert_s3_t1_g2_l21</title>
<polygon fill="lightgreen" stroke="black" points="22602,-423.97 22344,-423.97 22344,-382.97 22602,-382.97 22602,-423.97"/>
<text text-anchor="middle" x="22473" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;21 GPU&#45;106</text>
<text text-anchor="middle" x="22473" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22473" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g2_l22 -->
<g id="node952" class="node">
<title>expert_s3_t1_g2_l22</title>
<polygon fill="lightgreen" stroke="black" points="22326,-423.97 22068,-423.97 22068,-382.97 22326,-382.97 22326,-423.97"/>
<text text-anchor="middle" x="22197" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;22 GPU&#45;106</text>
<text text-anchor="middle" x="22197" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="22197" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g2_l23 -->
<g id="node953" class="node">
<title>expert_s3_t1_g2_l23</title>
<polygon fill="lightgreen" stroke="black" points="22050,-423.97 21792,-423.97 21792,-382.97 22050,-382.97 22050,-423.97"/>
<text text-anchor="middle" x="21921" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;106 Layer&#45;23 GPU&#45;106</text>
<text text-anchor="middle" x="21921" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21921" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g3 -->
<g id="node954" class="node">
<title>attn_s3_t1_g3</title>
<polygon fill="lightgreen" stroke="black" points="20099.5,-423.97 19824.5,-423.97 19824.5,-382.97 20099.5,-382.97 20099.5,-423.97"/>
<text text-anchor="middle" x="19962" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;107</text>
<text text-anchor="middle" x="19962" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g3 -->
<g id="node955" class="node">
<title>gate_s3_t1_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="20227.32,-346.97 19805.26,-346.97 19696.68,-264.97 20118.74,-264.97 20227.32,-346.97"/>
<text text-anchor="middle" x="19962" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;107</text>
<text text-anchor="middle" x="19962" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g3&#45;&gt;gate_s3_t1_g3 -->
<g id="edge329" class="edge">
<title>attn_s3_t1_g3&#45;&gt;gate_s3_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-382.68C19962,-375.22 19962,-366.35 19962,-357.35"/>
<polygon fill="black" stroke="black" points="19965.5,-357.21 19962,-347.21 19958.5,-357.21 19965.5,-357.21"/>
</g>
<!-- expert_s3_t1_g3_l18 -->
<g id="node956" class="node">
<title>expert_s3_t1_g3_l18</title>
<polygon fill="lightgreen" stroke="black" points="20091,-228.97 19833,-228.97 19833,-187.97 20091,-187.97 20091,-228.97"/>
<text text-anchor="middle" x="19962" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;18 GPU&#45;107</text>
<text text-anchor="middle" x="19962" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19962" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g3&#45;&gt;expert_s3_t1_g3_l18 -->
<g id="edge330" class="edge">
<title>gate_s3_t1_g3&#45;&gt;expert_s3_t1_g3_l18</title>
<path fill="none" stroke="black" d="M19962,-264.74C19962,-256.16 19962,-247.25 19962,-239.16"/>
<polygon fill="black" stroke="black" points="19965.5,-239.08 19962,-229.08 19958.5,-239.08 19965.5,-239.08"/>
</g>
<!-- comm_s3_t1_g3 -->
<g id="node1133" class="node">
<title>comm_s3_t1_g3</title>
<ellipse fill="lightblue" stroke="black" cx="19962" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="19962" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;107</text>
<text text-anchor="middle" x="19962" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="19962" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g3_l18&#45;&gt;comm_s3_t1_g3 -->
<g id="edge331" class="edge">
<title>expert_s3_t1_g3_l18&#45;&gt;comm_s3_t1_g3</title>
<path fill="none" stroke="black" d="M19962,-187.68C19962,-180.05 19962,-171.06 19962,-162.28"/>
<polygon fill="black" stroke="black" points="19965.5,-162.15 19962,-152.15 19958.5,-162.15 19965.5,-162.15"/>
</g>
<!-- expert_s3_t1_g3_l19 -->
<g id="node957" class="node">
<title>expert_s3_t1_g3_l19</title>
<polygon fill="lightgreen" stroke="black" points="21480,-423.97 21222,-423.97 21222,-382.97 21480,-382.97 21480,-423.97"/>
<text text-anchor="middle" x="21351" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;19 GPU&#45;107</text>
<text text-anchor="middle" x="21351" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21351" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g3_l20 -->
<g id="node958" class="node">
<title>expert_s3_t1_g3_l20</title>
<polygon fill="lightgreen" stroke="black" points="21204,-423.97 20946,-423.97 20946,-382.97 21204,-382.97 21204,-423.97"/>
<text text-anchor="middle" x="21075" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;20 GPU&#45;107</text>
<text text-anchor="middle" x="21075" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21075" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g3_l21 -->
<g id="node959" class="node">
<title>expert_s3_t1_g3_l21</title>
<polygon fill="lightgreen" stroke="black" points="20928,-423.97 20670,-423.97 20670,-382.97 20928,-382.97 20928,-423.97"/>
<text text-anchor="middle" x="20799" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;21 GPU&#45;107</text>
<text text-anchor="middle" x="20799" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20799" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g3_l22 -->
<g id="node960" class="node">
<title>expert_s3_t1_g3_l22</title>
<polygon fill="lightgreen" stroke="black" points="20652,-423.97 20394,-423.97 20394,-382.97 20652,-382.97 20652,-423.97"/>
<text text-anchor="middle" x="20523" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;22 GPU&#45;107</text>
<text text-anchor="middle" x="20523" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20523" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g3_l23 -->
<g id="node961" class="node">
<title>expert_s3_t1_g3_l23</title>
<polygon fill="lightgreen" stroke="black" points="20376,-423.97 20118,-423.97 20118,-382.97 20376,-382.97 20376,-423.97"/>
<text text-anchor="middle" x="20247" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;107 Layer&#45;23 GPU&#45;107</text>
<text text-anchor="middle" x="20247" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="20247" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g4 -->
<g id="node962" class="node">
<title>attn_s3_t1_g4</title>
<polygon fill="lightgreen" stroke="black" points="21773.5,-423.97 21498.5,-423.97 21498.5,-382.97 21773.5,-382.97 21773.5,-423.97"/>
<text text-anchor="middle" x="21636" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;108</text>
<text text-anchor="middle" x="21636" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g4 -->
<g id="node963" class="node">
<title>gate_s3_t1_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="21901.32,-346.97 21479.26,-346.97 21370.68,-264.97 21792.74,-264.97 21901.32,-346.97"/>
<text text-anchor="middle" x="21636" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;108</text>
<text text-anchor="middle" x="21636" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g4&#45;&gt;gate_s3_t1_g4 -->
<g id="edge332" class="edge">
<title>attn_s3_t1_g4&#45;&gt;gate_s3_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-382.68C21636,-375.22 21636,-366.35 21636,-357.35"/>
<polygon fill="black" stroke="black" points="21639.5,-357.21 21636,-347.21 21632.5,-357.21 21639.5,-357.21"/>
</g>
<!-- expert_s3_t1_g4_l18 -->
<g id="node964" class="node">
<title>expert_s3_t1_g4_l18</title>
<polygon fill="lightgreen" stroke="black" points="21765,-228.97 21507,-228.97 21507,-187.97 21765,-187.97 21765,-228.97"/>
<text text-anchor="middle" x="21636" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;18 GPU&#45;108</text>
<text text-anchor="middle" x="21636" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="21636" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g4&#45;&gt;expert_s3_t1_g4_l18 -->
<g id="edge333" class="edge">
<title>gate_s3_t1_g4&#45;&gt;expert_s3_t1_g4_l18</title>
<path fill="none" stroke="black" d="M21636,-264.74C21636,-256.16 21636,-247.25 21636,-239.16"/>
<polygon fill="black" stroke="black" points="21639.5,-239.08 21636,-229.08 21632.5,-239.08 21639.5,-239.08"/>
</g>
<!-- comm_s3_t1_g4 -->
<g id="node1134" class="node">
<title>comm_s3_t1_g4</title>
<ellipse fill="lightblue" stroke="black" cx="21636" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="21636" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;108</text>
<text text-anchor="middle" x="21636" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="21636" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g4_l18&#45;&gt;comm_s3_t1_g4 -->
<g id="edge334" class="edge">
<title>expert_s3_t1_g4_l18&#45;&gt;comm_s3_t1_g4</title>
<path fill="none" stroke="black" d="M21636,-187.68C21636,-180.05 21636,-171.06 21636,-162.28"/>
<polygon fill="black" stroke="black" points="21639.5,-162.15 21636,-152.15 21632.5,-162.15 21639.5,-162.15"/>
</g>
<!-- expert_s3_t1_g4_l19 -->
<g id="node965" class="node">
<title>expert_s3_t1_g4_l19</title>
<polygon fill="lightgreen" stroke="black" points="19806,-423.97 19548,-423.97 19548,-382.97 19806,-382.97 19806,-423.97"/>
<text text-anchor="middle" x="19677" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;19 GPU&#45;108</text>
<text text-anchor="middle" x="19677" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19677" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g4_l20 -->
<g id="node966" class="node">
<title>expert_s3_t1_g4_l20</title>
<polygon fill="lightgreen" stroke="black" points="19530,-423.97 19272,-423.97 19272,-382.97 19530,-382.97 19530,-423.97"/>
<text text-anchor="middle" x="19401" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;20 GPU&#45;108</text>
<text text-anchor="middle" x="19401" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19401" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g4_l21 -->
<g id="node967" class="node">
<title>expert_s3_t1_g4_l21</title>
<polygon fill="lightgreen" stroke="black" points="19254,-423.97 18996,-423.97 18996,-382.97 19254,-382.97 19254,-423.97"/>
<text text-anchor="middle" x="19125" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;21 GPU&#45;108</text>
<text text-anchor="middle" x="19125" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="19125" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g4_l22 -->
<g id="node968" class="node">
<title>expert_s3_t1_g4_l22</title>
<polygon fill="lightgreen" stroke="black" points="18978,-423.97 18720,-423.97 18720,-382.97 18978,-382.97 18978,-423.97"/>
<text text-anchor="middle" x="18849" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;22 GPU&#45;108</text>
<text text-anchor="middle" x="18849" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18849" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g4_l23 -->
<g id="node969" class="node">
<title>expert_s3_t1_g4_l23</title>
<polygon fill="lightgreen" stroke="black" points="18702,-423.97 18444,-423.97 18444,-382.97 18702,-382.97 18702,-423.97"/>
<text text-anchor="middle" x="18573" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;108 Layer&#45;23 GPU&#45;108</text>
<text text-anchor="middle" x="18573" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18573" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g5 -->
<g id="node970" class="node">
<title>attn_s3_t1_g5</title>
<polygon fill="lightgreen" stroke="black" points="23447.5,-423.97 23172.5,-423.97 23172.5,-382.97 23447.5,-382.97 23447.5,-423.97"/>
<text text-anchor="middle" x="23310" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;109</text>
<text text-anchor="middle" x="23310" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g5 -->
<g id="node971" class="node">
<title>gate_s3_t1_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="23575.32,-346.97 23153.26,-346.97 23044.68,-264.97 23466.74,-264.97 23575.32,-346.97"/>
<text text-anchor="middle" x="23310" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;109</text>
<text text-anchor="middle" x="23310" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g5&#45;&gt;gate_s3_t1_g5 -->
<g id="edge335" class="edge">
<title>attn_s3_t1_g5&#45;&gt;gate_s3_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-382.68C23310,-375.22 23310,-366.35 23310,-357.35"/>
<polygon fill="black" stroke="black" points="23313.5,-357.21 23310,-347.21 23306.5,-357.21 23313.5,-357.21"/>
</g>
<!-- expert_s3_t1_g5_l18 -->
<g id="node972" class="node">
<title>expert_s3_t1_g5_l18</title>
<polygon fill="lightgreen" stroke="black" points="23439,-228.97 23181,-228.97 23181,-187.97 23439,-187.97 23439,-228.97"/>
<text text-anchor="middle" x="23310" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;18 GPU&#45;109</text>
<text text-anchor="middle" x="23310" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="23310" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g5&#45;&gt;expert_s3_t1_g5_l18 -->
<g id="edge336" class="edge">
<title>gate_s3_t1_g5&#45;&gt;expert_s3_t1_g5_l18</title>
<path fill="none" stroke="black" d="M23310,-264.74C23310,-256.16 23310,-247.25 23310,-239.16"/>
<polygon fill="black" stroke="black" points="23313.5,-239.08 23310,-229.08 23306.5,-239.08 23313.5,-239.08"/>
</g>
<!-- comm_s3_t1_g5 -->
<g id="node1135" class="node">
<title>comm_s3_t1_g5</title>
<ellipse fill="lightblue" stroke="black" cx="23310" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="23310" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;109</text>
<text text-anchor="middle" x="23310" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="23310" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g5_l18&#45;&gt;comm_s3_t1_g5 -->
<g id="edge337" class="edge">
<title>expert_s3_t1_g5_l18&#45;&gt;comm_s3_t1_g5</title>
<path fill="none" stroke="black" d="M23310,-187.68C23310,-180.05 23310,-171.06 23310,-162.28"/>
<polygon fill="black" stroke="black" points="23313.5,-162.15 23310,-152.15 23306.5,-162.15 23313.5,-162.15"/>
</g>
<!-- expert_s3_t1_g5_l19 -->
<g id="node973" class="node">
<title>expert_s3_t1_g5_l19</title>
<polygon fill="lightgreen" stroke="black" points="18132,-423.97 17874,-423.97 17874,-382.97 18132,-382.97 18132,-423.97"/>
<text text-anchor="middle" x="18003" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;19 GPU&#45;109</text>
<text text-anchor="middle" x="18003" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="18003" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g5_l20 -->
<g id="node974" class="node">
<title>expert_s3_t1_g5_l20</title>
<polygon fill="lightgreen" stroke="black" points="17856,-423.97 17598,-423.97 17598,-382.97 17856,-382.97 17856,-423.97"/>
<text text-anchor="middle" x="17727" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;20 GPU&#45;109</text>
<text text-anchor="middle" x="17727" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17727" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g5_l21 -->
<g id="node975" class="node">
<title>expert_s3_t1_g5_l21</title>
<polygon fill="lightgreen" stroke="black" points="17580,-423.97 17322,-423.97 17322,-382.97 17580,-382.97 17580,-423.97"/>
<text text-anchor="middle" x="17451" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;21 GPU&#45;109</text>
<text text-anchor="middle" x="17451" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17451" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g5_l22 -->
<g id="node976" class="node">
<title>expert_s3_t1_g5_l22</title>
<polygon fill="lightgreen" stroke="black" points="17304,-423.97 17046,-423.97 17046,-382.97 17304,-382.97 17304,-423.97"/>
<text text-anchor="middle" x="17175" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;22 GPU&#45;109</text>
<text text-anchor="middle" x="17175" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="17175" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g5_l23 -->
<g id="node977" class="node">
<title>expert_s3_t1_g5_l23</title>
<polygon fill="lightgreen" stroke="black" points="17028,-423.97 16770,-423.97 16770,-382.97 17028,-382.97 17028,-423.97"/>
<text text-anchor="middle" x="16899" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;109 Layer&#45;23 GPU&#45;109</text>
<text text-anchor="middle" x="16899" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16899" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g6 -->
<g id="node978" class="node">
<title>attn_s3_t1_g6</title>
<polygon fill="lightgreen" stroke="black" points="25121.5,-423.97 24846.5,-423.97 24846.5,-382.97 25121.5,-382.97 25121.5,-423.97"/>
<text text-anchor="middle" x="24984" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;110</text>
<text text-anchor="middle" x="24984" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g6 -->
<g id="node979" class="node">
<title>gate_s3_t1_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="25249.32,-346.97 24827.26,-346.97 24718.68,-264.97 25140.74,-264.97 25249.32,-346.97"/>
<text text-anchor="middle" x="24984" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;110</text>
<text text-anchor="middle" x="24984" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g6&#45;&gt;gate_s3_t1_g6 -->
<g id="edge338" class="edge">
<title>attn_s3_t1_g6&#45;&gt;gate_s3_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-382.68C24984,-375.22 24984,-366.35 24984,-357.35"/>
<polygon fill="black" stroke="black" points="24987.5,-357.21 24984,-347.21 24980.5,-357.21 24987.5,-357.21"/>
</g>
<!-- expert_s3_t1_g6_l18 -->
<g id="node980" class="node">
<title>expert_s3_t1_g6_l18</title>
<polygon fill="lightgreen" stroke="black" points="25113,-228.97 24855,-228.97 24855,-187.97 25113,-187.97 25113,-228.97"/>
<text text-anchor="middle" x="24984" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;18 GPU&#45;110</text>
<text text-anchor="middle" x="24984" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="24984" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g6&#45;&gt;expert_s3_t1_g6_l18 -->
<g id="edge339" class="edge">
<title>gate_s3_t1_g6&#45;&gt;expert_s3_t1_g6_l18</title>
<path fill="none" stroke="black" d="M24984,-264.74C24984,-256.16 24984,-247.25 24984,-239.16"/>
<polygon fill="black" stroke="black" points="24987.5,-239.08 24984,-229.08 24980.5,-239.08 24987.5,-239.08"/>
</g>
<!-- comm_s3_t1_g6 -->
<g id="node1136" class="node">
<title>comm_s3_t1_g6</title>
<ellipse fill="lightblue" stroke="black" cx="24984" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="24984" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;110</text>
<text text-anchor="middle" x="24984" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="24984" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g6_l18&#45;&gt;comm_s3_t1_g6 -->
<g id="edge340" class="edge">
<title>expert_s3_t1_g6_l18&#45;&gt;comm_s3_t1_g6</title>
<path fill="none" stroke="black" d="M24984,-187.68C24984,-180.05 24984,-171.06 24984,-162.28"/>
<polygon fill="black" stroke="black" points="24987.5,-162.15 24984,-152.15 24980.5,-162.15 24987.5,-162.15"/>
</g>
<!-- expert_s3_t1_g6_l19 -->
<g id="node981" class="node">
<title>expert_s3_t1_g6_l19</title>
<polygon fill="lightgreen" stroke="black" points="16458,-423.97 16200,-423.97 16200,-382.97 16458,-382.97 16458,-423.97"/>
<text text-anchor="middle" x="16329" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;19 GPU&#45;110</text>
<text text-anchor="middle" x="16329" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16329" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g6_l20 -->
<g id="node982" class="node">
<title>expert_s3_t1_g6_l20</title>
<polygon fill="lightgreen" stroke="black" points="16182,-423.97 15924,-423.97 15924,-382.97 16182,-382.97 16182,-423.97"/>
<text text-anchor="middle" x="16053" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;20 GPU&#45;110</text>
<text text-anchor="middle" x="16053" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="16053" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g6_l21 -->
<g id="node983" class="node">
<title>expert_s3_t1_g6_l21</title>
<polygon fill="lightgreen" stroke="black" points="15906,-423.97 15648,-423.97 15648,-382.97 15906,-382.97 15906,-423.97"/>
<text text-anchor="middle" x="15777" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;21 GPU&#45;110</text>
<text text-anchor="middle" x="15777" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15777" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g6_l22 -->
<g id="node984" class="node">
<title>expert_s3_t1_g6_l22</title>
<polygon fill="lightgreen" stroke="black" points="15630,-423.97 15372,-423.97 15372,-382.97 15630,-382.97 15630,-423.97"/>
<text text-anchor="middle" x="15501" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;22 GPU&#45;110</text>
<text text-anchor="middle" x="15501" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15501" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g6_l23 -->
<g id="node985" class="node">
<title>expert_s3_t1_g6_l23</title>
<polygon fill="lightgreen" stroke="black" points="15354,-423.97 15096,-423.97 15096,-382.97 15354,-382.97 15354,-423.97"/>
<text text-anchor="middle" x="15225" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;110 Layer&#45;23 GPU&#45;110</text>
<text text-anchor="middle" x="15225" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="15225" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t1_g7 -->
<g id="node986" class="node">
<title>attn_s3_t1_g7</title>
<polygon fill="lightgreen" stroke="black" points="26795.5,-423.97 26520.5,-423.97 26520.5,-382.97 26795.5,-382.97 26795.5,-423.97"/>
<text text-anchor="middle" x="26658" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;111</text>
<text text-anchor="middle" x="26658" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26658" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t1_g7 -->
<g id="node987" class="node">
<title>gate_s3_t1_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="26796.32,-346.97 26374.26,-346.97 26265.68,-264.97 26687.74,-264.97 26796.32,-346.97"/>
<text text-anchor="middle" x="26531" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;111</text>
<text text-anchor="middle" x="26531" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t1_g7&#45;&gt;gate_s3_t1_g7 -->
<g id="edge341" class="edge">
<title>attn_s3_t1_g7&#45;&gt;gate_s3_t1_g7</title>
<path fill="none" stroke="black" d="M26631.99,-382.91C26620.47,-374.24 26606.37,-363.64 26592.41,-353.15"/>
<polygon fill="black" stroke="black" points="26594.33,-350.21 26584.23,-346.99 26590.12,-355.8 26594.33,-350.21"/>
</g>
<!-- expert_s3_t1_g7_l18 -->
<g id="node988" class="node">
<title>expert_s3_t1_g7_l18</title>
<polygon fill="lightgreen" stroke="black" points="26660,-228.97 26402,-228.97 26402,-187.97 26660,-187.97 26660,-228.97"/>
<text text-anchor="middle" x="26531" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;18 GPU&#45;111</text>
<text text-anchor="middle" x="26531" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26531" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t1_g7&#45;&gt;expert_s3_t1_g7_l18 -->
<g id="edge342" class="edge">
<title>gate_s3_t1_g7&#45;&gt;expert_s3_t1_g7_l18</title>
<path fill="none" stroke="black" d="M26531,-264.74C26531,-256.16 26531,-247.25 26531,-239.16"/>
<polygon fill="black" stroke="black" points="26534.5,-239.08 26531,-229.08 26527.5,-239.08 26534.5,-239.08"/>
</g>
<!-- comm_s3_t1_g7 -->
<g id="node1137" class="node">
<title>comm_s3_t1_g7</title>
<ellipse fill="lightblue" stroke="black" cx="26531" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="26531" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;111</text>
<text text-anchor="middle" x="26531" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="26531" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t1_g7_l18&#45;&gt;comm_s3_t1_g7 -->
<g id="edge343" class="edge">
<title>expert_s3_t1_g7_l18&#45;&gt;comm_s3_t1_g7</title>
<path fill="none" stroke="black" d="M26531,-187.68C26531,-180.05 26531,-171.06 26531,-162.28"/>
<polygon fill="black" stroke="black" points="26534.5,-162.15 26531,-152.15 26527.5,-162.15 26534.5,-162.15"/>
</g>
<!-- expert_s3_t1_g7_l19 -->
<g id="node989" class="node">
<title>expert_s3_t1_g7_l19</title>
<polygon fill="lightgreen" stroke="black" points="14784,-423.97 14526,-423.97 14526,-382.97 14784,-382.97 14784,-423.97"/>
<text text-anchor="middle" x="14655" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;19 GPU&#45;111</text>
<text text-anchor="middle" x="14655" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14655" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g7_l20 -->
<g id="node990" class="node">
<title>expert_s3_t1_g7_l20</title>
<polygon fill="lightgreen" stroke="black" points="14508,-423.97 14250,-423.97 14250,-382.97 14508,-382.97 14508,-423.97"/>
<text text-anchor="middle" x="14379" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;20 GPU&#45;111</text>
<text text-anchor="middle" x="14379" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14379" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g7_l21 -->
<g id="node991" class="node">
<title>expert_s3_t1_g7_l21</title>
<polygon fill="lightgreen" stroke="black" points="14232,-423.97 13974,-423.97 13974,-382.97 14232,-382.97 14232,-423.97"/>
<text text-anchor="middle" x="14103" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;21 GPU&#45;111</text>
<text text-anchor="middle" x="14103" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="14103" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g7_l22 -->
<g id="node992" class="node">
<title>expert_s3_t1_g7_l22</title>
<polygon fill="lightgreen" stroke="black" points="13956,-423.97 13698,-423.97 13698,-382.97 13956,-382.97 13956,-423.97"/>
<text text-anchor="middle" x="13827" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;22 GPU&#45;111</text>
<text text-anchor="middle" x="13827" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13827" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t1_g7_l23 -->
<g id="node993" class="node">
<title>expert_s3_t1_g7_l23</title>
<polygon fill="lightgreen" stroke="black" points="13680,-423.97 13422,-423.97 13422,-382.97 13680,-382.97 13680,-423.97"/>
<text text-anchor="middle" x="13551" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;111 Layer&#45;23 GPU&#45;111</text>
<text text-anchor="middle" x="13551" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="13551" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g0 -->
<g id="node994" class="node">
<title>attn_s3_t2_g0</title>
<polygon fill="lightgreen" stroke="black" points="28475.5,-423.97 28200.5,-423.97 28200.5,-382.97 28475.5,-382.97 28475.5,-423.97"/>
<text text-anchor="middle" x="28338" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;112</text>
<text text-anchor="middle" x="28338" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g0 -->
<g id="node995" class="node">
<title>gate_s3_t2_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="28603.32,-346.97 28181.26,-346.97 28072.68,-264.97 28494.74,-264.97 28603.32,-346.97"/>
<text text-anchor="middle" x="28338" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;112</text>
<text text-anchor="middle" x="28338" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g0&#45;&gt;gate_s3_t2_g0 -->
<g id="edge344" class="edge">
<title>attn_s3_t2_g0&#45;&gt;gate_s3_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-382.68C28338,-375.22 28338,-366.35 28338,-357.35"/>
<polygon fill="black" stroke="black" points="28341.5,-357.21 28338,-347.21 28334.5,-357.21 28341.5,-357.21"/>
</g>
<!-- expert_s3_t2_g0_l18 -->
<g id="node996" class="node">
<title>expert_s3_t2_g0_l18</title>
<polygon fill="lightgreen" stroke="black" points="28467,-228.97 28209,-228.97 28209,-187.97 28467,-187.97 28467,-228.97"/>
<text text-anchor="middle" x="28338" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;18 GPU&#45;112</text>
<text text-anchor="middle" x="28338" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28338" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g0&#45;&gt;expert_s3_t2_g0_l18 -->
<g id="edge345" class="edge">
<title>gate_s3_t2_g0&#45;&gt;expert_s3_t2_g0_l18</title>
<path fill="none" stroke="black" d="M28338,-264.74C28338,-256.16 28338,-247.25 28338,-239.16"/>
<polygon fill="black" stroke="black" points="28341.5,-239.08 28338,-229.08 28334.5,-239.08 28341.5,-239.08"/>
</g>
<!-- comm_s3_t2_g0 -->
<g id="node1138" class="node">
<title>comm_s3_t2_g0</title>
<ellipse fill="lightblue" stroke="black" cx="28338" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="28338" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;112</text>
<text text-anchor="middle" x="28338" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="28338" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g0_l18&#45;&gt;comm_s3_t2_g0 -->
<g id="edge346" class="edge">
<title>expert_s3_t2_g0_l18&#45;&gt;comm_s3_t2_g0</title>
<path fill="none" stroke="black" d="M28338,-187.68C28338,-180.05 28338,-171.06 28338,-162.28"/>
<polygon fill="black" stroke="black" points="28341.5,-162.15 28338,-152.15 28334.5,-162.15 28341.5,-162.15"/>
</g>
<!-- expert_s3_t2_g0_l19 -->
<g id="node997" class="node">
<title>expert_s3_t2_g0_l19</title>
<polygon fill="lightgreen" stroke="black" points="39900,-423.97 39642,-423.97 39642,-382.97 39900,-382.97 39900,-423.97"/>
<text text-anchor="middle" x="39771" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;19 GPU&#45;112</text>
<text text-anchor="middle" x="39771" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39771" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g0_l20 -->
<g id="node998" class="node">
<title>expert_s3_t2_g0_l20</title>
<polygon fill="lightgreen" stroke="black" points="39624,-423.97 39366,-423.97 39366,-382.97 39624,-382.97 39624,-423.97"/>
<text text-anchor="middle" x="39495" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;20 GPU&#45;112</text>
<text text-anchor="middle" x="39495" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39495" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g0_l21 -->
<g id="node999" class="node">
<title>expert_s3_t2_g0_l21</title>
<polygon fill="lightgreen" stroke="black" points="39348,-423.97 39090,-423.97 39090,-382.97 39348,-382.97 39348,-423.97"/>
<text text-anchor="middle" x="39219" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;21 GPU&#45;112</text>
<text text-anchor="middle" x="39219" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39219" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g0_l22 -->
<g id="node1000" class="node">
<title>expert_s3_t2_g0_l22</title>
<polygon fill="lightgreen" stroke="black" points="39072,-423.97 38814,-423.97 38814,-382.97 39072,-382.97 39072,-423.97"/>
<text text-anchor="middle" x="38943" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;22 GPU&#45;112</text>
<text text-anchor="middle" x="38943" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38943" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g0_l23 -->
<g id="node1001" class="node">
<title>expert_s3_t2_g0_l23</title>
<polygon fill="lightgreen" stroke="black" points="38796,-423.97 38538,-423.97 38538,-382.97 38796,-382.97 38796,-423.97"/>
<text text-anchor="middle" x="38667" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;112 Layer&#45;23 GPU&#45;112</text>
<text text-anchor="middle" x="38667" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38667" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g1 -->
<g id="node1002" class="node">
<title>attn_s3_t2_g1</title>
<polygon fill="lightgreen" stroke="black" points="30149.5,-423.97 29874.5,-423.97 29874.5,-382.97 30149.5,-382.97 30149.5,-423.97"/>
<text text-anchor="middle" x="30012" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;113</text>
<text text-anchor="middle" x="30012" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g1 -->
<g id="node1003" class="node">
<title>gate_s3_t2_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="30277.32,-346.97 29855.26,-346.97 29746.68,-264.97 30168.74,-264.97 30277.32,-346.97"/>
<text text-anchor="middle" x="30012" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;113</text>
<text text-anchor="middle" x="30012" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g1&#45;&gt;gate_s3_t2_g1 -->
<g id="edge347" class="edge">
<title>attn_s3_t2_g1&#45;&gt;gate_s3_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-382.68C30012,-375.22 30012,-366.35 30012,-357.35"/>
<polygon fill="black" stroke="black" points="30015.5,-357.21 30012,-347.21 30008.5,-357.21 30015.5,-357.21"/>
</g>
<!-- expert_s3_t2_g1_l18 -->
<g id="node1004" class="node">
<title>expert_s3_t2_g1_l18</title>
<polygon fill="lightgreen" stroke="black" points="30141,-228.97 29883,-228.97 29883,-187.97 30141,-187.97 30141,-228.97"/>
<text text-anchor="middle" x="30012" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;18 GPU&#45;113</text>
<text text-anchor="middle" x="30012" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30012" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g1&#45;&gt;expert_s3_t2_g1_l18 -->
<g id="edge348" class="edge">
<title>gate_s3_t2_g1&#45;&gt;expert_s3_t2_g1_l18</title>
<path fill="none" stroke="black" d="M30012,-264.74C30012,-256.16 30012,-247.25 30012,-239.16"/>
<polygon fill="black" stroke="black" points="30015.5,-239.08 30012,-229.08 30008.5,-239.08 30015.5,-239.08"/>
</g>
<!-- comm_s3_t2_g1 -->
<g id="node1139" class="node">
<title>comm_s3_t2_g1</title>
<ellipse fill="lightblue" stroke="black" cx="30012" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="30012" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;113</text>
<text text-anchor="middle" x="30012" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="30012" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g1_l18&#45;&gt;comm_s3_t2_g1 -->
<g id="edge349" class="edge">
<title>expert_s3_t2_g1_l18&#45;&gt;comm_s3_t2_g1</title>
<path fill="none" stroke="black" d="M30012,-187.68C30012,-180.05 30012,-171.06 30012,-162.28"/>
<polygon fill="black" stroke="black" points="30015.5,-162.15 30012,-152.15 30008.5,-162.15 30015.5,-162.15"/>
</g>
<!-- expert_s3_t2_g1_l19 -->
<g id="node1005" class="node">
<title>expert_s3_t2_g1_l19</title>
<polygon fill="lightgreen" stroke="black" points="38226,-423.97 37968,-423.97 37968,-382.97 38226,-382.97 38226,-423.97"/>
<text text-anchor="middle" x="38097" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;19 GPU&#45;113</text>
<text text-anchor="middle" x="38097" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38097" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g1_l20 -->
<g id="node1006" class="node">
<title>expert_s3_t2_g1_l20</title>
<polygon fill="lightgreen" stroke="black" points="37950,-423.97 37692,-423.97 37692,-382.97 37950,-382.97 37950,-423.97"/>
<text text-anchor="middle" x="37821" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;20 GPU&#45;113</text>
<text text-anchor="middle" x="37821" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37821" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g1_l21 -->
<g id="node1007" class="node">
<title>expert_s3_t2_g1_l21</title>
<polygon fill="lightgreen" stroke="black" points="37674,-423.97 37416,-423.97 37416,-382.97 37674,-382.97 37674,-423.97"/>
<text text-anchor="middle" x="37545" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;21 GPU&#45;113</text>
<text text-anchor="middle" x="37545" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37545" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g1_l22 -->
<g id="node1008" class="node">
<title>expert_s3_t2_g1_l22</title>
<polygon fill="lightgreen" stroke="black" points="37398,-423.97 37140,-423.97 37140,-382.97 37398,-382.97 37398,-423.97"/>
<text text-anchor="middle" x="37269" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;22 GPU&#45;113</text>
<text text-anchor="middle" x="37269" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="37269" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g1_l23 -->
<g id="node1009" class="node">
<title>expert_s3_t2_g1_l23</title>
<polygon fill="lightgreen" stroke="black" points="37122,-423.97 36864,-423.97 36864,-382.97 37122,-382.97 37122,-423.97"/>
<text text-anchor="middle" x="36993" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;113 Layer&#45;23 GPU&#45;113</text>
<text text-anchor="middle" x="36993" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36993" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g2 -->
<g id="node1010" class="node">
<title>attn_s3_t2_g2</title>
<polygon fill="lightgreen" stroke="black" points="31823.5,-423.97 31548.5,-423.97 31548.5,-382.97 31823.5,-382.97 31823.5,-423.97"/>
<text text-anchor="middle" x="31686" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;114</text>
<text text-anchor="middle" x="31686" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g2 -->
<g id="node1011" class="node">
<title>gate_s3_t2_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="31951.32,-346.97 31529.26,-346.97 31420.68,-264.97 31842.74,-264.97 31951.32,-346.97"/>
<text text-anchor="middle" x="31686" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;114</text>
<text text-anchor="middle" x="31686" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g2&#45;&gt;gate_s3_t2_g2 -->
<g id="edge350" class="edge">
<title>attn_s3_t2_g2&#45;&gt;gate_s3_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-382.68C31686,-375.22 31686,-366.35 31686,-357.35"/>
<polygon fill="black" stroke="black" points="31689.5,-357.21 31686,-347.21 31682.5,-357.21 31689.5,-357.21"/>
</g>
<!-- expert_s3_t2_g2_l18 -->
<g id="node1012" class="node">
<title>expert_s3_t2_g2_l18</title>
<polygon fill="lightgreen" stroke="black" points="31815,-228.97 31557,-228.97 31557,-187.97 31815,-187.97 31815,-228.97"/>
<text text-anchor="middle" x="31686" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;18 GPU&#45;114</text>
<text text-anchor="middle" x="31686" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31686" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g2&#45;&gt;expert_s3_t2_g2_l18 -->
<g id="edge351" class="edge">
<title>gate_s3_t2_g2&#45;&gt;expert_s3_t2_g2_l18</title>
<path fill="none" stroke="black" d="M31686,-264.74C31686,-256.16 31686,-247.25 31686,-239.16"/>
<polygon fill="black" stroke="black" points="31689.5,-239.08 31686,-229.08 31682.5,-239.08 31689.5,-239.08"/>
</g>
<!-- comm_s3_t2_g2 -->
<g id="node1140" class="node">
<title>comm_s3_t2_g2</title>
<ellipse fill="lightblue" stroke="black" cx="31686" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="31686" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;114</text>
<text text-anchor="middle" x="31686" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="31686" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g2_l18&#45;&gt;comm_s3_t2_g2 -->
<g id="edge352" class="edge">
<title>expert_s3_t2_g2_l18&#45;&gt;comm_s3_t2_g2</title>
<path fill="none" stroke="black" d="M31686,-187.68C31686,-180.05 31686,-171.06 31686,-162.28"/>
<polygon fill="black" stroke="black" points="31689.5,-162.15 31686,-152.15 31682.5,-162.15 31689.5,-162.15"/>
</g>
<!-- expert_s3_t2_g2_l19 -->
<g id="node1013" class="node">
<title>expert_s3_t2_g2_l19</title>
<polygon fill="lightgreen" stroke="black" points="36552,-423.97 36294,-423.97 36294,-382.97 36552,-382.97 36552,-423.97"/>
<text text-anchor="middle" x="36423" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;19 GPU&#45;114</text>
<text text-anchor="middle" x="36423" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36423" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g2_l20 -->
<g id="node1014" class="node">
<title>expert_s3_t2_g2_l20</title>
<polygon fill="lightgreen" stroke="black" points="36276,-423.97 36018,-423.97 36018,-382.97 36276,-382.97 36276,-423.97"/>
<text text-anchor="middle" x="36147" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;20 GPU&#45;114</text>
<text text-anchor="middle" x="36147" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36147" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g2_l21 -->
<g id="node1015" class="node">
<title>expert_s3_t2_g2_l21</title>
<polygon fill="lightgreen" stroke="black" points="36000,-423.97 35742,-423.97 35742,-382.97 36000,-382.97 36000,-423.97"/>
<text text-anchor="middle" x="35871" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;21 GPU&#45;114</text>
<text text-anchor="middle" x="35871" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35871" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g2_l22 -->
<g id="node1016" class="node">
<title>expert_s3_t2_g2_l22</title>
<polygon fill="lightgreen" stroke="black" points="35724,-423.97 35466,-423.97 35466,-382.97 35724,-382.97 35724,-423.97"/>
<text text-anchor="middle" x="35595" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;22 GPU&#45;114</text>
<text text-anchor="middle" x="35595" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35595" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g2_l23 -->
<g id="node1017" class="node">
<title>expert_s3_t2_g2_l23</title>
<polygon fill="lightgreen" stroke="black" points="35448,-423.97 35190,-423.97 35190,-382.97 35448,-382.97 35448,-423.97"/>
<text text-anchor="middle" x="35319" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;114 Layer&#45;23 GPU&#45;114</text>
<text text-anchor="middle" x="35319" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35319" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g3 -->
<g id="node1018" class="node">
<title>attn_s3_t2_g3</title>
<polygon fill="lightgreen" stroke="black" points="33497.5,-423.97 33222.5,-423.97 33222.5,-382.97 33497.5,-382.97 33497.5,-423.97"/>
<text text-anchor="middle" x="33360" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;115</text>
<text text-anchor="middle" x="33360" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g3 -->
<g id="node1019" class="node">
<title>gate_s3_t2_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="33625.32,-346.97 33203.26,-346.97 33094.68,-264.97 33516.74,-264.97 33625.32,-346.97"/>
<text text-anchor="middle" x="33360" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;115</text>
<text text-anchor="middle" x="33360" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g3&#45;&gt;gate_s3_t2_g3 -->
<g id="edge353" class="edge">
<title>attn_s3_t2_g3&#45;&gt;gate_s3_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-382.68C33360,-375.22 33360,-366.35 33360,-357.35"/>
<polygon fill="black" stroke="black" points="33363.5,-357.21 33360,-347.21 33356.5,-357.21 33363.5,-357.21"/>
</g>
<!-- expert_s3_t2_g3_l18 -->
<g id="node1020" class="node">
<title>expert_s3_t2_g3_l18</title>
<polygon fill="lightgreen" stroke="black" points="33489,-228.97 33231,-228.97 33231,-187.97 33489,-187.97 33489,-228.97"/>
<text text-anchor="middle" x="33360" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;18 GPU&#45;115</text>
<text text-anchor="middle" x="33360" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33360" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g3&#45;&gt;expert_s3_t2_g3_l18 -->
<g id="edge354" class="edge">
<title>gate_s3_t2_g3&#45;&gt;expert_s3_t2_g3_l18</title>
<path fill="none" stroke="black" d="M33360,-264.74C33360,-256.16 33360,-247.25 33360,-239.16"/>
<polygon fill="black" stroke="black" points="33363.5,-239.08 33360,-229.08 33356.5,-239.08 33363.5,-239.08"/>
</g>
<!-- comm_s3_t2_g3 -->
<g id="node1141" class="node">
<title>comm_s3_t2_g3</title>
<ellipse fill="lightblue" stroke="black" cx="33360" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="33360" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;115</text>
<text text-anchor="middle" x="33360" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="33360" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g3_l18&#45;&gt;comm_s3_t2_g3 -->
<g id="edge355" class="edge">
<title>expert_s3_t2_g3_l18&#45;&gt;comm_s3_t2_g3</title>
<path fill="none" stroke="black" d="M33360,-187.68C33360,-180.05 33360,-171.06 33360,-162.28"/>
<polygon fill="black" stroke="black" points="33363.5,-162.15 33360,-152.15 33356.5,-162.15 33363.5,-162.15"/>
</g>
<!-- expert_s3_t2_g3_l19 -->
<g id="node1021" class="node">
<title>expert_s3_t2_g3_l19</title>
<polygon fill="lightgreen" stroke="black" points="34878,-423.97 34620,-423.97 34620,-382.97 34878,-382.97 34878,-423.97"/>
<text text-anchor="middle" x="34749" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;19 GPU&#45;115</text>
<text text-anchor="middle" x="34749" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34749" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g3_l20 -->
<g id="node1022" class="node">
<title>expert_s3_t2_g3_l20</title>
<polygon fill="lightgreen" stroke="black" points="34602,-423.97 34344,-423.97 34344,-382.97 34602,-382.97 34602,-423.97"/>
<text text-anchor="middle" x="34473" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;20 GPU&#45;115</text>
<text text-anchor="middle" x="34473" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34473" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g3_l21 -->
<g id="node1023" class="node">
<title>expert_s3_t2_g3_l21</title>
<polygon fill="lightgreen" stroke="black" points="34326,-423.97 34068,-423.97 34068,-382.97 34326,-382.97 34326,-423.97"/>
<text text-anchor="middle" x="34197" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;21 GPU&#45;115</text>
<text text-anchor="middle" x="34197" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="34197" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g3_l22 -->
<g id="node1024" class="node">
<title>expert_s3_t2_g3_l22</title>
<polygon fill="lightgreen" stroke="black" points="34050,-423.97 33792,-423.97 33792,-382.97 34050,-382.97 34050,-423.97"/>
<text text-anchor="middle" x="33921" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;22 GPU&#45;115</text>
<text text-anchor="middle" x="33921" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33921" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g3_l23 -->
<g id="node1025" class="node">
<title>expert_s3_t2_g3_l23</title>
<polygon fill="lightgreen" stroke="black" points="33774,-423.97 33516,-423.97 33516,-382.97 33774,-382.97 33774,-423.97"/>
<text text-anchor="middle" x="33645" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;115 Layer&#45;23 GPU&#45;115</text>
<text text-anchor="middle" x="33645" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33645" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g4 -->
<g id="node1026" class="node">
<title>attn_s3_t2_g4</title>
<polygon fill="lightgreen" stroke="black" points="35171.5,-423.97 34896.5,-423.97 34896.5,-382.97 35171.5,-382.97 35171.5,-423.97"/>
<text text-anchor="middle" x="35034" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;116</text>
<text text-anchor="middle" x="35034" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g4 -->
<g id="node1027" class="node">
<title>gate_s3_t2_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="35299.32,-346.97 34877.26,-346.97 34768.68,-264.97 35190.74,-264.97 35299.32,-346.97"/>
<text text-anchor="middle" x="35034" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;116</text>
<text text-anchor="middle" x="35034" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g4&#45;&gt;gate_s3_t2_g4 -->
<g id="edge356" class="edge">
<title>attn_s3_t2_g4&#45;&gt;gate_s3_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-382.68C35034,-375.22 35034,-366.35 35034,-357.35"/>
<polygon fill="black" stroke="black" points="35037.5,-357.21 35034,-347.21 35030.5,-357.21 35037.5,-357.21"/>
</g>
<!-- expert_s3_t2_g4_l18 -->
<g id="node1028" class="node">
<title>expert_s3_t2_g4_l18</title>
<polygon fill="lightgreen" stroke="black" points="35163,-228.97 34905,-228.97 34905,-187.97 35163,-187.97 35163,-228.97"/>
<text text-anchor="middle" x="35034" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;18 GPU&#45;116</text>
<text text-anchor="middle" x="35034" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="35034" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g4&#45;&gt;expert_s3_t2_g4_l18 -->
<g id="edge357" class="edge">
<title>gate_s3_t2_g4&#45;&gt;expert_s3_t2_g4_l18</title>
<path fill="none" stroke="black" d="M35034,-264.74C35034,-256.16 35034,-247.25 35034,-239.16"/>
<polygon fill="black" stroke="black" points="35037.5,-239.08 35034,-229.08 35030.5,-239.08 35037.5,-239.08"/>
</g>
<!-- comm_s3_t2_g4 -->
<g id="node1142" class="node">
<title>comm_s3_t2_g4</title>
<ellipse fill="lightblue" stroke="black" cx="35034" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="35034" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;116</text>
<text text-anchor="middle" x="35034" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="35034" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g4_l18&#45;&gt;comm_s3_t2_g4 -->
<g id="edge358" class="edge">
<title>expert_s3_t2_g4_l18&#45;&gt;comm_s3_t2_g4</title>
<path fill="none" stroke="black" d="M35034,-187.68C35034,-180.05 35034,-171.06 35034,-162.28"/>
<polygon fill="black" stroke="black" points="35037.5,-162.15 35034,-152.15 35030.5,-162.15 35037.5,-162.15"/>
</g>
<!-- expert_s3_t2_g4_l19 -->
<g id="node1029" class="node">
<title>expert_s3_t2_g4_l19</title>
<polygon fill="lightgreen" stroke="black" points="33204,-423.97 32946,-423.97 32946,-382.97 33204,-382.97 33204,-423.97"/>
<text text-anchor="middle" x="33075" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;19 GPU&#45;116</text>
<text text-anchor="middle" x="33075" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="33075" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g4_l20 -->
<g id="node1030" class="node">
<title>expert_s3_t2_g4_l20</title>
<polygon fill="lightgreen" stroke="black" points="32928,-423.97 32670,-423.97 32670,-382.97 32928,-382.97 32928,-423.97"/>
<text text-anchor="middle" x="32799" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;20 GPU&#45;116</text>
<text text-anchor="middle" x="32799" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32799" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g4_l21 -->
<g id="node1031" class="node">
<title>expert_s3_t2_g4_l21</title>
<polygon fill="lightgreen" stroke="black" points="32652,-423.97 32394,-423.97 32394,-382.97 32652,-382.97 32652,-423.97"/>
<text text-anchor="middle" x="32523" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;21 GPU&#45;116</text>
<text text-anchor="middle" x="32523" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32523" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g4_l22 -->
<g id="node1032" class="node">
<title>expert_s3_t2_g4_l22</title>
<polygon fill="lightgreen" stroke="black" points="32376,-423.97 32118,-423.97 32118,-382.97 32376,-382.97 32376,-423.97"/>
<text text-anchor="middle" x="32247" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;22 GPU&#45;116</text>
<text text-anchor="middle" x="32247" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="32247" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g4_l23 -->
<g id="node1033" class="node">
<title>expert_s3_t2_g4_l23</title>
<polygon fill="lightgreen" stroke="black" points="32100,-423.97 31842,-423.97 31842,-382.97 32100,-382.97 32100,-423.97"/>
<text text-anchor="middle" x="31971" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;116 Layer&#45;23 GPU&#45;116</text>
<text text-anchor="middle" x="31971" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31971" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g5 -->
<g id="node1034" class="node">
<title>attn_s3_t2_g5</title>
<polygon fill="lightgreen" stroke="black" points="36845.5,-423.97 36570.5,-423.97 36570.5,-382.97 36845.5,-382.97 36845.5,-423.97"/>
<text text-anchor="middle" x="36708" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;117</text>
<text text-anchor="middle" x="36708" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g5 -->
<g id="node1035" class="node">
<title>gate_s3_t2_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="36973.32,-346.97 36551.26,-346.97 36442.68,-264.97 36864.74,-264.97 36973.32,-346.97"/>
<text text-anchor="middle" x="36708" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;117</text>
<text text-anchor="middle" x="36708" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g5&#45;&gt;gate_s3_t2_g5 -->
<g id="edge359" class="edge">
<title>attn_s3_t2_g5&#45;&gt;gate_s3_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-382.68C36708,-375.22 36708,-366.35 36708,-357.35"/>
<polygon fill="black" stroke="black" points="36711.5,-357.21 36708,-347.21 36704.5,-357.21 36711.5,-357.21"/>
</g>
<!-- expert_s3_t2_g5_l18 -->
<g id="node1036" class="node">
<title>expert_s3_t2_g5_l18</title>
<polygon fill="lightgreen" stroke="black" points="36837,-228.97 36579,-228.97 36579,-187.97 36837,-187.97 36837,-228.97"/>
<text text-anchor="middle" x="36708" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;18 GPU&#45;117</text>
<text text-anchor="middle" x="36708" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="36708" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g5&#45;&gt;expert_s3_t2_g5_l18 -->
<g id="edge360" class="edge">
<title>gate_s3_t2_g5&#45;&gt;expert_s3_t2_g5_l18</title>
<path fill="none" stroke="black" d="M36708,-264.74C36708,-256.16 36708,-247.25 36708,-239.16"/>
<polygon fill="black" stroke="black" points="36711.5,-239.08 36708,-229.08 36704.5,-239.08 36711.5,-239.08"/>
</g>
<!-- comm_s3_t2_g5 -->
<g id="node1143" class="node">
<title>comm_s3_t2_g5</title>
<ellipse fill="lightblue" stroke="black" cx="36708" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="36708" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;117</text>
<text text-anchor="middle" x="36708" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="36708" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g5_l18&#45;&gt;comm_s3_t2_g5 -->
<g id="edge361" class="edge">
<title>expert_s3_t2_g5_l18&#45;&gt;comm_s3_t2_g5</title>
<path fill="none" stroke="black" d="M36708,-187.68C36708,-180.05 36708,-171.06 36708,-162.28"/>
<polygon fill="black" stroke="black" points="36711.5,-162.15 36708,-152.15 36704.5,-162.15 36711.5,-162.15"/>
</g>
<!-- expert_s3_t2_g5_l19 -->
<g id="node1037" class="node">
<title>expert_s3_t2_g5_l19</title>
<polygon fill="lightgreen" stroke="black" points="31530,-423.97 31272,-423.97 31272,-382.97 31530,-382.97 31530,-423.97"/>
<text text-anchor="middle" x="31401" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;19 GPU&#45;117</text>
<text text-anchor="middle" x="31401" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31401" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g5_l20 -->
<g id="node1038" class="node">
<title>expert_s3_t2_g5_l20</title>
<polygon fill="lightgreen" stroke="black" points="31254,-423.97 30996,-423.97 30996,-382.97 31254,-382.97 31254,-423.97"/>
<text text-anchor="middle" x="31125" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;20 GPU&#45;117</text>
<text text-anchor="middle" x="31125" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="31125" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g5_l21 -->
<g id="node1039" class="node">
<title>expert_s3_t2_g5_l21</title>
<polygon fill="lightgreen" stroke="black" points="30978,-423.97 30720,-423.97 30720,-382.97 30978,-382.97 30978,-423.97"/>
<text text-anchor="middle" x="30849" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;21 GPU&#45;117</text>
<text text-anchor="middle" x="30849" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30849" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g5_l22 -->
<g id="node1040" class="node">
<title>expert_s3_t2_g5_l22</title>
<polygon fill="lightgreen" stroke="black" points="30702,-423.97 30444,-423.97 30444,-382.97 30702,-382.97 30702,-423.97"/>
<text text-anchor="middle" x="30573" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;22 GPU&#45;117</text>
<text text-anchor="middle" x="30573" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30573" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g5_l23 -->
<g id="node1041" class="node">
<title>expert_s3_t2_g5_l23</title>
<polygon fill="lightgreen" stroke="black" points="30426,-423.97 30168,-423.97 30168,-382.97 30426,-382.97 30426,-423.97"/>
<text text-anchor="middle" x="30297" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;117 Layer&#45;23 GPU&#45;117</text>
<text text-anchor="middle" x="30297" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="30297" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g6 -->
<g id="node1042" class="node">
<title>attn_s3_t2_g6</title>
<polygon fill="lightgreen" stroke="black" points="38519.5,-423.97 38244.5,-423.97 38244.5,-382.97 38519.5,-382.97 38519.5,-423.97"/>
<text text-anchor="middle" x="38382" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;118</text>
<text text-anchor="middle" x="38382" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g6 -->
<g id="node1043" class="node">
<title>gate_s3_t2_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="38647.32,-346.97 38225.26,-346.97 38116.68,-264.97 38538.74,-264.97 38647.32,-346.97"/>
<text text-anchor="middle" x="38382" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;118</text>
<text text-anchor="middle" x="38382" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g6&#45;&gt;gate_s3_t2_g6 -->
<g id="edge362" class="edge">
<title>attn_s3_t2_g6&#45;&gt;gate_s3_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-382.68C38382,-375.22 38382,-366.35 38382,-357.35"/>
<polygon fill="black" stroke="black" points="38385.5,-357.21 38382,-347.21 38378.5,-357.21 38385.5,-357.21"/>
</g>
<!-- expert_s3_t2_g6_l18 -->
<g id="node1044" class="node">
<title>expert_s3_t2_g6_l18</title>
<polygon fill="lightgreen" stroke="black" points="38511,-228.97 38253,-228.97 38253,-187.97 38511,-187.97 38511,-228.97"/>
<text text-anchor="middle" x="38382" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;18 GPU&#45;118</text>
<text text-anchor="middle" x="38382" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="38382" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g6&#45;&gt;expert_s3_t2_g6_l18 -->
<g id="edge363" class="edge">
<title>gate_s3_t2_g6&#45;&gt;expert_s3_t2_g6_l18</title>
<path fill="none" stroke="black" d="M38382,-264.74C38382,-256.16 38382,-247.25 38382,-239.16"/>
<polygon fill="black" stroke="black" points="38385.5,-239.08 38382,-229.08 38378.5,-239.08 38385.5,-239.08"/>
</g>
<!-- comm_s3_t2_g6 -->
<g id="node1144" class="node">
<title>comm_s3_t2_g6</title>
<ellipse fill="lightblue" stroke="black" cx="38382" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="38382" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;118</text>
<text text-anchor="middle" x="38382" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="38382" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g6_l18&#45;&gt;comm_s3_t2_g6 -->
<g id="edge364" class="edge">
<title>expert_s3_t2_g6_l18&#45;&gt;comm_s3_t2_g6</title>
<path fill="none" stroke="black" d="M38382,-187.68C38382,-180.05 38382,-171.06 38382,-162.28"/>
<polygon fill="black" stroke="black" points="38385.5,-162.15 38382,-152.15 38378.5,-162.15 38385.5,-162.15"/>
</g>
<!-- expert_s3_t2_g6_l19 -->
<g id="node1045" class="node">
<title>expert_s3_t2_g6_l19</title>
<polygon fill="lightgreen" stroke="black" points="29856,-423.97 29598,-423.97 29598,-382.97 29856,-382.97 29856,-423.97"/>
<text text-anchor="middle" x="29727" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;19 GPU&#45;118</text>
<text text-anchor="middle" x="29727" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29727" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g6_l20 -->
<g id="node1046" class="node">
<title>expert_s3_t2_g6_l20</title>
<polygon fill="lightgreen" stroke="black" points="29580,-423.97 29322,-423.97 29322,-382.97 29580,-382.97 29580,-423.97"/>
<text text-anchor="middle" x="29451" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;20 GPU&#45;118</text>
<text text-anchor="middle" x="29451" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29451" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g6_l21 -->
<g id="node1047" class="node">
<title>expert_s3_t2_g6_l21</title>
<polygon fill="lightgreen" stroke="black" points="29304,-423.97 29046,-423.97 29046,-382.97 29304,-382.97 29304,-423.97"/>
<text text-anchor="middle" x="29175" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;21 GPU&#45;118</text>
<text text-anchor="middle" x="29175" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="29175" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g6_l22 -->
<g id="node1048" class="node">
<title>expert_s3_t2_g6_l22</title>
<polygon fill="lightgreen" stroke="black" points="29028,-423.97 28770,-423.97 28770,-382.97 29028,-382.97 29028,-423.97"/>
<text text-anchor="middle" x="28899" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;22 GPU&#45;118</text>
<text text-anchor="middle" x="28899" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28899" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g6_l23 -->
<g id="node1049" class="node">
<title>expert_s3_t2_g6_l23</title>
<polygon fill="lightgreen" stroke="black" points="28752,-423.97 28494,-423.97 28494,-382.97 28752,-382.97 28752,-423.97"/>
<text text-anchor="middle" x="28623" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;118 Layer&#45;23 GPU&#45;118</text>
<text text-anchor="middle" x="28623" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28623" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t2_g7 -->
<g id="node1050" class="node">
<title>attn_s3_t2_g7</title>
<polygon fill="lightgreen" stroke="black" points="40193.5,-423.97 39918.5,-423.97 39918.5,-382.97 40193.5,-382.97 40193.5,-423.97"/>
<text text-anchor="middle" x="40056" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;119</text>
<text text-anchor="middle" x="40056" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="40056" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t2_g7 -->
<g id="node1051" class="node">
<title>gate_s3_t2_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="40194.32,-346.97 39772.26,-346.97 39663.68,-264.97 40085.74,-264.97 40194.32,-346.97"/>
<text text-anchor="middle" x="39929" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;119</text>
<text text-anchor="middle" x="39929" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t2_g7&#45;&gt;gate_s3_t2_g7 -->
<g id="edge365" class="edge">
<title>attn_s3_t2_g7&#45;&gt;gate_s3_t2_g7</title>
<path fill="none" stroke="black" d="M40029.99,-382.91C40018.47,-374.24 40004.37,-363.64 39990.41,-353.15"/>
<polygon fill="black" stroke="black" points="39992.33,-350.21 39982.23,-346.99 39988.12,-355.8 39992.33,-350.21"/>
</g>
<!-- expert_s3_t2_g7_l18 -->
<g id="node1052" class="node">
<title>expert_s3_t2_g7_l18</title>
<polygon fill="lightgreen" stroke="black" points="40058,-228.97 39800,-228.97 39800,-187.97 40058,-187.97 40058,-228.97"/>
<text text-anchor="middle" x="39929" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;18 GPU&#45;119</text>
<text text-anchor="middle" x="39929" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="39929" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t2_g7&#45;&gt;expert_s3_t2_g7_l18 -->
<g id="edge366" class="edge">
<title>gate_s3_t2_g7&#45;&gt;expert_s3_t2_g7_l18</title>
<path fill="none" stroke="black" d="M39929,-264.74C39929,-256.16 39929,-247.25 39929,-239.16"/>
<polygon fill="black" stroke="black" points="39932.5,-239.08 39929,-229.08 39925.5,-239.08 39932.5,-239.08"/>
</g>
<!-- comm_s3_t2_g7 -->
<g id="node1145" class="node">
<title>comm_s3_t2_g7</title>
<ellipse fill="lightblue" stroke="black" cx="39929" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="39929" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;119</text>
<text text-anchor="middle" x="39929" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="39929" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t2_g7_l18&#45;&gt;comm_s3_t2_g7 -->
<g id="edge367" class="edge">
<title>expert_s3_t2_g7_l18&#45;&gt;comm_s3_t2_g7</title>
<path fill="none" stroke="black" d="M39929,-187.68C39929,-180.05 39929,-171.06 39929,-162.28"/>
<polygon fill="black" stroke="black" points="39932.5,-162.15 39929,-152.15 39925.5,-162.15 39932.5,-162.15"/>
</g>
<!-- expert_s3_t2_g7_l19 -->
<g id="node1053" class="node">
<title>expert_s3_t2_g7_l19</title>
<polygon fill="lightgreen" stroke="black" points="28182,-423.97 27924,-423.97 27924,-382.97 28182,-382.97 28182,-423.97"/>
<text text-anchor="middle" x="28053" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;19 GPU&#45;119</text>
<text text-anchor="middle" x="28053" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="28053" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g7_l20 -->
<g id="node1054" class="node">
<title>expert_s3_t2_g7_l20</title>
<polygon fill="lightgreen" stroke="black" points="27906,-423.97 27648,-423.97 27648,-382.97 27906,-382.97 27906,-423.97"/>
<text text-anchor="middle" x="27777" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;20 GPU&#45;119</text>
<text text-anchor="middle" x="27777" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27777" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g7_l21 -->
<g id="node1055" class="node">
<title>expert_s3_t2_g7_l21</title>
<polygon fill="lightgreen" stroke="black" points="27630,-423.97 27372,-423.97 27372,-382.97 27630,-382.97 27630,-423.97"/>
<text text-anchor="middle" x="27501" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;21 GPU&#45;119</text>
<text text-anchor="middle" x="27501" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27501" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g7_l22 -->
<g id="node1056" class="node">
<title>expert_s3_t2_g7_l22</title>
<polygon fill="lightgreen" stroke="black" points="27354,-423.97 27096,-423.97 27096,-382.97 27354,-382.97 27354,-423.97"/>
<text text-anchor="middle" x="27225" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;22 GPU&#45;119</text>
<text text-anchor="middle" x="27225" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="27225" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t2_g7_l23 -->
<g id="node1057" class="node">
<title>expert_s3_t2_g7_l23</title>
<polygon fill="lightgreen" stroke="black" points="27078,-423.97 26820,-423.97 26820,-382.97 27078,-382.97 27078,-423.97"/>
<text text-anchor="middle" x="26949" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;119 Layer&#45;23 GPU&#45;119</text>
<text text-anchor="middle" x="26949" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="26949" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g0 -->
<g id="node1058" class="node">
<title>attn_s3_t3_g0</title>
<polygon fill="lightgreen" stroke="black" points="41873.5,-423.97 41598.5,-423.97 41598.5,-382.97 41873.5,-382.97 41873.5,-423.97"/>
<text text-anchor="middle" x="41736" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;120</text>
<text text-anchor="middle" x="41736" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g0 -->
<g id="node1059" class="node">
<title>gate_s3_t3_g0</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="42001.32,-346.97 41579.26,-346.97 41470.68,-264.97 41892.74,-264.97 42001.32,-346.97"/>
<text text-anchor="middle" x="41736" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;120</text>
<text text-anchor="middle" x="41736" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g0&#45;&gt;gate_s3_t3_g0 -->
<g id="edge368" class="edge">
<title>attn_s3_t3_g0&#45;&gt;gate_s3_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-382.68C41736,-375.22 41736,-366.35 41736,-357.35"/>
<polygon fill="black" stroke="black" points="41739.5,-357.21 41736,-347.21 41732.5,-357.21 41739.5,-357.21"/>
</g>
<!-- expert_s3_t3_g0_l18 -->
<g id="node1060" class="node">
<title>expert_s3_t3_g0_l18</title>
<polygon fill="lightgreen" stroke="black" points="41865,-228.97 41607,-228.97 41607,-187.97 41865,-187.97 41865,-228.97"/>
<text text-anchor="middle" x="41736" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;18 GPU&#45;120</text>
<text text-anchor="middle" x="41736" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41736" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g0&#45;&gt;expert_s3_t3_g0_l18 -->
<g id="edge369" class="edge">
<title>gate_s3_t3_g0&#45;&gt;expert_s3_t3_g0_l18</title>
<path fill="none" stroke="black" d="M41736,-264.74C41736,-256.16 41736,-247.25 41736,-239.16"/>
<polygon fill="black" stroke="black" points="41739.5,-239.08 41736,-229.08 41732.5,-239.08 41739.5,-239.08"/>
</g>
<!-- comm_s3_t3_g0 -->
<g id="node1146" class="node">
<title>comm_s3_t3_g0</title>
<ellipse fill="lightblue" stroke="black" cx="41736" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="41736" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;120</text>
<text text-anchor="middle" x="41736" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="41736" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g0_l18&#45;&gt;comm_s3_t3_g0 -->
<g id="edge370" class="edge">
<title>expert_s3_t3_g0_l18&#45;&gt;comm_s3_t3_g0</title>
<path fill="none" stroke="black" d="M41736,-187.68C41736,-180.05 41736,-171.06 41736,-162.28"/>
<polygon fill="black" stroke="black" points="41739.5,-162.15 41736,-152.15 41732.5,-162.15 41739.5,-162.15"/>
</g>
<!-- expert_s3_t3_g0_l19 -->
<g id="node1061" class="node">
<title>expert_s3_t3_g0_l19</title>
<polygon fill="lightgreen" stroke="black" points="53298,-423.97 53040,-423.97 53040,-382.97 53298,-382.97 53298,-423.97"/>
<text text-anchor="middle" x="53169" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;19 GPU&#45;120</text>
<text text-anchor="middle" x="53169" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53169" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g0_l20 -->
<g id="node1062" class="node">
<title>expert_s3_t3_g0_l20</title>
<polygon fill="lightgreen" stroke="black" points="53022,-423.97 52764,-423.97 52764,-382.97 53022,-382.97 53022,-423.97"/>
<text text-anchor="middle" x="52893" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;20 GPU&#45;120</text>
<text text-anchor="middle" x="52893" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52893" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g0_l21 -->
<g id="node1063" class="node">
<title>expert_s3_t3_g0_l21</title>
<polygon fill="lightgreen" stroke="black" points="52746,-423.97 52488,-423.97 52488,-382.97 52746,-382.97 52746,-423.97"/>
<text text-anchor="middle" x="52617" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;21 GPU&#45;120</text>
<text text-anchor="middle" x="52617" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52617" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g0_l22 -->
<g id="node1064" class="node">
<title>expert_s3_t3_g0_l22</title>
<polygon fill="lightgreen" stroke="black" points="52470,-423.97 52212,-423.97 52212,-382.97 52470,-382.97 52470,-423.97"/>
<text text-anchor="middle" x="52341" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;22 GPU&#45;120</text>
<text text-anchor="middle" x="52341" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52341" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g0_l23 -->
<g id="node1065" class="node">
<title>expert_s3_t3_g0_l23</title>
<polygon fill="lightgreen" stroke="black" points="52194,-423.97 51936,-423.97 51936,-382.97 52194,-382.97 52194,-423.97"/>
<text text-anchor="middle" x="52065" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;120 Layer&#45;23 GPU&#45;120</text>
<text text-anchor="middle" x="52065" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="52065" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g1 -->
<g id="node1066" class="node">
<title>attn_s3_t3_g1</title>
<polygon fill="lightgreen" stroke="black" points="43547.5,-423.97 43272.5,-423.97 43272.5,-382.97 43547.5,-382.97 43547.5,-423.97"/>
<text text-anchor="middle" x="43410" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;121</text>
<text text-anchor="middle" x="43410" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g1 -->
<g id="node1067" class="node">
<title>gate_s3_t3_g1</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="43675.32,-346.97 43253.26,-346.97 43144.68,-264.97 43566.74,-264.97 43675.32,-346.97"/>
<text text-anchor="middle" x="43410" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;121</text>
<text text-anchor="middle" x="43410" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g1&#45;&gt;gate_s3_t3_g1 -->
<g id="edge371" class="edge">
<title>attn_s3_t3_g1&#45;&gt;gate_s3_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-382.68C43410,-375.22 43410,-366.35 43410,-357.35"/>
<polygon fill="black" stroke="black" points="43413.5,-357.21 43410,-347.21 43406.5,-357.21 43413.5,-357.21"/>
</g>
<!-- expert_s3_t3_g1_l18 -->
<g id="node1068" class="node">
<title>expert_s3_t3_g1_l18</title>
<polygon fill="lightgreen" stroke="black" points="43539,-228.97 43281,-228.97 43281,-187.97 43539,-187.97 43539,-228.97"/>
<text text-anchor="middle" x="43410" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;18 GPU&#45;121</text>
<text text-anchor="middle" x="43410" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43410" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g1&#45;&gt;expert_s3_t3_g1_l18 -->
<g id="edge372" class="edge">
<title>gate_s3_t3_g1&#45;&gt;expert_s3_t3_g1_l18</title>
<path fill="none" stroke="black" d="M43410,-264.74C43410,-256.16 43410,-247.25 43410,-239.16"/>
<polygon fill="black" stroke="black" points="43413.5,-239.08 43410,-229.08 43406.5,-239.08 43413.5,-239.08"/>
</g>
<!-- comm_s3_t3_g1 -->
<g id="node1147" class="node">
<title>comm_s3_t3_g1</title>
<ellipse fill="lightblue" stroke="black" cx="43410" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="43410" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;121</text>
<text text-anchor="middle" x="43410" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="43410" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g1_l18&#45;&gt;comm_s3_t3_g1 -->
<g id="edge373" class="edge">
<title>expert_s3_t3_g1_l18&#45;&gt;comm_s3_t3_g1</title>
<path fill="none" stroke="black" d="M43410,-187.68C43410,-180.05 43410,-171.06 43410,-162.28"/>
<polygon fill="black" stroke="black" points="43413.5,-162.15 43410,-152.15 43406.5,-162.15 43413.5,-162.15"/>
</g>
<!-- expert_s3_t3_g1_l19 -->
<g id="node1069" class="node">
<title>expert_s3_t3_g1_l19</title>
<polygon fill="lightgreen" stroke="black" points="51624,-423.97 51366,-423.97 51366,-382.97 51624,-382.97 51624,-423.97"/>
<text text-anchor="middle" x="51495" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;19 GPU&#45;121</text>
<text text-anchor="middle" x="51495" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51495" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g1_l20 -->
<g id="node1070" class="node">
<title>expert_s3_t3_g1_l20</title>
<polygon fill="lightgreen" stroke="black" points="51348,-423.97 51090,-423.97 51090,-382.97 51348,-382.97 51348,-423.97"/>
<text text-anchor="middle" x="51219" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;20 GPU&#45;121</text>
<text text-anchor="middle" x="51219" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51219" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g1_l21 -->
<g id="node1071" class="node">
<title>expert_s3_t3_g1_l21</title>
<polygon fill="lightgreen" stroke="black" points="51072,-423.97 50814,-423.97 50814,-382.97 51072,-382.97 51072,-423.97"/>
<text text-anchor="middle" x="50943" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;21 GPU&#45;121</text>
<text text-anchor="middle" x="50943" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50943" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g1_l22 -->
<g id="node1072" class="node">
<title>expert_s3_t3_g1_l22</title>
<polygon fill="lightgreen" stroke="black" points="50796,-423.97 50538,-423.97 50538,-382.97 50796,-382.97 50796,-423.97"/>
<text text-anchor="middle" x="50667" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;22 GPU&#45;121</text>
<text text-anchor="middle" x="50667" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50667" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g1_l23 -->
<g id="node1073" class="node">
<title>expert_s3_t3_g1_l23</title>
<polygon fill="lightgreen" stroke="black" points="50520,-423.97 50262,-423.97 50262,-382.97 50520,-382.97 50520,-423.97"/>
<text text-anchor="middle" x="50391" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;121 Layer&#45;23 GPU&#45;121</text>
<text text-anchor="middle" x="50391" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50391" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g2 -->
<g id="node1074" class="node">
<title>attn_s3_t3_g2</title>
<polygon fill="lightgreen" stroke="black" points="45221.5,-423.97 44946.5,-423.97 44946.5,-382.97 45221.5,-382.97 45221.5,-423.97"/>
<text text-anchor="middle" x="45084" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;122</text>
<text text-anchor="middle" x="45084" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g2 -->
<g id="node1075" class="node">
<title>gate_s3_t3_g2</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="45349.32,-346.97 44927.26,-346.97 44818.68,-264.97 45240.74,-264.97 45349.32,-346.97"/>
<text text-anchor="middle" x="45084" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;122</text>
<text text-anchor="middle" x="45084" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g2&#45;&gt;gate_s3_t3_g2 -->
<g id="edge374" class="edge">
<title>attn_s3_t3_g2&#45;&gt;gate_s3_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-382.68C45084,-375.22 45084,-366.35 45084,-357.35"/>
<polygon fill="black" stroke="black" points="45087.5,-357.21 45084,-347.21 45080.5,-357.21 45087.5,-357.21"/>
</g>
<!-- expert_s3_t3_g2_l18 -->
<g id="node1076" class="node">
<title>expert_s3_t3_g2_l18</title>
<polygon fill="lightgreen" stroke="black" points="45213,-228.97 44955,-228.97 44955,-187.97 45213,-187.97 45213,-228.97"/>
<text text-anchor="middle" x="45084" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;18 GPU&#45;122</text>
<text text-anchor="middle" x="45084" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45084" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g2&#45;&gt;expert_s3_t3_g2_l18 -->
<g id="edge375" class="edge">
<title>gate_s3_t3_g2&#45;&gt;expert_s3_t3_g2_l18</title>
<path fill="none" stroke="black" d="M45084,-264.74C45084,-256.16 45084,-247.25 45084,-239.16"/>
<polygon fill="black" stroke="black" points="45087.5,-239.08 45084,-229.08 45080.5,-239.08 45087.5,-239.08"/>
</g>
<!-- comm_s3_t3_g2 -->
<g id="node1148" class="node">
<title>comm_s3_t3_g2</title>
<ellipse fill="lightblue" stroke="black" cx="45084" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="45084" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;122</text>
<text text-anchor="middle" x="45084" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="45084" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g2_l18&#45;&gt;comm_s3_t3_g2 -->
<g id="edge376" class="edge">
<title>expert_s3_t3_g2_l18&#45;&gt;comm_s3_t3_g2</title>
<path fill="none" stroke="black" d="M45084,-187.68C45084,-180.05 45084,-171.06 45084,-162.28"/>
<polygon fill="black" stroke="black" points="45087.5,-162.15 45084,-152.15 45080.5,-162.15 45087.5,-162.15"/>
</g>
<!-- expert_s3_t3_g2_l19 -->
<g id="node1077" class="node">
<title>expert_s3_t3_g2_l19</title>
<polygon fill="lightgreen" stroke="black" points="49950,-423.97 49692,-423.97 49692,-382.97 49950,-382.97 49950,-423.97"/>
<text text-anchor="middle" x="49821" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;19 GPU&#45;122</text>
<text text-anchor="middle" x="49821" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49821" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g2_l20 -->
<g id="node1078" class="node">
<title>expert_s3_t3_g2_l20</title>
<polygon fill="lightgreen" stroke="black" points="49674,-423.97 49416,-423.97 49416,-382.97 49674,-382.97 49674,-423.97"/>
<text text-anchor="middle" x="49545" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;20 GPU&#45;122</text>
<text text-anchor="middle" x="49545" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49545" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g2_l21 -->
<g id="node1079" class="node">
<title>expert_s3_t3_g2_l21</title>
<polygon fill="lightgreen" stroke="black" points="49398,-423.97 49140,-423.97 49140,-382.97 49398,-382.97 49398,-423.97"/>
<text text-anchor="middle" x="49269" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;21 GPU&#45;122</text>
<text text-anchor="middle" x="49269" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="49269" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g2_l22 -->
<g id="node1080" class="node">
<title>expert_s3_t3_g2_l22</title>
<polygon fill="lightgreen" stroke="black" points="49122,-423.97 48864,-423.97 48864,-382.97 49122,-382.97 49122,-423.97"/>
<text text-anchor="middle" x="48993" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;22 GPU&#45;122</text>
<text text-anchor="middle" x="48993" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48993" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g2_l23 -->
<g id="node1081" class="node">
<title>expert_s3_t3_g2_l23</title>
<polygon fill="lightgreen" stroke="black" points="48846,-423.97 48588,-423.97 48588,-382.97 48846,-382.97 48846,-423.97"/>
<text text-anchor="middle" x="48717" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;122 Layer&#45;23 GPU&#45;122</text>
<text text-anchor="middle" x="48717" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48717" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g3 -->
<g id="node1082" class="node">
<title>attn_s3_t3_g3</title>
<polygon fill="lightgreen" stroke="black" points="46895.5,-423.97 46620.5,-423.97 46620.5,-382.97 46895.5,-382.97 46895.5,-423.97"/>
<text text-anchor="middle" x="46758" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;123</text>
<text text-anchor="middle" x="46758" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g3 -->
<g id="node1083" class="node">
<title>gate_s3_t3_g3</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="47023.32,-346.97 46601.26,-346.97 46492.68,-264.97 46914.74,-264.97 47023.32,-346.97"/>
<text text-anchor="middle" x="46758" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;123</text>
<text text-anchor="middle" x="46758" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g3&#45;&gt;gate_s3_t3_g3 -->
<g id="edge377" class="edge">
<title>attn_s3_t3_g3&#45;&gt;gate_s3_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-382.68C46758,-375.22 46758,-366.35 46758,-357.35"/>
<polygon fill="black" stroke="black" points="46761.5,-357.21 46758,-347.21 46754.5,-357.21 46761.5,-357.21"/>
</g>
<!-- expert_s3_t3_g3_l18 -->
<g id="node1084" class="node">
<title>expert_s3_t3_g3_l18</title>
<polygon fill="lightgreen" stroke="black" points="46887,-228.97 46629,-228.97 46629,-187.97 46887,-187.97 46887,-228.97"/>
<text text-anchor="middle" x="46758" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;18 GPU&#45;123</text>
<text text-anchor="middle" x="46758" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46758" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g3&#45;&gt;expert_s3_t3_g3_l18 -->
<g id="edge378" class="edge">
<title>gate_s3_t3_g3&#45;&gt;expert_s3_t3_g3_l18</title>
<path fill="none" stroke="black" d="M46758,-264.74C46758,-256.16 46758,-247.25 46758,-239.16"/>
<polygon fill="black" stroke="black" points="46761.5,-239.08 46758,-229.08 46754.5,-239.08 46761.5,-239.08"/>
</g>
<!-- comm_s3_t3_g3 -->
<g id="node1149" class="node">
<title>comm_s3_t3_g3</title>
<ellipse fill="lightblue" stroke="black" cx="46758" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="46758" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;123</text>
<text text-anchor="middle" x="46758" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="46758" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g3_l18&#45;&gt;comm_s3_t3_g3 -->
<g id="edge379" class="edge">
<title>expert_s3_t3_g3_l18&#45;&gt;comm_s3_t3_g3</title>
<path fill="none" stroke="black" d="M46758,-187.68C46758,-180.05 46758,-171.06 46758,-162.28"/>
<polygon fill="black" stroke="black" points="46761.5,-162.15 46758,-152.15 46754.5,-162.15 46761.5,-162.15"/>
</g>
<!-- expert_s3_t3_g3_l19 -->
<g id="node1085" class="node">
<title>expert_s3_t3_g3_l19</title>
<polygon fill="lightgreen" stroke="black" points="48276,-423.97 48018,-423.97 48018,-382.97 48276,-382.97 48276,-423.97"/>
<text text-anchor="middle" x="48147" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;19 GPU&#45;123</text>
<text text-anchor="middle" x="48147" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48147" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g3_l20 -->
<g id="node1086" class="node">
<title>expert_s3_t3_g3_l20</title>
<polygon fill="lightgreen" stroke="black" points="48000,-423.97 47742,-423.97 47742,-382.97 48000,-382.97 48000,-423.97"/>
<text text-anchor="middle" x="47871" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;20 GPU&#45;123</text>
<text text-anchor="middle" x="47871" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47871" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g3_l21 -->
<g id="node1087" class="node">
<title>expert_s3_t3_g3_l21</title>
<polygon fill="lightgreen" stroke="black" points="47724,-423.97 47466,-423.97 47466,-382.97 47724,-382.97 47724,-423.97"/>
<text text-anchor="middle" x="47595" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;21 GPU&#45;123</text>
<text text-anchor="middle" x="47595" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47595" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g3_l22 -->
<g id="node1088" class="node">
<title>expert_s3_t3_g3_l22</title>
<polygon fill="lightgreen" stroke="black" points="47448,-423.97 47190,-423.97 47190,-382.97 47448,-382.97 47448,-423.97"/>
<text text-anchor="middle" x="47319" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;22 GPU&#45;123</text>
<text text-anchor="middle" x="47319" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47319" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g3_l23 -->
<g id="node1089" class="node">
<title>expert_s3_t3_g3_l23</title>
<polygon fill="lightgreen" stroke="black" points="47172,-423.97 46914,-423.97 46914,-382.97 47172,-382.97 47172,-423.97"/>
<text text-anchor="middle" x="47043" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;123 Layer&#45;23 GPU&#45;123</text>
<text text-anchor="middle" x="47043" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="47043" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g4 -->
<g id="node1090" class="node">
<title>attn_s3_t3_g4</title>
<polygon fill="lightgreen" stroke="black" points="48569.5,-423.97 48294.5,-423.97 48294.5,-382.97 48569.5,-382.97 48569.5,-423.97"/>
<text text-anchor="middle" x="48432" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;124</text>
<text text-anchor="middle" x="48432" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g4 -->
<g id="node1091" class="node">
<title>gate_s3_t3_g4</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="48697.32,-346.97 48275.26,-346.97 48166.68,-264.97 48588.74,-264.97 48697.32,-346.97"/>
<text text-anchor="middle" x="48432" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;124</text>
<text text-anchor="middle" x="48432" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g4&#45;&gt;gate_s3_t3_g4 -->
<g id="edge380" class="edge">
<title>attn_s3_t3_g4&#45;&gt;gate_s3_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-382.68C48432,-375.22 48432,-366.35 48432,-357.35"/>
<polygon fill="black" stroke="black" points="48435.5,-357.21 48432,-347.21 48428.5,-357.21 48435.5,-357.21"/>
</g>
<!-- expert_s3_t3_g4_l18 -->
<g id="node1092" class="node">
<title>expert_s3_t3_g4_l18</title>
<polygon fill="lightgreen" stroke="black" points="48561,-228.97 48303,-228.97 48303,-187.97 48561,-187.97 48561,-228.97"/>
<text text-anchor="middle" x="48432" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;18 GPU&#45;124</text>
<text text-anchor="middle" x="48432" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="48432" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g4&#45;&gt;expert_s3_t3_g4_l18 -->
<g id="edge381" class="edge">
<title>gate_s3_t3_g4&#45;&gt;expert_s3_t3_g4_l18</title>
<path fill="none" stroke="black" d="M48432,-264.74C48432,-256.16 48432,-247.25 48432,-239.16"/>
<polygon fill="black" stroke="black" points="48435.5,-239.08 48432,-229.08 48428.5,-239.08 48435.5,-239.08"/>
</g>
<!-- comm_s3_t3_g4 -->
<g id="node1150" class="node">
<title>comm_s3_t3_g4</title>
<ellipse fill="lightblue" stroke="black" cx="48432" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="48432" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;124</text>
<text text-anchor="middle" x="48432" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="48432" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g4_l18&#45;&gt;comm_s3_t3_g4 -->
<g id="edge382" class="edge">
<title>expert_s3_t3_g4_l18&#45;&gt;comm_s3_t3_g4</title>
<path fill="none" stroke="black" d="M48432,-187.68C48432,-180.05 48432,-171.06 48432,-162.28"/>
<polygon fill="black" stroke="black" points="48435.5,-162.15 48432,-152.15 48428.5,-162.15 48435.5,-162.15"/>
</g>
<!-- expert_s3_t3_g4_l19 -->
<g id="node1093" class="node">
<title>expert_s3_t3_g4_l19</title>
<polygon fill="lightgreen" stroke="black" points="46602,-423.97 46344,-423.97 46344,-382.97 46602,-382.97 46602,-423.97"/>
<text text-anchor="middle" x="46473" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;19 GPU&#45;124</text>
<text text-anchor="middle" x="46473" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46473" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g4_l20 -->
<g id="node1094" class="node">
<title>expert_s3_t3_g4_l20</title>
<polygon fill="lightgreen" stroke="black" points="46326,-423.97 46068,-423.97 46068,-382.97 46326,-382.97 46326,-423.97"/>
<text text-anchor="middle" x="46197" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;20 GPU&#45;124</text>
<text text-anchor="middle" x="46197" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="46197" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g4_l21 -->
<g id="node1095" class="node">
<title>expert_s3_t3_g4_l21</title>
<polygon fill="lightgreen" stroke="black" points="46050,-423.97 45792,-423.97 45792,-382.97 46050,-382.97 46050,-423.97"/>
<text text-anchor="middle" x="45921" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;21 GPU&#45;124</text>
<text text-anchor="middle" x="45921" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45921" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g4_l22 -->
<g id="node1096" class="node">
<title>expert_s3_t3_g4_l22</title>
<polygon fill="lightgreen" stroke="black" points="45774,-423.97 45516,-423.97 45516,-382.97 45774,-382.97 45774,-423.97"/>
<text text-anchor="middle" x="45645" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;22 GPU&#45;124</text>
<text text-anchor="middle" x="45645" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45645" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g4_l23 -->
<g id="node1097" class="node">
<title>expert_s3_t3_g4_l23</title>
<polygon fill="lightgreen" stroke="black" points="45498,-423.97 45240,-423.97 45240,-382.97 45498,-382.97 45498,-423.97"/>
<text text-anchor="middle" x="45369" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;124 Layer&#45;23 GPU&#45;124</text>
<text text-anchor="middle" x="45369" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="45369" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g5 -->
<g id="node1098" class="node">
<title>attn_s3_t3_g5</title>
<polygon fill="lightgreen" stroke="black" points="50243.5,-423.97 49968.5,-423.97 49968.5,-382.97 50243.5,-382.97 50243.5,-423.97"/>
<text text-anchor="middle" x="50106" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;125</text>
<text text-anchor="middle" x="50106" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g5 -->
<g id="node1099" class="node">
<title>gate_s3_t3_g5</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="50371.32,-346.97 49949.26,-346.97 49840.68,-264.97 50262.74,-264.97 50371.32,-346.97"/>
<text text-anchor="middle" x="50106" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;125</text>
<text text-anchor="middle" x="50106" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g5&#45;&gt;gate_s3_t3_g5 -->
<g id="edge383" class="edge">
<title>attn_s3_t3_g5&#45;&gt;gate_s3_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-382.68C50106,-375.22 50106,-366.35 50106,-357.35"/>
<polygon fill="black" stroke="black" points="50109.5,-357.21 50106,-347.21 50102.5,-357.21 50109.5,-357.21"/>
</g>
<!-- expert_s3_t3_g5_l18 -->
<g id="node1100" class="node">
<title>expert_s3_t3_g5_l18</title>
<polygon fill="lightgreen" stroke="black" points="50235,-228.97 49977,-228.97 49977,-187.97 50235,-187.97 50235,-228.97"/>
<text text-anchor="middle" x="50106" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;18 GPU&#45;125</text>
<text text-anchor="middle" x="50106" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="50106" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g5&#45;&gt;expert_s3_t3_g5_l18 -->
<g id="edge384" class="edge">
<title>gate_s3_t3_g5&#45;&gt;expert_s3_t3_g5_l18</title>
<path fill="none" stroke="black" d="M50106,-264.74C50106,-256.16 50106,-247.25 50106,-239.16"/>
<polygon fill="black" stroke="black" points="50109.5,-239.08 50106,-229.08 50102.5,-239.08 50109.5,-239.08"/>
</g>
<!-- comm_s3_t3_g5 -->
<g id="node1151" class="node">
<title>comm_s3_t3_g5</title>
<ellipse fill="lightblue" stroke="black" cx="50106" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="50106" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;125</text>
<text text-anchor="middle" x="50106" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="50106" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g5_l18&#45;&gt;comm_s3_t3_g5 -->
<g id="edge385" class="edge">
<title>expert_s3_t3_g5_l18&#45;&gt;comm_s3_t3_g5</title>
<path fill="none" stroke="black" d="M50106,-187.68C50106,-180.05 50106,-171.06 50106,-162.28"/>
<polygon fill="black" stroke="black" points="50109.5,-162.15 50106,-152.15 50102.5,-162.15 50109.5,-162.15"/>
</g>
<!-- expert_s3_t3_g5_l19 -->
<g id="node1101" class="node">
<title>expert_s3_t3_g5_l19</title>
<polygon fill="lightgreen" stroke="black" points="44928,-423.97 44670,-423.97 44670,-382.97 44928,-382.97 44928,-423.97"/>
<text text-anchor="middle" x="44799" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;19 GPU&#45;125</text>
<text text-anchor="middle" x="44799" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44799" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g5_l20 -->
<g id="node1102" class="node">
<title>expert_s3_t3_g5_l20</title>
<polygon fill="lightgreen" stroke="black" points="44652,-423.97 44394,-423.97 44394,-382.97 44652,-382.97 44652,-423.97"/>
<text text-anchor="middle" x="44523" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;20 GPU&#45;125</text>
<text text-anchor="middle" x="44523" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44523" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g5_l21 -->
<g id="node1103" class="node">
<title>expert_s3_t3_g5_l21</title>
<polygon fill="lightgreen" stroke="black" points="44376,-423.97 44118,-423.97 44118,-382.97 44376,-382.97 44376,-423.97"/>
<text text-anchor="middle" x="44247" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;21 GPU&#45;125</text>
<text text-anchor="middle" x="44247" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="44247" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g5_l22 -->
<g id="node1104" class="node">
<title>expert_s3_t3_g5_l22</title>
<polygon fill="lightgreen" stroke="black" points="44100,-423.97 43842,-423.97 43842,-382.97 44100,-382.97 44100,-423.97"/>
<text text-anchor="middle" x="43971" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;22 GPU&#45;125</text>
<text text-anchor="middle" x="43971" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43971" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g5_l23 -->
<g id="node1105" class="node">
<title>expert_s3_t3_g5_l23</title>
<polygon fill="lightgreen" stroke="black" points="43824,-423.97 43566,-423.97 43566,-382.97 43824,-382.97 43824,-423.97"/>
<text text-anchor="middle" x="43695" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;125 Layer&#45;23 GPU&#45;125</text>
<text text-anchor="middle" x="43695" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43695" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g6 -->
<g id="node1106" class="node">
<title>attn_s3_t3_g6</title>
<polygon fill="lightgreen" stroke="black" points="51917.5,-423.97 51642.5,-423.97 51642.5,-382.97 51917.5,-382.97 51917.5,-423.97"/>
<text text-anchor="middle" x="51780" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;126</text>
<text text-anchor="middle" x="51780" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g6 -->
<g id="node1107" class="node">
<title>gate_s3_t3_g6</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="52045.32,-346.97 51623.26,-346.97 51514.68,-264.97 51936.74,-264.97 52045.32,-346.97"/>
<text text-anchor="middle" x="51780" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;126</text>
<text text-anchor="middle" x="51780" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g6&#45;&gt;gate_s3_t3_g6 -->
<g id="edge386" class="edge">
<title>attn_s3_t3_g6&#45;&gt;gate_s3_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-382.68C51780,-375.22 51780,-366.35 51780,-357.35"/>
<polygon fill="black" stroke="black" points="51783.5,-357.21 51780,-347.21 51776.5,-357.21 51783.5,-357.21"/>
</g>
<!-- expert_s3_t3_g6_l18 -->
<g id="node1108" class="node">
<title>expert_s3_t3_g6_l18</title>
<polygon fill="lightgreen" stroke="black" points="51909,-228.97 51651,-228.97 51651,-187.97 51909,-187.97 51909,-228.97"/>
<text text-anchor="middle" x="51780" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;18 GPU&#45;126</text>
<text text-anchor="middle" x="51780" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="51780" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g6&#45;&gt;expert_s3_t3_g6_l18 -->
<g id="edge387" class="edge">
<title>gate_s3_t3_g6&#45;&gt;expert_s3_t3_g6_l18</title>
<path fill="none" stroke="black" d="M51780,-264.74C51780,-256.16 51780,-247.25 51780,-239.16"/>
<polygon fill="black" stroke="black" points="51783.5,-239.08 51780,-229.08 51776.5,-239.08 51783.5,-239.08"/>
</g>
<!-- comm_s3_t3_g6 -->
<g id="node1152" class="node">
<title>comm_s3_t3_g6</title>
<ellipse fill="lightblue" stroke="black" cx="51780" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="51780" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;126</text>
<text text-anchor="middle" x="51780" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="51780" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g6_l18&#45;&gt;comm_s3_t3_g6 -->
<g id="edge388" class="edge">
<title>expert_s3_t3_g6_l18&#45;&gt;comm_s3_t3_g6</title>
<path fill="none" stroke="black" d="M51780,-187.68C51780,-180.05 51780,-171.06 51780,-162.28"/>
<polygon fill="black" stroke="black" points="51783.5,-162.15 51780,-152.15 51776.5,-162.15 51783.5,-162.15"/>
</g>
<!-- expert_s3_t3_g6_l19 -->
<g id="node1109" class="node">
<title>expert_s3_t3_g6_l19</title>
<polygon fill="lightgreen" stroke="black" points="43254,-423.97 42996,-423.97 42996,-382.97 43254,-382.97 43254,-423.97"/>
<text text-anchor="middle" x="43125" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;19 GPU&#45;126</text>
<text text-anchor="middle" x="43125" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="43125" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g6_l20 -->
<g id="node1110" class="node">
<title>expert_s3_t3_g6_l20</title>
<polygon fill="lightgreen" stroke="black" points="42978,-423.97 42720,-423.97 42720,-382.97 42978,-382.97 42978,-423.97"/>
<text text-anchor="middle" x="42849" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;20 GPU&#45;126</text>
<text text-anchor="middle" x="42849" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42849" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g6_l21 -->
<g id="node1111" class="node">
<title>expert_s3_t3_g6_l21</title>
<polygon fill="lightgreen" stroke="black" points="42702,-423.97 42444,-423.97 42444,-382.97 42702,-382.97 42702,-423.97"/>
<text text-anchor="middle" x="42573" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;21 GPU&#45;126</text>
<text text-anchor="middle" x="42573" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42573" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g6_l22 -->
<g id="node1112" class="node">
<title>expert_s3_t3_g6_l22</title>
<polygon fill="lightgreen" stroke="black" points="42426,-423.97 42168,-423.97 42168,-382.97 42426,-382.97 42426,-423.97"/>
<text text-anchor="middle" x="42297" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;22 GPU&#45;126</text>
<text text-anchor="middle" x="42297" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42297" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g6_l23 -->
<g id="node1113" class="node">
<title>expert_s3_t3_g6_l23</title>
<polygon fill="lightgreen" stroke="black" points="42150,-423.97 41892,-423.97 41892,-382.97 42150,-382.97 42150,-423.97"/>
<text text-anchor="middle" x="42021" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;126 Layer&#45;23 GPU&#45;126</text>
<text text-anchor="middle" x="42021" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="42021" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- attn_s3_t3_g7 -->
<g id="node1114" class="node">
<title>attn_s3_t3_g7</title>
<polygon fill="lightgreen" stroke="black" points="53591.5,-423.97 53316.5,-423.97 53316.5,-382.97 53591.5,-382.97 53591.5,-423.97"/>
<text text-anchor="middle" x="53454" y="-411.97" font-family="Arial" font-size="10.00">Attention GPU&#45;127</text>
<text text-anchor="middle" x="53454" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53454" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- gate_s3_t3_g7 -->
<g id="node1115" class="node">
<title>gate_s3_t3_g7</title>
<polygon fill="lightyellow" stroke="black" stroke-dasharray="5,2" points="53592.32,-346.97 53170.26,-346.97 53061.68,-264.97 53483.74,-264.97 53592.32,-346.97"/>
<text text-anchor="middle" x="53327" y="-314.47" font-family="Arial" font-size="10.00">Gate GPU&#45;127</text>
<text text-anchor="middle" x="53327" y="-303.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-292.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, expert_ids=1]</text>
</g>
<!-- attn_s3_t3_g7&#45;&gt;gate_s3_t3_g7 -->
<g id="edge389" class="edge">
<title>attn_s3_t3_g7&#45;&gt;gate_s3_t3_g7</title>
<path fill="none" stroke="black" d="M53427.99,-382.91C53416.47,-374.24 53402.37,-363.64 53388.41,-353.15"/>
<polygon fill="black" stroke="black" points="53390.33,-350.21 53380.23,-346.99 53386.12,-355.8 53390.33,-350.21"/>
</g>
<!-- expert_s3_t3_g7_l18 -->
<g id="node1116" class="node">
<title>expert_s3_t3_g7_l18</title>
<polygon fill="lightgreen" stroke="black" points="53456,-228.97 53198,-228.97 53198,-187.97 53456,-187.97 53456,-228.97"/>
<text text-anchor="middle" x="53327" y="-216.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;18 GPU&#45;127</text>
<text text-anchor="middle" x="53327" y="-205.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="53327" y="-194.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- gate_s3_t3_g7&#45;&gt;expert_s3_t3_g7_l18 -->
<g id="edge390" class="edge">
<title>gate_s3_t3_g7&#45;&gt;expert_s3_t3_g7_l18</title>
<path fill="none" stroke="black" d="M53327,-264.74C53327,-256.16 53327,-247.25 53327,-239.16"/>
<polygon fill="black" stroke="black" points="53330.5,-239.08 53327,-229.08 53323.5,-239.08 53330.5,-239.08"/>
</g>
<!-- comm_s3_t3_g7 -->
<g id="node1153" class="node">
<title>comm_s3_t3_g7</title>
<ellipse fill="lightblue" stroke="black" cx="53327" cy="-122.97" rx="194.41" ry="28.98"/>
<text text-anchor="middle" x="53327" y="-131.47" font-family="Arial" font-size="10.00">TP All&#45;Reduce GPU&#45;127</text>
<text text-anchor="middle" x="53327" y="-120.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="53327" y="-109.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, heads=8, d_k=64]</text>
</g>
<!-- expert_s3_t3_g7_l18&#45;&gt;comm_s3_t3_g7 -->
<g id="edge391" class="edge">
<title>expert_s3_t3_g7_l18&#45;&gt;comm_s3_t3_g7</title>
<path fill="none" stroke="black" d="M53327,-187.68C53327,-180.05 53327,-171.06 53327,-162.28"/>
<polygon fill="black" stroke="black" points="53330.5,-162.15 53327,-152.15 53323.5,-162.15 53330.5,-162.15"/>
</g>
<!-- expert_s3_t3_g7_l19 -->
<g id="node1117" class="node">
<title>expert_s3_t3_g7_l19</title>
<polygon fill="lightgreen" stroke="black" points="41580,-423.97 41322,-423.97 41322,-382.97 41580,-382.97 41580,-423.97"/>
<text text-anchor="middle" x="41451" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;19 GPU&#45;127</text>
<text text-anchor="middle" x="41451" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41451" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g7_l20 -->
<g id="node1118" class="node">
<title>expert_s3_t3_g7_l20</title>
<polygon fill="lightgreen" stroke="black" points="41304,-423.97 41046,-423.97 41046,-382.97 41304,-382.97 41304,-423.97"/>
<text text-anchor="middle" x="41175" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;20 GPU&#45;127</text>
<text text-anchor="middle" x="41175" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="41175" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g7_l21 -->
<g id="node1119" class="node">
<title>expert_s3_t3_g7_l21</title>
<polygon fill="lightgreen" stroke="black" points="41028,-423.97 40770,-423.97 40770,-382.97 41028,-382.97 41028,-423.97"/>
<text text-anchor="middle" x="40899" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;21 GPU&#45;127</text>
<text text-anchor="middle" x="40899" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40899" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g7_l22 -->
<g id="node1120" class="node">
<title>expert_s3_t3_g7_l22</title>
<polygon fill="lightgreen" stroke="black" points="40752,-423.97 40494,-423.97 40494,-382.97 40752,-382.97 40752,-423.97"/>
<text text-anchor="middle" x="40623" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;22 GPU&#45;127</text>
<text text-anchor="middle" x="40623" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40623" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- expert_s3_t3_g7_l23 -->
<g id="node1121" class="node">
<title>expert_s3_t3_g7_l23</title>
<polygon fill="lightgreen" stroke="black" points="40476,-423.97 40218,-423.97 40218,-382.97 40476,-382.97 40476,-423.97"/>
<text text-anchor="middle" x="40347" y="-411.97" font-family="Arial" font-size="10.00">Expert&#45;127 Layer&#45;23 GPU&#45;127</text>
<text text-anchor="middle" x="40347" y="-400.97" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=1024, d_model=512]</text>
<text text-anchor="middle" x="40347" y="-389.97" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=1024, d_model=512]</text>
</g>
<!-- output -->
<g id="node1157" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="1542" cy="-28.99" rx="198.89" ry="28.98"/>
<text text-anchor="middle" x="1542" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="1542" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="1542" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- comm_s3_t0_g0&#45;&gt;output -->
<g id="edge392" class="edge">
<title>comm_s3_t0_g0&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1542,-93.88C1542,-85.84 1542,-76.94 1542,-68.39"/>
<polygon fill="black" stroke="black" points="1545.5,-68.23 1542,-58.23 1538.5,-68.23 1545.5,-68.23"/>
</g>
<!-- pipeline_comm_s0&#45;&gt;attn_s1_t0_g0 -->
<g id="edge99" class="edge">
<title>pipeline_comm_s0&#45;&gt;attn_s1_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-1481.75C1542,-1463.81 1542,-1440.6 1542,-1422.33"/>
<polygon fill="black" stroke="black" points="1545.5,-1422.22 1542,-1412.22 1538.5,-1422.22 1545.5,-1422.22"/>
</g>
<!-- pipeline_comm_s1&#45;&gt;attn_s2_t0_g0 -->
<g id="edge197" class="edge">
<title>pipeline_comm_s1&#45;&gt;attn_s2_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-987.78C1542,-969.85 1542,-946.64 1542,-928.36"/>
<polygon fill="black" stroke="black" points="1545.5,-928.26 1542,-918.26 1538.5,-928.26 1545.5,-928.26"/>
</g>
<!-- pipeline_comm_s2&#45;&gt;attn_s3_t0_g0 -->
<g id="edge295" class="edge">
<title>pipeline_comm_s2&#45;&gt;attn_s3_t0_g0</title>
<path fill="none" stroke="black" d="M1542,-493.81C1542,-475.88 1542,-452.67 1542,-434.4"/>
<polygon fill="black" stroke="black" points="1545.5,-434.29 1542,-424.29 1538.5,-434.29 1545.5,-434.29"/>
</g>
</g>
</svg>
