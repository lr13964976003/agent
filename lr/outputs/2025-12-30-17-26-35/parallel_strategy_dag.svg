<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="1804pt"
 viewBox="0.00 0.00 2160.00 432.98" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.5 0.5) rotate(0) translate(4 3574.93)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3574.93 17850,-3574.93 17850,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<path fill="none" stroke="black" d="M9435,-2740.85C9435,-2740.85 17826,-2740.85 17826,-2740.85 17832,-2740.85 17838,-2746.85 17838,-2752.85 17838,-2752.85 17838,-3509.93 17838,-3509.93 17838,-3515.93 17832,-3521.93 17826,-3521.93 17826,-3521.93 9435,-3521.93 9435,-3521.93 9429,-3521.93 9423,-3515.93 9423,-3509.93 9423,-3509.93 9423,-2752.85 9423,-2752.85 9423,-2746.85 9429,-2740.85 9435,-2740.85"/>
<text text-anchor="middle" x="13630.5" y="-3506.73" font-family="Times,serif" font-size="14.00">Pipeline Stage 0: Layers 0&#45;23</text>
<text text-anchor="middle" x="13630.5" y="-3491.73" font-family="Times,serif" font-size="14.00">GPUs: 0&#45;31</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<path fill="none" stroke="black" d="M6280,-1850.23C6280,-1850.23 14671,-1850.23 14671,-1850.23 14677,-1850.23 14683,-1856.23 14683,-1862.23 14683,-1862.23 14683,-2619.31 14683,-2619.31 14683,-2625.31 14677,-2631.31 14671,-2631.31 14671,-2631.31 6280,-2631.31 6280,-2631.31 6274,-2631.31 6268,-2625.31 6268,-2619.31 6268,-2619.31 6268,-1862.23 6268,-1862.23 6268,-1856.23 6274,-1850.23 6280,-1850.23"/>
<text text-anchor="middle" x="10475.5" y="-2616.11" font-family="Times,serif" font-size="14.00">Pipeline Stage 1: Layers 24&#45;47</text>
<text text-anchor="middle" x="10475.5" y="-2601.11" font-family="Times,serif" font-size="14.00">GPUs: 32&#45;63</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<path fill="none" stroke="black" d="M3150,-959.62C3150,-959.62 11541,-959.62 11541,-959.62 11547,-959.62 11553,-965.62 11553,-971.62 11553,-971.62 11553,-1728.7 11553,-1728.7 11553,-1734.7 11547,-1740.7 11541,-1740.7 11541,-1740.7 3150,-1740.7 3150,-1740.7 3144,-1740.7 3138,-1734.7 3138,-1728.7 3138,-1728.7 3138,-971.62 3138,-971.62 3138,-965.62 3144,-959.62 3150,-959.62"/>
<text text-anchor="middle" x="7345.5" y="-1725.5" font-family="Times,serif" font-size="14.00">Pipeline Stage 2: Layers 48&#45;71</text>
<text text-anchor="middle" x="7345.5" y="-1710.5" font-family="Times,serif" font-size="14.00">GPUs: 64&#45;95</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage3</title>
<path fill="none" stroke="black" d="M20,-69C20,-69 8411,-69 8411,-69 8417,-69 8423,-75 8423,-81 8423,-81 8423,-838.08 8423,-838.08 8423,-844.08 8417,-850.08 8411,-850.08 8411,-850.08 20,-850.08 20,-850.08 14,-850.08 8,-844.08 8,-838.08 8,-838.08 8,-81 8,-81 8,-75 14,-69 20,-69"/>
<text text-anchor="middle" x="4215.5" y="-834.88" font-family="Times,serif" font-size="14.00">Pipeline Stage 3: Layers 72&#45;93</text>
<text text-anchor="middle" x="4215.5" y="-819.88" font-family="Times,serif" font-size="14.00">GPUs: 96&#45;127</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgray" stroke="black" points="13757.5,-3570.93 13502.5,-3570.93 13502.5,-3529.93 13757.5,-3529.93 13757.5,-3570.93"/>
<text text-anchor="middle" x="13630" y="-3558.93" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="13630" y="-3547.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="13630" y="-3536.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- embed_0 -->
<g id="node2" class="node">
<title>embed_0</title>
<polygon fill="lightblue" stroke="black" points="13757.5,-3475.93 13502.5,-3475.93 13502.5,-3423.93 13757.5,-3423.93 13757.5,-3475.93"/>
<text text-anchor="middle" x="13630" y="-3463.93" font-family="Arial" font-size="10.00">Token Embedding</text>
<text text-anchor="middle" x="13630" y="-3452.93" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13630" y="-3441.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="13630" y="-3430.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- input&#45;&gt;embed_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed_0</title>
<path fill="none" stroke="black" d="M13630,-3529.5C13630,-3517.1 13630,-3500.81 13630,-3486.28"/>
<polygon fill="black" stroke="black" points="13633.5,-3486.09 13630,-3476.09 13626.5,-3486.09 13633.5,-3486.09"/>
</g>
<!-- gate_0 -->
<g id="node3" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="13887.23,-3387.93 13478.03,-3387.93 13372.77,-3283.93 13781.97,-3283.93 13887.23,-3387.93"/>
<text text-anchor="middle" x="13630" y="-3349.93" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="13630" y="-3338.93" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="13630" y="-3327.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="13630" y="-3316.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=32]</text>
</g>
<!-- embed_0&#45;&gt;gate_0 -->
<g id="edge2" class="edge">
<title>embed_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M13630,-3423.8C13630,-3416.11 13630,-3407.3 13630,-3398.3"/>
<polygon fill="black" stroke="black" points="13633.5,-3398.11 13630,-3388.11 13626.5,-3398.11 13633.5,-3398.11"/>
</g>
<!-- route_0 -->
<g id="node4" class="node">
<title>route_0</title>
<ellipse fill="lightgreen" stroke="black" cx="13630" cy="-3211.16" rx="171.65" ry="36.54"/>
<text text-anchor="middle" x="13630" y="-3225.16" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="13630" y="-3214.16" font-family="Arial" font-size="10.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="13630" y="-3203.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=32]</text>
<text text-anchor="middle" x="13630" y="-3192.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=1]</text>
</g>
<!-- gate_0&#45;&gt;route_0 -->
<g id="edge3" class="edge">
<title>gate_0&#45;&gt;route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13630,-3283.58C13630,-3275.17 13630,-3266.5 13630,-3258.23"/>
<polygon fill="black" stroke="black" points="13633.5,-3258.02 13630,-3248.02 13626.5,-3258.02 13633.5,-3258.02"/>
</g>
<!-- expert_0 -->
<g id="node5" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="9676.5,-3138.39 9431.5,-3138.39 9431.5,-3086.39 9676.5,-3086.39 9676.5,-3138.39"/>
<text text-anchor="middle" x="9554" y="-3126.39" font-family="Arial" font-size="10.00">Expert 0 Computation</text>
<text text-anchor="middle" x="9554" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 0</text>
<text text-anchor="middle" x="9554" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9554" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_0 -->
<g id="edge4" class="edge">
<title>route_0&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M13458.28,-3208.75C12754.48,-3202.73 10108.25,-3177.74 9686.62,-3138.31"/>
<polygon fill="black" stroke="black" points="9686.8,-3134.81 9676.51,-3137.32 9686.12,-3141.78 9686.8,-3134.81"/>
</g>
<!-- expert_1 -->
<g id="node6" class="node">
<title>expert_1</title>
<polygon fill="lightblue" stroke="black" points="9939.5,-3138.39 9694.5,-3138.39 9694.5,-3086.39 9939.5,-3086.39 9939.5,-3138.39"/>
<text text-anchor="middle" x="9817" y="-3126.39" font-family="Arial" font-size="10.00">Expert 1 Computation</text>
<text text-anchor="middle" x="9817" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 1</text>
<text text-anchor="middle" x="9817" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9817" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_1 -->
<g id="edge5" class="edge">
<title>route_0&#45;&gt;expert_1</title>
<path fill="none" stroke="black" d="M13457.93,-3210.63C12830.17,-3211.77 10663.26,-3210.32 9949.65,-3138.35"/>
<polygon fill="black" stroke="black" points="9949.81,-3134.85 9939.51,-3137.32 9949.1,-3141.82 9949.81,-3134.85"/>
</g>
<!-- expert_2 -->
<g id="node7" class="node">
<title>expert_2</title>
<polygon fill="lightblue" stroke="black" points="10202.5,-3138.39 9957.5,-3138.39 9957.5,-3086.39 10202.5,-3086.39 10202.5,-3138.39"/>
<text text-anchor="middle" x="10080" y="-3126.39" font-family="Arial" font-size="10.00">Expert 2 Computation</text>
<text text-anchor="middle" x="10080" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 2</text>
<text text-anchor="middle" x="10080" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10080" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_2 -->
<g id="edge6" class="edge">
<title>route_0&#45;&gt;expert_2</title>
<path fill="none" stroke="black" d="M13458.19,-3210.33C12860.35,-3210.33 10872.11,-3205.26 10212.6,-3138.35"/>
<polygon fill="black" stroke="black" points="10212.81,-3134.85 10202.51,-3137.31 10212.1,-3141.82 10212.81,-3134.85"/>
</g>
<!-- expert_3 -->
<g id="node8" class="node">
<title>expert_3</title>
<polygon fill="lightblue" stroke="black" points="10465.5,-3138.39 10220.5,-3138.39 10220.5,-3086.39 10465.5,-3086.39 10465.5,-3138.39"/>
<text text-anchor="middle" x="10343" y="-3126.39" font-family="Arial" font-size="10.00">Expert 3 Computation</text>
<text text-anchor="middle" x="10343" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 3</text>
<text text-anchor="middle" x="10343" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10343" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_3 -->
<g id="edge7" class="edge">
<title>route_0&#45;&gt;expert_3</title>
<path fill="none" stroke="black" d="M13458.22,-3209.98C12891.16,-3208.78 11081.22,-3200.19 10475.65,-3138.35"/>
<polygon fill="black" stroke="black" points="10475.82,-3134.85 10465.51,-3137.3 10475.09,-3141.82 10475.82,-3134.85"/>
</g>
<!-- expert_4 -->
<g id="node9" class="node">
<title>expert_4</title>
<polygon fill="lightblue" stroke="black" points="10728.5,-3138.39 10483.5,-3138.39 10483.5,-3086.39 10728.5,-3086.39 10728.5,-3138.39"/>
<text text-anchor="middle" x="10606" y="-3126.39" font-family="Arial" font-size="10.00">Expert 4 Computation</text>
<text text-anchor="middle" x="10606" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 4</text>
<text text-anchor="middle" x="10606" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10606" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_4 -->
<g id="edge8" class="edge">
<title>route_0&#45;&gt;expert_4</title>
<path fill="none" stroke="black" d="M13458.12,-3209.56C12923,-3207.11 11290.13,-3195.14 10738.55,-3138.34"/>
<polygon fill="black" stroke="black" points="10738.82,-3134.85 10728.51,-3137.29 10738.09,-3141.82 10738.82,-3134.85"/>
</g>
<!-- expert_5 -->
<g id="node10" class="node">
<title>expert_5</title>
<polygon fill="lightblue" stroke="black" points="10991.5,-3138.39 10746.5,-3138.39 10746.5,-3086.39 10991.5,-3086.39 10991.5,-3138.39"/>
<text text-anchor="middle" x="10869" y="-3126.39" font-family="Arial" font-size="10.00">Expert 5 Computation</text>
<text text-anchor="middle" x="10869" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 5</text>
<text text-anchor="middle" x="10869" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10869" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_5 -->
<g id="edge9" class="edge">
<title>route_0&#45;&gt;expert_5</title>
<path fill="none" stroke="black" d="M13458.36,-3209.06C12957.06,-3205.28 11499.76,-3190.13 11001.66,-3138.36"/>
<polygon fill="black" stroke="black" points="11001.82,-3134.85 10991.51,-3137.28 11001.09,-3141.82 11001.82,-3134.85"/>
</g>
<!-- expert_6 -->
<g id="node11" class="node">
<title>expert_6</title>
<polygon fill="lightblue" stroke="black" points="11254.5,-3138.39 11009.5,-3138.39 11009.5,-3086.39 11254.5,-3086.39 11254.5,-3138.39"/>
<text text-anchor="middle" x="11132" y="-3126.39" font-family="Arial" font-size="10.00">Expert 6 Computation</text>
<text text-anchor="middle" x="11132" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 6</text>
<text text-anchor="middle" x="11132" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11132" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_6 -->
<g id="edge10" class="edge">
<title>route_0&#45;&gt;expert_6</title>
<path fill="none" stroke="black" d="M13458.58,-3208.45C12992.7,-3203.26 11709.13,-3185.13 11264.54,-3138.35"/>
<polygon fill="black" stroke="black" points="11264.83,-3134.86 11254.51,-3137.27 11264.08,-3141.82 11264.83,-3134.86"/>
</g>
<!-- expert_7 -->
<g id="node12" class="node">
<title>expert_7</title>
<polygon fill="lightblue" stroke="black" points="11517.5,-3138.39 11272.5,-3138.39 11272.5,-3086.39 11517.5,-3086.39 11517.5,-3138.39"/>
<text text-anchor="middle" x="11395" y="-3126.39" font-family="Arial" font-size="10.00">Expert 7 Computation</text>
<text text-anchor="middle" x="11395" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 7</text>
<text text-anchor="middle" x="11395" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11395" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_7 -->
<g id="edge11" class="edge">
<title>route_0&#45;&gt;expert_7</title>
<path fill="none" stroke="black" d="M13458.76,-3207.7C13030.27,-3201 11918.82,-3180.15 11527.47,-3138.34"/>
<polygon fill="black" stroke="black" points="11527.83,-3134.86 11517.51,-3137.25 11527.07,-3141.82 11527.83,-3134.86"/>
</g>
<!-- expert_8 -->
<g id="node13" class="node">
<title>expert_8</title>
<polygon fill="lightblue" stroke="black" points="11780.5,-3138.39 11535.5,-3138.39 11535.5,-3086.39 11780.5,-3086.39 11780.5,-3138.39"/>
<text text-anchor="middle" x="11658" y="-3126.39" font-family="Arial" font-size="10.00">Expert 8 Computation</text>
<text text-anchor="middle" x="11658" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 8</text>
<text text-anchor="middle" x="11658" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11658" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_8 -->
<g id="edge12" class="edge">
<title>route_0&#45;&gt;expert_8</title>
<path fill="none" stroke="black" d="M13459.21,-3206.74C13070.74,-3198.43 12129.22,-3175.22 11790.6,-3138.36"/>
<polygon fill="black" stroke="black" points="11790.84,-3134.86 11780.52,-3137.23 11790.07,-3141.82 11790.84,-3134.86"/>
</g>
<!-- expert_9 -->
<g id="node14" class="node">
<title>expert_9</title>
<polygon fill="lightblue" stroke="black" points="12043.5,-3138.39 11798.5,-3138.39 11798.5,-3086.39 12043.5,-3086.39 12043.5,-3138.39"/>
<text text-anchor="middle" x="11921" y="-3126.39" font-family="Arial" font-size="10.00">Expert 9 Computation</text>
<text text-anchor="middle" x="11921" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 9</text>
<text text-anchor="middle" x="11921" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11921" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_9 -->
<g id="edge13" class="edge">
<title>route_0&#45;&gt;expert_9</title>
<path fill="none" stroke="black" d="M13458.13,-3210.29C13169.57,-3208.74 12569.51,-3197.96 12053.77,-3138.4"/>
<polygon fill="black" stroke="black" points="12053.86,-3134.88 12043.52,-3137.21 12053.05,-3141.84 12053.86,-3134.88"/>
</g>
<!-- expert_10 -->
<g id="node15" class="node">
<title>expert_10</title>
<polygon fill="lightblue" stroke="black" points="12306.5,-3138.39 12061.5,-3138.39 12061.5,-3086.39 12306.5,-3086.39 12306.5,-3138.39"/>
<text text-anchor="middle" x="12184" y="-3126.39" font-family="Arial" font-size="10.00">Expert 10 Computation</text>
<text text-anchor="middle" x="12184" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 10</text>
<text text-anchor="middle" x="12184" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12184" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_10 -->
<g id="edge14" class="edge">
<title>route_0&#45;&gt;expert_10</title>
<path fill="none" stroke="black" d="M13458.75,-3208.04C13209.37,-3203.33 12731.73,-3188.19 12316.63,-3138.39"/>
<polygon fill="black" stroke="black" points="12316.87,-3134.89 12306.52,-3137.17 12316.03,-3141.84 12316.87,-3134.89"/>
</g>
<!-- expert_11 -->
<g id="node16" class="node">
<title>expert_11</title>
<polygon fill="lightblue" stroke="black" points="12569.5,-3138.39 12324.5,-3138.39 12324.5,-3086.39 12569.5,-3086.39 12569.5,-3138.39"/>
<text text-anchor="middle" x="12447" y="-3126.39" font-family="Arial" font-size="10.00">Expert 11 Computation</text>
<text text-anchor="middle" x="12447" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 11</text>
<text text-anchor="middle" x="12447" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12447" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_11 -->
<g id="edge15" class="edge">
<title>route_0&#45;&gt;expert_11</title>
<path fill="none" stroke="black" d="M13460.56,-3204.8C13254.56,-3196.86 12896.31,-3178.53 12579.83,-3138.42"/>
<polygon fill="black" stroke="black" points="12579.89,-3134.9 12569.53,-3137.11 12579.01,-3141.85 12579.89,-3134.9"/>
</g>
<!-- expert_12 -->
<g id="node17" class="node">
<title>expert_12</title>
<polygon fill="lightblue" stroke="black" points="12832.5,-3138.39 12587.5,-3138.39 12587.5,-3086.39 12832.5,-3086.39 12832.5,-3138.39"/>
<text text-anchor="middle" x="12710" y="-3126.39" font-family="Arial" font-size="10.00">Expert 12 Computation</text>
<text text-anchor="middle" x="12710" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 12</text>
<text text-anchor="middle" x="12710" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12710" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_12 -->
<g id="edge16" class="edge">
<title>route_0&#45;&gt;expert_12</title>
<path fill="none" stroke="black" d="M13466.1,-3199.86C13308.76,-3188.89 13064.32,-3169.05 12842.74,-3138.43"/>
<polygon fill="black" stroke="black" points="12842.93,-3134.93 12832.54,-3137.02 12841.97,-3141.86 12842.93,-3134.93"/>
</g>
<!-- expert_13 -->
<g id="node18" class="node">
<title>expert_13</title>
<polygon fill="lightblue" stroke="black" points="13095.5,-3138.39 12850.5,-3138.39 12850.5,-3086.39 13095.5,-3086.39 13095.5,-3138.39"/>
<text text-anchor="middle" x="12973" y="-3126.39" font-family="Arial" font-size="10.00">Expert 13 Computation</text>
<text text-anchor="middle" x="12973" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 13</text>
<text text-anchor="middle" x="12973" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12973" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_13 -->
<g id="edge17" class="edge">
<title>route_0&#45;&gt;expert_13</title>
<path fill="none" stroke="black" d="M13482.89,-3192.1C13380.04,-3178.99 13239.3,-3160.07 13105.6,-3138.45"/>
<polygon fill="black" stroke="black" points="13106,-3134.98 13095.57,-3136.83 13104.88,-3141.88 13106,-3134.98"/>
</g>
<!-- expert_14 -->
<g id="node19" class="node">
<title>expert_14</title>
<polygon fill="lightblue" stroke="black" points="13358.5,-3138.39 13113.5,-3138.39 13113.5,-3086.39 13358.5,-3086.39 13358.5,-3138.39"/>
<text text-anchor="middle" x="13236" y="-3126.39" font-family="Arial" font-size="10.00">Expert 14 Computation</text>
<text text-anchor="middle" x="13236" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 14</text>
<text text-anchor="middle" x="13236" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13236" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_14 -->
<g id="edge18" class="edge">
<title>route_0&#45;&gt;expert_14</title>
<path fill="none" stroke="black" d="M13519.2,-3182.95C13465.63,-3169.79 13401.47,-3154.03 13347.78,-3140.84"/>
<polygon fill="black" stroke="black" points="13348.42,-3137.4 13337.88,-3138.41 13346.75,-3144.2 13348.42,-3137.4"/>
</g>
<!-- expert_15 -->
<g id="node20" class="node">
<title>expert_15</title>
<polygon fill="lightblue" stroke="black" points="13621.5,-3138.39 13376.5,-3138.39 13376.5,-3086.39 13621.5,-3086.39 13621.5,-3138.39"/>
<text text-anchor="middle" x="13499" y="-3126.39" font-family="Arial" font-size="10.00">Expert 15 Computation</text>
<text text-anchor="middle" x="13499" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 15</text>
<text text-anchor="middle" x="13499" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13499" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_15 -->
<g id="edge19" class="edge">
<title>route_0&#45;&gt;expert_15</title>
<path fill="none" stroke="black" d="M13583.08,-3175.5C13569.34,-3165.35 13554.41,-3154.32 13540.99,-3144.41"/>
<polygon fill="black" stroke="black" points="13542.99,-3141.53 13532.86,-3138.41 13538.83,-3147.16 13542.99,-3141.53"/>
</g>
<!-- expert_16 -->
<g id="node21" class="node">
<title>expert_16</title>
<polygon fill="lightblue" stroke="black" points="13884.5,-3138.39 13639.5,-3138.39 13639.5,-3086.39 13884.5,-3086.39 13884.5,-3138.39"/>
<text text-anchor="middle" x="13762" y="-3126.39" font-family="Arial" font-size="10.00">Expert 16 Computation</text>
<text text-anchor="middle" x="13762" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 16</text>
<text text-anchor="middle" x="13762" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13762" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_16 -->
<g id="edge20" class="edge">
<title>route_0&#45;&gt;expert_16</title>
<path fill="none" stroke="black" d="M13676.91,-3175.77C13690.78,-3165.6 13705.88,-3154.53 13719.46,-3144.58"/>
<polygon fill="black" stroke="black" points="13721.69,-3147.28 13727.69,-3138.55 13717.55,-3141.64 13721.69,-3147.28"/>
</g>
<!-- expert_17 -->
<g id="node22" class="node">
<title>expert_17</title>
<polygon fill="lightblue" stroke="black" points="14147.5,-3138.39 13902.5,-3138.39 13902.5,-3086.39 14147.5,-3086.39 14147.5,-3138.39"/>
<text text-anchor="middle" x="14025" y="-3126.39" font-family="Arial" font-size="10.00">Expert 17 Computation</text>
<text text-anchor="middle" x="14025" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 17</text>
<text text-anchor="middle" x="14025" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14025" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_17 -->
<g id="edge21" class="edge">
<title>route_0&#45;&gt;expert_17</title>
<path fill="none" stroke="black" d="M13740.82,-3183.01C13794.53,-3169.85 13858.91,-3154.08 13912.8,-3140.88"/>
<polygon fill="black" stroke="black" points="13913.85,-3144.22 13922.73,-3138.45 13912.19,-3137.43 13913.85,-3144.22"/>
</g>
<!-- expert_18 -->
<g id="node23" class="node">
<title>expert_18</title>
<polygon fill="lightblue" stroke="black" points="14410.5,-3138.39 14165.5,-3138.39 14165.5,-3086.39 14410.5,-3086.39 14410.5,-3138.39"/>
<text text-anchor="middle" x="14288" y="-3126.39" font-family="Arial" font-size="10.00">Expert 18 Computation</text>
<text text-anchor="middle" x="14288" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 18</text>
<text text-anchor="middle" x="14288" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14288" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_18 -->
<g id="edge22" class="edge">
<title>route_0&#45;&gt;expert_18</title>
<path fill="none" stroke="black" d="M13777.4,-3192.22C13880.66,-3179.14 14022.09,-3160.22 14155.32,-3138.64"/>
<polygon fill="black" stroke="black" points="14156,-3142.07 14165.31,-3137.01 14154.88,-3135.16 14156,-3142.07"/>
</g>
<!-- expert_19 -->
<g id="node24" class="node">
<title>expert_19</title>
<polygon fill="lightblue" stroke="black" points="14673.5,-3138.39 14428.5,-3138.39 14428.5,-3086.39 14673.5,-3086.39 14673.5,-3138.39"/>
<text text-anchor="middle" x="14551" y="-3126.39" font-family="Arial" font-size="10.00">Expert 19 Computation</text>
<text text-anchor="middle" x="14551" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 19</text>
<text text-anchor="middle" x="14551" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14551" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_19 -->
<g id="edge23" class="edge">
<title>route_0&#45;&gt;expert_19</title>
<path fill="none" stroke="black" d="M13793.94,-3199.97C13951.67,-3189.08 14196.96,-3169.28 14418.15,-3138.6"/>
<polygon fill="black" stroke="black" points="14418.92,-3142.03 14428.34,-3137.18 14417.95,-3135.09 14418.92,-3142.03"/>
</g>
<!-- expert_20 -->
<g id="node25" class="node">
<title>expert_20</title>
<polygon fill="lightblue" stroke="black" points="14936.5,-3138.39 14691.5,-3138.39 14691.5,-3086.39 14936.5,-3086.39 14936.5,-3138.39"/>
<text text-anchor="middle" x="14814" y="-3126.39" font-family="Arial" font-size="10.00">Expert 20 Computation</text>
<text text-anchor="middle" x="14814" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 20</text>
<text text-anchor="middle" x="14814" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14814" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_20 -->
<g id="edge24" class="edge">
<title>route_0&#45;&gt;expert_20</title>
<path fill="none" stroke="black" d="M13799.77,-3204.89C14006.17,-3197.04 14365.11,-3178.8 14681.07,-3138.58"/>
<polygon fill="black" stroke="black" points="14681.87,-3142.01 14691.35,-3137.26 14680.98,-3135.06 14681.87,-3142.01"/>
</g>
<!-- expert_21 -->
<g id="node26" class="node">
<title>expert_21</title>
<polygon fill="lightblue" stroke="black" points="15199.5,-3138.39 14954.5,-3138.39 14954.5,-3086.39 15199.5,-3086.39 15199.5,-3138.39"/>
<text text-anchor="middle" x="15077" y="-3126.39" font-family="Arial" font-size="10.00">Expert 21 Computation</text>
<text text-anchor="middle" x="15077" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 21</text>
<text text-anchor="middle" x="15077" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="15077" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_21 -->
<g id="edge25" class="edge">
<title>route_0&#45;&gt;expert_21</title>
<path fill="none" stroke="black" d="M13801.26,-3208.14C14050.96,-3203.55 14529.53,-3188.55 14944.26,-3138.54"/>
<polygon fill="black" stroke="black" points="14944.85,-3141.99 14954.35,-3137.31 14944,-3135.04 14944.85,-3141.99"/>
</g>
<!-- expert_22 -->
<g id="node27" class="node">
<title>expert_22</title>
<polygon fill="lightblue" stroke="black" points="15462.5,-3138.39 15217.5,-3138.39 15217.5,-3086.39 15462.5,-3086.39 15462.5,-3138.39"/>
<text text-anchor="middle" x="15340" y="-3126.39" font-family="Arial" font-size="10.00">Expert 22 Computation</text>
<text text-anchor="middle" x="15340" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 22</text>
<text text-anchor="middle" x="15340" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="15340" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_22 -->
<g id="edge26" class="edge">
<title>route_0&#45;&gt;expert_22</title>
<path fill="none" stroke="black" d="M13801.8,-3210.38C14090.63,-3208.97 14691.7,-3198.39 15207.11,-3138.55"/>
<polygon fill="black" stroke="black" points="15207.83,-3141.98 15217.36,-3137.35 15207.02,-3135.03 15207.83,-3141.98"/>
</g>
<!-- expert_23 -->
<g id="node28" class="node">
<title>expert_23</title>
<polygon fill="lightblue" stroke="black" points="15725.5,-3138.39 15480.5,-3138.39 15480.5,-3086.39 15725.5,-3086.39 15725.5,-3138.39"/>
<text text-anchor="middle" x="15603" y="-3126.39" font-family="Arial" font-size="10.00">Expert 23 Computation</text>
<text text-anchor="middle" x="15603" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 23</text>
<text text-anchor="middle" x="15603" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="15603" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_23 -->
<g id="edge27" class="edge">
<title>route_0&#45;&gt;expert_23</title>
<path fill="none" stroke="black" d="M13800.62,-3206.78C14189.29,-3198.55 15132.32,-3175.48 15470.29,-3138.5"/>
<polygon fill="black" stroke="black" points="15470.81,-3141.96 15480.36,-3137.37 15470.03,-3135.01 15470.81,-3141.96"/>
</g>
<!-- expert_24 -->
<g id="node29" class="node">
<title>expert_24</title>
<polygon fill="lightblue" stroke="black" points="15988.5,-3138.39 15743.5,-3138.39 15743.5,-3086.39 15988.5,-3086.39 15988.5,-3138.39"/>
<text text-anchor="middle" x="15866" y="-3126.39" font-family="Arial" font-size="10.00">Expert 24 Computation</text>
<text text-anchor="middle" x="15866" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 24</text>
<text text-anchor="middle" x="15866" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="15866" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_24 -->
<g id="edge28" class="edge">
<title>route_0&#45;&gt;expert_24</title>
<path fill="none" stroke="black" d="M13801.41,-3207.73C14230.21,-3201.11 15342.29,-3180.45 15733.14,-3138.51"/>
<polygon fill="black" stroke="black" points="15733.8,-3141.96 15743.36,-3137.39 15733.04,-3135 15733.8,-3141.96"/>
</g>
<!-- expert_25 -->
<g id="node30" class="node">
<title>expert_25</title>
<polygon fill="lightblue" stroke="black" points="16251.5,-3138.39 16006.5,-3138.39 16006.5,-3086.39 16251.5,-3086.39 16251.5,-3138.39"/>
<text text-anchor="middle" x="16129" y="-3126.39" font-family="Arial" font-size="10.00">Expert 25 Computation</text>
<text text-anchor="middle" x="16129" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 25</text>
<text text-anchor="middle" x="16129" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="16129" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_25 -->
<g id="edge29" class="edge">
<title>route_0&#45;&gt;expert_25</title>
<path fill="none" stroke="black" d="M13801.57,-3208.49C14267.85,-3203.38 15552.53,-3185.45 15996.36,-3138.48"/>
<polygon fill="black" stroke="black" points="15996.8,-3141.96 16006.36,-3137.4 15996.05,-3135 15996.8,-3141.96"/>
</g>
<!-- expert_26 -->
<g id="node31" class="node">
<title>expert_26</title>
<polygon fill="lightblue" stroke="black" points="16514.5,-3138.39 16269.5,-3138.39 16269.5,-3086.39 16514.5,-3086.39 16514.5,-3138.39"/>
<text text-anchor="middle" x="16392" y="-3126.39" font-family="Arial" font-size="10.00">Expert 26 Computation</text>
<text text-anchor="middle" x="16392" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 26</text>
<text text-anchor="middle" x="16392" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="16392" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_26 -->
<g id="edge30" class="edge">
<title>route_0&#45;&gt;expert_26</title>
<path fill="none" stroke="black" d="M13801.78,-3209.09C14303.47,-3205.41 15761.89,-3190.49 16259.23,-3138.49"/>
<polygon fill="black" stroke="black" points="16259.79,-3141.96 16269.36,-3137.42 16259.05,-3134.99 16259.79,-3141.96"/>
</g>
<!-- expert_27 -->
<g id="node32" class="node">
<title>expert_27</title>
<polygon fill="lightblue" stroke="black" points="16777.5,-3138.39 16532.5,-3138.39 16532.5,-3086.39 16777.5,-3086.39 16777.5,-3138.39"/>
<text text-anchor="middle" x="16655" y="-3126.39" font-family="Arial" font-size="10.00">Expert 27 Computation</text>
<text text-anchor="middle" x="16655" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 27</text>
<text text-anchor="middle" x="16655" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="16655" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_27 -->
<g id="edge31" class="edge">
<title>route_0&#45;&gt;expert_27</title>
<path fill="none" stroke="black" d="M13802,-3209.59C14337.51,-3207.24 15971.52,-3195.55 16522.34,-3138.48"/>
<polygon fill="black" stroke="black" points="16522.79,-3141.95 16532.37,-3137.43 16522.05,-3134.99 16522.79,-3141.95"/>
</g>
<!-- expert_28 -->
<g id="node33" class="node">
<title>expert_28</title>
<polygon fill="lightblue" stroke="black" points="17040.5,-3138.39 16795.5,-3138.39 16795.5,-3086.39 17040.5,-3086.39 17040.5,-3138.39"/>
<text text-anchor="middle" x="16918" y="-3126.39" font-family="Arial" font-size="10.00">Expert 28 Computation</text>
<text text-anchor="middle" x="16918" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 28</text>
<text text-anchor="middle" x="16918" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="16918" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_28 -->
<g id="edge32" class="edge">
<title>route_0&#45;&gt;expert_28</title>
<path fill="none" stroke="black" d="M13801.9,-3210.01C14369.32,-3208.93 16180.44,-3200.63 16785.24,-3138.49"/>
<polygon fill="black" stroke="black" points="16785.78,-3141.95 16795.37,-3137.43 16785.06,-3134.99 16785.78,-3141.95"/>
</g>
<!-- expert_29 -->
<g id="node34" class="node">
<title>expert_29</title>
<polygon fill="lightblue" stroke="black" points="17303.5,-3138.39 17058.5,-3138.39 17058.5,-3086.39 17303.5,-3086.39 17303.5,-3138.39"/>
<text text-anchor="middle" x="17181" y="-3126.39" font-family="Arial" font-size="10.00">Expert 29 Computation</text>
<text text-anchor="middle" x="17181" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 29</text>
<text text-anchor="middle" x="17181" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="17181" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_29 -->
<g id="edge33" class="edge">
<title>route_0&#45;&gt;expert_29</title>
<path fill="none" stroke="black" d="M13801.91,-3210.36C14400.11,-3210.48 16389.55,-3205.73 17048.29,-3138.48"/>
<polygon fill="black" stroke="black" points="17048.78,-3141.95 17058.37,-3137.44 17048.06,-3134.99 17048.78,-3141.95"/>
</g>
<!-- expert_30 -->
<g id="node35" class="node">
<title>expert_30</title>
<polygon fill="lightblue" stroke="black" points="17566.5,-3138.39 17321.5,-3138.39 17321.5,-3086.39 17566.5,-3086.39 17566.5,-3138.39"/>
<text text-anchor="middle" x="17444" y="-3126.39" font-family="Arial" font-size="10.00">Expert 30 Computation</text>
<text text-anchor="middle" x="17444" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 30</text>
<text text-anchor="middle" x="17444" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="17444" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_30 -->
<g id="edge34" class="edge">
<title>route_0&#45;&gt;expert_30</title>
<path fill="none" stroke="black" d="M13801.9,-3210.67C14429.65,-3211.92 16598.3,-3210.85 17311.24,-3138.49"/>
<polygon fill="black" stroke="black" points="17311.78,-3141.95 17321.37,-3137.45 17311.06,-3134.99 17311.78,-3141.95"/>
</g>
<!-- expert_31 -->
<g id="node36" class="node">
<title>expert_31</title>
<polygon fill="lightblue" stroke="black" points="17829.5,-3138.39 17584.5,-3138.39 17584.5,-3086.39 17829.5,-3086.39 17829.5,-3138.39"/>
<text text-anchor="middle" x="17707" y="-3126.39" font-family="Arial" font-size="10.00">Expert 31 Computation</text>
<text text-anchor="middle" x="17707" y="-3115.39" font-family="Arial" font-size="10.00">GPU: 31</text>
<text text-anchor="middle" x="17707" y="-3104.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="17707" y="-3093.39" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_0&#45;&gt;expert_31 -->
<g id="edge35" class="edge">
<title>route_0&#45;&gt;expert_31</title>
<path fill="none" stroke="black" d="M13801.51,-3208.77C14505.22,-3202.81 17153.5,-3178.03 17574.27,-3138.45"/>
<polygon fill="black" stroke="black" points="17574.76,-3141.92 17584.37,-3137.45 17574.07,-3134.95 17574.76,-3141.92"/>
</g>
<!-- attn_0 -->
<g id="node37" class="node">
<title>attn_0</title>
<polygon fill="lightblue" stroke="black" points="10615.5,-3050.39 10334.5,-3050.39 10334.5,-2998.39 10615.5,-2998.39 10615.5,-3050.39"/>
<text text-anchor="middle" x="10475" y="-3038.39" font-family="Arial" font-size="10.00">Attention (TP+SP)</text>
<text text-anchor="middle" x="10475" y="-3027.39" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="10475" y="-3016.39" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="10475" y="-3005.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- expert_0&#45;&gt;attn_0 -->
<g id="edge36" class="edge">
<title>expert_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M9676.54,-3087.71C9679.72,-3087.25 9682.88,-3086.81 9686,-3086.39 9907.05,-3057 10164.97,-3040.36 10324.14,-3032.11"/>
<polygon fill="black" stroke="black" points="10324.68,-3035.59 10334.48,-3031.58 10324.32,-3028.6 10324.68,-3035.59"/>
</g>
<!-- agg_0 -->
<g id="node39" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="10739.24,-2852.85 10318.89,-2852.85 10210.76,-2748.85 10631.11,-2748.85 10739.24,-2852.85"/>
<text text-anchor="middle" x="10475" y="-2814.85" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="10475" y="-2803.85" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="10475" y="-2792.85" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10475" y="-2781.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_0&#45;&gt;agg_0 -->
<g id="edge37" class="edge">
<title>expert_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M9597.91,-3086.24C9679.85,-3040.35 9862.72,-2942.82 10028,-2888.85 10109.44,-2862.26 10202.03,-2842.59 10281.74,-2828.75"/>
<polygon fill="black" stroke="black" points="10282.63,-2832.15 10291.89,-2827.01 10281.44,-2825.25 10282.63,-2832.15"/>
</g>
<!-- expert_1&#45;&gt;attn_0 -->
<g id="edge38" class="edge">
<title>expert_1&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M9939.56,-3087.87C9942.74,-3087.36 9945.89,-3086.87 9949,-3086.39 10075.01,-3067.18 10218.82,-3050.88 10324.19,-3039.98"/>
<polygon fill="black" stroke="black" points="10324.67,-3043.45 10334.26,-3038.94 10323.95,-3036.49 10324.67,-3043.45"/>
</g>
<!-- expert_1&#45;&gt;agg_0 -->
<g id="edge39" class="edge">
<title>expert_1&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M9849.75,-3086.2C9910.05,-3040.89 10043.99,-2945.15 10170,-2888.85 10209.76,-2871.09 10254.07,-2856 10296.31,-2843.62"/>
<polygon fill="black" stroke="black" points="10297.51,-2846.92 10306.14,-2840.78 10295.56,-2840.19 10297.51,-2846.92"/>
</g>
<!-- expert_2&#45;&gt;attn_0 -->
<g id="edge40" class="edge">
<title>expert_2&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M10195.05,-3086.34C10243.73,-3075.74 10300.56,-3063.37 10350.24,-3052.55"/>
<polygon fill="black" stroke="black" points="10351.05,-3055.96 10360.08,-3050.41 10349.56,-3049.12 10351.05,-3055.96"/>
</g>
<!-- expert_2&#45;&gt;agg_0 -->
<g id="edge41" class="edge">
<title>expert_2&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M10092.7,-3086.39C10116.96,-3040.96 10174.12,-2944.44 10248,-2888.85 10265.7,-2875.53 10285.68,-2864.02 10306.27,-2854.13"/>
<polygon fill="black" stroke="black" points="10307.86,-2857.25 10315.44,-2849.85 10304.9,-2850.91 10307.86,-2857.25"/>
</g>
<!-- expert_3&#45;&gt;attn_0 -->
<g id="edge42" class="edge">
<title>expert_3&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M10381.53,-3086.29C10395.91,-3076.92 10412.4,-3066.17 10427.49,-3056.34"/>
<polygon fill="black" stroke="black" points="10429.72,-3059.07 10436.19,-3050.68 10425.9,-3053.2 10429.72,-3059.07"/>
</g>
<!-- expert_3&#45;&gt;agg_0 -->
<g id="edge43" class="edge">
<title>expert_3&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M10320.76,-3086.15C10285.39,-3042.81 10224.47,-2952.74 10267,-2888.85 10276.61,-2874.42 10289.12,-2862.37 10303.25,-2852.32"/>
<polygon fill="black" stroke="black" points="10305.38,-2855.11 10311.74,-2846.63 10301.48,-2849.29 10305.38,-2855.11"/>
</g>
<!-- expert_4&#45;&gt;attn_0 -->
<g id="edge44" class="edge">
<title>expert_4&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M10567.76,-3086.29C10553.49,-3076.92 10537.12,-3066.17 10522.15,-3056.34"/>
<polygon fill="black" stroke="black" points="10523.8,-3053.24 10513.52,-3050.68 10519.96,-3059.09 10523.8,-3053.24"/>
</g>
<!-- expert_4&#45;&gt;agg_0 -->
<g id="edge45" class="edge">
<title>expert_4&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M10628.43,-3086.17C10664.1,-3042.86 10725.59,-2952.83 10683,-2888.85 10675.48,-2877.56 10666.19,-2867.73 10655.73,-2859.17"/>
<polygon fill="black" stroke="black" points="10657.59,-2856.18 10647.52,-2852.87 10653.32,-2861.73 10657.59,-2856.18"/>
</g>
<!-- expert_5&#45;&gt;attn_0 -->
<g id="edge46" class="edge">
<title>expert_5&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M10754.24,-3086.34C10705.69,-3075.74 10649,-3063.37 10599.44,-3052.55"/>
<polygon fill="black" stroke="black" points="10600.15,-3049.12 10589.63,-3050.41 10598.65,-3055.96 10600.15,-3049.12"/>
</g>
<!-- expert_5&#45;&gt;agg_0 -->
<g id="edge47" class="edge">
<title>expert_5&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M10855.35,-3086.13C10829.64,-3040.71 10769.83,-2944.79 10695,-2888.85 10679.17,-2877.02 10661.51,-2866.56 10643.28,-2857.38"/>
<polygon fill="black" stroke="black" points="10644.81,-2854.23 10634.29,-2852.97 10641.73,-2860.51 10644.81,-2854.23"/>
</g>
<!-- expert_6&#45;&gt;attn_0 -->
<g id="edge48" class="edge">
<title>expert_6&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M11009.32,-3087.7C11006.52,-3087.25 11003.75,-3086.81 11001,-3086.39 10875,-3067.09 10731.19,-3050.8 10625.82,-3039.93"/>
<polygon fill="black" stroke="black" points="10626.05,-3036.43 10615.75,-3038.89 10625.34,-3043.39 10626.05,-3036.43"/>
</g>
<!-- expert_6&#45;&gt;agg_0 -->
<g id="edge49" class="edge">
<title>expert_6&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M11093.5,-3086.37C11024.3,-3042.17 10873.39,-2949.24 10737,-2888.85 10710.72,-2877.21 10682.37,-2866.26 10654.37,-2856.3"/>
<polygon fill="black" stroke="black" points="10655.49,-2852.98 10644.89,-2852.96 10653.16,-2859.58 10655.49,-2852.98"/>
</g>
<!-- expert_7&#45;&gt;attn_0 -->
<g id="edge50" class="edge">
<title>expert_7&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M11272.34,-3087.55C11269.54,-3087.15 11266.75,-3086.76 11264,-3086.39 11042.97,-3056.85 10785.05,-3040.25 10625.87,-3032.05"/>
<polygon fill="black" stroke="black" points="10625.69,-3028.54 10615.52,-3031.52 10625.33,-3035.53 10625.69,-3028.54"/>
</g>
<!-- expert_7&#45;&gt;agg_0 -->
<g id="edge51" class="edge">
<title>expert_7&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M11335.89,-3086.23C11231.59,-3042.41 11007.54,-2950.86 10813,-2888.85 10776.14,-2877.1 10736.65,-2865.81 10698.13,-2855.46"/>
<polygon fill="black" stroke="black" points="10698.92,-2852.05 10688.36,-2852.85 10697.12,-2858.81 10698.92,-2852.05"/>
</g>
<!-- attn_comm_0 -->
<g id="node38" class="node">
<title>attn_comm_0</title>
<ellipse fill="lightgreen" stroke="black" cx="10475" cy="-2925.62" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="10475" y="-2939.62" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="10475" y="-2928.62" font-family="Arial" font-size="10.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="10475" y="-2917.62" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="10475" y="-2906.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- attn_0&#45;&gt;attn_comm_0 -->
<g id="edge52" class="edge">
<title>attn_0&#45;&gt;attn_comm_0</title>
<path fill="none" stroke="black" d="M10475,-2998.22C10475,-2990.41 10475,-2981.54 10475,-2972.78"/>
<polygon fill="black" stroke="black" points="10478.5,-2972.6 10475,-2962.6 10471.5,-2972.6 10478.5,-2972.6"/>
</g>
<!-- attn_comm_0&#45;&gt;agg_0 -->
<g id="edge53" class="edge">
<title>attn_comm_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M10475,-2888.78C10475,-2880.74 10475,-2872 10475,-2863.25"/>
<polygon fill="black" stroke="black" points="10478.5,-2863.02 10475,-2853.02 10471.5,-2863.02 10478.5,-2863.02"/>
</g>
<!-- pipe_comm_0_1 -->
<g id="node155" class="node">
<title>pipe_comm_0_1</title>
<ellipse fill="lightgreen" stroke="black" cx="10475" cy="-2676.08" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="10475" y="-2690.08" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="10475" y="-2679.08" font-family="Arial" font-size="10.00">GPU: 31&#45;&gt;32</text>
<text text-anchor="middle" x="10475" y="-2668.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10475" y="-2657.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- agg_0&#45;&gt;pipe_comm_0_1 -->
<g id="edge54" class="edge">
<title>agg_0&#45;&gt;pipe_comm_0_1</title>
<path fill="none" stroke="black" d="M10475,-2748.5C10475,-2740.09 10475,-2731.42 10475,-2723.15"/>
<polygon fill="black" stroke="black" points="10478.5,-2722.94 10475,-2712.94 10471.5,-2722.94 10478.5,-2722.94"/>
</g>
<!-- embed_1 -->
<g id="node40" class="node">
<title>embed_1</title>
<polygon fill="lightblue" stroke="black" points="10602.5,-2585.31 10347.5,-2585.31 10347.5,-2533.31 10602.5,-2533.31 10602.5,-2585.31"/>
<text text-anchor="middle" x="10475" y="-2573.31" font-family="Arial" font-size="10.00">Token Embedding</text>
<text text-anchor="middle" x="10475" y="-2562.31" font-family="Arial" font-size="10.00">GPU: 32&#45;39</text>
<text text-anchor="middle" x="10475" y="-2551.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10475" y="-2540.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- gate_1 -->
<g id="node41" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="10732.23,-2497.31 10323.03,-2497.31 10217.77,-2393.31 10626.97,-2393.31 10732.23,-2497.31"/>
<text text-anchor="middle" x="10475" y="-2459.31" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="10475" y="-2448.31" font-family="Arial" font-size="10.00">GPU: 32&#45;39</text>
<text text-anchor="middle" x="10475" y="-2437.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="10475" y="-2426.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=32]</text>
</g>
<!-- embed_1&#45;&gt;gate_1 -->
<g id="edge56" class="edge">
<title>embed_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M10475,-2533.18C10475,-2525.49 10475,-2516.68 10475,-2507.68"/>
<polygon fill="black" stroke="black" points="10478.5,-2507.49 10475,-2497.49 10471.5,-2507.49 10478.5,-2507.49"/>
</g>
<!-- route_1 -->
<g id="node42" class="node">
<title>route_1</title>
<ellipse fill="lightgreen" stroke="black" cx="10475" cy="-2320.54" rx="171.65" ry="36.54"/>
<text text-anchor="middle" x="10475" y="-2334.54" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="10475" y="-2323.54" font-family="Arial" font-size="10.00">GPU: 32&#45;63</text>
<text text-anchor="middle" x="10475" y="-2312.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=32]</text>
<text text-anchor="middle" x="10475" y="-2301.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=1]</text>
</g>
<!-- gate_1&#45;&gt;route_1 -->
<g id="edge57" class="edge">
<title>gate_1&#45;&gt;route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10475,-2392.96C10475,-2384.55 10475,-2375.88 10475,-2367.61"/>
<polygon fill="black" stroke="black" points="10478.5,-2367.4 10475,-2357.4 10471.5,-2367.4 10478.5,-2367.4"/>
</g>
<!-- expert_32 -->
<g id="node43" class="node">
<title>expert_32</title>
<polygon fill="lightblue" stroke="black" points="6521.5,-2247.77 6276.5,-2247.77 6276.5,-2195.77 6521.5,-2195.77 6521.5,-2247.77"/>
<text text-anchor="middle" x="6399" y="-2235.77" font-family="Arial" font-size="10.00">Expert 32 Computation</text>
<text text-anchor="middle" x="6399" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 32</text>
<text text-anchor="middle" x="6399" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6399" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_32 -->
<g id="edge58" class="edge">
<title>route_1&#45;&gt;expert_32</title>
<path fill="none" stroke="black" d="M10303.54,-2318.15C9600,-2312.19 6952.4,-2287.4 6531.72,-2247.83"/>
<polygon fill="black" stroke="black" points="6531.93,-2244.33 6521.63,-2246.83 6531.24,-2251.3 6531.93,-2244.33"/>
</g>
<!-- expert_33 -->
<g id="node44" class="node">
<title>expert_33</title>
<polygon fill="lightblue" stroke="black" points="6784.5,-2247.77 6539.5,-2247.77 6539.5,-2195.77 6784.5,-2195.77 6784.5,-2247.77"/>
<text text-anchor="middle" x="6662" y="-2235.77" font-family="Arial" font-size="10.00">Expert 33 Computation</text>
<text text-anchor="middle" x="6662" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 33</text>
<text text-anchor="middle" x="6662" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6662" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_33 -->
<g id="edge59" class="edge">
<title>route_1&#45;&gt;expert_33</title>
<path fill="none" stroke="black" d="M10303.15,-2320.05C9675.57,-2321.3 7507.51,-2320.21 6794.76,-2247.87"/>
<polygon fill="black" stroke="black" points="6794.94,-2244.37 6784.63,-2246.83 6794.22,-2251.33 6794.94,-2244.37"/>
</g>
<!-- expert_34 -->
<g id="node45" class="node">
<title>expert_34</title>
<polygon fill="lightblue" stroke="black" points="7047.5,-2247.77 6802.5,-2247.77 6802.5,-2195.77 7047.5,-2195.77 7047.5,-2247.77"/>
<text text-anchor="middle" x="6925" y="-2235.77" font-family="Arial" font-size="10.00">Expert 34 Computation</text>
<text text-anchor="middle" x="6925" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 34</text>
<text text-anchor="middle" x="6925" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6925" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_34 -->
<g id="edge60" class="edge">
<title>route_1&#45;&gt;expert_34</title>
<path fill="none" stroke="black" d="M10303.14,-2319.75C9705.11,-2319.86 7716.25,-2315.1 7057.71,-2247.87"/>
<polygon fill="black" stroke="black" points="7057.94,-2244.37 7047.63,-2246.82 7057.22,-2251.33 7057.94,-2244.37"/>
</g>
<!-- expert_35 -->
<g id="node46" class="node">
<title>expert_35</title>
<polygon fill="lightblue" stroke="black" points="7310.5,-2247.77 7065.5,-2247.77 7065.5,-2195.77 7310.5,-2195.77 7310.5,-2247.77"/>
<text text-anchor="middle" x="7188" y="-2235.77" font-family="Arial" font-size="10.00">Expert 35 Computation</text>
<text text-anchor="middle" x="7188" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 35</text>
<text text-anchor="middle" x="7188" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7188" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_35 -->
<g id="edge61" class="edge">
<title>route_1&#45;&gt;expert_35</title>
<path fill="none" stroke="black" d="M10303.16,-2319.39C9735.91,-2318.3 7925.37,-2310 7320.76,-2247.87"/>
<polygon fill="black" stroke="black" points="7320.94,-2244.37 7310.63,-2246.82 7320.22,-2251.34 7320.94,-2244.37"/>
</g>
<!-- expert_36 -->
<g id="node47" class="node">
<title>expert_36</title>
<polygon fill="lightblue" stroke="black" points="7573.5,-2247.77 7328.5,-2247.77 7328.5,-2195.77 7573.5,-2195.77 7573.5,-2247.77"/>
<text text-anchor="middle" x="7451" y="-2235.77" font-family="Arial" font-size="10.00">Expert 36 Computation</text>
<text text-anchor="middle" x="7451" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 36</text>
<text text-anchor="middle" x="7451" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7451" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_36 -->
<g id="edge62" class="edge">
<title>route_1&#45;&gt;expert_36</title>
<path fill="none" stroke="black" d="M10303.06,-2318.97C9767.74,-2316.62 8134.29,-2304.91 7583.66,-2247.86"/>
<polygon fill="black" stroke="black" points="7583.95,-2244.38 7573.63,-2246.81 7583.21,-2251.34 7583.95,-2244.38"/>
</g>
<!-- expert_37 -->
<g id="node48" class="node">
<title>expert_37</title>
<polygon fill="lightblue" stroke="black" points="7836.5,-2247.77 7591.5,-2247.77 7591.5,-2195.77 7836.5,-2195.77 7836.5,-2247.77"/>
<text text-anchor="middle" x="7714" y="-2235.77" font-family="Arial" font-size="10.00">Expert 37 Computation</text>
<text text-anchor="middle" x="7714" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 37</text>
<text text-anchor="middle" x="7714" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7714" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_37 -->
<g id="edge63" class="edge">
<title>route_1&#45;&gt;expert_37</title>
<path fill="none" stroke="black" d="M10303.29,-2318.48C9801.79,-2314.79 8343.92,-2299.86 7846.76,-2247.88"/>
<polygon fill="black" stroke="black" points="7846.95,-2244.38 7836.64,-2246.8 7846.21,-2251.34 7846.95,-2244.38"/>
</g>
<!-- expert_38 -->
<g id="node49" class="node">
<title>expert_38</title>
<polygon fill="lightblue" stroke="black" points="8099.5,-2247.77 7854.5,-2247.77 7854.5,-2195.77 8099.5,-2195.77 8099.5,-2247.77"/>
<text text-anchor="middle" x="7977" y="-2235.77" font-family="Arial" font-size="10.00">Expert 38 Computation</text>
<text text-anchor="middle" x="7977" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 38</text>
<text text-anchor="middle" x="7977" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7977" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_38 -->
<g id="edge64" class="edge">
<title>route_1&#45;&gt;expert_38</title>
<path fill="none" stroke="black" d="M10303.51,-2317.87C9837.42,-2312.76 8553.29,-2294.82 8109.64,-2247.87"/>
<polygon fill="black" stroke="black" points="8109.95,-2244.38 8099.64,-2246.79 8109.2,-2251.34 8109.95,-2244.38"/>
</g>
<!-- expert_39 -->
<g id="node50" class="node">
<title>expert_39</title>
<polygon fill="lightblue" stroke="black" points="8362.5,-2247.77 8117.5,-2247.77 8117.5,-2195.77 8362.5,-2195.77 8362.5,-2247.77"/>
<text text-anchor="middle" x="8240" y="-2235.77" font-family="Arial" font-size="10.00">Expert 39 Computation</text>
<text text-anchor="middle" x="8240" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 39</text>
<text text-anchor="middle" x="8240" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8240" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_39 -->
<g id="edge65" class="edge">
<title>route_1&#45;&gt;expert_39</title>
<path fill="none" stroke="black" d="M10303.67,-2317.11C9875.08,-2310.49 8763.53,-2289.82 8372.86,-2247.89"/>
<polygon fill="black" stroke="black" points="8372.96,-2244.38 8362.64,-2246.77 8372.2,-2251.34 8372.96,-2244.38"/>
</g>
<!-- expert_40 -->
<g id="node51" class="node">
<title>expert_40</title>
<polygon fill="lightblue" stroke="black" points="8625.5,-2247.77 8380.5,-2247.77 8380.5,-2195.77 8625.5,-2195.77 8625.5,-2247.77"/>
<text text-anchor="middle" x="8503" y="-2235.77" font-family="Arial" font-size="10.00">Expert 40 Computation</text>
<text text-anchor="middle" x="8503" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 40</text>
<text text-anchor="middle" x="8503" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8503" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_40 -->
<g id="edge66" class="edge">
<title>route_1&#45;&gt;expert_40</title>
<path fill="none" stroke="black" d="M10304.11,-2316.15C9915.42,-2307.91 8973.38,-2284.84 8635.7,-2247.88"/>
<polygon fill="black" stroke="black" points="8635.97,-2244.39 8625.64,-2246.75 8635.19,-2251.34 8635.97,-2244.39"/>
</g>
<!-- expert_41 -->
<g id="node52" class="node">
<title>expert_41</title>
<polygon fill="lightblue" stroke="black" points="8888.5,-2247.77 8643.5,-2247.77 8643.5,-2195.77 8888.5,-2195.77 8888.5,-2247.77"/>
<text text-anchor="middle" x="8766" y="-2235.77" font-family="Arial" font-size="10.00">Expert 41 Computation</text>
<text text-anchor="middle" x="8766" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 41</text>
<text text-anchor="middle" x="8766" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8766" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_41 -->
<g id="edge67" class="edge">
<title>route_1&#45;&gt;expert_41</title>
<path fill="none" stroke="black" d="M10303.01,-2319.76C10014.25,-2318.33 9413.8,-2307.73 8898.88,-2247.93"/>
<polygon fill="black" stroke="black" points="8898.98,-2244.41 8888.64,-2246.73 8898.17,-2251.37 8898.98,-2244.41"/>
</g>
<!-- expert_42 -->
<g id="node53" class="node">
<title>expert_42</title>
<polygon fill="lightblue" stroke="black" points="9151.5,-2247.77 8906.5,-2247.77 8906.5,-2195.77 9151.5,-2195.77 9151.5,-2247.77"/>
<text text-anchor="middle" x="9029" y="-2235.77" font-family="Arial" font-size="10.00">Expert 42 Computation</text>
<text text-anchor="middle" x="9029" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 42</text>
<text text-anchor="middle" x="9029" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9029" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_42 -->
<g id="edge68" class="edge">
<title>route_1&#45;&gt;expert_42</title>
<path fill="none" stroke="black" d="M10303.61,-2317.51C10054.03,-2312.9 9576.01,-2297.88 9161.73,-2247.92"/>
<polygon fill="black" stroke="black" points="9162,-2244.43 9151.65,-2246.7 9161.15,-2251.38 9162,-2244.43"/>
</g>
<!-- expert_43 -->
<g id="node54" class="node">
<title>expert_43</title>
<polygon fill="lightblue" stroke="black" points="9414.5,-2247.77 9169.5,-2247.77 9169.5,-2195.77 9414.5,-2195.77 9414.5,-2247.77"/>
<text text-anchor="middle" x="9292" y="-2235.77" font-family="Arial" font-size="10.00">Expert 43 Computation</text>
<text text-anchor="middle" x="9292" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 43</text>
<text text-anchor="middle" x="9292" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9292" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_43 -->
<g id="edge69" class="edge">
<title>route_1&#45;&gt;expert_43</title>
<path fill="none" stroke="black" d="M10305.39,-2314.26C10099.19,-2306.41 9740.59,-2288.15 9424.92,-2247.96"/>
<polygon fill="black" stroke="black" points="9425.02,-2244.45 9414.65,-2246.64 9424.13,-2251.39 9425.02,-2244.45"/>
</g>
<!-- expert_44 -->
<g id="node55" class="node">
<title>expert_44</title>
<polygon fill="lightblue" stroke="black" points="9677.5,-2247.77 9432.5,-2247.77 9432.5,-2195.77 9677.5,-2195.77 9677.5,-2247.77"/>
<text text-anchor="middle" x="9555" y="-2235.77" font-family="Arial" font-size="10.00">Expert 44 Computation</text>
<text text-anchor="middle" x="9555" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 44</text>
<text text-anchor="middle" x="9555" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9555" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_44 -->
<g id="edge70" class="edge">
<title>route_1&#45;&gt;expert_44</title>
<path fill="none" stroke="black" d="M10311.1,-2309.24C10153.76,-2298.27 9909.32,-2278.43 9687.74,-2247.82"/>
<polygon fill="black" stroke="black" points="9687.93,-2244.31 9677.54,-2246.4 9686.97,-2251.24 9687.93,-2244.31"/>
</g>
<!-- expert_45 -->
<g id="node56" class="node">
<title>expert_45</title>
<polygon fill="lightblue" stroke="black" points="9940.5,-2247.77 9695.5,-2247.77 9695.5,-2195.77 9940.5,-2195.77 9940.5,-2247.77"/>
<text text-anchor="middle" x="9818" y="-2235.77" font-family="Arial" font-size="10.00">Expert 45 Computation</text>
<text text-anchor="middle" x="9818" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 45</text>
<text text-anchor="middle" x="9818" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9818" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_45 -->
<g id="edge71" class="edge">
<title>route_1&#45;&gt;expert_45</title>
<path fill="none" stroke="black" d="M10327.89,-2301.48C10225.04,-2288.37 10084.3,-2269.45 9950.6,-2247.84"/>
<polygon fill="black" stroke="black" points="9951,-2244.36 9940.57,-2246.21 9949.88,-2251.27 9951,-2244.36"/>
</g>
<!-- expert_46 -->
<g id="node57" class="node">
<title>expert_46</title>
<polygon fill="lightblue" stroke="black" points="10203.5,-2247.77 9958.5,-2247.77 9958.5,-2195.77 10203.5,-2195.77 10203.5,-2247.77"/>
<text text-anchor="middle" x="10081" y="-2235.77" font-family="Arial" font-size="10.00">Expert 46 Computation</text>
<text text-anchor="middle" x="10081" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 46</text>
<text text-anchor="middle" x="10081" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10081" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_46 -->
<g id="edge72" class="edge">
<title>route_1&#45;&gt;expert_46</title>
<path fill="none" stroke="black" d="M10364.2,-2292.33C10310.63,-2279.17 10246.47,-2263.42 10192.78,-2250.23"/>
<polygon fill="black" stroke="black" points="10193.42,-2246.78 10182.88,-2247.8 10191.75,-2253.58 10193.42,-2246.78"/>
</g>
<!-- expert_47 -->
<g id="node58" class="node">
<title>expert_47</title>
<polygon fill="lightblue" stroke="black" points="10466.5,-2247.77 10221.5,-2247.77 10221.5,-2195.77 10466.5,-2195.77 10466.5,-2247.77"/>
<text text-anchor="middle" x="10344" y="-2235.77" font-family="Arial" font-size="10.00">Expert 47 Computation</text>
<text text-anchor="middle" x="10344" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 47</text>
<text text-anchor="middle" x="10344" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10344" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_47 -->
<g id="edge73" class="edge">
<title>route_1&#45;&gt;expert_47</title>
<path fill="none" stroke="black" d="M10428.08,-2284.88C10414.34,-2274.73 10399.41,-2263.7 10385.99,-2253.79"/>
<polygon fill="black" stroke="black" points="10387.99,-2250.91 10377.86,-2247.79 10383.83,-2256.54 10387.99,-2250.91"/>
</g>
<!-- expert_48 -->
<g id="node59" class="node">
<title>expert_48</title>
<polygon fill="lightblue" stroke="black" points="10729.5,-2247.77 10484.5,-2247.77 10484.5,-2195.77 10729.5,-2195.77 10729.5,-2247.77"/>
<text text-anchor="middle" x="10607" y="-2235.77" font-family="Arial" font-size="10.00">Expert 48 Computation</text>
<text text-anchor="middle" x="10607" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 48</text>
<text text-anchor="middle" x="10607" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10607" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_48 -->
<g id="edge74" class="edge">
<title>route_1&#45;&gt;expert_48</title>
<path fill="none" stroke="black" d="M10521.91,-2285.15C10535.78,-2274.99 10550.88,-2263.92 10564.46,-2253.96"/>
<polygon fill="black" stroke="black" points="10566.69,-2256.66 10572.69,-2247.93 10562.55,-2251.02 10566.69,-2256.66"/>
</g>
<!-- expert_49 -->
<g id="node60" class="node">
<title>expert_49</title>
<polygon fill="lightblue" stroke="black" points="10992.5,-2247.77 10747.5,-2247.77 10747.5,-2195.77 10992.5,-2195.77 10992.5,-2247.77"/>
<text text-anchor="middle" x="10870" y="-2235.77" font-family="Arial" font-size="10.00">Expert 49 Computation</text>
<text text-anchor="middle" x="10870" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 49</text>
<text text-anchor="middle" x="10870" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10870" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_49 -->
<g id="edge75" class="edge">
<title>route_1&#45;&gt;expert_49</title>
<path fill="none" stroke="black" d="M10585.82,-2292.39C10639.53,-2279.24 10703.91,-2263.46 10757.8,-2250.26"/>
<polygon fill="black" stroke="black" points="10758.85,-2253.61 10767.73,-2247.83 10757.19,-2246.81 10758.85,-2253.61"/>
</g>
<!-- expert_50 -->
<g id="node61" class="node">
<title>expert_50</title>
<polygon fill="lightblue" stroke="black" points="11255.5,-2247.77 11010.5,-2247.77 11010.5,-2195.77 11255.5,-2195.77 11255.5,-2247.77"/>
<text text-anchor="middle" x="11133" y="-2235.77" font-family="Arial" font-size="10.00">Expert 50 Computation</text>
<text text-anchor="middle" x="11133" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 50</text>
<text text-anchor="middle" x="11133" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11133" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_50 -->
<g id="edge76" class="edge">
<title>route_1&#45;&gt;expert_50</title>
<path fill="none" stroke="black" d="M10622.4,-2301.6C10725.66,-2288.53 10867.09,-2269.61 11000.32,-2248.02"/>
<polygon fill="black" stroke="black" points="11001,-2251.45 11010.31,-2246.39 10999.88,-2244.55 11001,-2251.45"/>
</g>
<!-- expert_51 -->
<g id="node62" class="node">
<title>expert_51</title>
<polygon fill="lightblue" stroke="black" points="11518.5,-2247.77 11273.5,-2247.77 11273.5,-2195.77 11518.5,-2195.77 11518.5,-2247.77"/>
<text text-anchor="middle" x="11396" y="-2235.77" font-family="Arial" font-size="10.00">Expert 51 Computation</text>
<text text-anchor="middle" x="11396" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 51</text>
<text text-anchor="middle" x="11396" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11396" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_51 -->
<g id="edge77" class="edge">
<title>route_1&#45;&gt;expert_51</title>
<path fill="none" stroke="black" d="M10638.94,-2309.35C10796.67,-2298.46 11041.96,-2278.66 11263.15,-2247.98"/>
<polygon fill="black" stroke="black" points="11263.92,-2251.41 11273.34,-2246.56 11262.95,-2244.48 11263.92,-2251.41"/>
</g>
<!-- expert_52 -->
<g id="node63" class="node">
<title>expert_52</title>
<polygon fill="lightblue" stroke="black" points="11781.5,-2247.77 11536.5,-2247.77 11536.5,-2195.77 11781.5,-2195.77 11781.5,-2247.77"/>
<text text-anchor="middle" x="11659" y="-2235.77" font-family="Arial" font-size="10.00">Expert 52 Computation</text>
<text text-anchor="middle" x="11659" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 52</text>
<text text-anchor="middle" x="11659" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11659" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_52 -->
<g id="edge78" class="edge">
<title>route_1&#45;&gt;expert_52</title>
<path fill="none" stroke="black" d="M10644.77,-2314.27C10851.17,-2306.42 11210.11,-2288.18 11526.07,-2247.96"/>
<polygon fill="black" stroke="black" points="11526.87,-2251.39 11536.35,-2246.65 11525.98,-2244.45 11526.87,-2251.39"/>
</g>
<!-- expert_53 -->
<g id="node64" class="node">
<title>expert_53</title>
<polygon fill="lightblue" stroke="black" points="12044.5,-2247.77 11799.5,-2247.77 11799.5,-2195.77 12044.5,-2195.77 12044.5,-2247.77"/>
<text text-anchor="middle" x="11922" y="-2235.77" font-family="Arial" font-size="10.00">Expert 53 Computation</text>
<text text-anchor="middle" x="11922" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 53</text>
<text text-anchor="middle" x="11922" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11922" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_53 -->
<g id="edge79" class="edge">
<title>route_1&#45;&gt;expert_53</title>
<path fill="none" stroke="black" d="M10646.26,-2317.52C10895.96,-2312.93 11374.53,-2297.93 11789.26,-2247.92"/>
<polygon fill="black" stroke="black" points="11789.85,-2251.38 11799.35,-2246.7 11789,-2244.43 11789.85,-2251.38"/>
</g>
<!-- expert_54 -->
<g id="node65" class="node">
<title>expert_54</title>
<polygon fill="lightblue" stroke="black" points="12307.5,-2247.77 12062.5,-2247.77 12062.5,-2195.77 12307.5,-2195.77 12307.5,-2247.77"/>
<text text-anchor="middle" x="12185" y="-2235.77" font-family="Arial" font-size="10.00">Expert 54 Computation</text>
<text text-anchor="middle" x="12185" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 54</text>
<text text-anchor="middle" x="12185" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12185" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_54 -->
<g id="edge80" class="edge">
<title>route_1&#45;&gt;expert_54</title>
<path fill="none" stroke="black" d="M10646.8,-2319.76C10935.63,-2318.35 11536.7,-2307.78 12052.11,-2247.93"/>
<polygon fill="black" stroke="black" points="12052.83,-2251.37 12062.36,-2246.73 12052.02,-2244.41 12052.83,-2251.37"/>
</g>
<!-- expert_55 -->
<g id="node66" class="node">
<title>expert_55</title>
<polygon fill="lightblue" stroke="black" points="12570.5,-2247.77 12325.5,-2247.77 12325.5,-2195.77 12570.5,-2195.77 12570.5,-2247.77"/>
<text text-anchor="middle" x="12448" y="-2235.77" font-family="Arial" font-size="10.00">Expert 55 Computation</text>
<text text-anchor="middle" x="12448" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 55</text>
<text text-anchor="middle" x="12448" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12448" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_55 -->
<g id="edge81" class="edge">
<title>route_1&#45;&gt;expert_55</title>
<path fill="none" stroke="black" d="M10645.62,-2316.16C11034.29,-2307.93 11977.32,-2284.86 12315.29,-2247.88"/>
<polygon fill="black" stroke="black" points="12315.81,-2251.34 12325.36,-2246.75 12315.03,-2244.39 12315.81,-2251.34"/>
</g>
<!-- expert_56 -->
<g id="node67" class="node">
<title>expert_56</title>
<polygon fill="lightblue" stroke="black" points="12833.5,-2247.77 12588.5,-2247.77 12588.5,-2195.77 12833.5,-2195.77 12833.5,-2247.77"/>
<text text-anchor="middle" x="12711" y="-2235.77" font-family="Arial" font-size="10.00">Expert 56 Computation</text>
<text text-anchor="middle" x="12711" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 56</text>
<text text-anchor="middle" x="12711" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12711" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_56 -->
<g id="edge82" class="edge">
<title>route_1&#45;&gt;expert_56</title>
<path fill="none" stroke="black" d="M10646.41,-2317.12C11075.21,-2310.5 12187.29,-2289.83 12578.14,-2247.89"/>
<polygon fill="black" stroke="black" points="12578.8,-2251.34 12588.36,-2246.77 12578.04,-2244.38 12578.8,-2251.34"/>
</g>
<!-- expert_57 -->
<g id="node68" class="node">
<title>expert_57</title>
<polygon fill="lightblue" stroke="black" points="13096.5,-2247.77 12851.5,-2247.77 12851.5,-2195.77 13096.5,-2195.77 13096.5,-2247.77"/>
<text text-anchor="middle" x="12974" y="-2235.77" font-family="Arial" font-size="10.00">Expert 57 Computation</text>
<text text-anchor="middle" x="12974" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 57</text>
<text text-anchor="middle" x="12974" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="12974" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_57 -->
<g id="edge83" class="edge">
<title>route_1&#45;&gt;expert_57</title>
<path fill="none" stroke="black" d="M10646.57,-2317.87C11112.85,-2312.77 12397.53,-2294.84 12841.36,-2247.87"/>
<polygon fill="black" stroke="black" points="12841.8,-2251.34 12851.36,-2246.79 12841.05,-2244.38 12841.8,-2251.34"/>
</g>
<!-- expert_58 -->
<g id="node69" class="node">
<title>expert_58</title>
<polygon fill="lightblue" stroke="black" points="13359.5,-2247.77 13114.5,-2247.77 13114.5,-2195.77 13359.5,-2195.77 13359.5,-2247.77"/>
<text text-anchor="middle" x="13237" y="-2235.77" font-family="Arial" font-size="10.00">Expert 58 Computation</text>
<text text-anchor="middle" x="13237" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 58</text>
<text text-anchor="middle" x="13237" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13237" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_58 -->
<g id="edge84" class="edge">
<title>route_1&#45;&gt;expert_58</title>
<path fill="none" stroke="black" d="M10646.78,-2318.48C11148.47,-2314.79 12606.89,-2299.87 13104.23,-2247.88"/>
<polygon fill="black" stroke="black" points="13104.79,-2251.34 13114.36,-2246.8 13104.05,-2244.38 13104.79,-2251.34"/>
</g>
<!-- expert_59 -->
<g id="node70" class="node">
<title>expert_59</title>
<polygon fill="lightblue" stroke="black" points="13622.5,-2247.77 13377.5,-2247.77 13377.5,-2195.77 13622.5,-2195.77 13622.5,-2247.77"/>
<text text-anchor="middle" x="13500" y="-2235.77" font-family="Arial" font-size="10.00">Expert 59 Computation</text>
<text text-anchor="middle" x="13500" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 59</text>
<text text-anchor="middle" x="13500" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13500" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_59 -->
<g id="edge85" class="edge">
<title>route_1&#45;&gt;expert_59</title>
<path fill="none" stroke="black" d="M10647,-2318.98C11182.51,-2316.63 12816.52,-2304.93 13367.34,-2247.86"/>
<polygon fill="black" stroke="black" points="13367.79,-2251.34 13377.37,-2246.81 13367.05,-2244.38 13367.79,-2251.34"/>
</g>
<!-- expert_60 -->
<g id="node71" class="node">
<title>expert_60</title>
<polygon fill="lightblue" stroke="black" points="13885.5,-2247.77 13640.5,-2247.77 13640.5,-2195.77 13885.5,-2195.77 13885.5,-2247.77"/>
<text text-anchor="middle" x="13763" y="-2235.77" font-family="Arial" font-size="10.00">Expert 60 Computation</text>
<text text-anchor="middle" x="13763" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 60</text>
<text text-anchor="middle" x="13763" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="13763" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_60 -->
<g id="edge86" class="edge">
<title>route_1&#45;&gt;expert_60</title>
<path fill="none" stroke="black" d="M10646.9,-2319.39C11214.32,-2318.31 13025.44,-2310.02 13630.24,-2247.87"/>
<polygon fill="black" stroke="black" points="13630.78,-2251.34 13640.37,-2246.82 13630.06,-2244.37 13630.78,-2251.34"/>
</g>
<!-- expert_61 -->
<g id="node72" class="node">
<title>expert_61</title>
<polygon fill="lightblue" stroke="black" points="14148.5,-2247.77 13903.5,-2247.77 13903.5,-2195.77 14148.5,-2195.77 14148.5,-2247.77"/>
<text text-anchor="middle" x="14026" y="-2235.77" font-family="Arial" font-size="10.00">Expert 61 Computation</text>
<text text-anchor="middle" x="14026" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 61</text>
<text text-anchor="middle" x="14026" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14026" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_61 -->
<g id="edge87" class="edge">
<title>route_1&#45;&gt;expert_61</title>
<path fill="none" stroke="black" d="M10646.91,-2319.75C11245.11,-2319.86 13234.55,-2315.12 13893.29,-2247.87"/>
<polygon fill="black" stroke="black" points="13893.78,-2251.33 13903.37,-2246.82 13893.06,-2244.37 13893.78,-2251.33"/>
</g>
<!-- expert_62 -->
<g id="node73" class="node">
<title>expert_62</title>
<polygon fill="lightblue" stroke="black" points="14411.5,-2247.77 14166.5,-2247.77 14166.5,-2195.77 14411.5,-2195.77 14411.5,-2247.77"/>
<text text-anchor="middle" x="14289" y="-2235.77" font-family="Arial" font-size="10.00">Expert 62 Computation</text>
<text text-anchor="middle" x="14289" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 62</text>
<text text-anchor="middle" x="14289" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14289" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_62 -->
<g id="edge88" class="edge">
<title>route_1&#45;&gt;expert_62</title>
<path fill="none" stroke="black" d="M10646.9,-2320.05C11274.65,-2321.3 13443.3,-2320.23 14156.24,-2247.87"/>
<polygon fill="black" stroke="black" points="14156.78,-2251.33 14166.37,-2246.83 14156.06,-2244.37 14156.78,-2251.33"/>
</g>
<!-- expert_63 -->
<g id="node74" class="node">
<title>expert_63</title>
<polygon fill="lightblue" stroke="black" points="14674.5,-2247.77 14429.5,-2247.77 14429.5,-2195.77 14674.5,-2195.77 14674.5,-2247.77"/>
<text text-anchor="middle" x="14552" y="-2235.77" font-family="Arial" font-size="10.00">Expert 63 Computation</text>
<text text-anchor="middle" x="14552" y="-2224.77" font-family="Arial" font-size="10.00">GPU: 63</text>
<text text-anchor="middle" x="14552" y="-2213.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="14552" y="-2202.77" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_1&#45;&gt;expert_63 -->
<g id="edge89" class="edge">
<title>route_1&#45;&gt;expert_63</title>
<path fill="none" stroke="black" d="M10646.51,-2318.15C11350.22,-2312.19 13998.5,-2287.41 14419.27,-2247.83"/>
<polygon fill="black" stroke="black" points="14419.76,-2251.3 14429.37,-2246.83 14419.07,-2244.33 14419.76,-2251.3"/>
</g>
<!-- attn_1 -->
<g id="node75" class="node">
<title>attn_1</title>
<polygon fill="lightblue" stroke="black" points="7485.5,-2159.77 7204.5,-2159.77 7204.5,-2107.77 7485.5,-2107.77 7485.5,-2159.77"/>
<text text-anchor="middle" x="7345" y="-2147.77" font-family="Arial" font-size="10.00">Attention (TP+SP)</text>
<text text-anchor="middle" x="7345" y="-2136.77" font-family="Arial" font-size="10.00">GPU: 32&#45;39</text>
<text text-anchor="middle" x="7345" y="-2125.77" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="7345" y="-2114.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- expert_32&#45;&gt;attn_1 -->
<g id="edge90" class="edge">
<title>expert_32&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M6521.66,-2196.93C6524.46,-2196.52 6527.25,-2196.14 6530,-2195.77 6760.6,-2165.24 7030.09,-2148.8 7194.09,-2140.92"/>
<polygon fill="black" stroke="black" points="7194.43,-2144.41 7204.25,-2140.44 7194.09,-2137.42 7194.43,-2144.41"/>
</g>
<!-- agg_1 -->
<g id="node77" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="7609.24,-1962.23 7188.89,-1962.23 7080.76,-1858.23 7501.11,-1858.23 7609.24,-1962.23"/>
<text text-anchor="middle" x="7345" y="-1924.23" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7345" y="-1913.23" font-family="Arial" font-size="10.00">GPU: 32&#45;39</text>
<text text-anchor="middle" x="7345" y="-1902.23" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7345" y="-1891.23" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_32&#45;&gt;agg_1 -->
<g id="edge91" class="edge">
<title>expert_32&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M6444.19,-2195.61C6528.5,-2149.7 6716.58,-2052.13 6886,-1998.23 6971.23,-1971.12 7068.19,-1951.23 7150.97,-1937.36"/>
<polygon fill="black" stroke="black" points="7151.7,-1940.79 7160.99,-1935.7 7150.56,-1933.88 7151.7,-1940.79"/>
</g>
<!-- expert_33&#45;&gt;attn_1 -->
<g id="edge92" class="edge">
<title>expert_33&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M6784.68,-2197.06C6787.47,-2196.62 6790.25,-2196.19 6793,-2195.77 6928.1,-2175.45 7082.77,-2158.94 7193.94,-2148.24"/>
<polygon fill="black" stroke="black" points="7194.6,-2151.69 7204.23,-2147.26 7193.94,-2144.73 7194.6,-2151.69"/>
</g>
<!-- expert_33&#45;&gt;agg_1 -->
<g id="edge93" class="edge">
<title>expert_33&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M6696.62,-2195.62C6760.3,-2150.39 6901.56,-2054.76 7033,-1998.23 7074.87,-1980.23 7121.5,-1964.9 7165.69,-1952.37"/>
<polygon fill="black" stroke="black" points="7166.69,-1955.72 7175.37,-1949.65 7164.8,-1948.98 7166.69,-1955.72"/>
</g>
<!-- expert_34&#45;&gt;attn_1 -->
<g id="edge94" class="edge">
<title>expert_34&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M7047.33,-2195.73C7099.31,-2185.08 7160.02,-2172.65 7213.01,-2161.8"/>
<polygon fill="black" stroke="black" points="7213.71,-2165.23 7222.81,-2159.79 7212.31,-2158.37 7213.71,-2165.23"/>
</g>
<!-- expert_34&#45;&gt;agg_1 -->
<g id="edge95" class="edge">
<title>expert_34&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M6940.65,-2195.49C6969.96,-2150.03 7037.42,-2054.06 7117,-1998.23 7135.43,-1985.31 7156.03,-1974 7177.11,-1964.19"/>
<polygon fill="black" stroke="black" points="7178.83,-1967.25 7186.49,-1959.94 7175.94,-1960.88 7178.83,-1967.25"/>
</g>
<!-- expert_35&#45;&gt;attn_1 -->
<g id="edge96" class="edge">
<title>expert_35&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M7233.83,-2195.67C7251.49,-2186 7271.83,-2174.85 7290.24,-2164.77"/>
<polygon fill="black" stroke="black" points="7292.02,-2167.78 7299.11,-2159.91 7288.66,-2161.65 7292.02,-2167.78"/>
</g>
<!-- expert_35&#45;&gt;agg_1 -->
<g id="edge97" class="edge">
<title>expert_35&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7170.6,-2195.49C7142.82,-2151.69 7095.6,-2060.43 7137,-1998.23 7146.61,-1983.8 7159.12,-1971.75 7173.25,-1961.7"/>
<polygon fill="black" stroke="black" points="7175.38,-1964.49 7181.74,-1956.02 7171.48,-1958.67 7175.38,-1964.49"/>
</g>
<!-- expert_36&#45;&gt;attn_1 -->
<g id="edge98" class="edge">
<title>expert_36&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M7420.06,-2195.67C7408.83,-2186.56 7396.01,-2176.16 7384.17,-2166.55"/>
<polygon fill="black" stroke="black" points="7386.14,-2163.64 7376.17,-2160.06 7381.73,-2169.08 7386.14,-2163.64"/>
</g>
<!-- expert_36&#45;&gt;agg_1 -->
<g id="edge99" class="edge">
<title>expert_36&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7478.49,-2195.75C7521.91,-2153.11 7597.16,-2064.57 7553,-1998.23 7545.48,-1986.94 7536.19,-1977.11 7525.73,-1968.55"/>
<polygon fill="black" stroke="black" points="7527.59,-1965.56 7517.52,-1962.25 7523.32,-1971.12 7527.59,-1965.56"/>
</g>
<!-- expert_37&#45;&gt;attn_1 -->
<g id="edge100" class="edge">
<title>expert_37&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M7606.28,-2195.67C7561.1,-2185.14 7508.44,-2172.87 7462.28,-2162.11"/>
<polygon fill="black" stroke="black" points="7463.07,-2158.7 7452.54,-2159.84 7461.48,-2165.52 7463.07,-2158.7"/>
</g>
<!-- expert_37&#45;&gt;agg_1 -->
<g id="edge101" class="edge">
<title>expert_37&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7703.27,-2195.44C7682.79,-2149.92 7633.95,-2053.84 7565,-1998.23 7550.3,-1986.38 7533.78,-1975.97 7516.57,-1966.88"/>
<polygon fill="black" stroke="black" points="7518.01,-1963.69 7507.52,-1962.25 7514.82,-1969.92 7518.01,-1963.69"/>
</g>
<!-- expert_38&#45;&gt;attn_1 -->
<g id="edge102" class="edge">
<title>expert_38&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M7854.44,-2197.28C7851.26,-2196.76 7848.11,-2196.26 7845,-2195.77 7728.15,-2177.6 7595.23,-2161.61 7495.82,-2150.56"/>
<polygon fill="black" stroke="black" points="7496.02,-2147.06 7485.7,-2149.44 7495.25,-2154.02 7496.02,-2147.06"/>
</g>
<!-- expert_38&#45;&gt;agg_1 -->
<g id="edge103" class="edge">
<title>expert_38&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7940.85,-2195.61C7875.83,-2151.19 7733.83,-2057.93 7604,-1998.23 7578.56,-1986.53 7551.07,-1975.6 7523.84,-1965.71"/>
<polygon fill="black" stroke="black" points="7524.82,-1962.34 7514.23,-1962.25 7522.45,-1968.93 7524.82,-1962.34"/>
</g>
<!-- expert_39&#45;&gt;attn_1 -->
<g id="edge104" class="edge">
<title>expert_39&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M8117.46,-2197.1C8114.28,-2196.64 8111.12,-2196.19 8108,-2195.77 7896.48,-2167.37 7650.07,-2150.6 7495.79,-2142.04"/>
<polygon fill="black" stroke="black" points="7495.94,-2138.54 7485.76,-2141.49 7495.55,-2145.53 7495.94,-2138.54"/>
</g>
<!-- expert_39&#45;&gt;agg_1 -->
<g id="edge105" class="edge">
<title>expert_39&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M8183.29,-2195.72C8082.69,-2151.88 7865.78,-2060.03 7677,-1998.23 7641.26,-1986.54 7602.97,-1975.32 7565.55,-1965.05"/>
<polygon fill="black" stroke="black" points="7566.11,-1961.58 7555.54,-1962.33 7564.27,-1968.33 7566.11,-1961.58"/>
</g>
<!-- attn_comm_1 -->
<g id="node76" class="node">
<title>attn_comm_1</title>
<ellipse fill="lightgreen" stroke="black" cx="7345" cy="-2035" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="7345" y="-2049" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="7345" y="-2038" font-family="Arial" font-size="10.00">GPU: 32&#45;39</text>
<text text-anchor="middle" x="7345" y="-2027" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="7345" y="-2016" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- attn_1&#45;&gt;attn_comm_1 -->
<g id="edge106" class="edge">
<title>attn_1&#45;&gt;attn_comm_1</title>
<path fill="none" stroke="black" d="M7345,-2107.6C7345,-2099.79 7345,-2090.93 7345,-2082.16"/>
<polygon fill="black" stroke="black" points="7348.5,-2081.98 7345,-2071.98 7341.5,-2081.98 7348.5,-2081.98"/>
</g>
<!-- attn_comm_1&#45;&gt;agg_1 -->
<g id="edge107" class="edge">
<title>attn_comm_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7345,-1998.16C7345,-1990.13 7345,-1981.38 7345,-1972.63"/>
<polygon fill="black" stroke="black" points="7348.5,-1972.4 7345,-1962.4 7341.5,-1972.4 7348.5,-1972.4"/>
</g>
<!-- pipe_comm_1_2 -->
<g id="node156" class="node">
<title>pipe_comm_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="7345" cy="-1785.47" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="7345" y="-1799.47" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="7345" y="-1788.47" font-family="Arial" font-size="10.00">GPU: 63&#45;&gt;64</text>
<text text-anchor="middle" x="7345" y="-1777.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7345" y="-1766.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- agg_1&#45;&gt;pipe_comm_1_2 -->
<g id="edge108" class="edge">
<title>agg_1&#45;&gt;pipe_comm_1_2</title>
<path fill="none" stroke="black" d="M7345,-1857.88C7345,-1849.47 7345,-1840.81 7345,-1832.54"/>
<polygon fill="black" stroke="black" points="7348.5,-1832.32 7345,-1822.32 7341.5,-1832.32 7348.5,-1832.32"/>
</g>
<!-- embed_2 -->
<g id="node78" class="node">
<title>embed_2</title>
<polygon fill="lightblue" stroke="black" points="7472.5,-1694.7 7217.5,-1694.7 7217.5,-1642.7 7472.5,-1642.7 7472.5,-1694.7"/>
<text text-anchor="middle" x="7345" y="-1682.7" font-family="Arial" font-size="10.00">Token Embedding</text>
<text text-anchor="middle" x="7345" y="-1671.7" font-family="Arial" font-size="10.00">GPU: 64&#45;71</text>
<text text-anchor="middle" x="7345" y="-1660.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7345" y="-1649.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- gate_2 -->
<g id="node79" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="7602.23,-1606.7 7193.03,-1606.7 7087.77,-1502.7 7496.97,-1502.7 7602.23,-1606.7"/>
<text text-anchor="middle" x="7345" y="-1568.7" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="7345" y="-1557.7" font-family="Arial" font-size="10.00">GPU: 64&#45;71</text>
<text text-anchor="middle" x="7345" y="-1546.7" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="7345" y="-1535.7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=32]</text>
</g>
<!-- embed_2&#45;&gt;gate_2 -->
<g id="edge110" class="edge">
<title>embed_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M7345,-1642.56C7345,-1634.88 7345,-1626.06 7345,-1617.06"/>
<polygon fill="black" stroke="black" points="7348.5,-1616.87 7345,-1606.87 7341.5,-1616.87 7348.5,-1616.87"/>
</g>
<!-- route_2 -->
<g id="node80" class="node">
<title>route_2</title>
<ellipse fill="lightgreen" stroke="black" cx="7345" cy="-1429.93" rx="171.65" ry="36.54"/>
<text text-anchor="middle" x="7345" y="-1443.93" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="7345" y="-1432.93" font-family="Arial" font-size="10.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="7345" y="-1421.93" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=32]</text>
<text text-anchor="middle" x="7345" y="-1410.93" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=1]</text>
</g>
<!-- gate_2&#45;&gt;route_2 -->
<g id="edge111" class="edge">
<title>gate_2&#45;&gt;route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7345,-1502.34C7345,-1493.93 7345,-1485.27 7345,-1477"/>
<polygon fill="black" stroke="black" points="7348.5,-1476.78 7345,-1466.78 7341.5,-1476.78 7348.5,-1476.78"/>
</g>
<!-- expert_64 -->
<g id="node81" class="node">
<title>expert_64</title>
<polygon fill="lightblue" stroke="black" points="3391.5,-1357.16 3146.5,-1357.16 3146.5,-1305.16 3391.5,-1305.16 3391.5,-1357.16"/>
<text text-anchor="middle" x="3269" y="-1345.16" font-family="Arial" font-size="10.00">Expert 64 Computation</text>
<text text-anchor="middle" x="3269" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 64</text>
<text text-anchor="middle" x="3269" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3269" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_64 -->
<g id="edge112" class="edge">
<title>route_2&#45;&gt;expert_64</title>
<path fill="none" stroke="black" d="M7173.54,-1427.53C6470,-1421.57 3822.4,-1396.78 3401.72,-1357.21"/>
<polygon fill="black" stroke="black" points="3401.93,-1353.72 3391.63,-1356.22 3401.24,-1360.68 3401.93,-1353.72"/>
</g>
<!-- expert_65 -->
<g id="node82" class="node">
<title>expert_65</title>
<polygon fill="lightblue" stroke="black" points="3654.5,-1357.16 3409.5,-1357.16 3409.5,-1305.16 3654.5,-1305.16 3654.5,-1357.16"/>
<text text-anchor="middle" x="3532" y="-1345.16" font-family="Arial" font-size="10.00">Expert 65 Computation</text>
<text text-anchor="middle" x="3532" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 65</text>
<text text-anchor="middle" x="3532" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3532" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_65 -->
<g id="edge113" class="edge">
<title>route_2&#45;&gt;expert_65</title>
<path fill="none" stroke="black" d="M7173.15,-1429.43C6545.57,-1430.68 4377.51,-1429.6 3664.76,-1357.25"/>
<polygon fill="black" stroke="black" points="3664.94,-1353.75 3654.63,-1356.21 3664.22,-1360.72 3664.94,-1353.75"/>
</g>
<!-- expert_66 -->
<g id="node83" class="node">
<title>expert_66</title>
<polygon fill="lightblue" stroke="black" points="3917.5,-1357.16 3672.5,-1357.16 3672.5,-1305.16 3917.5,-1305.16 3917.5,-1357.16"/>
<text text-anchor="middle" x="3795" y="-1345.16" font-family="Arial" font-size="10.00">Expert 66 Computation</text>
<text text-anchor="middle" x="3795" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 66</text>
<text text-anchor="middle" x="3795" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3795" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_66 -->
<g id="edge114" class="edge">
<title>route_2&#45;&gt;expert_66</title>
<path fill="none" stroke="black" d="M7173.14,-1429.13C6575.11,-1429.24 4586.25,-1424.48 3927.71,-1357.25"/>
<polygon fill="black" stroke="black" points="3927.94,-1353.75 3917.63,-1356.2 3927.22,-1360.72 3927.94,-1353.75"/>
</g>
<!-- expert_67 -->
<g id="node84" class="node">
<title>expert_67</title>
<polygon fill="lightblue" stroke="black" points="4180.5,-1357.16 3935.5,-1357.16 3935.5,-1305.16 4180.5,-1305.16 4180.5,-1357.16"/>
<text text-anchor="middle" x="4058" y="-1345.16" font-family="Arial" font-size="10.00">Expert 67 Computation</text>
<text text-anchor="middle" x="4058" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 67</text>
<text text-anchor="middle" x="4058" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4058" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_67 -->
<g id="edge115" class="edge">
<title>route_2&#45;&gt;expert_67</title>
<path fill="none" stroke="black" d="M7173.16,-1428.77C6605.91,-1427.69 4795.37,-1419.38 4190.76,-1357.26"/>
<polygon fill="black" stroke="black" points="4190.94,-1353.76 4180.63,-1356.2 4190.22,-1360.72 4190.94,-1353.76"/>
</g>
<!-- expert_68 -->
<g id="node85" class="node">
<title>expert_68</title>
<polygon fill="lightblue" stroke="black" points="4443.5,-1357.16 4198.5,-1357.16 4198.5,-1305.16 4443.5,-1305.16 4443.5,-1357.16"/>
<text text-anchor="middle" x="4321" y="-1345.16" font-family="Arial" font-size="10.00">Expert 68 Computation</text>
<text text-anchor="middle" x="4321" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 68</text>
<text text-anchor="middle" x="4321" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4321" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_68 -->
<g id="edge116" class="edge">
<title>route_2&#45;&gt;expert_68</title>
<path fill="none" stroke="black" d="M7173.06,-1428.36C6637.74,-1426 5004.29,-1414.29 4453.66,-1357.25"/>
<polygon fill="black" stroke="black" points="4453.95,-1353.76 4443.63,-1356.19 4453.21,-1360.72 4453.95,-1353.76"/>
</g>
<!-- expert_69 -->
<g id="node86" class="node">
<title>expert_69</title>
<polygon fill="lightblue" stroke="black" points="4706.5,-1357.16 4461.5,-1357.16 4461.5,-1305.16 4706.5,-1305.16 4706.5,-1357.16"/>
<text text-anchor="middle" x="4584" y="-1345.16" font-family="Arial" font-size="10.00">Expert 69 Computation</text>
<text text-anchor="middle" x="4584" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 69</text>
<text text-anchor="middle" x="4584" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4584" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_69 -->
<g id="edge117" class="edge">
<title>route_2&#45;&gt;expert_69</title>
<path fill="none" stroke="black" d="M7173.29,-1427.86C6671.79,-1424.17 5213.92,-1409.24 4716.76,-1357.26"/>
<polygon fill="black" stroke="black" points="4716.95,-1353.76 4706.64,-1356.18 4716.21,-1360.72 4716.95,-1353.76"/>
</g>
<!-- expert_70 -->
<g id="node87" class="node">
<title>expert_70</title>
<polygon fill="lightblue" stroke="black" points="4969.5,-1357.16 4724.5,-1357.16 4724.5,-1305.16 4969.5,-1305.16 4969.5,-1357.16"/>
<text text-anchor="middle" x="4847" y="-1345.16" font-family="Arial" font-size="10.00">Expert 70 Computation</text>
<text text-anchor="middle" x="4847" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 70</text>
<text text-anchor="middle" x="4847" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4847" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_70 -->
<g id="edge118" class="edge">
<title>route_2&#45;&gt;expert_70</title>
<path fill="none" stroke="black" d="M7173.51,-1427.25C6707.42,-1422.14 5423.29,-1404.2 4979.64,-1357.25"/>
<polygon fill="black" stroke="black" points="4979.95,-1353.76 4969.64,-1356.17 4979.2,-1360.72 4979.95,-1353.76"/>
</g>
<!-- expert_71 -->
<g id="node88" class="node">
<title>expert_71</title>
<polygon fill="lightblue" stroke="black" points="5232.5,-1357.16 4987.5,-1357.16 4987.5,-1305.16 5232.5,-1305.16 5232.5,-1357.16"/>
<text text-anchor="middle" x="5110" y="-1345.16" font-family="Arial" font-size="10.00">Expert 71 Computation</text>
<text text-anchor="middle" x="5110" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 71</text>
<text text-anchor="middle" x="5110" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5110" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_71 -->
<g id="edge119" class="edge">
<title>route_2&#45;&gt;expert_71</title>
<path fill="none" stroke="black" d="M7173.67,-1426.5C6745.08,-1419.87 5633.53,-1399.2 5242.86,-1357.28"/>
<polygon fill="black" stroke="black" points="5242.96,-1353.77 5232.64,-1356.16 5242.2,-1360.72 5242.96,-1353.77"/>
</g>
<!-- expert_72 -->
<g id="node89" class="node">
<title>expert_72</title>
<polygon fill="lightblue" stroke="black" points="5495.5,-1357.16 5250.5,-1357.16 5250.5,-1305.16 5495.5,-1305.16 5495.5,-1357.16"/>
<text text-anchor="middle" x="5373" y="-1345.16" font-family="Arial" font-size="10.00">Expert 72 Computation</text>
<text text-anchor="middle" x="5373" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 72</text>
<text text-anchor="middle" x="5373" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5373" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_72 -->
<g id="edge120" class="edge">
<title>route_2&#45;&gt;expert_72</title>
<path fill="none" stroke="black" d="M7174.11,-1425.53C6785.42,-1417.3 5843.38,-1394.22 5505.7,-1357.26"/>
<polygon fill="black" stroke="black" points="5505.97,-1353.77 5495.64,-1356.14 5505.19,-1360.73 5505.97,-1353.77"/>
</g>
<!-- expert_73 -->
<g id="node90" class="node">
<title>expert_73</title>
<polygon fill="lightblue" stroke="black" points="5758.5,-1357.16 5513.5,-1357.16 5513.5,-1305.16 5758.5,-1305.16 5758.5,-1357.16"/>
<text text-anchor="middle" x="5636" y="-1345.16" font-family="Arial" font-size="10.00">Expert 73 Computation</text>
<text text-anchor="middle" x="5636" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 73</text>
<text text-anchor="middle" x="5636" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5636" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_73 -->
<g id="edge121" class="edge">
<title>route_2&#45;&gt;expert_73</title>
<path fill="none" stroke="black" d="M7173.01,-1429.14C6884.25,-1427.71 6283.8,-1417.11 5768.88,-1357.31"/>
<polygon fill="black" stroke="black" points="5768.98,-1353.8 5758.64,-1356.11 5768.17,-1360.75 5768.98,-1353.8"/>
</g>
<!-- expert_74 -->
<g id="node91" class="node">
<title>expert_74</title>
<polygon fill="lightblue" stroke="black" points="6021.5,-1357.16 5776.5,-1357.16 5776.5,-1305.16 6021.5,-1305.16 6021.5,-1357.16"/>
<text text-anchor="middle" x="5899" y="-1345.16" font-family="Arial" font-size="10.00">Expert 74 Computation</text>
<text text-anchor="middle" x="5899" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 74</text>
<text text-anchor="middle" x="5899" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5899" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_74 -->
<g id="edge122" class="edge">
<title>route_2&#45;&gt;expert_74</title>
<path fill="none" stroke="black" d="M7173.61,-1426.89C6924.03,-1422.28 6446.01,-1407.27 6031.73,-1357.3"/>
<polygon fill="black" stroke="black" points="6032,-1353.81 6021.65,-1356.08 6031.15,-1360.76 6032,-1353.81"/>
</g>
<!-- expert_75 -->
<g id="node92" class="node">
<title>expert_75</title>
<polygon fill="lightblue" stroke="black" points="6284.5,-1357.16 6039.5,-1357.16 6039.5,-1305.16 6284.5,-1305.16 6284.5,-1357.16"/>
<text text-anchor="middle" x="6162" y="-1345.16" font-family="Arial" font-size="10.00">Expert 75 Computation</text>
<text text-anchor="middle" x="6162" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 75</text>
<text text-anchor="middle" x="6162" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6162" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_75 -->
<g id="edge123" class="edge">
<title>route_2&#45;&gt;expert_75</title>
<path fill="none" stroke="black" d="M7175.39,-1423.64C6969.19,-1415.79 6610.59,-1397.53 6294.92,-1357.34"/>
<polygon fill="black" stroke="black" points="6295.02,-1353.83 6284.65,-1356.03 6294.13,-1360.77 6295.02,-1353.83"/>
</g>
<!-- expert_76 -->
<g id="node93" class="node">
<title>expert_76</title>
<polygon fill="lightblue" stroke="black" points="6547.5,-1357.16 6302.5,-1357.16 6302.5,-1305.16 6547.5,-1305.16 6547.5,-1357.16"/>
<text text-anchor="middle" x="6425" y="-1345.16" font-family="Arial" font-size="10.00">Expert 76 Computation</text>
<text text-anchor="middle" x="6425" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 76</text>
<text text-anchor="middle" x="6425" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6425" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_76 -->
<g id="edge124" class="edge">
<title>route_2&#45;&gt;expert_76</title>
<path fill="none" stroke="black" d="M7181.26,-1418.72C7023.73,-1407.82 6778.76,-1388.02 6557.83,-1357.36"/>
<polygon fill="black" stroke="black" points="6558.05,-1353.86 6547.67,-1355.94 6557.08,-1360.79 6558.05,-1353.86"/>
</g>
<!-- expert_77 -->
<g id="node94" class="node">
<title>expert_77</title>
<polygon fill="lightblue" stroke="black" points="6810.5,-1357.16 6565.5,-1357.16 6565.5,-1305.16 6810.5,-1305.16 6810.5,-1357.16"/>
<text text-anchor="middle" x="6688" y="-1345.16" font-family="Arial" font-size="10.00">Expert 77 Computation</text>
<text text-anchor="middle" x="6688" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 77</text>
<text text-anchor="middle" x="6688" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6688" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_77 -->
<g id="edge125" class="edge">
<title>route_2&#45;&gt;expert_77</title>
<path fill="none" stroke="black" d="M7197.6,-1410.94C7094.55,-1397.85 6953.54,-1378.95 6820.65,-1357.4"/>
<polygon fill="black" stroke="black" points="6821.12,-1353.93 6810.69,-1355.77 6820,-1360.84 6821.12,-1353.93"/>
</g>
<!-- expert_78 -->
<g id="node95" class="node">
<title>expert_78</title>
<polygon fill="lightblue" stroke="black" points="7073.5,-1357.16 6828.5,-1357.16 6828.5,-1305.16 7073.5,-1305.16 7073.5,-1357.16"/>
<text text-anchor="middle" x="6951" y="-1345.16" font-family="Arial" font-size="10.00">Expert 78 Computation</text>
<text text-anchor="middle" x="6951" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 78</text>
<text text-anchor="middle" x="6951" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6951" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_78 -->
<g id="edge126" class="edge">
<title>route_2&#45;&gt;expert_78</title>
<path fill="none" stroke="black" d="M7234.2,-1401.71C7180.63,-1388.56 7116.47,-1372.8 7062.78,-1359.61"/>
<polygon fill="black" stroke="black" points="7063.42,-1356.16 7052.88,-1357.18 7061.75,-1362.96 7063.42,-1356.16"/>
</g>
<!-- expert_79 -->
<g id="node96" class="node">
<title>expert_79</title>
<polygon fill="lightblue" stroke="black" points="7336.5,-1357.16 7091.5,-1357.16 7091.5,-1305.16 7336.5,-1305.16 7336.5,-1357.16"/>
<text text-anchor="middle" x="7214" y="-1345.16" font-family="Arial" font-size="10.00">Expert 79 Computation</text>
<text text-anchor="middle" x="7214" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 79</text>
<text text-anchor="middle" x="7214" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7214" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_79 -->
<g id="edge127" class="edge">
<title>route_2&#45;&gt;expert_79</title>
<path fill="none" stroke="black" d="M7298.08,-1394.26C7284.34,-1384.11 7269.41,-1373.09 7255.99,-1363.18"/>
<polygon fill="black" stroke="black" points="7257.99,-1360.3 7247.86,-1357.17 7253.83,-1365.93 7257.99,-1360.3"/>
</g>
<!-- expert_80 -->
<g id="node97" class="node">
<title>expert_80</title>
<polygon fill="lightblue" stroke="black" points="7599.5,-1357.16 7354.5,-1357.16 7354.5,-1305.16 7599.5,-1305.16 7599.5,-1357.16"/>
<text text-anchor="middle" x="7477" y="-1345.16" font-family="Arial" font-size="10.00">Expert 80 Computation</text>
<text text-anchor="middle" x="7477" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 80</text>
<text text-anchor="middle" x="7477" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7477" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_80 -->
<g id="edge128" class="edge">
<title>route_2&#45;&gt;expert_80</title>
<path fill="none" stroke="black" d="M7391.91,-1394.54C7405.78,-1384.37 7420.88,-1373.3 7434.46,-1363.35"/>
<polygon fill="black" stroke="black" points="7436.69,-1366.05 7442.69,-1357.31 7432.55,-1360.4 7436.69,-1366.05"/>
</g>
<!-- expert_81 -->
<g id="node98" class="node">
<title>expert_81</title>
<polygon fill="lightblue" stroke="black" points="7862.5,-1357.16 7617.5,-1357.16 7617.5,-1305.16 7862.5,-1305.16 7862.5,-1357.16"/>
<text text-anchor="middle" x="7740" y="-1345.16" font-family="Arial" font-size="10.00">Expert 81 Computation</text>
<text text-anchor="middle" x="7740" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 81</text>
<text text-anchor="middle" x="7740" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7740" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_81 -->
<g id="edge129" class="edge">
<title>route_2&#45;&gt;expert_81</title>
<path fill="none" stroke="black" d="M7455.82,-1401.78C7509.53,-1388.62 7573.91,-1372.85 7627.8,-1359.64"/>
<polygon fill="black" stroke="black" points="7628.85,-1362.99 7637.73,-1357.21 7627.19,-1356.19 7628.85,-1362.99"/>
</g>
<!-- expert_82 -->
<g id="node99" class="node">
<title>expert_82</title>
<polygon fill="lightblue" stroke="black" points="8125.5,-1357.16 7880.5,-1357.16 7880.5,-1305.16 8125.5,-1305.16 8125.5,-1357.16"/>
<text text-anchor="middle" x="8003" y="-1345.16" font-family="Arial" font-size="10.00">Expert 82 Computation</text>
<text text-anchor="middle" x="8003" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 82</text>
<text text-anchor="middle" x="8003" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8003" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_82 -->
<g id="edge130" class="edge">
<title>route_2&#45;&gt;expert_82</title>
<path fill="none" stroke="black" d="M7492.11,-1410.92C7595.17,-1397.81 7736.33,-1378.88 7870.38,-1357.22"/>
<polygon fill="black" stroke="black" points="7871.12,-1360.65 7880.43,-1355.59 7870,-1353.74 7871.12,-1360.65"/>
</g>
<!-- expert_83 -->
<g id="node100" class="node">
<title>expert_83</title>
<polygon fill="lightblue" stroke="black" points="8388.5,-1357.16 8143.5,-1357.16 8143.5,-1305.16 8388.5,-1305.16 8388.5,-1357.16"/>
<text text-anchor="middle" x="8266" y="-1345.16" font-family="Arial" font-size="10.00">Expert 83 Computation</text>
<text text-anchor="middle" x="8266" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 83</text>
<text text-anchor="middle" x="8266" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8266" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_83 -->
<g id="edge131" class="edge">
<title>route_2&#45;&gt;expert_83</title>
<path fill="none" stroke="black" d="M7508.73,-1418.66C7666.25,-1407.71 7911.22,-1387.87 8133.24,-1357.2"/>
<polygon fill="black" stroke="black" points="8134.03,-1360.63 8143.46,-1355.78 8133.07,-1353.69 8134.03,-1360.63"/>
</g>
<!-- expert_84 -->
<g id="node101" class="node">
<title>expert_84</title>
<polygon fill="lightblue" stroke="black" points="8651.5,-1357.16 8406.5,-1357.16 8406.5,-1305.16 8651.5,-1305.16 8651.5,-1357.16"/>
<text text-anchor="middle" x="8529" y="-1345.16" font-family="Arial" font-size="10.00">Expert 84 Computation</text>
<text text-anchor="middle" x="8529" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 84</text>
<text text-anchor="middle" x="8529" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8529" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_84 -->
<g id="edge132" class="edge">
<title>route_2&#45;&gt;expert_84</title>
<path fill="none" stroke="black" d="M7514.6,-1423.57C7720.79,-1415.65 8079.38,-1397.32 8396.17,-1357.19"/>
<polygon fill="black" stroke="black" points="8396.99,-1360.61 8406.47,-1355.88 8396.11,-1353.67 8396.99,-1360.61"/>
</g>
<!-- expert_85 -->
<g id="node102" class="node">
<title>expert_85</title>
<polygon fill="lightblue" stroke="black" points="8914.5,-1357.16 8669.5,-1357.16 8669.5,-1305.16 8914.5,-1305.16 8914.5,-1357.16"/>
<text text-anchor="middle" x="8792" y="-1345.16" font-family="Arial" font-size="10.00">Expert 85 Computation</text>
<text text-anchor="middle" x="8792" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 85</text>
<text text-anchor="middle" x="8792" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8792" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_85 -->
<g id="edge133" class="edge">
<title>route_2&#45;&gt;expert_85</title>
<path fill="none" stroke="black" d="M7516.38,-1426.81C7765.95,-1422.11 8243.96,-1406.98 8659.37,-1357.15"/>
<polygon fill="black" stroke="black" points="8659.97,-1360.61 8669.48,-1355.93 8659.13,-1353.66 8659.97,-1360.61"/>
</g>
<!-- expert_86 -->
<g id="node103" class="node">
<title>expert_86</title>
<polygon fill="lightblue" stroke="black" points="9177.5,-1357.16 8932.5,-1357.16 8932.5,-1305.16 9177.5,-1305.16 9177.5,-1357.16"/>
<text text-anchor="middle" x="9055" y="-1345.16" font-family="Arial" font-size="10.00">Expert 86 Computation</text>
<text text-anchor="middle" x="9055" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 86</text>
<text text-anchor="middle" x="9055" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9055" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_86 -->
<g id="edge134" class="edge">
<title>route_2&#45;&gt;expert_86</title>
<path fill="none" stroke="black" d="M7516.98,-1429.06C7805.72,-1427.52 8406.16,-1416.75 8922.22,-1357.16"/>
<polygon fill="black" stroke="black" points="8922.95,-1360.6 8932.48,-1355.97 8922.14,-1353.65 8922.95,-1360.6"/>
</g>
<!-- expert_87 -->
<g id="node104" class="node">
<title>expert_87</title>
<polygon fill="lightblue" stroke="black" points="9440.5,-1357.16 9195.5,-1357.16 9195.5,-1305.16 9440.5,-1305.16 9440.5,-1357.16"/>
<text text-anchor="middle" x="9318" y="-1345.16" font-family="Arial" font-size="10.00">Expert 87 Computation</text>
<text text-anchor="middle" x="9318" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 87</text>
<text text-anchor="middle" x="9318" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9318" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_87 -->
<g id="edge135" class="edge">
<title>route_2&#45;&gt;expert_87</title>
<path fill="none" stroke="black" d="M7515.89,-1425.5C7904.57,-1417.2 8846.59,-1394 9185.39,-1357.12"/>
<polygon fill="black" stroke="black" points="9185.93,-1360.58 9195.48,-1356 9185.16,-1353.63 9185.93,-1360.58"/>
</g>
<!-- expert_88 -->
<g id="node105" class="node">
<title>expert_88</title>
<polygon fill="lightblue" stroke="black" points="9703.5,-1357.16 9458.5,-1357.16 9458.5,-1305.16 9703.5,-1305.16 9703.5,-1357.16"/>
<text text-anchor="middle" x="9581" y="-1345.16" font-family="Arial" font-size="10.00">Expert 88 Computation</text>
<text text-anchor="middle" x="9581" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 88</text>
<text text-anchor="middle" x="9581" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9581" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_88 -->
<g id="edge136" class="edge">
<title>route_2&#45;&gt;expert_88</title>
<path fill="none" stroke="black" d="M7516.33,-1426.47C7945.02,-1419.77 9056.99,-1398.93 9448.52,-1357.11"/>
<polygon fill="black" stroke="black" points="9448.93,-1360.58 9458.49,-1356.02 9448.17,-1353.62 9448.93,-1360.58"/>
</g>
<!-- expert_89 -->
<g id="node106" class="node">
<title>expert_89</title>
<polygon fill="lightblue" stroke="black" points="9966.5,-1357.16 9721.5,-1357.16 9721.5,-1305.16 9966.5,-1305.16 9966.5,-1357.16"/>
<text text-anchor="middle" x="9844" y="-1345.16" font-family="Arial" font-size="10.00">Expert 89 Computation</text>
<text text-anchor="middle" x="9844" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 89</text>
<text text-anchor="middle" x="9844" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="9844" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_89 -->
<g id="edge137" class="edge">
<title>route_2&#45;&gt;expert_89</title>
<path fill="none" stroke="black" d="M7516.57,-1427.25C7982.85,-1422.15 9267.53,-1404.22 9711.36,-1357.25"/>
<polygon fill="black" stroke="black" points="9711.8,-1360.72 9721.36,-1356.17 9711.05,-1353.76 9711.8,-1360.72"/>
</g>
<!-- expert_90 -->
<g id="node107" class="node">
<title>expert_90</title>
<polygon fill="lightblue" stroke="black" points="10229.5,-1357.16 9984.5,-1357.16 9984.5,-1305.16 10229.5,-1305.16 10229.5,-1357.16"/>
<text text-anchor="middle" x="10107" y="-1345.16" font-family="Arial" font-size="10.00">Expert 90 Computation</text>
<text text-anchor="middle" x="10107" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 90</text>
<text text-anchor="middle" x="10107" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10107" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_90 -->
<g id="edge138" class="edge">
<title>route_2&#45;&gt;expert_90</title>
<path fill="none" stroke="black" d="M7516.78,-1427.86C8018.47,-1424.17 9476.89,-1409.26 9974.23,-1357.26"/>
<polygon fill="black" stroke="black" points="9974.79,-1360.72 9984.36,-1356.18 9974.05,-1353.76 9974.79,-1360.72"/>
</g>
<!-- expert_91 -->
<g id="node108" class="node">
<title>expert_91</title>
<polygon fill="lightblue" stroke="black" points="10492.5,-1357.16 10247.5,-1357.16 10247.5,-1305.16 10492.5,-1305.16 10492.5,-1357.16"/>
<text text-anchor="middle" x="10370" y="-1345.16" font-family="Arial" font-size="10.00">Expert 91 Computation</text>
<text text-anchor="middle" x="10370" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 91</text>
<text text-anchor="middle" x="10370" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10370" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_91 -->
<g id="edge139" class="edge">
<title>route_2&#45;&gt;expert_91</title>
<path fill="none" stroke="black" d="M7517,-1428.36C8052.51,-1426.01 9686.52,-1414.31 10237.34,-1357.25"/>
<polygon fill="black" stroke="black" points="10237.79,-1360.72 10247.37,-1356.19 10237.05,-1353.76 10237.79,-1360.72"/>
</g>
<!-- expert_92 -->
<g id="node109" class="node">
<title>expert_92</title>
<polygon fill="lightblue" stroke="black" points="10755.5,-1357.16 10510.5,-1357.16 10510.5,-1305.16 10755.5,-1305.16 10755.5,-1357.16"/>
<text text-anchor="middle" x="10633" y="-1345.16" font-family="Arial" font-size="10.00">Expert 92 Computation</text>
<text text-anchor="middle" x="10633" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 92</text>
<text text-anchor="middle" x="10633" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10633" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_92 -->
<g id="edge140" class="edge">
<title>route_2&#45;&gt;expert_92</title>
<path fill="none" stroke="black" d="M7516.9,-1428.78C8084.32,-1427.69 9895.44,-1419.4 10500.24,-1357.26"/>
<polygon fill="black" stroke="black" points="10500.78,-1360.72 10510.37,-1356.2 10500.06,-1353.76 10500.78,-1360.72"/>
</g>
<!-- expert_93 -->
<g id="node110" class="node">
<title>expert_93</title>
<polygon fill="lightblue" stroke="black" points="11018.5,-1357.16 10773.5,-1357.16 10773.5,-1305.16 11018.5,-1305.16 11018.5,-1357.16"/>
<text text-anchor="middle" x="10896" y="-1345.16" font-family="Arial" font-size="10.00">Expert 93 Computation</text>
<text text-anchor="middle" x="10896" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 93</text>
<text text-anchor="middle" x="10896" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="10896" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_93 -->
<g id="edge141" class="edge">
<title>route_2&#45;&gt;expert_93</title>
<path fill="none" stroke="black" d="M7516.91,-1429.13C8115.11,-1429.24 10104.55,-1424.5 10763.29,-1357.25"/>
<polygon fill="black" stroke="black" points="10763.78,-1360.72 10773.37,-1356.2 10763.06,-1353.75 10763.78,-1360.72"/>
</g>
<!-- expert_94 -->
<g id="node111" class="node">
<title>expert_94</title>
<polygon fill="lightblue" stroke="black" points="11281.5,-1357.16 11036.5,-1357.16 11036.5,-1305.16 11281.5,-1305.16 11281.5,-1357.16"/>
<text text-anchor="middle" x="11159" y="-1345.16" font-family="Arial" font-size="10.00">Expert 94 Computation</text>
<text text-anchor="middle" x="11159" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 94</text>
<text text-anchor="middle" x="11159" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11159" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_94 -->
<g id="edge142" class="edge">
<title>route_2&#45;&gt;expert_94</title>
<path fill="none" stroke="black" d="M7516.9,-1429.43C8144.65,-1430.69 10313.3,-1429.62 11026.24,-1357.25"/>
<polygon fill="black" stroke="black" points="11026.78,-1360.72 11036.37,-1356.21 11026.06,-1353.75 11026.78,-1360.72"/>
</g>
<!-- expert_95 -->
<g id="node112" class="node">
<title>expert_95</title>
<polygon fill="lightblue" stroke="black" points="11544.5,-1357.16 11299.5,-1357.16 11299.5,-1305.16 11544.5,-1305.16 11544.5,-1357.16"/>
<text text-anchor="middle" x="11422" y="-1345.16" font-family="Arial" font-size="10.00">Expert 95 Computation</text>
<text text-anchor="middle" x="11422" y="-1334.16" font-family="Arial" font-size="10.00">GPU: 95</text>
<text text-anchor="middle" x="11422" y="-1323.16" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="11422" y="-1312.16" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_2&#45;&gt;expert_95 -->
<g id="edge143" class="edge">
<title>route_2&#45;&gt;expert_95</title>
<path fill="none" stroke="black" d="M7516.51,-1427.53C8220.22,-1421.57 10868.5,-1396.79 11289.27,-1357.21"/>
<polygon fill="black" stroke="black" points="11289.76,-1360.68 11299.37,-1356.22 11289.07,-1353.72 11289.76,-1360.68"/>
</g>
<!-- attn_2 -->
<g id="node113" class="node">
<title>attn_2</title>
<polygon fill="lightblue" stroke="black" points="4355.5,-1269.16 4074.5,-1269.16 4074.5,-1217.16 4355.5,-1217.16 4355.5,-1269.16"/>
<text text-anchor="middle" x="4215" y="-1257.16" font-family="Arial" font-size="10.00">Attention (TP+SP)</text>
<text text-anchor="middle" x="4215" y="-1246.16" font-family="Arial" font-size="10.00">GPU: 64&#45;71</text>
<text text-anchor="middle" x="4215" y="-1235.16" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="4215" y="-1224.16" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- expert_64&#45;&gt;attn_2 -->
<g id="edge144" class="edge">
<title>expert_64&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3391.66,-1306.31C3394.46,-1305.91 3397.25,-1305.52 3400,-1305.16 3630.6,-1274.62 3900.09,-1258.18 4064.09,-1250.3"/>
<polygon fill="black" stroke="black" points="4064.43,-1253.79 4074.25,-1249.82 4064.09,-1246.8 4064.43,-1253.79"/>
</g>
<!-- agg_2 -->
<g id="node115" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="4479.24,-1071.62 4058.89,-1071.62 3950.76,-967.62 4371.11,-967.62 4479.24,-1071.62"/>
<text text-anchor="middle" x="4215" y="-1033.62" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4215" y="-1022.62" font-family="Arial" font-size="10.00">GPU: 64&#45;71</text>
<text text-anchor="middle" x="4215" y="-1011.62" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4215" y="-1000.62" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_64&#45;&gt;agg_2 -->
<g id="edge145" class="edge">
<title>expert_64&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3314.19,-1304.99C3398.5,-1259.08 3586.58,-1161.51 3756,-1107.62 3841.23,-1080.51 3938.19,-1060.61 4020.97,-1046.74"/>
<polygon fill="black" stroke="black" points="4021.7,-1050.17 4030.99,-1045.08 4020.56,-1043.26 4021.7,-1050.17"/>
</g>
<!-- expert_65&#45;&gt;attn_2 -->
<g id="edge146" class="edge">
<title>expert_65&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3654.68,-1306.44C3657.47,-1306 3660.25,-1305.57 3663,-1305.16 3798.1,-1284.83 3952.77,-1268.32 4063.94,-1257.62"/>
<polygon fill="black" stroke="black" points="4064.6,-1261.08 4074.23,-1256.64 4063.94,-1254.11 4064.6,-1261.08"/>
</g>
<!-- expert_65&#45;&gt;agg_2 -->
<g id="edge147" class="edge">
<title>expert_65&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3566.62,-1305.01C3630.3,-1259.77 3771.56,-1164.14 3903,-1107.62 3944.87,-1089.61 3991.5,-1074.29 4035.69,-1061.75"/>
<polygon fill="black" stroke="black" points="4036.69,-1065.1 4045.37,-1059.03 4034.8,-1058.36 4036.69,-1065.1"/>
</g>
<!-- expert_66&#45;&gt;attn_2 -->
<g id="edge148" class="edge">
<title>expert_66&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M3917.33,-1305.11C3969.31,-1294.47 4030.02,-1282.03 4083.01,-1271.18"/>
<polygon fill="black" stroke="black" points="4083.71,-1274.61 4092.81,-1269.18 4082.31,-1267.75 4083.71,-1274.61"/>
</g>
<!-- expert_66&#45;&gt;agg_2 -->
<g id="edge149" class="edge">
<title>expert_66&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3810.65,-1304.87C3839.96,-1259.41 3907.42,-1163.44 3987,-1107.62 4005.43,-1094.69 4026.03,-1083.38 4047.11,-1073.57"/>
<polygon fill="black" stroke="black" points="4048.83,-1076.64 4056.49,-1069.32 4045.94,-1070.26 4048.83,-1076.64"/>
</g>
<!-- expert_67&#45;&gt;attn_2 -->
<g id="edge150" class="edge">
<title>expert_67&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4103.83,-1305.05C4121.49,-1295.38 4141.83,-1284.24 4160.24,-1274.15"/>
<polygon fill="black" stroke="black" points="4162.02,-1277.17 4169.11,-1269.29 4158.66,-1271.03 4162.02,-1277.17"/>
</g>
<!-- expert_67&#45;&gt;agg_2 -->
<g id="edge151" class="edge">
<title>expert_67&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4040.6,-1304.87C4012.82,-1261.07 3965.6,-1169.81 4007,-1107.62 4016.61,-1093.18 4029.12,-1081.14 4043.25,-1071.09"/>
<polygon fill="black" stroke="black" points="4045.38,-1073.87 4051.74,-1065.4 4041.48,-1068.06 4045.38,-1073.87"/>
</g>
<!-- expert_68&#45;&gt;attn_2 -->
<g id="edge152" class="edge">
<title>expert_68&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4290.06,-1305.05C4278.83,-1295.95 4266.01,-1285.54 4254.17,-1275.94"/>
<polygon fill="black" stroke="black" points="4256.14,-1273.02 4246.17,-1269.44 4251.73,-1278.46 4256.14,-1273.02"/>
</g>
<!-- expert_68&#45;&gt;agg_2 -->
<g id="edge153" class="edge">
<title>expert_68&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4348.49,-1305.13C4391.91,-1262.5 4467.16,-1173.95 4423,-1107.62 4415.48,-1096.32 4406.19,-1086.49 4395.73,-1077.93"/>
<polygon fill="black" stroke="black" points="4397.59,-1074.95 4387.52,-1071.64 4393.32,-1080.5 4397.59,-1074.95"/>
</g>
<!-- expert_69&#45;&gt;attn_2 -->
<g id="edge154" class="edge">
<title>expert_69&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4476.28,-1305.05C4431.1,-1294.52 4378.44,-1282.25 4332.28,-1271.49"/>
<polygon fill="black" stroke="black" points="4333.07,-1268.08 4322.54,-1269.22 4331.48,-1274.9 4333.07,-1268.08"/>
</g>
<!-- expert_69&#45;&gt;agg_2 -->
<g id="edge155" class="edge">
<title>expert_69&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4573.27,-1304.83C4552.79,-1259.3 4503.95,-1163.22 4435,-1107.62 4420.3,-1095.76 4403.78,-1085.36 4386.57,-1076.27"/>
<polygon fill="black" stroke="black" points="4388.01,-1073.07 4377.52,-1071.63 4384.82,-1079.3 4388.01,-1073.07"/>
</g>
<!-- expert_70&#45;&gt;attn_2 -->
<g id="edge156" class="edge">
<title>expert_70&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4724.44,-1306.66C4721.26,-1306.14 4718.11,-1305.64 4715,-1305.16 4598.15,-1286.98 4465.23,-1270.99 4365.82,-1259.94"/>
<polygon fill="black" stroke="black" points="4366.02,-1256.44 4355.7,-1258.82 4365.25,-1263.4 4366.02,-1256.44"/>
</g>
<!-- expert_70&#45;&gt;agg_2 -->
<g id="edge157" class="edge">
<title>expert_70&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4810.85,-1304.99C4745.83,-1260.57 4603.83,-1167.32 4474,-1107.62 4448.56,-1095.92 4421.07,-1084.99 4393.84,-1075.09"/>
<polygon fill="black" stroke="black" points="4394.82,-1071.73 4384.23,-1071.64 4392.45,-1078.31 4394.82,-1071.73"/>
</g>
<!-- expert_71&#45;&gt;attn_2 -->
<g id="edge158" class="edge">
<title>expert_71&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M4987.46,-1306.49C4984.28,-1306.02 4981.12,-1305.58 4978,-1305.16 4766.48,-1276.75 4520.07,-1259.98 4365.79,-1251.42"/>
<polygon fill="black" stroke="black" points="4365.94,-1247.93 4355.76,-1250.87 4365.55,-1254.92 4365.94,-1247.93"/>
</g>
<!-- expert_71&#45;&gt;agg_2 -->
<g id="edge159" class="edge">
<title>expert_71&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M5053.29,-1305.1C4952.69,-1261.26 4735.78,-1169.42 4547,-1107.62 4511.26,-1095.92 4472.97,-1084.7 4435.55,-1074.44"/>
<polygon fill="black" stroke="black" points="4436.11,-1070.96 4425.54,-1071.71 4434.27,-1077.72 4436.11,-1070.96"/>
</g>
<!-- attn_comm_2 -->
<g id="node114" class="node">
<title>attn_comm_2</title>
<ellipse fill="lightgreen" stroke="black" cx="4215" cy="-1144.39" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="4215" y="-1158.39" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4215" y="-1147.39" font-family="Arial" font-size="10.00">GPU: 64&#45;71</text>
<text text-anchor="middle" x="4215" y="-1136.39" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="4215" y="-1125.39" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- attn_2&#45;&gt;attn_comm_2 -->
<g id="edge160" class="edge">
<title>attn_2&#45;&gt;attn_comm_2</title>
<path fill="none" stroke="black" d="M4215,-1216.98C4215,-1209.18 4215,-1200.31 4215,-1191.54"/>
<polygon fill="black" stroke="black" points="4218.5,-1191.36 4215,-1181.36 4211.5,-1191.36 4218.5,-1191.36"/>
</g>
<!-- attn_comm_2&#45;&gt;agg_2 -->
<g id="edge161" class="edge">
<title>attn_comm_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4215,-1107.55C4215,-1099.51 4215,-1090.76 4215,-1082.01"/>
<polygon fill="black" stroke="black" points="4218.5,-1081.78 4215,-1071.78 4211.5,-1081.78 4218.5,-1081.78"/>
</g>
<!-- pipe_comm_2_3 -->
<g id="node157" class="node">
<title>pipe_comm_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="4215" cy="-894.85" rx="180.12" ry="36.54"/>
<text text-anchor="middle" x="4215" y="-908.85" font-family="Arial" font-size="10.00">Pipeline Communication</text>
<text text-anchor="middle" x="4215" y="-897.85" font-family="Arial" font-size="10.00">GPU: 95&#45;&gt;96</text>
<text text-anchor="middle" x="4215" y="-886.85" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="4215" y="-875.85" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- agg_2&#45;&gt;pipe_comm_2_3 -->
<g id="edge162" class="edge">
<title>agg_2&#45;&gt;pipe_comm_2_3</title>
<path fill="none" stroke="black" d="M4215,-967.26C4215,-958.85 4215,-950.19 4215,-941.92"/>
<polygon fill="black" stroke="black" points="4218.5,-941.7 4215,-931.7 4211.5,-941.7 4218.5,-941.7"/>
</g>
<!-- embed_3 -->
<g id="node116" class="node">
<title>embed_3</title>
<polygon fill="lightblue" stroke="black" points="4342.5,-804.08 4087.5,-804.08 4087.5,-752.08 4342.5,-752.08 4342.5,-804.08"/>
<text text-anchor="middle" x="4215" y="-792.08" font-family="Arial" font-size="10.00">Token Embedding</text>
<text text-anchor="middle" x="4215" y="-781.08" font-family="Arial" font-size="10.00">GPU: 96&#45;103</text>
<text text-anchor="middle" x="4215" y="-770.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="4215" y="-759.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- gate_3 -->
<g id="node117" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="4472.23,-716.08 4063.03,-716.08 3957.77,-612.08 4366.97,-612.08 4472.23,-716.08"/>
<text text-anchor="middle" x="4215" y="-678.08" font-family="Arial" font-size="10.00">Gate Selection</text>
<text text-anchor="middle" x="4215" y="-667.08" font-family="Arial" font-size="10.00">GPU: 96&#45;103</text>
<text text-anchor="middle" x="4215" y="-656.08" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="4215" y="-645.08" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=32]</text>
</g>
<!-- embed_3&#45;&gt;gate_3 -->
<g id="edge164" class="edge">
<title>embed_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M4215,-751.94C4215,-744.26 4215,-735.45 4215,-726.45"/>
<polygon fill="black" stroke="black" points="4218.5,-726.26 4215,-716.26 4211.5,-726.26 4218.5,-726.26"/>
</g>
<!-- route_3 -->
<g id="node118" class="node">
<title>route_3</title>
<ellipse fill="lightgreen" stroke="black" cx="4215" cy="-539.31" rx="171.65" ry="36.54"/>
<text text-anchor="middle" x="4215" y="-553.31" font-family="Arial" font-size="10.00">Expert Routing</text>
<text text-anchor="middle" x="4215" y="-542.31" font-family="Arial" font-size="10.00">GPU: 96&#45;127</text>
<text text-anchor="middle" x="4215" y="-531.31" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, experts=32]</text>
<text text-anchor="middle" x="4215" y="-520.31" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, experts=1]</text>
</g>
<!-- gate_3&#45;&gt;route_3 -->
<g id="edge165" class="edge">
<title>gate_3&#45;&gt;route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4215,-611.72C4215,-603.32 4215,-594.65 4215,-586.38"/>
<polygon fill="black" stroke="black" points="4218.5,-586.16 4215,-576.16 4211.5,-586.16 4218.5,-586.16"/>
</g>
<!-- expert_96 -->
<g id="node119" class="node">
<title>expert_96</title>
<polygon fill="lightblue" stroke="black" points="261.5,-466.54 16.5,-466.54 16.5,-414.54 261.5,-414.54 261.5,-466.54"/>
<text text-anchor="middle" x="139" y="-454.54" font-family="Arial" font-size="10.00">Expert 96 Computation</text>
<text text-anchor="middle" x="139" y="-443.54" font-family="Arial" font-size="10.00">GPU: 96</text>
<text text-anchor="middle" x="139" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="139" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_96 -->
<g id="edge166" class="edge">
<title>route_3&#45;&gt;expert_96</title>
<path fill="none" stroke="black" d="M4043.54,-536.91C3340,-530.95 692.4,-506.17 271.72,-466.59"/>
<polygon fill="black" stroke="black" points="271.93,-463.1 261.63,-465.6 271.24,-470.06 271.93,-463.1"/>
</g>
<!-- expert_97 -->
<g id="node120" class="node">
<title>expert_97</title>
<polygon fill="lightblue" stroke="black" points="524.5,-466.54 279.5,-466.54 279.5,-414.54 524.5,-414.54 524.5,-466.54"/>
<text text-anchor="middle" x="402" y="-454.54" font-family="Arial" font-size="10.00">Expert 97 Computation</text>
<text text-anchor="middle" x="402" y="-443.54" font-family="Arial" font-size="10.00">GPU: 97</text>
<text text-anchor="middle" x="402" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="402" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_97 -->
<g id="edge167" class="edge">
<title>route_3&#45;&gt;expert_97</title>
<path fill="none" stroke="black" d="M4043.15,-538.81C3415.57,-540.06 1247.51,-538.98 534.76,-466.64"/>
<polygon fill="black" stroke="black" points="534.94,-463.14 524.63,-465.59 534.22,-470.1 534.94,-463.14"/>
</g>
<!-- expert_98 -->
<g id="node121" class="node">
<title>expert_98</title>
<polygon fill="lightblue" stroke="black" points="787.5,-466.54 542.5,-466.54 542.5,-414.54 787.5,-414.54 787.5,-466.54"/>
<text text-anchor="middle" x="665" y="-454.54" font-family="Arial" font-size="10.00">Expert 98 Computation</text>
<text text-anchor="middle" x="665" y="-443.54" font-family="Arial" font-size="10.00">GPU: 98</text>
<text text-anchor="middle" x="665" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="665" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_98 -->
<g id="edge168" class="edge">
<title>route_3&#45;&gt;expert_98</title>
<path fill="none" stroke="black" d="M4043.14,-538.51C3445.11,-538.62 1456.25,-533.86 797.71,-466.63"/>
<polygon fill="black" stroke="black" points="797.94,-463.14 787.63,-465.59 797.22,-470.1 797.94,-463.14"/>
</g>
<!-- expert_99 -->
<g id="node122" class="node">
<title>expert_99</title>
<polygon fill="lightblue" stroke="black" points="1050.5,-466.54 805.5,-466.54 805.5,-414.54 1050.5,-414.54 1050.5,-466.54"/>
<text text-anchor="middle" x="928" y="-454.54" font-family="Arial" font-size="10.00">Expert 99 Computation</text>
<text text-anchor="middle" x="928" y="-443.54" font-family="Arial" font-size="10.00">GPU: 99</text>
<text text-anchor="middle" x="928" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="928" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_99 -->
<g id="edge169" class="edge">
<title>route_3&#45;&gt;expert_99</title>
<path fill="none" stroke="black" d="M4043.16,-538.16C3475.91,-537.07 1665.37,-528.77 1060.76,-466.64"/>
<polygon fill="black" stroke="black" points="1060.94,-463.14 1050.63,-465.58 1060.22,-470.1 1060.94,-463.14"/>
</g>
<!-- expert_100 -->
<g id="node123" class="node">
<title>expert_100</title>
<polygon fill="lightblue" stroke="black" points="1313.5,-466.54 1068.5,-466.54 1068.5,-414.54 1313.5,-414.54 1313.5,-466.54"/>
<text text-anchor="middle" x="1191" y="-454.54" font-family="Arial" font-size="10.00">Expert 100 Computation</text>
<text text-anchor="middle" x="1191" y="-443.54" font-family="Arial" font-size="10.00">GPU: 100</text>
<text text-anchor="middle" x="1191" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="1191" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_100 -->
<g id="edge170" class="edge">
<title>route_3&#45;&gt;expert_100</title>
<path fill="none" stroke="black" d="M4043.06,-537.74C3507.74,-535.39 1874.29,-523.68 1323.66,-466.63"/>
<polygon fill="black" stroke="black" points="1323.95,-463.14 1313.63,-465.57 1323.21,-470.1 1323.95,-463.14"/>
</g>
<!-- expert_101 -->
<g id="node124" class="node">
<title>expert_101</title>
<polygon fill="lightblue" stroke="black" points="1576.5,-466.54 1331.5,-466.54 1331.5,-414.54 1576.5,-414.54 1576.5,-466.54"/>
<text text-anchor="middle" x="1454" y="-454.54" font-family="Arial" font-size="10.00">Expert 101 Computation</text>
<text text-anchor="middle" x="1454" y="-443.54" font-family="Arial" font-size="10.00">GPU: 101</text>
<text text-anchor="middle" x="1454" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="1454" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_101 -->
<g id="edge171" class="edge">
<title>route_3&#45;&gt;expert_101</title>
<path fill="none" stroke="black" d="M4043.29,-537.24C3541.79,-533.55 2083.92,-518.62 1586.76,-466.64"/>
<polygon fill="black" stroke="black" points="1586.95,-463.14 1576.64,-465.56 1586.21,-470.1 1586.95,-463.14"/>
</g>
<!-- expert_102 -->
<g id="node125" class="node">
<title>expert_102</title>
<polygon fill="lightblue" stroke="black" points="1839.5,-466.54 1594.5,-466.54 1594.5,-414.54 1839.5,-414.54 1839.5,-466.54"/>
<text text-anchor="middle" x="1717" y="-454.54" font-family="Arial" font-size="10.00">Expert 102 Computation</text>
<text text-anchor="middle" x="1717" y="-443.54" font-family="Arial" font-size="10.00">GPU: 102</text>
<text text-anchor="middle" x="1717" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="1717" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_102 -->
<g id="edge172" class="edge">
<title>route_3&#45;&gt;expert_102</title>
<path fill="none" stroke="black" d="M4043.51,-536.63C3577.42,-531.52 2293.29,-513.58 1849.64,-466.63"/>
<polygon fill="black" stroke="black" points="1849.95,-463.15 1839.64,-465.55 1849.2,-470.11 1849.95,-463.15"/>
</g>
<!-- expert_103 -->
<g id="node126" class="node">
<title>expert_103</title>
<polygon fill="lightblue" stroke="black" points="2102.5,-466.54 1857.5,-466.54 1857.5,-414.54 2102.5,-414.54 2102.5,-466.54"/>
<text text-anchor="middle" x="1980" y="-454.54" font-family="Arial" font-size="10.00">Expert 103 Computation</text>
<text text-anchor="middle" x="1980" y="-443.54" font-family="Arial" font-size="10.00">GPU: 103</text>
<text text-anchor="middle" x="1980" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="1980" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_103 -->
<g id="edge173" class="edge">
<title>route_3&#45;&gt;expert_103</title>
<path fill="none" stroke="black" d="M4043.67,-535.88C3615.08,-529.26 2503.53,-508.58 2112.86,-466.66"/>
<polygon fill="black" stroke="black" points="2112.96,-463.15 2102.64,-465.54 2112.2,-470.11 2112.96,-463.15"/>
</g>
<!-- expert_104 -->
<g id="node127" class="node">
<title>expert_104</title>
<polygon fill="lightblue" stroke="black" points="2365.5,-466.54 2120.5,-466.54 2120.5,-414.54 2365.5,-414.54 2365.5,-466.54"/>
<text text-anchor="middle" x="2243" y="-454.54" font-family="Arial" font-size="10.00">Expert 104 Computation</text>
<text text-anchor="middle" x="2243" y="-443.54" font-family="Arial" font-size="10.00">GPU: 104</text>
<text text-anchor="middle" x="2243" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="2243" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_104 -->
<g id="edge174" class="edge">
<title>route_3&#45;&gt;expert_104</title>
<path fill="none" stroke="black" d="M4044.11,-534.92C3655.42,-526.68 2713.38,-503.6 2375.7,-466.65"/>
<polygon fill="black" stroke="black" points="2375.97,-463.15 2365.64,-465.52 2375.19,-470.11 2375.97,-463.15"/>
</g>
<!-- expert_105 -->
<g id="node128" class="node">
<title>expert_105</title>
<polygon fill="lightblue" stroke="black" points="2628.5,-466.54 2383.5,-466.54 2383.5,-414.54 2628.5,-414.54 2628.5,-466.54"/>
<text text-anchor="middle" x="2506" y="-454.54" font-family="Arial" font-size="10.00">Expert 105 Computation</text>
<text text-anchor="middle" x="2506" y="-443.54" font-family="Arial" font-size="10.00">GPU: 105</text>
<text text-anchor="middle" x="2506" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="2506" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_105 -->
<g id="edge175" class="edge">
<title>route_3&#45;&gt;expert_105</title>
<path fill="none" stroke="black" d="M4043.01,-538.52C3754.25,-537.1 3153.8,-526.49 2638.88,-466.69"/>
<polygon fill="black" stroke="black" points="2638.98,-463.18 2628.64,-465.5 2638.17,-470.13 2638.98,-463.18"/>
</g>
<!-- expert_106 -->
<g id="node129" class="node">
<title>expert_106</title>
<polygon fill="lightblue" stroke="black" points="2891.5,-466.54 2646.5,-466.54 2646.5,-414.54 2891.5,-414.54 2891.5,-466.54"/>
<text text-anchor="middle" x="2769" y="-454.54" font-family="Arial" font-size="10.00">Expert 106 Computation</text>
<text text-anchor="middle" x="2769" y="-443.54" font-family="Arial" font-size="10.00">GPU: 106</text>
<text text-anchor="middle" x="2769" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="2769" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_106 -->
<g id="edge176" class="edge">
<title>route_3&#45;&gt;expert_106</title>
<path fill="none" stroke="black" d="M4043.61,-536.27C3794.03,-531.67 3316.01,-516.65 2901.73,-466.69"/>
<polygon fill="black" stroke="black" points="2902,-463.19 2891.65,-465.46 2901.15,-470.14 2902,-463.19"/>
</g>
<!-- expert_107 -->
<g id="node130" class="node">
<title>expert_107</title>
<polygon fill="lightblue" stroke="black" points="3154.5,-466.54 2909.5,-466.54 2909.5,-414.54 3154.5,-414.54 3154.5,-466.54"/>
<text text-anchor="middle" x="3032" y="-454.54" font-family="Arial" font-size="10.00">Expert 107 Computation</text>
<text text-anchor="middle" x="3032" y="-443.54" font-family="Arial" font-size="10.00">GPU: 107</text>
<text text-anchor="middle" x="3032" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3032" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_107 -->
<g id="edge177" class="edge">
<title>route_3&#45;&gt;expert_107</title>
<path fill="none" stroke="black" d="M4045.39,-533.03C3839.19,-525.17 3480.59,-506.92 3164.92,-466.73"/>
<polygon fill="black" stroke="black" points="3165.02,-463.21 3154.65,-465.41 3164.13,-470.15 3165.02,-463.21"/>
</g>
<!-- expert_108 -->
<g id="node131" class="node">
<title>expert_108</title>
<polygon fill="lightblue" stroke="black" points="3417.5,-466.54 3172.5,-466.54 3172.5,-414.54 3417.5,-414.54 3417.5,-466.54"/>
<text text-anchor="middle" x="3295" y="-454.54" font-family="Arial" font-size="10.00">Expert 108 Computation</text>
<text text-anchor="middle" x="3295" y="-443.54" font-family="Arial" font-size="10.00">GPU: 108</text>
<text text-anchor="middle" x="3295" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3295" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_108 -->
<g id="edge178" class="edge">
<title>route_3&#45;&gt;expert_108</title>
<path fill="none" stroke="black" d="M4051.26,-528.11C3893.73,-517.2 3648.76,-497.4 3427.83,-466.75"/>
<polygon fill="black" stroke="black" points="3428.05,-463.24 3417.67,-465.33 3427.08,-470.18 3428.05,-463.24"/>
</g>
<!-- expert_109 -->
<g id="node132" class="node">
<title>expert_109</title>
<polygon fill="lightblue" stroke="black" points="3680.5,-466.54 3435.5,-466.54 3435.5,-414.54 3680.5,-414.54 3680.5,-466.54"/>
<text text-anchor="middle" x="3558" y="-454.54" font-family="Arial" font-size="10.00">Expert 109 Computation</text>
<text text-anchor="middle" x="3558" y="-443.54" font-family="Arial" font-size="10.00">GPU: 109</text>
<text text-anchor="middle" x="3558" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3558" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_109 -->
<g id="edge179" class="edge">
<title>route_3&#45;&gt;expert_109</title>
<path fill="none" stroke="black" d="M4067.6,-520.32C3964.55,-507.24 3823.54,-488.33 3690.65,-466.78"/>
<polygon fill="black" stroke="black" points="3691.12,-463.31 3680.69,-465.16 3690,-470.22 3691.12,-463.31"/>
</g>
<!-- expert_110 -->
<g id="node133" class="node">
<title>expert_110</title>
<polygon fill="lightblue" stroke="black" points="3943.5,-466.54 3698.5,-466.54 3698.5,-414.54 3943.5,-414.54 3943.5,-466.54"/>
<text text-anchor="middle" x="3821" y="-454.54" font-family="Arial" font-size="10.00">Expert 110 Computation</text>
<text text-anchor="middle" x="3821" y="-443.54" font-family="Arial" font-size="10.00">GPU: 110</text>
<text text-anchor="middle" x="3821" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="3821" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_110 -->
<g id="edge180" class="edge">
<title>route_3&#45;&gt;expert_110</title>
<path fill="none" stroke="black" d="M4104.2,-511.1C4050.63,-497.94 3986.47,-482.18 3932.78,-468.99"/>
<polygon fill="black" stroke="black" points="3933.42,-465.55 3922.88,-466.56 3931.75,-472.35 3933.42,-465.55"/>
</g>
<!-- expert_111 -->
<g id="node134" class="node">
<title>expert_111</title>
<polygon fill="lightblue" stroke="black" points="4206.5,-466.54 3961.5,-466.54 3961.5,-414.54 4206.5,-414.54 4206.5,-466.54"/>
<text text-anchor="middle" x="4084" y="-454.54" font-family="Arial" font-size="10.00">Expert 111 Computation</text>
<text text-anchor="middle" x="4084" y="-443.54" font-family="Arial" font-size="10.00">GPU: 111</text>
<text text-anchor="middle" x="4084" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4084" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_111 -->
<g id="edge181" class="edge">
<title>route_3&#45;&gt;expert_111</title>
<path fill="none" stroke="black" d="M4168.08,-503.65C4154.34,-493.5 4139.41,-482.47 4125.99,-472.56"/>
<polygon fill="black" stroke="black" points="4127.99,-469.68 4117.86,-466.55 4123.83,-475.31 4127.99,-469.68"/>
</g>
<!-- expert_112 -->
<g id="node135" class="node">
<title>expert_112</title>
<polygon fill="lightblue" stroke="black" points="4469.5,-466.54 4224.5,-466.54 4224.5,-414.54 4469.5,-414.54 4469.5,-466.54"/>
<text text-anchor="middle" x="4347" y="-454.54" font-family="Arial" font-size="10.00">Expert 112 Computation</text>
<text text-anchor="middle" x="4347" y="-443.54" font-family="Arial" font-size="10.00">GPU: 112</text>
<text text-anchor="middle" x="4347" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4347" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_112 -->
<g id="edge182" class="edge">
<title>route_3&#45;&gt;expert_112</title>
<path fill="none" stroke="black" d="M4261.91,-503.92C4275.78,-493.75 4290.88,-482.68 4304.46,-472.73"/>
<polygon fill="black" stroke="black" points="4306.69,-475.43 4312.69,-466.69 4302.55,-469.78 4306.69,-475.43"/>
</g>
<!-- expert_113 -->
<g id="node136" class="node">
<title>expert_113</title>
<polygon fill="lightblue" stroke="black" points="4732.5,-466.54 4487.5,-466.54 4487.5,-414.54 4732.5,-414.54 4732.5,-466.54"/>
<text text-anchor="middle" x="4610" y="-454.54" font-family="Arial" font-size="10.00">Expert 113 Computation</text>
<text text-anchor="middle" x="4610" y="-443.54" font-family="Arial" font-size="10.00">GPU: 113</text>
<text text-anchor="middle" x="4610" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4610" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_113 -->
<g id="edge183" class="edge">
<title>route_3&#45;&gt;expert_113</title>
<path fill="none" stroke="black" d="M4325.82,-511.16C4379.53,-498 4443.91,-482.23 4497.8,-469.03"/>
<polygon fill="black" stroke="black" points="4498.85,-472.37 4507.73,-466.59 4497.19,-465.57 4498.85,-472.37"/>
</g>
<!-- expert_114 -->
<g id="node137" class="node">
<title>expert_114</title>
<polygon fill="lightblue" stroke="black" points="4995.5,-466.54 4750.5,-466.54 4750.5,-414.54 4995.5,-414.54 4995.5,-466.54"/>
<text text-anchor="middle" x="4873" y="-454.54" font-family="Arial" font-size="10.00">Expert 114 Computation</text>
<text text-anchor="middle" x="4873" y="-443.54" font-family="Arial" font-size="10.00">GPU: 114</text>
<text text-anchor="middle" x="4873" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="4873" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_114 -->
<g id="edge184" class="edge">
<title>route_3&#45;&gt;expert_114</title>
<path fill="none" stroke="black" d="M4362.11,-520.3C4465.17,-507.19 4606.33,-488.26 4740.38,-466.61"/>
<polygon fill="black" stroke="black" points="4741.12,-470.03 4750.43,-464.98 4740,-463.12 4741.12,-470.03"/>
</g>
<!-- expert_115 -->
<g id="node138" class="node">
<title>expert_115</title>
<polygon fill="lightblue" stroke="black" points="5258.5,-466.54 5013.5,-466.54 5013.5,-414.54 5258.5,-414.54 5258.5,-466.54"/>
<text text-anchor="middle" x="5136" y="-454.54" font-family="Arial" font-size="10.00">Expert 115 Computation</text>
<text text-anchor="middle" x="5136" y="-443.54" font-family="Arial" font-size="10.00">GPU: 115</text>
<text text-anchor="middle" x="5136" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5136" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_115 -->
<g id="edge185" class="edge">
<title>route_3&#45;&gt;expert_115</title>
<path fill="none" stroke="black" d="M4378.73,-528.04C4536.25,-517.09 4781.22,-497.25 5003.24,-466.59"/>
<polygon fill="black" stroke="black" points="5004.03,-470.01 5013.46,-465.16 5003.07,-463.08 5004.03,-470.01"/>
</g>
<!-- expert_116 -->
<g id="node139" class="node">
<title>expert_116</title>
<polygon fill="lightblue" stroke="black" points="5521.5,-466.54 5276.5,-466.54 5276.5,-414.54 5521.5,-414.54 5521.5,-466.54"/>
<text text-anchor="middle" x="5399" y="-454.54" font-family="Arial" font-size="10.00">Expert 116 Computation</text>
<text text-anchor="middle" x="5399" y="-443.54" font-family="Arial" font-size="10.00">GPU: 116</text>
<text text-anchor="middle" x="5399" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5399" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_116 -->
<g id="edge186" class="edge">
<title>route_3&#45;&gt;expert_116</title>
<path fill="none" stroke="black" d="M4384.6,-532.95C4590.79,-525.03 4949.38,-506.7 5266.17,-466.57"/>
<polygon fill="black" stroke="black" points="5266.99,-470 5276.47,-465.26 5266.11,-463.05 5266.99,-470"/>
</g>
<!-- expert_117 -->
<g id="node140" class="node">
<title>expert_117</title>
<polygon fill="lightblue" stroke="black" points="5784.5,-466.54 5539.5,-466.54 5539.5,-414.54 5784.5,-414.54 5784.5,-466.54"/>
<text text-anchor="middle" x="5662" y="-454.54" font-family="Arial" font-size="10.00">Expert 117 Computation</text>
<text text-anchor="middle" x="5662" y="-443.54" font-family="Arial" font-size="10.00">GPU: 117</text>
<text text-anchor="middle" x="5662" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5662" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_117 -->
<g id="edge187" class="edge">
<title>route_3&#45;&gt;expert_117</title>
<path fill="none" stroke="black" d="M4386.38,-536.2C4635.95,-531.5 5113.96,-516.37 5529.37,-466.54"/>
<polygon fill="black" stroke="black" points="5529.97,-469.99 5539.48,-465.32 5529.13,-463.04 5529.97,-469.99"/>
</g>
<!-- expert_118 -->
<g id="node141" class="node">
<title>expert_118</title>
<polygon fill="lightblue" stroke="black" points="6047.5,-466.54 5802.5,-466.54 5802.5,-414.54 6047.5,-414.54 6047.5,-466.54"/>
<text text-anchor="middle" x="5925" y="-454.54" font-family="Arial" font-size="10.00">Expert 118 Computation</text>
<text text-anchor="middle" x="5925" y="-443.54" font-family="Arial" font-size="10.00">GPU: 118</text>
<text text-anchor="middle" x="5925" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="5925" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_118 -->
<g id="edge188" class="edge">
<title>route_3&#45;&gt;expert_118</title>
<path fill="none" stroke="black" d="M4386.98,-538.44C4675.72,-536.9 5276.16,-526.14 5792.22,-466.55"/>
<polygon fill="black" stroke="black" points="5792.95,-469.99 5802.48,-465.35 5792.14,-463.03 5792.95,-469.99"/>
</g>
<!-- expert_119 -->
<g id="node142" class="node">
<title>expert_119</title>
<polygon fill="lightblue" stroke="black" points="6310.5,-466.54 6065.5,-466.54 6065.5,-414.54 6310.5,-414.54 6310.5,-466.54"/>
<text text-anchor="middle" x="6188" y="-454.54" font-family="Arial" font-size="10.00">Expert 119 Computation</text>
<text text-anchor="middle" x="6188" y="-443.54" font-family="Arial" font-size="10.00">GPU: 119</text>
<text text-anchor="middle" x="6188" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6188" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_119 -->
<g id="edge189" class="edge">
<title>route_3&#45;&gt;expert_119</title>
<path fill="none" stroke="black" d="M4385.89,-534.89C4774.57,-526.58 5716.59,-503.38 6055.39,-466.5"/>
<polygon fill="black" stroke="black" points="6055.93,-469.97 6065.48,-465.38 6055.16,-463.01 6055.93,-469.97"/>
</g>
<!-- expert_120 -->
<g id="node143" class="node">
<title>expert_120</title>
<polygon fill="lightblue" stroke="black" points="6573.5,-466.54 6328.5,-466.54 6328.5,-414.54 6573.5,-414.54 6573.5,-466.54"/>
<text text-anchor="middle" x="6451" y="-454.54" font-family="Arial" font-size="10.00">Expert 120 Computation</text>
<text text-anchor="middle" x="6451" y="-443.54" font-family="Arial" font-size="10.00">GPU: 120</text>
<text text-anchor="middle" x="6451" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6451" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_120 -->
<g id="edge190" class="edge">
<title>route_3&#45;&gt;expert_120</title>
<path fill="none" stroke="black" d="M4386.33,-535.85C4815.02,-529.15 5926.99,-508.31 6318.52,-466.49"/>
<polygon fill="black" stroke="black" points="6318.93,-469.97 6328.49,-465.4 6318.17,-463.01 6318.93,-469.97"/>
</g>
<!-- expert_121 -->
<g id="node144" class="node">
<title>expert_121</title>
<polygon fill="lightblue" stroke="black" points="6836.5,-466.54 6591.5,-466.54 6591.5,-414.54 6836.5,-414.54 6836.5,-466.54"/>
<text text-anchor="middle" x="6714" y="-454.54" font-family="Arial" font-size="10.00">Expert 121 Computation</text>
<text text-anchor="middle" x="6714" y="-443.54" font-family="Arial" font-size="10.00">GPU: 121</text>
<text text-anchor="middle" x="6714" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6714" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_121 -->
<g id="edge191" class="edge">
<title>route_3&#45;&gt;expert_121</title>
<path fill="none" stroke="black" d="M4386.49,-536.6C4852.56,-531.41 6136.68,-513.29 6581.46,-466.49"/>
<polygon fill="black" stroke="black" points="6581.92,-469.96 6591.49,-465.42 6581.17,-463 6581.92,-469.96"/>
</g>
<!-- expert_122 -->
<g id="node145" class="node">
<title>expert_122</title>
<polygon fill="lightblue" stroke="black" points="7099.5,-466.54 6854.5,-466.54 6854.5,-414.54 7099.5,-414.54 7099.5,-466.54"/>
<text text-anchor="middle" x="6977" y="-454.54" font-family="Arial" font-size="10.00">Expert 122 Computation</text>
<text text-anchor="middle" x="6977" y="-443.54" font-family="Arial" font-size="10.00">GPU: 122</text>
<text text-anchor="middle" x="6977" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="6977" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_122 -->
<g id="edge192" class="edge">
<title>route_3&#45;&gt;expert_122</title>
<path fill="none" stroke="black" d="M4386.71,-537.21C4888.2,-533.43 6346.05,-518.29 6844.34,-466.51"/>
<polygon fill="black" stroke="black" points="6844.91,-469.96 6854.49,-465.43 6844.18,-463 6844.91,-469.96"/>
</g>
<!-- expert_123 -->
<g id="node146" class="node">
<title>expert_123</title>
<polygon fill="lightblue" stroke="black" points="7362.5,-466.54 7117.5,-466.54 7117.5,-414.54 7362.5,-414.54 7362.5,-466.54"/>
<text text-anchor="middle" x="7240" y="-454.54" font-family="Arial" font-size="10.00">Expert 123 Computation</text>
<text text-anchor="middle" x="7240" y="-443.54" font-family="Arial" font-size="10.00">GPU: 123</text>
<text text-anchor="middle" x="7240" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7240" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_123 -->
<g id="edge193" class="edge">
<title>route_3&#45;&gt;expert_123</title>
<path fill="none" stroke="black" d="M4386.94,-537.71C4922.25,-535.26 6555.68,-523.31 7107.45,-466.49"/>
<polygon fill="black" stroke="black" points="7107.91,-469.96 7117.49,-465.44 7107.18,-463 7107.91,-469.96"/>
</g>
<!-- expert_124 -->
<g id="node147" class="node">
<title>expert_124</title>
<polygon fill="lightblue" stroke="black" points="7625.5,-466.54 7380.5,-466.54 7380.5,-414.54 7625.5,-414.54 7625.5,-466.54"/>
<text text-anchor="middle" x="7503" y="-454.54" font-family="Arial" font-size="10.00">Expert 124 Computation</text>
<text text-anchor="middle" x="7503" y="-443.54" font-family="Arial" font-size="10.00">GPU: 124</text>
<text text-anchor="middle" x="7503" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7503" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_124 -->
<g id="edge194" class="edge">
<title>route_3&#45;&gt;expert_124</title>
<path fill="none" stroke="black" d="M4386.84,-538.13C4954.07,-536.94 6764.59,-528.36 7370.35,-466.5"/>
<polygon fill="black" stroke="black" points="7370.91,-469.96 7380.49,-465.45 7370.18,-463 7370.91,-469.96"/>
</g>
<!-- expert_125 -->
<g id="node148" class="node">
<title>expert_125</title>
<polygon fill="lightblue" stroke="black" points="7888.5,-466.54 7643.5,-466.54 7643.5,-414.54 7888.5,-414.54 7888.5,-466.54"/>
<text text-anchor="middle" x="7766" y="-454.54" font-family="Arial" font-size="10.00">Expert 125 Computation</text>
<text text-anchor="middle" x="7766" y="-443.54" font-family="Arial" font-size="10.00">GPU: 125</text>
<text text-anchor="middle" x="7766" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="7766" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_125 -->
<g id="edge195" class="edge">
<title>route_3&#45;&gt;expert_125</title>
<path fill="none" stroke="black" d="M4386.86,-538.48C4984.88,-538.48 6973.7,-533.42 7633.4,-466.5"/>
<polygon fill="black" stroke="black" points="7633.9,-469.96 7643.49,-465.46 7633.19,-463 7633.9,-469.96"/>
</g>
<!-- expert_126 -->
<g id="node149" class="node">
<title>expert_126</title>
<polygon fill="lightblue" stroke="black" points="8151.5,-466.54 7906.5,-466.54 7906.5,-414.54 8151.5,-414.54 8151.5,-466.54"/>
<text text-anchor="middle" x="8029" y="-454.54" font-family="Arial" font-size="10.00">Expert 126 Computation</text>
<text text-anchor="middle" x="8029" y="-443.54" font-family="Arial" font-size="10.00">GPU: 126</text>
<text text-anchor="middle" x="8029" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8029" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_126 -->
<g id="edge196" class="edge">
<title>route_3&#45;&gt;expert_126</title>
<path fill="none" stroke="black" d="M4386.85,-538.78C5014.42,-539.92 7182.44,-538.5 7896.35,-466.5"/>
<polygon fill="black" stroke="black" points="7896.9,-469.96 7906.49,-465.46 7896.19,-463 7896.9,-469.96"/>
</g>
<!-- expert_127 -->
<g id="node150" class="node">
<title>expert_127</title>
<polygon fill="lightblue" stroke="black" points="8414.5,-466.54 8169.5,-466.54 8169.5,-414.54 8414.5,-414.54 8414.5,-466.54"/>
<text text-anchor="middle" x="8292" y="-454.54" font-family="Arial" font-size="10.00">Expert 127 Computation</text>
<text text-anchor="middle" x="8292" y="-443.54" font-family="Arial" font-size="10.00">GPU: 127</text>
<text text-anchor="middle" x="8292" y="-432.54" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="8292" y="-421.54" font-family="Arial" font-size="10.00">Output: [batch_size=16, seq_len=2048, hidden=512]</text>
</g>
<!-- route_3&#45;&gt;expert_127 -->
<g id="edge197" class="edge">
<title>route_3&#45;&gt;expert_127</title>
<path fill="none" stroke="black" d="M4386.46,-536.9C5089.99,-530.88 7737.58,-505.91 8159.37,-466.46"/>
<polygon fill="black" stroke="black" points="8159.88,-469.93 8169.49,-465.47 8159.2,-462.96 8159.88,-469.93"/>
</g>
<!-- attn_3 -->
<g id="node151" class="node">
<title>attn_3</title>
<polygon fill="lightblue" stroke="black" points="1174.5,-378.54 893.5,-378.54 893.5,-326.54 1174.5,-326.54 1174.5,-378.54"/>
<text text-anchor="middle" x="1034" y="-366.54" font-family="Arial" font-size="10.00">Attention (TP+SP)</text>
<text text-anchor="middle" x="1034" y="-355.54" font-family="Arial" font-size="10.00">GPU: 96&#45;103</text>
<text text-anchor="middle" x="1034" y="-344.54" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
<text text-anchor="middle" x="1034" y="-333.54" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- expert_96&#45;&gt;attn_3 -->
<g id="edge198" class="edge">
<title>expert_96&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M261.66,-415.71C264.46,-415.3 267.25,-414.91 270,-414.54 481.94,-385.94 728.89,-369.21 883.36,-360.71"/>
<polygon fill="black" stroke="black" points="883.61,-364.21 893.4,-360.17 883.22,-357.22 883.61,-364.21"/>
</g>
<!-- agg_3 -->
<g id="node153" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="1298.24,-181 877.89,-181 769.76,-77 1190.11,-77 1298.24,-181"/>
<text text-anchor="middle" x="1034" y="-143" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1034" y="-132" font-family="Arial" font-size="10.00">GPU: 96&#45;103</text>
<text text-anchor="middle" x="1034" y="-121" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=2048, hidden=512]</text>
<text text-anchor="middle" x="1034" y="-110" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, hidden=4096]</text>
</g>
<!-- expert_96&#45;&gt;agg_3 -->
<g id="edge199" class="edge">
<title>expert_96&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M182.15,-414.47C262.66,-368.72 442.39,-271.39 605,-217 681.04,-191.56 767.28,-172.32 842.39,-158.48"/>
<polygon fill="black" stroke="black" points="843.22,-161.88 852.43,-156.64 841.97,-154.99 843.22,-161.88"/>
</g>
<!-- expert_97&#45;&gt;attn_3 -->
<g id="edge200" class="edge">
<title>expert_97&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M524.68,-415.87C527.48,-415.41 530.25,-414.97 533,-414.54 650.18,-396.25 783.5,-380.24 883.14,-369.23"/>
<polygon fill="black" stroke="black" points="883.72,-372.68 893.28,-368.11 882.96,-365.72 883.72,-372.68"/>
</g>
<!-- expert_97&#45;&gt;agg_3 -->
<g id="edge201" class="edge">
<title>expert_97&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M433.22,-414.37C490.72,-369.09 618.62,-273.4 740,-217 776.6,-199.99 817.31,-185.43 856.49,-173.35"/>
<polygon fill="black" stroke="black" points="857.86,-176.59 866.41,-170.33 855.83,-169.89 857.86,-176.59"/>
</g>
<!-- expert_98&#45;&gt;attn_3 -->
<g id="edge202" class="edge">
<title>expert_98&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M772.72,-414.43C817.9,-403.9 870.56,-391.63 916.72,-380.87"/>
<polygon fill="black" stroke="black" points="917.52,-384.28 926.46,-378.6 915.93,-377.46 917.52,-384.28"/>
</g>
<!-- expert_98&#45;&gt;agg_3 -->
<g id="edge203" class="edge">
<title>expert_98&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M674.95,-414.51C694.21,-369.04 740.81,-272.45 809,-217 825.77,-203.37 844.91,-191.69 864.8,-181.75"/>
<polygon fill="black" stroke="black" points="866.51,-184.81 873.99,-177.3 863.46,-178.51 866.51,-184.81"/>
</g>
<!-- expert_99&#45;&gt;attn_3 -->
<g id="edge204" class="edge">
<title>expert_99&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M958.94,-414.43C970.17,-405.33 982.99,-394.92 994.83,-385.32"/>
<polygon fill="black" stroke="black" points="997.27,-387.84 1002.83,-378.83 992.86,-382.41 997.27,-387.84"/>
</g>
<!-- expert_99&#45;&gt;agg_3 -->
<g id="edge205" class="edge">
<title>expert_99&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M900.51,-414.51C857.09,-371.88 781.84,-283.33 826,-217 835.61,-202.56 848.12,-190.52 862.25,-180.47"/>
<polygon fill="black" stroke="black" points="864.38,-183.25 870.74,-174.78 860.48,-177.44 864.38,-183.25"/>
</g>
<!-- expert_100&#45;&gt;attn_3 -->
<g id="edge206" class="edge">
<title>expert_100&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M1145.17,-414.43C1127.51,-404.76 1107.17,-393.62 1088.76,-383.53"/>
<polygon fill="black" stroke="black" points="1090.34,-380.41 1079.89,-378.68 1086.98,-386.55 1090.34,-380.41"/>
</g>
<!-- expert_100&#45;&gt;agg_3 -->
<g id="edge207" class="edge">
<title>expert_100&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1208.4,-414.26C1236.18,-370.45 1283.4,-279.2 1242,-217 1234.48,-205.71 1225.19,-195.87 1214.73,-187.32"/>
<polygon fill="black" stroke="black" points="1216.59,-184.33 1206.52,-181.02 1212.32,-189.88 1216.59,-184.33"/>
</g>
<!-- expert_101&#45;&gt;attn_3 -->
<g id="edge208" class="edge">
<title>expert_101&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M1331.67,-414.49C1279.69,-403.85 1218.98,-391.42 1165.99,-380.57"/>
<polygon fill="black" stroke="black" points="1166.69,-377.14 1156.19,-378.56 1165.29,-383.99 1166.69,-377.14"/>
</g>
<!-- expert_101&#45;&gt;agg_3 -->
<g id="edge209" class="edge">
<title>expert_101&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1437.62,-414.35C1407,-369.05 1336.83,-273.32 1256,-217 1239.07,-205.2 1220.31,-194.7 1201.08,-185.43"/>
<polygon fill="black" stroke="black" points="1202.46,-182.21 1191.92,-181.13 1199.48,-188.55 1202.46,-182.21"/>
</g>
<!-- expert_102&#45;&gt;attn_3 -->
<g id="edge210" class="edge">
<title>expert_102&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M1594.45,-416C1591.27,-415.49 1588.11,-415.01 1585,-414.54 1450.13,-394.33 1295.75,-377.81 1184.78,-367.08"/>
<polygon fill="black" stroke="black" points="1184.8,-363.56 1174.51,-366.09 1184.13,-370.53 1184.8,-363.56"/>
</g>
<!-- expert_102&#45;&gt;agg_3 -->
<g id="edge211" class="edge">
<title>expert_102&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1676.21,-414.39C1603.33,-370.2 1445.06,-277.57 1303,-217 1275.72,-205.37 1246.33,-194.38 1217.35,-184.38"/>
<polygon fill="black" stroke="black" points="1218.14,-180.95 1207.54,-181.03 1215.87,-187.58 1218.14,-180.95"/>
</g>
<!-- expert_103&#45;&gt;attn_3 -->
<g id="edge212" class="edge">
<title>expert_103&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M1857.47,-415.85C1854.28,-415.39 1851.12,-414.95 1848,-414.54 1617.66,-384.19 1348.51,-367.7 1184.72,-359.76"/>
<polygon fill="black" stroke="black" points="1184.73,-356.25 1174.57,-359.27 1184.39,-363.25 1184.73,-356.25"/>
</g>
<!-- expert_103&#45;&gt;agg_3 -->
<g id="edge213" class="edge">
<title>expert_103&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1919.76,-414.51C1812.92,-370.69 1582.69,-278.89 1383,-217 1344.98,-205.22 1304.26,-193.91 1264.53,-183.57"/>
<polygon fill="black" stroke="black" points="1265.28,-180.14 1254.73,-181.03 1263.53,-186.92 1265.28,-180.14"/>
</g>
<!-- attn_comm_3 -->
<g id="node152" class="node">
<title>attn_comm_3</title>
<ellipse fill="lightgreen" stroke="black" cx="1034" cy="-253.77" rx="198.89" ry="36.54"/>
<text text-anchor="middle" x="1034" y="-267.77" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="1034" y="-256.77" font-family="Arial" font-size="10.00">GPU: 96&#45;103</text>
<text text-anchor="middle" x="1034" y="-245.77" font-family="Arial" font-size="10.00">Input: [batch_size=16, seq_len=1024, heads=8, d_k=64]</text>
<text text-anchor="middle" x="1034" y="-234.77" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, heads=64, d_k=64]</text>
</g>
<!-- attn_3&#45;&gt;attn_comm_3 -->
<g id="edge214" class="edge">
<title>attn_3&#45;&gt;attn_comm_3</title>
<path fill="none" stroke="black" d="M1034,-326.37C1034,-318.56 1034,-309.69 1034,-300.92"/>
<polygon fill="black" stroke="black" points="1037.5,-300.75 1034,-290.75 1030.5,-300.75 1037.5,-300.75"/>
</g>
<!-- attn_comm_3&#45;&gt;agg_3 -->
<g id="edge215" class="edge">
<title>attn_comm_3&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1034,-216.93C1034,-208.89 1034,-200.14 1034,-191.39"/>
<polygon fill="black" stroke="black" points="1037.5,-191.17 1034,-181.17 1030.5,-191.17 1037.5,-191.17"/>
</g>
<!-- output -->
<g id="node154" class="node">
<title>output</title>
<polygon fill="lightgray" stroke="black" points="1177.5,-41 890.5,-41 890.5,0 1177.5,0 1177.5,-41"/>
<text text-anchor="middle" x="1034" y="-29" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="1034" y="-18" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=2048, hidden=4096]</text>
<text text-anchor="middle" x="1034" y="-7" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=2048, vocab_size=128000]</text>
</g>
<!-- agg_3&#45;&gt;output -->
<g id="edge216" class="edge">
<title>agg_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1034,-76.93C1034,-68.2 1034,-59.39 1034,-51.44"/>
<polygon fill="black" stroke="black" points="1037.5,-51.22 1034,-41.22 1030.5,-51.22 1037.5,-51.22"/>
</g>
<!-- pipe_comm_0_1&#45;&gt;embed_1 -->
<g id="edge55" class="edge">
<title>pipe_comm_0_1&#45;&gt;embed_1</title>
<path fill="none" stroke="black" d="M10475,-2639.08C10475,-2625.25 10475,-2609.49 10475,-2595.72"/>
<polygon fill="black" stroke="black" points="10478.5,-2595.64 10475,-2585.64 10471.5,-2595.64 10478.5,-2595.64"/>
</g>
<!-- pipe_comm_1_2&#45;&gt;embed_2 -->
<g id="edge109" class="edge">
<title>pipe_comm_1_2&#45;&gt;embed_2</title>
<path fill="none" stroke="black" d="M7345,-1748.47C7345,-1734.64 7345,-1718.87 7345,-1705.1"/>
<polygon fill="black" stroke="black" points="7348.5,-1705.02 7345,-1695.02 7341.5,-1705.02 7348.5,-1705.02"/>
</g>
<!-- pipe_comm_2_3&#45;&gt;embed_3 -->
<g id="edge163" class="edge">
<title>pipe_comm_2_3&#45;&gt;embed_3</title>
<path fill="none" stroke="black" d="M4215,-857.85C4215,-844.02 4215,-828.26 4215,-814.48"/>
<polygon fill="black" stroke="black" points="4218.5,-814.4 4215,-804.4 4211.5,-814.4 4218.5,-814.4"/>
</g>
</g>
</svg>
