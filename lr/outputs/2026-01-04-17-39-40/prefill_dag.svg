<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="6pt"
 viewBox="0.00 0.00 1440.00 5.89" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.01 0.01) rotate(0) translate(4 757.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-757.91 186162.43,-757.91 186162.43,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="22746" cy="-716.43" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="22746" y="-727.73" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="22746" y="-712.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="22746" y="-697.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_0 -->
<g id="node2" class="node">
<title>s0_emb_0</title>
<polygon fill="lightblue" stroke="black" points="398,-616.45 0,-616.45 0,-563.45 398,-563.45 398,-616.45"/>
<text text-anchor="middle" x="199" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: Embedding</text>
<text text-anchor="middle" x="199" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="199" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;s0_emb_0</title>
<path fill="none" stroke="black" d="M22464.2,-715.46C19919.25,-715.65 981.34,-714.6 407,-642.95 368.68,-638.17 327.26,-628.73 291.54,-619.18"/>
<polygon fill="black" stroke="black" points="292.19,-615.73 281.63,-616.49 290.36,-622.49 292.19,-615.73"/>
</g>
<!-- s0_emb_1 -->
<g id="node15" class="node">
<title>s0_emb_1</title>
<polygon fill="lightblue" stroke="black" points="6840,-616.45 6442,-616.45 6442,-563.45 6840,-563.45 6840,-616.45"/>
<text text-anchor="middle" x="6641" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: Embedding</text>
<text text-anchor="middle" x="6641" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="6641" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_1 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;s0_emb_1</title>
<path fill="none" stroke="black" d="M22464.68,-715.08C20368.23,-712.39 7252.1,-693.51 6849,-642.95 6810.68,-638.15 6769.26,-628.7 6733.55,-619.16"/>
<polygon fill="black" stroke="black" points="6734.2,-615.71 6723.63,-616.47 6732.37,-622.46 6734.2,-615.71"/>
</g>
<!-- s0_emb_2 -->
<g id="node28" class="node">
<title>s0_emb_2</title>
<polygon fill="lightblue" stroke="black" points="13282,-616.45 12884,-616.45 12884,-563.45 13282,-563.45 13282,-616.45"/>
<text text-anchor="middle" x="13083" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: Embedding</text>
<text text-anchor="middle" x="13083" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="13083" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_2 -->
<g id="edge31" class="edge">
<title>input&#45;&gt;s0_emb_2</title>
<path fill="none" stroke="black" d="M22464.49,-715.15C20943.31,-713.42 13756.77,-702.1 13291,-642.95 13252.78,-638.1 13211.45,-628.67 13175.79,-619.16"/>
<polygon fill="black" stroke="black" points="13176.46,-615.71 13165.89,-616.47 13174.63,-622.47 13176.46,-615.71"/>
</g>
<!-- s0_emb_3 -->
<g id="node41" class="node">
<title>s0_emb_3</title>
<polygon fill="lightblue" stroke="black" points="19724,-616.45 19326,-616.45 19326,-563.45 19724,-563.45 19724,-616.45"/>
<text text-anchor="middle" x="19525" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: Embedding</text>
<text text-anchor="middle" x="19525" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="19525" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_3 -->
<g id="edge46" class="edge">
<title>input&#45;&gt;s0_emb_3</title>
<path fill="none" stroke="black" d="M22466.23,-712.22C21770.43,-703.75 19998.7,-678.91 19733,-642.95 19695.24,-637.84 19654.41,-628.5 19619.02,-619.14"/>
<polygon fill="black" stroke="black" points="19619.75,-615.71 19609.18,-616.5 19617.93,-622.47 19619.75,-615.71"/>
</g>
<!-- s0_emb_4 -->
<g id="node54" class="node">
<title>s0_emb_4</title>
<polygon fill="lightblue" stroke="black" points="26166,-616.45 25768,-616.45 25768,-563.45 26166,-563.45 26166,-616.45"/>
<text text-anchor="middle" x="25967" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: Embedding</text>
<text text-anchor="middle" x="25967" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="25967" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_4 -->
<g id="edge61" class="edge">
<title>input&#45;&gt;s0_emb_4</title>
<path fill="none" stroke="black" d="M23025.77,-712.22C23721.57,-703.75 25493.3,-678.91 25759,-642.95 25796.76,-637.84 25837.59,-628.5 25872.98,-619.14"/>
<polygon fill="black" stroke="black" points="25874.07,-622.47 25882.82,-616.5 25872.25,-615.71 25874.07,-622.47"/>
</g>
<!-- s0_emb_5 -->
<g id="node67" class="node">
<title>s0_emb_5</title>
<polygon fill="lightblue" stroke="black" points="32608,-616.45 32210,-616.45 32210,-563.45 32608,-563.45 32608,-616.45"/>
<text text-anchor="middle" x="32409" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: Embedding</text>
<text text-anchor="middle" x="32409" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="32409" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_5 -->
<g id="edge76" class="edge">
<title>input&#45;&gt;s0_emb_5</title>
<path fill="none" stroke="black" d="M23027.51,-715.15C24548.69,-713.42 31735.23,-702.1 32201,-642.95 32239.22,-638.1 32280.55,-628.67 32316.21,-619.16"/>
<polygon fill="black" stroke="black" points="32317.37,-622.47 32326.11,-616.47 32315.54,-615.71 32317.37,-622.47"/>
</g>
<!-- s0_emb_6 -->
<g id="node80" class="node">
<title>s0_emb_6</title>
<polygon fill="lightblue" stroke="black" points="39050,-616.45 38652,-616.45 38652,-563.45 39050,-563.45 39050,-616.45"/>
<text text-anchor="middle" x="38851" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: Embedding</text>
<text text-anchor="middle" x="38851" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="38851" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_6 -->
<g id="edge91" class="edge">
<title>input&#45;&gt;s0_emb_6</title>
<path fill="none" stroke="black" d="M23027.32,-715.08C25123.77,-712.39 38239.9,-693.51 38643,-642.95 38681.32,-638.15 38722.74,-628.7 38758.45,-619.16"/>
<polygon fill="black" stroke="black" points="38759.63,-622.46 38768.37,-616.47 38757.8,-615.71 38759.63,-622.46"/>
</g>
<!-- s0_emb_7 -->
<g id="node93" class="node">
<title>s0_emb_7</title>
<polygon fill="lightblue" stroke="black" points="45492,-616.45 45094,-616.45 45094,-563.45 45492,-563.45 45492,-616.45"/>
<text text-anchor="middle" x="45293" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: Embedding</text>
<text text-anchor="middle" x="45293" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096]</text>
<text text-anchor="middle" x="45293" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_7 -->
<g id="edge106" class="edge">
<title>input&#45;&gt;s0_emb_7</title>
<path fill="none" stroke="black" d="M23027.8,-715.46C25572.75,-715.65 44510.66,-714.6 45085,-642.95 45123.32,-638.17 45164.74,-628.73 45200.46,-619.18"/>
<polygon fill="black" stroke="black" points="45201.64,-622.49 45210.37,-616.49 45199.81,-615.73 45201.64,-622.49"/>
</g>
<!-- s0_ln0_0 -->
<g id="node3" class="node">
<title>s0_ln0_0</title>
<polygon fill="lightblue" stroke="black" points="814,-616.45 416,-616.45 416,-563.45 814,-563.45 814,-616.45"/>
<text text-anchor="middle" x="615" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: LayerNorm</text>
<text text-anchor="middle" x="615" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="615" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_0&#45;&gt;s0_ln0_0 -->
<g id="edge2" class="edge">
<title>s0_emb_0&#45;&gt;s0_ln0_0</title>
<path fill="none" stroke="black" d="M398.06,-589.95C400.66,-589.95 403.25,-589.95 405.85,-589.95"/>
<polygon fill="black" stroke="black" points="405.86,-593.45 415.86,-589.95 405.86,-586.45 405.86,-593.45"/>
</g>
<!-- s0_q_0 -->
<g id="node4" class="node">
<title>s0_q_0</title>
<polygon fill="lightblue" stroke="black" points="3197.5,-616.45 2808.5,-616.45 2808.5,-563.45 3197.5,-563.45 3197.5,-616.45"/>
<text text-anchor="middle" x="3003" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: Q Linear</text>
<text text-anchor="middle" x="3003" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="3003" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_q_0 -->
<g id="edge3" class="edge">
<title>s0_ln0_0&#45;&gt;s0_q_0</title>
<path fill="none" stroke="black" d="M678.25,-616.53C720.85,-632.96 778.76,-652.47 832,-660.95 939.42,-678.08 2682.63,-678.38 2790,-660.95 2838.44,-653.09 2890.76,-635.79 2931.42,-620.23"/>
<polygon fill="black" stroke="black" points="2932.91,-623.41 2940.96,-616.53 2930.38,-616.88 2932.91,-623.41"/>
</g>
<!-- s0_k_0 -->
<g id="node5" class="node">
<title>s0_k_0</title>
<polygon fill="lightblue" stroke="black" points="2209.5,-616.45 1820.5,-616.45 1820.5,-563.45 2209.5,-563.45 2209.5,-616.45"/>
<text text-anchor="middle" x="2015" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: K Linear</text>
<text text-anchor="middle" x="2015" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="2015" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_k_0 -->
<g id="edge4" class="edge">
<title>s0_ln0_0&#45;&gt;s0_k_0</title>
<path fill="none" stroke="black" d="M678.25,-616.53C720.85,-632.96 778.76,-652.47 832,-660.95 938.43,-677.92 1695.61,-678.22 1802,-660.95 1850.44,-653.09 1902.76,-635.79 1943.42,-620.23"/>
<polygon fill="black" stroke="black" points="1944.91,-623.41 1952.96,-616.53 1942.38,-616.88 1944.91,-623.41"/>
</g>
<!-- s0_v_0 -->
<g id="node6" class="node">
<title>s0_v_0</title>
<polygon fill="lightblue" stroke="black" points="1221.5,-616.45 832.5,-616.45 832.5,-563.45 1221.5,-563.45 1221.5,-616.45"/>
<text text-anchor="middle" x="1027" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: V Linear</text>
<text text-anchor="middle" x="1027" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="1027" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_v_0 -->
<g id="edge5" class="edge">
<title>s0_ln0_0&#45;&gt;s0_v_0</title>
<path fill="none" stroke="black" d="M814.16,-589.95C816.92,-589.95 819.69,-589.95 822.45,-589.95"/>
<polygon fill="black" stroke="black" points="822.45,-593.45 832.45,-589.95 822.45,-586.45 822.45,-593.45"/>
</g>
<!-- s0_allgather_q_0 -->
<g id="node7" class="node">
<title>s0_allgather_q_0</title>
<ellipse fill="white" stroke="black" cx="3497" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="3497" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather Q</text>
<text text-anchor="middle" x="3497" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="3497" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_0&#45;&gt;s0_allgather_q_0 -->
<g id="edge6" class="edge">
<title>s0_q_0&#45;&gt;s0_allgather_q_0</title>
<path fill="none" stroke="black" d="M3197.9,-589.95C3200.36,-589.95 3202.83,-589.95 3205.29,-589.95"/>
<polygon fill="black" stroke="black" points="3205.42,-593.45 3215.42,-589.95 3205.42,-586.45 3205.42,-593.45"/>
</g>
<!-- s0_allgather_k_0 -->
<g id="node8" class="node">
<title>s0_allgather_k_0</title>
<ellipse fill="white" stroke="black" cx="2509" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="2509" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather K</text>
<text text-anchor="middle" x="2509" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="2509" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_0&#45;&gt;s0_allgather_k_0 -->
<g id="edge7" class="edge">
<title>s0_k_0&#45;&gt;s0_allgather_k_0</title>
<path fill="none" stroke="black" d="M2209.9,-589.95C2212.36,-589.95 2214.83,-589.95 2217.29,-589.95"/>
<polygon fill="black" stroke="black" points="2217.42,-593.45 2227.42,-589.95 2217.42,-586.45 2217.42,-593.45"/>
</g>
<!-- s0_allgather_v_0 -->
<g id="node9" class="node">
<title>s0_allgather_v_0</title>
<ellipse fill="white" stroke="black" cx="1521" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="1521" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather V</text>
<text text-anchor="middle" x="1521" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="1521" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_0&#45;&gt;s0_allgather_v_0 -->
<g id="edge8" class="edge">
<title>s0_v_0&#45;&gt;s0_allgather_v_0</title>
<path fill="none" stroke="black" d="M1221.9,-589.95C1224.36,-589.95 1226.83,-589.95 1229.29,-589.95"/>
<polygon fill="black" stroke="black" points="1229.42,-593.45 1239.42,-589.95 1229.42,-586.45 1229.42,-593.45"/>
</g>
<!-- s0_attn_0 -->
<g id="node10" class="node">
<title>s0_attn_0</title>
<polygon fill="lightblue" stroke="black" points="4194,-616.45 3796,-616.45 3796,-563.45 4194,-563.45 4194,-616.45"/>
<text text-anchor="middle" x="3995" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: Attention</text>
<text text-anchor="middle" x="3995" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="3995" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_0&#45;&gt;s0_attn_0 -->
<g id="edge9" class="edge">
<title>s0_allgather_q_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M3778.58,-589.95C3781.02,-589.95 3783.46,-589.95 3785.9,-589.95"/>
<polygon fill="black" stroke="black" points="3785.91,-593.45 3795.91,-589.95 3785.91,-586.45 3785.91,-593.45"/>
</g>
<!-- s0_allgather_k_0&#45;&gt;s0_attn_0 -->
<g id="edge10" class="edge">
<title>s0_allgather_k_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M2625.02,-624.16C2679.96,-638.63 2746.8,-653.79 2808,-660.95 2915.05,-673.49 3671.57,-677.92 3778,-660.95 3827.39,-653.08 3880.81,-635.72 3922.28,-620.14"/>
<polygon fill="black" stroke="black" points="3923.65,-623.36 3931.75,-616.53 3921.16,-616.82 3923.65,-623.36"/>
</g>
<!-- s0_allgather_v_0&#45;&gt;s0_attn_0 -->
<g id="edge11" class="edge">
<title>s0_allgather_v_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M1637.02,-624.16C1691.96,-638.63 1758.8,-653.79 1820,-660.95 1928.04,-673.6 3670.58,-678.08 3778,-660.95 3827.39,-653.08 3880.81,-635.72 3922.28,-620.14"/>
<polygon fill="black" stroke="black" points="3923.65,-623.36 3931.75,-616.53 3921.16,-616.82 3923.65,-623.36"/>
</g>
<!-- s0_gate_0 -->
<g id="node11" class="node">
<title>s0_gate_0</title>
<polygon fill="orange" stroke="black" points="5012.37,-642.95 4375.47,-642.95 4211.63,-536.95 4848.53,-536.95 5012.37,-642.95"/>
<text text-anchor="middle" x="4612" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: MoE Gate</text>
<text text-anchor="middle" x="4612" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="4612" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_0&#45;&gt;s0_gate_0 -->
<g id="edge12" class="edge">
<title>s0_attn_0&#45;&gt;s0_gate_0</title>
<path fill="none" stroke="black" d="M4194.14,-589.95C4223.84,-589.95 4253.53,-589.95 4283.23,-589.95"/>
<polygon fill="black" stroke="black" points="4283.3,-593.45 4293.3,-589.95 4283.3,-586.45 4283.3,-593.45"/>
</g>
<!-- s0_expert_0 -->
<g id="node12" class="node">
<title>s0_expert_0</title>
<polygon fill="lightblue" stroke="black" points="5428,-616.45 5030,-616.45 5030,-563.45 5428,-563.45 5428,-616.45"/>
<text text-anchor="middle" x="5229" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: Expert FFN</text>
<text text-anchor="middle" x="5229" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="5229" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_0&#45;&gt;s0_expert_0 -->
<g id="edge13" class="edge">
<title>s0_gate_0&#45;&gt;s0_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4930.74,-589.95C4960.4,-589.95 4990.06,-589.95 5019.72,-589.95"/>
<polygon fill="black" stroke="black" points="5019.77,-593.45 5029.77,-589.95 5019.77,-586.45 5019.77,-593.45"/>
</g>
<!-- s0_alltoall_0 -->
<g id="node13" class="node">
<title>s0_alltoall_0</title>
<ellipse fill="white" stroke="black" cx="5727" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="5727" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: AllToAll</text>
<text text-anchor="middle" x="5727" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="5727" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_0&#45;&gt;s0_alltoall_0 -->
<g id="edge14" class="edge">
<title>s0_expert_0&#45;&gt;s0_alltoall_0</title>
<path fill="none" stroke="black" d="M5428.39,-589.95C5430.68,-589.95 5432.98,-589.95 5435.27,-589.95"/>
<polygon fill="black" stroke="black" points="5435.31,-593.45 5445.31,-589.95 5435.31,-586.45 5435.31,-593.45"/>
</g>
<!-- s0_ln1_0 -->
<g id="node14" class="node">
<title>s0_ln1_0</title>
<polygon fill="lightblue" stroke="black" points="6424,-616.45 6026,-616.45 6026,-563.45 6424,-563.45 6424,-616.45"/>
<text text-anchor="middle" x="6225" y="-601.25" font-family="Times,serif" font-size="14.00">GPU0: LayerNorm</text>
<text text-anchor="middle" x="6225" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="6225" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_0&#45;&gt;s0_ln1_0 -->
<g id="edge15" class="edge">
<title>s0_alltoall_0&#45;&gt;s0_ln1_0</title>
<path fill="none" stroke="black" d="M6008.58,-589.95C6011.02,-589.95 6013.46,-589.95 6015.9,-589.95"/>
<polygon fill="black" stroke="black" points="6015.91,-593.45 6025.91,-589.95 6015.91,-586.45 6015.91,-593.45"/>
</g>
<!-- s1_ln0_8 -->
<g id="node106" class="node">
<title>s1_ln0_8</title>
<polygon fill="lightgreen" stroke="black" points="6424,-474.45 6026,-474.45 6026,-421.45 6424,-421.45 6424,-474.45"/>
<text text-anchor="middle" x="6225" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: LayerNorm</text>
<text text-anchor="middle" x="6225" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="6225" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_0&#45;&gt;s1_ln0_8 -->
<g id="edge121" class="edge">
<title>s0_ln1_0&#45;&gt;s1_ln0_8</title>
<path fill="none" stroke="black" d="M6225,-563.28C6225,-541.17 6225,-509.05 6225,-484.48"/>
<polygon fill="black" stroke="black" points="6228.5,-484.47 6225,-474.47 6221.5,-484.47 6228.5,-484.47"/>
</g>
<!-- s0_ln0_1 -->
<g id="node16" class="node">
<title>s0_ln0_1</title>
<polygon fill="lightblue" stroke="black" points="7256,-616.45 6858,-616.45 6858,-563.45 7256,-563.45 7256,-616.45"/>
<text text-anchor="middle" x="7057" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: LayerNorm</text>
<text text-anchor="middle" x="7057" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="7057" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_1&#45;&gt;s0_ln0_1 -->
<g id="edge17" class="edge">
<title>s0_emb_1&#45;&gt;s0_ln0_1</title>
<path fill="none" stroke="black" d="M6840.06,-589.95C6842.66,-589.95 6845.25,-589.95 6847.85,-589.95"/>
<polygon fill="black" stroke="black" points="6847.86,-593.45 6857.86,-589.95 6847.86,-586.45 6847.86,-593.45"/>
</g>
<!-- s0_q_1 -->
<g id="node17" class="node">
<title>s0_q_1</title>
<polygon fill="lightblue" stroke="black" points="9639.5,-616.45 9250.5,-616.45 9250.5,-563.45 9639.5,-563.45 9639.5,-616.45"/>
<text text-anchor="middle" x="9445" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: Q Linear</text>
<text text-anchor="middle" x="9445" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="9445" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_q_1 -->
<g id="edge18" class="edge">
<title>s0_ln0_1&#45;&gt;s0_q_1</title>
<path fill="none" stroke="black" d="M7120.25,-616.53C7162.85,-632.96 7220.76,-652.47 7274,-660.95 7381.42,-678.08 9124.63,-678.38 9232,-660.95 9280.44,-653.09 9332.76,-635.79 9373.42,-620.23"/>
<polygon fill="black" stroke="black" points="9374.91,-623.41 9382.96,-616.53 9372.38,-616.88 9374.91,-623.41"/>
</g>
<!-- s0_k_1 -->
<g id="node18" class="node">
<title>s0_k_1</title>
<polygon fill="lightblue" stroke="black" points="8651.5,-616.45 8262.5,-616.45 8262.5,-563.45 8651.5,-563.45 8651.5,-616.45"/>
<text text-anchor="middle" x="8457" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: K Linear</text>
<text text-anchor="middle" x="8457" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="8457" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_k_1 -->
<g id="edge19" class="edge">
<title>s0_ln0_1&#45;&gt;s0_k_1</title>
<path fill="none" stroke="black" d="M7120.25,-616.53C7162.85,-632.96 7220.76,-652.47 7274,-660.95 7380.43,-677.92 8137.61,-678.22 8244,-660.95 8292.44,-653.09 8344.76,-635.79 8385.42,-620.23"/>
<polygon fill="black" stroke="black" points="8386.91,-623.41 8394.96,-616.53 8384.38,-616.88 8386.91,-623.41"/>
</g>
<!-- s0_v_1 -->
<g id="node19" class="node">
<title>s0_v_1</title>
<polygon fill="lightblue" stroke="black" points="7663.5,-616.45 7274.5,-616.45 7274.5,-563.45 7663.5,-563.45 7663.5,-616.45"/>
<text text-anchor="middle" x="7469" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: V Linear</text>
<text text-anchor="middle" x="7469" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="7469" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_v_1 -->
<g id="edge20" class="edge">
<title>s0_ln0_1&#45;&gt;s0_v_1</title>
<path fill="none" stroke="black" d="M7256.16,-589.95C7258.92,-589.95 7261.69,-589.95 7264.45,-589.95"/>
<polygon fill="black" stroke="black" points="7264.45,-593.45 7274.45,-589.95 7264.45,-586.45 7264.45,-593.45"/>
</g>
<!-- s0_allgather_q_1 -->
<g id="node20" class="node">
<title>s0_allgather_q_1</title>
<ellipse fill="white" stroke="black" cx="9939" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="9939" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather Q</text>
<text text-anchor="middle" x="9939" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="9939" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_1&#45;&gt;s0_allgather_q_1 -->
<g id="edge21" class="edge">
<title>s0_q_1&#45;&gt;s0_allgather_q_1</title>
<path fill="none" stroke="black" d="M9639.9,-589.95C9642.36,-589.95 9644.83,-589.95 9647.29,-589.95"/>
<polygon fill="black" stroke="black" points="9647.42,-593.45 9657.42,-589.95 9647.42,-586.45 9647.42,-593.45"/>
</g>
<!-- s0_allgather_k_1 -->
<g id="node21" class="node">
<title>s0_allgather_k_1</title>
<ellipse fill="white" stroke="black" cx="8951" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="8951" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather K</text>
<text text-anchor="middle" x="8951" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="8951" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_1&#45;&gt;s0_allgather_k_1 -->
<g id="edge22" class="edge">
<title>s0_k_1&#45;&gt;s0_allgather_k_1</title>
<path fill="none" stroke="black" d="M8651.9,-589.95C8654.36,-589.95 8656.83,-589.95 8659.29,-589.95"/>
<polygon fill="black" stroke="black" points="8659.42,-593.45 8669.42,-589.95 8659.42,-586.45 8659.42,-593.45"/>
</g>
<!-- s0_allgather_v_1 -->
<g id="node22" class="node">
<title>s0_allgather_v_1</title>
<ellipse fill="white" stroke="black" cx="7963" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="7963" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather V</text>
<text text-anchor="middle" x="7963" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="7963" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_1&#45;&gt;s0_allgather_v_1 -->
<g id="edge23" class="edge">
<title>s0_v_1&#45;&gt;s0_allgather_v_1</title>
<path fill="none" stroke="black" d="M7663.9,-589.95C7666.36,-589.95 7668.83,-589.95 7671.29,-589.95"/>
<polygon fill="black" stroke="black" points="7671.42,-593.45 7681.42,-589.95 7671.42,-586.45 7671.42,-593.45"/>
</g>
<!-- s0_attn_1 -->
<g id="node23" class="node">
<title>s0_attn_1</title>
<polygon fill="lightblue" stroke="black" points="10636,-616.45 10238,-616.45 10238,-563.45 10636,-563.45 10636,-616.45"/>
<text text-anchor="middle" x="10437" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: Attention</text>
<text text-anchor="middle" x="10437" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="10437" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_1&#45;&gt;s0_attn_1 -->
<g id="edge24" class="edge">
<title>s0_allgather_q_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M10220.58,-589.95C10223.02,-589.95 10225.46,-589.95 10227.9,-589.95"/>
<polygon fill="black" stroke="black" points="10227.91,-593.45 10237.91,-589.95 10227.91,-586.45 10227.91,-593.45"/>
</g>
<!-- s0_allgather_k_1&#45;&gt;s0_attn_1 -->
<g id="edge25" class="edge">
<title>s0_allgather_k_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M9067.02,-624.16C9121.96,-638.63 9188.8,-653.79 9250,-660.95 9357.05,-673.49 10113.57,-677.92 10220,-660.95 10269.39,-653.08 10322.81,-635.72 10364.28,-620.14"/>
<polygon fill="black" stroke="black" points="10365.65,-623.36 10373.75,-616.53 10363.16,-616.82 10365.65,-623.36"/>
</g>
<!-- s0_allgather_v_1&#45;&gt;s0_attn_1 -->
<g id="edge26" class="edge">
<title>s0_allgather_v_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M8079.02,-624.16C8133.96,-638.63 8200.8,-653.79 8262,-660.95 8370.04,-673.6 10112.58,-678.08 10220,-660.95 10269.39,-653.08 10322.81,-635.72 10364.28,-620.14"/>
<polygon fill="black" stroke="black" points="10365.65,-623.36 10373.75,-616.53 10363.16,-616.82 10365.65,-623.36"/>
</g>
<!-- s0_gate_1 -->
<g id="node24" class="node">
<title>s0_gate_1</title>
<polygon fill="orange" stroke="black" points="11454.37,-642.95 10817.47,-642.95 10653.63,-536.95 11290.53,-536.95 11454.37,-642.95"/>
<text text-anchor="middle" x="11054" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: MoE Gate</text>
<text text-anchor="middle" x="11054" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="11054" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_1&#45;&gt;s0_gate_1 -->
<g id="edge27" class="edge">
<title>s0_attn_1&#45;&gt;s0_gate_1</title>
<path fill="none" stroke="black" d="M10636.14,-589.95C10665.84,-589.95 10695.53,-589.95 10725.23,-589.95"/>
<polygon fill="black" stroke="black" points="10725.3,-593.45 10735.3,-589.95 10725.3,-586.45 10725.3,-593.45"/>
</g>
<!-- s0_expert_1 -->
<g id="node25" class="node">
<title>s0_expert_1</title>
<polygon fill="lightblue" stroke="black" points="11870,-616.45 11472,-616.45 11472,-563.45 11870,-563.45 11870,-616.45"/>
<text text-anchor="middle" x="11671" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: Expert FFN</text>
<text text-anchor="middle" x="11671" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="11671" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_1&#45;&gt;s0_expert_1 -->
<g id="edge28" class="edge">
<title>s0_gate_1&#45;&gt;s0_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11372.74,-589.95C11402.4,-589.95 11432.06,-589.95 11461.72,-589.95"/>
<polygon fill="black" stroke="black" points="11461.77,-593.45 11471.77,-589.95 11461.77,-586.45 11461.77,-593.45"/>
</g>
<!-- s0_alltoall_1 -->
<g id="node26" class="node">
<title>s0_alltoall_1</title>
<ellipse fill="white" stroke="black" cx="12169" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="12169" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: AllToAll</text>
<text text-anchor="middle" x="12169" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="12169" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_1&#45;&gt;s0_alltoall_1 -->
<g id="edge29" class="edge">
<title>s0_expert_1&#45;&gt;s0_alltoall_1</title>
<path fill="none" stroke="black" d="M11870.39,-589.95C11872.68,-589.95 11874.98,-589.95 11877.27,-589.95"/>
<polygon fill="black" stroke="black" points="11877.31,-593.45 11887.31,-589.95 11877.31,-586.45 11877.31,-593.45"/>
</g>
<!-- s0_ln1_1 -->
<g id="node27" class="node">
<title>s0_ln1_1</title>
<polygon fill="lightblue" stroke="black" points="12866,-616.45 12468,-616.45 12468,-563.45 12866,-563.45 12866,-616.45"/>
<text text-anchor="middle" x="12667" y="-601.25" font-family="Times,serif" font-size="14.00">GPU1: LayerNorm</text>
<text text-anchor="middle" x="12667" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="12667" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_1&#45;&gt;s0_ln1_1 -->
<g id="edge30" class="edge">
<title>s0_alltoall_1&#45;&gt;s0_ln1_1</title>
<path fill="none" stroke="black" d="M12450.58,-589.95C12453.02,-589.95 12455.46,-589.95 12457.9,-589.95"/>
<polygon fill="black" stroke="black" points="12457.91,-593.45 12467.91,-589.95 12457.91,-586.45 12457.91,-593.45"/>
</g>
<!-- s1_ln0_9 -->
<g id="node118" class="node">
<title>s1_ln0_9</title>
<polygon fill="lightgreen" stroke="black" points="12866,-474.45 12468,-474.45 12468,-421.45 12866,-421.45 12866,-474.45"/>
<text text-anchor="middle" x="12667" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: LayerNorm</text>
<text text-anchor="middle" x="12667" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="12667" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_1&#45;&gt;s1_ln0_9 -->
<g id="edge122" class="edge">
<title>s0_ln1_1&#45;&gt;s1_ln0_9</title>
<path fill="none" stroke="black" d="M12667,-563.28C12667,-541.17 12667,-509.05 12667,-484.48"/>
<polygon fill="black" stroke="black" points="12670.5,-484.47 12667,-474.47 12663.5,-484.47 12670.5,-484.47"/>
</g>
<!-- s0_ln0_2 -->
<g id="node29" class="node">
<title>s0_ln0_2</title>
<polygon fill="lightblue" stroke="black" points="13698,-616.45 13300,-616.45 13300,-563.45 13698,-563.45 13698,-616.45"/>
<text text-anchor="middle" x="13499" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: LayerNorm</text>
<text text-anchor="middle" x="13499" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="13499" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_2&#45;&gt;s0_ln0_2 -->
<g id="edge32" class="edge">
<title>s0_emb_2&#45;&gt;s0_ln0_2</title>
<path fill="none" stroke="black" d="M13282.06,-589.95C13284.66,-589.95 13287.25,-589.95 13289.85,-589.95"/>
<polygon fill="black" stroke="black" points="13289.86,-593.45 13299.86,-589.95 13289.86,-586.45 13289.86,-593.45"/>
</g>
<!-- s0_q_2 -->
<g id="node30" class="node">
<title>s0_q_2</title>
<polygon fill="lightblue" stroke="black" points="16081.5,-616.45 15692.5,-616.45 15692.5,-563.45 16081.5,-563.45 16081.5,-616.45"/>
<text text-anchor="middle" x="15887" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: Q Linear</text>
<text text-anchor="middle" x="15887" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="15887" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_q_2 -->
<g id="edge33" class="edge">
<title>s0_ln0_2&#45;&gt;s0_q_2</title>
<path fill="none" stroke="black" d="M13562.25,-616.53C13604.85,-632.96 13662.76,-652.47 13716,-660.95 13823.42,-678.08 15566.63,-678.38 15674,-660.95 15722.44,-653.09 15774.76,-635.79 15815.42,-620.23"/>
<polygon fill="black" stroke="black" points="15816.91,-623.41 15824.96,-616.53 15814.38,-616.88 15816.91,-623.41"/>
</g>
<!-- s0_k_2 -->
<g id="node31" class="node">
<title>s0_k_2</title>
<polygon fill="lightblue" stroke="black" points="15093.5,-616.45 14704.5,-616.45 14704.5,-563.45 15093.5,-563.45 15093.5,-616.45"/>
<text text-anchor="middle" x="14899" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: K Linear</text>
<text text-anchor="middle" x="14899" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="14899" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_k_2 -->
<g id="edge34" class="edge">
<title>s0_ln0_2&#45;&gt;s0_k_2</title>
<path fill="none" stroke="black" d="M13562.25,-616.53C13604.85,-632.96 13662.76,-652.47 13716,-660.95 13822.43,-677.92 14579.61,-678.22 14686,-660.95 14734.44,-653.09 14786.76,-635.79 14827.42,-620.23"/>
<polygon fill="black" stroke="black" points="14828.91,-623.41 14836.96,-616.53 14826.38,-616.88 14828.91,-623.41"/>
</g>
<!-- s0_v_2 -->
<g id="node32" class="node">
<title>s0_v_2</title>
<polygon fill="lightblue" stroke="black" points="14105.5,-616.45 13716.5,-616.45 13716.5,-563.45 14105.5,-563.45 14105.5,-616.45"/>
<text text-anchor="middle" x="13911" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: V Linear</text>
<text text-anchor="middle" x="13911" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="13911" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_v_2 -->
<g id="edge35" class="edge">
<title>s0_ln0_2&#45;&gt;s0_v_2</title>
<path fill="none" stroke="black" d="M13698.16,-589.95C13700.92,-589.95 13703.69,-589.95 13706.45,-589.95"/>
<polygon fill="black" stroke="black" points="13706.45,-593.45 13716.45,-589.95 13706.45,-586.45 13706.45,-593.45"/>
</g>
<!-- s0_allgather_q_2 -->
<g id="node33" class="node">
<title>s0_allgather_q_2</title>
<ellipse fill="white" stroke="black" cx="16381" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="16381" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather Q</text>
<text text-anchor="middle" x="16381" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="16381" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_2&#45;&gt;s0_allgather_q_2 -->
<g id="edge36" class="edge">
<title>s0_q_2&#45;&gt;s0_allgather_q_2</title>
<path fill="none" stroke="black" d="M16081.9,-589.95C16084.36,-589.95 16086.83,-589.95 16089.29,-589.95"/>
<polygon fill="black" stroke="black" points="16089.42,-593.45 16099.42,-589.95 16089.42,-586.45 16089.42,-593.45"/>
</g>
<!-- s0_allgather_k_2 -->
<g id="node34" class="node">
<title>s0_allgather_k_2</title>
<ellipse fill="white" stroke="black" cx="15393" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="15393" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather K</text>
<text text-anchor="middle" x="15393" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="15393" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_2&#45;&gt;s0_allgather_k_2 -->
<g id="edge37" class="edge">
<title>s0_k_2&#45;&gt;s0_allgather_k_2</title>
<path fill="none" stroke="black" d="M15093.9,-589.95C15096.36,-589.95 15098.83,-589.95 15101.29,-589.95"/>
<polygon fill="black" stroke="black" points="15101.42,-593.45 15111.42,-589.95 15101.42,-586.45 15101.42,-593.45"/>
</g>
<!-- s0_allgather_v_2 -->
<g id="node35" class="node">
<title>s0_allgather_v_2</title>
<ellipse fill="white" stroke="black" cx="14405" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="14405" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather V</text>
<text text-anchor="middle" x="14405" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="14405" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_2&#45;&gt;s0_allgather_v_2 -->
<g id="edge38" class="edge">
<title>s0_v_2&#45;&gt;s0_allgather_v_2</title>
<path fill="none" stroke="black" d="M14105.9,-589.95C14108.36,-589.95 14110.83,-589.95 14113.29,-589.95"/>
<polygon fill="black" stroke="black" points="14113.42,-593.45 14123.42,-589.95 14113.42,-586.45 14113.42,-593.45"/>
</g>
<!-- s0_attn_2 -->
<g id="node36" class="node">
<title>s0_attn_2</title>
<polygon fill="lightblue" stroke="black" points="17078,-616.45 16680,-616.45 16680,-563.45 17078,-563.45 17078,-616.45"/>
<text text-anchor="middle" x="16879" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: Attention</text>
<text text-anchor="middle" x="16879" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="16879" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_2&#45;&gt;s0_attn_2 -->
<g id="edge39" class="edge">
<title>s0_allgather_q_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M16662.58,-589.95C16665.02,-589.95 16667.46,-589.95 16669.9,-589.95"/>
<polygon fill="black" stroke="black" points="16669.91,-593.45 16679.91,-589.95 16669.91,-586.45 16669.91,-593.45"/>
</g>
<!-- s0_allgather_k_2&#45;&gt;s0_attn_2 -->
<g id="edge40" class="edge">
<title>s0_allgather_k_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M15509.02,-624.16C15563.96,-638.63 15630.8,-653.79 15692,-660.95 15799.05,-673.49 16555.57,-677.92 16662,-660.95 16711.39,-653.08 16764.81,-635.72 16806.28,-620.14"/>
<polygon fill="black" stroke="black" points="16807.65,-623.36 16815.75,-616.53 16805.16,-616.82 16807.65,-623.36"/>
</g>
<!-- s0_allgather_v_2&#45;&gt;s0_attn_2 -->
<g id="edge41" class="edge">
<title>s0_allgather_v_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M14521.02,-624.16C14575.96,-638.63 14642.8,-653.79 14704,-660.95 14812.04,-673.6 16554.58,-678.08 16662,-660.95 16711.39,-653.08 16764.81,-635.72 16806.28,-620.14"/>
<polygon fill="black" stroke="black" points="16807.65,-623.36 16815.75,-616.53 16805.16,-616.82 16807.65,-623.36"/>
</g>
<!-- s0_gate_2 -->
<g id="node37" class="node">
<title>s0_gate_2</title>
<polygon fill="orange" stroke="black" points="17896.37,-642.95 17259.47,-642.95 17095.63,-536.95 17732.53,-536.95 17896.37,-642.95"/>
<text text-anchor="middle" x="17496" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: MoE Gate</text>
<text text-anchor="middle" x="17496" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="17496" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_2&#45;&gt;s0_gate_2 -->
<g id="edge42" class="edge">
<title>s0_attn_2&#45;&gt;s0_gate_2</title>
<path fill="none" stroke="black" d="M17078.14,-589.95C17107.84,-589.95 17137.53,-589.95 17167.23,-589.95"/>
<polygon fill="black" stroke="black" points="17167.3,-593.45 17177.3,-589.95 17167.3,-586.45 17167.3,-593.45"/>
</g>
<!-- s0_expert_2 -->
<g id="node38" class="node">
<title>s0_expert_2</title>
<polygon fill="lightblue" stroke="black" points="18312,-616.45 17914,-616.45 17914,-563.45 18312,-563.45 18312,-616.45"/>
<text text-anchor="middle" x="18113" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: Expert FFN</text>
<text text-anchor="middle" x="18113" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="18113" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_2&#45;&gt;s0_expert_2 -->
<g id="edge43" class="edge">
<title>s0_gate_2&#45;&gt;s0_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17814.74,-589.95C17844.4,-589.95 17874.06,-589.95 17903.72,-589.95"/>
<polygon fill="black" stroke="black" points="17903.77,-593.45 17913.77,-589.95 17903.77,-586.45 17903.77,-593.45"/>
</g>
<!-- s0_alltoall_2 -->
<g id="node39" class="node">
<title>s0_alltoall_2</title>
<ellipse fill="white" stroke="black" cx="18611" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="18611" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: AllToAll</text>
<text text-anchor="middle" x="18611" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="18611" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_2&#45;&gt;s0_alltoall_2 -->
<g id="edge44" class="edge">
<title>s0_expert_2&#45;&gt;s0_alltoall_2</title>
<path fill="none" stroke="black" d="M18312.39,-589.95C18314.68,-589.95 18316.98,-589.95 18319.27,-589.95"/>
<polygon fill="black" stroke="black" points="18319.31,-593.45 18329.31,-589.95 18319.31,-586.45 18319.31,-593.45"/>
</g>
<!-- s0_ln1_2 -->
<g id="node40" class="node">
<title>s0_ln1_2</title>
<polygon fill="lightblue" stroke="black" points="19308,-616.45 18910,-616.45 18910,-563.45 19308,-563.45 19308,-616.45"/>
<text text-anchor="middle" x="19109" y="-601.25" font-family="Times,serif" font-size="14.00">GPU2: LayerNorm</text>
<text text-anchor="middle" x="19109" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="19109" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_2&#45;&gt;s0_ln1_2 -->
<g id="edge45" class="edge">
<title>s0_alltoall_2&#45;&gt;s0_ln1_2</title>
<path fill="none" stroke="black" d="M18892.58,-589.95C18895.02,-589.95 18897.46,-589.95 18899.9,-589.95"/>
<polygon fill="black" stroke="black" points="18899.91,-593.45 18909.91,-589.95 18899.91,-586.45 18899.91,-593.45"/>
</g>
<!-- s1_ln0_10 -->
<g id="node130" class="node">
<title>s1_ln0_10</title>
<polygon fill="lightgreen" stroke="black" points="19308,-474.45 18910,-474.45 18910,-421.45 19308,-421.45 19308,-474.45"/>
<text text-anchor="middle" x="19109" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: LayerNorm</text>
<text text-anchor="middle" x="19109" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="19109" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_2&#45;&gt;s1_ln0_10 -->
<g id="edge123" class="edge">
<title>s0_ln1_2&#45;&gt;s1_ln0_10</title>
<path fill="none" stroke="black" d="M19109,-563.28C19109,-541.17 19109,-509.05 19109,-484.48"/>
<polygon fill="black" stroke="black" points="19112.5,-484.47 19109,-474.47 19105.5,-484.47 19112.5,-484.47"/>
</g>
<!-- s0_ln0_3 -->
<g id="node42" class="node">
<title>s0_ln0_3</title>
<polygon fill="lightblue" stroke="black" points="20140,-616.45 19742,-616.45 19742,-563.45 20140,-563.45 20140,-616.45"/>
<text text-anchor="middle" x="19941" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: LayerNorm</text>
<text text-anchor="middle" x="19941" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="19941" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_3&#45;&gt;s0_ln0_3 -->
<g id="edge47" class="edge">
<title>s0_emb_3&#45;&gt;s0_ln0_3</title>
<path fill="none" stroke="black" d="M19724.06,-589.95C19726.66,-589.95 19729.25,-589.95 19731.85,-589.95"/>
<polygon fill="black" stroke="black" points="19731.86,-593.45 19741.86,-589.95 19731.86,-586.45 19731.86,-593.45"/>
</g>
<!-- s0_q_3 -->
<g id="node43" class="node">
<title>s0_q_3</title>
<polygon fill="lightblue" stroke="black" points="22523.5,-616.45 22134.5,-616.45 22134.5,-563.45 22523.5,-563.45 22523.5,-616.45"/>
<text text-anchor="middle" x="22329" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: Q Linear</text>
<text text-anchor="middle" x="22329" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="22329" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_q_3 -->
<g id="edge48" class="edge">
<title>s0_ln0_3&#45;&gt;s0_q_3</title>
<path fill="none" stroke="black" d="M20004.25,-616.53C20046.85,-632.96 20104.76,-652.47 20158,-660.95 20265.42,-678.08 22008.63,-678.38 22116,-660.95 22164.44,-653.09 22216.76,-635.79 22257.42,-620.23"/>
<polygon fill="black" stroke="black" points="22258.91,-623.41 22266.96,-616.53 22256.38,-616.88 22258.91,-623.41"/>
</g>
<!-- s0_k_3 -->
<g id="node44" class="node">
<title>s0_k_3</title>
<polygon fill="lightblue" stroke="black" points="21535.5,-616.45 21146.5,-616.45 21146.5,-563.45 21535.5,-563.45 21535.5,-616.45"/>
<text text-anchor="middle" x="21341" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: K Linear</text>
<text text-anchor="middle" x="21341" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="21341" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_k_3 -->
<g id="edge49" class="edge">
<title>s0_ln0_3&#45;&gt;s0_k_3</title>
<path fill="none" stroke="black" d="M20004.25,-616.53C20046.85,-632.96 20104.76,-652.47 20158,-660.95 20264.43,-677.92 21021.61,-678.22 21128,-660.95 21176.44,-653.09 21228.76,-635.79 21269.42,-620.23"/>
<polygon fill="black" stroke="black" points="21270.91,-623.41 21278.96,-616.53 21268.38,-616.88 21270.91,-623.41"/>
</g>
<!-- s0_v_3 -->
<g id="node45" class="node">
<title>s0_v_3</title>
<polygon fill="lightblue" stroke="black" points="20547.5,-616.45 20158.5,-616.45 20158.5,-563.45 20547.5,-563.45 20547.5,-616.45"/>
<text text-anchor="middle" x="20353" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: V Linear</text>
<text text-anchor="middle" x="20353" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="20353" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_v_3 -->
<g id="edge50" class="edge">
<title>s0_ln0_3&#45;&gt;s0_v_3</title>
<path fill="none" stroke="black" d="M20140.16,-589.95C20142.92,-589.95 20145.69,-589.95 20148.45,-589.95"/>
<polygon fill="black" stroke="black" points="20148.45,-593.45 20158.45,-589.95 20148.45,-586.45 20148.45,-593.45"/>
</g>
<!-- s0_allgather_q_3 -->
<g id="node46" class="node">
<title>s0_allgather_q_3</title>
<ellipse fill="white" stroke="black" cx="22823" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="22823" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather Q</text>
<text text-anchor="middle" x="22823" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="22823" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_3&#45;&gt;s0_allgather_q_3 -->
<g id="edge51" class="edge">
<title>s0_q_3&#45;&gt;s0_allgather_q_3</title>
<path fill="none" stroke="black" d="M22523.9,-589.95C22526.36,-589.95 22528.83,-589.95 22531.29,-589.95"/>
<polygon fill="black" stroke="black" points="22531.42,-593.45 22541.42,-589.95 22531.42,-586.45 22531.42,-593.45"/>
</g>
<!-- s0_allgather_k_3 -->
<g id="node47" class="node">
<title>s0_allgather_k_3</title>
<ellipse fill="white" stroke="black" cx="21835" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="21835" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather K</text>
<text text-anchor="middle" x="21835" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="21835" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_3&#45;&gt;s0_allgather_k_3 -->
<g id="edge52" class="edge">
<title>s0_k_3&#45;&gt;s0_allgather_k_3</title>
<path fill="none" stroke="black" d="M21535.9,-589.95C21538.36,-589.95 21540.83,-589.95 21543.29,-589.95"/>
<polygon fill="black" stroke="black" points="21543.42,-593.45 21553.42,-589.95 21543.42,-586.45 21543.42,-593.45"/>
</g>
<!-- s0_allgather_v_3 -->
<g id="node48" class="node">
<title>s0_allgather_v_3</title>
<ellipse fill="white" stroke="black" cx="20847" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="20847" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather V</text>
<text text-anchor="middle" x="20847" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="20847" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_3&#45;&gt;s0_allgather_v_3 -->
<g id="edge53" class="edge">
<title>s0_v_3&#45;&gt;s0_allgather_v_3</title>
<path fill="none" stroke="black" d="M20547.9,-589.95C20550.36,-589.95 20552.83,-589.95 20555.29,-589.95"/>
<polygon fill="black" stroke="black" points="20555.42,-593.45 20565.42,-589.95 20555.42,-586.45 20555.42,-593.45"/>
</g>
<!-- s0_attn_3 -->
<g id="node49" class="node">
<title>s0_attn_3</title>
<polygon fill="lightblue" stroke="black" points="23520,-616.45 23122,-616.45 23122,-563.45 23520,-563.45 23520,-616.45"/>
<text text-anchor="middle" x="23321" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: Attention</text>
<text text-anchor="middle" x="23321" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="23321" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_3&#45;&gt;s0_attn_3 -->
<g id="edge54" class="edge">
<title>s0_allgather_q_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M23104.58,-589.95C23107.02,-589.95 23109.46,-589.95 23111.9,-589.95"/>
<polygon fill="black" stroke="black" points="23111.91,-593.45 23121.91,-589.95 23111.91,-586.45 23111.91,-593.45"/>
</g>
<!-- s0_allgather_k_3&#45;&gt;s0_attn_3 -->
<g id="edge55" class="edge">
<title>s0_allgather_k_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M21951.02,-624.16C22005.96,-638.63 22072.8,-653.79 22134,-660.95 22241.05,-673.49 22997.57,-677.92 23104,-660.95 23153.39,-653.08 23206.81,-635.72 23248.28,-620.14"/>
<polygon fill="black" stroke="black" points="23249.65,-623.36 23257.75,-616.53 23247.16,-616.82 23249.65,-623.36"/>
</g>
<!-- s0_allgather_v_3&#45;&gt;s0_attn_3 -->
<g id="edge56" class="edge">
<title>s0_allgather_v_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M20963.02,-624.16C21017.96,-638.63 21084.8,-653.79 21146,-660.95 21254.04,-673.6 22996.58,-678.08 23104,-660.95 23153.39,-653.08 23206.81,-635.72 23248.28,-620.14"/>
<polygon fill="black" stroke="black" points="23249.65,-623.36 23257.75,-616.53 23247.16,-616.82 23249.65,-623.36"/>
</g>
<!-- s0_gate_3 -->
<g id="node50" class="node">
<title>s0_gate_3</title>
<polygon fill="orange" stroke="black" points="24338.37,-642.95 23701.47,-642.95 23537.63,-536.95 24174.53,-536.95 24338.37,-642.95"/>
<text text-anchor="middle" x="23938" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: MoE Gate</text>
<text text-anchor="middle" x="23938" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="23938" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_3&#45;&gt;s0_gate_3 -->
<g id="edge57" class="edge">
<title>s0_attn_3&#45;&gt;s0_gate_3</title>
<path fill="none" stroke="black" d="M23520.14,-589.95C23549.84,-589.95 23579.53,-589.95 23609.23,-589.95"/>
<polygon fill="black" stroke="black" points="23609.3,-593.45 23619.3,-589.95 23609.3,-586.45 23609.3,-593.45"/>
</g>
<!-- s0_expert_3 -->
<g id="node51" class="node">
<title>s0_expert_3</title>
<polygon fill="lightblue" stroke="black" points="24754,-616.45 24356,-616.45 24356,-563.45 24754,-563.45 24754,-616.45"/>
<text text-anchor="middle" x="24555" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: Expert FFN</text>
<text text-anchor="middle" x="24555" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="24555" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_3&#45;&gt;s0_expert_3 -->
<g id="edge58" class="edge">
<title>s0_gate_3&#45;&gt;s0_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24256.74,-589.95C24286.4,-589.95 24316.06,-589.95 24345.72,-589.95"/>
<polygon fill="black" stroke="black" points="24345.77,-593.45 24355.77,-589.95 24345.77,-586.45 24345.77,-593.45"/>
</g>
<!-- s0_alltoall_3 -->
<g id="node52" class="node">
<title>s0_alltoall_3</title>
<ellipse fill="white" stroke="black" cx="25053" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="25053" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: AllToAll</text>
<text text-anchor="middle" x="25053" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="25053" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_3&#45;&gt;s0_alltoall_3 -->
<g id="edge59" class="edge">
<title>s0_expert_3&#45;&gt;s0_alltoall_3</title>
<path fill="none" stroke="black" d="M24754.39,-589.95C24756.68,-589.95 24758.98,-589.95 24761.27,-589.95"/>
<polygon fill="black" stroke="black" points="24761.31,-593.45 24771.31,-589.95 24761.31,-586.45 24761.31,-593.45"/>
</g>
<!-- s0_ln1_3 -->
<g id="node53" class="node">
<title>s0_ln1_3</title>
<polygon fill="lightblue" stroke="black" points="25750,-616.45 25352,-616.45 25352,-563.45 25750,-563.45 25750,-616.45"/>
<text text-anchor="middle" x="25551" y="-601.25" font-family="Times,serif" font-size="14.00">GPU3: LayerNorm</text>
<text text-anchor="middle" x="25551" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="25551" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_3&#45;&gt;s0_ln1_3 -->
<g id="edge60" class="edge">
<title>s0_alltoall_3&#45;&gt;s0_ln1_3</title>
<path fill="none" stroke="black" d="M25334.58,-589.95C25337.02,-589.95 25339.46,-589.95 25341.9,-589.95"/>
<polygon fill="black" stroke="black" points="25341.91,-593.45 25351.91,-589.95 25341.91,-586.45 25341.91,-593.45"/>
</g>
<!-- s1_ln0_11 -->
<g id="node142" class="node">
<title>s1_ln0_11</title>
<polygon fill="lightgreen" stroke="black" points="25750,-474.45 25352,-474.45 25352,-421.45 25750,-421.45 25750,-474.45"/>
<text text-anchor="middle" x="25551" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: LayerNorm</text>
<text text-anchor="middle" x="25551" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="25551" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_3&#45;&gt;s1_ln0_11 -->
<g id="edge124" class="edge">
<title>s0_ln1_3&#45;&gt;s1_ln0_11</title>
<path fill="none" stroke="black" d="M25551,-563.28C25551,-541.17 25551,-509.05 25551,-484.48"/>
<polygon fill="black" stroke="black" points="25554.5,-484.47 25551,-474.47 25547.5,-484.47 25554.5,-484.47"/>
</g>
<!-- s0_ln0_4 -->
<g id="node55" class="node">
<title>s0_ln0_4</title>
<polygon fill="lightblue" stroke="black" points="26582,-616.45 26184,-616.45 26184,-563.45 26582,-563.45 26582,-616.45"/>
<text text-anchor="middle" x="26383" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: LayerNorm</text>
<text text-anchor="middle" x="26383" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="26383" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_4&#45;&gt;s0_ln0_4 -->
<g id="edge62" class="edge">
<title>s0_emb_4&#45;&gt;s0_ln0_4</title>
<path fill="none" stroke="black" d="M26166.06,-589.95C26168.66,-589.95 26171.25,-589.95 26173.85,-589.95"/>
<polygon fill="black" stroke="black" points="26173.86,-593.45 26183.86,-589.95 26173.86,-586.45 26173.86,-593.45"/>
</g>
<!-- s0_q_4 -->
<g id="node56" class="node">
<title>s0_q_4</title>
<polygon fill="lightblue" stroke="black" points="28965.5,-616.45 28576.5,-616.45 28576.5,-563.45 28965.5,-563.45 28965.5,-616.45"/>
<text text-anchor="middle" x="28771" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: Q Linear</text>
<text text-anchor="middle" x="28771" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="28771" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_q_4 -->
<g id="edge63" class="edge">
<title>s0_ln0_4&#45;&gt;s0_q_4</title>
<path fill="none" stroke="black" d="M26446.25,-616.53C26488.85,-632.96 26546.76,-652.47 26600,-660.95 26707.42,-678.08 28450.63,-678.38 28558,-660.95 28606.44,-653.09 28658.76,-635.79 28699.42,-620.23"/>
<polygon fill="black" stroke="black" points="28700.91,-623.41 28708.96,-616.53 28698.38,-616.88 28700.91,-623.41"/>
</g>
<!-- s0_k_4 -->
<g id="node57" class="node">
<title>s0_k_4</title>
<polygon fill="lightblue" stroke="black" points="27977.5,-616.45 27588.5,-616.45 27588.5,-563.45 27977.5,-563.45 27977.5,-616.45"/>
<text text-anchor="middle" x="27783" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: K Linear</text>
<text text-anchor="middle" x="27783" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="27783" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_k_4 -->
<g id="edge64" class="edge">
<title>s0_ln0_4&#45;&gt;s0_k_4</title>
<path fill="none" stroke="black" d="M26446.25,-616.53C26488.85,-632.96 26546.76,-652.47 26600,-660.95 26706.43,-677.92 27463.61,-678.22 27570,-660.95 27618.44,-653.09 27670.76,-635.79 27711.42,-620.23"/>
<polygon fill="black" stroke="black" points="27712.91,-623.41 27720.96,-616.53 27710.38,-616.88 27712.91,-623.41"/>
</g>
<!-- s0_v_4 -->
<g id="node58" class="node">
<title>s0_v_4</title>
<polygon fill="lightblue" stroke="black" points="26989.5,-616.45 26600.5,-616.45 26600.5,-563.45 26989.5,-563.45 26989.5,-616.45"/>
<text text-anchor="middle" x="26795" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: V Linear</text>
<text text-anchor="middle" x="26795" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="26795" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_v_4 -->
<g id="edge65" class="edge">
<title>s0_ln0_4&#45;&gt;s0_v_4</title>
<path fill="none" stroke="black" d="M26582.16,-589.95C26584.92,-589.95 26587.69,-589.95 26590.45,-589.95"/>
<polygon fill="black" stroke="black" points="26590.45,-593.45 26600.45,-589.95 26590.45,-586.45 26590.45,-593.45"/>
</g>
<!-- s0_allgather_q_4 -->
<g id="node59" class="node">
<title>s0_allgather_q_4</title>
<ellipse fill="white" stroke="black" cx="29265" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="29265" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather Q</text>
<text text-anchor="middle" x="29265" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="29265" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_4&#45;&gt;s0_allgather_q_4 -->
<g id="edge66" class="edge">
<title>s0_q_4&#45;&gt;s0_allgather_q_4</title>
<path fill="none" stroke="black" d="M28965.9,-589.95C28968.36,-589.95 28970.83,-589.95 28973.29,-589.95"/>
<polygon fill="black" stroke="black" points="28973.42,-593.45 28983.42,-589.95 28973.42,-586.45 28973.42,-593.45"/>
</g>
<!-- s0_allgather_k_4 -->
<g id="node60" class="node">
<title>s0_allgather_k_4</title>
<ellipse fill="white" stroke="black" cx="28277" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="28277" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather K</text>
<text text-anchor="middle" x="28277" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="28277" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_4&#45;&gt;s0_allgather_k_4 -->
<g id="edge67" class="edge">
<title>s0_k_4&#45;&gt;s0_allgather_k_4</title>
<path fill="none" stroke="black" d="M27977.9,-589.95C27980.36,-589.95 27982.83,-589.95 27985.29,-589.95"/>
<polygon fill="black" stroke="black" points="27985.42,-593.45 27995.42,-589.95 27985.42,-586.45 27985.42,-593.45"/>
</g>
<!-- s0_allgather_v_4 -->
<g id="node61" class="node">
<title>s0_allgather_v_4</title>
<ellipse fill="white" stroke="black" cx="27289" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="27289" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather V</text>
<text text-anchor="middle" x="27289" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="27289" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_4&#45;&gt;s0_allgather_v_4 -->
<g id="edge68" class="edge">
<title>s0_v_4&#45;&gt;s0_allgather_v_4</title>
<path fill="none" stroke="black" d="M26989.9,-589.95C26992.36,-589.95 26994.83,-589.95 26997.29,-589.95"/>
<polygon fill="black" stroke="black" points="26997.42,-593.45 27007.42,-589.95 26997.42,-586.45 26997.42,-593.45"/>
</g>
<!-- s0_attn_4 -->
<g id="node62" class="node">
<title>s0_attn_4</title>
<polygon fill="lightblue" stroke="black" points="29962,-616.45 29564,-616.45 29564,-563.45 29962,-563.45 29962,-616.45"/>
<text text-anchor="middle" x="29763" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: Attention</text>
<text text-anchor="middle" x="29763" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="29763" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_4&#45;&gt;s0_attn_4 -->
<g id="edge69" class="edge">
<title>s0_allgather_q_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M29546.58,-589.95C29549.02,-589.95 29551.46,-589.95 29553.9,-589.95"/>
<polygon fill="black" stroke="black" points="29553.91,-593.45 29563.91,-589.95 29553.91,-586.45 29553.91,-593.45"/>
</g>
<!-- s0_allgather_k_4&#45;&gt;s0_attn_4 -->
<g id="edge70" class="edge">
<title>s0_allgather_k_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M28393.02,-624.16C28447.96,-638.63 28514.8,-653.79 28576,-660.95 28683.05,-673.49 29439.57,-677.92 29546,-660.95 29595.39,-653.08 29648.81,-635.72 29690.28,-620.14"/>
<polygon fill="black" stroke="black" points="29691.65,-623.36 29699.75,-616.53 29689.16,-616.82 29691.65,-623.36"/>
</g>
<!-- s0_allgather_v_4&#45;&gt;s0_attn_4 -->
<g id="edge71" class="edge">
<title>s0_allgather_v_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M27405.02,-624.16C27459.96,-638.63 27526.8,-653.79 27588,-660.95 27696.04,-673.6 29438.58,-678.08 29546,-660.95 29595.39,-653.08 29648.81,-635.72 29690.28,-620.14"/>
<polygon fill="black" stroke="black" points="29691.65,-623.36 29699.75,-616.53 29689.16,-616.82 29691.65,-623.36"/>
</g>
<!-- s0_gate_4 -->
<g id="node63" class="node">
<title>s0_gate_4</title>
<polygon fill="orange" stroke="black" points="30780.37,-642.95 30143.47,-642.95 29979.63,-536.95 30616.53,-536.95 30780.37,-642.95"/>
<text text-anchor="middle" x="30380" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: MoE Gate</text>
<text text-anchor="middle" x="30380" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="30380" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_4&#45;&gt;s0_gate_4 -->
<g id="edge72" class="edge">
<title>s0_attn_4&#45;&gt;s0_gate_4</title>
<path fill="none" stroke="black" d="M29962.14,-589.95C29991.84,-589.95 30021.53,-589.95 30051.23,-589.95"/>
<polygon fill="black" stroke="black" points="30051.3,-593.45 30061.3,-589.95 30051.3,-586.45 30051.3,-593.45"/>
</g>
<!-- s0_expert_4 -->
<g id="node64" class="node">
<title>s0_expert_4</title>
<polygon fill="lightblue" stroke="black" points="31196,-616.45 30798,-616.45 30798,-563.45 31196,-563.45 31196,-616.45"/>
<text text-anchor="middle" x="30997" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: Expert FFN</text>
<text text-anchor="middle" x="30997" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="30997" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_4&#45;&gt;s0_expert_4 -->
<g id="edge73" class="edge">
<title>s0_gate_4&#45;&gt;s0_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M30698.74,-589.95C30728.4,-589.95 30758.06,-589.95 30787.72,-589.95"/>
<polygon fill="black" stroke="black" points="30787.77,-593.45 30797.77,-589.95 30787.77,-586.45 30787.77,-593.45"/>
</g>
<!-- s0_alltoall_4 -->
<g id="node65" class="node">
<title>s0_alltoall_4</title>
<ellipse fill="white" stroke="black" cx="31495" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="31495" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: AllToAll</text>
<text text-anchor="middle" x="31495" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="31495" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_4&#45;&gt;s0_alltoall_4 -->
<g id="edge74" class="edge">
<title>s0_expert_4&#45;&gt;s0_alltoall_4</title>
<path fill="none" stroke="black" d="M31196.39,-589.95C31198.68,-589.95 31200.98,-589.95 31203.27,-589.95"/>
<polygon fill="black" stroke="black" points="31203.31,-593.45 31213.31,-589.95 31203.31,-586.45 31203.31,-593.45"/>
</g>
<!-- s0_ln1_4 -->
<g id="node66" class="node">
<title>s0_ln1_4</title>
<polygon fill="lightblue" stroke="black" points="32192,-616.45 31794,-616.45 31794,-563.45 32192,-563.45 32192,-616.45"/>
<text text-anchor="middle" x="31993" y="-601.25" font-family="Times,serif" font-size="14.00">GPU4: LayerNorm</text>
<text text-anchor="middle" x="31993" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="31993" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_4&#45;&gt;s0_ln1_4 -->
<g id="edge75" class="edge">
<title>s0_alltoall_4&#45;&gt;s0_ln1_4</title>
<path fill="none" stroke="black" d="M31776.58,-589.95C31779.02,-589.95 31781.46,-589.95 31783.9,-589.95"/>
<polygon fill="black" stroke="black" points="31783.91,-593.45 31793.91,-589.95 31783.91,-586.45 31783.91,-593.45"/>
</g>
<!-- s1_ln0_12 -->
<g id="node154" class="node">
<title>s1_ln0_12</title>
<polygon fill="lightgreen" stroke="black" points="32192,-474.45 31794,-474.45 31794,-421.45 32192,-421.45 32192,-474.45"/>
<text text-anchor="middle" x="31993" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: LayerNorm</text>
<text text-anchor="middle" x="31993" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="31993" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_4&#45;&gt;s1_ln0_12 -->
<g id="edge125" class="edge">
<title>s0_ln1_4&#45;&gt;s1_ln0_12</title>
<path fill="none" stroke="black" d="M31993,-563.28C31993,-541.17 31993,-509.05 31993,-484.48"/>
<polygon fill="black" stroke="black" points="31996.5,-484.47 31993,-474.47 31989.5,-484.47 31996.5,-484.47"/>
</g>
<!-- s0_ln0_5 -->
<g id="node68" class="node">
<title>s0_ln0_5</title>
<polygon fill="lightblue" stroke="black" points="33024,-616.45 32626,-616.45 32626,-563.45 33024,-563.45 33024,-616.45"/>
<text text-anchor="middle" x="32825" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: LayerNorm</text>
<text text-anchor="middle" x="32825" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="32825" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_5&#45;&gt;s0_ln0_5 -->
<g id="edge77" class="edge">
<title>s0_emb_5&#45;&gt;s0_ln0_5</title>
<path fill="none" stroke="black" d="M32608.06,-589.95C32610.66,-589.95 32613.25,-589.95 32615.85,-589.95"/>
<polygon fill="black" stroke="black" points="32615.86,-593.45 32625.86,-589.95 32615.86,-586.45 32615.86,-593.45"/>
</g>
<!-- s0_q_5 -->
<g id="node69" class="node">
<title>s0_q_5</title>
<polygon fill="lightblue" stroke="black" points="35407.5,-616.45 35018.5,-616.45 35018.5,-563.45 35407.5,-563.45 35407.5,-616.45"/>
<text text-anchor="middle" x="35213" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: Q Linear</text>
<text text-anchor="middle" x="35213" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="35213" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_q_5 -->
<g id="edge78" class="edge">
<title>s0_ln0_5&#45;&gt;s0_q_5</title>
<path fill="none" stroke="black" d="M32888.25,-616.53C32930.85,-632.96 32988.76,-652.47 33042,-660.95 33149.42,-678.08 34892.63,-678.38 35000,-660.95 35048.44,-653.09 35100.76,-635.79 35141.42,-620.23"/>
<polygon fill="black" stroke="black" points="35142.91,-623.41 35150.96,-616.53 35140.38,-616.88 35142.91,-623.41"/>
</g>
<!-- s0_k_5 -->
<g id="node70" class="node">
<title>s0_k_5</title>
<polygon fill="lightblue" stroke="black" points="34419.5,-616.45 34030.5,-616.45 34030.5,-563.45 34419.5,-563.45 34419.5,-616.45"/>
<text text-anchor="middle" x="34225" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: K Linear</text>
<text text-anchor="middle" x="34225" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="34225" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_k_5 -->
<g id="edge79" class="edge">
<title>s0_ln0_5&#45;&gt;s0_k_5</title>
<path fill="none" stroke="black" d="M32888.25,-616.53C32930.85,-632.96 32988.76,-652.47 33042,-660.95 33148.43,-677.92 33905.61,-678.22 34012,-660.95 34060.44,-653.09 34112.76,-635.79 34153.42,-620.23"/>
<polygon fill="black" stroke="black" points="34154.91,-623.41 34162.96,-616.53 34152.38,-616.88 34154.91,-623.41"/>
</g>
<!-- s0_v_5 -->
<g id="node71" class="node">
<title>s0_v_5</title>
<polygon fill="lightblue" stroke="black" points="33431.5,-616.45 33042.5,-616.45 33042.5,-563.45 33431.5,-563.45 33431.5,-616.45"/>
<text text-anchor="middle" x="33237" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: V Linear</text>
<text text-anchor="middle" x="33237" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="33237" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_v_5 -->
<g id="edge80" class="edge">
<title>s0_ln0_5&#45;&gt;s0_v_5</title>
<path fill="none" stroke="black" d="M33024.16,-589.95C33026.92,-589.95 33029.69,-589.95 33032.45,-589.95"/>
<polygon fill="black" stroke="black" points="33032.45,-593.45 33042.45,-589.95 33032.45,-586.45 33032.45,-593.45"/>
</g>
<!-- s0_allgather_q_5 -->
<g id="node72" class="node">
<title>s0_allgather_q_5</title>
<ellipse fill="white" stroke="black" cx="35707" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="35707" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather Q</text>
<text text-anchor="middle" x="35707" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="35707" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_5&#45;&gt;s0_allgather_q_5 -->
<g id="edge81" class="edge">
<title>s0_q_5&#45;&gt;s0_allgather_q_5</title>
<path fill="none" stroke="black" d="M35407.9,-589.95C35410.36,-589.95 35412.83,-589.95 35415.29,-589.95"/>
<polygon fill="black" stroke="black" points="35415.42,-593.45 35425.42,-589.95 35415.42,-586.45 35415.42,-593.45"/>
</g>
<!-- s0_allgather_k_5 -->
<g id="node73" class="node">
<title>s0_allgather_k_5</title>
<ellipse fill="white" stroke="black" cx="34719" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="34719" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather K</text>
<text text-anchor="middle" x="34719" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="34719" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_5&#45;&gt;s0_allgather_k_5 -->
<g id="edge82" class="edge">
<title>s0_k_5&#45;&gt;s0_allgather_k_5</title>
<path fill="none" stroke="black" d="M34419.9,-589.95C34422.36,-589.95 34424.83,-589.95 34427.29,-589.95"/>
<polygon fill="black" stroke="black" points="34427.42,-593.45 34437.42,-589.95 34427.42,-586.45 34427.42,-593.45"/>
</g>
<!-- s0_allgather_v_5 -->
<g id="node74" class="node">
<title>s0_allgather_v_5</title>
<ellipse fill="white" stroke="black" cx="33731" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="33731" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather V</text>
<text text-anchor="middle" x="33731" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="33731" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_5&#45;&gt;s0_allgather_v_5 -->
<g id="edge83" class="edge">
<title>s0_v_5&#45;&gt;s0_allgather_v_5</title>
<path fill="none" stroke="black" d="M33431.9,-589.95C33434.36,-589.95 33436.83,-589.95 33439.29,-589.95"/>
<polygon fill="black" stroke="black" points="33439.42,-593.45 33449.42,-589.95 33439.42,-586.45 33439.42,-593.45"/>
</g>
<!-- s0_attn_5 -->
<g id="node75" class="node">
<title>s0_attn_5</title>
<polygon fill="lightblue" stroke="black" points="36404,-616.45 36006,-616.45 36006,-563.45 36404,-563.45 36404,-616.45"/>
<text text-anchor="middle" x="36205" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: Attention</text>
<text text-anchor="middle" x="36205" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="36205" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_5&#45;&gt;s0_attn_5 -->
<g id="edge84" class="edge">
<title>s0_allgather_q_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M35988.58,-589.95C35991.02,-589.95 35993.46,-589.95 35995.9,-589.95"/>
<polygon fill="black" stroke="black" points="35995.91,-593.45 36005.91,-589.95 35995.91,-586.45 35995.91,-593.45"/>
</g>
<!-- s0_allgather_k_5&#45;&gt;s0_attn_5 -->
<g id="edge85" class="edge">
<title>s0_allgather_k_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M34835.02,-624.16C34889.96,-638.63 34956.8,-653.79 35018,-660.95 35125.05,-673.49 35881.57,-677.92 35988,-660.95 36037.39,-653.08 36090.81,-635.72 36132.28,-620.14"/>
<polygon fill="black" stroke="black" points="36133.65,-623.36 36141.75,-616.53 36131.16,-616.82 36133.65,-623.36"/>
</g>
<!-- s0_allgather_v_5&#45;&gt;s0_attn_5 -->
<g id="edge86" class="edge">
<title>s0_allgather_v_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M33847.02,-624.16C33901.96,-638.63 33968.8,-653.79 34030,-660.95 34138.04,-673.6 35880.58,-678.08 35988,-660.95 36037.39,-653.08 36090.81,-635.72 36132.28,-620.14"/>
<polygon fill="black" stroke="black" points="36133.65,-623.36 36141.75,-616.53 36131.16,-616.82 36133.65,-623.36"/>
</g>
<!-- s0_gate_5 -->
<g id="node76" class="node">
<title>s0_gate_5</title>
<polygon fill="orange" stroke="black" points="37222.37,-642.95 36585.47,-642.95 36421.63,-536.95 37058.53,-536.95 37222.37,-642.95"/>
<text text-anchor="middle" x="36822" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: MoE Gate</text>
<text text-anchor="middle" x="36822" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="36822" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_5&#45;&gt;s0_gate_5 -->
<g id="edge87" class="edge">
<title>s0_attn_5&#45;&gt;s0_gate_5</title>
<path fill="none" stroke="black" d="M36404.14,-589.95C36433.84,-589.95 36463.53,-589.95 36493.23,-589.95"/>
<polygon fill="black" stroke="black" points="36493.3,-593.45 36503.3,-589.95 36493.3,-586.45 36493.3,-593.45"/>
</g>
<!-- s0_expert_5 -->
<g id="node77" class="node">
<title>s0_expert_5</title>
<polygon fill="lightblue" stroke="black" points="37638,-616.45 37240,-616.45 37240,-563.45 37638,-563.45 37638,-616.45"/>
<text text-anchor="middle" x="37439" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: Expert FFN</text>
<text text-anchor="middle" x="37439" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="37439" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_5&#45;&gt;s0_expert_5 -->
<g id="edge88" class="edge">
<title>s0_gate_5&#45;&gt;s0_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M37140.74,-589.95C37170.4,-589.95 37200.06,-589.95 37229.72,-589.95"/>
<polygon fill="black" stroke="black" points="37229.77,-593.45 37239.77,-589.95 37229.77,-586.45 37229.77,-593.45"/>
</g>
<!-- s0_alltoall_5 -->
<g id="node78" class="node">
<title>s0_alltoall_5</title>
<ellipse fill="white" stroke="black" cx="37937" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="37937" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: AllToAll</text>
<text text-anchor="middle" x="37937" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="37937" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_5&#45;&gt;s0_alltoall_5 -->
<g id="edge89" class="edge">
<title>s0_expert_5&#45;&gt;s0_alltoall_5</title>
<path fill="none" stroke="black" d="M37638.39,-589.95C37640.68,-589.95 37642.98,-589.95 37645.27,-589.95"/>
<polygon fill="black" stroke="black" points="37645.31,-593.45 37655.31,-589.95 37645.31,-586.45 37645.31,-593.45"/>
</g>
<!-- s0_ln1_5 -->
<g id="node79" class="node">
<title>s0_ln1_5</title>
<polygon fill="lightblue" stroke="black" points="38634,-616.45 38236,-616.45 38236,-563.45 38634,-563.45 38634,-616.45"/>
<text text-anchor="middle" x="38435" y="-601.25" font-family="Times,serif" font-size="14.00">GPU5: LayerNorm</text>
<text text-anchor="middle" x="38435" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="38435" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_5&#45;&gt;s0_ln1_5 -->
<g id="edge90" class="edge">
<title>s0_alltoall_5&#45;&gt;s0_ln1_5</title>
<path fill="none" stroke="black" d="M38218.58,-589.95C38221.02,-589.95 38223.46,-589.95 38225.9,-589.95"/>
<polygon fill="black" stroke="black" points="38225.91,-593.45 38235.91,-589.95 38225.91,-586.45 38225.91,-593.45"/>
</g>
<!-- s1_ln0_13 -->
<g id="node166" class="node">
<title>s1_ln0_13</title>
<polygon fill="lightgreen" stroke="black" points="38634,-474.45 38236,-474.45 38236,-421.45 38634,-421.45 38634,-474.45"/>
<text text-anchor="middle" x="38435" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: LayerNorm</text>
<text text-anchor="middle" x="38435" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="38435" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_5&#45;&gt;s1_ln0_13 -->
<g id="edge126" class="edge">
<title>s0_ln1_5&#45;&gt;s1_ln0_13</title>
<path fill="none" stroke="black" d="M38435,-563.28C38435,-541.17 38435,-509.05 38435,-484.48"/>
<polygon fill="black" stroke="black" points="38438.5,-484.47 38435,-474.47 38431.5,-484.47 38438.5,-484.47"/>
</g>
<!-- s0_ln0_6 -->
<g id="node81" class="node">
<title>s0_ln0_6</title>
<polygon fill="lightblue" stroke="black" points="39466,-616.45 39068,-616.45 39068,-563.45 39466,-563.45 39466,-616.45"/>
<text text-anchor="middle" x="39267" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: LayerNorm</text>
<text text-anchor="middle" x="39267" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="39267" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_6&#45;&gt;s0_ln0_6 -->
<g id="edge92" class="edge">
<title>s0_emb_6&#45;&gt;s0_ln0_6</title>
<path fill="none" stroke="black" d="M39050.06,-589.95C39052.66,-589.95 39055.25,-589.95 39057.85,-589.95"/>
<polygon fill="black" stroke="black" points="39057.86,-593.45 39067.86,-589.95 39057.86,-586.45 39057.86,-593.45"/>
</g>
<!-- s0_q_6 -->
<g id="node82" class="node">
<title>s0_q_6</title>
<polygon fill="lightblue" stroke="black" points="41849.5,-616.45 41460.5,-616.45 41460.5,-563.45 41849.5,-563.45 41849.5,-616.45"/>
<text text-anchor="middle" x="41655" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: Q Linear</text>
<text text-anchor="middle" x="41655" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="41655" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_q_6 -->
<g id="edge93" class="edge">
<title>s0_ln0_6&#45;&gt;s0_q_6</title>
<path fill="none" stroke="black" d="M39330.25,-616.53C39372.85,-632.96 39430.76,-652.47 39484,-660.95 39591.42,-678.08 41334.63,-678.38 41442,-660.95 41490.44,-653.09 41542.76,-635.79 41583.42,-620.23"/>
<polygon fill="black" stroke="black" points="41584.91,-623.41 41592.96,-616.53 41582.38,-616.88 41584.91,-623.41"/>
</g>
<!-- s0_k_6 -->
<g id="node83" class="node">
<title>s0_k_6</title>
<polygon fill="lightblue" stroke="black" points="40861.5,-616.45 40472.5,-616.45 40472.5,-563.45 40861.5,-563.45 40861.5,-616.45"/>
<text text-anchor="middle" x="40667" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: K Linear</text>
<text text-anchor="middle" x="40667" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="40667" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_k_6 -->
<g id="edge94" class="edge">
<title>s0_ln0_6&#45;&gt;s0_k_6</title>
<path fill="none" stroke="black" d="M39330.25,-616.53C39372.85,-632.96 39430.76,-652.47 39484,-660.95 39590.43,-677.92 40347.61,-678.22 40454,-660.95 40502.44,-653.09 40554.76,-635.79 40595.42,-620.23"/>
<polygon fill="black" stroke="black" points="40596.91,-623.41 40604.96,-616.53 40594.38,-616.88 40596.91,-623.41"/>
</g>
<!-- s0_v_6 -->
<g id="node84" class="node">
<title>s0_v_6</title>
<polygon fill="lightblue" stroke="black" points="39873.5,-616.45 39484.5,-616.45 39484.5,-563.45 39873.5,-563.45 39873.5,-616.45"/>
<text text-anchor="middle" x="39679" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: V Linear</text>
<text text-anchor="middle" x="39679" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="39679" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_v_6 -->
<g id="edge95" class="edge">
<title>s0_ln0_6&#45;&gt;s0_v_6</title>
<path fill="none" stroke="black" d="M39466.16,-589.95C39468.92,-589.95 39471.69,-589.95 39474.45,-589.95"/>
<polygon fill="black" stroke="black" points="39474.45,-593.45 39484.45,-589.95 39474.45,-586.45 39474.45,-593.45"/>
</g>
<!-- s0_allgather_q_6 -->
<g id="node85" class="node">
<title>s0_allgather_q_6</title>
<ellipse fill="white" stroke="black" cx="42149" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="42149" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather Q</text>
<text text-anchor="middle" x="42149" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="42149" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_6&#45;&gt;s0_allgather_q_6 -->
<g id="edge96" class="edge">
<title>s0_q_6&#45;&gt;s0_allgather_q_6</title>
<path fill="none" stroke="black" d="M41849.9,-589.95C41852.36,-589.95 41854.83,-589.95 41857.29,-589.95"/>
<polygon fill="black" stroke="black" points="41857.42,-593.45 41867.42,-589.95 41857.42,-586.45 41857.42,-593.45"/>
</g>
<!-- s0_allgather_k_6 -->
<g id="node86" class="node">
<title>s0_allgather_k_6</title>
<ellipse fill="white" stroke="black" cx="41161" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="41161" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather K</text>
<text text-anchor="middle" x="41161" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="41161" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_6&#45;&gt;s0_allgather_k_6 -->
<g id="edge97" class="edge">
<title>s0_k_6&#45;&gt;s0_allgather_k_6</title>
<path fill="none" stroke="black" d="M40861.9,-589.95C40864.36,-589.95 40866.83,-589.95 40869.29,-589.95"/>
<polygon fill="black" stroke="black" points="40869.42,-593.45 40879.42,-589.95 40869.42,-586.45 40869.42,-593.45"/>
</g>
<!-- s0_allgather_v_6 -->
<g id="node87" class="node">
<title>s0_allgather_v_6</title>
<ellipse fill="white" stroke="black" cx="40173" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="40173" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather V</text>
<text text-anchor="middle" x="40173" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="40173" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_6&#45;&gt;s0_allgather_v_6 -->
<g id="edge98" class="edge">
<title>s0_v_6&#45;&gt;s0_allgather_v_6</title>
<path fill="none" stroke="black" d="M39873.9,-589.95C39876.36,-589.95 39878.83,-589.95 39881.29,-589.95"/>
<polygon fill="black" stroke="black" points="39881.42,-593.45 39891.42,-589.95 39881.42,-586.45 39881.42,-593.45"/>
</g>
<!-- s0_attn_6 -->
<g id="node88" class="node">
<title>s0_attn_6</title>
<polygon fill="lightblue" stroke="black" points="42846,-616.45 42448,-616.45 42448,-563.45 42846,-563.45 42846,-616.45"/>
<text text-anchor="middle" x="42647" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: Attention</text>
<text text-anchor="middle" x="42647" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="42647" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_6&#45;&gt;s0_attn_6 -->
<g id="edge99" class="edge">
<title>s0_allgather_q_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M42430.58,-589.95C42433.02,-589.95 42435.46,-589.95 42437.9,-589.95"/>
<polygon fill="black" stroke="black" points="42437.91,-593.45 42447.91,-589.95 42437.91,-586.45 42437.91,-593.45"/>
</g>
<!-- s0_allgather_k_6&#45;&gt;s0_attn_6 -->
<g id="edge100" class="edge">
<title>s0_allgather_k_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M41277.02,-624.16C41331.96,-638.63 41398.8,-653.79 41460,-660.95 41567.05,-673.49 42323.57,-677.92 42430,-660.95 42479.39,-653.08 42532.81,-635.72 42574.28,-620.14"/>
<polygon fill="black" stroke="black" points="42575.65,-623.36 42583.75,-616.53 42573.16,-616.82 42575.65,-623.36"/>
</g>
<!-- s0_allgather_v_6&#45;&gt;s0_attn_6 -->
<g id="edge101" class="edge">
<title>s0_allgather_v_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M40289.02,-624.16C40343.96,-638.63 40410.8,-653.79 40472,-660.95 40580.04,-673.6 42322.58,-678.08 42430,-660.95 42479.39,-653.08 42532.81,-635.72 42574.28,-620.14"/>
<polygon fill="black" stroke="black" points="42575.65,-623.36 42583.75,-616.53 42573.16,-616.82 42575.65,-623.36"/>
</g>
<!-- s0_gate_6 -->
<g id="node89" class="node">
<title>s0_gate_6</title>
<polygon fill="orange" stroke="black" points="43664.37,-642.95 43027.47,-642.95 42863.63,-536.95 43500.53,-536.95 43664.37,-642.95"/>
<text text-anchor="middle" x="43264" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: MoE Gate</text>
<text text-anchor="middle" x="43264" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="43264" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_6&#45;&gt;s0_gate_6 -->
<g id="edge102" class="edge">
<title>s0_attn_6&#45;&gt;s0_gate_6</title>
<path fill="none" stroke="black" d="M42846.14,-589.95C42875.84,-589.95 42905.53,-589.95 42935.23,-589.95"/>
<polygon fill="black" stroke="black" points="42935.3,-593.45 42945.3,-589.95 42935.3,-586.45 42935.3,-593.45"/>
</g>
<!-- s0_expert_6 -->
<g id="node90" class="node">
<title>s0_expert_6</title>
<polygon fill="lightblue" stroke="black" points="44080,-616.45 43682,-616.45 43682,-563.45 44080,-563.45 44080,-616.45"/>
<text text-anchor="middle" x="43881" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: Expert FFN</text>
<text text-anchor="middle" x="43881" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="43881" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_6&#45;&gt;s0_expert_6 -->
<g id="edge103" class="edge">
<title>s0_gate_6&#45;&gt;s0_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M43582.74,-589.95C43612.4,-589.95 43642.06,-589.95 43671.72,-589.95"/>
<polygon fill="black" stroke="black" points="43671.77,-593.45 43681.77,-589.95 43671.77,-586.45 43671.77,-593.45"/>
</g>
<!-- s0_alltoall_6 -->
<g id="node91" class="node">
<title>s0_alltoall_6</title>
<ellipse fill="white" stroke="black" cx="44379" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="44379" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: AllToAll</text>
<text text-anchor="middle" x="44379" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="44379" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_6&#45;&gt;s0_alltoall_6 -->
<g id="edge104" class="edge">
<title>s0_expert_6&#45;&gt;s0_alltoall_6</title>
<path fill="none" stroke="black" d="M44080.39,-589.95C44082.68,-589.95 44084.98,-589.95 44087.27,-589.95"/>
<polygon fill="black" stroke="black" points="44087.31,-593.45 44097.31,-589.95 44087.31,-586.45 44087.31,-593.45"/>
</g>
<!-- s0_ln1_6 -->
<g id="node92" class="node">
<title>s0_ln1_6</title>
<polygon fill="lightblue" stroke="black" points="45076,-616.45 44678,-616.45 44678,-563.45 45076,-563.45 45076,-616.45"/>
<text text-anchor="middle" x="44877" y="-601.25" font-family="Times,serif" font-size="14.00">GPU6: LayerNorm</text>
<text text-anchor="middle" x="44877" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="44877" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_6&#45;&gt;s0_ln1_6 -->
<g id="edge105" class="edge">
<title>s0_alltoall_6&#45;&gt;s0_ln1_6</title>
<path fill="none" stroke="black" d="M44660.58,-589.95C44663.02,-589.95 44665.46,-589.95 44667.9,-589.95"/>
<polygon fill="black" stroke="black" points="44667.91,-593.45 44677.91,-589.95 44667.91,-586.45 44667.91,-593.45"/>
</g>
<!-- s1_ln0_14 -->
<g id="node178" class="node">
<title>s1_ln0_14</title>
<polygon fill="lightgreen" stroke="black" points="45076,-474.45 44678,-474.45 44678,-421.45 45076,-421.45 45076,-474.45"/>
<text text-anchor="middle" x="44877" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: LayerNorm</text>
<text text-anchor="middle" x="44877" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="44877" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_6&#45;&gt;s1_ln0_14 -->
<g id="edge127" class="edge">
<title>s0_ln1_6&#45;&gt;s1_ln0_14</title>
<path fill="none" stroke="black" d="M44877,-563.28C44877,-541.17 44877,-509.05 44877,-484.48"/>
<polygon fill="black" stroke="black" points="44880.5,-484.47 44877,-474.47 44873.5,-484.47 44880.5,-484.47"/>
</g>
<!-- s0_ln0_7 -->
<g id="node94" class="node">
<title>s0_ln0_7</title>
<polygon fill="lightblue" stroke="black" points="45908,-616.45 45510,-616.45 45510,-563.45 45908,-563.45 45908,-616.45"/>
<text text-anchor="middle" x="45709" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: LayerNorm</text>
<text text-anchor="middle" x="45709" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="45709" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_emb_7&#45;&gt;s0_ln0_7 -->
<g id="edge107" class="edge">
<title>s0_emb_7&#45;&gt;s0_ln0_7</title>
<path fill="none" stroke="black" d="M45492.06,-589.95C45494.66,-589.95 45497.25,-589.95 45499.85,-589.95"/>
<polygon fill="black" stroke="black" points="45499.86,-593.45 45509.86,-589.95 45499.86,-586.45 45499.86,-593.45"/>
</g>
<!-- s0_q_7 -->
<g id="node95" class="node">
<title>s0_q_7</title>
<polygon fill="lightblue" stroke="black" points="48291.5,-616.45 47902.5,-616.45 47902.5,-563.45 48291.5,-563.45 48291.5,-616.45"/>
<text text-anchor="middle" x="48097" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: Q Linear</text>
<text text-anchor="middle" x="48097" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="48097" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_q_7 -->
<g id="edge108" class="edge">
<title>s0_ln0_7&#45;&gt;s0_q_7</title>
<path fill="none" stroke="black" d="M45772.25,-616.53C45814.85,-632.96 45872.76,-652.47 45926,-660.95 46033.42,-678.08 47776.63,-678.38 47884,-660.95 47932.44,-653.09 47984.76,-635.79 48025.42,-620.23"/>
<polygon fill="black" stroke="black" points="48026.91,-623.41 48034.96,-616.53 48024.38,-616.88 48026.91,-623.41"/>
</g>
<!-- s0_k_7 -->
<g id="node96" class="node">
<title>s0_k_7</title>
<polygon fill="lightblue" stroke="black" points="47303.5,-616.45 46914.5,-616.45 46914.5,-563.45 47303.5,-563.45 47303.5,-616.45"/>
<text text-anchor="middle" x="47109" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: K Linear</text>
<text text-anchor="middle" x="47109" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="47109" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_k_7 -->
<g id="edge109" class="edge">
<title>s0_ln0_7&#45;&gt;s0_k_7</title>
<path fill="none" stroke="black" d="M45772.25,-616.53C45814.85,-632.96 45872.76,-652.47 45926,-660.95 46032.43,-677.92 46789.61,-678.22 46896,-660.95 46944.44,-653.09 46996.76,-635.79 47037.42,-620.23"/>
<polygon fill="black" stroke="black" points="47038.91,-623.41 47046.96,-616.53 47036.38,-616.88 47038.91,-623.41"/>
</g>
<!-- s0_v_7 -->
<g id="node97" class="node">
<title>s0_v_7</title>
<polygon fill="lightblue" stroke="black" points="46315.5,-616.45 45926.5,-616.45 45926.5,-563.45 46315.5,-563.45 46315.5,-616.45"/>
<text text-anchor="middle" x="46121" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: V Linear</text>
<text text-anchor="middle" x="46121" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="46121" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_v_7 -->
<g id="edge110" class="edge">
<title>s0_ln0_7&#45;&gt;s0_v_7</title>
<path fill="none" stroke="black" d="M45908.16,-589.95C45910.92,-589.95 45913.69,-589.95 45916.45,-589.95"/>
<polygon fill="black" stroke="black" points="45916.45,-593.45 45926.45,-589.95 45916.45,-586.45 45916.45,-593.45"/>
</g>
<!-- s0_allgather_q_7 -->
<g id="node98" class="node">
<title>s0_allgather_q_7</title>
<ellipse fill="white" stroke="black" cx="48591" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="48591" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather Q</text>
<text text-anchor="middle" x="48591" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="48591" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_q_7&#45;&gt;s0_allgather_q_7 -->
<g id="edge111" class="edge">
<title>s0_q_7&#45;&gt;s0_allgather_q_7</title>
<path fill="none" stroke="black" d="M48291.9,-589.95C48294.36,-589.95 48296.83,-589.95 48299.29,-589.95"/>
<polygon fill="black" stroke="black" points="48299.42,-593.45 48309.42,-589.95 48299.42,-586.45 48299.42,-593.45"/>
</g>
<!-- s0_allgather_k_7 -->
<g id="node99" class="node">
<title>s0_allgather_k_7</title>
<ellipse fill="white" stroke="black" cx="47603" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="47603" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather K</text>
<text text-anchor="middle" x="47603" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="47603" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_k_7&#45;&gt;s0_allgather_k_7 -->
<g id="edge112" class="edge">
<title>s0_k_7&#45;&gt;s0_allgather_k_7</title>
<path fill="none" stroke="black" d="M47303.9,-589.95C47306.36,-589.95 47308.83,-589.95 47311.29,-589.95"/>
<polygon fill="black" stroke="black" points="47311.42,-593.45 47321.42,-589.95 47311.42,-586.45 47311.42,-593.45"/>
</g>
<!-- s0_allgather_v_7 -->
<g id="node100" class="node">
<title>s0_allgather_v_7</title>
<ellipse fill="white" stroke="black" cx="46615" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="46615" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather V</text>
<text text-anchor="middle" x="46615" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="46615" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_v_7&#45;&gt;s0_allgather_v_7 -->
<g id="edge113" class="edge">
<title>s0_v_7&#45;&gt;s0_allgather_v_7</title>
<path fill="none" stroke="black" d="M46315.9,-589.95C46318.36,-589.95 46320.83,-589.95 46323.29,-589.95"/>
<polygon fill="black" stroke="black" points="46323.42,-593.45 46333.42,-589.95 46323.42,-586.45 46323.42,-593.45"/>
</g>
<!-- s0_attn_7 -->
<g id="node101" class="node">
<title>s0_attn_7</title>
<polygon fill="lightblue" stroke="black" points="49288,-616.45 48890,-616.45 48890,-563.45 49288,-563.45 49288,-616.45"/>
<text text-anchor="middle" x="49089" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: Attention</text>
<text text-anchor="middle" x="49089" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="49089" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_allgather_q_7&#45;&gt;s0_attn_7 -->
<g id="edge114" class="edge">
<title>s0_allgather_q_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M48872.58,-589.95C48875.02,-589.95 48877.46,-589.95 48879.9,-589.95"/>
<polygon fill="black" stroke="black" points="48879.91,-593.45 48889.91,-589.95 48879.91,-586.45 48879.91,-593.45"/>
</g>
<!-- s0_allgather_k_7&#45;&gt;s0_attn_7 -->
<g id="edge115" class="edge">
<title>s0_allgather_k_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M47719.02,-624.16C47773.96,-638.63 47840.8,-653.79 47902,-660.95 48009.05,-673.49 48765.57,-677.92 48872,-660.95 48921.39,-653.08 48974.81,-635.72 49016.28,-620.14"/>
<polygon fill="black" stroke="black" points="49017.65,-623.36 49025.75,-616.53 49015.16,-616.82 49017.65,-623.36"/>
</g>
<!-- s0_allgather_v_7&#45;&gt;s0_attn_7 -->
<g id="edge116" class="edge">
<title>s0_allgather_v_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M46731.02,-624.16C46785.96,-638.63 46852.8,-653.79 46914,-660.95 47022.04,-673.6 48764.58,-678.08 48872,-660.95 48921.39,-653.08 48974.81,-635.72 49016.28,-620.14"/>
<polygon fill="black" stroke="black" points="49017.65,-623.36 49025.75,-616.53 49015.16,-616.82 49017.65,-623.36"/>
</g>
<!-- s0_gate_7 -->
<g id="node102" class="node">
<title>s0_gate_7</title>
<polygon fill="orange" stroke="black" points="50106.37,-642.95 49469.47,-642.95 49305.63,-536.95 49942.53,-536.95 50106.37,-642.95"/>
<text text-anchor="middle" x="49706" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: MoE Gate</text>
<text text-anchor="middle" x="49706" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="49706" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s0_attn_7&#45;&gt;s0_gate_7 -->
<g id="edge117" class="edge">
<title>s0_attn_7&#45;&gt;s0_gate_7</title>
<path fill="none" stroke="black" d="M49288.14,-589.95C49317.84,-589.95 49347.53,-589.95 49377.23,-589.95"/>
<polygon fill="black" stroke="black" points="49377.3,-593.45 49387.3,-589.95 49377.3,-586.45 49377.3,-593.45"/>
</g>
<!-- s0_expert_7 -->
<g id="node103" class="node">
<title>s0_expert_7</title>
<polygon fill="lightblue" stroke="black" points="50522,-616.45 50124,-616.45 50124,-563.45 50522,-563.45 50522,-616.45"/>
<text text-anchor="middle" x="50323" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: Expert FFN</text>
<text text-anchor="middle" x="50323" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="50323" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_gate_7&#45;&gt;s0_expert_7 -->
<g id="edge118" class="edge">
<title>s0_gate_7&#45;&gt;s0_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M50024.74,-589.95C50054.4,-589.95 50084.06,-589.95 50113.72,-589.95"/>
<polygon fill="black" stroke="black" points="50113.77,-593.45 50123.77,-589.95 50113.77,-586.45 50113.77,-593.45"/>
</g>
<!-- s0_alltoall_7 -->
<g id="node104" class="node">
<title>s0_alltoall_7</title>
<ellipse fill="white" stroke="black" cx="50821" cy="-589.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="50821" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: AllToAll</text>
<text text-anchor="middle" x="50821" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="50821" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_expert_7&#45;&gt;s0_alltoall_7 -->
<g id="edge119" class="edge">
<title>s0_expert_7&#45;&gt;s0_alltoall_7</title>
<path fill="none" stroke="black" d="M50522.39,-589.95C50524.68,-589.95 50526.98,-589.95 50529.27,-589.95"/>
<polygon fill="black" stroke="black" points="50529.31,-593.45 50539.31,-589.95 50529.31,-586.45 50529.31,-593.45"/>
</g>
<!-- s0_ln1_7 -->
<g id="node105" class="node">
<title>s0_ln1_7</title>
<polygon fill="lightblue" stroke="black" points="51518,-616.45 51120,-616.45 51120,-563.45 51518,-563.45 51518,-616.45"/>
<text text-anchor="middle" x="51319" y="-601.25" font-family="Times,serif" font-size="14.00">GPU7: LayerNorm</text>
<text text-anchor="middle" x="51319" y="-586.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="51319" y="-571.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_alltoall_7&#45;&gt;s0_ln1_7 -->
<g id="edge120" class="edge">
<title>s0_alltoall_7&#45;&gt;s0_ln1_7</title>
<path fill="none" stroke="black" d="M51102.58,-589.95C51105.02,-589.95 51107.46,-589.95 51109.9,-589.95"/>
<polygon fill="black" stroke="black" points="51109.91,-593.45 51119.91,-589.95 51109.91,-586.45 51109.91,-593.45"/>
</g>
<!-- s1_ln0_15 -->
<g id="node190" class="node">
<title>s1_ln0_15</title>
<polygon fill="lightgreen" stroke="black" points="51518,-474.45 51120,-474.45 51120,-421.45 51518,-421.45 51518,-474.45"/>
<text text-anchor="middle" x="51319" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: LayerNorm</text>
<text text-anchor="middle" x="51319" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="51319" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s0_ln1_7&#45;&gt;s1_ln0_15 -->
<g id="edge128" class="edge">
<title>s0_ln1_7&#45;&gt;s1_ln0_15</title>
<path fill="none" stroke="black" d="M51319,-563.28C51319,-541.17 51319,-509.05 51319,-484.48"/>
<polygon fill="black" stroke="black" points="51322.5,-484.47 51319,-474.47 51315.5,-484.47 51322.5,-484.47"/>
</g>
<!-- s1_q_8 -->
<g id="node107" class="node">
<title>s1_q_8</title>
<polygon fill="lightgreen" stroke="black" points="51925.5,-474.45 51536.5,-474.45 51536.5,-421.45 51925.5,-421.45 51925.5,-474.45"/>
<text text-anchor="middle" x="51731" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: Q Linear</text>
<text text-anchor="middle" x="51731" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="51731" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_8 -->
<g id="node108" class="node">
<title>s1_k_8</title>
<polygon fill="lightgreen" stroke="black" points="52332.5,-474.45 51943.5,-474.45 51943.5,-421.45 52332.5,-421.45 52332.5,-474.45"/>
<text text-anchor="middle" x="52138" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: K Linear</text>
<text text-anchor="middle" x="52138" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="52138" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_8 -->
<g id="node109" class="node">
<title>s1_v_8</title>
<polygon fill="lightgreen" stroke="black" points="52739.5,-474.45 52350.5,-474.45 52350.5,-421.45 52739.5,-421.45 52739.5,-474.45"/>
<text text-anchor="middle" x="52545" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: V Linear</text>
<text text-anchor="middle" x="52545" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="52545" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_8 -->
<g id="node110" class="node">
<title>s1_allgather_q_8</title>
<ellipse fill="white" stroke="black" cx="53039" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="53039" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather Q</text>
<text text-anchor="middle" x="53039" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="53039" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_8 -->
<g id="node111" class="node">
<title>s1_allgather_k_8</title>
<ellipse fill="white" stroke="black" cx="53620" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="53620" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather K</text>
<text text-anchor="middle" x="53620" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="53620" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_8 -->
<g id="node112" class="node">
<title>s1_allgather_v_8</title>
<ellipse fill="white" stroke="black" cx="54201" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="54201" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather V</text>
<text text-anchor="middle" x="54201" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="54201" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_8 -->
<g id="node113" class="node">
<title>s1_attn_8</title>
<polygon fill="lightgreen" stroke="black" points="54898,-474.45 54500,-474.45 54500,-421.45 54898,-421.45 54898,-474.45"/>
<text text-anchor="middle" x="54699" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: Attention</text>
<text text-anchor="middle" x="54699" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="54699" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_8 -->
<g id="node114" class="node">
<title>s1_gate_8</title>
<polygon fill="orange" stroke="black" points="55716.37,-500.95 55079.47,-500.95 54915.63,-394.95 55552.53,-394.95 55716.37,-500.95"/>
<text text-anchor="middle" x="55316" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: MoE Gate</text>
<text text-anchor="middle" x="55316" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="55316" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_8 -->
<g id="node115" class="node">
<title>s1_expert_8</title>
<polygon fill="lightgreen" stroke="black" points="56132,-474.45 55734,-474.45 55734,-421.45 56132,-421.45 56132,-474.45"/>
<text text-anchor="middle" x="55933" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: Expert FFN</text>
<text text-anchor="middle" x="55933" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="55933" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_8 -->
<g id="node116" class="node">
<title>s1_alltoall_8</title>
<ellipse fill="white" stroke="black" cx="56431" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="56431" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: AllToAll</text>
<text text-anchor="middle" x="56431" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="56431" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_8 -->
<g id="node117" class="node">
<title>s1_ln1_8</title>
<polygon fill="lightgreen" stroke="black" points="57128,-474.45 56730,-474.45 56730,-421.45 57128,-421.45 57128,-474.45"/>
<text text-anchor="middle" x="56929" y="-459.25" font-family="Times,serif" font-size="14.00">GPU8: LayerNorm</text>
<text text-anchor="middle" x="56929" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="56929" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_16 -->
<g id="node202" class="node">
<title>s2_ln0_16</title>
<polygon fill="lightyellow" stroke="black" points="57128,-332.45 56730,-332.45 56730,-279.45 57128,-279.45 57128,-332.45"/>
<text text-anchor="middle" x="56929" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: LayerNorm</text>
<text text-anchor="middle" x="56929" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="56929" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_8&#45;&gt;s2_ln0_16 -->
<g id="edge129" class="edge">
<title>s1_ln1_8&#45;&gt;s2_ln0_16</title>
<path fill="none" stroke="black" d="M56929,-421.28C56929,-399.17 56929,-367.05 56929,-342.48"/>
<polygon fill="black" stroke="black" points="56932.5,-342.47 56929,-332.47 56925.5,-342.47 56932.5,-342.47"/>
</g>
<!-- s1_q_9 -->
<g id="node119" class="node">
<title>s1_q_9</title>
<polygon fill="lightgreen" stroke="black" points="57535.5,-474.45 57146.5,-474.45 57146.5,-421.45 57535.5,-421.45 57535.5,-474.45"/>
<text text-anchor="middle" x="57341" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: Q Linear</text>
<text text-anchor="middle" x="57341" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="57341" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_9 -->
<g id="node120" class="node">
<title>s1_k_9</title>
<polygon fill="lightgreen" stroke="black" points="57942.5,-474.45 57553.5,-474.45 57553.5,-421.45 57942.5,-421.45 57942.5,-474.45"/>
<text text-anchor="middle" x="57748" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: K Linear</text>
<text text-anchor="middle" x="57748" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="57748" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_9 -->
<g id="node121" class="node">
<title>s1_v_9</title>
<polygon fill="lightgreen" stroke="black" points="58349.5,-474.45 57960.5,-474.45 57960.5,-421.45 58349.5,-421.45 58349.5,-474.45"/>
<text text-anchor="middle" x="58155" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: V Linear</text>
<text text-anchor="middle" x="58155" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="58155" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_9 -->
<g id="node122" class="node">
<title>s1_allgather_q_9</title>
<ellipse fill="white" stroke="black" cx="58649" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="58649" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather Q</text>
<text text-anchor="middle" x="58649" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="58649" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_9 -->
<g id="node123" class="node">
<title>s1_allgather_k_9</title>
<ellipse fill="white" stroke="black" cx="59230" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="59230" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather K</text>
<text text-anchor="middle" x="59230" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="59230" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_9 -->
<g id="node124" class="node">
<title>s1_allgather_v_9</title>
<ellipse fill="white" stroke="black" cx="59811" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="59811" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather V</text>
<text text-anchor="middle" x="59811" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="59811" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_9 -->
<g id="node125" class="node">
<title>s1_attn_9</title>
<polygon fill="lightgreen" stroke="black" points="60508,-474.45 60110,-474.45 60110,-421.45 60508,-421.45 60508,-474.45"/>
<text text-anchor="middle" x="60309" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: Attention</text>
<text text-anchor="middle" x="60309" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="60309" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_9 -->
<g id="node126" class="node">
<title>s1_gate_9</title>
<polygon fill="orange" stroke="black" points="61326.37,-500.95 60689.47,-500.95 60525.63,-394.95 61162.53,-394.95 61326.37,-500.95"/>
<text text-anchor="middle" x="60926" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: MoE Gate</text>
<text text-anchor="middle" x="60926" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="60926" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_9 -->
<g id="node127" class="node">
<title>s1_expert_9</title>
<polygon fill="lightgreen" stroke="black" points="61742,-474.45 61344,-474.45 61344,-421.45 61742,-421.45 61742,-474.45"/>
<text text-anchor="middle" x="61543" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: Expert FFN</text>
<text text-anchor="middle" x="61543" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="61543" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_9 -->
<g id="node128" class="node">
<title>s1_alltoall_9</title>
<ellipse fill="white" stroke="black" cx="62041" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="62041" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: AllToAll</text>
<text text-anchor="middle" x="62041" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="62041" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_9 -->
<g id="node129" class="node">
<title>s1_ln1_9</title>
<polygon fill="lightgreen" stroke="black" points="62738,-474.45 62340,-474.45 62340,-421.45 62738,-421.45 62738,-474.45"/>
<text text-anchor="middle" x="62539" y="-459.25" font-family="Times,serif" font-size="14.00">GPU9: LayerNorm</text>
<text text-anchor="middle" x="62539" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="62539" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_17 -->
<g id="node214" class="node">
<title>s2_ln0_17</title>
<polygon fill="lightyellow" stroke="black" points="62738,-332.45 62340,-332.45 62340,-279.45 62738,-279.45 62738,-332.45"/>
<text text-anchor="middle" x="62539" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: LayerNorm</text>
<text text-anchor="middle" x="62539" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="62539" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_9&#45;&gt;s2_ln0_17 -->
<g id="edge130" class="edge">
<title>s1_ln1_9&#45;&gt;s2_ln0_17</title>
<path fill="none" stroke="black" d="M62539,-421.28C62539,-399.17 62539,-367.05 62539,-342.48"/>
<polygon fill="black" stroke="black" points="62542.5,-342.47 62539,-332.47 62535.5,-342.47 62542.5,-342.47"/>
</g>
<!-- s1_q_10 -->
<g id="node131" class="node">
<title>s1_q_10</title>
<polygon fill="lightgreen" stroke="black" points="63145.5,-474.45 62756.5,-474.45 62756.5,-421.45 63145.5,-421.45 63145.5,-474.45"/>
<text text-anchor="middle" x="62951" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: Q Linear</text>
<text text-anchor="middle" x="62951" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="62951" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_10 -->
<g id="node132" class="node">
<title>s1_k_10</title>
<polygon fill="lightgreen" stroke="black" points="63552.5,-474.45 63163.5,-474.45 63163.5,-421.45 63552.5,-421.45 63552.5,-474.45"/>
<text text-anchor="middle" x="63358" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: K Linear</text>
<text text-anchor="middle" x="63358" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="63358" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_10 -->
<g id="node133" class="node">
<title>s1_v_10</title>
<polygon fill="lightgreen" stroke="black" points="63959.5,-474.45 63570.5,-474.45 63570.5,-421.45 63959.5,-421.45 63959.5,-474.45"/>
<text text-anchor="middle" x="63765" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: V Linear</text>
<text text-anchor="middle" x="63765" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="63765" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_10 -->
<g id="node134" class="node">
<title>s1_allgather_q_10</title>
<ellipse fill="white" stroke="black" cx="64259" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="64259" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather Q</text>
<text text-anchor="middle" x="64259" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="64259" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_10 -->
<g id="node135" class="node">
<title>s1_allgather_k_10</title>
<ellipse fill="white" stroke="black" cx="64840" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="64840" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather K</text>
<text text-anchor="middle" x="64840" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="64840" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_10 -->
<g id="node136" class="node">
<title>s1_allgather_v_10</title>
<ellipse fill="white" stroke="black" cx="65421" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="65421" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather V</text>
<text text-anchor="middle" x="65421" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="65421" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_10 -->
<g id="node137" class="node">
<title>s1_attn_10</title>
<polygon fill="lightgreen" stroke="black" points="66118,-474.45 65720,-474.45 65720,-421.45 66118,-421.45 66118,-474.45"/>
<text text-anchor="middle" x="65919" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: Attention</text>
<text text-anchor="middle" x="65919" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="65919" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_10 -->
<g id="node138" class="node">
<title>s1_gate_10</title>
<polygon fill="orange" stroke="black" points="66936.37,-500.95 66299.47,-500.95 66135.63,-394.95 66772.53,-394.95 66936.37,-500.95"/>
<text text-anchor="middle" x="66536" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: MoE Gate</text>
<text text-anchor="middle" x="66536" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="66536" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_10 -->
<g id="node139" class="node">
<title>s1_expert_10</title>
<polygon fill="lightgreen" stroke="black" points="67352,-474.45 66954,-474.45 66954,-421.45 67352,-421.45 67352,-474.45"/>
<text text-anchor="middle" x="67153" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: Expert FFN</text>
<text text-anchor="middle" x="67153" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="67153" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_10 -->
<g id="node140" class="node">
<title>s1_alltoall_10</title>
<ellipse fill="white" stroke="black" cx="67651" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="67651" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: AllToAll</text>
<text text-anchor="middle" x="67651" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="67651" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_10 -->
<g id="node141" class="node">
<title>s1_ln1_10</title>
<polygon fill="lightgreen" stroke="black" points="68348,-474.45 67950,-474.45 67950,-421.45 68348,-421.45 68348,-474.45"/>
<text text-anchor="middle" x="68149" y="-459.25" font-family="Times,serif" font-size="14.00">GPU10: LayerNorm</text>
<text text-anchor="middle" x="68149" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="68149" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_18 -->
<g id="node226" class="node">
<title>s2_ln0_18</title>
<polygon fill="lightyellow" stroke="black" points="68348,-332.45 67950,-332.45 67950,-279.45 68348,-279.45 68348,-332.45"/>
<text text-anchor="middle" x="68149" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: LayerNorm</text>
<text text-anchor="middle" x="68149" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="68149" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_10&#45;&gt;s2_ln0_18 -->
<g id="edge131" class="edge">
<title>s1_ln1_10&#45;&gt;s2_ln0_18</title>
<path fill="none" stroke="black" d="M68149,-421.28C68149,-399.17 68149,-367.05 68149,-342.48"/>
<polygon fill="black" stroke="black" points="68152.5,-342.47 68149,-332.47 68145.5,-342.47 68152.5,-342.47"/>
</g>
<!-- s1_q_11 -->
<g id="node143" class="node">
<title>s1_q_11</title>
<polygon fill="lightgreen" stroke="black" points="68755.5,-474.45 68366.5,-474.45 68366.5,-421.45 68755.5,-421.45 68755.5,-474.45"/>
<text text-anchor="middle" x="68561" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: Q Linear</text>
<text text-anchor="middle" x="68561" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="68561" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_11 -->
<g id="node144" class="node">
<title>s1_k_11</title>
<polygon fill="lightgreen" stroke="black" points="69162.5,-474.45 68773.5,-474.45 68773.5,-421.45 69162.5,-421.45 69162.5,-474.45"/>
<text text-anchor="middle" x="68968" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: K Linear</text>
<text text-anchor="middle" x="68968" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="68968" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_11 -->
<g id="node145" class="node">
<title>s1_v_11</title>
<polygon fill="lightgreen" stroke="black" points="69569.5,-474.45 69180.5,-474.45 69180.5,-421.45 69569.5,-421.45 69569.5,-474.45"/>
<text text-anchor="middle" x="69375" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: V Linear</text>
<text text-anchor="middle" x="69375" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="69375" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_11 -->
<g id="node146" class="node">
<title>s1_allgather_q_11</title>
<ellipse fill="white" stroke="black" cx="69869" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="69869" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather Q</text>
<text text-anchor="middle" x="69869" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="69869" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_11 -->
<g id="node147" class="node">
<title>s1_allgather_k_11</title>
<ellipse fill="white" stroke="black" cx="70450" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="70450" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather K</text>
<text text-anchor="middle" x="70450" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="70450" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_11 -->
<g id="node148" class="node">
<title>s1_allgather_v_11</title>
<ellipse fill="white" stroke="black" cx="71031" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="71031" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather V</text>
<text text-anchor="middle" x="71031" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="71031" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_11 -->
<g id="node149" class="node">
<title>s1_attn_11</title>
<polygon fill="lightgreen" stroke="black" points="71728,-474.45 71330,-474.45 71330,-421.45 71728,-421.45 71728,-474.45"/>
<text text-anchor="middle" x="71529" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: Attention</text>
<text text-anchor="middle" x="71529" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="71529" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_11 -->
<g id="node150" class="node">
<title>s1_gate_11</title>
<polygon fill="orange" stroke="black" points="72546.37,-500.95 71909.47,-500.95 71745.63,-394.95 72382.53,-394.95 72546.37,-500.95"/>
<text text-anchor="middle" x="72146" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: MoE Gate</text>
<text text-anchor="middle" x="72146" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="72146" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_11 -->
<g id="node151" class="node">
<title>s1_expert_11</title>
<polygon fill="lightgreen" stroke="black" points="72962,-474.45 72564,-474.45 72564,-421.45 72962,-421.45 72962,-474.45"/>
<text text-anchor="middle" x="72763" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: Expert FFN</text>
<text text-anchor="middle" x="72763" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="72763" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_11 -->
<g id="node152" class="node">
<title>s1_alltoall_11</title>
<ellipse fill="white" stroke="black" cx="73261" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="73261" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: AllToAll</text>
<text text-anchor="middle" x="73261" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="73261" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_11 -->
<g id="node153" class="node">
<title>s1_ln1_11</title>
<polygon fill="lightgreen" stroke="black" points="73958,-474.45 73560,-474.45 73560,-421.45 73958,-421.45 73958,-474.45"/>
<text text-anchor="middle" x="73759" y="-459.25" font-family="Times,serif" font-size="14.00">GPU11: LayerNorm</text>
<text text-anchor="middle" x="73759" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="73759" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_19 -->
<g id="node238" class="node">
<title>s2_ln0_19</title>
<polygon fill="lightyellow" stroke="black" points="73958,-332.45 73560,-332.45 73560,-279.45 73958,-279.45 73958,-332.45"/>
<text text-anchor="middle" x="73759" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: LayerNorm</text>
<text text-anchor="middle" x="73759" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="73759" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_11&#45;&gt;s2_ln0_19 -->
<g id="edge132" class="edge">
<title>s1_ln1_11&#45;&gt;s2_ln0_19</title>
<path fill="none" stroke="black" d="M73759,-421.28C73759,-399.17 73759,-367.05 73759,-342.48"/>
<polygon fill="black" stroke="black" points="73762.5,-342.47 73759,-332.47 73755.5,-342.47 73762.5,-342.47"/>
</g>
<!-- s1_q_12 -->
<g id="node155" class="node">
<title>s1_q_12</title>
<polygon fill="lightgreen" stroke="black" points="74365.5,-474.45 73976.5,-474.45 73976.5,-421.45 74365.5,-421.45 74365.5,-474.45"/>
<text text-anchor="middle" x="74171" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: Q Linear</text>
<text text-anchor="middle" x="74171" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="74171" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_12 -->
<g id="node156" class="node">
<title>s1_k_12</title>
<polygon fill="lightgreen" stroke="black" points="74772.5,-474.45 74383.5,-474.45 74383.5,-421.45 74772.5,-421.45 74772.5,-474.45"/>
<text text-anchor="middle" x="74578" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: K Linear</text>
<text text-anchor="middle" x="74578" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="74578" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_12 -->
<g id="node157" class="node">
<title>s1_v_12</title>
<polygon fill="lightgreen" stroke="black" points="75179.5,-474.45 74790.5,-474.45 74790.5,-421.45 75179.5,-421.45 75179.5,-474.45"/>
<text text-anchor="middle" x="74985" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: V Linear</text>
<text text-anchor="middle" x="74985" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="74985" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_12 -->
<g id="node158" class="node">
<title>s1_allgather_q_12</title>
<ellipse fill="white" stroke="black" cx="75479" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="75479" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather Q</text>
<text text-anchor="middle" x="75479" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="75479" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_12 -->
<g id="node159" class="node">
<title>s1_allgather_k_12</title>
<ellipse fill="white" stroke="black" cx="76060" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="76060" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather K</text>
<text text-anchor="middle" x="76060" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="76060" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_12 -->
<g id="node160" class="node">
<title>s1_allgather_v_12</title>
<ellipse fill="white" stroke="black" cx="76641" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="76641" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather V</text>
<text text-anchor="middle" x="76641" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="76641" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_12 -->
<g id="node161" class="node">
<title>s1_attn_12</title>
<polygon fill="lightgreen" stroke="black" points="77338,-474.45 76940,-474.45 76940,-421.45 77338,-421.45 77338,-474.45"/>
<text text-anchor="middle" x="77139" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: Attention</text>
<text text-anchor="middle" x="77139" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="77139" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_12 -->
<g id="node162" class="node">
<title>s1_gate_12</title>
<polygon fill="orange" stroke="black" points="78156.37,-500.95 77519.47,-500.95 77355.63,-394.95 77992.53,-394.95 78156.37,-500.95"/>
<text text-anchor="middle" x="77756" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: MoE Gate</text>
<text text-anchor="middle" x="77756" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="77756" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_12 -->
<g id="node163" class="node">
<title>s1_expert_12</title>
<polygon fill="lightgreen" stroke="black" points="78572,-474.45 78174,-474.45 78174,-421.45 78572,-421.45 78572,-474.45"/>
<text text-anchor="middle" x="78373" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: Expert FFN</text>
<text text-anchor="middle" x="78373" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="78373" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_12 -->
<g id="node164" class="node">
<title>s1_alltoall_12</title>
<ellipse fill="white" stroke="black" cx="78871" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="78871" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: AllToAll</text>
<text text-anchor="middle" x="78871" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="78871" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_12 -->
<g id="node165" class="node">
<title>s1_ln1_12</title>
<polygon fill="lightgreen" stroke="black" points="79568,-474.45 79170,-474.45 79170,-421.45 79568,-421.45 79568,-474.45"/>
<text text-anchor="middle" x="79369" y="-459.25" font-family="Times,serif" font-size="14.00">GPU12: LayerNorm</text>
<text text-anchor="middle" x="79369" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="79369" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_20 -->
<g id="node250" class="node">
<title>s2_ln0_20</title>
<polygon fill="lightyellow" stroke="black" points="79568,-332.45 79170,-332.45 79170,-279.45 79568,-279.45 79568,-332.45"/>
<text text-anchor="middle" x="79369" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: LayerNorm</text>
<text text-anchor="middle" x="79369" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="79369" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_12&#45;&gt;s2_ln0_20 -->
<g id="edge133" class="edge">
<title>s1_ln1_12&#45;&gt;s2_ln0_20</title>
<path fill="none" stroke="black" d="M79369,-421.28C79369,-399.17 79369,-367.05 79369,-342.48"/>
<polygon fill="black" stroke="black" points="79372.5,-342.47 79369,-332.47 79365.5,-342.47 79372.5,-342.47"/>
</g>
<!-- s1_q_13 -->
<g id="node167" class="node">
<title>s1_q_13</title>
<polygon fill="lightgreen" stroke="black" points="79975.5,-474.45 79586.5,-474.45 79586.5,-421.45 79975.5,-421.45 79975.5,-474.45"/>
<text text-anchor="middle" x="79781" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: Q Linear</text>
<text text-anchor="middle" x="79781" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="79781" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_13 -->
<g id="node168" class="node">
<title>s1_k_13</title>
<polygon fill="lightgreen" stroke="black" points="80382.5,-474.45 79993.5,-474.45 79993.5,-421.45 80382.5,-421.45 80382.5,-474.45"/>
<text text-anchor="middle" x="80188" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: K Linear</text>
<text text-anchor="middle" x="80188" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="80188" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_13 -->
<g id="node169" class="node">
<title>s1_v_13</title>
<polygon fill="lightgreen" stroke="black" points="80789.5,-474.45 80400.5,-474.45 80400.5,-421.45 80789.5,-421.45 80789.5,-474.45"/>
<text text-anchor="middle" x="80595" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: V Linear</text>
<text text-anchor="middle" x="80595" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="80595" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_13 -->
<g id="node170" class="node">
<title>s1_allgather_q_13</title>
<ellipse fill="white" stroke="black" cx="81089" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="81089" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather Q</text>
<text text-anchor="middle" x="81089" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="81089" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_13 -->
<g id="node171" class="node">
<title>s1_allgather_k_13</title>
<ellipse fill="white" stroke="black" cx="81670" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="81670" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather K</text>
<text text-anchor="middle" x="81670" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="81670" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_13 -->
<g id="node172" class="node">
<title>s1_allgather_v_13</title>
<ellipse fill="white" stroke="black" cx="82251" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="82251" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather V</text>
<text text-anchor="middle" x="82251" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="82251" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_13 -->
<g id="node173" class="node">
<title>s1_attn_13</title>
<polygon fill="lightgreen" stroke="black" points="82948,-474.45 82550,-474.45 82550,-421.45 82948,-421.45 82948,-474.45"/>
<text text-anchor="middle" x="82749" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: Attention</text>
<text text-anchor="middle" x="82749" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="82749" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_13 -->
<g id="node174" class="node">
<title>s1_gate_13</title>
<polygon fill="orange" stroke="black" points="83766.37,-500.95 83129.47,-500.95 82965.63,-394.95 83602.53,-394.95 83766.37,-500.95"/>
<text text-anchor="middle" x="83366" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: MoE Gate</text>
<text text-anchor="middle" x="83366" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="83366" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_13 -->
<g id="node175" class="node">
<title>s1_expert_13</title>
<polygon fill="lightgreen" stroke="black" points="84182,-474.45 83784,-474.45 83784,-421.45 84182,-421.45 84182,-474.45"/>
<text text-anchor="middle" x="83983" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: Expert FFN</text>
<text text-anchor="middle" x="83983" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="83983" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_13 -->
<g id="node176" class="node">
<title>s1_alltoall_13</title>
<ellipse fill="white" stroke="black" cx="84481" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="84481" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: AllToAll</text>
<text text-anchor="middle" x="84481" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="84481" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_13 -->
<g id="node177" class="node">
<title>s1_ln1_13</title>
<polygon fill="lightgreen" stroke="black" points="85178,-474.45 84780,-474.45 84780,-421.45 85178,-421.45 85178,-474.45"/>
<text text-anchor="middle" x="84979" y="-459.25" font-family="Times,serif" font-size="14.00">GPU13: LayerNorm</text>
<text text-anchor="middle" x="84979" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="84979" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_21 -->
<g id="node262" class="node">
<title>s2_ln0_21</title>
<polygon fill="lightyellow" stroke="black" points="85178,-332.45 84780,-332.45 84780,-279.45 85178,-279.45 85178,-332.45"/>
<text text-anchor="middle" x="84979" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: LayerNorm</text>
<text text-anchor="middle" x="84979" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="84979" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_13&#45;&gt;s2_ln0_21 -->
<g id="edge134" class="edge">
<title>s1_ln1_13&#45;&gt;s2_ln0_21</title>
<path fill="none" stroke="black" d="M84979,-421.28C84979,-399.17 84979,-367.05 84979,-342.48"/>
<polygon fill="black" stroke="black" points="84982.5,-342.47 84979,-332.47 84975.5,-342.47 84982.5,-342.47"/>
</g>
<!-- s1_q_14 -->
<g id="node179" class="node">
<title>s1_q_14</title>
<polygon fill="lightgreen" stroke="black" points="85585.5,-474.45 85196.5,-474.45 85196.5,-421.45 85585.5,-421.45 85585.5,-474.45"/>
<text text-anchor="middle" x="85391" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: Q Linear</text>
<text text-anchor="middle" x="85391" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="85391" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_14 -->
<g id="node180" class="node">
<title>s1_k_14</title>
<polygon fill="lightgreen" stroke="black" points="85992.5,-474.45 85603.5,-474.45 85603.5,-421.45 85992.5,-421.45 85992.5,-474.45"/>
<text text-anchor="middle" x="85798" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: K Linear</text>
<text text-anchor="middle" x="85798" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="85798" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_14 -->
<g id="node181" class="node">
<title>s1_v_14</title>
<polygon fill="lightgreen" stroke="black" points="86399.5,-474.45 86010.5,-474.45 86010.5,-421.45 86399.5,-421.45 86399.5,-474.45"/>
<text text-anchor="middle" x="86205" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: V Linear</text>
<text text-anchor="middle" x="86205" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="86205" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_14 -->
<g id="node182" class="node">
<title>s1_allgather_q_14</title>
<ellipse fill="white" stroke="black" cx="86699" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="86699" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather Q</text>
<text text-anchor="middle" x="86699" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="86699" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_14 -->
<g id="node183" class="node">
<title>s1_allgather_k_14</title>
<ellipse fill="white" stroke="black" cx="87280" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="87280" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather K</text>
<text text-anchor="middle" x="87280" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="87280" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_14 -->
<g id="node184" class="node">
<title>s1_allgather_v_14</title>
<ellipse fill="white" stroke="black" cx="87861" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="87861" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather V</text>
<text text-anchor="middle" x="87861" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="87861" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_14 -->
<g id="node185" class="node">
<title>s1_attn_14</title>
<polygon fill="lightgreen" stroke="black" points="88558,-474.45 88160,-474.45 88160,-421.45 88558,-421.45 88558,-474.45"/>
<text text-anchor="middle" x="88359" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: Attention</text>
<text text-anchor="middle" x="88359" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="88359" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_14 -->
<g id="node186" class="node">
<title>s1_gate_14</title>
<polygon fill="orange" stroke="black" points="89376.37,-500.95 88739.47,-500.95 88575.63,-394.95 89212.53,-394.95 89376.37,-500.95"/>
<text text-anchor="middle" x="88976" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: MoE Gate</text>
<text text-anchor="middle" x="88976" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="88976" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_14 -->
<g id="node187" class="node">
<title>s1_expert_14</title>
<polygon fill="lightgreen" stroke="black" points="89792,-474.45 89394,-474.45 89394,-421.45 89792,-421.45 89792,-474.45"/>
<text text-anchor="middle" x="89593" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: Expert FFN</text>
<text text-anchor="middle" x="89593" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="89593" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_14 -->
<g id="node188" class="node">
<title>s1_alltoall_14</title>
<ellipse fill="white" stroke="black" cx="90091" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="90091" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: AllToAll</text>
<text text-anchor="middle" x="90091" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="90091" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_14 -->
<g id="node189" class="node">
<title>s1_ln1_14</title>
<polygon fill="lightgreen" stroke="black" points="90788,-474.45 90390,-474.45 90390,-421.45 90788,-421.45 90788,-474.45"/>
<text text-anchor="middle" x="90589" y="-459.25" font-family="Times,serif" font-size="14.00">GPU14: LayerNorm</text>
<text text-anchor="middle" x="90589" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="90589" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_22 -->
<g id="node274" class="node">
<title>s2_ln0_22</title>
<polygon fill="lightyellow" stroke="black" points="90788,-332.45 90390,-332.45 90390,-279.45 90788,-279.45 90788,-332.45"/>
<text text-anchor="middle" x="90589" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: LayerNorm</text>
<text text-anchor="middle" x="90589" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="90589" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_14&#45;&gt;s2_ln0_22 -->
<g id="edge135" class="edge">
<title>s1_ln1_14&#45;&gt;s2_ln0_22</title>
<path fill="none" stroke="black" d="M90589,-421.28C90589,-399.17 90589,-367.05 90589,-342.48"/>
<polygon fill="black" stroke="black" points="90592.5,-342.47 90589,-332.47 90585.5,-342.47 90592.5,-342.47"/>
</g>
<!-- s1_q_15 -->
<g id="node191" class="node">
<title>s1_q_15</title>
<polygon fill="lightgreen" stroke="black" points="91195.5,-474.45 90806.5,-474.45 90806.5,-421.45 91195.5,-421.45 91195.5,-474.45"/>
<text text-anchor="middle" x="91001" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: Q Linear</text>
<text text-anchor="middle" x="91001" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="91001" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_k_15 -->
<g id="node192" class="node">
<title>s1_k_15</title>
<polygon fill="lightgreen" stroke="black" points="91602.5,-474.45 91213.5,-474.45 91213.5,-421.45 91602.5,-421.45 91602.5,-474.45"/>
<text text-anchor="middle" x="91408" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: K Linear</text>
<text text-anchor="middle" x="91408" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="91408" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_v_15 -->
<g id="node193" class="node">
<title>s1_v_15</title>
<polygon fill="lightgreen" stroke="black" points="92009.5,-474.45 91620.5,-474.45 91620.5,-421.45 92009.5,-421.45 92009.5,-474.45"/>
<text text-anchor="middle" x="91815" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: V Linear</text>
<text text-anchor="middle" x="91815" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="91815" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s1_allgather_q_15 -->
<g id="node194" class="node">
<title>s1_allgather_q_15</title>
<ellipse fill="white" stroke="black" cx="92309" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="92309" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather Q</text>
<text text-anchor="middle" x="92309" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="92309" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_k_15 -->
<g id="node195" class="node">
<title>s1_allgather_k_15</title>
<ellipse fill="white" stroke="black" cx="92890" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="92890" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather K</text>
<text text-anchor="middle" x="92890" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="92890" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_allgather_v_15 -->
<g id="node196" class="node">
<title>s1_allgather_v_15</title>
<ellipse fill="white" stroke="black" cx="93471" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="93471" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather V</text>
<text text-anchor="middle" x="93471" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="93471" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_attn_15 -->
<g id="node197" class="node">
<title>s1_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="94168,-474.45 93770,-474.45 93770,-421.45 94168,-421.45 94168,-474.45"/>
<text text-anchor="middle" x="93969" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: Attention</text>
<text text-anchor="middle" x="93969" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="93969" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_gate_15 -->
<g id="node198" class="node">
<title>s1_gate_15</title>
<polygon fill="orange" stroke="black" points="94986.37,-500.95 94349.47,-500.95 94185.63,-394.95 94822.53,-394.95 94986.37,-500.95"/>
<text text-anchor="middle" x="94586" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: MoE Gate</text>
<text text-anchor="middle" x="94586" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="94586" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s1_expert_15 -->
<g id="node199" class="node">
<title>s1_expert_15</title>
<polygon fill="lightgreen" stroke="black" points="95402,-474.45 95004,-474.45 95004,-421.45 95402,-421.45 95402,-474.45"/>
<text text-anchor="middle" x="95203" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: Expert FFN</text>
<text text-anchor="middle" x="95203" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="95203" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_alltoall_15 -->
<g id="node200" class="node">
<title>s1_alltoall_15</title>
<ellipse fill="white" stroke="black" cx="95701" cy="-447.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="95701" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: AllToAll</text>
<text text-anchor="middle" x="95701" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="95701" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_15 -->
<g id="node201" class="node">
<title>s1_ln1_15</title>
<polygon fill="lightgreen" stroke="black" points="96398,-474.45 96000,-474.45 96000,-421.45 96398,-421.45 96398,-474.45"/>
<text text-anchor="middle" x="96199" y="-459.25" font-family="Times,serif" font-size="14.00">GPU15: LayerNorm</text>
<text text-anchor="middle" x="96199" y="-444.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="96199" y="-429.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln0_23 -->
<g id="node286" class="node">
<title>s2_ln0_23</title>
<polygon fill="lightyellow" stroke="black" points="96398,-332.45 96000,-332.45 96000,-279.45 96398,-279.45 96398,-332.45"/>
<text text-anchor="middle" x="96199" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: LayerNorm</text>
<text text-anchor="middle" x="96199" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="96199" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s1_ln1_15&#45;&gt;s2_ln0_23 -->
<g id="edge136" class="edge">
<title>s1_ln1_15&#45;&gt;s2_ln0_23</title>
<path fill="none" stroke="black" d="M96199,-421.28C96199,-399.17 96199,-367.05 96199,-342.48"/>
<polygon fill="black" stroke="black" points="96202.5,-342.47 96199,-332.47 96195.5,-342.47 96202.5,-342.47"/>
</g>
<!-- s2_q_16 -->
<g id="node203" class="node">
<title>s2_q_16</title>
<polygon fill="lightyellow" stroke="black" points="96805.5,-332.45 96416.5,-332.45 96416.5,-279.45 96805.5,-279.45 96805.5,-332.45"/>
<text text-anchor="middle" x="96611" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: Q Linear</text>
<text text-anchor="middle" x="96611" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="96611" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_16 -->
<g id="node204" class="node">
<title>s2_k_16</title>
<polygon fill="lightyellow" stroke="black" points="97212.5,-332.45 96823.5,-332.45 96823.5,-279.45 97212.5,-279.45 97212.5,-332.45"/>
<text text-anchor="middle" x="97018" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: K Linear</text>
<text text-anchor="middle" x="97018" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="97018" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_16 -->
<g id="node205" class="node">
<title>s2_v_16</title>
<polygon fill="lightyellow" stroke="black" points="97619.5,-332.45 97230.5,-332.45 97230.5,-279.45 97619.5,-279.45 97619.5,-332.45"/>
<text text-anchor="middle" x="97425" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: V Linear</text>
<text text-anchor="middle" x="97425" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="97425" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_16 -->
<g id="node206" class="node">
<title>s2_allgather_q_16</title>
<ellipse fill="white" stroke="black" cx="97919" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="97919" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather Q</text>
<text text-anchor="middle" x="97919" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="97919" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_16 -->
<g id="node207" class="node">
<title>s2_allgather_k_16</title>
<ellipse fill="white" stroke="black" cx="98500" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="98500" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather K</text>
<text text-anchor="middle" x="98500" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="98500" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_16 -->
<g id="node208" class="node">
<title>s2_allgather_v_16</title>
<ellipse fill="white" stroke="black" cx="99081" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="99081" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather V</text>
<text text-anchor="middle" x="99081" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="99081" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_16 -->
<g id="node209" class="node">
<title>s2_attn_16</title>
<polygon fill="lightyellow" stroke="black" points="99778,-332.45 99380,-332.45 99380,-279.45 99778,-279.45 99778,-332.45"/>
<text text-anchor="middle" x="99579" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: Attention</text>
<text text-anchor="middle" x="99579" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="99579" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_16 -->
<g id="node210" class="node">
<title>s2_gate_16</title>
<polygon fill="orange" stroke="black" points="100596.37,-358.95 99959.47,-358.95 99795.63,-252.95 100432.53,-252.95 100596.37,-358.95"/>
<text text-anchor="middle" x="100196" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: MoE Gate</text>
<text text-anchor="middle" x="100196" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="100196" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_16 -->
<g id="node211" class="node">
<title>s2_expert_16</title>
<polygon fill="lightyellow" stroke="black" points="101012,-332.45 100614,-332.45 100614,-279.45 101012,-279.45 101012,-332.45"/>
<text text-anchor="middle" x="100813" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: Expert FFN</text>
<text text-anchor="middle" x="100813" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="100813" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_16 -->
<g id="node212" class="node">
<title>s2_alltoall_16</title>
<ellipse fill="white" stroke="black" cx="101311" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="101311" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: AllToAll</text>
<text text-anchor="middle" x="101311" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="101311" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_16 -->
<g id="node213" class="node">
<title>s2_ln1_16</title>
<polygon fill="lightyellow" stroke="black" points="102008,-332.45 101610,-332.45 101610,-279.45 102008,-279.45 102008,-332.45"/>
<text text-anchor="middle" x="101809" y="-317.25" font-family="Times,serif" font-size="14.00">GPU16: LayerNorm</text>
<text text-anchor="middle" x="101809" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="101809" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_24 -->
<g id="node298" class="node">
<title>s3_ln0_24</title>
<polygon fill="lightcoral" stroke="black" points="102008,-190.45 101610,-190.45 101610,-137.45 102008,-137.45 102008,-190.45"/>
<text text-anchor="middle" x="101809" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: LayerNorm</text>
<text text-anchor="middle" x="101809" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="101809" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_16&#45;&gt;s3_ln0_24 -->
<g id="edge137" class="edge">
<title>s2_ln1_16&#45;&gt;s3_ln0_24</title>
<path fill="none" stroke="black" d="M101809,-279.28C101809,-257.17 101809,-225.05 101809,-200.48"/>
<polygon fill="black" stroke="black" points="101812.5,-200.47 101809,-190.47 101805.5,-200.47 101812.5,-200.47"/>
</g>
<!-- s2_q_17 -->
<g id="node215" class="node">
<title>s2_q_17</title>
<polygon fill="lightyellow" stroke="black" points="102415.5,-332.45 102026.5,-332.45 102026.5,-279.45 102415.5,-279.45 102415.5,-332.45"/>
<text text-anchor="middle" x="102221" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: Q Linear</text>
<text text-anchor="middle" x="102221" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="102221" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_17 -->
<g id="node216" class="node">
<title>s2_k_17</title>
<polygon fill="lightyellow" stroke="black" points="102822.5,-332.45 102433.5,-332.45 102433.5,-279.45 102822.5,-279.45 102822.5,-332.45"/>
<text text-anchor="middle" x="102628" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: K Linear</text>
<text text-anchor="middle" x="102628" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="102628" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_17 -->
<g id="node217" class="node">
<title>s2_v_17</title>
<polygon fill="lightyellow" stroke="black" points="103229.5,-332.45 102840.5,-332.45 102840.5,-279.45 103229.5,-279.45 103229.5,-332.45"/>
<text text-anchor="middle" x="103035" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: V Linear</text>
<text text-anchor="middle" x="103035" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="103035" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_17 -->
<g id="node218" class="node">
<title>s2_allgather_q_17</title>
<ellipse fill="white" stroke="black" cx="103529" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="103529" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather Q</text>
<text text-anchor="middle" x="103529" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="103529" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_17 -->
<g id="node219" class="node">
<title>s2_allgather_k_17</title>
<ellipse fill="white" stroke="black" cx="104110" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="104110" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather K</text>
<text text-anchor="middle" x="104110" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="104110" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_17 -->
<g id="node220" class="node">
<title>s2_allgather_v_17</title>
<ellipse fill="white" stroke="black" cx="104691" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="104691" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather V</text>
<text text-anchor="middle" x="104691" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="104691" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_17 -->
<g id="node221" class="node">
<title>s2_attn_17</title>
<polygon fill="lightyellow" stroke="black" points="105388,-332.45 104990,-332.45 104990,-279.45 105388,-279.45 105388,-332.45"/>
<text text-anchor="middle" x="105189" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: Attention</text>
<text text-anchor="middle" x="105189" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="105189" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_17 -->
<g id="node222" class="node">
<title>s2_gate_17</title>
<polygon fill="orange" stroke="black" points="106206.37,-358.95 105569.47,-358.95 105405.63,-252.95 106042.53,-252.95 106206.37,-358.95"/>
<text text-anchor="middle" x="105806" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: MoE Gate</text>
<text text-anchor="middle" x="105806" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="105806" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_17 -->
<g id="node223" class="node">
<title>s2_expert_17</title>
<polygon fill="lightyellow" stroke="black" points="106622,-332.45 106224,-332.45 106224,-279.45 106622,-279.45 106622,-332.45"/>
<text text-anchor="middle" x="106423" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: Expert FFN</text>
<text text-anchor="middle" x="106423" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="106423" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_17 -->
<g id="node224" class="node">
<title>s2_alltoall_17</title>
<ellipse fill="white" stroke="black" cx="106921" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="106921" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: AllToAll</text>
<text text-anchor="middle" x="106921" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="106921" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_17 -->
<g id="node225" class="node">
<title>s2_ln1_17</title>
<polygon fill="lightyellow" stroke="black" points="107618,-332.45 107220,-332.45 107220,-279.45 107618,-279.45 107618,-332.45"/>
<text text-anchor="middle" x="107419" y="-317.25" font-family="Times,serif" font-size="14.00">GPU17: LayerNorm</text>
<text text-anchor="middle" x="107419" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="107419" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_25 -->
<g id="node310" class="node">
<title>s3_ln0_25</title>
<polygon fill="lightcoral" stroke="black" points="107618,-190.45 107220,-190.45 107220,-137.45 107618,-137.45 107618,-190.45"/>
<text text-anchor="middle" x="107419" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: LayerNorm</text>
<text text-anchor="middle" x="107419" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="107419" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_17&#45;&gt;s3_ln0_25 -->
<g id="edge138" class="edge">
<title>s2_ln1_17&#45;&gt;s3_ln0_25</title>
<path fill="none" stroke="black" d="M107419,-279.28C107419,-257.17 107419,-225.05 107419,-200.48"/>
<polygon fill="black" stroke="black" points="107422.5,-200.47 107419,-190.47 107415.5,-200.47 107422.5,-200.47"/>
</g>
<!-- s2_q_18 -->
<g id="node227" class="node">
<title>s2_q_18</title>
<polygon fill="lightyellow" stroke="black" points="108025.5,-332.45 107636.5,-332.45 107636.5,-279.45 108025.5,-279.45 108025.5,-332.45"/>
<text text-anchor="middle" x="107831" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: Q Linear</text>
<text text-anchor="middle" x="107831" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="107831" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_18 -->
<g id="node228" class="node">
<title>s2_k_18</title>
<polygon fill="lightyellow" stroke="black" points="108432.5,-332.45 108043.5,-332.45 108043.5,-279.45 108432.5,-279.45 108432.5,-332.45"/>
<text text-anchor="middle" x="108238" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: K Linear</text>
<text text-anchor="middle" x="108238" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="108238" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_18 -->
<g id="node229" class="node">
<title>s2_v_18</title>
<polygon fill="lightyellow" stroke="black" points="108839.5,-332.45 108450.5,-332.45 108450.5,-279.45 108839.5,-279.45 108839.5,-332.45"/>
<text text-anchor="middle" x="108645" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: V Linear</text>
<text text-anchor="middle" x="108645" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="108645" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_18 -->
<g id="node230" class="node">
<title>s2_allgather_q_18</title>
<ellipse fill="white" stroke="black" cx="109139" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="109139" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather Q</text>
<text text-anchor="middle" x="109139" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="109139" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_18 -->
<g id="node231" class="node">
<title>s2_allgather_k_18</title>
<ellipse fill="white" stroke="black" cx="109720" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="109720" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather K</text>
<text text-anchor="middle" x="109720" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="109720" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_18 -->
<g id="node232" class="node">
<title>s2_allgather_v_18</title>
<ellipse fill="white" stroke="black" cx="110301" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="110301" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather V</text>
<text text-anchor="middle" x="110301" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="110301" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_18 -->
<g id="node233" class="node">
<title>s2_attn_18</title>
<polygon fill="lightyellow" stroke="black" points="110998,-332.45 110600,-332.45 110600,-279.45 110998,-279.45 110998,-332.45"/>
<text text-anchor="middle" x="110799" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: Attention</text>
<text text-anchor="middle" x="110799" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="110799" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_18 -->
<g id="node234" class="node">
<title>s2_gate_18</title>
<polygon fill="orange" stroke="black" points="111816.37,-358.95 111179.47,-358.95 111015.63,-252.95 111652.53,-252.95 111816.37,-358.95"/>
<text text-anchor="middle" x="111416" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: MoE Gate</text>
<text text-anchor="middle" x="111416" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="111416" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_18 -->
<g id="node235" class="node">
<title>s2_expert_18</title>
<polygon fill="lightyellow" stroke="black" points="112232,-332.45 111834,-332.45 111834,-279.45 112232,-279.45 112232,-332.45"/>
<text text-anchor="middle" x="112033" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: Expert FFN</text>
<text text-anchor="middle" x="112033" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="112033" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_18 -->
<g id="node236" class="node">
<title>s2_alltoall_18</title>
<ellipse fill="white" stroke="black" cx="112531" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="112531" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: AllToAll</text>
<text text-anchor="middle" x="112531" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="112531" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_18 -->
<g id="node237" class="node">
<title>s2_ln1_18</title>
<polygon fill="lightyellow" stroke="black" points="113228,-332.45 112830,-332.45 112830,-279.45 113228,-279.45 113228,-332.45"/>
<text text-anchor="middle" x="113029" y="-317.25" font-family="Times,serif" font-size="14.00">GPU18: LayerNorm</text>
<text text-anchor="middle" x="113029" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="113029" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_26 -->
<g id="node322" class="node">
<title>s3_ln0_26</title>
<polygon fill="lightcoral" stroke="black" points="113228,-190.45 112830,-190.45 112830,-137.45 113228,-137.45 113228,-190.45"/>
<text text-anchor="middle" x="113029" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: LayerNorm</text>
<text text-anchor="middle" x="113029" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="113029" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_18&#45;&gt;s3_ln0_26 -->
<g id="edge139" class="edge">
<title>s2_ln1_18&#45;&gt;s3_ln0_26</title>
<path fill="none" stroke="black" d="M113029,-279.28C113029,-257.17 113029,-225.05 113029,-200.48"/>
<polygon fill="black" stroke="black" points="113032.5,-200.47 113029,-190.47 113025.5,-200.47 113032.5,-200.47"/>
</g>
<!-- s2_q_19 -->
<g id="node239" class="node">
<title>s2_q_19</title>
<polygon fill="lightyellow" stroke="black" points="113635.5,-332.45 113246.5,-332.45 113246.5,-279.45 113635.5,-279.45 113635.5,-332.45"/>
<text text-anchor="middle" x="113441" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: Q Linear</text>
<text text-anchor="middle" x="113441" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="113441" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_19 -->
<g id="node240" class="node">
<title>s2_k_19</title>
<polygon fill="lightyellow" stroke="black" points="114042.5,-332.45 113653.5,-332.45 113653.5,-279.45 114042.5,-279.45 114042.5,-332.45"/>
<text text-anchor="middle" x="113848" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: K Linear</text>
<text text-anchor="middle" x="113848" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="113848" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_19 -->
<g id="node241" class="node">
<title>s2_v_19</title>
<polygon fill="lightyellow" stroke="black" points="114449.5,-332.45 114060.5,-332.45 114060.5,-279.45 114449.5,-279.45 114449.5,-332.45"/>
<text text-anchor="middle" x="114255" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: V Linear</text>
<text text-anchor="middle" x="114255" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="114255" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_19 -->
<g id="node242" class="node">
<title>s2_allgather_q_19</title>
<ellipse fill="white" stroke="black" cx="114749" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="114749" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather Q</text>
<text text-anchor="middle" x="114749" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="114749" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_19 -->
<g id="node243" class="node">
<title>s2_allgather_k_19</title>
<ellipse fill="white" stroke="black" cx="115330" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="115330" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather K</text>
<text text-anchor="middle" x="115330" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="115330" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_19 -->
<g id="node244" class="node">
<title>s2_allgather_v_19</title>
<ellipse fill="white" stroke="black" cx="115911" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="115911" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather V</text>
<text text-anchor="middle" x="115911" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="115911" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_19 -->
<g id="node245" class="node">
<title>s2_attn_19</title>
<polygon fill="lightyellow" stroke="black" points="116608,-332.45 116210,-332.45 116210,-279.45 116608,-279.45 116608,-332.45"/>
<text text-anchor="middle" x="116409" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: Attention</text>
<text text-anchor="middle" x="116409" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="116409" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_19 -->
<g id="node246" class="node">
<title>s2_gate_19</title>
<polygon fill="orange" stroke="black" points="117426.37,-358.95 116789.47,-358.95 116625.63,-252.95 117262.53,-252.95 117426.37,-358.95"/>
<text text-anchor="middle" x="117026" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: MoE Gate</text>
<text text-anchor="middle" x="117026" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="117026" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_19 -->
<g id="node247" class="node">
<title>s2_expert_19</title>
<polygon fill="lightyellow" stroke="black" points="117842,-332.45 117444,-332.45 117444,-279.45 117842,-279.45 117842,-332.45"/>
<text text-anchor="middle" x="117643" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: Expert FFN</text>
<text text-anchor="middle" x="117643" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="117643" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_19 -->
<g id="node248" class="node">
<title>s2_alltoall_19</title>
<ellipse fill="white" stroke="black" cx="118141" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="118141" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: AllToAll</text>
<text text-anchor="middle" x="118141" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="118141" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_19 -->
<g id="node249" class="node">
<title>s2_ln1_19</title>
<polygon fill="lightyellow" stroke="black" points="118838,-332.45 118440,-332.45 118440,-279.45 118838,-279.45 118838,-332.45"/>
<text text-anchor="middle" x="118639" y="-317.25" font-family="Times,serif" font-size="14.00">GPU19: LayerNorm</text>
<text text-anchor="middle" x="118639" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="118639" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_27 -->
<g id="node334" class="node">
<title>s3_ln0_27</title>
<polygon fill="lightcoral" stroke="black" points="118838,-190.45 118440,-190.45 118440,-137.45 118838,-137.45 118838,-190.45"/>
<text text-anchor="middle" x="118639" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: LayerNorm</text>
<text text-anchor="middle" x="118639" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="118639" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_19&#45;&gt;s3_ln0_27 -->
<g id="edge140" class="edge">
<title>s2_ln1_19&#45;&gt;s3_ln0_27</title>
<path fill="none" stroke="black" d="M118639,-279.28C118639,-257.17 118639,-225.05 118639,-200.48"/>
<polygon fill="black" stroke="black" points="118642.5,-200.47 118639,-190.47 118635.5,-200.47 118642.5,-200.47"/>
</g>
<!-- s2_q_20 -->
<g id="node251" class="node">
<title>s2_q_20</title>
<polygon fill="lightyellow" stroke="black" points="119245.5,-332.45 118856.5,-332.45 118856.5,-279.45 119245.5,-279.45 119245.5,-332.45"/>
<text text-anchor="middle" x="119051" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: Q Linear</text>
<text text-anchor="middle" x="119051" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="119051" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_20 -->
<g id="node252" class="node">
<title>s2_k_20</title>
<polygon fill="lightyellow" stroke="black" points="119652.5,-332.45 119263.5,-332.45 119263.5,-279.45 119652.5,-279.45 119652.5,-332.45"/>
<text text-anchor="middle" x="119458" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: K Linear</text>
<text text-anchor="middle" x="119458" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="119458" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_20 -->
<g id="node253" class="node">
<title>s2_v_20</title>
<polygon fill="lightyellow" stroke="black" points="120059.5,-332.45 119670.5,-332.45 119670.5,-279.45 120059.5,-279.45 120059.5,-332.45"/>
<text text-anchor="middle" x="119865" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: V Linear</text>
<text text-anchor="middle" x="119865" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="119865" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_20 -->
<g id="node254" class="node">
<title>s2_allgather_q_20</title>
<ellipse fill="white" stroke="black" cx="120359" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="120359" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather Q</text>
<text text-anchor="middle" x="120359" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="120359" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_20 -->
<g id="node255" class="node">
<title>s2_allgather_k_20</title>
<ellipse fill="white" stroke="black" cx="120940" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="120940" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather K</text>
<text text-anchor="middle" x="120940" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="120940" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_20 -->
<g id="node256" class="node">
<title>s2_allgather_v_20</title>
<ellipse fill="white" stroke="black" cx="121521" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="121521" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather V</text>
<text text-anchor="middle" x="121521" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="121521" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_20 -->
<g id="node257" class="node">
<title>s2_attn_20</title>
<polygon fill="lightyellow" stroke="black" points="122218,-332.45 121820,-332.45 121820,-279.45 122218,-279.45 122218,-332.45"/>
<text text-anchor="middle" x="122019" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: Attention</text>
<text text-anchor="middle" x="122019" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="122019" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_20 -->
<g id="node258" class="node">
<title>s2_gate_20</title>
<polygon fill="orange" stroke="black" points="123036.37,-358.95 122399.47,-358.95 122235.63,-252.95 122872.53,-252.95 123036.37,-358.95"/>
<text text-anchor="middle" x="122636" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: MoE Gate</text>
<text text-anchor="middle" x="122636" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="122636" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_20 -->
<g id="node259" class="node">
<title>s2_expert_20</title>
<polygon fill="lightyellow" stroke="black" points="123452,-332.45 123054,-332.45 123054,-279.45 123452,-279.45 123452,-332.45"/>
<text text-anchor="middle" x="123253" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: Expert FFN</text>
<text text-anchor="middle" x="123253" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="123253" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_20 -->
<g id="node260" class="node">
<title>s2_alltoall_20</title>
<ellipse fill="white" stroke="black" cx="123751" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="123751" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: AllToAll</text>
<text text-anchor="middle" x="123751" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="123751" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_20 -->
<g id="node261" class="node">
<title>s2_ln1_20</title>
<polygon fill="lightyellow" stroke="black" points="124448,-332.45 124050,-332.45 124050,-279.45 124448,-279.45 124448,-332.45"/>
<text text-anchor="middle" x="124249" y="-317.25" font-family="Times,serif" font-size="14.00">GPU20: LayerNorm</text>
<text text-anchor="middle" x="124249" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="124249" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_28 -->
<g id="node346" class="node">
<title>s3_ln0_28</title>
<polygon fill="lightcoral" stroke="black" points="124448,-190.45 124050,-190.45 124050,-137.45 124448,-137.45 124448,-190.45"/>
<text text-anchor="middle" x="124249" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: LayerNorm</text>
<text text-anchor="middle" x="124249" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="124249" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_20&#45;&gt;s3_ln0_28 -->
<g id="edge141" class="edge">
<title>s2_ln1_20&#45;&gt;s3_ln0_28</title>
<path fill="none" stroke="black" d="M124249,-279.28C124249,-257.17 124249,-225.05 124249,-200.48"/>
<polygon fill="black" stroke="black" points="124252.5,-200.47 124249,-190.47 124245.5,-200.47 124252.5,-200.47"/>
</g>
<!-- s2_q_21 -->
<g id="node263" class="node">
<title>s2_q_21</title>
<polygon fill="lightyellow" stroke="black" points="124855.5,-332.45 124466.5,-332.45 124466.5,-279.45 124855.5,-279.45 124855.5,-332.45"/>
<text text-anchor="middle" x="124661" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: Q Linear</text>
<text text-anchor="middle" x="124661" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="124661" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_21 -->
<g id="node264" class="node">
<title>s2_k_21</title>
<polygon fill="lightyellow" stroke="black" points="125262.5,-332.45 124873.5,-332.45 124873.5,-279.45 125262.5,-279.45 125262.5,-332.45"/>
<text text-anchor="middle" x="125068" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: K Linear</text>
<text text-anchor="middle" x="125068" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="125068" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_21 -->
<g id="node265" class="node">
<title>s2_v_21</title>
<polygon fill="lightyellow" stroke="black" points="125669.5,-332.45 125280.5,-332.45 125280.5,-279.45 125669.5,-279.45 125669.5,-332.45"/>
<text text-anchor="middle" x="125475" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: V Linear</text>
<text text-anchor="middle" x="125475" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="125475" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_21 -->
<g id="node266" class="node">
<title>s2_allgather_q_21</title>
<ellipse fill="white" stroke="black" cx="125969" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="125969" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather Q</text>
<text text-anchor="middle" x="125969" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="125969" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_21 -->
<g id="node267" class="node">
<title>s2_allgather_k_21</title>
<ellipse fill="white" stroke="black" cx="126550" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="126550" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather K</text>
<text text-anchor="middle" x="126550" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="126550" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_21 -->
<g id="node268" class="node">
<title>s2_allgather_v_21</title>
<ellipse fill="white" stroke="black" cx="127131" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="127131" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather V</text>
<text text-anchor="middle" x="127131" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="127131" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_21 -->
<g id="node269" class="node">
<title>s2_attn_21</title>
<polygon fill="lightyellow" stroke="black" points="127828,-332.45 127430,-332.45 127430,-279.45 127828,-279.45 127828,-332.45"/>
<text text-anchor="middle" x="127629" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: Attention</text>
<text text-anchor="middle" x="127629" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="127629" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_21 -->
<g id="node270" class="node">
<title>s2_gate_21</title>
<polygon fill="orange" stroke="black" points="128646.37,-358.95 128009.47,-358.95 127845.63,-252.95 128482.53,-252.95 128646.37,-358.95"/>
<text text-anchor="middle" x="128246" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: MoE Gate</text>
<text text-anchor="middle" x="128246" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="128246" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_21 -->
<g id="node271" class="node">
<title>s2_expert_21</title>
<polygon fill="lightyellow" stroke="black" points="129062,-332.45 128664,-332.45 128664,-279.45 129062,-279.45 129062,-332.45"/>
<text text-anchor="middle" x="128863" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: Expert FFN</text>
<text text-anchor="middle" x="128863" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="128863" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_21 -->
<g id="node272" class="node">
<title>s2_alltoall_21</title>
<ellipse fill="white" stroke="black" cx="129361" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="129361" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: AllToAll</text>
<text text-anchor="middle" x="129361" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="129361" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_21 -->
<g id="node273" class="node">
<title>s2_ln1_21</title>
<polygon fill="lightyellow" stroke="black" points="130058,-332.45 129660,-332.45 129660,-279.45 130058,-279.45 130058,-332.45"/>
<text text-anchor="middle" x="129859" y="-317.25" font-family="Times,serif" font-size="14.00">GPU21: LayerNorm</text>
<text text-anchor="middle" x="129859" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="129859" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_29 -->
<g id="node358" class="node">
<title>s3_ln0_29</title>
<polygon fill="lightcoral" stroke="black" points="130058,-190.45 129660,-190.45 129660,-137.45 130058,-137.45 130058,-190.45"/>
<text text-anchor="middle" x="129859" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: LayerNorm</text>
<text text-anchor="middle" x="129859" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="129859" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_21&#45;&gt;s3_ln0_29 -->
<g id="edge142" class="edge">
<title>s2_ln1_21&#45;&gt;s3_ln0_29</title>
<path fill="none" stroke="black" d="M129859,-279.28C129859,-257.17 129859,-225.05 129859,-200.48"/>
<polygon fill="black" stroke="black" points="129862.5,-200.47 129859,-190.47 129855.5,-200.47 129862.5,-200.47"/>
</g>
<!-- s2_q_22 -->
<g id="node275" class="node">
<title>s2_q_22</title>
<polygon fill="lightyellow" stroke="black" points="130465.5,-332.45 130076.5,-332.45 130076.5,-279.45 130465.5,-279.45 130465.5,-332.45"/>
<text text-anchor="middle" x="130271" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: Q Linear</text>
<text text-anchor="middle" x="130271" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="130271" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_22 -->
<g id="node276" class="node">
<title>s2_k_22</title>
<polygon fill="lightyellow" stroke="black" points="130872.5,-332.45 130483.5,-332.45 130483.5,-279.45 130872.5,-279.45 130872.5,-332.45"/>
<text text-anchor="middle" x="130678" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: K Linear</text>
<text text-anchor="middle" x="130678" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="130678" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_22 -->
<g id="node277" class="node">
<title>s2_v_22</title>
<polygon fill="lightyellow" stroke="black" points="131279.5,-332.45 130890.5,-332.45 130890.5,-279.45 131279.5,-279.45 131279.5,-332.45"/>
<text text-anchor="middle" x="131085" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: V Linear</text>
<text text-anchor="middle" x="131085" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="131085" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_22 -->
<g id="node278" class="node">
<title>s2_allgather_q_22</title>
<ellipse fill="white" stroke="black" cx="131579" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="131579" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather Q</text>
<text text-anchor="middle" x="131579" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="131579" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_22 -->
<g id="node279" class="node">
<title>s2_allgather_k_22</title>
<ellipse fill="white" stroke="black" cx="132160" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="132160" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather K</text>
<text text-anchor="middle" x="132160" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="132160" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_22 -->
<g id="node280" class="node">
<title>s2_allgather_v_22</title>
<ellipse fill="white" stroke="black" cx="132741" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="132741" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather V</text>
<text text-anchor="middle" x="132741" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="132741" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_22 -->
<g id="node281" class="node">
<title>s2_attn_22</title>
<polygon fill="lightyellow" stroke="black" points="133438,-332.45 133040,-332.45 133040,-279.45 133438,-279.45 133438,-332.45"/>
<text text-anchor="middle" x="133239" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: Attention</text>
<text text-anchor="middle" x="133239" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="133239" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_22 -->
<g id="node282" class="node">
<title>s2_gate_22</title>
<polygon fill="orange" stroke="black" points="134256.37,-358.95 133619.47,-358.95 133455.63,-252.95 134092.53,-252.95 134256.37,-358.95"/>
<text text-anchor="middle" x="133856" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: MoE Gate</text>
<text text-anchor="middle" x="133856" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="133856" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_22 -->
<g id="node283" class="node">
<title>s2_expert_22</title>
<polygon fill="lightyellow" stroke="black" points="134672,-332.45 134274,-332.45 134274,-279.45 134672,-279.45 134672,-332.45"/>
<text text-anchor="middle" x="134473" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: Expert FFN</text>
<text text-anchor="middle" x="134473" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="134473" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_22 -->
<g id="node284" class="node">
<title>s2_alltoall_22</title>
<ellipse fill="white" stroke="black" cx="134971" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="134971" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: AllToAll</text>
<text text-anchor="middle" x="134971" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="134971" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_22 -->
<g id="node285" class="node">
<title>s2_ln1_22</title>
<polygon fill="lightyellow" stroke="black" points="135668,-332.45 135270,-332.45 135270,-279.45 135668,-279.45 135668,-332.45"/>
<text text-anchor="middle" x="135469" y="-317.25" font-family="Times,serif" font-size="14.00">GPU22: LayerNorm</text>
<text text-anchor="middle" x="135469" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="135469" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_30 -->
<g id="node370" class="node">
<title>s3_ln0_30</title>
<polygon fill="lightcoral" stroke="black" points="135668,-190.45 135270,-190.45 135270,-137.45 135668,-137.45 135668,-190.45"/>
<text text-anchor="middle" x="135469" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: LayerNorm</text>
<text text-anchor="middle" x="135469" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="135469" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_22&#45;&gt;s3_ln0_30 -->
<g id="edge143" class="edge">
<title>s2_ln1_22&#45;&gt;s3_ln0_30</title>
<path fill="none" stroke="black" d="M135469,-279.28C135469,-257.17 135469,-225.05 135469,-200.48"/>
<polygon fill="black" stroke="black" points="135472.5,-200.47 135469,-190.47 135465.5,-200.47 135472.5,-200.47"/>
</g>
<!-- s2_q_23 -->
<g id="node287" class="node">
<title>s2_q_23</title>
<polygon fill="lightyellow" stroke="black" points="136075.5,-332.45 135686.5,-332.45 135686.5,-279.45 136075.5,-279.45 136075.5,-332.45"/>
<text text-anchor="middle" x="135881" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: Q Linear</text>
<text text-anchor="middle" x="135881" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="135881" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_k_23 -->
<g id="node288" class="node">
<title>s2_k_23</title>
<polygon fill="lightyellow" stroke="black" points="136482.5,-332.45 136093.5,-332.45 136093.5,-279.45 136482.5,-279.45 136482.5,-332.45"/>
<text text-anchor="middle" x="136288" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: K Linear</text>
<text text-anchor="middle" x="136288" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="136288" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_v_23 -->
<g id="node289" class="node">
<title>s2_v_23</title>
<polygon fill="lightyellow" stroke="black" points="136889.5,-332.45 136500.5,-332.45 136500.5,-279.45 136889.5,-279.45 136889.5,-332.45"/>
<text text-anchor="middle" x="136695" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: V Linear</text>
<text text-anchor="middle" x="136695" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="136695" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s2_allgather_q_23 -->
<g id="node290" class="node">
<title>s2_allgather_q_23</title>
<ellipse fill="white" stroke="black" cx="137189" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="137189" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather Q</text>
<text text-anchor="middle" x="137189" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="137189" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_k_23 -->
<g id="node291" class="node">
<title>s2_allgather_k_23</title>
<ellipse fill="white" stroke="black" cx="137770" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="137770" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather K</text>
<text text-anchor="middle" x="137770" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="137770" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_allgather_v_23 -->
<g id="node292" class="node">
<title>s2_allgather_v_23</title>
<ellipse fill="white" stroke="black" cx="138351" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="138351" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather V</text>
<text text-anchor="middle" x="138351" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="138351" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_attn_23 -->
<g id="node293" class="node">
<title>s2_attn_23</title>
<polygon fill="lightyellow" stroke="black" points="139048,-332.45 138650,-332.45 138650,-279.45 139048,-279.45 139048,-332.45"/>
<text text-anchor="middle" x="138849" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: Attention</text>
<text text-anchor="middle" x="138849" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="138849" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_gate_23 -->
<g id="node294" class="node">
<title>s2_gate_23</title>
<polygon fill="orange" stroke="black" points="139866.37,-358.95 139229.47,-358.95 139065.63,-252.95 139702.53,-252.95 139866.37,-358.95"/>
<text text-anchor="middle" x="139466" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: MoE Gate</text>
<text text-anchor="middle" x="139466" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="139466" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s2_expert_23 -->
<g id="node295" class="node">
<title>s2_expert_23</title>
<polygon fill="lightyellow" stroke="black" points="140282,-332.45 139884,-332.45 139884,-279.45 140282,-279.45 140282,-332.45"/>
<text text-anchor="middle" x="140083" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: Expert FFN</text>
<text text-anchor="middle" x="140083" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="140083" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_alltoall_23 -->
<g id="node296" class="node">
<title>s2_alltoall_23</title>
<ellipse fill="white" stroke="black" cx="140581" cy="-305.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="140581" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: AllToAll</text>
<text text-anchor="middle" x="140581" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="140581" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_23 -->
<g id="node297" class="node">
<title>s2_ln1_23</title>
<polygon fill="lightyellow" stroke="black" points="141278,-332.45 140880,-332.45 140880,-279.45 141278,-279.45 141278,-332.45"/>
<text text-anchor="middle" x="141079" y="-317.25" font-family="Times,serif" font-size="14.00">GPU23: LayerNorm</text>
<text text-anchor="middle" x="141079" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="141079" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln0_31 -->
<g id="node382" class="node">
<title>s3_ln0_31</title>
<polygon fill="lightcoral" stroke="black" points="141278,-190.45 140880,-190.45 140880,-137.45 141278,-137.45 141278,-190.45"/>
<text text-anchor="middle" x="141079" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: LayerNorm</text>
<text text-anchor="middle" x="141079" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="141079" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s2_ln1_23&#45;&gt;s3_ln0_31 -->
<g id="edge144" class="edge">
<title>s2_ln1_23&#45;&gt;s3_ln0_31</title>
<path fill="none" stroke="black" d="M141079,-279.28C141079,-257.17 141079,-225.05 141079,-200.48"/>
<polygon fill="black" stroke="black" points="141082.5,-200.47 141079,-190.47 141075.5,-200.47 141082.5,-200.47"/>
</g>
<!-- s3_q_24 -->
<g id="node299" class="node">
<title>s3_q_24</title>
<polygon fill="lightcoral" stroke="black" points="141685.5,-190.45 141296.5,-190.45 141296.5,-137.45 141685.5,-137.45 141685.5,-190.45"/>
<text text-anchor="middle" x="141491" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Q Linear</text>
<text text-anchor="middle" x="141491" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="141491" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_24 -->
<g id="node300" class="node">
<title>s3_k_24</title>
<polygon fill="lightcoral" stroke="black" points="142092.5,-190.45 141703.5,-190.45 141703.5,-137.45 142092.5,-137.45 142092.5,-190.45"/>
<text text-anchor="middle" x="141898" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: K Linear</text>
<text text-anchor="middle" x="141898" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="141898" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_24 -->
<g id="node301" class="node">
<title>s3_v_24</title>
<polygon fill="lightcoral" stroke="black" points="142499.5,-190.45 142110.5,-190.45 142110.5,-137.45 142499.5,-137.45 142499.5,-190.45"/>
<text text-anchor="middle" x="142305" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: V Linear</text>
<text text-anchor="middle" x="142305" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="142305" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_24 -->
<g id="node302" class="node">
<title>s3_allgather_q_24</title>
<ellipse fill="white" stroke="black" cx="142799" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="142799" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather Q</text>
<text text-anchor="middle" x="142799" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="142799" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_24 -->
<g id="node303" class="node">
<title>s3_allgather_k_24</title>
<ellipse fill="white" stroke="black" cx="143380" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="143380" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather K</text>
<text text-anchor="middle" x="143380" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="143380" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_24 -->
<g id="node304" class="node">
<title>s3_allgather_v_24</title>
<ellipse fill="white" stroke="black" cx="143961" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="143961" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather V</text>
<text text-anchor="middle" x="143961" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="143961" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_24 -->
<g id="node305" class="node">
<title>s3_attn_24</title>
<polygon fill="lightcoral" stroke="black" points="144658,-190.45 144260,-190.45 144260,-137.45 144658,-137.45 144658,-190.45"/>
<text text-anchor="middle" x="144459" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Attention</text>
<text text-anchor="middle" x="144459" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="144459" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_24 -->
<g id="node306" class="node">
<title>s3_gate_24</title>
<polygon fill="orange" stroke="black" points="145476.37,-216.95 144839.47,-216.95 144675.63,-110.95 145312.53,-110.95 145476.37,-216.95"/>
<text text-anchor="middle" x="145076" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: MoE Gate</text>
<text text-anchor="middle" x="145076" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="145076" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_24 -->
<g id="node307" class="node">
<title>s3_expert_24</title>
<polygon fill="lightcoral" stroke="black" points="145892,-190.45 145494,-190.45 145494,-137.45 145892,-137.45 145892,-190.45"/>
<text text-anchor="middle" x="145693" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Expert FFN</text>
<text text-anchor="middle" x="145693" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="145693" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_24 -->
<g id="node308" class="node">
<title>s3_alltoall_24</title>
<ellipse fill="white" stroke="black" cx="146191" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="146191" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllToAll</text>
<text text-anchor="middle" x="146191" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="146191" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_24 -->
<g id="node309" class="node">
<title>s3_ln1_24</title>
<polygon fill="lightcoral" stroke="black" points="146888,-190.45 146490,-190.45 146490,-137.45 146888,-137.45 146888,-190.45"/>
<text text-anchor="middle" x="146689" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: LayerNorm</text>
<text text-anchor="middle" x="146689" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="146689" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- output -->
<g id="node394" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="148145" cy="-37.48" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="148145" y="-48.78" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="148145" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="148145" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_24&#45;&gt;output -->
<g id="edge145" class="edge">
<title>s3_ln1_24&#45;&gt;output</title>
<path fill="none" stroke="black" d="M146775.8,-137.4C146812.83,-127.51 146856.71,-117.1 146897,-110.95 147222.25,-61.3 147599.94,-45.04 147853.9,-40.03"/>
<polygon fill="black" stroke="black" points="147854.08,-43.53 147864.01,-39.84 147853.94,-36.53 147854.08,-43.53"/>
</g>
<!-- s3_q_25 -->
<g id="node311" class="node">
<title>s3_q_25</title>
<polygon fill="lightcoral" stroke="black" points="150207.5,-190.45 149818.5,-190.45 149818.5,-137.45 150207.5,-137.45 150207.5,-190.45"/>
<text text-anchor="middle" x="150013" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Q Linear</text>
<text text-anchor="middle" x="150013" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="150013" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_25 -->
<g id="node312" class="node">
<title>s3_k_25</title>
<polygon fill="lightcoral" stroke="black" points="150614.5,-190.45 150225.5,-190.45 150225.5,-137.45 150614.5,-137.45 150614.5,-190.45"/>
<text text-anchor="middle" x="150420" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: K Linear</text>
<text text-anchor="middle" x="150420" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="150420" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_25 -->
<g id="node313" class="node">
<title>s3_v_25</title>
<polygon fill="lightcoral" stroke="black" points="151021.5,-190.45 150632.5,-190.45 150632.5,-137.45 151021.5,-137.45 151021.5,-190.45"/>
<text text-anchor="middle" x="150827" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: V Linear</text>
<text text-anchor="middle" x="150827" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="150827" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_25 -->
<g id="node314" class="node">
<title>s3_allgather_q_25</title>
<ellipse fill="white" stroke="black" cx="151321" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="151321" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather Q</text>
<text text-anchor="middle" x="151321" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="151321" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_25 -->
<g id="node315" class="node">
<title>s3_allgather_k_25</title>
<ellipse fill="white" stroke="black" cx="151902" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="151902" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather K</text>
<text text-anchor="middle" x="151902" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="151902" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_25 -->
<g id="node316" class="node">
<title>s3_allgather_v_25</title>
<ellipse fill="white" stroke="black" cx="152483" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="152483" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather V</text>
<text text-anchor="middle" x="152483" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="152483" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_25 -->
<g id="node317" class="node">
<title>s3_attn_25</title>
<polygon fill="lightcoral" stroke="black" points="153180,-190.45 152782,-190.45 152782,-137.45 153180,-137.45 153180,-190.45"/>
<text text-anchor="middle" x="152981" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Attention</text>
<text text-anchor="middle" x="152981" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="152981" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_25 -->
<g id="node318" class="node">
<title>s3_gate_25</title>
<polygon fill="orange" stroke="black" points="153998.37,-216.95 153361.47,-216.95 153197.63,-110.95 153834.53,-110.95 153998.37,-216.95"/>
<text text-anchor="middle" x="153598" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: MoE Gate</text>
<text text-anchor="middle" x="153598" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="153598" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_25 -->
<g id="node319" class="node">
<title>s3_expert_25</title>
<polygon fill="lightcoral" stroke="black" points="154414,-190.45 154016,-190.45 154016,-137.45 154414,-137.45 154414,-190.45"/>
<text text-anchor="middle" x="154215" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Expert FFN</text>
<text text-anchor="middle" x="154215" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="154215" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_25 -->
<g id="node320" class="node">
<title>s3_alltoall_25</title>
<ellipse fill="white" stroke="black" cx="154713" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="154713" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllToAll</text>
<text text-anchor="middle" x="154713" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="154713" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_25 -->
<g id="node321" class="node">
<title>s3_ln1_25</title>
<polygon fill="lightcoral" stroke="black" points="147304,-190.45 146906,-190.45 146906,-137.45 147304,-137.45 147304,-190.45"/>
<text text-anchor="middle" x="147105" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: LayerNorm</text>
<text text-anchor="middle" x="147105" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="147105" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_25&#45;&gt;output -->
<g id="edge146" class="edge">
<title>s3_ln1_25&#45;&gt;output</title>
<path fill="none" stroke="black" d="M147193.93,-137.43C147230.54,-127.79 147273.54,-117.56 147313,-110.95 147497.89,-79.99 147708.24,-61.81 147871.18,-51.41"/>
<polygon fill="black" stroke="black" points="147871.59,-54.89 147881.35,-50.77 147871.15,-47.9 147871.59,-54.89"/>
</g>
<!-- s3_q_26 -->
<g id="node323" class="node">
<title>s3_q_26</title>
<polygon fill="lightcoral" stroke="black" points="155401.5,-190.45 155012.5,-190.45 155012.5,-137.45 155401.5,-137.45 155401.5,-190.45"/>
<text text-anchor="middle" x="155207" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Q Linear</text>
<text text-anchor="middle" x="155207" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="155207" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_26 -->
<g id="node324" class="node">
<title>s3_k_26</title>
<polygon fill="lightcoral" stroke="black" points="155808.5,-190.45 155419.5,-190.45 155419.5,-137.45 155808.5,-137.45 155808.5,-190.45"/>
<text text-anchor="middle" x="155614" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: K Linear</text>
<text text-anchor="middle" x="155614" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="155614" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_26 -->
<g id="node325" class="node">
<title>s3_v_26</title>
<polygon fill="lightcoral" stroke="black" points="156215.5,-190.45 155826.5,-190.45 155826.5,-137.45 156215.5,-137.45 156215.5,-190.45"/>
<text text-anchor="middle" x="156021" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: V Linear</text>
<text text-anchor="middle" x="156021" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="156021" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_26 -->
<g id="node326" class="node">
<title>s3_allgather_q_26</title>
<ellipse fill="white" stroke="black" cx="156515" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="156515" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather Q</text>
<text text-anchor="middle" x="156515" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="156515" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_26 -->
<g id="node327" class="node">
<title>s3_allgather_k_26</title>
<ellipse fill="white" stroke="black" cx="157096" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="157096" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather K</text>
<text text-anchor="middle" x="157096" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="157096" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_26 -->
<g id="node328" class="node">
<title>s3_allgather_v_26</title>
<ellipse fill="white" stroke="black" cx="157677" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="157677" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather V</text>
<text text-anchor="middle" x="157677" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="157677" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_26 -->
<g id="node329" class="node">
<title>s3_attn_26</title>
<polygon fill="lightcoral" stroke="black" points="158374,-190.45 157976,-190.45 157976,-137.45 158374,-137.45 158374,-190.45"/>
<text text-anchor="middle" x="158175" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Attention</text>
<text text-anchor="middle" x="158175" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="158175" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_26 -->
<g id="node330" class="node">
<title>s3_gate_26</title>
<polygon fill="orange" stroke="black" points="159192.37,-216.95 158555.47,-216.95 158391.63,-110.95 159028.53,-110.95 159192.37,-216.95"/>
<text text-anchor="middle" x="158792" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: MoE Gate</text>
<text text-anchor="middle" x="158792" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="158792" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_26 -->
<g id="node331" class="node">
<title>s3_expert_26</title>
<polygon fill="lightcoral" stroke="black" points="159608,-190.45 159210,-190.45 159210,-137.45 159608,-137.45 159608,-190.45"/>
<text text-anchor="middle" x="159409" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Expert FFN</text>
<text text-anchor="middle" x="159409" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="159409" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_26 -->
<g id="node332" class="node">
<title>s3_alltoall_26</title>
<ellipse fill="white" stroke="black" cx="159907" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="159907" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllToAll</text>
<text text-anchor="middle" x="159907" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="159907" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_26 -->
<g id="node333" class="node">
<title>s3_ln1_26</title>
<polygon fill="lightcoral" stroke="black" points="147720,-190.45 147322,-190.45 147322,-137.45 147720,-137.45 147720,-190.45"/>
<text text-anchor="middle" x="147521" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: LayerNorm</text>
<text text-anchor="middle" x="147521" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="147521" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_26&#45;&gt;output -->
<g id="edge147" class="edge">
<title>s3_ln1_26&#45;&gt;output</title>
<path fill="none" stroke="black" d="M147616.97,-137.42C147652.09,-128.48 147692.22,-118.74 147729,-110.95 147803.23,-95.23 147885.45,-80.37 147957.05,-68.25"/>
<polygon fill="black" stroke="black" points="147957.8,-71.67 147967.08,-66.56 147956.64,-64.77 147957.8,-71.67"/>
</g>
<!-- s3_q_27 -->
<g id="node335" class="node">
<title>s3_q_27</title>
<polygon fill="lightcoral" stroke="black" points="160595.5,-190.45 160206.5,-190.45 160206.5,-137.45 160595.5,-137.45 160595.5,-190.45"/>
<text text-anchor="middle" x="160401" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Q Linear</text>
<text text-anchor="middle" x="160401" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="160401" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_27 -->
<g id="node336" class="node">
<title>s3_k_27</title>
<polygon fill="lightcoral" stroke="black" points="161002.5,-190.45 160613.5,-190.45 160613.5,-137.45 161002.5,-137.45 161002.5,-190.45"/>
<text text-anchor="middle" x="160808" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: K Linear</text>
<text text-anchor="middle" x="160808" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="160808" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_27 -->
<g id="node337" class="node">
<title>s3_v_27</title>
<polygon fill="lightcoral" stroke="black" points="161409.5,-190.45 161020.5,-190.45 161020.5,-137.45 161409.5,-137.45 161409.5,-190.45"/>
<text text-anchor="middle" x="161215" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: V Linear</text>
<text text-anchor="middle" x="161215" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="161215" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_27 -->
<g id="node338" class="node">
<title>s3_allgather_q_27</title>
<ellipse fill="white" stroke="black" cx="161709" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="161709" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather Q</text>
<text text-anchor="middle" x="161709" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="161709" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_27 -->
<g id="node339" class="node">
<title>s3_allgather_k_27</title>
<ellipse fill="white" stroke="black" cx="162290" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="162290" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather K</text>
<text text-anchor="middle" x="162290" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="162290" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_27 -->
<g id="node340" class="node">
<title>s3_allgather_v_27</title>
<ellipse fill="white" stroke="black" cx="162871" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="162871" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather V</text>
<text text-anchor="middle" x="162871" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="162871" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_27 -->
<g id="node341" class="node">
<title>s3_attn_27</title>
<polygon fill="lightcoral" stroke="black" points="163568,-190.45 163170,-190.45 163170,-137.45 163568,-137.45 163568,-190.45"/>
<text text-anchor="middle" x="163369" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Attention</text>
<text text-anchor="middle" x="163369" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="163369" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_27 -->
<g id="node342" class="node">
<title>s3_gate_27</title>
<polygon fill="orange" stroke="black" points="164386.37,-216.95 163749.47,-216.95 163585.63,-110.95 164222.53,-110.95 164386.37,-216.95"/>
<text text-anchor="middle" x="163986" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: MoE Gate</text>
<text text-anchor="middle" x="163986" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="163986" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_27 -->
<g id="node343" class="node">
<title>s3_expert_27</title>
<polygon fill="lightcoral" stroke="black" points="164802,-190.45 164404,-190.45 164404,-137.45 164802,-137.45 164802,-190.45"/>
<text text-anchor="middle" x="164603" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Expert FFN</text>
<text text-anchor="middle" x="164603" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="164603" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_27 -->
<g id="node344" class="node">
<title>s3_alltoall_27</title>
<ellipse fill="white" stroke="black" cx="165101" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="165101" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllToAll</text>
<text text-anchor="middle" x="165101" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="165101" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_27 -->
<g id="node345" class="node">
<title>s3_ln1_27</title>
<polygon fill="lightcoral" stroke="black" points="148136,-190.45 147738,-190.45 147738,-137.45 148136,-137.45 148136,-190.45"/>
<text text-anchor="middle" x="147937" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: LayerNorm</text>
<text text-anchor="middle" x="147937" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="147937" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_27&#45;&gt;output -->
<g id="edge148" class="edge">
<title>s3_ln1_27&#45;&gt;output</title>
<path fill="none" stroke="black" d="M147979.85,-137.31C148007.67,-120.66 148044.56,-98.58 148076.42,-79.52"/>
<polygon fill="black" stroke="black" points="148078.47,-82.37 148085.26,-74.23 148074.88,-76.36 148078.47,-82.37"/>
</g>
<!-- s3_q_28 -->
<g id="node347" class="node">
<title>s3_q_28</title>
<polygon fill="lightcoral" stroke="black" points="165789.5,-190.45 165400.5,-190.45 165400.5,-137.45 165789.5,-137.45 165789.5,-190.45"/>
<text text-anchor="middle" x="165595" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Q Linear</text>
<text text-anchor="middle" x="165595" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="165595" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_28 -->
<g id="node348" class="node">
<title>s3_k_28</title>
<polygon fill="lightcoral" stroke="black" points="166196.5,-190.45 165807.5,-190.45 165807.5,-137.45 166196.5,-137.45 166196.5,-190.45"/>
<text text-anchor="middle" x="166002" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: K Linear</text>
<text text-anchor="middle" x="166002" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="166002" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_28 -->
<g id="node349" class="node">
<title>s3_v_28</title>
<polygon fill="lightcoral" stroke="black" points="166603.5,-190.45 166214.5,-190.45 166214.5,-137.45 166603.5,-137.45 166603.5,-190.45"/>
<text text-anchor="middle" x="166409" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: V Linear</text>
<text text-anchor="middle" x="166409" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="166409" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_28 -->
<g id="node350" class="node">
<title>s3_allgather_q_28</title>
<ellipse fill="white" stroke="black" cx="166903" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="166903" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather Q</text>
<text text-anchor="middle" x="166903" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="166903" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_28 -->
<g id="node351" class="node">
<title>s3_allgather_k_28</title>
<ellipse fill="white" stroke="black" cx="167484" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="167484" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather K</text>
<text text-anchor="middle" x="167484" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="167484" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_28 -->
<g id="node352" class="node">
<title>s3_allgather_v_28</title>
<ellipse fill="white" stroke="black" cx="168065" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="168065" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather V</text>
<text text-anchor="middle" x="168065" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="168065" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_28 -->
<g id="node353" class="node">
<title>s3_attn_28</title>
<polygon fill="lightcoral" stroke="black" points="168762,-190.45 168364,-190.45 168364,-137.45 168762,-137.45 168762,-190.45"/>
<text text-anchor="middle" x="168563" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Attention</text>
<text text-anchor="middle" x="168563" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="168563" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_28 -->
<g id="node354" class="node">
<title>s3_gate_28</title>
<polygon fill="orange" stroke="black" points="169580.37,-216.95 168943.47,-216.95 168779.63,-110.95 169416.53,-110.95 169580.37,-216.95"/>
<text text-anchor="middle" x="169180" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: MoE Gate</text>
<text text-anchor="middle" x="169180" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="169180" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_28 -->
<g id="node355" class="node">
<title>s3_expert_28</title>
<polygon fill="lightcoral" stroke="black" points="169996,-190.45 169598,-190.45 169598,-137.45 169996,-137.45 169996,-190.45"/>
<text text-anchor="middle" x="169797" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Expert FFN</text>
<text text-anchor="middle" x="169797" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="169797" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_28 -->
<g id="node356" class="node">
<title>s3_alltoall_28</title>
<ellipse fill="white" stroke="black" cx="170295" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="170295" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllToAll</text>
<text text-anchor="middle" x="170295" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="170295" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_28 -->
<g id="node357" class="node">
<title>s3_ln1_28</title>
<polygon fill="lightcoral" stroke="black" points="148552,-190.45 148154,-190.45 148154,-137.45 148552,-137.45 148552,-190.45"/>
<text text-anchor="middle" x="148353" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: LayerNorm</text>
<text text-anchor="middle" x="148353" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="148353" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_28&#45;&gt;output -->
<g id="edge149" class="edge">
<title>s3_ln1_28&#45;&gt;output</title>
<path fill="none" stroke="black" d="M148310.15,-137.31C148282.33,-120.66 148245.44,-98.58 148213.58,-79.52"/>
<polygon fill="black" stroke="black" points="148215.12,-76.36 148204.74,-74.23 148211.53,-82.37 148215.12,-76.36"/>
</g>
<!-- s3_q_29 -->
<g id="node359" class="node">
<title>s3_q_29</title>
<polygon fill="lightcoral" stroke="black" points="170983.5,-190.45 170594.5,-190.45 170594.5,-137.45 170983.5,-137.45 170983.5,-190.45"/>
<text text-anchor="middle" x="170789" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Q Linear</text>
<text text-anchor="middle" x="170789" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="170789" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_29 -->
<g id="node360" class="node">
<title>s3_k_29</title>
<polygon fill="lightcoral" stroke="black" points="171390.5,-190.45 171001.5,-190.45 171001.5,-137.45 171390.5,-137.45 171390.5,-190.45"/>
<text text-anchor="middle" x="171196" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: K Linear</text>
<text text-anchor="middle" x="171196" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="171196" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_29 -->
<g id="node361" class="node">
<title>s3_v_29</title>
<polygon fill="lightcoral" stroke="black" points="171797.5,-190.45 171408.5,-190.45 171408.5,-137.45 171797.5,-137.45 171797.5,-190.45"/>
<text text-anchor="middle" x="171603" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: V Linear</text>
<text text-anchor="middle" x="171603" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="171603" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_29 -->
<g id="node362" class="node">
<title>s3_allgather_q_29</title>
<ellipse fill="white" stroke="black" cx="172097" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="172097" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather Q</text>
<text text-anchor="middle" x="172097" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="172097" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_29 -->
<g id="node363" class="node">
<title>s3_allgather_k_29</title>
<ellipse fill="white" stroke="black" cx="172678" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="172678" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather K</text>
<text text-anchor="middle" x="172678" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="172678" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_29 -->
<g id="node364" class="node">
<title>s3_allgather_v_29</title>
<ellipse fill="white" stroke="black" cx="173259" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="173259" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather V</text>
<text text-anchor="middle" x="173259" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="173259" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_29 -->
<g id="node365" class="node">
<title>s3_attn_29</title>
<polygon fill="lightcoral" stroke="black" points="173956,-190.45 173558,-190.45 173558,-137.45 173956,-137.45 173956,-190.45"/>
<text text-anchor="middle" x="173757" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Attention</text>
<text text-anchor="middle" x="173757" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="173757" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_29 -->
<g id="node366" class="node">
<title>s3_gate_29</title>
<polygon fill="orange" stroke="black" points="174774.37,-216.95 174137.47,-216.95 173973.63,-110.95 174610.53,-110.95 174774.37,-216.95"/>
<text text-anchor="middle" x="174374" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: MoE Gate</text>
<text text-anchor="middle" x="174374" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="174374" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_29 -->
<g id="node367" class="node">
<title>s3_expert_29</title>
<polygon fill="lightcoral" stroke="black" points="175190,-190.45 174792,-190.45 174792,-137.45 175190,-137.45 175190,-190.45"/>
<text text-anchor="middle" x="174991" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Expert FFN</text>
<text text-anchor="middle" x="174991" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="174991" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_29 -->
<g id="node368" class="node">
<title>s3_alltoall_29</title>
<ellipse fill="white" stroke="black" cx="175489" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="175489" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllToAll</text>
<text text-anchor="middle" x="175489" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="175489" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_29 -->
<g id="node369" class="node">
<title>s3_ln1_29</title>
<polygon fill="lightcoral" stroke="black" points="148968,-190.45 148570,-190.45 148570,-137.45 148968,-137.45 148968,-190.45"/>
<text text-anchor="middle" x="148769" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: LayerNorm</text>
<text text-anchor="middle" x="148769" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="148769" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_29&#45;&gt;output -->
<g id="edge150" class="edge">
<title>s3_ln1_29&#45;&gt;output</title>
<path fill="none" stroke="black" d="M148673.03,-137.42C148637.91,-128.48 148597.78,-118.74 148561,-110.95 148486.77,-95.23 148404.55,-80.37 148332.95,-68.25"/>
<polygon fill="black" stroke="black" points="148333.36,-64.77 148322.92,-66.56 148332.2,-71.67 148333.36,-64.77"/>
</g>
<!-- s3_q_30 -->
<g id="node371" class="node">
<title>s3_q_30</title>
<polygon fill="lightcoral" stroke="black" points="176177.5,-190.45 175788.5,-190.45 175788.5,-137.45 176177.5,-137.45 176177.5,-190.45"/>
<text text-anchor="middle" x="175983" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Q Linear</text>
<text text-anchor="middle" x="175983" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="175983" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_30 -->
<g id="node372" class="node">
<title>s3_k_30</title>
<polygon fill="lightcoral" stroke="black" points="176584.5,-190.45 176195.5,-190.45 176195.5,-137.45 176584.5,-137.45 176584.5,-190.45"/>
<text text-anchor="middle" x="176390" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: K Linear</text>
<text text-anchor="middle" x="176390" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="176390" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_30 -->
<g id="node373" class="node">
<title>s3_v_30</title>
<polygon fill="lightcoral" stroke="black" points="176991.5,-190.45 176602.5,-190.45 176602.5,-137.45 176991.5,-137.45 176991.5,-190.45"/>
<text text-anchor="middle" x="176797" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: V Linear</text>
<text text-anchor="middle" x="176797" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="176797" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_30 -->
<g id="node374" class="node">
<title>s3_allgather_q_30</title>
<ellipse fill="white" stroke="black" cx="177291" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="177291" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather Q</text>
<text text-anchor="middle" x="177291" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="177291" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_30 -->
<g id="node375" class="node">
<title>s3_allgather_k_30</title>
<ellipse fill="white" stroke="black" cx="177872" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="177872" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather K</text>
<text text-anchor="middle" x="177872" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="177872" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_30 -->
<g id="node376" class="node">
<title>s3_allgather_v_30</title>
<ellipse fill="white" stroke="black" cx="178453" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="178453" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather V</text>
<text text-anchor="middle" x="178453" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="178453" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_30 -->
<g id="node377" class="node">
<title>s3_attn_30</title>
<polygon fill="lightcoral" stroke="black" points="179150,-190.45 178752,-190.45 178752,-137.45 179150,-137.45 179150,-190.45"/>
<text text-anchor="middle" x="178951" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Attention</text>
<text text-anchor="middle" x="178951" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="178951" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_30 -->
<g id="node378" class="node">
<title>s3_gate_30</title>
<polygon fill="orange" stroke="black" points="179968.37,-216.95 179331.47,-216.95 179167.63,-110.95 179804.53,-110.95 179968.37,-216.95"/>
<text text-anchor="middle" x="179568" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: MoE Gate</text>
<text text-anchor="middle" x="179568" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="179568" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_30 -->
<g id="node379" class="node">
<title>s3_expert_30</title>
<polygon fill="lightcoral" stroke="black" points="180384,-190.45 179986,-190.45 179986,-137.45 180384,-137.45 180384,-190.45"/>
<text text-anchor="middle" x="180185" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Expert FFN</text>
<text text-anchor="middle" x="180185" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="180185" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_30 -->
<g id="node380" class="node">
<title>s3_alltoall_30</title>
<ellipse fill="white" stroke="black" cx="180683" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="180683" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllToAll</text>
<text text-anchor="middle" x="180683" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="180683" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_30 -->
<g id="node381" class="node">
<title>s3_ln1_30</title>
<polygon fill="lightcoral" stroke="black" points="149384,-190.45 148986,-190.45 148986,-137.45 149384,-137.45 149384,-190.45"/>
<text text-anchor="middle" x="149185" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: LayerNorm</text>
<text text-anchor="middle" x="149185" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="149185" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_30&#45;&gt;output -->
<g id="edge151" class="edge">
<title>s3_ln1_30&#45;&gt;output</title>
<path fill="none" stroke="black" d="M149096.07,-137.43C149059.46,-127.79 149016.46,-117.56 148977,-110.95 148792.11,-79.99 148581.76,-61.81 148418.82,-51.41"/>
<polygon fill="black" stroke="black" points="148418.85,-47.9 148408.65,-50.77 148418.41,-54.89 148418.85,-47.9"/>
</g>
<!-- s3_q_31 -->
<g id="node383" class="node">
<title>s3_q_31</title>
<polygon fill="lightcoral" stroke="black" points="181371.5,-190.45 180982.5,-190.45 180982.5,-137.45 181371.5,-137.45 181371.5,-190.45"/>
<text text-anchor="middle" x="181177" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Q Linear</text>
<text text-anchor="middle" x="181177" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="181177" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_k_31 -->
<g id="node384" class="node">
<title>s3_k_31</title>
<polygon fill="lightcoral" stroke="black" points="181778.5,-190.45 181389.5,-190.45 181389.5,-137.45 181778.5,-137.45 181778.5,-190.45"/>
<text text-anchor="middle" x="181584" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: K Linear</text>
<text text-anchor="middle" x="181584" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="181584" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_v_31 -->
<g id="node385" class="node">
<title>s3_v_31</title>
<polygon fill="lightcoral" stroke="black" points="182185.5,-190.45 181796.5,-190.45 181796.5,-137.45 182185.5,-137.45 182185.5,-190.45"/>
<text text-anchor="middle" x="181991" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: V Linear</text>
<text text-anchor="middle" x="181991" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="181991" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=768]</text>
</g>
<!-- s3_allgather_q_31 -->
<g id="node386" class="node">
<title>s3_allgather_q_31</title>
<ellipse fill="white" stroke="black" cx="182485" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="182485" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather Q</text>
<text text-anchor="middle" x="182485" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="182485" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_k_31 -->
<g id="node387" class="node">
<title>s3_allgather_k_31</title>
<ellipse fill="white" stroke="black" cx="183066" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="183066" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather K</text>
<text text-anchor="middle" x="183066" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="183066" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_allgather_v_31 -->
<g id="node388" class="node">
<title>s3_allgather_v_31</title>
<ellipse fill="white" stroke="black" cx="183647" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="183647" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather V</text>
<text text-anchor="middle" x="183647" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=768]</text>
<text text-anchor="middle" x="183647" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_attn_31 -->
<g id="node389" class="node">
<title>s3_attn_31</title>
<polygon fill="lightcoral" stroke="black" points="184344,-190.45 183946,-190.45 183946,-137.45 184344,-137.45 184344,-190.45"/>
<text text-anchor="middle" x="184145" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Attention</text>
<text text-anchor="middle" x="184145" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="184145" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_gate_31 -->
<g id="node390" class="node">
<title>s3_gate_31</title>
<polygon fill="orange" stroke="black" points="185162.37,-216.95 184525.47,-216.95 184361.63,-110.95 184998.53,-110.95 185162.37,-216.95"/>
<text text-anchor="middle" x="184762" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: MoE Gate</text>
<text text-anchor="middle" x="184762" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="184762" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, experts=8]</text>
</g>
<!-- s3_expert_31 -->
<g id="node391" class="node">
<title>s3_expert_31</title>
<polygon fill="lightcoral" stroke="black" points="185578,-190.45 185180,-190.45 185180,-137.45 185578,-137.45 185578,-190.45"/>
<text text-anchor="middle" x="185379" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Expert FFN</text>
<text text-anchor="middle" x="185379" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="185379" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_alltoall_31 -->
<g id="node392" class="node">
<title>s3_alltoall_31</title>
<ellipse fill="white" stroke="black" cx="185877" cy="-163.95" rx="281.36" ry="37.45"/>
<text text-anchor="middle" x="185877" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllToAll</text>
<text text-anchor="middle" x="185877" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="185877" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_31 -->
<g id="node393" class="node">
<title>s3_ln1_31</title>
<polygon fill="lightcoral" stroke="black" points="149800,-190.45 149402,-190.45 149402,-137.45 149800,-137.45 149800,-190.45"/>
<text text-anchor="middle" x="149601" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: LayerNorm</text>
<text text-anchor="middle" x="149601" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=4096, hidden=6144]</text>
<text text-anchor="middle" x="149601" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=4096, hidden=6144]</text>
</g>
<!-- s3_ln1_31&#45;&gt;output -->
<g id="edge152" class="edge">
<title>s3_ln1_31&#45;&gt;output</title>
<path fill="none" stroke="black" d="M149514.2,-137.4C149477.17,-127.51 149433.29,-117.1 149393,-110.95 149067.75,-61.3 148690.06,-45.04 148436.1,-40.03"/>
<polygon fill="black" stroke="black" points="148436.06,-36.53 148425.99,-39.84 148435.92,-43.53 148436.06,-36.53"/>
</g>
</g>
</svg>
