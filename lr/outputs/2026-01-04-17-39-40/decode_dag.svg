<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="4pt"
 viewBox="0.00 0.00 1440.00 3.80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.01 0.01) rotate(0) translate(4 473.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-473.91 181041.84,-473.91 181041.84,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="45537.5" cy="-432.43" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="45537.5" y="-443.73" font-family="Times,serif" font-size="14.00">INPUT</text>
<text text-anchor="middle" x="45537.5" y="-428.73" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="45537.5" y="-413.73" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_0 -->
<g id="node2" class="node">
<title>s0_emb_0</title>
<polygon fill="lightblue" stroke="black" points="371,-332.45 0,-332.45 0,-279.45 371,-279.45 371,-332.45"/>
<text text-anchor="middle" x="185.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: Embedding (DP0)</text>
<text text-anchor="middle" x="185.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="185.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;s0_emb_0</title>
<path fill="none" stroke="black" d="M45275.2,-431.48C41619.62,-432.14 973.29,-437.64 379.5,-358.95 343.79,-354.22 305.31,-344.84 272.11,-335.33"/>
<polygon fill="black" stroke="black" points="273.02,-331.95 262.44,-332.52 271.07,-338.68 273.02,-331.95"/>
</g>
<!-- s0_emb_1 -->
<g id="node15" class="node">
<title>s0_emb_1</title>
<polygon fill="lightblue" stroke="black" points="6418,-332.45 6047,-332.45 6047,-279.45 6418,-279.45 6418,-332.45"/>
<text text-anchor="middle" x="6232.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: Embedding (DP0)</text>
<text text-anchor="middle" x="6232.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="6232.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_1 -->
<g id="edge16" class="edge">
<title>input&#45;&gt;s0_emb_1</title>
<path fill="none" stroke="black" d="M45275.1,-431.41C41892.71,-431.16 6938.93,-426.92 6426.5,-358.95 6390.79,-354.22 6352.31,-344.84 6319.11,-335.33"/>
<polygon fill="black" stroke="black" points="6320.02,-331.95 6309.44,-332.52 6318.07,-338.67 6320.02,-331.95"/>
</g>
<!-- s0_emb_2 -->
<g id="node28" class="node">
<title>s0_emb_2</title>
<polygon fill="lightblue" stroke="black" points="12465,-332.45 12094,-332.45 12094,-279.45 12465,-279.45 12465,-332.45"/>
<text text-anchor="middle" x="12279.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: Embedding (DP0)</text>
<text text-anchor="middle" x="12279.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="12279.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_2 -->
<g id="edge31" class="edge">
<title>input&#45;&gt;s0_emb_2</title>
<path fill="none" stroke="black" d="M45275.25,-431.32C42189.6,-430.03 12904.73,-416.23 12473.5,-358.95 12437.79,-354.21 12399.31,-344.83 12366.11,-335.32"/>
<polygon fill="black" stroke="black" points="12367.02,-331.94 12356.44,-332.51 12365.07,-338.66 12367.02,-331.94"/>
</g>
<!-- s0_emb_3 -->
<g id="node41" class="node">
<title>s0_emb_3</title>
<polygon fill="lightblue" stroke="black" points="18512,-332.45 18141,-332.45 18141,-279.45 18512,-279.45 18512,-332.45"/>
<text text-anchor="middle" x="18326.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: Embedding (DP0)</text>
<text text-anchor="middle" x="18326.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="18326.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_3 -->
<g id="edge46" class="edge">
<title>input&#45;&gt;s0_emb_3</title>
<path fill="none" stroke="black" d="M45275.05,-431.19C42512.9,-428.65 18870.72,-405.55 18520.5,-358.95 18484.79,-354.2 18446.31,-344.82 18413.11,-335.31"/>
<polygon fill="black" stroke="black" points="18414.02,-331.93 18403.44,-332.5 18412.07,-338.65 18414.02,-331.93"/>
</g>
<!-- s0_emb_4 -->
<g id="node54" class="node">
<title>s0_emb_4</title>
<polygon fill="lightblue" stroke="black" points="24559,-332.45 24188,-332.45 24188,-279.45 24559,-279.45 24559,-332.45"/>
<text text-anchor="middle" x="24373.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: Embedding (DP1)</text>
<text text-anchor="middle" x="24373.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="24373.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_4 -->
<g id="edge61" class="edge">
<title>input&#45;&gt;s0_emb_4</title>
<path fill="none" stroke="black" d="M45274.84,-431.47C42893.21,-431.68 25106.19,-430.84 24567.5,-358.95 24531.8,-354.19 24493.32,-344.8 24460.12,-335.3"/>
<polygon fill="black" stroke="black" points="24461.03,-331.92 24450.45,-332.49 24459.07,-338.64 24461.03,-331.92"/>
</g>
<!-- s0_emb_5 -->
<g id="node67" class="node">
<title>s0_emb_5</title>
<polygon fill="lightblue" stroke="black" points="30606,-332.45 30235,-332.45 30235,-279.45 30606,-279.45 30606,-332.45"/>
<text text-anchor="middle" x="30420.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: Embedding (DP1)</text>
<text text-anchor="middle" x="30420.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="30420.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_5 -->
<g id="edge76" class="edge">
<title>input&#45;&gt;s0_emb_5</title>
<path fill="none" stroke="black" d="M45274.97,-431.09C43311.88,-428.42 30992.58,-409.68 30614.5,-358.95 30578.8,-354.16 30540.32,-344.77 30507.12,-335.27"/>
<polygon fill="black" stroke="black" points="30508.03,-331.89 30497.45,-332.46 30506.08,-338.61 30508.03,-331.89"/>
</g>
<!-- s0_emb_6 -->
<g id="node80" class="node">
<title>s0_emb_6</title>
<polygon fill="lightblue" stroke="black" points="36653,-332.45 36282,-332.45 36282,-279.45 36653,-279.45 36653,-332.45"/>
<text text-anchor="middle" x="36467.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: Embedding (DP1)</text>
<text text-anchor="middle" x="36467.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="36467.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_6 -->
<g id="edge91" class="edge">
<title>input&#45;&gt;s0_emb_6</title>
<path fill="none" stroke="black" d="M45275.26,-431.16C43851.54,-429.47 37098.45,-418.31 36661.5,-358.95 36625.96,-354.13 36587.67,-344.78 36554.57,-335.33"/>
<polygon fill="black" stroke="black" points="36555.5,-331.96 36544.92,-332.54 36553.55,-338.68 36555.5,-331.96"/>
</g>
<!-- s0_emb_7 -->
<g id="node93" class="node">
<title>s0_emb_7</title>
<polygon fill="lightblue" stroke="black" points="42700,-332.45 42329,-332.45 42329,-279.45 42700,-279.45 42700,-332.45"/>
<text text-anchor="middle" x="42514.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: Embedding (DP1)</text>
<text text-anchor="middle" x="42514.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="42514.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_7 -->
<g id="edge106" class="edge">
<title>input&#45;&gt;s0_emb_7</title>
<path fill="none" stroke="black" d="M45276.57,-428.26C44624.43,-419.84 42957.89,-395.05 42708.5,-358.95 42673.47,-353.88 42635.72,-344.66 42602.92,-335.37"/>
<polygon fill="black" stroke="black" points="42603.48,-331.89 42592.9,-332.49 42601.55,-338.62 42603.48,-331.89"/>
</g>
<!-- s0_emb_8 -->
<g id="node106" class="node">
<title>s0_emb_8</title>
<polygon fill="lightblue" stroke="black" points="48747,-332.45 48376,-332.45 48376,-279.45 48747,-279.45 48747,-332.45"/>
<text text-anchor="middle" x="48561.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: Embedding (DP2)</text>
<text text-anchor="middle" x="48561.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="48561.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_8 -->
<g id="edge121" class="edge">
<title>input&#45;&gt;s0_emb_8</title>
<path fill="none" stroke="black" d="M45798.43,-428.24C46450.57,-419.78 48117.09,-394.89 48366.5,-358.95 48401.85,-353.86 48439.97,-344.58 48473.04,-335.25"/>
<polygon fill="black" stroke="black" points="48474.03,-338.61 48482.68,-332.49 48472.11,-331.88 48474.03,-338.61"/>
</g>
<!-- s0_emb_9 -->
<g id="node119" class="node">
<title>s0_emb_9</title>
<polygon fill="lightblue" stroke="black" points="54794,-332.45 54423,-332.45 54423,-279.45 54794,-279.45 54794,-332.45"/>
<text text-anchor="middle" x="54608.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: Embedding (DP2)</text>
<text text-anchor="middle" x="54608.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="54608.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_9 -->
<g id="edge136" class="edge">
<title>input&#45;&gt;s0_emb_9</title>
<path fill="none" stroke="black" d="M45799.74,-431.15C47223.45,-429.41 53976.51,-418.03 54413.5,-358.95 54449.21,-354.13 54487.7,-344.78 54520.97,-335.33"/>
<polygon fill="black" stroke="black" points="54522.03,-338.67 54530.67,-332.54 54520.09,-331.95 54522.03,-338.67"/>
</g>
<!-- s0_emb_10 -->
<g id="node132" class="node">
<title>s0_emb_10</title>
<polygon fill="lightblue" stroke="black" points="60841,-332.45 60470,-332.45 60470,-279.45 60841,-279.45 60841,-332.45"/>
<text text-anchor="middle" x="60655.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: Embedding (DP2)</text>
<text text-anchor="middle" x="60655.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="60655.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_10 -->
<g id="edge151" class="edge">
<title>input&#45;&gt;s0_emb_10</title>
<path fill="none" stroke="black" d="M45800.03,-431.08C47763.11,-428.38 60082.39,-409.44 60460.5,-358.95 60496.38,-354.16 60535.05,-344.77 60568.42,-335.27"/>
<polygon fill="black" stroke="black" points="60569.51,-338.6 60578.14,-332.46 60567.57,-331.88 60569.51,-338.6"/>
</g>
<!-- s0_emb_11 -->
<g id="node145" class="node">
<title>s0_emb_11</title>
<polygon fill="lightblue" stroke="black" points="66888,-332.45 66517,-332.45 66517,-279.45 66888,-279.45 66888,-332.45"/>
<text text-anchor="middle" x="66702.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: Embedding (DP2)</text>
<text text-anchor="middle" x="66702.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="66702.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_11 -->
<g id="edge166" class="edge">
<title>input&#45;&gt;s0_emb_11</title>
<path fill="none" stroke="black" d="M45800.16,-431.46C48181.79,-431.63 65968.76,-430.5 66507.5,-358.95 66543.38,-354.19 66582.05,-344.8 66615.43,-335.3"/>
<polygon fill="black" stroke="black" points="66616.51,-338.63 66625.15,-332.49 66614.57,-331.9 66616.51,-338.63"/>
</g>
<!-- s0_emb_12 -->
<g id="node158" class="node">
<title>s0_emb_12</title>
<polygon fill="lightblue" stroke="black" points="72935,-332.45 72564,-332.45 72564,-279.45 72935,-279.45 72935,-332.45"/>
<text text-anchor="middle" x="72749.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: Embedding (DP3)</text>
<text text-anchor="middle" x="72749.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="72749.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_12 -->
<g id="edge181" class="edge">
<title>input&#45;&gt;s0_emb_12</title>
<path fill="none" stroke="black" d="M45799.95,-431.19C48562.1,-428.63 72204.25,-405.33 72554.5,-358.95 72590.38,-354.2 72629.06,-344.82 72662.43,-335.31"/>
<polygon fill="black" stroke="black" points="72663.52,-338.64 72672.15,-332.5 72661.57,-331.92 72663.52,-338.64"/>
</g>
<!-- s0_emb_13 -->
<g id="node171" class="node">
<title>s0_emb_13</title>
<polygon fill="lightblue" stroke="black" points="78982,-332.45 78611,-332.45 78611,-279.45 78982,-279.45 78982,-332.45"/>
<text text-anchor="middle" x="78796.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: Embedding (DP3)</text>
<text text-anchor="middle" x="78796.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="78796.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_13 -->
<g id="edge196" class="edge">
<title>input&#45;&gt;s0_emb_13</title>
<path fill="none" stroke="black" d="M45799.75,-431.32C48885.4,-430 78170.23,-415.95 78601.5,-358.95 78637.38,-354.21 78676.06,-344.83 78709.43,-335.32"/>
<polygon fill="black" stroke="black" points="78710.52,-338.65 78719.15,-332.51 78708.57,-331.93 78710.52,-338.65"/>
</g>
<!-- s0_emb_14 -->
<g id="node184" class="node">
<title>s0_emb_14</title>
<polygon fill="lightblue" stroke="black" points="85029,-332.45 84658,-332.45 84658,-279.45 85029,-279.45 85029,-332.45"/>
<text text-anchor="middle" x="84843.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: Embedding (DP3)</text>
<text text-anchor="middle" x="84843.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="84843.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_14 -->
<g id="edge211" class="edge">
<title>input&#45;&gt;s0_emb_14</title>
<path fill="none" stroke="black" d="M45799.9,-431.41C49182.28,-431.13 84136.03,-426.59 84648.5,-358.95 84684.38,-354.22 84723.06,-344.84 84756.43,-335.33"/>
<polygon fill="black" stroke="black" points="84757.52,-338.66 84766.15,-332.52 84755.57,-331.93 84757.52,-338.66"/>
</g>
<!-- s0_emb_15 -->
<g id="node197" class="node">
<title>s0_emb_15</title>
<polygon fill="lightblue" stroke="black" points="91076,-332.45 90705,-332.45 90705,-279.45 91076,-279.45 91076,-332.45"/>
<text text-anchor="middle" x="90890.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: Embedding (DP3)</text>
<text text-anchor="middle" x="90890.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="90890.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- input&#45;&gt;s0_emb_15 -->
<g id="edge226" class="edge">
<title>input&#45;&gt;s0_emb_15</title>
<path fill="none" stroke="black" d="M45799.8,-431.48C49455.38,-432.1 90101.66,-437.26 90695.5,-358.95 90731.38,-354.22 90770.06,-344.84 90803.43,-335.33"/>
<polygon fill="black" stroke="black" points="90804.52,-338.66 90813.15,-332.52 90802.57,-331.94 90804.52,-338.66"/>
</g>
<!-- s0_ln0_0 -->
<g id="node3" class="node">
<title>s0_ln0_0</title>
<polygon fill="lightblue" stroke="black" points="760,-332.45 389,-332.45 389,-279.45 760,-279.45 760,-332.45"/>
<text text-anchor="middle" x="574.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: LayerNorm (DP0)</text>
<text text-anchor="middle" x="574.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="574.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_0&#45;&gt;s0_ln0_0 -->
<g id="edge2" class="edge">
<title>s0_emb_0&#45;&gt;s0_ln0_0</title>
<path fill="none" stroke="black" d="M371.26,-305.95C373.72,-305.95 376.17,-305.95 378.63,-305.95"/>
<polygon fill="black" stroke="black" points="378.73,-309.45 388.73,-305.95 378.73,-302.45 378.73,-309.45"/>
</g>
<!-- s0_q_0 -->
<g id="node4" class="node">
<title>s0_q_0</title>
<polygon fill="lightblue" stroke="black" points="3013,-332.45 2642,-332.45 2642,-279.45 3013,-279.45 3013,-332.45"/>
<text text-anchor="middle" x="2827.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: Q Linear (TP0)</text>
<text text-anchor="middle" x="2827.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="2827.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_q_0 -->
<g id="edge3" class="edge">
<title>s0_ln0_0&#45;&gt;s0_q_0</title>
<path fill="none" stroke="black" d="M633.5,-332.53C673.28,-348.94 727.44,-368.45 777.5,-376.95 878.61,-394.12 2522.38,-394.05 2623.5,-376.95 2669.86,-369.12 2719.74,-351.93 2758.57,-336.42"/>
<polygon fill="black" stroke="black" points="2760.24,-339.52 2768.2,-332.53 2757.62,-333.04 2760.24,-339.52"/>
</g>
<!-- s0_k_0 -->
<g id="node5" class="node">
<title>s0_k_0</title>
<polygon fill="lightblue" stroke="black" points="2081,-332.45 1710,-332.45 1710,-279.45 2081,-279.45 2081,-332.45"/>
<text text-anchor="middle" x="1895.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: K Linear (TP0)</text>
<text text-anchor="middle" x="1895.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="1895.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_k_0 -->
<g id="edge4" class="edge">
<title>s0_ln0_0&#45;&gt;s0_k_0</title>
<path fill="none" stroke="black" d="M633.5,-332.53C673.28,-348.94 727.44,-368.45 777.5,-376.95 877.62,-393.96 1591.37,-393.88 1691.5,-376.95 1737.86,-369.12 1787.74,-351.93 1826.57,-336.42"/>
<polygon fill="black" stroke="black" points="1828.24,-339.52 1836.2,-332.53 1825.62,-333.04 1828.24,-339.52"/>
</g>
<!-- s0_v_0 -->
<g id="node6" class="node">
<title>s0_v_0</title>
<polygon fill="lightblue" stroke="black" points="1149,-332.45 778,-332.45 778,-279.45 1149,-279.45 1149,-332.45"/>
<text text-anchor="middle" x="963.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: V Linear (TP0)</text>
<text text-anchor="middle" x="963.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="963.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_0&#45;&gt;s0_v_0 -->
<g id="edge5" class="edge">
<title>s0_ln0_0&#45;&gt;s0_v_0</title>
<path fill="none" stroke="black" d="M760.26,-305.95C762.72,-305.95 765.17,-305.95 767.63,-305.95"/>
<polygon fill="black" stroke="black" points="767.73,-309.45 777.73,-305.95 767.73,-302.45 767.73,-309.45"/>
</g>
<!-- s0_allgather_q_0 -->
<g id="node7" class="node">
<title>s0_allgather_q_0</title>
<ellipse fill="white" stroke="black" cx="3293.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="3293.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather Q (TP0)</text>
<text text-anchor="middle" x="3293.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="3293.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_0&#45;&gt;s0_allgather_q_0 -->
<g id="edge6" class="edge">
<title>s0_q_0&#45;&gt;s0_allgather_q_0</title>
<path fill="none" stroke="black" d="M3013.17,-305.95C3015.77,-305.95 3018.36,-305.95 3020.96,-305.95"/>
<polygon fill="black" stroke="black" points="3020.97,-309.45 3030.97,-305.95 3020.97,-302.45 3020.97,-309.45"/>
</g>
<!-- s0_allgather_k_0 -->
<g id="node8" class="node">
<title>s0_allgather_k_0</title>
<ellipse fill="white" stroke="black" cx="2361.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="2361.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather K (TP0)</text>
<text text-anchor="middle" x="2361.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="2361.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_0&#45;&gt;s0_allgather_k_0 -->
<g id="edge7" class="edge">
<title>s0_k_0&#45;&gt;s0_allgather_k_0</title>
<path fill="none" stroke="black" d="M2081.17,-305.95C2083.77,-305.95 2086.36,-305.95 2088.96,-305.95"/>
<polygon fill="black" stroke="black" points="2088.97,-309.45 2098.97,-305.95 2088.97,-302.45 2088.97,-309.45"/>
</g>
<!-- s0_allgather_v_0 -->
<g id="node9" class="node">
<title>s0_allgather_v_0</title>
<ellipse fill="white" stroke="black" cx="1429.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="1429.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: AllGather V (TP0)</text>
<text text-anchor="middle" x="1429.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="1429.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_0&#45;&gt;s0_allgather_v_0 -->
<g id="edge8" class="edge">
<title>s0_v_0&#45;&gt;s0_allgather_v_0</title>
<path fill="none" stroke="black" d="M1149.17,-305.95C1151.77,-305.95 1154.36,-305.95 1156.96,-305.95"/>
<polygon fill="black" stroke="black" points="1156.97,-309.45 1166.97,-305.95 1156.97,-302.45 1156.97,-309.45"/>
</g>
<!-- s0_attn_0 -->
<g id="node10" class="node">
<title>s0_attn_0</title>
<polygon fill="lightblue" stroke="black" points="3945,-332.45 3574,-332.45 3574,-279.45 3945,-279.45 3945,-332.45"/>
<text text-anchor="middle" x="3759.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: Attention (TP0)</text>
<text text-anchor="middle" x="3759.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="3759.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_0&#45;&gt;s0_attn_0 -->
<g id="edge9" class="edge">
<title>s0_allgather_q_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M3556.08,-305.95C3558.69,-305.95 3561.29,-305.95 3563.9,-305.95"/>
<polygon fill="black" stroke="black" points="3563.96,-309.45 3573.96,-305.95 3563.96,-302.45 3563.96,-309.45"/>
</g>
<!-- s0_allgather_k_0&#45;&gt;s0_attn_0 -->
<g id="edge10" class="edge">
<title>s0_allgather_k_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M2470,-340.15C2521.41,-354.63 2584.02,-369.78 2641.5,-376.95 2742.27,-389.53 3455.37,-393.88 3555.5,-376.95 3601.86,-369.12 3651.74,-351.93 3690.57,-336.42"/>
<polygon fill="black" stroke="black" points="3692.24,-339.52 3700.2,-332.53 3689.62,-333.04 3692.24,-339.52"/>
</g>
<!-- s0_allgather_v_0&#45;&gt;s0_attn_0 -->
<g id="edge11" class="edge">
<title>s0_allgather_v_0&#45;&gt;s0_attn_0</title>
<path fill="none" stroke="black" d="M1538,-340.15C1589.41,-354.63 1652.02,-369.78 1709.5,-376.95 1811.27,-389.65 3454.38,-394.05 3555.5,-376.95 3601.86,-369.12 3651.74,-351.93 3690.57,-336.42"/>
<polygon fill="black" stroke="black" points="3692.24,-339.52 3700.2,-332.53 3689.62,-333.04 3692.24,-339.52"/>
</g>
<!-- s0_gate_0 -->
<g id="node11" class="node">
<title>s0_gate_0</title>
<polygon fill="orange" stroke="black" points="4707.89,-358.95 4115.5,-358.95 3963.11,-252.95 4555.5,-252.95 4707.89,-358.95"/>
<text text-anchor="middle" x="4335.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: MoE Gate</text>
<text text-anchor="middle" x="4335.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="4335.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_0&#45;&gt;s0_gate_0 -->
<g id="edge12" class="edge">
<title>s0_attn_0&#45;&gt;s0_gate_0</title>
<path fill="none" stroke="black" d="M3945.12,-305.95C3973.08,-305.95 4001.03,-305.95 4028.99,-305.95"/>
<polygon fill="black" stroke="black" points="4029.29,-309.45 4039.29,-305.95 4029.29,-302.45 4029.29,-309.45"/>
</g>
<!-- s0_expert_0 -->
<g id="node12" class="node">
<title>s0_expert_0</title>
<polygon fill="lightblue" stroke="black" points="5097,-332.45 4726,-332.45 4726,-279.45 5097,-279.45 5097,-332.45"/>
<text text-anchor="middle" x="4911.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: Expert FFN</text>
<text text-anchor="middle" x="4911.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="4911.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_0&#45;&gt;s0_expert_0 -->
<g id="edge13" class="edge">
<title>s0_gate_0&#45;&gt;s0_expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4631.94,-305.95C4659.82,-305.95 4687.7,-305.95 4715.58,-305.95"/>
<polygon fill="black" stroke="black" points="4715.85,-309.45 4725.85,-305.95 4715.85,-302.45 4715.85,-309.45"/>
</g>
<!-- s0_alltoall_0 -->
<g id="node13" class="node">
<title>s0_alltoall_0</title>
<ellipse fill="white" stroke="black" cx="5377.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="5377.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: AllToAll</text>
<text text-anchor="middle" x="5377.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="5377.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_0&#45;&gt;s0_alltoall_0 -->
<g id="edge14" class="edge">
<title>s0_expert_0&#45;&gt;s0_alltoall_0</title>
<path fill="none" stroke="black" d="M5097.17,-305.95C5099.77,-305.95 5102.36,-305.95 5104.96,-305.95"/>
<polygon fill="black" stroke="black" points="5104.97,-309.45 5114.97,-305.95 5104.97,-302.45 5104.97,-309.45"/>
</g>
<!-- s0_ln1_0 -->
<g id="node14" class="node">
<title>s0_ln1_0</title>
<polygon fill="lightblue" stroke="black" points="6029,-332.45 5658,-332.45 5658,-279.45 6029,-279.45 6029,-332.45"/>
<text text-anchor="middle" x="5843.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU0: LayerNorm (DP0)</text>
<text text-anchor="middle" x="5843.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="5843.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_0&#45;&gt;s0_ln1_0 -->
<g id="edge15" class="edge">
<title>s0_alltoall_0&#45;&gt;s0_ln1_0</title>
<path fill="none" stroke="black" d="M5640.08,-305.95C5642.69,-305.95 5645.29,-305.95 5647.9,-305.95"/>
<polygon fill="black" stroke="black" points="5647.96,-309.45 5657.96,-305.95 5647.96,-302.45 5647.96,-309.45"/>
</g>
<!-- s1_ln0_16 -->
<g id="node210" class="node">
<title>s1_ln0_16</title>
<polygon fill="lightgreen" stroke="black" points="6029,-190.45 5658,-190.45 5658,-137.45 6029,-137.45 6029,-190.45"/>
<text text-anchor="middle" x="5843.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: LayerNorm (DP0)</text>
<text text-anchor="middle" x="5843.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="5843.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_0&#45;&gt;s1_ln0_16 -->
<g id="edge241" class="edge">
<title>s0_ln1_0&#45;&gt;s1_ln0_16</title>
<path fill="none" stroke="black" d="M5843.5,-279.28C5843.5,-257.17 5843.5,-225.05 5843.5,-200.48"/>
<polygon fill="black" stroke="black" points="5847,-200.47 5843.5,-190.47 5840,-200.47 5847,-200.47"/>
</g>
<!-- s0_ln0_1 -->
<g id="node16" class="node">
<title>s0_ln0_1</title>
<polygon fill="lightblue" stroke="black" points="6807,-332.45 6436,-332.45 6436,-279.45 6807,-279.45 6807,-332.45"/>
<text text-anchor="middle" x="6621.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: LayerNorm (DP0)</text>
<text text-anchor="middle" x="6621.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="6621.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_1&#45;&gt;s0_ln0_1 -->
<g id="edge17" class="edge">
<title>s0_emb_1&#45;&gt;s0_ln0_1</title>
<path fill="none" stroke="black" d="M6418.26,-305.95C6420.72,-305.95 6423.17,-305.95 6425.63,-305.95"/>
<polygon fill="black" stroke="black" points="6425.73,-309.45 6435.73,-305.95 6425.73,-302.45 6425.73,-309.45"/>
</g>
<!-- s0_q_1 -->
<g id="node17" class="node">
<title>s0_q_1</title>
<polygon fill="lightblue" stroke="black" points="9060,-332.45 8689,-332.45 8689,-279.45 9060,-279.45 9060,-332.45"/>
<text text-anchor="middle" x="8874.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: Q Linear (TP1)</text>
<text text-anchor="middle" x="8874.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="8874.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_q_1 -->
<g id="edge18" class="edge">
<title>s0_ln0_1&#45;&gt;s0_q_1</title>
<path fill="none" stroke="black" d="M6680.5,-332.53C6720.28,-348.94 6774.44,-368.45 6824.5,-376.95 6925.61,-394.12 8569.38,-394.05 8670.5,-376.95 8716.86,-369.12 8766.74,-351.93 8805.57,-336.42"/>
<polygon fill="black" stroke="black" points="8807.24,-339.52 8815.2,-332.53 8804.62,-333.04 8807.24,-339.52"/>
</g>
<!-- s0_k_1 -->
<g id="node18" class="node">
<title>s0_k_1</title>
<polygon fill="lightblue" stroke="black" points="8128,-332.45 7757,-332.45 7757,-279.45 8128,-279.45 8128,-332.45"/>
<text text-anchor="middle" x="7942.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: K Linear (TP1)</text>
<text text-anchor="middle" x="7942.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="7942.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_k_1 -->
<g id="edge19" class="edge">
<title>s0_ln0_1&#45;&gt;s0_k_1</title>
<path fill="none" stroke="black" d="M6680.5,-332.53C6720.28,-348.94 6774.44,-368.45 6824.5,-376.95 6924.62,-393.96 7638.37,-393.88 7738.5,-376.95 7784.86,-369.12 7834.74,-351.93 7873.57,-336.42"/>
<polygon fill="black" stroke="black" points="7875.24,-339.52 7883.2,-332.53 7872.62,-333.04 7875.24,-339.52"/>
</g>
<!-- s0_v_1 -->
<g id="node19" class="node">
<title>s0_v_1</title>
<polygon fill="lightblue" stroke="black" points="7196,-332.45 6825,-332.45 6825,-279.45 7196,-279.45 7196,-332.45"/>
<text text-anchor="middle" x="7010.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: V Linear (TP1)</text>
<text text-anchor="middle" x="7010.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="7010.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_1&#45;&gt;s0_v_1 -->
<g id="edge20" class="edge">
<title>s0_ln0_1&#45;&gt;s0_v_1</title>
<path fill="none" stroke="black" d="M6807.26,-305.95C6809.72,-305.95 6812.17,-305.95 6814.63,-305.95"/>
<polygon fill="black" stroke="black" points="6814.73,-309.45 6824.73,-305.95 6814.73,-302.45 6814.73,-309.45"/>
</g>
<!-- s0_allgather_q_1 -->
<g id="node20" class="node">
<title>s0_allgather_q_1</title>
<ellipse fill="white" stroke="black" cx="9340.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="9340.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather Q (TP1)</text>
<text text-anchor="middle" x="9340.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="9340.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_1&#45;&gt;s0_allgather_q_1 -->
<g id="edge21" class="edge">
<title>s0_q_1&#45;&gt;s0_allgather_q_1</title>
<path fill="none" stroke="black" d="M9060.17,-305.95C9062.77,-305.95 9065.36,-305.95 9067.96,-305.95"/>
<polygon fill="black" stroke="black" points="9067.97,-309.45 9077.97,-305.95 9067.97,-302.45 9067.97,-309.45"/>
</g>
<!-- s0_allgather_k_1 -->
<g id="node21" class="node">
<title>s0_allgather_k_1</title>
<ellipse fill="white" stroke="black" cx="8408.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="8408.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather K (TP1)</text>
<text text-anchor="middle" x="8408.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="8408.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_1&#45;&gt;s0_allgather_k_1 -->
<g id="edge22" class="edge">
<title>s0_k_1&#45;&gt;s0_allgather_k_1</title>
<path fill="none" stroke="black" d="M8128.17,-305.95C8130.77,-305.95 8133.36,-305.95 8135.96,-305.95"/>
<polygon fill="black" stroke="black" points="8135.97,-309.45 8145.97,-305.95 8135.97,-302.45 8135.97,-309.45"/>
</g>
<!-- s0_allgather_v_1 -->
<g id="node22" class="node">
<title>s0_allgather_v_1</title>
<ellipse fill="white" stroke="black" cx="7476.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="7476.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: AllGather V (TP1)</text>
<text text-anchor="middle" x="7476.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="7476.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_1&#45;&gt;s0_allgather_v_1 -->
<g id="edge23" class="edge">
<title>s0_v_1&#45;&gt;s0_allgather_v_1</title>
<path fill="none" stroke="black" d="M7196.17,-305.95C7198.77,-305.95 7201.36,-305.95 7203.96,-305.95"/>
<polygon fill="black" stroke="black" points="7203.97,-309.45 7213.97,-305.95 7203.97,-302.45 7203.97,-309.45"/>
</g>
<!-- s0_attn_1 -->
<g id="node23" class="node">
<title>s0_attn_1</title>
<polygon fill="lightblue" stroke="black" points="9992,-332.45 9621,-332.45 9621,-279.45 9992,-279.45 9992,-332.45"/>
<text text-anchor="middle" x="9806.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: Attention (TP1)</text>
<text text-anchor="middle" x="9806.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="9806.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_1&#45;&gt;s0_attn_1 -->
<g id="edge24" class="edge">
<title>s0_allgather_q_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M9603.08,-305.95C9605.69,-305.95 9608.29,-305.95 9610.9,-305.95"/>
<polygon fill="black" stroke="black" points="9610.96,-309.45 9620.96,-305.95 9610.96,-302.45 9610.96,-309.45"/>
</g>
<!-- s0_allgather_k_1&#45;&gt;s0_attn_1 -->
<g id="edge25" class="edge">
<title>s0_allgather_k_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M8517,-340.15C8568.41,-354.63 8631.02,-369.78 8688.5,-376.95 8789.27,-389.53 9502.37,-393.88 9602.5,-376.95 9648.86,-369.12 9698.74,-351.93 9737.57,-336.42"/>
<polygon fill="black" stroke="black" points="9739.24,-339.52 9747.2,-332.53 9736.62,-333.04 9739.24,-339.52"/>
</g>
<!-- s0_allgather_v_1&#45;&gt;s0_attn_1 -->
<g id="edge26" class="edge">
<title>s0_allgather_v_1&#45;&gt;s0_attn_1</title>
<path fill="none" stroke="black" d="M7585,-340.15C7636.41,-354.63 7699.02,-369.78 7756.5,-376.95 7858.27,-389.65 9501.38,-394.05 9602.5,-376.95 9648.86,-369.12 9698.74,-351.93 9737.57,-336.42"/>
<polygon fill="black" stroke="black" points="9739.24,-339.52 9747.2,-332.53 9736.62,-333.04 9739.24,-339.52"/>
</g>
<!-- s0_gate_1 -->
<g id="node24" class="node">
<title>s0_gate_1</title>
<polygon fill="orange" stroke="black" points="10754.89,-358.95 10162.5,-358.95 10010.11,-252.95 10602.5,-252.95 10754.89,-358.95"/>
<text text-anchor="middle" x="10382.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: MoE Gate</text>
<text text-anchor="middle" x="10382.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="10382.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_1&#45;&gt;s0_gate_1 -->
<g id="edge27" class="edge">
<title>s0_attn_1&#45;&gt;s0_gate_1</title>
<path fill="none" stroke="black" d="M9992.12,-305.95C10020.08,-305.95 10048.03,-305.95 10075.99,-305.95"/>
<polygon fill="black" stroke="black" points="10076.29,-309.45 10086.29,-305.95 10076.29,-302.45 10076.29,-309.45"/>
</g>
<!-- s0_expert_1 -->
<g id="node25" class="node">
<title>s0_expert_1</title>
<polygon fill="lightblue" stroke="black" points="11144,-332.45 10773,-332.45 10773,-279.45 11144,-279.45 11144,-332.45"/>
<text text-anchor="middle" x="10958.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: Expert FFN</text>
<text text-anchor="middle" x="10958.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="10958.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_1&#45;&gt;s0_expert_1 -->
<g id="edge28" class="edge">
<title>s0_gate_1&#45;&gt;s0_expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10678.94,-305.95C10706.82,-305.95 10734.7,-305.95 10762.58,-305.95"/>
<polygon fill="black" stroke="black" points="10762.85,-309.45 10772.85,-305.95 10762.85,-302.45 10762.85,-309.45"/>
</g>
<!-- s0_alltoall_1 -->
<g id="node26" class="node">
<title>s0_alltoall_1</title>
<ellipse fill="white" stroke="black" cx="11424.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="11424.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: AllToAll</text>
<text text-anchor="middle" x="11424.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="11424.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_1&#45;&gt;s0_alltoall_1 -->
<g id="edge29" class="edge">
<title>s0_expert_1&#45;&gt;s0_alltoall_1</title>
<path fill="none" stroke="black" d="M11144.17,-305.95C11146.77,-305.95 11149.36,-305.95 11151.96,-305.95"/>
<polygon fill="black" stroke="black" points="11151.97,-309.45 11161.97,-305.95 11151.97,-302.45 11151.97,-309.45"/>
</g>
<!-- s0_ln1_1 -->
<g id="node27" class="node">
<title>s0_ln1_1</title>
<polygon fill="lightblue" stroke="black" points="12076,-332.45 11705,-332.45 11705,-279.45 12076,-279.45 12076,-332.45"/>
<text text-anchor="middle" x="11890.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU1: LayerNorm (DP0)</text>
<text text-anchor="middle" x="11890.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="11890.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_1&#45;&gt;s0_ln1_1 -->
<g id="edge30" class="edge">
<title>s0_alltoall_1&#45;&gt;s0_ln1_1</title>
<path fill="none" stroke="black" d="M11687.08,-305.95C11689.69,-305.95 11692.29,-305.95 11694.9,-305.95"/>
<polygon fill="black" stroke="black" points="11694.96,-309.45 11704.96,-305.95 11694.96,-302.45 11694.96,-309.45"/>
</g>
<!-- s1_ln0_17 -->
<g id="node222" class="node">
<title>s1_ln0_17</title>
<polygon fill="lightgreen" stroke="black" points="12076,-190.45 11705,-190.45 11705,-137.45 12076,-137.45 12076,-190.45"/>
<text text-anchor="middle" x="11890.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: LayerNorm (DP0)</text>
<text text-anchor="middle" x="11890.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="11890.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_1&#45;&gt;s1_ln0_17 -->
<g id="edge242" class="edge">
<title>s0_ln1_1&#45;&gt;s1_ln0_17</title>
<path fill="none" stroke="black" d="M11890.5,-279.28C11890.5,-257.17 11890.5,-225.05 11890.5,-200.48"/>
<polygon fill="black" stroke="black" points="11894,-200.47 11890.5,-190.47 11887,-200.47 11894,-200.47"/>
</g>
<!-- s0_ln0_2 -->
<g id="node29" class="node">
<title>s0_ln0_2</title>
<polygon fill="lightblue" stroke="black" points="12854,-332.45 12483,-332.45 12483,-279.45 12854,-279.45 12854,-332.45"/>
<text text-anchor="middle" x="12668.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: LayerNorm (DP0)</text>
<text text-anchor="middle" x="12668.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="12668.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_2&#45;&gt;s0_ln0_2 -->
<g id="edge32" class="edge">
<title>s0_emb_2&#45;&gt;s0_ln0_2</title>
<path fill="none" stroke="black" d="M12465.26,-305.95C12467.72,-305.95 12470.17,-305.95 12472.63,-305.95"/>
<polygon fill="black" stroke="black" points="12472.73,-309.45 12482.73,-305.95 12472.73,-302.45 12472.73,-309.45"/>
</g>
<!-- s0_q_2 -->
<g id="node30" class="node">
<title>s0_q_2</title>
<polygon fill="lightblue" stroke="black" points="15107,-332.45 14736,-332.45 14736,-279.45 15107,-279.45 15107,-332.45"/>
<text text-anchor="middle" x="14921.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: Q Linear (TP2)</text>
<text text-anchor="middle" x="14921.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="14921.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_q_2 -->
<g id="edge33" class="edge">
<title>s0_ln0_2&#45;&gt;s0_q_2</title>
<path fill="none" stroke="black" d="M12727.5,-332.53C12767.28,-348.94 12821.44,-368.45 12871.5,-376.95 12972.61,-394.12 14616.38,-394.05 14717.5,-376.95 14763.86,-369.12 14813.74,-351.93 14852.57,-336.42"/>
<polygon fill="black" stroke="black" points="14854.24,-339.52 14862.2,-332.53 14851.62,-333.04 14854.24,-339.52"/>
</g>
<!-- s0_k_2 -->
<g id="node31" class="node">
<title>s0_k_2</title>
<polygon fill="lightblue" stroke="black" points="14175,-332.45 13804,-332.45 13804,-279.45 14175,-279.45 14175,-332.45"/>
<text text-anchor="middle" x="13989.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: K Linear (TP2)</text>
<text text-anchor="middle" x="13989.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="13989.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_k_2 -->
<g id="edge34" class="edge">
<title>s0_ln0_2&#45;&gt;s0_k_2</title>
<path fill="none" stroke="black" d="M12727.5,-332.53C12767.28,-348.94 12821.44,-368.45 12871.5,-376.95 12971.62,-393.96 13685.37,-393.88 13785.5,-376.95 13831.86,-369.12 13881.74,-351.93 13920.57,-336.42"/>
<polygon fill="black" stroke="black" points="13922.24,-339.52 13930.2,-332.53 13919.62,-333.04 13922.24,-339.52"/>
</g>
<!-- s0_v_2 -->
<g id="node32" class="node">
<title>s0_v_2</title>
<polygon fill="lightblue" stroke="black" points="13243,-332.45 12872,-332.45 12872,-279.45 13243,-279.45 13243,-332.45"/>
<text text-anchor="middle" x="13057.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: V Linear (TP2)</text>
<text text-anchor="middle" x="13057.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="13057.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_2&#45;&gt;s0_v_2 -->
<g id="edge35" class="edge">
<title>s0_ln0_2&#45;&gt;s0_v_2</title>
<path fill="none" stroke="black" d="M12854.26,-305.95C12856.72,-305.95 12859.17,-305.95 12861.63,-305.95"/>
<polygon fill="black" stroke="black" points="12861.73,-309.45 12871.73,-305.95 12861.73,-302.45 12861.73,-309.45"/>
</g>
<!-- s0_allgather_q_2 -->
<g id="node33" class="node">
<title>s0_allgather_q_2</title>
<ellipse fill="white" stroke="black" cx="15387.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="15387.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather Q (TP2)</text>
<text text-anchor="middle" x="15387.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="15387.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_2&#45;&gt;s0_allgather_q_2 -->
<g id="edge36" class="edge">
<title>s0_q_2&#45;&gt;s0_allgather_q_2</title>
<path fill="none" stroke="black" d="M15107.17,-305.95C15109.77,-305.95 15112.36,-305.95 15114.96,-305.95"/>
<polygon fill="black" stroke="black" points="15114.97,-309.45 15124.97,-305.95 15114.97,-302.45 15114.97,-309.45"/>
</g>
<!-- s0_allgather_k_2 -->
<g id="node34" class="node">
<title>s0_allgather_k_2</title>
<ellipse fill="white" stroke="black" cx="14455.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="14455.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather K (TP2)</text>
<text text-anchor="middle" x="14455.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="14455.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_2&#45;&gt;s0_allgather_k_2 -->
<g id="edge37" class="edge">
<title>s0_k_2&#45;&gt;s0_allgather_k_2</title>
<path fill="none" stroke="black" d="M14175.17,-305.95C14177.77,-305.95 14180.36,-305.95 14182.96,-305.95"/>
<polygon fill="black" stroke="black" points="14182.97,-309.45 14192.97,-305.95 14182.97,-302.45 14182.97,-309.45"/>
</g>
<!-- s0_allgather_v_2 -->
<g id="node35" class="node">
<title>s0_allgather_v_2</title>
<ellipse fill="white" stroke="black" cx="13523.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="13523.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: AllGather V (TP2)</text>
<text text-anchor="middle" x="13523.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="13523.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_2&#45;&gt;s0_allgather_v_2 -->
<g id="edge38" class="edge">
<title>s0_v_2&#45;&gt;s0_allgather_v_2</title>
<path fill="none" stroke="black" d="M13243.17,-305.95C13245.77,-305.95 13248.36,-305.95 13250.96,-305.95"/>
<polygon fill="black" stroke="black" points="13250.97,-309.45 13260.97,-305.95 13250.97,-302.45 13250.97,-309.45"/>
</g>
<!-- s0_attn_2 -->
<g id="node36" class="node">
<title>s0_attn_2</title>
<polygon fill="lightblue" stroke="black" points="16039,-332.45 15668,-332.45 15668,-279.45 16039,-279.45 16039,-332.45"/>
<text text-anchor="middle" x="15853.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: Attention (TP2)</text>
<text text-anchor="middle" x="15853.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="15853.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_2&#45;&gt;s0_attn_2 -->
<g id="edge39" class="edge">
<title>s0_allgather_q_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M15650.08,-305.95C15652.69,-305.95 15655.29,-305.95 15657.9,-305.95"/>
<polygon fill="black" stroke="black" points="15657.96,-309.45 15667.96,-305.95 15657.96,-302.45 15657.96,-309.45"/>
</g>
<!-- s0_allgather_k_2&#45;&gt;s0_attn_2 -->
<g id="edge40" class="edge">
<title>s0_allgather_k_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M14564,-340.15C14615.41,-354.63 14678.02,-369.78 14735.5,-376.95 14836.27,-389.53 15549.37,-393.88 15649.5,-376.95 15695.86,-369.12 15745.74,-351.93 15784.57,-336.42"/>
<polygon fill="black" stroke="black" points="15786.24,-339.52 15794.2,-332.53 15783.62,-333.04 15786.24,-339.52"/>
</g>
<!-- s0_allgather_v_2&#45;&gt;s0_attn_2 -->
<g id="edge41" class="edge">
<title>s0_allgather_v_2&#45;&gt;s0_attn_2</title>
<path fill="none" stroke="black" d="M13632,-340.15C13683.41,-354.63 13746.02,-369.78 13803.5,-376.95 13905.27,-389.65 15548.38,-394.05 15649.5,-376.95 15695.86,-369.12 15745.74,-351.93 15784.57,-336.42"/>
<polygon fill="black" stroke="black" points="15786.24,-339.52 15794.2,-332.53 15783.62,-333.04 15786.24,-339.52"/>
</g>
<!-- s0_gate_2 -->
<g id="node37" class="node">
<title>s0_gate_2</title>
<polygon fill="orange" stroke="black" points="16801.89,-358.95 16209.5,-358.95 16057.11,-252.95 16649.5,-252.95 16801.89,-358.95"/>
<text text-anchor="middle" x="16429.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: MoE Gate</text>
<text text-anchor="middle" x="16429.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="16429.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_2&#45;&gt;s0_gate_2 -->
<g id="edge42" class="edge">
<title>s0_attn_2&#45;&gt;s0_gate_2</title>
<path fill="none" stroke="black" d="M16039.12,-305.95C16067.08,-305.95 16095.03,-305.95 16122.99,-305.95"/>
<polygon fill="black" stroke="black" points="16123.29,-309.45 16133.29,-305.95 16123.29,-302.45 16123.29,-309.45"/>
</g>
<!-- s0_expert_2 -->
<g id="node38" class="node">
<title>s0_expert_2</title>
<polygon fill="lightblue" stroke="black" points="17191,-332.45 16820,-332.45 16820,-279.45 17191,-279.45 17191,-332.45"/>
<text text-anchor="middle" x="17005.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: Expert FFN</text>
<text text-anchor="middle" x="17005.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="17005.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_2&#45;&gt;s0_expert_2 -->
<g id="edge43" class="edge">
<title>s0_gate_2&#45;&gt;s0_expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16725.94,-305.95C16753.82,-305.95 16781.7,-305.95 16809.58,-305.95"/>
<polygon fill="black" stroke="black" points="16809.85,-309.45 16819.85,-305.95 16809.85,-302.45 16809.85,-309.45"/>
</g>
<!-- s0_alltoall_2 -->
<g id="node39" class="node">
<title>s0_alltoall_2</title>
<ellipse fill="white" stroke="black" cx="17471.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="17471.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: AllToAll</text>
<text text-anchor="middle" x="17471.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="17471.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_2&#45;&gt;s0_alltoall_2 -->
<g id="edge44" class="edge">
<title>s0_expert_2&#45;&gt;s0_alltoall_2</title>
<path fill="none" stroke="black" d="M17191.17,-305.95C17193.77,-305.95 17196.36,-305.95 17198.96,-305.95"/>
<polygon fill="black" stroke="black" points="17198.97,-309.45 17208.97,-305.95 17198.97,-302.45 17198.97,-309.45"/>
</g>
<!-- s0_ln1_2 -->
<g id="node40" class="node">
<title>s0_ln1_2</title>
<polygon fill="lightblue" stroke="black" points="18123,-332.45 17752,-332.45 17752,-279.45 18123,-279.45 18123,-332.45"/>
<text text-anchor="middle" x="17937.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU2: LayerNorm (DP0)</text>
<text text-anchor="middle" x="17937.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="17937.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_2&#45;&gt;s0_ln1_2 -->
<g id="edge45" class="edge">
<title>s0_alltoall_2&#45;&gt;s0_ln1_2</title>
<path fill="none" stroke="black" d="M17734.08,-305.95C17736.69,-305.95 17739.29,-305.95 17741.9,-305.95"/>
<polygon fill="black" stroke="black" points="17741.96,-309.45 17751.96,-305.95 17741.96,-302.45 17741.96,-309.45"/>
</g>
<!-- s1_ln0_18 -->
<g id="node234" class="node">
<title>s1_ln0_18</title>
<polygon fill="lightgreen" stroke="black" points="18123,-190.45 17752,-190.45 17752,-137.45 18123,-137.45 18123,-190.45"/>
<text text-anchor="middle" x="17937.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: LayerNorm (DP0)</text>
<text text-anchor="middle" x="17937.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="17937.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_2&#45;&gt;s1_ln0_18 -->
<g id="edge243" class="edge">
<title>s0_ln1_2&#45;&gt;s1_ln0_18</title>
<path fill="none" stroke="black" d="M17937.5,-279.28C17937.5,-257.17 17937.5,-225.05 17937.5,-200.48"/>
<polygon fill="black" stroke="black" points="17941,-200.47 17937.5,-190.47 17934,-200.47 17941,-200.47"/>
</g>
<!-- s0_ln0_3 -->
<g id="node42" class="node">
<title>s0_ln0_3</title>
<polygon fill="lightblue" stroke="black" points="18901,-332.45 18530,-332.45 18530,-279.45 18901,-279.45 18901,-332.45"/>
<text text-anchor="middle" x="18715.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: LayerNorm (DP0)</text>
<text text-anchor="middle" x="18715.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="18715.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_3&#45;&gt;s0_ln0_3 -->
<g id="edge47" class="edge">
<title>s0_emb_3&#45;&gt;s0_ln0_3</title>
<path fill="none" stroke="black" d="M18512.26,-305.95C18514.72,-305.95 18517.17,-305.95 18519.63,-305.95"/>
<polygon fill="black" stroke="black" points="18519.73,-309.45 18529.73,-305.95 18519.73,-302.45 18519.73,-309.45"/>
</g>
<!-- s0_q_3 -->
<g id="node43" class="node">
<title>s0_q_3</title>
<polygon fill="lightblue" stroke="black" points="21154,-332.45 20783,-332.45 20783,-279.45 21154,-279.45 21154,-332.45"/>
<text text-anchor="middle" x="20968.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: Q Linear (TP3)</text>
<text text-anchor="middle" x="20968.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="20968.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_q_3 -->
<g id="edge48" class="edge">
<title>s0_ln0_3&#45;&gt;s0_q_3</title>
<path fill="none" stroke="black" d="M18774.5,-332.53C18814.28,-348.94 18868.44,-368.45 18918.5,-376.95 19019.61,-394.12 20663.38,-394.05 20764.5,-376.95 20810.86,-369.12 20860.74,-351.93 20899.57,-336.42"/>
<polygon fill="black" stroke="black" points="20901.24,-339.52 20909.2,-332.53 20898.62,-333.04 20901.24,-339.52"/>
</g>
<!-- s0_k_3 -->
<g id="node44" class="node">
<title>s0_k_3</title>
<polygon fill="lightblue" stroke="black" points="20222,-332.45 19851,-332.45 19851,-279.45 20222,-279.45 20222,-332.45"/>
<text text-anchor="middle" x="20036.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: K Linear (TP3)</text>
<text text-anchor="middle" x="20036.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="20036.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_k_3 -->
<g id="edge49" class="edge">
<title>s0_ln0_3&#45;&gt;s0_k_3</title>
<path fill="none" stroke="black" d="M18774.5,-332.53C18814.28,-348.94 18868.44,-368.45 18918.5,-376.95 19018.62,-393.96 19732.37,-393.88 19832.5,-376.95 19878.86,-369.12 19928.74,-351.93 19967.57,-336.42"/>
<polygon fill="black" stroke="black" points="19969.24,-339.52 19977.2,-332.53 19966.62,-333.04 19969.24,-339.52"/>
</g>
<!-- s0_v_3 -->
<g id="node45" class="node">
<title>s0_v_3</title>
<polygon fill="lightblue" stroke="black" points="19290,-332.45 18919,-332.45 18919,-279.45 19290,-279.45 19290,-332.45"/>
<text text-anchor="middle" x="19104.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: V Linear (TP3)</text>
<text text-anchor="middle" x="19104.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="19104.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_3&#45;&gt;s0_v_3 -->
<g id="edge50" class="edge">
<title>s0_ln0_3&#45;&gt;s0_v_3</title>
<path fill="none" stroke="black" d="M18901.26,-305.95C18903.72,-305.95 18906.17,-305.95 18908.63,-305.95"/>
<polygon fill="black" stroke="black" points="18908.73,-309.45 18918.73,-305.95 18908.73,-302.45 18908.73,-309.45"/>
</g>
<!-- s0_allgather_q_3 -->
<g id="node46" class="node">
<title>s0_allgather_q_3</title>
<ellipse fill="white" stroke="black" cx="21434.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="21434.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather Q (TP3)</text>
<text text-anchor="middle" x="21434.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="21434.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_3&#45;&gt;s0_allgather_q_3 -->
<g id="edge51" class="edge">
<title>s0_q_3&#45;&gt;s0_allgather_q_3</title>
<path fill="none" stroke="black" d="M21154.17,-305.95C21156.77,-305.95 21159.36,-305.95 21161.96,-305.95"/>
<polygon fill="black" stroke="black" points="21161.97,-309.45 21171.97,-305.95 21161.97,-302.45 21161.97,-309.45"/>
</g>
<!-- s0_allgather_k_3 -->
<g id="node47" class="node">
<title>s0_allgather_k_3</title>
<ellipse fill="white" stroke="black" cx="20502.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="20502.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather K (TP3)</text>
<text text-anchor="middle" x="20502.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="20502.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_3&#45;&gt;s0_allgather_k_3 -->
<g id="edge52" class="edge">
<title>s0_k_3&#45;&gt;s0_allgather_k_3</title>
<path fill="none" stroke="black" d="M20222.17,-305.95C20224.77,-305.95 20227.36,-305.95 20229.96,-305.95"/>
<polygon fill="black" stroke="black" points="20229.97,-309.45 20239.97,-305.95 20229.97,-302.45 20229.97,-309.45"/>
</g>
<!-- s0_allgather_v_3 -->
<g id="node48" class="node">
<title>s0_allgather_v_3</title>
<ellipse fill="white" stroke="black" cx="19570.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="19570.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: AllGather V (TP3)</text>
<text text-anchor="middle" x="19570.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="19570.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_3&#45;&gt;s0_allgather_v_3 -->
<g id="edge53" class="edge">
<title>s0_v_3&#45;&gt;s0_allgather_v_3</title>
<path fill="none" stroke="black" d="M19290.17,-305.95C19292.77,-305.95 19295.36,-305.95 19297.96,-305.95"/>
<polygon fill="black" stroke="black" points="19297.97,-309.45 19307.97,-305.95 19297.97,-302.45 19297.97,-309.45"/>
</g>
<!-- s0_attn_3 -->
<g id="node49" class="node">
<title>s0_attn_3</title>
<polygon fill="lightblue" stroke="black" points="22086,-332.45 21715,-332.45 21715,-279.45 22086,-279.45 22086,-332.45"/>
<text text-anchor="middle" x="21900.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: Attention (TP3)</text>
<text text-anchor="middle" x="21900.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="21900.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_3&#45;&gt;s0_attn_3 -->
<g id="edge54" class="edge">
<title>s0_allgather_q_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M21697.08,-305.95C21699.69,-305.95 21702.29,-305.95 21704.9,-305.95"/>
<polygon fill="black" stroke="black" points="21704.96,-309.45 21714.96,-305.95 21704.96,-302.45 21704.96,-309.45"/>
</g>
<!-- s0_allgather_k_3&#45;&gt;s0_attn_3 -->
<g id="edge55" class="edge">
<title>s0_allgather_k_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M20611,-340.15C20662.41,-354.63 20725.02,-369.78 20782.5,-376.95 20883.27,-389.53 21596.37,-393.88 21696.5,-376.95 21742.86,-369.12 21792.74,-351.93 21831.57,-336.42"/>
<polygon fill="black" stroke="black" points="21833.24,-339.52 21841.2,-332.53 21830.62,-333.04 21833.24,-339.52"/>
</g>
<!-- s0_allgather_v_3&#45;&gt;s0_attn_3 -->
<g id="edge56" class="edge">
<title>s0_allgather_v_3&#45;&gt;s0_attn_3</title>
<path fill="none" stroke="black" d="M19679,-340.15C19730.41,-354.63 19793.02,-369.78 19850.5,-376.95 19952.27,-389.65 21595.38,-394.05 21696.5,-376.95 21742.86,-369.12 21792.74,-351.93 21831.57,-336.42"/>
<polygon fill="black" stroke="black" points="21833.24,-339.52 21841.2,-332.53 21830.62,-333.04 21833.24,-339.52"/>
</g>
<!-- s0_gate_3 -->
<g id="node50" class="node">
<title>s0_gate_3</title>
<polygon fill="orange" stroke="black" points="22848.89,-358.95 22256.5,-358.95 22104.11,-252.95 22696.5,-252.95 22848.89,-358.95"/>
<text text-anchor="middle" x="22476.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: MoE Gate</text>
<text text-anchor="middle" x="22476.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="22476.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_3&#45;&gt;s0_gate_3 -->
<g id="edge57" class="edge">
<title>s0_attn_3&#45;&gt;s0_gate_3</title>
<path fill="none" stroke="black" d="M22086.12,-305.95C22114.08,-305.95 22142.03,-305.95 22169.99,-305.95"/>
<polygon fill="black" stroke="black" points="22170.29,-309.45 22180.29,-305.95 22170.29,-302.45 22170.29,-309.45"/>
</g>
<!-- s0_expert_3 -->
<g id="node51" class="node">
<title>s0_expert_3</title>
<polygon fill="lightblue" stroke="black" points="23238,-332.45 22867,-332.45 22867,-279.45 23238,-279.45 23238,-332.45"/>
<text text-anchor="middle" x="23052.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: Expert FFN</text>
<text text-anchor="middle" x="23052.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="23052.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_3&#45;&gt;s0_expert_3 -->
<g id="edge58" class="edge">
<title>s0_gate_3&#45;&gt;s0_expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M22772.94,-305.95C22800.82,-305.95 22828.7,-305.95 22856.58,-305.95"/>
<polygon fill="black" stroke="black" points="22856.85,-309.45 22866.85,-305.95 22856.85,-302.45 22856.85,-309.45"/>
</g>
<!-- s0_alltoall_3 -->
<g id="node52" class="node">
<title>s0_alltoall_3</title>
<ellipse fill="white" stroke="black" cx="23518.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="23518.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: AllToAll</text>
<text text-anchor="middle" x="23518.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="23518.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_3&#45;&gt;s0_alltoall_3 -->
<g id="edge59" class="edge">
<title>s0_expert_3&#45;&gt;s0_alltoall_3</title>
<path fill="none" stroke="black" d="M23238.17,-305.95C23240.77,-305.95 23243.36,-305.95 23245.96,-305.95"/>
<polygon fill="black" stroke="black" points="23245.97,-309.45 23255.97,-305.95 23245.97,-302.45 23245.97,-309.45"/>
</g>
<!-- s0_ln1_3 -->
<g id="node53" class="node">
<title>s0_ln1_3</title>
<polygon fill="lightblue" stroke="black" points="24170,-332.45 23799,-332.45 23799,-279.45 24170,-279.45 24170,-332.45"/>
<text text-anchor="middle" x="23984.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU3: LayerNorm (DP0)</text>
<text text-anchor="middle" x="23984.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="23984.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_3&#45;&gt;s0_ln1_3 -->
<g id="edge60" class="edge">
<title>s0_alltoall_3&#45;&gt;s0_ln1_3</title>
<path fill="none" stroke="black" d="M23781.08,-305.95C23783.69,-305.95 23786.29,-305.95 23788.9,-305.95"/>
<polygon fill="black" stroke="black" points="23788.96,-309.45 23798.96,-305.95 23788.96,-302.45 23788.96,-309.45"/>
</g>
<!-- s1_ln0_19 -->
<g id="node246" class="node">
<title>s1_ln0_19</title>
<polygon fill="lightgreen" stroke="black" points="24170,-190.45 23799,-190.45 23799,-137.45 24170,-137.45 24170,-190.45"/>
<text text-anchor="middle" x="23984.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: LayerNorm (DP0)</text>
<text text-anchor="middle" x="23984.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="23984.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_3&#45;&gt;s1_ln0_19 -->
<g id="edge244" class="edge">
<title>s0_ln1_3&#45;&gt;s1_ln0_19</title>
<path fill="none" stroke="black" d="M23984.5,-279.28C23984.5,-257.17 23984.5,-225.05 23984.5,-200.48"/>
<polygon fill="black" stroke="black" points="23988,-200.47 23984.5,-190.47 23981,-200.47 23988,-200.47"/>
</g>
<!-- s0_ln0_4 -->
<g id="node55" class="node">
<title>s0_ln0_4</title>
<polygon fill="lightblue" stroke="black" points="24948,-332.45 24577,-332.45 24577,-279.45 24948,-279.45 24948,-332.45"/>
<text text-anchor="middle" x="24762.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: LayerNorm (DP1)</text>
<text text-anchor="middle" x="24762.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="24762.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_4&#45;&gt;s0_ln0_4 -->
<g id="edge62" class="edge">
<title>s0_emb_4&#45;&gt;s0_ln0_4</title>
<path fill="none" stroke="black" d="M24559.26,-305.95C24561.72,-305.95 24564.17,-305.95 24566.63,-305.95"/>
<polygon fill="black" stroke="black" points="24566.73,-309.45 24576.73,-305.95 24566.73,-302.45 24566.73,-309.45"/>
</g>
<!-- s0_q_4 -->
<g id="node56" class="node">
<title>s0_q_4</title>
<polygon fill="lightblue" stroke="black" points="27201,-332.45 26830,-332.45 26830,-279.45 27201,-279.45 27201,-332.45"/>
<text text-anchor="middle" x="27015.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: Q Linear (TP0)</text>
<text text-anchor="middle" x="27015.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="27015.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_q_4 -->
<g id="edge63" class="edge">
<title>s0_ln0_4&#45;&gt;s0_q_4</title>
<path fill="none" stroke="black" d="M24821.5,-332.53C24861.28,-348.94 24915.44,-368.45 24965.5,-376.95 25066.61,-394.12 26710.38,-394.05 26811.5,-376.95 26857.86,-369.12 26907.74,-351.93 26946.57,-336.42"/>
<polygon fill="black" stroke="black" points="26948.24,-339.52 26956.2,-332.53 26945.62,-333.04 26948.24,-339.52"/>
</g>
<!-- s0_k_4 -->
<g id="node57" class="node">
<title>s0_k_4</title>
<polygon fill="lightblue" stroke="black" points="26269,-332.45 25898,-332.45 25898,-279.45 26269,-279.45 26269,-332.45"/>
<text text-anchor="middle" x="26083.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: K Linear (TP0)</text>
<text text-anchor="middle" x="26083.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="26083.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_k_4 -->
<g id="edge64" class="edge">
<title>s0_ln0_4&#45;&gt;s0_k_4</title>
<path fill="none" stroke="black" d="M24821.5,-332.53C24861.28,-348.94 24915.44,-368.45 24965.5,-376.95 25065.62,-393.96 25779.37,-393.88 25879.5,-376.95 25925.86,-369.12 25975.74,-351.93 26014.57,-336.42"/>
<polygon fill="black" stroke="black" points="26016.24,-339.52 26024.2,-332.53 26013.62,-333.04 26016.24,-339.52"/>
</g>
<!-- s0_v_4 -->
<g id="node58" class="node">
<title>s0_v_4</title>
<polygon fill="lightblue" stroke="black" points="25337,-332.45 24966,-332.45 24966,-279.45 25337,-279.45 25337,-332.45"/>
<text text-anchor="middle" x="25151.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: V Linear (TP0)</text>
<text text-anchor="middle" x="25151.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="25151.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_4&#45;&gt;s0_v_4 -->
<g id="edge65" class="edge">
<title>s0_ln0_4&#45;&gt;s0_v_4</title>
<path fill="none" stroke="black" d="M24948.26,-305.95C24950.72,-305.95 24953.17,-305.95 24955.63,-305.95"/>
<polygon fill="black" stroke="black" points="24955.73,-309.45 24965.73,-305.95 24955.73,-302.45 24955.73,-309.45"/>
</g>
<!-- s0_allgather_q_4 -->
<g id="node59" class="node">
<title>s0_allgather_q_4</title>
<ellipse fill="white" stroke="black" cx="27481.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="27481.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather Q (TP0)</text>
<text text-anchor="middle" x="27481.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="27481.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_4&#45;&gt;s0_allgather_q_4 -->
<g id="edge66" class="edge">
<title>s0_q_4&#45;&gt;s0_allgather_q_4</title>
<path fill="none" stroke="black" d="M27201.17,-305.95C27203.77,-305.95 27206.36,-305.95 27208.96,-305.95"/>
<polygon fill="black" stroke="black" points="27208.97,-309.45 27218.97,-305.95 27208.97,-302.45 27208.97,-309.45"/>
</g>
<!-- s0_allgather_k_4 -->
<g id="node60" class="node">
<title>s0_allgather_k_4</title>
<ellipse fill="white" stroke="black" cx="26549.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="26549.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather K (TP0)</text>
<text text-anchor="middle" x="26549.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="26549.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_4&#45;&gt;s0_allgather_k_4 -->
<g id="edge67" class="edge">
<title>s0_k_4&#45;&gt;s0_allgather_k_4</title>
<path fill="none" stroke="black" d="M26269.17,-305.95C26271.77,-305.95 26274.36,-305.95 26276.96,-305.95"/>
<polygon fill="black" stroke="black" points="26276.97,-309.45 26286.97,-305.95 26276.97,-302.45 26276.97,-309.45"/>
</g>
<!-- s0_allgather_v_4 -->
<g id="node61" class="node">
<title>s0_allgather_v_4</title>
<ellipse fill="white" stroke="black" cx="25617.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="25617.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: AllGather V (TP0)</text>
<text text-anchor="middle" x="25617.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="25617.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_4&#45;&gt;s0_allgather_v_4 -->
<g id="edge68" class="edge">
<title>s0_v_4&#45;&gt;s0_allgather_v_4</title>
<path fill="none" stroke="black" d="M25337.17,-305.95C25339.77,-305.95 25342.36,-305.95 25344.96,-305.95"/>
<polygon fill="black" stroke="black" points="25344.97,-309.45 25354.97,-305.95 25344.97,-302.45 25344.97,-309.45"/>
</g>
<!-- s0_attn_4 -->
<g id="node62" class="node">
<title>s0_attn_4</title>
<polygon fill="lightblue" stroke="black" points="28133,-332.45 27762,-332.45 27762,-279.45 28133,-279.45 28133,-332.45"/>
<text text-anchor="middle" x="27947.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: Attention (TP0)</text>
<text text-anchor="middle" x="27947.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="27947.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_4&#45;&gt;s0_attn_4 -->
<g id="edge69" class="edge">
<title>s0_allgather_q_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M27744.08,-305.95C27746.69,-305.95 27749.29,-305.95 27751.9,-305.95"/>
<polygon fill="black" stroke="black" points="27751.96,-309.45 27761.96,-305.95 27751.96,-302.45 27751.96,-309.45"/>
</g>
<!-- s0_allgather_k_4&#45;&gt;s0_attn_4 -->
<g id="edge70" class="edge">
<title>s0_allgather_k_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M26658,-340.15C26709.41,-354.63 26772.02,-369.78 26829.5,-376.95 26930.27,-389.53 27643.37,-393.88 27743.5,-376.95 27789.86,-369.12 27839.74,-351.93 27878.57,-336.42"/>
<polygon fill="black" stroke="black" points="27880.24,-339.52 27888.2,-332.53 27877.62,-333.04 27880.24,-339.52"/>
</g>
<!-- s0_allgather_v_4&#45;&gt;s0_attn_4 -->
<g id="edge71" class="edge">
<title>s0_allgather_v_4&#45;&gt;s0_attn_4</title>
<path fill="none" stroke="black" d="M25726,-340.15C25777.41,-354.63 25840.02,-369.78 25897.5,-376.95 25999.27,-389.65 27642.38,-394.05 27743.5,-376.95 27789.86,-369.12 27839.74,-351.93 27878.57,-336.42"/>
<polygon fill="black" stroke="black" points="27880.24,-339.52 27888.2,-332.53 27877.62,-333.04 27880.24,-339.52"/>
</g>
<!-- s0_gate_4 -->
<g id="node63" class="node">
<title>s0_gate_4</title>
<polygon fill="orange" stroke="black" points="28895.89,-358.95 28303.5,-358.95 28151.11,-252.95 28743.5,-252.95 28895.89,-358.95"/>
<text text-anchor="middle" x="28523.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: MoE Gate</text>
<text text-anchor="middle" x="28523.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="28523.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_4&#45;&gt;s0_gate_4 -->
<g id="edge72" class="edge">
<title>s0_attn_4&#45;&gt;s0_gate_4</title>
<path fill="none" stroke="black" d="M28133.12,-305.95C28161.08,-305.95 28189.03,-305.95 28216.99,-305.95"/>
<polygon fill="black" stroke="black" points="28217.29,-309.45 28227.29,-305.95 28217.29,-302.45 28217.29,-309.45"/>
</g>
<!-- s0_expert_4 -->
<g id="node64" class="node">
<title>s0_expert_4</title>
<polygon fill="lightblue" stroke="black" points="29285,-332.45 28914,-332.45 28914,-279.45 29285,-279.45 29285,-332.45"/>
<text text-anchor="middle" x="29099.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: Expert FFN</text>
<text text-anchor="middle" x="29099.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="29099.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_4&#45;&gt;s0_expert_4 -->
<g id="edge73" class="edge">
<title>s0_gate_4&#45;&gt;s0_expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M28819.94,-305.95C28847.82,-305.95 28875.7,-305.95 28903.58,-305.95"/>
<polygon fill="black" stroke="black" points="28903.85,-309.45 28913.85,-305.95 28903.85,-302.45 28903.85,-309.45"/>
</g>
<!-- s0_alltoall_4 -->
<g id="node65" class="node">
<title>s0_alltoall_4</title>
<ellipse fill="white" stroke="black" cx="29565.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="29565.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: AllToAll</text>
<text text-anchor="middle" x="29565.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="29565.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_4&#45;&gt;s0_alltoall_4 -->
<g id="edge74" class="edge">
<title>s0_expert_4&#45;&gt;s0_alltoall_4</title>
<path fill="none" stroke="black" d="M29285.17,-305.95C29287.77,-305.95 29290.36,-305.95 29292.96,-305.95"/>
<polygon fill="black" stroke="black" points="29292.97,-309.45 29302.97,-305.95 29292.97,-302.45 29292.97,-309.45"/>
</g>
<!-- s0_ln1_4 -->
<g id="node66" class="node">
<title>s0_ln1_4</title>
<polygon fill="lightblue" stroke="black" points="30217,-332.45 29846,-332.45 29846,-279.45 30217,-279.45 30217,-332.45"/>
<text text-anchor="middle" x="30031.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU4: LayerNorm (DP1)</text>
<text text-anchor="middle" x="30031.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="30031.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_4&#45;&gt;s0_ln1_4 -->
<g id="edge75" class="edge">
<title>s0_alltoall_4&#45;&gt;s0_ln1_4</title>
<path fill="none" stroke="black" d="M29828.08,-305.95C29830.69,-305.95 29833.29,-305.95 29835.9,-305.95"/>
<polygon fill="black" stroke="black" points="29835.96,-309.45 29845.96,-305.95 29835.96,-302.45 29835.96,-309.45"/>
</g>
<!-- s1_ln0_20 -->
<g id="node258" class="node">
<title>s1_ln0_20</title>
<polygon fill="lightgreen" stroke="black" points="30217,-190.45 29846,-190.45 29846,-137.45 30217,-137.45 30217,-190.45"/>
<text text-anchor="middle" x="30031.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: LayerNorm (DP1)</text>
<text text-anchor="middle" x="30031.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="30031.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_4&#45;&gt;s1_ln0_20 -->
<g id="edge245" class="edge">
<title>s0_ln1_4&#45;&gt;s1_ln0_20</title>
<path fill="none" stroke="black" d="M30031.5,-279.28C30031.5,-257.17 30031.5,-225.05 30031.5,-200.48"/>
<polygon fill="black" stroke="black" points="30035,-200.47 30031.5,-190.47 30028,-200.47 30035,-200.47"/>
</g>
<!-- s0_ln0_5 -->
<g id="node68" class="node">
<title>s0_ln0_5</title>
<polygon fill="lightblue" stroke="black" points="30995,-332.45 30624,-332.45 30624,-279.45 30995,-279.45 30995,-332.45"/>
<text text-anchor="middle" x="30809.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: LayerNorm (DP1)</text>
<text text-anchor="middle" x="30809.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="30809.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_5&#45;&gt;s0_ln0_5 -->
<g id="edge77" class="edge">
<title>s0_emb_5&#45;&gt;s0_ln0_5</title>
<path fill="none" stroke="black" d="M30606.26,-305.95C30608.72,-305.95 30611.17,-305.95 30613.63,-305.95"/>
<polygon fill="black" stroke="black" points="30613.73,-309.45 30623.73,-305.95 30613.73,-302.45 30613.73,-309.45"/>
</g>
<!-- s0_q_5 -->
<g id="node69" class="node">
<title>s0_q_5</title>
<polygon fill="lightblue" stroke="black" points="33248,-332.45 32877,-332.45 32877,-279.45 33248,-279.45 33248,-332.45"/>
<text text-anchor="middle" x="33062.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: Q Linear (TP1)</text>
<text text-anchor="middle" x="33062.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="33062.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_q_5 -->
<g id="edge78" class="edge">
<title>s0_ln0_5&#45;&gt;s0_q_5</title>
<path fill="none" stroke="black" d="M30868.5,-332.53C30908.28,-348.94 30962.44,-368.45 31012.5,-376.95 31113.61,-394.12 32757.38,-394.05 32858.5,-376.95 32904.86,-369.12 32954.74,-351.93 32993.57,-336.42"/>
<polygon fill="black" stroke="black" points="32995.24,-339.52 33003.2,-332.53 32992.62,-333.04 32995.24,-339.52"/>
</g>
<!-- s0_k_5 -->
<g id="node70" class="node">
<title>s0_k_5</title>
<polygon fill="lightblue" stroke="black" points="32316,-332.45 31945,-332.45 31945,-279.45 32316,-279.45 32316,-332.45"/>
<text text-anchor="middle" x="32130.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: K Linear (TP1)</text>
<text text-anchor="middle" x="32130.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="32130.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_k_5 -->
<g id="edge79" class="edge">
<title>s0_ln0_5&#45;&gt;s0_k_5</title>
<path fill="none" stroke="black" d="M30868.5,-332.53C30908.28,-348.94 30962.44,-368.45 31012.5,-376.95 31112.62,-393.96 31826.37,-393.88 31926.5,-376.95 31972.86,-369.12 32022.74,-351.93 32061.57,-336.42"/>
<polygon fill="black" stroke="black" points="32063.24,-339.52 32071.2,-332.53 32060.62,-333.04 32063.24,-339.52"/>
</g>
<!-- s0_v_5 -->
<g id="node71" class="node">
<title>s0_v_5</title>
<polygon fill="lightblue" stroke="black" points="31384,-332.45 31013,-332.45 31013,-279.45 31384,-279.45 31384,-332.45"/>
<text text-anchor="middle" x="31198.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: V Linear (TP1)</text>
<text text-anchor="middle" x="31198.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="31198.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_5&#45;&gt;s0_v_5 -->
<g id="edge80" class="edge">
<title>s0_ln0_5&#45;&gt;s0_v_5</title>
<path fill="none" stroke="black" d="M30995.26,-305.95C30997.72,-305.95 31000.17,-305.95 31002.63,-305.95"/>
<polygon fill="black" stroke="black" points="31002.73,-309.45 31012.73,-305.95 31002.73,-302.45 31002.73,-309.45"/>
</g>
<!-- s0_allgather_q_5 -->
<g id="node72" class="node">
<title>s0_allgather_q_5</title>
<ellipse fill="white" stroke="black" cx="33528.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="33528.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather Q (TP1)</text>
<text text-anchor="middle" x="33528.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="33528.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_5&#45;&gt;s0_allgather_q_5 -->
<g id="edge81" class="edge">
<title>s0_q_5&#45;&gt;s0_allgather_q_5</title>
<path fill="none" stroke="black" d="M33248.17,-305.95C33250.77,-305.95 33253.36,-305.95 33255.96,-305.95"/>
<polygon fill="black" stroke="black" points="33255.97,-309.45 33265.97,-305.95 33255.97,-302.45 33255.97,-309.45"/>
</g>
<!-- s0_allgather_k_5 -->
<g id="node73" class="node">
<title>s0_allgather_k_5</title>
<ellipse fill="white" stroke="black" cx="32596.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="32596.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather K (TP1)</text>
<text text-anchor="middle" x="32596.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="32596.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_5&#45;&gt;s0_allgather_k_5 -->
<g id="edge82" class="edge">
<title>s0_k_5&#45;&gt;s0_allgather_k_5</title>
<path fill="none" stroke="black" d="M32316.17,-305.95C32318.77,-305.95 32321.36,-305.95 32323.96,-305.95"/>
<polygon fill="black" stroke="black" points="32323.97,-309.45 32333.97,-305.95 32323.97,-302.45 32323.97,-309.45"/>
</g>
<!-- s0_allgather_v_5 -->
<g id="node74" class="node">
<title>s0_allgather_v_5</title>
<ellipse fill="white" stroke="black" cx="31664.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="31664.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: AllGather V (TP1)</text>
<text text-anchor="middle" x="31664.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="31664.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_5&#45;&gt;s0_allgather_v_5 -->
<g id="edge83" class="edge">
<title>s0_v_5&#45;&gt;s0_allgather_v_5</title>
<path fill="none" stroke="black" d="M31384.17,-305.95C31386.77,-305.95 31389.36,-305.95 31391.96,-305.95"/>
<polygon fill="black" stroke="black" points="31391.97,-309.45 31401.97,-305.95 31391.97,-302.45 31391.97,-309.45"/>
</g>
<!-- s0_attn_5 -->
<g id="node75" class="node">
<title>s0_attn_5</title>
<polygon fill="lightblue" stroke="black" points="34180,-332.45 33809,-332.45 33809,-279.45 34180,-279.45 34180,-332.45"/>
<text text-anchor="middle" x="33994.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: Attention (TP1)</text>
<text text-anchor="middle" x="33994.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="33994.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_5&#45;&gt;s0_attn_5 -->
<g id="edge84" class="edge">
<title>s0_allgather_q_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M33791.08,-305.95C33793.69,-305.95 33796.29,-305.95 33798.9,-305.95"/>
<polygon fill="black" stroke="black" points="33798.96,-309.45 33808.96,-305.95 33798.96,-302.45 33798.96,-309.45"/>
</g>
<!-- s0_allgather_k_5&#45;&gt;s0_attn_5 -->
<g id="edge85" class="edge">
<title>s0_allgather_k_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M32705,-340.15C32756.41,-354.63 32819.02,-369.78 32876.5,-376.95 32977.27,-389.53 33690.37,-393.88 33790.5,-376.95 33836.86,-369.12 33886.74,-351.93 33925.57,-336.42"/>
<polygon fill="black" stroke="black" points="33927.24,-339.52 33935.2,-332.53 33924.62,-333.04 33927.24,-339.52"/>
</g>
<!-- s0_allgather_v_5&#45;&gt;s0_attn_5 -->
<g id="edge86" class="edge">
<title>s0_allgather_v_5&#45;&gt;s0_attn_5</title>
<path fill="none" stroke="black" d="M31773,-340.15C31824.41,-354.63 31887.02,-369.78 31944.5,-376.95 32046.27,-389.65 33689.38,-394.05 33790.5,-376.95 33836.86,-369.12 33886.74,-351.93 33925.57,-336.42"/>
<polygon fill="black" stroke="black" points="33927.24,-339.52 33935.2,-332.53 33924.62,-333.04 33927.24,-339.52"/>
</g>
<!-- s0_gate_5 -->
<g id="node76" class="node">
<title>s0_gate_5</title>
<polygon fill="orange" stroke="black" points="34942.89,-358.95 34350.5,-358.95 34198.11,-252.95 34790.5,-252.95 34942.89,-358.95"/>
<text text-anchor="middle" x="34570.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: MoE Gate</text>
<text text-anchor="middle" x="34570.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="34570.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_5&#45;&gt;s0_gate_5 -->
<g id="edge87" class="edge">
<title>s0_attn_5&#45;&gt;s0_gate_5</title>
<path fill="none" stroke="black" d="M34180.12,-305.95C34208.08,-305.95 34236.03,-305.95 34263.99,-305.95"/>
<polygon fill="black" stroke="black" points="34264.29,-309.45 34274.29,-305.95 34264.29,-302.45 34264.29,-309.45"/>
</g>
<!-- s0_expert_5 -->
<g id="node77" class="node">
<title>s0_expert_5</title>
<polygon fill="lightblue" stroke="black" points="35332,-332.45 34961,-332.45 34961,-279.45 35332,-279.45 35332,-332.45"/>
<text text-anchor="middle" x="35146.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: Expert FFN</text>
<text text-anchor="middle" x="35146.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="35146.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_5&#45;&gt;s0_expert_5 -->
<g id="edge88" class="edge">
<title>s0_gate_5&#45;&gt;s0_expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M34866.94,-305.95C34894.82,-305.95 34922.7,-305.95 34950.58,-305.95"/>
<polygon fill="black" stroke="black" points="34950.85,-309.45 34960.85,-305.95 34950.85,-302.45 34950.85,-309.45"/>
</g>
<!-- s0_alltoall_5 -->
<g id="node78" class="node">
<title>s0_alltoall_5</title>
<ellipse fill="white" stroke="black" cx="35612.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="35612.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: AllToAll</text>
<text text-anchor="middle" x="35612.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="35612.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_5&#45;&gt;s0_alltoall_5 -->
<g id="edge89" class="edge">
<title>s0_expert_5&#45;&gt;s0_alltoall_5</title>
<path fill="none" stroke="black" d="M35332.17,-305.95C35334.77,-305.95 35337.36,-305.95 35339.96,-305.95"/>
<polygon fill="black" stroke="black" points="35339.97,-309.45 35349.97,-305.95 35339.97,-302.45 35339.97,-309.45"/>
</g>
<!-- s0_ln1_5 -->
<g id="node79" class="node">
<title>s0_ln1_5</title>
<polygon fill="lightblue" stroke="black" points="36264,-332.45 35893,-332.45 35893,-279.45 36264,-279.45 36264,-332.45"/>
<text text-anchor="middle" x="36078.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU5: LayerNorm (DP1)</text>
<text text-anchor="middle" x="36078.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="36078.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_5&#45;&gt;s0_ln1_5 -->
<g id="edge90" class="edge">
<title>s0_alltoall_5&#45;&gt;s0_ln1_5</title>
<path fill="none" stroke="black" d="M35875.08,-305.95C35877.69,-305.95 35880.29,-305.95 35882.9,-305.95"/>
<polygon fill="black" stroke="black" points="35882.96,-309.45 35892.96,-305.95 35882.96,-302.45 35882.96,-309.45"/>
</g>
<!-- s1_ln0_21 -->
<g id="node270" class="node">
<title>s1_ln0_21</title>
<polygon fill="lightgreen" stroke="black" points="36264,-190.45 35893,-190.45 35893,-137.45 36264,-137.45 36264,-190.45"/>
<text text-anchor="middle" x="36078.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: LayerNorm (DP1)</text>
<text text-anchor="middle" x="36078.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="36078.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_5&#45;&gt;s1_ln0_21 -->
<g id="edge246" class="edge">
<title>s0_ln1_5&#45;&gt;s1_ln0_21</title>
<path fill="none" stroke="black" d="M36078.5,-279.28C36078.5,-257.17 36078.5,-225.05 36078.5,-200.48"/>
<polygon fill="black" stroke="black" points="36082,-200.47 36078.5,-190.47 36075,-200.47 36082,-200.47"/>
</g>
<!-- s0_ln0_6 -->
<g id="node81" class="node">
<title>s0_ln0_6</title>
<polygon fill="lightblue" stroke="black" points="37042,-332.45 36671,-332.45 36671,-279.45 37042,-279.45 37042,-332.45"/>
<text text-anchor="middle" x="36856.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: LayerNorm (DP1)</text>
<text text-anchor="middle" x="36856.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="36856.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_6&#45;&gt;s0_ln0_6 -->
<g id="edge92" class="edge">
<title>s0_emb_6&#45;&gt;s0_ln0_6</title>
<path fill="none" stroke="black" d="M36653.26,-305.95C36655.72,-305.95 36658.17,-305.95 36660.63,-305.95"/>
<polygon fill="black" stroke="black" points="36660.73,-309.45 36670.73,-305.95 36660.73,-302.45 36660.73,-309.45"/>
</g>
<!-- s0_q_6 -->
<g id="node82" class="node">
<title>s0_q_6</title>
<polygon fill="lightblue" stroke="black" points="39295,-332.45 38924,-332.45 38924,-279.45 39295,-279.45 39295,-332.45"/>
<text text-anchor="middle" x="39109.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: Q Linear (TP2)</text>
<text text-anchor="middle" x="39109.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="39109.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_q_6 -->
<g id="edge93" class="edge">
<title>s0_ln0_6&#45;&gt;s0_q_6</title>
<path fill="none" stroke="black" d="M36915.5,-332.53C36955.28,-348.94 37009.44,-368.45 37059.5,-376.95 37160.61,-394.12 38804.38,-394.05 38905.5,-376.95 38951.86,-369.12 39001.74,-351.93 39040.57,-336.42"/>
<polygon fill="black" stroke="black" points="39042.24,-339.52 39050.2,-332.53 39039.62,-333.04 39042.24,-339.52"/>
</g>
<!-- s0_k_6 -->
<g id="node83" class="node">
<title>s0_k_6</title>
<polygon fill="lightblue" stroke="black" points="38363,-332.45 37992,-332.45 37992,-279.45 38363,-279.45 38363,-332.45"/>
<text text-anchor="middle" x="38177.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: K Linear (TP2)</text>
<text text-anchor="middle" x="38177.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="38177.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_k_6 -->
<g id="edge94" class="edge">
<title>s0_ln0_6&#45;&gt;s0_k_6</title>
<path fill="none" stroke="black" d="M36915.5,-332.53C36955.28,-348.94 37009.44,-368.45 37059.5,-376.95 37159.62,-393.96 37873.37,-393.88 37973.5,-376.95 38019.86,-369.12 38069.74,-351.93 38108.57,-336.42"/>
<polygon fill="black" stroke="black" points="38110.24,-339.52 38118.2,-332.53 38107.62,-333.04 38110.24,-339.52"/>
</g>
<!-- s0_v_6 -->
<g id="node84" class="node">
<title>s0_v_6</title>
<polygon fill="lightblue" stroke="black" points="37431,-332.45 37060,-332.45 37060,-279.45 37431,-279.45 37431,-332.45"/>
<text text-anchor="middle" x="37245.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: V Linear (TP2)</text>
<text text-anchor="middle" x="37245.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="37245.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_6&#45;&gt;s0_v_6 -->
<g id="edge95" class="edge">
<title>s0_ln0_6&#45;&gt;s0_v_6</title>
<path fill="none" stroke="black" d="M37042.26,-305.95C37044.72,-305.95 37047.17,-305.95 37049.63,-305.95"/>
<polygon fill="black" stroke="black" points="37049.73,-309.45 37059.73,-305.95 37049.73,-302.45 37049.73,-309.45"/>
</g>
<!-- s0_allgather_q_6 -->
<g id="node85" class="node">
<title>s0_allgather_q_6</title>
<ellipse fill="white" stroke="black" cx="39575.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="39575.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather Q (TP2)</text>
<text text-anchor="middle" x="39575.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="39575.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_6&#45;&gt;s0_allgather_q_6 -->
<g id="edge96" class="edge">
<title>s0_q_6&#45;&gt;s0_allgather_q_6</title>
<path fill="none" stroke="black" d="M39295.17,-305.95C39297.77,-305.95 39300.36,-305.95 39302.96,-305.95"/>
<polygon fill="black" stroke="black" points="39302.97,-309.45 39312.97,-305.95 39302.97,-302.45 39302.97,-309.45"/>
</g>
<!-- s0_allgather_k_6 -->
<g id="node86" class="node">
<title>s0_allgather_k_6</title>
<ellipse fill="white" stroke="black" cx="38643.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="38643.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather K (TP2)</text>
<text text-anchor="middle" x="38643.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="38643.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_6&#45;&gt;s0_allgather_k_6 -->
<g id="edge97" class="edge">
<title>s0_k_6&#45;&gt;s0_allgather_k_6</title>
<path fill="none" stroke="black" d="M38363.17,-305.95C38365.77,-305.95 38368.36,-305.95 38370.96,-305.95"/>
<polygon fill="black" stroke="black" points="38370.97,-309.45 38380.97,-305.95 38370.97,-302.45 38370.97,-309.45"/>
</g>
<!-- s0_allgather_v_6 -->
<g id="node87" class="node">
<title>s0_allgather_v_6</title>
<ellipse fill="white" stroke="black" cx="37711.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="37711.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: AllGather V (TP2)</text>
<text text-anchor="middle" x="37711.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="37711.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_6&#45;&gt;s0_allgather_v_6 -->
<g id="edge98" class="edge">
<title>s0_v_6&#45;&gt;s0_allgather_v_6</title>
<path fill="none" stroke="black" d="M37431.17,-305.95C37433.77,-305.95 37436.36,-305.95 37438.96,-305.95"/>
<polygon fill="black" stroke="black" points="37438.97,-309.45 37448.97,-305.95 37438.97,-302.45 37438.97,-309.45"/>
</g>
<!-- s0_attn_6 -->
<g id="node88" class="node">
<title>s0_attn_6</title>
<polygon fill="lightblue" stroke="black" points="40227,-332.45 39856,-332.45 39856,-279.45 40227,-279.45 40227,-332.45"/>
<text text-anchor="middle" x="40041.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: Attention (TP2)</text>
<text text-anchor="middle" x="40041.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="40041.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_6&#45;&gt;s0_attn_6 -->
<g id="edge99" class="edge">
<title>s0_allgather_q_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M39838.08,-305.95C39840.69,-305.95 39843.29,-305.95 39845.9,-305.95"/>
<polygon fill="black" stroke="black" points="39845.96,-309.45 39855.96,-305.95 39845.96,-302.45 39845.96,-309.45"/>
</g>
<!-- s0_allgather_k_6&#45;&gt;s0_attn_6 -->
<g id="edge100" class="edge">
<title>s0_allgather_k_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M38752,-340.15C38803.41,-354.63 38866.02,-369.78 38923.5,-376.95 39024.27,-389.53 39737.37,-393.88 39837.5,-376.95 39883.86,-369.12 39933.74,-351.93 39972.57,-336.42"/>
<polygon fill="black" stroke="black" points="39974.24,-339.52 39982.2,-332.53 39971.62,-333.04 39974.24,-339.52"/>
</g>
<!-- s0_allgather_v_6&#45;&gt;s0_attn_6 -->
<g id="edge101" class="edge">
<title>s0_allgather_v_6&#45;&gt;s0_attn_6</title>
<path fill="none" stroke="black" d="M37820,-340.15C37871.41,-354.63 37934.02,-369.78 37991.5,-376.95 38093.27,-389.65 39736.38,-394.05 39837.5,-376.95 39883.86,-369.12 39933.74,-351.93 39972.57,-336.42"/>
<polygon fill="black" stroke="black" points="39974.24,-339.52 39982.2,-332.53 39971.62,-333.04 39974.24,-339.52"/>
</g>
<!-- s0_gate_6 -->
<g id="node89" class="node">
<title>s0_gate_6</title>
<polygon fill="orange" stroke="black" points="40989.89,-358.95 40397.5,-358.95 40245.11,-252.95 40837.5,-252.95 40989.89,-358.95"/>
<text text-anchor="middle" x="40617.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: MoE Gate</text>
<text text-anchor="middle" x="40617.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="40617.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_6&#45;&gt;s0_gate_6 -->
<g id="edge102" class="edge">
<title>s0_attn_6&#45;&gt;s0_gate_6</title>
<path fill="none" stroke="black" d="M40227.12,-305.95C40255.08,-305.95 40283.03,-305.95 40310.99,-305.95"/>
<polygon fill="black" stroke="black" points="40311.29,-309.45 40321.29,-305.95 40311.29,-302.45 40311.29,-309.45"/>
</g>
<!-- s0_expert_6 -->
<g id="node90" class="node">
<title>s0_expert_6</title>
<polygon fill="lightblue" stroke="black" points="41379,-332.45 41008,-332.45 41008,-279.45 41379,-279.45 41379,-332.45"/>
<text text-anchor="middle" x="41193.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: Expert FFN</text>
<text text-anchor="middle" x="41193.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="41193.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_6&#45;&gt;s0_expert_6 -->
<g id="edge103" class="edge">
<title>s0_gate_6&#45;&gt;s0_expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M40913.94,-305.95C40941.82,-305.95 40969.7,-305.95 40997.58,-305.95"/>
<polygon fill="black" stroke="black" points="40997.85,-309.45 41007.85,-305.95 40997.85,-302.45 40997.85,-309.45"/>
</g>
<!-- s0_alltoall_6 -->
<g id="node91" class="node">
<title>s0_alltoall_6</title>
<ellipse fill="white" stroke="black" cx="41659.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="41659.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: AllToAll</text>
<text text-anchor="middle" x="41659.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="41659.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_6&#45;&gt;s0_alltoall_6 -->
<g id="edge104" class="edge">
<title>s0_expert_6&#45;&gt;s0_alltoall_6</title>
<path fill="none" stroke="black" d="M41379.17,-305.95C41381.77,-305.95 41384.36,-305.95 41386.96,-305.95"/>
<polygon fill="black" stroke="black" points="41386.97,-309.45 41396.97,-305.95 41386.97,-302.45 41386.97,-309.45"/>
</g>
<!-- s0_ln1_6 -->
<g id="node92" class="node">
<title>s0_ln1_6</title>
<polygon fill="lightblue" stroke="black" points="42311,-332.45 41940,-332.45 41940,-279.45 42311,-279.45 42311,-332.45"/>
<text text-anchor="middle" x="42125.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU6: LayerNorm (DP1)</text>
<text text-anchor="middle" x="42125.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="42125.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_6&#45;&gt;s0_ln1_6 -->
<g id="edge105" class="edge">
<title>s0_alltoall_6&#45;&gt;s0_ln1_6</title>
<path fill="none" stroke="black" d="M41922.08,-305.95C41924.69,-305.95 41927.29,-305.95 41929.9,-305.95"/>
<polygon fill="black" stroke="black" points="41929.96,-309.45 41939.96,-305.95 41929.96,-302.45 41929.96,-309.45"/>
</g>
<!-- s1_ln0_22 -->
<g id="node282" class="node">
<title>s1_ln0_22</title>
<polygon fill="lightgreen" stroke="black" points="42311,-190.45 41940,-190.45 41940,-137.45 42311,-137.45 42311,-190.45"/>
<text text-anchor="middle" x="42125.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: LayerNorm (DP1)</text>
<text text-anchor="middle" x="42125.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="42125.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_6&#45;&gt;s1_ln0_22 -->
<g id="edge247" class="edge">
<title>s0_ln1_6&#45;&gt;s1_ln0_22</title>
<path fill="none" stroke="black" d="M42125.5,-279.28C42125.5,-257.17 42125.5,-225.05 42125.5,-200.48"/>
<polygon fill="black" stroke="black" points="42129,-200.47 42125.5,-190.47 42122,-200.47 42129,-200.47"/>
</g>
<!-- s0_ln0_7 -->
<g id="node94" class="node">
<title>s0_ln0_7</title>
<polygon fill="lightblue" stroke="black" points="43089,-332.45 42718,-332.45 42718,-279.45 43089,-279.45 43089,-332.45"/>
<text text-anchor="middle" x="42903.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: LayerNorm (DP1)</text>
<text text-anchor="middle" x="42903.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="42903.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_7&#45;&gt;s0_ln0_7 -->
<g id="edge107" class="edge">
<title>s0_emb_7&#45;&gt;s0_ln0_7</title>
<path fill="none" stroke="black" d="M42700.26,-305.95C42702.72,-305.95 42705.17,-305.95 42707.63,-305.95"/>
<polygon fill="black" stroke="black" points="42707.73,-309.45 42717.73,-305.95 42707.73,-302.45 42707.73,-309.45"/>
</g>
<!-- s0_q_7 -->
<g id="node95" class="node">
<title>s0_q_7</title>
<polygon fill="lightblue" stroke="black" points="45342,-332.45 44971,-332.45 44971,-279.45 45342,-279.45 45342,-332.45"/>
<text text-anchor="middle" x="45156.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: Q Linear (TP3)</text>
<text text-anchor="middle" x="45156.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="45156.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_q_7 -->
<g id="edge108" class="edge">
<title>s0_ln0_7&#45;&gt;s0_q_7</title>
<path fill="none" stroke="black" d="M42962.5,-332.53C43002.28,-348.94 43056.44,-368.45 43106.5,-376.95 43207.61,-394.12 44851.38,-394.05 44952.5,-376.95 44998.86,-369.12 45048.74,-351.93 45087.57,-336.42"/>
<polygon fill="black" stroke="black" points="45089.24,-339.52 45097.2,-332.53 45086.62,-333.04 45089.24,-339.52"/>
</g>
<!-- s0_k_7 -->
<g id="node96" class="node">
<title>s0_k_7</title>
<polygon fill="lightblue" stroke="black" points="44410,-332.45 44039,-332.45 44039,-279.45 44410,-279.45 44410,-332.45"/>
<text text-anchor="middle" x="44224.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: K Linear (TP3)</text>
<text text-anchor="middle" x="44224.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="44224.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_k_7 -->
<g id="edge109" class="edge">
<title>s0_ln0_7&#45;&gt;s0_k_7</title>
<path fill="none" stroke="black" d="M42962.5,-332.53C43002.28,-348.94 43056.44,-368.45 43106.5,-376.95 43206.62,-393.96 43920.37,-393.88 44020.5,-376.95 44066.86,-369.12 44116.74,-351.93 44155.57,-336.42"/>
<polygon fill="black" stroke="black" points="44157.24,-339.52 44165.2,-332.53 44154.62,-333.04 44157.24,-339.52"/>
</g>
<!-- s0_v_7 -->
<g id="node97" class="node">
<title>s0_v_7</title>
<polygon fill="lightblue" stroke="black" points="43478,-332.45 43107,-332.45 43107,-279.45 43478,-279.45 43478,-332.45"/>
<text text-anchor="middle" x="43292.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: V Linear (TP3)</text>
<text text-anchor="middle" x="43292.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="43292.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_7&#45;&gt;s0_v_7 -->
<g id="edge110" class="edge">
<title>s0_ln0_7&#45;&gt;s0_v_7</title>
<path fill="none" stroke="black" d="M43089.26,-305.95C43091.72,-305.95 43094.17,-305.95 43096.63,-305.95"/>
<polygon fill="black" stroke="black" points="43096.73,-309.45 43106.73,-305.95 43096.73,-302.45 43096.73,-309.45"/>
</g>
<!-- s0_allgather_q_7 -->
<g id="node98" class="node">
<title>s0_allgather_q_7</title>
<ellipse fill="white" stroke="black" cx="45622.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="45622.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather Q (TP3)</text>
<text text-anchor="middle" x="45622.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="45622.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_7&#45;&gt;s0_allgather_q_7 -->
<g id="edge111" class="edge">
<title>s0_q_7&#45;&gt;s0_allgather_q_7</title>
<path fill="none" stroke="black" d="M45342.17,-305.95C45344.77,-305.95 45347.36,-305.95 45349.96,-305.95"/>
<polygon fill="black" stroke="black" points="45349.97,-309.45 45359.97,-305.95 45349.97,-302.45 45349.97,-309.45"/>
</g>
<!-- s0_allgather_k_7 -->
<g id="node99" class="node">
<title>s0_allgather_k_7</title>
<ellipse fill="white" stroke="black" cx="44690.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="44690.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather K (TP3)</text>
<text text-anchor="middle" x="44690.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="44690.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_7&#45;&gt;s0_allgather_k_7 -->
<g id="edge112" class="edge">
<title>s0_k_7&#45;&gt;s0_allgather_k_7</title>
<path fill="none" stroke="black" d="M44410.17,-305.95C44412.77,-305.95 44415.36,-305.95 44417.96,-305.95"/>
<polygon fill="black" stroke="black" points="44417.97,-309.45 44427.97,-305.95 44417.97,-302.45 44417.97,-309.45"/>
</g>
<!-- s0_allgather_v_7 -->
<g id="node100" class="node">
<title>s0_allgather_v_7</title>
<ellipse fill="white" stroke="black" cx="43758.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="43758.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: AllGather V (TP3)</text>
<text text-anchor="middle" x="43758.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="43758.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_7&#45;&gt;s0_allgather_v_7 -->
<g id="edge113" class="edge">
<title>s0_v_7&#45;&gt;s0_allgather_v_7</title>
<path fill="none" stroke="black" d="M43478.17,-305.95C43480.77,-305.95 43483.36,-305.95 43485.96,-305.95"/>
<polygon fill="black" stroke="black" points="43485.97,-309.45 43495.97,-305.95 43485.97,-302.45 43485.97,-309.45"/>
</g>
<!-- s0_attn_7 -->
<g id="node101" class="node">
<title>s0_attn_7</title>
<polygon fill="lightblue" stroke="black" points="46274,-332.45 45903,-332.45 45903,-279.45 46274,-279.45 46274,-332.45"/>
<text text-anchor="middle" x="46088.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: Attention (TP3)</text>
<text text-anchor="middle" x="46088.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="46088.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_7&#45;&gt;s0_attn_7 -->
<g id="edge114" class="edge">
<title>s0_allgather_q_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M45885.08,-305.95C45887.69,-305.95 45890.29,-305.95 45892.9,-305.95"/>
<polygon fill="black" stroke="black" points="45892.96,-309.45 45902.96,-305.95 45892.96,-302.45 45892.96,-309.45"/>
</g>
<!-- s0_allgather_k_7&#45;&gt;s0_attn_7 -->
<g id="edge115" class="edge">
<title>s0_allgather_k_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M44799,-340.15C44850.41,-354.63 44913.02,-369.78 44970.5,-376.95 45071.27,-389.53 45784.37,-393.88 45884.5,-376.95 45930.86,-369.12 45980.74,-351.93 46019.57,-336.42"/>
<polygon fill="black" stroke="black" points="46021.24,-339.52 46029.2,-332.53 46018.62,-333.04 46021.24,-339.52"/>
</g>
<!-- s0_allgather_v_7&#45;&gt;s0_attn_7 -->
<g id="edge116" class="edge">
<title>s0_allgather_v_7&#45;&gt;s0_attn_7</title>
<path fill="none" stroke="black" d="M43867,-340.15C43918.41,-354.63 43981.02,-369.78 44038.5,-376.95 44140.27,-389.65 45783.38,-394.05 45884.5,-376.95 45930.86,-369.12 45980.74,-351.93 46019.57,-336.42"/>
<polygon fill="black" stroke="black" points="46021.24,-339.52 46029.2,-332.53 46018.62,-333.04 46021.24,-339.52"/>
</g>
<!-- s0_gate_7 -->
<g id="node102" class="node">
<title>s0_gate_7</title>
<polygon fill="orange" stroke="black" points="47036.89,-358.95 46444.5,-358.95 46292.11,-252.95 46884.5,-252.95 47036.89,-358.95"/>
<text text-anchor="middle" x="46664.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: MoE Gate</text>
<text text-anchor="middle" x="46664.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="46664.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_7&#45;&gt;s0_gate_7 -->
<g id="edge117" class="edge">
<title>s0_attn_7&#45;&gt;s0_gate_7</title>
<path fill="none" stroke="black" d="M46274.12,-305.95C46302.08,-305.95 46330.03,-305.95 46357.99,-305.95"/>
<polygon fill="black" stroke="black" points="46358.29,-309.45 46368.29,-305.95 46358.29,-302.45 46358.29,-309.45"/>
</g>
<!-- s0_expert_7 -->
<g id="node103" class="node">
<title>s0_expert_7</title>
<polygon fill="lightblue" stroke="black" points="47426,-332.45 47055,-332.45 47055,-279.45 47426,-279.45 47426,-332.45"/>
<text text-anchor="middle" x="47240.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: Expert FFN</text>
<text text-anchor="middle" x="47240.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="47240.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_7&#45;&gt;s0_expert_7 -->
<g id="edge118" class="edge">
<title>s0_gate_7&#45;&gt;s0_expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M46960.94,-305.95C46988.82,-305.95 47016.7,-305.95 47044.58,-305.95"/>
<polygon fill="black" stroke="black" points="47044.85,-309.45 47054.85,-305.95 47044.85,-302.45 47044.85,-309.45"/>
</g>
<!-- s0_alltoall_7 -->
<g id="node104" class="node">
<title>s0_alltoall_7</title>
<ellipse fill="white" stroke="black" cx="47706.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="47706.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: AllToAll</text>
<text text-anchor="middle" x="47706.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="47706.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_7&#45;&gt;s0_alltoall_7 -->
<g id="edge119" class="edge">
<title>s0_expert_7&#45;&gt;s0_alltoall_7</title>
<path fill="none" stroke="black" d="M47426.17,-305.95C47428.77,-305.95 47431.36,-305.95 47433.96,-305.95"/>
<polygon fill="black" stroke="black" points="47433.97,-309.45 47443.97,-305.95 47433.97,-302.45 47433.97,-309.45"/>
</g>
<!-- s0_ln1_7 -->
<g id="node105" class="node">
<title>s0_ln1_7</title>
<polygon fill="lightblue" stroke="black" points="48358,-332.45 47987,-332.45 47987,-279.45 48358,-279.45 48358,-332.45"/>
<text text-anchor="middle" x="48172.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU7: LayerNorm (DP1)</text>
<text text-anchor="middle" x="48172.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="48172.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_7&#45;&gt;s0_ln1_7 -->
<g id="edge120" class="edge">
<title>s0_alltoall_7&#45;&gt;s0_ln1_7</title>
<path fill="none" stroke="black" d="M47969.08,-305.95C47971.69,-305.95 47974.29,-305.95 47976.9,-305.95"/>
<polygon fill="black" stroke="black" points="47976.96,-309.45 47986.96,-305.95 47976.96,-302.45 47976.96,-309.45"/>
</g>
<!-- s1_ln0_23 -->
<g id="node294" class="node">
<title>s1_ln0_23</title>
<polygon fill="lightgreen" stroke="black" points="48358,-190.45 47987,-190.45 47987,-137.45 48358,-137.45 48358,-190.45"/>
<text text-anchor="middle" x="48172.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: LayerNorm (DP1)</text>
<text text-anchor="middle" x="48172.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="48172.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_7&#45;&gt;s1_ln0_23 -->
<g id="edge248" class="edge">
<title>s0_ln1_7&#45;&gt;s1_ln0_23</title>
<path fill="none" stroke="black" d="M48172.5,-279.28C48172.5,-257.17 48172.5,-225.05 48172.5,-200.48"/>
<polygon fill="black" stroke="black" points="48176,-200.47 48172.5,-190.47 48169,-200.47 48176,-200.47"/>
</g>
<!-- s0_ln0_8 -->
<g id="node107" class="node">
<title>s0_ln0_8</title>
<polygon fill="lightblue" stroke="black" points="49136,-332.45 48765,-332.45 48765,-279.45 49136,-279.45 49136,-332.45"/>
<text text-anchor="middle" x="48950.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: LayerNorm (DP2)</text>
<text text-anchor="middle" x="48950.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="48950.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_8&#45;&gt;s0_ln0_8 -->
<g id="edge122" class="edge">
<title>s0_emb_8&#45;&gt;s0_ln0_8</title>
<path fill="none" stroke="black" d="M48747.26,-305.95C48749.72,-305.95 48752.17,-305.95 48754.63,-305.95"/>
<polygon fill="black" stroke="black" points="48754.73,-309.45 48764.73,-305.95 48754.73,-302.45 48754.73,-309.45"/>
</g>
<!-- s0_q_8 -->
<g id="node108" class="node">
<title>s0_q_8</title>
<polygon fill="lightblue" stroke="black" points="51389,-332.45 51018,-332.45 51018,-279.45 51389,-279.45 51389,-332.45"/>
<text text-anchor="middle" x="51203.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: Q Linear (TP0)</text>
<text text-anchor="middle" x="51203.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="51203.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_8&#45;&gt;s0_q_8 -->
<g id="edge123" class="edge">
<title>s0_ln0_8&#45;&gt;s0_q_8</title>
<path fill="none" stroke="black" d="M49009.5,-332.53C49049.28,-348.94 49103.44,-368.45 49153.5,-376.95 49254.61,-394.12 50898.38,-394.05 50999.5,-376.95 51045.86,-369.12 51095.74,-351.93 51134.57,-336.42"/>
<polygon fill="black" stroke="black" points="51136.24,-339.52 51144.2,-332.53 51133.62,-333.04 51136.24,-339.52"/>
</g>
<!-- s0_k_8 -->
<g id="node109" class="node">
<title>s0_k_8</title>
<polygon fill="lightblue" stroke="black" points="50457,-332.45 50086,-332.45 50086,-279.45 50457,-279.45 50457,-332.45"/>
<text text-anchor="middle" x="50271.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: K Linear (TP0)</text>
<text text-anchor="middle" x="50271.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="50271.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_8&#45;&gt;s0_k_8 -->
<g id="edge124" class="edge">
<title>s0_ln0_8&#45;&gt;s0_k_8</title>
<path fill="none" stroke="black" d="M49009.5,-332.53C49049.28,-348.94 49103.44,-368.45 49153.5,-376.95 49253.62,-393.96 49967.37,-393.88 50067.5,-376.95 50113.86,-369.12 50163.74,-351.93 50202.57,-336.42"/>
<polygon fill="black" stroke="black" points="50204.24,-339.52 50212.2,-332.53 50201.62,-333.04 50204.24,-339.52"/>
</g>
<!-- s0_v_8 -->
<g id="node110" class="node">
<title>s0_v_8</title>
<polygon fill="lightblue" stroke="black" points="49525,-332.45 49154,-332.45 49154,-279.45 49525,-279.45 49525,-332.45"/>
<text text-anchor="middle" x="49339.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: V Linear (TP0)</text>
<text text-anchor="middle" x="49339.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="49339.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_8&#45;&gt;s0_v_8 -->
<g id="edge125" class="edge">
<title>s0_ln0_8&#45;&gt;s0_v_8</title>
<path fill="none" stroke="black" d="M49136.26,-305.95C49138.72,-305.95 49141.17,-305.95 49143.63,-305.95"/>
<polygon fill="black" stroke="black" points="49143.73,-309.45 49153.73,-305.95 49143.73,-302.45 49143.73,-309.45"/>
</g>
<!-- s0_allgather_q_8 -->
<g id="node111" class="node">
<title>s0_allgather_q_8</title>
<ellipse fill="white" stroke="black" cx="51669.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="51669.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather Q (TP0)</text>
<text text-anchor="middle" x="51669.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="51669.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_8&#45;&gt;s0_allgather_q_8 -->
<g id="edge126" class="edge">
<title>s0_q_8&#45;&gt;s0_allgather_q_8</title>
<path fill="none" stroke="black" d="M51389.17,-305.95C51391.77,-305.95 51394.36,-305.95 51396.96,-305.95"/>
<polygon fill="black" stroke="black" points="51396.97,-309.45 51406.97,-305.95 51396.97,-302.45 51396.97,-309.45"/>
</g>
<!-- s0_allgather_k_8 -->
<g id="node112" class="node">
<title>s0_allgather_k_8</title>
<ellipse fill="white" stroke="black" cx="50737.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="50737.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather K (TP0)</text>
<text text-anchor="middle" x="50737.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="50737.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_8&#45;&gt;s0_allgather_k_8 -->
<g id="edge127" class="edge">
<title>s0_k_8&#45;&gt;s0_allgather_k_8</title>
<path fill="none" stroke="black" d="M50457.17,-305.95C50459.77,-305.95 50462.36,-305.95 50464.96,-305.95"/>
<polygon fill="black" stroke="black" points="50464.97,-309.45 50474.97,-305.95 50464.97,-302.45 50464.97,-309.45"/>
</g>
<!-- s0_allgather_v_8 -->
<g id="node113" class="node">
<title>s0_allgather_v_8</title>
<ellipse fill="white" stroke="black" cx="49805.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="49805.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: AllGather V (TP0)</text>
<text text-anchor="middle" x="49805.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="49805.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_8&#45;&gt;s0_allgather_v_8 -->
<g id="edge128" class="edge">
<title>s0_v_8&#45;&gt;s0_allgather_v_8</title>
<path fill="none" stroke="black" d="M49525.17,-305.95C49527.77,-305.95 49530.36,-305.95 49532.96,-305.95"/>
<polygon fill="black" stroke="black" points="49532.97,-309.45 49542.97,-305.95 49532.97,-302.45 49532.97,-309.45"/>
</g>
<!-- s0_attn_8 -->
<g id="node114" class="node">
<title>s0_attn_8</title>
<polygon fill="lightblue" stroke="black" points="52321,-332.45 51950,-332.45 51950,-279.45 52321,-279.45 52321,-332.45"/>
<text text-anchor="middle" x="52135.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: Attention (TP0)</text>
<text text-anchor="middle" x="52135.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="52135.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_8&#45;&gt;s0_attn_8 -->
<g id="edge129" class="edge">
<title>s0_allgather_q_8&#45;&gt;s0_attn_8</title>
<path fill="none" stroke="black" d="M51932.08,-305.95C51934.69,-305.95 51937.29,-305.95 51939.9,-305.95"/>
<polygon fill="black" stroke="black" points="51939.96,-309.45 51949.96,-305.95 51939.96,-302.45 51939.96,-309.45"/>
</g>
<!-- s0_allgather_k_8&#45;&gt;s0_attn_8 -->
<g id="edge130" class="edge">
<title>s0_allgather_k_8&#45;&gt;s0_attn_8</title>
<path fill="none" stroke="black" d="M50846,-340.15C50897.41,-354.63 50960.02,-369.78 51017.5,-376.95 51118.27,-389.53 51831.37,-393.88 51931.5,-376.95 51977.86,-369.12 52027.74,-351.93 52066.57,-336.42"/>
<polygon fill="black" stroke="black" points="52068.24,-339.52 52076.2,-332.53 52065.62,-333.04 52068.24,-339.52"/>
</g>
<!-- s0_allgather_v_8&#45;&gt;s0_attn_8 -->
<g id="edge131" class="edge">
<title>s0_allgather_v_8&#45;&gt;s0_attn_8</title>
<path fill="none" stroke="black" d="M49914,-340.15C49965.41,-354.63 50028.02,-369.78 50085.5,-376.95 50187.27,-389.65 51830.38,-394.05 51931.5,-376.95 51977.86,-369.12 52027.74,-351.93 52066.57,-336.42"/>
<polygon fill="black" stroke="black" points="52068.24,-339.52 52076.2,-332.53 52065.62,-333.04 52068.24,-339.52"/>
</g>
<!-- s0_gate_8 -->
<g id="node115" class="node">
<title>s0_gate_8</title>
<polygon fill="orange" stroke="black" points="53083.89,-358.95 52491.5,-358.95 52339.11,-252.95 52931.5,-252.95 53083.89,-358.95"/>
<text text-anchor="middle" x="52711.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: MoE Gate</text>
<text text-anchor="middle" x="52711.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="52711.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_8&#45;&gt;s0_gate_8 -->
<g id="edge132" class="edge">
<title>s0_attn_8&#45;&gt;s0_gate_8</title>
<path fill="none" stroke="black" d="M52321.12,-305.95C52349.08,-305.95 52377.03,-305.95 52404.99,-305.95"/>
<polygon fill="black" stroke="black" points="52405.29,-309.45 52415.29,-305.95 52405.29,-302.45 52405.29,-309.45"/>
</g>
<!-- s0_expert_8 -->
<g id="node116" class="node">
<title>s0_expert_8</title>
<polygon fill="lightblue" stroke="black" points="53473,-332.45 53102,-332.45 53102,-279.45 53473,-279.45 53473,-332.45"/>
<text text-anchor="middle" x="53287.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: Expert FFN</text>
<text text-anchor="middle" x="53287.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="53287.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_8&#45;&gt;s0_expert_8 -->
<g id="edge133" class="edge">
<title>s0_gate_8&#45;&gt;s0_expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M53007.94,-305.95C53035.82,-305.95 53063.7,-305.95 53091.58,-305.95"/>
<polygon fill="black" stroke="black" points="53091.85,-309.45 53101.85,-305.95 53091.85,-302.45 53091.85,-309.45"/>
</g>
<!-- s0_alltoall_8 -->
<g id="node117" class="node">
<title>s0_alltoall_8</title>
<ellipse fill="white" stroke="black" cx="53753.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="53753.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: AllToAll</text>
<text text-anchor="middle" x="53753.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="53753.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_8&#45;&gt;s0_alltoall_8 -->
<g id="edge134" class="edge">
<title>s0_expert_8&#45;&gt;s0_alltoall_8</title>
<path fill="none" stroke="black" d="M53473.17,-305.95C53475.77,-305.95 53478.36,-305.95 53480.96,-305.95"/>
<polygon fill="black" stroke="black" points="53480.97,-309.45 53490.97,-305.95 53480.97,-302.45 53480.97,-309.45"/>
</g>
<!-- s0_ln1_8 -->
<g id="node118" class="node">
<title>s0_ln1_8</title>
<polygon fill="lightblue" stroke="black" points="54405,-332.45 54034,-332.45 54034,-279.45 54405,-279.45 54405,-332.45"/>
<text text-anchor="middle" x="54219.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU8: LayerNorm (DP2)</text>
<text text-anchor="middle" x="54219.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="54219.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_8&#45;&gt;s0_ln1_8 -->
<g id="edge135" class="edge">
<title>s0_alltoall_8&#45;&gt;s0_ln1_8</title>
<path fill="none" stroke="black" d="M54016.08,-305.95C54018.69,-305.95 54021.29,-305.95 54023.9,-305.95"/>
<polygon fill="black" stroke="black" points="54023.96,-309.45 54033.96,-305.95 54023.96,-302.45 54023.96,-309.45"/>
</g>
<!-- s1_ln0_24 -->
<g id="node306" class="node">
<title>s1_ln0_24</title>
<polygon fill="lightgreen" stroke="black" points="54405,-190.45 54034,-190.45 54034,-137.45 54405,-137.45 54405,-190.45"/>
<text text-anchor="middle" x="54219.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: LayerNorm (DP2)</text>
<text text-anchor="middle" x="54219.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="54219.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_8&#45;&gt;s1_ln0_24 -->
<g id="edge249" class="edge">
<title>s0_ln1_8&#45;&gt;s1_ln0_24</title>
<path fill="none" stroke="black" d="M54219.5,-279.28C54219.5,-257.17 54219.5,-225.05 54219.5,-200.48"/>
<polygon fill="black" stroke="black" points="54223,-200.47 54219.5,-190.47 54216,-200.47 54223,-200.47"/>
</g>
<!-- s0_ln0_9 -->
<g id="node120" class="node">
<title>s0_ln0_9</title>
<polygon fill="lightblue" stroke="black" points="55183,-332.45 54812,-332.45 54812,-279.45 55183,-279.45 55183,-332.45"/>
<text text-anchor="middle" x="54997.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: LayerNorm (DP2)</text>
<text text-anchor="middle" x="54997.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="54997.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_9&#45;&gt;s0_ln0_9 -->
<g id="edge137" class="edge">
<title>s0_emb_9&#45;&gt;s0_ln0_9</title>
<path fill="none" stroke="black" d="M54794.26,-305.95C54796.72,-305.95 54799.17,-305.95 54801.63,-305.95"/>
<polygon fill="black" stroke="black" points="54801.73,-309.45 54811.73,-305.95 54801.73,-302.45 54801.73,-309.45"/>
</g>
<!-- s0_q_9 -->
<g id="node121" class="node">
<title>s0_q_9</title>
<polygon fill="lightblue" stroke="black" points="57436,-332.45 57065,-332.45 57065,-279.45 57436,-279.45 57436,-332.45"/>
<text text-anchor="middle" x="57250.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: Q Linear (TP1)</text>
<text text-anchor="middle" x="57250.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="57250.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_9&#45;&gt;s0_q_9 -->
<g id="edge138" class="edge">
<title>s0_ln0_9&#45;&gt;s0_q_9</title>
<path fill="none" stroke="black" d="M55056.5,-332.53C55096.28,-348.94 55150.44,-368.45 55200.5,-376.95 55301.61,-394.12 56945.38,-394.05 57046.5,-376.95 57092.86,-369.12 57142.74,-351.93 57181.57,-336.42"/>
<polygon fill="black" stroke="black" points="57183.24,-339.52 57191.2,-332.53 57180.62,-333.04 57183.24,-339.52"/>
</g>
<!-- s0_k_9 -->
<g id="node122" class="node">
<title>s0_k_9</title>
<polygon fill="lightblue" stroke="black" points="56504,-332.45 56133,-332.45 56133,-279.45 56504,-279.45 56504,-332.45"/>
<text text-anchor="middle" x="56318.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: K Linear (TP1)</text>
<text text-anchor="middle" x="56318.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="56318.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_9&#45;&gt;s0_k_9 -->
<g id="edge139" class="edge">
<title>s0_ln0_9&#45;&gt;s0_k_9</title>
<path fill="none" stroke="black" d="M55056.5,-332.53C55096.28,-348.94 55150.44,-368.45 55200.5,-376.95 55300.62,-393.96 56014.37,-393.88 56114.5,-376.95 56160.86,-369.12 56210.74,-351.93 56249.57,-336.42"/>
<polygon fill="black" stroke="black" points="56251.24,-339.52 56259.2,-332.53 56248.62,-333.04 56251.24,-339.52"/>
</g>
<!-- s0_v_9 -->
<g id="node123" class="node">
<title>s0_v_9</title>
<polygon fill="lightblue" stroke="black" points="55572,-332.45 55201,-332.45 55201,-279.45 55572,-279.45 55572,-332.45"/>
<text text-anchor="middle" x="55386.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: V Linear (TP1)</text>
<text text-anchor="middle" x="55386.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="55386.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_9&#45;&gt;s0_v_9 -->
<g id="edge140" class="edge">
<title>s0_ln0_9&#45;&gt;s0_v_9</title>
<path fill="none" stroke="black" d="M55183.26,-305.95C55185.72,-305.95 55188.17,-305.95 55190.63,-305.95"/>
<polygon fill="black" stroke="black" points="55190.73,-309.45 55200.73,-305.95 55190.73,-302.45 55190.73,-309.45"/>
</g>
<!-- s0_allgather_q_9 -->
<g id="node124" class="node">
<title>s0_allgather_q_9</title>
<ellipse fill="white" stroke="black" cx="57716.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="57716.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather Q (TP1)</text>
<text text-anchor="middle" x="57716.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="57716.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_9&#45;&gt;s0_allgather_q_9 -->
<g id="edge141" class="edge">
<title>s0_q_9&#45;&gt;s0_allgather_q_9</title>
<path fill="none" stroke="black" d="M57436.17,-305.95C57438.77,-305.95 57441.36,-305.95 57443.96,-305.95"/>
<polygon fill="black" stroke="black" points="57443.97,-309.45 57453.97,-305.95 57443.97,-302.45 57443.97,-309.45"/>
</g>
<!-- s0_allgather_k_9 -->
<g id="node125" class="node">
<title>s0_allgather_k_9</title>
<ellipse fill="white" stroke="black" cx="56784.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="56784.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather K (TP1)</text>
<text text-anchor="middle" x="56784.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="56784.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_9&#45;&gt;s0_allgather_k_9 -->
<g id="edge142" class="edge">
<title>s0_k_9&#45;&gt;s0_allgather_k_9</title>
<path fill="none" stroke="black" d="M56504.17,-305.95C56506.77,-305.95 56509.36,-305.95 56511.96,-305.95"/>
<polygon fill="black" stroke="black" points="56511.97,-309.45 56521.97,-305.95 56511.97,-302.45 56511.97,-309.45"/>
</g>
<!-- s0_allgather_v_9 -->
<g id="node126" class="node">
<title>s0_allgather_v_9</title>
<ellipse fill="white" stroke="black" cx="55852.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="55852.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: AllGather V (TP1)</text>
<text text-anchor="middle" x="55852.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="55852.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_9&#45;&gt;s0_allgather_v_9 -->
<g id="edge143" class="edge">
<title>s0_v_9&#45;&gt;s0_allgather_v_9</title>
<path fill="none" stroke="black" d="M55572.17,-305.95C55574.77,-305.95 55577.36,-305.95 55579.96,-305.95"/>
<polygon fill="black" stroke="black" points="55579.97,-309.45 55589.97,-305.95 55579.97,-302.45 55579.97,-309.45"/>
</g>
<!-- s0_attn_9 -->
<g id="node127" class="node">
<title>s0_attn_9</title>
<polygon fill="lightblue" stroke="black" points="58368,-332.45 57997,-332.45 57997,-279.45 58368,-279.45 58368,-332.45"/>
<text text-anchor="middle" x="58182.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: Attention (TP1)</text>
<text text-anchor="middle" x="58182.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="58182.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_9&#45;&gt;s0_attn_9 -->
<g id="edge144" class="edge">
<title>s0_allgather_q_9&#45;&gt;s0_attn_9</title>
<path fill="none" stroke="black" d="M57979.08,-305.95C57981.69,-305.95 57984.29,-305.95 57986.9,-305.95"/>
<polygon fill="black" stroke="black" points="57986.96,-309.45 57996.96,-305.95 57986.96,-302.45 57986.96,-309.45"/>
</g>
<!-- s0_allgather_k_9&#45;&gt;s0_attn_9 -->
<g id="edge145" class="edge">
<title>s0_allgather_k_9&#45;&gt;s0_attn_9</title>
<path fill="none" stroke="black" d="M56893,-340.15C56944.41,-354.63 57007.02,-369.78 57064.5,-376.95 57165.27,-389.53 57878.37,-393.88 57978.5,-376.95 58024.86,-369.12 58074.74,-351.93 58113.57,-336.42"/>
<polygon fill="black" stroke="black" points="58115.24,-339.52 58123.2,-332.53 58112.62,-333.04 58115.24,-339.52"/>
</g>
<!-- s0_allgather_v_9&#45;&gt;s0_attn_9 -->
<g id="edge146" class="edge">
<title>s0_allgather_v_9&#45;&gt;s0_attn_9</title>
<path fill="none" stroke="black" d="M55961,-340.15C56012.41,-354.63 56075.02,-369.78 56132.5,-376.95 56234.27,-389.65 57877.38,-394.05 57978.5,-376.95 58024.86,-369.12 58074.74,-351.93 58113.57,-336.42"/>
<polygon fill="black" stroke="black" points="58115.24,-339.52 58123.2,-332.53 58112.62,-333.04 58115.24,-339.52"/>
</g>
<!-- s0_gate_9 -->
<g id="node128" class="node">
<title>s0_gate_9</title>
<polygon fill="orange" stroke="black" points="59130.89,-358.95 58538.5,-358.95 58386.11,-252.95 58978.5,-252.95 59130.89,-358.95"/>
<text text-anchor="middle" x="58758.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: MoE Gate</text>
<text text-anchor="middle" x="58758.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="58758.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_9&#45;&gt;s0_gate_9 -->
<g id="edge147" class="edge">
<title>s0_attn_9&#45;&gt;s0_gate_9</title>
<path fill="none" stroke="black" d="M58368.12,-305.95C58396.08,-305.95 58424.03,-305.95 58451.99,-305.95"/>
<polygon fill="black" stroke="black" points="58452.29,-309.45 58462.29,-305.95 58452.29,-302.45 58452.29,-309.45"/>
</g>
<!-- s0_expert_9 -->
<g id="node129" class="node">
<title>s0_expert_9</title>
<polygon fill="lightblue" stroke="black" points="59520,-332.45 59149,-332.45 59149,-279.45 59520,-279.45 59520,-332.45"/>
<text text-anchor="middle" x="59334.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: Expert FFN</text>
<text text-anchor="middle" x="59334.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="59334.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_9&#45;&gt;s0_expert_9 -->
<g id="edge148" class="edge">
<title>s0_gate_9&#45;&gt;s0_expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M59054.94,-305.95C59082.82,-305.95 59110.7,-305.95 59138.58,-305.95"/>
<polygon fill="black" stroke="black" points="59138.85,-309.45 59148.85,-305.95 59138.85,-302.45 59138.85,-309.45"/>
</g>
<!-- s0_alltoall_9 -->
<g id="node130" class="node">
<title>s0_alltoall_9</title>
<ellipse fill="white" stroke="black" cx="59800.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="59800.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: AllToAll</text>
<text text-anchor="middle" x="59800.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="59800.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_9&#45;&gt;s0_alltoall_9 -->
<g id="edge149" class="edge">
<title>s0_expert_9&#45;&gt;s0_alltoall_9</title>
<path fill="none" stroke="black" d="M59520.17,-305.95C59522.77,-305.95 59525.36,-305.95 59527.96,-305.95"/>
<polygon fill="black" stroke="black" points="59527.97,-309.45 59537.97,-305.95 59527.97,-302.45 59527.97,-309.45"/>
</g>
<!-- s0_ln1_9 -->
<g id="node131" class="node">
<title>s0_ln1_9</title>
<polygon fill="lightblue" stroke="black" points="60452,-332.45 60081,-332.45 60081,-279.45 60452,-279.45 60452,-332.45"/>
<text text-anchor="middle" x="60266.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU9: LayerNorm (DP2)</text>
<text text-anchor="middle" x="60266.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="60266.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_9&#45;&gt;s0_ln1_9 -->
<g id="edge150" class="edge">
<title>s0_alltoall_9&#45;&gt;s0_ln1_9</title>
<path fill="none" stroke="black" d="M60063.08,-305.95C60065.69,-305.95 60068.29,-305.95 60070.9,-305.95"/>
<polygon fill="black" stroke="black" points="60070.96,-309.45 60080.96,-305.95 60070.96,-302.45 60070.96,-309.45"/>
</g>
<!-- s1_ln0_25 -->
<g id="node318" class="node">
<title>s1_ln0_25</title>
<polygon fill="lightgreen" stroke="black" points="60452,-190.45 60081,-190.45 60081,-137.45 60452,-137.45 60452,-190.45"/>
<text text-anchor="middle" x="60266.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: LayerNorm (DP2)</text>
<text text-anchor="middle" x="60266.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="60266.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_9&#45;&gt;s1_ln0_25 -->
<g id="edge250" class="edge">
<title>s0_ln1_9&#45;&gt;s1_ln0_25</title>
<path fill="none" stroke="black" d="M60266.5,-279.28C60266.5,-257.17 60266.5,-225.05 60266.5,-200.48"/>
<polygon fill="black" stroke="black" points="60270,-200.47 60266.5,-190.47 60263,-200.47 60270,-200.47"/>
</g>
<!-- s0_ln0_10 -->
<g id="node133" class="node">
<title>s0_ln0_10</title>
<polygon fill="lightblue" stroke="black" points="61230,-332.45 60859,-332.45 60859,-279.45 61230,-279.45 61230,-332.45"/>
<text text-anchor="middle" x="61044.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: LayerNorm (DP2)</text>
<text text-anchor="middle" x="61044.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="61044.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_10&#45;&gt;s0_ln0_10 -->
<g id="edge152" class="edge">
<title>s0_emb_10&#45;&gt;s0_ln0_10</title>
<path fill="none" stroke="black" d="M60841.26,-305.95C60843.72,-305.95 60846.17,-305.95 60848.63,-305.95"/>
<polygon fill="black" stroke="black" points="60848.73,-309.45 60858.73,-305.95 60848.73,-302.45 60848.73,-309.45"/>
</g>
<!-- s0_q_10 -->
<g id="node134" class="node">
<title>s0_q_10</title>
<polygon fill="lightblue" stroke="black" points="63483,-332.45 63112,-332.45 63112,-279.45 63483,-279.45 63483,-332.45"/>
<text text-anchor="middle" x="63297.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: Q Linear (TP2)</text>
<text text-anchor="middle" x="63297.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="63297.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_10&#45;&gt;s0_q_10 -->
<g id="edge153" class="edge">
<title>s0_ln0_10&#45;&gt;s0_q_10</title>
<path fill="none" stroke="black" d="M61103.5,-332.53C61143.28,-348.94 61197.44,-368.45 61247.5,-376.95 61348.61,-394.12 62992.38,-394.05 63093.5,-376.95 63139.86,-369.12 63189.74,-351.93 63228.57,-336.42"/>
<polygon fill="black" stroke="black" points="63230.24,-339.52 63238.2,-332.53 63227.62,-333.04 63230.24,-339.52"/>
</g>
<!-- s0_k_10 -->
<g id="node135" class="node">
<title>s0_k_10</title>
<polygon fill="lightblue" stroke="black" points="62551,-332.45 62180,-332.45 62180,-279.45 62551,-279.45 62551,-332.45"/>
<text text-anchor="middle" x="62365.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: K Linear (TP2)</text>
<text text-anchor="middle" x="62365.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="62365.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_10&#45;&gt;s0_k_10 -->
<g id="edge154" class="edge">
<title>s0_ln0_10&#45;&gt;s0_k_10</title>
<path fill="none" stroke="black" d="M61103.5,-332.53C61143.28,-348.94 61197.44,-368.45 61247.5,-376.95 61347.62,-393.96 62061.37,-393.88 62161.5,-376.95 62207.86,-369.12 62257.74,-351.93 62296.57,-336.42"/>
<polygon fill="black" stroke="black" points="62298.24,-339.52 62306.2,-332.53 62295.62,-333.04 62298.24,-339.52"/>
</g>
<!-- s0_v_10 -->
<g id="node136" class="node">
<title>s0_v_10</title>
<polygon fill="lightblue" stroke="black" points="61619,-332.45 61248,-332.45 61248,-279.45 61619,-279.45 61619,-332.45"/>
<text text-anchor="middle" x="61433.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: V Linear (TP2)</text>
<text text-anchor="middle" x="61433.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="61433.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_10&#45;&gt;s0_v_10 -->
<g id="edge155" class="edge">
<title>s0_ln0_10&#45;&gt;s0_v_10</title>
<path fill="none" stroke="black" d="M61230.26,-305.95C61232.72,-305.95 61235.17,-305.95 61237.63,-305.95"/>
<polygon fill="black" stroke="black" points="61237.73,-309.45 61247.73,-305.95 61237.73,-302.45 61237.73,-309.45"/>
</g>
<!-- s0_allgather_q_10 -->
<g id="node137" class="node">
<title>s0_allgather_q_10</title>
<ellipse fill="white" stroke="black" cx="63763.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="63763.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather Q (TP2)</text>
<text text-anchor="middle" x="63763.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="63763.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_10&#45;&gt;s0_allgather_q_10 -->
<g id="edge156" class="edge">
<title>s0_q_10&#45;&gt;s0_allgather_q_10</title>
<path fill="none" stroke="black" d="M63483.17,-305.95C63485.77,-305.95 63488.36,-305.95 63490.96,-305.95"/>
<polygon fill="black" stroke="black" points="63490.97,-309.45 63500.97,-305.95 63490.97,-302.45 63490.97,-309.45"/>
</g>
<!-- s0_allgather_k_10 -->
<g id="node138" class="node">
<title>s0_allgather_k_10</title>
<ellipse fill="white" stroke="black" cx="62831.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="62831.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather K (TP2)</text>
<text text-anchor="middle" x="62831.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="62831.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_10&#45;&gt;s0_allgather_k_10 -->
<g id="edge157" class="edge">
<title>s0_k_10&#45;&gt;s0_allgather_k_10</title>
<path fill="none" stroke="black" d="M62551.17,-305.95C62553.77,-305.95 62556.36,-305.95 62558.96,-305.95"/>
<polygon fill="black" stroke="black" points="62558.97,-309.45 62568.97,-305.95 62558.97,-302.45 62558.97,-309.45"/>
</g>
<!-- s0_allgather_v_10 -->
<g id="node139" class="node">
<title>s0_allgather_v_10</title>
<ellipse fill="white" stroke="black" cx="61899.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="61899.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: AllGather V (TP2)</text>
<text text-anchor="middle" x="61899.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="61899.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_10&#45;&gt;s0_allgather_v_10 -->
<g id="edge158" class="edge">
<title>s0_v_10&#45;&gt;s0_allgather_v_10</title>
<path fill="none" stroke="black" d="M61619.17,-305.95C61621.77,-305.95 61624.36,-305.95 61626.96,-305.95"/>
<polygon fill="black" stroke="black" points="61626.97,-309.45 61636.97,-305.95 61626.97,-302.45 61626.97,-309.45"/>
</g>
<!-- s0_attn_10 -->
<g id="node140" class="node">
<title>s0_attn_10</title>
<polygon fill="lightblue" stroke="black" points="64415,-332.45 64044,-332.45 64044,-279.45 64415,-279.45 64415,-332.45"/>
<text text-anchor="middle" x="64229.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: Attention (TP2)</text>
<text text-anchor="middle" x="64229.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="64229.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_10&#45;&gt;s0_attn_10 -->
<g id="edge159" class="edge">
<title>s0_allgather_q_10&#45;&gt;s0_attn_10</title>
<path fill="none" stroke="black" d="M64026.08,-305.95C64028.69,-305.95 64031.29,-305.95 64033.9,-305.95"/>
<polygon fill="black" stroke="black" points="64033.96,-309.45 64043.96,-305.95 64033.96,-302.45 64033.96,-309.45"/>
</g>
<!-- s0_allgather_k_10&#45;&gt;s0_attn_10 -->
<g id="edge160" class="edge">
<title>s0_allgather_k_10&#45;&gt;s0_attn_10</title>
<path fill="none" stroke="black" d="M62940,-340.15C62991.41,-354.63 63054.02,-369.78 63111.5,-376.95 63212.27,-389.53 63925.37,-393.88 64025.5,-376.95 64071.86,-369.12 64121.74,-351.93 64160.57,-336.42"/>
<polygon fill="black" stroke="black" points="64162.24,-339.52 64170.2,-332.53 64159.62,-333.04 64162.24,-339.52"/>
</g>
<!-- s0_allgather_v_10&#45;&gt;s0_attn_10 -->
<g id="edge161" class="edge">
<title>s0_allgather_v_10&#45;&gt;s0_attn_10</title>
<path fill="none" stroke="black" d="M62008,-340.15C62059.41,-354.63 62122.02,-369.78 62179.5,-376.95 62281.27,-389.65 63924.38,-394.05 64025.5,-376.95 64071.86,-369.12 64121.74,-351.93 64160.57,-336.42"/>
<polygon fill="black" stroke="black" points="64162.24,-339.52 64170.2,-332.53 64159.62,-333.04 64162.24,-339.52"/>
</g>
<!-- s0_gate_10 -->
<g id="node141" class="node">
<title>s0_gate_10</title>
<polygon fill="orange" stroke="black" points="65177.89,-358.95 64585.5,-358.95 64433.11,-252.95 65025.5,-252.95 65177.89,-358.95"/>
<text text-anchor="middle" x="64805.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: MoE Gate</text>
<text text-anchor="middle" x="64805.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="64805.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_10&#45;&gt;s0_gate_10 -->
<g id="edge162" class="edge">
<title>s0_attn_10&#45;&gt;s0_gate_10</title>
<path fill="none" stroke="black" d="M64415.12,-305.95C64443.08,-305.95 64471.03,-305.95 64498.99,-305.95"/>
<polygon fill="black" stroke="black" points="64499.29,-309.45 64509.29,-305.95 64499.29,-302.45 64499.29,-309.45"/>
</g>
<!-- s0_expert_10 -->
<g id="node142" class="node">
<title>s0_expert_10</title>
<polygon fill="lightblue" stroke="black" points="65567,-332.45 65196,-332.45 65196,-279.45 65567,-279.45 65567,-332.45"/>
<text text-anchor="middle" x="65381.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: Expert FFN</text>
<text text-anchor="middle" x="65381.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="65381.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_10&#45;&gt;s0_expert_10 -->
<g id="edge163" class="edge">
<title>s0_gate_10&#45;&gt;s0_expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M65101.94,-305.95C65129.82,-305.95 65157.7,-305.95 65185.58,-305.95"/>
<polygon fill="black" stroke="black" points="65185.85,-309.45 65195.85,-305.95 65185.85,-302.45 65185.85,-309.45"/>
</g>
<!-- s0_alltoall_10 -->
<g id="node143" class="node">
<title>s0_alltoall_10</title>
<ellipse fill="white" stroke="black" cx="65847.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="65847.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: AllToAll</text>
<text text-anchor="middle" x="65847.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="65847.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_10&#45;&gt;s0_alltoall_10 -->
<g id="edge164" class="edge">
<title>s0_expert_10&#45;&gt;s0_alltoall_10</title>
<path fill="none" stroke="black" d="M65567.17,-305.95C65569.77,-305.95 65572.36,-305.95 65574.96,-305.95"/>
<polygon fill="black" stroke="black" points="65574.97,-309.45 65584.97,-305.95 65574.97,-302.45 65574.97,-309.45"/>
</g>
<!-- s0_ln1_10 -->
<g id="node144" class="node">
<title>s0_ln1_10</title>
<polygon fill="lightblue" stroke="black" points="66499,-332.45 66128,-332.45 66128,-279.45 66499,-279.45 66499,-332.45"/>
<text text-anchor="middle" x="66313.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU10: LayerNorm (DP2)</text>
<text text-anchor="middle" x="66313.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="66313.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_10&#45;&gt;s0_ln1_10 -->
<g id="edge165" class="edge">
<title>s0_alltoall_10&#45;&gt;s0_ln1_10</title>
<path fill="none" stroke="black" d="M66110.08,-305.95C66112.69,-305.95 66115.29,-305.95 66117.9,-305.95"/>
<polygon fill="black" stroke="black" points="66117.96,-309.45 66127.96,-305.95 66117.96,-302.45 66117.96,-309.45"/>
</g>
<!-- s1_ln0_26 -->
<g id="node330" class="node">
<title>s1_ln0_26</title>
<polygon fill="lightgreen" stroke="black" points="66499,-190.45 66128,-190.45 66128,-137.45 66499,-137.45 66499,-190.45"/>
<text text-anchor="middle" x="66313.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: LayerNorm (DP2)</text>
<text text-anchor="middle" x="66313.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="66313.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_10&#45;&gt;s1_ln0_26 -->
<g id="edge251" class="edge">
<title>s0_ln1_10&#45;&gt;s1_ln0_26</title>
<path fill="none" stroke="black" d="M66313.5,-279.28C66313.5,-257.17 66313.5,-225.05 66313.5,-200.48"/>
<polygon fill="black" stroke="black" points="66317,-200.47 66313.5,-190.47 66310,-200.47 66317,-200.47"/>
</g>
<!-- s0_ln0_11 -->
<g id="node146" class="node">
<title>s0_ln0_11</title>
<polygon fill="lightblue" stroke="black" points="67277,-332.45 66906,-332.45 66906,-279.45 67277,-279.45 67277,-332.45"/>
<text text-anchor="middle" x="67091.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: LayerNorm (DP2)</text>
<text text-anchor="middle" x="67091.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="67091.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_11&#45;&gt;s0_ln0_11 -->
<g id="edge167" class="edge">
<title>s0_emb_11&#45;&gt;s0_ln0_11</title>
<path fill="none" stroke="black" d="M66888.26,-305.95C66890.72,-305.95 66893.17,-305.95 66895.63,-305.95"/>
<polygon fill="black" stroke="black" points="66895.73,-309.45 66905.73,-305.95 66895.73,-302.45 66895.73,-309.45"/>
</g>
<!-- s0_q_11 -->
<g id="node147" class="node">
<title>s0_q_11</title>
<polygon fill="lightblue" stroke="black" points="69530,-332.45 69159,-332.45 69159,-279.45 69530,-279.45 69530,-332.45"/>
<text text-anchor="middle" x="69344.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: Q Linear (TP3)</text>
<text text-anchor="middle" x="69344.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="69344.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_11&#45;&gt;s0_q_11 -->
<g id="edge168" class="edge">
<title>s0_ln0_11&#45;&gt;s0_q_11</title>
<path fill="none" stroke="black" d="M67150.5,-332.53C67190.28,-348.94 67244.44,-368.45 67294.5,-376.95 67395.61,-394.12 69039.38,-394.05 69140.5,-376.95 69186.86,-369.12 69236.74,-351.93 69275.57,-336.42"/>
<polygon fill="black" stroke="black" points="69277.24,-339.52 69285.2,-332.53 69274.62,-333.04 69277.24,-339.52"/>
</g>
<!-- s0_k_11 -->
<g id="node148" class="node">
<title>s0_k_11</title>
<polygon fill="lightblue" stroke="black" points="68598,-332.45 68227,-332.45 68227,-279.45 68598,-279.45 68598,-332.45"/>
<text text-anchor="middle" x="68412.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: K Linear (TP3)</text>
<text text-anchor="middle" x="68412.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="68412.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_11&#45;&gt;s0_k_11 -->
<g id="edge169" class="edge">
<title>s0_ln0_11&#45;&gt;s0_k_11</title>
<path fill="none" stroke="black" d="M67150.5,-332.53C67190.28,-348.94 67244.44,-368.45 67294.5,-376.95 67394.62,-393.96 68108.37,-393.88 68208.5,-376.95 68254.86,-369.12 68304.74,-351.93 68343.57,-336.42"/>
<polygon fill="black" stroke="black" points="68345.24,-339.52 68353.2,-332.53 68342.62,-333.04 68345.24,-339.52"/>
</g>
<!-- s0_v_11 -->
<g id="node149" class="node">
<title>s0_v_11</title>
<polygon fill="lightblue" stroke="black" points="67666,-332.45 67295,-332.45 67295,-279.45 67666,-279.45 67666,-332.45"/>
<text text-anchor="middle" x="67480.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: V Linear (TP3)</text>
<text text-anchor="middle" x="67480.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="67480.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_11&#45;&gt;s0_v_11 -->
<g id="edge170" class="edge">
<title>s0_ln0_11&#45;&gt;s0_v_11</title>
<path fill="none" stroke="black" d="M67277.26,-305.95C67279.72,-305.95 67282.17,-305.95 67284.63,-305.95"/>
<polygon fill="black" stroke="black" points="67284.73,-309.45 67294.73,-305.95 67284.73,-302.45 67284.73,-309.45"/>
</g>
<!-- s0_allgather_q_11 -->
<g id="node150" class="node">
<title>s0_allgather_q_11</title>
<ellipse fill="white" stroke="black" cx="69810.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="69810.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather Q (TP3)</text>
<text text-anchor="middle" x="69810.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="69810.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_11&#45;&gt;s0_allgather_q_11 -->
<g id="edge171" class="edge">
<title>s0_q_11&#45;&gt;s0_allgather_q_11</title>
<path fill="none" stroke="black" d="M69530.17,-305.95C69532.77,-305.95 69535.36,-305.95 69537.96,-305.95"/>
<polygon fill="black" stroke="black" points="69537.97,-309.45 69547.97,-305.95 69537.97,-302.45 69537.97,-309.45"/>
</g>
<!-- s0_allgather_k_11 -->
<g id="node151" class="node">
<title>s0_allgather_k_11</title>
<ellipse fill="white" stroke="black" cx="68878.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="68878.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather K (TP3)</text>
<text text-anchor="middle" x="68878.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="68878.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_11&#45;&gt;s0_allgather_k_11 -->
<g id="edge172" class="edge">
<title>s0_k_11&#45;&gt;s0_allgather_k_11</title>
<path fill="none" stroke="black" d="M68598.17,-305.95C68600.77,-305.95 68603.36,-305.95 68605.96,-305.95"/>
<polygon fill="black" stroke="black" points="68605.97,-309.45 68615.97,-305.95 68605.97,-302.45 68605.97,-309.45"/>
</g>
<!-- s0_allgather_v_11 -->
<g id="node152" class="node">
<title>s0_allgather_v_11</title>
<ellipse fill="white" stroke="black" cx="67946.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="67946.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: AllGather V (TP3)</text>
<text text-anchor="middle" x="67946.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="67946.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_11&#45;&gt;s0_allgather_v_11 -->
<g id="edge173" class="edge">
<title>s0_v_11&#45;&gt;s0_allgather_v_11</title>
<path fill="none" stroke="black" d="M67666.17,-305.95C67668.77,-305.95 67671.36,-305.95 67673.96,-305.95"/>
<polygon fill="black" stroke="black" points="67673.97,-309.45 67683.97,-305.95 67673.97,-302.45 67673.97,-309.45"/>
</g>
<!-- s0_attn_11 -->
<g id="node153" class="node">
<title>s0_attn_11</title>
<polygon fill="lightblue" stroke="black" points="70462,-332.45 70091,-332.45 70091,-279.45 70462,-279.45 70462,-332.45"/>
<text text-anchor="middle" x="70276.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: Attention (TP3)</text>
<text text-anchor="middle" x="70276.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="70276.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_11&#45;&gt;s0_attn_11 -->
<g id="edge174" class="edge">
<title>s0_allgather_q_11&#45;&gt;s0_attn_11</title>
<path fill="none" stroke="black" d="M70073.08,-305.95C70075.69,-305.95 70078.29,-305.95 70080.9,-305.95"/>
<polygon fill="black" stroke="black" points="70080.96,-309.45 70090.96,-305.95 70080.96,-302.45 70080.96,-309.45"/>
</g>
<!-- s0_allgather_k_11&#45;&gt;s0_attn_11 -->
<g id="edge175" class="edge">
<title>s0_allgather_k_11&#45;&gt;s0_attn_11</title>
<path fill="none" stroke="black" d="M68987,-340.15C69038.41,-354.63 69101.02,-369.78 69158.5,-376.95 69259.27,-389.53 69972.37,-393.88 70072.5,-376.95 70118.86,-369.12 70168.74,-351.93 70207.57,-336.42"/>
<polygon fill="black" stroke="black" points="70209.24,-339.52 70217.2,-332.53 70206.62,-333.04 70209.24,-339.52"/>
</g>
<!-- s0_allgather_v_11&#45;&gt;s0_attn_11 -->
<g id="edge176" class="edge">
<title>s0_allgather_v_11&#45;&gt;s0_attn_11</title>
<path fill="none" stroke="black" d="M68055,-340.15C68106.41,-354.63 68169.02,-369.78 68226.5,-376.95 68328.27,-389.65 69971.38,-394.05 70072.5,-376.95 70118.86,-369.12 70168.74,-351.93 70207.57,-336.42"/>
<polygon fill="black" stroke="black" points="70209.24,-339.52 70217.2,-332.53 70206.62,-333.04 70209.24,-339.52"/>
</g>
<!-- s0_gate_11 -->
<g id="node154" class="node">
<title>s0_gate_11</title>
<polygon fill="orange" stroke="black" points="71224.89,-358.95 70632.5,-358.95 70480.11,-252.95 71072.5,-252.95 71224.89,-358.95"/>
<text text-anchor="middle" x="70852.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: MoE Gate</text>
<text text-anchor="middle" x="70852.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="70852.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_11&#45;&gt;s0_gate_11 -->
<g id="edge177" class="edge">
<title>s0_attn_11&#45;&gt;s0_gate_11</title>
<path fill="none" stroke="black" d="M70462.12,-305.95C70490.08,-305.95 70518.03,-305.95 70545.99,-305.95"/>
<polygon fill="black" stroke="black" points="70546.29,-309.45 70556.29,-305.95 70546.29,-302.45 70546.29,-309.45"/>
</g>
<!-- s0_expert_11 -->
<g id="node155" class="node">
<title>s0_expert_11</title>
<polygon fill="lightblue" stroke="black" points="71614,-332.45 71243,-332.45 71243,-279.45 71614,-279.45 71614,-332.45"/>
<text text-anchor="middle" x="71428.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: Expert FFN</text>
<text text-anchor="middle" x="71428.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="71428.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_11&#45;&gt;s0_expert_11 -->
<g id="edge178" class="edge">
<title>s0_gate_11&#45;&gt;s0_expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M71148.94,-305.95C71176.82,-305.95 71204.7,-305.95 71232.58,-305.95"/>
<polygon fill="black" stroke="black" points="71232.85,-309.45 71242.85,-305.95 71232.85,-302.45 71232.85,-309.45"/>
</g>
<!-- s0_alltoall_11 -->
<g id="node156" class="node">
<title>s0_alltoall_11</title>
<ellipse fill="white" stroke="black" cx="71894.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="71894.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: AllToAll</text>
<text text-anchor="middle" x="71894.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="71894.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_11&#45;&gt;s0_alltoall_11 -->
<g id="edge179" class="edge">
<title>s0_expert_11&#45;&gt;s0_alltoall_11</title>
<path fill="none" stroke="black" d="M71614.17,-305.95C71616.77,-305.95 71619.36,-305.95 71621.96,-305.95"/>
<polygon fill="black" stroke="black" points="71621.97,-309.45 71631.97,-305.95 71621.97,-302.45 71621.97,-309.45"/>
</g>
<!-- s0_ln1_11 -->
<g id="node157" class="node">
<title>s0_ln1_11</title>
<polygon fill="lightblue" stroke="black" points="72546,-332.45 72175,-332.45 72175,-279.45 72546,-279.45 72546,-332.45"/>
<text text-anchor="middle" x="72360.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU11: LayerNorm (DP2)</text>
<text text-anchor="middle" x="72360.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="72360.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_11&#45;&gt;s0_ln1_11 -->
<g id="edge180" class="edge">
<title>s0_alltoall_11&#45;&gt;s0_ln1_11</title>
<path fill="none" stroke="black" d="M72157.08,-305.95C72159.69,-305.95 72162.29,-305.95 72164.9,-305.95"/>
<polygon fill="black" stroke="black" points="72164.96,-309.45 72174.96,-305.95 72164.96,-302.45 72164.96,-309.45"/>
</g>
<!-- s1_ln0_27 -->
<g id="node342" class="node">
<title>s1_ln0_27</title>
<polygon fill="lightgreen" stroke="black" points="72546,-190.45 72175,-190.45 72175,-137.45 72546,-137.45 72546,-190.45"/>
<text text-anchor="middle" x="72360.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: LayerNorm (DP2)</text>
<text text-anchor="middle" x="72360.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="72360.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_11&#45;&gt;s1_ln0_27 -->
<g id="edge252" class="edge">
<title>s0_ln1_11&#45;&gt;s1_ln0_27</title>
<path fill="none" stroke="black" d="M72360.5,-279.28C72360.5,-257.17 72360.5,-225.05 72360.5,-200.48"/>
<polygon fill="black" stroke="black" points="72364,-200.47 72360.5,-190.47 72357,-200.47 72364,-200.47"/>
</g>
<!-- s0_ln0_12 -->
<g id="node159" class="node">
<title>s0_ln0_12</title>
<polygon fill="lightblue" stroke="black" points="73324,-332.45 72953,-332.45 72953,-279.45 73324,-279.45 73324,-332.45"/>
<text text-anchor="middle" x="73138.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: LayerNorm (DP3)</text>
<text text-anchor="middle" x="73138.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="73138.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_12&#45;&gt;s0_ln0_12 -->
<g id="edge182" class="edge">
<title>s0_emb_12&#45;&gt;s0_ln0_12</title>
<path fill="none" stroke="black" d="M72935.26,-305.95C72937.72,-305.95 72940.17,-305.95 72942.63,-305.95"/>
<polygon fill="black" stroke="black" points="72942.73,-309.45 72952.73,-305.95 72942.73,-302.45 72942.73,-309.45"/>
</g>
<!-- s0_q_12 -->
<g id="node160" class="node">
<title>s0_q_12</title>
<polygon fill="lightblue" stroke="black" points="75577,-332.45 75206,-332.45 75206,-279.45 75577,-279.45 75577,-332.45"/>
<text text-anchor="middle" x="75391.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: Q Linear (TP0)</text>
<text text-anchor="middle" x="75391.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="75391.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_12&#45;&gt;s0_q_12 -->
<g id="edge183" class="edge">
<title>s0_ln0_12&#45;&gt;s0_q_12</title>
<path fill="none" stroke="black" d="M73197.5,-332.53C73237.28,-348.94 73291.44,-368.45 73341.5,-376.95 73442.61,-394.12 75086.38,-394.05 75187.5,-376.95 75233.86,-369.12 75283.74,-351.93 75322.57,-336.42"/>
<polygon fill="black" stroke="black" points="75324.24,-339.52 75332.2,-332.53 75321.62,-333.04 75324.24,-339.52"/>
</g>
<!-- s0_k_12 -->
<g id="node161" class="node">
<title>s0_k_12</title>
<polygon fill="lightblue" stroke="black" points="74645,-332.45 74274,-332.45 74274,-279.45 74645,-279.45 74645,-332.45"/>
<text text-anchor="middle" x="74459.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: K Linear (TP0)</text>
<text text-anchor="middle" x="74459.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="74459.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_12&#45;&gt;s0_k_12 -->
<g id="edge184" class="edge">
<title>s0_ln0_12&#45;&gt;s0_k_12</title>
<path fill="none" stroke="black" d="M73197.5,-332.53C73237.28,-348.94 73291.44,-368.45 73341.5,-376.95 73441.62,-393.96 74155.37,-393.88 74255.5,-376.95 74301.86,-369.12 74351.74,-351.93 74390.57,-336.42"/>
<polygon fill="black" stroke="black" points="74392.24,-339.52 74400.2,-332.53 74389.62,-333.04 74392.24,-339.52"/>
</g>
<!-- s0_v_12 -->
<g id="node162" class="node">
<title>s0_v_12</title>
<polygon fill="lightblue" stroke="black" points="73713,-332.45 73342,-332.45 73342,-279.45 73713,-279.45 73713,-332.45"/>
<text text-anchor="middle" x="73527.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: V Linear (TP0)</text>
<text text-anchor="middle" x="73527.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="73527.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_12&#45;&gt;s0_v_12 -->
<g id="edge185" class="edge">
<title>s0_ln0_12&#45;&gt;s0_v_12</title>
<path fill="none" stroke="black" d="M73324.26,-305.95C73326.72,-305.95 73329.17,-305.95 73331.63,-305.95"/>
<polygon fill="black" stroke="black" points="73331.73,-309.45 73341.73,-305.95 73331.73,-302.45 73331.73,-309.45"/>
</g>
<!-- s0_allgather_q_12 -->
<g id="node163" class="node">
<title>s0_allgather_q_12</title>
<ellipse fill="white" stroke="black" cx="75857.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="75857.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather Q (TP0)</text>
<text text-anchor="middle" x="75857.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="75857.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_12&#45;&gt;s0_allgather_q_12 -->
<g id="edge186" class="edge">
<title>s0_q_12&#45;&gt;s0_allgather_q_12</title>
<path fill="none" stroke="black" d="M75577.17,-305.95C75579.77,-305.95 75582.36,-305.95 75584.96,-305.95"/>
<polygon fill="black" stroke="black" points="75584.97,-309.45 75594.97,-305.95 75584.97,-302.45 75584.97,-309.45"/>
</g>
<!-- s0_allgather_k_12 -->
<g id="node164" class="node">
<title>s0_allgather_k_12</title>
<ellipse fill="white" stroke="black" cx="74925.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="74925.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather K (TP0)</text>
<text text-anchor="middle" x="74925.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="74925.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_12&#45;&gt;s0_allgather_k_12 -->
<g id="edge187" class="edge">
<title>s0_k_12&#45;&gt;s0_allgather_k_12</title>
<path fill="none" stroke="black" d="M74645.17,-305.95C74647.77,-305.95 74650.36,-305.95 74652.96,-305.95"/>
<polygon fill="black" stroke="black" points="74652.97,-309.45 74662.97,-305.95 74652.97,-302.45 74652.97,-309.45"/>
</g>
<!-- s0_allgather_v_12 -->
<g id="node165" class="node">
<title>s0_allgather_v_12</title>
<ellipse fill="white" stroke="black" cx="73993.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="73993.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: AllGather V (TP0)</text>
<text text-anchor="middle" x="73993.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="73993.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_12&#45;&gt;s0_allgather_v_12 -->
<g id="edge188" class="edge">
<title>s0_v_12&#45;&gt;s0_allgather_v_12</title>
<path fill="none" stroke="black" d="M73713.17,-305.95C73715.77,-305.95 73718.36,-305.95 73720.96,-305.95"/>
<polygon fill="black" stroke="black" points="73720.97,-309.45 73730.97,-305.95 73720.97,-302.45 73720.97,-309.45"/>
</g>
<!-- s0_attn_12 -->
<g id="node166" class="node">
<title>s0_attn_12</title>
<polygon fill="lightblue" stroke="black" points="76509,-332.45 76138,-332.45 76138,-279.45 76509,-279.45 76509,-332.45"/>
<text text-anchor="middle" x="76323.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: Attention (TP0)</text>
<text text-anchor="middle" x="76323.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="76323.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_12&#45;&gt;s0_attn_12 -->
<g id="edge189" class="edge">
<title>s0_allgather_q_12&#45;&gt;s0_attn_12</title>
<path fill="none" stroke="black" d="M76120.08,-305.95C76122.69,-305.95 76125.29,-305.95 76127.9,-305.95"/>
<polygon fill="black" stroke="black" points="76127.96,-309.45 76137.96,-305.95 76127.96,-302.45 76127.96,-309.45"/>
</g>
<!-- s0_allgather_k_12&#45;&gt;s0_attn_12 -->
<g id="edge190" class="edge">
<title>s0_allgather_k_12&#45;&gt;s0_attn_12</title>
<path fill="none" stroke="black" d="M75034,-340.15C75085.41,-354.63 75148.02,-369.78 75205.5,-376.95 75306.27,-389.53 76019.37,-393.88 76119.5,-376.95 76165.86,-369.12 76215.74,-351.93 76254.57,-336.42"/>
<polygon fill="black" stroke="black" points="76256.24,-339.52 76264.2,-332.53 76253.62,-333.04 76256.24,-339.52"/>
</g>
<!-- s0_allgather_v_12&#45;&gt;s0_attn_12 -->
<g id="edge191" class="edge">
<title>s0_allgather_v_12&#45;&gt;s0_attn_12</title>
<path fill="none" stroke="black" d="M74102,-340.15C74153.41,-354.63 74216.02,-369.78 74273.5,-376.95 74375.27,-389.65 76018.38,-394.05 76119.5,-376.95 76165.86,-369.12 76215.74,-351.93 76254.57,-336.42"/>
<polygon fill="black" stroke="black" points="76256.24,-339.52 76264.2,-332.53 76253.62,-333.04 76256.24,-339.52"/>
</g>
<!-- s0_gate_12 -->
<g id="node167" class="node">
<title>s0_gate_12</title>
<polygon fill="orange" stroke="black" points="77271.89,-358.95 76679.5,-358.95 76527.11,-252.95 77119.5,-252.95 77271.89,-358.95"/>
<text text-anchor="middle" x="76899.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: MoE Gate</text>
<text text-anchor="middle" x="76899.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="76899.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_12&#45;&gt;s0_gate_12 -->
<g id="edge192" class="edge">
<title>s0_attn_12&#45;&gt;s0_gate_12</title>
<path fill="none" stroke="black" d="M76509.12,-305.95C76537.08,-305.95 76565.03,-305.95 76592.99,-305.95"/>
<polygon fill="black" stroke="black" points="76593.29,-309.45 76603.29,-305.95 76593.29,-302.45 76593.29,-309.45"/>
</g>
<!-- s0_expert_12 -->
<g id="node168" class="node">
<title>s0_expert_12</title>
<polygon fill="lightblue" stroke="black" points="77661,-332.45 77290,-332.45 77290,-279.45 77661,-279.45 77661,-332.45"/>
<text text-anchor="middle" x="77475.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: Expert FFN</text>
<text text-anchor="middle" x="77475.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="77475.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_12&#45;&gt;s0_expert_12 -->
<g id="edge193" class="edge">
<title>s0_gate_12&#45;&gt;s0_expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M77195.94,-305.95C77223.82,-305.95 77251.7,-305.95 77279.58,-305.95"/>
<polygon fill="black" stroke="black" points="77279.85,-309.45 77289.85,-305.95 77279.85,-302.45 77279.85,-309.45"/>
</g>
<!-- s0_alltoall_12 -->
<g id="node169" class="node">
<title>s0_alltoall_12</title>
<ellipse fill="white" stroke="black" cx="77941.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="77941.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: AllToAll</text>
<text text-anchor="middle" x="77941.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="77941.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_12&#45;&gt;s0_alltoall_12 -->
<g id="edge194" class="edge">
<title>s0_expert_12&#45;&gt;s0_alltoall_12</title>
<path fill="none" stroke="black" d="M77661.17,-305.95C77663.77,-305.95 77666.36,-305.95 77668.96,-305.95"/>
<polygon fill="black" stroke="black" points="77668.97,-309.45 77678.97,-305.95 77668.97,-302.45 77668.97,-309.45"/>
</g>
<!-- s0_ln1_12 -->
<g id="node170" class="node">
<title>s0_ln1_12</title>
<polygon fill="lightblue" stroke="black" points="78593,-332.45 78222,-332.45 78222,-279.45 78593,-279.45 78593,-332.45"/>
<text text-anchor="middle" x="78407.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU12: LayerNorm (DP3)</text>
<text text-anchor="middle" x="78407.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="78407.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_12&#45;&gt;s0_ln1_12 -->
<g id="edge195" class="edge">
<title>s0_alltoall_12&#45;&gt;s0_ln1_12</title>
<path fill="none" stroke="black" d="M78204.08,-305.95C78206.69,-305.95 78209.29,-305.95 78211.9,-305.95"/>
<polygon fill="black" stroke="black" points="78211.96,-309.45 78221.96,-305.95 78211.96,-302.45 78211.96,-309.45"/>
</g>
<!-- s1_ln0_28 -->
<g id="node354" class="node">
<title>s1_ln0_28</title>
<polygon fill="lightgreen" stroke="black" points="78593,-190.45 78222,-190.45 78222,-137.45 78593,-137.45 78593,-190.45"/>
<text text-anchor="middle" x="78407.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: LayerNorm (DP3)</text>
<text text-anchor="middle" x="78407.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="78407.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_12&#45;&gt;s1_ln0_28 -->
<g id="edge253" class="edge">
<title>s0_ln1_12&#45;&gt;s1_ln0_28</title>
<path fill="none" stroke="black" d="M78407.5,-279.28C78407.5,-257.17 78407.5,-225.05 78407.5,-200.48"/>
<polygon fill="black" stroke="black" points="78411,-200.47 78407.5,-190.47 78404,-200.47 78411,-200.47"/>
</g>
<!-- s0_ln0_13 -->
<g id="node172" class="node">
<title>s0_ln0_13</title>
<polygon fill="lightblue" stroke="black" points="79371,-332.45 79000,-332.45 79000,-279.45 79371,-279.45 79371,-332.45"/>
<text text-anchor="middle" x="79185.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: LayerNorm (DP3)</text>
<text text-anchor="middle" x="79185.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="79185.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_13&#45;&gt;s0_ln0_13 -->
<g id="edge197" class="edge">
<title>s0_emb_13&#45;&gt;s0_ln0_13</title>
<path fill="none" stroke="black" d="M78982.26,-305.95C78984.72,-305.95 78987.17,-305.95 78989.63,-305.95"/>
<polygon fill="black" stroke="black" points="78989.73,-309.45 78999.73,-305.95 78989.73,-302.45 78989.73,-309.45"/>
</g>
<!-- s0_q_13 -->
<g id="node173" class="node">
<title>s0_q_13</title>
<polygon fill="lightblue" stroke="black" points="81624,-332.45 81253,-332.45 81253,-279.45 81624,-279.45 81624,-332.45"/>
<text text-anchor="middle" x="81438.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: Q Linear (TP1)</text>
<text text-anchor="middle" x="81438.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="81438.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_13&#45;&gt;s0_q_13 -->
<g id="edge198" class="edge">
<title>s0_ln0_13&#45;&gt;s0_q_13</title>
<path fill="none" stroke="black" d="M79244.5,-332.53C79284.28,-348.94 79338.44,-368.45 79388.5,-376.95 79489.61,-394.12 81133.38,-394.05 81234.5,-376.95 81280.86,-369.12 81330.74,-351.93 81369.57,-336.42"/>
<polygon fill="black" stroke="black" points="81371.24,-339.52 81379.2,-332.53 81368.62,-333.04 81371.24,-339.52"/>
</g>
<!-- s0_k_13 -->
<g id="node174" class="node">
<title>s0_k_13</title>
<polygon fill="lightblue" stroke="black" points="80692,-332.45 80321,-332.45 80321,-279.45 80692,-279.45 80692,-332.45"/>
<text text-anchor="middle" x="80506.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: K Linear (TP1)</text>
<text text-anchor="middle" x="80506.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="80506.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_13&#45;&gt;s0_k_13 -->
<g id="edge199" class="edge">
<title>s0_ln0_13&#45;&gt;s0_k_13</title>
<path fill="none" stroke="black" d="M79244.5,-332.53C79284.28,-348.94 79338.44,-368.45 79388.5,-376.95 79488.62,-393.96 80202.37,-393.88 80302.5,-376.95 80348.86,-369.12 80398.74,-351.93 80437.57,-336.42"/>
<polygon fill="black" stroke="black" points="80439.24,-339.52 80447.2,-332.53 80436.62,-333.04 80439.24,-339.52"/>
</g>
<!-- s0_v_13 -->
<g id="node175" class="node">
<title>s0_v_13</title>
<polygon fill="lightblue" stroke="black" points="79760,-332.45 79389,-332.45 79389,-279.45 79760,-279.45 79760,-332.45"/>
<text text-anchor="middle" x="79574.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: V Linear (TP1)</text>
<text text-anchor="middle" x="79574.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="79574.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_13&#45;&gt;s0_v_13 -->
<g id="edge200" class="edge">
<title>s0_ln0_13&#45;&gt;s0_v_13</title>
<path fill="none" stroke="black" d="M79371.26,-305.95C79373.72,-305.95 79376.17,-305.95 79378.63,-305.95"/>
<polygon fill="black" stroke="black" points="79378.73,-309.45 79388.73,-305.95 79378.73,-302.45 79378.73,-309.45"/>
</g>
<!-- s0_allgather_q_13 -->
<g id="node176" class="node">
<title>s0_allgather_q_13</title>
<ellipse fill="white" stroke="black" cx="81904.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="81904.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather Q (TP1)</text>
<text text-anchor="middle" x="81904.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="81904.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_13&#45;&gt;s0_allgather_q_13 -->
<g id="edge201" class="edge">
<title>s0_q_13&#45;&gt;s0_allgather_q_13</title>
<path fill="none" stroke="black" d="M81624.17,-305.95C81626.77,-305.95 81629.36,-305.95 81631.96,-305.95"/>
<polygon fill="black" stroke="black" points="81631.97,-309.45 81641.97,-305.95 81631.97,-302.45 81631.97,-309.45"/>
</g>
<!-- s0_allgather_k_13 -->
<g id="node177" class="node">
<title>s0_allgather_k_13</title>
<ellipse fill="white" stroke="black" cx="80972.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="80972.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather K (TP1)</text>
<text text-anchor="middle" x="80972.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="80972.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_13&#45;&gt;s0_allgather_k_13 -->
<g id="edge202" class="edge">
<title>s0_k_13&#45;&gt;s0_allgather_k_13</title>
<path fill="none" stroke="black" d="M80692.17,-305.95C80694.77,-305.95 80697.36,-305.95 80699.96,-305.95"/>
<polygon fill="black" stroke="black" points="80699.97,-309.45 80709.97,-305.95 80699.97,-302.45 80699.97,-309.45"/>
</g>
<!-- s0_allgather_v_13 -->
<g id="node178" class="node">
<title>s0_allgather_v_13</title>
<ellipse fill="white" stroke="black" cx="80040.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="80040.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: AllGather V (TP1)</text>
<text text-anchor="middle" x="80040.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="80040.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_13&#45;&gt;s0_allgather_v_13 -->
<g id="edge203" class="edge">
<title>s0_v_13&#45;&gt;s0_allgather_v_13</title>
<path fill="none" stroke="black" d="M79760.17,-305.95C79762.77,-305.95 79765.36,-305.95 79767.96,-305.95"/>
<polygon fill="black" stroke="black" points="79767.97,-309.45 79777.97,-305.95 79767.97,-302.45 79767.97,-309.45"/>
</g>
<!-- s0_attn_13 -->
<g id="node179" class="node">
<title>s0_attn_13</title>
<polygon fill="lightblue" stroke="black" points="82556,-332.45 82185,-332.45 82185,-279.45 82556,-279.45 82556,-332.45"/>
<text text-anchor="middle" x="82370.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: Attention (TP1)</text>
<text text-anchor="middle" x="82370.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="82370.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_13&#45;&gt;s0_attn_13 -->
<g id="edge204" class="edge">
<title>s0_allgather_q_13&#45;&gt;s0_attn_13</title>
<path fill="none" stroke="black" d="M82167.08,-305.95C82169.69,-305.95 82172.29,-305.95 82174.9,-305.95"/>
<polygon fill="black" stroke="black" points="82174.96,-309.45 82184.96,-305.95 82174.96,-302.45 82174.96,-309.45"/>
</g>
<!-- s0_allgather_k_13&#45;&gt;s0_attn_13 -->
<g id="edge205" class="edge">
<title>s0_allgather_k_13&#45;&gt;s0_attn_13</title>
<path fill="none" stroke="black" d="M81081,-340.15C81132.41,-354.63 81195.02,-369.78 81252.5,-376.95 81353.27,-389.53 82066.37,-393.88 82166.5,-376.95 82212.86,-369.12 82262.74,-351.93 82301.57,-336.42"/>
<polygon fill="black" stroke="black" points="82303.24,-339.52 82311.2,-332.53 82300.62,-333.04 82303.24,-339.52"/>
</g>
<!-- s0_allgather_v_13&#45;&gt;s0_attn_13 -->
<g id="edge206" class="edge">
<title>s0_allgather_v_13&#45;&gt;s0_attn_13</title>
<path fill="none" stroke="black" d="M80149,-340.15C80200.41,-354.63 80263.02,-369.78 80320.5,-376.95 80422.27,-389.65 82065.38,-394.05 82166.5,-376.95 82212.86,-369.12 82262.74,-351.93 82301.57,-336.42"/>
<polygon fill="black" stroke="black" points="82303.24,-339.52 82311.2,-332.53 82300.62,-333.04 82303.24,-339.52"/>
</g>
<!-- s0_gate_13 -->
<g id="node180" class="node">
<title>s0_gate_13</title>
<polygon fill="orange" stroke="black" points="83318.89,-358.95 82726.5,-358.95 82574.11,-252.95 83166.5,-252.95 83318.89,-358.95"/>
<text text-anchor="middle" x="82946.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: MoE Gate</text>
<text text-anchor="middle" x="82946.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="82946.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_13&#45;&gt;s0_gate_13 -->
<g id="edge207" class="edge">
<title>s0_attn_13&#45;&gt;s0_gate_13</title>
<path fill="none" stroke="black" d="M82556.12,-305.95C82584.08,-305.95 82612.03,-305.95 82639.99,-305.95"/>
<polygon fill="black" stroke="black" points="82640.29,-309.45 82650.29,-305.95 82640.29,-302.45 82640.29,-309.45"/>
</g>
<!-- s0_expert_13 -->
<g id="node181" class="node">
<title>s0_expert_13</title>
<polygon fill="lightblue" stroke="black" points="83708,-332.45 83337,-332.45 83337,-279.45 83708,-279.45 83708,-332.45"/>
<text text-anchor="middle" x="83522.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: Expert FFN</text>
<text text-anchor="middle" x="83522.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="83522.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_13&#45;&gt;s0_expert_13 -->
<g id="edge208" class="edge">
<title>s0_gate_13&#45;&gt;s0_expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M83242.94,-305.95C83270.82,-305.95 83298.7,-305.95 83326.58,-305.95"/>
<polygon fill="black" stroke="black" points="83326.85,-309.45 83336.85,-305.95 83326.85,-302.45 83326.85,-309.45"/>
</g>
<!-- s0_alltoall_13 -->
<g id="node182" class="node">
<title>s0_alltoall_13</title>
<ellipse fill="white" stroke="black" cx="83988.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="83988.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: AllToAll</text>
<text text-anchor="middle" x="83988.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="83988.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_13&#45;&gt;s0_alltoall_13 -->
<g id="edge209" class="edge">
<title>s0_expert_13&#45;&gt;s0_alltoall_13</title>
<path fill="none" stroke="black" d="M83708.17,-305.95C83710.77,-305.95 83713.36,-305.95 83715.96,-305.95"/>
<polygon fill="black" stroke="black" points="83715.97,-309.45 83725.97,-305.95 83715.97,-302.45 83715.97,-309.45"/>
</g>
<!-- s0_ln1_13 -->
<g id="node183" class="node">
<title>s0_ln1_13</title>
<polygon fill="lightblue" stroke="black" points="84640,-332.45 84269,-332.45 84269,-279.45 84640,-279.45 84640,-332.45"/>
<text text-anchor="middle" x="84454.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU13: LayerNorm (DP3)</text>
<text text-anchor="middle" x="84454.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="84454.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_13&#45;&gt;s0_ln1_13 -->
<g id="edge210" class="edge">
<title>s0_alltoall_13&#45;&gt;s0_ln1_13</title>
<path fill="none" stroke="black" d="M84251.08,-305.95C84253.69,-305.95 84256.29,-305.95 84258.9,-305.95"/>
<polygon fill="black" stroke="black" points="84258.96,-309.45 84268.96,-305.95 84258.96,-302.45 84258.96,-309.45"/>
</g>
<!-- s1_ln0_29 -->
<g id="node366" class="node">
<title>s1_ln0_29</title>
<polygon fill="lightgreen" stroke="black" points="84640,-190.45 84269,-190.45 84269,-137.45 84640,-137.45 84640,-190.45"/>
<text text-anchor="middle" x="84454.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: LayerNorm (DP3)</text>
<text text-anchor="middle" x="84454.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="84454.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_13&#45;&gt;s1_ln0_29 -->
<g id="edge254" class="edge">
<title>s0_ln1_13&#45;&gt;s1_ln0_29</title>
<path fill="none" stroke="black" d="M84454.5,-279.28C84454.5,-257.17 84454.5,-225.05 84454.5,-200.48"/>
<polygon fill="black" stroke="black" points="84458,-200.47 84454.5,-190.47 84451,-200.47 84458,-200.47"/>
</g>
<!-- s0_ln0_14 -->
<g id="node185" class="node">
<title>s0_ln0_14</title>
<polygon fill="lightblue" stroke="black" points="85418,-332.45 85047,-332.45 85047,-279.45 85418,-279.45 85418,-332.45"/>
<text text-anchor="middle" x="85232.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: LayerNorm (DP3)</text>
<text text-anchor="middle" x="85232.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="85232.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_14&#45;&gt;s0_ln0_14 -->
<g id="edge212" class="edge">
<title>s0_emb_14&#45;&gt;s0_ln0_14</title>
<path fill="none" stroke="black" d="M85029.26,-305.95C85031.72,-305.95 85034.17,-305.95 85036.63,-305.95"/>
<polygon fill="black" stroke="black" points="85036.73,-309.45 85046.73,-305.95 85036.73,-302.45 85036.73,-309.45"/>
</g>
<!-- s0_q_14 -->
<g id="node186" class="node">
<title>s0_q_14</title>
<polygon fill="lightblue" stroke="black" points="87671,-332.45 87300,-332.45 87300,-279.45 87671,-279.45 87671,-332.45"/>
<text text-anchor="middle" x="87485.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: Q Linear (TP2)</text>
<text text-anchor="middle" x="87485.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="87485.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_14&#45;&gt;s0_q_14 -->
<g id="edge213" class="edge">
<title>s0_ln0_14&#45;&gt;s0_q_14</title>
<path fill="none" stroke="black" d="M85291.5,-332.53C85331.28,-348.94 85385.44,-368.45 85435.5,-376.95 85536.61,-394.12 87180.38,-394.05 87281.5,-376.95 87327.86,-369.12 87377.74,-351.93 87416.57,-336.42"/>
<polygon fill="black" stroke="black" points="87418.24,-339.52 87426.2,-332.53 87415.62,-333.04 87418.24,-339.52"/>
</g>
<!-- s0_k_14 -->
<g id="node187" class="node">
<title>s0_k_14</title>
<polygon fill="lightblue" stroke="black" points="86739,-332.45 86368,-332.45 86368,-279.45 86739,-279.45 86739,-332.45"/>
<text text-anchor="middle" x="86553.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: K Linear (TP2)</text>
<text text-anchor="middle" x="86553.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="86553.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_14&#45;&gt;s0_k_14 -->
<g id="edge214" class="edge">
<title>s0_ln0_14&#45;&gt;s0_k_14</title>
<path fill="none" stroke="black" d="M85291.5,-332.53C85331.28,-348.94 85385.44,-368.45 85435.5,-376.95 85535.62,-393.96 86249.37,-393.88 86349.5,-376.95 86395.86,-369.12 86445.74,-351.93 86484.57,-336.42"/>
<polygon fill="black" stroke="black" points="86486.24,-339.52 86494.2,-332.53 86483.62,-333.04 86486.24,-339.52"/>
</g>
<!-- s0_v_14 -->
<g id="node188" class="node">
<title>s0_v_14</title>
<polygon fill="lightblue" stroke="black" points="85807,-332.45 85436,-332.45 85436,-279.45 85807,-279.45 85807,-332.45"/>
<text text-anchor="middle" x="85621.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: V Linear (TP2)</text>
<text text-anchor="middle" x="85621.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="85621.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_14&#45;&gt;s0_v_14 -->
<g id="edge215" class="edge">
<title>s0_ln0_14&#45;&gt;s0_v_14</title>
<path fill="none" stroke="black" d="M85418.26,-305.95C85420.72,-305.95 85423.17,-305.95 85425.63,-305.95"/>
<polygon fill="black" stroke="black" points="85425.73,-309.45 85435.73,-305.95 85425.73,-302.45 85425.73,-309.45"/>
</g>
<!-- s0_allgather_q_14 -->
<g id="node189" class="node">
<title>s0_allgather_q_14</title>
<ellipse fill="white" stroke="black" cx="87951.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="87951.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather Q (TP2)</text>
<text text-anchor="middle" x="87951.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="87951.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_14&#45;&gt;s0_allgather_q_14 -->
<g id="edge216" class="edge">
<title>s0_q_14&#45;&gt;s0_allgather_q_14</title>
<path fill="none" stroke="black" d="M87671.17,-305.95C87673.77,-305.95 87676.36,-305.95 87678.96,-305.95"/>
<polygon fill="black" stroke="black" points="87678.97,-309.45 87688.97,-305.95 87678.97,-302.45 87678.97,-309.45"/>
</g>
<!-- s0_allgather_k_14 -->
<g id="node190" class="node">
<title>s0_allgather_k_14</title>
<ellipse fill="white" stroke="black" cx="87019.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="87019.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather K (TP2)</text>
<text text-anchor="middle" x="87019.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="87019.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_14&#45;&gt;s0_allgather_k_14 -->
<g id="edge217" class="edge">
<title>s0_k_14&#45;&gt;s0_allgather_k_14</title>
<path fill="none" stroke="black" d="M86739.17,-305.95C86741.77,-305.95 86744.36,-305.95 86746.96,-305.95"/>
<polygon fill="black" stroke="black" points="86746.97,-309.45 86756.97,-305.95 86746.97,-302.45 86746.97,-309.45"/>
</g>
<!-- s0_allgather_v_14 -->
<g id="node191" class="node">
<title>s0_allgather_v_14</title>
<ellipse fill="white" stroke="black" cx="86087.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="86087.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: AllGather V (TP2)</text>
<text text-anchor="middle" x="86087.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="86087.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_14&#45;&gt;s0_allgather_v_14 -->
<g id="edge218" class="edge">
<title>s0_v_14&#45;&gt;s0_allgather_v_14</title>
<path fill="none" stroke="black" d="M85807.17,-305.95C85809.77,-305.95 85812.36,-305.95 85814.96,-305.95"/>
<polygon fill="black" stroke="black" points="85814.97,-309.45 85824.97,-305.95 85814.97,-302.45 85814.97,-309.45"/>
</g>
<!-- s0_attn_14 -->
<g id="node192" class="node">
<title>s0_attn_14</title>
<polygon fill="lightblue" stroke="black" points="88603,-332.45 88232,-332.45 88232,-279.45 88603,-279.45 88603,-332.45"/>
<text text-anchor="middle" x="88417.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: Attention (TP2)</text>
<text text-anchor="middle" x="88417.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="88417.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_14&#45;&gt;s0_attn_14 -->
<g id="edge219" class="edge">
<title>s0_allgather_q_14&#45;&gt;s0_attn_14</title>
<path fill="none" stroke="black" d="M88214.08,-305.95C88216.69,-305.95 88219.29,-305.95 88221.9,-305.95"/>
<polygon fill="black" stroke="black" points="88221.96,-309.45 88231.96,-305.95 88221.96,-302.45 88221.96,-309.45"/>
</g>
<!-- s0_allgather_k_14&#45;&gt;s0_attn_14 -->
<g id="edge220" class="edge">
<title>s0_allgather_k_14&#45;&gt;s0_attn_14</title>
<path fill="none" stroke="black" d="M87128,-340.15C87179.41,-354.63 87242.02,-369.78 87299.5,-376.95 87400.27,-389.53 88113.37,-393.88 88213.5,-376.95 88259.86,-369.12 88309.74,-351.93 88348.57,-336.42"/>
<polygon fill="black" stroke="black" points="88350.24,-339.52 88358.2,-332.53 88347.62,-333.04 88350.24,-339.52"/>
</g>
<!-- s0_allgather_v_14&#45;&gt;s0_attn_14 -->
<g id="edge221" class="edge">
<title>s0_allgather_v_14&#45;&gt;s0_attn_14</title>
<path fill="none" stroke="black" d="M86196,-340.15C86247.41,-354.63 86310.02,-369.78 86367.5,-376.95 86469.27,-389.65 88112.38,-394.05 88213.5,-376.95 88259.86,-369.12 88309.74,-351.93 88348.57,-336.42"/>
<polygon fill="black" stroke="black" points="88350.24,-339.52 88358.2,-332.53 88347.62,-333.04 88350.24,-339.52"/>
</g>
<!-- s0_gate_14 -->
<g id="node193" class="node">
<title>s0_gate_14</title>
<polygon fill="orange" stroke="black" points="89365.89,-358.95 88773.5,-358.95 88621.11,-252.95 89213.5,-252.95 89365.89,-358.95"/>
<text text-anchor="middle" x="88993.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: MoE Gate</text>
<text text-anchor="middle" x="88993.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="88993.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_14&#45;&gt;s0_gate_14 -->
<g id="edge222" class="edge">
<title>s0_attn_14&#45;&gt;s0_gate_14</title>
<path fill="none" stroke="black" d="M88603.12,-305.95C88631.08,-305.95 88659.03,-305.95 88686.99,-305.95"/>
<polygon fill="black" stroke="black" points="88687.29,-309.45 88697.29,-305.95 88687.29,-302.45 88687.29,-309.45"/>
</g>
<!-- s0_expert_14 -->
<g id="node194" class="node">
<title>s0_expert_14</title>
<polygon fill="lightblue" stroke="black" points="89755,-332.45 89384,-332.45 89384,-279.45 89755,-279.45 89755,-332.45"/>
<text text-anchor="middle" x="89569.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: Expert FFN</text>
<text text-anchor="middle" x="89569.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="89569.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_14&#45;&gt;s0_expert_14 -->
<g id="edge223" class="edge">
<title>s0_gate_14&#45;&gt;s0_expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M89289.94,-305.95C89317.82,-305.95 89345.7,-305.95 89373.58,-305.95"/>
<polygon fill="black" stroke="black" points="89373.85,-309.45 89383.85,-305.95 89373.85,-302.45 89373.85,-309.45"/>
</g>
<!-- s0_alltoall_14 -->
<g id="node195" class="node">
<title>s0_alltoall_14</title>
<ellipse fill="white" stroke="black" cx="90035.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="90035.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: AllToAll</text>
<text text-anchor="middle" x="90035.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="90035.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_14&#45;&gt;s0_alltoall_14 -->
<g id="edge224" class="edge">
<title>s0_expert_14&#45;&gt;s0_alltoall_14</title>
<path fill="none" stroke="black" d="M89755.17,-305.95C89757.77,-305.95 89760.36,-305.95 89762.96,-305.95"/>
<polygon fill="black" stroke="black" points="89762.97,-309.45 89772.97,-305.95 89762.97,-302.45 89762.97,-309.45"/>
</g>
<!-- s0_ln1_14 -->
<g id="node196" class="node">
<title>s0_ln1_14</title>
<polygon fill="lightblue" stroke="black" points="90687,-332.45 90316,-332.45 90316,-279.45 90687,-279.45 90687,-332.45"/>
<text text-anchor="middle" x="90501.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU14: LayerNorm (DP3)</text>
<text text-anchor="middle" x="90501.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="90501.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_14&#45;&gt;s0_ln1_14 -->
<g id="edge225" class="edge">
<title>s0_alltoall_14&#45;&gt;s0_ln1_14</title>
<path fill="none" stroke="black" d="M90298.08,-305.95C90300.69,-305.95 90303.29,-305.95 90305.9,-305.95"/>
<polygon fill="black" stroke="black" points="90305.96,-309.45 90315.96,-305.95 90305.96,-302.45 90305.96,-309.45"/>
</g>
<!-- s1_ln0_30 -->
<g id="node378" class="node">
<title>s1_ln0_30</title>
<polygon fill="lightgreen" stroke="black" points="90687,-190.45 90316,-190.45 90316,-137.45 90687,-137.45 90687,-190.45"/>
<text text-anchor="middle" x="90501.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: LayerNorm (DP3)</text>
<text text-anchor="middle" x="90501.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="90501.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_14&#45;&gt;s1_ln0_30 -->
<g id="edge255" class="edge">
<title>s0_ln1_14&#45;&gt;s1_ln0_30</title>
<path fill="none" stroke="black" d="M90501.5,-279.28C90501.5,-257.17 90501.5,-225.05 90501.5,-200.48"/>
<polygon fill="black" stroke="black" points="90505,-200.47 90501.5,-190.47 90498,-200.47 90505,-200.47"/>
</g>
<!-- s0_ln0_15 -->
<g id="node198" class="node">
<title>s0_ln0_15</title>
<polygon fill="lightblue" stroke="black" points="91465,-332.45 91094,-332.45 91094,-279.45 91465,-279.45 91465,-332.45"/>
<text text-anchor="middle" x="91279.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: LayerNorm (DP3)</text>
<text text-anchor="middle" x="91279.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="91279.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_emb_15&#45;&gt;s0_ln0_15 -->
<g id="edge227" class="edge">
<title>s0_emb_15&#45;&gt;s0_ln0_15</title>
<path fill="none" stroke="black" d="M91076.26,-305.95C91078.72,-305.95 91081.17,-305.95 91083.63,-305.95"/>
<polygon fill="black" stroke="black" points="91083.73,-309.45 91093.73,-305.95 91083.73,-302.45 91083.73,-309.45"/>
</g>
<!-- s0_q_15 -->
<g id="node199" class="node">
<title>s0_q_15</title>
<polygon fill="lightblue" stroke="black" points="93718,-332.45 93347,-332.45 93347,-279.45 93718,-279.45 93718,-332.45"/>
<text text-anchor="middle" x="93532.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: Q Linear (TP3)</text>
<text text-anchor="middle" x="93532.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="93532.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_15&#45;&gt;s0_q_15 -->
<g id="edge228" class="edge">
<title>s0_ln0_15&#45;&gt;s0_q_15</title>
<path fill="none" stroke="black" d="M91338.5,-332.53C91378.28,-348.94 91432.44,-368.45 91482.5,-376.95 91583.61,-394.12 93227.38,-394.05 93328.5,-376.95 93374.86,-369.12 93424.74,-351.93 93463.57,-336.42"/>
<polygon fill="black" stroke="black" points="93465.24,-339.52 93473.2,-332.53 93462.62,-333.04 93465.24,-339.52"/>
</g>
<!-- s0_k_15 -->
<g id="node200" class="node">
<title>s0_k_15</title>
<polygon fill="lightblue" stroke="black" points="92786,-332.45 92415,-332.45 92415,-279.45 92786,-279.45 92786,-332.45"/>
<text text-anchor="middle" x="92600.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: K Linear (TP3)</text>
<text text-anchor="middle" x="92600.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="92600.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_15&#45;&gt;s0_k_15 -->
<g id="edge229" class="edge">
<title>s0_ln0_15&#45;&gt;s0_k_15</title>
<path fill="none" stroke="black" d="M91338.5,-332.53C91378.28,-348.94 91432.44,-368.45 91482.5,-376.95 91582.62,-393.96 92296.37,-393.88 92396.5,-376.95 92442.86,-369.12 92492.74,-351.93 92531.57,-336.42"/>
<polygon fill="black" stroke="black" points="92533.24,-339.52 92541.2,-332.53 92530.62,-333.04 92533.24,-339.52"/>
</g>
<!-- s0_v_15 -->
<g id="node201" class="node">
<title>s0_v_15</title>
<polygon fill="lightblue" stroke="black" points="91854,-332.45 91483,-332.45 91483,-279.45 91854,-279.45 91854,-332.45"/>
<text text-anchor="middle" x="91668.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: V Linear (TP3)</text>
<text text-anchor="middle" x="91668.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="91668.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s0_ln0_15&#45;&gt;s0_v_15 -->
<g id="edge230" class="edge">
<title>s0_ln0_15&#45;&gt;s0_v_15</title>
<path fill="none" stroke="black" d="M91465.26,-305.95C91467.72,-305.95 91470.17,-305.95 91472.63,-305.95"/>
<polygon fill="black" stroke="black" points="91472.73,-309.45 91482.73,-305.95 91472.73,-302.45 91472.73,-309.45"/>
</g>
<!-- s0_allgather_q_15 -->
<g id="node202" class="node">
<title>s0_allgather_q_15</title>
<ellipse fill="white" stroke="black" cx="93998.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="93998.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather Q (TP3)</text>
<text text-anchor="middle" x="93998.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="93998.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_q_15&#45;&gt;s0_allgather_q_15 -->
<g id="edge231" class="edge">
<title>s0_q_15&#45;&gt;s0_allgather_q_15</title>
<path fill="none" stroke="black" d="M93718.17,-305.95C93720.77,-305.95 93723.36,-305.95 93725.96,-305.95"/>
<polygon fill="black" stroke="black" points="93725.97,-309.45 93735.97,-305.95 93725.97,-302.45 93725.97,-309.45"/>
</g>
<!-- s0_allgather_k_15 -->
<g id="node203" class="node">
<title>s0_allgather_k_15</title>
<ellipse fill="white" stroke="black" cx="93066.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="93066.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather K (TP3)</text>
<text text-anchor="middle" x="93066.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="93066.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_k_15&#45;&gt;s0_allgather_k_15 -->
<g id="edge232" class="edge">
<title>s0_k_15&#45;&gt;s0_allgather_k_15</title>
<path fill="none" stroke="black" d="M92786.17,-305.95C92788.77,-305.95 92791.36,-305.95 92793.96,-305.95"/>
<polygon fill="black" stroke="black" points="92793.97,-309.45 92803.97,-305.95 92793.97,-302.45 92793.97,-309.45"/>
</g>
<!-- s0_allgather_v_15 -->
<g id="node204" class="node">
<title>s0_allgather_v_15</title>
<ellipse fill="white" stroke="black" cx="92134.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="92134.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: AllGather V (TP3)</text>
<text text-anchor="middle" x="92134.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="92134.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_v_15&#45;&gt;s0_allgather_v_15 -->
<g id="edge233" class="edge">
<title>s0_v_15&#45;&gt;s0_allgather_v_15</title>
<path fill="none" stroke="black" d="M91854.17,-305.95C91856.77,-305.95 91859.36,-305.95 91861.96,-305.95"/>
<polygon fill="black" stroke="black" points="91861.97,-309.45 91871.97,-305.95 91861.97,-302.45 91861.97,-309.45"/>
</g>
<!-- s0_attn_15 -->
<g id="node205" class="node">
<title>s0_attn_15</title>
<polygon fill="lightblue" stroke="black" points="94650,-332.45 94279,-332.45 94279,-279.45 94650,-279.45 94650,-332.45"/>
<text text-anchor="middle" x="94464.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: Attention (TP3)</text>
<text text-anchor="middle" x="94464.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="94464.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_allgather_q_15&#45;&gt;s0_attn_15 -->
<g id="edge234" class="edge">
<title>s0_allgather_q_15&#45;&gt;s0_attn_15</title>
<path fill="none" stroke="black" d="M94261.08,-305.95C94263.69,-305.95 94266.29,-305.95 94268.9,-305.95"/>
<polygon fill="black" stroke="black" points="94268.96,-309.45 94278.96,-305.95 94268.96,-302.45 94268.96,-309.45"/>
</g>
<!-- s0_allgather_k_15&#45;&gt;s0_attn_15 -->
<g id="edge235" class="edge">
<title>s0_allgather_k_15&#45;&gt;s0_attn_15</title>
<path fill="none" stroke="black" d="M93175,-340.15C93226.41,-354.63 93289.02,-369.78 93346.5,-376.95 93447.27,-389.53 94160.37,-393.88 94260.5,-376.95 94306.86,-369.12 94356.74,-351.93 94395.57,-336.42"/>
<polygon fill="black" stroke="black" points="94397.24,-339.52 94405.2,-332.53 94394.62,-333.04 94397.24,-339.52"/>
</g>
<!-- s0_allgather_v_15&#45;&gt;s0_attn_15 -->
<g id="edge236" class="edge">
<title>s0_allgather_v_15&#45;&gt;s0_attn_15</title>
<path fill="none" stroke="black" d="M92243,-340.15C92294.41,-354.63 92357.02,-369.78 92414.5,-376.95 92516.27,-389.65 94159.38,-394.05 94260.5,-376.95 94306.86,-369.12 94356.74,-351.93 94395.57,-336.42"/>
<polygon fill="black" stroke="black" points="94397.24,-339.52 94405.2,-332.53 94394.62,-333.04 94397.24,-339.52"/>
</g>
<!-- s0_gate_15 -->
<g id="node206" class="node">
<title>s0_gate_15</title>
<polygon fill="orange" stroke="black" points="95412.89,-358.95 94820.5,-358.95 94668.11,-252.95 95260.5,-252.95 95412.89,-358.95"/>
<text text-anchor="middle" x="95040.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: MoE Gate</text>
<text text-anchor="middle" x="95040.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="95040.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s0_attn_15&#45;&gt;s0_gate_15 -->
<g id="edge237" class="edge">
<title>s0_attn_15&#45;&gt;s0_gate_15</title>
<path fill="none" stroke="black" d="M94650.12,-305.95C94678.08,-305.95 94706.03,-305.95 94733.99,-305.95"/>
<polygon fill="black" stroke="black" points="94734.29,-309.45 94744.29,-305.95 94734.29,-302.45 94734.29,-309.45"/>
</g>
<!-- s0_expert_15 -->
<g id="node207" class="node">
<title>s0_expert_15</title>
<polygon fill="lightblue" stroke="black" points="95802,-332.45 95431,-332.45 95431,-279.45 95802,-279.45 95802,-332.45"/>
<text text-anchor="middle" x="95616.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: Expert FFN</text>
<text text-anchor="middle" x="95616.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="95616.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_gate_15&#45;&gt;s0_expert_15 -->
<g id="edge238" class="edge">
<title>s0_gate_15&#45;&gt;s0_expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M95336.94,-305.95C95364.82,-305.95 95392.7,-305.95 95420.58,-305.95"/>
<polygon fill="black" stroke="black" points="95420.85,-309.45 95430.85,-305.95 95420.85,-302.45 95420.85,-309.45"/>
</g>
<!-- s0_alltoall_15 -->
<g id="node208" class="node">
<title>s0_alltoall_15</title>
<ellipse fill="white" stroke="black" cx="96082.5" cy="-305.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="96082.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: AllToAll</text>
<text text-anchor="middle" x="96082.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="96082.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_expert_15&#45;&gt;s0_alltoall_15 -->
<g id="edge239" class="edge">
<title>s0_expert_15&#45;&gt;s0_alltoall_15</title>
<path fill="none" stroke="black" d="M95802.17,-305.95C95804.77,-305.95 95807.36,-305.95 95809.96,-305.95"/>
<polygon fill="black" stroke="black" points="95809.97,-309.45 95819.97,-305.95 95809.97,-302.45 95809.97,-309.45"/>
</g>
<!-- s0_ln1_15 -->
<g id="node209" class="node">
<title>s0_ln1_15</title>
<polygon fill="lightblue" stroke="black" points="96734,-332.45 96363,-332.45 96363,-279.45 96734,-279.45 96734,-332.45"/>
<text text-anchor="middle" x="96548.5" y="-317.25" font-family="Times,serif" font-size="14.00">GPU15: LayerNorm (DP3)</text>
<text text-anchor="middle" x="96548.5" y="-302.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="96548.5" y="-287.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_alltoall_15&#45;&gt;s0_ln1_15 -->
<g id="edge240" class="edge">
<title>s0_alltoall_15&#45;&gt;s0_ln1_15</title>
<path fill="none" stroke="black" d="M96345.08,-305.95C96347.69,-305.95 96350.29,-305.95 96352.9,-305.95"/>
<polygon fill="black" stroke="black" points="96352.96,-309.45 96362.96,-305.95 96352.96,-302.45 96352.96,-309.45"/>
</g>
<!-- s1_ln0_31 -->
<g id="node390" class="node">
<title>s1_ln0_31</title>
<polygon fill="lightgreen" stroke="black" points="96734,-190.45 96363,-190.45 96363,-137.45 96734,-137.45 96734,-190.45"/>
<text text-anchor="middle" x="96548.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: LayerNorm (DP3)</text>
<text text-anchor="middle" x="96548.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="96548.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s0_ln1_15&#45;&gt;s1_ln0_31 -->
<g id="edge256" class="edge">
<title>s0_ln1_15&#45;&gt;s1_ln0_31</title>
<path fill="none" stroke="black" d="M96548.5,-279.28C96548.5,-257.17 96548.5,-225.05 96548.5,-200.48"/>
<polygon fill="black" stroke="black" points="96552,-200.47 96548.5,-190.47 96545,-200.47 96552,-200.47"/>
</g>
<!-- s1_q_16 -->
<g id="node211" class="node">
<title>s1_q_16</title>
<polygon fill="lightgreen" stroke="black" points="97123,-190.45 96752,-190.45 96752,-137.45 97123,-137.45 97123,-190.45"/>
<text text-anchor="middle" x="96937.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: Q Linear (TP0)</text>
<text text-anchor="middle" x="96937.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="96937.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_16 -->
<g id="node212" class="node">
<title>s1_k_16</title>
<polygon fill="lightgreen" stroke="black" points="97512,-190.45 97141,-190.45 97141,-137.45 97512,-137.45 97512,-190.45"/>
<text text-anchor="middle" x="97326.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: K Linear (TP0)</text>
<text text-anchor="middle" x="97326.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="97326.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_16 -->
<g id="node213" class="node">
<title>s1_v_16</title>
<polygon fill="lightgreen" stroke="black" points="97901,-190.45 97530,-190.45 97530,-137.45 97901,-137.45 97901,-190.45"/>
<text text-anchor="middle" x="97715.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: V Linear (TP0)</text>
<text text-anchor="middle" x="97715.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="97715.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_16 -->
<g id="node214" class="node">
<title>s1_allgather_q_16</title>
<ellipse fill="white" stroke="black" cx="98181.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="98181.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather Q (TP0)</text>
<text text-anchor="middle" x="98181.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="98181.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_16 -->
<g id="node215" class="node">
<title>s1_allgather_k_16</title>
<ellipse fill="white" stroke="black" cx="98724.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="98724.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather K (TP0)</text>
<text text-anchor="middle" x="98724.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="98724.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_16 -->
<g id="node216" class="node">
<title>s1_allgather_v_16</title>
<ellipse fill="white" stroke="black" cx="99267.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="99267.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: AllGather V (TP0)</text>
<text text-anchor="middle" x="99267.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="99267.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_16 -->
<g id="node217" class="node">
<title>s1_attn_16</title>
<polygon fill="lightgreen" stroke="black" points="99919,-190.45 99548,-190.45 99548,-137.45 99919,-137.45 99919,-190.45"/>
<text text-anchor="middle" x="99733.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: Attention (TP0)</text>
<text text-anchor="middle" x="99733.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="99733.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_16 -->
<g id="node218" class="node">
<title>s1_gate_16</title>
<polygon fill="orange" stroke="black" points="100681.89,-216.95 100089.5,-216.95 99937.11,-110.95 100529.5,-110.95 100681.89,-216.95"/>
<text text-anchor="middle" x="100309.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: MoE Gate</text>
<text text-anchor="middle" x="100309.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="100309.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_16 -->
<g id="node219" class="node">
<title>s1_expert_16</title>
<polygon fill="lightgreen" stroke="black" points="101071,-190.45 100700,-190.45 100700,-137.45 101071,-137.45 101071,-190.45"/>
<text text-anchor="middle" x="100885.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: Expert FFN</text>
<text text-anchor="middle" x="100885.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="100885.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_16 -->
<g id="node220" class="node">
<title>s1_alltoall_16</title>
<ellipse fill="white" stroke="black" cx="101351.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="101351.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: AllToAll</text>
<text text-anchor="middle" x="101351.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="101351.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_16 -->
<g id="node221" class="node">
<title>s1_ln1_16</title>
<polygon fill="lightgreen" stroke="black" points="102003,-190.45 101632,-190.45 101632,-137.45 102003,-137.45 102003,-190.45"/>
<text text-anchor="middle" x="101817.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU16: LayerNorm (DP0)</text>
<text text-anchor="middle" x="101817.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="101817.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- output -->
<g id="node402" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="104734.5" cy="-37.48" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="104734.5" y="-48.78" font-family="Times,serif" font-size="14.00">OUTPUT</text>
<text text-anchor="middle" x="104734.5" y="-33.78" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="104734.5" y="-18.78" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_16&#45;&gt;output -->
<g id="edge257" class="edge">
<title>s1_ln1_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M101896.32,-137.43C101931.48,-127.22 101973.66,-116.57 102012.5,-110.95 102478.72,-43.53 103868.71,-37.16 104461.62,-37.65"/>
<polygon fill="black" stroke="black" points="104462.02,-41.15 104472.02,-37.66 104462.03,-34.15 104462.02,-41.15"/>
</g>
<!-- s1_q_17 -->
<g id="node223" class="node">
<title>s1_q_17</title>
<polygon fill="lightgreen" stroke="black" points="108227,-190.45 107856,-190.45 107856,-137.45 108227,-137.45 108227,-190.45"/>
<text text-anchor="middle" x="108041.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: Q Linear (TP1)</text>
<text text-anchor="middle" x="108041.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="108041.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_17 -->
<g id="node224" class="node">
<title>s1_k_17</title>
<polygon fill="lightgreen" stroke="black" points="108616,-190.45 108245,-190.45 108245,-137.45 108616,-137.45 108616,-190.45"/>
<text text-anchor="middle" x="108430.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: K Linear (TP1)</text>
<text text-anchor="middle" x="108430.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="108430.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_17 -->
<g id="node225" class="node">
<title>s1_v_17</title>
<polygon fill="lightgreen" stroke="black" points="109005,-190.45 108634,-190.45 108634,-137.45 109005,-137.45 109005,-190.45"/>
<text text-anchor="middle" x="108819.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: V Linear (TP1)</text>
<text text-anchor="middle" x="108819.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="108819.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_17 -->
<g id="node226" class="node">
<title>s1_allgather_q_17</title>
<ellipse fill="white" stroke="black" cx="109285.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="109285.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather Q (TP1)</text>
<text text-anchor="middle" x="109285.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="109285.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_17 -->
<g id="node227" class="node">
<title>s1_allgather_k_17</title>
<ellipse fill="white" stroke="black" cx="109828.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="109828.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather K (TP1)</text>
<text text-anchor="middle" x="109828.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="109828.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_17 -->
<g id="node228" class="node">
<title>s1_allgather_v_17</title>
<ellipse fill="white" stroke="black" cx="110371.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="110371.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: AllGather V (TP1)</text>
<text text-anchor="middle" x="110371.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="110371.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_17 -->
<g id="node229" class="node">
<title>s1_attn_17</title>
<polygon fill="lightgreen" stroke="black" points="111023,-190.45 110652,-190.45 110652,-137.45 111023,-137.45 111023,-190.45"/>
<text text-anchor="middle" x="110837.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: Attention (TP1)</text>
<text text-anchor="middle" x="110837.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="110837.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_17 -->
<g id="node230" class="node">
<title>s1_gate_17</title>
<polygon fill="orange" stroke="black" points="111785.89,-216.95 111193.5,-216.95 111041.11,-110.95 111633.5,-110.95 111785.89,-216.95"/>
<text text-anchor="middle" x="111413.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: MoE Gate</text>
<text text-anchor="middle" x="111413.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="111413.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_17 -->
<g id="node231" class="node">
<title>s1_expert_17</title>
<polygon fill="lightgreen" stroke="black" points="112175,-190.45 111804,-190.45 111804,-137.45 112175,-137.45 112175,-190.45"/>
<text text-anchor="middle" x="111989.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: Expert FFN</text>
<text text-anchor="middle" x="111989.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="111989.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_17 -->
<g id="node232" class="node">
<title>s1_alltoall_17</title>
<ellipse fill="white" stroke="black" cx="112455.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="112455.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: AllToAll</text>
<text text-anchor="middle" x="112455.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="112455.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_17 -->
<g id="node233" class="node">
<title>s1_ln1_17</title>
<polygon fill="lightgreen" stroke="black" points="102392,-190.45 102021,-190.45 102021,-137.45 102392,-137.45 102392,-190.45"/>
<text text-anchor="middle" x="102206.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU17: LayerNorm (DP0)</text>
<text text-anchor="middle" x="102206.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="102206.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_17&#45;&gt;output -->
<g id="edge258" class="edge">
<title>s1_ln1_17&#45;&gt;output</title>
<path fill="none" stroke="black" d="M102285.8,-137.38C102320.87,-127.23 102362.85,-116.63 102401.5,-110.95 102791.29,-53.7 103934.9,-41.61 104462.32,-39.1"/>
<polygon fill="black" stroke="black" points="104462.37,-42.6 104472.36,-39.06 104462.34,-35.6 104462.37,-42.6"/>
</g>
<!-- s1_q_18 -->
<g id="node235" class="node">
<title>s1_q_18</title>
<polygon fill="lightgreen" stroke="black" points="113107,-190.45 112736,-190.45 112736,-137.45 113107,-137.45 113107,-190.45"/>
<text text-anchor="middle" x="112921.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: Q Linear (TP2)</text>
<text text-anchor="middle" x="112921.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="112921.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_18 -->
<g id="node236" class="node">
<title>s1_k_18</title>
<polygon fill="lightgreen" stroke="black" points="113496,-190.45 113125,-190.45 113125,-137.45 113496,-137.45 113496,-190.45"/>
<text text-anchor="middle" x="113310.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: K Linear (TP2)</text>
<text text-anchor="middle" x="113310.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="113310.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_18 -->
<g id="node237" class="node">
<title>s1_v_18</title>
<polygon fill="lightgreen" stroke="black" points="113885,-190.45 113514,-190.45 113514,-137.45 113885,-137.45 113885,-190.45"/>
<text text-anchor="middle" x="113699.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: V Linear (TP2)</text>
<text text-anchor="middle" x="113699.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="113699.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_18 -->
<g id="node238" class="node">
<title>s1_allgather_q_18</title>
<ellipse fill="white" stroke="black" cx="114165.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="114165.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather Q (TP2)</text>
<text text-anchor="middle" x="114165.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="114165.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_18 -->
<g id="node239" class="node">
<title>s1_allgather_k_18</title>
<ellipse fill="white" stroke="black" cx="114708.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="114708.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather K (TP2)</text>
<text text-anchor="middle" x="114708.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="114708.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_18 -->
<g id="node240" class="node">
<title>s1_allgather_v_18</title>
<ellipse fill="white" stroke="black" cx="115251.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="115251.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: AllGather V (TP2)</text>
<text text-anchor="middle" x="115251.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="115251.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_18 -->
<g id="node241" class="node">
<title>s1_attn_18</title>
<polygon fill="lightgreen" stroke="black" points="115903,-190.45 115532,-190.45 115532,-137.45 115903,-137.45 115903,-190.45"/>
<text text-anchor="middle" x="115717.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: Attention (TP2)</text>
<text text-anchor="middle" x="115717.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="115717.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_18 -->
<g id="node242" class="node">
<title>s1_gate_18</title>
<polygon fill="orange" stroke="black" points="116665.89,-216.95 116073.5,-216.95 115921.11,-110.95 116513.5,-110.95 116665.89,-216.95"/>
<text text-anchor="middle" x="116293.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: MoE Gate</text>
<text text-anchor="middle" x="116293.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="116293.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_18 -->
<g id="node243" class="node">
<title>s1_expert_18</title>
<polygon fill="lightgreen" stroke="black" points="117055,-190.45 116684,-190.45 116684,-137.45 117055,-137.45 117055,-190.45"/>
<text text-anchor="middle" x="116869.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: Expert FFN</text>
<text text-anchor="middle" x="116869.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="116869.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_18 -->
<g id="node244" class="node">
<title>s1_alltoall_18</title>
<ellipse fill="white" stroke="black" cx="117335.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="117335.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: AllToAll</text>
<text text-anchor="middle" x="117335.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="117335.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_18 -->
<g id="node245" class="node">
<title>s1_ln1_18</title>
<polygon fill="lightgreen" stroke="black" points="102781,-190.45 102410,-190.45 102410,-137.45 102781,-137.45 102781,-190.45"/>
<text text-anchor="middle" x="102595.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU18: LayerNorm (DP0)</text>
<text text-anchor="middle" x="102595.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="102595.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_18&#45;&gt;output -->
<g id="edge259" class="edge">
<title>s1_ln1_18&#45;&gt;output</title>
<path fill="none" stroke="black" d="M102675.29,-137.36C102710.27,-127.27 102752.04,-116.72 102790.5,-110.95 103104.64,-63.82 104006.78,-46.82 104463.15,-41.12"/>
<polygon fill="black" stroke="black" points="104463.22,-44.62 104473.18,-41 104463.14,-37.62 104463.22,-44.62"/>
</g>
<!-- s1_q_19 -->
<g id="node247" class="node">
<title>s1_q_19</title>
<polygon fill="lightgreen" stroke="black" points="117987,-190.45 117616,-190.45 117616,-137.45 117987,-137.45 117987,-190.45"/>
<text text-anchor="middle" x="117801.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: Q Linear (TP3)</text>
<text text-anchor="middle" x="117801.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="117801.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_19 -->
<g id="node248" class="node">
<title>s1_k_19</title>
<polygon fill="lightgreen" stroke="black" points="118376,-190.45 118005,-190.45 118005,-137.45 118376,-137.45 118376,-190.45"/>
<text text-anchor="middle" x="118190.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: K Linear (TP3)</text>
<text text-anchor="middle" x="118190.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="118190.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_19 -->
<g id="node249" class="node">
<title>s1_v_19</title>
<polygon fill="lightgreen" stroke="black" points="118765,-190.45 118394,-190.45 118394,-137.45 118765,-137.45 118765,-190.45"/>
<text text-anchor="middle" x="118579.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: V Linear (TP3)</text>
<text text-anchor="middle" x="118579.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="118579.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_19 -->
<g id="node250" class="node">
<title>s1_allgather_q_19</title>
<ellipse fill="white" stroke="black" cx="119045.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="119045.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather Q (TP3)</text>
<text text-anchor="middle" x="119045.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="119045.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_19 -->
<g id="node251" class="node">
<title>s1_allgather_k_19</title>
<ellipse fill="white" stroke="black" cx="119588.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="119588.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather K (TP3)</text>
<text text-anchor="middle" x="119588.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="119588.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_19 -->
<g id="node252" class="node">
<title>s1_allgather_v_19</title>
<ellipse fill="white" stroke="black" cx="120131.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="120131.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: AllGather V (TP3)</text>
<text text-anchor="middle" x="120131.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="120131.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_19 -->
<g id="node253" class="node">
<title>s1_attn_19</title>
<polygon fill="lightgreen" stroke="black" points="120783,-190.45 120412,-190.45 120412,-137.45 120783,-137.45 120783,-190.45"/>
<text text-anchor="middle" x="120597.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: Attention (TP3)</text>
<text text-anchor="middle" x="120597.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="120597.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_19 -->
<g id="node254" class="node">
<title>s1_gate_19</title>
<polygon fill="orange" stroke="black" points="121545.89,-216.95 120953.5,-216.95 120801.11,-110.95 121393.5,-110.95 121545.89,-216.95"/>
<text text-anchor="middle" x="121173.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: MoE Gate</text>
<text text-anchor="middle" x="121173.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="121173.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_19 -->
<g id="node255" class="node">
<title>s1_expert_19</title>
<polygon fill="lightgreen" stroke="black" points="121935,-190.45 121564,-190.45 121564,-137.45 121935,-137.45 121935,-190.45"/>
<text text-anchor="middle" x="121749.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: Expert FFN</text>
<text text-anchor="middle" x="121749.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="121749.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_19 -->
<g id="node256" class="node">
<title>s1_alltoall_19</title>
<ellipse fill="white" stroke="black" cx="122215.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="122215.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: AllToAll</text>
<text text-anchor="middle" x="122215.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="122215.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_19 -->
<g id="node257" class="node">
<title>s1_ln1_19</title>
<polygon fill="lightgreen" stroke="black" points="103170,-190.45 102799,-190.45 102799,-137.45 103170,-137.45 103170,-190.45"/>
<text text-anchor="middle" x="102984.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU19: LayerNorm (DP0)</text>
<text text-anchor="middle" x="102984.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="102984.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_19&#45;&gt;output -->
<g id="edge260" class="edge">
<title>s1_ln1_19&#45;&gt;output</title>
<path fill="none" stroke="black" d="M103064.79,-137.39C103099.68,-127.37 103141.24,-116.88 103179.5,-110.95 103419.27,-73.84 104087.64,-53.13 104465.45,-44.08"/>
<polygon fill="black" stroke="black" points="104465.79,-47.57 104475.71,-43.83 104465.63,-40.57 104465.79,-47.57"/>
</g>
<!-- s1_q_20 -->
<g id="node259" class="node">
<title>s1_q_20</title>
<polygon fill="lightgreen" stroke="black" points="122867,-190.45 122496,-190.45 122496,-137.45 122867,-137.45 122867,-190.45"/>
<text text-anchor="middle" x="122681.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: Q Linear (TP0)</text>
<text text-anchor="middle" x="122681.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="122681.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_20 -->
<g id="node260" class="node">
<title>s1_k_20</title>
<polygon fill="lightgreen" stroke="black" points="123256,-190.45 122885,-190.45 122885,-137.45 123256,-137.45 123256,-190.45"/>
<text text-anchor="middle" x="123070.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: K Linear (TP0)</text>
<text text-anchor="middle" x="123070.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="123070.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_20 -->
<g id="node261" class="node">
<title>s1_v_20</title>
<polygon fill="lightgreen" stroke="black" points="123645,-190.45 123274,-190.45 123274,-137.45 123645,-137.45 123645,-190.45"/>
<text text-anchor="middle" x="123459.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: V Linear (TP0)</text>
<text text-anchor="middle" x="123459.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="123459.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_20 -->
<g id="node262" class="node">
<title>s1_allgather_q_20</title>
<ellipse fill="white" stroke="black" cx="123925.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="123925.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather Q (TP0)</text>
<text text-anchor="middle" x="123925.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="123925.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_20 -->
<g id="node263" class="node">
<title>s1_allgather_k_20</title>
<ellipse fill="white" stroke="black" cx="124468.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="124468.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather K (TP0)</text>
<text text-anchor="middle" x="124468.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="124468.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_20 -->
<g id="node264" class="node">
<title>s1_allgather_v_20</title>
<ellipse fill="white" stroke="black" cx="125011.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="125011.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: AllGather V (TP0)</text>
<text text-anchor="middle" x="125011.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="125011.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_20 -->
<g id="node265" class="node">
<title>s1_attn_20</title>
<polygon fill="lightgreen" stroke="black" points="125663,-190.45 125292,-190.45 125292,-137.45 125663,-137.45 125663,-190.45"/>
<text text-anchor="middle" x="125477.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: Attention (TP0)</text>
<text text-anchor="middle" x="125477.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="125477.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_20 -->
<g id="node266" class="node">
<title>s1_gate_20</title>
<polygon fill="orange" stroke="black" points="126425.89,-216.95 125833.5,-216.95 125681.11,-110.95 126273.5,-110.95 126425.89,-216.95"/>
<text text-anchor="middle" x="126053.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: MoE Gate</text>
<text text-anchor="middle" x="126053.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="126053.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_20 -->
<g id="node267" class="node">
<title>s1_expert_20</title>
<polygon fill="lightgreen" stroke="black" points="126815,-190.45 126444,-190.45 126444,-137.45 126815,-137.45 126815,-190.45"/>
<text text-anchor="middle" x="126629.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: Expert FFN</text>
<text text-anchor="middle" x="126629.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="126629.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_20 -->
<g id="node268" class="node">
<title>s1_alltoall_20</title>
<ellipse fill="white" stroke="black" cx="127095.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="127095.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: AllToAll</text>
<text text-anchor="middle" x="127095.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="127095.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_20 -->
<g id="node269" class="node">
<title>s1_ln1_20</title>
<polygon fill="lightgreen" stroke="black" points="103559,-190.45 103188,-190.45 103188,-137.45 103559,-137.45 103559,-190.45"/>
<text text-anchor="middle" x="103373.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU20: LayerNorm (DP1)</text>
<text text-anchor="middle" x="103373.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="103373.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_20&#45;&gt;output -->
<g id="edge261" class="edge">
<title>s1_ln1_20&#45;&gt;output</title>
<path fill="none" stroke="black" d="M103454.79,-137.41C103489.48,-127.52 103530.63,-117.12 103568.5,-110.95 103872.05,-61.55 104225.09,-45.24 104462.49,-40.16"/>
<polygon fill="black" stroke="black" points="104462.72,-43.65 104472.65,-39.95 104462.58,-36.66 104462.72,-43.65"/>
</g>
<!-- s1_q_21 -->
<g id="node271" class="node">
<title>s1_q_21</title>
<polygon fill="lightgreen" stroke="black" points="127747,-190.45 127376,-190.45 127376,-137.45 127747,-137.45 127747,-190.45"/>
<text text-anchor="middle" x="127561.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: Q Linear (TP1)</text>
<text text-anchor="middle" x="127561.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="127561.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_21 -->
<g id="node272" class="node">
<title>s1_k_21</title>
<polygon fill="lightgreen" stroke="black" points="128136,-190.45 127765,-190.45 127765,-137.45 128136,-137.45 128136,-190.45"/>
<text text-anchor="middle" x="127950.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: K Linear (TP1)</text>
<text text-anchor="middle" x="127950.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="127950.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_21 -->
<g id="node273" class="node">
<title>s1_v_21</title>
<polygon fill="lightgreen" stroke="black" points="128525,-190.45 128154,-190.45 128154,-137.45 128525,-137.45 128525,-190.45"/>
<text text-anchor="middle" x="128339.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: V Linear (TP1)</text>
<text text-anchor="middle" x="128339.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="128339.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_21 -->
<g id="node274" class="node">
<title>s1_allgather_q_21</title>
<ellipse fill="white" stroke="black" cx="128805.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="128805.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather Q (TP1)</text>
<text text-anchor="middle" x="128805.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="128805.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_21 -->
<g id="node275" class="node">
<title>s1_allgather_k_21</title>
<ellipse fill="white" stroke="black" cx="129348.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="129348.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather K (TP1)</text>
<text text-anchor="middle" x="129348.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="129348.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_21 -->
<g id="node276" class="node">
<title>s1_allgather_v_21</title>
<ellipse fill="white" stroke="black" cx="129891.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="129891.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: AllGather V (TP1)</text>
<text text-anchor="middle" x="129891.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="129891.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_21 -->
<g id="node277" class="node">
<title>s1_attn_21</title>
<polygon fill="lightgreen" stroke="black" points="130543,-190.45 130172,-190.45 130172,-137.45 130543,-137.45 130543,-190.45"/>
<text text-anchor="middle" x="130357.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: Attention (TP1)</text>
<text text-anchor="middle" x="130357.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="130357.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_21 -->
<g id="node278" class="node">
<title>s1_gate_21</title>
<polygon fill="orange" stroke="black" points="131305.89,-216.95 130713.5,-216.95 130561.11,-110.95 131153.5,-110.95 131305.89,-216.95"/>
<text text-anchor="middle" x="130933.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: MoE Gate</text>
<text text-anchor="middle" x="130933.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="130933.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_21 -->
<g id="node279" class="node">
<title>s1_expert_21</title>
<polygon fill="lightgreen" stroke="black" points="131695,-190.45 131324,-190.45 131324,-137.45 131695,-137.45 131695,-190.45"/>
<text text-anchor="middle" x="131509.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: Expert FFN</text>
<text text-anchor="middle" x="131509.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="131509.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_21 -->
<g id="node280" class="node">
<title>s1_alltoall_21</title>
<ellipse fill="white" stroke="black" cx="131975.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="131975.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: AllToAll</text>
<text text-anchor="middle" x="131975.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="131975.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_21 -->
<g id="node281" class="node">
<title>s1_ln1_21</title>
<polygon fill="lightgreen" stroke="black" points="103948,-190.45 103577,-190.45 103577,-137.45 103948,-137.45 103948,-190.45"/>
<text text-anchor="middle" x="103762.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU21: LayerNorm (DP1)</text>
<text text-anchor="middle" x="103762.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="103762.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_21&#45;&gt;output -->
<g id="edge262" class="edge">
<title>s1_ln1_21&#45;&gt;output</title>
<path fill="none" stroke="black" d="M103845.79,-137.45C103880.1,-127.81 103920.42,-117.58 103957.5,-110.95 104129.92,-80.15 104326.35,-61.97 104478.57,-51.53"/>
<polygon fill="black" stroke="black" points="104479.25,-54.99 104488.99,-50.82 104478.77,-48 104479.25,-54.99"/>
</g>
<!-- s1_q_22 -->
<g id="node283" class="node">
<title>s1_q_22</title>
<polygon fill="lightgreen" stroke="black" points="132627,-190.45 132256,-190.45 132256,-137.45 132627,-137.45 132627,-190.45"/>
<text text-anchor="middle" x="132441.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: Q Linear (TP2)</text>
<text text-anchor="middle" x="132441.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="132441.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_22 -->
<g id="node284" class="node">
<title>s1_k_22</title>
<polygon fill="lightgreen" stroke="black" points="133016,-190.45 132645,-190.45 132645,-137.45 133016,-137.45 133016,-190.45"/>
<text text-anchor="middle" x="132830.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: K Linear (TP2)</text>
<text text-anchor="middle" x="132830.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="132830.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_22 -->
<g id="node285" class="node">
<title>s1_v_22</title>
<polygon fill="lightgreen" stroke="black" points="133405,-190.45 133034,-190.45 133034,-137.45 133405,-137.45 133405,-190.45"/>
<text text-anchor="middle" x="133219.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: V Linear (TP2)</text>
<text text-anchor="middle" x="133219.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="133219.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_22 -->
<g id="node286" class="node">
<title>s1_allgather_q_22</title>
<ellipse fill="white" stroke="black" cx="133685.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="133685.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather Q (TP2)</text>
<text text-anchor="middle" x="133685.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="133685.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_22 -->
<g id="node287" class="node">
<title>s1_allgather_k_22</title>
<ellipse fill="white" stroke="black" cx="134228.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="134228.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather K (TP2)</text>
<text text-anchor="middle" x="134228.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="134228.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_22 -->
<g id="node288" class="node">
<title>s1_allgather_v_22</title>
<ellipse fill="white" stroke="black" cx="134771.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="134771.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: AllGather V (TP2)</text>
<text text-anchor="middle" x="134771.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="134771.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_22 -->
<g id="node289" class="node">
<title>s1_attn_22</title>
<polygon fill="lightgreen" stroke="black" points="135423,-190.45 135052,-190.45 135052,-137.45 135423,-137.45 135423,-190.45"/>
<text text-anchor="middle" x="135237.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: Attention (TP2)</text>
<text text-anchor="middle" x="135237.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="135237.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_22 -->
<g id="node290" class="node">
<title>s1_gate_22</title>
<polygon fill="orange" stroke="black" points="136185.89,-216.95 135593.5,-216.95 135441.11,-110.95 136033.5,-110.95 136185.89,-216.95"/>
<text text-anchor="middle" x="135813.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: MoE Gate</text>
<text text-anchor="middle" x="135813.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="135813.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_22 -->
<g id="node291" class="node">
<title>s1_expert_22</title>
<polygon fill="lightgreen" stroke="black" points="136575,-190.45 136204,-190.45 136204,-137.45 136575,-137.45 136575,-190.45"/>
<text text-anchor="middle" x="136389.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: Expert FFN</text>
<text text-anchor="middle" x="136389.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="136389.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_22 -->
<g id="node292" class="node">
<title>s1_alltoall_22</title>
<ellipse fill="white" stroke="black" cx="136855.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="136855.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: AllToAll</text>
<text text-anchor="middle" x="136855.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="136855.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_22 -->
<g id="node293" class="node">
<title>s1_ln1_22</title>
<polygon fill="lightgreen" stroke="black" points="104337,-190.45 103966,-190.45 103966,-137.45 104337,-137.45 104337,-190.45"/>
<text text-anchor="middle" x="104151.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU22: LayerNorm (DP1)</text>
<text text-anchor="middle" x="104151.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="104151.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_22&#45;&gt;output -->
<g id="edge263" class="edge">
<title>s1_ln1_22&#45;&gt;output</title>
<path fill="none" stroke="black" d="M104241.43,-137.44C104274.35,-128.51 104311.99,-118.77 104346.5,-110.95 104415.48,-95.34 104491.89,-80.53 104558.55,-68.43"/>
<polygon fill="black" stroke="black" points="104559.51,-71.81 104568.73,-66.58 104558.27,-64.92 104559.51,-71.81"/>
</g>
<!-- s1_q_23 -->
<g id="node295" class="node">
<title>s1_q_23</title>
<polygon fill="lightgreen" stroke="black" points="137507,-190.45 137136,-190.45 137136,-137.45 137507,-137.45 137507,-190.45"/>
<text text-anchor="middle" x="137321.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: Q Linear (TP3)</text>
<text text-anchor="middle" x="137321.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="137321.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_23 -->
<g id="node296" class="node">
<title>s1_k_23</title>
<polygon fill="lightgreen" stroke="black" points="137896,-190.45 137525,-190.45 137525,-137.45 137896,-137.45 137896,-190.45"/>
<text text-anchor="middle" x="137710.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: K Linear (TP3)</text>
<text text-anchor="middle" x="137710.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="137710.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_23 -->
<g id="node297" class="node">
<title>s1_v_23</title>
<polygon fill="lightgreen" stroke="black" points="138285,-190.45 137914,-190.45 137914,-137.45 138285,-137.45 138285,-190.45"/>
<text text-anchor="middle" x="138099.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: V Linear (TP3)</text>
<text text-anchor="middle" x="138099.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="138099.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_23 -->
<g id="node298" class="node">
<title>s1_allgather_q_23</title>
<ellipse fill="white" stroke="black" cx="138565.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="138565.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather Q (TP3)</text>
<text text-anchor="middle" x="138565.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="138565.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_23 -->
<g id="node299" class="node">
<title>s1_allgather_k_23</title>
<ellipse fill="white" stroke="black" cx="139108.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="139108.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather K (TP3)</text>
<text text-anchor="middle" x="139108.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="139108.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_23 -->
<g id="node300" class="node">
<title>s1_allgather_v_23</title>
<ellipse fill="white" stroke="black" cx="139651.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="139651.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: AllGather V (TP3)</text>
<text text-anchor="middle" x="139651.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="139651.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_23 -->
<g id="node301" class="node">
<title>s1_attn_23</title>
<polygon fill="lightgreen" stroke="black" points="140303,-190.45 139932,-190.45 139932,-137.45 140303,-137.45 140303,-190.45"/>
<text text-anchor="middle" x="140117.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: Attention (TP3)</text>
<text text-anchor="middle" x="140117.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="140117.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_23 -->
<g id="node302" class="node">
<title>s1_gate_23</title>
<polygon fill="orange" stroke="black" points="141065.89,-216.95 140473.5,-216.95 140321.11,-110.95 140913.5,-110.95 141065.89,-216.95"/>
<text text-anchor="middle" x="140693.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: MoE Gate</text>
<text text-anchor="middle" x="140693.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="140693.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_23 -->
<g id="node303" class="node">
<title>s1_expert_23</title>
<polygon fill="lightgreen" stroke="black" points="141455,-190.45 141084,-190.45 141084,-137.45 141455,-137.45 141455,-190.45"/>
<text text-anchor="middle" x="141269.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: Expert FFN</text>
<text text-anchor="middle" x="141269.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="141269.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_23 -->
<g id="node304" class="node">
<title>s1_alltoall_23</title>
<ellipse fill="white" stroke="black" cx="141735.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="141735.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: AllToAll</text>
<text text-anchor="middle" x="141735.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="141735.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_23 -->
<g id="node305" class="node">
<title>s1_ln1_23</title>
<polygon fill="lightgreen" stroke="black" points="104726,-190.45 104355,-190.45 104355,-137.45 104726,-137.45 104726,-190.45"/>
<text text-anchor="middle" x="104540.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU23: LayerNorm (DP1)</text>
<text text-anchor="middle" x="104540.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="104540.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_23&#45;&gt;output -->
<g id="edge264" class="edge">
<title>s1_ln1_23&#45;&gt;output</title>
<path fill="none" stroke="black" d="M104580.7,-137.16C104606.56,-120.57 104640.73,-98.64 104670.3,-79.67"/>
<polygon fill="black" stroke="black" points="104672.38,-82.49 104678.91,-74.15 104668.6,-76.6 104672.38,-82.49"/>
</g>
<!-- s1_q_24 -->
<g id="node307" class="node">
<title>s1_q_24</title>
<polygon fill="lightgreen" stroke="black" points="142387,-190.45 142016,-190.45 142016,-137.45 142387,-137.45 142387,-190.45"/>
<text text-anchor="middle" x="142201.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Q Linear (TP0)</text>
<text text-anchor="middle" x="142201.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="142201.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_24 -->
<g id="node308" class="node">
<title>s1_k_24</title>
<polygon fill="lightgreen" stroke="black" points="142776,-190.45 142405,-190.45 142405,-137.45 142776,-137.45 142776,-190.45"/>
<text text-anchor="middle" x="142590.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: K Linear (TP0)</text>
<text text-anchor="middle" x="142590.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="142590.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_24 -->
<g id="node309" class="node">
<title>s1_v_24</title>
<polygon fill="lightgreen" stroke="black" points="143165,-190.45 142794,-190.45 142794,-137.45 143165,-137.45 143165,-190.45"/>
<text text-anchor="middle" x="142979.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: V Linear (TP0)</text>
<text text-anchor="middle" x="142979.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="142979.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_24 -->
<g id="node310" class="node">
<title>s1_allgather_q_24</title>
<ellipse fill="white" stroke="black" cx="143445.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="143445.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather Q (TP0)</text>
<text text-anchor="middle" x="143445.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="143445.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_24 -->
<g id="node311" class="node">
<title>s1_allgather_k_24</title>
<ellipse fill="white" stroke="black" cx="143988.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="143988.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather K (TP0)</text>
<text text-anchor="middle" x="143988.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="143988.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_24 -->
<g id="node312" class="node">
<title>s1_allgather_v_24</title>
<ellipse fill="white" stroke="black" cx="144531.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="144531.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllGather V (TP0)</text>
<text text-anchor="middle" x="144531.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="144531.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_24 -->
<g id="node313" class="node">
<title>s1_attn_24</title>
<polygon fill="lightgreen" stroke="black" points="145183,-190.45 144812,-190.45 144812,-137.45 145183,-137.45 145183,-190.45"/>
<text text-anchor="middle" x="144997.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Attention (TP0)</text>
<text text-anchor="middle" x="144997.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="144997.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_24 -->
<g id="node314" class="node">
<title>s1_gate_24</title>
<polygon fill="orange" stroke="black" points="145945.89,-216.95 145353.5,-216.95 145201.11,-110.95 145793.5,-110.95 145945.89,-216.95"/>
<text text-anchor="middle" x="145573.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: MoE Gate</text>
<text text-anchor="middle" x="145573.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="145573.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_24 -->
<g id="node315" class="node">
<title>s1_expert_24</title>
<polygon fill="lightgreen" stroke="black" points="146335,-190.45 145964,-190.45 145964,-137.45 146335,-137.45 146335,-190.45"/>
<text text-anchor="middle" x="146149.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: Expert FFN</text>
<text text-anchor="middle" x="146149.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="146149.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_24 -->
<g id="node316" class="node">
<title>s1_alltoall_24</title>
<ellipse fill="white" stroke="black" cx="146615.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="146615.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: AllToAll</text>
<text text-anchor="middle" x="146615.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="146615.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_24 -->
<g id="node317" class="node">
<title>s1_ln1_24</title>
<polygon fill="lightgreen" stroke="black" points="105115,-190.45 104744,-190.45 104744,-137.45 105115,-137.45 105115,-190.45"/>
<text text-anchor="middle" x="104929.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU24: LayerNorm (DP2)</text>
<text text-anchor="middle" x="104929.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="104929.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_24&#45;&gt;output -->
<g id="edge265" class="edge">
<title>s1_ln1_24&#45;&gt;output</title>
<path fill="none" stroke="black" d="M104889.1,-137.16C104863.1,-120.57 104828.75,-98.64 104799.03,-79.67"/>
<polygon fill="black" stroke="black" points="104800.69,-76.58 104790.38,-74.15 104796.93,-82.48 104800.69,-76.58"/>
</g>
<!-- s1_q_25 -->
<g id="node319" class="node">
<title>s1_q_25</title>
<polygon fill="lightgreen" stroke="black" points="147267,-190.45 146896,-190.45 146896,-137.45 147267,-137.45 147267,-190.45"/>
<text text-anchor="middle" x="147081.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Q Linear (TP1)</text>
<text text-anchor="middle" x="147081.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="147081.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_25 -->
<g id="node320" class="node">
<title>s1_k_25</title>
<polygon fill="lightgreen" stroke="black" points="147656,-190.45 147285,-190.45 147285,-137.45 147656,-137.45 147656,-190.45"/>
<text text-anchor="middle" x="147470.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: K Linear (TP1)</text>
<text text-anchor="middle" x="147470.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="147470.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_25 -->
<g id="node321" class="node">
<title>s1_v_25</title>
<polygon fill="lightgreen" stroke="black" points="148045,-190.45 147674,-190.45 147674,-137.45 148045,-137.45 148045,-190.45"/>
<text text-anchor="middle" x="147859.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: V Linear (TP1)</text>
<text text-anchor="middle" x="147859.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="147859.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_25 -->
<g id="node322" class="node">
<title>s1_allgather_q_25</title>
<ellipse fill="white" stroke="black" cx="148325.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="148325.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather Q (TP1)</text>
<text text-anchor="middle" x="148325.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="148325.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_25 -->
<g id="node323" class="node">
<title>s1_allgather_k_25</title>
<ellipse fill="white" stroke="black" cx="148868.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="148868.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather K (TP1)</text>
<text text-anchor="middle" x="148868.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="148868.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_25 -->
<g id="node324" class="node">
<title>s1_allgather_v_25</title>
<ellipse fill="white" stroke="black" cx="149411.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="149411.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllGather V (TP1)</text>
<text text-anchor="middle" x="149411.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="149411.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_25 -->
<g id="node325" class="node">
<title>s1_attn_25</title>
<polygon fill="lightgreen" stroke="black" points="150063,-190.45 149692,-190.45 149692,-137.45 150063,-137.45 150063,-190.45"/>
<text text-anchor="middle" x="149877.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Attention (TP1)</text>
<text text-anchor="middle" x="149877.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="149877.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_25 -->
<g id="node326" class="node">
<title>s1_gate_25</title>
<polygon fill="orange" stroke="black" points="150825.89,-216.95 150233.5,-216.95 150081.11,-110.95 150673.5,-110.95 150825.89,-216.95"/>
<text text-anchor="middle" x="150453.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: MoE Gate</text>
<text text-anchor="middle" x="150453.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="150453.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_25 -->
<g id="node327" class="node">
<title>s1_expert_25</title>
<polygon fill="lightgreen" stroke="black" points="151215,-190.45 150844,-190.45 150844,-137.45 151215,-137.45 151215,-190.45"/>
<text text-anchor="middle" x="151029.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: Expert FFN</text>
<text text-anchor="middle" x="151029.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="151029.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_25 -->
<g id="node328" class="node">
<title>s1_alltoall_25</title>
<ellipse fill="white" stroke="black" cx="151495.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="151495.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: AllToAll</text>
<text text-anchor="middle" x="151495.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="151495.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_25 -->
<g id="node329" class="node">
<title>s1_ln1_25</title>
<polygon fill="lightgreen" stroke="black" points="105504,-190.45 105133,-190.45 105133,-137.45 105504,-137.45 105504,-190.45"/>
<text text-anchor="middle" x="105318.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU25: LayerNorm (DP2)</text>
<text text-anchor="middle" x="105318.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="105318.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_25&#45;&gt;output -->
<g id="edge266" class="edge">
<title>s1_ln1_25&#45;&gt;output</title>
<path fill="none" stroke="black" d="M105229.04,-137.41C105196.29,-128.47 105158.85,-118.74 105124.5,-110.95 105055.18,-95.25 104978.37,-80.43 104911.38,-68.33"/>
<polygon fill="black" stroke="black" points="104911.6,-64.81 104901.14,-66.49 104910.36,-71.7 104911.6,-64.81"/>
</g>
<!-- s1_q_26 -->
<g id="node331" class="node">
<title>s1_q_26</title>
<polygon fill="lightgreen" stroke="black" points="152147,-190.45 151776,-190.45 151776,-137.45 152147,-137.45 152147,-190.45"/>
<text text-anchor="middle" x="151961.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Q Linear (TP2)</text>
<text text-anchor="middle" x="151961.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="151961.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_26 -->
<g id="node332" class="node">
<title>s1_k_26</title>
<polygon fill="lightgreen" stroke="black" points="152536,-190.45 152165,-190.45 152165,-137.45 152536,-137.45 152536,-190.45"/>
<text text-anchor="middle" x="152350.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: K Linear (TP2)</text>
<text text-anchor="middle" x="152350.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="152350.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_26 -->
<g id="node333" class="node">
<title>s1_v_26</title>
<polygon fill="lightgreen" stroke="black" points="152925,-190.45 152554,-190.45 152554,-137.45 152925,-137.45 152925,-190.45"/>
<text text-anchor="middle" x="152739.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: V Linear (TP2)</text>
<text text-anchor="middle" x="152739.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="152739.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_26 -->
<g id="node334" class="node">
<title>s1_allgather_q_26</title>
<ellipse fill="white" stroke="black" cx="153205.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="153205.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather Q (TP2)</text>
<text text-anchor="middle" x="153205.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="153205.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_26 -->
<g id="node335" class="node">
<title>s1_allgather_k_26</title>
<ellipse fill="white" stroke="black" cx="153748.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="153748.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather K (TP2)</text>
<text text-anchor="middle" x="153748.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="153748.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_26 -->
<g id="node336" class="node">
<title>s1_allgather_v_26</title>
<ellipse fill="white" stroke="black" cx="154291.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="154291.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllGather V (TP2)</text>
<text text-anchor="middle" x="154291.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="154291.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_26 -->
<g id="node337" class="node">
<title>s1_attn_26</title>
<polygon fill="lightgreen" stroke="black" points="154943,-190.45 154572,-190.45 154572,-137.45 154943,-137.45 154943,-190.45"/>
<text text-anchor="middle" x="154757.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Attention (TP2)</text>
<text text-anchor="middle" x="154757.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="154757.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_26 -->
<g id="node338" class="node">
<title>s1_gate_26</title>
<polygon fill="orange" stroke="black" points="155705.89,-216.95 155113.5,-216.95 154961.11,-110.95 155553.5,-110.95 155705.89,-216.95"/>
<text text-anchor="middle" x="155333.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: MoE Gate</text>
<text text-anchor="middle" x="155333.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="155333.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_26 -->
<g id="node339" class="node">
<title>s1_expert_26</title>
<polygon fill="lightgreen" stroke="black" points="156095,-190.45 155724,-190.45 155724,-137.45 156095,-137.45 156095,-190.45"/>
<text text-anchor="middle" x="155909.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: Expert FFN</text>
<text text-anchor="middle" x="155909.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="155909.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_26 -->
<g id="node340" class="node">
<title>s1_alltoall_26</title>
<ellipse fill="white" stroke="black" cx="156375.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="156375.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: AllToAll</text>
<text text-anchor="middle" x="156375.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="156375.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_26 -->
<g id="node341" class="node">
<title>s1_ln1_26</title>
<polygon fill="lightgreen" stroke="black" points="105893,-190.45 105522,-190.45 105522,-137.45 105893,-137.45 105893,-190.45"/>
<text text-anchor="middle" x="105707.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU26: LayerNorm (DP2)</text>
<text text-anchor="middle" x="105707.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="105707.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_26&#45;&gt;output -->
<g id="edge267" class="edge">
<title>s1_ln1_26&#45;&gt;output</title>
<path fill="none" stroke="black" d="M105624.64,-137.44C105590.52,-127.79 105550.4,-117.57 105513.5,-110.95 105340.32,-79.92 105142.96,-61.73 104990.22,-51.34"/>
<polygon fill="black" stroke="black" points="104990.43,-47.85 104980.22,-50.67 104989.96,-54.83 104990.43,-47.85"/>
</g>
<!-- s1_q_27 -->
<g id="node343" class="node">
<title>s1_q_27</title>
<polygon fill="lightgreen" stroke="black" points="157027,-190.45 156656,-190.45 156656,-137.45 157027,-137.45 157027,-190.45"/>
<text text-anchor="middle" x="156841.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Q Linear (TP3)</text>
<text text-anchor="middle" x="156841.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="156841.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_27 -->
<g id="node344" class="node">
<title>s1_k_27</title>
<polygon fill="lightgreen" stroke="black" points="157416,-190.45 157045,-190.45 157045,-137.45 157416,-137.45 157416,-190.45"/>
<text text-anchor="middle" x="157230.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: K Linear (TP3)</text>
<text text-anchor="middle" x="157230.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="157230.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_27 -->
<g id="node345" class="node">
<title>s1_v_27</title>
<polygon fill="lightgreen" stroke="black" points="157805,-190.45 157434,-190.45 157434,-137.45 157805,-137.45 157805,-190.45"/>
<text text-anchor="middle" x="157619.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: V Linear (TP3)</text>
<text text-anchor="middle" x="157619.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="157619.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_27 -->
<g id="node346" class="node">
<title>s1_allgather_q_27</title>
<ellipse fill="white" stroke="black" cx="158085.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="158085.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather Q (TP3)</text>
<text text-anchor="middle" x="158085.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="158085.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_27 -->
<g id="node347" class="node">
<title>s1_allgather_k_27</title>
<ellipse fill="white" stroke="black" cx="158628.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="158628.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather K (TP3)</text>
<text text-anchor="middle" x="158628.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="158628.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_27 -->
<g id="node348" class="node">
<title>s1_allgather_v_27</title>
<ellipse fill="white" stroke="black" cx="159171.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="159171.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllGather V (TP3)</text>
<text text-anchor="middle" x="159171.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="159171.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_27 -->
<g id="node349" class="node">
<title>s1_attn_27</title>
<polygon fill="lightgreen" stroke="black" points="159823,-190.45 159452,-190.45 159452,-137.45 159823,-137.45 159823,-190.45"/>
<text text-anchor="middle" x="159637.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Attention (TP3)</text>
<text text-anchor="middle" x="159637.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="159637.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_27 -->
<g id="node350" class="node">
<title>s1_gate_27</title>
<polygon fill="orange" stroke="black" points="160585.89,-216.95 159993.5,-216.95 159841.11,-110.95 160433.5,-110.95 160585.89,-216.95"/>
<text text-anchor="middle" x="160213.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: MoE Gate</text>
<text text-anchor="middle" x="160213.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="160213.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_27 -->
<g id="node351" class="node">
<title>s1_expert_27</title>
<polygon fill="lightgreen" stroke="black" points="160975,-190.45 160604,-190.45 160604,-137.45 160975,-137.45 160975,-190.45"/>
<text text-anchor="middle" x="160789.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: Expert FFN</text>
<text text-anchor="middle" x="160789.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="160789.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_27 -->
<g id="node352" class="node">
<title>s1_alltoall_27</title>
<ellipse fill="white" stroke="black" cx="161255.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="161255.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: AllToAll</text>
<text text-anchor="middle" x="161255.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="161255.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_27 -->
<g id="node353" class="node">
<title>s1_ln1_27</title>
<polygon fill="lightgreen" stroke="black" points="106282,-190.45 105911,-190.45 105911,-137.45 106282,-137.45 106282,-190.45"/>
<text text-anchor="middle" x="106096.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU27: LayerNorm (DP2)</text>
<text text-anchor="middle" x="106096.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="106096.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_27&#45;&gt;output -->
<g id="edge268" class="edge">
<title>s1_ln1_27&#45;&gt;output</title>
<path fill="none" stroke="black" d="M106015.64,-137.4C105981.12,-127.51 105940.18,-117.11 105902.5,-110.95 105598.33,-61.27 105244.52,-45.01 105006.7,-40.02"/>
<polygon fill="black" stroke="black" points="105006.6,-36.52 104996.53,-39.81 105006.45,-43.52 105006.6,-36.52"/>
</g>
<!-- s1_q_28 -->
<g id="node355" class="node">
<title>s1_q_28</title>
<polygon fill="lightgreen" stroke="black" points="161907,-190.45 161536,-190.45 161536,-137.45 161907,-137.45 161907,-190.45"/>
<text text-anchor="middle" x="161721.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Q Linear (TP0)</text>
<text text-anchor="middle" x="161721.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="161721.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_28 -->
<g id="node356" class="node">
<title>s1_k_28</title>
<polygon fill="lightgreen" stroke="black" points="162296,-190.45 161925,-190.45 161925,-137.45 162296,-137.45 162296,-190.45"/>
<text text-anchor="middle" x="162110.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: K Linear (TP0)</text>
<text text-anchor="middle" x="162110.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="162110.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_28 -->
<g id="node357" class="node">
<title>s1_v_28</title>
<polygon fill="lightgreen" stroke="black" points="162685,-190.45 162314,-190.45 162314,-137.45 162685,-137.45 162685,-190.45"/>
<text text-anchor="middle" x="162499.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: V Linear (TP0)</text>
<text text-anchor="middle" x="162499.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="162499.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_28 -->
<g id="node358" class="node">
<title>s1_allgather_q_28</title>
<ellipse fill="white" stroke="black" cx="162965.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="162965.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather Q (TP0)</text>
<text text-anchor="middle" x="162965.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="162965.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_28 -->
<g id="node359" class="node">
<title>s1_allgather_k_28</title>
<ellipse fill="white" stroke="black" cx="163508.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="163508.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather K (TP0)</text>
<text text-anchor="middle" x="163508.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="163508.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_28 -->
<g id="node360" class="node">
<title>s1_allgather_v_28</title>
<ellipse fill="white" stroke="black" cx="164051.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="164051.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllGather V (TP0)</text>
<text text-anchor="middle" x="164051.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="164051.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_28 -->
<g id="node361" class="node">
<title>s1_attn_28</title>
<polygon fill="lightgreen" stroke="black" points="164703,-190.45 164332,-190.45 164332,-137.45 164703,-137.45 164703,-190.45"/>
<text text-anchor="middle" x="164517.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Attention (TP0)</text>
<text text-anchor="middle" x="164517.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="164517.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_28 -->
<g id="node362" class="node">
<title>s1_gate_28</title>
<polygon fill="orange" stroke="black" points="165465.89,-216.95 164873.5,-216.95 164721.11,-110.95 165313.5,-110.95 165465.89,-216.95"/>
<text text-anchor="middle" x="165093.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: MoE Gate</text>
<text text-anchor="middle" x="165093.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="165093.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_28 -->
<g id="node363" class="node">
<title>s1_expert_28</title>
<polygon fill="lightgreen" stroke="black" points="165855,-190.45 165484,-190.45 165484,-137.45 165855,-137.45 165855,-190.45"/>
<text text-anchor="middle" x="165669.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: Expert FFN</text>
<text text-anchor="middle" x="165669.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="165669.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_28 -->
<g id="node364" class="node">
<title>s1_alltoall_28</title>
<ellipse fill="white" stroke="black" cx="166135.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="166135.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: AllToAll</text>
<text text-anchor="middle" x="166135.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="166135.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_28 -->
<g id="node365" class="node">
<title>s1_ln1_28</title>
<polygon fill="lightgreen" stroke="black" points="106671,-190.45 106300,-190.45 106300,-137.45 106671,-137.45 106671,-190.45"/>
<text text-anchor="middle" x="106485.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU28: LayerNorm (DP3)</text>
<text text-anchor="middle" x="106485.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="106485.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_28&#45;&gt;output -->
<g id="edge269" class="edge">
<title>s1_ln1_28&#45;&gt;output</title>
<path fill="none" stroke="black" d="M106405.63,-137.39C106370.92,-127.37 106329.57,-116.87 106291.5,-110.95 106051.36,-73.63 105381.74,-53 105003.51,-44.01"/>
<polygon fill="black" stroke="black" points="105003.32,-40.51 104993.24,-43.77 105003.16,-47.51 105003.32,-40.51"/>
</g>
<!-- s1_q_29 -->
<g id="node367" class="node">
<title>s1_q_29</title>
<polygon fill="lightgreen" stroke="black" points="166787,-190.45 166416,-190.45 166416,-137.45 166787,-137.45 166787,-190.45"/>
<text text-anchor="middle" x="166601.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Q Linear (TP1)</text>
<text text-anchor="middle" x="166601.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="166601.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_29 -->
<g id="node368" class="node">
<title>s1_k_29</title>
<polygon fill="lightgreen" stroke="black" points="167176,-190.45 166805,-190.45 166805,-137.45 167176,-137.45 167176,-190.45"/>
<text text-anchor="middle" x="166990.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: K Linear (TP1)</text>
<text text-anchor="middle" x="166990.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="166990.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_29 -->
<g id="node369" class="node">
<title>s1_v_29</title>
<polygon fill="lightgreen" stroke="black" points="167565,-190.45 167194,-190.45 167194,-137.45 167565,-137.45 167565,-190.45"/>
<text text-anchor="middle" x="167379.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: V Linear (TP1)</text>
<text text-anchor="middle" x="167379.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="167379.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_29 -->
<g id="node370" class="node">
<title>s1_allgather_q_29</title>
<ellipse fill="white" stroke="black" cx="167845.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="167845.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather Q (TP1)</text>
<text text-anchor="middle" x="167845.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="167845.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_29 -->
<g id="node371" class="node">
<title>s1_allgather_k_29</title>
<ellipse fill="white" stroke="black" cx="168388.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="168388.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather K (TP1)</text>
<text text-anchor="middle" x="168388.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="168388.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_29 -->
<g id="node372" class="node">
<title>s1_allgather_v_29</title>
<ellipse fill="white" stroke="black" cx="168931.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="168931.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllGather V (TP1)</text>
<text text-anchor="middle" x="168931.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="168931.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_29 -->
<g id="node373" class="node">
<title>s1_attn_29</title>
<polygon fill="lightgreen" stroke="black" points="169583,-190.45 169212,-190.45 169212,-137.45 169583,-137.45 169583,-190.45"/>
<text text-anchor="middle" x="169397.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Attention (TP1)</text>
<text text-anchor="middle" x="169397.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="169397.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_29 -->
<g id="node374" class="node">
<title>s1_gate_29</title>
<polygon fill="orange" stroke="black" points="170345.89,-216.95 169753.5,-216.95 169601.11,-110.95 170193.5,-110.95 170345.89,-216.95"/>
<text text-anchor="middle" x="169973.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: MoE Gate</text>
<text text-anchor="middle" x="169973.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="169973.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_29 -->
<g id="node375" class="node">
<title>s1_expert_29</title>
<polygon fill="lightgreen" stroke="black" points="170735,-190.45 170364,-190.45 170364,-137.45 170735,-137.45 170735,-190.45"/>
<text text-anchor="middle" x="170549.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: Expert FFN</text>
<text text-anchor="middle" x="170549.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="170549.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_29 -->
<g id="node376" class="node">
<title>s1_alltoall_29</title>
<ellipse fill="white" stroke="black" cx="171015.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="171015.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: AllToAll</text>
<text text-anchor="middle" x="171015.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="171015.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_29 -->
<g id="node377" class="node">
<title>s1_ln1_29</title>
<polygon fill="lightgreen" stroke="black" points="107060,-190.45 106689,-190.45 106689,-137.45 107060,-137.45 107060,-190.45"/>
<text text-anchor="middle" x="106874.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU29: LayerNorm (DP3)</text>
<text text-anchor="middle" x="106874.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="106874.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_29&#45;&gt;output -->
<g id="edge270" class="edge">
<title>s1_ln1_29&#45;&gt;output</title>
<path fill="none" stroke="black" d="M106795.13,-137.35C106760.33,-127.26 106718.77,-116.72 106680.5,-110.95 106366.06,-63.57 105462.99,-46.69 105006.13,-41.07"/>
<polygon fill="black" stroke="black" points="105006.14,-37.57 104996.09,-40.95 105006.05,-44.57 105006.14,-37.57"/>
</g>
<!-- s1_q_30 -->
<g id="node379" class="node">
<title>s1_q_30</title>
<polygon fill="lightgreen" stroke="black" points="171667,-190.45 171296,-190.45 171296,-137.45 171667,-137.45 171667,-190.45"/>
<text text-anchor="middle" x="171481.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Q Linear (TP2)</text>
<text text-anchor="middle" x="171481.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="171481.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_30 -->
<g id="node380" class="node">
<title>s1_k_30</title>
<polygon fill="lightgreen" stroke="black" points="172056,-190.45 171685,-190.45 171685,-137.45 172056,-137.45 172056,-190.45"/>
<text text-anchor="middle" x="171870.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: K Linear (TP2)</text>
<text text-anchor="middle" x="171870.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="171870.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_30 -->
<g id="node381" class="node">
<title>s1_v_30</title>
<polygon fill="lightgreen" stroke="black" points="172445,-190.45 172074,-190.45 172074,-137.45 172445,-137.45 172445,-190.45"/>
<text text-anchor="middle" x="172259.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: V Linear (TP2)</text>
<text text-anchor="middle" x="172259.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="172259.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_30 -->
<g id="node382" class="node">
<title>s1_allgather_q_30</title>
<ellipse fill="white" stroke="black" cx="172725.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="172725.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather Q (TP2)</text>
<text text-anchor="middle" x="172725.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="172725.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_30 -->
<g id="node383" class="node">
<title>s1_allgather_k_30</title>
<ellipse fill="white" stroke="black" cx="173268.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="173268.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather K (TP2)</text>
<text text-anchor="middle" x="173268.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="173268.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_30 -->
<g id="node384" class="node">
<title>s1_allgather_v_30</title>
<ellipse fill="white" stroke="black" cx="173811.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="173811.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllGather V (TP2)</text>
<text text-anchor="middle" x="173811.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="173811.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_30 -->
<g id="node385" class="node">
<title>s1_attn_30</title>
<polygon fill="lightgreen" stroke="black" points="174463,-190.45 174092,-190.45 174092,-137.45 174463,-137.45 174463,-190.45"/>
<text text-anchor="middle" x="174277.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Attention (TP2)</text>
<text text-anchor="middle" x="174277.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="174277.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_30 -->
<g id="node386" class="node">
<title>s1_gate_30</title>
<polygon fill="orange" stroke="black" points="175225.89,-216.95 174633.5,-216.95 174481.11,-110.95 175073.5,-110.95 175225.89,-216.95"/>
<text text-anchor="middle" x="174853.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: MoE Gate</text>
<text text-anchor="middle" x="174853.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="174853.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_30 -->
<g id="node387" class="node">
<title>s1_expert_30</title>
<polygon fill="lightgreen" stroke="black" points="175615,-190.45 175244,-190.45 175244,-137.45 175615,-137.45 175615,-190.45"/>
<text text-anchor="middle" x="175429.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: Expert FFN</text>
<text text-anchor="middle" x="175429.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="175429.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_30 -->
<g id="node388" class="node">
<title>s1_alltoall_30</title>
<ellipse fill="white" stroke="black" cx="175895.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="175895.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: AllToAll</text>
<text text-anchor="middle" x="175895.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="175895.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_30 -->
<g id="node389" class="node">
<title>s1_ln1_30</title>
<polygon fill="lightgreen" stroke="black" points="107449,-190.45 107078,-190.45 107078,-137.45 107449,-137.45 107449,-190.45"/>
<text text-anchor="middle" x="107263.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU30: LayerNorm (DP3)</text>
<text text-anchor="middle" x="107263.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="107263.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_30&#45;&gt;output -->
<g id="edge271" class="edge">
<title>s1_ln1_30&#45;&gt;output</title>
<path fill="none" stroke="black" d="M107184.61,-137.38C107149.72,-127.22 107107.96,-116.63 107069.5,-110.95 106679.35,-53.4 105534.43,-41.46 105006.66,-39.05"/>
<polygon fill="black" stroke="black" points="105006.64,-35.55 104996.62,-39.01 105006.61,-42.55 105006.64,-35.55"/>
</g>
<!-- s1_q_31 -->
<g id="node391" class="node">
<title>s1_q_31</title>
<polygon fill="lightgreen" stroke="black" points="176547,-190.45 176176,-190.45 176176,-137.45 176547,-137.45 176547,-190.45"/>
<text text-anchor="middle" x="176361.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Q Linear (TP3)</text>
<text text-anchor="middle" x="176361.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="176361.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_k_31 -->
<g id="node392" class="node">
<title>s1_k_31</title>
<polygon fill="lightgreen" stroke="black" points="176936,-190.45 176565,-190.45 176565,-137.45 176936,-137.45 176936,-190.45"/>
<text text-anchor="middle" x="176750.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: K Linear (TP3)</text>
<text text-anchor="middle" x="176750.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="176750.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_v_31 -->
<g id="node393" class="node">
<title>s1_v_31</title>
<polygon fill="lightgreen" stroke="black" points="177325,-190.45 176954,-190.45 176954,-137.45 177325,-137.45 177325,-190.45"/>
<text text-anchor="middle" x="177139.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: V Linear (TP3)</text>
<text text-anchor="middle" x="177139.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="177139.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=1536]</text>
</g>
<!-- s1_allgather_q_31 -->
<g id="node394" class="node">
<title>s1_allgather_q_31</title>
<ellipse fill="white" stroke="black" cx="177605.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="177605.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather Q (TP3)</text>
<text text-anchor="middle" x="177605.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="177605.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_k_31 -->
<g id="node395" class="node">
<title>s1_allgather_k_31</title>
<ellipse fill="white" stroke="black" cx="178148.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="178148.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather K (TP3)</text>
<text text-anchor="middle" x="178148.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="178148.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_allgather_v_31 -->
<g id="node396" class="node">
<title>s1_allgather_v_31</title>
<ellipse fill="white" stroke="black" cx="178691.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="178691.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllGather V (TP3)</text>
<text text-anchor="middle" x="178691.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=1536]</text>
<text text-anchor="middle" x="178691.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_attn_31 -->
<g id="node397" class="node">
<title>s1_attn_31</title>
<polygon fill="lightgreen" stroke="black" points="179343,-190.45 178972,-190.45 178972,-137.45 179343,-137.45 179343,-190.45"/>
<text text-anchor="middle" x="179157.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Attention (TP3)</text>
<text text-anchor="middle" x="179157.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="179157.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_gate_31 -->
<g id="node398" class="node">
<title>s1_gate_31</title>
<polygon fill="orange" stroke="black" points="180105.89,-216.95 179513.5,-216.95 179361.11,-110.95 179953.5,-110.95 180105.89,-216.95"/>
<text text-anchor="middle" x="179733.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: MoE Gate</text>
<text text-anchor="middle" x="179733.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="179733.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, experts=8]</text>
</g>
<!-- s1_expert_31 -->
<g id="node399" class="node">
<title>s1_expert_31</title>
<polygon fill="lightgreen" stroke="black" points="180495,-190.45 180124,-190.45 180124,-137.45 180495,-137.45 180495,-190.45"/>
<text text-anchor="middle" x="180309.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: Expert FFN</text>
<text text-anchor="middle" x="180309.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="180309.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_alltoall_31 -->
<g id="node400" class="node">
<title>s1_alltoall_31</title>
<ellipse fill="white" stroke="black" cx="180775.5" cy="-163.95" rx="262.17" ry="37.45"/>
<text text-anchor="middle" x="180775.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: AllToAll</text>
<text text-anchor="middle" x="180775.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="180775.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_31 -->
<g id="node401" class="node">
<title>s1_ln1_31</title>
<polygon fill="lightgreen" stroke="black" points="107838,-190.45 107467,-190.45 107467,-137.45 107838,-137.45 107838,-190.45"/>
<text text-anchor="middle" x="107652.5" y="-175.25" font-family="Times,serif" font-size="14.00">GPU31: LayerNorm (DP3)</text>
<text text-anchor="middle" x="107652.5" y="-160.25" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=1, hidden=6144]</text>
<text text-anchor="middle" x="107652.5" y="-145.25" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=1, hidden=6144]</text>
</g>
<!-- s1_ln1_31&#45;&gt;output -->
<g id="edge272" class="edge">
<title>s1_ln1_31&#45;&gt;output</title>
<path fill="none" stroke="black" d="M107574.09,-137.43C107539.11,-127.22 107497.15,-116.57 107458.5,-110.95 106991.91,-43.18 105600.51,-37.01 105007.3,-37.6"/>
<polygon fill="black" stroke="black" points="105006.9,-34.1 104996.9,-37.61 105006.9,-41.1 105006.9,-34.1"/>
</g>
</g>
</svg>
