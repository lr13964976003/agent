<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="9000pt" height="24pt"
 viewBox="0.00 0.00 2160.00 5.86" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.03 0.03) rotate(0) translate(4 922.45)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-922.45 341543,-922.45 341543,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<path fill="lightgray" stroke="black" d="M20,-8C20,-8 23656,-8 23656,-8 23662,-8 23668,-14 23668,-20 23668,-20 23668,-763.45 23668,-763.45 23668,-769.45 23662,-775.45 23656,-775.45 23656,-775.45 20,-775.45 20,-775.45 14,-775.45 8,-769.45 8,-763.45 8,-763.45 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="11838" y="-760.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_1</title>
<path fill="lightgray" stroke="black" d="M23429,-783.45C23429,-783.45 68843,-783.45 68843,-783.45 68849,-783.45 68855,-789.45 68855,-795.45 68855,-795.45 68855,-898.45 68855,-898.45 68855,-904.45 68849,-910.45 68843,-910.45 68843,-910.45 23429,-910.45 23429,-910.45 23423,-910.45 23417,-904.45 23417,-898.45 23417,-898.45 23417,-795.45 23417,-795.45 23417,-789.45 23423,-783.45 23429,-783.45"/>
<text text-anchor="middle" x="46136" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_2</title>
<path fill="lightgray" stroke="black" d="M68875,-783.45C68875,-783.45 114289,-783.45 114289,-783.45 114295,-783.45 114301,-789.45 114301,-795.45 114301,-795.45 114301,-898.45 114301,-898.45 114301,-904.45 114295,-910.45 114289,-910.45 114289,-910.45 68875,-910.45 68875,-910.45 68869,-910.45 68863,-904.45 68863,-898.45 68863,-898.45 68863,-795.45 68863,-795.45 68863,-789.45 68869,-783.45 68875,-783.45"/>
<text text-anchor="middle" x="91582" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layers 4&#45;5)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_3</title>
<path fill="lightgray" stroke="black" d="M114321,-783.45C114321,-783.45 159735,-783.45 159735,-783.45 159741,-783.45 159747,-789.45 159747,-795.45 159747,-795.45 159747,-898.45 159747,-898.45 159747,-904.45 159741,-910.45 159735,-910.45 159735,-910.45 114321,-910.45 114321,-910.45 114315,-910.45 114309,-904.45 114309,-898.45 114309,-898.45 114309,-795.45 114309,-795.45 114309,-789.45 114315,-783.45 114321,-783.45"/>
<text text-anchor="middle" x="137028" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (Layers 6&#45;7)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage_4</title>
<path fill="lightgray" stroke="black" d="M159767,-783.45C159767,-783.45 205181,-783.45 205181,-783.45 205187,-783.45 205193,-789.45 205193,-795.45 205193,-795.45 205193,-898.45 205193,-898.45 205193,-904.45 205187,-910.45 205181,-910.45 205181,-910.45 159767,-910.45 159767,-910.45 159761,-910.45 159755,-904.45 159755,-898.45 159755,-898.45 159755,-795.45 159755,-795.45 159755,-789.45 159761,-783.45 159767,-783.45"/>
<text text-anchor="middle" x="182474" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 4 (Layers 8&#45;9)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage_5</title>
<path fill="lightgray" stroke="black" d="M205213,-783.45C205213,-783.45 250627,-783.45 250627,-783.45 250633,-783.45 250639,-789.45 250639,-795.45 250639,-795.45 250639,-898.45 250639,-898.45 250639,-904.45 250633,-910.45 250627,-910.45 250627,-910.45 205213,-910.45 205213,-910.45 205207,-910.45 205201,-904.45 205201,-898.45 205201,-898.45 205201,-795.45 205201,-795.45 205201,-789.45 205207,-783.45 205213,-783.45"/>
<text text-anchor="middle" x="227920" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 5 (Layers 10&#45;11)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage_6</title>
<path fill="lightgray" stroke="black" d="M250659,-783.45C250659,-783.45 296073,-783.45 296073,-783.45 296079,-783.45 296085,-789.45 296085,-795.45 296085,-795.45 296085,-898.45 296085,-898.45 296085,-904.45 296079,-910.45 296073,-910.45 296073,-910.45 250659,-910.45 250659,-910.45 250653,-910.45 250647,-904.45 250647,-898.45 250647,-898.45 250647,-795.45 250647,-795.45 250647,-789.45 250653,-783.45 250659,-783.45"/>
<text text-anchor="middle" x="273366" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 6 (Layers 12&#45;13)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_stage_7</title>
<path fill="lightgray" stroke="black" d="M296105,-783.45C296105,-783.45 341519,-783.45 341519,-783.45 341525,-783.45 341531,-789.45 341531,-795.45 341531,-795.45 341531,-898.45 341531,-898.45 341531,-904.45 341525,-910.45 341519,-910.45 341519,-910.45 296105,-910.45 296105,-910.45 296099,-910.45 296093,-904.45 296093,-898.45 296093,-898.45 296093,-795.45 296093,-795.45 296093,-789.45 296099,-783.45 296105,-783.45"/>
<text text-anchor="middle" x="318812" y="-895.25" font-family="Times,serif" font-size="14.00">Pipeline Stage 7 (Layers 14&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="23198" cy="-835.45" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="23198" y="-843.25" font-family="Times,serif" font-size="9.00">Input</text>
<text text-anchor="middle" x="23198" y="-833.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23198" y="-823.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- q_proj_0 -->
<g id="node2" class="node">
<title>q_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="23660,-722.45 23364,-722.45 23364,-678.45 23660,-678.45 23660,-722.45"/>
<text text-anchor="middle" x="23512" y="-713.25" font-family="Times,serif" font-size="9.00">Q Projection L0</text>
<text text-anchor="middle" x="23512" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="23512" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23512" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;q_proj_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;q_proj_0</title>
<path fill="none" stroke="black" d="M23259.97,-812.48C23289.04,-801.83 23324.02,-788.55 23355,-775.45 23390.72,-760.35 23430.2,-741.73 23460.63,-726.95"/>
<polygon fill="black" stroke="black" points="23462.32,-730.02 23469.77,-722.49 23459.25,-723.73 23462.32,-730.02"/>
</g>
<!-- k_proj_0 -->
<g id="node3" class="node">
<title>k_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="23346,-722.45 23050,-722.45 23050,-678.45 23346,-678.45 23346,-722.45"/>
<text text-anchor="middle" x="23198" y="-713.25" font-family="Times,serif" font-size="9.00">K Projection L0</text>
<text text-anchor="middle" x="23198" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="23198" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23198" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;k_proj_0 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;k_proj_0</title>
<path fill="none" stroke="black" d="M23198,-811.28C23198,-789.5 23198,-756.73 23198,-732.65"/>
<polygon fill="black" stroke="black" points="23201.5,-732.6 23198,-722.6 23194.5,-732.6 23201.5,-732.6"/>
</g>
<!-- v_proj_0 -->
<g id="node4" class="node">
<title>v_proj_0</title>
<polygon fill="lightgreen" stroke="black" points="23032,-722.45 22736,-722.45 22736,-678.45 23032,-678.45 23032,-722.45"/>
<text text-anchor="middle" x="22884" y="-713.25" font-family="Times,serif" font-size="9.00">V Projection L0</text>
<text text-anchor="middle" x="22884" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="22884" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22884" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;v_proj_0 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;v_proj_0</title>
<path fill="none" stroke="black" d="M23136.03,-812.48C23106.96,-801.83 23071.98,-788.55 23041,-775.45 23005.28,-760.35 22965.8,-741.73 22935.37,-726.95"/>
<polygon fill="black" stroke="black" points="22936.75,-723.73 22926.23,-722.49 22933.68,-730.02 22936.75,-723.73"/>
</g>
<!-- attn_scores_0 -->
<g id="node5" class="node">
<title>attn_scores_0</title>
<polygon fill="lightgreen" stroke="black" points="23207.5,-620.45 22874.5,-620.45 22874.5,-576.45 23207.5,-576.45 23207.5,-620.45"/>
<text text-anchor="middle" x="23041" y="-611.25" font-family="Times,serif" font-size="9.00">Attention Scores L0</text>
<text text-anchor="middle" x="23041" y="-601.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="23041" y="-591.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23041" y="-581.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- q_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge4" class="edge">
<title>q_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M23440.43,-678.42C23413.74,-670.96 23383.11,-662.84 23355,-656.45 23298.54,-643.62 23235.86,-631.77 23181.44,-622.23"/>
<polygon fill="black" stroke="black" points="23181.83,-618.75 23171.38,-620.48 23180.63,-625.64 23181.83,-618.75"/>
</g>
<!-- k_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge5" class="edge">
<title>k_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M23164.7,-678.24C23140.79,-663.01 23108.39,-642.37 23082.74,-626.04"/>
<polygon fill="black" stroke="black" points="23084.29,-622.88 23073.98,-620.46 23080.53,-628.78 23084.29,-622.88"/>
</g>
<!-- v_proj_0&#45;&gt;attn_scores_0 -->
<g id="edge6" class="edge">
<title>v_proj_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M22917.3,-678.24C22941.21,-663.01 22973.61,-642.37 22999.26,-626.04"/>
<polygon fill="black" stroke="black" points="23001.47,-628.78 23008.02,-620.46 22997.71,-622.88 23001.47,-628.78"/>
</g>
<!-- softmax_0 -->
<g id="node6" class="node">
<title>softmax_0</title>
<polygon fill="lightgreen" stroke="black" points="22223.5,-540.45 21890.5,-540.45 21890.5,-496.45 22223.5,-496.45 22223.5,-540.45"/>
<text text-anchor="middle" x="22057" y="-531.25" font-family="Times,serif" font-size="9.00">Softmax L0</text>
<text text-anchor="middle" x="22057" y="-521.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="22057" y="-511.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="22057" y="-501.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_scores_0&#45;&gt;softmax_0 -->
<g id="edge7" class="edge">
<title>attn_scores_0&#45;&gt;softmax_0</title>
<path fill="none" stroke="black" d="M22874.36,-584.24C22696.41,-570.14 22415.55,-547.87 22233.81,-533.47"/>
<polygon fill="black" stroke="black" points="22233.85,-529.96 22223.61,-532.66 22233.3,-536.94 22233.85,-529.96"/>
</g>
<!-- attn_out_0 -->
<g id="node7" class="node">
<title>attn_out_0</title>
<polygon fill="lightgreen" stroke="black" points="20374,-460.45 20078,-460.45 20078,-416.45 20374,-416.45 20374,-460.45"/>
<text text-anchor="middle" x="20226" y="-451.25" font-family="Times,serif" font-size="9.00">Attention Output L0</text>
<text text-anchor="middle" x="20226" y="-441.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="20226" y="-431.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20226" y="-421.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- softmax_0&#45;&gt;attn_out_0 -->
<g id="edge8" class="edge">
<title>softmax_0&#45;&gt;attn_out_0</title>
<path fill="none" stroke="black" d="M21890.47,-510.36C21539.43,-495.4 20727.64,-460.82 20384.11,-446.19"/>
<polygon fill="black" stroke="black" points="20384.22,-442.69 20374.08,-445.76 20383.93,-449.68 20384.22,-442.69"/>
</g>
<!-- gate_0 -->
<g id="node8" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="19542.74,-380.45 19065.92,-380.45 18943.26,-292.45 19420.08,-292.45 19542.74,-380.45"/>
<text text-anchor="middle" x="19243" y="-349.25" font-family="Times,serif" font-size="9.00">Gate L0</text>
<text text-anchor="middle" x="19243" y="-339.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="19243" y="-329.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19243" y="-319.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- attn_out_0&#45;&gt;gate_0 -->
<g id="edge9" class="edge">
<title>attn_out_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M20077.77,-422.37C19933.93,-407.74 19711.75,-385.14 19532.76,-366.93"/>
<polygon fill="black" stroke="black" points="19532.96,-363.43 19522.66,-365.9 19532.25,-370.39 19532.96,-363.43"/>
</g>
<!-- route_0_0 -->
<g id="node9" class="node">
<title>route_0_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="14671" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="14671" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="14671" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="14671" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14671" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_0 -->
<g id="edge10" class="edge">
<title>gate_0&#45;&gt;route_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19003.85,-335.98C18363.02,-336.32 16553.92,-330.09 15051,-256.45 14985.75,-253.25 14914.31,-248.04 14851.17,-242.85"/>
<polygon fill="black" stroke="black" points="14851.36,-239.35 14841.11,-242.02 14850.78,-246.33 14851.36,-239.35"/>
</g>
<!-- route_0_1 -->
<g id="node13" class="node">
<title>route_0_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="15261" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="15261" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="15261" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="15261" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15261" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_1 -->
<g id="edge15" class="edge">
<title>gate_0&#45;&gt;route_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19002.29,-334.92C18423.06,-332.6 16905.82,-320.38 15641,-256.45 15575.75,-253.15 15504.32,-247.92 15441.17,-242.74"/>
<polygon fill="black" stroke="black" points="15441.37,-239.24 15431.11,-241.9 15440.79,-246.22 15441.37,-239.24"/>
</g>
<!-- route_0_2 -->
<g id="node17" class="node">
<title>route_0_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="15851" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="15851" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="15851" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="15851" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15851" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_2 -->
<g id="edge20" class="edge">
<title>gate_0&#45;&gt;route_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19000.28,-333.43C18488.2,-328.22 17259.75,-310.66 16231,-256.45 16165.92,-253.02 16094.67,-247.77 16031.64,-242.61"/>
<polygon fill="black" stroke="black" points="16031.85,-239.12 16021.59,-241.79 16031.27,-246.1 16031.85,-239.12"/>
</g>
<!-- route_0_3 -->
<g id="node21" class="node">
<title>route_0_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="16441" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="16441" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="16441" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="16441" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16441" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_3 -->
<g id="edge25" class="edge">
<title>gate_0&#45;&gt;route_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18997.02,-331.2C18559.18,-322.8 17615.95,-300.89 16821,-256.45 16756.24,-252.83 16685.37,-247.57 16622.56,-242.45"/>
<polygon fill="black" stroke="black" points="16622.8,-238.96 16612.55,-241.63 16622.23,-245.94 16622.8,-238.96"/>
</g>
<!-- route_0_4 -->
<g id="node25" class="node">
<title>route_0_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="17031" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="17031" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="17031" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="17031" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17031" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_4 -->
<g id="edge30" class="edge">
<title>gate_0&#45;&gt;route_0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18992.08,-327.49C18639.03,-315.64 17975.62,-290.98 17411,-256.45 17346.57,-252.51 17276.08,-247.2 17213.5,-242.14"/>
<polygon fill="black" stroke="black" points="17213.77,-238.65 17203.52,-241.33 17213.21,-245.63 17213.77,-238.65"/>
</g>
<!-- route_0_5 -->
<g id="node29" class="node">
<title>route_0_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="17621" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="17621" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="17621" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="17621" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17621" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_5 -->
<g id="edge35" class="edge">
<title>gate_0&#45;&gt;route_0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18981.54,-320.01C18730.14,-304.87 18339.49,-280.63 18001,-256.45 17937.53,-251.92 17868.14,-246.54 17806.22,-241.6"/>
<polygon fill="black" stroke="black" points="17806.2,-238.08 17795.95,-240.77 17805.64,-245.06 17806.2,-238.08"/>
</g>
<!-- route_0_6 -->
<g id="node33" class="node">
<title>route_0_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="18211" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="18211" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="18211" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="18211" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18211" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_6 -->
<g id="edge40" class="edge">
<title>gate_0&#45;&gt;route_0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18961.68,-305.71C18777.14,-286.2 18541.7,-261.3 18384.15,-244.65"/>
<polygon fill="black" stroke="black" points="18384.2,-241.13 18373.89,-243.56 18383.46,-248.09 18384.2,-241.13"/>
</g>
<!-- route_0_7 -->
<g id="node37" class="node">
<title>route_0_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="18801" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="18801" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="18801" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="18801" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18801" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_7 -->
<g id="edge45" class="edge">
<title>gate_0&#45;&gt;route_0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19068.63,-292.4C19016.9,-279.63 18961.59,-265.98 18914.77,-254.42"/>
<polygon fill="black" stroke="black" points="18915.46,-250.99 18904.91,-251.99 18913.78,-257.78 18915.46,-250.99"/>
</g>
<!-- route_0_8 -->
<g id="node41" class="node">
<title>route_0_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="19243" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="19243" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="19243" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="19243" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19243" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_8 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;route_0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19243,-292.33C19243,-283.95 19243,-275.2 19243,-266.91"/>
<polygon fill="black" stroke="black" points="19246.5,-266.71 19243,-256.71 19239.5,-266.71 19246.5,-266.71"/>
</g>
<!-- route_0_9 -->
<g id="node45" class="node">
<title>route_0_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="19686" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="19686" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="19686" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="19686" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19686" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_9 -->
<g id="edge55" class="edge">
<title>gate_0&#45;&gt;route_0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19417.77,-292.4C19469.62,-279.63 19525.04,-265.98 19571.97,-254.42"/>
<polygon fill="black" stroke="black" points="19572.98,-257.78 19581.85,-251.99 19571.31,-250.98 19572.98,-257.78"/>
</g>
<!-- route_0_10 -->
<g id="node49" class="node">
<title>route_0_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="20276" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="20276" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="20276" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="20276" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20276" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_10 -->
<g id="edge60" class="edge">
<title>gate_0&#45;&gt;route_0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19449.87,-313.6C19641.32,-293.38 19922.72,-263.65 20102.65,-244.65"/>
<polygon fill="black" stroke="black" points="20103.17,-248.11 20112.75,-243.58 20102.44,-241.15 20103.17,-248.11"/>
</g>
<!-- route_0_11 -->
<g id="node53" class="node">
<title>route_0_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="20866" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="20866" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="20866" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="20866" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20866" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_11 -->
<g id="edge65" class="edge">
<title>gate_0&#45;&gt;route_0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19462.27,-322.55C19710.67,-307.7 20127.56,-282.04 20486,-256.45 20549.47,-251.92 20618.86,-246.54 20680.78,-241.6"/>
<polygon fill="black" stroke="black" points="20681.36,-245.06 20691.05,-240.78 20680.8,-238.09 20681.36,-245.06"/>
</g>
<!-- route_0_12 -->
<g id="node57" class="node">
<title>route_0_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="21456" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="21456" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="21456" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="21456" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21456" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_12 -->
<g id="edge70" class="edge">
<title>gate_0&#45;&gt;route_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19470.32,-328.29C19816.89,-316.77 20498.16,-291.79 21076,-256.45 21140.43,-252.51 21210.92,-247.2 21273.5,-242.14"/>
<polygon fill="black" stroke="black" points="21273.79,-245.63 21283.48,-241.33 21273.23,-238.65 21273.79,-245.63"/>
</g>
<!-- route_0_13 -->
<g id="node61" class="node">
<title>route_0_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="22046" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="22046" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="22046" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="22046" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22046" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_13 -->
<g id="edge75" class="edge">
<title>gate_0&#45;&gt;route_0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19474.52,-331.48C19905.89,-323.29 20861.79,-301.4 21666,-256.45 21730.76,-252.83 21801.63,-247.57 21864.44,-242.45"/>
<polygon fill="black" stroke="black" points="21864.77,-245.94 21874.45,-241.63 21864.2,-238.96 21864.77,-245.94"/>
</g>
<!-- route_0_14 -->
<g id="node65" class="node">
<title>route_0_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="22636" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="22636" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="22636" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="22636" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22636" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_14 -->
<g id="edge80" class="edge">
<title>gate_0&#45;&gt;route_0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19477.57,-333.52C19984.79,-328.41 21221.36,-310.97 22256,-256.45 22321.08,-253.02 22392.33,-247.77 22455.36,-242.62"/>
<polygon fill="black" stroke="black" points="22455.73,-246.1 22465.41,-241.79 22455.15,-239.12 22455.73,-246.1"/>
</g>
<!-- route_0_15 -->
<g id="node69" class="node">
<title>route_0_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="23226" cy="-225.34" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="23226" y="-238.14" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="23226" y="-228.14" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="23226" y="-218.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23226" y="-208.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_15 -->
<g id="edge85" class="edge">
<title>gate_0&#45;&gt;route_0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M19479.51,-334.94C20055.67,-332.67 21577.7,-320.56 22846,-256.45 22911.25,-253.15 22982.68,-247.92 23045.83,-242.74"/>
<polygon fill="black" stroke="black" points="23046.21,-246.22 23055.89,-241.9 23045.63,-239.24 23046.21,-246.22"/>
</g>
<!-- expert_0_0_0 -->
<g id="node10" class="node">
<title>expert_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="14514.5,-158.23 14237.5,-158.23 14237.5,-114.23 14514.5,-114.23 14514.5,-158.23"/>
<text text-anchor="middle" x="14376" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L0</text>
<text text-anchor="middle" x="14376" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="14376" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14376" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_0 -->
<g id="edge11" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_0</title>
<path fill="none" stroke="black" d="M14580.08,-197.49C14540.92,-185.93 14495.49,-172.51 14457.44,-161.27"/>
<polygon fill="black" stroke="black" points="14458.01,-157.79 14447.43,-158.32 14456.03,-164.51 14458.01,-157.79"/>
</g>
<!-- expert_0_0_1 -->
<g id="node11" class="node">
<title>expert_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="14809.5,-158.23 14532.5,-158.23 14532.5,-114.23 14809.5,-114.23 14809.5,-158.23"/>
<text text-anchor="middle" x="14671" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L0</text>
<text text-anchor="middle" x="14671" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="14671" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14671" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_1 -->
<g id="edge12" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_1</title>
<path fill="none" stroke="black" d="M14671,-193.87C14671,-185.59 14671,-176.62 14671,-168.3"/>
<polygon fill="black" stroke="black" points="14674.5,-168.23 14671,-158.23 14667.5,-168.23 14674.5,-168.23"/>
</g>
<!-- tp_0_0 -->
<g id="node12" class="node">
<title>tp_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="14523" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="14523" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L0</text>
<text text-anchor="middle" x="14523" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="14523" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="14523" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_0_0&#45;&gt;tp_0_0 -->
<g id="edge13" class="edge">
<title>expert_0_0_0&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M14411.58,-114.14C14428.38,-104.18 14448.82,-92.07 14467.58,-80.95"/>
<polygon fill="black" stroke="black" points="14469.53,-83.87 14476.35,-75.76 14465.96,-77.85 14469.53,-83.87"/>
</g>
<!-- expert_0_0_1&#45;&gt;tp_0_0 -->
<g id="edge14" class="edge">
<title>expert_0_0_1&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M14635.17,-114.14C14618.19,-104.14 14597.51,-91.97 14578.55,-80.81"/>
<polygon fill="black" stroke="black" points="14580.09,-77.65 14569.69,-75.6 14576.54,-83.69 14580.09,-77.65"/>
</g>
<!-- expert_0_1_0 -->
<g id="node14" class="node">
<title>expert_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="15104.5,-158.23 14827.5,-158.23 14827.5,-114.23 15104.5,-114.23 15104.5,-158.23"/>
<text text-anchor="middle" x="14966" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L0</text>
<text text-anchor="middle" x="14966" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="14966" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14966" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_0 -->
<g id="edge16" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_0</title>
<path fill="none" stroke="black" d="M15170.08,-197.49C15130.92,-185.93 15085.49,-172.51 15047.44,-161.27"/>
<polygon fill="black" stroke="black" points="15048.01,-157.79 15037.43,-158.32 15046.03,-164.51 15048.01,-157.79"/>
</g>
<!-- expert_0_1_1 -->
<g id="node15" class="node">
<title>expert_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="15399.5,-158.23 15122.5,-158.23 15122.5,-114.23 15399.5,-114.23 15399.5,-158.23"/>
<text text-anchor="middle" x="15261" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L0</text>
<text text-anchor="middle" x="15261" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="15261" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15261" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_1 -->
<g id="edge17" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_1</title>
<path fill="none" stroke="black" d="M15261,-193.87C15261,-185.59 15261,-176.62 15261,-168.3"/>
<polygon fill="black" stroke="black" points="15264.5,-168.23 15261,-158.23 15257.5,-168.23 15264.5,-168.23"/>
</g>
<!-- tp_0_1 -->
<g id="node16" class="node">
<title>tp_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="15113" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="15113" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L0</text>
<text text-anchor="middle" x="15113" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="15113" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="15113" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_1_0&#45;&gt;tp_0_1 -->
<g id="edge18" class="edge">
<title>expert_0_1_0&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M15001.58,-114.14C15018.38,-104.18 15038.82,-92.07 15057.58,-80.95"/>
<polygon fill="black" stroke="black" points="15059.53,-83.87 15066.35,-75.76 15055.96,-77.85 15059.53,-83.87"/>
</g>
<!-- expert_0_1_1&#45;&gt;tp_0_1 -->
<g id="edge19" class="edge">
<title>expert_0_1_1&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M15225.17,-114.14C15208.19,-104.14 15187.51,-91.97 15168.55,-80.81"/>
<polygon fill="black" stroke="black" points="15170.09,-77.65 15159.69,-75.6 15166.54,-83.69 15170.09,-77.65"/>
</g>
<!-- expert_0_2_0 -->
<g id="node18" class="node">
<title>expert_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="15694.5,-158.23 15417.5,-158.23 15417.5,-114.23 15694.5,-114.23 15694.5,-158.23"/>
<text text-anchor="middle" x="15556" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L0</text>
<text text-anchor="middle" x="15556" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="15556" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15556" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_0 -->
<g id="edge21" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_0</title>
<path fill="none" stroke="black" d="M15760.08,-197.49C15720.92,-185.93 15675.49,-172.51 15637.44,-161.27"/>
<polygon fill="black" stroke="black" points="15638.01,-157.79 15627.43,-158.32 15636.03,-164.51 15638.01,-157.79"/>
</g>
<!-- expert_0_2_1 -->
<g id="node19" class="node">
<title>expert_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="15989.5,-158.23 15712.5,-158.23 15712.5,-114.23 15989.5,-114.23 15989.5,-158.23"/>
<text text-anchor="middle" x="15851" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L0</text>
<text text-anchor="middle" x="15851" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="15851" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15851" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_1 -->
<g id="edge22" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_1</title>
<path fill="none" stroke="black" d="M15851,-193.87C15851,-185.59 15851,-176.62 15851,-168.3"/>
<polygon fill="black" stroke="black" points="15854.5,-168.23 15851,-158.23 15847.5,-168.23 15854.5,-168.23"/>
</g>
<!-- tp_0_2 -->
<g id="node20" class="node">
<title>tp_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="15703" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="15703" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L0</text>
<text text-anchor="middle" x="15703" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="15703" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="15703" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_2_0&#45;&gt;tp_0_2 -->
<g id="edge23" class="edge">
<title>expert_0_2_0&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M15591.58,-114.14C15608.38,-104.18 15628.82,-92.07 15647.58,-80.95"/>
<polygon fill="black" stroke="black" points="15649.53,-83.87 15656.35,-75.76 15645.96,-77.85 15649.53,-83.87"/>
</g>
<!-- expert_0_2_1&#45;&gt;tp_0_2 -->
<g id="edge24" class="edge">
<title>expert_0_2_1&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M15815.17,-114.14C15798.19,-104.14 15777.51,-91.97 15758.55,-80.81"/>
<polygon fill="black" stroke="black" points="15760.09,-77.65 15749.69,-75.6 15756.54,-83.69 15760.09,-77.65"/>
</g>
<!-- expert_0_3_0 -->
<g id="node22" class="node">
<title>expert_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="16284.5,-158.23 16007.5,-158.23 16007.5,-114.23 16284.5,-114.23 16284.5,-158.23"/>
<text text-anchor="middle" x="16146" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L0</text>
<text text-anchor="middle" x="16146" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="16146" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16146" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_0 -->
<g id="edge26" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_0</title>
<path fill="none" stroke="black" d="M16350.08,-197.49C16310.92,-185.93 16265.49,-172.51 16227.44,-161.27"/>
<polygon fill="black" stroke="black" points="16228.01,-157.79 16217.43,-158.32 16226.03,-164.51 16228.01,-157.79"/>
</g>
<!-- expert_0_3_1 -->
<g id="node23" class="node">
<title>expert_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="16579.5,-158.23 16302.5,-158.23 16302.5,-114.23 16579.5,-114.23 16579.5,-158.23"/>
<text text-anchor="middle" x="16441" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L0</text>
<text text-anchor="middle" x="16441" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="16441" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16441" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_1 -->
<g id="edge27" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_1</title>
<path fill="none" stroke="black" d="M16441,-193.87C16441,-185.59 16441,-176.62 16441,-168.3"/>
<polygon fill="black" stroke="black" points="16444.5,-168.23 16441,-158.23 16437.5,-168.23 16444.5,-168.23"/>
</g>
<!-- tp_0_3 -->
<g id="node24" class="node">
<title>tp_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="16293" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="16293" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L0</text>
<text text-anchor="middle" x="16293" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="16293" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="16293" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_3_0&#45;&gt;tp_0_3 -->
<g id="edge28" class="edge">
<title>expert_0_3_0&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M16181.58,-114.14C16198.38,-104.18 16218.82,-92.07 16237.58,-80.95"/>
<polygon fill="black" stroke="black" points="16239.53,-83.87 16246.35,-75.76 16235.96,-77.85 16239.53,-83.87"/>
</g>
<!-- expert_0_3_1&#45;&gt;tp_0_3 -->
<g id="edge29" class="edge">
<title>expert_0_3_1&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M16405.17,-114.14C16388.19,-104.14 16367.51,-91.97 16348.55,-80.81"/>
<polygon fill="black" stroke="black" points="16350.09,-77.65 16339.69,-75.6 16346.54,-83.69 16350.09,-77.65"/>
</g>
<!-- expert_0_4_0 -->
<g id="node26" class="node">
<title>expert_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="16874.5,-158.23 16597.5,-158.23 16597.5,-114.23 16874.5,-114.23 16874.5,-158.23"/>
<text text-anchor="middle" x="16736" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L0</text>
<text text-anchor="middle" x="16736" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="16736" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16736" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_0 -->
<g id="edge31" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_0</title>
<path fill="none" stroke="black" d="M16940.08,-197.49C16900.92,-185.93 16855.49,-172.51 16817.44,-161.27"/>
<polygon fill="black" stroke="black" points="16818.01,-157.79 16807.43,-158.32 16816.03,-164.51 16818.01,-157.79"/>
</g>
<!-- expert_0_4_1 -->
<g id="node27" class="node">
<title>expert_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="17169.5,-158.23 16892.5,-158.23 16892.5,-114.23 17169.5,-114.23 17169.5,-158.23"/>
<text text-anchor="middle" x="17031" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L0</text>
<text text-anchor="middle" x="17031" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="17031" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17031" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_1 -->
<g id="edge32" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_1</title>
<path fill="none" stroke="black" d="M17031,-193.87C17031,-185.59 17031,-176.62 17031,-168.3"/>
<polygon fill="black" stroke="black" points="17034.5,-168.23 17031,-158.23 17027.5,-168.23 17034.5,-168.23"/>
</g>
<!-- tp_0_4 -->
<g id="node28" class="node">
<title>tp_0_4</title>
<ellipse fill="lightblue" stroke="black" cx="16884" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="16884" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L0</text>
<text text-anchor="middle" x="16884" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="16884" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="16884" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_4_0&#45;&gt;tp_0_4 -->
<g id="edge33" class="edge">
<title>expert_0_4_0&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M16771.83,-114.14C16788.81,-104.14 16809.49,-91.97 16828.45,-80.81"/>
<polygon fill="black" stroke="black" points="16830.46,-83.69 16837.31,-75.6 16826.91,-77.65 16830.46,-83.69"/>
</g>
<!-- expert_0_4_1&#45;&gt;tp_0_4 -->
<g id="edge34" class="edge">
<title>expert_0_4_1&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M16995.42,-114.14C16978.62,-104.18 16958.18,-92.07 16939.42,-80.95"/>
<polygon fill="black" stroke="black" points="16941.04,-77.85 16930.65,-75.76 16937.47,-83.87 16941.04,-77.85"/>
</g>
<!-- expert_0_5_0 -->
<g id="node30" class="node">
<title>expert_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="17464.5,-158.23 17187.5,-158.23 17187.5,-114.23 17464.5,-114.23 17464.5,-158.23"/>
<text text-anchor="middle" x="17326" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L0</text>
<text text-anchor="middle" x="17326" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="17326" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17326" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_0 -->
<g id="edge36" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_0</title>
<path fill="none" stroke="black" d="M17530.08,-197.49C17490.92,-185.93 17445.49,-172.51 17407.44,-161.27"/>
<polygon fill="black" stroke="black" points="17408.01,-157.79 17397.43,-158.32 17406.03,-164.51 17408.01,-157.79"/>
</g>
<!-- expert_0_5_1 -->
<g id="node31" class="node">
<title>expert_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="17759.5,-158.23 17482.5,-158.23 17482.5,-114.23 17759.5,-114.23 17759.5,-158.23"/>
<text text-anchor="middle" x="17621" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L0</text>
<text text-anchor="middle" x="17621" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="17621" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17621" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_1 -->
<g id="edge37" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_1</title>
<path fill="none" stroke="black" d="M17621,-193.87C17621,-185.59 17621,-176.62 17621,-168.3"/>
<polygon fill="black" stroke="black" points="17624.5,-168.23 17621,-158.23 17617.5,-168.23 17624.5,-168.23"/>
</g>
<!-- tp_0_5 -->
<g id="node32" class="node">
<title>tp_0_5</title>
<ellipse fill="lightblue" stroke="black" cx="17473" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="17473" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L0</text>
<text text-anchor="middle" x="17473" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="17473" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="17473" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_5_0&#45;&gt;tp_0_5 -->
<g id="edge38" class="edge">
<title>expert_0_5_0&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M17361.58,-114.14C17378.38,-104.18 17398.82,-92.07 17417.58,-80.95"/>
<polygon fill="black" stroke="black" points="17419.53,-83.87 17426.35,-75.76 17415.96,-77.85 17419.53,-83.87"/>
</g>
<!-- expert_0_5_1&#45;&gt;tp_0_5 -->
<g id="edge39" class="edge">
<title>expert_0_5_1&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M17585.17,-114.14C17568.19,-104.14 17547.51,-91.97 17528.55,-80.81"/>
<polygon fill="black" stroke="black" points="17530.09,-77.65 17519.69,-75.6 17526.54,-83.69 17530.09,-77.65"/>
</g>
<!-- expert_0_6_0 -->
<g id="node34" class="node">
<title>expert_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="18054.5,-158.23 17777.5,-158.23 17777.5,-114.23 18054.5,-114.23 18054.5,-158.23"/>
<text text-anchor="middle" x="17916" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L0</text>
<text text-anchor="middle" x="17916" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="17916" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17916" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_0 -->
<g id="edge41" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_0</title>
<path fill="none" stroke="black" d="M18120.08,-197.49C18080.92,-185.93 18035.49,-172.51 17997.44,-161.27"/>
<polygon fill="black" stroke="black" points="17998.01,-157.79 17987.43,-158.32 17996.03,-164.51 17998.01,-157.79"/>
</g>
<!-- expert_0_6_1 -->
<g id="node35" class="node">
<title>expert_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="18349.5,-158.23 18072.5,-158.23 18072.5,-114.23 18349.5,-114.23 18349.5,-158.23"/>
<text text-anchor="middle" x="18211" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L0</text>
<text text-anchor="middle" x="18211" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="18211" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18211" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_1 -->
<g id="edge42" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_1</title>
<path fill="none" stroke="black" d="M18211,-193.87C18211,-185.59 18211,-176.62 18211,-168.3"/>
<polygon fill="black" stroke="black" points="18214.5,-168.23 18211,-158.23 18207.5,-168.23 18214.5,-168.23"/>
</g>
<!-- tp_0_6 -->
<g id="node36" class="node">
<title>tp_0_6</title>
<ellipse fill="lightblue" stroke="black" cx="18063" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="18063" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L0</text>
<text text-anchor="middle" x="18063" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="18063" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="18063" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_6_0&#45;&gt;tp_0_6 -->
<g id="edge43" class="edge">
<title>expert_0_6_0&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M17951.58,-114.14C17968.38,-104.18 17988.82,-92.07 18007.58,-80.95"/>
<polygon fill="black" stroke="black" points="18009.53,-83.87 18016.35,-75.76 18005.96,-77.85 18009.53,-83.87"/>
</g>
<!-- expert_0_6_1&#45;&gt;tp_0_6 -->
<g id="edge44" class="edge">
<title>expert_0_6_1&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M18175.17,-114.14C18158.19,-104.14 18137.51,-91.97 18118.55,-80.81"/>
<polygon fill="black" stroke="black" points="18120.09,-77.65 18109.69,-75.6 18116.54,-83.69 18120.09,-77.65"/>
</g>
<!-- expert_0_7_0 -->
<g id="node38" class="node">
<title>expert_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="18644.5,-158.23 18367.5,-158.23 18367.5,-114.23 18644.5,-114.23 18644.5,-158.23"/>
<text text-anchor="middle" x="18506" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L0</text>
<text text-anchor="middle" x="18506" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="18506" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18506" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_0 -->
<g id="edge46" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_0</title>
<path fill="none" stroke="black" d="M18710.08,-197.49C18670.92,-185.93 18625.49,-172.51 18587.44,-161.27"/>
<polygon fill="black" stroke="black" points="18588.01,-157.79 18577.43,-158.32 18586.03,-164.51 18588.01,-157.79"/>
</g>
<!-- expert_0_7_1 -->
<g id="node39" class="node">
<title>expert_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="18939.5,-158.23 18662.5,-158.23 18662.5,-114.23 18939.5,-114.23 18939.5,-158.23"/>
<text text-anchor="middle" x="18801" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L0</text>
<text text-anchor="middle" x="18801" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="18801" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18801" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_1 -->
<g id="edge47" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_1</title>
<path fill="none" stroke="black" d="M18801,-193.87C18801,-185.59 18801,-176.62 18801,-168.3"/>
<polygon fill="black" stroke="black" points="18804.5,-168.23 18801,-158.23 18797.5,-168.23 18804.5,-168.23"/>
</g>
<!-- tp_0_7 -->
<g id="node40" class="node">
<title>tp_0_7</title>
<ellipse fill="lightblue" stroke="black" cx="18653" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="18653" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L0</text>
<text text-anchor="middle" x="18653" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="18653" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="18653" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_7_0&#45;&gt;tp_0_7 -->
<g id="edge48" class="edge">
<title>expert_0_7_0&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M18541.58,-114.14C18558.38,-104.18 18578.82,-92.07 18597.58,-80.95"/>
<polygon fill="black" stroke="black" points="18599.53,-83.87 18606.35,-75.76 18595.96,-77.85 18599.53,-83.87"/>
</g>
<!-- expert_0_7_1&#45;&gt;tp_0_7 -->
<g id="edge49" class="edge">
<title>expert_0_7_1&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M18765.17,-114.14C18748.19,-104.14 18727.51,-91.97 18708.55,-80.81"/>
<polygon fill="black" stroke="black" points="18710.09,-77.65 18699.69,-75.6 18706.54,-83.69 18710.09,-77.65"/>
</g>
<!-- expert_0_8_0 -->
<g id="node42" class="node">
<title>expert_0_8_0</title>
<polygon fill="lightgreen" stroke="black" points="19234.5,-158.23 18957.5,-158.23 18957.5,-114.23 19234.5,-114.23 19234.5,-158.23"/>
<text text-anchor="middle" x="19096" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L0</text>
<text text-anchor="middle" x="19096" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="19096" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19096" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_0 -->
<g id="edge51" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_0</title>
<path fill="none" stroke="black" d="M19193.64,-195.09C19176.47,-184.91 19157.32,-173.56 19140.56,-163.63"/>
<polygon fill="black" stroke="black" points="19141.91,-160.36 19131.52,-158.28 19138.34,-166.39 19141.91,-160.36"/>
</g>
<!-- expert_0_8_1 -->
<g id="node43" class="node">
<title>expert_0_8_1</title>
<polygon fill="lightgreen" stroke="black" points="19529.5,-158.23 19252.5,-158.23 19252.5,-114.23 19529.5,-114.23 19529.5,-158.23"/>
<text text-anchor="middle" x="19391" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L0</text>
<text text-anchor="middle" x="19391" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="19391" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19391" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_1 -->
<g id="edge52" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_1</title>
<path fill="none" stroke="black" d="M19292.69,-195.09C19310.14,-184.82 19329.62,-173.35 19346.6,-163.36"/>
<polygon fill="black" stroke="black" points="19348.39,-166.37 19355.24,-158.28 19344.84,-160.33 19348.39,-166.37"/>
</g>
<!-- tp_0_8 -->
<g id="node44" class="node">
<title>tp_0_8</title>
<ellipse fill="lightblue" stroke="black" cx="19243" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="19243" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L0</text>
<text text-anchor="middle" x="19243" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="19243" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="19243" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_8_0&#45;&gt;tp_0_8 -->
<g id="edge53" class="edge">
<title>expert_0_8_0&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M19131.58,-114.14C19148.38,-104.18 19168.82,-92.07 19187.58,-80.95"/>
<polygon fill="black" stroke="black" points="19189.53,-83.87 19196.35,-75.76 19185.96,-77.85 19189.53,-83.87"/>
</g>
<!-- expert_0_8_1&#45;&gt;tp_0_8 -->
<g id="edge54" class="edge">
<title>expert_0_8_1&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M19355.17,-114.14C19338.19,-104.14 19317.51,-91.97 19298.55,-80.81"/>
<polygon fill="black" stroke="black" points="19300.09,-77.65 19289.69,-75.6 19296.54,-83.69 19300.09,-77.65"/>
</g>
<!-- expert_0_9_0 -->
<g id="node46" class="node">
<title>expert_0_9_0</title>
<polygon fill="lightgreen" stroke="black" points="19824.5,-158.23 19547.5,-158.23 19547.5,-114.23 19824.5,-114.23 19824.5,-158.23"/>
<text text-anchor="middle" x="19686" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L0</text>
<text text-anchor="middle" x="19686" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="19686" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19686" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_0 -->
<g id="edge56" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_0</title>
<path fill="none" stroke="black" d="M19686,-193.87C19686,-185.59 19686,-176.62 19686,-168.3"/>
<polygon fill="black" stroke="black" points="19689.5,-168.23 19686,-158.23 19682.5,-168.23 19689.5,-168.23"/>
</g>
<!-- expert_0_9_1 -->
<g id="node47" class="node">
<title>expert_0_9_1</title>
<polygon fill="lightgreen" stroke="black" points="20119.5,-158.23 19842.5,-158.23 19842.5,-114.23 20119.5,-114.23 20119.5,-158.23"/>
<text text-anchor="middle" x="19981" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L0</text>
<text text-anchor="middle" x="19981" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="19981" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19981" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_1 -->
<g id="edge57" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_1</title>
<path fill="none" stroke="black" d="M19776.92,-197.49C19816.08,-185.93 19861.51,-172.51 19899.56,-161.27"/>
<polygon fill="black" stroke="black" points="19900.97,-164.51 19909.57,-158.32 19898.99,-157.79 19900.97,-164.51"/>
</g>
<!-- tp_0_9 -->
<g id="node48" class="node">
<title>tp_0_9</title>
<ellipse fill="lightblue" stroke="black" cx="19833" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="19833" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L0</text>
<text text-anchor="middle" x="19833" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="19833" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="19833" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_9_0&#45;&gt;tp_0_9 -->
<g id="edge58" class="edge">
<title>expert_0_9_0&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M19721.58,-114.14C19738.38,-104.18 19758.82,-92.07 19777.58,-80.95"/>
<polygon fill="black" stroke="black" points="19779.53,-83.87 19786.35,-75.76 19775.96,-77.85 19779.53,-83.87"/>
</g>
<!-- expert_0_9_1&#45;&gt;tp_0_9 -->
<g id="edge59" class="edge">
<title>expert_0_9_1&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M19945.17,-114.14C19928.19,-104.14 19907.51,-91.97 19888.55,-80.81"/>
<polygon fill="black" stroke="black" points="19890.09,-77.65 19879.69,-75.6 19886.54,-83.69 19890.09,-77.65"/>
</g>
<!-- expert_0_10_0 -->
<g id="node50" class="node">
<title>expert_0_10_0</title>
<polygon fill="lightgreen" stroke="black" points="20414.5,-158.23 20137.5,-158.23 20137.5,-114.23 20414.5,-114.23 20414.5,-158.23"/>
<text text-anchor="middle" x="20276" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L0</text>
<text text-anchor="middle" x="20276" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="20276" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20276" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_0 -->
<g id="edge61" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_0</title>
<path fill="none" stroke="black" d="M20276,-193.87C20276,-185.59 20276,-176.62 20276,-168.3"/>
<polygon fill="black" stroke="black" points="20279.5,-168.23 20276,-158.23 20272.5,-168.23 20279.5,-168.23"/>
</g>
<!-- expert_0_10_1 -->
<g id="node51" class="node">
<title>expert_0_10_1</title>
<polygon fill="lightgreen" stroke="black" points="20709.5,-158.23 20432.5,-158.23 20432.5,-114.23 20709.5,-114.23 20709.5,-158.23"/>
<text text-anchor="middle" x="20571" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L0</text>
<text text-anchor="middle" x="20571" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="20571" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20571" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_1 -->
<g id="edge62" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_1</title>
<path fill="none" stroke="black" d="M20366.92,-197.49C20406.08,-185.93 20451.51,-172.51 20489.56,-161.27"/>
<polygon fill="black" stroke="black" points="20490.97,-164.51 20499.57,-158.32 20488.99,-157.79 20490.97,-164.51"/>
</g>
<!-- tp_0_10 -->
<g id="node52" class="node">
<title>tp_0_10</title>
<ellipse fill="lightblue" stroke="black" cx="20423" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="20423" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L0</text>
<text text-anchor="middle" x="20423" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="20423" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="20423" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_10_0&#45;&gt;tp_0_10 -->
<g id="edge63" class="edge">
<title>expert_0_10_0&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M20311.58,-114.14C20328.38,-104.18 20348.82,-92.07 20367.58,-80.95"/>
<polygon fill="black" stroke="black" points="20369.53,-83.87 20376.35,-75.76 20365.96,-77.85 20369.53,-83.87"/>
</g>
<!-- expert_0_10_1&#45;&gt;tp_0_10 -->
<g id="edge64" class="edge">
<title>expert_0_10_1&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M20535.17,-114.14C20518.19,-104.14 20497.51,-91.97 20478.55,-80.81"/>
<polygon fill="black" stroke="black" points="20480.09,-77.65 20469.69,-75.6 20476.54,-83.69 20480.09,-77.65"/>
</g>
<!-- expert_0_11_0 -->
<g id="node54" class="node">
<title>expert_0_11_0</title>
<polygon fill="lightgreen" stroke="black" points="21004.5,-158.23 20727.5,-158.23 20727.5,-114.23 21004.5,-114.23 21004.5,-158.23"/>
<text text-anchor="middle" x="20866" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L0</text>
<text text-anchor="middle" x="20866" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="20866" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20866" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_0 -->
<g id="edge66" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_0</title>
<path fill="none" stroke="black" d="M20866,-193.87C20866,-185.59 20866,-176.62 20866,-168.3"/>
<polygon fill="black" stroke="black" points="20869.5,-168.23 20866,-158.23 20862.5,-168.23 20869.5,-168.23"/>
</g>
<!-- expert_0_11_1 -->
<g id="node55" class="node">
<title>expert_0_11_1</title>
<polygon fill="lightgreen" stroke="black" points="21299.5,-158.23 21022.5,-158.23 21022.5,-114.23 21299.5,-114.23 21299.5,-158.23"/>
<text text-anchor="middle" x="21161" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L0</text>
<text text-anchor="middle" x="21161" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="21161" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21161" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_1 -->
<g id="edge67" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_1</title>
<path fill="none" stroke="black" d="M20956.92,-197.49C20996.08,-185.93 21041.51,-172.51 21079.56,-161.27"/>
<polygon fill="black" stroke="black" points="21080.97,-164.51 21089.57,-158.32 21078.99,-157.79 21080.97,-164.51"/>
</g>
<!-- tp_0_11 -->
<g id="node56" class="node">
<title>tp_0_11</title>
<ellipse fill="lightblue" stroke="black" cx="21013" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="21013" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L0</text>
<text text-anchor="middle" x="21013" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="21013" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="21013" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_11_0&#45;&gt;tp_0_11 -->
<g id="edge68" class="edge">
<title>expert_0_11_0&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M20901.58,-114.14C20918.38,-104.18 20938.82,-92.07 20957.58,-80.95"/>
<polygon fill="black" stroke="black" points="20959.53,-83.87 20966.35,-75.76 20955.96,-77.85 20959.53,-83.87"/>
</g>
<!-- expert_0_11_1&#45;&gt;tp_0_11 -->
<g id="edge69" class="edge">
<title>expert_0_11_1&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M21125.17,-114.14C21108.19,-104.14 21087.51,-91.97 21068.55,-80.81"/>
<polygon fill="black" stroke="black" points="21070.09,-77.65 21059.69,-75.6 21066.54,-83.69 21070.09,-77.65"/>
</g>
<!-- expert_0_12_0 -->
<g id="node58" class="node">
<title>expert_0_12_0</title>
<polygon fill="lightgreen" stroke="black" points="21594.5,-158.23 21317.5,-158.23 21317.5,-114.23 21594.5,-114.23 21594.5,-158.23"/>
<text text-anchor="middle" x="21456" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L0</text>
<text text-anchor="middle" x="21456" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="21456" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21456" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_0 -->
<g id="edge71" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_0</title>
<path fill="none" stroke="black" d="M21456,-193.87C21456,-185.59 21456,-176.62 21456,-168.3"/>
<polygon fill="black" stroke="black" points="21459.5,-168.23 21456,-158.23 21452.5,-168.23 21459.5,-168.23"/>
</g>
<!-- expert_0_12_1 -->
<g id="node59" class="node">
<title>expert_0_12_1</title>
<polygon fill="lightgreen" stroke="black" points="21889.5,-158.23 21612.5,-158.23 21612.5,-114.23 21889.5,-114.23 21889.5,-158.23"/>
<text text-anchor="middle" x="21751" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L0</text>
<text text-anchor="middle" x="21751" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="21751" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21751" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_1 -->
<g id="edge72" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_1</title>
<path fill="none" stroke="black" d="M21546.92,-197.49C21586.08,-185.93 21631.51,-172.51 21669.56,-161.27"/>
<polygon fill="black" stroke="black" points="21670.97,-164.51 21679.57,-158.32 21668.99,-157.79 21670.97,-164.51"/>
</g>
<!-- tp_0_12 -->
<g id="node60" class="node">
<title>tp_0_12</title>
<ellipse fill="lightblue" stroke="black" cx="21603" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="21603" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L0</text>
<text text-anchor="middle" x="21603" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="21603" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="21603" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_12_0&#45;&gt;tp_0_12 -->
<g id="edge73" class="edge">
<title>expert_0_12_0&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M21491.58,-114.14C21508.38,-104.18 21528.82,-92.07 21547.58,-80.95"/>
<polygon fill="black" stroke="black" points="21549.53,-83.87 21556.35,-75.76 21545.96,-77.85 21549.53,-83.87"/>
</g>
<!-- expert_0_12_1&#45;&gt;tp_0_12 -->
<g id="edge74" class="edge">
<title>expert_0_12_1&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M21715.17,-114.14C21698.19,-104.14 21677.51,-91.97 21658.55,-80.81"/>
<polygon fill="black" stroke="black" points="21660.09,-77.65 21649.69,-75.6 21656.54,-83.69 21660.09,-77.65"/>
</g>
<!-- expert_0_13_0 -->
<g id="node62" class="node">
<title>expert_0_13_0</title>
<polygon fill="lightgreen" stroke="black" points="22184.5,-158.23 21907.5,-158.23 21907.5,-114.23 22184.5,-114.23 22184.5,-158.23"/>
<text text-anchor="middle" x="22046" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L0</text>
<text text-anchor="middle" x="22046" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="22046" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22046" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_0 -->
<g id="edge76" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_0</title>
<path fill="none" stroke="black" d="M22046,-193.87C22046,-185.59 22046,-176.62 22046,-168.3"/>
<polygon fill="black" stroke="black" points="22049.5,-168.23 22046,-158.23 22042.5,-168.23 22049.5,-168.23"/>
</g>
<!-- expert_0_13_1 -->
<g id="node63" class="node">
<title>expert_0_13_1</title>
<polygon fill="lightgreen" stroke="black" points="22479.5,-158.23 22202.5,-158.23 22202.5,-114.23 22479.5,-114.23 22479.5,-158.23"/>
<text text-anchor="middle" x="22341" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L0</text>
<text text-anchor="middle" x="22341" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="22341" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22341" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_1 -->
<g id="edge77" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_1</title>
<path fill="none" stroke="black" d="M22136.92,-197.49C22176.08,-185.93 22221.51,-172.51 22259.56,-161.27"/>
<polygon fill="black" stroke="black" points="22260.97,-164.51 22269.57,-158.32 22258.99,-157.79 22260.97,-164.51"/>
</g>
<!-- tp_0_13 -->
<g id="node64" class="node">
<title>tp_0_13</title>
<ellipse fill="lightblue" stroke="black" cx="22193" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="22193" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L0</text>
<text text-anchor="middle" x="22193" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="22193" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="22193" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_13_0&#45;&gt;tp_0_13 -->
<g id="edge78" class="edge">
<title>expert_0_13_0&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M22081.58,-114.14C22098.38,-104.18 22118.82,-92.07 22137.58,-80.95"/>
<polygon fill="black" stroke="black" points="22139.53,-83.87 22146.35,-75.76 22135.96,-77.85 22139.53,-83.87"/>
</g>
<!-- expert_0_13_1&#45;&gt;tp_0_13 -->
<g id="edge79" class="edge">
<title>expert_0_13_1&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M22305.17,-114.14C22288.19,-104.14 22267.51,-91.97 22248.55,-80.81"/>
<polygon fill="black" stroke="black" points="22250.09,-77.65 22239.69,-75.6 22246.54,-83.69 22250.09,-77.65"/>
</g>
<!-- expert_0_14_0 -->
<g id="node66" class="node">
<title>expert_0_14_0</title>
<polygon fill="lightgreen" stroke="black" points="22774.5,-158.23 22497.5,-158.23 22497.5,-114.23 22774.5,-114.23 22774.5,-158.23"/>
<text text-anchor="middle" x="22636" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L0</text>
<text text-anchor="middle" x="22636" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="22636" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22636" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_0 -->
<g id="edge81" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_0</title>
<path fill="none" stroke="black" d="M22636,-193.87C22636,-185.59 22636,-176.62 22636,-168.3"/>
<polygon fill="black" stroke="black" points="22639.5,-168.23 22636,-158.23 22632.5,-168.23 22639.5,-168.23"/>
</g>
<!-- expert_0_14_1 -->
<g id="node67" class="node">
<title>expert_0_14_1</title>
<polygon fill="lightgreen" stroke="black" points="23069.5,-158.23 22792.5,-158.23 22792.5,-114.23 23069.5,-114.23 23069.5,-158.23"/>
<text text-anchor="middle" x="22931" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L0</text>
<text text-anchor="middle" x="22931" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="22931" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22931" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_1 -->
<g id="edge82" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_1</title>
<path fill="none" stroke="black" d="M22726.92,-197.49C22766.08,-185.93 22811.51,-172.51 22849.56,-161.27"/>
<polygon fill="black" stroke="black" points="22850.97,-164.51 22859.57,-158.32 22848.99,-157.79 22850.97,-164.51"/>
</g>
<!-- tp_0_14 -->
<g id="node68" class="node">
<title>tp_0_14</title>
<ellipse fill="lightblue" stroke="black" cx="22783" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="22783" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L0</text>
<text text-anchor="middle" x="22783" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="22783" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="22783" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_14_0&#45;&gt;tp_0_14 -->
<g id="edge83" class="edge">
<title>expert_0_14_0&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M22671.58,-114.14C22688.38,-104.18 22708.82,-92.07 22727.58,-80.95"/>
<polygon fill="black" stroke="black" points="22729.53,-83.87 22736.35,-75.76 22725.96,-77.85 22729.53,-83.87"/>
</g>
<!-- expert_0_14_1&#45;&gt;tp_0_14 -->
<g id="edge84" class="edge">
<title>expert_0_14_1&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M22895.17,-114.14C22878.19,-104.14 22857.51,-91.97 22838.55,-80.81"/>
<polygon fill="black" stroke="black" points="22840.09,-77.65 22829.69,-75.6 22836.54,-83.69 22840.09,-77.65"/>
</g>
<!-- expert_0_15_0 -->
<g id="node70" class="node">
<title>expert_0_15_0</title>
<polygon fill="lightgreen" stroke="black" points="23364.5,-158.23 23087.5,-158.23 23087.5,-114.23 23364.5,-114.23 23364.5,-158.23"/>
<text text-anchor="middle" x="23226" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L0</text>
<text text-anchor="middle" x="23226" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="23226" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23226" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_0 -->
<g id="edge86" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_0</title>
<path fill="none" stroke="black" d="M23226,-193.87C23226,-185.59 23226,-176.62 23226,-168.3"/>
<polygon fill="black" stroke="black" points="23229.5,-168.23 23226,-158.23 23222.5,-168.23 23229.5,-168.23"/>
</g>
<!-- expert_0_15_1 -->
<g id="node71" class="node">
<title>expert_0_15_1</title>
<polygon fill="lightgreen" stroke="black" points="23659.5,-158.23 23382.5,-158.23 23382.5,-114.23 23659.5,-114.23 23659.5,-158.23"/>
<text text-anchor="middle" x="23521" y="-149.03" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L0</text>
<text text-anchor="middle" x="23521" y="-139.03" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="23521" y="-129.03" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23521" y="-119.03" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_1 -->
<g id="edge87" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_1</title>
<path fill="none" stroke="black" d="M23316.92,-197.49C23356.08,-185.93 23401.51,-172.51 23439.56,-161.27"/>
<polygon fill="black" stroke="black" points="23440.97,-164.51 23449.57,-158.32 23438.99,-157.79 23440.97,-164.51"/>
</g>
<!-- tp_0_15 -->
<g id="node72" class="node">
<title>tp_0_15</title>
<ellipse fill="lightblue" stroke="black" cx="23373" cy="-47.11" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="23373" y="-59.91" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L0</text>
<text text-anchor="middle" x="23373" y="-49.91" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="23373" y="-39.91" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="23373" y="-29.91" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_15_0&#45;&gt;tp_0_15 -->
<g id="edge88" class="edge">
<title>expert_0_15_0&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M23261.58,-114.14C23278.38,-104.18 23298.82,-92.07 23317.58,-80.95"/>
<polygon fill="black" stroke="black" points="23319.53,-83.87 23326.35,-75.76 23315.96,-77.85 23319.53,-83.87"/>
</g>
<!-- expert_0_15_1&#45;&gt;tp_0_15 -->
<g id="edge89" class="edge">
<title>expert_0_15_1&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M23485.17,-114.14C23468.19,-104.14 23447.51,-91.97 23428.55,-80.81"/>
<polygon fill="black" stroke="black" points="23430.09,-77.65 23419.69,-75.6 23426.54,-83.69 23430.09,-77.65"/>
</g>
<!-- q_proj_1 -->
<g id="node73" class="node">
<title>q_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="22718,-722.45 22422,-722.45 22422,-678.45 22718,-678.45 22718,-722.45"/>
<text text-anchor="middle" x="22570" y="-713.25" font-family="Times,serif" font-size="9.00">Q Projection L1</text>
<text text-anchor="middle" x="22570" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="22570" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22570" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_1 -->
<g id="node74" class="node">
<title>k_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="22404,-722.45 22108,-722.45 22108,-678.45 22404,-678.45 22404,-722.45"/>
<text text-anchor="middle" x="22256" y="-713.25" font-family="Times,serif" font-size="9.00">K Projection L1</text>
<text text-anchor="middle" x="22256" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="22256" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="22256" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_1 -->
<g id="node75" class="node">
<title>v_proj_1</title>
<polygon fill="lightgreen" stroke="black" points="22090,-722.45 21794,-722.45 21794,-678.45 22090,-678.45 22090,-722.45"/>
<text text-anchor="middle" x="21942" y="-713.25" font-family="Times,serif" font-size="9.00">V Projection L1</text>
<text text-anchor="middle" x="21942" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="21942" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21942" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_1 -->
<g id="node76" class="node">
<title>attn_scores_1</title>
<polygon fill="lightgreen" stroke="black" points="21775.5,-722.45 21442.5,-722.45 21442.5,-678.45 21775.5,-678.45 21775.5,-722.45"/>
<text text-anchor="middle" x="21609" y="-713.25" font-family="Times,serif" font-size="9.00">Attention Scores L1</text>
<text text-anchor="middle" x="21609" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="21609" y="-693.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="21609" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_1 -->
<g id="node77" class="node">
<title>softmax_1</title>
<polygon fill="lightgreen" stroke="black" points="21424.5,-722.45 21091.5,-722.45 21091.5,-678.45 21424.5,-678.45 21424.5,-722.45"/>
<text text-anchor="middle" x="21258" y="-713.25" font-family="Times,serif" font-size="9.00">Softmax L1</text>
<text text-anchor="middle" x="21258" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="21258" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="21258" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_1 -->
<g id="node78" class="node">
<title>attn_out_1</title>
<polygon fill="lightgreen" stroke="black" points="21073,-722.45 20777,-722.45 20777,-678.45 21073,-678.45 21073,-722.45"/>
<text text-anchor="middle" x="20925" y="-713.25" font-family="Times,serif" font-size="9.00">Attention Output L1</text>
<text text-anchor="middle" x="20925" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;31</text>
<text text-anchor="middle" x="20925" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20925" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_1 -->
<g id="node79" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="20758.74,-744.45 20281.92,-744.45 20159.26,-656.45 20636.08,-656.45 20758.74,-744.45"/>
<text text-anchor="middle" x="20459" y="-713.25" font-family="Times,serif" font-size="9.00">Gate L1</text>
<text text-anchor="middle" x="20459" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0&#45;63</text>
<text text-anchor="middle" x="20459" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="20459" y="-683.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_1_0 -->
<g id="node80" class="node">
<title>route_1_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="19941" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="19941" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="19941" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="19941" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19941" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_0_0 -->
<g id="node81" class="node">
<title>expert_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="19722.5,-722.45 19445.5,-722.45 19445.5,-678.45 19722.5,-678.45 19722.5,-722.45"/>
<text text-anchor="middle" x="19584" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L1</text>
<text text-anchor="middle" x="19584" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="19584" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19584" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_0_1 -->
<g id="node82" class="node">
<title>expert_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="19427.5,-722.45 19150.5,-722.45 19150.5,-678.45 19427.5,-678.45 19427.5,-722.45"/>
<text text-anchor="middle" x="19289" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L1</text>
<text text-anchor="middle" x="19289" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="19289" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="19289" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_0 -->
<g id="node83" class="node">
<title>tp_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="19017" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="19017" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L1</text>
<text text-anchor="middle" x="19017" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="19017" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="19017" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_1 -->
<g id="node84" class="node">
<title>route_1_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="18682" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="18682" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="18682" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="18682" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18682" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_1_0 -->
<g id="node85" class="node">
<title>expert_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="18463.5,-722.45 18186.5,-722.45 18186.5,-678.45 18463.5,-678.45 18463.5,-722.45"/>
<text text-anchor="middle" x="18325" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L1</text>
<text text-anchor="middle" x="18325" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="18325" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18325" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_1_1 -->
<g id="node86" class="node">
<title>expert_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18168.5,-722.45 17891.5,-722.45 17891.5,-678.45 18168.5,-678.45 18168.5,-722.45"/>
<text text-anchor="middle" x="18030" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L1</text>
<text text-anchor="middle" x="18030" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="18030" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="18030" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_1 -->
<g id="node87" class="node">
<title>tp_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="17758" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="17758" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L1</text>
<text text-anchor="middle" x="17758" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="17758" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="17758" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_2 -->
<g id="node88" class="node">
<title>route_1_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="17423" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="17423" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="17423" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="17423" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17423" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_2_0 -->
<g id="node89" class="node">
<title>expert_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="17204.5,-722.45 16927.5,-722.45 16927.5,-678.45 17204.5,-678.45 17204.5,-722.45"/>
<text text-anchor="middle" x="17066" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L1</text>
<text text-anchor="middle" x="17066" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="17066" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="17066" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_2_1 -->
<g id="node90" class="node">
<title>expert_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="16909.5,-722.45 16632.5,-722.45 16632.5,-678.45 16909.5,-678.45 16909.5,-722.45"/>
<text text-anchor="middle" x="16771" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L1</text>
<text text-anchor="middle" x="16771" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="16771" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16771" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_2 -->
<g id="node91" class="node">
<title>tp_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="16499" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="16499" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L1</text>
<text text-anchor="middle" x="16499" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="16499" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="16499" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_3 -->
<g id="node92" class="node">
<title>route_1_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="16164" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="16164" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="16164" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="16164" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="16164" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_3_0 -->
<g id="node93" class="node">
<title>expert_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="15945.5,-722.45 15668.5,-722.45 15668.5,-678.45 15945.5,-678.45 15945.5,-722.45"/>
<text text-anchor="middle" x="15807" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L1</text>
<text text-anchor="middle" x="15807" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="15807" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15807" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_3_1 -->
<g id="node94" class="node">
<title>expert_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="15650.5,-722.45 15373.5,-722.45 15373.5,-678.45 15650.5,-678.45 15650.5,-722.45"/>
<text text-anchor="middle" x="15512" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L1</text>
<text text-anchor="middle" x="15512" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="15512" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="15512" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_3 -->
<g id="node95" class="node">
<title>tp_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="15240" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="15240" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L1</text>
<text text-anchor="middle" x="15240" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="15240" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="15240" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_4 -->
<g id="node96" class="node">
<title>route_1_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="14905" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="14905" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="14905" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="14905" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14905" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_4_0 -->
<g id="node97" class="node">
<title>expert_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="14686.5,-722.45 14409.5,-722.45 14409.5,-678.45 14686.5,-678.45 14686.5,-722.45"/>
<text text-anchor="middle" x="14548" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L1</text>
<text text-anchor="middle" x="14548" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="14548" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14548" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_4_1 -->
<g id="node98" class="node">
<title>expert_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="14391.5,-722.45 14114.5,-722.45 14114.5,-678.45 14391.5,-678.45 14391.5,-722.45"/>
<text text-anchor="middle" x="14253" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L1</text>
<text text-anchor="middle" x="14253" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="14253" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="14253" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_4 -->
<g id="node99" class="node">
<title>tp_1_4</title>
<ellipse fill="lightblue" stroke="black" cx="13981" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="13981" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L1</text>
<text text-anchor="middle" x="13981" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="13981" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="13981" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_5 -->
<g id="node100" class="node">
<title>route_1_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="13646" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="13646" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="13646" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="13646" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="13646" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_5_0 -->
<g id="node101" class="node">
<title>expert_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="13427.5,-722.45 13150.5,-722.45 13150.5,-678.45 13427.5,-678.45 13427.5,-722.45"/>
<text text-anchor="middle" x="13289" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L1</text>
<text text-anchor="middle" x="13289" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="13289" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="13289" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_5_1 -->
<g id="node102" class="node">
<title>expert_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="13132.5,-722.45 12855.5,-722.45 12855.5,-678.45 13132.5,-678.45 13132.5,-722.45"/>
<text text-anchor="middle" x="12994" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L1</text>
<text text-anchor="middle" x="12994" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="12994" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12994" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_5 -->
<g id="node103" class="node">
<title>tp_1_5</title>
<ellipse fill="lightblue" stroke="black" cx="12722" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="12722" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L1</text>
<text text-anchor="middle" x="12722" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="12722" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="12722" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_6 -->
<g id="node104" class="node">
<title>route_1_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="12387" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="12387" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="12387" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="12387" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12387" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_6_0 -->
<g id="node105" class="node">
<title>expert_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="12168.5,-722.45 11891.5,-722.45 11891.5,-678.45 12168.5,-678.45 12168.5,-722.45"/>
<text text-anchor="middle" x="12030" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L1</text>
<text text-anchor="middle" x="12030" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="12030" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="12030" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_6_1 -->
<g id="node106" class="node">
<title>expert_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="11873.5,-722.45 11596.5,-722.45 11596.5,-678.45 11873.5,-678.45 11873.5,-722.45"/>
<text text-anchor="middle" x="11735" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L1</text>
<text text-anchor="middle" x="11735" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="11735" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="11735" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_6 -->
<g id="node107" class="node">
<title>tp_1_6</title>
<ellipse fill="lightblue" stroke="black" cx="11463" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="11463" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L1</text>
<text text-anchor="middle" x="11463" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="11463" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="11463" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_7 -->
<g id="node108" class="node">
<title>route_1_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="11128" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="11128" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="11128" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="11128" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="11128" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_7_0 -->
<g id="node109" class="node">
<title>expert_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="10909.5,-722.45 10632.5,-722.45 10632.5,-678.45 10909.5,-678.45 10909.5,-722.45"/>
<text text-anchor="middle" x="10771" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L1</text>
<text text-anchor="middle" x="10771" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="10771" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="10771" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_7_1 -->
<g id="node110" class="node">
<title>expert_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="10614.5,-722.45 10337.5,-722.45 10337.5,-678.45 10614.5,-678.45 10614.5,-722.45"/>
<text text-anchor="middle" x="10476" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L1</text>
<text text-anchor="middle" x="10476" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="10476" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="10476" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_7 -->
<g id="node111" class="node">
<title>tp_1_7</title>
<ellipse fill="lightblue" stroke="black" cx="10204" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="10204" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L1</text>
<text text-anchor="middle" x="10204" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="10204" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="10204" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_8 -->
<g id="node112" class="node">
<title>route_1_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9869" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9869" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="9869" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="9869" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9869" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_8_0 -->
<g id="node113" class="node">
<title>expert_1_8_0</title>
<polygon fill="lightgreen" stroke="black" points="9650.5,-722.45 9373.5,-722.45 9373.5,-678.45 9650.5,-678.45 9650.5,-722.45"/>
<text text-anchor="middle" x="9512" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L1</text>
<text text-anchor="middle" x="9512" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="9512" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9512" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_8_1 -->
<g id="node114" class="node">
<title>expert_1_8_1</title>
<polygon fill="lightgreen" stroke="black" points="9355.5,-722.45 9078.5,-722.45 9078.5,-678.45 9355.5,-678.45 9355.5,-722.45"/>
<text text-anchor="middle" x="9217" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L1</text>
<text text-anchor="middle" x="9217" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="9217" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9217" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_8 -->
<g id="node115" class="node">
<title>tp_1_8</title>
<ellipse fill="lightblue" stroke="black" cx="8945" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8945" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L1</text>
<text text-anchor="middle" x="8945" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="8945" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8945" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_9 -->
<g id="node116" class="node">
<title>route_1_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8610" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8610" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="8610" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="8610" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8610" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_9_0 -->
<g id="node117" class="node">
<title>expert_1_9_0</title>
<polygon fill="lightgreen" stroke="black" points="8391.5,-722.45 8114.5,-722.45 8114.5,-678.45 8391.5,-678.45 8391.5,-722.45"/>
<text text-anchor="middle" x="8253" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L1</text>
<text text-anchor="middle" x="8253" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="8253" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8253" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_9_1 -->
<g id="node118" class="node">
<title>expert_1_9_1</title>
<polygon fill="lightgreen" stroke="black" points="8096.5,-722.45 7819.5,-722.45 7819.5,-678.45 8096.5,-678.45 8096.5,-722.45"/>
<text text-anchor="middle" x="7958" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L1</text>
<text text-anchor="middle" x="7958" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="7958" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7958" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_9 -->
<g id="node119" class="node">
<title>tp_1_9</title>
<ellipse fill="lightblue" stroke="black" cx="7686" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7686" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L1</text>
<text text-anchor="middle" x="7686" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="7686" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7686" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_10 -->
<g id="node120" class="node">
<title>route_1_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7351" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7351" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="7351" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="7351" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7351" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_10_0 -->
<g id="node121" class="node">
<title>expert_1_10_0</title>
<polygon fill="lightgreen" stroke="black" points="7132.5,-722.45 6855.5,-722.45 6855.5,-678.45 7132.5,-678.45 7132.5,-722.45"/>
<text text-anchor="middle" x="6994" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L1</text>
<text text-anchor="middle" x="6994" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="6994" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6994" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_10_1 -->
<g id="node122" class="node">
<title>expert_1_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6837.5,-722.45 6560.5,-722.45 6560.5,-678.45 6837.5,-678.45 6837.5,-722.45"/>
<text text-anchor="middle" x="6699" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L1</text>
<text text-anchor="middle" x="6699" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="6699" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6699" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_10 -->
<g id="node123" class="node">
<title>tp_1_10</title>
<ellipse fill="lightblue" stroke="black" cx="6427" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6427" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L1</text>
<text text-anchor="middle" x="6427" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="6427" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6427" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_11 -->
<g id="node124" class="node">
<title>route_1_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6092" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6092" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6092" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="6092" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6092" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_11_0 -->
<g id="node125" class="node">
<title>expert_1_11_0</title>
<polygon fill="lightgreen" stroke="black" points="5873.5,-722.45 5596.5,-722.45 5596.5,-678.45 5873.5,-678.45 5873.5,-722.45"/>
<text text-anchor="middle" x="5735" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L1</text>
<text text-anchor="middle" x="5735" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="5735" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5735" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_11_1 -->
<g id="node126" class="node">
<title>expert_1_11_1</title>
<polygon fill="lightgreen" stroke="black" points="5578.5,-722.45 5301.5,-722.45 5301.5,-678.45 5578.5,-678.45 5578.5,-722.45"/>
<text text-anchor="middle" x="5440" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L1</text>
<text text-anchor="middle" x="5440" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="5440" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5440" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_11 -->
<g id="node127" class="node">
<title>tp_1_11</title>
<ellipse fill="lightblue" stroke="black" cx="5168" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5168" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L1</text>
<text text-anchor="middle" x="5168" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="5168" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5168" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_12 -->
<g id="node128" class="node">
<title>route_1_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4833" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4833" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="4833" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="4833" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4833" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_12_0 -->
<g id="node129" class="node">
<title>expert_1_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4614.5,-722.45 4337.5,-722.45 4337.5,-678.45 4614.5,-678.45 4614.5,-722.45"/>
<text text-anchor="middle" x="4476" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L1</text>
<text text-anchor="middle" x="4476" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="4476" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4476" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_12_1 -->
<g id="node130" class="node">
<title>expert_1_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4319.5,-722.45 4042.5,-722.45 4042.5,-678.45 4319.5,-678.45 4319.5,-722.45"/>
<text text-anchor="middle" x="4181" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L1</text>
<text text-anchor="middle" x="4181" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="4181" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4181" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_12 -->
<g id="node131" class="node">
<title>tp_1_12</title>
<ellipse fill="lightblue" stroke="black" cx="3909" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3909" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L1</text>
<text text-anchor="middle" x="3909" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="3909" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3909" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_13 -->
<g id="node132" class="node">
<title>route_1_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3574" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3574" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="3574" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="3574" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3574" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_13_0 -->
<g id="node133" class="node">
<title>expert_1_13_0</title>
<polygon fill="lightgreen" stroke="black" points="3355.5,-722.45 3078.5,-722.45 3078.5,-678.45 3355.5,-678.45 3355.5,-722.45"/>
<text text-anchor="middle" x="3217" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L1</text>
<text text-anchor="middle" x="3217" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="3217" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3217" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_13_1 -->
<g id="node134" class="node">
<title>expert_1_13_1</title>
<polygon fill="lightgreen" stroke="black" points="3060.5,-722.45 2783.5,-722.45 2783.5,-678.45 3060.5,-678.45 3060.5,-722.45"/>
<text text-anchor="middle" x="2922" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L1</text>
<text text-anchor="middle" x="2922" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="2922" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2922" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_13 -->
<g id="node135" class="node">
<title>tp_1_13</title>
<ellipse fill="lightblue" stroke="black" cx="2650" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2650" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L1</text>
<text text-anchor="middle" x="2650" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="2650" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2650" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_14 -->
<g id="node136" class="node">
<title>route_1_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2315" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2315" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="2315" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="2315" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2315" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_14_0 -->
<g id="node137" class="node">
<title>expert_1_14_0</title>
<polygon fill="lightgreen" stroke="black" points="2096.5,-722.45 1819.5,-722.45 1819.5,-678.45 2096.5,-678.45 2096.5,-722.45"/>
<text text-anchor="middle" x="1958" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L1</text>
<text text-anchor="middle" x="1958" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="1958" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1958" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_14_1 -->
<g id="node138" class="node">
<title>expert_1_14_1</title>
<polygon fill="lightgreen" stroke="black" points="1801.5,-722.45 1524.5,-722.45 1524.5,-678.45 1801.5,-678.45 1801.5,-722.45"/>
<text text-anchor="middle" x="1663" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L1</text>
<text text-anchor="middle" x="1663" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="1663" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1663" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_14 -->
<g id="node139" class="node">
<title>tp_1_14</title>
<ellipse fill="lightblue" stroke="black" cx="1391" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1391" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L1</text>
<text text-anchor="middle" x="1391" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="1391" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1391" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_1_15 -->
<g id="node140" class="node">
<title>route_1_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1056" cy="-700.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1056" y="-713.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="1056" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="1056" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1056" y="-683.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_1_15_0 -->
<g id="node141" class="node">
<title>expert_1_15_0</title>
<polygon fill="lightgreen" stroke="black" points="837.5,-722.45 560.5,-722.45 560.5,-678.45 837.5,-678.45 837.5,-722.45"/>
<text text-anchor="middle" x="699" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L1</text>
<text text-anchor="middle" x="699" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="699" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="699" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_1_15_1 -->
<g id="node142" class="node">
<title>expert_1_15_1</title>
<polygon fill="lightgreen" stroke="black" points="542.5,-722.45 265.5,-722.45 265.5,-678.45 542.5,-678.45 542.5,-722.45"/>
<text text-anchor="middle" x="404" y="-713.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L1</text>
<text text-anchor="middle" x="404" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="404" y="-693.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="404" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_1_15 -->
<g id="node143" class="node">
<title>tp_1_15</title>
<ellipse fill="lightblue" stroke="black" cx="132" cy="-700.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="132" y="-713.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L1</text>
<text text-anchor="middle" x="132" y="-703.25" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="132" y="-693.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="132" y="-683.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_2 -->
<g id="node144" class="node">
<title>q_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="68847,-857.45 68551,-857.45 68551,-813.45 68847,-813.45 68847,-857.45"/>
<text text-anchor="middle" x="68699" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L2</text>
<text text-anchor="middle" x="68699" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="68699" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="68699" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_2 -->
<g id="node145" class="node">
<title>k_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="68533,-857.45 68237,-857.45 68237,-813.45 68533,-813.45 68533,-857.45"/>
<text text-anchor="middle" x="68385" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L2</text>
<text text-anchor="middle" x="68385" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="68385" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="68385" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_2 -->
<g id="node146" class="node">
<title>v_proj_2</title>
<polygon fill="lightgreen" stroke="black" points="68219,-857.45 67923,-857.45 67923,-813.45 68219,-813.45 68219,-857.45"/>
<text text-anchor="middle" x="68071" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L2</text>
<text text-anchor="middle" x="68071" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="68071" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="68071" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_2 -->
<g id="node147" class="node">
<title>attn_scores_2</title>
<polygon fill="lightgreen" stroke="black" points="67904.5,-857.45 67571.5,-857.45 67571.5,-813.45 67904.5,-813.45 67904.5,-857.45"/>
<text text-anchor="middle" x="67738" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L2</text>
<text text-anchor="middle" x="67738" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="67738" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="67738" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_2 -->
<g id="node148" class="node">
<title>softmax_2</title>
<polygon fill="lightgreen" stroke="black" points="67553.5,-857.45 67220.5,-857.45 67220.5,-813.45 67553.5,-813.45 67553.5,-857.45"/>
<text text-anchor="middle" x="67387" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L2</text>
<text text-anchor="middle" x="67387" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="67387" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="67387" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_2 -->
<g id="node149" class="node">
<title>attn_out_2</title>
<polygon fill="lightgreen" stroke="black" points="67202,-857.45 66906,-857.45 66906,-813.45 67202,-813.45 67202,-857.45"/>
<text text-anchor="middle" x="67054" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L2</text>
<text text-anchor="middle" x="67054" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="67054" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="67054" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_2 -->
<g id="node150" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="66887.74,-879.45 66410.92,-879.45 66288.26,-791.45 66765.08,-791.45 66887.74,-879.45"/>
<text text-anchor="middle" x="66588" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L2</text>
<text text-anchor="middle" x="66588" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;127</text>
<text text-anchor="middle" x="66588" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="66588" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_2_0 -->
<g id="node151" class="node">
<title>route_2_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="66070" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="66070" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="66070" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="66070" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="66070" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_0_0 -->
<g id="node152" class="node">
<title>expert_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="65851.5,-857.45 65574.5,-857.45 65574.5,-813.45 65851.5,-813.45 65851.5,-857.45"/>
<text text-anchor="middle" x="65713" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L2</text>
<text text-anchor="middle" x="65713" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="65713" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="65713" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_0_1 -->
<g id="node153" class="node">
<title>expert_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="65556.5,-857.45 65279.5,-857.45 65279.5,-813.45 65556.5,-813.45 65556.5,-857.45"/>
<text text-anchor="middle" x="65418" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L2</text>
<text text-anchor="middle" x="65418" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="65418" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="65418" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_0 -->
<g id="node154" class="node">
<title>tp_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="65146" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="65146" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L2</text>
<text text-anchor="middle" x="65146" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="65146" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="65146" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_1 -->
<g id="node155" class="node">
<title>route_2_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="64811" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="64811" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="64811" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="64811" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="64811" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_1_0 -->
<g id="node156" class="node">
<title>expert_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="64592.5,-857.45 64315.5,-857.45 64315.5,-813.45 64592.5,-813.45 64592.5,-857.45"/>
<text text-anchor="middle" x="64454" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L2</text>
<text text-anchor="middle" x="64454" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="64454" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="64454" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_1_1 -->
<g id="node157" class="node">
<title>expert_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="64297.5,-857.45 64020.5,-857.45 64020.5,-813.45 64297.5,-813.45 64297.5,-857.45"/>
<text text-anchor="middle" x="64159" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L2</text>
<text text-anchor="middle" x="64159" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="64159" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="64159" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_1 -->
<g id="node158" class="node">
<title>tp_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="63887" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="63887" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L2</text>
<text text-anchor="middle" x="63887" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="63887" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="63887" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_2 -->
<g id="node159" class="node">
<title>route_2_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="63552" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="63552" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="63552" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="63552" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="63552" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_2_0 -->
<g id="node160" class="node">
<title>expert_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="63333.5,-857.45 63056.5,-857.45 63056.5,-813.45 63333.5,-813.45 63333.5,-857.45"/>
<text text-anchor="middle" x="63195" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L2</text>
<text text-anchor="middle" x="63195" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="63195" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="63195" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_2_1 -->
<g id="node161" class="node">
<title>expert_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="63038.5,-857.45 62761.5,-857.45 62761.5,-813.45 63038.5,-813.45 63038.5,-857.45"/>
<text text-anchor="middle" x="62900" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L2</text>
<text text-anchor="middle" x="62900" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="62900" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="62900" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_2 -->
<g id="node162" class="node">
<title>tp_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="62628" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="62628" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L2</text>
<text text-anchor="middle" x="62628" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="62628" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="62628" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_3 -->
<g id="node163" class="node">
<title>route_2_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="62293" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="62293" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="62293" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="62293" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="62293" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_3_0 -->
<g id="node164" class="node">
<title>expert_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="62074.5,-857.45 61797.5,-857.45 61797.5,-813.45 62074.5,-813.45 62074.5,-857.45"/>
<text text-anchor="middle" x="61936" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L2</text>
<text text-anchor="middle" x="61936" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="61936" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="61936" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_3_1 -->
<g id="node165" class="node">
<title>expert_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="61779.5,-857.45 61502.5,-857.45 61502.5,-813.45 61779.5,-813.45 61779.5,-857.45"/>
<text text-anchor="middle" x="61641" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L2</text>
<text text-anchor="middle" x="61641" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="61641" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="61641" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_3 -->
<g id="node166" class="node">
<title>tp_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="61369" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="61369" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L2</text>
<text text-anchor="middle" x="61369" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="61369" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="61369" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_4 -->
<g id="node167" class="node">
<title>route_2_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="61034" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="61034" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="61034" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="61034" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="61034" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_4_0 -->
<g id="node168" class="node">
<title>expert_2_4_0</title>
<polygon fill="lightgreen" stroke="black" points="60815.5,-857.45 60538.5,-857.45 60538.5,-813.45 60815.5,-813.45 60815.5,-857.45"/>
<text text-anchor="middle" x="60677" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L2</text>
<text text-anchor="middle" x="60677" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="60677" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="60677" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_4_1 -->
<g id="node169" class="node">
<title>expert_2_4_1</title>
<polygon fill="lightgreen" stroke="black" points="60520.5,-857.45 60243.5,-857.45 60243.5,-813.45 60520.5,-813.45 60520.5,-857.45"/>
<text text-anchor="middle" x="60382" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L2</text>
<text text-anchor="middle" x="60382" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="60382" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="60382" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_4 -->
<g id="node170" class="node">
<title>tp_2_4</title>
<ellipse fill="lightblue" stroke="black" cx="60110" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="60110" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L2</text>
<text text-anchor="middle" x="60110" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="60110" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="60110" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_5 -->
<g id="node171" class="node">
<title>route_2_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="59775" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="59775" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="59775" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="59775" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="59775" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_5_0 -->
<g id="node172" class="node">
<title>expert_2_5_0</title>
<polygon fill="lightgreen" stroke="black" points="59556.5,-857.45 59279.5,-857.45 59279.5,-813.45 59556.5,-813.45 59556.5,-857.45"/>
<text text-anchor="middle" x="59418" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L2</text>
<text text-anchor="middle" x="59418" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="59418" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="59418" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_5_1 -->
<g id="node173" class="node">
<title>expert_2_5_1</title>
<polygon fill="lightgreen" stroke="black" points="59261.5,-857.45 58984.5,-857.45 58984.5,-813.45 59261.5,-813.45 59261.5,-857.45"/>
<text text-anchor="middle" x="59123" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L2</text>
<text text-anchor="middle" x="59123" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="59123" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="59123" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_5 -->
<g id="node174" class="node">
<title>tp_2_5</title>
<ellipse fill="lightblue" stroke="black" cx="58851" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="58851" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L2</text>
<text text-anchor="middle" x="58851" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="58851" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="58851" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_6 -->
<g id="node175" class="node">
<title>route_2_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="58516" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="58516" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="58516" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="58516" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="58516" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_6_0 -->
<g id="node176" class="node">
<title>expert_2_6_0</title>
<polygon fill="lightgreen" stroke="black" points="58297.5,-857.45 58020.5,-857.45 58020.5,-813.45 58297.5,-813.45 58297.5,-857.45"/>
<text text-anchor="middle" x="58159" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L2</text>
<text text-anchor="middle" x="58159" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="58159" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="58159" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_6_1 -->
<g id="node177" class="node">
<title>expert_2_6_1</title>
<polygon fill="lightgreen" stroke="black" points="58002.5,-857.45 57725.5,-857.45 57725.5,-813.45 58002.5,-813.45 58002.5,-857.45"/>
<text text-anchor="middle" x="57864" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L2</text>
<text text-anchor="middle" x="57864" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="57864" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="57864" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_6 -->
<g id="node178" class="node">
<title>tp_2_6</title>
<ellipse fill="lightblue" stroke="black" cx="57592" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="57592" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L2</text>
<text text-anchor="middle" x="57592" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="57592" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="57592" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_7 -->
<g id="node179" class="node">
<title>route_2_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="57257" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="57257" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="57257" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="57257" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="57257" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_7_0 -->
<g id="node180" class="node">
<title>expert_2_7_0</title>
<polygon fill="lightgreen" stroke="black" points="57038.5,-857.45 56761.5,-857.45 56761.5,-813.45 57038.5,-813.45 57038.5,-857.45"/>
<text text-anchor="middle" x="56900" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L2</text>
<text text-anchor="middle" x="56900" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="56900" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="56900" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_7_1 -->
<g id="node181" class="node">
<title>expert_2_7_1</title>
<polygon fill="lightgreen" stroke="black" points="56743.5,-857.45 56466.5,-857.45 56466.5,-813.45 56743.5,-813.45 56743.5,-857.45"/>
<text text-anchor="middle" x="56605" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L2</text>
<text text-anchor="middle" x="56605" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="56605" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="56605" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_7 -->
<g id="node182" class="node">
<title>tp_2_7</title>
<ellipse fill="lightblue" stroke="black" cx="56333" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="56333" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L2</text>
<text text-anchor="middle" x="56333" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="56333" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="56333" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_8 -->
<g id="node183" class="node">
<title>route_2_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="55998" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="55998" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="55998" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="55998" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="55998" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_8_0 -->
<g id="node184" class="node">
<title>expert_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="55779.5,-857.45 55502.5,-857.45 55502.5,-813.45 55779.5,-813.45 55779.5,-857.45"/>
<text text-anchor="middle" x="55641" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L2</text>
<text text-anchor="middle" x="55641" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="55641" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="55641" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_8_1 -->
<g id="node185" class="node">
<title>expert_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="55484.5,-857.45 55207.5,-857.45 55207.5,-813.45 55484.5,-813.45 55484.5,-857.45"/>
<text text-anchor="middle" x="55346" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L2</text>
<text text-anchor="middle" x="55346" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="55346" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="55346" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_8 -->
<g id="node186" class="node">
<title>tp_2_8</title>
<ellipse fill="lightblue" stroke="black" cx="55074" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="55074" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L2</text>
<text text-anchor="middle" x="55074" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="55074" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="55074" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_9 -->
<g id="node187" class="node">
<title>route_2_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="54739" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="54739" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="54739" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="54739" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="54739" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_9_0 -->
<g id="node188" class="node">
<title>expert_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="54520.5,-857.45 54243.5,-857.45 54243.5,-813.45 54520.5,-813.45 54520.5,-857.45"/>
<text text-anchor="middle" x="54382" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L2</text>
<text text-anchor="middle" x="54382" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="54382" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="54382" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_9_1 -->
<g id="node189" class="node">
<title>expert_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="54225.5,-857.45 53948.5,-857.45 53948.5,-813.45 54225.5,-813.45 54225.5,-857.45"/>
<text text-anchor="middle" x="54087" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L2</text>
<text text-anchor="middle" x="54087" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="54087" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="54087" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_9 -->
<g id="node190" class="node">
<title>tp_2_9</title>
<ellipse fill="lightblue" stroke="black" cx="53815" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="53815" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L2</text>
<text text-anchor="middle" x="53815" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="53815" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="53815" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_10 -->
<g id="node191" class="node">
<title>route_2_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="53480" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="53480" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="53480" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="53480" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="53480" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_10_0 -->
<g id="node192" class="node">
<title>expert_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="53261.5,-857.45 52984.5,-857.45 52984.5,-813.45 53261.5,-813.45 53261.5,-857.45"/>
<text text-anchor="middle" x="53123" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L2</text>
<text text-anchor="middle" x="53123" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="53123" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="53123" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_10_1 -->
<g id="node193" class="node">
<title>expert_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="52966.5,-857.45 52689.5,-857.45 52689.5,-813.45 52966.5,-813.45 52966.5,-857.45"/>
<text text-anchor="middle" x="52828" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L2</text>
<text text-anchor="middle" x="52828" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="52828" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="52828" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_10 -->
<g id="node194" class="node">
<title>tp_2_10</title>
<ellipse fill="lightblue" stroke="black" cx="52556" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="52556" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L2</text>
<text text-anchor="middle" x="52556" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="52556" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="52556" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_11 -->
<g id="node195" class="node">
<title>route_2_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="52221" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="52221" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="52221" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="52221" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="52221" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_11_0 -->
<g id="node196" class="node">
<title>expert_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="52002.5,-857.45 51725.5,-857.45 51725.5,-813.45 52002.5,-813.45 52002.5,-857.45"/>
<text text-anchor="middle" x="51864" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L2</text>
<text text-anchor="middle" x="51864" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="51864" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="51864" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_11_1 -->
<g id="node197" class="node">
<title>expert_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="51707.5,-857.45 51430.5,-857.45 51430.5,-813.45 51707.5,-813.45 51707.5,-857.45"/>
<text text-anchor="middle" x="51569" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L2</text>
<text text-anchor="middle" x="51569" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="51569" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="51569" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_11 -->
<g id="node198" class="node">
<title>tp_2_11</title>
<ellipse fill="lightblue" stroke="black" cx="51297" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="51297" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L2</text>
<text text-anchor="middle" x="51297" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="51297" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="51297" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_12 -->
<g id="node199" class="node">
<title>route_2_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="50962" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="50962" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="50962" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="50962" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="50962" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_12_0 -->
<g id="node200" class="node">
<title>expert_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="50743.5,-857.45 50466.5,-857.45 50466.5,-813.45 50743.5,-813.45 50743.5,-857.45"/>
<text text-anchor="middle" x="50605" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L2</text>
<text text-anchor="middle" x="50605" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="50605" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="50605" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_12_1 -->
<g id="node201" class="node">
<title>expert_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="50448.5,-857.45 50171.5,-857.45 50171.5,-813.45 50448.5,-813.45 50448.5,-857.45"/>
<text text-anchor="middle" x="50310" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L2</text>
<text text-anchor="middle" x="50310" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="50310" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="50310" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_12 -->
<g id="node202" class="node">
<title>tp_2_12</title>
<ellipse fill="lightblue" stroke="black" cx="50038" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="50038" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L2</text>
<text text-anchor="middle" x="50038" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="50038" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="50038" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_13 -->
<g id="node203" class="node">
<title>route_2_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="49703" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="49703" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="49703" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="49703" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="49703" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_13_0 -->
<g id="node204" class="node">
<title>expert_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="49484.5,-857.45 49207.5,-857.45 49207.5,-813.45 49484.5,-813.45 49484.5,-857.45"/>
<text text-anchor="middle" x="49346" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L2</text>
<text text-anchor="middle" x="49346" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="49346" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="49346" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_13_1 -->
<g id="node205" class="node">
<title>expert_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="49189.5,-857.45 48912.5,-857.45 48912.5,-813.45 49189.5,-813.45 49189.5,-857.45"/>
<text text-anchor="middle" x="49051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L2</text>
<text text-anchor="middle" x="49051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="49051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="49051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_13 -->
<g id="node206" class="node">
<title>tp_2_13</title>
<ellipse fill="lightblue" stroke="black" cx="48779" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="48779" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L2</text>
<text text-anchor="middle" x="48779" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="48779" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="48779" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_14 -->
<g id="node207" class="node">
<title>route_2_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="48444" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="48444" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="48444" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="48444" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="48444" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_14_0 -->
<g id="node208" class="node">
<title>expert_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="48225.5,-857.45 47948.5,-857.45 47948.5,-813.45 48225.5,-813.45 48225.5,-857.45"/>
<text text-anchor="middle" x="48087" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L2</text>
<text text-anchor="middle" x="48087" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="48087" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="48087" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_14_1 -->
<g id="node209" class="node">
<title>expert_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="47930.5,-857.45 47653.5,-857.45 47653.5,-813.45 47930.5,-813.45 47930.5,-857.45"/>
<text text-anchor="middle" x="47792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L2</text>
<text text-anchor="middle" x="47792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="47792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="47792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_14 -->
<g id="node210" class="node">
<title>tp_2_14</title>
<ellipse fill="lightblue" stroke="black" cx="47520" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="47520" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L2</text>
<text text-anchor="middle" x="47520" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="47520" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="47520" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_2_15 -->
<g id="node211" class="node">
<title>route_2_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="47185" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="47185" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="47185" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="47185" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="47185" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_2_15_0 -->
<g id="node212" class="node">
<title>expert_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="46966.5,-857.45 46689.5,-857.45 46689.5,-813.45 46966.5,-813.45 46966.5,-857.45"/>
<text text-anchor="middle" x="46828" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L2</text>
<text text-anchor="middle" x="46828" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="46828" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="46828" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_2_15_1 -->
<g id="node213" class="node">
<title>expert_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="46671.5,-857.45 46394.5,-857.45 46394.5,-813.45 46671.5,-813.45 46671.5,-857.45"/>
<text text-anchor="middle" x="46533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L2</text>
<text text-anchor="middle" x="46533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="46533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="46533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_2_15 -->
<g id="node214" class="node">
<title>tp_2_15</title>
<ellipse fill="lightblue" stroke="black" cx="46261" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="46261" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L2</text>
<text text-anchor="middle" x="46261" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="46261" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="46261" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_3 -->
<g id="node215" class="node">
<title>q_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="46127,-857.45 45831,-857.45 45831,-813.45 46127,-813.45 46127,-857.45"/>
<text text-anchor="middle" x="45979" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L3</text>
<text text-anchor="middle" x="45979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="45979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="45979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_3 -->
<g id="node216" class="node">
<title>k_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="45813,-857.45 45517,-857.45 45517,-813.45 45813,-813.45 45813,-857.45"/>
<text text-anchor="middle" x="45665" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L3</text>
<text text-anchor="middle" x="45665" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="45665" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="45665" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_3 -->
<g id="node217" class="node">
<title>v_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="45499,-857.45 45203,-857.45 45203,-813.45 45499,-813.45 45499,-857.45"/>
<text text-anchor="middle" x="45351" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L3</text>
<text text-anchor="middle" x="45351" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="45351" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="45351" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_3 -->
<g id="node218" class="node">
<title>attn_scores_3</title>
<polygon fill="lightgreen" stroke="black" points="45184.5,-857.45 44851.5,-857.45 44851.5,-813.45 45184.5,-813.45 45184.5,-857.45"/>
<text text-anchor="middle" x="45018" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L3</text>
<text text-anchor="middle" x="45018" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="45018" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="45018" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_3 -->
<g id="node219" class="node">
<title>softmax_3</title>
<polygon fill="lightgreen" stroke="black" points="44833.5,-857.45 44500.5,-857.45 44500.5,-813.45 44833.5,-813.45 44833.5,-857.45"/>
<text text-anchor="middle" x="44667" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L3</text>
<text text-anchor="middle" x="44667" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="44667" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="44667" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_3 -->
<g id="node220" class="node">
<title>attn_out_3</title>
<polygon fill="lightgreen" stroke="black" points="44482,-857.45 44186,-857.45 44186,-813.45 44482,-813.45 44482,-857.45"/>
<text text-anchor="middle" x="44334" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L3</text>
<text text-anchor="middle" x="44334" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;95</text>
<text text-anchor="middle" x="44334" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="44334" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_3 -->
<g id="node221" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="44167.74,-879.45 43690.92,-879.45 43568.26,-791.45 44045.08,-791.45 44167.74,-879.45"/>
<text text-anchor="middle" x="43868" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L3</text>
<text text-anchor="middle" x="43868" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64&#45;127</text>
<text text-anchor="middle" x="43868" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="43868" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_3_0 -->
<g id="node222" class="node">
<title>route_3_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="43350" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="43350" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="43350" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="43350" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="43350" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_0_0 -->
<g id="node223" class="node">
<title>expert_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="43131.5,-857.45 42854.5,-857.45 42854.5,-813.45 43131.5,-813.45 43131.5,-857.45"/>
<text text-anchor="middle" x="42993" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L3</text>
<text text-anchor="middle" x="42993" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="42993" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="42993" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_0_1 -->
<g id="node224" class="node">
<title>expert_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="42836.5,-857.45 42559.5,-857.45 42559.5,-813.45 42836.5,-813.45 42836.5,-857.45"/>
<text text-anchor="middle" x="42698" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L3</text>
<text text-anchor="middle" x="42698" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="42698" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="42698" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_0 -->
<g id="node225" class="node">
<title>tp_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="42426" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="42426" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L3</text>
<text text-anchor="middle" x="42426" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="42426" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="42426" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_1 -->
<g id="node226" class="node">
<title>route_3_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="42091" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="42091" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="42091" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="42091" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="42091" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_1_0 -->
<g id="node227" class="node">
<title>expert_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="41872.5,-857.45 41595.5,-857.45 41595.5,-813.45 41872.5,-813.45 41872.5,-857.45"/>
<text text-anchor="middle" x="41734" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L3</text>
<text text-anchor="middle" x="41734" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="41734" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="41734" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_1_1 -->
<g id="node228" class="node">
<title>expert_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="41577.5,-857.45 41300.5,-857.45 41300.5,-813.45 41577.5,-813.45 41577.5,-857.45"/>
<text text-anchor="middle" x="41439" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L3</text>
<text text-anchor="middle" x="41439" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="41439" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="41439" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_1 -->
<g id="node229" class="node">
<title>tp_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="41167" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="41167" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L3</text>
<text text-anchor="middle" x="41167" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="41167" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="41167" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_2 -->
<g id="node230" class="node">
<title>route_3_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="40832" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="40832" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="40832" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="40832" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="40832" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_2_0 -->
<g id="node231" class="node">
<title>expert_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="40613.5,-857.45 40336.5,-857.45 40336.5,-813.45 40613.5,-813.45 40613.5,-857.45"/>
<text text-anchor="middle" x="40475" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L3</text>
<text text-anchor="middle" x="40475" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="40475" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="40475" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_2_1 -->
<g id="node232" class="node">
<title>expert_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="40318.5,-857.45 40041.5,-857.45 40041.5,-813.45 40318.5,-813.45 40318.5,-857.45"/>
<text text-anchor="middle" x="40180" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L3</text>
<text text-anchor="middle" x="40180" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="40180" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="40180" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_2 -->
<g id="node233" class="node">
<title>tp_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="39908" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="39908" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L3</text>
<text text-anchor="middle" x="39908" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="39908" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="39908" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_3 -->
<g id="node234" class="node">
<title>route_3_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="39573" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="39573" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="39573" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="39573" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="39573" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_3_0 -->
<g id="node235" class="node">
<title>expert_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="39354.5,-857.45 39077.5,-857.45 39077.5,-813.45 39354.5,-813.45 39354.5,-857.45"/>
<text text-anchor="middle" x="39216" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L3</text>
<text text-anchor="middle" x="39216" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="39216" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="39216" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_3_1 -->
<g id="node236" class="node">
<title>expert_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="39059.5,-857.45 38782.5,-857.45 38782.5,-813.45 39059.5,-813.45 39059.5,-857.45"/>
<text text-anchor="middle" x="38921" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L3</text>
<text text-anchor="middle" x="38921" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="38921" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="38921" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_3 -->
<g id="node237" class="node">
<title>tp_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="38649" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="38649" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L3</text>
<text text-anchor="middle" x="38649" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="38649" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="38649" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_4 -->
<g id="node238" class="node">
<title>route_3_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="38314" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="38314" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="38314" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="38314" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="38314" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_4_0 -->
<g id="node239" class="node">
<title>expert_3_4_0</title>
<polygon fill="lightgreen" stroke="black" points="38095.5,-857.45 37818.5,-857.45 37818.5,-813.45 38095.5,-813.45 38095.5,-857.45"/>
<text text-anchor="middle" x="37957" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L3</text>
<text text-anchor="middle" x="37957" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="37957" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="37957" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_4_1 -->
<g id="node240" class="node">
<title>expert_3_4_1</title>
<polygon fill="lightgreen" stroke="black" points="37800.5,-857.45 37523.5,-857.45 37523.5,-813.45 37800.5,-813.45 37800.5,-857.45"/>
<text text-anchor="middle" x="37662" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L3</text>
<text text-anchor="middle" x="37662" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="37662" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="37662" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_4 -->
<g id="node241" class="node">
<title>tp_3_4</title>
<ellipse fill="lightblue" stroke="black" cx="37390" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="37390" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L3</text>
<text text-anchor="middle" x="37390" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="37390" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="37390" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_5 -->
<g id="node242" class="node">
<title>route_3_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="37055" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="37055" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="37055" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="37055" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="37055" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_5_0 -->
<g id="node243" class="node">
<title>expert_3_5_0</title>
<polygon fill="lightgreen" stroke="black" points="36836.5,-857.45 36559.5,-857.45 36559.5,-813.45 36836.5,-813.45 36836.5,-857.45"/>
<text text-anchor="middle" x="36698" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L3</text>
<text text-anchor="middle" x="36698" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="36698" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="36698" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_5_1 -->
<g id="node244" class="node">
<title>expert_3_5_1</title>
<polygon fill="lightgreen" stroke="black" points="36541.5,-857.45 36264.5,-857.45 36264.5,-813.45 36541.5,-813.45 36541.5,-857.45"/>
<text text-anchor="middle" x="36403" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L3</text>
<text text-anchor="middle" x="36403" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="36403" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="36403" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_5 -->
<g id="node245" class="node">
<title>tp_3_5</title>
<ellipse fill="lightblue" stroke="black" cx="36131" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="36131" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L3</text>
<text text-anchor="middle" x="36131" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="36131" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="36131" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_6 -->
<g id="node246" class="node">
<title>route_3_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="35796" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="35796" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="35796" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="35796" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="35796" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_6_0 -->
<g id="node247" class="node">
<title>expert_3_6_0</title>
<polygon fill="lightgreen" stroke="black" points="35577.5,-857.45 35300.5,-857.45 35300.5,-813.45 35577.5,-813.45 35577.5,-857.45"/>
<text text-anchor="middle" x="35439" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L3</text>
<text text-anchor="middle" x="35439" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="35439" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="35439" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_6_1 -->
<g id="node248" class="node">
<title>expert_3_6_1</title>
<polygon fill="lightgreen" stroke="black" points="35282.5,-857.45 35005.5,-857.45 35005.5,-813.45 35282.5,-813.45 35282.5,-857.45"/>
<text text-anchor="middle" x="35144" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L3</text>
<text text-anchor="middle" x="35144" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="35144" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="35144" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_6 -->
<g id="node249" class="node">
<title>tp_3_6</title>
<ellipse fill="lightblue" stroke="black" cx="34872" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="34872" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L3</text>
<text text-anchor="middle" x="34872" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="34872" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="34872" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_7 -->
<g id="node250" class="node">
<title>route_3_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="34537" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="34537" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="34537" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="34537" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="34537" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_7_0 -->
<g id="node251" class="node">
<title>expert_3_7_0</title>
<polygon fill="lightgreen" stroke="black" points="34318.5,-857.45 34041.5,-857.45 34041.5,-813.45 34318.5,-813.45 34318.5,-857.45"/>
<text text-anchor="middle" x="34180" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L3</text>
<text text-anchor="middle" x="34180" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="34180" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="34180" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_7_1 -->
<g id="node252" class="node">
<title>expert_3_7_1</title>
<polygon fill="lightgreen" stroke="black" points="34023.5,-857.45 33746.5,-857.45 33746.5,-813.45 34023.5,-813.45 34023.5,-857.45"/>
<text text-anchor="middle" x="33885" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L3</text>
<text text-anchor="middle" x="33885" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="33885" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="33885" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_7 -->
<g id="node253" class="node">
<title>tp_3_7</title>
<ellipse fill="lightblue" stroke="black" cx="33613" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="33613" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L3</text>
<text text-anchor="middle" x="33613" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="33613" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="33613" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_8 -->
<g id="node254" class="node">
<title>route_3_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="33278" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="33278" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="33278" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="33278" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="33278" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_8_0 -->
<g id="node255" class="node">
<title>expert_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="33059.5,-857.45 32782.5,-857.45 32782.5,-813.45 33059.5,-813.45 33059.5,-857.45"/>
<text text-anchor="middle" x="32921" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L3</text>
<text text-anchor="middle" x="32921" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="32921" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="32921" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_8_1 -->
<g id="node256" class="node">
<title>expert_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="32764.5,-857.45 32487.5,-857.45 32487.5,-813.45 32764.5,-813.45 32764.5,-857.45"/>
<text text-anchor="middle" x="32626" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L3</text>
<text text-anchor="middle" x="32626" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="32626" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="32626" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_8 -->
<g id="node257" class="node">
<title>tp_3_8</title>
<ellipse fill="lightblue" stroke="black" cx="32354" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="32354" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L3</text>
<text text-anchor="middle" x="32354" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="32354" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="32354" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_9 -->
<g id="node258" class="node">
<title>route_3_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="32019" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="32019" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="32019" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="32019" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="32019" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_9_0 -->
<g id="node259" class="node">
<title>expert_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="31800.5,-857.45 31523.5,-857.45 31523.5,-813.45 31800.5,-813.45 31800.5,-857.45"/>
<text text-anchor="middle" x="31662" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L3</text>
<text text-anchor="middle" x="31662" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="31662" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="31662" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_9_1 -->
<g id="node260" class="node">
<title>expert_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="31505.5,-857.45 31228.5,-857.45 31228.5,-813.45 31505.5,-813.45 31505.5,-857.45"/>
<text text-anchor="middle" x="31367" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L3</text>
<text text-anchor="middle" x="31367" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="31367" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="31367" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_9 -->
<g id="node261" class="node">
<title>tp_3_9</title>
<ellipse fill="lightblue" stroke="black" cx="31095" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="31095" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L3</text>
<text text-anchor="middle" x="31095" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="31095" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="31095" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_10 -->
<g id="node262" class="node">
<title>route_3_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="30760" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="30760" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="30760" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="30760" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="30760" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_10_0 -->
<g id="node263" class="node">
<title>expert_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="30541.5,-857.45 30264.5,-857.45 30264.5,-813.45 30541.5,-813.45 30541.5,-857.45"/>
<text text-anchor="middle" x="30403" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L3</text>
<text text-anchor="middle" x="30403" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="30403" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="30403" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_10_1 -->
<g id="node264" class="node">
<title>expert_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="30246.5,-857.45 29969.5,-857.45 29969.5,-813.45 30246.5,-813.45 30246.5,-857.45"/>
<text text-anchor="middle" x="30108" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L3</text>
<text text-anchor="middle" x="30108" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="30108" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="30108" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_10 -->
<g id="node265" class="node">
<title>tp_3_10</title>
<ellipse fill="lightblue" stroke="black" cx="29836" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="29836" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L3</text>
<text text-anchor="middle" x="29836" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="29836" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="29836" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_11 -->
<g id="node266" class="node">
<title>route_3_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="29501" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="29501" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="29501" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="29501" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="29501" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_11_0 -->
<g id="node267" class="node">
<title>expert_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="29282.5,-857.45 29005.5,-857.45 29005.5,-813.45 29282.5,-813.45 29282.5,-857.45"/>
<text text-anchor="middle" x="29144" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L3</text>
<text text-anchor="middle" x="29144" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="29144" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="29144" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_11_1 -->
<g id="node268" class="node">
<title>expert_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="28987.5,-857.45 28710.5,-857.45 28710.5,-813.45 28987.5,-813.45 28987.5,-857.45"/>
<text text-anchor="middle" x="28849" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L3</text>
<text text-anchor="middle" x="28849" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="28849" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="28849" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_11 -->
<g id="node269" class="node">
<title>tp_3_11</title>
<ellipse fill="lightblue" stroke="black" cx="28577" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="28577" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L3</text>
<text text-anchor="middle" x="28577" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="28577" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="28577" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_12 -->
<g id="node270" class="node">
<title>route_3_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="28242" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="28242" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="28242" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="28242" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="28242" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_12_0 -->
<g id="node271" class="node">
<title>expert_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="28023.5,-857.45 27746.5,-857.45 27746.5,-813.45 28023.5,-813.45 28023.5,-857.45"/>
<text text-anchor="middle" x="27885" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L3</text>
<text text-anchor="middle" x="27885" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="27885" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="27885" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_12_1 -->
<g id="node272" class="node">
<title>expert_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="27728.5,-857.45 27451.5,-857.45 27451.5,-813.45 27728.5,-813.45 27728.5,-857.45"/>
<text text-anchor="middle" x="27590" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L3</text>
<text text-anchor="middle" x="27590" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="27590" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="27590" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_12 -->
<g id="node273" class="node">
<title>tp_3_12</title>
<ellipse fill="lightblue" stroke="black" cx="27318" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="27318" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L3</text>
<text text-anchor="middle" x="27318" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="27318" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="27318" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_13 -->
<g id="node274" class="node">
<title>route_3_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="26983" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="26983" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="26983" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="26983" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="26983" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_13_0 -->
<g id="node275" class="node">
<title>expert_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="26764.5,-857.45 26487.5,-857.45 26487.5,-813.45 26764.5,-813.45 26764.5,-857.45"/>
<text text-anchor="middle" x="26626" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L3</text>
<text text-anchor="middle" x="26626" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="26626" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="26626" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_13_1 -->
<g id="node276" class="node">
<title>expert_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="26469.5,-857.45 26192.5,-857.45 26192.5,-813.45 26469.5,-813.45 26469.5,-857.45"/>
<text text-anchor="middle" x="26331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L3</text>
<text text-anchor="middle" x="26331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="26331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="26331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_13 -->
<g id="node277" class="node">
<title>tp_3_13</title>
<ellipse fill="lightblue" stroke="black" cx="26059" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="26059" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L3</text>
<text text-anchor="middle" x="26059" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="26059" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="26059" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_14 -->
<g id="node278" class="node">
<title>route_3_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="25724" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="25724" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="25724" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="25724" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="25724" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_14_0 -->
<g id="node279" class="node">
<title>expert_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="25505.5,-857.45 25228.5,-857.45 25228.5,-813.45 25505.5,-813.45 25505.5,-857.45"/>
<text text-anchor="middle" x="25367" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L3</text>
<text text-anchor="middle" x="25367" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="25367" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="25367" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_14_1 -->
<g id="node280" class="node">
<title>expert_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="25210.5,-857.45 24933.5,-857.45 24933.5,-813.45 25210.5,-813.45 25210.5,-857.45"/>
<text text-anchor="middle" x="25072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L3</text>
<text text-anchor="middle" x="25072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="25072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="25072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_14 -->
<g id="node281" class="node">
<title>tp_3_14</title>
<ellipse fill="lightblue" stroke="black" cx="24800" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="24800" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L3</text>
<text text-anchor="middle" x="24800" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="24800" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="24800" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_3_15 -->
<g id="node282" class="node">
<title>route_3_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="24465" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="24465" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="24465" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="24465" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="24465" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_3_15_0 -->
<g id="node283" class="node">
<title>expert_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="24246.5,-857.45 23969.5,-857.45 23969.5,-813.45 24246.5,-813.45 24246.5,-857.45"/>
<text text-anchor="middle" x="24108" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L3</text>
<text text-anchor="middle" x="24108" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="24108" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="24108" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_3_15_1 -->
<g id="node284" class="node">
<title>expert_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="23951.5,-857.45 23674.5,-857.45 23674.5,-813.45 23951.5,-813.45 23951.5,-857.45"/>
<text text-anchor="middle" x="23813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L3</text>
<text text-anchor="middle" x="23813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="23813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="23813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_3_15 -->
<g id="node285" class="node">
<title>tp_3_15</title>
<ellipse fill="lightblue" stroke="black" cx="23541" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="23541" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L3</text>
<text text-anchor="middle" x="23541" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="23541" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="23541" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_4 -->
<g id="node286" class="node">
<title>q_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="114293,-857.45 113997,-857.45 113997,-813.45 114293,-813.45 114293,-857.45"/>
<text text-anchor="middle" x="114145" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L4</text>
<text text-anchor="middle" x="114145" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="114145" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="114145" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_4 -->
<g id="node287" class="node">
<title>k_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="113979,-857.45 113683,-857.45 113683,-813.45 113979,-813.45 113979,-857.45"/>
<text text-anchor="middle" x="113831" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L4</text>
<text text-anchor="middle" x="113831" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="113831" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="113831" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_4 -->
<g id="node288" class="node">
<title>v_proj_4</title>
<polygon fill="lightgreen" stroke="black" points="113665,-857.45 113369,-857.45 113369,-813.45 113665,-813.45 113665,-857.45"/>
<text text-anchor="middle" x="113517" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L4</text>
<text text-anchor="middle" x="113517" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="113517" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="113517" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_4 -->
<g id="node289" class="node">
<title>attn_scores_4</title>
<polygon fill="lightgreen" stroke="black" points="113350.5,-857.45 113017.5,-857.45 113017.5,-813.45 113350.5,-813.45 113350.5,-857.45"/>
<text text-anchor="middle" x="113184" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L4</text>
<text text-anchor="middle" x="113184" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="113184" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="113184" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_4 -->
<g id="node290" class="node">
<title>softmax_4</title>
<polygon fill="lightgreen" stroke="black" points="112999.5,-857.45 112666.5,-857.45 112666.5,-813.45 112999.5,-813.45 112999.5,-857.45"/>
<text text-anchor="middle" x="112833" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L4</text>
<text text-anchor="middle" x="112833" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="112833" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="112833" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_4 -->
<g id="node291" class="node">
<title>attn_out_4</title>
<polygon fill="lightgreen" stroke="black" points="112648,-857.45 112352,-857.45 112352,-813.45 112648,-813.45 112648,-857.45"/>
<text text-anchor="middle" x="112500" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L4</text>
<text text-anchor="middle" x="112500" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="112500" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="112500" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_4 -->
<g id="node292" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="112333.74,-879.45 111856.92,-879.45 111734.26,-791.45 112211.08,-791.45 112333.74,-879.45"/>
<text text-anchor="middle" x="112034" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L4</text>
<text text-anchor="middle" x="112034" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;191</text>
<text text-anchor="middle" x="112034" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="112034" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_4_0 -->
<g id="node293" class="node">
<title>route_4_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="111516" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="111516" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="111516" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="111516" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="111516" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_0_0 -->
<g id="node294" class="node">
<title>expert_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="111297.5,-857.45 111020.5,-857.45 111020.5,-813.45 111297.5,-813.45 111297.5,-857.45"/>
<text text-anchor="middle" x="111159" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L4</text>
<text text-anchor="middle" x="111159" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="111159" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="111159" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_0_1 -->
<g id="node295" class="node">
<title>expert_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="111002.5,-857.45 110725.5,-857.45 110725.5,-813.45 111002.5,-813.45 111002.5,-857.45"/>
<text text-anchor="middle" x="110864" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L4</text>
<text text-anchor="middle" x="110864" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="110864" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="110864" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_0 -->
<g id="node296" class="node">
<title>tp_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="110592" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="110592" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L4</text>
<text text-anchor="middle" x="110592" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="110592" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="110592" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_1 -->
<g id="node297" class="node">
<title>route_4_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="110257" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="110257" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="110257" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="110257" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="110257" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_1_0 -->
<g id="node298" class="node">
<title>expert_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="110038.5,-857.45 109761.5,-857.45 109761.5,-813.45 110038.5,-813.45 110038.5,-857.45"/>
<text text-anchor="middle" x="109900" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L4</text>
<text text-anchor="middle" x="109900" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="109900" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="109900" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_1_1 -->
<g id="node299" class="node">
<title>expert_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="109743.5,-857.45 109466.5,-857.45 109466.5,-813.45 109743.5,-813.45 109743.5,-857.45"/>
<text text-anchor="middle" x="109605" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L4</text>
<text text-anchor="middle" x="109605" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="109605" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="109605" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_1 -->
<g id="node300" class="node">
<title>tp_4_1</title>
<ellipse fill="lightblue" stroke="black" cx="109333" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="109333" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L4</text>
<text text-anchor="middle" x="109333" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="109333" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="109333" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_2 -->
<g id="node301" class="node">
<title>route_4_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="108998" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="108998" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="108998" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="108998" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="108998" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_2_0 -->
<g id="node302" class="node">
<title>expert_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="108779.5,-857.45 108502.5,-857.45 108502.5,-813.45 108779.5,-813.45 108779.5,-857.45"/>
<text text-anchor="middle" x="108641" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L4</text>
<text text-anchor="middle" x="108641" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="108641" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="108641" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_2_1 -->
<g id="node303" class="node">
<title>expert_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="108484.5,-857.45 108207.5,-857.45 108207.5,-813.45 108484.5,-813.45 108484.5,-857.45"/>
<text text-anchor="middle" x="108346" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L4</text>
<text text-anchor="middle" x="108346" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="108346" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="108346" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_2 -->
<g id="node304" class="node">
<title>tp_4_2</title>
<ellipse fill="lightblue" stroke="black" cx="108074" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="108074" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L4</text>
<text text-anchor="middle" x="108074" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="108074" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="108074" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_3 -->
<g id="node305" class="node">
<title>route_4_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="107739" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="107739" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="107739" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="107739" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="107739" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_3_0 -->
<g id="node306" class="node">
<title>expert_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="107520.5,-857.45 107243.5,-857.45 107243.5,-813.45 107520.5,-813.45 107520.5,-857.45"/>
<text text-anchor="middle" x="107382" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L4</text>
<text text-anchor="middle" x="107382" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="107382" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="107382" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_3_1 -->
<g id="node307" class="node">
<title>expert_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="107225.5,-857.45 106948.5,-857.45 106948.5,-813.45 107225.5,-813.45 107225.5,-857.45"/>
<text text-anchor="middle" x="107087" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L4</text>
<text text-anchor="middle" x="107087" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="107087" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="107087" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_3 -->
<g id="node308" class="node">
<title>tp_4_3</title>
<ellipse fill="lightblue" stroke="black" cx="106815" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="106815" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L4</text>
<text text-anchor="middle" x="106815" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="106815" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="106815" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_4 -->
<g id="node309" class="node">
<title>route_4_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="106480" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="106480" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="106480" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="106480" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="106480" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_4_0 -->
<g id="node310" class="node">
<title>expert_4_4_0</title>
<polygon fill="lightgreen" stroke="black" points="106261.5,-857.45 105984.5,-857.45 105984.5,-813.45 106261.5,-813.45 106261.5,-857.45"/>
<text text-anchor="middle" x="106123" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L4</text>
<text text-anchor="middle" x="106123" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="106123" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="106123" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_4_1 -->
<g id="node311" class="node">
<title>expert_4_4_1</title>
<polygon fill="lightgreen" stroke="black" points="105966.5,-857.45 105689.5,-857.45 105689.5,-813.45 105966.5,-813.45 105966.5,-857.45"/>
<text text-anchor="middle" x="105828" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L4</text>
<text text-anchor="middle" x="105828" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="105828" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="105828" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_4 -->
<g id="node312" class="node">
<title>tp_4_4</title>
<ellipse fill="lightblue" stroke="black" cx="105556" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="105556" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L4</text>
<text text-anchor="middle" x="105556" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="105556" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="105556" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_5 -->
<g id="node313" class="node">
<title>route_4_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="105221" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="105221" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="105221" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="105221" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="105221" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_5_0 -->
<g id="node314" class="node">
<title>expert_4_5_0</title>
<polygon fill="lightgreen" stroke="black" points="105002.5,-857.45 104725.5,-857.45 104725.5,-813.45 105002.5,-813.45 105002.5,-857.45"/>
<text text-anchor="middle" x="104864" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L4</text>
<text text-anchor="middle" x="104864" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="104864" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="104864" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_5_1 -->
<g id="node315" class="node">
<title>expert_4_5_1</title>
<polygon fill="lightgreen" stroke="black" points="104707.5,-857.45 104430.5,-857.45 104430.5,-813.45 104707.5,-813.45 104707.5,-857.45"/>
<text text-anchor="middle" x="104569" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L4</text>
<text text-anchor="middle" x="104569" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="104569" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="104569" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_5 -->
<g id="node316" class="node">
<title>tp_4_5</title>
<ellipse fill="lightblue" stroke="black" cx="104297" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="104297" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L4</text>
<text text-anchor="middle" x="104297" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="104297" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="104297" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_6 -->
<g id="node317" class="node">
<title>route_4_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="103962" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="103962" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="103962" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="103962" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="103962" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_6_0 -->
<g id="node318" class="node">
<title>expert_4_6_0</title>
<polygon fill="lightgreen" stroke="black" points="103743.5,-857.45 103466.5,-857.45 103466.5,-813.45 103743.5,-813.45 103743.5,-857.45"/>
<text text-anchor="middle" x="103605" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L4</text>
<text text-anchor="middle" x="103605" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="103605" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="103605" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_6_1 -->
<g id="node319" class="node">
<title>expert_4_6_1</title>
<polygon fill="lightgreen" stroke="black" points="103448.5,-857.45 103171.5,-857.45 103171.5,-813.45 103448.5,-813.45 103448.5,-857.45"/>
<text text-anchor="middle" x="103310" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L4</text>
<text text-anchor="middle" x="103310" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="103310" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="103310" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_6 -->
<g id="node320" class="node">
<title>tp_4_6</title>
<ellipse fill="lightblue" stroke="black" cx="103038" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="103038" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L4</text>
<text text-anchor="middle" x="103038" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="103038" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="103038" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_7 -->
<g id="node321" class="node">
<title>route_4_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="102703" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="102703" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="102703" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="102703" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="102703" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_7_0 -->
<g id="node322" class="node">
<title>expert_4_7_0</title>
<polygon fill="lightgreen" stroke="black" points="102484.5,-857.45 102207.5,-857.45 102207.5,-813.45 102484.5,-813.45 102484.5,-857.45"/>
<text text-anchor="middle" x="102346" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L4</text>
<text text-anchor="middle" x="102346" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="102346" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="102346" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_7_1 -->
<g id="node323" class="node">
<title>expert_4_7_1</title>
<polygon fill="lightgreen" stroke="black" points="102189.5,-857.45 101912.5,-857.45 101912.5,-813.45 102189.5,-813.45 102189.5,-857.45"/>
<text text-anchor="middle" x="102051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L4</text>
<text text-anchor="middle" x="102051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="102051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="102051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_7 -->
<g id="node324" class="node">
<title>tp_4_7</title>
<ellipse fill="lightblue" stroke="black" cx="101779" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="101779" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L4</text>
<text text-anchor="middle" x="101779" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="101779" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="101779" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_8 -->
<g id="node325" class="node">
<title>route_4_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="101444" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="101444" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="101444" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="101444" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="101444" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_8_0 -->
<g id="node326" class="node">
<title>expert_4_8_0</title>
<polygon fill="lightgreen" stroke="black" points="101225.5,-857.45 100948.5,-857.45 100948.5,-813.45 101225.5,-813.45 101225.5,-857.45"/>
<text text-anchor="middle" x="101087" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L4</text>
<text text-anchor="middle" x="101087" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="101087" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="101087" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_8_1 -->
<g id="node327" class="node">
<title>expert_4_8_1</title>
<polygon fill="lightgreen" stroke="black" points="100930.5,-857.45 100653.5,-857.45 100653.5,-813.45 100930.5,-813.45 100930.5,-857.45"/>
<text text-anchor="middle" x="100792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L4</text>
<text text-anchor="middle" x="100792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="100792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="100792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_8 -->
<g id="node328" class="node">
<title>tp_4_8</title>
<ellipse fill="lightblue" stroke="black" cx="100520" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="100520" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L4</text>
<text text-anchor="middle" x="100520" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="100520" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="100520" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_9 -->
<g id="node329" class="node">
<title>route_4_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="100185" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="100185" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="100185" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="100185" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="100185" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_9_0 -->
<g id="node330" class="node">
<title>expert_4_9_0</title>
<polygon fill="lightgreen" stroke="black" points="99966.5,-857.45 99689.5,-857.45 99689.5,-813.45 99966.5,-813.45 99966.5,-857.45"/>
<text text-anchor="middle" x="99828" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L4</text>
<text text-anchor="middle" x="99828" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="99828" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="99828" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_9_1 -->
<g id="node331" class="node">
<title>expert_4_9_1</title>
<polygon fill="lightgreen" stroke="black" points="99671.5,-857.45 99394.5,-857.45 99394.5,-813.45 99671.5,-813.45 99671.5,-857.45"/>
<text text-anchor="middle" x="99533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L4</text>
<text text-anchor="middle" x="99533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="99533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="99533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_9 -->
<g id="node332" class="node">
<title>tp_4_9</title>
<ellipse fill="lightblue" stroke="black" cx="99261" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="99261" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L4</text>
<text text-anchor="middle" x="99261" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="99261" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="99261" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_10 -->
<g id="node333" class="node">
<title>route_4_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="98926" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="98926" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="98926" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="98926" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="98926" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_10_0 -->
<g id="node334" class="node">
<title>expert_4_10_0</title>
<polygon fill="lightgreen" stroke="black" points="98707.5,-857.45 98430.5,-857.45 98430.5,-813.45 98707.5,-813.45 98707.5,-857.45"/>
<text text-anchor="middle" x="98569" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L4</text>
<text text-anchor="middle" x="98569" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="98569" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="98569" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_10_1 -->
<g id="node335" class="node">
<title>expert_4_10_1</title>
<polygon fill="lightgreen" stroke="black" points="98412.5,-857.45 98135.5,-857.45 98135.5,-813.45 98412.5,-813.45 98412.5,-857.45"/>
<text text-anchor="middle" x="98274" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L4</text>
<text text-anchor="middle" x="98274" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="98274" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="98274" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_10 -->
<g id="node336" class="node">
<title>tp_4_10</title>
<ellipse fill="lightblue" stroke="black" cx="98002" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="98002" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L4</text>
<text text-anchor="middle" x="98002" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="98002" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="98002" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_11 -->
<g id="node337" class="node">
<title>route_4_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="97667" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="97667" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="97667" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="97667" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="97667" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_11_0 -->
<g id="node338" class="node">
<title>expert_4_11_0</title>
<polygon fill="lightgreen" stroke="black" points="97448.5,-857.45 97171.5,-857.45 97171.5,-813.45 97448.5,-813.45 97448.5,-857.45"/>
<text text-anchor="middle" x="97310" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L4</text>
<text text-anchor="middle" x="97310" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="97310" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="97310" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_11_1 -->
<g id="node339" class="node">
<title>expert_4_11_1</title>
<polygon fill="lightgreen" stroke="black" points="97153.5,-857.45 96876.5,-857.45 96876.5,-813.45 97153.5,-813.45 97153.5,-857.45"/>
<text text-anchor="middle" x="97015" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L4</text>
<text text-anchor="middle" x="97015" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="97015" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="97015" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_11 -->
<g id="node340" class="node">
<title>tp_4_11</title>
<ellipse fill="lightblue" stroke="black" cx="96743" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="96743" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L4</text>
<text text-anchor="middle" x="96743" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="96743" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="96743" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_12 -->
<g id="node341" class="node">
<title>route_4_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="96408" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="96408" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="96408" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="96408" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="96408" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_12_0 -->
<g id="node342" class="node">
<title>expert_4_12_0</title>
<polygon fill="lightgreen" stroke="black" points="96189.5,-857.45 95912.5,-857.45 95912.5,-813.45 96189.5,-813.45 96189.5,-857.45"/>
<text text-anchor="middle" x="96051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L4</text>
<text text-anchor="middle" x="96051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="96051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="96051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_12_1 -->
<g id="node343" class="node">
<title>expert_4_12_1</title>
<polygon fill="lightgreen" stroke="black" points="95894.5,-857.45 95617.5,-857.45 95617.5,-813.45 95894.5,-813.45 95894.5,-857.45"/>
<text text-anchor="middle" x="95756" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L4</text>
<text text-anchor="middle" x="95756" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="95756" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="95756" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_12 -->
<g id="node344" class="node">
<title>tp_4_12</title>
<ellipse fill="lightblue" stroke="black" cx="95484" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="95484" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L4</text>
<text text-anchor="middle" x="95484" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="95484" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="95484" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_13 -->
<g id="node345" class="node">
<title>route_4_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="95149" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="95149" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="95149" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="95149" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="95149" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_13_0 -->
<g id="node346" class="node">
<title>expert_4_13_0</title>
<polygon fill="lightgreen" stroke="black" points="94930.5,-857.45 94653.5,-857.45 94653.5,-813.45 94930.5,-813.45 94930.5,-857.45"/>
<text text-anchor="middle" x="94792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L4</text>
<text text-anchor="middle" x="94792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="94792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="94792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_13_1 -->
<g id="node347" class="node">
<title>expert_4_13_1</title>
<polygon fill="lightgreen" stroke="black" points="94635.5,-857.45 94358.5,-857.45 94358.5,-813.45 94635.5,-813.45 94635.5,-857.45"/>
<text text-anchor="middle" x="94497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L4</text>
<text text-anchor="middle" x="94497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="94497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="94497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_13 -->
<g id="node348" class="node">
<title>tp_4_13</title>
<ellipse fill="lightblue" stroke="black" cx="94225" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="94225" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L4</text>
<text text-anchor="middle" x="94225" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="94225" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="94225" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_14 -->
<g id="node349" class="node">
<title>route_4_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="93890" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="93890" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="93890" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="93890" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="93890" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_14_0 -->
<g id="node350" class="node">
<title>expert_4_14_0</title>
<polygon fill="lightgreen" stroke="black" points="93671.5,-857.45 93394.5,-857.45 93394.5,-813.45 93671.5,-813.45 93671.5,-857.45"/>
<text text-anchor="middle" x="93533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L4</text>
<text text-anchor="middle" x="93533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="93533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="93533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_14_1 -->
<g id="node351" class="node">
<title>expert_4_14_1</title>
<polygon fill="lightgreen" stroke="black" points="93376.5,-857.45 93099.5,-857.45 93099.5,-813.45 93376.5,-813.45 93376.5,-857.45"/>
<text text-anchor="middle" x="93238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L4</text>
<text text-anchor="middle" x="93238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="93238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="93238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_14 -->
<g id="node352" class="node">
<title>tp_4_14</title>
<ellipse fill="lightblue" stroke="black" cx="92966" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="92966" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L4</text>
<text text-anchor="middle" x="92966" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="92966" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="92966" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_4_15 -->
<g id="node353" class="node">
<title>route_4_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="92631" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="92631" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="92631" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="92631" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="92631" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_4_15_0 -->
<g id="node354" class="node">
<title>expert_4_15_0</title>
<polygon fill="lightgreen" stroke="black" points="92412.5,-857.45 92135.5,-857.45 92135.5,-813.45 92412.5,-813.45 92412.5,-857.45"/>
<text text-anchor="middle" x="92274" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L4</text>
<text text-anchor="middle" x="92274" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="92274" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="92274" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_4_15_1 -->
<g id="node355" class="node">
<title>expert_4_15_1</title>
<polygon fill="lightgreen" stroke="black" points="92117.5,-857.45 91840.5,-857.45 91840.5,-813.45 92117.5,-813.45 92117.5,-857.45"/>
<text text-anchor="middle" x="91979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L4</text>
<text text-anchor="middle" x="91979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="91979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="91979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_4_15 -->
<g id="node356" class="node">
<title>tp_4_15</title>
<ellipse fill="lightblue" stroke="black" cx="91707" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="91707" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L4</text>
<text text-anchor="middle" x="91707" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="91707" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="91707" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_5 -->
<g id="node357" class="node">
<title>q_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="91573,-857.45 91277,-857.45 91277,-813.45 91573,-813.45 91573,-857.45"/>
<text text-anchor="middle" x="91425" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L5</text>
<text text-anchor="middle" x="91425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="91425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="91425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_5 -->
<g id="node358" class="node">
<title>k_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="91259,-857.45 90963,-857.45 90963,-813.45 91259,-813.45 91259,-857.45"/>
<text text-anchor="middle" x="91111" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L5</text>
<text text-anchor="middle" x="91111" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="91111" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="91111" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_5 -->
<g id="node359" class="node">
<title>v_proj_5</title>
<polygon fill="lightgreen" stroke="black" points="90945,-857.45 90649,-857.45 90649,-813.45 90945,-813.45 90945,-857.45"/>
<text text-anchor="middle" x="90797" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L5</text>
<text text-anchor="middle" x="90797" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="90797" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="90797" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_5 -->
<g id="node360" class="node">
<title>attn_scores_5</title>
<polygon fill="lightgreen" stroke="black" points="90630.5,-857.45 90297.5,-857.45 90297.5,-813.45 90630.5,-813.45 90630.5,-857.45"/>
<text text-anchor="middle" x="90464" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L5</text>
<text text-anchor="middle" x="90464" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="90464" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="90464" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_5 -->
<g id="node361" class="node">
<title>softmax_5</title>
<polygon fill="lightgreen" stroke="black" points="90279.5,-857.45 89946.5,-857.45 89946.5,-813.45 90279.5,-813.45 90279.5,-857.45"/>
<text text-anchor="middle" x="90113" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L5</text>
<text text-anchor="middle" x="90113" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="90113" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="90113" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_5 -->
<g id="node362" class="node">
<title>attn_out_5</title>
<polygon fill="lightgreen" stroke="black" points="89928,-857.45 89632,-857.45 89632,-813.45 89928,-813.45 89928,-857.45"/>
<text text-anchor="middle" x="89780" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L5</text>
<text text-anchor="middle" x="89780" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;159</text>
<text text-anchor="middle" x="89780" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="89780" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_5 -->
<g id="node363" class="node">
<title>gate_5</title>
<polygon fill="lightyellow" stroke="black" points="89613.74,-879.45 89136.92,-879.45 89014.26,-791.45 89491.08,-791.45 89613.74,-879.45"/>
<text text-anchor="middle" x="89314" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L5</text>
<text text-anchor="middle" x="89314" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128&#45;191</text>
<text text-anchor="middle" x="89314" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="89314" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_5_0 -->
<g id="node364" class="node">
<title>route_5_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="88796" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="88796" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="88796" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="88796" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="88796" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_0_0 -->
<g id="node365" class="node">
<title>expert_5_0_0</title>
<polygon fill="lightgreen" stroke="black" points="88577.5,-857.45 88300.5,-857.45 88300.5,-813.45 88577.5,-813.45 88577.5,-857.45"/>
<text text-anchor="middle" x="88439" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L5</text>
<text text-anchor="middle" x="88439" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="88439" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="88439" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_0_1 -->
<g id="node366" class="node">
<title>expert_5_0_1</title>
<polygon fill="lightgreen" stroke="black" points="88282.5,-857.45 88005.5,-857.45 88005.5,-813.45 88282.5,-813.45 88282.5,-857.45"/>
<text text-anchor="middle" x="88144" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L5</text>
<text text-anchor="middle" x="88144" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="88144" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="88144" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_0 -->
<g id="node367" class="node">
<title>tp_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="87872" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="87872" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L5</text>
<text text-anchor="middle" x="87872" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="87872" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="87872" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_1 -->
<g id="node368" class="node">
<title>route_5_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="87537" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="87537" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="87537" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="87537" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="87537" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_1_0 -->
<g id="node369" class="node">
<title>expert_5_1_0</title>
<polygon fill="lightgreen" stroke="black" points="87318.5,-857.45 87041.5,-857.45 87041.5,-813.45 87318.5,-813.45 87318.5,-857.45"/>
<text text-anchor="middle" x="87180" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L5</text>
<text text-anchor="middle" x="87180" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="87180" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="87180" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_1_1 -->
<g id="node370" class="node">
<title>expert_5_1_1</title>
<polygon fill="lightgreen" stroke="black" points="87023.5,-857.45 86746.5,-857.45 86746.5,-813.45 87023.5,-813.45 87023.5,-857.45"/>
<text text-anchor="middle" x="86885" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L5</text>
<text text-anchor="middle" x="86885" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="86885" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="86885" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_1 -->
<g id="node371" class="node">
<title>tp_5_1</title>
<ellipse fill="lightblue" stroke="black" cx="86613" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="86613" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L5</text>
<text text-anchor="middle" x="86613" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="86613" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="86613" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_2 -->
<g id="node372" class="node">
<title>route_5_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="86278" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="86278" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="86278" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="86278" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="86278" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_2_0 -->
<g id="node373" class="node">
<title>expert_5_2_0</title>
<polygon fill="lightgreen" stroke="black" points="86059.5,-857.45 85782.5,-857.45 85782.5,-813.45 86059.5,-813.45 86059.5,-857.45"/>
<text text-anchor="middle" x="85921" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L5</text>
<text text-anchor="middle" x="85921" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="85921" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="85921" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_2_1 -->
<g id="node374" class="node">
<title>expert_5_2_1</title>
<polygon fill="lightgreen" stroke="black" points="85764.5,-857.45 85487.5,-857.45 85487.5,-813.45 85764.5,-813.45 85764.5,-857.45"/>
<text text-anchor="middle" x="85626" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L5</text>
<text text-anchor="middle" x="85626" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="85626" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="85626" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_2 -->
<g id="node375" class="node">
<title>tp_5_2</title>
<ellipse fill="lightblue" stroke="black" cx="85354" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="85354" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L5</text>
<text text-anchor="middle" x="85354" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="85354" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="85354" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_3 -->
<g id="node376" class="node">
<title>route_5_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="85019" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="85019" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="85019" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="85019" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="85019" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_3_0 -->
<g id="node377" class="node">
<title>expert_5_3_0</title>
<polygon fill="lightgreen" stroke="black" points="84800.5,-857.45 84523.5,-857.45 84523.5,-813.45 84800.5,-813.45 84800.5,-857.45"/>
<text text-anchor="middle" x="84662" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L5</text>
<text text-anchor="middle" x="84662" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="84662" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="84662" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_3_1 -->
<g id="node378" class="node">
<title>expert_5_3_1</title>
<polygon fill="lightgreen" stroke="black" points="84505.5,-857.45 84228.5,-857.45 84228.5,-813.45 84505.5,-813.45 84505.5,-857.45"/>
<text text-anchor="middle" x="84367" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L5</text>
<text text-anchor="middle" x="84367" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="84367" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="84367" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_3 -->
<g id="node379" class="node">
<title>tp_5_3</title>
<ellipse fill="lightblue" stroke="black" cx="84095" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="84095" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L5</text>
<text text-anchor="middle" x="84095" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="84095" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="84095" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_4 -->
<g id="node380" class="node">
<title>route_5_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="83760" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="83760" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="83760" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="83760" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="83760" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_4_0 -->
<g id="node381" class="node">
<title>expert_5_4_0</title>
<polygon fill="lightgreen" stroke="black" points="83541.5,-857.45 83264.5,-857.45 83264.5,-813.45 83541.5,-813.45 83541.5,-857.45"/>
<text text-anchor="middle" x="83403" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L5</text>
<text text-anchor="middle" x="83403" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="83403" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="83403" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_4_1 -->
<g id="node382" class="node">
<title>expert_5_4_1</title>
<polygon fill="lightgreen" stroke="black" points="83246.5,-857.45 82969.5,-857.45 82969.5,-813.45 83246.5,-813.45 83246.5,-857.45"/>
<text text-anchor="middle" x="83108" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L5</text>
<text text-anchor="middle" x="83108" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="83108" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="83108" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_4 -->
<g id="node383" class="node">
<title>tp_5_4</title>
<ellipse fill="lightblue" stroke="black" cx="82836" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="82836" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L5</text>
<text text-anchor="middle" x="82836" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="82836" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="82836" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_5 -->
<g id="node384" class="node">
<title>route_5_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="82501" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="82501" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="82501" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="82501" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="82501" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_5_0 -->
<g id="node385" class="node">
<title>expert_5_5_0</title>
<polygon fill="lightgreen" stroke="black" points="82282.5,-857.45 82005.5,-857.45 82005.5,-813.45 82282.5,-813.45 82282.5,-857.45"/>
<text text-anchor="middle" x="82144" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L5</text>
<text text-anchor="middle" x="82144" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="82144" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="82144" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_5_1 -->
<g id="node386" class="node">
<title>expert_5_5_1</title>
<polygon fill="lightgreen" stroke="black" points="81987.5,-857.45 81710.5,-857.45 81710.5,-813.45 81987.5,-813.45 81987.5,-857.45"/>
<text text-anchor="middle" x="81849" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L5</text>
<text text-anchor="middle" x="81849" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="81849" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="81849" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_5 -->
<g id="node387" class="node">
<title>tp_5_5</title>
<ellipse fill="lightblue" stroke="black" cx="81577" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="81577" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L5</text>
<text text-anchor="middle" x="81577" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="81577" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="81577" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_6 -->
<g id="node388" class="node">
<title>route_5_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="81242" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="81242" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="81242" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="81242" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="81242" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_6_0 -->
<g id="node389" class="node">
<title>expert_5_6_0</title>
<polygon fill="lightgreen" stroke="black" points="81023.5,-857.45 80746.5,-857.45 80746.5,-813.45 81023.5,-813.45 81023.5,-857.45"/>
<text text-anchor="middle" x="80885" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L5</text>
<text text-anchor="middle" x="80885" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="80885" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="80885" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_6_1 -->
<g id="node390" class="node">
<title>expert_5_6_1</title>
<polygon fill="lightgreen" stroke="black" points="80728.5,-857.45 80451.5,-857.45 80451.5,-813.45 80728.5,-813.45 80728.5,-857.45"/>
<text text-anchor="middle" x="80590" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L5</text>
<text text-anchor="middle" x="80590" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="80590" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="80590" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_6 -->
<g id="node391" class="node">
<title>tp_5_6</title>
<ellipse fill="lightblue" stroke="black" cx="80318" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="80318" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L5</text>
<text text-anchor="middle" x="80318" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="80318" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="80318" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_7 -->
<g id="node392" class="node">
<title>route_5_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="79983" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="79983" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="79983" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="79983" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="79983" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_7_0 -->
<g id="node393" class="node">
<title>expert_5_7_0</title>
<polygon fill="lightgreen" stroke="black" points="79764.5,-857.45 79487.5,-857.45 79487.5,-813.45 79764.5,-813.45 79764.5,-857.45"/>
<text text-anchor="middle" x="79626" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L5</text>
<text text-anchor="middle" x="79626" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="79626" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="79626" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_7_1 -->
<g id="node394" class="node">
<title>expert_5_7_1</title>
<polygon fill="lightgreen" stroke="black" points="79469.5,-857.45 79192.5,-857.45 79192.5,-813.45 79469.5,-813.45 79469.5,-857.45"/>
<text text-anchor="middle" x="79331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L5</text>
<text text-anchor="middle" x="79331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="79331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="79331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_7 -->
<g id="node395" class="node">
<title>tp_5_7</title>
<ellipse fill="lightblue" stroke="black" cx="79059" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="79059" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L5</text>
<text text-anchor="middle" x="79059" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="79059" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="79059" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_8 -->
<g id="node396" class="node">
<title>route_5_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="78724" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="78724" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="78724" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="78724" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="78724" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_8_0 -->
<g id="node397" class="node">
<title>expert_5_8_0</title>
<polygon fill="lightgreen" stroke="black" points="78505.5,-857.45 78228.5,-857.45 78228.5,-813.45 78505.5,-813.45 78505.5,-857.45"/>
<text text-anchor="middle" x="78367" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L5</text>
<text text-anchor="middle" x="78367" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="78367" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="78367" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_8_1 -->
<g id="node398" class="node">
<title>expert_5_8_1</title>
<polygon fill="lightgreen" stroke="black" points="78210.5,-857.45 77933.5,-857.45 77933.5,-813.45 78210.5,-813.45 78210.5,-857.45"/>
<text text-anchor="middle" x="78072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L5</text>
<text text-anchor="middle" x="78072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="78072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="78072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_8 -->
<g id="node399" class="node">
<title>tp_5_8</title>
<ellipse fill="lightblue" stroke="black" cx="77800" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="77800" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L5</text>
<text text-anchor="middle" x="77800" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="77800" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="77800" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_9 -->
<g id="node400" class="node">
<title>route_5_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="77465" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="77465" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="77465" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="77465" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="77465" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_9_0 -->
<g id="node401" class="node">
<title>expert_5_9_0</title>
<polygon fill="lightgreen" stroke="black" points="77246.5,-857.45 76969.5,-857.45 76969.5,-813.45 77246.5,-813.45 77246.5,-857.45"/>
<text text-anchor="middle" x="77108" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L5</text>
<text text-anchor="middle" x="77108" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="77108" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="77108" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_9_1 -->
<g id="node402" class="node">
<title>expert_5_9_1</title>
<polygon fill="lightgreen" stroke="black" points="76951.5,-857.45 76674.5,-857.45 76674.5,-813.45 76951.5,-813.45 76951.5,-857.45"/>
<text text-anchor="middle" x="76813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L5</text>
<text text-anchor="middle" x="76813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="76813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="76813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_9 -->
<g id="node403" class="node">
<title>tp_5_9</title>
<ellipse fill="lightblue" stroke="black" cx="76541" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="76541" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L5</text>
<text text-anchor="middle" x="76541" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="76541" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="76541" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_10 -->
<g id="node404" class="node">
<title>route_5_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="76206" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="76206" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="76206" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="76206" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="76206" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_10_0 -->
<g id="node405" class="node">
<title>expert_5_10_0</title>
<polygon fill="lightgreen" stroke="black" points="75987.5,-857.45 75710.5,-857.45 75710.5,-813.45 75987.5,-813.45 75987.5,-857.45"/>
<text text-anchor="middle" x="75849" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L5</text>
<text text-anchor="middle" x="75849" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="75849" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="75849" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_10_1 -->
<g id="node406" class="node">
<title>expert_5_10_1</title>
<polygon fill="lightgreen" stroke="black" points="75692.5,-857.45 75415.5,-857.45 75415.5,-813.45 75692.5,-813.45 75692.5,-857.45"/>
<text text-anchor="middle" x="75554" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L5</text>
<text text-anchor="middle" x="75554" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="75554" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="75554" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_10 -->
<g id="node407" class="node">
<title>tp_5_10</title>
<ellipse fill="lightblue" stroke="black" cx="75282" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="75282" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L5</text>
<text text-anchor="middle" x="75282" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="75282" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="75282" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_11 -->
<g id="node408" class="node">
<title>route_5_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="74947" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="74947" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="74947" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="74947" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="74947" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_11_0 -->
<g id="node409" class="node">
<title>expert_5_11_0</title>
<polygon fill="lightgreen" stroke="black" points="74728.5,-857.45 74451.5,-857.45 74451.5,-813.45 74728.5,-813.45 74728.5,-857.45"/>
<text text-anchor="middle" x="74590" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L5</text>
<text text-anchor="middle" x="74590" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="74590" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="74590" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_11_1 -->
<g id="node410" class="node">
<title>expert_5_11_1</title>
<polygon fill="lightgreen" stroke="black" points="74433.5,-857.45 74156.5,-857.45 74156.5,-813.45 74433.5,-813.45 74433.5,-857.45"/>
<text text-anchor="middle" x="74295" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L5</text>
<text text-anchor="middle" x="74295" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="74295" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="74295" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_11 -->
<g id="node411" class="node">
<title>tp_5_11</title>
<ellipse fill="lightblue" stroke="black" cx="74023" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="74023" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L5</text>
<text text-anchor="middle" x="74023" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="74023" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="74023" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_12 -->
<g id="node412" class="node">
<title>route_5_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="73688" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="73688" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="73688" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="73688" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="73688" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_12_0 -->
<g id="node413" class="node">
<title>expert_5_12_0</title>
<polygon fill="lightgreen" stroke="black" points="73469.5,-857.45 73192.5,-857.45 73192.5,-813.45 73469.5,-813.45 73469.5,-857.45"/>
<text text-anchor="middle" x="73331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L5</text>
<text text-anchor="middle" x="73331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="73331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="73331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_12_1 -->
<g id="node414" class="node">
<title>expert_5_12_1</title>
<polygon fill="lightgreen" stroke="black" points="73174.5,-857.45 72897.5,-857.45 72897.5,-813.45 73174.5,-813.45 73174.5,-857.45"/>
<text text-anchor="middle" x="73036" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L5</text>
<text text-anchor="middle" x="73036" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="73036" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="73036" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_12 -->
<g id="node415" class="node">
<title>tp_5_12</title>
<ellipse fill="lightblue" stroke="black" cx="72764" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="72764" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L5</text>
<text text-anchor="middle" x="72764" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="72764" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="72764" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_13 -->
<g id="node416" class="node">
<title>route_5_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="72429" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="72429" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="72429" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="72429" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="72429" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_13_0 -->
<g id="node417" class="node">
<title>expert_5_13_0</title>
<polygon fill="lightgreen" stroke="black" points="72210.5,-857.45 71933.5,-857.45 71933.5,-813.45 72210.5,-813.45 72210.5,-857.45"/>
<text text-anchor="middle" x="72072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L5</text>
<text text-anchor="middle" x="72072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="72072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="72072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_13_1 -->
<g id="node418" class="node">
<title>expert_5_13_1</title>
<polygon fill="lightgreen" stroke="black" points="71915.5,-857.45 71638.5,-857.45 71638.5,-813.45 71915.5,-813.45 71915.5,-857.45"/>
<text text-anchor="middle" x="71777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L5</text>
<text text-anchor="middle" x="71777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="71777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="71777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_13 -->
<g id="node419" class="node">
<title>tp_5_13</title>
<ellipse fill="lightblue" stroke="black" cx="71505" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="71505" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L5</text>
<text text-anchor="middle" x="71505" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="71505" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="71505" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_14 -->
<g id="node420" class="node">
<title>route_5_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="71170" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="71170" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="71170" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="71170" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="71170" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_14_0 -->
<g id="node421" class="node">
<title>expert_5_14_0</title>
<polygon fill="lightgreen" stroke="black" points="70951.5,-857.45 70674.5,-857.45 70674.5,-813.45 70951.5,-813.45 70951.5,-857.45"/>
<text text-anchor="middle" x="70813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L5</text>
<text text-anchor="middle" x="70813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="70813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="70813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_14_1 -->
<g id="node422" class="node">
<title>expert_5_14_1</title>
<polygon fill="lightgreen" stroke="black" points="70656.5,-857.45 70379.5,-857.45 70379.5,-813.45 70656.5,-813.45 70656.5,-857.45"/>
<text text-anchor="middle" x="70518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L5</text>
<text text-anchor="middle" x="70518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="70518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="70518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_14 -->
<g id="node423" class="node">
<title>tp_5_14</title>
<ellipse fill="lightblue" stroke="black" cx="70246" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="70246" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L5</text>
<text text-anchor="middle" x="70246" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="70246" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="70246" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_5_15 -->
<g id="node424" class="node">
<title>route_5_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="69911" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="69911" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="69911" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="69911" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="69911" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_5_15_0 -->
<g id="node425" class="node">
<title>expert_5_15_0</title>
<polygon fill="lightgreen" stroke="black" points="69692.5,-857.45 69415.5,-857.45 69415.5,-813.45 69692.5,-813.45 69692.5,-857.45"/>
<text text-anchor="middle" x="69554" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L5</text>
<text text-anchor="middle" x="69554" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="69554" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="69554" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_5_15_1 -->
<g id="node426" class="node">
<title>expert_5_15_1</title>
<polygon fill="lightgreen" stroke="black" points="69397.5,-857.45 69120.5,-857.45 69120.5,-813.45 69397.5,-813.45 69397.5,-857.45"/>
<text text-anchor="middle" x="69259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L5</text>
<text text-anchor="middle" x="69259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="69259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="69259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_5_15 -->
<g id="node427" class="node">
<title>tp_5_15</title>
<ellipse fill="lightblue" stroke="black" cx="68987" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="68987" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L5</text>
<text text-anchor="middle" x="68987" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="68987" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="68987" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_6 -->
<g id="node428" class="node">
<title>q_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="159739,-857.45 159443,-857.45 159443,-813.45 159739,-813.45 159739,-857.45"/>
<text text-anchor="middle" x="159591" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L6</text>
<text text-anchor="middle" x="159591" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="159591" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="159591" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_6 -->
<g id="node429" class="node">
<title>k_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="159425,-857.45 159129,-857.45 159129,-813.45 159425,-813.45 159425,-857.45"/>
<text text-anchor="middle" x="159277" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L6</text>
<text text-anchor="middle" x="159277" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="159277" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="159277" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_6 -->
<g id="node430" class="node">
<title>v_proj_6</title>
<polygon fill="lightgreen" stroke="black" points="159111,-857.45 158815,-857.45 158815,-813.45 159111,-813.45 159111,-857.45"/>
<text text-anchor="middle" x="158963" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L6</text>
<text text-anchor="middle" x="158963" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="158963" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="158963" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_6 -->
<g id="node431" class="node">
<title>attn_scores_6</title>
<polygon fill="lightgreen" stroke="black" points="158796.5,-857.45 158463.5,-857.45 158463.5,-813.45 158796.5,-813.45 158796.5,-857.45"/>
<text text-anchor="middle" x="158630" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L6</text>
<text text-anchor="middle" x="158630" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="158630" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="158630" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_6 -->
<g id="node432" class="node">
<title>softmax_6</title>
<polygon fill="lightgreen" stroke="black" points="158445.5,-857.45 158112.5,-857.45 158112.5,-813.45 158445.5,-813.45 158445.5,-857.45"/>
<text text-anchor="middle" x="158279" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L6</text>
<text text-anchor="middle" x="158279" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="158279" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="158279" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_6 -->
<g id="node433" class="node">
<title>attn_out_6</title>
<polygon fill="lightgreen" stroke="black" points="158094,-857.45 157798,-857.45 157798,-813.45 158094,-813.45 158094,-857.45"/>
<text text-anchor="middle" x="157946" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L6</text>
<text text-anchor="middle" x="157946" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="157946" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157946" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_6 -->
<g id="node434" class="node">
<title>gate_6</title>
<polygon fill="lightyellow" stroke="black" points="157779.74,-879.45 157302.92,-879.45 157180.26,-791.45 157657.08,-791.45 157779.74,-879.45"/>
<text text-anchor="middle" x="157480" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L6</text>
<text text-anchor="middle" x="157480" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;255</text>
<text text-anchor="middle" x="157480" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="157480" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_6_0 -->
<g id="node435" class="node">
<title>route_6_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="156962" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="156962" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="156962" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="156962" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="156962" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_0_0 -->
<g id="node436" class="node">
<title>expert_6_0_0</title>
<polygon fill="lightgreen" stroke="black" points="156743.5,-857.45 156466.5,-857.45 156466.5,-813.45 156743.5,-813.45 156743.5,-857.45"/>
<text text-anchor="middle" x="156605" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L6</text>
<text text-anchor="middle" x="156605" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="156605" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="156605" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_0_1 -->
<g id="node437" class="node">
<title>expert_6_0_1</title>
<polygon fill="lightgreen" stroke="black" points="156448.5,-857.45 156171.5,-857.45 156171.5,-813.45 156448.5,-813.45 156448.5,-857.45"/>
<text text-anchor="middle" x="156310" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L6</text>
<text text-anchor="middle" x="156310" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="156310" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="156310" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_0 -->
<g id="node438" class="node">
<title>tp_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="156038" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="156038" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L6</text>
<text text-anchor="middle" x="156038" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="156038" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="156038" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_1 -->
<g id="node439" class="node">
<title>route_6_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="155703" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="155703" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="155703" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="155703" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155703" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_1_0 -->
<g id="node440" class="node">
<title>expert_6_1_0</title>
<polygon fill="lightgreen" stroke="black" points="155484.5,-857.45 155207.5,-857.45 155207.5,-813.45 155484.5,-813.45 155484.5,-857.45"/>
<text text-anchor="middle" x="155346" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L6</text>
<text text-anchor="middle" x="155346" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="155346" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155346" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_1_1 -->
<g id="node441" class="node">
<title>expert_6_1_1</title>
<polygon fill="lightgreen" stroke="black" points="155189.5,-857.45 154912.5,-857.45 154912.5,-813.45 155189.5,-813.45 155189.5,-857.45"/>
<text text-anchor="middle" x="155051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L6</text>
<text text-anchor="middle" x="155051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="155051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_1 -->
<g id="node442" class="node">
<title>tp_6_1</title>
<ellipse fill="lightblue" stroke="black" cx="154779" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="154779" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L6</text>
<text text-anchor="middle" x="154779" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="154779" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="154779" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_2 -->
<g id="node443" class="node">
<title>route_6_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="154444" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="154444" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="154444" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="154444" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="154444" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_2_0 -->
<g id="node444" class="node">
<title>expert_6_2_0</title>
<polygon fill="lightgreen" stroke="black" points="154225.5,-857.45 153948.5,-857.45 153948.5,-813.45 154225.5,-813.45 154225.5,-857.45"/>
<text text-anchor="middle" x="154087" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L6</text>
<text text-anchor="middle" x="154087" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="154087" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="154087" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_2_1 -->
<g id="node445" class="node">
<title>expert_6_2_1</title>
<polygon fill="lightgreen" stroke="black" points="153930.5,-857.45 153653.5,-857.45 153653.5,-813.45 153930.5,-813.45 153930.5,-857.45"/>
<text text-anchor="middle" x="153792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L6</text>
<text text-anchor="middle" x="153792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="153792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="153792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_2 -->
<g id="node446" class="node">
<title>tp_6_2</title>
<ellipse fill="lightblue" stroke="black" cx="153520" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="153520" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L6</text>
<text text-anchor="middle" x="153520" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="153520" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="153520" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_3 -->
<g id="node447" class="node">
<title>route_6_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="153185" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="153185" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="153185" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="153185" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="153185" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_3_0 -->
<g id="node448" class="node">
<title>expert_6_3_0</title>
<polygon fill="lightgreen" stroke="black" points="152966.5,-857.45 152689.5,-857.45 152689.5,-813.45 152966.5,-813.45 152966.5,-857.45"/>
<text text-anchor="middle" x="152828" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L6</text>
<text text-anchor="middle" x="152828" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="152828" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="152828" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_3_1 -->
<g id="node449" class="node">
<title>expert_6_3_1</title>
<polygon fill="lightgreen" stroke="black" points="152671.5,-857.45 152394.5,-857.45 152394.5,-813.45 152671.5,-813.45 152671.5,-857.45"/>
<text text-anchor="middle" x="152533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L6</text>
<text text-anchor="middle" x="152533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="152533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="152533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_3 -->
<g id="node450" class="node">
<title>tp_6_3</title>
<ellipse fill="lightblue" stroke="black" cx="152261" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="152261" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L6</text>
<text text-anchor="middle" x="152261" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="152261" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="152261" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_4 -->
<g id="node451" class="node">
<title>route_6_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="151926" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="151926" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="151926" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="151926" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="151926" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_4_0 -->
<g id="node452" class="node">
<title>expert_6_4_0</title>
<polygon fill="lightgreen" stroke="black" points="151707.5,-857.45 151430.5,-857.45 151430.5,-813.45 151707.5,-813.45 151707.5,-857.45"/>
<text text-anchor="middle" x="151569" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L6</text>
<text text-anchor="middle" x="151569" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="151569" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="151569" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_4_1 -->
<g id="node453" class="node">
<title>expert_6_4_1</title>
<polygon fill="lightgreen" stroke="black" points="151412.5,-857.45 151135.5,-857.45 151135.5,-813.45 151412.5,-813.45 151412.5,-857.45"/>
<text text-anchor="middle" x="151274" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L6</text>
<text text-anchor="middle" x="151274" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="151274" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="151274" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_4 -->
<g id="node454" class="node">
<title>tp_6_4</title>
<ellipse fill="lightblue" stroke="black" cx="151002" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="151002" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L6</text>
<text text-anchor="middle" x="151002" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="151002" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="151002" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_5 -->
<g id="node455" class="node">
<title>route_6_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="150667" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="150667" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="150667" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="150667" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="150667" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_5_0 -->
<g id="node456" class="node">
<title>expert_6_5_0</title>
<polygon fill="lightgreen" stroke="black" points="150448.5,-857.45 150171.5,-857.45 150171.5,-813.45 150448.5,-813.45 150448.5,-857.45"/>
<text text-anchor="middle" x="150310" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L6</text>
<text text-anchor="middle" x="150310" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="150310" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="150310" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_5_1 -->
<g id="node457" class="node">
<title>expert_6_5_1</title>
<polygon fill="lightgreen" stroke="black" points="150153.5,-857.45 149876.5,-857.45 149876.5,-813.45 150153.5,-813.45 150153.5,-857.45"/>
<text text-anchor="middle" x="150015" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L6</text>
<text text-anchor="middle" x="150015" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="150015" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="150015" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_5 -->
<g id="node458" class="node">
<title>tp_6_5</title>
<ellipse fill="lightblue" stroke="black" cx="149743" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="149743" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L6</text>
<text text-anchor="middle" x="149743" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="149743" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="149743" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_6 -->
<g id="node459" class="node">
<title>route_6_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="149408" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="149408" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="149408" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="149408" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="149408" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_6_0 -->
<g id="node460" class="node">
<title>expert_6_6_0</title>
<polygon fill="lightgreen" stroke="black" points="149189.5,-857.45 148912.5,-857.45 148912.5,-813.45 149189.5,-813.45 149189.5,-857.45"/>
<text text-anchor="middle" x="149051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L6</text>
<text text-anchor="middle" x="149051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="149051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="149051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_6_1 -->
<g id="node461" class="node">
<title>expert_6_6_1</title>
<polygon fill="lightgreen" stroke="black" points="148894.5,-857.45 148617.5,-857.45 148617.5,-813.45 148894.5,-813.45 148894.5,-857.45"/>
<text text-anchor="middle" x="148756" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L6</text>
<text text-anchor="middle" x="148756" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="148756" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="148756" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_6 -->
<g id="node462" class="node">
<title>tp_6_6</title>
<ellipse fill="lightblue" stroke="black" cx="148484" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="148484" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L6</text>
<text text-anchor="middle" x="148484" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="148484" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="148484" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_7 -->
<g id="node463" class="node">
<title>route_6_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="148149" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="148149" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="148149" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="148149" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="148149" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_7_0 -->
<g id="node464" class="node">
<title>expert_6_7_0</title>
<polygon fill="lightgreen" stroke="black" points="147930.5,-857.45 147653.5,-857.45 147653.5,-813.45 147930.5,-813.45 147930.5,-857.45"/>
<text text-anchor="middle" x="147792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L6</text>
<text text-anchor="middle" x="147792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="147792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="147792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_7_1 -->
<g id="node465" class="node">
<title>expert_6_7_1</title>
<polygon fill="lightgreen" stroke="black" points="147635.5,-857.45 147358.5,-857.45 147358.5,-813.45 147635.5,-813.45 147635.5,-857.45"/>
<text text-anchor="middle" x="147497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L6</text>
<text text-anchor="middle" x="147497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="147497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="147497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_7 -->
<g id="node466" class="node">
<title>tp_6_7</title>
<ellipse fill="lightblue" stroke="black" cx="147225" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="147225" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L6</text>
<text text-anchor="middle" x="147225" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="147225" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="147225" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_8 -->
<g id="node467" class="node">
<title>route_6_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="146890" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="146890" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="146890" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="146890" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="146890" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_8_0 -->
<g id="node468" class="node">
<title>expert_6_8_0</title>
<polygon fill="lightgreen" stroke="black" points="146671.5,-857.45 146394.5,-857.45 146394.5,-813.45 146671.5,-813.45 146671.5,-857.45"/>
<text text-anchor="middle" x="146533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L6</text>
<text text-anchor="middle" x="146533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="146533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="146533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_8_1 -->
<g id="node469" class="node">
<title>expert_6_8_1</title>
<polygon fill="lightgreen" stroke="black" points="146376.5,-857.45 146099.5,-857.45 146099.5,-813.45 146376.5,-813.45 146376.5,-857.45"/>
<text text-anchor="middle" x="146238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L6</text>
<text text-anchor="middle" x="146238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="146238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="146238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_8 -->
<g id="node470" class="node">
<title>tp_6_8</title>
<ellipse fill="lightblue" stroke="black" cx="145966" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="145966" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L6</text>
<text text-anchor="middle" x="145966" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="145966" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="145966" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_9 -->
<g id="node471" class="node">
<title>route_6_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="145631" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="145631" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="145631" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="145631" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="145631" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_9_0 -->
<g id="node472" class="node">
<title>expert_6_9_0</title>
<polygon fill="lightgreen" stroke="black" points="145412.5,-857.45 145135.5,-857.45 145135.5,-813.45 145412.5,-813.45 145412.5,-857.45"/>
<text text-anchor="middle" x="145274" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L6</text>
<text text-anchor="middle" x="145274" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="145274" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="145274" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_9_1 -->
<g id="node473" class="node">
<title>expert_6_9_1</title>
<polygon fill="lightgreen" stroke="black" points="145117.5,-857.45 144840.5,-857.45 144840.5,-813.45 145117.5,-813.45 145117.5,-857.45"/>
<text text-anchor="middle" x="144979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L6</text>
<text text-anchor="middle" x="144979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="144979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="144979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_9 -->
<g id="node474" class="node">
<title>tp_6_9</title>
<ellipse fill="lightblue" stroke="black" cx="144707" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="144707" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L6</text>
<text text-anchor="middle" x="144707" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="144707" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="144707" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_10 -->
<g id="node475" class="node">
<title>route_6_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="144372" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="144372" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="144372" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="144372" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="144372" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_10_0 -->
<g id="node476" class="node">
<title>expert_6_10_0</title>
<polygon fill="lightgreen" stroke="black" points="144153.5,-857.45 143876.5,-857.45 143876.5,-813.45 144153.5,-813.45 144153.5,-857.45"/>
<text text-anchor="middle" x="144015" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L6</text>
<text text-anchor="middle" x="144015" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="144015" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="144015" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_10_1 -->
<g id="node477" class="node">
<title>expert_6_10_1</title>
<polygon fill="lightgreen" stroke="black" points="143858.5,-857.45 143581.5,-857.45 143581.5,-813.45 143858.5,-813.45 143858.5,-857.45"/>
<text text-anchor="middle" x="143720" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L6</text>
<text text-anchor="middle" x="143720" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="143720" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="143720" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_10 -->
<g id="node478" class="node">
<title>tp_6_10</title>
<ellipse fill="lightblue" stroke="black" cx="143448" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="143448" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L6</text>
<text text-anchor="middle" x="143448" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="143448" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="143448" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_11 -->
<g id="node479" class="node">
<title>route_6_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="143113" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="143113" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="143113" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="143113" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="143113" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_11_0 -->
<g id="node480" class="node">
<title>expert_6_11_0</title>
<polygon fill="lightgreen" stroke="black" points="142894.5,-857.45 142617.5,-857.45 142617.5,-813.45 142894.5,-813.45 142894.5,-857.45"/>
<text text-anchor="middle" x="142756" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L6</text>
<text text-anchor="middle" x="142756" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="142756" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="142756" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_11_1 -->
<g id="node481" class="node">
<title>expert_6_11_1</title>
<polygon fill="lightgreen" stroke="black" points="142599.5,-857.45 142322.5,-857.45 142322.5,-813.45 142599.5,-813.45 142599.5,-857.45"/>
<text text-anchor="middle" x="142461" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L6</text>
<text text-anchor="middle" x="142461" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="142461" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="142461" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_11 -->
<g id="node482" class="node">
<title>tp_6_11</title>
<ellipse fill="lightblue" stroke="black" cx="142189" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="142189" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L6</text>
<text text-anchor="middle" x="142189" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="142189" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="142189" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_12 -->
<g id="node483" class="node">
<title>route_6_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="141854" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="141854" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="141854" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="141854" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="141854" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_12_0 -->
<g id="node484" class="node">
<title>expert_6_12_0</title>
<polygon fill="lightgreen" stroke="black" points="141635.5,-857.45 141358.5,-857.45 141358.5,-813.45 141635.5,-813.45 141635.5,-857.45"/>
<text text-anchor="middle" x="141497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L6</text>
<text text-anchor="middle" x="141497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="141497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="141497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_12_1 -->
<g id="node485" class="node">
<title>expert_6_12_1</title>
<polygon fill="lightgreen" stroke="black" points="141340.5,-857.45 141063.5,-857.45 141063.5,-813.45 141340.5,-813.45 141340.5,-857.45"/>
<text text-anchor="middle" x="141202" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L6</text>
<text text-anchor="middle" x="141202" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="141202" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="141202" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_12 -->
<g id="node486" class="node">
<title>tp_6_12</title>
<ellipse fill="lightblue" stroke="black" cx="140930" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="140930" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L6</text>
<text text-anchor="middle" x="140930" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="140930" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="140930" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_13 -->
<g id="node487" class="node">
<title>route_6_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="140595" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="140595" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="140595" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="140595" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="140595" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_13_0 -->
<g id="node488" class="node">
<title>expert_6_13_0</title>
<polygon fill="lightgreen" stroke="black" points="140376.5,-857.45 140099.5,-857.45 140099.5,-813.45 140376.5,-813.45 140376.5,-857.45"/>
<text text-anchor="middle" x="140238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L6</text>
<text text-anchor="middle" x="140238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="140238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="140238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_13_1 -->
<g id="node489" class="node">
<title>expert_6_13_1</title>
<polygon fill="lightgreen" stroke="black" points="140081.5,-857.45 139804.5,-857.45 139804.5,-813.45 140081.5,-813.45 140081.5,-857.45"/>
<text text-anchor="middle" x="139943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L6</text>
<text text-anchor="middle" x="139943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="139943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="139943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_13 -->
<g id="node490" class="node">
<title>tp_6_13</title>
<ellipse fill="lightblue" stroke="black" cx="139671" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="139671" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L6</text>
<text text-anchor="middle" x="139671" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="139671" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="139671" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_14 -->
<g id="node491" class="node">
<title>route_6_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="139336" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="139336" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="139336" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="139336" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="139336" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_14_0 -->
<g id="node492" class="node">
<title>expert_6_14_0</title>
<polygon fill="lightgreen" stroke="black" points="139117.5,-857.45 138840.5,-857.45 138840.5,-813.45 139117.5,-813.45 139117.5,-857.45"/>
<text text-anchor="middle" x="138979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L6</text>
<text text-anchor="middle" x="138979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="138979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="138979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_14_1 -->
<g id="node493" class="node">
<title>expert_6_14_1</title>
<polygon fill="lightgreen" stroke="black" points="138822.5,-857.45 138545.5,-857.45 138545.5,-813.45 138822.5,-813.45 138822.5,-857.45"/>
<text text-anchor="middle" x="138684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L6</text>
<text text-anchor="middle" x="138684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="138684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="138684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_14 -->
<g id="node494" class="node">
<title>tp_6_14</title>
<ellipse fill="lightblue" stroke="black" cx="138412" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="138412" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L6</text>
<text text-anchor="middle" x="138412" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="138412" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="138412" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_6_15 -->
<g id="node495" class="node">
<title>route_6_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="138077" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="138077" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="138077" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="138077" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="138077" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_6_15_0 -->
<g id="node496" class="node">
<title>expert_6_15_0</title>
<polygon fill="lightgreen" stroke="black" points="137858.5,-857.45 137581.5,-857.45 137581.5,-813.45 137858.5,-813.45 137858.5,-857.45"/>
<text text-anchor="middle" x="137720" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L6</text>
<text text-anchor="middle" x="137720" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="137720" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="137720" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_6_15_1 -->
<g id="node497" class="node">
<title>expert_6_15_1</title>
<polygon fill="lightgreen" stroke="black" points="137563.5,-857.45 137286.5,-857.45 137286.5,-813.45 137563.5,-813.45 137563.5,-857.45"/>
<text text-anchor="middle" x="137425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L6</text>
<text text-anchor="middle" x="137425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="137425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="137425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_6_15 -->
<g id="node498" class="node">
<title>tp_6_15</title>
<ellipse fill="lightblue" stroke="black" cx="137153" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="137153" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L6</text>
<text text-anchor="middle" x="137153" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="137153" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="137153" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_7 -->
<g id="node499" class="node">
<title>q_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="137019,-857.45 136723,-857.45 136723,-813.45 137019,-813.45 137019,-857.45"/>
<text text-anchor="middle" x="136871" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L7</text>
<text text-anchor="middle" x="136871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="136871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="136871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_7 -->
<g id="node500" class="node">
<title>k_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="136705,-857.45 136409,-857.45 136409,-813.45 136705,-813.45 136705,-857.45"/>
<text text-anchor="middle" x="136557" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L7</text>
<text text-anchor="middle" x="136557" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="136557" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="136557" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_7 -->
<g id="node501" class="node">
<title>v_proj_7</title>
<polygon fill="lightgreen" stroke="black" points="136391,-857.45 136095,-857.45 136095,-813.45 136391,-813.45 136391,-857.45"/>
<text text-anchor="middle" x="136243" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L7</text>
<text text-anchor="middle" x="136243" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="136243" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="136243" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_7 -->
<g id="node502" class="node">
<title>attn_scores_7</title>
<polygon fill="lightgreen" stroke="black" points="136076.5,-857.45 135743.5,-857.45 135743.5,-813.45 136076.5,-813.45 136076.5,-857.45"/>
<text text-anchor="middle" x="135910" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L7</text>
<text text-anchor="middle" x="135910" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="135910" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="135910" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_7 -->
<g id="node503" class="node">
<title>softmax_7</title>
<polygon fill="lightgreen" stroke="black" points="135725.5,-857.45 135392.5,-857.45 135392.5,-813.45 135725.5,-813.45 135725.5,-857.45"/>
<text text-anchor="middle" x="135559" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L7</text>
<text text-anchor="middle" x="135559" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="135559" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="135559" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_7 -->
<g id="node504" class="node">
<title>attn_out_7</title>
<polygon fill="lightgreen" stroke="black" points="135374,-857.45 135078,-857.45 135078,-813.45 135374,-813.45 135374,-857.45"/>
<text text-anchor="middle" x="135226" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L7</text>
<text text-anchor="middle" x="135226" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;223</text>
<text text-anchor="middle" x="135226" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="135226" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_7 -->
<g id="node505" class="node">
<title>gate_7</title>
<polygon fill="lightyellow" stroke="black" points="135059.74,-879.45 134582.92,-879.45 134460.26,-791.45 134937.08,-791.45 135059.74,-879.45"/>
<text text-anchor="middle" x="134760" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L7</text>
<text text-anchor="middle" x="134760" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192&#45;255</text>
<text text-anchor="middle" x="134760" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="134760" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_7_0 -->
<g id="node506" class="node">
<title>route_7_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="134242" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="134242" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="134242" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="134242" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="134242" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_0_0 -->
<g id="node507" class="node">
<title>expert_7_0_0</title>
<polygon fill="lightgreen" stroke="black" points="134023.5,-857.45 133746.5,-857.45 133746.5,-813.45 134023.5,-813.45 134023.5,-857.45"/>
<text text-anchor="middle" x="133885" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L7</text>
<text text-anchor="middle" x="133885" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="133885" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="133885" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_0_1 -->
<g id="node508" class="node">
<title>expert_7_0_1</title>
<polygon fill="lightgreen" stroke="black" points="133728.5,-857.45 133451.5,-857.45 133451.5,-813.45 133728.5,-813.45 133728.5,-857.45"/>
<text text-anchor="middle" x="133590" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L7</text>
<text text-anchor="middle" x="133590" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="133590" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="133590" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_0 -->
<g id="node509" class="node">
<title>tp_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="133318" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="133318" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L7</text>
<text text-anchor="middle" x="133318" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="133318" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="133318" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_1 -->
<g id="node510" class="node">
<title>route_7_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="132983" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="132983" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="132983" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="132983" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="132983" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_1_0 -->
<g id="node511" class="node">
<title>expert_7_1_0</title>
<polygon fill="lightgreen" stroke="black" points="132764.5,-857.45 132487.5,-857.45 132487.5,-813.45 132764.5,-813.45 132764.5,-857.45"/>
<text text-anchor="middle" x="132626" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L7</text>
<text text-anchor="middle" x="132626" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="132626" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="132626" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_1_1 -->
<g id="node512" class="node">
<title>expert_7_1_1</title>
<polygon fill="lightgreen" stroke="black" points="132469.5,-857.45 132192.5,-857.45 132192.5,-813.45 132469.5,-813.45 132469.5,-857.45"/>
<text text-anchor="middle" x="132331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L7</text>
<text text-anchor="middle" x="132331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="132331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="132331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_1 -->
<g id="node513" class="node">
<title>tp_7_1</title>
<ellipse fill="lightblue" stroke="black" cx="132059" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="132059" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L7</text>
<text text-anchor="middle" x="132059" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="132059" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="132059" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_2 -->
<g id="node514" class="node">
<title>route_7_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="131724" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="131724" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="131724" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="131724" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="131724" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_2_0 -->
<g id="node515" class="node">
<title>expert_7_2_0</title>
<polygon fill="lightgreen" stroke="black" points="131505.5,-857.45 131228.5,-857.45 131228.5,-813.45 131505.5,-813.45 131505.5,-857.45"/>
<text text-anchor="middle" x="131367" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L7</text>
<text text-anchor="middle" x="131367" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="131367" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="131367" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_2_1 -->
<g id="node516" class="node">
<title>expert_7_2_1</title>
<polygon fill="lightgreen" stroke="black" points="131210.5,-857.45 130933.5,-857.45 130933.5,-813.45 131210.5,-813.45 131210.5,-857.45"/>
<text text-anchor="middle" x="131072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L7</text>
<text text-anchor="middle" x="131072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="131072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="131072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_2 -->
<g id="node517" class="node">
<title>tp_7_2</title>
<ellipse fill="lightblue" stroke="black" cx="130800" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="130800" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L7</text>
<text text-anchor="middle" x="130800" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="130800" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="130800" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_3 -->
<g id="node518" class="node">
<title>route_7_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="130465" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="130465" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="130465" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="130465" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="130465" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_3_0 -->
<g id="node519" class="node">
<title>expert_7_3_0</title>
<polygon fill="lightgreen" stroke="black" points="130246.5,-857.45 129969.5,-857.45 129969.5,-813.45 130246.5,-813.45 130246.5,-857.45"/>
<text text-anchor="middle" x="130108" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L7</text>
<text text-anchor="middle" x="130108" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="130108" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="130108" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_3_1 -->
<g id="node520" class="node">
<title>expert_7_3_1</title>
<polygon fill="lightgreen" stroke="black" points="129951.5,-857.45 129674.5,-857.45 129674.5,-813.45 129951.5,-813.45 129951.5,-857.45"/>
<text text-anchor="middle" x="129813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L7</text>
<text text-anchor="middle" x="129813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="129813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="129813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_3 -->
<g id="node521" class="node">
<title>tp_7_3</title>
<ellipse fill="lightblue" stroke="black" cx="129541" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="129541" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L7</text>
<text text-anchor="middle" x="129541" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="129541" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="129541" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_4 -->
<g id="node522" class="node">
<title>route_7_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="129206" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="129206" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="129206" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="129206" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="129206" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_4_0 -->
<g id="node523" class="node">
<title>expert_7_4_0</title>
<polygon fill="lightgreen" stroke="black" points="128987.5,-857.45 128710.5,-857.45 128710.5,-813.45 128987.5,-813.45 128987.5,-857.45"/>
<text text-anchor="middle" x="128849" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L7</text>
<text text-anchor="middle" x="128849" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="128849" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="128849" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_4_1 -->
<g id="node524" class="node">
<title>expert_7_4_1</title>
<polygon fill="lightgreen" stroke="black" points="128692.5,-857.45 128415.5,-857.45 128415.5,-813.45 128692.5,-813.45 128692.5,-857.45"/>
<text text-anchor="middle" x="128554" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L7</text>
<text text-anchor="middle" x="128554" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="128554" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="128554" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_4 -->
<g id="node525" class="node">
<title>tp_7_4</title>
<ellipse fill="lightblue" stroke="black" cx="128282" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="128282" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L7</text>
<text text-anchor="middle" x="128282" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="128282" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="128282" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_5 -->
<g id="node526" class="node">
<title>route_7_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="127947" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="127947" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="127947" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="127947" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="127947" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_5_0 -->
<g id="node527" class="node">
<title>expert_7_5_0</title>
<polygon fill="lightgreen" stroke="black" points="127728.5,-857.45 127451.5,-857.45 127451.5,-813.45 127728.5,-813.45 127728.5,-857.45"/>
<text text-anchor="middle" x="127590" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L7</text>
<text text-anchor="middle" x="127590" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="127590" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="127590" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_5_1 -->
<g id="node528" class="node">
<title>expert_7_5_1</title>
<polygon fill="lightgreen" stroke="black" points="127433.5,-857.45 127156.5,-857.45 127156.5,-813.45 127433.5,-813.45 127433.5,-857.45"/>
<text text-anchor="middle" x="127295" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L7</text>
<text text-anchor="middle" x="127295" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="127295" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="127295" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_5 -->
<g id="node529" class="node">
<title>tp_7_5</title>
<ellipse fill="lightblue" stroke="black" cx="127023" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="127023" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L7</text>
<text text-anchor="middle" x="127023" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="127023" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="127023" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_6 -->
<g id="node530" class="node">
<title>route_7_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="126688" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="126688" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="126688" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="126688" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="126688" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_6_0 -->
<g id="node531" class="node">
<title>expert_7_6_0</title>
<polygon fill="lightgreen" stroke="black" points="126469.5,-857.45 126192.5,-857.45 126192.5,-813.45 126469.5,-813.45 126469.5,-857.45"/>
<text text-anchor="middle" x="126331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L7</text>
<text text-anchor="middle" x="126331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="126331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="126331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_6_1 -->
<g id="node532" class="node">
<title>expert_7_6_1</title>
<polygon fill="lightgreen" stroke="black" points="126174.5,-857.45 125897.5,-857.45 125897.5,-813.45 126174.5,-813.45 126174.5,-857.45"/>
<text text-anchor="middle" x="126036" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L7</text>
<text text-anchor="middle" x="126036" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="126036" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="126036" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_6 -->
<g id="node533" class="node">
<title>tp_7_6</title>
<ellipse fill="lightblue" stroke="black" cx="125764" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="125764" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L7</text>
<text text-anchor="middle" x="125764" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="125764" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="125764" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_7 -->
<g id="node534" class="node">
<title>route_7_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="125429" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="125429" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="125429" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="125429" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="125429" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_7_0 -->
<g id="node535" class="node">
<title>expert_7_7_0</title>
<polygon fill="lightgreen" stroke="black" points="125210.5,-857.45 124933.5,-857.45 124933.5,-813.45 125210.5,-813.45 125210.5,-857.45"/>
<text text-anchor="middle" x="125072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L7</text>
<text text-anchor="middle" x="125072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="125072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="125072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_7_1 -->
<g id="node536" class="node">
<title>expert_7_7_1</title>
<polygon fill="lightgreen" stroke="black" points="124915.5,-857.45 124638.5,-857.45 124638.5,-813.45 124915.5,-813.45 124915.5,-857.45"/>
<text text-anchor="middle" x="124777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L7</text>
<text text-anchor="middle" x="124777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="124777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="124777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_7 -->
<g id="node537" class="node">
<title>tp_7_7</title>
<ellipse fill="lightblue" stroke="black" cx="124505" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="124505" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L7</text>
<text text-anchor="middle" x="124505" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="124505" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="124505" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_8 -->
<g id="node538" class="node">
<title>route_7_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="124170" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="124170" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="124170" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="124170" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="124170" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_8_0 -->
<g id="node539" class="node">
<title>expert_7_8_0</title>
<polygon fill="lightgreen" stroke="black" points="123951.5,-857.45 123674.5,-857.45 123674.5,-813.45 123951.5,-813.45 123951.5,-857.45"/>
<text text-anchor="middle" x="123813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L7</text>
<text text-anchor="middle" x="123813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="123813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="123813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_8_1 -->
<g id="node540" class="node">
<title>expert_7_8_1</title>
<polygon fill="lightgreen" stroke="black" points="123656.5,-857.45 123379.5,-857.45 123379.5,-813.45 123656.5,-813.45 123656.5,-857.45"/>
<text text-anchor="middle" x="123518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L7</text>
<text text-anchor="middle" x="123518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="123518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="123518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_8 -->
<g id="node541" class="node">
<title>tp_7_8</title>
<ellipse fill="lightblue" stroke="black" cx="123246" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="123246" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L7</text>
<text text-anchor="middle" x="123246" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="123246" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="123246" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_9 -->
<g id="node542" class="node">
<title>route_7_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="122911" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="122911" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="122911" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="122911" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="122911" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_9_0 -->
<g id="node543" class="node">
<title>expert_7_9_0</title>
<polygon fill="lightgreen" stroke="black" points="122692.5,-857.45 122415.5,-857.45 122415.5,-813.45 122692.5,-813.45 122692.5,-857.45"/>
<text text-anchor="middle" x="122554" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L7</text>
<text text-anchor="middle" x="122554" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="122554" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="122554" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_9_1 -->
<g id="node544" class="node">
<title>expert_7_9_1</title>
<polygon fill="lightgreen" stroke="black" points="122397.5,-857.45 122120.5,-857.45 122120.5,-813.45 122397.5,-813.45 122397.5,-857.45"/>
<text text-anchor="middle" x="122259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L7</text>
<text text-anchor="middle" x="122259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="122259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="122259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_9 -->
<g id="node545" class="node">
<title>tp_7_9</title>
<ellipse fill="lightblue" stroke="black" cx="121987" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="121987" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L7</text>
<text text-anchor="middle" x="121987" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="121987" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="121987" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_10 -->
<g id="node546" class="node">
<title>route_7_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="121652" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="121652" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="121652" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="121652" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="121652" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_10_0 -->
<g id="node547" class="node">
<title>expert_7_10_0</title>
<polygon fill="lightgreen" stroke="black" points="121433.5,-857.45 121156.5,-857.45 121156.5,-813.45 121433.5,-813.45 121433.5,-857.45"/>
<text text-anchor="middle" x="121295" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L7</text>
<text text-anchor="middle" x="121295" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="121295" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="121295" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_10_1 -->
<g id="node548" class="node">
<title>expert_7_10_1</title>
<polygon fill="lightgreen" stroke="black" points="121138.5,-857.45 120861.5,-857.45 120861.5,-813.45 121138.5,-813.45 121138.5,-857.45"/>
<text text-anchor="middle" x="121000" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L7</text>
<text text-anchor="middle" x="121000" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="121000" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="121000" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_10 -->
<g id="node549" class="node">
<title>tp_7_10</title>
<ellipse fill="lightblue" stroke="black" cx="120728" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="120728" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L7</text>
<text text-anchor="middle" x="120728" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="120728" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="120728" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_11 -->
<g id="node550" class="node">
<title>route_7_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="120393" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="120393" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="120393" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="120393" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="120393" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_11_0 -->
<g id="node551" class="node">
<title>expert_7_11_0</title>
<polygon fill="lightgreen" stroke="black" points="120174.5,-857.45 119897.5,-857.45 119897.5,-813.45 120174.5,-813.45 120174.5,-857.45"/>
<text text-anchor="middle" x="120036" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L7</text>
<text text-anchor="middle" x="120036" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="120036" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="120036" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_11_1 -->
<g id="node552" class="node">
<title>expert_7_11_1</title>
<polygon fill="lightgreen" stroke="black" points="119879.5,-857.45 119602.5,-857.45 119602.5,-813.45 119879.5,-813.45 119879.5,-857.45"/>
<text text-anchor="middle" x="119741" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L7</text>
<text text-anchor="middle" x="119741" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="119741" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="119741" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_11 -->
<g id="node553" class="node">
<title>tp_7_11</title>
<ellipse fill="lightblue" stroke="black" cx="119469" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="119469" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L7</text>
<text text-anchor="middle" x="119469" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="119469" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="119469" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_12 -->
<g id="node554" class="node">
<title>route_7_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="119134" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="119134" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="119134" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="119134" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="119134" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_12_0 -->
<g id="node555" class="node">
<title>expert_7_12_0</title>
<polygon fill="lightgreen" stroke="black" points="118915.5,-857.45 118638.5,-857.45 118638.5,-813.45 118915.5,-813.45 118915.5,-857.45"/>
<text text-anchor="middle" x="118777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L7</text>
<text text-anchor="middle" x="118777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="118777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="118777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_12_1 -->
<g id="node556" class="node">
<title>expert_7_12_1</title>
<polygon fill="lightgreen" stroke="black" points="118620.5,-857.45 118343.5,-857.45 118343.5,-813.45 118620.5,-813.45 118620.5,-857.45"/>
<text text-anchor="middle" x="118482" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L7</text>
<text text-anchor="middle" x="118482" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="118482" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="118482" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_12 -->
<g id="node557" class="node">
<title>tp_7_12</title>
<ellipse fill="lightblue" stroke="black" cx="118210" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="118210" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L7</text>
<text text-anchor="middle" x="118210" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="118210" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="118210" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_13 -->
<g id="node558" class="node">
<title>route_7_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="117875" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="117875" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="117875" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="117875" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="117875" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_13_0 -->
<g id="node559" class="node">
<title>expert_7_13_0</title>
<polygon fill="lightgreen" stroke="black" points="117656.5,-857.45 117379.5,-857.45 117379.5,-813.45 117656.5,-813.45 117656.5,-857.45"/>
<text text-anchor="middle" x="117518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L7</text>
<text text-anchor="middle" x="117518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="117518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="117518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_13_1 -->
<g id="node560" class="node">
<title>expert_7_13_1</title>
<polygon fill="lightgreen" stroke="black" points="117361.5,-857.45 117084.5,-857.45 117084.5,-813.45 117361.5,-813.45 117361.5,-857.45"/>
<text text-anchor="middle" x="117223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L7</text>
<text text-anchor="middle" x="117223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="117223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="117223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_13 -->
<g id="node561" class="node">
<title>tp_7_13</title>
<ellipse fill="lightblue" stroke="black" cx="116951" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="116951" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L7</text>
<text text-anchor="middle" x="116951" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="116951" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="116951" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_14 -->
<g id="node562" class="node">
<title>route_7_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="116616" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="116616" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="116616" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="116616" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="116616" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_14_0 -->
<g id="node563" class="node">
<title>expert_7_14_0</title>
<polygon fill="lightgreen" stroke="black" points="116397.5,-857.45 116120.5,-857.45 116120.5,-813.45 116397.5,-813.45 116397.5,-857.45"/>
<text text-anchor="middle" x="116259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L7</text>
<text text-anchor="middle" x="116259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="116259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="116259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_14_1 -->
<g id="node564" class="node">
<title>expert_7_14_1</title>
<polygon fill="lightgreen" stroke="black" points="116102.5,-857.45 115825.5,-857.45 115825.5,-813.45 116102.5,-813.45 116102.5,-857.45"/>
<text text-anchor="middle" x="115964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L7</text>
<text text-anchor="middle" x="115964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="115964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="115964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_14 -->
<g id="node565" class="node">
<title>tp_7_14</title>
<ellipse fill="lightblue" stroke="black" cx="115692" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="115692" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L7</text>
<text text-anchor="middle" x="115692" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="115692" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="115692" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_7_15 -->
<g id="node566" class="node">
<title>route_7_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="115357" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="115357" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="115357" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="115357" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="115357" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_7_15_0 -->
<g id="node567" class="node">
<title>expert_7_15_0</title>
<polygon fill="lightgreen" stroke="black" points="115138.5,-857.45 114861.5,-857.45 114861.5,-813.45 115138.5,-813.45 115138.5,-857.45"/>
<text text-anchor="middle" x="115000" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L7</text>
<text text-anchor="middle" x="115000" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="115000" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="115000" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_7_15_1 -->
<g id="node568" class="node">
<title>expert_7_15_1</title>
<polygon fill="lightgreen" stroke="black" points="114843.5,-857.45 114566.5,-857.45 114566.5,-813.45 114843.5,-813.45 114843.5,-857.45"/>
<text text-anchor="middle" x="114705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L7</text>
<text text-anchor="middle" x="114705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="114705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="114705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_7_15 -->
<g id="node569" class="node">
<title>tp_7_15</title>
<ellipse fill="lightblue" stroke="black" cx="114433" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="114433" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L7</text>
<text text-anchor="middle" x="114433" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="114433" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="114433" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_8 -->
<g id="node570" class="node">
<title>q_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="205185,-857.45 204889,-857.45 204889,-813.45 205185,-813.45 205185,-857.45"/>
<text text-anchor="middle" x="205037" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L8</text>
<text text-anchor="middle" x="205037" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="205037" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="205037" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_8 -->
<g id="node571" class="node">
<title>k_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="204871,-857.45 204575,-857.45 204575,-813.45 204871,-813.45 204871,-857.45"/>
<text text-anchor="middle" x="204723" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L8</text>
<text text-anchor="middle" x="204723" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="204723" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="204723" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_8 -->
<g id="node572" class="node">
<title>v_proj_8</title>
<polygon fill="lightgreen" stroke="black" points="204557,-857.45 204261,-857.45 204261,-813.45 204557,-813.45 204557,-857.45"/>
<text text-anchor="middle" x="204409" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L8</text>
<text text-anchor="middle" x="204409" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="204409" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="204409" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_8 -->
<g id="node573" class="node">
<title>attn_scores_8</title>
<polygon fill="lightgreen" stroke="black" points="204242.5,-857.45 203909.5,-857.45 203909.5,-813.45 204242.5,-813.45 204242.5,-857.45"/>
<text text-anchor="middle" x="204076" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L8</text>
<text text-anchor="middle" x="204076" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="204076" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="204076" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_8 -->
<g id="node574" class="node">
<title>softmax_8</title>
<polygon fill="lightgreen" stroke="black" points="203891.5,-857.45 203558.5,-857.45 203558.5,-813.45 203891.5,-813.45 203891.5,-857.45"/>
<text text-anchor="middle" x="203725" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L8</text>
<text text-anchor="middle" x="203725" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="203725" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="203725" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_8 -->
<g id="node575" class="node">
<title>attn_out_8</title>
<polygon fill="lightgreen" stroke="black" points="203540,-857.45 203244,-857.45 203244,-813.45 203540,-813.45 203540,-857.45"/>
<text text-anchor="middle" x="203392" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L8</text>
<text text-anchor="middle" x="203392" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="203392" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="203392" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_8 -->
<g id="node576" class="node">
<title>gate_8</title>
<polygon fill="lightyellow" stroke="black" points="203225.74,-879.45 202748.92,-879.45 202626.26,-791.45 203103.08,-791.45 203225.74,-879.45"/>
<text text-anchor="middle" x="202926" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L8</text>
<text text-anchor="middle" x="202926" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;319</text>
<text text-anchor="middle" x="202926" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="202926" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_8_0 -->
<g id="node577" class="node">
<title>route_8_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="202408" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="202408" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="202408" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="202408" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="202408" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_0_0 -->
<g id="node578" class="node">
<title>expert_8_0_0</title>
<polygon fill="lightgreen" stroke="black" points="202189.5,-857.45 201912.5,-857.45 201912.5,-813.45 202189.5,-813.45 202189.5,-857.45"/>
<text text-anchor="middle" x="202051" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L8</text>
<text text-anchor="middle" x="202051" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="202051" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="202051" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_0_1 -->
<g id="node579" class="node">
<title>expert_8_0_1</title>
<polygon fill="lightgreen" stroke="black" points="201894.5,-857.45 201617.5,-857.45 201617.5,-813.45 201894.5,-813.45 201894.5,-857.45"/>
<text text-anchor="middle" x="201756" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L8</text>
<text text-anchor="middle" x="201756" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="201756" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="201756" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_0 -->
<g id="node580" class="node">
<title>tp_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="201484" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="201484" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L8</text>
<text text-anchor="middle" x="201484" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="201484" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="201484" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_1 -->
<g id="node581" class="node">
<title>route_8_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="201149" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="201149" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="201149" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="201149" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="201149" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_1_0 -->
<g id="node582" class="node">
<title>expert_8_1_0</title>
<polygon fill="lightgreen" stroke="black" points="200930.5,-857.45 200653.5,-857.45 200653.5,-813.45 200930.5,-813.45 200930.5,-857.45"/>
<text text-anchor="middle" x="200792" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L8</text>
<text text-anchor="middle" x="200792" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="200792" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="200792" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_1_1 -->
<g id="node583" class="node">
<title>expert_8_1_1</title>
<polygon fill="lightgreen" stroke="black" points="200635.5,-857.45 200358.5,-857.45 200358.5,-813.45 200635.5,-813.45 200635.5,-857.45"/>
<text text-anchor="middle" x="200497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L8</text>
<text text-anchor="middle" x="200497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="200497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="200497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_1 -->
<g id="node584" class="node">
<title>tp_8_1</title>
<ellipse fill="lightblue" stroke="black" cx="200225" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="200225" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L8</text>
<text text-anchor="middle" x="200225" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="200225" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="200225" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_2 -->
<g id="node585" class="node">
<title>route_8_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="199890" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="199890" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="199890" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="199890" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="199890" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_2_0 -->
<g id="node586" class="node">
<title>expert_8_2_0</title>
<polygon fill="lightgreen" stroke="black" points="199671.5,-857.45 199394.5,-857.45 199394.5,-813.45 199671.5,-813.45 199671.5,-857.45"/>
<text text-anchor="middle" x="199533" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L8</text>
<text text-anchor="middle" x="199533" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="199533" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="199533" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_2_1 -->
<g id="node587" class="node">
<title>expert_8_2_1</title>
<polygon fill="lightgreen" stroke="black" points="199376.5,-857.45 199099.5,-857.45 199099.5,-813.45 199376.5,-813.45 199376.5,-857.45"/>
<text text-anchor="middle" x="199238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L8</text>
<text text-anchor="middle" x="199238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="199238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="199238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_2 -->
<g id="node588" class="node">
<title>tp_8_2</title>
<ellipse fill="lightblue" stroke="black" cx="198966" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="198966" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L8</text>
<text text-anchor="middle" x="198966" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="198966" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="198966" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_3 -->
<g id="node589" class="node">
<title>route_8_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="198631" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="198631" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="198631" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="198631" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="198631" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_3_0 -->
<g id="node590" class="node">
<title>expert_8_3_0</title>
<polygon fill="lightgreen" stroke="black" points="198412.5,-857.45 198135.5,-857.45 198135.5,-813.45 198412.5,-813.45 198412.5,-857.45"/>
<text text-anchor="middle" x="198274" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L8</text>
<text text-anchor="middle" x="198274" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="198274" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="198274" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_3_1 -->
<g id="node591" class="node">
<title>expert_8_3_1</title>
<polygon fill="lightgreen" stroke="black" points="198117.5,-857.45 197840.5,-857.45 197840.5,-813.45 198117.5,-813.45 198117.5,-857.45"/>
<text text-anchor="middle" x="197979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L8</text>
<text text-anchor="middle" x="197979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="197979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="197979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_3 -->
<g id="node592" class="node">
<title>tp_8_3</title>
<ellipse fill="lightblue" stroke="black" cx="197707" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="197707" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L8</text>
<text text-anchor="middle" x="197707" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="197707" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="197707" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_4 -->
<g id="node593" class="node">
<title>route_8_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="197372" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="197372" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="197372" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="197372" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="197372" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_4_0 -->
<g id="node594" class="node">
<title>expert_8_4_0</title>
<polygon fill="lightgreen" stroke="black" points="197153.5,-857.45 196876.5,-857.45 196876.5,-813.45 197153.5,-813.45 197153.5,-857.45"/>
<text text-anchor="middle" x="197015" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L8</text>
<text text-anchor="middle" x="197015" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="197015" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="197015" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_4_1 -->
<g id="node595" class="node">
<title>expert_8_4_1</title>
<polygon fill="lightgreen" stroke="black" points="196858.5,-857.45 196581.5,-857.45 196581.5,-813.45 196858.5,-813.45 196858.5,-857.45"/>
<text text-anchor="middle" x="196720" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L8</text>
<text text-anchor="middle" x="196720" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="196720" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="196720" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_4 -->
<g id="node596" class="node">
<title>tp_8_4</title>
<ellipse fill="lightblue" stroke="black" cx="196448" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="196448" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L8</text>
<text text-anchor="middle" x="196448" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="196448" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="196448" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_5 -->
<g id="node597" class="node">
<title>route_8_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="196113" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="196113" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="196113" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="196113" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="196113" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_5_0 -->
<g id="node598" class="node">
<title>expert_8_5_0</title>
<polygon fill="lightgreen" stroke="black" points="195894.5,-857.45 195617.5,-857.45 195617.5,-813.45 195894.5,-813.45 195894.5,-857.45"/>
<text text-anchor="middle" x="195756" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L8</text>
<text text-anchor="middle" x="195756" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="195756" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="195756" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_5_1 -->
<g id="node599" class="node">
<title>expert_8_5_1</title>
<polygon fill="lightgreen" stroke="black" points="195599.5,-857.45 195322.5,-857.45 195322.5,-813.45 195599.5,-813.45 195599.5,-857.45"/>
<text text-anchor="middle" x="195461" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L8</text>
<text text-anchor="middle" x="195461" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="195461" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="195461" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_5 -->
<g id="node600" class="node">
<title>tp_8_5</title>
<ellipse fill="lightblue" stroke="black" cx="195189" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="195189" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L8</text>
<text text-anchor="middle" x="195189" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="195189" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="195189" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_6 -->
<g id="node601" class="node">
<title>route_8_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="194854" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="194854" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="194854" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="194854" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="194854" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_6_0 -->
<g id="node602" class="node">
<title>expert_8_6_0</title>
<polygon fill="lightgreen" stroke="black" points="194635.5,-857.45 194358.5,-857.45 194358.5,-813.45 194635.5,-813.45 194635.5,-857.45"/>
<text text-anchor="middle" x="194497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L8</text>
<text text-anchor="middle" x="194497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="194497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="194497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_6_1 -->
<g id="node603" class="node">
<title>expert_8_6_1</title>
<polygon fill="lightgreen" stroke="black" points="194340.5,-857.45 194063.5,-857.45 194063.5,-813.45 194340.5,-813.45 194340.5,-857.45"/>
<text text-anchor="middle" x="194202" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L8</text>
<text text-anchor="middle" x="194202" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="194202" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="194202" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_6 -->
<g id="node604" class="node">
<title>tp_8_6</title>
<ellipse fill="lightblue" stroke="black" cx="193930" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="193930" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L8</text>
<text text-anchor="middle" x="193930" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="193930" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="193930" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_7 -->
<g id="node605" class="node">
<title>route_8_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="193595" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="193595" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="193595" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="193595" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="193595" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_7_0 -->
<g id="node606" class="node">
<title>expert_8_7_0</title>
<polygon fill="lightgreen" stroke="black" points="193376.5,-857.45 193099.5,-857.45 193099.5,-813.45 193376.5,-813.45 193376.5,-857.45"/>
<text text-anchor="middle" x="193238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L8</text>
<text text-anchor="middle" x="193238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="193238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="193238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_7_1 -->
<g id="node607" class="node">
<title>expert_8_7_1</title>
<polygon fill="lightgreen" stroke="black" points="193081.5,-857.45 192804.5,-857.45 192804.5,-813.45 193081.5,-813.45 193081.5,-857.45"/>
<text text-anchor="middle" x="192943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L8</text>
<text text-anchor="middle" x="192943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="192943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="192943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_7 -->
<g id="node608" class="node">
<title>tp_8_7</title>
<ellipse fill="lightblue" stroke="black" cx="192671" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="192671" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L8</text>
<text text-anchor="middle" x="192671" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="192671" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="192671" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_8 -->
<g id="node609" class="node">
<title>route_8_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="192336" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="192336" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="192336" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="192336" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="192336" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_8_0 -->
<g id="node610" class="node">
<title>expert_8_8_0</title>
<polygon fill="lightgreen" stroke="black" points="192117.5,-857.45 191840.5,-857.45 191840.5,-813.45 192117.5,-813.45 192117.5,-857.45"/>
<text text-anchor="middle" x="191979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L8</text>
<text text-anchor="middle" x="191979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="191979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="191979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_8_1 -->
<g id="node611" class="node">
<title>expert_8_8_1</title>
<polygon fill="lightgreen" stroke="black" points="191822.5,-857.45 191545.5,-857.45 191545.5,-813.45 191822.5,-813.45 191822.5,-857.45"/>
<text text-anchor="middle" x="191684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L8</text>
<text text-anchor="middle" x="191684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="191684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="191684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_8 -->
<g id="node612" class="node">
<title>tp_8_8</title>
<ellipse fill="lightblue" stroke="black" cx="191412" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="191412" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L8</text>
<text text-anchor="middle" x="191412" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="191412" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="191412" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_9 -->
<g id="node613" class="node">
<title>route_8_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="191077" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="191077" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="191077" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="191077" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="191077" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_9_0 -->
<g id="node614" class="node">
<title>expert_8_9_0</title>
<polygon fill="lightgreen" stroke="black" points="190858.5,-857.45 190581.5,-857.45 190581.5,-813.45 190858.5,-813.45 190858.5,-857.45"/>
<text text-anchor="middle" x="190720" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L8</text>
<text text-anchor="middle" x="190720" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="190720" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="190720" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_9_1 -->
<g id="node615" class="node">
<title>expert_8_9_1</title>
<polygon fill="lightgreen" stroke="black" points="190563.5,-857.45 190286.5,-857.45 190286.5,-813.45 190563.5,-813.45 190563.5,-857.45"/>
<text text-anchor="middle" x="190425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L8</text>
<text text-anchor="middle" x="190425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="190425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="190425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_9 -->
<g id="node616" class="node">
<title>tp_8_9</title>
<ellipse fill="lightblue" stroke="black" cx="190153" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="190153" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L8</text>
<text text-anchor="middle" x="190153" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="190153" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="190153" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_10 -->
<g id="node617" class="node">
<title>route_8_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="189818" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="189818" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="189818" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="189818" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="189818" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_10_0 -->
<g id="node618" class="node">
<title>expert_8_10_0</title>
<polygon fill="lightgreen" stroke="black" points="189599.5,-857.45 189322.5,-857.45 189322.5,-813.45 189599.5,-813.45 189599.5,-857.45"/>
<text text-anchor="middle" x="189461" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L8</text>
<text text-anchor="middle" x="189461" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="189461" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="189461" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_10_1 -->
<g id="node619" class="node">
<title>expert_8_10_1</title>
<polygon fill="lightgreen" stroke="black" points="189304.5,-857.45 189027.5,-857.45 189027.5,-813.45 189304.5,-813.45 189304.5,-857.45"/>
<text text-anchor="middle" x="189166" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L8</text>
<text text-anchor="middle" x="189166" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="189166" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="189166" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_10 -->
<g id="node620" class="node">
<title>tp_8_10</title>
<ellipse fill="lightblue" stroke="black" cx="188894" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="188894" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L8</text>
<text text-anchor="middle" x="188894" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="188894" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="188894" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_11 -->
<g id="node621" class="node">
<title>route_8_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="188559" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="188559" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="188559" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="188559" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="188559" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_11_0 -->
<g id="node622" class="node">
<title>expert_8_11_0</title>
<polygon fill="lightgreen" stroke="black" points="188340.5,-857.45 188063.5,-857.45 188063.5,-813.45 188340.5,-813.45 188340.5,-857.45"/>
<text text-anchor="middle" x="188202" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L8</text>
<text text-anchor="middle" x="188202" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="188202" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="188202" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_11_1 -->
<g id="node623" class="node">
<title>expert_8_11_1</title>
<polygon fill="lightgreen" stroke="black" points="188045.5,-857.45 187768.5,-857.45 187768.5,-813.45 188045.5,-813.45 188045.5,-857.45"/>
<text text-anchor="middle" x="187907" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L8</text>
<text text-anchor="middle" x="187907" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="187907" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="187907" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_11 -->
<g id="node624" class="node">
<title>tp_8_11</title>
<ellipse fill="lightblue" stroke="black" cx="187635" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="187635" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L8</text>
<text text-anchor="middle" x="187635" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="187635" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="187635" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_12 -->
<g id="node625" class="node">
<title>route_8_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="187300" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="187300" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="187300" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="187300" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="187300" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_12_0 -->
<g id="node626" class="node">
<title>expert_8_12_0</title>
<polygon fill="lightgreen" stroke="black" points="187081.5,-857.45 186804.5,-857.45 186804.5,-813.45 187081.5,-813.45 187081.5,-857.45"/>
<text text-anchor="middle" x="186943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L8</text>
<text text-anchor="middle" x="186943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="186943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="186943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_12_1 -->
<g id="node627" class="node">
<title>expert_8_12_1</title>
<polygon fill="lightgreen" stroke="black" points="186786.5,-857.45 186509.5,-857.45 186509.5,-813.45 186786.5,-813.45 186786.5,-857.45"/>
<text text-anchor="middle" x="186648" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L8</text>
<text text-anchor="middle" x="186648" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="186648" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="186648" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_12 -->
<g id="node628" class="node">
<title>tp_8_12</title>
<ellipse fill="lightblue" stroke="black" cx="186376" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="186376" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L8</text>
<text text-anchor="middle" x="186376" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="186376" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="186376" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_13 -->
<g id="node629" class="node">
<title>route_8_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="186041" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="186041" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="186041" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="186041" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="186041" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_13_0 -->
<g id="node630" class="node">
<title>expert_8_13_0</title>
<polygon fill="lightgreen" stroke="black" points="185822.5,-857.45 185545.5,-857.45 185545.5,-813.45 185822.5,-813.45 185822.5,-857.45"/>
<text text-anchor="middle" x="185684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L8</text>
<text text-anchor="middle" x="185684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="185684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="185684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_13_1 -->
<g id="node631" class="node">
<title>expert_8_13_1</title>
<polygon fill="lightgreen" stroke="black" points="185527.5,-857.45 185250.5,-857.45 185250.5,-813.45 185527.5,-813.45 185527.5,-857.45"/>
<text text-anchor="middle" x="185389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L8</text>
<text text-anchor="middle" x="185389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="185389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="185389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_13 -->
<g id="node632" class="node">
<title>tp_8_13</title>
<ellipse fill="lightblue" stroke="black" cx="185117" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="185117" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L8</text>
<text text-anchor="middle" x="185117" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="185117" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="185117" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_14 -->
<g id="node633" class="node">
<title>route_8_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="184782" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="184782" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="184782" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="184782" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="184782" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_14_0 -->
<g id="node634" class="node">
<title>expert_8_14_0</title>
<polygon fill="lightgreen" stroke="black" points="184563.5,-857.45 184286.5,-857.45 184286.5,-813.45 184563.5,-813.45 184563.5,-857.45"/>
<text text-anchor="middle" x="184425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L8</text>
<text text-anchor="middle" x="184425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="184425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="184425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_14_1 -->
<g id="node635" class="node">
<title>expert_8_14_1</title>
<polygon fill="lightgreen" stroke="black" points="184268.5,-857.45 183991.5,-857.45 183991.5,-813.45 184268.5,-813.45 184268.5,-857.45"/>
<text text-anchor="middle" x="184130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L8</text>
<text text-anchor="middle" x="184130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="184130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="184130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_14 -->
<g id="node636" class="node">
<title>tp_8_14</title>
<ellipse fill="lightblue" stroke="black" cx="183858" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="183858" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L8</text>
<text text-anchor="middle" x="183858" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="183858" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="183858" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_8_15 -->
<g id="node637" class="node">
<title>route_8_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="183523" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="183523" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="183523" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="183523" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="183523" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_8_15_0 -->
<g id="node638" class="node">
<title>expert_8_15_0</title>
<polygon fill="lightgreen" stroke="black" points="183304.5,-857.45 183027.5,-857.45 183027.5,-813.45 183304.5,-813.45 183304.5,-857.45"/>
<text text-anchor="middle" x="183166" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L8</text>
<text text-anchor="middle" x="183166" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="183166" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="183166" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_8_15_1 -->
<g id="node639" class="node">
<title>expert_8_15_1</title>
<polygon fill="lightgreen" stroke="black" points="183009.5,-857.45 182732.5,-857.45 182732.5,-813.45 183009.5,-813.45 183009.5,-857.45"/>
<text text-anchor="middle" x="182871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L8</text>
<text text-anchor="middle" x="182871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="182871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="182871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_8_15 -->
<g id="node640" class="node">
<title>tp_8_15</title>
<ellipse fill="lightblue" stroke="black" cx="182599" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="182599" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L8</text>
<text text-anchor="middle" x="182599" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="182599" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="182599" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_9 -->
<g id="node641" class="node">
<title>q_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="182465,-857.45 182169,-857.45 182169,-813.45 182465,-813.45 182465,-857.45"/>
<text text-anchor="middle" x="182317" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L9</text>
<text text-anchor="middle" x="182317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="182317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="182317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_9 -->
<g id="node642" class="node">
<title>k_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="182151,-857.45 181855,-857.45 181855,-813.45 182151,-813.45 182151,-857.45"/>
<text text-anchor="middle" x="182003" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L9</text>
<text text-anchor="middle" x="182003" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="182003" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="182003" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_9 -->
<g id="node643" class="node">
<title>v_proj_9</title>
<polygon fill="lightgreen" stroke="black" points="181837,-857.45 181541,-857.45 181541,-813.45 181837,-813.45 181837,-857.45"/>
<text text-anchor="middle" x="181689" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L9</text>
<text text-anchor="middle" x="181689" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="181689" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="181689" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_9 -->
<g id="node644" class="node">
<title>attn_scores_9</title>
<polygon fill="lightgreen" stroke="black" points="181522.5,-857.45 181189.5,-857.45 181189.5,-813.45 181522.5,-813.45 181522.5,-857.45"/>
<text text-anchor="middle" x="181356" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L9</text>
<text text-anchor="middle" x="181356" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="181356" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="181356" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_9 -->
<g id="node645" class="node">
<title>softmax_9</title>
<polygon fill="lightgreen" stroke="black" points="181171.5,-857.45 180838.5,-857.45 180838.5,-813.45 181171.5,-813.45 181171.5,-857.45"/>
<text text-anchor="middle" x="181005" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L9</text>
<text text-anchor="middle" x="181005" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="181005" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="181005" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_9 -->
<g id="node646" class="node">
<title>attn_out_9</title>
<polygon fill="lightgreen" stroke="black" points="180820,-857.45 180524,-857.45 180524,-813.45 180820,-813.45 180820,-857.45"/>
<text text-anchor="middle" x="180672" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L9</text>
<text text-anchor="middle" x="180672" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;287</text>
<text text-anchor="middle" x="180672" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="180672" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_9 -->
<g id="node647" class="node">
<title>gate_9</title>
<polygon fill="lightyellow" stroke="black" points="180505.74,-879.45 180028.92,-879.45 179906.26,-791.45 180383.08,-791.45 180505.74,-879.45"/>
<text text-anchor="middle" x="180206" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L9</text>
<text text-anchor="middle" x="180206" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256&#45;319</text>
<text text-anchor="middle" x="180206" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="180206" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_9_0 -->
<g id="node648" class="node">
<title>route_9_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="179688" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="179688" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="179688" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="179688" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="179688" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_0_0 -->
<g id="node649" class="node">
<title>expert_9_0_0</title>
<polygon fill="lightgreen" stroke="black" points="179469.5,-857.45 179192.5,-857.45 179192.5,-813.45 179469.5,-813.45 179469.5,-857.45"/>
<text text-anchor="middle" x="179331" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L9</text>
<text text-anchor="middle" x="179331" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="179331" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="179331" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_0_1 -->
<g id="node650" class="node">
<title>expert_9_0_1</title>
<polygon fill="lightgreen" stroke="black" points="179174.5,-857.45 178897.5,-857.45 178897.5,-813.45 179174.5,-813.45 179174.5,-857.45"/>
<text text-anchor="middle" x="179036" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L9</text>
<text text-anchor="middle" x="179036" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="179036" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="179036" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_0 -->
<g id="node651" class="node">
<title>tp_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="178764" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="178764" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L9</text>
<text text-anchor="middle" x="178764" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="178764" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="178764" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_1 -->
<g id="node652" class="node">
<title>route_9_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="178429" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="178429" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="178429" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="178429" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="178429" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_1_0 -->
<g id="node653" class="node">
<title>expert_9_1_0</title>
<polygon fill="lightgreen" stroke="black" points="178210.5,-857.45 177933.5,-857.45 177933.5,-813.45 178210.5,-813.45 178210.5,-857.45"/>
<text text-anchor="middle" x="178072" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L9</text>
<text text-anchor="middle" x="178072" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="178072" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="178072" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_1_1 -->
<g id="node654" class="node">
<title>expert_9_1_1</title>
<polygon fill="lightgreen" stroke="black" points="177915.5,-857.45 177638.5,-857.45 177638.5,-813.45 177915.5,-813.45 177915.5,-857.45"/>
<text text-anchor="middle" x="177777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L9</text>
<text text-anchor="middle" x="177777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="177777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="177777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_1 -->
<g id="node655" class="node">
<title>tp_9_1</title>
<ellipse fill="lightblue" stroke="black" cx="177505" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="177505" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L9</text>
<text text-anchor="middle" x="177505" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="177505" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="177505" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_2 -->
<g id="node656" class="node">
<title>route_9_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="177170" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="177170" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="177170" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="177170" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="177170" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_2_0 -->
<g id="node657" class="node">
<title>expert_9_2_0</title>
<polygon fill="lightgreen" stroke="black" points="176951.5,-857.45 176674.5,-857.45 176674.5,-813.45 176951.5,-813.45 176951.5,-857.45"/>
<text text-anchor="middle" x="176813" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L9</text>
<text text-anchor="middle" x="176813" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="176813" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="176813" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_2_1 -->
<g id="node658" class="node">
<title>expert_9_2_1</title>
<polygon fill="lightgreen" stroke="black" points="176656.5,-857.45 176379.5,-857.45 176379.5,-813.45 176656.5,-813.45 176656.5,-857.45"/>
<text text-anchor="middle" x="176518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L9</text>
<text text-anchor="middle" x="176518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="176518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="176518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_2 -->
<g id="node659" class="node">
<title>tp_9_2</title>
<ellipse fill="lightblue" stroke="black" cx="176246" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="176246" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L9</text>
<text text-anchor="middle" x="176246" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="176246" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="176246" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_3 -->
<g id="node660" class="node">
<title>route_9_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="175911" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="175911" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="175911" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="175911" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="175911" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_3_0 -->
<g id="node661" class="node">
<title>expert_9_3_0</title>
<polygon fill="lightgreen" stroke="black" points="175692.5,-857.45 175415.5,-857.45 175415.5,-813.45 175692.5,-813.45 175692.5,-857.45"/>
<text text-anchor="middle" x="175554" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L9</text>
<text text-anchor="middle" x="175554" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="175554" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="175554" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_3_1 -->
<g id="node662" class="node">
<title>expert_9_3_1</title>
<polygon fill="lightgreen" stroke="black" points="175397.5,-857.45 175120.5,-857.45 175120.5,-813.45 175397.5,-813.45 175397.5,-857.45"/>
<text text-anchor="middle" x="175259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L9</text>
<text text-anchor="middle" x="175259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="175259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="175259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_3 -->
<g id="node663" class="node">
<title>tp_9_3</title>
<ellipse fill="lightblue" stroke="black" cx="174987" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="174987" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L9</text>
<text text-anchor="middle" x="174987" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="174987" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="174987" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_4 -->
<g id="node664" class="node">
<title>route_9_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="174652" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="174652" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="174652" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="174652" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="174652" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_4_0 -->
<g id="node665" class="node">
<title>expert_9_4_0</title>
<polygon fill="lightgreen" stroke="black" points="174433.5,-857.45 174156.5,-857.45 174156.5,-813.45 174433.5,-813.45 174433.5,-857.45"/>
<text text-anchor="middle" x="174295" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L9</text>
<text text-anchor="middle" x="174295" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="174295" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="174295" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_4_1 -->
<g id="node666" class="node">
<title>expert_9_4_1</title>
<polygon fill="lightgreen" stroke="black" points="174138.5,-857.45 173861.5,-857.45 173861.5,-813.45 174138.5,-813.45 174138.5,-857.45"/>
<text text-anchor="middle" x="174000" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L9</text>
<text text-anchor="middle" x="174000" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="174000" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="174000" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_4 -->
<g id="node667" class="node">
<title>tp_9_4</title>
<ellipse fill="lightblue" stroke="black" cx="173728" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="173728" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L9</text>
<text text-anchor="middle" x="173728" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="173728" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="173728" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_5 -->
<g id="node668" class="node">
<title>route_9_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="173393" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="173393" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="173393" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="173393" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="173393" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_5_0 -->
<g id="node669" class="node">
<title>expert_9_5_0</title>
<polygon fill="lightgreen" stroke="black" points="173174.5,-857.45 172897.5,-857.45 172897.5,-813.45 173174.5,-813.45 173174.5,-857.45"/>
<text text-anchor="middle" x="173036" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L9</text>
<text text-anchor="middle" x="173036" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="173036" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="173036" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_5_1 -->
<g id="node670" class="node">
<title>expert_9_5_1</title>
<polygon fill="lightgreen" stroke="black" points="172879.5,-857.45 172602.5,-857.45 172602.5,-813.45 172879.5,-813.45 172879.5,-857.45"/>
<text text-anchor="middle" x="172741" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L9</text>
<text text-anchor="middle" x="172741" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="172741" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="172741" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_5 -->
<g id="node671" class="node">
<title>tp_9_5</title>
<ellipse fill="lightblue" stroke="black" cx="172469" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="172469" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L9</text>
<text text-anchor="middle" x="172469" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="172469" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="172469" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_6 -->
<g id="node672" class="node">
<title>route_9_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="172134" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="172134" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="172134" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="172134" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="172134" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_6_0 -->
<g id="node673" class="node">
<title>expert_9_6_0</title>
<polygon fill="lightgreen" stroke="black" points="171915.5,-857.45 171638.5,-857.45 171638.5,-813.45 171915.5,-813.45 171915.5,-857.45"/>
<text text-anchor="middle" x="171777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L9</text>
<text text-anchor="middle" x="171777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="171777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="171777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_6_1 -->
<g id="node674" class="node">
<title>expert_9_6_1</title>
<polygon fill="lightgreen" stroke="black" points="171620.5,-857.45 171343.5,-857.45 171343.5,-813.45 171620.5,-813.45 171620.5,-857.45"/>
<text text-anchor="middle" x="171482" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L9</text>
<text text-anchor="middle" x="171482" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="171482" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="171482" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_6 -->
<g id="node675" class="node">
<title>tp_9_6</title>
<ellipse fill="lightblue" stroke="black" cx="171210" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="171210" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L9</text>
<text text-anchor="middle" x="171210" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="171210" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="171210" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_7 -->
<g id="node676" class="node">
<title>route_9_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="170875" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="170875" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="170875" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="170875" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="170875" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_7_0 -->
<g id="node677" class="node">
<title>expert_9_7_0</title>
<polygon fill="lightgreen" stroke="black" points="170656.5,-857.45 170379.5,-857.45 170379.5,-813.45 170656.5,-813.45 170656.5,-857.45"/>
<text text-anchor="middle" x="170518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L9</text>
<text text-anchor="middle" x="170518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="170518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="170518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_7_1 -->
<g id="node678" class="node">
<title>expert_9_7_1</title>
<polygon fill="lightgreen" stroke="black" points="170361.5,-857.45 170084.5,-857.45 170084.5,-813.45 170361.5,-813.45 170361.5,-857.45"/>
<text text-anchor="middle" x="170223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L9</text>
<text text-anchor="middle" x="170223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="170223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="170223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_7 -->
<g id="node679" class="node">
<title>tp_9_7</title>
<ellipse fill="lightblue" stroke="black" cx="169951" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="169951" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L9</text>
<text text-anchor="middle" x="169951" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="169951" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="169951" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_8 -->
<g id="node680" class="node">
<title>route_9_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="169616" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="169616" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="169616" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="169616" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="169616" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_8_0 -->
<g id="node681" class="node">
<title>expert_9_8_0</title>
<polygon fill="lightgreen" stroke="black" points="169397.5,-857.45 169120.5,-857.45 169120.5,-813.45 169397.5,-813.45 169397.5,-857.45"/>
<text text-anchor="middle" x="169259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L9</text>
<text text-anchor="middle" x="169259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="169259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="169259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_8_1 -->
<g id="node682" class="node">
<title>expert_9_8_1</title>
<polygon fill="lightgreen" stroke="black" points="169102.5,-857.45 168825.5,-857.45 168825.5,-813.45 169102.5,-813.45 169102.5,-857.45"/>
<text text-anchor="middle" x="168964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L9</text>
<text text-anchor="middle" x="168964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="168964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="168964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_8 -->
<g id="node683" class="node">
<title>tp_9_8</title>
<ellipse fill="lightblue" stroke="black" cx="168692" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="168692" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L9</text>
<text text-anchor="middle" x="168692" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="168692" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="168692" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_9 -->
<g id="node684" class="node">
<title>route_9_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="168357" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="168357" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="168357" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="168357" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="168357" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_9_0 -->
<g id="node685" class="node">
<title>expert_9_9_0</title>
<polygon fill="lightgreen" stroke="black" points="168138.5,-857.45 167861.5,-857.45 167861.5,-813.45 168138.5,-813.45 168138.5,-857.45"/>
<text text-anchor="middle" x="168000" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L9</text>
<text text-anchor="middle" x="168000" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="168000" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="168000" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_9_1 -->
<g id="node686" class="node">
<title>expert_9_9_1</title>
<polygon fill="lightgreen" stroke="black" points="167843.5,-857.45 167566.5,-857.45 167566.5,-813.45 167843.5,-813.45 167843.5,-857.45"/>
<text text-anchor="middle" x="167705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L9</text>
<text text-anchor="middle" x="167705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="167705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="167705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_9 -->
<g id="node687" class="node">
<title>tp_9_9</title>
<ellipse fill="lightblue" stroke="black" cx="167433" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="167433" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L9</text>
<text text-anchor="middle" x="167433" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="167433" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="167433" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_10 -->
<g id="node688" class="node">
<title>route_9_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="167098" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="167098" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="167098" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="167098" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="167098" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_10_0 -->
<g id="node689" class="node">
<title>expert_9_10_0</title>
<polygon fill="lightgreen" stroke="black" points="166879.5,-857.45 166602.5,-857.45 166602.5,-813.45 166879.5,-813.45 166879.5,-857.45"/>
<text text-anchor="middle" x="166741" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L9</text>
<text text-anchor="middle" x="166741" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="166741" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="166741" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_10_1 -->
<g id="node690" class="node">
<title>expert_9_10_1</title>
<polygon fill="lightgreen" stroke="black" points="166584.5,-857.45 166307.5,-857.45 166307.5,-813.45 166584.5,-813.45 166584.5,-857.45"/>
<text text-anchor="middle" x="166446" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L9</text>
<text text-anchor="middle" x="166446" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="166446" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="166446" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_10 -->
<g id="node691" class="node">
<title>tp_9_10</title>
<ellipse fill="lightblue" stroke="black" cx="166174" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="166174" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L9</text>
<text text-anchor="middle" x="166174" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="166174" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="166174" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_11 -->
<g id="node692" class="node">
<title>route_9_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="165839" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="165839" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="165839" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="165839" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="165839" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_11_0 -->
<g id="node693" class="node">
<title>expert_9_11_0</title>
<polygon fill="lightgreen" stroke="black" points="165620.5,-857.45 165343.5,-857.45 165343.5,-813.45 165620.5,-813.45 165620.5,-857.45"/>
<text text-anchor="middle" x="165482" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L9</text>
<text text-anchor="middle" x="165482" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="165482" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="165482" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_11_1 -->
<g id="node694" class="node">
<title>expert_9_11_1</title>
<polygon fill="lightgreen" stroke="black" points="165325.5,-857.45 165048.5,-857.45 165048.5,-813.45 165325.5,-813.45 165325.5,-857.45"/>
<text text-anchor="middle" x="165187" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L9</text>
<text text-anchor="middle" x="165187" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="165187" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="165187" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_11 -->
<g id="node695" class="node">
<title>tp_9_11</title>
<ellipse fill="lightblue" stroke="black" cx="164915" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="164915" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L9</text>
<text text-anchor="middle" x="164915" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="164915" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="164915" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_12 -->
<g id="node696" class="node">
<title>route_9_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="164580" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="164580" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="164580" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="164580" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="164580" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_12_0 -->
<g id="node697" class="node">
<title>expert_9_12_0</title>
<polygon fill="lightgreen" stroke="black" points="164361.5,-857.45 164084.5,-857.45 164084.5,-813.45 164361.5,-813.45 164361.5,-857.45"/>
<text text-anchor="middle" x="164223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L9</text>
<text text-anchor="middle" x="164223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="164223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="164223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_12_1 -->
<g id="node698" class="node">
<title>expert_9_12_1</title>
<polygon fill="lightgreen" stroke="black" points="164066.5,-857.45 163789.5,-857.45 163789.5,-813.45 164066.5,-813.45 164066.5,-857.45"/>
<text text-anchor="middle" x="163928" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L9</text>
<text text-anchor="middle" x="163928" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="163928" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="163928" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_12 -->
<g id="node699" class="node">
<title>tp_9_12</title>
<ellipse fill="lightblue" stroke="black" cx="163656" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="163656" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L9</text>
<text text-anchor="middle" x="163656" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="163656" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="163656" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_13 -->
<g id="node700" class="node">
<title>route_9_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="163321" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="163321" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="163321" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="163321" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="163321" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_13_0 -->
<g id="node701" class="node">
<title>expert_9_13_0</title>
<polygon fill="lightgreen" stroke="black" points="163102.5,-857.45 162825.5,-857.45 162825.5,-813.45 163102.5,-813.45 163102.5,-857.45"/>
<text text-anchor="middle" x="162964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L9</text>
<text text-anchor="middle" x="162964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="162964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="162964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_13_1 -->
<g id="node702" class="node">
<title>expert_9_13_1</title>
<polygon fill="lightgreen" stroke="black" points="162807.5,-857.45 162530.5,-857.45 162530.5,-813.45 162807.5,-813.45 162807.5,-857.45"/>
<text text-anchor="middle" x="162669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L9</text>
<text text-anchor="middle" x="162669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="162669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="162669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_13 -->
<g id="node703" class="node">
<title>tp_9_13</title>
<ellipse fill="lightblue" stroke="black" cx="162397" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="162397" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L9</text>
<text text-anchor="middle" x="162397" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="162397" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="162397" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_14 -->
<g id="node704" class="node">
<title>route_9_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="162062" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="162062" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="162062" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="162062" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="162062" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_14_0 -->
<g id="node705" class="node">
<title>expert_9_14_0</title>
<polygon fill="lightgreen" stroke="black" points="161843.5,-857.45 161566.5,-857.45 161566.5,-813.45 161843.5,-813.45 161843.5,-857.45"/>
<text text-anchor="middle" x="161705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L9</text>
<text text-anchor="middle" x="161705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="161705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="161705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_14_1 -->
<g id="node706" class="node">
<title>expert_9_14_1</title>
<polygon fill="lightgreen" stroke="black" points="161548.5,-857.45 161271.5,-857.45 161271.5,-813.45 161548.5,-813.45 161548.5,-857.45"/>
<text text-anchor="middle" x="161410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L9</text>
<text text-anchor="middle" x="161410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="161410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="161410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_14 -->
<g id="node707" class="node">
<title>tp_9_14</title>
<ellipse fill="lightblue" stroke="black" cx="161138" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="161138" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L9</text>
<text text-anchor="middle" x="161138" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="161138" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="161138" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_9_15 -->
<g id="node708" class="node">
<title>route_9_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="160803" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="160803" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="160803" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="160803" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="160803" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_9_15_0 -->
<g id="node709" class="node">
<title>expert_9_15_0</title>
<polygon fill="lightgreen" stroke="black" points="160584.5,-857.45 160307.5,-857.45 160307.5,-813.45 160584.5,-813.45 160584.5,-857.45"/>
<text text-anchor="middle" x="160446" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L9</text>
<text text-anchor="middle" x="160446" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="160446" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="160446" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_9_15_1 -->
<g id="node710" class="node">
<title>expert_9_15_1</title>
<polygon fill="lightgreen" stroke="black" points="160289.5,-857.45 160012.5,-857.45 160012.5,-813.45 160289.5,-813.45 160289.5,-857.45"/>
<text text-anchor="middle" x="160151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L9</text>
<text text-anchor="middle" x="160151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="160151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="160151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_9_15 -->
<g id="node711" class="node">
<title>tp_9_15</title>
<ellipse fill="lightblue" stroke="black" cx="159879" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="159879" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L9</text>
<text text-anchor="middle" x="159879" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="159879" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="159879" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_10 -->
<g id="node712" class="node">
<title>q_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="250631,-857.45 250335,-857.45 250335,-813.45 250631,-813.45 250631,-857.45"/>
<text text-anchor="middle" x="250483" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L10</text>
<text text-anchor="middle" x="250483" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="250483" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="250483" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_10 -->
<g id="node713" class="node">
<title>k_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="250317,-857.45 250021,-857.45 250021,-813.45 250317,-813.45 250317,-857.45"/>
<text text-anchor="middle" x="250169" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L10</text>
<text text-anchor="middle" x="250169" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="250169" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="250169" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_10 -->
<g id="node714" class="node">
<title>v_proj_10</title>
<polygon fill="lightgreen" stroke="black" points="250003,-857.45 249707,-857.45 249707,-813.45 250003,-813.45 250003,-857.45"/>
<text text-anchor="middle" x="249855" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L10</text>
<text text-anchor="middle" x="249855" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="249855" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="249855" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_10 -->
<g id="node715" class="node">
<title>attn_scores_10</title>
<polygon fill="lightgreen" stroke="black" points="249688.5,-857.45 249355.5,-857.45 249355.5,-813.45 249688.5,-813.45 249688.5,-857.45"/>
<text text-anchor="middle" x="249522" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L10</text>
<text text-anchor="middle" x="249522" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="249522" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="249522" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_10 -->
<g id="node716" class="node">
<title>softmax_10</title>
<polygon fill="lightgreen" stroke="black" points="249337.5,-857.45 249004.5,-857.45 249004.5,-813.45 249337.5,-813.45 249337.5,-857.45"/>
<text text-anchor="middle" x="249171" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L10</text>
<text text-anchor="middle" x="249171" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="249171" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="249171" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_10 -->
<g id="node717" class="node">
<title>attn_out_10</title>
<polygon fill="lightgreen" stroke="black" points="248986,-857.45 248690,-857.45 248690,-813.45 248986,-813.45 248986,-857.45"/>
<text text-anchor="middle" x="248838" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L10</text>
<text text-anchor="middle" x="248838" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="248838" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="248838" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_10 -->
<g id="node718" class="node">
<title>gate_10</title>
<polygon fill="lightyellow" stroke="black" points="248671.74,-879.45 248194.92,-879.45 248072.26,-791.45 248549.08,-791.45 248671.74,-879.45"/>
<text text-anchor="middle" x="248372" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L10</text>
<text text-anchor="middle" x="248372" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;383</text>
<text text-anchor="middle" x="248372" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="248372" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_10_0 -->
<g id="node719" class="node">
<title>route_10_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="247854" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="247854" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="247854" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="247854" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="247854" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_0_0 -->
<g id="node720" class="node">
<title>expert_10_0_0</title>
<polygon fill="lightgreen" stroke="black" points="247635.5,-857.45 247358.5,-857.45 247358.5,-813.45 247635.5,-813.45 247635.5,-857.45"/>
<text text-anchor="middle" x="247497" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L10</text>
<text text-anchor="middle" x="247497" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="247497" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="247497" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_0_1 -->
<g id="node721" class="node">
<title>expert_10_0_1</title>
<polygon fill="lightgreen" stroke="black" points="247340.5,-857.45 247063.5,-857.45 247063.5,-813.45 247340.5,-813.45 247340.5,-857.45"/>
<text text-anchor="middle" x="247202" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L10</text>
<text text-anchor="middle" x="247202" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="247202" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="247202" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_0 -->
<g id="node722" class="node">
<title>tp_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="246930" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="246930" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L10</text>
<text text-anchor="middle" x="246930" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="246930" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="246930" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_1 -->
<g id="node723" class="node">
<title>route_10_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="246595" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="246595" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="246595" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="246595" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="246595" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_1_0 -->
<g id="node724" class="node">
<title>expert_10_1_0</title>
<polygon fill="lightgreen" stroke="black" points="246376.5,-857.45 246099.5,-857.45 246099.5,-813.45 246376.5,-813.45 246376.5,-857.45"/>
<text text-anchor="middle" x="246238" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L10</text>
<text text-anchor="middle" x="246238" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="246238" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="246238" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_1_1 -->
<g id="node725" class="node">
<title>expert_10_1_1</title>
<polygon fill="lightgreen" stroke="black" points="246081.5,-857.45 245804.5,-857.45 245804.5,-813.45 246081.5,-813.45 246081.5,-857.45"/>
<text text-anchor="middle" x="245943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L10</text>
<text text-anchor="middle" x="245943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="245943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="245943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_1 -->
<g id="node726" class="node">
<title>tp_10_1</title>
<ellipse fill="lightblue" stroke="black" cx="245671" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="245671" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L10</text>
<text text-anchor="middle" x="245671" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="245671" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="245671" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_2 -->
<g id="node727" class="node">
<title>route_10_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="245336" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="245336" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="245336" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="245336" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="245336" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_2_0 -->
<g id="node728" class="node">
<title>expert_10_2_0</title>
<polygon fill="lightgreen" stroke="black" points="245117.5,-857.45 244840.5,-857.45 244840.5,-813.45 245117.5,-813.45 245117.5,-857.45"/>
<text text-anchor="middle" x="244979" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L10</text>
<text text-anchor="middle" x="244979" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="244979" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="244979" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_2_1 -->
<g id="node729" class="node">
<title>expert_10_2_1</title>
<polygon fill="lightgreen" stroke="black" points="244822.5,-857.45 244545.5,-857.45 244545.5,-813.45 244822.5,-813.45 244822.5,-857.45"/>
<text text-anchor="middle" x="244684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L10</text>
<text text-anchor="middle" x="244684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="244684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="244684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_2 -->
<g id="node730" class="node">
<title>tp_10_2</title>
<ellipse fill="lightblue" stroke="black" cx="244412" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="244412" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L10</text>
<text text-anchor="middle" x="244412" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="244412" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="244412" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_3 -->
<g id="node731" class="node">
<title>route_10_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="244077" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="244077" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="244077" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="244077" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="244077" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_3_0 -->
<g id="node732" class="node">
<title>expert_10_3_0</title>
<polygon fill="lightgreen" stroke="black" points="243858.5,-857.45 243581.5,-857.45 243581.5,-813.45 243858.5,-813.45 243858.5,-857.45"/>
<text text-anchor="middle" x="243720" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L10</text>
<text text-anchor="middle" x="243720" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="243720" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="243720" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_3_1 -->
<g id="node733" class="node">
<title>expert_10_3_1</title>
<polygon fill="lightgreen" stroke="black" points="243563.5,-857.45 243286.5,-857.45 243286.5,-813.45 243563.5,-813.45 243563.5,-857.45"/>
<text text-anchor="middle" x="243425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L10</text>
<text text-anchor="middle" x="243425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="243425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="243425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_3 -->
<g id="node734" class="node">
<title>tp_10_3</title>
<ellipse fill="lightblue" stroke="black" cx="243153" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="243153" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L10</text>
<text text-anchor="middle" x="243153" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="243153" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="243153" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_4 -->
<g id="node735" class="node">
<title>route_10_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="242818" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="242818" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="242818" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="242818" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="242818" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_4_0 -->
<g id="node736" class="node">
<title>expert_10_4_0</title>
<polygon fill="lightgreen" stroke="black" points="242599.5,-857.45 242322.5,-857.45 242322.5,-813.45 242599.5,-813.45 242599.5,-857.45"/>
<text text-anchor="middle" x="242461" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L10</text>
<text text-anchor="middle" x="242461" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="242461" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="242461" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_4_1 -->
<g id="node737" class="node">
<title>expert_10_4_1</title>
<polygon fill="lightgreen" stroke="black" points="242304.5,-857.45 242027.5,-857.45 242027.5,-813.45 242304.5,-813.45 242304.5,-857.45"/>
<text text-anchor="middle" x="242166" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L10</text>
<text text-anchor="middle" x="242166" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="242166" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="242166" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_4 -->
<g id="node738" class="node">
<title>tp_10_4</title>
<ellipse fill="lightblue" stroke="black" cx="241894" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="241894" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L10</text>
<text text-anchor="middle" x="241894" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="241894" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="241894" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_5 -->
<g id="node739" class="node">
<title>route_10_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="241559" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="241559" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="241559" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="241559" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="241559" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_5_0 -->
<g id="node740" class="node">
<title>expert_10_5_0</title>
<polygon fill="lightgreen" stroke="black" points="241340.5,-857.45 241063.5,-857.45 241063.5,-813.45 241340.5,-813.45 241340.5,-857.45"/>
<text text-anchor="middle" x="241202" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L10</text>
<text text-anchor="middle" x="241202" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="241202" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="241202" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_5_1 -->
<g id="node741" class="node">
<title>expert_10_5_1</title>
<polygon fill="lightgreen" stroke="black" points="241045.5,-857.45 240768.5,-857.45 240768.5,-813.45 241045.5,-813.45 241045.5,-857.45"/>
<text text-anchor="middle" x="240907" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L10</text>
<text text-anchor="middle" x="240907" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="240907" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="240907" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_5 -->
<g id="node742" class="node">
<title>tp_10_5</title>
<ellipse fill="lightblue" stroke="black" cx="240635" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="240635" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L10</text>
<text text-anchor="middle" x="240635" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="240635" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="240635" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_6 -->
<g id="node743" class="node">
<title>route_10_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="240300" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="240300" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="240300" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="240300" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="240300" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_6_0 -->
<g id="node744" class="node">
<title>expert_10_6_0</title>
<polygon fill="lightgreen" stroke="black" points="240081.5,-857.45 239804.5,-857.45 239804.5,-813.45 240081.5,-813.45 240081.5,-857.45"/>
<text text-anchor="middle" x="239943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L10</text>
<text text-anchor="middle" x="239943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="239943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="239943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_6_1 -->
<g id="node745" class="node">
<title>expert_10_6_1</title>
<polygon fill="lightgreen" stroke="black" points="239786.5,-857.45 239509.5,-857.45 239509.5,-813.45 239786.5,-813.45 239786.5,-857.45"/>
<text text-anchor="middle" x="239648" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L10</text>
<text text-anchor="middle" x="239648" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="239648" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="239648" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_6 -->
<g id="node746" class="node">
<title>tp_10_6</title>
<ellipse fill="lightblue" stroke="black" cx="239376" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="239376" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L10</text>
<text text-anchor="middle" x="239376" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="239376" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="239376" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_7 -->
<g id="node747" class="node">
<title>route_10_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="239041" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="239041" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="239041" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="239041" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="239041" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_7_0 -->
<g id="node748" class="node">
<title>expert_10_7_0</title>
<polygon fill="lightgreen" stroke="black" points="238822.5,-857.45 238545.5,-857.45 238545.5,-813.45 238822.5,-813.45 238822.5,-857.45"/>
<text text-anchor="middle" x="238684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L10</text>
<text text-anchor="middle" x="238684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="238684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="238684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_7_1 -->
<g id="node749" class="node">
<title>expert_10_7_1</title>
<polygon fill="lightgreen" stroke="black" points="238527.5,-857.45 238250.5,-857.45 238250.5,-813.45 238527.5,-813.45 238527.5,-857.45"/>
<text text-anchor="middle" x="238389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L10</text>
<text text-anchor="middle" x="238389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="238389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="238389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_7 -->
<g id="node750" class="node">
<title>tp_10_7</title>
<ellipse fill="lightblue" stroke="black" cx="238117" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="238117" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L10</text>
<text text-anchor="middle" x="238117" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="238117" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="238117" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_8 -->
<g id="node751" class="node">
<title>route_10_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="237782" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="237782" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="237782" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="237782" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="237782" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_8_0 -->
<g id="node752" class="node">
<title>expert_10_8_0</title>
<polygon fill="lightgreen" stroke="black" points="237563.5,-857.45 237286.5,-857.45 237286.5,-813.45 237563.5,-813.45 237563.5,-857.45"/>
<text text-anchor="middle" x="237425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L10</text>
<text text-anchor="middle" x="237425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="237425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="237425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_8_1 -->
<g id="node753" class="node">
<title>expert_10_8_1</title>
<polygon fill="lightgreen" stroke="black" points="237268.5,-857.45 236991.5,-857.45 236991.5,-813.45 237268.5,-813.45 237268.5,-857.45"/>
<text text-anchor="middle" x="237130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L10</text>
<text text-anchor="middle" x="237130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="237130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="237130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_8 -->
<g id="node754" class="node">
<title>tp_10_8</title>
<ellipse fill="lightblue" stroke="black" cx="236858" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="236858" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L10</text>
<text text-anchor="middle" x="236858" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="236858" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="236858" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_9 -->
<g id="node755" class="node">
<title>route_10_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="236523" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="236523" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="236523" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="236523" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="236523" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_9_0 -->
<g id="node756" class="node">
<title>expert_10_9_0</title>
<polygon fill="lightgreen" stroke="black" points="236304.5,-857.45 236027.5,-857.45 236027.5,-813.45 236304.5,-813.45 236304.5,-857.45"/>
<text text-anchor="middle" x="236166" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L10</text>
<text text-anchor="middle" x="236166" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="236166" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="236166" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_9_1 -->
<g id="node757" class="node">
<title>expert_10_9_1</title>
<polygon fill="lightgreen" stroke="black" points="236009.5,-857.45 235732.5,-857.45 235732.5,-813.45 236009.5,-813.45 236009.5,-857.45"/>
<text text-anchor="middle" x="235871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L10</text>
<text text-anchor="middle" x="235871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="235871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="235871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_9 -->
<g id="node758" class="node">
<title>tp_10_9</title>
<ellipse fill="lightblue" stroke="black" cx="235599" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="235599" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L10</text>
<text text-anchor="middle" x="235599" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="235599" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="235599" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_10 -->
<g id="node759" class="node">
<title>route_10_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="235264" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="235264" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="235264" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="235264" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="235264" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_10_0 -->
<g id="node760" class="node">
<title>expert_10_10_0</title>
<polygon fill="lightgreen" stroke="black" points="235045.5,-857.45 234768.5,-857.45 234768.5,-813.45 235045.5,-813.45 235045.5,-857.45"/>
<text text-anchor="middle" x="234907" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L10</text>
<text text-anchor="middle" x="234907" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="234907" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="234907" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_10_1 -->
<g id="node761" class="node">
<title>expert_10_10_1</title>
<polygon fill="lightgreen" stroke="black" points="234750.5,-857.45 234473.5,-857.45 234473.5,-813.45 234750.5,-813.45 234750.5,-857.45"/>
<text text-anchor="middle" x="234612" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L10</text>
<text text-anchor="middle" x="234612" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="234612" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="234612" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_10 -->
<g id="node762" class="node">
<title>tp_10_10</title>
<ellipse fill="lightblue" stroke="black" cx="234340" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="234340" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L10</text>
<text text-anchor="middle" x="234340" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="234340" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="234340" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_11 -->
<g id="node763" class="node">
<title>route_10_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="234005" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="234005" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="234005" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="234005" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="234005" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_11_0 -->
<g id="node764" class="node">
<title>expert_10_11_0</title>
<polygon fill="lightgreen" stroke="black" points="233786.5,-857.45 233509.5,-857.45 233509.5,-813.45 233786.5,-813.45 233786.5,-857.45"/>
<text text-anchor="middle" x="233648" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L10</text>
<text text-anchor="middle" x="233648" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="233648" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="233648" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_11_1 -->
<g id="node765" class="node">
<title>expert_10_11_1</title>
<polygon fill="lightgreen" stroke="black" points="233491.5,-857.45 233214.5,-857.45 233214.5,-813.45 233491.5,-813.45 233491.5,-857.45"/>
<text text-anchor="middle" x="233353" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L10</text>
<text text-anchor="middle" x="233353" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="233353" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="233353" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_11 -->
<g id="node766" class="node">
<title>tp_10_11</title>
<ellipse fill="lightblue" stroke="black" cx="233081" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="233081" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L10</text>
<text text-anchor="middle" x="233081" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="233081" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="233081" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_12 -->
<g id="node767" class="node">
<title>route_10_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="232746" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="232746" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="232746" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="232746" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="232746" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_12_0 -->
<g id="node768" class="node">
<title>expert_10_12_0</title>
<polygon fill="lightgreen" stroke="black" points="232527.5,-857.45 232250.5,-857.45 232250.5,-813.45 232527.5,-813.45 232527.5,-857.45"/>
<text text-anchor="middle" x="232389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L10</text>
<text text-anchor="middle" x="232389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="232389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="232389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_12_1 -->
<g id="node769" class="node">
<title>expert_10_12_1</title>
<polygon fill="lightgreen" stroke="black" points="232232.5,-857.45 231955.5,-857.45 231955.5,-813.45 232232.5,-813.45 232232.5,-857.45"/>
<text text-anchor="middle" x="232094" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L10</text>
<text text-anchor="middle" x="232094" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="232094" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="232094" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_12 -->
<g id="node770" class="node">
<title>tp_10_12</title>
<ellipse fill="lightblue" stroke="black" cx="231822" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="231822" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L10</text>
<text text-anchor="middle" x="231822" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="231822" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="231822" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_13 -->
<g id="node771" class="node">
<title>route_10_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="231487" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="231487" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="231487" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="231487" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="231487" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_13_0 -->
<g id="node772" class="node">
<title>expert_10_13_0</title>
<polygon fill="lightgreen" stroke="black" points="231268.5,-857.45 230991.5,-857.45 230991.5,-813.45 231268.5,-813.45 231268.5,-857.45"/>
<text text-anchor="middle" x="231130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L10</text>
<text text-anchor="middle" x="231130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="231130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="231130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_13_1 -->
<g id="node773" class="node">
<title>expert_10_13_1</title>
<polygon fill="lightgreen" stroke="black" points="230973.5,-857.45 230696.5,-857.45 230696.5,-813.45 230973.5,-813.45 230973.5,-857.45"/>
<text text-anchor="middle" x="230835" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L10</text>
<text text-anchor="middle" x="230835" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="230835" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="230835" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_13 -->
<g id="node774" class="node">
<title>tp_10_13</title>
<ellipse fill="lightblue" stroke="black" cx="230563" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="230563" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L10</text>
<text text-anchor="middle" x="230563" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="230563" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="230563" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_14 -->
<g id="node775" class="node">
<title>route_10_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="230228" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="230228" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="230228" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="230228" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="230228" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_14_0 -->
<g id="node776" class="node">
<title>expert_10_14_0</title>
<polygon fill="lightgreen" stroke="black" points="230009.5,-857.45 229732.5,-857.45 229732.5,-813.45 230009.5,-813.45 230009.5,-857.45"/>
<text text-anchor="middle" x="229871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L10</text>
<text text-anchor="middle" x="229871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="229871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="229871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_14_1 -->
<g id="node777" class="node">
<title>expert_10_14_1</title>
<polygon fill="lightgreen" stroke="black" points="229714.5,-857.45 229437.5,-857.45 229437.5,-813.45 229714.5,-813.45 229714.5,-857.45"/>
<text text-anchor="middle" x="229576" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L10</text>
<text text-anchor="middle" x="229576" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="229576" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="229576" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_14 -->
<g id="node778" class="node">
<title>tp_10_14</title>
<ellipse fill="lightblue" stroke="black" cx="229304" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="229304" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L10</text>
<text text-anchor="middle" x="229304" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="229304" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="229304" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_10_15 -->
<g id="node779" class="node">
<title>route_10_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="228969" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="228969" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="228969" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="228969" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228969" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_10_15_0 -->
<g id="node780" class="node">
<title>expert_10_15_0</title>
<polygon fill="lightgreen" stroke="black" points="228750.5,-857.45 228473.5,-857.45 228473.5,-813.45 228750.5,-813.45 228750.5,-857.45"/>
<text text-anchor="middle" x="228612" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L10</text>
<text text-anchor="middle" x="228612" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="228612" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228612" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_10_15_1 -->
<g id="node781" class="node">
<title>expert_10_15_1</title>
<polygon fill="lightgreen" stroke="black" points="228455.5,-857.45 228178.5,-857.45 228178.5,-813.45 228455.5,-813.45 228455.5,-857.45"/>
<text text-anchor="middle" x="228317" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L10</text>
<text text-anchor="middle" x="228317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="228317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="228317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_10_15 -->
<g id="node782" class="node">
<title>tp_10_15</title>
<ellipse fill="lightblue" stroke="black" cx="228045" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="228045" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L10</text>
<text text-anchor="middle" x="228045" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="228045" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="228045" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_11 -->
<g id="node783" class="node">
<title>q_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="227911,-857.45 227615,-857.45 227615,-813.45 227911,-813.45 227911,-857.45"/>
<text text-anchor="middle" x="227763" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L11</text>
<text text-anchor="middle" x="227763" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="227763" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="227763" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_11 -->
<g id="node784" class="node">
<title>k_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="227597,-857.45 227301,-857.45 227301,-813.45 227597,-813.45 227597,-857.45"/>
<text text-anchor="middle" x="227449" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L11</text>
<text text-anchor="middle" x="227449" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="227449" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="227449" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_11 -->
<g id="node785" class="node">
<title>v_proj_11</title>
<polygon fill="lightgreen" stroke="black" points="227283,-857.45 226987,-857.45 226987,-813.45 227283,-813.45 227283,-857.45"/>
<text text-anchor="middle" x="227135" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L11</text>
<text text-anchor="middle" x="227135" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="227135" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="227135" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_11 -->
<g id="node786" class="node">
<title>attn_scores_11</title>
<polygon fill="lightgreen" stroke="black" points="226968.5,-857.45 226635.5,-857.45 226635.5,-813.45 226968.5,-813.45 226968.5,-857.45"/>
<text text-anchor="middle" x="226802" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L11</text>
<text text-anchor="middle" x="226802" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="226802" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="226802" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_11 -->
<g id="node787" class="node">
<title>softmax_11</title>
<polygon fill="lightgreen" stroke="black" points="226617.5,-857.45 226284.5,-857.45 226284.5,-813.45 226617.5,-813.45 226617.5,-857.45"/>
<text text-anchor="middle" x="226451" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L11</text>
<text text-anchor="middle" x="226451" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="226451" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="226451" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_11 -->
<g id="node788" class="node">
<title>attn_out_11</title>
<polygon fill="lightgreen" stroke="black" points="226266,-857.45 225970,-857.45 225970,-813.45 226266,-813.45 226266,-857.45"/>
<text text-anchor="middle" x="226118" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L11</text>
<text text-anchor="middle" x="226118" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;351</text>
<text text-anchor="middle" x="226118" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="226118" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_11 -->
<g id="node789" class="node">
<title>gate_11</title>
<polygon fill="lightyellow" stroke="black" points="225951.74,-879.45 225474.92,-879.45 225352.26,-791.45 225829.08,-791.45 225951.74,-879.45"/>
<text text-anchor="middle" x="225652" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L11</text>
<text text-anchor="middle" x="225652" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320&#45;383</text>
<text text-anchor="middle" x="225652" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="225652" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_11_0 -->
<g id="node790" class="node">
<title>route_11_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="225134" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="225134" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="225134" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="225134" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="225134" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_0_0 -->
<g id="node791" class="node">
<title>expert_11_0_0</title>
<polygon fill="lightgreen" stroke="black" points="224915.5,-857.45 224638.5,-857.45 224638.5,-813.45 224915.5,-813.45 224915.5,-857.45"/>
<text text-anchor="middle" x="224777" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L11</text>
<text text-anchor="middle" x="224777" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="224777" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="224777" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_0_1 -->
<g id="node792" class="node">
<title>expert_11_0_1</title>
<polygon fill="lightgreen" stroke="black" points="224620.5,-857.45 224343.5,-857.45 224343.5,-813.45 224620.5,-813.45 224620.5,-857.45"/>
<text text-anchor="middle" x="224482" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L11</text>
<text text-anchor="middle" x="224482" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="224482" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="224482" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_0 -->
<g id="node793" class="node">
<title>tp_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="224210" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="224210" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L11</text>
<text text-anchor="middle" x="224210" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="224210" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="224210" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_1 -->
<g id="node794" class="node">
<title>route_11_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="223875" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="223875" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="223875" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="223875" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="223875" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_1_0 -->
<g id="node795" class="node">
<title>expert_11_1_0</title>
<polygon fill="lightgreen" stroke="black" points="223656.5,-857.45 223379.5,-857.45 223379.5,-813.45 223656.5,-813.45 223656.5,-857.45"/>
<text text-anchor="middle" x="223518" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L11</text>
<text text-anchor="middle" x="223518" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="223518" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="223518" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_1_1 -->
<g id="node796" class="node">
<title>expert_11_1_1</title>
<polygon fill="lightgreen" stroke="black" points="223361.5,-857.45 223084.5,-857.45 223084.5,-813.45 223361.5,-813.45 223361.5,-857.45"/>
<text text-anchor="middle" x="223223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L11</text>
<text text-anchor="middle" x="223223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="223223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="223223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_1 -->
<g id="node797" class="node">
<title>tp_11_1</title>
<ellipse fill="lightblue" stroke="black" cx="222951" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="222951" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L11</text>
<text text-anchor="middle" x="222951" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="222951" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="222951" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_2 -->
<g id="node798" class="node">
<title>route_11_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="222616" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="222616" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="222616" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="222616" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="222616" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_2_0 -->
<g id="node799" class="node">
<title>expert_11_2_0</title>
<polygon fill="lightgreen" stroke="black" points="222397.5,-857.45 222120.5,-857.45 222120.5,-813.45 222397.5,-813.45 222397.5,-857.45"/>
<text text-anchor="middle" x="222259" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L11</text>
<text text-anchor="middle" x="222259" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="222259" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="222259" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_2_1 -->
<g id="node800" class="node">
<title>expert_11_2_1</title>
<polygon fill="lightgreen" stroke="black" points="222102.5,-857.45 221825.5,-857.45 221825.5,-813.45 222102.5,-813.45 222102.5,-857.45"/>
<text text-anchor="middle" x="221964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L11</text>
<text text-anchor="middle" x="221964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="221964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="221964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_2 -->
<g id="node801" class="node">
<title>tp_11_2</title>
<ellipse fill="lightblue" stroke="black" cx="221692" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="221692" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L11</text>
<text text-anchor="middle" x="221692" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="221692" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="221692" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_3 -->
<g id="node802" class="node">
<title>route_11_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="221357" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="221357" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="221357" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="221357" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="221357" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_3_0 -->
<g id="node803" class="node">
<title>expert_11_3_0</title>
<polygon fill="lightgreen" stroke="black" points="221138.5,-857.45 220861.5,-857.45 220861.5,-813.45 221138.5,-813.45 221138.5,-857.45"/>
<text text-anchor="middle" x="221000" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L11</text>
<text text-anchor="middle" x="221000" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="221000" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="221000" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_3_1 -->
<g id="node804" class="node">
<title>expert_11_3_1</title>
<polygon fill="lightgreen" stroke="black" points="220843.5,-857.45 220566.5,-857.45 220566.5,-813.45 220843.5,-813.45 220843.5,-857.45"/>
<text text-anchor="middle" x="220705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L11</text>
<text text-anchor="middle" x="220705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="220705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="220705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_3 -->
<g id="node805" class="node">
<title>tp_11_3</title>
<ellipse fill="lightblue" stroke="black" cx="220433" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="220433" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L11</text>
<text text-anchor="middle" x="220433" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="220433" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="220433" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_4 -->
<g id="node806" class="node">
<title>route_11_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="220098" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="220098" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="220098" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="220098" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="220098" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_4_0 -->
<g id="node807" class="node">
<title>expert_11_4_0</title>
<polygon fill="lightgreen" stroke="black" points="219879.5,-857.45 219602.5,-857.45 219602.5,-813.45 219879.5,-813.45 219879.5,-857.45"/>
<text text-anchor="middle" x="219741" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L11</text>
<text text-anchor="middle" x="219741" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="219741" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="219741" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_4_1 -->
<g id="node808" class="node">
<title>expert_11_4_1</title>
<polygon fill="lightgreen" stroke="black" points="219584.5,-857.45 219307.5,-857.45 219307.5,-813.45 219584.5,-813.45 219584.5,-857.45"/>
<text text-anchor="middle" x="219446" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L11</text>
<text text-anchor="middle" x="219446" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="219446" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="219446" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_4 -->
<g id="node809" class="node">
<title>tp_11_4</title>
<ellipse fill="lightblue" stroke="black" cx="219174" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="219174" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L11</text>
<text text-anchor="middle" x="219174" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="219174" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="219174" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_5 -->
<g id="node810" class="node">
<title>route_11_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="218839" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="218839" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="218839" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="218839" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="218839" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_5_0 -->
<g id="node811" class="node">
<title>expert_11_5_0</title>
<polygon fill="lightgreen" stroke="black" points="218620.5,-857.45 218343.5,-857.45 218343.5,-813.45 218620.5,-813.45 218620.5,-857.45"/>
<text text-anchor="middle" x="218482" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L11</text>
<text text-anchor="middle" x="218482" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="218482" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="218482" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_5_1 -->
<g id="node812" class="node">
<title>expert_11_5_1</title>
<polygon fill="lightgreen" stroke="black" points="218325.5,-857.45 218048.5,-857.45 218048.5,-813.45 218325.5,-813.45 218325.5,-857.45"/>
<text text-anchor="middle" x="218187" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L11</text>
<text text-anchor="middle" x="218187" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="218187" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="218187" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_5 -->
<g id="node813" class="node">
<title>tp_11_5</title>
<ellipse fill="lightblue" stroke="black" cx="217915" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="217915" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L11</text>
<text text-anchor="middle" x="217915" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="217915" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="217915" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_6 -->
<g id="node814" class="node">
<title>route_11_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="217580" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="217580" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="217580" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="217580" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="217580" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_6_0 -->
<g id="node815" class="node">
<title>expert_11_6_0</title>
<polygon fill="lightgreen" stroke="black" points="217361.5,-857.45 217084.5,-857.45 217084.5,-813.45 217361.5,-813.45 217361.5,-857.45"/>
<text text-anchor="middle" x="217223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L11</text>
<text text-anchor="middle" x="217223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="217223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="217223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_6_1 -->
<g id="node816" class="node">
<title>expert_11_6_1</title>
<polygon fill="lightgreen" stroke="black" points="217066.5,-857.45 216789.5,-857.45 216789.5,-813.45 217066.5,-813.45 217066.5,-857.45"/>
<text text-anchor="middle" x="216928" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L11</text>
<text text-anchor="middle" x="216928" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="216928" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="216928" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_6 -->
<g id="node817" class="node">
<title>tp_11_6</title>
<ellipse fill="lightblue" stroke="black" cx="216656" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="216656" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L11</text>
<text text-anchor="middle" x="216656" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="216656" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="216656" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_7 -->
<g id="node818" class="node">
<title>route_11_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="216321" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="216321" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="216321" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="216321" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="216321" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_7_0 -->
<g id="node819" class="node">
<title>expert_11_7_0</title>
<polygon fill="lightgreen" stroke="black" points="216102.5,-857.45 215825.5,-857.45 215825.5,-813.45 216102.5,-813.45 216102.5,-857.45"/>
<text text-anchor="middle" x="215964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L11</text>
<text text-anchor="middle" x="215964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="215964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="215964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_7_1 -->
<g id="node820" class="node">
<title>expert_11_7_1</title>
<polygon fill="lightgreen" stroke="black" points="215807.5,-857.45 215530.5,-857.45 215530.5,-813.45 215807.5,-813.45 215807.5,-857.45"/>
<text text-anchor="middle" x="215669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L11</text>
<text text-anchor="middle" x="215669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="215669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="215669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_7 -->
<g id="node821" class="node">
<title>tp_11_7</title>
<ellipse fill="lightblue" stroke="black" cx="215397" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="215397" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L11</text>
<text text-anchor="middle" x="215397" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="215397" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="215397" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_8 -->
<g id="node822" class="node">
<title>route_11_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="215062" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="215062" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="215062" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="215062" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="215062" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_8_0 -->
<g id="node823" class="node">
<title>expert_11_8_0</title>
<polygon fill="lightgreen" stroke="black" points="214843.5,-857.45 214566.5,-857.45 214566.5,-813.45 214843.5,-813.45 214843.5,-857.45"/>
<text text-anchor="middle" x="214705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L11</text>
<text text-anchor="middle" x="214705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="214705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="214705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_8_1 -->
<g id="node824" class="node">
<title>expert_11_8_1</title>
<polygon fill="lightgreen" stroke="black" points="214548.5,-857.45 214271.5,-857.45 214271.5,-813.45 214548.5,-813.45 214548.5,-857.45"/>
<text text-anchor="middle" x="214410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L11</text>
<text text-anchor="middle" x="214410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="214410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="214410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_8 -->
<g id="node825" class="node">
<title>tp_11_8</title>
<ellipse fill="lightblue" stroke="black" cx="214138" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="214138" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L11</text>
<text text-anchor="middle" x="214138" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="214138" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="214138" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_9 -->
<g id="node826" class="node">
<title>route_11_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="213803" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="213803" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="213803" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="213803" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="213803" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_9_0 -->
<g id="node827" class="node">
<title>expert_11_9_0</title>
<polygon fill="lightgreen" stroke="black" points="213584.5,-857.45 213307.5,-857.45 213307.5,-813.45 213584.5,-813.45 213584.5,-857.45"/>
<text text-anchor="middle" x="213446" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L11</text>
<text text-anchor="middle" x="213446" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="213446" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="213446" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_9_1 -->
<g id="node828" class="node">
<title>expert_11_9_1</title>
<polygon fill="lightgreen" stroke="black" points="213289.5,-857.45 213012.5,-857.45 213012.5,-813.45 213289.5,-813.45 213289.5,-857.45"/>
<text text-anchor="middle" x="213151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L11</text>
<text text-anchor="middle" x="213151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="213151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="213151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_9 -->
<g id="node829" class="node">
<title>tp_11_9</title>
<ellipse fill="lightblue" stroke="black" cx="212879" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="212879" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L11</text>
<text text-anchor="middle" x="212879" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="212879" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="212879" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_10 -->
<g id="node830" class="node">
<title>route_11_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="212544" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="212544" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="212544" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="212544" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="212544" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_10_0 -->
<g id="node831" class="node">
<title>expert_11_10_0</title>
<polygon fill="lightgreen" stroke="black" points="212325.5,-857.45 212048.5,-857.45 212048.5,-813.45 212325.5,-813.45 212325.5,-857.45"/>
<text text-anchor="middle" x="212187" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L11</text>
<text text-anchor="middle" x="212187" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="212187" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="212187" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_10_1 -->
<g id="node832" class="node">
<title>expert_11_10_1</title>
<polygon fill="lightgreen" stroke="black" points="212030.5,-857.45 211753.5,-857.45 211753.5,-813.45 212030.5,-813.45 212030.5,-857.45"/>
<text text-anchor="middle" x="211892" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L11</text>
<text text-anchor="middle" x="211892" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="211892" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="211892" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_10 -->
<g id="node833" class="node">
<title>tp_11_10</title>
<ellipse fill="lightblue" stroke="black" cx="211620" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="211620" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L11</text>
<text text-anchor="middle" x="211620" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="211620" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="211620" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_11 -->
<g id="node834" class="node">
<title>route_11_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="211285" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="211285" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="211285" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="211285" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="211285" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_11_0 -->
<g id="node835" class="node">
<title>expert_11_11_0</title>
<polygon fill="lightgreen" stroke="black" points="211066.5,-857.45 210789.5,-857.45 210789.5,-813.45 211066.5,-813.45 211066.5,-857.45"/>
<text text-anchor="middle" x="210928" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L11</text>
<text text-anchor="middle" x="210928" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="210928" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="210928" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_11_1 -->
<g id="node836" class="node">
<title>expert_11_11_1</title>
<polygon fill="lightgreen" stroke="black" points="210771.5,-857.45 210494.5,-857.45 210494.5,-813.45 210771.5,-813.45 210771.5,-857.45"/>
<text text-anchor="middle" x="210633" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L11</text>
<text text-anchor="middle" x="210633" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="210633" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="210633" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_11 -->
<g id="node837" class="node">
<title>tp_11_11</title>
<ellipse fill="lightblue" stroke="black" cx="210361" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="210361" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L11</text>
<text text-anchor="middle" x="210361" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="210361" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="210361" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_12 -->
<g id="node838" class="node">
<title>route_11_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="210026" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="210026" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="210026" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="210026" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="210026" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_12_0 -->
<g id="node839" class="node">
<title>expert_11_12_0</title>
<polygon fill="lightgreen" stroke="black" points="209807.5,-857.45 209530.5,-857.45 209530.5,-813.45 209807.5,-813.45 209807.5,-857.45"/>
<text text-anchor="middle" x="209669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L11</text>
<text text-anchor="middle" x="209669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="209669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="209669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_12_1 -->
<g id="node840" class="node">
<title>expert_11_12_1</title>
<polygon fill="lightgreen" stroke="black" points="209512.5,-857.45 209235.5,-857.45 209235.5,-813.45 209512.5,-813.45 209512.5,-857.45"/>
<text text-anchor="middle" x="209374" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L11</text>
<text text-anchor="middle" x="209374" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="209374" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="209374" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_12 -->
<g id="node841" class="node">
<title>tp_11_12</title>
<ellipse fill="lightblue" stroke="black" cx="209102" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="209102" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L11</text>
<text text-anchor="middle" x="209102" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="209102" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="209102" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_13 -->
<g id="node842" class="node">
<title>route_11_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="208767" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="208767" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="208767" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="208767" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="208767" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_13_0 -->
<g id="node843" class="node">
<title>expert_11_13_0</title>
<polygon fill="lightgreen" stroke="black" points="208548.5,-857.45 208271.5,-857.45 208271.5,-813.45 208548.5,-813.45 208548.5,-857.45"/>
<text text-anchor="middle" x="208410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L11</text>
<text text-anchor="middle" x="208410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="208410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="208410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_13_1 -->
<g id="node844" class="node">
<title>expert_11_13_1</title>
<polygon fill="lightgreen" stroke="black" points="208253.5,-857.45 207976.5,-857.45 207976.5,-813.45 208253.5,-813.45 208253.5,-857.45"/>
<text text-anchor="middle" x="208115" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L11</text>
<text text-anchor="middle" x="208115" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="208115" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="208115" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_13 -->
<g id="node845" class="node">
<title>tp_11_13</title>
<ellipse fill="lightblue" stroke="black" cx="207843" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="207843" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L11</text>
<text text-anchor="middle" x="207843" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="207843" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="207843" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_14 -->
<g id="node846" class="node">
<title>route_11_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="207508" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="207508" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="207508" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="207508" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="207508" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_14_0 -->
<g id="node847" class="node">
<title>expert_11_14_0</title>
<polygon fill="lightgreen" stroke="black" points="207289.5,-857.45 207012.5,-857.45 207012.5,-813.45 207289.5,-813.45 207289.5,-857.45"/>
<text text-anchor="middle" x="207151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L11</text>
<text text-anchor="middle" x="207151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="207151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="207151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_14_1 -->
<g id="node848" class="node">
<title>expert_11_14_1</title>
<polygon fill="lightgreen" stroke="black" points="206994.5,-857.45 206717.5,-857.45 206717.5,-813.45 206994.5,-813.45 206994.5,-857.45"/>
<text text-anchor="middle" x="206856" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L11</text>
<text text-anchor="middle" x="206856" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="206856" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="206856" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_14 -->
<g id="node849" class="node">
<title>tp_11_14</title>
<ellipse fill="lightblue" stroke="black" cx="206584" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="206584" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L11</text>
<text text-anchor="middle" x="206584" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="206584" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="206584" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_11_15 -->
<g id="node850" class="node">
<title>route_11_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="206249" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="206249" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="206249" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="206249" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="206249" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_11_15_0 -->
<g id="node851" class="node">
<title>expert_11_15_0</title>
<polygon fill="lightgreen" stroke="black" points="206030.5,-857.45 205753.5,-857.45 205753.5,-813.45 206030.5,-813.45 206030.5,-857.45"/>
<text text-anchor="middle" x="205892" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L11</text>
<text text-anchor="middle" x="205892" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="205892" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="205892" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_11_15_1 -->
<g id="node852" class="node">
<title>expert_11_15_1</title>
<polygon fill="lightgreen" stroke="black" points="205735.5,-857.45 205458.5,-857.45 205458.5,-813.45 205735.5,-813.45 205735.5,-857.45"/>
<text text-anchor="middle" x="205597" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L11</text>
<text text-anchor="middle" x="205597" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="205597" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="205597" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_11_15 -->
<g id="node853" class="node">
<title>tp_11_15</title>
<ellipse fill="lightblue" stroke="black" cx="205325" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="205325" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L11</text>
<text text-anchor="middle" x="205325" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="205325" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="205325" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_12 -->
<g id="node854" class="node">
<title>q_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="296077,-857.45 295781,-857.45 295781,-813.45 296077,-813.45 296077,-857.45"/>
<text text-anchor="middle" x="295929" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L12</text>
<text text-anchor="middle" x="295929" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="295929" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="295929" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_12 -->
<g id="node855" class="node">
<title>k_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="295763,-857.45 295467,-857.45 295467,-813.45 295763,-813.45 295763,-857.45"/>
<text text-anchor="middle" x="295615" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L12</text>
<text text-anchor="middle" x="295615" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="295615" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="295615" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_12 -->
<g id="node856" class="node">
<title>v_proj_12</title>
<polygon fill="lightgreen" stroke="black" points="295449,-857.45 295153,-857.45 295153,-813.45 295449,-813.45 295449,-857.45"/>
<text text-anchor="middle" x="295301" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L12</text>
<text text-anchor="middle" x="295301" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="295301" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="295301" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_12 -->
<g id="node857" class="node">
<title>attn_scores_12</title>
<polygon fill="lightgreen" stroke="black" points="295134.5,-857.45 294801.5,-857.45 294801.5,-813.45 295134.5,-813.45 295134.5,-857.45"/>
<text text-anchor="middle" x="294968" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L12</text>
<text text-anchor="middle" x="294968" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="294968" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="294968" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_12 -->
<g id="node858" class="node">
<title>softmax_12</title>
<polygon fill="lightgreen" stroke="black" points="294783.5,-857.45 294450.5,-857.45 294450.5,-813.45 294783.5,-813.45 294783.5,-857.45"/>
<text text-anchor="middle" x="294617" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L12</text>
<text text-anchor="middle" x="294617" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="294617" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="294617" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_12 -->
<g id="node859" class="node">
<title>attn_out_12</title>
<polygon fill="lightgreen" stroke="black" points="294432,-857.45 294136,-857.45 294136,-813.45 294432,-813.45 294432,-857.45"/>
<text text-anchor="middle" x="294284" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L12</text>
<text text-anchor="middle" x="294284" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="294284" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="294284" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_12 -->
<g id="node860" class="node">
<title>gate_12</title>
<polygon fill="lightyellow" stroke="black" points="294117.74,-879.45 293640.92,-879.45 293518.26,-791.45 293995.08,-791.45 294117.74,-879.45"/>
<text text-anchor="middle" x="293818" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L12</text>
<text text-anchor="middle" x="293818" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;447</text>
<text text-anchor="middle" x="293818" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="293818" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_12_0 -->
<g id="node861" class="node">
<title>route_12_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="293300" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="293300" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="293300" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="293300" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="293300" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_0_0 -->
<g id="node862" class="node">
<title>expert_12_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293081.5,-857.45 292804.5,-857.45 292804.5,-813.45 293081.5,-813.45 293081.5,-857.45"/>
<text text-anchor="middle" x="292943" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L12</text>
<text text-anchor="middle" x="292943" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="292943" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="292943" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_0_1 -->
<g id="node863" class="node">
<title>expert_12_0_1</title>
<polygon fill="lightgreen" stroke="black" points="292786.5,-857.45 292509.5,-857.45 292509.5,-813.45 292786.5,-813.45 292786.5,-857.45"/>
<text text-anchor="middle" x="292648" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L12</text>
<text text-anchor="middle" x="292648" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="292648" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="292648" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_0 -->
<g id="node864" class="node">
<title>tp_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="292376" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="292376" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L12</text>
<text text-anchor="middle" x="292376" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="292376" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="292376" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_1 -->
<g id="node865" class="node">
<title>route_12_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="292041" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="292041" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="292041" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="292041" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="292041" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_1_0 -->
<g id="node866" class="node">
<title>expert_12_1_0</title>
<polygon fill="lightgreen" stroke="black" points="291822.5,-857.45 291545.5,-857.45 291545.5,-813.45 291822.5,-813.45 291822.5,-857.45"/>
<text text-anchor="middle" x="291684" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L12</text>
<text text-anchor="middle" x="291684" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="291684" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="291684" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_1_1 -->
<g id="node867" class="node">
<title>expert_12_1_1</title>
<polygon fill="lightgreen" stroke="black" points="291527.5,-857.45 291250.5,-857.45 291250.5,-813.45 291527.5,-813.45 291527.5,-857.45"/>
<text text-anchor="middle" x="291389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L12</text>
<text text-anchor="middle" x="291389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="291389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="291389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_1 -->
<g id="node868" class="node">
<title>tp_12_1</title>
<ellipse fill="lightblue" stroke="black" cx="291117" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="291117" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L12</text>
<text text-anchor="middle" x="291117" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="291117" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="291117" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_2 -->
<g id="node869" class="node">
<title>route_12_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="290782" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="290782" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="290782" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="290782" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="290782" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_2_0 -->
<g id="node870" class="node">
<title>expert_12_2_0</title>
<polygon fill="lightgreen" stroke="black" points="290563.5,-857.45 290286.5,-857.45 290286.5,-813.45 290563.5,-813.45 290563.5,-857.45"/>
<text text-anchor="middle" x="290425" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L12</text>
<text text-anchor="middle" x="290425" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="290425" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="290425" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_2_1 -->
<g id="node871" class="node">
<title>expert_12_2_1</title>
<polygon fill="lightgreen" stroke="black" points="290268.5,-857.45 289991.5,-857.45 289991.5,-813.45 290268.5,-813.45 290268.5,-857.45"/>
<text text-anchor="middle" x="290130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L12</text>
<text text-anchor="middle" x="290130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="290130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="290130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_2 -->
<g id="node872" class="node">
<title>tp_12_2</title>
<ellipse fill="lightblue" stroke="black" cx="289858" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="289858" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L12</text>
<text text-anchor="middle" x="289858" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="289858" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="289858" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_3 -->
<g id="node873" class="node">
<title>route_12_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="289523" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="289523" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="289523" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="289523" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="289523" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_3_0 -->
<g id="node874" class="node">
<title>expert_12_3_0</title>
<polygon fill="lightgreen" stroke="black" points="289304.5,-857.45 289027.5,-857.45 289027.5,-813.45 289304.5,-813.45 289304.5,-857.45"/>
<text text-anchor="middle" x="289166" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L12</text>
<text text-anchor="middle" x="289166" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="289166" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="289166" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_3_1 -->
<g id="node875" class="node">
<title>expert_12_3_1</title>
<polygon fill="lightgreen" stroke="black" points="289009.5,-857.45 288732.5,-857.45 288732.5,-813.45 289009.5,-813.45 289009.5,-857.45"/>
<text text-anchor="middle" x="288871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L12</text>
<text text-anchor="middle" x="288871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="288871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="288871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_3 -->
<g id="node876" class="node">
<title>tp_12_3</title>
<ellipse fill="lightblue" stroke="black" cx="288599" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="288599" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L12</text>
<text text-anchor="middle" x="288599" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="288599" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="288599" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_4 -->
<g id="node877" class="node">
<title>route_12_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="288264" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="288264" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="288264" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="288264" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="288264" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_4_0 -->
<g id="node878" class="node">
<title>expert_12_4_0</title>
<polygon fill="lightgreen" stroke="black" points="288045.5,-857.45 287768.5,-857.45 287768.5,-813.45 288045.5,-813.45 288045.5,-857.45"/>
<text text-anchor="middle" x="287907" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L12</text>
<text text-anchor="middle" x="287907" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="287907" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="287907" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_4_1 -->
<g id="node879" class="node">
<title>expert_12_4_1</title>
<polygon fill="lightgreen" stroke="black" points="287750.5,-857.45 287473.5,-857.45 287473.5,-813.45 287750.5,-813.45 287750.5,-857.45"/>
<text text-anchor="middle" x="287612" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L12</text>
<text text-anchor="middle" x="287612" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="287612" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="287612" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_4 -->
<g id="node880" class="node">
<title>tp_12_4</title>
<ellipse fill="lightblue" stroke="black" cx="287340" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="287340" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L12</text>
<text text-anchor="middle" x="287340" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="287340" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="287340" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_5 -->
<g id="node881" class="node">
<title>route_12_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="287005" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="287005" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="287005" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="287005" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="287005" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_5_0 -->
<g id="node882" class="node">
<title>expert_12_5_0</title>
<polygon fill="lightgreen" stroke="black" points="286786.5,-857.45 286509.5,-857.45 286509.5,-813.45 286786.5,-813.45 286786.5,-857.45"/>
<text text-anchor="middle" x="286648" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L12</text>
<text text-anchor="middle" x="286648" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="286648" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="286648" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_5_1 -->
<g id="node883" class="node">
<title>expert_12_5_1</title>
<polygon fill="lightgreen" stroke="black" points="286491.5,-857.45 286214.5,-857.45 286214.5,-813.45 286491.5,-813.45 286491.5,-857.45"/>
<text text-anchor="middle" x="286353" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L12</text>
<text text-anchor="middle" x="286353" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="286353" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="286353" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_5 -->
<g id="node884" class="node">
<title>tp_12_5</title>
<ellipse fill="lightblue" stroke="black" cx="286081" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="286081" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L12</text>
<text text-anchor="middle" x="286081" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="286081" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="286081" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_6 -->
<g id="node885" class="node">
<title>route_12_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="285746" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="285746" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="285746" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="285746" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="285746" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_6_0 -->
<g id="node886" class="node">
<title>expert_12_6_0</title>
<polygon fill="lightgreen" stroke="black" points="285527.5,-857.45 285250.5,-857.45 285250.5,-813.45 285527.5,-813.45 285527.5,-857.45"/>
<text text-anchor="middle" x="285389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L12</text>
<text text-anchor="middle" x="285389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="285389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="285389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_6_1 -->
<g id="node887" class="node">
<title>expert_12_6_1</title>
<polygon fill="lightgreen" stroke="black" points="285232.5,-857.45 284955.5,-857.45 284955.5,-813.45 285232.5,-813.45 285232.5,-857.45"/>
<text text-anchor="middle" x="285094" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L12</text>
<text text-anchor="middle" x="285094" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="285094" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="285094" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_6 -->
<g id="node888" class="node">
<title>tp_12_6</title>
<ellipse fill="lightblue" stroke="black" cx="284822" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="284822" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L12</text>
<text text-anchor="middle" x="284822" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="284822" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="284822" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_7 -->
<g id="node889" class="node">
<title>route_12_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="284487" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="284487" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="284487" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="284487" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="284487" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_7_0 -->
<g id="node890" class="node">
<title>expert_12_7_0</title>
<polygon fill="lightgreen" stroke="black" points="284268.5,-857.45 283991.5,-857.45 283991.5,-813.45 284268.5,-813.45 284268.5,-857.45"/>
<text text-anchor="middle" x="284130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L12</text>
<text text-anchor="middle" x="284130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="284130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="284130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_7_1 -->
<g id="node891" class="node">
<title>expert_12_7_1</title>
<polygon fill="lightgreen" stroke="black" points="283973.5,-857.45 283696.5,-857.45 283696.5,-813.45 283973.5,-813.45 283973.5,-857.45"/>
<text text-anchor="middle" x="283835" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L12</text>
<text text-anchor="middle" x="283835" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="283835" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="283835" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_7 -->
<g id="node892" class="node">
<title>tp_12_7</title>
<ellipse fill="lightblue" stroke="black" cx="283563" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="283563" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L12</text>
<text text-anchor="middle" x="283563" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="283563" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="283563" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_8 -->
<g id="node893" class="node">
<title>route_12_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="283228" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="283228" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="283228" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="283228" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="283228" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_8_0 -->
<g id="node894" class="node">
<title>expert_12_8_0</title>
<polygon fill="lightgreen" stroke="black" points="283009.5,-857.45 282732.5,-857.45 282732.5,-813.45 283009.5,-813.45 283009.5,-857.45"/>
<text text-anchor="middle" x="282871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L12</text>
<text text-anchor="middle" x="282871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="282871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="282871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_8_1 -->
<g id="node895" class="node">
<title>expert_12_8_1</title>
<polygon fill="lightgreen" stroke="black" points="282714.5,-857.45 282437.5,-857.45 282437.5,-813.45 282714.5,-813.45 282714.5,-857.45"/>
<text text-anchor="middle" x="282576" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L12</text>
<text text-anchor="middle" x="282576" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="282576" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="282576" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_8 -->
<g id="node896" class="node">
<title>tp_12_8</title>
<ellipse fill="lightblue" stroke="black" cx="282304" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="282304" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L12</text>
<text text-anchor="middle" x="282304" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="282304" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="282304" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_9 -->
<g id="node897" class="node">
<title>route_12_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="281969" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="281969" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="281969" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="281969" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="281969" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_9_0 -->
<g id="node898" class="node">
<title>expert_12_9_0</title>
<polygon fill="lightgreen" stroke="black" points="281750.5,-857.45 281473.5,-857.45 281473.5,-813.45 281750.5,-813.45 281750.5,-857.45"/>
<text text-anchor="middle" x="281612" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L12</text>
<text text-anchor="middle" x="281612" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="281612" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="281612" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_9_1 -->
<g id="node899" class="node">
<title>expert_12_9_1</title>
<polygon fill="lightgreen" stroke="black" points="281455.5,-857.45 281178.5,-857.45 281178.5,-813.45 281455.5,-813.45 281455.5,-857.45"/>
<text text-anchor="middle" x="281317" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L12</text>
<text text-anchor="middle" x="281317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="281317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="281317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_9 -->
<g id="node900" class="node">
<title>tp_12_9</title>
<ellipse fill="lightblue" stroke="black" cx="281045" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="281045" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L12</text>
<text text-anchor="middle" x="281045" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="281045" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="281045" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_10 -->
<g id="node901" class="node">
<title>route_12_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="280710" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="280710" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="280710" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="280710" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="280710" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_10_0 -->
<g id="node902" class="node">
<title>expert_12_10_0</title>
<polygon fill="lightgreen" stroke="black" points="280491.5,-857.45 280214.5,-857.45 280214.5,-813.45 280491.5,-813.45 280491.5,-857.45"/>
<text text-anchor="middle" x="280353" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L12</text>
<text text-anchor="middle" x="280353" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="280353" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="280353" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_10_1 -->
<g id="node903" class="node">
<title>expert_12_10_1</title>
<polygon fill="lightgreen" stroke="black" points="280196.5,-857.45 279919.5,-857.45 279919.5,-813.45 280196.5,-813.45 280196.5,-857.45"/>
<text text-anchor="middle" x="280058" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L12</text>
<text text-anchor="middle" x="280058" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="280058" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="280058" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_10 -->
<g id="node904" class="node">
<title>tp_12_10</title>
<ellipse fill="lightblue" stroke="black" cx="279786" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="279786" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L12</text>
<text text-anchor="middle" x="279786" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="279786" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="279786" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_11 -->
<g id="node905" class="node">
<title>route_12_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="279451" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="279451" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="279451" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="279451" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="279451" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_11_0 -->
<g id="node906" class="node">
<title>expert_12_11_0</title>
<polygon fill="lightgreen" stroke="black" points="279232.5,-857.45 278955.5,-857.45 278955.5,-813.45 279232.5,-813.45 279232.5,-857.45"/>
<text text-anchor="middle" x="279094" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L12</text>
<text text-anchor="middle" x="279094" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="279094" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="279094" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_11_1 -->
<g id="node907" class="node">
<title>expert_12_11_1</title>
<polygon fill="lightgreen" stroke="black" points="278937.5,-857.45 278660.5,-857.45 278660.5,-813.45 278937.5,-813.45 278937.5,-857.45"/>
<text text-anchor="middle" x="278799" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L12</text>
<text text-anchor="middle" x="278799" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="278799" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="278799" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_11 -->
<g id="node908" class="node">
<title>tp_12_11</title>
<ellipse fill="lightblue" stroke="black" cx="278527" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="278527" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L12</text>
<text text-anchor="middle" x="278527" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="278527" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="278527" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_12 -->
<g id="node909" class="node">
<title>route_12_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="278192" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="278192" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="278192" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="278192" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="278192" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_12_0 -->
<g id="node910" class="node">
<title>expert_12_12_0</title>
<polygon fill="lightgreen" stroke="black" points="277973.5,-857.45 277696.5,-857.45 277696.5,-813.45 277973.5,-813.45 277973.5,-857.45"/>
<text text-anchor="middle" x="277835" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L12</text>
<text text-anchor="middle" x="277835" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="277835" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="277835" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_12_1 -->
<g id="node911" class="node">
<title>expert_12_12_1</title>
<polygon fill="lightgreen" stroke="black" points="277678.5,-857.45 277401.5,-857.45 277401.5,-813.45 277678.5,-813.45 277678.5,-857.45"/>
<text text-anchor="middle" x="277540" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L12</text>
<text text-anchor="middle" x="277540" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="277540" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="277540" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_12 -->
<g id="node912" class="node">
<title>tp_12_12</title>
<ellipse fill="lightblue" stroke="black" cx="277268" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="277268" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L12</text>
<text text-anchor="middle" x="277268" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="277268" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="277268" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_13 -->
<g id="node913" class="node">
<title>route_12_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="276933" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="276933" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="276933" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="276933" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="276933" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_13_0 -->
<g id="node914" class="node">
<title>expert_12_13_0</title>
<polygon fill="lightgreen" stroke="black" points="276714.5,-857.45 276437.5,-857.45 276437.5,-813.45 276714.5,-813.45 276714.5,-857.45"/>
<text text-anchor="middle" x="276576" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L12</text>
<text text-anchor="middle" x="276576" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="276576" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="276576" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_13_1 -->
<g id="node915" class="node">
<title>expert_12_13_1</title>
<polygon fill="lightgreen" stroke="black" points="276419.5,-857.45 276142.5,-857.45 276142.5,-813.45 276419.5,-813.45 276419.5,-857.45"/>
<text text-anchor="middle" x="276281" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L12</text>
<text text-anchor="middle" x="276281" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="276281" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="276281" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_13 -->
<g id="node916" class="node">
<title>tp_12_13</title>
<ellipse fill="lightblue" stroke="black" cx="276009" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="276009" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L12</text>
<text text-anchor="middle" x="276009" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="276009" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="276009" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_14 -->
<g id="node917" class="node">
<title>route_12_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="275674" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="275674" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="275674" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="275674" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="275674" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_14_0 -->
<g id="node918" class="node">
<title>expert_12_14_0</title>
<polygon fill="lightgreen" stroke="black" points="275455.5,-857.45 275178.5,-857.45 275178.5,-813.45 275455.5,-813.45 275455.5,-857.45"/>
<text text-anchor="middle" x="275317" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L12</text>
<text text-anchor="middle" x="275317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="275317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="275317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_14_1 -->
<g id="node919" class="node">
<title>expert_12_14_1</title>
<polygon fill="lightgreen" stroke="black" points="275160.5,-857.45 274883.5,-857.45 274883.5,-813.45 275160.5,-813.45 275160.5,-857.45"/>
<text text-anchor="middle" x="275022" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L12</text>
<text text-anchor="middle" x="275022" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="275022" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="275022" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_14 -->
<g id="node920" class="node">
<title>tp_12_14</title>
<ellipse fill="lightblue" stroke="black" cx="274750" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="274750" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L12</text>
<text text-anchor="middle" x="274750" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="274750" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="274750" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_12_15 -->
<g id="node921" class="node">
<title>route_12_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="274415" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="274415" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="274415" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="274415" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="274415" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_12_15_0 -->
<g id="node922" class="node">
<title>expert_12_15_0</title>
<polygon fill="lightgreen" stroke="black" points="274196.5,-857.45 273919.5,-857.45 273919.5,-813.45 274196.5,-813.45 274196.5,-857.45"/>
<text text-anchor="middle" x="274058" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L12</text>
<text text-anchor="middle" x="274058" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="274058" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="274058" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_12_15_1 -->
<g id="node923" class="node">
<title>expert_12_15_1</title>
<polygon fill="lightgreen" stroke="black" points="273901.5,-857.45 273624.5,-857.45 273624.5,-813.45 273901.5,-813.45 273901.5,-857.45"/>
<text text-anchor="middle" x="273763" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L12</text>
<text text-anchor="middle" x="273763" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="273763" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="273763" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_12_15 -->
<g id="node924" class="node">
<title>tp_12_15</title>
<ellipse fill="lightblue" stroke="black" cx="273491" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="273491" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L12</text>
<text text-anchor="middle" x="273491" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="273491" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="273491" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_13 -->
<g id="node925" class="node">
<title>q_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="273357,-857.45 273061,-857.45 273061,-813.45 273357,-813.45 273357,-857.45"/>
<text text-anchor="middle" x="273209" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L13</text>
<text text-anchor="middle" x="273209" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="273209" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="273209" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_13 -->
<g id="node926" class="node">
<title>k_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="273043,-857.45 272747,-857.45 272747,-813.45 273043,-813.45 273043,-857.45"/>
<text text-anchor="middle" x="272895" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L13</text>
<text text-anchor="middle" x="272895" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="272895" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="272895" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_13 -->
<g id="node927" class="node">
<title>v_proj_13</title>
<polygon fill="lightgreen" stroke="black" points="272729,-857.45 272433,-857.45 272433,-813.45 272729,-813.45 272729,-857.45"/>
<text text-anchor="middle" x="272581" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L13</text>
<text text-anchor="middle" x="272581" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="272581" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="272581" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_13 -->
<g id="node928" class="node">
<title>attn_scores_13</title>
<polygon fill="lightgreen" stroke="black" points="272414.5,-857.45 272081.5,-857.45 272081.5,-813.45 272414.5,-813.45 272414.5,-857.45"/>
<text text-anchor="middle" x="272248" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L13</text>
<text text-anchor="middle" x="272248" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="272248" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="272248" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_13 -->
<g id="node929" class="node">
<title>softmax_13</title>
<polygon fill="lightgreen" stroke="black" points="272063.5,-857.45 271730.5,-857.45 271730.5,-813.45 272063.5,-813.45 272063.5,-857.45"/>
<text text-anchor="middle" x="271897" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L13</text>
<text text-anchor="middle" x="271897" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="271897" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="271897" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_13 -->
<g id="node930" class="node">
<title>attn_out_13</title>
<polygon fill="lightgreen" stroke="black" points="271712,-857.45 271416,-857.45 271416,-813.45 271712,-813.45 271712,-857.45"/>
<text text-anchor="middle" x="271564" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L13</text>
<text text-anchor="middle" x="271564" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;415</text>
<text text-anchor="middle" x="271564" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="271564" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_13 -->
<g id="node931" class="node">
<title>gate_13</title>
<polygon fill="lightyellow" stroke="black" points="271397.74,-879.45 270920.92,-879.45 270798.26,-791.45 271275.08,-791.45 271397.74,-879.45"/>
<text text-anchor="middle" x="271098" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L13</text>
<text text-anchor="middle" x="271098" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384&#45;447</text>
<text text-anchor="middle" x="271098" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="271098" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_13_0 -->
<g id="node932" class="node">
<title>route_13_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="270580" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="270580" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="270580" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="270580" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="270580" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_0_0 -->
<g id="node933" class="node">
<title>expert_13_0_0</title>
<polygon fill="lightgreen" stroke="black" points="270361.5,-857.45 270084.5,-857.45 270084.5,-813.45 270361.5,-813.45 270361.5,-857.45"/>
<text text-anchor="middle" x="270223" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L13</text>
<text text-anchor="middle" x="270223" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="270223" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="270223" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_0_1 -->
<g id="node934" class="node">
<title>expert_13_0_1</title>
<polygon fill="lightgreen" stroke="black" points="270066.5,-857.45 269789.5,-857.45 269789.5,-813.45 270066.5,-813.45 270066.5,-857.45"/>
<text text-anchor="middle" x="269928" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L13</text>
<text text-anchor="middle" x="269928" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="269928" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="269928" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_0 -->
<g id="node935" class="node">
<title>tp_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="269656" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="269656" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L13</text>
<text text-anchor="middle" x="269656" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="269656" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="269656" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_1 -->
<g id="node936" class="node">
<title>route_13_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="269321" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="269321" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="269321" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="269321" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="269321" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_1_0 -->
<g id="node937" class="node">
<title>expert_13_1_0</title>
<polygon fill="lightgreen" stroke="black" points="269102.5,-857.45 268825.5,-857.45 268825.5,-813.45 269102.5,-813.45 269102.5,-857.45"/>
<text text-anchor="middle" x="268964" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L13</text>
<text text-anchor="middle" x="268964" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="268964" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="268964" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_1_1 -->
<g id="node938" class="node">
<title>expert_13_1_1</title>
<polygon fill="lightgreen" stroke="black" points="268807.5,-857.45 268530.5,-857.45 268530.5,-813.45 268807.5,-813.45 268807.5,-857.45"/>
<text text-anchor="middle" x="268669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L13</text>
<text text-anchor="middle" x="268669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="268669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="268669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_1 -->
<g id="node939" class="node">
<title>tp_13_1</title>
<ellipse fill="lightblue" stroke="black" cx="268397" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="268397" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L13</text>
<text text-anchor="middle" x="268397" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="268397" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="268397" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_2 -->
<g id="node940" class="node">
<title>route_13_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="268062" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="268062" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="268062" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="268062" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="268062" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_2_0 -->
<g id="node941" class="node">
<title>expert_13_2_0</title>
<polygon fill="lightgreen" stroke="black" points="267843.5,-857.45 267566.5,-857.45 267566.5,-813.45 267843.5,-813.45 267843.5,-857.45"/>
<text text-anchor="middle" x="267705" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L13</text>
<text text-anchor="middle" x="267705" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="267705" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="267705" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_2_1 -->
<g id="node942" class="node">
<title>expert_13_2_1</title>
<polygon fill="lightgreen" stroke="black" points="267548.5,-857.45 267271.5,-857.45 267271.5,-813.45 267548.5,-813.45 267548.5,-857.45"/>
<text text-anchor="middle" x="267410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L13</text>
<text text-anchor="middle" x="267410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="267410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="267410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_2 -->
<g id="node943" class="node">
<title>tp_13_2</title>
<ellipse fill="lightblue" stroke="black" cx="267138" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="267138" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L13</text>
<text text-anchor="middle" x="267138" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="267138" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="267138" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_3 -->
<g id="node944" class="node">
<title>route_13_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="266803" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="266803" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="266803" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="266803" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="266803" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_3_0 -->
<g id="node945" class="node">
<title>expert_13_3_0</title>
<polygon fill="lightgreen" stroke="black" points="266584.5,-857.45 266307.5,-857.45 266307.5,-813.45 266584.5,-813.45 266584.5,-857.45"/>
<text text-anchor="middle" x="266446" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L13</text>
<text text-anchor="middle" x="266446" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="266446" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="266446" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_3_1 -->
<g id="node946" class="node">
<title>expert_13_3_1</title>
<polygon fill="lightgreen" stroke="black" points="266289.5,-857.45 266012.5,-857.45 266012.5,-813.45 266289.5,-813.45 266289.5,-857.45"/>
<text text-anchor="middle" x="266151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L13</text>
<text text-anchor="middle" x="266151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="266151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="266151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_3 -->
<g id="node947" class="node">
<title>tp_13_3</title>
<ellipse fill="lightblue" stroke="black" cx="265879" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="265879" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L13</text>
<text text-anchor="middle" x="265879" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="265879" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="265879" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_4 -->
<g id="node948" class="node">
<title>route_13_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="265544" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="265544" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="265544" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="265544" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="265544" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_4_0 -->
<g id="node949" class="node">
<title>expert_13_4_0</title>
<polygon fill="lightgreen" stroke="black" points="265325.5,-857.45 265048.5,-857.45 265048.5,-813.45 265325.5,-813.45 265325.5,-857.45"/>
<text text-anchor="middle" x="265187" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L13</text>
<text text-anchor="middle" x="265187" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="265187" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="265187" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_4_1 -->
<g id="node950" class="node">
<title>expert_13_4_1</title>
<polygon fill="lightgreen" stroke="black" points="265030.5,-857.45 264753.5,-857.45 264753.5,-813.45 265030.5,-813.45 265030.5,-857.45"/>
<text text-anchor="middle" x="264892" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L13</text>
<text text-anchor="middle" x="264892" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="264892" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="264892" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_4 -->
<g id="node951" class="node">
<title>tp_13_4</title>
<ellipse fill="lightblue" stroke="black" cx="264620" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="264620" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L13</text>
<text text-anchor="middle" x="264620" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="264620" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="264620" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_5 -->
<g id="node952" class="node">
<title>route_13_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="264285" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="264285" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="264285" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="264285" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="264285" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_5_0 -->
<g id="node953" class="node">
<title>expert_13_5_0</title>
<polygon fill="lightgreen" stroke="black" points="264066.5,-857.45 263789.5,-857.45 263789.5,-813.45 264066.5,-813.45 264066.5,-857.45"/>
<text text-anchor="middle" x="263928" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L13</text>
<text text-anchor="middle" x="263928" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="263928" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="263928" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_5_1 -->
<g id="node954" class="node">
<title>expert_13_5_1</title>
<polygon fill="lightgreen" stroke="black" points="263771.5,-857.45 263494.5,-857.45 263494.5,-813.45 263771.5,-813.45 263771.5,-857.45"/>
<text text-anchor="middle" x="263633" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L13</text>
<text text-anchor="middle" x="263633" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="263633" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="263633" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_5 -->
<g id="node955" class="node">
<title>tp_13_5</title>
<ellipse fill="lightblue" stroke="black" cx="263361" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="263361" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L13</text>
<text text-anchor="middle" x="263361" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="263361" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="263361" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_6 -->
<g id="node956" class="node">
<title>route_13_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="263026" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="263026" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="263026" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="263026" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="263026" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_6_0 -->
<g id="node957" class="node">
<title>expert_13_6_0</title>
<polygon fill="lightgreen" stroke="black" points="262807.5,-857.45 262530.5,-857.45 262530.5,-813.45 262807.5,-813.45 262807.5,-857.45"/>
<text text-anchor="middle" x="262669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L13</text>
<text text-anchor="middle" x="262669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="262669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="262669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_6_1 -->
<g id="node958" class="node">
<title>expert_13_6_1</title>
<polygon fill="lightgreen" stroke="black" points="262512.5,-857.45 262235.5,-857.45 262235.5,-813.45 262512.5,-813.45 262512.5,-857.45"/>
<text text-anchor="middle" x="262374" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L13</text>
<text text-anchor="middle" x="262374" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="262374" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="262374" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_6 -->
<g id="node959" class="node">
<title>tp_13_6</title>
<ellipse fill="lightblue" stroke="black" cx="262102" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="262102" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L13</text>
<text text-anchor="middle" x="262102" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="262102" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="262102" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_7 -->
<g id="node960" class="node">
<title>route_13_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="261767" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="261767" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="261767" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="261767" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="261767" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_7_0 -->
<g id="node961" class="node">
<title>expert_13_7_0</title>
<polygon fill="lightgreen" stroke="black" points="261548.5,-857.45 261271.5,-857.45 261271.5,-813.45 261548.5,-813.45 261548.5,-857.45"/>
<text text-anchor="middle" x="261410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L13</text>
<text text-anchor="middle" x="261410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="261410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="261410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_7_1 -->
<g id="node962" class="node">
<title>expert_13_7_1</title>
<polygon fill="lightgreen" stroke="black" points="261253.5,-857.45 260976.5,-857.45 260976.5,-813.45 261253.5,-813.45 261253.5,-857.45"/>
<text text-anchor="middle" x="261115" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L13</text>
<text text-anchor="middle" x="261115" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="261115" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="261115" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_7 -->
<g id="node963" class="node">
<title>tp_13_7</title>
<ellipse fill="lightblue" stroke="black" cx="260843" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="260843" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L13</text>
<text text-anchor="middle" x="260843" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="260843" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="260843" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_8 -->
<g id="node964" class="node">
<title>route_13_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="260508" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="260508" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="260508" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="260508" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="260508" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_8_0 -->
<g id="node965" class="node">
<title>expert_13_8_0</title>
<polygon fill="lightgreen" stroke="black" points="260289.5,-857.45 260012.5,-857.45 260012.5,-813.45 260289.5,-813.45 260289.5,-857.45"/>
<text text-anchor="middle" x="260151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L13</text>
<text text-anchor="middle" x="260151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="260151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="260151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_8_1 -->
<g id="node966" class="node">
<title>expert_13_8_1</title>
<polygon fill="lightgreen" stroke="black" points="259994.5,-857.45 259717.5,-857.45 259717.5,-813.45 259994.5,-813.45 259994.5,-857.45"/>
<text text-anchor="middle" x="259856" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L13</text>
<text text-anchor="middle" x="259856" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="259856" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="259856" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_8 -->
<g id="node967" class="node">
<title>tp_13_8</title>
<ellipse fill="lightblue" stroke="black" cx="259584" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="259584" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L13</text>
<text text-anchor="middle" x="259584" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="259584" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="259584" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_9 -->
<g id="node968" class="node">
<title>route_13_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="259249" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="259249" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="259249" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="259249" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="259249" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_9_0 -->
<g id="node969" class="node">
<title>expert_13_9_0</title>
<polygon fill="lightgreen" stroke="black" points="259030.5,-857.45 258753.5,-857.45 258753.5,-813.45 259030.5,-813.45 259030.5,-857.45"/>
<text text-anchor="middle" x="258892" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L13</text>
<text text-anchor="middle" x="258892" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="258892" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="258892" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_9_1 -->
<g id="node970" class="node">
<title>expert_13_9_1</title>
<polygon fill="lightgreen" stroke="black" points="258735.5,-857.45 258458.5,-857.45 258458.5,-813.45 258735.5,-813.45 258735.5,-857.45"/>
<text text-anchor="middle" x="258597" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L13</text>
<text text-anchor="middle" x="258597" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="258597" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="258597" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_9 -->
<g id="node971" class="node">
<title>tp_13_9</title>
<ellipse fill="lightblue" stroke="black" cx="258325" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="258325" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L13</text>
<text text-anchor="middle" x="258325" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="258325" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="258325" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_10 -->
<g id="node972" class="node">
<title>route_13_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="257990" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="257990" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="257990" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="257990" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="257990" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_10_0 -->
<g id="node973" class="node">
<title>expert_13_10_0</title>
<polygon fill="lightgreen" stroke="black" points="257771.5,-857.45 257494.5,-857.45 257494.5,-813.45 257771.5,-813.45 257771.5,-857.45"/>
<text text-anchor="middle" x="257633" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L13</text>
<text text-anchor="middle" x="257633" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="257633" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="257633" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_10_1 -->
<g id="node974" class="node">
<title>expert_13_10_1</title>
<polygon fill="lightgreen" stroke="black" points="257476.5,-857.45 257199.5,-857.45 257199.5,-813.45 257476.5,-813.45 257476.5,-857.45"/>
<text text-anchor="middle" x="257338" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L13</text>
<text text-anchor="middle" x="257338" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="257338" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="257338" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_10 -->
<g id="node975" class="node">
<title>tp_13_10</title>
<ellipse fill="lightblue" stroke="black" cx="257066" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="257066" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L13</text>
<text text-anchor="middle" x="257066" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="257066" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="257066" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_11 -->
<g id="node976" class="node">
<title>route_13_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="256731" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="256731" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="256731" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="256731" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="256731" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_11_0 -->
<g id="node977" class="node">
<title>expert_13_11_0</title>
<polygon fill="lightgreen" stroke="black" points="256512.5,-857.45 256235.5,-857.45 256235.5,-813.45 256512.5,-813.45 256512.5,-857.45"/>
<text text-anchor="middle" x="256374" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L13</text>
<text text-anchor="middle" x="256374" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="256374" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="256374" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_11_1 -->
<g id="node978" class="node">
<title>expert_13_11_1</title>
<polygon fill="lightgreen" stroke="black" points="256217.5,-857.45 255940.5,-857.45 255940.5,-813.45 256217.5,-813.45 256217.5,-857.45"/>
<text text-anchor="middle" x="256079" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L13</text>
<text text-anchor="middle" x="256079" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="256079" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="256079" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_11 -->
<g id="node979" class="node">
<title>tp_13_11</title>
<ellipse fill="lightblue" stroke="black" cx="255807" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="255807" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L13</text>
<text text-anchor="middle" x="255807" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="255807" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="255807" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_12 -->
<g id="node980" class="node">
<title>route_13_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="255472" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="255472" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="255472" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="255472" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="255472" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_12_0 -->
<g id="node981" class="node">
<title>expert_13_12_0</title>
<polygon fill="lightgreen" stroke="black" points="255253.5,-857.45 254976.5,-857.45 254976.5,-813.45 255253.5,-813.45 255253.5,-857.45"/>
<text text-anchor="middle" x="255115" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L13</text>
<text text-anchor="middle" x="255115" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="255115" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="255115" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_12_1 -->
<g id="node982" class="node">
<title>expert_13_12_1</title>
<polygon fill="lightgreen" stroke="black" points="254958.5,-857.45 254681.5,-857.45 254681.5,-813.45 254958.5,-813.45 254958.5,-857.45"/>
<text text-anchor="middle" x="254820" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L13</text>
<text text-anchor="middle" x="254820" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="254820" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="254820" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_12 -->
<g id="node983" class="node">
<title>tp_13_12</title>
<ellipse fill="lightblue" stroke="black" cx="254548" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="254548" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L13</text>
<text text-anchor="middle" x="254548" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="254548" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="254548" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_13 -->
<g id="node984" class="node">
<title>route_13_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="254213" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="254213" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="254213" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="254213" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="254213" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_13_0 -->
<g id="node985" class="node">
<title>expert_13_13_0</title>
<polygon fill="lightgreen" stroke="black" points="253994.5,-857.45 253717.5,-857.45 253717.5,-813.45 253994.5,-813.45 253994.5,-857.45"/>
<text text-anchor="middle" x="253856" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L13</text>
<text text-anchor="middle" x="253856" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="253856" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="253856" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_13_1 -->
<g id="node986" class="node">
<title>expert_13_13_1</title>
<polygon fill="lightgreen" stroke="black" points="253699.5,-857.45 253422.5,-857.45 253422.5,-813.45 253699.5,-813.45 253699.5,-857.45"/>
<text text-anchor="middle" x="253561" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L13</text>
<text text-anchor="middle" x="253561" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="253561" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="253561" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_13 -->
<g id="node987" class="node">
<title>tp_13_13</title>
<ellipse fill="lightblue" stroke="black" cx="253289" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="253289" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L13</text>
<text text-anchor="middle" x="253289" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="253289" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="253289" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_14 -->
<g id="node988" class="node">
<title>route_13_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="252954" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="252954" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="252954" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="252954" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="252954" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_14_0 -->
<g id="node989" class="node">
<title>expert_13_14_0</title>
<polygon fill="lightgreen" stroke="black" points="252735.5,-857.45 252458.5,-857.45 252458.5,-813.45 252735.5,-813.45 252735.5,-857.45"/>
<text text-anchor="middle" x="252597" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L13</text>
<text text-anchor="middle" x="252597" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="252597" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="252597" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_14_1 -->
<g id="node990" class="node">
<title>expert_13_14_1</title>
<polygon fill="lightgreen" stroke="black" points="252440.5,-857.45 252163.5,-857.45 252163.5,-813.45 252440.5,-813.45 252440.5,-857.45"/>
<text text-anchor="middle" x="252302" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L13</text>
<text text-anchor="middle" x="252302" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="252302" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="252302" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_14 -->
<g id="node991" class="node">
<title>tp_13_14</title>
<ellipse fill="lightblue" stroke="black" cx="252030" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="252030" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L13</text>
<text text-anchor="middle" x="252030" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="252030" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="252030" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_13_15 -->
<g id="node992" class="node">
<title>route_13_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="251695" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="251695" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="251695" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="251695" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="251695" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_13_15_0 -->
<g id="node993" class="node">
<title>expert_13_15_0</title>
<polygon fill="lightgreen" stroke="black" points="251476.5,-857.45 251199.5,-857.45 251199.5,-813.45 251476.5,-813.45 251476.5,-857.45"/>
<text text-anchor="middle" x="251338" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L13</text>
<text text-anchor="middle" x="251338" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="251338" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="251338" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_13_15_1 -->
<g id="node994" class="node">
<title>expert_13_15_1</title>
<polygon fill="lightgreen" stroke="black" points="251181.5,-857.45 250904.5,-857.45 250904.5,-813.45 251181.5,-813.45 251181.5,-857.45"/>
<text text-anchor="middle" x="251043" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L13</text>
<text text-anchor="middle" x="251043" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="251043" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="251043" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_13_15 -->
<g id="node995" class="node">
<title>tp_13_15</title>
<ellipse fill="lightblue" stroke="black" cx="250771" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="250771" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L13</text>
<text text-anchor="middle" x="250771" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="250771" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="250771" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_14 -->
<g id="node996" class="node">
<title>q_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="341523,-857.45 341227,-857.45 341227,-813.45 341523,-813.45 341523,-857.45"/>
<text text-anchor="middle" x="341375" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L14</text>
<text text-anchor="middle" x="341375" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="341375" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="341375" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_14 -->
<g id="node997" class="node">
<title>k_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="341209,-857.45 340913,-857.45 340913,-813.45 341209,-813.45 341209,-857.45"/>
<text text-anchor="middle" x="341061" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L14</text>
<text text-anchor="middle" x="341061" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="341061" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="341061" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_14 -->
<g id="node998" class="node">
<title>v_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="340895,-857.45 340599,-857.45 340599,-813.45 340895,-813.45 340895,-857.45"/>
<text text-anchor="middle" x="340747" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L14</text>
<text text-anchor="middle" x="340747" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="340747" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="340747" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_14 -->
<g id="node999" class="node">
<title>attn_scores_14</title>
<polygon fill="lightgreen" stroke="black" points="340580.5,-857.45 340247.5,-857.45 340247.5,-813.45 340580.5,-813.45 340580.5,-857.45"/>
<text text-anchor="middle" x="340414" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L14</text>
<text text-anchor="middle" x="340414" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="340414" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="340414" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_14 -->
<g id="node1000" class="node">
<title>softmax_14</title>
<polygon fill="lightgreen" stroke="black" points="340229.5,-857.45 339896.5,-857.45 339896.5,-813.45 340229.5,-813.45 340229.5,-857.45"/>
<text text-anchor="middle" x="340063" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L14</text>
<text text-anchor="middle" x="340063" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="340063" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="340063" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_14 -->
<g id="node1001" class="node">
<title>attn_out_14</title>
<polygon fill="lightgreen" stroke="black" points="339878,-857.45 339582,-857.45 339582,-813.45 339878,-813.45 339878,-857.45"/>
<text text-anchor="middle" x="339730" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L14</text>
<text text-anchor="middle" x="339730" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="339730" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="339730" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_14 -->
<g id="node1002" class="node">
<title>gate_14</title>
<polygon fill="lightyellow" stroke="black" points="339563.74,-879.45 339086.92,-879.45 338964.26,-791.45 339441.08,-791.45 339563.74,-879.45"/>
<text text-anchor="middle" x="339264" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L14</text>
<text text-anchor="middle" x="339264" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;511</text>
<text text-anchor="middle" x="339264" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="339264" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_14_0 -->
<g id="node1003" class="node">
<title>route_14_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="338746" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="338746" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="338746" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="338746" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="338746" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_0_0 -->
<g id="node1004" class="node">
<title>expert_14_0_0</title>
<polygon fill="lightgreen" stroke="black" points="338527.5,-857.45 338250.5,-857.45 338250.5,-813.45 338527.5,-813.45 338527.5,-857.45"/>
<text text-anchor="middle" x="338389" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L14</text>
<text text-anchor="middle" x="338389" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="338389" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="338389" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_0_1 -->
<g id="node1005" class="node">
<title>expert_14_0_1</title>
<polygon fill="lightgreen" stroke="black" points="338232.5,-857.45 337955.5,-857.45 337955.5,-813.45 338232.5,-813.45 338232.5,-857.45"/>
<text text-anchor="middle" x="338094" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L14</text>
<text text-anchor="middle" x="338094" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="338094" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="338094" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_0 -->
<g id="node1006" class="node">
<title>tp_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="337822" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="337822" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L14</text>
<text text-anchor="middle" x="337822" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="337822" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="337822" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_1 -->
<g id="node1007" class="node">
<title>route_14_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="337487" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="337487" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="337487" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="337487" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="337487" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_1_0 -->
<g id="node1008" class="node">
<title>expert_14_1_0</title>
<polygon fill="lightgreen" stroke="black" points="337268.5,-857.45 336991.5,-857.45 336991.5,-813.45 337268.5,-813.45 337268.5,-857.45"/>
<text text-anchor="middle" x="337130" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L14</text>
<text text-anchor="middle" x="337130" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="337130" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="337130" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_1_1 -->
<g id="node1009" class="node">
<title>expert_14_1_1</title>
<polygon fill="lightgreen" stroke="black" points="336973.5,-857.45 336696.5,-857.45 336696.5,-813.45 336973.5,-813.45 336973.5,-857.45"/>
<text text-anchor="middle" x="336835" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L14</text>
<text text-anchor="middle" x="336835" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="336835" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="336835" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_1 -->
<g id="node1010" class="node">
<title>tp_14_1</title>
<ellipse fill="lightblue" stroke="black" cx="336563" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="336563" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L14</text>
<text text-anchor="middle" x="336563" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="336563" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="336563" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_2 -->
<g id="node1011" class="node">
<title>route_14_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="336228" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="336228" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="336228" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="336228" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="336228" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_2_0 -->
<g id="node1012" class="node">
<title>expert_14_2_0</title>
<polygon fill="lightgreen" stroke="black" points="336009.5,-857.45 335732.5,-857.45 335732.5,-813.45 336009.5,-813.45 336009.5,-857.45"/>
<text text-anchor="middle" x="335871" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L14</text>
<text text-anchor="middle" x="335871" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="335871" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="335871" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_2_1 -->
<g id="node1013" class="node">
<title>expert_14_2_1</title>
<polygon fill="lightgreen" stroke="black" points="335714.5,-857.45 335437.5,-857.45 335437.5,-813.45 335714.5,-813.45 335714.5,-857.45"/>
<text text-anchor="middle" x="335576" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L14</text>
<text text-anchor="middle" x="335576" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="335576" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="335576" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_2 -->
<g id="node1014" class="node">
<title>tp_14_2</title>
<ellipse fill="lightblue" stroke="black" cx="335304" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="335304" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L14</text>
<text text-anchor="middle" x="335304" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="335304" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="335304" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_3 -->
<g id="node1015" class="node">
<title>route_14_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="334969" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="334969" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="334969" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="334969" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="334969" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_3_0 -->
<g id="node1016" class="node">
<title>expert_14_3_0</title>
<polygon fill="lightgreen" stroke="black" points="334750.5,-857.45 334473.5,-857.45 334473.5,-813.45 334750.5,-813.45 334750.5,-857.45"/>
<text text-anchor="middle" x="334612" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L14</text>
<text text-anchor="middle" x="334612" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="334612" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="334612" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_3_1 -->
<g id="node1017" class="node">
<title>expert_14_3_1</title>
<polygon fill="lightgreen" stroke="black" points="334455.5,-857.45 334178.5,-857.45 334178.5,-813.45 334455.5,-813.45 334455.5,-857.45"/>
<text text-anchor="middle" x="334317" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L14</text>
<text text-anchor="middle" x="334317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="334317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="334317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_3 -->
<g id="node1018" class="node">
<title>tp_14_3</title>
<ellipse fill="lightblue" stroke="black" cx="334045" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="334045" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L14</text>
<text text-anchor="middle" x="334045" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="334045" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="334045" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_4 -->
<g id="node1019" class="node">
<title>route_14_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="333710" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="333710" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="333710" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="333710" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="333710" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_4_0 -->
<g id="node1020" class="node">
<title>expert_14_4_0</title>
<polygon fill="lightgreen" stroke="black" points="333491.5,-857.45 333214.5,-857.45 333214.5,-813.45 333491.5,-813.45 333491.5,-857.45"/>
<text text-anchor="middle" x="333353" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L14</text>
<text text-anchor="middle" x="333353" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="333353" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="333353" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_4_1 -->
<g id="node1021" class="node">
<title>expert_14_4_1</title>
<polygon fill="lightgreen" stroke="black" points="333196.5,-857.45 332919.5,-857.45 332919.5,-813.45 333196.5,-813.45 333196.5,-857.45"/>
<text text-anchor="middle" x="333058" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L14</text>
<text text-anchor="middle" x="333058" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="333058" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="333058" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_4 -->
<g id="node1022" class="node">
<title>tp_14_4</title>
<ellipse fill="lightblue" stroke="black" cx="332786" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="332786" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L14</text>
<text text-anchor="middle" x="332786" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="332786" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="332786" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_5 -->
<g id="node1023" class="node">
<title>route_14_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="332451" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="332451" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="332451" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="332451" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="332451" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_5_0 -->
<g id="node1024" class="node">
<title>expert_14_5_0</title>
<polygon fill="lightgreen" stroke="black" points="332232.5,-857.45 331955.5,-857.45 331955.5,-813.45 332232.5,-813.45 332232.5,-857.45"/>
<text text-anchor="middle" x="332094" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L14</text>
<text text-anchor="middle" x="332094" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="332094" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="332094" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_5_1 -->
<g id="node1025" class="node">
<title>expert_14_5_1</title>
<polygon fill="lightgreen" stroke="black" points="331937.5,-857.45 331660.5,-857.45 331660.5,-813.45 331937.5,-813.45 331937.5,-857.45"/>
<text text-anchor="middle" x="331799" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L14</text>
<text text-anchor="middle" x="331799" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="331799" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="331799" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_5 -->
<g id="node1026" class="node">
<title>tp_14_5</title>
<ellipse fill="lightblue" stroke="black" cx="331527" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="331527" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L14</text>
<text text-anchor="middle" x="331527" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="331527" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="331527" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_6 -->
<g id="node1027" class="node">
<title>route_14_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="331192" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="331192" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="331192" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="331192" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="331192" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_6_0 -->
<g id="node1028" class="node">
<title>expert_14_6_0</title>
<polygon fill="lightgreen" stroke="black" points="330973.5,-857.45 330696.5,-857.45 330696.5,-813.45 330973.5,-813.45 330973.5,-857.45"/>
<text text-anchor="middle" x="330835" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L14</text>
<text text-anchor="middle" x="330835" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="330835" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="330835" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_6_1 -->
<g id="node1029" class="node">
<title>expert_14_6_1</title>
<polygon fill="lightgreen" stroke="black" points="330678.5,-857.45 330401.5,-857.45 330401.5,-813.45 330678.5,-813.45 330678.5,-857.45"/>
<text text-anchor="middle" x="330540" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L14</text>
<text text-anchor="middle" x="330540" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="330540" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="330540" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_6 -->
<g id="node1030" class="node">
<title>tp_14_6</title>
<ellipse fill="lightblue" stroke="black" cx="330268" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="330268" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L14</text>
<text text-anchor="middle" x="330268" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="330268" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="330268" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_7 -->
<g id="node1031" class="node">
<title>route_14_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="329933" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="329933" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="329933" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="329933" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="329933" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_7_0 -->
<g id="node1032" class="node">
<title>expert_14_7_0</title>
<polygon fill="lightgreen" stroke="black" points="329714.5,-857.45 329437.5,-857.45 329437.5,-813.45 329714.5,-813.45 329714.5,-857.45"/>
<text text-anchor="middle" x="329576" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L14</text>
<text text-anchor="middle" x="329576" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="329576" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="329576" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_7_1 -->
<g id="node1033" class="node">
<title>expert_14_7_1</title>
<polygon fill="lightgreen" stroke="black" points="329419.5,-857.45 329142.5,-857.45 329142.5,-813.45 329419.5,-813.45 329419.5,-857.45"/>
<text text-anchor="middle" x="329281" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L14</text>
<text text-anchor="middle" x="329281" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="329281" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="329281" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_7 -->
<g id="node1034" class="node">
<title>tp_14_7</title>
<ellipse fill="lightblue" stroke="black" cx="329009" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="329009" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L14</text>
<text text-anchor="middle" x="329009" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="329009" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="329009" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_8 -->
<g id="node1035" class="node">
<title>route_14_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="328674" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="328674" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="328674" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="328674" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="328674" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_8_0 -->
<g id="node1036" class="node">
<title>expert_14_8_0</title>
<polygon fill="lightgreen" stroke="black" points="328455.5,-857.45 328178.5,-857.45 328178.5,-813.45 328455.5,-813.45 328455.5,-857.45"/>
<text text-anchor="middle" x="328317" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L14</text>
<text text-anchor="middle" x="328317" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="328317" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="328317" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_8_1 -->
<g id="node1037" class="node">
<title>expert_14_8_1</title>
<polygon fill="lightgreen" stroke="black" points="328160.5,-857.45 327883.5,-857.45 327883.5,-813.45 328160.5,-813.45 328160.5,-857.45"/>
<text text-anchor="middle" x="328022" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L14</text>
<text text-anchor="middle" x="328022" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="328022" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="328022" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_8 -->
<g id="node1038" class="node">
<title>tp_14_8</title>
<ellipse fill="lightblue" stroke="black" cx="327750" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="327750" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L14</text>
<text text-anchor="middle" x="327750" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="327750" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="327750" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_9 -->
<g id="node1039" class="node">
<title>route_14_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="327415" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="327415" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="327415" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="327415" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="327415" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_9_0 -->
<g id="node1040" class="node">
<title>expert_14_9_0</title>
<polygon fill="lightgreen" stroke="black" points="327196.5,-857.45 326919.5,-857.45 326919.5,-813.45 327196.5,-813.45 327196.5,-857.45"/>
<text text-anchor="middle" x="327058" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L14</text>
<text text-anchor="middle" x="327058" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="327058" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="327058" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_9_1 -->
<g id="node1041" class="node">
<title>expert_14_9_1</title>
<polygon fill="lightgreen" stroke="black" points="326901.5,-857.45 326624.5,-857.45 326624.5,-813.45 326901.5,-813.45 326901.5,-857.45"/>
<text text-anchor="middle" x="326763" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L14</text>
<text text-anchor="middle" x="326763" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="326763" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="326763" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_9 -->
<g id="node1042" class="node">
<title>tp_14_9</title>
<ellipse fill="lightblue" stroke="black" cx="326491" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="326491" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L14</text>
<text text-anchor="middle" x="326491" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="326491" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="326491" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_10 -->
<g id="node1043" class="node">
<title>route_14_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="326156" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="326156" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="326156" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="326156" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="326156" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_10_0 -->
<g id="node1044" class="node">
<title>expert_14_10_0</title>
<polygon fill="lightgreen" stroke="black" points="325937.5,-857.45 325660.5,-857.45 325660.5,-813.45 325937.5,-813.45 325937.5,-857.45"/>
<text text-anchor="middle" x="325799" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L14</text>
<text text-anchor="middle" x="325799" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="325799" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="325799" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_10_1 -->
<g id="node1045" class="node">
<title>expert_14_10_1</title>
<polygon fill="lightgreen" stroke="black" points="325642.5,-857.45 325365.5,-857.45 325365.5,-813.45 325642.5,-813.45 325642.5,-857.45"/>
<text text-anchor="middle" x="325504" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L14</text>
<text text-anchor="middle" x="325504" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="325504" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="325504" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_10 -->
<g id="node1046" class="node">
<title>tp_14_10</title>
<ellipse fill="lightblue" stroke="black" cx="325232" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="325232" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L14</text>
<text text-anchor="middle" x="325232" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="325232" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="325232" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_11 -->
<g id="node1047" class="node">
<title>route_14_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="324897" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="324897" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="324897" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="324897" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="324897" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_11_0 -->
<g id="node1048" class="node">
<title>expert_14_11_0</title>
<polygon fill="lightgreen" stroke="black" points="324678.5,-857.45 324401.5,-857.45 324401.5,-813.45 324678.5,-813.45 324678.5,-857.45"/>
<text text-anchor="middle" x="324540" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L14</text>
<text text-anchor="middle" x="324540" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="324540" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="324540" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_11_1 -->
<g id="node1049" class="node">
<title>expert_14_11_1</title>
<polygon fill="lightgreen" stroke="black" points="324383.5,-857.45 324106.5,-857.45 324106.5,-813.45 324383.5,-813.45 324383.5,-857.45"/>
<text text-anchor="middle" x="324245" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L14</text>
<text text-anchor="middle" x="324245" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="324245" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="324245" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_11 -->
<g id="node1050" class="node">
<title>tp_14_11</title>
<ellipse fill="lightblue" stroke="black" cx="323973" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="323973" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L14</text>
<text text-anchor="middle" x="323973" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="323973" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="323973" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_12 -->
<g id="node1051" class="node">
<title>route_14_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="323638" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="323638" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="323638" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="323638" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="323638" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_12_0 -->
<g id="node1052" class="node">
<title>expert_14_12_0</title>
<polygon fill="lightgreen" stroke="black" points="323419.5,-857.45 323142.5,-857.45 323142.5,-813.45 323419.5,-813.45 323419.5,-857.45"/>
<text text-anchor="middle" x="323281" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L14</text>
<text text-anchor="middle" x="323281" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="323281" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="323281" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_12_1 -->
<g id="node1053" class="node">
<title>expert_14_12_1</title>
<polygon fill="lightgreen" stroke="black" points="323124.5,-857.45 322847.5,-857.45 322847.5,-813.45 323124.5,-813.45 323124.5,-857.45"/>
<text text-anchor="middle" x="322986" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L14</text>
<text text-anchor="middle" x="322986" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="322986" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="322986" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_12 -->
<g id="node1054" class="node">
<title>tp_14_12</title>
<ellipse fill="lightblue" stroke="black" cx="322714" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="322714" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L14</text>
<text text-anchor="middle" x="322714" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="322714" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="322714" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_13 -->
<g id="node1055" class="node">
<title>route_14_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="322379" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="322379" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="322379" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="322379" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="322379" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_13_0 -->
<g id="node1056" class="node">
<title>expert_14_13_0</title>
<polygon fill="lightgreen" stroke="black" points="322160.5,-857.45 321883.5,-857.45 321883.5,-813.45 322160.5,-813.45 322160.5,-857.45"/>
<text text-anchor="middle" x="322022" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L14</text>
<text text-anchor="middle" x="322022" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="322022" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="322022" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_13_1 -->
<g id="node1057" class="node">
<title>expert_14_13_1</title>
<polygon fill="lightgreen" stroke="black" points="321865.5,-857.45 321588.5,-857.45 321588.5,-813.45 321865.5,-813.45 321865.5,-857.45"/>
<text text-anchor="middle" x="321727" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L14</text>
<text text-anchor="middle" x="321727" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="321727" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="321727" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_13 -->
<g id="node1058" class="node">
<title>tp_14_13</title>
<ellipse fill="lightblue" stroke="black" cx="321455" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="321455" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L14</text>
<text text-anchor="middle" x="321455" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="321455" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="321455" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_14 -->
<g id="node1059" class="node">
<title>route_14_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="321120" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="321120" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="321120" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="321120" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="321120" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_14_0 -->
<g id="node1060" class="node">
<title>expert_14_14_0</title>
<polygon fill="lightgreen" stroke="black" points="320901.5,-857.45 320624.5,-857.45 320624.5,-813.45 320901.5,-813.45 320901.5,-857.45"/>
<text text-anchor="middle" x="320763" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L14</text>
<text text-anchor="middle" x="320763" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="320763" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="320763" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_14_1 -->
<g id="node1061" class="node">
<title>expert_14_14_1</title>
<polygon fill="lightgreen" stroke="black" points="320606.5,-857.45 320329.5,-857.45 320329.5,-813.45 320606.5,-813.45 320606.5,-857.45"/>
<text text-anchor="middle" x="320468" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L14</text>
<text text-anchor="middle" x="320468" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="320468" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="320468" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_14 -->
<g id="node1062" class="node">
<title>tp_14_14</title>
<ellipse fill="lightblue" stroke="black" cx="320196" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="320196" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L14</text>
<text text-anchor="middle" x="320196" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="320196" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="320196" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_14_15 -->
<g id="node1063" class="node">
<title>route_14_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="319861" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="319861" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="319861" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="319861" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="319861" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_14_15_0 -->
<g id="node1064" class="node">
<title>expert_14_15_0</title>
<polygon fill="lightgreen" stroke="black" points="319642.5,-857.45 319365.5,-857.45 319365.5,-813.45 319642.5,-813.45 319642.5,-857.45"/>
<text text-anchor="middle" x="319504" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L14</text>
<text text-anchor="middle" x="319504" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="319504" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="319504" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_14_15_1 -->
<g id="node1065" class="node">
<title>expert_14_15_1</title>
<polygon fill="lightgreen" stroke="black" points="319347.5,-857.45 319070.5,-857.45 319070.5,-813.45 319347.5,-813.45 319347.5,-857.45"/>
<text text-anchor="middle" x="319209" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L14</text>
<text text-anchor="middle" x="319209" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="319209" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="319209" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_14_15 -->
<g id="node1066" class="node">
<title>tp_14_15</title>
<ellipse fill="lightblue" stroke="black" cx="318937" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="318937" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L14</text>
<text text-anchor="middle" x="318937" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="318937" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="318937" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- q_proj_15 -->
<g id="node1067" class="node">
<title>q_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="318803,-857.45 318507,-857.45 318507,-813.45 318803,-813.45 318803,-857.45"/>
<text text-anchor="middle" x="318655" y="-848.25" font-family="Times,serif" font-size="9.00">Q Projection L15</text>
<text text-anchor="middle" x="318655" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="318655" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="318655" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- k_proj_15 -->
<g id="node1068" class="node">
<title>k_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="318489,-857.45 318193,-857.45 318193,-813.45 318489,-813.45 318489,-857.45"/>
<text text-anchor="middle" x="318341" y="-848.25" font-family="Times,serif" font-size="9.00">K Projection L15</text>
<text text-anchor="middle" x="318341" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="318341" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="318341" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- v_proj_15 -->
<g id="node1069" class="node">
<title>v_proj_15</title>
<polygon fill="lightgreen" stroke="black" points="318175,-857.45 317879,-857.45 317879,-813.45 318175,-813.45 318175,-857.45"/>
<text text-anchor="middle" x="318027" y="-848.25" font-family="Times,serif" font-size="9.00">V Projection L15</text>
<text text-anchor="middle" x="318027" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="318027" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="318027" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- attn_scores_15 -->
<g id="node1070" class="node">
<title>attn_scores_15</title>
<polygon fill="lightgreen" stroke="black" points="317860.5,-857.45 317527.5,-857.45 317527.5,-813.45 317860.5,-813.45 317860.5,-857.45"/>
<text text-anchor="middle" x="317694" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Scores L15</text>
<text text-anchor="middle" x="317694" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="317694" y="-828.25" font-family="Times,serif" font-size="9.00">Input: Q,K,V [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="317694" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- softmax_15 -->
<g id="node1071" class="node">
<title>softmax_15</title>
<polygon fill="lightgreen" stroke="black" points="317509.5,-857.45 317176.5,-857.45 317176.5,-813.45 317509.5,-813.45 317509.5,-857.45"/>
<text text-anchor="middle" x="317343" y="-848.25" font-family="Times,serif" font-size="9.00">Softmax L15</text>
<text text-anchor="middle" x="317343" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="317343" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
<text text-anchor="middle" x="317343" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, seq_len=10240]</text>
</g>
<!-- attn_out_15 -->
<g id="node1072" class="node">
<title>attn_out_15</title>
<polygon fill="lightgreen" stroke="black" points="317158,-857.45 316862,-857.45 316862,-813.45 317158,-813.45 317158,-857.45"/>
<text text-anchor="middle" x="317010" y="-848.25" font-family="Times,serif" font-size="9.00">Attention Output L15</text>
<text text-anchor="middle" x="317010" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;479</text>
<text text-anchor="middle" x="317010" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="317010" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- gate_15 -->
<g id="node1073" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="316843.74,-879.45 316366.92,-879.45 316244.26,-791.45 316721.08,-791.45 316843.74,-879.45"/>
<text text-anchor="middle" x="316544" y="-848.25" font-family="Times,serif" font-size="9.00">Gate L15</text>
<text text-anchor="middle" x="316544" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448&#45;511</text>
<text text-anchor="middle" x="316544" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="316544" y="-818.25" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- route_15_0 -->
<g id="node1074" class="node">
<title>route_15_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="316026" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="316026" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="316026" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="316026" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="316026" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_0_0 -->
<g id="node1075" class="node">
<title>expert_15_0_0</title>
<polygon fill="lightgreen" stroke="black" points="315807.5,-857.45 315530.5,-857.45 315530.5,-813.45 315807.5,-813.45 315807.5,-857.45"/>
<text text-anchor="middle" x="315669" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0 L15</text>
<text text-anchor="middle" x="315669" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="315669" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="315669" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_0_1 -->
<g id="node1076" class="node">
<title>expert_15_0_1</title>
<polygon fill="lightgreen" stroke="black" points="315512.5,-857.45 315235.5,-857.45 315235.5,-813.45 315512.5,-813.45 315512.5,-857.45"/>
<text text-anchor="middle" x="315374" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1 L15</text>
<text text-anchor="middle" x="315374" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="315374" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="315374" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_0 -->
<g id="node1077" class="node">
<title>tp_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="315102" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="315102" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 0 L15</text>
<text text-anchor="middle" x="315102" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="315102" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="315102" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_1 -->
<g id="node1078" class="node">
<title>route_15_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="314767" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="314767" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="314767" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="314767" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="314767" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_1_0 -->
<g id="node1079" class="node">
<title>expert_15_1_0</title>
<polygon fill="lightgreen" stroke="black" points="314548.5,-857.45 314271.5,-857.45 314271.5,-813.45 314548.5,-813.45 314548.5,-857.45"/>
<text text-anchor="middle" x="314410" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0 L15</text>
<text text-anchor="middle" x="314410" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="314410" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="314410" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_1_1 -->
<g id="node1080" class="node">
<title>expert_15_1_1</title>
<polygon fill="lightgreen" stroke="black" points="314253.5,-857.45 313976.5,-857.45 313976.5,-813.45 314253.5,-813.45 314253.5,-857.45"/>
<text text-anchor="middle" x="314115" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1 L15</text>
<text text-anchor="middle" x="314115" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="314115" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="314115" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_1 -->
<g id="node1081" class="node">
<title>tp_15_1</title>
<ellipse fill="lightblue" stroke="black" cx="313843" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="313843" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 1 L15</text>
<text text-anchor="middle" x="313843" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="313843" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="313843" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_2 -->
<g id="node1082" class="node">
<title>route_15_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="313508" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="313508" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="313508" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="313508" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="313508" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_2_0 -->
<g id="node1083" class="node">
<title>expert_15_2_0</title>
<polygon fill="lightgreen" stroke="black" points="313289.5,-857.45 313012.5,-857.45 313012.5,-813.45 313289.5,-813.45 313289.5,-857.45"/>
<text text-anchor="middle" x="313151" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0 L15</text>
<text text-anchor="middle" x="313151" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="313151" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="313151" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_2_1 -->
<g id="node1084" class="node">
<title>expert_15_2_1</title>
<polygon fill="lightgreen" stroke="black" points="312994.5,-857.45 312717.5,-857.45 312717.5,-813.45 312994.5,-813.45 312994.5,-857.45"/>
<text text-anchor="middle" x="312856" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1 L15</text>
<text text-anchor="middle" x="312856" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="312856" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="312856" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_2 -->
<g id="node1085" class="node">
<title>tp_15_2</title>
<ellipse fill="lightblue" stroke="black" cx="312584" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="312584" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 2 L15</text>
<text text-anchor="middle" x="312584" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="312584" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="312584" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_3 -->
<g id="node1086" class="node">
<title>route_15_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="312249" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="312249" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="312249" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="312249" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="312249" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_3_0 -->
<g id="node1087" class="node">
<title>expert_15_3_0</title>
<polygon fill="lightgreen" stroke="black" points="312030.5,-857.45 311753.5,-857.45 311753.5,-813.45 312030.5,-813.45 312030.5,-857.45"/>
<text text-anchor="middle" x="311892" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0 L15</text>
<text text-anchor="middle" x="311892" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="311892" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="311892" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_3_1 -->
<g id="node1088" class="node">
<title>expert_15_3_1</title>
<polygon fill="lightgreen" stroke="black" points="311735.5,-857.45 311458.5,-857.45 311458.5,-813.45 311735.5,-813.45 311735.5,-857.45"/>
<text text-anchor="middle" x="311597" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1 L15</text>
<text text-anchor="middle" x="311597" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="311597" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="311597" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_3 -->
<g id="node1089" class="node">
<title>tp_15_3</title>
<ellipse fill="lightblue" stroke="black" cx="311325" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="311325" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 3 L15</text>
<text text-anchor="middle" x="311325" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="311325" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="311325" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_4 -->
<g id="node1090" class="node">
<title>route_15_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="310990" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="310990" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="310990" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="310990" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="310990" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_4_0 -->
<g id="node1091" class="node">
<title>expert_15_4_0</title>
<polygon fill="lightgreen" stroke="black" points="310771.5,-857.45 310494.5,-857.45 310494.5,-813.45 310771.5,-813.45 310771.5,-857.45"/>
<text text-anchor="middle" x="310633" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0 L15</text>
<text text-anchor="middle" x="310633" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="310633" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="310633" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_4_1 -->
<g id="node1092" class="node">
<title>expert_15_4_1</title>
<polygon fill="lightgreen" stroke="black" points="310476.5,-857.45 310199.5,-857.45 310199.5,-813.45 310476.5,-813.45 310476.5,-857.45"/>
<text text-anchor="middle" x="310338" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1 L15</text>
<text text-anchor="middle" x="310338" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="310338" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="310338" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_4 -->
<g id="node1093" class="node">
<title>tp_15_4</title>
<ellipse fill="lightblue" stroke="black" cx="310066" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="310066" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 4 L15</text>
<text text-anchor="middle" x="310066" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="310066" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="310066" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_5 -->
<g id="node1094" class="node">
<title>route_15_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="309731" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="309731" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="309731" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="309731" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="309731" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_5_0 -->
<g id="node1095" class="node">
<title>expert_15_5_0</title>
<polygon fill="lightgreen" stroke="black" points="309512.5,-857.45 309235.5,-857.45 309235.5,-813.45 309512.5,-813.45 309512.5,-857.45"/>
<text text-anchor="middle" x="309374" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0 L15</text>
<text text-anchor="middle" x="309374" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="309374" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="309374" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_5_1 -->
<g id="node1096" class="node">
<title>expert_15_5_1</title>
<polygon fill="lightgreen" stroke="black" points="309217.5,-857.45 308940.5,-857.45 308940.5,-813.45 309217.5,-813.45 309217.5,-857.45"/>
<text text-anchor="middle" x="309079" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1 L15</text>
<text text-anchor="middle" x="309079" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="309079" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="309079" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_5 -->
<g id="node1097" class="node">
<title>tp_15_5</title>
<ellipse fill="lightblue" stroke="black" cx="308807" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="308807" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 5 L15</text>
<text text-anchor="middle" x="308807" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="308807" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="308807" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_6 -->
<g id="node1098" class="node">
<title>route_15_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="308472" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="308472" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="308472" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="308472" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="308472" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_6_0 -->
<g id="node1099" class="node">
<title>expert_15_6_0</title>
<polygon fill="lightgreen" stroke="black" points="308253.5,-857.45 307976.5,-857.45 307976.5,-813.45 308253.5,-813.45 308253.5,-857.45"/>
<text text-anchor="middle" x="308115" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0 L15</text>
<text text-anchor="middle" x="308115" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="308115" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="308115" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_6_1 -->
<g id="node1100" class="node">
<title>expert_15_6_1</title>
<polygon fill="lightgreen" stroke="black" points="307958.5,-857.45 307681.5,-857.45 307681.5,-813.45 307958.5,-813.45 307958.5,-857.45"/>
<text text-anchor="middle" x="307820" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1 L15</text>
<text text-anchor="middle" x="307820" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="307820" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="307820" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_6 -->
<g id="node1101" class="node">
<title>tp_15_6</title>
<ellipse fill="lightblue" stroke="black" cx="307548" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="307548" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 6 L15</text>
<text text-anchor="middle" x="307548" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="307548" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="307548" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_7 -->
<g id="node1102" class="node">
<title>route_15_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="307213" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="307213" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="307213" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="307213" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="307213" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_7_0 -->
<g id="node1103" class="node">
<title>expert_15_7_0</title>
<polygon fill="lightgreen" stroke="black" points="306994.5,-857.45 306717.5,-857.45 306717.5,-813.45 306994.5,-813.45 306994.5,-857.45"/>
<text text-anchor="middle" x="306856" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0 L15</text>
<text text-anchor="middle" x="306856" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="306856" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="306856" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_7_1 -->
<g id="node1104" class="node">
<title>expert_15_7_1</title>
<polygon fill="lightgreen" stroke="black" points="306699.5,-857.45 306422.5,-857.45 306422.5,-813.45 306699.5,-813.45 306699.5,-857.45"/>
<text text-anchor="middle" x="306561" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1 L15</text>
<text text-anchor="middle" x="306561" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="306561" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="306561" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_7 -->
<g id="node1105" class="node">
<title>tp_15_7</title>
<ellipse fill="lightblue" stroke="black" cx="306289" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="306289" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 7 L15</text>
<text text-anchor="middle" x="306289" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="306289" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="306289" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_8 -->
<g id="node1106" class="node">
<title>route_15_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="305954" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="305954" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="305954" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="305954" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="305954" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_8_0 -->
<g id="node1107" class="node">
<title>expert_15_8_0</title>
<polygon fill="lightgreen" stroke="black" points="305735.5,-857.45 305458.5,-857.45 305458.5,-813.45 305735.5,-813.45 305735.5,-857.45"/>
<text text-anchor="middle" x="305597" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0 L15</text>
<text text-anchor="middle" x="305597" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="305597" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="305597" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_8_1 -->
<g id="node1108" class="node">
<title>expert_15_8_1</title>
<polygon fill="lightgreen" stroke="black" points="305440.5,-857.45 305163.5,-857.45 305163.5,-813.45 305440.5,-813.45 305440.5,-857.45"/>
<text text-anchor="middle" x="305302" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1 L15</text>
<text text-anchor="middle" x="305302" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="305302" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="305302" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_8 -->
<g id="node1109" class="node">
<title>tp_15_8</title>
<ellipse fill="lightblue" stroke="black" cx="305030" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="305030" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 8 L15</text>
<text text-anchor="middle" x="305030" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="305030" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="305030" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_9 -->
<g id="node1110" class="node">
<title>route_15_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="304695" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="304695" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="304695" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="304695" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="304695" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_9_0 -->
<g id="node1111" class="node">
<title>expert_15_9_0</title>
<polygon fill="lightgreen" stroke="black" points="304476.5,-857.45 304199.5,-857.45 304199.5,-813.45 304476.5,-813.45 304476.5,-857.45"/>
<text text-anchor="middle" x="304338" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0 L15</text>
<text text-anchor="middle" x="304338" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="304338" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="304338" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_9_1 -->
<g id="node1112" class="node">
<title>expert_15_9_1</title>
<polygon fill="lightgreen" stroke="black" points="304181.5,-857.45 303904.5,-857.45 303904.5,-813.45 304181.5,-813.45 304181.5,-857.45"/>
<text text-anchor="middle" x="304043" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1 L15</text>
<text text-anchor="middle" x="304043" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="304043" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="304043" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_9 -->
<g id="node1113" class="node">
<title>tp_15_9</title>
<ellipse fill="lightblue" stroke="black" cx="303771" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="303771" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 9 L15</text>
<text text-anchor="middle" x="303771" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="303771" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="303771" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_10 -->
<g id="node1114" class="node">
<title>route_15_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="303436" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="303436" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="303436" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="303436" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="303436" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_10_0 -->
<g id="node1115" class="node">
<title>expert_15_10_0</title>
<polygon fill="lightgreen" stroke="black" points="303217.5,-857.45 302940.5,-857.45 302940.5,-813.45 303217.5,-813.45 303217.5,-857.45"/>
<text text-anchor="middle" x="303079" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0 L15</text>
<text text-anchor="middle" x="303079" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="303079" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="303079" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_10_1 -->
<g id="node1116" class="node">
<title>expert_15_10_1</title>
<polygon fill="lightgreen" stroke="black" points="302922.5,-857.45 302645.5,-857.45 302645.5,-813.45 302922.5,-813.45 302922.5,-857.45"/>
<text text-anchor="middle" x="302784" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1 L15</text>
<text text-anchor="middle" x="302784" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="302784" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="302784" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_10 -->
<g id="node1117" class="node">
<title>tp_15_10</title>
<ellipse fill="lightblue" stroke="black" cx="302512" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="302512" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 10 L15</text>
<text text-anchor="middle" x="302512" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="302512" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="302512" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_11 -->
<g id="node1118" class="node">
<title>route_15_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="302177" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="302177" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="302177" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="302177" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="302177" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_11_0 -->
<g id="node1119" class="node">
<title>expert_15_11_0</title>
<polygon fill="lightgreen" stroke="black" points="301958.5,-857.45 301681.5,-857.45 301681.5,-813.45 301958.5,-813.45 301958.5,-857.45"/>
<text text-anchor="middle" x="301820" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0 L15</text>
<text text-anchor="middle" x="301820" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="301820" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="301820" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_11_1 -->
<g id="node1120" class="node">
<title>expert_15_11_1</title>
<polygon fill="lightgreen" stroke="black" points="301663.5,-857.45 301386.5,-857.45 301386.5,-813.45 301663.5,-813.45 301663.5,-857.45"/>
<text text-anchor="middle" x="301525" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1 L15</text>
<text text-anchor="middle" x="301525" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="301525" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="301525" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_11 -->
<g id="node1121" class="node">
<title>tp_15_11</title>
<ellipse fill="lightblue" stroke="black" cx="301253" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="301253" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 11 L15</text>
<text text-anchor="middle" x="301253" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="301253" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="301253" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_12 -->
<g id="node1122" class="node">
<title>route_15_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="300918" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="300918" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="300918" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="300918" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="300918" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_12_0 -->
<g id="node1123" class="node">
<title>expert_15_12_0</title>
<polygon fill="lightgreen" stroke="black" points="300699.5,-857.45 300422.5,-857.45 300422.5,-813.45 300699.5,-813.45 300699.5,-857.45"/>
<text text-anchor="middle" x="300561" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0 L15</text>
<text text-anchor="middle" x="300561" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="300561" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="300561" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_12_1 -->
<g id="node1124" class="node">
<title>expert_15_12_1</title>
<polygon fill="lightgreen" stroke="black" points="300404.5,-857.45 300127.5,-857.45 300127.5,-813.45 300404.5,-813.45 300404.5,-857.45"/>
<text text-anchor="middle" x="300266" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1 L15</text>
<text text-anchor="middle" x="300266" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="300266" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="300266" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_12 -->
<g id="node1125" class="node">
<title>tp_15_12</title>
<ellipse fill="lightblue" stroke="black" cx="299994" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="299994" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 12 L15</text>
<text text-anchor="middle" x="299994" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="299994" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="299994" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_13 -->
<g id="node1126" class="node">
<title>route_15_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="299659" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="299659" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="299659" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="299659" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="299659" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_13_0 -->
<g id="node1127" class="node">
<title>expert_15_13_0</title>
<polygon fill="lightgreen" stroke="black" points="299440.5,-857.45 299163.5,-857.45 299163.5,-813.45 299440.5,-813.45 299440.5,-857.45"/>
<text text-anchor="middle" x="299302" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0 L15</text>
<text text-anchor="middle" x="299302" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="299302" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="299302" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_13_1 -->
<g id="node1128" class="node">
<title>expert_15_13_1</title>
<polygon fill="lightgreen" stroke="black" points="299145.5,-857.45 298868.5,-857.45 298868.5,-813.45 299145.5,-813.45 299145.5,-857.45"/>
<text text-anchor="middle" x="299007" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1 L15</text>
<text text-anchor="middle" x="299007" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="299007" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="299007" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_13 -->
<g id="node1129" class="node">
<title>tp_15_13</title>
<ellipse fill="lightblue" stroke="black" cx="298735" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="298735" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 13 L15</text>
<text text-anchor="middle" x="298735" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="298735" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="298735" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_14 -->
<g id="node1130" class="node">
<title>route_15_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="298400" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="298400" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="298400" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="298400" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="298400" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_14_0 -->
<g id="node1131" class="node">
<title>expert_15_14_0</title>
<polygon fill="lightgreen" stroke="black" points="298181.5,-857.45 297904.5,-857.45 297904.5,-813.45 298181.5,-813.45 298181.5,-857.45"/>
<text text-anchor="middle" x="298043" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0 L15</text>
<text text-anchor="middle" x="298043" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="298043" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="298043" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_14_1 -->
<g id="node1132" class="node">
<title>expert_15_14_1</title>
<polygon fill="lightgreen" stroke="black" points="297886.5,-857.45 297609.5,-857.45 297609.5,-813.45 297886.5,-813.45 297886.5,-857.45"/>
<text text-anchor="middle" x="297748" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1 L15</text>
<text text-anchor="middle" x="297748" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="297748" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="297748" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_14 -->
<g id="node1133" class="node">
<title>tp_15_14</title>
<ellipse fill="lightblue" stroke="black" cx="297476" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="297476" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 14 L15</text>
<text text-anchor="middle" x="297476" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="297476" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="297476" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- route_15_15 -->
<g id="node1134" class="node">
<title>route_15_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="297141" cy="-835.45" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="297141" y="-848.25" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="297141" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="297141" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="297141" y="-818.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- expert_15_15_0 -->
<g id="node1135" class="node">
<title>expert_15_15_0</title>
<polygon fill="lightgreen" stroke="black" points="296922.5,-857.45 296645.5,-857.45 296645.5,-813.45 296922.5,-813.45 296922.5,-857.45"/>
<text text-anchor="middle" x="296784" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0 L15</text>
<text text-anchor="middle" x="296784" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="296784" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="296784" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- expert_15_15_1 -->
<g id="node1136" class="node">
<title>expert_15_15_1</title>
<polygon fill="lightgreen" stroke="black" points="296627.5,-857.45 296350.5,-857.45 296350.5,-813.45 296627.5,-813.45 296627.5,-857.45"/>
<text text-anchor="middle" x="296489" y="-848.25" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1 L15</text>
<text text-anchor="middle" x="296489" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="296489" y="-828.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="296489" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- tp_15_15 -->
<g id="node1137" class="node">
<title>tp_15_15</title>
<ellipse fill="lightblue" stroke="black" cx="296217" cy="-835.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="296217" y="-848.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce Expert 15 L15</text>
<text text-anchor="middle" x="296217" y="-838.25" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="296217" y="-828.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="296217" y="-818.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- output -->
<g id="node1138" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="296217" cy="-700.45" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="296217" y="-708.25" font-family="Times,serif" font-size="9.00">Output</text>
<text text-anchor="middle" x="296217" y="-698.25" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="296217" y="-688.25" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- tp_15_15&#45;&gt;output -->
<g id="edge90" class="edge">
<title>tp_15_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M296217,-804.27C296217,-783.68 296217,-756.4 296217,-735.11"/>
<polygon fill="black" stroke="black" points="296220.5,-734.89 296217,-724.89 296213.5,-734.89 296220.5,-734.89"/>
</g>
</g>
</svg>
