<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7707pt" height="9000pt"
 viewBox="0.00 0.00 1849.79 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.81 0.81) rotate(0) translate(4 11167.38)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11167.38 9563,-11167.38 9563,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<path fill="lightgray" stroke="black" d="M89,-9735.39C89,-9735.39 9504,-9735.39 9504,-9735.39 9510,-9735.39 9516,-9741.39 9516,-9747.39 9516,-9747.39 9516,-11095.3 9516,-11095.3 9516,-11101.3 9510,-11107.3 9504,-11107.3 9504,-11107.3 89,-11107.3 89,-11107.3 83,-11107.3 77,-11101.3 77,-11095.3 77,-11095.3 77,-9747.39 77,-9747.39 77,-9741.39 83,-9735.39 89,-9735.39"/>
<text text-anchor="middle" x="4796.5" y="-11092.1" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_1</title>
<path fill="lightgray" stroke="black" d="M105,-8355.49C105,-8355.49 9520,-8355.49 9520,-8355.49 9526,-8355.49 9532,-8361.49 9532,-8367.49 9532,-8367.49 9532,-9715.39 9532,-9715.39 9532,-9721.39 9526,-9727.39 9520,-9727.39 9520,-9727.39 105,-9727.39 105,-9727.39 99,-9727.39 93,-9721.39 93,-9715.39 93,-9715.39 93,-8367.49 93,-8367.49 93,-8361.49 99,-8355.49 105,-8355.49"/>
<text text-anchor="middle" x="4812.5" y="-9712.19" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_2</title>
<path fill="lightgray" stroke="black" d="M20,-6975.59C20,-6975.59 9435,-6975.59 9435,-6975.59 9441,-6975.59 9447,-6981.59 9447,-6987.59 9447,-6987.59 9447,-8335.49 9447,-8335.49 9447,-8341.49 9441,-8347.49 9435,-8347.49 9435,-8347.49 20,-8347.49 20,-8347.49 14,-8347.49 8,-8341.49 8,-8335.49 8,-8335.49 8,-6987.59 8,-6987.59 8,-6981.59 14,-6975.59 20,-6975.59"/>
<text text-anchor="middle" x="4727.5" y="-8332.29" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (Layers 4&#45;5)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_3</title>
<path fill="lightgray" stroke="black" d="M43,-5595.69C43,-5595.69 9458,-5595.69 9458,-5595.69 9464,-5595.69 9470,-5601.69 9470,-5607.69 9470,-5607.69 9470,-6955.59 9470,-6955.59 9470,-6961.59 9464,-6967.59 9458,-6967.59 9458,-6967.59 43,-6967.59 43,-6967.59 37,-6967.59 31,-6961.59 31,-6955.59 31,-6955.59 31,-5607.69 31,-5607.69 31,-5601.69 37,-5595.69 43,-5595.69"/>
<text text-anchor="middle" x="4750.5" y="-6952.39" font-family="Times,serif" font-size="14.00">Pipeline Stage 3 (Layers 6&#45;7)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage_4</title>
<path fill="lightgray" stroke="black" d="M109,-4215.79C109,-4215.79 9524,-4215.79 9524,-4215.79 9530,-4215.79 9536,-4221.79 9536,-4227.79 9536,-4227.79 9536,-5575.69 9536,-5575.69 9536,-5581.69 9530,-5587.69 9524,-5587.69 9524,-5587.69 109,-5587.69 109,-5587.69 103,-5587.69 97,-5581.69 97,-5575.69 97,-5575.69 97,-4227.79 97,-4227.79 97,-4221.79 103,-4215.79 109,-4215.79"/>
<text text-anchor="middle" x="4816.5" y="-5572.49" font-family="Times,serif" font-size="14.00">Pipeline Stage 4 (Layers 8&#45;9)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage_5</title>
<path fill="lightgray" stroke="black" d="M82,-2835.89C82,-2835.89 9497,-2835.89 9497,-2835.89 9503,-2835.89 9509,-2841.89 9509,-2847.89 9509,-2847.89 9509,-4195.79 9509,-4195.79 9509,-4201.79 9503,-4207.79 9497,-4207.79 9497,-4207.79 82,-4207.79 82,-4207.79 76,-4207.79 70,-4201.79 70,-4195.79 70,-4195.79 70,-2847.89 70,-2847.89 70,-2841.89 76,-2835.89 82,-2835.89"/>
<text text-anchor="middle" x="4789.5" y="-4192.59" font-family="Times,serif" font-size="14.00">Pipeline Stage 5 (Layers 10&#45;11)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_stage_6</title>
<path fill="lightgray" stroke="black" d="M124,-1455.98C124,-1455.98 9539,-1455.98 9539,-1455.98 9545,-1455.98 9551,-1461.98 9551,-1467.98 9551,-1467.98 9551,-2815.89 9551,-2815.89 9551,-2821.89 9545,-2827.89 9539,-2827.89 9539,-2827.89 124,-2827.89 124,-2827.89 118,-2827.89 112,-2821.89 112,-2815.89 112,-2815.89 112,-1467.98 112,-1467.98 112,-1461.98 118,-1455.98 124,-1455.98"/>
<text text-anchor="middle" x="4831.5" y="-2812.69" font-family="Times,serif" font-size="14.00">Pipeline Stage 6 (Layers 12&#45;13)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_stage_7</title>
<path fill="lightgray" stroke="black" d="M87,-76.08C87,-76.08 9502,-76.08 9502,-76.08 9508,-76.08 9514,-82.08 9514,-88.08 9514,-88.08 9514,-1435.98 9514,-1435.98 9514,-1441.98 9508,-1447.98 9502,-1447.98 9502,-1447.98 87,-1447.98 87,-1447.98 81,-1447.98 75,-1441.98 75,-1435.98 75,-1435.98 75,-88.08 75,-88.08 75,-82.08 81,-76.08 87,-76.08"/>
<text text-anchor="middle" x="4794.5" y="-1432.78" font-family="Times,serif" font-size="14.00">Pipeline Stage 7 (Layers 14&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="4796" cy="-11139.34" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="4796" y="-11147.14" font-family="Times,serif" font-size="9.00">Input</text>
<text text-anchor="middle" x="4796" y="-11137.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4796" y="-11127.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- mha_0 -->
<g id="node2" class="node">
<title>mha_0</title>
<polygon fill="lightgreen" stroke="black" points="4944,-11076.3 4648,-11076.3 4648,-11032.3 4944,-11032.3 4944,-11076.3"/>
<text text-anchor="middle" x="4796" y="-11067.1" font-family="Times,serif" font-size="9.00">MHA L0</text>
<text text-anchor="middle" x="4796" y="-11057.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-11047.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4796" y="-11037.1" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- input&#45;&gt;mha_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M4796,-11115.21C4796,-11106.35 4796,-11096.09 4796,-11086.6"/>
<polygon fill="black" stroke="black" points="4799.5,-11086.32 4796,-11076.32 4792.5,-11086.32 4799.5,-11086.32"/>
</g>
<!-- gate_0 -->
<g id="node3" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="5095.74,-10996.3 4618.92,-10996.3 4496.26,-10908.3 4973.08,-10908.3 5095.74,-10996.3"/>
<text text-anchor="middle" x="4796" y="-10965.1" font-family="Times,serif" font-size="9.00">Gate L0</text>
<text text-anchor="middle" x="4796" y="-10955.1" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-10945.1" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4796" y="-10935.1" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_0&#45;&gt;gate_0 -->
<g id="edge2" class="edge">
<title>mha_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M4796,-11032.09C4796,-11024.59 4796,-11015.78 4796,-11006.82"/>
<polygon fill="black" stroke="black" points="4799.5,-11006.7 4796,-10996.7 4792.5,-11006.7 4799.5,-11006.7"/>
</g>
<!-- route_0_0 -->
<g id="node4" class="node">
<title>route_0_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="519" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="519" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="519" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 0,1</text>
<text text-anchor="middle" x="519" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="519" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_0 -->
<g id="edge3" class="edge">
<title>gate_0&#45;&gt;route_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4556.09,-10951.34C3945.43,-10950.37 2282.63,-10941.08 899,-10872.3 833.75,-10869.05 762.32,-10863.83 699.17,-10858.64"/>
<polygon fill="black" stroke="black" points="699.36,-10855.15 689.11,-10857.81 698.79,-10862.12 699.36,-10855.15"/>
</g>
<!-- route_0_1 -->
<g id="node8" class="node">
<title>route_0_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1109" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1109" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1109" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 2,3</text>
<text text-anchor="middle" x="1109" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1109" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_1 -->
<g id="edge9" class="edge">
<title>gate_0&#45;&gt;route_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4554.4,-10950.09C4007.99,-10946.36 2635.53,-10931.37 1489,-10872.3 1423.91,-10868.94 1352.67,-10863.71 1289.63,-10858.55"/>
<polygon fill="black" stroke="black" points="1289.84,-10855.05 1279.59,-10857.72 1289.27,-10862.03 1289.84,-10855.05"/>
</g>
<!-- route_0_2 -->
<g id="node12" class="node">
<title>route_0_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1699" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1699" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1699" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 4,5</text>
<text text-anchor="middle" x="1699" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1699" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_2 -->
<g id="edge15" class="edge">
<title>gate_0&#45;&gt;route_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4551.82,-10948.29C4075.8,-10941.52 2990.5,-10921.63 2079,-10872.3 2014.08,-10868.78 1943.02,-10863.53 1880.1,-10858.39"/>
<polygon fill="black" stroke="black" points="1880.32,-10854.9 1870.07,-10857.57 1879.75,-10861.88 1880.32,-10854.9"/>
</g>
<!-- route_0_3 -->
<g id="node16" class="node">
<title>route_0_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2289" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2289" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2289" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 6,7</text>
<text text-anchor="middle" x="2289" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2289" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_3 -->
<g id="edge21" class="edge">
<title>gate_0&#45;&gt;route_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4547.78,-10945.45C4150.71,-10935.35 3348.24,-10911.81 2669,-10872.3 2604.41,-10868.54 2533.73,-10863.26 2471.03,-10858.17"/>
<polygon fill="black" stroke="black" points="2471.29,-10854.68 2461.04,-10857.35 2470.72,-10861.65 2471.29,-10854.68"/>
</g>
<!-- route_0_4 -->
<g id="node20" class="node">
<title>route_0_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2879" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2879" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2879" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 8,9</text>
<text text-anchor="middle" x="2879" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2879" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_4 -->
<g id="edge27" class="edge">
<title>gate_0&#45;&gt;route_0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4540.91,-10940.35C4235.88,-10926.76 3709.93,-10901.75 3259,-10872.3 3195.04,-10868.12 3125.08,-10862.79 3062.82,-10857.78"/>
<polygon fill="black" stroke="black" points="3062.74,-10854.27 3052.49,-10856.95 3062.18,-10861.24 3062.74,-10854.27"/>
</g>
<!-- route_0_5 -->
<g id="node24" class="node">
<title>route_0_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3469" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3469" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3469" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 10,11</text>
<text text-anchor="middle" x="3469" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3469" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_5 -->
<g id="edge33" class="edge">
<title>gate_0&#45;&gt;route_0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4525.06,-10929.02C4265.32,-10907.66 3880.23,-10876 3653.92,-10857.39"/>
<polygon fill="black" stroke="black" points="3654.18,-10853.9 3643.93,-10856.57 3653.61,-10860.87 3654.18,-10853.9"/>
</g>
<!-- route_0_6 -->
<g id="node28" class="node">
<title>route_0_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4059" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4059" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4059" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 12,13</text>
<text text-anchor="middle" x="4059" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4059" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_6 -->
<g id="edge39" class="edge">
<title>gate_0&#45;&gt;route_0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4505.51,-10908.29C4404.8,-10893.38 4295.94,-10877.26 4210.92,-10864.67"/>
<polygon fill="black" stroke="black" points="4211.34,-10861.2 4200.93,-10863.2 4210.31,-10868.12 4211.34,-10861.2"/>
</g>
<!-- route_0_7 -->
<g id="node32" class="node">
<title>route_0_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4586" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4586" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4586" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 14,15</text>
<text text-anchor="middle" x="4586" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4586" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_7 -->
<g id="edge45" class="edge">
<title>gate_0&#45;&gt;route_0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4713,-10908.17C4692.22,-10897.38 4670.24,-10885.95 4650.51,-10875.7"/>
<polygon fill="black" stroke="black" points="4652.1,-10872.59 4641.62,-10871.08 4648.88,-10878.8 4652.1,-10872.59"/>
</g>
<!-- route_0_8 -->
<g id="node36" class="node">
<title>route_0_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5006" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5006" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5006" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 16,17</text>
<text text-anchor="middle" x="5006" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5006" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_8 -->
<g id="edge51" class="edge">
<title>gate_0&#45;&gt;route_0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4879,-10908.17C4899.78,-10897.38 4921.76,-10885.95 4941.49,-10875.7"/>
<polygon fill="black" stroke="black" points="4943.12,-10878.8 4950.38,-10871.08 4939.9,-10872.59 4943.12,-10878.8"/>
</g>
<!-- route_0_9 -->
<g id="node40" class="node">
<title>route_0_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5534" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5534" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5534" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 18,19</text>
<text text-anchor="middle" x="5534" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5534" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_9 -->
<g id="edge57" class="edge">
<title>gate_0&#45;&gt;route_0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4992.8,-10922.2C5114.76,-10904.17 5269.08,-10881.35 5381.69,-10864.7"/>
<polygon fill="black" stroke="black" points="5382.39,-10868.14 5391.77,-10863.21 5381.37,-10861.21 5382.39,-10868.14"/>
</g>
<!-- route_0_10 -->
<g id="node44" class="node">
<title>route_0_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6124" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6124" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6124" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 20,21</text>
<text text-anchor="middle" x="6124" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6124" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_10 -->
<g id="edge63" class="edge">
<title>gate_0&#45;&gt;route_0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5009,-10933.8C5266.37,-10912.65 5695.14,-10877.42 5939.18,-10857.37"/>
<polygon fill="black" stroke="black" points="5939.54,-10860.85 5949.22,-10856.54 5938.96,-10853.87 5939.54,-10860.85"/>
</g>
<!-- route_0_11 -->
<g id="node48" class="node">
<title>route_0_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6714" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6714" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6714" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 22,23</text>
<text text-anchor="middle" x="6714" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6714" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_11 -->
<g id="edge69" class="edge">
<title>gate_0&#45;&gt;route_0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5019.94,-10941.74C5319.44,-10928.52 5866.94,-10902.79 6334,-10872.3 6397.96,-10868.12 6467.92,-10862.79 6530.18,-10857.78"/>
<polygon fill="black" stroke="black" points="6530.82,-10861.24 6540.51,-10856.95 6530.26,-10854.27 6530.82,-10861.24"/>
</g>
<!-- route_0_12 -->
<g id="node52" class="node">
<title>route_0_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7304" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7304" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7304" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 24,25</text>
<text text-anchor="middle" x="7304" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7304" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_12 -->
<g id="edge75" class="edge">
<title>gate_0&#45;&gt;route_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025.64,-10945.93C5415.94,-10936.1 6233.6,-10912.45 6924,-10872.3 6988.59,-10868.54 7059.27,-10863.26 7121.97,-10858.17"/>
<polygon fill="black" stroke="black" points="7122.28,-10861.66 7131.96,-10857.35 7121.71,-10854.68 7122.28,-10861.66"/>
</g>
<!-- route_0_13 -->
<g id="node56" class="node">
<title>route_0_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7894" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7894" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7894" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 26,27</text>
<text text-anchor="middle" x="7894" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7894" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_13 -->
<g id="edge81" class="edge">
<title>gate_0&#45;&gt;route_0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5029.3,-10948.44C5499.62,-10941.83 6595.09,-10922.03 7514,-10872.3 7578.92,-10868.78 7649.98,-10863.53 7712.9,-10858.39"/>
<polygon fill="black" stroke="black" points="7713.25,-10861.88 7722.93,-10857.57 7712.68,-10854.9 7713.25,-10861.88"/>
</g>
<!-- route_0_14 -->
<g id="node60" class="node">
<title>route_0_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8484" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8484" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8484" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 28,29</text>
<text text-anchor="middle" x="8484" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8484" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_14 -->
<g id="edge87" class="edge">
<title>gate_0&#45;&gt;route_0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5031.56,-10950.13C5573.95,-10946.48 6952.82,-10931.61 8104,-10872.3 8169.09,-10868.94 8240.33,-10863.71 8303.37,-10858.55"/>
<polygon fill="black" stroke="black" points="8303.73,-10862.03 8313.41,-10857.72 8303.16,-10855.05 8303.73,-10862.03"/>
</g>
<!-- route_0_15 -->
<g id="node64" class="node">
<title>route_0_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9074" cy="-10841.18" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9074" y="-10853.98" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9074" y="-10843.98" font-family="Times,serif" font-size="9.00">GPU: 30,31</text>
<text text-anchor="middle" x="9074" y="-10833.98" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9074" y="-10823.98" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_0&#45;&gt;route_0_15 -->
<g id="edge93" class="edge">
<title>gate_0&#45;&gt;route_0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5033.19,-10951.34C5641.71,-10950.41 7307.91,-10941.2 8694,-10872.3 8759.25,-10869.05 8830.68,-10863.83 8893.83,-10858.64"/>
<polygon fill="black" stroke="black" points="8894.21,-10862.12 8903.89,-10857.81 8893.64,-10855.15 8894.21,-10862.12"/>
</g>
<!-- expert_0_0_0 -->
<g id="node5" class="node">
<title>expert_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="362.5,-10774.07 85.5,-10774.07 85.5,-10730.07 362.5,-10730.07 362.5,-10774.07"/>
<text text-anchor="middle" x="224" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="224" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 0</text>
<text text-anchor="middle" x="224" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="224" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_0 -->
<g id="edge4" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_0</title>
<path fill="none" stroke="black" d="M428.08,-10813.34C388.92,-10801.77 343.49,-10788.35 305.44,-10777.12"/>
<polygon fill="black" stroke="black" points="306.01,-10773.64 295.43,-10774.16 304.03,-10780.35 306.01,-10773.64"/>
</g>
<!-- expert_0_0_1 -->
<g id="node6" class="node">
<title>expert_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="657.5,-10774.07 380.5,-10774.07 380.5,-10730.07 657.5,-10730.07 657.5,-10774.07"/>
<text text-anchor="middle" x="519" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="519" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 1</text>
<text text-anchor="middle" x="519" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="519" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_0&#45;&gt;expert_0_0_1 -->
<g id="edge5" class="edge">
<title>route_0_0&#45;&gt;expert_0_0_1</title>
<path fill="none" stroke="black" d="M519,-10809.72C519,-10801.44 519,-10792.46 519,-10784.15"/>
<polygon fill="black" stroke="black" points="522.5,-10784.07 519,-10774.07 515.5,-10784.07 522.5,-10784.07"/>
</g>
<!-- tp_0_0 -->
<g id="node7" class="node">
<title>tp_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="519" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="519" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="519" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 0↔1</text>
<text text-anchor="middle" x="519" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="519" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_0_0&#45;&gt;tp_0_0 -->
<g id="edge6" class="edge">
<title>expert_0_0_0&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M295.41,-10729.98C336.87,-10717.74 389.36,-10702.24 433.07,-10689.33"/>
<polygon fill="black" stroke="black" points="434.23,-10692.64 442.83,-10686.45 432.25,-10685.93 434.23,-10692.64"/>
</g>
<!-- expert_0_0_1&#45;&gt;tp_0_0 -->
<g id="edge7" class="edge">
<title>expert_0_0_1&#45;&gt;tp_0_0</title>
<path fill="none" stroke="black" d="M519,-10729.98C519,-10722.31 519,-10713.36 519,-10704.56"/>
<polygon fill="black" stroke="black" points="522.5,-10704.4 519,-10694.4 515.5,-10704.4 522.5,-10704.4"/>
</g>
<!-- agg_0 -->
<g id="node68" class="node">
<title>agg_0</title>
<polygon fill="lightyellow" stroke="black" points="5077.99,-10595.85 4629.4,-10595.85 4514.01,-10507.85 4962.6,-10507.85 5077.99,-10595.85"/>
<text text-anchor="middle" x="4796" y="-10564.65" font-family="Times,serif" font-size="9.00">Aggregate Experts L0</text>
<text text-anchor="middle" x="4796" y="-10554.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-10544.65" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4796" y="-10534.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_0_0&#45;&gt;agg_0 -->
<g id="edge8" class="edge">
<title>tp_0_0&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M629.79,-10653.41C723.96,-10646.47 862.76,-10637.02 984,-10631.85 2339.83,-10573.92 3968.8,-10558.11 4563.92,-10554.11"/>
<polygon fill="black" stroke="black" points="4564.36,-10557.6 4574.33,-10554.04 4564.31,-10550.6 4564.36,-10557.6"/>
</g>
<!-- expert_0_1_0 -->
<g id="node9" class="node">
<title>expert_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="952.5,-10774.07 675.5,-10774.07 675.5,-10730.07 952.5,-10730.07 952.5,-10774.07"/>
<text text-anchor="middle" x="814" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="814" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 2</text>
<text text-anchor="middle" x="814" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="814" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_0 -->
<g id="edge10" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_0</title>
<path fill="none" stroke="black" d="M1018.08,-10813.34C978.92,-10801.77 933.49,-10788.35 895.44,-10777.12"/>
<polygon fill="black" stroke="black" points="896.01,-10773.64 885.43,-10774.16 894.03,-10780.35 896.01,-10773.64"/>
</g>
<!-- expert_0_1_1 -->
<g id="node10" class="node">
<title>expert_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1247.5,-10774.07 970.5,-10774.07 970.5,-10730.07 1247.5,-10730.07 1247.5,-10774.07"/>
<text text-anchor="middle" x="1109" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1109" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 3</text>
<text text-anchor="middle" x="1109" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1109" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_1&#45;&gt;expert_0_1_1 -->
<g id="edge11" class="edge">
<title>route_0_1&#45;&gt;expert_0_1_1</title>
<path fill="none" stroke="black" d="M1109,-10809.72C1109,-10801.44 1109,-10792.46 1109,-10784.15"/>
<polygon fill="black" stroke="black" points="1112.5,-10784.07 1109,-10774.07 1105.5,-10784.07 1112.5,-10784.07"/>
</g>
<!-- tp_0_1 -->
<g id="node11" class="node">
<title>tp_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="1109" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1109" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1109" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 2↔3</text>
<text text-anchor="middle" x="1109" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1109" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_1_0&#45;&gt;tp_0_1 -->
<g id="edge12" class="edge">
<title>expert_0_1_0&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M885.41,-10729.98C926.87,-10717.74 979.36,-10702.24 1023.07,-10689.33"/>
<polygon fill="black" stroke="black" points="1024.23,-10692.64 1032.83,-10686.45 1022.25,-10685.93 1024.23,-10692.64"/>
</g>
<!-- expert_0_1_1&#45;&gt;tp_0_1 -->
<g id="edge13" class="edge">
<title>expert_0_1_1&#45;&gt;tp_0_1</title>
<path fill="none" stroke="black" d="M1109,-10729.98C1109,-10722.31 1109,-10713.36 1109,-10704.56"/>
<polygon fill="black" stroke="black" points="1112.5,-10704.4 1109,-10694.4 1105.5,-10704.4 1112.5,-10704.4"/>
</g>
<!-- tp_0_1&#45;&gt;agg_0 -->
<g id="edge14" class="edge">
<title>tp_0_1&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1219.8,-10653.53C1313.96,-10646.66 1452.77,-10637.25 1574,-10631.85 2694.94,-10581.83 4036.78,-10561.7 4565.63,-10555.32"/>
<polygon fill="black" stroke="black" points="4565.71,-10558.82 4575.67,-10555.2 4565.63,-10551.82 4565.71,-10558.82"/>
</g>
<!-- expert_0_2_0 -->
<g id="node13" class="node">
<title>expert_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1542.5,-10774.07 1265.5,-10774.07 1265.5,-10730.07 1542.5,-10730.07 1542.5,-10774.07"/>
<text text-anchor="middle" x="1404" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1404" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 4</text>
<text text-anchor="middle" x="1404" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1404" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_0 -->
<g id="edge16" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_0</title>
<path fill="none" stroke="black" d="M1608.08,-10813.34C1568.92,-10801.77 1523.49,-10788.35 1485.44,-10777.12"/>
<polygon fill="black" stroke="black" points="1486.01,-10773.64 1475.43,-10774.16 1484.03,-10780.35 1486.01,-10773.64"/>
</g>
<!-- expert_0_2_1 -->
<g id="node14" class="node">
<title>expert_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1837.5,-10774.07 1560.5,-10774.07 1560.5,-10730.07 1837.5,-10730.07 1837.5,-10774.07"/>
<text text-anchor="middle" x="1699" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1699" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 5</text>
<text text-anchor="middle" x="1699" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1699" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_2&#45;&gt;expert_0_2_1 -->
<g id="edge17" class="edge">
<title>route_0_2&#45;&gt;expert_0_2_1</title>
<path fill="none" stroke="black" d="M1699,-10809.72C1699,-10801.44 1699,-10792.46 1699,-10784.15"/>
<polygon fill="black" stroke="black" points="1702.5,-10784.07 1699,-10774.07 1695.5,-10784.07 1702.5,-10784.07"/>
</g>
<!-- tp_0_2 -->
<g id="node15" class="node">
<title>tp_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="1699" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1699" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1699" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 4↔5</text>
<text text-anchor="middle" x="1699" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1699" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_2_0&#45;&gt;tp_0_2 -->
<g id="edge18" class="edge">
<title>expert_0_2_0&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M1475.41,-10729.98C1516.87,-10717.74 1569.36,-10702.24 1613.07,-10689.33"/>
<polygon fill="black" stroke="black" points="1614.23,-10692.64 1622.83,-10686.45 1612.25,-10685.93 1614.23,-10692.64"/>
</g>
<!-- expert_0_2_1&#45;&gt;tp_0_2 -->
<g id="edge19" class="edge">
<title>expert_0_2_1&#45;&gt;tp_0_2</title>
<path fill="none" stroke="black" d="M1699,-10729.98C1699,-10722.31 1699,-10713.36 1699,-10704.56"/>
<polygon fill="black" stroke="black" points="1702.5,-10704.4 1699,-10694.4 1695.5,-10704.4 1702.5,-10704.4"/>
</g>
<!-- tp_0_2&#45;&gt;agg_0 -->
<g id="edge20" class="edge">
<title>tp_0_2&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M1809.8,-10653.7C1903.98,-10646.94 2042.79,-10637.59 2164,-10631.85 3052.74,-10589.74 4111.42,-10566 4567.95,-10557.03"/>
<polygon fill="black" stroke="black" points="4568.03,-10560.53 4577.96,-10556.83 4567.89,-10553.53 4568.03,-10560.53"/>
</g>
<!-- expert_0_3_0 -->
<g id="node17" class="node">
<title>expert_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2132.5,-10774.07 1855.5,-10774.07 1855.5,-10730.07 2132.5,-10730.07 2132.5,-10774.07"/>
<text text-anchor="middle" x="1994" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1994" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 6</text>
<text text-anchor="middle" x="1994" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1994" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_0 -->
<g id="edge22" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_0</title>
<path fill="none" stroke="black" d="M2198.08,-10813.34C2158.92,-10801.77 2113.49,-10788.35 2075.44,-10777.12"/>
<polygon fill="black" stroke="black" points="2076.01,-10773.64 2065.43,-10774.16 2074.03,-10780.35 2076.01,-10773.64"/>
</g>
<!-- expert_0_3_1 -->
<g id="node18" class="node">
<title>expert_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2427.5,-10774.07 2150.5,-10774.07 2150.5,-10730.07 2427.5,-10730.07 2427.5,-10774.07"/>
<text text-anchor="middle" x="2289" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2289" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 7</text>
<text text-anchor="middle" x="2289" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2289" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_3&#45;&gt;expert_0_3_1 -->
<g id="edge23" class="edge">
<title>route_0_3&#45;&gt;expert_0_3_1</title>
<path fill="none" stroke="black" d="M2289,-10809.72C2289,-10801.44 2289,-10792.46 2289,-10784.15"/>
<polygon fill="black" stroke="black" points="2292.5,-10784.07 2289,-10774.07 2285.5,-10784.07 2292.5,-10784.07"/>
</g>
<!-- tp_0_3 -->
<g id="node19" class="node">
<title>tp_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="2289" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2289" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2289" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 6↔7</text>
<text text-anchor="middle" x="2289" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2289" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_3_0&#45;&gt;tp_0_3 -->
<g id="edge24" class="edge">
<title>expert_0_3_0&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M2065.41,-10729.98C2106.87,-10717.74 2159.36,-10702.24 2203.07,-10689.33"/>
<polygon fill="black" stroke="black" points="2204.23,-10692.64 2212.83,-10686.45 2202.25,-10685.93 2204.23,-10692.64"/>
</g>
<!-- expert_0_3_1&#45;&gt;tp_0_3 -->
<g id="edge25" class="edge">
<title>expert_0_3_1&#45;&gt;tp_0_3</title>
<path fill="none" stroke="black" d="M2289,-10729.98C2289,-10722.31 2289,-10713.36 2289,-10704.56"/>
<polygon fill="black" stroke="black" points="2292.5,-10704.4 2289,-10694.4 2285.5,-10704.4 2292.5,-10704.4"/>
</g>
<!-- tp_0_3&#45;&gt;agg_0 -->
<g id="edge26" class="edge">
<title>tp_0_3&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2400.29,-10653.94C2494.46,-10647.34 2633.02,-10638.1 2754,-10631.85 3414.08,-10597.71 4194.88,-10571.42 4571.12,-10559.63"/>
<polygon fill="black" stroke="black" points="4571.42,-10563.13 4581.3,-10559.31 4571.2,-10556.13 4571.42,-10563.13"/>
</g>
<!-- expert_0_4_0 -->
<g id="node21" class="node">
<title>expert_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2722.5,-10774.07 2445.5,-10774.07 2445.5,-10730.07 2722.5,-10730.07 2722.5,-10774.07"/>
<text text-anchor="middle" x="2584" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2584" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 8</text>
<text text-anchor="middle" x="2584" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2584" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_0 -->
<g id="edge28" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_0</title>
<path fill="none" stroke="black" d="M2788.08,-10813.34C2748.92,-10801.77 2703.49,-10788.35 2665.44,-10777.12"/>
<polygon fill="black" stroke="black" points="2666.01,-10773.64 2655.43,-10774.16 2664.03,-10780.35 2666.01,-10773.64"/>
</g>
<!-- expert_0_4_1 -->
<g id="node22" class="node">
<title>expert_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3017.5,-10774.07 2740.5,-10774.07 2740.5,-10730.07 3017.5,-10730.07 3017.5,-10774.07"/>
<text text-anchor="middle" x="2879" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2879" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 9</text>
<text text-anchor="middle" x="2879" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2879" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_4&#45;&gt;expert_0_4_1 -->
<g id="edge29" class="edge">
<title>route_0_4&#45;&gt;expert_0_4_1</title>
<path fill="none" stroke="black" d="M2879,-10809.72C2879,-10801.44 2879,-10792.46 2879,-10784.15"/>
<polygon fill="black" stroke="black" points="2882.5,-10784.07 2879,-10774.07 2875.5,-10784.07 2882.5,-10784.07"/>
</g>
<!-- tp_0_4 -->
<g id="node23" class="node">
<title>tp_0_4</title>
<ellipse fill="lightblue" stroke="black" cx="2879" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2879" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2879" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 8↔9</text>
<text text-anchor="middle" x="2879" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2879" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_4_0&#45;&gt;tp_0_4 -->
<g id="edge30" class="edge">
<title>expert_0_4_0&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M2655.41,-10729.98C2696.87,-10717.74 2749.36,-10702.24 2793.07,-10689.33"/>
<polygon fill="black" stroke="black" points="2794.23,-10692.64 2802.83,-10686.45 2792.25,-10685.93 2794.23,-10692.64"/>
</g>
<!-- expert_0_4_1&#45;&gt;tp_0_4 -->
<g id="edge31" class="edge">
<title>expert_0_4_1&#45;&gt;tp_0_4</title>
<path fill="none" stroke="black" d="M2879,-10729.98C2879,-10722.31 2879,-10713.36 2879,-10704.56"/>
<polygon fill="black" stroke="black" points="2882.5,-10704.4 2879,-10694.4 2875.5,-10704.4 2882.5,-10704.4"/>
</g>
<!-- tp_0_4&#45;&gt;agg_0 -->
<g id="edge32" class="edge">
<title>tp_0_4&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M2990.79,-10654.39C3084.97,-10648.1 3223.27,-10639.04 3344,-10631.85 3781.09,-10605.8 4292.42,-10578.79 4576.75,-10564.07"/>
<polygon fill="black" stroke="black" points="4576.96,-10567.56 4586.77,-10563.55 4576.6,-10560.57 4576.96,-10567.56"/>
</g>
<!-- expert_0_5_0 -->
<g id="node25" class="node">
<title>expert_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3312.5,-10774.07 3035.5,-10774.07 3035.5,-10730.07 3312.5,-10730.07 3312.5,-10774.07"/>
<text text-anchor="middle" x="3174" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3174" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 10</text>
<text text-anchor="middle" x="3174" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3174" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_0 -->
<g id="edge34" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_0</title>
<path fill="none" stroke="black" d="M3378.08,-10813.34C3338.92,-10801.77 3293.49,-10788.35 3255.44,-10777.12"/>
<polygon fill="black" stroke="black" points="3256.01,-10773.64 3245.43,-10774.16 3254.03,-10780.35 3256.01,-10773.64"/>
</g>
<!-- expert_0_5_1 -->
<g id="node26" class="node">
<title>expert_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3607.5,-10774.07 3330.5,-10774.07 3330.5,-10730.07 3607.5,-10730.07 3607.5,-10774.07"/>
<text text-anchor="middle" x="3469" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3469" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 11</text>
<text text-anchor="middle" x="3469" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3469" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_5&#45;&gt;expert_0_5_1 -->
<g id="edge35" class="edge">
<title>route_0_5&#45;&gt;expert_0_5_1</title>
<path fill="none" stroke="black" d="M3469,-10809.72C3469,-10801.44 3469,-10792.46 3469,-10784.15"/>
<polygon fill="black" stroke="black" points="3472.5,-10784.07 3469,-10774.07 3465.5,-10784.07 3472.5,-10784.07"/>
</g>
<!-- tp_0_5 -->
<g id="node27" class="node">
<title>tp_0_5</title>
<ellipse fill="lightblue" stroke="black" cx="3469" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3469" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3469" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 10↔11</text>
<text text-anchor="middle" x="3469" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3469" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_5_0&#45;&gt;tp_0_5 -->
<g id="edge36" class="edge">
<title>expert_0_5_0&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M3245.41,-10729.98C3286.87,-10717.74 3339.36,-10702.24 3383.07,-10689.33"/>
<polygon fill="black" stroke="black" points="3384.23,-10692.64 3392.83,-10686.45 3382.25,-10685.93 3384.23,-10692.64"/>
</g>
<!-- expert_0_5_1&#45;&gt;tp_0_5 -->
<g id="edge37" class="edge">
<title>expert_0_5_1&#45;&gt;tp_0_5</title>
<path fill="none" stroke="black" d="M3469,-10729.98C3469,-10722.31 3469,-10713.36 3469,-10704.56"/>
<polygon fill="black" stroke="black" points="3472.5,-10704.4 3469,-10694.4 3465.5,-10704.4 3472.5,-10704.4"/>
</g>
<!-- tp_0_5&#45;&gt;agg_0 -->
<g id="edge38" class="edge">
<title>tp_0_5&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M3579.01,-10652.91C3799.49,-10634.78 4298.79,-10593.73 4584.61,-10570.23"/>
<polygon fill="black" stroke="black" points="4585.01,-10573.71 4594.69,-10569.4 4584.44,-10566.73 4585.01,-10573.71"/>
</g>
<!-- expert_0_6_0 -->
<g id="node29" class="node">
<title>expert_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3902.5,-10774.07 3625.5,-10774.07 3625.5,-10730.07 3902.5,-10730.07 3902.5,-10774.07"/>
<text text-anchor="middle" x="3764" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3764" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 12</text>
<text text-anchor="middle" x="3764" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3764" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_0 -->
<g id="edge40" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_0</title>
<path fill="none" stroke="black" d="M3968.08,-10813.34C3928.92,-10801.77 3883.49,-10788.35 3845.44,-10777.12"/>
<polygon fill="black" stroke="black" points="3846.01,-10773.64 3835.43,-10774.16 3844.03,-10780.35 3846.01,-10773.64"/>
</g>
<!-- expert_0_6_1 -->
<g id="node30" class="node">
<title>expert_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4197.5,-10774.07 3920.5,-10774.07 3920.5,-10730.07 4197.5,-10730.07 4197.5,-10774.07"/>
<text text-anchor="middle" x="4059" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4059" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 13</text>
<text text-anchor="middle" x="4059" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4059" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_6&#45;&gt;expert_0_6_1 -->
<g id="edge41" class="edge">
<title>route_0_6&#45;&gt;expert_0_6_1</title>
<path fill="none" stroke="black" d="M4059,-10809.72C4059,-10801.44 4059,-10792.46 4059,-10784.15"/>
<polygon fill="black" stroke="black" points="4062.5,-10784.07 4059,-10774.07 4055.5,-10784.07 4062.5,-10784.07"/>
</g>
<!-- tp_0_6 -->
<g id="node31" class="node">
<title>tp_0_6</title>
<ellipse fill="lightblue" stroke="black" cx="4059" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4059" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4059" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 12↔13</text>
<text text-anchor="middle" x="4059" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4059" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_6_0&#45;&gt;tp_0_6 -->
<g id="edge42" class="edge">
<title>expert_0_6_0&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M3835.41,-10729.98C3876.87,-10717.74 3929.36,-10702.24 3973.07,-10689.33"/>
<polygon fill="black" stroke="black" points="3974.23,-10692.64 3982.83,-10686.45 3972.25,-10685.93 3974.23,-10692.64"/>
</g>
<!-- expert_0_6_1&#45;&gt;tp_0_6 -->
<g id="edge43" class="edge">
<title>expert_0_6_1&#45;&gt;tp_0_6</title>
<path fill="none" stroke="black" d="M4059,-10729.98C4059,-10722.31 4059,-10713.36 4059,-10704.56"/>
<polygon fill="black" stroke="black" points="4062.5,-10704.4 4059,-10694.4 4055.5,-10704.4 4062.5,-10704.4"/>
</g>
<!-- tp_0_6&#45;&gt;agg_0 -->
<g id="edge44" class="edge">
<title>tp_0_6&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4159.16,-10647.13C4271.68,-10630.47 4457.1,-10603.02 4598.93,-10582.02"/>
<polygon fill="black" stroke="black" points="4599.68,-10585.45 4609.06,-10580.52 4598.66,-10578.52 4599.68,-10585.45"/>
</g>
<!-- expert_0_7_0 -->
<g id="node33" class="node">
<title>expert_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4492.5,-10774.07 4215.5,-10774.07 4215.5,-10730.07 4492.5,-10730.07 4492.5,-10774.07"/>
<text text-anchor="middle" x="4354" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4354" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 14</text>
<text text-anchor="middle" x="4354" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4354" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_0 -->
<g id="edge46" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_0</title>
<path fill="none" stroke="black" d="M4511.64,-10812.26C4482.11,-10801.17 4448.42,-10788.53 4419.8,-10777.78"/>
<polygon fill="black" stroke="black" points="4420.89,-10774.45 4410.29,-10774.21 4418.43,-10781 4420.89,-10774.45"/>
</g>
<!-- expert_0_7_1 -->
<g id="node34" class="node">
<title>expert_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4787.5,-10774.07 4510.5,-10774.07 4510.5,-10730.07 4787.5,-10730.07 4787.5,-10774.07"/>
<text text-anchor="middle" x="4649" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4649" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 15</text>
<text text-anchor="middle" x="4649" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4649" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_7&#45;&gt;expert_0_7_1 -->
<g id="edge47" class="edge">
<title>route_0_7&#45;&gt;expert_0_7_1</title>
<path fill="none" stroke="black" d="M4607.68,-10810.2C4614.15,-10801.25 4621.24,-10791.45 4627.69,-10782.53"/>
<polygon fill="black" stroke="black" points="4630.61,-10784.47 4633.64,-10774.31 4624.94,-10780.36 4630.61,-10784.47"/>
</g>
<!-- tp_0_7 -->
<g id="node35" class="node">
<title>tp_0_7</title>
<ellipse fill="lightblue" stroke="black" cx="4649" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4649" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4649" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 14↔15</text>
<text text-anchor="middle" x="4649" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4649" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_7_0&#45;&gt;tp_0_7 -->
<g id="edge48" class="edge">
<title>expert_0_7_0&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M4425.41,-10729.98C4466.87,-10717.74 4519.36,-10702.24 4563.07,-10689.33"/>
<polygon fill="black" stroke="black" points="4564.23,-10692.64 4572.83,-10686.45 4562.25,-10685.93 4564.23,-10692.64"/>
</g>
<!-- expert_0_7_1&#45;&gt;tp_0_7 -->
<g id="edge49" class="edge">
<title>expert_0_7_1&#45;&gt;tp_0_7</title>
<path fill="none" stroke="black" d="M4649,-10729.98C4649,-10722.31 4649,-10713.36 4649,-10704.56"/>
<polygon fill="black" stroke="black" points="4652.5,-10704.4 4649,-10694.4 4645.5,-10704.4 4652.5,-10704.4"/>
</g>
<!-- tp_0_7&#45;&gt;agg_0 -->
<g id="edge50" class="edge">
<title>tp_0_7&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4687.24,-10633.57C4700.3,-10623.88 4715.31,-10612.74 4729.93,-10601.89"/>
<polygon fill="black" stroke="black" points="4732.05,-10604.67 4737.99,-10595.9 4727.88,-10599.05 4732.05,-10604.67"/>
</g>
<!-- expert_0_8_0 -->
<g id="node37" class="node">
<title>expert_0_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5082.5,-10774.07 4805.5,-10774.07 4805.5,-10730.07 5082.5,-10730.07 5082.5,-10774.07"/>
<text text-anchor="middle" x="4944" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4944" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 16</text>
<text text-anchor="middle" x="4944" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4944" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_0 -->
<g id="edge52" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_0</title>
<path fill="none" stroke="black" d="M4984.66,-10810.2C4978.29,-10801.25 4971.32,-10791.45 4964.97,-10782.53"/>
<polygon fill="black" stroke="black" points="4967.77,-10780.43 4959.12,-10774.31 4962.06,-10784.49 4967.77,-10780.43"/>
</g>
<!-- expert_0_8_1 -->
<g id="node38" class="node">
<title>expert_0_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5377.5,-10774.07 5100.5,-10774.07 5100.5,-10730.07 5377.5,-10730.07 5377.5,-10774.07"/>
<text text-anchor="middle" x="5239" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5239" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 17</text>
<text text-anchor="middle" x="5239" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5239" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_8&#45;&gt;expert_0_8_1 -->
<g id="edge53" class="edge">
<title>route_0_8&#45;&gt;expert_0_8_1</title>
<path fill="none" stroke="black" d="M5080.68,-10812.26C5110.34,-10801.17 5144.17,-10788.53 5172.92,-10777.78"/>
<polygon fill="black" stroke="black" points="5174.32,-10780.99 5182.46,-10774.21 5171.87,-10774.43 5174.32,-10780.99"/>
</g>
<!-- tp_0_8 -->
<g id="node39" class="node">
<title>tp_0_8</title>
<ellipse fill="lightblue" stroke="black" cx="4944" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4944" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4944" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 16↔17</text>
<text text-anchor="middle" x="4944" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4944" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_8_0&#45;&gt;tp_0_8 -->
<g id="edge54" class="edge">
<title>expert_0_8_0&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M4944,-10729.98C4944,-10722.31 4944,-10713.36 4944,-10704.56"/>
<polygon fill="black" stroke="black" points="4947.5,-10704.4 4944,-10694.4 4940.5,-10704.4 4947.5,-10704.4"/>
</g>
<!-- expert_0_8_1&#45;&gt;tp_0_8 -->
<g id="edge55" class="edge">
<title>expert_0_8_1&#45;&gt;tp_0_8</title>
<path fill="none" stroke="black" d="M5167.59,-10729.98C5126.13,-10717.74 5073.64,-10702.24 5029.93,-10689.33"/>
<polygon fill="black" stroke="black" points="5030.75,-10685.93 5020.17,-10686.45 5028.77,-10692.64 5030.75,-10685.93"/>
</g>
<!-- tp_0_8&#45;&gt;agg_0 -->
<g id="edge56" class="edge">
<title>tp_0_8&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M4905.5,-10633.57C4892.35,-10623.88 4877.24,-10612.74 4862.52,-10601.89"/>
<polygon fill="black" stroke="black" points="4864.53,-10599.02 4854.4,-10595.9 4860.37,-10604.65 4864.53,-10599.02"/>
</g>
<!-- expert_0_9_0 -->
<g id="node41" class="node">
<title>expert_0_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5672.5,-10774.07 5395.5,-10774.07 5395.5,-10730.07 5672.5,-10730.07 5672.5,-10774.07"/>
<text text-anchor="middle" x="5534" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5534" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 18</text>
<text text-anchor="middle" x="5534" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5534" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_0 -->
<g id="edge58" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_0</title>
<path fill="none" stroke="black" d="M5534,-10809.72C5534,-10801.44 5534,-10792.46 5534,-10784.15"/>
<polygon fill="black" stroke="black" points="5537.5,-10784.07 5534,-10774.07 5530.5,-10784.07 5537.5,-10784.07"/>
</g>
<!-- expert_0_9_1 -->
<g id="node42" class="node">
<title>expert_0_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5967.5,-10774.07 5690.5,-10774.07 5690.5,-10730.07 5967.5,-10730.07 5967.5,-10774.07"/>
<text text-anchor="middle" x="5829" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5829" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 19</text>
<text text-anchor="middle" x="5829" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5829" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_9&#45;&gt;expert_0_9_1 -->
<g id="edge59" class="edge">
<title>route_0_9&#45;&gt;expert_0_9_1</title>
<path fill="none" stroke="black" d="M5624.92,-10813.34C5664.08,-10801.77 5709.51,-10788.35 5747.56,-10777.12"/>
<polygon fill="black" stroke="black" points="5748.97,-10780.35 5757.57,-10774.16 5746.99,-10773.64 5748.97,-10780.35"/>
</g>
<!-- tp_0_9 -->
<g id="node43" class="node">
<title>tp_0_9</title>
<ellipse fill="lightblue" stroke="black" cx="5534" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5534" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5534" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 18↔19</text>
<text text-anchor="middle" x="5534" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5534" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_9_0&#45;&gt;tp_0_9 -->
<g id="edge60" class="edge">
<title>expert_0_9_0&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M5534,-10729.98C5534,-10722.31 5534,-10713.36 5534,-10704.56"/>
<polygon fill="black" stroke="black" points="5537.5,-10704.4 5534,-10694.4 5530.5,-10704.4 5537.5,-10704.4"/>
</g>
<!-- expert_0_9_1&#45;&gt;tp_0_9 -->
<g id="edge61" class="edge">
<title>expert_0_9_1&#45;&gt;tp_0_9</title>
<path fill="none" stroke="black" d="M5757.59,-10729.98C5716.13,-10717.74 5663.64,-10702.24 5619.93,-10689.33"/>
<polygon fill="black" stroke="black" points="5620.75,-10685.93 5610.17,-10686.45 5618.77,-10692.64 5620.75,-10685.93"/>
</g>
<!-- tp_0_9&#45;&gt;agg_0 -->
<g id="edge62" class="edge">
<title>tp_0_9&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M5433.7,-10647.13C5344.3,-10633.91 5208.93,-10613.9 5085.87,-10595.7"/>
<polygon fill="black" stroke="black" points="5086.31,-10592.23 5075.9,-10594.23 5085.28,-10599.15 5086.31,-10592.23"/>
</g>
<!-- expert_0_10_0 -->
<g id="node45" class="node">
<title>expert_0_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6262.5,-10774.07 5985.5,-10774.07 5985.5,-10730.07 6262.5,-10730.07 6262.5,-10774.07"/>
<text text-anchor="middle" x="6124" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6124" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 20</text>
<text text-anchor="middle" x="6124" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6124" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_0 -->
<g id="edge64" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_0</title>
<path fill="none" stroke="black" d="M6124,-10809.72C6124,-10801.44 6124,-10792.46 6124,-10784.15"/>
<polygon fill="black" stroke="black" points="6127.5,-10784.07 6124,-10774.07 6120.5,-10784.07 6127.5,-10784.07"/>
</g>
<!-- expert_0_10_1 -->
<g id="node46" class="node">
<title>expert_0_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6557.5,-10774.07 6280.5,-10774.07 6280.5,-10730.07 6557.5,-10730.07 6557.5,-10774.07"/>
<text text-anchor="middle" x="6419" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6419" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 21</text>
<text text-anchor="middle" x="6419" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6419" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_10&#45;&gt;expert_0_10_1 -->
<g id="edge65" class="edge">
<title>route_0_10&#45;&gt;expert_0_10_1</title>
<path fill="none" stroke="black" d="M6214.92,-10813.34C6254.08,-10801.77 6299.51,-10788.35 6337.56,-10777.12"/>
<polygon fill="black" stroke="black" points="6338.97,-10780.35 6347.57,-10774.16 6336.99,-10773.64 6338.97,-10780.35"/>
</g>
<!-- tp_0_10 -->
<g id="node47" class="node">
<title>tp_0_10</title>
<ellipse fill="lightblue" stroke="black" cx="6124" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6124" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6124" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 20↔21</text>
<text text-anchor="middle" x="6124" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6124" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_10_0&#45;&gt;tp_0_10 -->
<g id="edge66" class="edge">
<title>expert_0_10_0&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M6124,-10729.98C6124,-10722.31 6124,-10713.36 6124,-10704.56"/>
<polygon fill="black" stroke="black" points="6127.5,-10704.4 6124,-10694.4 6120.5,-10704.4 6127.5,-10704.4"/>
</g>
<!-- expert_0_10_1&#45;&gt;tp_0_10 -->
<g id="edge67" class="edge">
<title>expert_0_10_1&#45;&gt;tp_0_10</title>
<path fill="none" stroke="black" d="M6347.59,-10729.98C6306.13,-10717.74 6253.64,-10702.24 6209.93,-10689.33"/>
<polygon fill="black" stroke="black" points="6210.75,-10685.93 6200.17,-10686.45 6208.77,-10692.64 6210.75,-10685.93"/>
</g>
<!-- tp_0_10&#45;&gt;agg_0 -->
<g id="edge68" class="edge">
<title>tp_0_10&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M6014.19,-10652.94C5806.46,-10635.87 5350.69,-10598.42 5059.33,-10574.48"/>
<polygon fill="black" stroke="black" points="5059.29,-10570.97 5049.03,-10573.64 5058.71,-10577.94 5059.29,-10570.97"/>
</g>
<!-- expert_0_11_0 -->
<g id="node49" class="node">
<title>expert_0_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6852.5,-10774.07 6575.5,-10774.07 6575.5,-10730.07 6852.5,-10730.07 6852.5,-10774.07"/>
<text text-anchor="middle" x="6714" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6714" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 22</text>
<text text-anchor="middle" x="6714" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6714" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_0 -->
<g id="edge70" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_0</title>
<path fill="none" stroke="black" d="M6714,-10809.72C6714,-10801.44 6714,-10792.46 6714,-10784.15"/>
<polygon fill="black" stroke="black" points="6717.5,-10784.07 6714,-10774.07 6710.5,-10784.07 6717.5,-10784.07"/>
</g>
<!-- expert_0_11_1 -->
<g id="node50" class="node">
<title>expert_0_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7147.5,-10774.07 6870.5,-10774.07 6870.5,-10730.07 7147.5,-10730.07 7147.5,-10774.07"/>
<text text-anchor="middle" x="7009" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7009" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 23</text>
<text text-anchor="middle" x="7009" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7009" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_11&#45;&gt;expert_0_11_1 -->
<g id="edge71" class="edge">
<title>route_0_11&#45;&gt;expert_0_11_1</title>
<path fill="none" stroke="black" d="M6804.92,-10813.34C6844.08,-10801.77 6889.51,-10788.35 6927.56,-10777.12"/>
<polygon fill="black" stroke="black" points="6928.97,-10780.35 6937.57,-10774.16 6926.99,-10773.64 6928.97,-10780.35"/>
</g>
<!-- tp_0_11 -->
<g id="node51" class="node">
<title>tp_0_11</title>
<ellipse fill="lightblue" stroke="black" cx="6714" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6714" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6714" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 22↔23</text>
<text text-anchor="middle" x="6714" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6714" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_11_0&#45;&gt;tp_0_11 -->
<g id="edge72" class="edge">
<title>expert_0_11_0&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M6714,-10729.98C6714,-10722.31 6714,-10713.36 6714,-10704.56"/>
<polygon fill="black" stroke="black" points="6717.5,-10704.4 6714,-10694.4 6710.5,-10704.4 6717.5,-10704.4"/>
</g>
<!-- expert_0_11_1&#45;&gt;tp_0_11 -->
<g id="edge73" class="edge">
<title>expert_0_11_1&#45;&gt;tp_0_11</title>
<path fill="none" stroke="black" d="M6937.59,-10729.98C6896.13,-10717.74 6843.64,-10702.24 6799.93,-10689.33"/>
<polygon fill="black" stroke="black" points="6800.75,-10685.93 6790.17,-10686.45 6798.77,-10692.64 6800.75,-10685.93"/>
</g>
<!-- tp_0_11&#45;&gt;agg_0 -->
<g id="edge74" class="edge">
<title>tp_0_11&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M6602.21,-10654.39C6508.03,-10648.1 6369.73,-10639.04 6249,-10631.85 5827.96,-10606.77 5338.09,-10580.8 5048.26,-10565.77"/>
<polygon fill="black" stroke="black" points="5048.2,-10562.26 5038.03,-10565.24 5047.84,-10569.25 5048.2,-10562.26"/>
</g>
<!-- expert_0_12_0 -->
<g id="node53" class="node">
<title>expert_0_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7442.5,-10774.07 7165.5,-10774.07 7165.5,-10730.07 7442.5,-10730.07 7442.5,-10774.07"/>
<text text-anchor="middle" x="7304" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7304" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 24</text>
<text text-anchor="middle" x="7304" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7304" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_0 -->
<g id="edge76" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_0</title>
<path fill="none" stroke="black" d="M7304,-10809.72C7304,-10801.44 7304,-10792.46 7304,-10784.15"/>
<polygon fill="black" stroke="black" points="7307.5,-10784.07 7304,-10774.07 7300.5,-10784.07 7307.5,-10784.07"/>
</g>
<!-- expert_0_12_1 -->
<g id="node54" class="node">
<title>expert_0_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7737.5,-10774.07 7460.5,-10774.07 7460.5,-10730.07 7737.5,-10730.07 7737.5,-10774.07"/>
<text text-anchor="middle" x="7599" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7599" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 25</text>
<text text-anchor="middle" x="7599" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7599" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_12&#45;&gt;expert_0_12_1 -->
<g id="edge77" class="edge">
<title>route_0_12&#45;&gt;expert_0_12_1</title>
<path fill="none" stroke="black" d="M7394.92,-10813.34C7434.08,-10801.77 7479.51,-10788.35 7517.56,-10777.12"/>
<polygon fill="black" stroke="black" points="7518.97,-10780.35 7527.57,-10774.16 7516.99,-10773.64 7518.97,-10780.35"/>
</g>
<!-- tp_0_12 -->
<g id="node55" class="node">
<title>tp_0_12</title>
<ellipse fill="lightblue" stroke="black" cx="7304" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7304" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7304" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 24↔25</text>
<text text-anchor="middle" x="7304" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7304" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_12_0&#45;&gt;tp_0_12 -->
<g id="edge78" class="edge">
<title>expert_0_12_0&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M7304,-10729.98C7304,-10722.31 7304,-10713.36 7304,-10704.56"/>
<polygon fill="black" stroke="black" points="7307.5,-10704.4 7304,-10694.4 7300.5,-10704.4 7307.5,-10704.4"/>
</g>
<!-- expert_0_12_1&#45;&gt;tp_0_12 -->
<g id="edge79" class="edge">
<title>expert_0_12_1&#45;&gt;tp_0_12</title>
<path fill="none" stroke="black" d="M7527.59,-10729.98C7486.13,-10717.74 7433.64,-10702.24 7389.93,-10689.33"/>
<polygon fill="black" stroke="black" points="7390.75,-10685.93 7380.17,-10686.45 7388.77,-10692.64 7390.75,-10685.93"/>
</g>
<!-- tp_0_12&#45;&gt;agg_0 -->
<g id="edge80" class="edge">
<title>tp_0_12&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M7192.71,-10653.93C7098.54,-10647.34 6959.98,-10638.1 6839,-10631.85 6190.3,-10598.3 5425.04,-10572.35 5041.37,-10560.27"/>
<polygon fill="black" stroke="black" points="5041.36,-10556.77 5031.26,-10559.95 5041.14,-10563.77 5041.36,-10556.77"/>
</g>
<!-- expert_0_13_0 -->
<g id="node57" class="node">
<title>expert_0_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8032.5,-10774.07 7755.5,-10774.07 7755.5,-10730.07 8032.5,-10730.07 8032.5,-10774.07"/>
<text text-anchor="middle" x="7894" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7894" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 26</text>
<text text-anchor="middle" x="7894" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7894" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_0 -->
<g id="edge82" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_0</title>
<path fill="none" stroke="black" d="M7894,-10809.72C7894,-10801.44 7894,-10792.46 7894,-10784.15"/>
<polygon fill="black" stroke="black" points="7897.5,-10784.07 7894,-10774.07 7890.5,-10784.07 7897.5,-10784.07"/>
</g>
<!-- expert_0_13_1 -->
<g id="node58" class="node">
<title>expert_0_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8327.5,-10774.07 8050.5,-10774.07 8050.5,-10730.07 8327.5,-10730.07 8327.5,-10774.07"/>
<text text-anchor="middle" x="8189" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8189" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 27</text>
<text text-anchor="middle" x="8189" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8189" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_13&#45;&gt;expert_0_13_1 -->
<g id="edge83" class="edge">
<title>route_0_13&#45;&gt;expert_0_13_1</title>
<path fill="none" stroke="black" d="M7984.92,-10813.34C8024.08,-10801.77 8069.51,-10788.35 8107.56,-10777.12"/>
<polygon fill="black" stroke="black" points="8108.97,-10780.35 8117.57,-10774.16 8106.99,-10773.64 8108.97,-10780.35"/>
</g>
<!-- tp_0_13 -->
<g id="node59" class="node">
<title>tp_0_13</title>
<ellipse fill="lightblue" stroke="black" cx="7894" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7894" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7894" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 26↔27</text>
<text text-anchor="middle" x="7894" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7894" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_13_0&#45;&gt;tp_0_13 -->
<g id="edge84" class="edge">
<title>expert_0_13_0&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M7894,-10729.98C7894,-10722.31 7894,-10713.36 7894,-10704.56"/>
<polygon fill="black" stroke="black" points="7897.5,-10704.4 7894,-10694.4 7890.5,-10704.4 7897.5,-10704.4"/>
</g>
<!-- expert_0_13_1&#45;&gt;tp_0_13 -->
<g id="edge85" class="edge">
<title>expert_0_13_1&#45;&gt;tp_0_13</title>
<path fill="none" stroke="black" d="M8117.59,-10729.98C8076.13,-10717.74 8023.64,-10702.24 7979.93,-10689.33"/>
<polygon fill="black" stroke="black" points="7980.75,-10685.93 7970.17,-10686.45 7978.77,-10692.64 7980.75,-10685.93"/>
</g>
<!-- tp_0_13&#45;&gt;agg_0 -->
<g id="edge86" class="edge">
<title>tp_0_13&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M7783.2,-10653.7C7689.02,-10646.94 7550.21,-10637.59 7429,-10631.85 6548.43,-10590.14 5501.09,-10566.45 5037.4,-10557.29"/>
<polygon fill="black" stroke="black" points="5037.3,-10553.79 5027.24,-10557.09 5037.17,-10560.79 5037.3,-10553.79"/>
</g>
<!-- expert_0_14_0 -->
<g id="node61" class="node">
<title>expert_0_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8622.5,-10774.07 8345.5,-10774.07 8345.5,-10730.07 8622.5,-10730.07 8622.5,-10774.07"/>
<text text-anchor="middle" x="8484" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8484" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 28</text>
<text text-anchor="middle" x="8484" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8484" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_0 -->
<g id="edge88" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_0</title>
<path fill="none" stroke="black" d="M8484,-10809.72C8484,-10801.44 8484,-10792.46 8484,-10784.15"/>
<polygon fill="black" stroke="black" points="8487.5,-10784.07 8484,-10774.07 8480.5,-10784.07 8487.5,-10784.07"/>
</g>
<!-- expert_0_14_1 -->
<g id="node62" class="node">
<title>expert_0_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8917.5,-10774.07 8640.5,-10774.07 8640.5,-10730.07 8917.5,-10730.07 8917.5,-10774.07"/>
<text text-anchor="middle" x="8779" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8779" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 29</text>
<text text-anchor="middle" x="8779" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8779" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_14&#45;&gt;expert_0_14_1 -->
<g id="edge89" class="edge">
<title>route_0_14&#45;&gt;expert_0_14_1</title>
<path fill="none" stroke="black" d="M8574.92,-10813.34C8614.08,-10801.77 8659.51,-10788.35 8697.56,-10777.12"/>
<polygon fill="black" stroke="black" points="8698.97,-10780.35 8707.57,-10774.16 8696.99,-10773.64 8698.97,-10780.35"/>
</g>
<!-- tp_0_14 -->
<g id="node63" class="node">
<title>tp_0_14</title>
<ellipse fill="lightblue" stroke="black" cx="8484" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8484" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8484" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 28↔29</text>
<text text-anchor="middle" x="8484" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8484" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_14_0&#45;&gt;tp_0_14 -->
<g id="edge90" class="edge">
<title>expert_0_14_0&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M8484,-10729.98C8484,-10722.31 8484,-10713.36 8484,-10704.56"/>
<polygon fill="black" stroke="black" points="8487.5,-10704.4 8484,-10694.4 8480.5,-10704.4 8487.5,-10704.4"/>
</g>
<!-- expert_0_14_1&#45;&gt;tp_0_14 -->
<g id="edge91" class="edge">
<title>expert_0_14_1&#45;&gt;tp_0_14</title>
<path fill="none" stroke="black" d="M8707.59,-10729.98C8666.13,-10717.74 8613.64,-10702.24 8569.93,-10689.33"/>
<polygon fill="black" stroke="black" points="8570.75,-10685.93 8560.17,-10686.45 8568.77,-10692.64 8570.75,-10685.93"/>
</g>
<!-- tp_0_14&#45;&gt;agg_0 -->
<g id="edge92" class="edge">
<title>tp_0_14&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M8373.2,-10653.53C8279.04,-10646.66 8140.23,-10637.25 8019,-10631.85 6903.96,-10582.1 5570.42,-10561.92 5035.36,-10555.43"/>
<polygon fill="black" stroke="black" points="5035.25,-10551.92 5025.21,-10555.3 5035.16,-10558.92 5035.25,-10551.92"/>
</g>
<!-- expert_0_15_0 -->
<g id="node65" class="node">
<title>expert_0_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9212.5,-10774.07 8935.5,-10774.07 8935.5,-10730.07 9212.5,-10730.07 9212.5,-10774.07"/>
<text text-anchor="middle" x="9074" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9074" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 30</text>
<text text-anchor="middle" x="9074" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9074" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_0 -->
<g id="edge94" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_0</title>
<path fill="none" stroke="black" d="M9074,-10809.72C9074,-10801.44 9074,-10792.46 9074,-10784.15"/>
<polygon fill="black" stroke="black" points="9077.5,-10784.07 9074,-10774.07 9070.5,-10784.07 9077.5,-10784.07"/>
</g>
<!-- expert_0_15_1 -->
<g id="node66" class="node">
<title>expert_0_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9507.5,-10774.07 9230.5,-10774.07 9230.5,-10730.07 9507.5,-10730.07 9507.5,-10774.07"/>
<text text-anchor="middle" x="9369" y="-10764.87" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9369" y="-10754.87" font-family="Times,serif" font-size="9.00">GPU: 31</text>
<text text-anchor="middle" x="9369" y="-10744.87" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9369" y="-10734.87" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_0_15&#45;&gt;expert_0_15_1 -->
<g id="edge95" class="edge">
<title>route_0_15&#45;&gt;expert_0_15_1</title>
<path fill="none" stroke="black" d="M9164.92,-10813.34C9204.08,-10801.77 9249.51,-10788.35 9287.56,-10777.12"/>
<polygon fill="black" stroke="black" points="9288.97,-10780.35 9297.57,-10774.16 9286.99,-10773.64 9288.97,-10780.35"/>
</g>
<!-- tp_0_15 -->
<g id="node67" class="node">
<title>tp_0_15</title>
<ellipse fill="lightblue" stroke="black" cx="9074" cy="-10662.96" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9074" y="-10675.76" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9074" y="-10665.76" font-family="Times,serif" font-size="9.00">GPU: 30↔31</text>
<text text-anchor="middle" x="9074" y="-10655.76" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9074" y="-10645.76" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_0_15_0&#45;&gt;tp_0_15 -->
<g id="edge96" class="edge">
<title>expert_0_15_0&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M9074,-10729.98C9074,-10722.31 9074,-10713.36 9074,-10704.56"/>
<polygon fill="black" stroke="black" points="9077.5,-10704.4 9074,-10694.4 9070.5,-10704.4 9077.5,-10704.4"/>
</g>
<!-- expert_0_15_1&#45;&gt;tp_0_15 -->
<g id="edge97" class="edge">
<title>expert_0_15_1&#45;&gt;tp_0_15</title>
<path fill="none" stroke="black" d="M9297.59,-10729.98C9256.13,-10717.74 9203.64,-10702.24 9159.93,-10689.33"/>
<polygon fill="black" stroke="black" points="9160.75,-10685.93 9150.17,-10686.45 9158.77,-10692.64 9160.75,-10685.93"/>
</g>
<!-- tp_0_15&#45;&gt;agg_0 -->
<g id="edge98" class="edge">
<title>tp_0_15&#45;&gt;agg_0</title>
<path fill="none" stroke="black" d="M8963.21,-10653.41C8869.04,-10646.47 8730.24,-10637.02 8609,-10631.85 7256.8,-10574.08 5632.99,-10558.2 5033.41,-10554.14"/>
<polygon fill="black" stroke="black" points="5033.38,-10550.64 5023.35,-10554.07 5033.33,-10557.64 5033.38,-10550.64"/>
</g>
<!-- output_0 -->
<g id="node69" class="node">
<title>output_0</title>
<polygon fill="lightgreen" stroke="black" points="4944,-10471.85 4648,-10471.85 4648,-10427.85 4944,-10427.85 4944,-10471.85"/>
<text text-anchor="middle" x="4796" y="-10462.65" font-family="Times,serif" font-size="9.00">Layer 0 Output</text>
<text text-anchor="middle" x="4796" y="-10452.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-10442.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4796" y="-10432.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_0&#45;&gt;output_0 -->
<g id="edge99" class="edge">
<title>agg_0&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M4796,-10507.57C4796,-10498.98 4796,-10490.12 4796,-10482.03"/>
<polygon fill="black" stroke="black" points="4799.5,-10481.93 4796,-10471.93 4792.5,-10481.93 4799.5,-10481.93"/>
</g>
<!-- mha_1 -->
<g id="node70" class="node">
<title>mha_1</title>
<polygon fill="lightgreen" stroke="black" points="4944,-10391.85 4648,-10391.85 4648,-10347.85 4944,-10347.85 4944,-10391.85"/>
<text text-anchor="middle" x="4796" y="-10382.65" font-family="Times,serif" font-size="9.00">MHA L1</text>
<text text-anchor="middle" x="4796" y="-10372.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-10362.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4796" y="-10352.65" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_0&#45;&gt;mha_1 -->
<g id="edge100" class="edge">
<title>output_0&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M4796,-10427.53C4796,-10419.64 4796,-10410.53 4796,-10401.95"/>
<polygon fill="black" stroke="black" points="4799.5,-10401.86 4796,-10391.86 4792.5,-10401.86 4799.5,-10401.86"/>
</g>
<!-- gate_1 -->
<g id="node71" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="5095.74,-10311.85 4618.92,-10311.85 4496.26,-10223.85 4973.08,-10223.85 5095.74,-10311.85"/>
<text text-anchor="middle" x="4796" y="-10280.65" font-family="Times,serif" font-size="9.00">Gate L1</text>
<text text-anchor="middle" x="4796" y="-10270.65" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4796" y="-10260.65" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4796" y="-10250.65" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_1&#45;&gt;gate_1 -->
<g id="edge101" class="edge">
<title>mha_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M4796,-10347.64C4796,-10340.14 4796,-10331.33 4796,-10322.37"/>
<polygon fill="black" stroke="black" points="4799.5,-10322.25 4796,-10312.25 4792.5,-10322.25 4799.5,-10322.25"/>
</g>
<!-- route_1_0 -->
<g id="node72" class="node">
<title>route_1_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="519" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="519" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="519" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 32,33</text>
<text text-anchor="middle" x="519" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="519" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_0 -->
<g id="edge102" class="edge">
<title>gate_1&#45;&gt;route_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4556.09,-10266.89C3945.43,-10265.92 2282.63,-10256.63 899,-10187.85 833.75,-10184.6 762.32,-10179.38 699.17,-10174.19"/>
<polygon fill="black" stroke="black" points="699.36,-10170.7 689.11,-10173.36 698.79,-10177.67 699.36,-10170.7"/>
</g>
<!-- route_1_1 -->
<g id="node76" class="node">
<title>route_1_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1109" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1109" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1109" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 34,35</text>
<text text-anchor="middle" x="1109" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1109" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_1 -->
<g id="edge108" class="edge">
<title>gate_1&#45;&gt;route_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4554.4,-10265.64C4007.99,-10261.91 2635.53,-10246.92 1489,-10187.85 1423.91,-10184.49 1352.67,-10179.26 1289.63,-10174.1"/>
<polygon fill="black" stroke="black" points="1289.84,-10170.6 1279.59,-10173.27 1289.27,-10177.58 1289.84,-10170.6"/>
</g>
<!-- route_1_2 -->
<g id="node80" class="node">
<title>route_1_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1699" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1699" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1699" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 36,37</text>
<text text-anchor="middle" x="1699" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1699" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_2 -->
<g id="edge114" class="edge">
<title>gate_1&#45;&gt;route_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4551.82,-10263.84C4075.8,-10257.06 2990.5,-10237.18 2079,-10187.85 2014.08,-10184.33 1943.02,-10179.08 1880.1,-10173.94"/>
<polygon fill="black" stroke="black" points="1880.32,-10170.45 1870.07,-10173.12 1879.75,-10177.42 1880.32,-10170.45"/>
</g>
<!-- route_1_3 -->
<g id="node84" class="node">
<title>route_1_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2289" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2289" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2289" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 38,39</text>
<text text-anchor="middle" x="2289" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2289" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_3 -->
<g id="edge120" class="edge">
<title>gate_1&#45;&gt;route_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4547.78,-10261C4150.71,-10250.9 3348.24,-10227.35 2669,-10187.85 2604.41,-10184.09 2533.73,-10178.81 2471.03,-10173.72"/>
<polygon fill="black" stroke="black" points="2471.29,-10170.23 2461.04,-10172.9 2470.72,-10177.2 2471.29,-10170.23"/>
</g>
<!-- route_1_4 -->
<g id="node88" class="node">
<title>route_1_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2879" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2879" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2879" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 40,41</text>
<text text-anchor="middle" x="2879" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2879" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_4 -->
<g id="edge126" class="edge">
<title>gate_1&#45;&gt;route_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4540.91,-10255.9C4235.88,-10242.31 3709.93,-10217.29 3259,-10187.85 3195.04,-10183.67 3125.08,-10178.34 3062.82,-10173.33"/>
<polygon fill="black" stroke="black" points="3062.74,-10169.81 3052.49,-10172.5 3062.18,-10176.79 3062.74,-10169.81"/>
</g>
<!-- route_1_5 -->
<g id="node92" class="node">
<title>route_1_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3469" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3469" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3469" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 42,43</text>
<text text-anchor="middle" x="3469" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3469" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_5 -->
<g id="edge132" class="edge">
<title>gate_1&#45;&gt;route_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4525.06,-10244.57C4265.32,-10223.21 3880.23,-10191.55 3653.92,-10172.94"/>
<polygon fill="black" stroke="black" points="3654.18,-10169.45 3643.93,-10172.12 3653.61,-10176.42 3654.18,-10169.45"/>
</g>
<!-- route_1_6 -->
<g id="node96" class="node">
<title>route_1_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4059" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4059" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4059" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 44,45</text>
<text text-anchor="middle" x="4059" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4059" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_6 -->
<g id="edge138" class="edge">
<title>gate_1&#45;&gt;route_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4505.51,-10223.84C4404.8,-10208.93 4295.94,-10192.81 4210.92,-10180.22"/>
<polygon fill="black" stroke="black" points="4211.34,-10176.75 4200.93,-10178.75 4210.31,-10183.67 4211.34,-10176.75"/>
</g>
<!-- route_1_7 -->
<g id="node100" class="node">
<title>route_1_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4586" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4586" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4586" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 46,47</text>
<text text-anchor="middle" x="4586" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4586" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_7 -->
<g id="edge144" class="edge">
<title>gate_1&#45;&gt;route_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4713,-10223.72C4692.22,-10212.92 4670.24,-10201.5 4650.51,-10191.25"/>
<polygon fill="black" stroke="black" points="4652.1,-10188.14 4641.62,-10186.63 4648.88,-10194.35 4652.1,-10188.14"/>
</g>
<!-- route_1_8 -->
<g id="node104" class="node">
<title>route_1_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5006" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5006" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5006" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 48,49</text>
<text text-anchor="middle" x="5006" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5006" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_8 -->
<g id="edge150" class="edge">
<title>gate_1&#45;&gt;route_1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4879,-10223.72C4899.78,-10212.92 4921.76,-10201.5 4941.49,-10191.25"/>
<polygon fill="black" stroke="black" points="4943.12,-10194.35 4950.38,-10186.63 4939.9,-10188.14 4943.12,-10194.35"/>
</g>
<!-- route_1_9 -->
<g id="node108" class="node">
<title>route_1_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5534" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5534" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5534" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 50,51</text>
<text text-anchor="middle" x="5534" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5534" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_9 -->
<g id="edge156" class="edge">
<title>gate_1&#45;&gt;route_1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4992.8,-10237.75C5114.76,-10219.72 5269.08,-10196.9 5381.69,-10180.25"/>
<polygon fill="black" stroke="black" points="5382.39,-10183.69 5391.77,-10178.76 5381.37,-10176.76 5382.39,-10183.69"/>
</g>
<!-- route_1_10 -->
<g id="node112" class="node">
<title>route_1_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6124" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6124" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6124" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 52,53</text>
<text text-anchor="middle" x="6124" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6124" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_10 -->
<g id="edge162" class="edge">
<title>gate_1&#45;&gt;route_1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5009,-10249.34C5266.37,-10228.2 5695.14,-10192.97 5939.18,-10172.92"/>
<polygon fill="black" stroke="black" points="5939.54,-10176.4 5949.22,-10172.09 5938.96,-10169.42 5939.54,-10176.4"/>
</g>
<!-- route_1_11 -->
<g id="node116" class="node">
<title>route_1_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6714" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6714" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6714" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 54,55</text>
<text text-anchor="middle" x="6714" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6714" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_11 -->
<g id="edge168" class="edge">
<title>gate_1&#45;&gt;route_1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5019.94,-10257.29C5319.44,-10244.07 5866.94,-10218.34 6334,-10187.85 6397.96,-10183.67 6467.92,-10178.34 6530.18,-10173.33"/>
<polygon fill="black" stroke="black" points="6530.82,-10176.79 6540.51,-10172.5 6530.26,-10169.82 6530.82,-10176.79"/>
</g>
<!-- route_1_12 -->
<g id="node120" class="node">
<title>route_1_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7304" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7304" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7304" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 56,57</text>
<text text-anchor="middle" x="7304" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7304" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_12 -->
<g id="edge174" class="edge">
<title>gate_1&#45;&gt;route_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025.64,-10261.48C5415.94,-10251.65 6233.6,-10228 6924,-10187.85 6988.59,-10184.09 7059.27,-10178.81 7121.97,-10173.72"/>
<polygon fill="black" stroke="black" points="7122.28,-10177.2 7131.96,-10172.9 7121.71,-10170.23 7122.28,-10177.2"/>
</g>
<!-- route_1_13 -->
<g id="node124" class="node">
<title>route_1_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7894" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7894" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7894" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 58,59</text>
<text text-anchor="middle" x="7894" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7894" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_13 -->
<g id="edge180" class="edge">
<title>gate_1&#45;&gt;route_1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5029.3,-10263.99C5499.62,-10257.38 6595.09,-10237.58 7514,-10187.85 7578.92,-10184.33 7649.98,-10179.08 7712.9,-10173.94"/>
<polygon fill="black" stroke="black" points="7713.25,-10177.42 7722.93,-10173.12 7712.68,-10170.45 7713.25,-10177.42"/>
</g>
<!-- route_1_14 -->
<g id="node128" class="node">
<title>route_1_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8484" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8484" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8484" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 60,61</text>
<text text-anchor="middle" x="8484" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8484" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_14 -->
<g id="edge186" class="edge">
<title>gate_1&#45;&gt;route_1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5031.56,-10265.68C5573.95,-10262.03 6952.82,-10247.16 8104,-10187.85 8169.09,-10184.49 8240.33,-10179.26 8303.37,-10174.1"/>
<polygon fill="black" stroke="black" points="8303.73,-10177.58 8313.41,-10173.27 8303.16,-10170.6 8303.73,-10177.58"/>
</g>
<!-- route_1_15 -->
<g id="node132" class="node">
<title>route_1_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9074" cy="-10156.73" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9074" y="-10169.53" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9074" y="-10159.53" font-family="Times,serif" font-size="9.00">GPU: 62,63</text>
<text text-anchor="middle" x="9074" y="-10149.53" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9074" y="-10139.53" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_1&#45;&gt;route_1_15 -->
<g id="edge192" class="edge">
<title>gate_1&#45;&gt;route_1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5033.19,-10266.89C5641.71,-10265.96 7307.91,-10256.75 8694,-10187.85 8759.25,-10184.6 8830.68,-10179.38 8893.83,-10174.19"/>
<polygon fill="black" stroke="black" points="8894.21,-10177.67 8903.89,-10173.36 8893.64,-10170.7 8894.21,-10177.67"/>
</g>
<!-- expert_1_0_0 -->
<g id="node73" class="node">
<title>expert_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="362.5,-10089.62 85.5,-10089.62 85.5,-10045.62 362.5,-10045.62 362.5,-10089.62"/>
<text text-anchor="middle" x="224" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="224" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 32</text>
<text text-anchor="middle" x="224" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="224" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_0&#45;&gt;expert_1_0_0 -->
<g id="edge103" class="edge">
<title>route_1_0&#45;&gt;expert_1_0_0</title>
<path fill="none" stroke="black" d="M428.08,-10128.88C388.92,-10117.32 343.49,-10103.9 305.44,-10092.67"/>
<polygon fill="black" stroke="black" points="306.01,-10089.19 295.43,-10089.71 304.03,-10095.9 306.01,-10089.19"/>
</g>
<!-- expert_1_0_1 -->
<g id="node74" class="node">
<title>expert_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="657.5,-10089.62 380.5,-10089.62 380.5,-10045.62 657.5,-10045.62 657.5,-10089.62"/>
<text text-anchor="middle" x="519" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="519" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 33</text>
<text text-anchor="middle" x="519" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="519" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_0&#45;&gt;expert_1_0_1 -->
<g id="edge104" class="edge">
<title>route_1_0&#45;&gt;expert_1_0_1</title>
<path fill="none" stroke="black" d="M519,-10125.26C519,-10116.99 519,-10108.01 519,-10099.7"/>
<polygon fill="black" stroke="black" points="522.5,-10099.62 519,-10089.62 515.5,-10099.62 522.5,-10099.62"/>
</g>
<!-- tp_1_0 -->
<g id="node75" class="node">
<title>tp_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="519" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="519" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="519" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 32↔33</text>
<text text-anchor="middle" x="519" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="519" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_0_0&#45;&gt;tp_1_0 -->
<g id="edge105" class="edge">
<title>expert_1_0_0&#45;&gt;tp_1_0</title>
<path fill="none" stroke="black" d="M295.41,-10045.53C336.87,-10033.29 389.36,-10017.79 433.07,-10004.88"/>
<polygon fill="black" stroke="black" points="434.23,-10008.19 442.83,-10002 432.25,-10001.48 434.23,-10008.19"/>
</g>
<!-- expert_1_0_1&#45;&gt;tp_1_0 -->
<g id="edge106" class="edge">
<title>expert_1_0_1&#45;&gt;tp_1_0</title>
<path fill="none" stroke="black" d="M519,-10045.53C519,-10037.86 519,-10028.91 519,-10020.11"/>
<polygon fill="black" stroke="black" points="522.5,-10019.95 519,-10009.95 515.5,-10019.95 522.5,-10019.95"/>
</g>
<!-- agg_1 -->
<g id="node136" class="node">
<title>agg_1</title>
<polygon fill="lightyellow" stroke="black" points="4980.99,-9911.39 4532.4,-9911.39 4417.01,-9823.39 4865.6,-9823.39 4980.99,-9911.39"/>
<text text-anchor="middle" x="4699" y="-9880.19" font-family="Times,serif" font-size="9.00">Aggregate Experts L1</text>
<text text-anchor="middle" x="4699" y="-9870.19" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4699" y="-9860.19" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4699" y="-9850.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_1_0&#45;&gt;agg_1 -->
<g id="edge107" class="edge">
<title>tp_1_0&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M629.79,-9968.98C723.96,-9962.05 862.76,-9952.61 984,-9947.39 2301.32,-9890.76 3883.23,-9874.2 4467.52,-9869.83"/>
<polygon fill="black" stroke="black" points="4467.78,-9873.33 4477.75,-9869.75 4467.73,-9866.33 4467.78,-9873.33"/>
</g>
<!-- expert_1_1_0 -->
<g id="node77" class="node">
<title>expert_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="952.5,-10089.62 675.5,-10089.62 675.5,-10045.62 952.5,-10045.62 952.5,-10089.62"/>
<text text-anchor="middle" x="814" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="814" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 34</text>
<text text-anchor="middle" x="814" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="814" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_1&#45;&gt;expert_1_1_0 -->
<g id="edge109" class="edge">
<title>route_1_1&#45;&gt;expert_1_1_0</title>
<path fill="none" stroke="black" d="M1018.08,-10128.88C978.92,-10117.32 933.49,-10103.9 895.44,-10092.67"/>
<polygon fill="black" stroke="black" points="896.01,-10089.19 885.43,-10089.71 894.03,-10095.9 896.01,-10089.19"/>
</g>
<!-- expert_1_1_1 -->
<g id="node78" class="node">
<title>expert_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1247.5,-10089.62 970.5,-10089.62 970.5,-10045.62 1247.5,-10045.62 1247.5,-10089.62"/>
<text text-anchor="middle" x="1109" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1109" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 35</text>
<text text-anchor="middle" x="1109" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1109" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_1&#45;&gt;expert_1_1_1 -->
<g id="edge110" class="edge">
<title>route_1_1&#45;&gt;expert_1_1_1</title>
<path fill="none" stroke="black" d="M1109,-10125.26C1109,-10116.99 1109,-10108.01 1109,-10099.7"/>
<polygon fill="black" stroke="black" points="1112.5,-10099.62 1109,-10089.62 1105.5,-10099.62 1112.5,-10099.62"/>
</g>
<!-- tp_1_1 -->
<g id="node79" class="node">
<title>tp_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="1109" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1109" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1109" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 34↔35</text>
<text text-anchor="middle" x="1109" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1109" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_1_0&#45;&gt;tp_1_1 -->
<g id="edge111" class="edge">
<title>expert_1_1_0&#45;&gt;tp_1_1</title>
<path fill="none" stroke="black" d="M885.41,-10045.53C926.87,-10033.29 979.36,-10017.79 1023.07,-10004.88"/>
<polygon fill="black" stroke="black" points="1024.23,-10008.19 1032.83,-10002 1022.25,-10001.48 1024.23,-10008.19"/>
</g>
<!-- expert_1_1_1&#45;&gt;tp_1_1 -->
<g id="edge112" class="edge">
<title>expert_1_1_1&#45;&gt;tp_1_1</title>
<path fill="none" stroke="black" d="M1109,-10045.53C1109,-10037.86 1109,-10028.91 1109,-10020.11"/>
<polygon fill="black" stroke="black" points="1112.5,-10019.95 1109,-10009.95 1105.5,-10019.95 1112.5,-10019.95"/>
</g>
<!-- tp_1_1&#45;&gt;agg_1 -->
<g id="edge113" class="edge">
<title>tp_1_1&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1219.8,-9969.1C1313.97,-9962.25 1452.78,-9952.85 1574,-9947.39 2656.56,-9898.68 3951.52,-9877.9 4468.95,-9871.11"/>
<polygon fill="black" stroke="black" points="4469.2,-9874.61 4479.15,-9870.98 4469.11,-9867.61 4469.2,-9874.61"/>
</g>
<!-- expert_1_2_0 -->
<g id="node81" class="node">
<title>expert_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1542.5,-10089.62 1265.5,-10089.62 1265.5,-10045.62 1542.5,-10045.62 1542.5,-10089.62"/>
<text text-anchor="middle" x="1404" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1404" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 36</text>
<text text-anchor="middle" x="1404" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1404" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_2&#45;&gt;expert_1_2_0 -->
<g id="edge115" class="edge">
<title>route_1_2&#45;&gt;expert_1_2_0</title>
<path fill="none" stroke="black" d="M1608.08,-10128.88C1568.92,-10117.32 1523.49,-10103.9 1485.44,-10092.67"/>
<polygon fill="black" stroke="black" points="1486.01,-10089.19 1475.43,-10089.71 1484.03,-10095.9 1486.01,-10089.19"/>
</g>
<!-- expert_1_2_1 -->
<g id="node82" class="node">
<title>expert_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1837.5,-10089.62 1560.5,-10089.62 1560.5,-10045.62 1837.5,-10045.62 1837.5,-10089.62"/>
<text text-anchor="middle" x="1699" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1699" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 37</text>
<text text-anchor="middle" x="1699" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1699" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_2&#45;&gt;expert_1_2_1 -->
<g id="edge116" class="edge">
<title>route_1_2&#45;&gt;expert_1_2_1</title>
<path fill="none" stroke="black" d="M1699,-10125.26C1699,-10116.99 1699,-10108.01 1699,-10099.7"/>
<polygon fill="black" stroke="black" points="1702.5,-10099.62 1699,-10089.62 1695.5,-10099.62 1702.5,-10099.62"/>
</g>
<!-- tp_1_2 -->
<g id="node83" class="node">
<title>tp_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="1699" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1699" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1699" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 36↔37</text>
<text text-anchor="middle" x="1699" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1699" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_2_0&#45;&gt;tp_1_2 -->
<g id="edge117" class="edge">
<title>expert_1_2_0&#45;&gt;tp_1_2</title>
<path fill="none" stroke="black" d="M1475.41,-10045.53C1516.87,-10033.29 1569.36,-10017.79 1613.07,-10004.88"/>
<polygon fill="black" stroke="black" points="1614.23,-10008.19 1622.83,-10002 1612.25,-10001.48 1614.23,-10008.19"/>
</g>
<!-- expert_1_2_1&#45;&gt;tp_1_2 -->
<g id="edge118" class="edge">
<title>expert_1_2_1&#45;&gt;tp_1_2</title>
<path fill="none" stroke="black" d="M1699,-10045.53C1699,-10037.86 1699,-10028.91 1699,-10020.11"/>
<polygon fill="black" stroke="black" points="1702.5,-10019.95 1699,-10009.95 1695.5,-10019.95 1702.5,-10019.95"/>
</g>
<!-- tp_1_2&#45;&gt;agg_1 -->
<g id="edge119" class="edge">
<title>tp_1_2&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M1809.81,-9969.28C1903.98,-9962.55 2042.79,-9953.21 2164,-9947.39 3014.87,-9906.6 4027.45,-9882.34 4471.4,-9872.93"/>
<polygon fill="black" stroke="black" points="4471.54,-9876.43 4481.46,-9872.72 4471.39,-9869.43 4471.54,-9876.43"/>
</g>
<!-- expert_1_3_0 -->
<g id="node85" class="node">
<title>expert_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2132.5,-10089.62 1855.5,-10089.62 1855.5,-10045.62 2132.5,-10045.62 2132.5,-10089.62"/>
<text text-anchor="middle" x="1994" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1994" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 38</text>
<text text-anchor="middle" x="1994" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1994" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_3&#45;&gt;expert_1_3_0 -->
<g id="edge121" class="edge">
<title>route_1_3&#45;&gt;expert_1_3_0</title>
<path fill="none" stroke="black" d="M2198.08,-10128.88C2158.92,-10117.32 2113.49,-10103.9 2075.44,-10092.67"/>
<polygon fill="black" stroke="black" points="2076.01,-10089.19 2065.43,-10089.71 2074.03,-10095.9 2076.01,-10089.19"/>
</g>
<!-- expert_1_3_1 -->
<g id="node86" class="node">
<title>expert_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2427.5,-10089.62 2150.5,-10089.62 2150.5,-10045.62 2427.5,-10045.62 2427.5,-10089.62"/>
<text text-anchor="middle" x="2289" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2289" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 39</text>
<text text-anchor="middle" x="2289" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2289" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_3&#45;&gt;expert_1_3_1 -->
<g id="edge122" class="edge">
<title>route_1_3&#45;&gt;expert_1_3_1</title>
<path fill="none" stroke="black" d="M2289,-10125.26C2289,-10116.99 2289,-10108.01 2289,-10099.7"/>
<polygon fill="black" stroke="black" points="2292.5,-10099.62 2289,-10089.62 2285.5,-10099.62 2292.5,-10099.62"/>
</g>
<!-- tp_1_3 -->
<g id="node87" class="node">
<title>tp_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="2289" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2289" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2289" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 38↔39</text>
<text text-anchor="middle" x="2289" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2289" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_3_0&#45;&gt;tp_1_3 -->
<g id="edge123" class="edge">
<title>expert_1_3_0&#45;&gt;tp_1_3</title>
<path fill="none" stroke="black" d="M2065.41,-10045.53C2106.87,-10033.29 2159.36,-10017.79 2203.07,-10004.88"/>
<polygon fill="black" stroke="black" points="2204.23,-10008.19 2212.83,-10002 2202.25,-10001.48 2204.23,-10008.19"/>
</g>
<!-- expert_1_3_1&#45;&gt;tp_1_3 -->
<g id="edge124" class="edge">
<title>expert_1_3_1&#45;&gt;tp_1_3</title>
<path fill="none" stroke="black" d="M2289,-10045.53C2289,-10037.86 2289,-10028.91 2289,-10020.11"/>
<polygon fill="black" stroke="black" points="2292.5,-10019.95 2289,-10009.95 2285.5,-10019.95 2292.5,-10019.95"/>
</g>
<!-- tp_1_3&#45;&gt;agg_1 -->
<g id="edge125" class="edge">
<title>tp_1_3&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2400.29,-9969.54C2494.47,-9962.99 2633.02,-9953.77 2754,-9947.39 3376.94,-9914.58 4112.74,-9888.01 4474.79,-9875.75"/>
<polygon fill="black" stroke="black" points="4474.99,-9879.24 4484.86,-9875.41 4474.75,-9872.25 4474.99,-9879.24"/>
</g>
<!-- expert_1_4_0 -->
<g id="node89" class="node">
<title>expert_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2722.5,-10089.62 2445.5,-10089.62 2445.5,-10045.62 2722.5,-10045.62 2722.5,-10089.62"/>
<text text-anchor="middle" x="2584" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2584" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 40</text>
<text text-anchor="middle" x="2584" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2584" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_4&#45;&gt;expert_1_4_0 -->
<g id="edge127" class="edge">
<title>route_1_4&#45;&gt;expert_1_4_0</title>
<path fill="none" stroke="black" d="M2788.08,-10128.88C2748.92,-10117.32 2703.49,-10103.9 2665.44,-10092.67"/>
<polygon fill="black" stroke="black" points="2666.01,-10089.19 2655.43,-10089.71 2664.03,-10095.9 2666.01,-10089.19"/>
</g>
<!-- expert_1_4_1 -->
<g id="node90" class="node">
<title>expert_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3017.5,-10089.62 2740.5,-10089.62 2740.5,-10045.62 3017.5,-10045.62 3017.5,-10089.62"/>
<text text-anchor="middle" x="2879" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2879" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 41</text>
<text text-anchor="middle" x="2879" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2879" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_4&#45;&gt;expert_1_4_1 -->
<g id="edge128" class="edge">
<title>route_1_4&#45;&gt;expert_1_4_1</title>
<path fill="none" stroke="black" d="M2879,-10125.26C2879,-10116.99 2879,-10108.01 2879,-10099.7"/>
<polygon fill="black" stroke="black" points="2882.5,-10099.62 2879,-10089.62 2875.5,-10099.62 2882.5,-10099.62"/>
</g>
<!-- tp_1_4 -->
<g id="node91" class="node">
<title>tp_1_4</title>
<ellipse fill="lightblue" stroke="black" cx="2879" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2879" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2879" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 40↔41</text>
<text text-anchor="middle" x="2879" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2879" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_4_0&#45;&gt;tp_1_4 -->
<g id="edge129" class="edge">
<title>expert_1_4_0&#45;&gt;tp_1_4</title>
<path fill="none" stroke="black" d="M2655.41,-10045.53C2696.87,-10033.29 2749.36,-10017.79 2793.07,-10004.88"/>
<polygon fill="black" stroke="black" points="2794.23,-10008.19 2802.83,-10002 2792.25,-10001.48 2794.23,-10008.19"/>
</g>
<!-- expert_1_4_1&#45;&gt;tp_1_4 -->
<g id="edge130" class="edge">
<title>expert_1_4_1&#45;&gt;tp_1_4</title>
<path fill="none" stroke="black" d="M2879,-10045.53C2879,-10037.86 2879,-10028.91 2879,-10020.11"/>
<polygon fill="black" stroke="black" points="2882.5,-10019.95 2879,-10009.95 2875.5,-10019.95 2882.5,-10019.95"/>
</g>
<!-- tp_1_4&#45;&gt;agg_1 -->
<g id="edge131" class="edge">
<title>tp_1_4&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M2990.8,-9970.06C3084.98,-9963.84 3223.29,-9954.82 3344,-9947.39 3745.15,-9922.71 4213.22,-9895.85 4480.99,-9880.67"/>
<polygon fill="black" stroke="black" points="4481.43,-9884.15 4491.22,-9880.09 4481.04,-9877.16 4481.43,-9884.15"/>
</g>
<!-- expert_1_5_0 -->
<g id="node93" class="node">
<title>expert_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3312.5,-10089.62 3035.5,-10089.62 3035.5,-10045.62 3312.5,-10045.62 3312.5,-10089.62"/>
<text text-anchor="middle" x="3174" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3174" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 42</text>
<text text-anchor="middle" x="3174" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3174" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_5&#45;&gt;expert_1_5_0 -->
<g id="edge133" class="edge">
<title>route_1_5&#45;&gt;expert_1_5_0</title>
<path fill="none" stroke="black" d="M3378.08,-10128.88C3338.92,-10117.32 3293.49,-10103.9 3255.44,-10092.67"/>
<polygon fill="black" stroke="black" points="3256.01,-10089.19 3245.43,-10089.71 3254.03,-10095.9 3256.01,-10089.19"/>
</g>
<!-- expert_1_5_1 -->
<g id="node94" class="node">
<title>expert_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3607.5,-10089.62 3330.5,-10089.62 3330.5,-10045.62 3607.5,-10045.62 3607.5,-10089.62"/>
<text text-anchor="middle" x="3469" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3469" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 43</text>
<text text-anchor="middle" x="3469" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3469" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_5&#45;&gt;expert_1_5_1 -->
<g id="edge134" class="edge">
<title>route_1_5&#45;&gt;expert_1_5_1</title>
<path fill="none" stroke="black" d="M3469,-10125.26C3469,-10116.99 3469,-10108.01 3469,-10099.7"/>
<polygon fill="black" stroke="black" points="3472.5,-10099.62 3469,-10089.62 3465.5,-10099.62 3472.5,-10099.62"/>
</g>
<!-- tp_1_5 -->
<g id="node95" class="node">
<title>tp_1_5</title>
<ellipse fill="lightblue" stroke="black" cx="3469" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3469" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3469" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 42↔43</text>
<text text-anchor="middle" x="3469" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3469" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_5_0&#45;&gt;tp_1_5 -->
<g id="edge135" class="edge">
<title>expert_1_5_0&#45;&gt;tp_1_5</title>
<path fill="none" stroke="black" d="M3245.41,-10045.53C3286.87,-10033.29 3339.36,-10017.79 3383.07,-10004.88"/>
<polygon fill="black" stroke="black" points="3384.23,-10008.19 3392.83,-10002 3382.25,-10001.48 3384.23,-10008.19"/>
</g>
<!-- expert_1_5_1&#45;&gt;tp_1_5 -->
<g id="edge136" class="edge">
<title>expert_1_5_1&#45;&gt;tp_1_5</title>
<path fill="none" stroke="black" d="M3469,-10045.53C3469,-10037.86 3469,-10028.91 3469,-10020.11"/>
<polygon fill="black" stroke="black" points="3472.5,-10019.95 3469,-10009.95 3465.5,-10019.95 3472.5,-10019.95"/>
</g>
<!-- tp_1_5&#45;&gt;agg_1 -->
<g id="edge137" class="edge">
<title>tp_1_5&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M3578.15,-9967.82C3782.34,-9949.71 4225.21,-9910.42 4489.02,-9887.02"/>
<polygon fill="black" stroke="black" points="4489.46,-9890.5 4499.11,-9886.13 4488.84,-9883.52 4489.46,-9890.5"/>
</g>
<!-- expert_1_6_0 -->
<g id="node97" class="node">
<title>expert_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3902.5,-10089.62 3625.5,-10089.62 3625.5,-10045.62 3902.5,-10045.62 3902.5,-10089.62"/>
<text text-anchor="middle" x="3764" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3764" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 44</text>
<text text-anchor="middle" x="3764" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3764" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_6&#45;&gt;expert_1_6_0 -->
<g id="edge139" class="edge">
<title>route_1_6&#45;&gt;expert_1_6_0</title>
<path fill="none" stroke="black" d="M3968.08,-10128.88C3928.92,-10117.32 3883.49,-10103.9 3845.44,-10092.67"/>
<polygon fill="black" stroke="black" points="3846.01,-10089.19 3835.43,-10089.71 3844.03,-10095.9 3846.01,-10089.19"/>
</g>
<!-- expert_1_6_1 -->
<g id="node98" class="node">
<title>expert_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4197.5,-10089.62 3920.5,-10089.62 3920.5,-10045.62 4197.5,-10045.62 4197.5,-10089.62"/>
<text text-anchor="middle" x="4059" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4059" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 45</text>
<text text-anchor="middle" x="4059" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4059" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_6&#45;&gt;expert_1_6_1 -->
<g id="edge140" class="edge">
<title>route_1_6&#45;&gt;expert_1_6_1</title>
<path fill="none" stroke="black" d="M4059,-10125.26C4059,-10116.99 4059,-10108.01 4059,-10099.7"/>
<polygon fill="black" stroke="black" points="4062.5,-10099.62 4059,-10089.62 4055.5,-10099.62 4062.5,-10099.62"/>
</g>
<!-- tp_1_6 -->
<g id="node99" class="node">
<title>tp_1_6</title>
<ellipse fill="lightblue" stroke="black" cx="4059" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4059" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4059" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 44↔45</text>
<text text-anchor="middle" x="4059" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4059" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_6_0&#45;&gt;tp_1_6 -->
<g id="edge141" class="edge">
<title>expert_1_6_0&#45;&gt;tp_1_6</title>
<path fill="none" stroke="black" d="M3835.41,-10045.53C3876.87,-10033.29 3929.36,-10017.79 3973.07,-10004.88"/>
<polygon fill="black" stroke="black" points="3974.23,-10008.19 3982.83,-10002 3972.25,-10001.48 3974.23,-10008.19"/>
</g>
<!-- expert_1_6_1&#45;&gt;tp_1_6 -->
<g id="edge142" class="edge">
<title>expert_1_6_1&#45;&gt;tp_1_6</title>
<path fill="none" stroke="black" d="M4059,-10045.53C4059,-10037.86 4059,-10028.91 4059,-10020.11"/>
<polygon fill="black" stroke="black" points="4062.5,-10019.95 4059,-10009.95 4055.5,-10019.95 4062.5,-10019.95"/>
</g>
<!-- tp_1_6&#45;&gt;agg_1 -->
<g id="edge143" class="edge">
<title>tp_1_6&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4155.16,-9961.11C4247.81,-9945.32 4390.62,-9920.97 4506.65,-9901.19"/>
<polygon fill="black" stroke="black" points="4507.45,-9904.6 4516.72,-9899.47 4506.28,-9897.7 4507.45,-9904.6"/>
</g>
<!-- expert_1_7_0 -->
<g id="node101" class="node">
<title>expert_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4492.5,-10089.62 4215.5,-10089.62 4215.5,-10045.62 4492.5,-10045.62 4492.5,-10089.62"/>
<text text-anchor="middle" x="4354" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4354" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 46</text>
<text text-anchor="middle" x="4354" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4354" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_7&#45;&gt;expert_1_7_0 -->
<g id="edge145" class="edge">
<title>route_1_7&#45;&gt;expert_1_7_0</title>
<path fill="none" stroke="black" d="M4511.64,-10127.81C4482.11,-10116.72 4448.42,-10104.07 4419.8,-10093.33"/>
<polygon fill="black" stroke="black" points="4420.89,-10090 4410.29,-10089.76 4418.43,-10096.55 4420.89,-10090"/>
</g>
<!-- expert_1_7_1 -->
<g id="node102" class="node">
<title>expert_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4787.5,-10089.62 4510.5,-10089.62 4510.5,-10045.62 4787.5,-10045.62 4787.5,-10089.62"/>
<text text-anchor="middle" x="4649" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4649" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 47</text>
<text text-anchor="middle" x="4649" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4649" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_7&#45;&gt;expert_1_7_1 -->
<g id="edge146" class="edge">
<title>route_1_7&#45;&gt;expert_1_7_1</title>
<path fill="none" stroke="black" d="M4607.68,-10125.75C4614.15,-10116.8 4621.24,-10107 4627.69,-10098.08"/>
<polygon fill="black" stroke="black" points="4630.61,-10100.01 4633.64,-10089.86 4624.94,-10095.91 4630.61,-10100.01"/>
</g>
<!-- tp_1_7 -->
<g id="node103" class="node">
<title>tp_1_7</title>
<ellipse fill="lightblue" stroke="black" cx="4649" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4649" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4649" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 46↔47</text>
<text text-anchor="middle" x="4649" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4649" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_7_0&#45;&gt;tp_1_7 -->
<g id="edge147" class="edge">
<title>expert_1_7_0&#45;&gt;tp_1_7</title>
<path fill="none" stroke="black" d="M4425.41,-10045.53C4466.87,-10033.29 4519.36,-10017.79 4563.07,-10004.88"/>
<polygon fill="black" stroke="black" points="4564.23,-10008.19 4572.83,-10002 4562.25,-10001.48 4564.23,-10008.19"/>
</g>
<!-- expert_1_7_1&#45;&gt;tp_1_7 -->
<g id="edge148" class="edge">
<title>expert_1_7_1&#45;&gt;tp_1_7</title>
<path fill="none" stroke="black" d="M4649,-10045.53C4649,-10037.86 4649,-10028.91 4649,-10020.11"/>
<polygon fill="black" stroke="black" points="4652.5,-10019.95 4649,-10009.95 4645.5,-10019.95 4652.5,-10019.95"/>
</g>
<!-- tp_1_7&#45;&gt;agg_1 -->
<g id="edge149" class="edge">
<title>tp_1_7&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4662.8,-9947.4C4666.61,-9939.08 4670.87,-9929.79 4675.08,-9920.6"/>
<polygon fill="black" stroke="black" points="4678.28,-9922.02 4679.26,-9911.47 4671.91,-9919.1 4678.28,-9922.02"/>
</g>
<!-- expert_1_8_0 -->
<g id="node105" class="node">
<title>expert_1_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5082.5,-10089.62 4805.5,-10089.62 4805.5,-10045.62 5082.5,-10045.62 5082.5,-10089.62"/>
<text text-anchor="middle" x="4944" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4944" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 48</text>
<text text-anchor="middle" x="4944" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4944" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_8&#45;&gt;expert_1_8_0 -->
<g id="edge151" class="edge">
<title>route_1_8&#45;&gt;expert_1_8_0</title>
<path fill="none" stroke="black" d="M4984.66,-10125.75C4978.29,-10116.8 4971.32,-10107 4964.97,-10098.08"/>
<polygon fill="black" stroke="black" points="4967.77,-10095.98 4959.12,-10089.86 4962.06,-10100.04 4967.77,-10095.98"/>
</g>
<!-- expert_1_8_1 -->
<g id="node106" class="node">
<title>expert_1_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5377.5,-10089.62 5100.5,-10089.62 5100.5,-10045.62 5377.5,-10045.62 5377.5,-10089.62"/>
<text text-anchor="middle" x="5239" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5239" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 49</text>
<text text-anchor="middle" x="5239" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5239" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_8&#45;&gt;expert_1_8_1 -->
<g id="edge152" class="edge">
<title>route_1_8&#45;&gt;expert_1_8_1</title>
<path fill="none" stroke="black" d="M5080.68,-10127.81C5110.34,-10116.72 5144.17,-10104.07 5172.92,-10093.33"/>
<polygon fill="black" stroke="black" points="5174.32,-10096.54 5182.46,-10089.76 5171.87,-10089.98 5174.32,-10096.54"/>
</g>
<!-- tp_1_8 -->
<g id="node107" class="node">
<title>tp_1_8</title>
<ellipse fill="lightblue" stroke="black" cx="4944" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4944" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4944" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 48↔49</text>
<text text-anchor="middle" x="4944" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4944" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_8_0&#45;&gt;tp_1_8 -->
<g id="edge153" class="edge">
<title>expert_1_8_0&#45;&gt;tp_1_8</title>
<path fill="none" stroke="black" d="M4944,-10045.53C4944,-10037.86 4944,-10028.91 4944,-10020.11"/>
<polygon fill="black" stroke="black" points="4947.5,-10019.95 4944,-10009.95 4940.5,-10019.95 4947.5,-10019.95"/>
</g>
<!-- expert_1_8_1&#45;&gt;tp_1_8 -->
<g id="edge154" class="edge">
<title>expert_1_8_1&#45;&gt;tp_1_8</title>
<path fill="none" stroke="black" d="M5167.59,-10045.53C5126.13,-10033.29 5073.64,-10017.79 5029.93,-10004.88"/>
<polygon fill="black" stroke="black" points="5030.75,-10001.48 5020.17,-10002 5028.77,-10008.19 5030.75,-10001.48"/>
</g>
<!-- tp_1_8&#45;&gt;agg_1 -->
<g id="edge155" class="edge">
<title>tp_1_8&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M4885.63,-9951.51C4861.47,-9940.75 4832.67,-9927.93 4805.02,-9915.61"/>
<polygon fill="black" stroke="black" points="4806.25,-9912.33 4795.69,-9911.46 4803.4,-9918.72 4806.25,-9912.33"/>
</g>
<!-- expert_1_9_0 -->
<g id="node109" class="node">
<title>expert_1_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5672.5,-10089.62 5395.5,-10089.62 5395.5,-10045.62 5672.5,-10045.62 5672.5,-10089.62"/>
<text text-anchor="middle" x="5534" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5534" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 50</text>
<text text-anchor="middle" x="5534" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5534" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_9&#45;&gt;expert_1_9_0 -->
<g id="edge157" class="edge">
<title>route_1_9&#45;&gt;expert_1_9_0</title>
<path fill="none" stroke="black" d="M5534,-10125.26C5534,-10116.99 5534,-10108.01 5534,-10099.7"/>
<polygon fill="black" stroke="black" points="5537.5,-10099.62 5534,-10089.62 5530.5,-10099.62 5537.5,-10099.62"/>
</g>
<!-- expert_1_9_1 -->
<g id="node110" class="node">
<title>expert_1_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5967.5,-10089.62 5690.5,-10089.62 5690.5,-10045.62 5967.5,-10045.62 5967.5,-10089.62"/>
<text text-anchor="middle" x="5829" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5829" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 51</text>
<text text-anchor="middle" x="5829" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5829" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_9&#45;&gt;expert_1_9_1 -->
<g id="edge158" class="edge">
<title>route_1_9&#45;&gt;expert_1_9_1</title>
<path fill="none" stroke="black" d="M5624.92,-10128.88C5664.08,-10117.32 5709.51,-10103.9 5747.56,-10092.67"/>
<polygon fill="black" stroke="black" points="5748.97,-10095.9 5757.57,-10089.71 5746.99,-10089.19 5748.97,-10095.9"/>
</g>
<!-- tp_1_9 -->
<g id="node111" class="node">
<title>tp_1_9</title>
<ellipse fill="lightblue" stroke="black" cx="5534" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5534" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5534" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 50↔51</text>
<text text-anchor="middle" x="5534" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5534" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_9_0&#45;&gt;tp_1_9 -->
<g id="edge159" class="edge">
<title>expert_1_9_0&#45;&gt;tp_1_9</title>
<path fill="none" stroke="black" d="M5534,-10045.53C5534,-10037.86 5534,-10028.91 5534,-10020.11"/>
<polygon fill="black" stroke="black" points="5537.5,-10019.95 5534,-10009.95 5530.5,-10019.95 5537.5,-10019.95"/>
</g>
<!-- expert_1_9_1&#45;&gt;tp_1_9 -->
<g id="edge160" class="edge">
<title>expert_1_9_1&#45;&gt;tp_1_9</title>
<path fill="none" stroke="black" d="M5757.59,-10045.53C5716.13,-10033.29 5663.64,-10017.79 5619.93,-10004.88"/>
<polygon fill="black" stroke="black" points="5620.75,-10001.48 5610.17,-10002 5618.77,-10008.19 5620.75,-10001.48"/>
</g>
<!-- tp_1_9&#45;&gt;agg_1 -->
<g id="edge161" class="edge">
<title>tp_1_9&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M5431.19,-9964.07C5319.65,-9949.5 5136.72,-9925.59 4981.62,-9905.32"/>
<polygon fill="black" stroke="black" points="4981.81,-9901.82 4971.44,-9904 4980.9,-9908.76 4981.81,-9901.82"/>
</g>
<!-- expert_1_10_0 -->
<g id="node113" class="node">
<title>expert_1_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6262.5,-10089.62 5985.5,-10089.62 5985.5,-10045.62 6262.5,-10045.62 6262.5,-10089.62"/>
<text text-anchor="middle" x="6124" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6124" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 52</text>
<text text-anchor="middle" x="6124" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6124" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_10&#45;&gt;expert_1_10_0 -->
<g id="edge163" class="edge">
<title>route_1_10&#45;&gt;expert_1_10_0</title>
<path fill="none" stroke="black" d="M6124,-10125.26C6124,-10116.99 6124,-10108.01 6124,-10099.7"/>
<polygon fill="black" stroke="black" points="6127.5,-10099.62 6124,-10089.62 6120.5,-10099.62 6127.5,-10099.62"/>
</g>
<!-- expert_1_10_1 -->
<g id="node114" class="node">
<title>expert_1_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6557.5,-10089.62 6280.5,-10089.62 6280.5,-10045.62 6557.5,-10045.62 6557.5,-10089.62"/>
<text text-anchor="middle" x="6419" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6419" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 53</text>
<text text-anchor="middle" x="6419" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6419" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_10&#45;&gt;expert_1_10_1 -->
<g id="edge164" class="edge">
<title>route_1_10&#45;&gt;expert_1_10_1</title>
<path fill="none" stroke="black" d="M6214.92,-10128.88C6254.08,-10117.32 6299.51,-10103.9 6337.56,-10092.67"/>
<polygon fill="black" stroke="black" points="6338.97,-10095.9 6347.57,-10089.71 6336.99,-10089.19 6338.97,-10095.9"/>
</g>
<!-- tp_1_10 -->
<g id="node115" class="node">
<title>tp_1_10</title>
<ellipse fill="lightblue" stroke="black" cx="6124" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6124" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6124" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 52↔53</text>
<text text-anchor="middle" x="6124" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6124" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_10_0&#45;&gt;tp_1_10 -->
<g id="edge165" class="edge">
<title>expert_1_10_0&#45;&gt;tp_1_10</title>
<path fill="none" stroke="black" d="M6124,-10045.53C6124,-10037.86 6124,-10028.91 6124,-10020.11"/>
<polygon fill="black" stroke="black" points="6127.5,-10019.95 6124,-10009.95 6120.5,-10019.95 6127.5,-10019.95"/>
</g>
<!-- expert_1_10_1&#45;&gt;tp_1_10 -->
<g id="edge166" class="edge">
<title>expert_1_10_1&#45;&gt;tp_1_10</title>
<path fill="none" stroke="black" d="M6347.59,-10045.53C6306.13,-10033.29 6253.64,-10017.79 6209.93,-10004.88"/>
<polygon fill="black" stroke="black" points="6210.75,-10001.48 6200.17,-10002 6208.77,-10008.19 6210.75,-10001.48"/>
</g>
<!-- tp_1_10&#45;&gt;agg_1 -->
<g id="edge167" class="edge">
<title>tp_1_10&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M6013.37,-9969.04C5788.89,-9951.85 5274.6,-9912.47 4960.01,-9888.38"/>
<polygon fill="black" stroke="black" points="4960.07,-9884.87 4949.83,-9887.6 4959.54,-9891.85 4960.07,-9884.87"/>
</g>
<!-- expert_1_11_0 -->
<g id="node117" class="node">
<title>expert_1_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6852.5,-10089.62 6575.5,-10089.62 6575.5,-10045.62 6852.5,-10045.62 6852.5,-10089.62"/>
<text text-anchor="middle" x="6714" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6714" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 54</text>
<text text-anchor="middle" x="6714" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6714" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_11&#45;&gt;expert_1_11_0 -->
<g id="edge169" class="edge">
<title>route_1_11&#45;&gt;expert_1_11_0</title>
<path fill="none" stroke="black" d="M6714,-10125.26C6714,-10116.99 6714,-10108.01 6714,-10099.7"/>
<polygon fill="black" stroke="black" points="6717.5,-10099.62 6714,-10089.62 6710.5,-10099.62 6717.5,-10099.62"/>
</g>
<!-- expert_1_11_1 -->
<g id="node118" class="node">
<title>expert_1_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7147.5,-10089.62 6870.5,-10089.62 6870.5,-10045.62 7147.5,-10045.62 7147.5,-10089.62"/>
<text text-anchor="middle" x="7009" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7009" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 55</text>
<text text-anchor="middle" x="7009" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7009" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_11&#45;&gt;expert_1_11_1 -->
<g id="edge170" class="edge">
<title>route_1_11&#45;&gt;expert_1_11_1</title>
<path fill="none" stroke="black" d="M6804.92,-10128.88C6844.08,-10117.32 6889.51,-10103.9 6927.56,-10092.67"/>
<polygon fill="black" stroke="black" points="6928.97,-10095.9 6937.57,-10089.71 6926.99,-10089.19 6928.97,-10095.9"/>
</g>
<!-- tp_1_11 -->
<g id="node119" class="node">
<title>tp_1_11</title>
<ellipse fill="lightblue" stroke="black" cx="6714" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6714" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6714" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 54↔55</text>
<text text-anchor="middle" x="6714" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6714" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_11_0&#45;&gt;tp_1_11 -->
<g id="edge171" class="edge">
<title>expert_1_11_0&#45;&gt;tp_1_11</title>
<path fill="none" stroke="black" d="M6714,-10045.53C6714,-10037.86 6714,-10028.91 6714,-10020.11"/>
<polygon fill="black" stroke="black" points="6717.5,-10019.95 6714,-10009.95 6710.5,-10019.95 6717.5,-10019.95"/>
</g>
<!-- expert_1_11_1&#45;&gt;tp_1_11 -->
<g id="edge172" class="edge">
<title>expert_1_11_1&#45;&gt;tp_1_11</title>
<path fill="none" stroke="black" d="M6937.59,-10045.53C6896.13,-10033.29 6843.64,-10017.79 6799.93,-10004.88"/>
<polygon fill="black" stroke="black" points="6800.75,-10001.48 6790.17,-10002 6798.77,-10008.19 6800.75,-10001.48"/>
</g>
<!-- tp_1_11&#45;&gt;agg_1 -->
<g id="edge173" class="edge">
<title>tp_1_11&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M6602.22,-9969.84C6508.04,-9963.48 6369.74,-9954.38 6249,-9947.39 5790.86,-9920.89 5256.26,-9894.68 4949.72,-9880.11"/>
<polygon fill="black" stroke="black" points="4949.51,-9876.6 4939.36,-9879.62 4949.18,-9883.59 4949.51,-9876.6"/>
</g>
<!-- expert_1_12_0 -->
<g id="node121" class="node">
<title>expert_1_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7442.5,-10089.62 7165.5,-10089.62 7165.5,-10045.62 7442.5,-10045.62 7442.5,-10089.62"/>
<text text-anchor="middle" x="7304" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7304" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 56</text>
<text text-anchor="middle" x="7304" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7304" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_12&#45;&gt;expert_1_12_0 -->
<g id="edge175" class="edge">
<title>route_1_12&#45;&gt;expert_1_12_0</title>
<path fill="none" stroke="black" d="M7304,-10125.26C7304,-10116.99 7304,-10108.01 7304,-10099.7"/>
<polygon fill="black" stroke="black" points="7307.5,-10099.62 7304,-10089.62 7300.5,-10099.62 7307.5,-10099.62"/>
</g>
<!-- expert_1_12_1 -->
<g id="node122" class="node">
<title>expert_1_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7737.5,-10089.62 7460.5,-10089.62 7460.5,-10045.62 7737.5,-10045.62 7737.5,-10089.62"/>
<text text-anchor="middle" x="7599" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7599" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 57</text>
<text text-anchor="middle" x="7599" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7599" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_12&#45;&gt;expert_1_12_1 -->
<g id="edge176" class="edge">
<title>route_1_12&#45;&gt;expert_1_12_1</title>
<path fill="none" stroke="black" d="M7394.92,-10128.88C7434.08,-10117.32 7479.51,-10103.9 7517.56,-10092.67"/>
<polygon fill="black" stroke="black" points="7518.97,-10095.9 7527.57,-10089.71 7516.99,-10089.19 7518.97,-10095.9"/>
</g>
<!-- tp_1_12 -->
<g id="node123" class="node">
<title>tp_1_12</title>
<ellipse fill="lightblue" stroke="black" cx="7304" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7304" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7304" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 56↔57</text>
<text text-anchor="middle" x="7304" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7304" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_12_0&#45;&gt;tp_1_12 -->
<g id="edge177" class="edge">
<title>expert_1_12_0&#45;&gt;tp_1_12</title>
<path fill="none" stroke="black" d="M7304,-10045.53C7304,-10037.86 7304,-10028.91 7304,-10020.11"/>
<polygon fill="black" stroke="black" points="7307.5,-10019.95 7304,-10009.95 7300.5,-10019.95 7307.5,-10019.95"/>
</g>
<!-- expert_1_12_1&#45;&gt;tp_1_12 -->
<g id="edge178" class="edge">
<title>expert_1_12_1&#45;&gt;tp_1_12</title>
<path fill="none" stroke="black" d="M7527.59,-10045.53C7486.13,-10033.29 7433.64,-10017.79 7389.93,-10004.88"/>
<polygon fill="black" stroke="black" points="7390.75,-10001.48 7380.17,-10002 7388.77,-10008.19 7390.75,-10001.48"/>
</g>
<!-- tp_1_12&#45;&gt;agg_1 -->
<g id="edge179" class="edge">
<title>tp_1_12&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7192.71,-9969.43C7098.54,-9962.8 6959.99,-9953.54 6839,-9947.39 6152.44,-9912.5 5341.23,-9886.8 4943.61,-9875.21"/>
<polygon fill="black" stroke="black" points="4943.52,-9871.71 4933.42,-9874.92 4943.32,-9878.71 4943.52,-9871.71"/>
</g>
<!-- expert_1_13_0 -->
<g id="node125" class="node">
<title>expert_1_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8032.5,-10089.62 7755.5,-10089.62 7755.5,-10045.62 8032.5,-10045.62 8032.5,-10089.62"/>
<text text-anchor="middle" x="7894" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7894" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 58</text>
<text text-anchor="middle" x="7894" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7894" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_13&#45;&gt;expert_1_13_0 -->
<g id="edge181" class="edge">
<title>route_1_13&#45;&gt;expert_1_13_0</title>
<path fill="none" stroke="black" d="M7894,-10125.26C7894,-10116.99 7894,-10108.01 7894,-10099.7"/>
<polygon fill="black" stroke="black" points="7897.5,-10099.62 7894,-10089.62 7890.5,-10099.62 7897.5,-10099.62"/>
</g>
<!-- expert_1_13_1 -->
<g id="node126" class="node">
<title>expert_1_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8327.5,-10089.62 8050.5,-10089.62 8050.5,-10045.62 8327.5,-10045.62 8327.5,-10089.62"/>
<text text-anchor="middle" x="8189" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8189" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 59</text>
<text text-anchor="middle" x="8189" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8189" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_13&#45;&gt;expert_1_13_1 -->
<g id="edge182" class="edge">
<title>route_1_13&#45;&gt;expert_1_13_1</title>
<path fill="none" stroke="black" d="M7984.92,-10128.88C8024.08,-10117.32 8069.51,-10103.9 8107.56,-10092.67"/>
<polygon fill="black" stroke="black" points="8108.97,-10095.9 8117.57,-10089.71 8106.99,-10089.19 8108.97,-10095.9"/>
</g>
<!-- tp_1_13 -->
<g id="node127" class="node">
<title>tp_1_13</title>
<ellipse fill="lightblue" stroke="black" cx="7894" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7894" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7894" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 58↔59</text>
<text text-anchor="middle" x="7894" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7894" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_13_0&#45;&gt;tp_1_13 -->
<g id="edge183" class="edge">
<title>expert_1_13_0&#45;&gt;tp_1_13</title>
<path fill="none" stroke="black" d="M7894,-10045.53C7894,-10037.86 7894,-10028.91 7894,-10020.11"/>
<polygon fill="black" stroke="black" points="7897.5,-10019.95 7894,-10009.95 7890.5,-10019.95 7897.5,-10019.95"/>
</g>
<!-- expert_1_13_1&#45;&gt;tp_1_13 -->
<g id="edge184" class="edge">
<title>expert_1_13_1&#45;&gt;tp_1_13</title>
<path fill="none" stroke="black" d="M8117.59,-10045.53C8076.13,-10033.29 8023.64,-10017.79 7979.93,-10004.88"/>
<polygon fill="black" stroke="black" points="7980.75,-10001.48 7970.17,-10002 7978.77,-10008.19 7980.75,-10001.48"/>
</g>
<!-- tp_1_13&#45;&gt;agg_1 -->
<g id="edge185" class="edge">
<title>tp_1_13&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M7783.2,-9969.21C7689.03,-9962.43 7550.21,-9953.07 7429,-9947.39 6510.18,-9904.36 5416.24,-9881.18 4940.2,-9872.48"/>
<polygon fill="black" stroke="black" points="4940.17,-9868.98 4930.11,-9872.3 4940.04,-9875.98 4940.17,-9868.98"/>
</g>
<!-- expert_1_14_0 -->
<g id="node129" class="node">
<title>expert_1_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8622.5,-10089.62 8345.5,-10089.62 8345.5,-10045.62 8622.5,-10045.62 8622.5,-10089.62"/>
<text text-anchor="middle" x="8484" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8484" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 60</text>
<text text-anchor="middle" x="8484" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8484" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_14&#45;&gt;expert_1_14_0 -->
<g id="edge187" class="edge">
<title>route_1_14&#45;&gt;expert_1_14_0</title>
<path fill="none" stroke="black" d="M8484,-10125.26C8484,-10116.99 8484,-10108.01 8484,-10099.7"/>
<polygon fill="black" stroke="black" points="8487.5,-10099.62 8484,-10089.62 8480.5,-10099.62 8487.5,-10099.62"/>
</g>
<!-- expert_1_14_1 -->
<g id="node130" class="node">
<title>expert_1_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8917.5,-10089.62 8640.5,-10089.62 8640.5,-10045.62 8917.5,-10045.62 8917.5,-10089.62"/>
<text text-anchor="middle" x="8779" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8779" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 61</text>
<text text-anchor="middle" x="8779" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8779" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_14&#45;&gt;expert_1_14_1 -->
<g id="edge188" class="edge">
<title>route_1_14&#45;&gt;expert_1_14_1</title>
<path fill="none" stroke="black" d="M8574.92,-10128.88C8614.08,-10117.32 8659.51,-10103.9 8697.56,-10092.67"/>
<polygon fill="black" stroke="black" points="8698.97,-10095.9 8707.57,-10089.71 8696.99,-10089.19 8698.97,-10095.9"/>
</g>
<!-- tp_1_14 -->
<g id="node131" class="node">
<title>tp_1_14</title>
<ellipse fill="lightblue" stroke="black" cx="8484" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8484" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8484" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 60↔61</text>
<text text-anchor="middle" x="8484" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8484" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_14_0&#45;&gt;tp_1_14 -->
<g id="edge189" class="edge">
<title>expert_1_14_0&#45;&gt;tp_1_14</title>
<path fill="none" stroke="black" d="M8484,-10045.53C8484,-10037.86 8484,-10028.91 8484,-10020.11"/>
<polygon fill="black" stroke="black" points="8487.5,-10019.95 8484,-10009.95 8480.5,-10019.95 8487.5,-10019.95"/>
</g>
<!-- expert_1_14_1&#45;&gt;tp_1_14 -->
<g id="edge190" class="edge">
<title>expert_1_14_1&#45;&gt;tp_1_14</title>
<path fill="none" stroke="black" d="M8707.59,-10045.53C8666.13,-10033.29 8613.64,-10017.79 8569.93,-10004.88"/>
<polygon fill="black" stroke="black" points="8570.75,-10001.48 8560.17,-10002 8568.77,-10008.19 8570.75,-10001.48"/>
</g>
<!-- tp_1_14&#45;&gt;agg_1 -->
<g id="edge191" class="edge">
<title>tp_1_14&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M8373.2,-9969.05C8279.04,-9962.18 8140.23,-9952.76 8019,-9947.39 6865.04,-9896.32 5483.88,-9876.8 4937.9,-9870.73"/>
<polygon fill="black" stroke="black" points="4937.57,-9867.23 4927.54,-9870.62 4937.5,-9874.23 4937.57,-9867.23"/>
</g>
<!-- expert_1_15_0 -->
<g id="node133" class="node">
<title>expert_1_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9212.5,-10089.62 8935.5,-10089.62 8935.5,-10045.62 9212.5,-10045.62 9212.5,-10089.62"/>
<text text-anchor="middle" x="9074" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9074" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 62</text>
<text text-anchor="middle" x="9074" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9074" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_15&#45;&gt;expert_1_15_0 -->
<g id="edge193" class="edge">
<title>route_1_15&#45;&gt;expert_1_15_0</title>
<path fill="none" stroke="black" d="M9074,-10125.26C9074,-10116.99 9074,-10108.01 9074,-10099.7"/>
<polygon fill="black" stroke="black" points="9077.5,-10099.62 9074,-10089.62 9070.5,-10099.62 9077.5,-10099.62"/>
</g>
<!-- expert_1_15_1 -->
<g id="node134" class="node">
<title>expert_1_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9507.5,-10089.62 9230.5,-10089.62 9230.5,-10045.62 9507.5,-10045.62 9507.5,-10089.62"/>
<text text-anchor="middle" x="9369" y="-10080.42" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9369" y="-10070.42" font-family="Times,serif" font-size="9.00">GPU: 63</text>
<text text-anchor="middle" x="9369" y="-10060.42" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9369" y="-10050.42" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_1_15&#45;&gt;expert_1_15_1 -->
<g id="edge194" class="edge">
<title>route_1_15&#45;&gt;expert_1_15_1</title>
<path fill="none" stroke="black" d="M9164.92,-10128.88C9204.08,-10117.32 9249.51,-10103.9 9287.56,-10092.67"/>
<polygon fill="black" stroke="black" points="9288.97,-10095.9 9297.57,-10089.71 9286.99,-10089.19 9288.97,-10095.9"/>
</g>
<!-- tp_1_15 -->
<g id="node135" class="node">
<title>tp_1_15</title>
<ellipse fill="lightblue" stroke="black" cx="9074" cy="-9978.51" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9074" y="-9991.31" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9074" y="-9981.31" font-family="Times,serif" font-size="9.00">GPU: 62↔63</text>
<text text-anchor="middle" x="9074" y="-9971.31" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9074" y="-9961.31" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_1_15_0&#45;&gt;tp_1_15 -->
<g id="edge195" class="edge">
<title>expert_1_15_0&#45;&gt;tp_1_15</title>
<path fill="none" stroke="black" d="M9074,-10045.53C9074,-10037.86 9074,-10028.91 9074,-10020.11"/>
<polygon fill="black" stroke="black" points="9077.5,-10019.95 9074,-10009.95 9070.5,-10019.95 9077.5,-10019.95"/>
</g>
<!-- expert_1_15_1&#45;&gt;tp_1_15 -->
<g id="edge196" class="edge">
<title>expert_1_15_1&#45;&gt;tp_1_15</title>
<path fill="none" stroke="black" d="M9297.59,-10045.53C9256.13,-10033.29 9203.64,-10017.79 9159.93,-10004.88"/>
<polygon fill="black" stroke="black" points="9160.75,-10001.48 9150.17,-10002 9158.77,-10008.19 9160.75,-10001.48"/>
</g>
<!-- tp_1_15&#45;&gt;agg_1 -->
<g id="edge197" class="edge">
<title>tp_1_15&#45;&gt;agg_1</title>
<path fill="none" stroke="black" d="M8963.21,-9968.94C8869.05,-9962 8730.24,-9952.54 8609,-9947.39 7217.77,-9888.32 5546.14,-9873.2 4936.32,-9869.52"/>
<polygon fill="black" stroke="black" points="4936.11,-9866.01 4926.09,-9869.45 4936.07,-9873.01 4936.11,-9866.01"/>
</g>
<!-- output_1 -->
<g id="node137" class="node">
<title>output_1</title>
<polygon fill="lightgreen" stroke="black" points="4847,-9787.39 4551,-9787.39 4551,-9743.39 4847,-9743.39 4847,-9787.39"/>
<text text-anchor="middle" x="4699" y="-9778.19" font-family="Times,serif" font-size="9.00">Layer 1 Output</text>
<text text-anchor="middle" x="4699" y="-9768.19" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4699" y="-9758.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4699" y="-9748.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_1&#45;&gt;output_1 -->
<g id="edge198" class="edge">
<title>agg_1&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M4699,-9823.11C4699,-9814.53 4699,-9805.67 4699,-9797.58"/>
<polygon fill="black" stroke="black" points="4702.5,-9797.48 4699,-9787.48 4695.5,-9797.48 4702.5,-9797.48"/>
</g>
<!-- mha_2 -->
<g id="node138" class="node">
<title>mha_2</title>
<polygon fill="lightgreen" stroke="black" points="4847,-9696.39 4551,-9696.39 4551,-9652.39 4847,-9652.39 4847,-9696.39"/>
<text text-anchor="middle" x="4699" y="-9687.19" font-family="Times,serif" font-size="9.00">MHA L2</text>
<text text-anchor="middle" x="4699" y="-9677.19" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4699" y="-9667.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4699" y="-9657.19" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_1&#45;&gt;mha_2 -->
<g id="edge199" class="edge">
<title>output_1&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M4699,-9743.3C4699,-9732.41 4699,-9718.9 4699,-9706.81"/>
<polygon fill="black" stroke="black" points="4702.5,-9706.64 4699,-9696.64 4695.5,-9706.64 4702.5,-9706.64"/>
</g>
<!-- gate_2 -->
<g id="node139" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="4998.74,-9616.39 4521.92,-9616.39 4399.26,-9528.39 4876.08,-9528.39 4998.74,-9616.39"/>
<text text-anchor="middle" x="4699" y="-9585.19" font-family="Times,serif" font-size="9.00">Gate L2</text>
<text text-anchor="middle" x="4699" y="-9575.19" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4699" y="-9565.19" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4699" y="-9555.19" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_2&#45;&gt;gate_2 -->
<g id="edge200" class="edge">
<title>mha_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M4699,-9652.19C4699,-9644.69 4699,-9635.88 4699,-9626.92"/>
<polygon fill="black" stroke="black" points="4702.5,-9626.8 4699,-9616.8 4695.5,-9626.8 4702.5,-9626.8"/>
</g>
<!-- route_2_0 -->
<g id="node140" class="node">
<title>route_2_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="535" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="535" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="535" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 64,65</text>
<text text-anchor="middle" x="535" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="535" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_0 -->
<g id="edge201" class="edge">
<title>gate_2&#45;&gt;route_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4458.93,-9571.23C3860.28,-9569.75 2253.17,-9559.33 915,-9492.39 849.75,-9489.13 778.32,-9483.91 715.17,-9478.72"/>
<polygon fill="black" stroke="black" points="715.36,-9475.22 705.11,-9477.89 714.79,-9482.2 715.36,-9475.22"/>
</g>
<!-- route_2_1 -->
<g id="node144" class="node">
<title>route_2_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1125" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1125" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1125" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 66,67</text>
<text text-anchor="middle" x="1125" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1125" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_1 -->
<g id="edge207" class="edge">
<title>gate_2&#45;&gt;route_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4456.92,-9569.89C3923.42,-9565.6 2606.29,-9549.61 1505,-9492.39 1439.91,-9489.01 1368.67,-9483.78 1305.63,-9478.61"/>
<polygon fill="black" stroke="black" points="1305.84,-9475.12 1295.59,-9477.79 1305.27,-9482.1 1305.84,-9475.12"/>
</g>
<!-- route_2_2 -->
<g id="node148" class="node">
<title>route_2_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1715" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1715" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1715" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 68,69</text>
<text text-anchor="middle" x="1715" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1715" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_2 -->
<g id="edge213" class="edge">
<title>gate_2&#45;&gt;route_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4454.26,-9567.95C3992.63,-9560.56 2961.82,-9539.86 2095,-9492.39 2030.08,-9488.84 1959.02,-9483.58 1896.1,-9478.44"/>
<polygon fill="black" stroke="black" points="1896.33,-9474.95 1886.07,-9477.62 1895.75,-9481.93 1896.33,-9474.95"/>
</g>
<!-- route_2_3 -->
<g id="node152" class="node">
<title>route_2_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2305" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2305" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2305" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 70,71</text>
<text text-anchor="middle" x="2305" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2305" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_3 -->
<g id="edge219" class="edge">
<title>gate_2&#45;&gt;route_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4450.02,-9564.82C4069.45,-9554.05 3320.31,-9530.01 2685,-9492.39 2620.41,-9488.57 2549.73,-9483.27 2487.03,-9478.19"/>
<polygon fill="black" stroke="black" points="2487.29,-9474.7 2477.04,-9477.38 2486.72,-9481.68 2487.29,-9474.7"/>
</g>
<!-- route_2_4 -->
<g id="node156" class="node">
<title>route_2_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2895" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2895" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2895" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 72,73</text>
<text text-anchor="middle" x="2895" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2895" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_4 -->
<g id="edge225" class="edge">
<title>gate_2&#45;&gt;route_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4441.64,-9558.95C4156.35,-9544.73 3682.62,-9519.85 3275,-9492.39 3211.2,-9488.1 3141.43,-9482.75 3079.28,-9477.77"/>
<polygon fill="black" stroke="black" points="3079.23,-9474.25 3068.98,-9476.94 3078.66,-9481.23 3079.23,-9474.25"/>
</g>
<!-- route_2_5 -->
<g id="node160" class="node">
<title>route_2_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3485" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3485" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3485" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 74,75</text>
<text text-anchor="middle" x="3485" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3485" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_5 -->
<g id="edge231" class="edge">
<title>gate_2&#45;&gt;route_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4424.66,-9546.74C4192.71,-9525.89 3866.98,-9496.61 3666.29,-9478.58"/>
<polygon fill="black" stroke="black" points="3666.51,-9475.08 3656.24,-9477.67 3665.88,-9482.05 3666.51,-9475.08"/>
</g>
<!-- route_2_6 -->
<g id="node164" class="node">
<title>route_2_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4075" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4075" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4075" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 76,77</text>
<text text-anchor="middle" x="4075" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4075" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_6 -->
<g id="edge237" class="edge">
<title>gate_2&#45;&gt;route_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4452.83,-9528.35C4372.26,-9514.26 4285.55,-9499.1 4215.55,-9486.86"/>
<polygon fill="black" stroke="black" points="4215.8,-9483.35 4205.34,-9485.07 4214.59,-9490.24 4215.8,-9483.35"/>
</g>
<!-- route_2_7 -->
<g id="node168" class="node">
<title>route_2_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4665" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4665" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4665" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 78,79</text>
<text text-anchor="middle" x="4665" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4665" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_7 -->
<g id="edge243" class="edge">
<title>gate_2&#45;&gt;route_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4685.56,-9528.27C4682.89,-9519.71 4680.1,-9510.75 4677.47,-9502.3"/>
<polygon fill="black" stroke="black" points="4680.78,-9501.16 4674.47,-9492.66 4674.1,-9503.25 4680.78,-9501.16"/>
</g>
<!-- route_2_8 -->
<g id="node172" class="node">
<title>route_2_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5085" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5085" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5085" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 80,81</text>
<text text-anchor="middle" x="5085" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5085" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_8 -->
<g id="edge249" class="edge">
<title>gate_2&#45;&gt;route_2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4851.28,-9528.35C4894.91,-9516.01 4941.46,-9502.86 4981.43,-9491.56"/>
<polygon fill="black" stroke="black" points="4982.5,-9494.89 4991.18,-9488.8 4980.6,-9488.16 4982.5,-9494.89"/>
</g>
<!-- route_2_9 -->
<g id="node176" class="node">
<title>route_2_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5550" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5550" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5550" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 82,83</text>
<text text-anchor="middle" x="5550" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5550" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_9 -->
<g id="edge255" class="edge">
<title>gate_2&#45;&gt;route_2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4900.14,-9545.61C5049.13,-9526.5 5249.52,-9500.81 5388.21,-9483.03"/>
<polygon fill="black" stroke="black" points="5389.03,-9486.45 5398.5,-9481.71 5388.14,-9479.51 5389.03,-9486.45"/>
</g>
<!-- route_2_10 -->
<g id="node180" class="node">
<title>route_2_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6140" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6140" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6140" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 84,85</text>
<text text-anchor="middle" x="6140" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6140" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_10 -->
<g id="edge261" class="edge">
<title>gate_2&#45;&gt;route_2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4914.17,-9555.67C5128.54,-9539.94 5467.06,-9514.91 5760,-9492.39 5823.13,-9487.54 5892.15,-9482.11 5953.84,-9477.21"/>
<polygon fill="black" stroke="black" points="5954.38,-9480.68 5964.07,-9476.4 5953.82,-9473.7 5954.38,-9480.68"/>
</g>
<!-- route_2_11 -->
<g id="node184" class="node">
<title>route_2_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6730" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6730" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6730" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 86,87</text>
<text text-anchor="middle" x="6730" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6730" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_11 -->
<g id="edge267" class="edge">
<title>gate_2&#45;&gt;route_2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4924.45,-9562.84C5242.43,-9550.27 5840.78,-9524.75 6350,-9492.39 6414.13,-9488.32 6484.27,-9483 6546.65,-9477.98"/>
<polygon fill="black" stroke="black" points="6547.31,-9481.43 6556.99,-9477.14 6546.74,-9474.46 6547.31,-9481.43"/>
</g>
<!-- route_2_12 -->
<g id="node188" class="node">
<title>route_2_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7320" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7320" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7320" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 88,89</text>
<text text-anchor="middle" x="7320" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7320" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_12 -->
<g id="edge273" class="edge">
<title>gate_2&#45;&gt;route_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4929.41,-9566.6C5335.74,-9557.41 6206.15,-9534.39 6940,-9492.39 7004.75,-9488.69 7075.62,-9483.41 7138.43,-9478.3"/>
<polygon fill="black" stroke="black" points="7138.76,-9481.78 7148.44,-9477.48 7138.19,-9474.81 7138.76,-9481.78"/>
</g>
<!-- route_2_13 -->
<g id="node192" class="node">
<title>route_2_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7910" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7910" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7910" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 90,91</text>
<text text-anchor="middle" x="7910" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7910" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_13 -->
<g id="edge279" class="edge">
<title>gate_2&#45;&gt;route_2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4932.66,-9568.92C5417.23,-9562.89 6566.76,-9543.97 7530,-9492.39 7594.92,-9488.92 7665.98,-9483.68 7728.9,-9478.53"/>
<polygon fill="black" stroke="black" points="7729.25,-9482.02 7738.93,-9477.71 7728.68,-9475.04 7729.25,-9482.02"/>
</g>
<!-- route_2_14 -->
<g id="node196" class="node">
<title>route_2_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8500" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8500" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8500" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 92,93</text>
<text text-anchor="middle" x="8500" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8500" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_14 -->
<g id="edge285" class="edge">
<title>gate_2&#45;&gt;route_2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4934.8,-9570.49C5490.19,-9567.38 6923.93,-9553.55 8120,-9492.39 8185.09,-9489.07 8256.34,-9483.84 8319.37,-9478.67"/>
<polygon fill="black" stroke="black" points="8319.73,-9482.16 8329.41,-9477.85 8319.16,-9475.18 8319.73,-9482.16"/>
</g>
<!-- route_2_15 -->
<g id="node200" class="node">
<title>route_2_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9090" cy="-9461.28" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9090" y="-9474.08" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9090" y="-9464.08" font-family="Times,serif" font-size="9.00">GPU: 94,95</text>
<text text-anchor="middle" x="9090" y="-9454.08" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9090" y="-9444.08" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_2&#45;&gt;route_2_15 -->
<g id="edge291" class="edge">
<title>gate_2&#45;&gt;route_2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4936.52,-9571.63C5557.2,-9571.2 7278.72,-9563.14 8710,-9492.39 8775.25,-9489.17 8846.69,-9483.95 8909.83,-9478.76"/>
<polygon fill="black" stroke="black" points="8910.21,-9482.24 8919.89,-9477.93 8909.64,-9475.27 8910.21,-9482.24"/>
</g>
<!-- expert_2_0_0 -->
<g id="node141" class="node">
<title>expert_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="378.5,-9394.17 101.5,-9394.17 101.5,-9350.17 378.5,-9350.17 378.5,-9394.17"/>
<text text-anchor="middle" x="240" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="240" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 64</text>
<text text-anchor="middle" x="240" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="240" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_0&#45;&gt;expert_2_0_0 -->
<g id="edge202" class="edge">
<title>route_2_0&#45;&gt;expert_2_0_0</title>
<path fill="none" stroke="black" d="M444.08,-9433.43C404.92,-9421.87 359.49,-9408.45 321.44,-9397.22"/>
<polygon fill="black" stroke="black" points="322.01,-9393.74 311.43,-9394.26 320.03,-9400.45 322.01,-9393.74"/>
</g>
<!-- expert_2_0_1 -->
<g id="node142" class="node">
<title>expert_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="673.5,-9394.17 396.5,-9394.17 396.5,-9350.17 673.5,-9350.17 673.5,-9394.17"/>
<text text-anchor="middle" x="535" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="535" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 65</text>
<text text-anchor="middle" x="535" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="535" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_0&#45;&gt;expert_2_0_1 -->
<g id="edge203" class="edge">
<title>route_2_0&#45;&gt;expert_2_0_1</title>
<path fill="none" stroke="black" d="M535,-9429.81C535,-9421.53 535,-9412.56 535,-9404.25"/>
<polygon fill="black" stroke="black" points="538.5,-9404.17 535,-9394.17 531.5,-9404.17 538.5,-9404.17"/>
</g>
<!-- tp_2_0 -->
<g id="node143" class="node">
<title>tp_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="535" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="535" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="535" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 64↔65</text>
<text text-anchor="middle" x="535" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="535" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_0_0&#45;&gt;tp_2_0 -->
<g id="edge204" class="edge">
<title>expert_2_0_0&#45;&gt;tp_2_0</title>
<path fill="none" stroke="black" d="M311.41,-9350.08C352.87,-9337.84 405.36,-9322.34 449.07,-9309.43"/>
<polygon fill="black" stroke="black" points="450.23,-9312.74 458.83,-9306.55 448.25,-9306.02 450.23,-9312.74"/>
</g>
<!-- expert_2_0_1&#45;&gt;tp_2_0 -->
<g id="edge205" class="edge">
<title>expert_2_0_1&#45;&gt;tp_2_0</title>
<path fill="none" stroke="black" d="M535,-9350.08C535,-9342.41 535,-9333.46 535,-9324.66"/>
<polygon fill="black" stroke="black" points="538.5,-9324.5 535,-9314.5 531.5,-9324.5 538.5,-9324.5"/>
</g>
<!-- agg_2 -->
<g id="node204" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="5093.99,-9215.94 4645.4,-9215.94 4530.01,-9127.94 4978.6,-9127.94 5093.99,-9215.94"/>
<text text-anchor="middle" x="4812" y="-9184.74" font-family="Times,serif" font-size="9.00">Aggregate Experts L2</text>
<text text-anchor="middle" x="4812" y="-9174.74" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4812" y="-9164.74" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4812" y="-9154.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_2_0&#45;&gt;agg_2 -->
<g id="edge206" class="edge">
<title>tp_2_0&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M645.79,-9273.51C739.96,-9266.57 878.76,-9257.12 1000,-9251.94 2355.83,-9194.02 3984.8,-9178.21 4579.92,-9174.2"/>
<polygon fill="black" stroke="black" points="4580.36,-9177.7 4590.33,-9174.13 4580.31,-9170.7 4580.36,-9177.7"/>
</g>
<!-- expert_2_1_0 -->
<g id="node145" class="node">
<title>expert_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="968.5,-9394.17 691.5,-9394.17 691.5,-9350.17 968.5,-9350.17 968.5,-9394.17"/>
<text text-anchor="middle" x="830" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="830" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 66</text>
<text text-anchor="middle" x="830" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="830" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_1&#45;&gt;expert_2_1_0 -->
<g id="edge208" class="edge">
<title>route_2_1&#45;&gt;expert_2_1_0</title>
<path fill="none" stroke="black" d="M1034.08,-9433.43C994.92,-9421.87 949.49,-9408.45 911.44,-9397.22"/>
<polygon fill="black" stroke="black" points="912.01,-9393.74 901.43,-9394.26 910.03,-9400.45 912.01,-9393.74"/>
</g>
<!-- expert_2_1_1 -->
<g id="node146" class="node">
<title>expert_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1263.5,-9394.17 986.5,-9394.17 986.5,-9350.17 1263.5,-9350.17 1263.5,-9394.17"/>
<text text-anchor="middle" x="1125" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1125" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 67</text>
<text text-anchor="middle" x="1125" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1125" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_1&#45;&gt;expert_2_1_1 -->
<g id="edge209" class="edge">
<title>route_2_1&#45;&gt;expert_2_1_1</title>
<path fill="none" stroke="black" d="M1125,-9429.81C1125,-9421.53 1125,-9412.56 1125,-9404.25"/>
<polygon fill="black" stroke="black" points="1128.5,-9404.17 1125,-9394.17 1121.5,-9404.17 1128.5,-9404.17"/>
</g>
<!-- tp_2_1 -->
<g id="node147" class="node">
<title>tp_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="1125" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1125" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1125" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 66↔67</text>
<text text-anchor="middle" x="1125" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1125" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_1_0&#45;&gt;tp_2_1 -->
<g id="edge210" class="edge">
<title>expert_2_1_0&#45;&gt;tp_2_1</title>
<path fill="none" stroke="black" d="M901.41,-9350.08C942.87,-9337.84 995.36,-9322.34 1039.07,-9309.43"/>
<polygon fill="black" stroke="black" points="1040.23,-9312.74 1048.83,-9306.55 1038.25,-9306.02 1040.23,-9312.74"/>
</g>
<!-- expert_2_1_1&#45;&gt;tp_2_1 -->
<g id="edge211" class="edge">
<title>expert_2_1_1&#45;&gt;tp_2_1</title>
<path fill="none" stroke="black" d="M1125,-9350.08C1125,-9342.41 1125,-9333.46 1125,-9324.66"/>
<polygon fill="black" stroke="black" points="1128.5,-9324.5 1125,-9314.5 1121.5,-9324.5 1128.5,-9324.5"/>
</g>
<!-- tp_2_1&#45;&gt;agg_2 -->
<g id="edge212" class="edge">
<title>tp_2_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1235.8,-9273.63C1329.96,-9266.76 1468.77,-9257.35 1590,-9251.94 2710.94,-9201.93 4052.78,-9181.79 4581.63,-9175.42"/>
<polygon fill="black" stroke="black" points="4581.71,-9178.92 4591.67,-9175.3 4581.63,-9171.92 4581.71,-9178.92"/>
</g>
<!-- expert_2_2_0 -->
<g id="node149" class="node">
<title>expert_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1558.5,-9394.17 1281.5,-9394.17 1281.5,-9350.17 1558.5,-9350.17 1558.5,-9394.17"/>
<text text-anchor="middle" x="1420" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1420" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 68</text>
<text text-anchor="middle" x="1420" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1420" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_2&#45;&gt;expert_2_2_0 -->
<g id="edge214" class="edge">
<title>route_2_2&#45;&gt;expert_2_2_0</title>
<path fill="none" stroke="black" d="M1624.08,-9433.43C1584.92,-9421.87 1539.49,-9408.45 1501.44,-9397.22"/>
<polygon fill="black" stroke="black" points="1502.01,-9393.74 1491.43,-9394.26 1500.03,-9400.45 1502.01,-9393.74"/>
</g>
<!-- expert_2_2_1 -->
<g id="node150" class="node">
<title>expert_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1853.5,-9394.17 1576.5,-9394.17 1576.5,-9350.17 1853.5,-9350.17 1853.5,-9394.17"/>
<text text-anchor="middle" x="1715" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1715" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 69</text>
<text text-anchor="middle" x="1715" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1715" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_2&#45;&gt;expert_2_2_1 -->
<g id="edge215" class="edge">
<title>route_2_2&#45;&gt;expert_2_2_1</title>
<path fill="none" stroke="black" d="M1715,-9429.81C1715,-9421.53 1715,-9412.56 1715,-9404.25"/>
<polygon fill="black" stroke="black" points="1718.5,-9404.17 1715,-9394.17 1711.5,-9404.17 1718.5,-9404.17"/>
</g>
<!-- tp_2_2 -->
<g id="node151" class="node">
<title>tp_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="1715" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1715" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1715" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 68↔69</text>
<text text-anchor="middle" x="1715" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1715" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_2_0&#45;&gt;tp_2_2 -->
<g id="edge216" class="edge">
<title>expert_2_2_0&#45;&gt;tp_2_2</title>
<path fill="none" stroke="black" d="M1491.41,-9350.08C1532.87,-9337.84 1585.36,-9322.34 1629.07,-9309.43"/>
<polygon fill="black" stroke="black" points="1630.23,-9312.74 1638.83,-9306.55 1628.25,-9306.02 1630.23,-9312.74"/>
</g>
<!-- expert_2_2_1&#45;&gt;tp_2_2 -->
<g id="edge217" class="edge">
<title>expert_2_2_1&#45;&gt;tp_2_2</title>
<path fill="none" stroke="black" d="M1715,-9350.08C1715,-9342.41 1715,-9333.46 1715,-9324.66"/>
<polygon fill="black" stroke="black" points="1718.5,-9324.5 1715,-9314.5 1711.5,-9324.5 1718.5,-9324.5"/>
</g>
<!-- tp_2_2&#45;&gt;agg_2 -->
<g id="edge218" class="edge">
<title>tp_2_2&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M1825.8,-9273.8C1919.98,-9267.04 2058.79,-9257.69 2180,-9251.94 3068.74,-9209.84 4127.42,-9186.09 4583.95,-9177.13"/>
<polygon fill="black" stroke="black" points="4584.03,-9180.63 4593.96,-9176.93 4583.89,-9173.63 4584.03,-9180.63"/>
</g>
<!-- expert_2_3_0 -->
<g id="node153" class="node">
<title>expert_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2148.5,-9394.17 1871.5,-9394.17 1871.5,-9350.17 2148.5,-9350.17 2148.5,-9394.17"/>
<text text-anchor="middle" x="2010" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2010" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 70</text>
<text text-anchor="middle" x="2010" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2010" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_3&#45;&gt;expert_2_3_0 -->
<g id="edge220" class="edge">
<title>route_2_3&#45;&gt;expert_2_3_0</title>
<path fill="none" stroke="black" d="M2214.08,-9433.43C2174.92,-9421.87 2129.49,-9408.45 2091.44,-9397.22"/>
<polygon fill="black" stroke="black" points="2092.01,-9393.74 2081.43,-9394.26 2090.03,-9400.45 2092.01,-9393.74"/>
</g>
<!-- expert_2_3_1 -->
<g id="node154" class="node">
<title>expert_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2443.5,-9394.17 2166.5,-9394.17 2166.5,-9350.17 2443.5,-9350.17 2443.5,-9394.17"/>
<text text-anchor="middle" x="2305" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2305" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 71</text>
<text text-anchor="middle" x="2305" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2305" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_3&#45;&gt;expert_2_3_1 -->
<g id="edge221" class="edge">
<title>route_2_3&#45;&gt;expert_2_3_1</title>
<path fill="none" stroke="black" d="M2305,-9429.81C2305,-9421.53 2305,-9412.56 2305,-9404.25"/>
<polygon fill="black" stroke="black" points="2308.5,-9404.17 2305,-9394.17 2301.5,-9404.17 2308.5,-9404.17"/>
</g>
<!-- tp_2_3 -->
<g id="node155" class="node">
<title>tp_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="2305" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2305" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2305" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 70↔71</text>
<text text-anchor="middle" x="2305" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2305" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_3_0&#45;&gt;tp_2_3 -->
<g id="edge222" class="edge">
<title>expert_2_3_0&#45;&gt;tp_2_3</title>
<path fill="none" stroke="black" d="M2081.41,-9350.08C2122.87,-9337.84 2175.36,-9322.34 2219.07,-9309.43"/>
<polygon fill="black" stroke="black" points="2220.23,-9312.74 2228.83,-9306.55 2218.25,-9306.02 2220.23,-9312.74"/>
</g>
<!-- expert_2_3_1&#45;&gt;tp_2_3 -->
<g id="edge223" class="edge">
<title>expert_2_3_1&#45;&gt;tp_2_3</title>
<path fill="none" stroke="black" d="M2305,-9350.08C2305,-9342.41 2305,-9333.46 2305,-9324.66"/>
<polygon fill="black" stroke="black" points="2308.5,-9324.5 2305,-9314.5 2301.5,-9324.5 2308.5,-9324.5"/>
</g>
<!-- tp_2_3&#45;&gt;agg_2 -->
<g id="edge224" class="edge">
<title>tp_2_3&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M2416.29,-9274.03C2510.46,-9267.44 2649.02,-9258.2 2770,-9251.94 3430.08,-9217.81 4210.88,-9191.52 4587.12,-9179.73"/>
<polygon fill="black" stroke="black" points="4587.42,-9183.22 4597.3,-9179.41 4587.2,-9176.23 4587.42,-9183.22"/>
</g>
<!-- expert_2_4_0 -->
<g id="node157" class="node">
<title>expert_2_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2738.5,-9394.17 2461.5,-9394.17 2461.5,-9350.17 2738.5,-9350.17 2738.5,-9394.17"/>
<text text-anchor="middle" x="2600" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2600" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 72</text>
<text text-anchor="middle" x="2600" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2600" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_4&#45;&gt;expert_2_4_0 -->
<g id="edge226" class="edge">
<title>route_2_4&#45;&gt;expert_2_4_0</title>
<path fill="none" stroke="black" d="M2804.08,-9433.43C2764.92,-9421.87 2719.49,-9408.45 2681.44,-9397.22"/>
<polygon fill="black" stroke="black" points="2682.01,-9393.74 2671.43,-9394.26 2680.03,-9400.45 2682.01,-9393.74"/>
</g>
<!-- expert_2_4_1 -->
<g id="node158" class="node">
<title>expert_2_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3033.5,-9394.17 2756.5,-9394.17 2756.5,-9350.17 3033.5,-9350.17 3033.5,-9394.17"/>
<text text-anchor="middle" x="2895" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2895" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 73</text>
<text text-anchor="middle" x="2895" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2895" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_4&#45;&gt;expert_2_4_1 -->
<g id="edge227" class="edge">
<title>route_2_4&#45;&gt;expert_2_4_1</title>
<path fill="none" stroke="black" d="M2895,-9429.81C2895,-9421.53 2895,-9412.56 2895,-9404.25"/>
<polygon fill="black" stroke="black" points="2898.5,-9404.17 2895,-9394.17 2891.5,-9404.17 2898.5,-9404.17"/>
</g>
<!-- tp_2_4 -->
<g id="node159" class="node">
<title>tp_2_4</title>
<ellipse fill="lightblue" stroke="black" cx="2895" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2895" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2895" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 72↔73</text>
<text text-anchor="middle" x="2895" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2895" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_4_0&#45;&gt;tp_2_4 -->
<g id="edge228" class="edge">
<title>expert_2_4_0&#45;&gt;tp_2_4</title>
<path fill="none" stroke="black" d="M2671.41,-9350.08C2712.87,-9337.84 2765.36,-9322.34 2809.07,-9309.43"/>
<polygon fill="black" stroke="black" points="2810.23,-9312.74 2818.83,-9306.55 2808.25,-9306.02 2810.23,-9312.74"/>
</g>
<!-- expert_2_4_1&#45;&gt;tp_2_4 -->
<g id="edge229" class="edge">
<title>expert_2_4_1&#45;&gt;tp_2_4</title>
<path fill="none" stroke="black" d="M2895,-9350.08C2895,-9342.41 2895,-9333.46 2895,-9324.66"/>
<polygon fill="black" stroke="black" points="2898.5,-9324.5 2895,-9314.5 2891.5,-9324.5 2898.5,-9324.5"/>
</g>
<!-- tp_2_4&#45;&gt;agg_2 -->
<g id="edge230" class="edge">
<title>tp_2_4&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3006.79,-9274.49C3100.97,-9268.2 3239.27,-9259.14 3360,-9251.94 3797.09,-9225.9 4308.42,-9198.88 4592.75,-9184.17"/>
<polygon fill="black" stroke="black" points="4592.96,-9187.66 4602.77,-9183.65 4592.6,-9180.67 4592.96,-9187.66"/>
</g>
<!-- expert_2_5_0 -->
<g id="node161" class="node">
<title>expert_2_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3328.5,-9394.17 3051.5,-9394.17 3051.5,-9350.17 3328.5,-9350.17 3328.5,-9394.17"/>
<text text-anchor="middle" x="3190" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3190" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 74</text>
<text text-anchor="middle" x="3190" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3190" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_5&#45;&gt;expert_2_5_0 -->
<g id="edge232" class="edge">
<title>route_2_5&#45;&gt;expert_2_5_0</title>
<path fill="none" stroke="black" d="M3394.08,-9433.43C3354.92,-9421.87 3309.49,-9408.45 3271.44,-9397.22"/>
<polygon fill="black" stroke="black" points="3272.01,-9393.74 3261.43,-9394.26 3270.03,-9400.45 3272.01,-9393.74"/>
</g>
<!-- expert_2_5_1 -->
<g id="node162" class="node">
<title>expert_2_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3623.5,-9394.17 3346.5,-9394.17 3346.5,-9350.17 3623.5,-9350.17 3623.5,-9394.17"/>
<text text-anchor="middle" x="3485" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3485" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 75</text>
<text text-anchor="middle" x="3485" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3485" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_5&#45;&gt;expert_2_5_1 -->
<g id="edge233" class="edge">
<title>route_2_5&#45;&gt;expert_2_5_1</title>
<path fill="none" stroke="black" d="M3485,-9429.81C3485,-9421.53 3485,-9412.56 3485,-9404.25"/>
<polygon fill="black" stroke="black" points="3488.5,-9404.17 3485,-9394.17 3481.5,-9404.17 3488.5,-9404.17"/>
</g>
<!-- tp_2_5 -->
<g id="node163" class="node">
<title>tp_2_5</title>
<ellipse fill="lightblue" stroke="black" cx="3485" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3485" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3485" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 74↔75</text>
<text text-anchor="middle" x="3485" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3485" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_5_0&#45;&gt;tp_2_5 -->
<g id="edge234" class="edge">
<title>expert_2_5_0&#45;&gt;tp_2_5</title>
<path fill="none" stroke="black" d="M3261.41,-9350.08C3302.87,-9337.84 3355.36,-9322.34 3399.07,-9309.43"/>
<polygon fill="black" stroke="black" points="3400.23,-9312.74 3408.83,-9306.55 3398.25,-9306.02 3400.23,-9312.74"/>
</g>
<!-- expert_2_5_1&#45;&gt;tp_2_5 -->
<g id="edge235" class="edge">
<title>expert_2_5_1&#45;&gt;tp_2_5</title>
<path fill="none" stroke="black" d="M3485,-9350.08C3485,-9342.41 3485,-9333.46 3485,-9324.66"/>
<polygon fill="black" stroke="black" points="3488.5,-9324.5 3485,-9314.5 3481.5,-9324.5 3488.5,-9324.5"/>
</g>
<!-- tp_2_5&#45;&gt;agg_2 -->
<g id="edge236" class="edge">
<title>tp_2_5&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M3595.01,-9273.01C3815.49,-9254.88 4314.79,-9213.83 4600.61,-9190.32"/>
<polygon fill="black" stroke="black" points="4601.01,-9193.8 4610.69,-9189.5 4600.44,-9186.83 4601.01,-9193.8"/>
</g>
<!-- expert_2_6_0 -->
<g id="node165" class="node">
<title>expert_2_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3918.5,-9394.17 3641.5,-9394.17 3641.5,-9350.17 3918.5,-9350.17 3918.5,-9394.17"/>
<text text-anchor="middle" x="3780" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3780" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 76</text>
<text text-anchor="middle" x="3780" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3780" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_6&#45;&gt;expert_2_6_0 -->
<g id="edge238" class="edge">
<title>route_2_6&#45;&gt;expert_2_6_0</title>
<path fill="none" stroke="black" d="M3984.08,-9433.43C3944.92,-9421.87 3899.49,-9408.45 3861.44,-9397.22"/>
<polygon fill="black" stroke="black" points="3862.01,-9393.74 3851.43,-9394.26 3860.03,-9400.45 3862.01,-9393.74"/>
</g>
<!-- expert_2_6_1 -->
<g id="node166" class="node">
<title>expert_2_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4213.5,-9394.17 3936.5,-9394.17 3936.5,-9350.17 4213.5,-9350.17 4213.5,-9394.17"/>
<text text-anchor="middle" x="4075" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4075" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 77</text>
<text text-anchor="middle" x="4075" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4075" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_6&#45;&gt;expert_2_6_1 -->
<g id="edge239" class="edge">
<title>route_2_6&#45;&gt;expert_2_6_1</title>
<path fill="none" stroke="black" d="M4075,-9429.81C4075,-9421.53 4075,-9412.56 4075,-9404.25"/>
<polygon fill="black" stroke="black" points="4078.5,-9404.17 4075,-9394.17 4071.5,-9404.17 4078.5,-9404.17"/>
</g>
<!-- tp_2_6 -->
<g id="node167" class="node">
<title>tp_2_6</title>
<ellipse fill="lightblue" stroke="black" cx="4075" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4075" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4075" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 76↔77</text>
<text text-anchor="middle" x="4075" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4075" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_6_0&#45;&gt;tp_2_6 -->
<g id="edge240" class="edge">
<title>expert_2_6_0&#45;&gt;tp_2_6</title>
<path fill="none" stroke="black" d="M3851.41,-9350.08C3892.87,-9337.84 3945.36,-9322.34 3989.07,-9309.43"/>
<polygon fill="black" stroke="black" points="3990.23,-9312.74 3998.83,-9306.55 3988.25,-9306.02 3990.23,-9312.74"/>
</g>
<!-- expert_2_6_1&#45;&gt;tp_2_6 -->
<g id="edge241" class="edge">
<title>expert_2_6_1&#45;&gt;tp_2_6</title>
<path fill="none" stroke="black" d="M4075,-9350.08C4075,-9342.41 4075,-9333.46 4075,-9324.66"/>
<polygon fill="black" stroke="black" points="4078.5,-9324.5 4075,-9314.5 4071.5,-9324.5 4078.5,-9324.5"/>
</g>
<!-- tp_2_6&#45;&gt;agg_2 -->
<g id="edge242" class="edge">
<title>tp_2_6&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4175.16,-9267.23C4287.68,-9250.57 4473.1,-9223.12 4614.93,-9202.12"/>
<polygon fill="black" stroke="black" points="4615.68,-9205.55 4625.06,-9200.62 4614.66,-9198.62 4615.68,-9205.55"/>
</g>
<!-- expert_2_7_0 -->
<g id="node169" class="node">
<title>expert_2_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4508.5,-9394.17 4231.5,-9394.17 4231.5,-9350.17 4508.5,-9350.17 4508.5,-9394.17"/>
<text text-anchor="middle" x="4370" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4370" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 78</text>
<text text-anchor="middle" x="4370" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4370" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_7&#45;&gt;expert_2_7_0 -->
<g id="edge244" class="edge">
<title>route_2_7&#45;&gt;expert_2_7_0</title>
<path fill="none" stroke="black" d="M4574.08,-9433.43C4534.92,-9421.87 4489.49,-9408.45 4451.44,-9397.22"/>
<polygon fill="black" stroke="black" points="4452.01,-9393.74 4441.43,-9394.26 4450.03,-9400.45 4452.01,-9393.74"/>
</g>
<!-- expert_2_7_1 -->
<g id="node170" class="node">
<title>expert_2_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4803.5,-9394.17 4526.5,-9394.17 4526.5,-9350.17 4803.5,-9350.17 4803.5,-9394.17"/>
<text text-anchor="middle" x="4665" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4665" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 79</text>
<text text-anchor="middle" x="4665" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4665" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_7&#45;&gt;expert_2_7_1 -->
<g id="edge245" class="edge">
<title>route_2_7&#45;&gt;expert_2_7_1</title>
<path fill="none" stroke="black" d="M4665,-9429.81C4665,-9421.53 4665,-9412.56 4665,-9404.25"/>
<polygon fill="black" stroke="black" points="4668.5,-9404.17 4665,-9394.17 4661.5,-9404.17 4668.5,-9404.17"/>
</g>
<!-- tp_2_7 -->
<g id="node171" class="node">
<title>tp_2_7</title>
<ellipse fill="lightblue" stroke="black" cx="4665" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4665" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4665" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 78↔79</text>
<text text-anchor="middle" x="4665" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4665" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_7_0&#45;&gt;tp_2_7 -->
<g id="edge246" class="edge">
<title>expert_2_7_0&#45;&gt;tp_2_7</title>
<path fill="none" stroke="black" d="M4441.41,-9350.08C4482.87,-9337.84 4535.36,-9322.34 4579.07,-9309.43"/>
<polygon fill="black" stroke="black" points="4580.23,-9312.74 4588.83,-9306.55 4578.25,-9306.02 4580.23,-9312.74"/>
</g>
<!-- expert_2_7_1&#45;&gt;tp_2_7 -->
<g id="edge247" class="edge">
<title>expert_2_7_1&#45;&gt;tp_2_7</title>
<path fill="none" stroke="black" d="M4665,-9350.08C4665,-9342.41 4665,-9333.46 4665,-9324.66"/>
<polygon fill="black" stroke="black" points="4668.5,-9324.5 4665,-9314.5 4661.5,-9324.5 4668.5,-9324.5"/>
</g>
<!-- tp_2_7&#45;&gt;agg_2 -->
<g id="edge248" class="edge">
<title>tp_2_7&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4703.24,-9253.67C4716.3,-9243.98 4731.31,-9232.83 4745.93,-9221.99"/>
<polygon fill="black" stroke="black" points="4748.05,-9224.77 4753.99,-9216 4743.88,-9219.15 4748.05,-9224.77"/>
</g>
<!-- expert_2_8_0 -->
<g id="node173" class="node">
<title>expert_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5098.5,-9394.17 4821.5,-9394.17 4821.5,-9350.17 5098.5,-9350.17 5098.5,-9394.17"/>
<text text-anchor="middle" x="4960" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4960" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 80</text>
<text text-anchor="middle" x="4960" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4960" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_8&#45;&gt;expert_2_8_0 -->
<g id="edge250" class="edge">
<title>route_2_8&#45;&gt;expert_2_8_0</title>
<path fill="none" stroke="black" d="M5042.68,-9430.79C5028.49,-9420.9 5012.74,-9409.92 4998.82,-9400.23"/>
<polygon fill="black" stroke="black" points="5000.63,-9397.22 4990.43,-9394.37 4996.63,-9402.96 5000.63,-9397.22"/>
</g>
<!-- expert_2_8_1 -->
<g id="node174" class="node">
<title>expert_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5393.5,-9394.17 5116.5,-9394.17 5116.5,-9350.17 5393.5,-9350.17 5393.5,-9394.17"/>
<text text-anchor="middle" x="5255" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5255" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 81</text>
<text text-anchor="middle" x="5255" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5255" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_8&#45;&gt;expert_2_8_1 -->
<g id="edge251" class="edge">
<title>route_2_8&#45;&gt;expert_2_8_1</title>
<path fill="none" stroke="black" d="M5141.61,-9431.27C5162.13,-9420.76 5185.14,-9408.96 5205.05,-9398.76"/>
<polygon fill="black" stroke="black" points="5206.65,-9401.88 5213.96,-9394.2 5203.46,-9395.65 5206.65,-9401.88"/>
</g>
<!-- tp_2_8 -->
<g id="node175" class="node">
<title>tp_2_8</title>
<ellipse fill="lightblue" stroke="black" cx="4960" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4960" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4960" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 80↔81</text>
<text text-anchor="middle" x="4960" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4960" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_8_0&#45;&gt;tp_2_8 -->
<g id="edge252" class="edge">
<title>expert_2_8_0&#45;&gt;tp_2_8</title>
<path fill="none" stroke="black" d="M4960,-9350.08C4960,-9342.41 4960,-9333.46 4960,-9324.66"/>
<polygon fill="black" stroke="black" points="4963.5,-9324.5 4960,-9314.5 4956.5,-9324.5 4963.5,-9324.5"/>
</g>
<!-- expert_2_8_1&#45;&gt;tp_2_8 -->
<g id="edge253" class="edge">
<title>expert_2_8_1&#45;&gt;tp_2_8</title>
<path fill="none" stroke="black" d="M5183.59,-9350.08C5142.13,-9337.84 5089.64,-9322.34 5045.93,-9309.43"/>
<polygon fill="black" stroke="black" points="5046.75,-9306.02 5036.17,-9306.55 5044.77,-9312.74 5046.75,-9306.02"/>
</g>
<!-- tp_2_8&#45;&gt;agg_2 -->
<g id="edge254" class="edge">
<title>tp_2_8&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M4921.5,-9253.67C4908.35,-9243.98 4893.24,-9232.83 4878.52,-9221.99"/>
<polygon fill="black" stroke="black" points="4880.53,-9219.12 4870.4,-9216 4876.37,-9224.75 4880.53,-9219.12"/>
</g>
<!-- expert_2_9_0 -->
<g id="node177" class="node">
<title>expert_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5688.5,-9394.17 5411.5,-9394.17 5411.5,-9350.17 5688.5,-9350.17 5688.5,-9394.17"/>
<text text-anchor="middle" x="5550" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5550" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 82</text>
<text text-anchor="middle" x="5550" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5550" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_9&#45;&gt;expert_2_9_0 -->
<g id="edge256" class="edge">
<title>route_2_9&#45;&gt;expert_2_9_0</title>
<path fill="none" stroke="black" d="M5550,-9429.81C5550,-9421.53 5550,-9412.56 5550,-9404.25"/>
<polygon fill="black" stroke="black" points="5553.5,-9404.17 5550,-9394.17 5546.5,-9404.17 5553.5,-9404.17"/>
</g>
<!-- expert_2_9_1 -->
<g id="node178" class="node">
<title>expert_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5983.5,-9394.17 5706.5,-9394.17 5706.5,-9350.17 5983.5,-9350.17 5983.5,-9394.17"/>
<text text-anchor="middle" x="5845" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5845" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 83</text>
<text text-anchor="middle" x="5845" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5845" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_9&#45;&gt;expert_2_9_1 -->
<g id="edge257" class="edge">
<title>route_2_9&#45;&gt;expert_2_9_1</title>
<path fill="none" stroke="black" d="M5640.92,-9433.43C5680.08,-9421.87 5725.51,-9408.45 5763.56,-9397.22"/>
<polygon fill="black" stroke="black" points="5764.97,-9400.45 5773.57,-9394.26 5762.99,-9393.74 5764.97,-9400.45"/>
</g>
<!-- tp_2_9 -->
<g id="node179" class="node">
<title>tp_2_9</title>
<ellipse fill="lightblue" stroke="black" cx="5550" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5550" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5550" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 82↔83</text>
<text text-anchor="middle" x="5550" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5550" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_9_0&#45;&gt;tp_2_9 -->
<g id="edge258" class="edge">
<title>expert_2_9_0&#45;&gt;tp_2_9</title>
<path fill="none" stroke="black" d="M5550,-9350.08C5550,-9342.41 5550,-9333.46 5550,-9324.66"/>
<polygon fill="black" stroke="black" points="5553.5,-9324.5 5550,-9314.5 5546.5,-9324.5 5553.5,-9324.5"/>
</g>
<!-- expert_2_9_1&#45;&gt;tp_2_9 -->
<g id="edge259" class="edge">
<title>expert_2_9_1&#45;&gt;tp_2_9</title>
<path fill="none" stroke="black" d="M5773.59,-9350.08C5732.13,-9337.84 5679.64,-9322.34 5635.93,-9309.43"/>
<polygon fill="black" stroke="black" points="5636.75,-9306.02 5626.17,-9306.55 5634.77,-9312.74 5636.75,-9306.02"/>
</g>
<!-- tp_2_9&#45;&gt;agg_2 -->
<g id="edge260" class="edge">
<title>tp_2_9&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M5449.7,-9267.23C5360.3,-9254.01 5224.93,-9233.99 5101.87,-9215.8"/>
<polygon fill="black" stroke="black" points="5102.31,-9212.33 5091.9,-9214.33 5101.28,-9219.25 5102.31,-9212.33"/>
</g>
<!-- expert_2_10_0 -->
<g id="node181" class="node">
<title>expert_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6278.5,-9394.17 6001.5,-9394.17 6001.5,-9350.17 6278.5,-9350.17 6278.5,-9394.17"/>
<text text-anchor="middle" x="6140" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6140" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 84</text>
<text text-anchor="middle" x="6140" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6140" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_10&#45;&gt;expert_2_10_0 -->
<g id="edge262" class="edge">
<title>route_2_10&#45;&gt;expert_2_10_0</title>
<path fill="none" stroke="black" d="M6140,-9429.81C6140,-9421.53 6140,-9412.56 6140,-9404.25"/>
<polygon fill="black" stroke="black" points="6143.5,-9404.17 6140,-9394.17 6136.5,-9404.17 6143.5,-9404.17"/>
</g>
<!-- expert_2_10_1 -->
<g id="node182" class="node">
<title>expert_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6573.5,-9394.17 6296.5,-9394.17 6296.5,-9350.17 6573.5,-9350.17 6573.5,-9394.17"/>
<text text-anchor="middle" x="6435" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6435" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 85</text>
<text text-anchor="middle" x="6435" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6435" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_10&#45;&gt;expert_2_10_1 -->
<g id="edge263" class="edge">
<title>route_2_10&#45;&gt;expert_2_10_1</title>
<path fill="none" stroke="black" d="M6230.92,-9433.43C6270.08,-9421.87 6315.51,-9408.45 6353.56,-9397.22"/>
<polygon fill="black" stroke="black" points="6354.97,-9400.45 6363.57,-9394.26 6352.99,-9393.74 6354.97,-9400.45"/>
</g>
<!-- tp_2_10 -->
<g id="node183" class="node">
<title>tp_2_10</title>
<ellipse fill="lightblue" stroke="black" cx="6140" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6140" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6140" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 84↔85</text>
<text text-anchor="middle" x="6140" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6140" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_10_0&#45;&gt;tp_2_10 -->
<g id="edge264" class="edge">
<title>expert_2_10_0&#45;&gt;tp_2_10</title>
<path fill="none" stroke="black" d="M6140,-9350.08C6140,-9342.41 6140,-9333.46 6140,-9324.66"/>
<polygon fill="black" stroke="black" points="6143.5,-9324.5 6140,-9314.5 6136.5,-9324.5 6143.5,-9324.5"/>
</g>
<!-- expert_2_10_1&#45;&gt;tp_2_10 -->
<g id="edge265" class="edge">
<title>expert_2_10_1&#45;&gt;tp_2_10</title>
<path fill="none" stroke="black" d="M6363.59,-9350.08C6322.13,-9337.84 6269.64,-9322.34 6225.93,-9309.43"/>
<polygon fill="black" stroke="black" points="6226.75,-9306.02 6216.17,-9306.55 6224.77,-9312.74 6226.75,-9306.02"/>
</g>
<!-- tp_2_10&#45;&gt;agg_2 -->
<g id="edge266" class="edge">
<title>tp_2_10&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M6030.19,-9273.03C5822.46,-9255.97 5366.69,-9218.52 5075.33,-9194.58"/>
<polygon fill="black" stroke="black" points="5075.29,-9191.06 5065.03,-9193.73 5074.71,-9198.04 5075.29,-9191.06"/>
</g>
<!-- expert_2_11_0 -->
<g id="node185" class="node">
<title>expert_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6868.5,-9394.17 6591.5,-9394.17 6591.5,-9350.17 6868.5,-9350.17 6868.5,-9394.17"/>
<text text-anchor="middle" x="6730" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6730" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 86</text>
<text text-anchor="middle" x="6730" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6730" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_11&#45;&gt;expert_2_11_0 -->
<g id="edge268" class="edge">
<title>route_2_11&#45;&gt;expert_2_11_0</title>
<path fill="none" stroke="black" d="M6730,-9429.81C6730,-9421.53 6730,-9412.56 6730,-9404.25"/>
<polygon fill="black" stroke="black" points="6733.5,-9404.17 6730,-9394.17 6726.5,-9404.17 6733.5,-9404.17"/>
</g>
<!-- expert_2_11_1 -->
<g id="node186" class="node">
<title>expert_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7163.5,-9394.17 6886.5,-9394.17 6886.5,-9350.17 7163.5,-9350.17 7163.5,-9394.17"/>
<text text-anchor="middle" x="7025" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7025" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 87</text>
<text text-anchor="middle" x="7025" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7025" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_11&#45;&gt;expert_2_11_1 -->
<g id="edge269" class="edge">
<title>route_2_11&#45;&gt;expert_2_11_1</title>
<path fill="none" stroke="black" d="M6820.92,-9433.43C6860.08,-9421.87 6905.51,-9408.45 6943.56,-9397.22"/>
<polygon fill="black" stroke="black" points="6944.97,-9400.45 6953.57,-9394.26 6942.99,-9393.74 6944.97,-9400.45"/>
</g>
<!-- tp_2_11 -->
<g id="node187" class="node">
<title>tp_2_11</title>
<ellipse fill="lightblue" stroke="black" cx="6730" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6730" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6730" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 86↔87</text>
<text text-anchor="middle" x="6730" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6730" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_11_0&#45;&gt;tp_2_11 -->
<g id="edge270" class="edge">
<title>expert_2_11_0&#45;&gt;tp_2_11</title>
<path fill="none" stroke="black" d="M6730,-9350.08C6730,-9342.41 6730,-9333.46 6730,-9324.66"/>
<polygon fill="black" stroke="black" points="6733.5,-9324.5 6730,-9314.5 6726.5,-9324.5 6733.5,-9324.5"/>
</g>
<!-- expert_2_11_1&#45;&gt;tp_2_11 -->
<g id="edge271" class="edge">
<title>expert_2_11_1&#45;&gt;tp_2_11</title>
<path fill="none" stroke="black" d="M6953.59,-9350.08C6912.13,-9337.84 6859.64,-9322.34 6815.93,-9309.43"/>
<polygon fill="black" stroke="black" points="6816.75,-9306.02 6806.17,-9306.55 6814.77,-9312.74 6816.75,-9306.02"/>
</g>
<!-- tp_2_11&#45;&gt;agg_2 -->
<g id="edge272" class="edge">
<title>tp_2_11&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M6618.21,-9274.49C6524.03,-9268.2 6385.73,-9259.13 6265,-9251.94 5843.96,-9226.87 5354.09,-9200.9 5064.26,-9185.87"/>
<polygon fill="black" stroke="black" points="5064.2,-9182.36 5054.03,-9185.34 5063.84,-9189.35 5064.2,-9182.36"/>
</g>
<!-- expert_2_12_0 -->
<g id="node189" class="node">
<title>expert_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7458.5,-9394.17 7181.5,-9394.17 7181.5,-9350.17 7458.5,-9350.17 7458.5,-9394.17"/>
<text text-anchor="middle" x="7320" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7320" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 88</text>
<text text-anchor="middle" x="7320" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7320" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_12&#45;&gt;expert_2_12_0 -->
<g id="edge274" class="edge">
<title>route_2_12&#45;&gt;expert_2_12_0</title>
<path fill="none" stroke="black" d="M7320,-9429.81C7320,-9421.53 7320,-9412.56 7320,-9404.25"/>
<polygon fill="black" stroke="black" points="7323.5,-9404.17 7320,-9394.17 7316.5,-9404.17 7323.5,-9404.17"/>
</g>
<!-- expert_2_12_1 -->
<g id="node190" class="node">
<title>expert_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7753.5,-9394.17 7476.5,-9394.17 7476.5,-9350.17 7753.5,-9350.17 7753.5,-9394.17"/>
<text text-anchor="middle" x="7615" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7615" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 89</text>
<text text-anchor="middle" x="7615" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7615" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_12&#45;&gt;expert_2_12_1 -->
<g id="edge275" class="edge">
<title>route_2_12&#45;&gt;expert_2_12_1</title>
<path fill="none" stroke="black" d="M7410.92,-9433.43C7450.08,-9421.87 7495.51,-9408.45 7533.56,-9397.22"/>
<polygon fill="black" stroke="black" points="7534.97,-9400.45 7543.57,-9394.26 7532.99,-9393.74 7534.97,-9400.45"/>
</g>
<!-- tp_2_12 -->
<g id="node191" class="node">
<title>tp_2_12</title>
<ellipse fill="lightblue" stroke="black" cx="7320" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7320" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7320" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 88↔89</text>
<text text-anchor="middle" x="7320" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7320" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_12_0&#45;&gt;tp_2_12 -->
<g id="edge276" class="edge">
<title>expert_2_12_0&#45;&gt;tp_2_12</title>
<path fill="none" stroke="black" d="M7320,-9350.08C7320,-9342.41 7320,-9333.46 7320,-9324.66"/>
<polygon fill="black" stroke="black" points="7323.5,-9324.5 7320,-9314.5 7316.5,-9324.5 7323.5,-9324.5"/>
</g>
<!-- expert_2_12_1&#45;&gt;tp_2_12 -->
<g id="edge277" class="edge">
<title>expert_2_12_1&#45;&gt;tp_2_12</title>
<path fill="none" stroke="black" d="M7543.59,-9350.08C7502.13,-9337.84 7449.64,-9322.34 7405.93,-9309.43"/>
<polygon fill="black" stroke="black" points="7406.75,-9306.02 7396.17,-9306.55 7404.77,-9312.74 7406.75,-9306.02"/>
</g>
<!-- tp_2_12&#45;&gt;agg_2 -->
<g id="edge278" class="edge">
<title>tp_2_12&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M7208.71,-9274.03C7114.54,-9267.44 6975.98,-9258.2 6855,-9251.94 6206.3,-9218.4 5441.04,-9192.45 5057.37,-9180.37"/>
<polygon fill="black" stroke="black" points="5057.36,-9176.87 5047.26,-9180.05 5057.14,-9183.86 5057.36,-9176.87"/>
</g>
<!-- expert_2_13_0 -->
<g id="node193" class="node">
<title>expert_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8048.5,-9394.17 7771.5,-9394.17 7771.5,-9350.17 8048.5,-9350.17 8048.5,-9394.17"/>
<text text-anchor="middle" x="7910" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7910" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 90</text>
<text text-anchor="middle" x="7910" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7910" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_13&#45;&gt;expert_2_13_0 -->
<g id="edge280" class="edge">
<title>route_2_13&#45;&gt;expert_2_13_0</title>
<path fill="none" stroke="black" d="M7910,-9429.81C7910,-9421.53 7910,-9412.56 7910,-9404.25"/>
<polygon fill="black" stroke="black" points="7913.5,-9404.17 7910,-9394.17 7906.5,-9404.17 7913.5,-9404.17"/>
</g>
<!-- expert_2_13_1 -->
<g id="node194" class="node">
<title>expert_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8343.5,-9394.17 8066.5,-9394.17 8066.5,-9350.17 8343.5,-9350.17 8343.5,-9394.17"/>
<text text-anchor="middle" x="8205" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8205" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 91</text>
<text text-anchor="middle" x="8205" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8205" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_13&#45;&gt;expert_2_13_1 -->
<g id="edge281" class="edge">
<title>route_2_13&#45;&gt;expert_2_13_1</title>
<path fill="none" stroke="black" d="M8000.92,-9433.43C8040.08,-9421.87 8085.51,-9408.45 8123.56,-9397.22"/>
<polygon fill="black" stroke="black" points="8124.97,-9400.45 8133.57,-9394.26 8122.99,-9393.74 8124.97,-9400.45"/>
</g>
<!-- tp_2_13 -->
<g id="node195" class="node">
<title>tp_2_13</title>
<ellipse fill="lightblue" stroke="black" cx="7910" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7910" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7910" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 90↔91</text>
<text text-anchor="middle" x="7910" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7910" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_13_0&#45;&gt;tp_2_13 -->
<g id="edge282" class="edge">
<title>expert_2_13_0&#45;&gt;tp_2_13</title>
<path fill="none" stroke="black" d="M7910,-9350.08C7910,-9342.41 7910,-9333.46 7910,-9324.66"/>
<polygon fill="black" stroke="black" points="7913.5,-9324.5 7910,-9314.5 7906.5,-9324.5 7913.5,-9324.5"/>
</g>
<!-- expert_2_13_1&#45;&gt;tp_2_13 -->
<g id="edge283" class="edge">
<title>expert_2_13_1&#45;&gt;tp_2_13</title>
<path fill="none" stroke="black" d="M8133.59,-9350.08C8092.13,-9337.84 8039.64,-9322.34 7995.93,-9309.43"/>
<polygon fill="black" stroke="black" points="7996.75,-9306.02 7986.17,-9306.55 7994.77,-9312.74 7996.75,-9306.02"/>
</g>
<!-- tp_2_13&#45;&gt;agg_2 -->
<g id="edge284" class="edge">
<title>tp_2_13&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M7799.2,-9273.8C7705.02,-9267.04 7566.21,-9257.68 7445,-9251.94 6564.43,-9210.23 5517.09,-9186.55 5053.4,-9177.39"/>
<polygon fill="black" stroke="black" points="5053.3,-9173.89 5043.24,-9177.19 5053.17,-9180.88 5053.3,-9173.89"/>
</g>
<!-- expert_2_14_0 -->
<g id="node197" class="node">
<title>expert_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8638.5,-9394.17 8361.5,-9394.17 8361.5,-9350.17 8638.5,-9350.17 8638.5,-9394.17"/>
<text text-anchor="middle" x="8500" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8500" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 92</text>
<text text-anchor="middle" x="8500" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8500" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_14&#45;&gt;expert_2_14_0 -->
<g id="edge286" class="edge">
<title>route_2_14&#45;&gt;expert_2_14_0</title>
<path fill="none" stroke="black" d="M8500,-9429.81C8500,-9421.53 8500,-9412.56 8500,-9404.25"/>
<polygon fill="black" stroke="black" points="8503.5,-9404.17 8500,-9394.17 8496.5,-9404.17 8503.5,-9404.17"/>
</g>
<!-- expert_2_14_1 -->
<g id="node198" class="node">
<title>expert_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8933.5,-9394.17 8656.5,-9394.17 8656.5,-9350.17 8933.5,-9350.17 8933.5,-9394.17"/>
<text text-anchor="middle" x="8795" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8795" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 93</text>
<text text-anchor="middle" x="8795" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8795" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_14&#45;&gt;expert_2_14_1 -->
<g id="edge287" class="edge">
<title>route_2_14&#45;&gt;expert_2_14_1</title>
<path fill="none" stroke="black" d="M8590.92,-9433.43C8630.08,-9421.87 8675.51,-9408.45 8713.56,-9397.22"/>
<polygon fill="black" stroke="black" points="8714.97,-9400.45 8723.57,-9394.26 8712.99,-9393.74 8714.97,-9400.45"/>
</g>
<!-- tp_2_14 -->
<g id="node199" class="node">
<title>tp_2_14</title>
<ellipse fill="lightblue" stroke="black" cx="8500" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8500" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8500" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 92↔93</text>
<text text-anchor="middle" x="8500" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8500" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_14_0&#45;&gt;tp_2_14 -->
<g id="edge288" class="edge">
<title>expert_2_14_0&#45;&gt;tp_2_14</title>
<path fill="none" stroke="black" d="M8500,-9350.08C8500,-9342.41 8500,-9333.46 8500,-9324.66"/>
<polygon fill="black" stroke="black" points="8503.5,-9324.5 8500,-9314.5 8496.5,-9324.5 8503.5,-9324.5"/>
</g>
<!-- expert_2_14_1&#45;&gt;tp_2_14 -->
<g id="edge289" class="edge">
<title>expert_2_14_1&#45;&gt;tp_2_14</title>
<path fill="none" stroke="black" d="M8723.59,-9350.08C8682.13,-9337.84 8629.64,-9322.34 8585.93,-9309.43"/>
<polygon fill="black" stroke="black" points="8586.75,-9306.02 8576.17,-9306.55 8584.77,-9312.74 8586.75,-9306.02"/>
</g>
<!-- tp_2_14&#45;&gt;agg_2 -->
<g id="edge290" class="edge">
<title>tp_2_14&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M8389.2,-9273.63C8295.04,-9266.76 8156.23,-9257.35 8035,-9251.94 6919.96,-9202.19 5586.42,-9182.01 5051.36,-9175.52"/>
<polygon fill="black" stroke="black" points="5051.25,-9172.02 5041.21,-9175.4 5051.16,-9179.02 5051.25,-9172.02"/>
</g>
<!-- expert_2_15_0 -->
<g id="node201" class="node">
<title>expert_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9228.5,-9394.17 8951.5,-9394.17 8951.5,-9350.17 9228.5,-9350.17 9228.5,-9394.17"/>
<text text-anchor="middle" x="9090" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9090" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 94</text>
<text text-anchor="middle" x="9090" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9090" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_15&#45;&gt;expert_2_15_0 -->
<g id="edge292" class="edge">
<title>route_2_15&#45;&gt;expert_2_15_0</title>
<path fill="none" stroke="black" d="M9090,-9429.81C9090,-9421.53 9090,-9412.56 9090,-9404.25"/>
<polygon fill="black" stroke="black" points="9093.5,-9404.17 9090,-9394.17 9086.5,-9404.17 9093.5,-9404.17"/>
</g>
<!-- expert_2_15_1 -->
<g id="node202" class="node">
<title>expert_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9523.5,-9394.17 9246.5,-9394.17 9246.5,-9350.17 9523.5,-9350.17 9523.5,-9394.17"/>
<text text-anchor="middle" x="9385" y="-9384.97" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9385" y="-9374.97" font-family="Times,serif" font-size="9.00">GPU: 95</text>
<text text-anchor="middle" x="9385" y="-9364.97" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9385" y="-9354.97" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_2_15&#45;&gt;expert_2_15_1 -->
<g id="edge293" class="edge">
<title>route_2_15&#45;&gt;expert_2_15_1</title>
<path fill="none" stroke="black" d="M9180.92,-9433.43C9220.08,-9421.87 9265.51,-9408.45 9303.56,-9397.22"/>
<polygon fill="black" stroke="black" points="9304.97,-9400.45 9313.57,-9394.26 9302.99,-9393.74 9304.97,-9400.45"/>
</g>
<!-- tp_2_15 -->
<g id="node203" class="node">
<title>tp_2_15</title>
<ellipse fill="lightblue" stroke="black" cx="9090" cy="-9283.06" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9090" y="-9295.86" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9090" y="-9285.86" font-family="Times,serif" font-size="9.00">GPU: 94↔95</text>
<text text-anchor="middle" x="9090" y="-9275.86" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9090" y="-9265.86" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_2_15_0&#45;&gt;tp_2_15 -->
<g id="edge294" class="edge">
<title>expert_2_15_0&#45;&gt;tp_2_15</title>
<path fill="none" stroke="black" d="M9090,-9350.08C9090,-9342.41 9090,-9333.46 9090,-9324.66"/>
<polygon fill="black" stroke="black" points="9093.5,-9324.5 9090,-9314.5 9086.5,-9324.5 9093.5,-9324.5"/>
</g>
<!-- expert_2_15_1&#45;&gt;tp_2_15 -->
<g id="edge295" class="edge">
<title>expert_2_15_1&#45;&gt;tp_2_15</title>
<path fill="none" stroke="black" d="M9313.59,-9350.08C9272.13,-9337.84 9219.64,-9322.34 9175.93,-9309.43"/>
<polygon fill="black" stroke="black" points="9176.75,-9306.02 9166.17,-9306.55 9174.77,-9312.74 9176.75,-9306.02"/>
</g>
<!-- tp_2_15&#45;&gt;agg_2 -->
<g id="edge296" class="edge">
<title>tp_2_15&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M8979.21,-9273.51C8885.04,-9266.57 8746.24,-9257.12 8625,-9251.94 7272.8,-9194.18 5648.99,-9178.29 5049.41,-9174.24"/>
<polygon fill="black" stroke="black" points="5049.38,-9170.74 5039.35,-9174.17 5049.33,-9177.74 5049.38,-9170.74"/>
</g>
<!-- output_2 -->
<g id="node205" class="node">
<title>output_2</title>
<polygon fill="lightgreen" stroke="black" points="4960,-9091.94 4664,-9091.94 4664,-9047.94 4960,-9047.94 4960,-9091.94"/>
<text text-anchor="middle" x="4812" y="-9082.74" font-family="Times,serif" font-size="9.00">Layer 2 Output</text>
<text text-anchor="middle" x="4812" y="-9072.74" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4812" y="-9062.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4812" y="-9052.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_2&#45;&gt;output_2 -->
<g id="edge297" class="edge">
<title>agg_2&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M4812,-9127.66C4812,-9119.08 4812,-9110.22 4812,-9102.13"/>
<polygon fill="black" stroke="black" points="4815.5,-9102.03 4812,-9092.03 4808.5,-9102.03 4815.5,-9102.03"/>
</g>
<!-- mha_3 -->
<g id="node206" class="node">
<title>mha_3</title>
<polygon fill="lightgreen" stroke="black" points="4960,-9011.94 4664,-9011.94 4664,-8967.94 4960,-8967.94 4960,-9011.94"/>
<text text-anchor="middle" x="4812" y="-9002.74" font-family="Times,serif" font-size="9.00">MHA L3</text>
<text text-anchor="middle" x="4812" y="-8992.74" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4812" y="-8982.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4812" y="-8972.74" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_2&#45;&gt;mha_3 -->
<g id="edge298" class="edge">
<title>output_2&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M4812,-9047.63C4812,-9039.74 4812,-9030.63 4812,-9022.05"/>
<polygon fill="black" stroke="black" points="4815.5,-9021.96 4812,-9011.96 4808.5,-9021.96 4815.5,-9021.96"/>
</g>
<!-- gate_3 -->
<g id="node207" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="5111.74,-8931.94 4634.92,-8931.94 4512.26,-8843.94 4989.08,-8843.94 5111.74,-8931.94"/>
<text text-anchor="middle" x="4812" y="-8900.74" font-family="Times,serif" font-size="9.00">Gate L3</text>
<text text-anchor="middle" x="4812" y="-8890.74" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4812" y="-8880.74" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4812" y="-8870.74" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_3&#45;&gt;gate_3 -->
<g id="edge299" class="edge">
<title>mha_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M4812,-8967.74C4812,-8960.24 4812,-8951.43 4812,-8942.47"/>
<polygon fill="black" stroke="black" points="4815.5,-8942.35 4812,-8932.35 4808.5,-8942.35 4815.5,-8942.35"/>
</g>
<!-- route_3_0 -->
<g id="node208" class="node">
<title>route_3_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="535" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="535" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="535" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 96,97</text>
<text text-anchor="middle" x="535" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="535" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_0 -->
<g id="edge300" class="edge">
<title>gate_3&#45;&gt;route_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4572.09,-8886.98C3961.43,-8886.02 2298.63,-8876.73 915,-8807.94 849.75,-8804.7 778.32,-8799.48 715.17,-8794.29"/>
<polygon fill="black" stroke="black" points="715.36,-8790.79 705.11,-8793.46 714.79,-8797.77 715.36,-8790.79"/>
</g>
<!-- route_3_1 -->
<g id="node212" class="node">
<title>route_3_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1125" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1125" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1125" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 98,99</text>
<text text-anchor="middle" x="1125" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1125" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_1 -->
<g id="edge306" class="edge">
<title>gate_3&#45;&gt;route_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4570.4,-8885.74C4023.99,-8882.01 2651.53,-8867.02 1505,-8807.94 1439.91,-8804.59 1368.67,-8799.36 1305.63,-8794.19"/>
<polygon fill="black" stroke="black" points="1305.84,-8790.7 1295.59,-8793.37 1305.27,-8797.68 1305.84,-8790.7"/>
</g>
<!-- route_3_2 -->
<g id="node216" class="node">
<title>route_3_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1715" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1715" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1715" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 100,101</text>
<text text-anchor="middle" x="1715" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1715" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_2 -->
<g id="edge312" class="edge">
<title>gate_3&#45;&gt;route_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4567.82,-8883.93C4091.8,-8877.16 3006.5,-8857.28 2095,-8807.94 2030.08,-8804.43 1959.02,-8799.18 1896.1,-8794.04"/>
<polygon fill="black" stroke="black" points="1896.32,-8790.55 1886.07,-8793.22 1895.75,-8797.52 1896.32,-8790.55"/>
</g>
<!-- route_3_3 -->
<g id="node220" class="node">
<title>route_3_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2305" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2305" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2305" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 102,103</text>
<text text-anchor="middle" x="2305" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2305" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_3 -->
<g id="edge318" class="edge">
<title>gate_3&#45;&gt;route_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4563.78,-8881.1C4166.71,-8871 3364.24,-8847.45 2685,-8807.94 2620.41,-8804.19 2549.73,-8798.91 2487.03,-8793.82"/>
<polygon fill="black" stroke="black" points="2487.29,-8790.33 2477.04,-8793 2486.72,-8797.3 2487.29,-8790.33"/>
</g>
<!-- route_3_4 -->
<g id="node224" class="node">
<title>route_3_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2895" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2895" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2895" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 104,105</text>
<text text-anchor="middle" x="2895" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2895" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_4 -->
<g id="edge324" class="edge">
<title>gate_3&#45;&gt;route_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4556.91,-8876C4251.88,-8862.41 3725.93,-8837.39 3275,-8807.94 3211.04,-8803.77 3141.08,-8798.44 3078.82,-8793.43"/>
<polygon fill="black" stroke="black" points="3078.74,-8789.91 3068.49,-8792.6 3078.18,-8796.89 3078.74,-8789.91"/>
</g>
<!-- route_3_5 -->
<g id="node228" class="node">
<title>route_3_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3485" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3485" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3485" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 106,107</text>
<text text-anchor="middle" x="3485" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3485" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_5 -->
<g id="edge330" class="edge">
<title>gate_3&#45;&gt;route_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4541.06,-8864.67C4281.32,-8843.31 3896.23,-8811.64 3669.92,-8793.04"/>
<polygon fill="black" stroke="black" points="3670.18,-8789.55 3659.93,-8792.21 3669.61,-8796.52 3670.18,-8789.55"/>
</g>
<!-- route_3_6 -->
<g id="node232" class="node">
<title>route_3_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4075" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4075" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4075" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 108,109</text>
<text text-anchor="middle" x="4075" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4075" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_6 -->
<g id="edge336" class="edge">
<title>gate_3&#45;&gt;route_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4521.51,-8843.94C4420.8,-8829.03 4311.94,-8812.91 4226.92,-8800.32"/>
<polygon fill="black" stroke="black" points="4227.34,-8796.85 4216.93,-8798.84 4226.31,-8803.77 4227.34,-8796.85"/>
</g>
<!-- route_3_7 -->
<g id="node236" class="node">
<title>route_3_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4602" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4602" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4602" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 110,111</text>
<text text-anchor="middle" x="4602" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4602" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_7 -->
<g id="edge342" class="edge">
<title>gate_3&#45;&gt;route_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4729,-8843.82C4708.22,-8833.02 4686.24,-8821.6 4666.51,-8811.35"/>
<polygon fill="black" stroke="black" points="4668.1,-8808.23 4657.62,-8806.73 4664.88,-8814.45 4668.1,-8808.23"/>
</g>
<!-- route_3_8 -->
<g id="node240" class="node">
<title>route_3_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5022" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5022" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5022" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 112,113</text>
<text text-anchor="middle" x="5022" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5022" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_8 -->
<g id="edge348" class="edge">
<title>gate_3&#45;&gt;route_3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4895,-8843.82C4915.78,-8833.02 4937.76,-8821.6 4957.49,-8811.35"/>
<polygon fill="black" stroke="black" points="4959.12,-8814.45 4966.38,-8806.73 4955.9,-8808.23 4959.12,-8814.45"/>
</g>
<!-- route_3_9 -->
<g id="node244" class="node">
<title>route_3_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5550" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5550" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5550" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 114,115</text>
<text text-anchor="middle" x="5550" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5550" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_9 -->
<g id="edge354" class="edge">
<title>gate_3&#45;&gt;route_3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5008.8,-8857.85C5130.76,-8839.81 5285.08,-8817 5397.69,-8800.35"/>
<polygon fill="black" stroke="black" points="5398.39,-8803.78 5407.77,-8798.86 5397.37,-8796.86 5398.39,-8803.78"/>
</g>
<!-- route_3_10 -->
<g id="node248" class="node">
<title>route_3_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6140" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6140" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6140" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 116,117</text>
<text text-anchor="middle" x="6140" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6140" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_10 -->
<g id="edge360" class="edge">
<title>gate_3&#45;&gt;route_3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025,-8869.44C5282.37,-8848.3 5711.14,-8813.07 5955.18,-8793.02"/>
<polygon fill="black" stroke="black" points="5955.54,-8796.5 5965.22,-8792.19 5954.96,-8789.52 5955.54,-8796.5"/>
</g>
<!-- route_3_11 -->
<g id="node252" class="node">
<title>route_3_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6730" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6730" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6730" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 118,119</text>
<text text-anchor="middle" x="6730" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6730" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_11 -->
<g id="edge366" class="edge">
<title>gate_3&#45;&gt;route_3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5035.94,-8877.39C5335.44,-8864.17 5882.94,-8838.44 6350,-8807.94 6413.96,-8803.77 6483.92,-8798.44 6546.18,-8793.43"/>
<polygon fill="black" stroke="black" points="6546.82,-8796.89 6556.51,-8792.6 6546.26,-8789.91 6546.82,-8796.89"/>
</g>
<!-- route_3_12 -->
<g id="node256" class="node">
<title>route_3_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7320" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7320" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7320" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 120,121</text>
<text text-anchor="middle" x="7320" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7320" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_12 -->
<g id="edge372" class="edge">
<title>gate_3&#45;&gt;route_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5041.64,-8881.58C5431.94,-8871.75 6249.6,-8848.1 6940,-8807.94 7004.59,-8804.19 7075.27,-8798.91 7137.97,-8793.82"/>
<polygon fill="black" stroke="black" points="7138.28,-8797.3 7147.96,-8793 7137.71,-8790.33 7138.28,-8797.3"/>
</g>
<!-- route_3_13 -->
<g id="node260" class="node">
<title>route_3_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7910" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7910" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7910" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 122,123</text>
<text text-anchor="middle" x="7910" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7910" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_13 -->
<g id="edge378" class="edge">
<title>gate_3&#45;&gt;route_3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.3,-8884.09C5515.62,-8877.48 6611.09,-8857.68 7530,-8807.94 7594.92,-8804.43 7665.98,-8799.18 7728.9,-8794.04"/>
<polygon fill="black" stroke="black" points="7729.25,-8797.52 7738.93,-8793.22 7728.68,-8790.55 7729.25,-8797.52"/>
</g>
<!-- route_3_14 -->
<g id="node264" class="node">
<title>route_3_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8500" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8500" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8500" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 124,125</text>
<text text-anchor="middle" x="8500" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8500" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_14 -->
<g id="edge384" class="edge">
<title>gate_3&#45;&gt;route_3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5047.56,-8885.78C5589.95,-8882.12 6968.82,-8867.26 8120,-8807.94 8185.09,-8804.59 8256.33,-8799.36 8319.37,-8794.19"/>
<polygon fill="black" stroke="black" points="8319.73,-8797.68 8329.41,-8793.37 8319.16,-8790.7 8319.73,-8797.68"/>
</g>
<!-- route_3_15 -->
<g id="node268" class="node">
<title>route_3_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9090" cy="-8776.83" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9090" y="-8789.63" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9090" y="-8779.63" font-family="Times,serif" font-size="9.00">GPU: 126,127</text>
<text text-anchor="middle" x="9090" y="-8769.63" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9090" y="-8759.63" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_3&#45;&gt;route_3_15 -->
<g id="edge390" class="edge">
<title>gate_3&#45;&gt;route_3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5049.19,-8886.99C5657.71,-8886.06 7323.91,-8876.85 8710,-8807.94 8775.25,-8804.7 8846.68,-8799.48 8909.83,-8794.29"/>
<polygon fill="black" stroke="black" points="8910.21,-8797.77 8919.89,-8793.46 8909.64,-8790.79 8910.21,-8797.77"/>
</g>
<!-- expert_3_0_0 -->
<g id="node209" class="node">
<title>expert_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="378.5,-8709.72 101.5,-8709.72 101.5,-8665.72 378.5,-8665.72 378.5,-8709.72"/>
<text text-anchor="middle" x="240" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="240" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 96</text>
<text text-anchor="middle" x="240" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="240" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_0&#45;&gt;expert_3_0_0 -->
<g id="edge301" class="edge">
<title>route_3_0&#45;&gt;expert_3_0_0</title>
<path fill="none" stroke="black" d="M444.08,-8748.98C404.92,-8737.42 359.49,-8724 321.44,-8712.77"/>
<polygon fill="black" stroke="black" points="322.01,-8709.29 311.43,-8709.81 320.03,-8716 322.01,-8709.29"/>
</g>
<!-- expert_3_0_1 -->
<g id="node210" class="node">
<title>expert_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="673.5,-8709.72 396.5,-8709.72 396.5,-8665.72 673.5,-8665.72 673.5,-8709.72"/>
<text text-anchor="middle" x="535" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="535" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 97</text>
<text text-anchor="middle" x="535" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="535" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_0&#45;&gt;expert_3_0_1 -->
<g id="edge302" class="edge">
<title>route_3_0&#45;&gt;expert_3_0_1</title>
<path fill="none" stroke="black" d="M535,-8745.36C535,-8737.08 535,-8728.11 535,-8719.8"/>
<polygon fill="black" stroke="black" points="538.5,-8719.72 535,-8709.72 531.5,-8719.72 538.5,-8719.72"/>
</g>
<!-- tp_3_0 -->
<g id="node211" class="node">
<title>tp_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="535" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="535" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="535" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 96↔97</text>
<text text-anchor="middle" x="535" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="535" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_0_0&#45;&gt;tp_3_0 -->
<g id="edge303" class="edge">
<title>expert_3_0_0&#45;&gt;tp_3_0</title>
<path fill="none" stroke="black" d="M311.41,-8665.63C352.87,-8653.39 405.36,-8637.89 449.07,-8624.98"/>
<polygon fill="black" stroke="black" points="450.23,-8628.29 458.83,-8622.1 448.25,-8621.57 450.23,-8628.29"/>
</g>
<!-- expert_3_0_1&#45;&gt;tp_3_0 -->
<g id="edge304" class="edge">
<title>expert_3_0_1&#45;&gt;tp_3_0</title>
<path fill="none" stroke="black" d="M535,-8665.63C535,-8657.96 535,-8649 535,-8640.21"/>
<polygon fill="black" stroke="black" points="538.5,-8640.05 535,-8630.05 531.5,-8640.05 538.5,-8640.05"/>
</g>
<!-- agg_3 -->
<g id="node272" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="5090.99,-8531.49 4642.4,-8531.49 4527.01,-8443.49 4975.6,-8443.49 5090.99,-8531.49"/>
<text text-anchor="middle" x="4809" y="-8500.29" font-family="Times,serif" font-size="9.00">Aggregate Experts L3</text>
<text text-anchor="middle" x="4809" y="-8490.29" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4809" y="-8480.29" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4809" y="-8470.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_3_0&#45;&gt;agg_3 -->
<g id="edge305" class="edge">
<title>tp_3_0&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M645.79,-8589.06C739.96,-8582.12 878.76,-8572.67 1000,-8567.49 2354.76,-8509.61 3982.45,-8493.77 4577.1,-8489.76"/>
<polygon fill="black" stroke="black" points="4577.53,-8493.25 4587.51,-8489.69 4577.49,-8486.25 4577.53,-8493.25"/>
</g>
<!-- expert_3_1_0 -->
<g id="node213" class="node">
<title>expert_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="968.5,-8709.72 691.5,-8709.72 691.5,-8665.72 968.5,-8665.72 968.5,-8709.72"/>
<text text-anchor="middle" x="830" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="830" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 98</text>
<text text-anchor="middle" x="830" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="830" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_1&#45;&gt;expert_3_1_0 -->
<g id="edge307" class="edge">
<title>route_3_1&#45;&gt;expert_3_1_0</title>
<path fill="none" stroke="black" d="M1034.08,-8748.98C994.92,-8737.42 949.49,-8724 911.44,-8712.77"/>
<polygon fill="black" stroke="black" points="912.01,-8709.29 901.43,-8709.81 910.03,-8716 912.01,-8709.29"/>
</g>
<!-- expert_3_1_1 -->
<g id="node214" class="node">
<title>expert_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1263.5,-8709.72 986.5,-8709.72 986.5,-8665.72 1263.5,-8665.72 1263.5,-8709.72"/>
<text text-anchor="middle" x="1125" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1125" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 99</text>
<text text-anchor="middle" x="1125" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1125" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_1&#45;&gt;expert_3_1_1 -->
<g id="edge308" class="edge">
<title>route_3_1&#45;&gt;expert_3_1_1</title>
<path fill="none" stroke="black" d="M1125,-8745.36C1125,-8737.08 1125,-8728.11 1125,-8719.8"/>
<polygon fill="black" stroke="black" points="1128.5,-8719.72 1125,-8709.72 1121.5,-8719.72 1128.5,-8719.72"/>
</g>
<!-- tp_3_1 -->
<g id="node215" class="node">
<title>tp_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="1125" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1125" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1125" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 98↔99</text>
<text text-anchor="middle" x="1125" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1125" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_1_0&#45;&gt;tp_3_1 -->
<g id="edge309" class="edge">
<title>expert_3_1_0&#45;&gt;tp_3_1</title>
<path fill="none" stroke="black" d="M901.41,-8665.63C942.87,-8653.39 995.36,-8637.89 1039.07,-8624.98"/>
<polygon fill="black" stroke="black" points="1040.23,-8628.29 1048.83,-8622.1 1038.25,-8621.57 1040.23,-8628.29"/>
</g>
<!-- expert_3_1_1&#45;&gt;tp_3_1 -->
<g id="edge310" class="edge">
<title>expert_3_1_1&#45;&gt;tp_3_1</title>
<path fill="none" stroke="black" d="M1125,-8665.63C1125,-8657.96 1125,-8649 1125,-8640.21"/>
<polygon fill="black" stroke="black" points="1128.5,-8640.05 1125,-8630.05 1121.5,-8640.05 1128.5,-8640.05"/>
</g>
<!-- tp_3_1&#45;&gt;agg_3 -->
<g id="edge311" class="edge">
<title>tp_3_1&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1235.8,-8589.18C1329.96,-8582.31 1468.77,-8572.9 1590,-8567.49 2709.9,-8517.51 4050.48,-8497.36 4578.85,-8490.97"/>
<polygon fill="black" stroke="black" points="4578.92,-8494.47 4588.87,-8490.85 4578.83,-8487.47 4578.92,-8494.47"/>
</g>
<!-- expert_3_2_0 -->
<g id="node217" class="node">
<title>expert_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1558.5,-8709.72 1281.5,-8709.72 1281.5,-8665.72 1558.5,-8665.72 1558.5,-8709.72"/>
<text text-anchor="middle" x="1420" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1420" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 100</text>
<text text-anchor="middle" x="1420" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1420" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_2&#45;&gt;expert_3_2_0 -->
<g id="edge313" class="edge">
<title>route_3_2&#45;&gt;expert_3_2_0</title>
<path fill="none" stroke="black" d="M1624.08,-8748.98C1584.92,-8737.42 1539.49,-8724 1501.44,-8712.77"/>
<polygon fill="black" stroke="black" points="1502.01,-8709.29 1491.43,-8709.81 1500.03,-8716 1502.01,-8709.29"/>
</g>
<!-- expert_3_2_1 -->
<g id="node218" class="node">
<title>expert_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1853.5,-8709.72 1576.5,-8709.72 1576.5,-8665.72 1853.5,-8665.72 1853.5,-8709.72"/>
<text text-anchor="middle" x="1715" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1715" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 101</text>
<text text-anchor="middle" x="1715" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1715" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_2&#45;&gt;expert_3_2_1 -->
<g id="edge314" class="edge">
<title>route_3_2&#45;&gt;expert_3_2_1</title>
<path fill="none" stroke="black" d="M1715,-8745.36C1715,-8737.08 1715,-8728.11 1715,-8719.8"/>
<polygon fill="black" stroke="black" points="1718.5,-8719.72 1715,-8709.72 1711.5,-8719.72 1718.5,-8719.72"/>
</g>
<!-- tp_3_2 -->
<g id="node219" class="node">
<title>tp_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="1715" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1715" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1715" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 100↔101</text>
<text text-anchor="middle" x="1715" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1715" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_2_0&#45;&gt;tp_3_2 -->
<g id="edge315" class="edge">
<title>expert_3_2_0&#45;&gt;tp_3_2</title>
<path fill="none" stroke="black" d="M1491.41,-8665.63C1532.87,-8653.39 1585.36,-8637.89 1629.07,-8624.98"/>
<polygon fill="black" stroke="black" points="1630.23,-8628.29 1638.83,-8622.1 1628.25,-8621.57 1630.23,-8628.29"/>
</g>
<!-- expert_3_2_1&#45;&gt;tp_3_2 -->
<g id="edge316" class="edge">
<title>expert_3_2_1&#45;&gt;tp_3_2</title>
<path fill="none" stroke="black" d="M1715,-8665.63C1715,-8657.96 1715,-8649 1715,-8640.21"/>
<polygon fill="black" stroke="black" points="1718.5,-8640.05 1715,-8630.05 1711.5,-8640.05 1718.5,-8640.05"/>
</g>
<!-- tp_3_2&#45;&gt;agg_3 -->
<g id="edge317" class="edge">
<title>tp_3_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M1825.8,-8589.35C1919.98,-8582.59 2058.79,-8573.24 2180,-8567.49 3067.51,-8525.43 4124.68,-8501.67 4580.87,-8492.69"/>
<polygon fill="black" stroke="black" points="4581.28,-8496.18 4591.2,-8492.49 4581.14,-8489.18 4581.28,-8496.18"/>
</g>
<!-- expert_3_3_0 -->
<g id="node221" class="node">
<title>expert_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2148.5,-8709.72 1871.5,-8709.72 1871.5,-8665.72 2148.5,-8665.72 2148.5,-8709.72"/>
<text text-anchor="middle" x="2010" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2010" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 102</text>
<text text-anchor="middle" x="2010" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2010" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_3&#45;&gt;expert_3_3_0 -->
<g id="edge319" class="edge">
<title>route_3_3&#45;&gt;expert_3_3_0</title>
<path fill="none" stroke="black" d="M2214.08,-8748.98C2174.92,-8737.42 2129.49,-8724 2091.44,-8712.77"/>
<polygon fill="black" stroke="black" points="2092.01,-8709.29 2081.43,-8709.81 2090.03,-8716 2092.01,-8709.29"/>
</g>
<!-- expert_3_3_1 -->
<g id="node222" class="node">
<title>expert_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2443.5,-8709.72 2166.5,-8709.72 2166.5,-8665.72 2443.5,-8665.72 2443.5,-8709.72"/>
<text text-anchor="middle" x="2305" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2305" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 103</text>
<text text-anchor="middle" x="2305" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2305" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_3&#45;&gt;expert_3_3_1 -->
<g id="edge320" class="edge">
<title>route_3_3&#45;&gt;expert_3_3_1</title>
<path fill="none" stroke="black" d="M2305,-8745.36C2305,-8737.08 2305,-8728.11 2305,-8719.8"/>
<polygon fill="black" stroke="black" points="2308.5,-8719.72 2305,-8709.72 2301.5,-8719.72 2308.5,-8719.72"/>
</g>
<!-- tp_3_3 -->
<g id="node223" class="node">
<title>tp_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="2305" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2305" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2305" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 102↔103</text>
<text text-anchor="middle" x="2305" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2305" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_3_0&#45;&gt;tp_3_3 -->
<g id="edge321" class="edge">
<title>expert_3_3_0&#45;&gt;tp_3_3</title>
<path fill="none" stroke="black" d="M2081.41,-8665.63C2122.87,-8653.39 2175.36,-8637.89 2219.07,-8624.98"/>
<polygon fill="black" stroke="black" points="2220.23,-8628.29 2228.83,-8622.1 2218.25,-8621.57 2220.23,-8628.29"/>
</g>
<!-- expert_3_3_1&#45;&gt;tp_3_3 -->
<g id="edge322" class="edge">
<title>expert_3_3_1&#45;&gt;tp_3_3</title>
<path fill="none" stroke="black" d="M2305,-8665.63C2305,-8657.96 2305,-8649 2305,-8640.21"/>
<polygon fill="black" stroke="black" points="2308.5,-8640.05 2305,-8630.05 2301.5,-8640.05 2308.5,-8640.05"/>
</g>
<!-- tp_3_3&#45;&gt;agg_3 -->
<g id="edge323" class="edge">
<title>tp_3_3&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M2416.29,-8589.58C2510.46,-8582.99 2649.02,-8573.75 2770,-8567.49 3428.89,-8533.4 4208.25,-8507.1 4584.07,-8495.3"/>
<polygon fill="black" stroke="black" points="4584.36,-8498.79 4594.25,-8494.98 4584.14,-8491.8 4584.36,-8498.79"/>
</g>
<!-- expert_3_4_0 -->
<g id="node225" class="node">
<title>expert_3_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2738.5,-8709.72 2461.5,-8709.72 2461.5,-8665.72 2738.5,-8665.72 2738.5,-8709.72"/>
<text text-anchor="middle" x="2600" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2600" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 104</text>
<text text-anchor="middle" x="2600" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2600" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_4&#45;&gt;expert_3_4_0 -->
<g id="edge325" class="edge">
<title>route_3_4&#45;&gt;expert_3_4_0</title>
<path fill="none" stroke="black" d="M2804.08,-8748.98C2764.92,-8737.42 2719.49,-8724 2681.44,-8712.77"/>
<polygon fill="black" stroke="black" points="2682.01,-8709.29 2671.43,-8709.81 2680.03,-8716 2682.01,-8709.29"/>
</g>
<!-- expert_3_4_1 -->
<g id="node226" class="node">
<title>expert_3_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3033.5,-8709.72 2756.5,-8709.72 2756.5,-8665.72 3033.5,-8665.72 3033.5,-8709.72"/>
<text text-anchor="middle" x="2895" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2895" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 105</text>
<text text-anchor="middle" x="2895" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2895" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_4&#45;&gt;expert_3_4_1 -->
<g id="edge326" class="edge">
<title>route_3_4&#45;&gt;expert_3_4_1</title>
<path fill="none" stroke="black" d="M2895,-8745.36C2895,-8737.08 2895,-8728.11 2895,-8719.8"/>
<polygon fill="black" stroke="black" points="2898.5,-8719.72 2895,-8709.72 2891.5,-8719.72 2898.5,-8719.72"/>
</g>
<!-- tp_3_4 -->
<g id="node227" class="node">
<title>tp_3_4</title>
<ellipse fill="lightblue" stroke="black" cx="2895" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2895" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2895" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 104↔105</text>
<text text-anchor="middle" x="2895" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2895" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_4_0&#45;&gt;tp_3_4 -->
<g id="edge327" class="edge">
<title>expert_3_4_0&#45;&gt;tp_3_4</title>
<path fill="none" stroke="black" d="M2671.41,-8665.63C2712.87,-8653.39 2765.36,-8637.89 2809.07,-8624.98"/>
<polygon fill="black" stroke="black" points="2810.23,-8628.29 2818.83,-8622.1 2808.25,-8621.57 2810.23,-8628.29"/>
</g>
<!-- expert_3_4_1&#45;&gt;tp_3_4 -->
<g id="edge328" class="edge">
<title>expert_3_4_1&#45;&gt;tp_3_4</title>
<path fill="none" stroke="black" d="M2895,-8665.63C2895,-8657.96 2895,-8649 2895,-8640.21"/>
<polygon fill="black" stroke="black" points="2898.5,-8640.05 2895,-8630.05 2891.5,-8640.05 2898.5,-8640.05"/>
</g>
<!-- tp_3_4&#45;&gt;agg_3 -->
<g id="edge329" class="edge">
<title>tp_3_4&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3006.79,-8590.05C3100.97,-8583.75 3239.27,-8574.69 3360,-8567.49 3796.04,-8541.49 4306.09,-8514.47 4589.9,-8499.74"/>
<polygon fill="black" stroke="black" points="4590.09,-8503.24 4599.9,-8499.22 4589.73,-8496.25 4590.09,-8503.24"/>
</g>
<!-- expert_3_5_0 -->
<g id="node229" class="node">
<title>expert_3_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3328.5,-8709.72 3051.5,-8709.72 3051.5,-8665.72 3328.5,-8665.72 3328.5,-8709.72"/>
<text text-anchor="middle" x="3190" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3190" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 106</text>
<text text-anchor="middle" x="3190" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3190" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_5&#45;&gt;expert_3_5_0 -->
<g id="edge331" class="edge">
<title>route_3_5&#45;&gt;expert_3_5_0</title>
<path fill="none" stroke="black" d="M3394.08,-8748.98C3354.92,-8737.42 3309.49,-8724 3271.44,-8712.77"/>
<polygon fill="black" stroke="black" points="3272.01,-8709.29 3261.43,-8709.81 3270.03,-8716 3272.01,-8709.29"/>
</g>
<!-- expert_3_5_1 -->
<g id="node230" class="node">
<title>expert_3_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3623.5,-8709.72 3346.5,-8709.72 3346.5,-8665.72 3623.5,-8665.72 3623.5,-8709.72"/>
<text text-anchor="middle" x="3485" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3485" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 107</text>
<text text-anchor="middle" x="3485" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3485" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_5&#45;&gt;expert_3_5_1 -->
<g id="edge332" class="edge">
<title>route_3_5&#45;&gt;expert_3_5_1</title>
<path fill="none" stroke="black" d="M3485,-8745.36C3485,-8737.08 3485,-8728.11 3485,-8719.8"/>
<polygon fill="black" stroke="black" points="3488.5,-8719.72 3485,-8709.72 3481.5,-8719.72 3488.5,-8719.72"/>
</g>
<!-- tp_3_5 -->
<g id="node231" class="node">
<title>tp_3_5</title>
<ellipse fill="lightblue" stroke="black" cx="3485" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3485" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3485" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 106↔107</text>
<text text-anchor="middle" x="3485" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3485" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_5_0&#45;&gt;tp_3_5 -->
<g id="edge333" class="edge">
<title>expert_3_5_0&#45;&gt;tp_3_5</title>
<path fill="none" stroke="black" d="M3261.41,-8665.63C3302.87,-8653.39 3355.36,-8637.89 3399.07,-8624.98"/>
<polygon fill="black" stroke="black" points="3400.23,-8628.29 3408.83,-8622.1 3398.25,-8621.57 3400.23,-8628.29"/>
</g>
<!-- expert_3_5_1&#45;&gt;tp_3_5 -->
<g id="edge334" class="edge">
<title>expert_3_5_1&#45;&gt;tp_3_5</title>
<path fill="none" stroke="black" d="M3485,-8665.63C3485,-8657.96 3485,-8649 3485,-8640.21"/>
<polygon fill="black" stroke="black" points="3488.5,-8640.05 3485,-8630.05 3481.5,-8640.05 3488.5,-8640.05"/>
</g>
<!-- tp_3_5&#45;&gt;agg_3 -->
<g id="edge335" class="edge">
<title>tp_3_5&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M3594.76,-8588.56C3814.59,-8570.44 4312.22,-8529.43 4597.5,-8505.92"/>
<polygon fill="black" stroke="black" points="4597.88,-8509.4 4607.55,-8505.09 4597.3,-8502.43 4597.88,-8509.4"/>
</g>
<!-- expert_3_6_0 -->
<g id="node233" class="node">
<title>expert_3_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3918.5,-8709.72 3641.5,-8709.72 3641.5,-8665.72 3918.5,-8665.72 3918.5,-8709.72"/>
<text text-anchor="middle" x="3780" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3780" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 108</text>
<text text-anchor="middle" x="3780" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3780" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_6&#45;&gt;expert_3_6_0 -->
<g id="edge337" class="edge">
<title>route_3_6&#45;&gt;expert_3_6_0</title>
<path fill="none" stroke="black" d="M3984.08,-8748.98C3944.92,-8737.42 3899.49,-8724 3861.44,-8712.77"/>
<polygon fill="black" stroke="black" points="3862.01,-8709.29 3851.43,-8709.81 3860.03,-8716 3862.01,-8709.29"/>
</g>
<!-- expert_3_6_1 -->
<g id="node234" class="node">
<title>expert_3_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4213.5,-8709.72 3936.5,-8709.72 3936.5,-8665.72 4213.5,-8665.72 4213.5,-8709.72"/>
<text text-anchor="middle" x="4075" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4075" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 109</text>
<text text-anchor="middle" x="4075" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4075" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_6&#45;&gt;expert_3_6_1 -->
<g id="edge338" class="edge">
<title>route_3_6&#45;&gt;expert_3_6_1</title>
<path fill="none" stroke="black" d="M4075,-8745.36C4075,-8737.08 4075,-8728.11 4075,-8719.8"/>
<polygon fill="black" stroke="black" points="4078.5,-8719.72 4075,-8709.72 4071.5,-8719.72 4078.5,-8719.72"/>
</g>
<!-- tp_3_6 -->
<g id="node235" class="node">
<title>tp_3_6</title>
<ellipse fill="lightblue" stroke="black" cx="4075" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4075" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4075" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 108↔109</text>
<text text-anchor="middle" x="4075" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4075" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_6_0&#45;&gt;tp_3_6 -->
<g id="edge339" class="edge">
<title>expert_3_6_0&#45;&gt;tp_3_6</title>
<path fill="none" stroke="black" d="M3851.41,-8665.63C3892.87,-8653.39 3945.36,-8637.89 3989.07,-8624.98"/>
<polygon fill="black" stroke="black" points="3990.23,-8628.29 3998.83,-8622.1 3988.25,-8621.57 3990.23,-8628.29"/>
</g>
<!-- expert_3_6_1&#45;&gt;tp_3_6 -->
<g id="edge340" class="edge">
<title>expert_3_6_1&#45;&gt;tp_3_6</title>
<path fill="none" stroke="black" d="M4075,-8665.63C4075,-8657.96 4075,-8649 4075,-8640.21"/>
<polygon fill="black" stroke="black" points="4078.5,-8640.05 4075,-8630.05 4071.5,-8640.05 4078.5,-8640.05"/>
</g>
<!-- tp_3_6&#45;&gt;agg_3 -->
<g id="edge341" class="edge">
<title>tp_3_6&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M4175.14,-8582.72C4287.1,-8566.08 4471.2,-8538.71 4612.22,-8517.75"/>
<polygon fill="black" stroke="black" points="4612.92,-8521.18 4622.3,-8516.25 4611.89,-8514.26 4612.92,-8521.18"/>
</g>
<!-- expert_3_7_0 -->
<g id="node237" class="node">
<title>expert_3_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4508.5,-8709.72 4231.5,-8709.72 4231.5,-8665.72 4508.5,-8665.72 4508.5,-8709.72"/>
<text text-anchor="middle" x="4370" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4370" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 110</text>
<text text-anchor="middle" x="4370" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4370" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_7&#45;&gt;expert_3_7_0 -->
<g id="edge343" class="edge">
<title>route_3_7&#45;&gt;expert_3_7_0</title>
<path fill="none" stroke="black" d="M4527.64,-8747.91C4498.11,-8736.82 4464.42,-8724.17 4435.8,-8713.42"/>
<polygon fill="black" stroke="black" points="4436.89,-8710.09 4426.29,-8709.86 4434.43,-8716.65 4436.89,-8710.09"/>
</g>
<!-- expert_3_7_1 -->
<g id="node238" class="node">
<title>expert_3_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4803.5,-8709.72 4526.5,-8709.72 4526.5,-8665.72 4803.5,-8665.72 4803.5,-8709.72"/>
<text text-anchor="middle" x="4665" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4665" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 111</text>
<text text-anchor="middle" x="4665" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4665" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_7&#45;&gt;expert_3_7_1 -->
<g id="edge344" class="edge">
<title>route_3_7&#45;&gt;expert_3_7_1</title>
<path fill="none" stroke="black" d="M4623.68,-8745.85C4630.15,-8736.9 4637.24,-8727.1 4643.69,-8718.18"/>
<polygon fill="black" stroke="black" points="4646.61,-8720.11 4649.64,-8709.96 4640.94,-8716.01 4646.61,-8720.11"/>
</g>
<!-- tp_3_7 -->
<g id="node239" class="node">
<title>tp_3_7</title>
<ellipse fill="lightblue" stroke="black" cx="4665" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4665" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4665" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 110↔111</text>
<text text-anchor="middle" x="4665" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4665" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_7_0&#45;&gt;tp_3_7 -->
<g id="edge345" class="edge">
<title>expert_3_7_0&#45;&gt;tp_3_7</title>
<path fill="none" stroke="black" d="M4441.41,-8665.63C4482.87,-8653.39 4535.36,-8637.89 4579.07,-8624.98"/>
<polygon fill="black" stroke="black" points="4580.23,-8628.29 4588.83,-8622.1 4578.25,-8621.57 4580.23,-8628.29"/>
</g>
<!-- expert_3_7_1&#45;&gt;tp_3_7 -->
<g id="edge346" class="edge">
<title>expert_3_7_1&#45;&gt;tp_3_7</title>
<path fill="none" stroke="black" d="M4665,-8665.63C4665,-8657.96 4665,-8649 4665,-8640.21"/>
<polygon fill="black" stroke="black" points="4668.5,-8640.05 4665,-8630.05 4661.5,-8640.05 4668.5,-8640.05"/>
</g>
<!-- tp_3_7&#45;&gt;agg_3 -->
<g id="edge347" class="edge">
<title>tp_3_7&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M4702.83,-8568.94C4715.44,-8559.38 4729.87,-8548.45 4743.94,-8537.79"/>
<polygon fill="black" stroke="black" points="4746.31,-8540.38 4752.17,-8531.56 4742.08,-8534.81 4746.31,-8540.38"/>
</g>
<!-- expert_3_8_0 -->
<g id="node241" class="node">
<title>expert_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5098.5,-8709.72 4821.5,-8709.72 4821.5,-8665.72 5098.5,-8665.72 5098.5,-8709.72"/>
<text text-anchor="middle" x="4960" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4960" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 112</text>
<text text-anchor="middle" x="4960" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4960" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_8&#45;&gt;expert_3_8_0 -->
<g id="edge349" class="edge">
<title>route_3_8&#45;&gt;expert_3_8_0</title>
<path fill="none" stroke="black" d="M5000.66,-8745.85C4994.29,-8736.9 4987.32,-8727.1 4980.97,-8718.18"/>
<polygon fill="black" stroke="black" points="4983.77,-8716.08 4975.12,-8709.96 4978.06,-8720.14 4983.77,-8716.08"/>
</g>
<!-- expert_3_8_1 -->
<g id="node242" class="node">
<title>expert_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5393.5,-8709.72 5116.5,-8709.72 5116.5,-8665.72 5393.5,-8665.72 5393.5,-8709.72"/>
<text text-anchor="middle" x="5255" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5255" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 113</text>
<text text-anchor="middle" x="5255" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5255" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_8&#45;&gt;expert_3_8_1 -->
<g id="edge350" class="edge">
<title>route_3_8&#45;&gt;expert_3_8_1</title>
<path fill="none" stroke="black" d="M5096.68,-8747.91C5126.34,-8736.82 5160.17,-8724.17 5188.92,-8713.42"/>
<polygon fill="black" stroke="black" points="5190.32,-8716.64 5198.46,-8709.86 5187.87,-8710.08 5190.32,-8716.64"/>
</g>
<!-- tp_3_8 -->
<g id="node243" class="node">
<title>tp_3_8</title>
<ellipse fill="lightblue" stroke="black" cx="4960" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4960" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4960" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 112↔113</text>
<text text-anchor="middle" x="4960" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4960" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_8_0&#45;&gt;tp_3_8 -->
<g id="edge351" class="edge">
<title>expert_3_8_0&#45;&gt;tp_3_8</title>
<path fill="none" stroke="black" d="M4960,-8665.63C4960,-8657.96 4960,-8649 4960,-8640.21"/>
<polygon fill="black" stroke="black" points="4963.5,-8640.05 4960,-8630.05 4956.5,-8640.05 4963.5,-8640.05"/>
</g>
<!-- expert_3_8_1&#45;&gt;tp_3_8 -->
<g id="edge352" class="edge">
<title>expert_3_8_1&#45;&gt;tp_3_8</title>
<path fill="none" stroke="black" d="M5183.59,-8665.63C5142.13,-8653.39 5089.64,-8637.89 5045.93,-8624.98"/>
<polygon fill="black" stroke="black" points="5046.75,-8621.57 5036.17,-8622.1 5044.77,-8628.29 5046.75,-8621.57"/>
</g>
<!-- tp_3_8&#45;&gt;agg_3 -->
<g id="edge353" class="edge">
<title>tp_3_8&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M4920.72,-8569.22C4907.3,-8559.53 4891.88,-8548.38 4876.87,-8537.54"/>
<polygon fill="black" stroke="black" points="4878.74,-8534.57 4868.59,-8531.55 4874.64,-8540.24 4878.74,-8534.57"/>
</g>
<!-- expert_3_9_0 -->
<g id="node245" class="node">
<title>expert_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5688.5,-8709.72 5411.5,-8709.72 5411.5,-8665.72 5688.5,-8665.72 5688.5,-8709.72"/>
<text text-anchor="middle" x="5550" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5550" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 114</text>
<text text-anchor="middle" x="5550" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5550" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_9&#45;&gt;expert_3_9_0 -->
<g id="edge355" class="edge">
<title>route_3_9&#45;&gt;expert_3_9_0</title>
<path fill="none" stroke="black" d="M5550,-8745.36C5550,-8737.08 5550,-8728.11 5550,-8719.8"/>
<polygon fill="black" stroke="black" points="5553.5,-8719.72 5550,-8709.72 5546.5,-8719.72 5553.5,-8719.72"/>
</g>
<!-- expert_3_9_1 -->
<g id="node246" class="node">
<title>expert_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5983.5,-8709.72 5706.5,-8709.72 5706.5,-8665.72 5983.5,-8665.72 5983.5,-8709.72"/>
<text text-anchor="middle" x="5845" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5845" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 115</text>
<text text-anchor="middle" x="5845" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5845" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_9&#45;&gt;expert_3_9_1 -->
<g id="edge356" class="edge">
<title>route_3_9&#45;&gt;expert_3_9_1</title>
<path fill="none" stroke="black" d="M5640.92,-8748.98C5680.08,-8737.42 5725.51,-8724 5763.56,-8712.77"/>
<polygon fill="black" stroke="black" points="5764.97,-8716 5773.57,-8709.81 5762.99,-8709.29 5764.97,-8716"/>
</g>
<!-- tp_3_9 -->
<g id="node247" class="node">
<title>tp_3_9</title>
<ellipse fill="lightblue" stroke="black" cx="5550" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5550" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5550" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 114↔115</text>
<text text-anchor="middle" x="5550" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5550" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_9_0&#45;&gt;tp_3_9 -->
<g id="edge357" class="edge">
<title>expert_3_9_0&#45;&gt;tp_3_9</title>
<path fill="none" stroke="black" d="M5550,-8665.63C5550,-8657.96 5550,-8649 5550,-8640.21"/>
<polygon fill="black" stroke="black" points="5553.5,-8640.05 5550,-8630.05 5546.5,-8640.05 5553.5,-8640.05"/>
</g>
<!-- expert_3_9_1&#45;&gt;tp_3_9 -->
<g id="edge358" class="edge">
<title>expert_3_9_1&#45;&gt;tp_3_9</title>
<path fill="none" stroke="black" d="M5773.59,-8665.63C5732.13,-8653.39 5679.64,-8637.89 5635.93,-8624.98"/>
<polygon fill="black" stroke="black" points="5636.75,-8621.57 5626.17,-8622.1 5634.77,-8628.29 5636.75,-8621.57"/>
</g>
<!-- tp_3_9&#45;&gt;agg_3 -->
<g id="edge359" class="edge">
<title>tp_3_9&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M5449.68,-8582.83C5359.6,-8569.57 5222.83,-8549.43 5098.76,-8531.16"/>
<polygon fill="black" stroke="black" points="5099.11,-8527.67 5088.71,-8529.68 5098.09,-8534.6 5099.11,-8527.67"/>
</g>
<!-- expert_3_10_0 -->
<g id="node249" class="node">
<title>expert_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6278.5,-8709.72 6001.5,-8709.72 6001.5,-8665.72 6278.5,-8665.72 6278.5,-8709.72"/>
<text text-anchor="middle" x="6140" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6140" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 116</text>
<text text-anchor="middle" x="6140" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6140" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_10&#45;&gt;expert_3_10_0 -->
<g id="edge361" class="edge">
<title>route_3_10&#45;&gt;expert_3_10_0</title>
<path fill="none" stroke="black" d="M6140,-8745.36C6140,-8737.08 6140,-8728.11 6140,-8719.8"/>
<polygon fill="black" stroke="black" points="6143.5,-8719.72 6140,-8709.72 6136.5,-8719.72 6143.5,-8719.72"/>
</g>
<!-- expert_3_10_1 -->
<g id="node250" class="node">
<title>expert_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6573.5,-8709.72 6296.5,-8709.72 6296.5,-8665.72 6573.5,-8665.72 6573.5,-8709.72"/>
<text text-anchor="middle" x="6435" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6435" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 117</text>
<text text-anchor="middle" x="6435" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6435" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_10&#45;&gt;expert_3_10_1 -->
<g id="edge362" class="edge">
<title>route_3_10&#45;&gt;expert_3_10_1</title>
<path fill="none" stroke="black" d="M6230.92,-8748.98C6270.08,-8737.42 6315.51,-8724 6353.56,-8712.77"/>
<polygon fill="black" stroke="black" points="6354.97,-8716 6363.57,-8709.81 6352.99,-8709.29 6354.97,-8716"/>
</g>
<!-- tp_3_10 -->
<g id="node251" class="node">
<title>tp_3_10</title>
<ellipse fill="lightblue" stroke="black" cx="6140" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6140" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6140" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 116↔117</text>
<text text-anchor="middle" x="6140" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6140" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_10_0&#45;&gt;tp_3_10 -->
<g id="edge363" class="edge">
<title>expert_3_10_0&#45;&gt;tp_3_10</title>
<path fill="none" stroke="black" d="M6140,-8665.63C6140,-8657.96 6140,-8649 6140,-8640.21"/>
<polygon fill="black" stroke="black" points="6143.5,-8640.05 6140,-8630.05 6136.5,-8640.05 6143.5,-8640.05"/>
</g>
<!-- expert_3_10_1&#45;&gt;tp_3_10 -->
<g id="edge364" class="edge">
<title>expert_3_10_1&#45;&gt;tp_3_10</title>
<path fill="none" stroke="black" d="M6363.59,-8665.63C6322.13,-8653.39 6269.64,-8637.89 6225.93,-8624.98"/>
<polygon fill="black" stroke="black" points="6226.75,-8621.57 6216.17,-8622.1 6224.77,-8628.29 6226.75,-8621.57"/>
</g>
<!-- tp_3_10&#45;&gt;agg_3 -->
<g id="edge365" class="edge">
<title>tp_3_10&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M6029.95,-8588.58C5821.59,-8571.5 5364.27,-8534.01 5072.27,-8510.08"/>
<polygon fill="black" stroke="black" points="5072.21,-8506.56 5061.96,-8509.23 5071.64,-8513.54 5072.21,-8506.56"/>
</g>
<!-- expert_3_11_0 -->
<g id="node253" class="node">
<title>expert_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6868.5,-8709.72 6591.5,-8709.72 6591.5,-8665.72 6868.5,-8665.72 6868.5,-8709.72"/>
<text text-anchor="middle" x="6730" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6730" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 118</text>
<text text-anchor="middle" x="6730" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6730" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_11&#45;&gt;expert_3_11_0 -->
<g id="edge367" class="edge">
<title>route_3_11&#45;&gt;expert_3_11_0</title>
<path fill="none" stroke="black" d="M6730,-8745.36C6730,-8737.08 6730,-8728.11 6730,-8719.8"/>
<polygon fill="black" stroke="black" points="6733.5,-8719.72 6730,-8709.72 6726.5,-8719.72 6733.5,-8719.72"/>
</g>
<!-- expert_3_11_1 -->
<g id="node254" class="node">
<title>expert_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7163.5,-8709.72 6886.5,-8709.72 6886.5,-8665.72 7163.5,-8665.72 7163.5,-8709.72"/>
<text text-anchor="middle" x="7025" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7025" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 119</text>
<text text-anchor="middle" x="7025" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7025" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_11&#45;&gt;expert_3_11_1 -->
<g id="edge368" class="edge">
<title>route_3_11&#45;&gt;expert_3_11_1</title>
<path fill="none" stroke="black" d="M6820.92,-8748.98C6860.08,-8737.42 6905.51,-8724 6943.56,-8712.77"/>
<polygon fill="black" stroke="black" points="6944.97,-8716 6953.57,-8709.81 6942.99,-8709.29 6944.97,-8716"/>
</g>
<!-- tp_3_11 -->
<g id="node255" class="node">
<title>tp_3_11</title>
<ellipse fill="lightblue" stroke="black" cx="6730" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6730" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6730" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 118↔119</text>
<text text-anchor="middle" x="6730" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6730" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_11_0&#45;&gt;tp_3_11 -->
<g id="edge369" class="edge">
<title>expert_3_11_0&#45;&gt;tp_3_11</title>
<path fill="none" stroke="black" d="M6730,-8665.63C6730,-8657.96 6730,-8649 6730,-8640.21"/>
<polygon fill="black" stroke="black" points="6733.5,-8640.05 6730,-8630.05 6726.5,-8640.05 6733.5,-8640.05"/>
</g>
<!-- expert_3_11_1&#45;&gt;tp_3_11 -->
<g id="edge370" class="edge">
<title>expert_3_11_1&#45;&gt;tp_3_11</title>
<path fill="none" stroke="black" d="M6953.59,-8665.63C6912.13,-8653.39 6859.64,-8637.89 6815.93,-8624.98"/>
<polygon fill="black" stroke="black" points="6816.75,-8621.57 6806.17,-8622.1 6814.77,-8628.29 6816.75,-8621.57"/>
</g>
<!-- tp_3_11&#45;&gt;agg_3 -->
<g id="edge371" class="edge">
<title>tp_3_11&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M6618.21,-8590.04C6524.03,-8583.74 6385.73,-8574.68 6265,-8567.49 5842.78,-8542.37 5351.49,-8516.39 5061.13,-8501.37"/>
<polygon fill="black" stroke="black" points="5061.06,-8497.86 5050.89,-8500.84 5060.7,-8504.85 5061.06,-8497.86"/>
</g>
<!-- expert_3_12_0 -->
<g id="node257" class="node">
<title>expert_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7458.5,-8709.72 7181.5,-8709.72 7181.5,-8665.72 7458.5,-8665.72 7458.5,-8709.72"/>
<text text-anchor="middle" x="7320" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7320" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 120</text>
<text text-anchor="middle" x="7320" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7320" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_12&#45;&gt;expert_3_12_0 -->
<g id="edge373" class="edge">
<title>route_3_12&#45;&gt;expert_3_12_0</title>
<path fill="none" stroke="black" d="M7320,-8745.36C7320,-8737.08 7320,-8728.11 7320,-8719.8"/>
<polygon fill="black" stroke="black" points="7323.5,-8719.72 7320,-8709.72 7316.5,-8719.72 7323.5,-8719.72"/>
</g>
<!-- expert_3_12_1 -->
<g id="node258" class="node">
<title>expert_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7753.5,-8709.72 7476.5,-8709.72 7476.5,-8665.72 7753.5,-8665.72 7753.5,-8709.72"/>
<text text-anchor="middle" x="7615" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7615" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 121</text>
<text text-anchor="middle" x="7615" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7615" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_12&#45;&gt;expert_3_12_1 -->
<g id="edge374" class="edge">
<title>route_3_12&#45;&gt;expert_3_12_1</title>
<path fill="none" stroke="black" d="M7410.92,-8748.98C7450.08,-8737.42 7495.51,-8724 7533.56,-8712.77"/>
<polygon fill="black" stroke="black" points="7534.97,-8716 7543.57,-8709.81 7532.99,-8709.29 7534.97,-8716"/>
</g>
<!-- tp_3_12 -->
<g id="node259" class="node">
<title>tp_3_12</title>
<ellipse fill="lightblue" stroke="black" cx="7320" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7320" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7320" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 120↔121</text>
<text text-anchor="middle" x="7320" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7320" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_12_0&#45;&gt;tp_3_12 -->
<g id="edge375" class="edge">
<title>expert_3_12_0&#45;&gt;tp_3_12</title>
<path fill="none" stroke="black" d="M7320,-8665.63C7320,-8657.96 7320,-8649 7320,-8640.21"/>
<polygon fill="black" stroke="black" points="7323.5,-8640.05 7320,-8630.05 7316.5,-8640.05 7323.5,-8640.05"/>
</g>
<!-- expert_3_12_1&#45;&gt;tp_3_12 -->
<g id="edge376" class="edge">
<title>expert_3_12_1&#45;&gt;tp_3_12</title>
<path fill="none" stroke="black" d="M7543.59,-8665.63C7502.13,-8653.39 7449.64,-8637.89 7405.93,-8624.98"/>
<polygon fill="black" stroke="black" points="7406.75,-8621.57 7396.17,-8622.1 7404.77,-8628.29 7406.75,-8621.57"/>
</g>
<!-- tp_3_12&#45;&gt;agg_3 -->
<g id="edge377" class="edge">
<title>tp_3_12&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M7208.71,-8589.58C7114.54,-8582.99 6975.98,-8573.74 6855,-8567.49 6205.12,-8533.91 5438.45,-8507.96 5054.34,-8495.9"/>
<polygon fill="black" stroke="black" points="5054.32,-8492.4 5044.22,-8495.58 5054.1,-8499.39 5054.32,-8492.4"/>
</g>
<!-- expert_3_13_0 -->
<g id="node261" class="node">
<title>expert_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8048.5,-8709.72 7771.5,-8709.72 7771.5,-8665.72 8048.5,-8665.72 8048.5,-8709.72"/>
<text text-anchor="middle" x="7910" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7910" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 122</text>
<text text-anchor="middle" x="7910" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7910" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_13&#45;&gt;expert_3_13_0 -->
<g id="edge379" class="edge">
<title>route_3_13&#45;&gt;expert_3_13_0</title>
<path fill="none" stroke="black" d="M7910,-8745.36C7910,-8737.08 7910,-8728.11 7910,-8719.8"/>
<polygon fill="black" stroke="black" points="7913.5,-8719.72 7910,-8709.72 7906.5,-8719.72 7913.5,-8719.72"/>
</g>
<!-- expert_3_13_1 -->
<g id="node262" class="node">
<title>expert_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8343.5,-8709.72 8066.5,-8709.72 8066.5,-8665.72 8343.5,-8665.72 8343.5,-8709.72"/>
<text text-anchor="middle" x="8205" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8205" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 123</text>
<text text-anchor="middle" x="8205" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8205" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_13&#45;&gt;expert_3_13_1 -->
<g id="edge380" class="edge">
<title>route_3_13&#45;&gt;expert_3_13_1</title>
<path fill="none" stroke="black" d="M8000.92,-8748.98C8040.08,-8737.42 8085.51,-8724 8123.56,-8712.77"/>
<polygon fill="black" stroke="black" points="8124.97,-8716 8133.57,-8709.81 8122.99,-8709.29 8124.97,-8716"/>
</g>
<!-- tp_3_13 -->
<g id="node263" class="node">
<title>tp_3_13</title>
<ellipse fill="lightblue" stroke="black" cx="7910" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7910" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7910" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 122↔123</text>
<text text-anchor="middle" x="7910" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7910" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_13_0&#45;&gt;tp_3_13 -->
<g id="edge381" class="edge">
<title>expert_3_13_0&#45;&gt;tp_3_13</title>
<path fill="none" stroke="black" d="M7910,-8665.63C7910,-8657.96 7910,-8649 7910,-8640.21"/>
<polygon fill="black" stroke="black" points="7913.5,-8640.05 7910,-8630.05 7906.5,-8640.05 7913.5,-8640.05"/>
</g>
<!-- expert_3_13_1&#45;&gt;tp_3_13 -->
<g id="edge382" class="edge">
<title>expert_3_13_1&#45;&gt;tp_3_13</title>
<path fill="none" stroke="black" d="M8133.59,-8665.63C8092.13,-8653.39 8039.64,-8637.89 7995.93,-8624.98"/>
<polygon fill="black" stroke="black" points="7996.75,-8621.57 7986.17,-8622.1 7994.77,-8628.29 7996.75,-8621.57"/>
</g>
<!-- tp_3_13&#45;&gt;agg_3 -->
<g id="edge383" class="edge">
<title>tp_3_13&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M7799.2,-8589.34C7705.02,-8582.58 7566.21,-8573.23 7445,-8567.49 6563.42,-8525.75 5514.89,-8502.08 5050.68,-8492.93"/>
<polygon fill="black" stroke="black" points="5050.57,-8489.43 5040.5,-8492.73 5050.43,-8496.43 5050.57,-8489.43"/>
</g>
<!-- expert_3_14_0 -->
<g id="node265" class="node">
<title>expert_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8638.5,-8709.72 8361.5,-8709.72 8361.5,-8665.72 8638.5,-8665.72 8638.5,-8709.72"/>
<text text-anchor="middle" x="8500" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8500" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 124</text>
<text text-anchor="middle" x="8500" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8500" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_14&#45;&gt;expert_3_14_0 -->
<g id="edge385" class="edge">
<title>route_3_14&#45;&gt;expert_3_14_0</title>
<path fill="none" stroke="black" d="M8500,-8745.36C8500,-8737.08 8500,-8728.11 8500,-8719.8"/>
<polygon fill="black" stroke="black" points="8503.5,-8719.72 8500,-8709.72 8496.5,-8719.72 8503.5,-8719.72"/>
</g>
<!-- expert_3_14_1 -->
<g id="node266" class="node">
<title>expert_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8933.5,-8709.72 8656.5,-8709.72 8656.5,-8665.72 8933.5,-8665.72 8933.5,-8709.72"/>
<text text-anchor="middle" x="8795" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8795" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 125</text>
<text text-anchor="middle" x="8795" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8795" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_14&#45;&gt;expert_3_14_1 -->
<g id="edge386" class="edge">
<title>route_3_14&#45;&gt;expert_3_14_1</title>
<path fill="none" stroke="black" d="M8590.92,-8748.98C8630.08,-8737.42 8675.51,-8724 8713.56,-8712.77"/>
<polygon fill="black" stroke="black" points="8714.97,-8716 8723.57,-8709.81 8712.99,-8709.29 8714.97,-8716"/>
</g>
<!-- tp_3_14 -->
<g id="node267" class="node">
<title>tp_3_14</title>
<ellipse fill="lightblue" stroke="black" cx="8500" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8500" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8500" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 124↔125</text>
<text text-anchor="middle" x="8500" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8500" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_14_0&#45;&gt;tp_3_14 -->
<g id="edge387" class="edge">
<title>expert_3_14_0&#45;&gt;tp_3_14</title>
<path fill="none" stroke="black" d="M8500,-8665.63C8500,-8657.96 8500,-8649 8500,-8640.21"/>
<polygon fill="black" stroke="black" points="8503.5,-8640.05 8500,-8630.05 8496.5,-8640.05 8503.5,-8640.05"/>
</g>
<!-- expert_3_14_1&#45;&gt;tp_3_14 -->
<g id="edge388" class="edge">
<title>expert_3_14_1&#45;&gt;tp_3_14</title>
<path fill="none" stroke="black" d="M8723.59,-8665.63C8682.13,-8653.39 8629.64,-8637.89 8585.93,-8624.98"/>
<polygon fill="black" stroke="black" points="8586.75,-8621.57 8576.17,-8622.1 8584.77,-8628.29 8586.75,-8621.57"/>
</g>
<!-- tp_3_14&#45;&gt;agg_3 -->
<g id="edge389" class="edge">
<title>tp_3_14&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M8389.2,-8589.17C8295.04,-8582.31 8156.23,-8572.9 8035,-8567.49 6918.57,-8517.69 5583.31,-8497.54 5048.08,-8491.06"/>
<polygon fill="black" stroke="black" points="5047.97,-8487.56 5037.93,-8490.94 5047.88,-8494.56 5047.97,-8487.56"/>
</g>
<!-- expert_3_15_0 -->
<g id="node269" class="node">
<title>expert_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9228.5,-8709.72 8951.5,-8709.72 8951.5,-8665.72 9228.5,-8665.72 9228.5,-8709.72"/>
<text text-anchor="middle" x="9090" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9090" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 126</text>
<text text-anchor="middle" x="9090" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9090" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_15&#45;&gt;expert_3_15_0 -->
<g id="edge391" class="edge">
<title>route_3_15&#45;&gt;expert_3_15_0</title>
<path fill="none" stroke="black" d="M9090,-8745.36C9090,-8737.08 9090,-8728.11 9090,-8719.8"/>
<polygon fill="black" stroke="black" points="9093.5,-8719.72 9090,-8709.72 9086.5,-8719.72 9093.5,-8719.72"/>
</g>
<!-- expert_3_15_1 -->
<g id="node270" class="node">
<title>expert_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9523.5,-8709.72 9246.5,-8709.72 9246.5,-8665.72 9523.5,-8665.72 9523.5,-8709.72"/>
<text text-anchor="middle" x="9385" y="-8700.52" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9385" y="-8690.52" font-family="Times,serif" font-size="9.00">GPU: 127</text>
<text text-anchor="middle" x="9385" y="-8680.52" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9385" y="-8670.52" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_3_15&#45;&gt;expert_3_15_1 -->
<g id="edge392" class="edge">
<title>route_3_15&#45;&gt;expert_3_15_1</title>
<path fill="none" stroke="black" d="M9180.92,-8748.98C9220.08,-8737.42 9265.51,-8724 9303.56,-8712.77"/>
<polygon fill="black" stroke="black" points="9304.97,-8716 9313.57,-8709.81 9302.99,-8709.29 9304.97,-8716"/>
</g>
<!-- tp_3_15 -->
<g id="node271" class="node">
<title>tp_3_15</title>
<ellipse fill="lightblue" stroke="black" cx="9090" cy="-8598.61" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9090" y="-8611.41" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9090" y="-8601.41" font-family="Times,serif" font-size="9.00">GPU: 126↔127</text>
<text text-anchor="middle" x="9090" y="-8591.41" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9090" y="-8581.41" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_3_15_0&#45;&gt;tp_3_15 -->
<g id="edge393" class="edge">
<title>expert_3_15_0&#45;&gt;tp_3_15</title>
<path fill="none" stroke="black" d="M9090,-8665.63C9090,-8657.96 9090,-8649 9090,-8640.21"/>
<polygon fill="black" stroke="black" points="9093.5,-8640.05 9090,-8630.05 9086.5,-8640.05 9093.5,-8640.05"/>
</g>
<!-- expert_3_15_1&#45;&gt;tp_3_15 -->
<g id="edge394" class="edge">
<title>expert_3_15_1&#45;&gt;tp_3_15</title>
<path fill="none" stroke="black" d="M9313.59,-8665.63C9272.13,-8653.39 9219.64,-8637.89 9175.93,-8624.98"/>
<polygon fill="black" stroke="black" points="9176.75,-8621.57 9166.17,-8622.1 9174.77,-8628.29 9176.75,-8621.57"/>
</g>
<!-- tp_3_15&#45;&gt;agg_3 -->
<g id="edge395" class="edge">
<title>tp_3_15&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M8979.21,-8589.06C8885.04,-8582.12 8746.24,-8572.67 8625,-8567.49 7271.53,-8509.69 5646.15,-8493.83 5046.33,-8489.78"/>
<polygon fill="black" stroke="black" points="5046.29,-8486.28 5036.26,-8489.71 5046.24,-8493.28 5046.29,-8486.28"/>
</g>
<!-- output_3 -->
<g id="node273" class="node">
<title>output_3</title>
<polygon fill="lightgreen" stroke="black" points="4957,-8407.49 4661,-8407.49 4661,-8363.49 4957,-8363.49 4957,-8407.49"/>
<text text-anchor="middle" x="4809" y="-8398.29" font-family="Times,serif" font-size="9.00">Layer 3 Output</text>
<text text-anchor="middle" x="4809" y="-8388.29" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4809" y="-8378.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4809" y="-8368.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_3&#45;&gt;output_3 -->
<g id="edge396" class="edge">
<title>agg_3&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M4809,-8443.21C4809,-8434.62 4809,-8425.77 4809,-8417.68"/>
<polygon fill="black" stroke="black" points="4812.5,-8417.58 4809,-8407.58 4805.5,-8417.58 4812.5,-8417.58"/>
</g>
<!-- mha_4 -->
<g id="node274" class="node">
<title>mha_4</title>
<polygon fill="lightgreen" stroke="black" points="4957,-8316.49 4661,-8316.49 4661,-8272.49 4957,-8272.49 4957,-8316.49"/>
<text text-anchor="middle" x="4809" y="-8307.29" font-family="Times,serif" font-size="9.00">MHA L4</text>
<text text-anchor="middle" x="4809" y="-8297.29" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4809" y="-8287.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4809" y="-8277.29" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_3&#45;&gt;mha_4 -->
<g id="edge397" class="edge">
<title>output_3&#45;&gt;mha_4</title>
<path fill="none" stroke="black" d="M4809,-8363.4C4809,-8352.51 4809,-8339 4809,-8326.9"/>
<polygon fill="black" stroke="black" points="4812.5,-8326.74 4809,-8316.74 4805.5,-8326.74 4812.5,-8326.74"/>
</g>
<!-- gate_4 -->
<g id="node275" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="5108.74,-8236.49 4631.92,-8236.49 4509.26,-8148.49 4986.08,-8148.49 5108.74,-8236.49"/>
<text text-anchor="middle" x="4809" y="-8205.29" font-family="Times,serif" font-size="9.00">Gate L4</text>
<text text-anchor="middle" x="4809" y="-8195.29" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4809" y="-8185.29" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4809" y="-8175.29" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_4&#45;&gt;gate_4 -->
<g id="edge398" class="edge">
<title>mha_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M4809,-8272.29C4809,-8264.79 4809,-8255.98 4809,-8247.02"/>
<polygon fill="black" stroke="black" points="4812.5,-8246.9 4809,-8236.9 4805.5,-8246.9 4812.5,-8246.9"/>
</g>
<!-- route_4_0 -->
<g id="node276" class="node">
<title>route_4_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 128,129</text>
<text text-anchor="middle" x="450" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_0 -->
<g id="edge399" class="edge">
<title>gate_4&#45;&gt;route_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4569.44,-8191.68C3950.38,-8191.08 2246.84,-8182.63 830,-8112.49 764.75,-8109.26 693.31,-8104.05 630.17,-8098.85"/>
<polygon fill="black" stroke="black" points="630.36,-8095.36 620.11,-8098.02 629.79,-8102.34 630.36,-8095.36"/>
</g>
<!-- route_4_1 -->
<g id="node280" class="node">
<title>route_4_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 130,131</text>
<text text-anchor="middle" x="1040" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_1 -->
<g id="edge405" class="edge">
<title>gate_4&#45;&gt;route_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4567.67,-8190.49C4012.01,-8187.15 2599.37,-8172.92 1420,-8112.49 1354.91,-8109.16 1283.67,-8103.93 1220.63,-8098.76"/>
<polygon fill="black" stroke="black" points="1220.84,-8095.27 1210.59,-8097.94 1220.27,-8102.25 1220.84,-8095.27"/>
</g>
<!-- route_4_2 -->
<g id="node284" class="node">
<title>route_4_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 132,133</text>
<text text-anchor="middle" x="1630" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_2 -->
<g id="edge411" class="edge">
<title>gate_4&#45;&gt;route_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4565,-8188.78C4078.62,-8182.44 2953.86,-8163.18 2010,-8112.49 1945.08,-8109.01 1874.02,-8103.76 1811.1,-8098.62"/>
<polygon fill="black" stroke="black" points="1811.32,-8095.13 1801.07,-8097.8 1810.75,-8102.1 1811.32,-8095.13"/>
</g>
<!-- route_4_3 -->
<g id="node288" class="node">
<title>route_4_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 134,135</text>
<text text-anchor="middle" x="2220" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_3 -->
<g id="edge417" class="edge">
<title>gate_4&#45;&gt;route_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4561.62,-8186.14C4152.99,-8176.52 3311.41,-8153.38 2600,-8112.49 2535.25,-8108.77 2464.38,-8103.49 2401.57,-8098.38"/>
<polygon fill="black" stroke="black" points="2401.81,-8094.89 2391.56,-8097.56 2401.24,-8101.86 2401.81,-8094.89"/>
</g>
<!-- route_4_4 -->
<g id="node292" class="node">
<title>route_4_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 136,137</text>
<text text-anchor="middle" x="2810" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_4 -->
<g id="edge423" class="edge">
<title>gate_4&#45;&gt;route_4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4555.09,-8181.49C4236.19,-8168.37 3672.34,-8143.36 3190,-8112.49 3125.87,-8108.39 3055.73,-8103.07 2993.35,-8098.04"/>
<polygon fill="black" stroke="black" points="2993.26,-8094.52 2983.01,-8097.2 2992.7,-8101.5 2993.26,-8094.52"/>
</g>
<!-- route_4_5 -->
<g id="node296" class="node">
<title>route_4_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 138,139</text>
<text text-anchor="middle" x="3400" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_5 -->
<g id="edge429" class="edge">
<title>gate_4&#45;&gt;route_4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4540.6,-8171.07C4332.95,-8155.22 4038.23,-8132.64 3780,-8112.49 3716.88,-8107.57 3647.86,-8102.12 3586.17,-8097.22"/>
<polygon fill="black" stroke="black" points="3586.18,-8093.71 3575.94,-8096.41 3585.63,-8100.69 3586.18,-8093.71"/>
</g>
<!-- route_4_6 -->
<g id="node300" class="node">
<title>route_4_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 140,141</text>
<text text-anchor="middle" x="3990" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_6 -->
<g id="edge435" class="edge">
<title>gate_4&#45;&gt;route_4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4514.48,-8152.25C4391.2,-8135.83 4252.78,-8117.39 4149.12,-8103.58"/>
<polygon fill="black" stroke="black" points="4149.57,-8100.11 4139.2,-8102.26 4148.65,-8107.05 4149.57,-8100.11"/>
</g>
<!-- route_4_7 -->
<g id="node304" class="node">
<title>route_4_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4518" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4518" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4518" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 142,143</text>
<text text-anchor="middle" x="4518" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4518" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_7 -->
<g id="edge441" class="edge">
<title>gate_4&#45;&gt;route_4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4693.99,-8148.37C4663.3,-8136.86 4630.72,-8124.65 4602.04,-8113.89"/>
<polygon fill="black" stroke="black" points="4603.07,-8110.54 4592.47,-8110.3 4600.61,-8117.09 4603.07,-8110.54"/>
</g>
<!-- route_4_8 -->
<g id="node308" class="node">
<title>route_4_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4938" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4938" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4938" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 144,145</text>
<text text-anchor="middle" x="4938" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4938" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_8 -->
<g id="edge447" class="edge">
<title>gate_4&#45;&gt;route_4_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4859.98,-8148.37C4871.54,-8138.59 4883.71,-8128.3 4894.91,-8118.83"/>
<polygon fill="black" stroke="black" points="4897.49,-8121.23 4902.87,-8112.1 4892.97,-8115.88 4897.49,-8121.23"/>
</g>
<!-- route_4_9 -->
<g id="node312" class="node">
<title>route_4_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 146,147</text>
<text text-anchor="middle" x="5465" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_9 -->
<g id="edge453" class="edge">
<title>gate_4&#45;&gt;route_4_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5001.83,-8159.42C5104.04,-8142.42 5227.48,-8121.89 5321.21,-8106.3"/>
<polygon fill="black" stroke="black" points="5322.04,-8109.71 5331.33,-8104.61 5320.9,-8102.8 5322.04,-8109.71"/>
</g>
<!-- route_4_10 -->
<g id="node316" class="node">
<title>route_4_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 148,149</text>
<text text-anchor="middle" x="6055" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_10 -->
<g id="edge459" class="edge">
<title>gate_4&#45;&gt;route_4_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5020.37,-8172.98C5259.82,-8152.01 5646.11,-8118.19 5872.79,-8098.34"/>
<polygon fill="black" stroke="black" points="5873.14,-8101.82 5882.79,-8097.46 5872.52,-8094.85 5873.14,-8101.82"/>
</g>
<!-- route_4_11 -->
<g id="node320" class="node">
<title>route_4_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 150,151</text>
<text text-anchor="middle" x="6645" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_11 -->
<g id="edge465" class="edge">
<title>gate_4&#45;&gt;route_4_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5031.73,-8181.13C5317.46,-8167.44 5828.34,-8141.64 6265,-8112.49 6328.8,-8108.23 6398.57,-8102.9 6460.72,-8097.91"/>
<polygon fill="black" stroke="black" points="6461.34,-8101.37 6471.03,-8097.08 6460.78,-8094.39 6461.34,-8101.37"/>
</g>
<!-- route_4_12 -->
<g id="node324" class="node">
<title>route_4_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 152,153</text>
<text text-anchor="middle" x="7235" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_12 -->
<g id="edge471" class="edge">
<title>gate_4&#45;&gt;route_4_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5038.13,-8185.67C5416.6,-8175.38 6196.07,-8151.31 6855,-8112.49 6919.59,-8108.69 6990.27,-8103.4 7052.97,-8098.31"/>
<polygon fill="black" stroke="black" points="7053.28,-8101.8 7062.96,-8097.5 7052.71,-8094.82 7053.28,-8101.8"/>
</g>
<!-- route_4_13 -->
<g id="node328" class="node">
<title>route_4_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 154,155</text>
<text text-anchor="middle" x="7825" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_13 -->
<g id="edge477" class="edge">
<title>gate_4&#45;&gt;route_4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5041.89,-8188.35C5501.61,-8181.31 6558.1,-8160.89 7445,-8112.49 7509.92,-8108.95 7580.98,-8103.69 7643.9,-8098.56"/>
<polygon fill="black" stroke="black" points="7644.25,-8102.04 7653.93,-8097.73 7643.67,-8095.06 7644.25,-8102.04"/>
</g>
<!-- route_4_14 -->
<g id="node332" class="node">
<title>route_4_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 156,157</text>
<text text-anchor="middle" x="8415" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_14 -->
<g id="edge483" class="edge">
<title>gate_4&#45;&gt;route_4_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5044.44,-8190.13C5577.29,-8186.07 6916.38,-8170.47 8035,-8112.49 8100.09,-8109.12 8171.33,-8103.89 8234.37,-8098.72"/>
<polygon fill="black" stroke="black" points="8234.73,-8102.2 8244.41,-8097.89 8234.16,-8095.23 8234.73,-8102.2"/>
</g>
<!-- route_4_15 -->
<g id="node336" class="node">
<title>route_4_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-8081.38" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-8094.18" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-8084.18" font-family="Times,serif" font-size="9.00">GPU: 158,159</text>
<text text-anchor="middle" x="9005" y="-8074.18" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-8064.18" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_4&#45;&gt;route_4_15 -->
<g id="edge489" class="edge">
<title>gate_4&#45;&gt;route_4_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5046.12,-8191.39C5645.87,-8190.09 7271.79,-8180.06 8625,-8112.49 8690.25,-8109.23 8761.68,-8104.01 8824.83,-8098.82"/>
<polygon fill="black" stroke="black" points="8825.21,-8102.3 8834.89,-8097.99 8824.64,-8095.33 8825.21,-8102.3"/>
</g>
<!-- expert_4_0_0 -->
<g id="node277" class="node">
<title>expert_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-8014.27 16.5,-8014.27 16.5,-7970.27 293.5,-7970.27 293.5,-8014.27"/>
<text text-anchor="middle" x="155" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="155" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 128</text>
<text text-anchor="middle" x="155" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_0&#45;&gt;expert_4_0_0 -->
<g id="edge400" class="edge">
<title>route_4_0&#45;&gt;expert_4_0_0</title>
<path fill="none" stroke="black" d="M359.08,-8053.53C319.92,-8041.97 274.49,-8028.55 236.44,-8017.32"/>
<polygon fill="black" stroke="black" points="237.01,-8013.84 226.43,-8014.36 235.03,-8020.55 237.01,-8013.84"/>
</g>
<!-- expert_4_0_1 -->
<g id="node278" class="node">
<title>expert_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-8014.27 311.5,-8014.27 311.5,-7970.27 588.5,-7970.27 588.5,-8014.27"/>
<text text-anchor="middle" x="450" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="450" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 129</text>
<text text-anchor="middle" x="450" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_0&#45;&gt;expert_4_0_1 -->
<g id="edge401" class="edge">
<title>route_4_0&#45;&gt;expert_4_0_1</title>
<path fill="none" stroke="black" d="M450,-8049.91C450,-8041.63 450,-8032.66 450,-8024.34"/>
<polygon fill="black" stroke="black" points="453.5,-8024.27 450,-8014.27 446.5,-8024.27 453.5,-8024.27"/>
</g>
<!-- tp_4_0 -->
<g id="node279" class="node">
<title>tp_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="450" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="450" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="450" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 128↔129</text>
<text text-anchor="middle" x="450" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="450" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_0_0&#45;&gt;tp_4_0 -->
<g id="edge402" class="edge">
<title>expert_4_0_0&#45;&gt;tp_4_0</title>
<path fill="none" stroke="black" d="M226.41,-7970.18C267.87,-7957.94 320.36,-7942.44 364.07,-7929.53"/>
<polygon fill="black" stroke="black" points="365.23,-7932.84 373.83,-7926.65 363.25,-7926.12 365.23,-7932.84"/>
</g>
<!-- expert_4_0_1&#45;&gt;tp_4_0 -->
<g id="edge403" class="edge">
<title>expert_4_0_1&#45;&gt;tp_4_0</title>
<path fill="none" stroke="black" d="M450,-7970.18C450,-7962.51 450,-7953.55 450,-7944.76"/>
<polygon fill="black" stroke="black" points="453.5,-7944.6 450,-7934.6 446.5,-7944.6 453.5,-7944.6"/>
</g>
<!-- agg_4 -->
<g id="node340" class="node">
<title>agg_4</title>
<polygon fill="lightyellow" stroke="black" points="5008.99,-7836.04 4560.4,-7836.04 4445.01,-7748.04 4893.6,-7748.04 5008.99,-7836.04"/>
<text text-anchor="middle" x="4727" y="-7804.84" font-family="Times,serif" font-size="9.00">Aggregate Experts L4</text>
<text text-anchor="middle" x="4727" y="-7794.84" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-7784.84" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4727" y="-7774.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_4_0&#45;&gt;agg_4 -->
<g id="edge404" class="edge">
<title>tp_4_0&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M560.79,-7893.61C654.96,-7886.67 793.76,-7877.22 915,-7872.04 2270.83,-7814.12 3899.8,-7798.3 4494.92,-7794.3"/>
<polygon fill="black" stroke="black" points="4495.36,-7797.8 4505.33,-7794.23 4495.31,-7790.8 4495.36,-7797.8"/>
</g>
<!-- expert_4_1_0 -->
<g id="node281" class="node">
<title>expert_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-8014.27 606.5,-8014.27 606.5,-7970.27 883.5,-7970.27 883.5,-8014.27"/>
<text text-anchor="middle" x="745" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="745" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 130</text>
<text text-anchor="middle" x="745" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_1&#45;&gt;expert_4_1_0 -->
<g id="edge406" class="edge">
<title>route_4_1&#45;&gt;expert_4_1_0</title>
<path fill="none" stroke="black" d="M949.08,-8053.53C909.92,-8041.97 864.49,-8028.55 826.44,-8017.32"/>
<polygon fill="black" stroke="black" points="827.01,-8013.84 816.43,-8014.36 825.03,-8020.55 827.01,-8013.84"/>
</g>
<!-- expert_4_1_1 -->
<g id="node282" class="node">
<title>expert_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-8014.27 901.5,-8014.27 901.5,-7970.27 1178.5,-7970.27 1178.5,-8014.27"/>
<text text-anchor="middle" x="1040" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1040" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 131</text>
<text text-anchor="middle" x="1040" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_1&#45;&gt;expert_4_1_1 -->
<g id="edge407" class="edge">
<title>route_4_1&#45;&gt;expert_4_1_1</title>
<path fill="none" stroke="black" d="M1040,-8049.91C1040,-8041.63 1040,-8032.66 1040,-8024.34"/>
<polygon fill="black" stroke="black" points="1043.5,-8024.27 1040,-8014.27 1036.5,-8024.27 1043.5,-8024.27"/>
</g>
<!-- tp_4_1 -->
<g id="node283" class="node">
<title>tp_4_1</title>
<ellipse fill="lightblue" stroke="black" cx="1040" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1040" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 130↔131</text>
<text text-anchor="middle" x="1040" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1040" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_1_0&#45;&gt;tp_4_1 -->
<g id="edge408" class="edge">
<title>expert_4_1_0&#45;&gt;tp_4_1</title>
<path fill="none" stroke="black" d="M816.41,-7970.18C857.87,-7957.94 910.36,-7942.44 954.07,-7929.53"/>
<polygon fill="black" stroke="black" points="955.23,-7932.84 963.83,-7926.65 953.25,-7926.12 955.23,-7932.84"/>
</g>
<!-- expert_4_1_1&#45;&gt;tp_4_1 -->
<g id="edge409" class="edge">
<title>expert_4_1_1&#45;&gt;tp_4_1</title>
<path fill="none" stroke="black" d="M1040,-7970.18C1040,-7962.51 1040,-7953.55 1040,-7944.76"/>
<polygon fill="black" stroke="black" points="1043.5,-7944.6 1040,-7934.6 1036.5,-7944.6 1043.5,-7944.6"/>
</g>
<!-- tp_4_1&#45;&gt;agg_4 -->
<g id="edge410" class="edge">
<title>tp_4_1&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1150.8,-7893.72C1244.96,-7886.86 1383.77,-7877.45 1505,-7872.04 2625.94,-7822.02 3967.78,-7801.89 4496.63,-7795.52"/>
<polygon fill="black" stroke="black" points="4496.71,-7799.02 4506.67,-7795.4 4496.63,-7792.02 4496.71,-7799.02"/>
</g>
<!-- expert_4_2_0 -->
<g id="node285" class="node">
<title>expert_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-8014.27 1196.5,-8014.27 1196.5,-7970.27 1473.5,-7970.27 1473.5,-8014.27"/>
<text text-anchor="middle" x="1335" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1335" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 132</text>
<text text-anchor="middle" x="1335" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_2&#45;&gt;expert_4_2_0 -->
<g id="edge412" class="edge">
<title>route_4_2&#45;&gt;expert_4_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-8053.53C1499.92,-8041.97 1454.49,-8028.55 1416.44,-8017.32"/>
<polygon fill="black" stroke="black" points="1417.01,-8013.84 1406.43,-8014.36 1415.03,-8020.55 1417.01,-8013.84"/>
</g>
<!-- expert_4_2_1 -->
<g id="node286" class="node">
<title>expert_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-8014.27 1491.5,-8014.27 1491.5,-7970.27 1768.5,-7970.27 1768.5,-8014.27"/>
<text text-anchor="middle" x="1630" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1630" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 133</text>
<text text-anchor="middle" x="1630" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_2&#45;&gt;expert_4_2_1 -->
<g id="edge413" class="edge">
<title>route_4_2&#45;&gt;expert_4_2_1</title>
<path fill="none" stroke="black" d="M1630,-8049.91C1630,-8041.63 1630,-8032.66 1630,-8024.34"/>
<polygon fill="black" stroke="black" points="1633.5,-8024.27 1630,-8014.27 1626.5,-8024.27 1633.5,-8024.27"/>
</g>
<!-- tp_4_2 -->
<g id="node287" class="node">
<title>tp_4_2</title>
<ellipse fill="lightblue" stroke="black" cx="1630" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1630" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 132↔133</text>
<text text-anchor="middle" x="1630" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1630" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_2_0&#45;&gt;tp_4_2 -->
<g id="edge414" class="edge">
<title>expert_4_2_0&#45;&gt;tp_4_2</title>
<path fill="none" stroke="black" d="M1406.41,-7970.18C1447.87,-7957.94 1500.36,-7942.44 1544.07,-7929.53"/>
<polygon fill="black" stroke="black" points="1545.23,-7932.84 1553.83,-7926.65 1543.25,-7926.12 1545.23,-7932.84"/>
</g>
<!-- expert_4_2_1&#45;&gt;tp_4_2 -->
<g id="edge415" class="edge">
<title>expert_4_2_1&#45;&gt;tp_4_2</title>
<path fill="none" stroke="black" d="M1630,-7970.18C1630,-7962.51 1630,-7953.55 1630,-7944.76"/>
<polygon fill="black" stroke="black" points="1633.5,-7944.6 1630,-7934.6 1626.5,-7944.6 1633.5,-7944.6"/>
</g>
<!-- tp_4_2&#45;&gt;agg_4 -->
<g id="edge416" class="edge">
<title>tp_4_2&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M1740.8,-7893.9C1834.98,-7887.14 1973.79,-7877.78 2095,-7872.04 2983.74,-7829.94 4042.42,-7806.19 4498.95,-7797.23"/>
<polygon fill="black" stroke="black" points="4499.03,-7800.73 4508.96,-7797.03 4498.89,-7793.73 4499.03,-7800.73"/>
</g>
<!-- expert_4_3_0 -->
<g id="node289" class="node">
<title>expert_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-8014.27 1786.5,-8014.27 1786.5,-7970.27 2063.5,-7970.27 2063.5,-8014.27"/>
<text text-anchor="middle" x="1925" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1925" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 134</text>
<text text-anchor="middle" x="1925" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_3&#45;&gt;expert_4_3_0 -->
<g id="edge418" class="edge">
<title>route_4_3&#45;&gt;expert_4_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-8053.53C2089.92,-8041.97 2044.49,-8028.55 2006.44,-8017.32"/>
<polygon fill="black" stroke="black" points="2007.01,-8013.84 1996.43,-8014.36 2005.03,-8020.55 2007.01,-8013.84"/>
</g>
<!-- expert_4_3_1 -->
<g id="node290" class="node">
<title>expert_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-8014.27 2081.5,-8014.27 2081.5,-7970.27 2358.5,-7970.27 2358.5,-8014.27"/>
<text text-anchor="middle" x="2220" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2220" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 135</text>
<text text-anchor="middle" x="2220" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_3&#45;&gt;expert_4_3_1 -->
<g id="edge419" class="edge">
<title>route_4_3&#45;&gt;expert_4_3_1</title>
<path fill="none" stroke="black" d="M2220,-8049.91C2220,-8041.63 2220,-8032.66 2220,-8024.34"/>
<polygon fill="black" stroke="black" points="2223.5,-8024.27 2220,-8014.27 2216.5,-8024.27 2223.5,-8024.27"/>
</g>
<!-- tp_4_3 -->
<g id="node291" class="node">
<title>tp_4_3</title>
<ellipse fill="lightblue" stroke="black" cx="2220" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2220" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 134↔135</text>
<text text-anchor="middle" x="2220" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2220" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_3_0&#45;&gt;tp_4_3 -->
<g id="edge420" class="edge">
<title>expert_4_3_0&#45;&gt;tp_4_3</title>
<path fill="none" stroke="black" d="M1996.41,-7970.18C2037.87,-7957.94 2090.36,-7942.44 2134.07,-7929.53"/>
<polygon fill="black" stroke="black" points="2135.23,-7932.84 2143.83,-7926.65 2133.25,-7926.12 2135.23,-7932.84"/>
</g>
<!-- expert_4_3_1&#45;&gt;tp_4_3 -->
<g id="edge421" class="edge">
<title>expert_4_3_1&#45;&gt;tp_4_3</title>
<path fill="none" stroke="black" d="M2220,-7970.18C2220,-7962.51 2220,-7953.55 2220,-7944.76"/>
<polygon fill="black" stroke="black" points="2223.5,-7944.6 2220,-7934.6 2216.5,-7944.6 2223.5,-7944.6"/>
</g>
<!-- tp_4_3&#45;&gt;agg_4 -->
<g id="edge422" class="edge">
<title>tp_4_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2331.29,-7894.13C2425.46,-7887.54 2564.02,-7878.3 2685,-7872.04 3345.08,-7837.91 4125.88,-7811.62 4502.12,-7799.83"/>
<polygon fill="black" stroke="black" points="4502.42,-7803.32 4512.3,-7799.51 4502.2,-7796.33 4502.42,-7803.32"/>
</g>
<!-- expert_4_4_0 -->
<g id="node293" class="node">
<title>expert_4_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-8014.27 2376.5,-8014.27 2376.5,-7970.27 2653.5,-7970.27 2653.5,-8014.27"/>
<text text-anchor="middle" x="2515" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2515" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 136</text>
<text text-anchor="middle" x="2515" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_4&#45;&gt;expert_4_4_0 -->
<g id="edge424" class="edge">
<title>route_4_4&#45;&gt;expert_4_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-8053.53C2679.92,-8041.97 2634.49,-8028.55 2596.44,-8017.32"/>
<polygon fill="black" stroke="black" points="2597.01,-8013.84 2586.43,-8014.36 2595.03,-8020.55 2597.01,-8013.84"/>
</g>
<!-- expert_4_4_1 -->
<g id="node294" class="node">
<title>expert_4_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-8014.27 2671.5,-8014.27 2671.5,-7970.27 2948.5,-7970.27 2948.5,-8014.27"/>
<text text-anchor="middle" x="2810" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2810" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 137</text>
<text text-anchor="middle" x="2810" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_4&#45;&gt;expert_4_4_1 -->
<g id="edge425" class="edge">
<title>route_4_4&#45;&gt;expert_4_4_1</title>
<path fill="none" stroke="black" d="M2810,-8049.91C2810,-8041.63 2810,-8032.66 2810,-8024.34"/>
<polygon fill="black" stroke="black" points="2813.5,-8024.27 2810,-8014.27 2806.5,-8024.27 2813.5,-8024.27"/>
</g>
<!-- tp_4_4 -->
<g id="node295" class="node">
<title>tp_4_4</title>
<ellipse fill="lightblue" stroke="black" cx="2810" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2810" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 136↔137</text>
<text text-anchor="middle" x="2810" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2810" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_4_0&#45;&gt;tp_4_4 -->
<g id="edge426" class="edge">
<title>expert_4_4_0&#45;&gt;tp_4_4</title>
<path fill="none" stroke="black" d="M2586.41,-7970.18C2627.87,-7957.94 2680.36,-7942.44 2724.07,-7929.53"/>
<polygon fill="black" stroke="black" points="2725.23,-7932.84 2733.83,-7926.65 2723.25,-7926.12 2725.23,-7932.84"/>
</g>
<!-- expert_4_4_1&#45;&gt;tp_4_4 -->
<g id="edge427" class="edge">
<title>expert_4_4_1&#45;&gt;tp_4_4</title>
<path fill="none" stroke="black" d="M2810,-7970.18C2810,-7962.51 2810,-7953.55 2810,-7944.76"/>
<polygon fill="black" stroke="black" points="2813.5,-7944.6 2810,-7934.6 2806.5,-7944.6 2813.5,-7944.6"/>
</g>
<!-- tp_4_4&#45;&gt;agg_4 -->
<g id="edge428" class="edge">
<title>tp_4_4&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M2921.79,-7894.59C3015.97,-7888.3 3154.27,-7879.24 3275,-7872.04 3712.09,-7846 4223.42,-7818.98 4507.75,-7804.27"/>
<polygon fill="black" stroke="black" points="4507.96,-7807.76 4517.77,-7803.75 4507.6,-7800.77 4507.96,-7807.76"/>
</g>
<!-- expert_4_5_0 -->
<g id="node297" class="node">
<title>expert_4_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-8014.27 2966.5,-8014.27 2966.5,-7970.27 3243.5,-7970.27 3243.5,-8014.27"/>
<text text-anchor="middle" x="3105" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3105" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 138</text>
<text text-anchor="middle" x="3105" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_5&#45;&gt;expert_4_5_0 -->
<g id="edge430" class="edge">
<title>route_4_5&#45;&gt;expert_4_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-8053.53C3269.92,-8041.97 3224.49,-8028.55 3186.44,-8017.32"/>
<polygon fill="black" stroke="black" points="3187.01,-8013.84 3176.43,-8014.36 3185.03,-8020.55 3187.01,-8013.84"/>
</g>
<!-- expert_4_5_1 -->
<g id="node298" class="node">
<title>expert_4_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-8014.27 3261.5,-8014.27 3261.5,-7970.27 3538.5,-7970.27 3538.5,-8014.27"/>
<text text-anchor="middle" x="3400" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3400" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 139</text>
<text text-anchor="middle" x="3400" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_5&#45;&gt;expert_4_5_1 -->
<g id="edge431" class="edge">
<title>route_4_5&#45;&gt;expert_4_5_1</title>
<path fill="none" stroke="black" d="M3400,-8049.91C3400,-8041.63 3400,-8032.66 3400,-8024.34"/>
<polygon fill="black" stroke="black" points="3403.5,-8024.27 3400,-8014.27 3396.5,-8024.27 3403.5,-8024.27"/>
</g>
<!-- tp_4_5 -->
<g id="node299" class="node">
<title>tp_4_5</title>
<ellipse fill="lightblue" stroke="black" cx="3400" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3400" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 138↔139</text>
<text text-anchor="middle" x="3400" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3400" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_5_0&#45;&gt;tp_4_5 -->
<g id="edge432" class="edge">
<title>expert_4_5_0&#45;&gt;tp_4_5</title>
<path fill="none" stroke="black" d="M3176.41,-7970.18C3217.87,-7957.94 3270.36,-7942.44 3314.07,-7929.53"/>
<polygon fill="black" stroke="black" points="3315.23,-7932.84 3323.83,-7926.65 3313.25,-7926.12 3315.23,-7932.84"/>
</g>
<!-- expert_4_5_1&#45;&gt;tp_4_5 -->
<g id="edge433" class="edge">
<title>expert_4_5_1&#45;&gt;tp_4_5</title>
<path fill="none" stroke="black" d="M3400,-7970.18C3400,-7962.51 3400,-7953.55 3400,-7944.76"/>
<polygon fill="black" stroke="black" points="3403.5,-7944.6 3400,-7934.6 3396.5,-7944.6 3403.5,-7944.6"/>
</g>
<!-- tp_4_5&#45;&gt;agg_4 -->
<g id="edge434" class="edge">
<title>tp_4_5&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M3510.01,-7893.11C3730.49,-7874.98 4229.79,-7833.93 4515.61,-7810.42"/>
<polygon fill="black" stroke="black" points="4516.01,-7813.9 4525.69,-7809.59 4515.44,-7806.93 4516.01,-7813.9"/>
</g>
<!-- expert_4_6_0 -->
<g id="node301" class="node">
<title>expert_4_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-8014.27 3556.5,-8014.27 3556.5,-7970.27 3833.5,-7970.27 3833.5,-8014.27"/>
<text text-anchor="middle" x="3695" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3695" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 140</text>
<text text-anchor="middle" x="3695" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_6&#45;&gt;expert_4_6_0 -->
<g id="edge436" class="edge">
<title>route_4_6&#45;&gt;expert_4_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-8053.53C3859.92,-8041.97 3814.49,-8028.55 3776.44,-8017.32"/>
<polygon fill="black" stroke="black" points="3777.01,-8013.84 3766.43,-8014.36 3775.03,-8020.55 3777.01,-8013.84"/>
</g>
<!-- expert_4_6_1 -->
<g id="node302" class="node">
<title>expert_4_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-8014.27 3851.5,-8014.27 3851.5,-7970.27 4128.5,-7970.27 4128.5,-8014.27"/>
<text text-anchor="middle" x="3990" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="3990" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 141</text>
<text text-anchor="middle" x="3990" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_6&#45;&gt;expert_4_6_1 -->
<g id="edge437" class="edge">
<title>route_4_6&#45;&gt;expert_4_6_1</title>
<path fill="none" stroke="black" d="M3990,-8049.91C3990,-8041.63 3990,-8032.66 3990,-8024.34"/>
<polygon fill="black" stroke="black" points="3993.5,-8024.27 3990,-8014.27 3986.5,-8024.27 3993.5,-8024.27"/>
</g>
<!-- tp_4_6 -->
<g id="node303" class="node">
<title>tp_4_6</title>
<ellipse fill="lightblue" stroke="black" cx="3990" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3990" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 140↔141</text>
<text text-anchor="middle" x="3990" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3990" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_6_0&#45;&gt;tp_4_6 -->
<g id="edge438" class="edge">
<title>expert_4_6_0&#45;&gt;tp_4_6</title>
<path fill="none" stroke="black" d="M3766.41,-7970.18C3807.87,-7957.94 3860.36,-7942.44 3904.07,-7929.53"/>
<polygon fill="black" stroke="black" points="3905.23,-7932.84 3913.83,-7926.65 3903.25,-7926.12 3905.23,-7932.84"/>
</g>
<!-- expert_4_6_1&#45;&gt;tp_4_6 -->
<g id="edge439" class="edge">
<title>expert_4_6_1&#45;&gt;tp_4_6</title>
<path fill="none" stroke="black" d="M3990,-7970.18C3990,-7962.51 3990,-7953.55 3990,-7944.76"/>
<polygon fill="black" stroke="black" points="3993.5,-7944.6 3990,-7934.6 3986.5,-7944.6 3993.5,-7944.6"/>
</g>
<!-- tp_4_6&#45;&gt;agg_4 -->
<g id="edge440" class="edge">
<title>tp_4_6&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M4090.16,-7887.33C4202.68,-7870.67 4388.1,-7843.22 4529.93,-7822.22"/>
<polygon fill="black" stroke="black" points="4530.68,-7825.65 4540.06,-7820.72 4529.66,-7818.72 4530.68,-7825.65"/>
</g>
<!-- expert_4_7_0 -->
<g id="node305" class="node">
<title>expert_4_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-8014.27 4146.5,-8014.27 4146.5,-7970.27 4423.5,-7970.27 4423.5,-8014.27"/>
<text text-anchor="middle" x="4285" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4285" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 142</text>
<text text-anchor="middle" x="4285" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_7&#45;&gt;expert_4_7_0 -->
<g id="edge442" class="edge">
<title>route_4_7&#45;&gt;expert_4_7_0</title>
<path fill="none" stroke="black" d="M4443.32,-8052.46C4413.66,-8041.37 4379.83,-8028.72 4351.08,-8017.97"/>
<polygon fill="black" stroke="black" points="4352.13,-8014.63 4341.54,-8014.41 4349.68,-8021.19 4352.13,-8014.63"/>
</g>
<!-- expert_4_7_1 -->
<g id="node306" class="node">
<title>expert_4_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-8014.27 4441.5,-8014.27 4441.5,-7970.27 4718.5,-7970.27 4718.5,-8014.27"/>
<text text-anchor="middle" x="4580" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4580" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 143</text>
<text text-anchor="middle" x="4580" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_7&#45;&gt;expert_4_7_1 -->
<g id="edge443" class="edge">
<title>route_4_7&#45;&gt;expert_4_7_1</title>
<path fill="none" stroke="black" d="M4539.34,-8050.4C4545.71,-8041.45 4552.68,-8031.65 4559.03,-8022.73"/>
<polygon fill="black" stroke="black" points="4561.94,-8024.68 4564.88,-8014.51 4556.23,-8020.63 4561.94,-8024.68"/>
</g>
<!-- tp_4_7 -->
<g id="node307" class="node">
<title>tp_4_7</title>
<ellipse fill="lightblue" stroke="black" cx="4580" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4580" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4580" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 142↔143</text>
<text text-anchor="middle" x="4580" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4580" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_7_0&#45;&gt;tp_4_7 -->
<g id="edge444" class="edge">
<title>expert_4_7_0&#45;&gt;tp_4_7</title>
<path fill="none" stroke="black" d="M4356.41,-7970.18C4397.87,-7957.94 4450.36,-7942.44 4494.07,-7929.53"/>
<polygon fill="black" stroke="black" points="4495.23,-7932.84 4503.83,-7926.65 4493.25,-7926.12 4495.23,-7932.84"/>
</g>
<!-- expert_4_7_1&#45;&gt;tp_4_7 -->
<g id="edge445" class="edge">
<title>expert_4_7_1&#45;&gt;tp_4_7</title>
<path fill="none" stroke="black" d="M4580,-7970.18C4580,-7962.51 4580,-7953.55 4580,-7944.76"/>
<polygon fill="black" stroke="black" points="4583.5,-7944.6 4580,-7934.6 4576.5,-7944.6 4583.5,-7944.6"/>
</g>
<!-- tp_4_7&#45;&gt;agg_4 -->
<g id="edge446" class="edge">
<title>tp_4_7&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M4618.24,-7873.77C4631.3,-7864.07 4646.31,-7852.93 4660.93,-7842.08"/>
<polygon fill="black" stroke="black" points="4663.05,-7844.87 4668.99,-7836.1 4658.88,-7839.25 4663.05,-7844.87"/>
</g>
<!-- expert_4_8_0 -->
<g id="node309" class="node">
<title>expert_4_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-8014.27 4736.5,-8014.27 4736.5,-7970.27 5013.5,-7970.27 5013.5,-8014.27"/>
<text text-anchor="middle" x="4875" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4875" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 144</text>
<text text-anchor="middle" x="4875" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_8&#45;&gt;expert_4_8_0 -->
<g id="edge448" class="edge">
<title>route_4_8&#45;&gt;expert_4_8_0</title>
<path fill="none" stroke="black" d="M4916.32,-8050.4C4909.85,-8041.45 4902.76,-8031.65 4896.31,-8022.73"/>
<polygon fill="black" stroke="black" points="4899.06,-8020.56 4890.36,-8014.51 4893.39,-8024.66 4899.06,-8020.56"/>
</g>
<!-- expert_4_8_1 -->
<g id="node310" class="node">
<title>expert_4_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-8014.27 5031.5,-8014.27 5031.5,-7970.27 5308.5,-7970.27 5308.5,-8014.27"/>
<text text-anchor="middle" x="5170" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5170" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 145</text>
<text text-anchor="middle" x="5170" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_8&#45;&gt;expert_4_8_1 -->
<g id="edge449" class="edge">
<title>route_4_8&#45;&gt;expert_4_8_1</title>
<path fill="none" stroke="black" d="M5012.36,-8052.46C5041.89,-8041.37 5075.58,-8028.72 5104.2,-8017.97"/>
<polygon fill="black" stroke="black" points="5105.57,-8021.2 5113.71,-8014.41 5103.11,-8014.64 5105.57,-8021.2"/>
</g>
<!-- tp_4_8 -->
<g id="node311" class="node">
<title>tp_4_8</title>
<ellipse fill="lightblue" stroke="black" cx="4875" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4875" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4875" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 144↔145</text>
<text text-anchor="middle" x="4875" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4875" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_8_0&#45;&gt;tp_4_8 -->
<g id="edge450" class="edge">
<title>expert_4_8_0&#45;&gt;tp_4_8</title>
<path fill="none" stroke="black" d="M4875,-7970.18C4875,-7962.51 4875,-7953.55 4875,-7944.76"/>
<polygon fill="black" stroke="black" points="4878.5,-7944.6 4875,-7934.6 4871.5,-7944.6 4878.5,-7944.6"/>
</g>
<!-- expert_4_8_1&#45;&gt;tp_4_8 -->
<g id="edge451" class="edge">
<title>expert_4_8_1&#45;&gt;tp_4_8</title>
<path fill="none" stroke="black" d="M5098.59,-7970.18C5057.13,-7957.94 5004.64,-7942.44 4960.93,-7929.53"/>
<polygon fill="black" stroke="black" points="4961.75,-7926.12 4951.17,-7926.65 4959.77,-7932.84 4961.75,-7926.12"/>
</g>
<!-- tp_4_8&#45;&gt;agg_4 -->
<g id="edge452" class="edge">
<title>tp_4_8&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M4836.5,-7873.77C4823.35,-7864.07 4808.24,-7852.93 4793.52,-7842.08"/>
<polygon fill="black" stroke="black" points="4795.53,-7839.22 4785.4,-7836.1 4791.37,-7844.85 4795.53,-7839.22"/>
</g>
<!-- expert_4_9_0 -->
<g id="node313" class="node">
<title>expert_4_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-8014.27 5326.5,-8014.27 5326.5,-7970.27 5603.5,-7970.27 5603.5,-8014.27"/>
<text text-anchor="middle" x="5465" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5465" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 146</text>
<text text-anchor="middle" x="5465" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_9&#45;&gt;expert_4_9_0 -->
<g id="edge454" class="edge">
<title>route_4_9&#45;&gt;expert_4_9_0</title>
<path fill="none" stroke="black" d="M5465,-8049.91C5465,-8041.63 5465,-8032.66 5465,-8024.34"/>
<polygon fill="black" stroke="black" points="5468.5,-8024.27 5465,-8014.27 5461.5,-8024.27 5468.5,-8024.27"/>
</g>
<!-- expert_4_9_1 -->
<g id="node314" class="node">
<title>expert_4_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-8014.27 5621.5,-8014.27 5621.5,-7970.27 5898.5,-7970.27 5898.5,-8014.27"/>
<text text-anchor="middle" x="5760" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5760" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 147</text>
<text text-anchor="middle" x="5760" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_9&#45;&gt;expert_4_9_1 -->
<g id="edge455" class="edge">
<title>route_4_9&#45;&gt;expert_4_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-8053.53C5595.08,-8041.97 5640.51,-8028.55 5678.56,-8017.32"/>
<polygon fill="black" stroke="black" points="5679.97,-8020.55 5688.57,-8014.36 5677.99,-8013.84 5679.97,-8020.55"/>
</g>
<!-- tp_4_9 -->
<g id="node315" class="node">
<title>tp_4_9</title>
<ellipse fill="lightblue" stroke="black" cx="5465" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5465" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 146↔147</text>
<text text-anchor="middle" x="5465" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5465" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_9_0&#45;&gt;tp_4_9 -->
<g id="edge456" class="edge">
<title>expert_4_9_0&#45;&gt;tp_4_9</title>
<path fill="none" stroke="black" d="M5465,-7970.18C5465,-7962.51 5465,-7953.55 5465,-7944.76"/>
<polygon fill="black" stroke="black" points="5468.5,-7944.6 5465,-7934.6 5461.5,-7944.6 5468.5,-7944.6"/>
</g>
<!-- expert_4_9_1&#45;&gt;tp_4_9 -->
<g id="edge457" class="edge">
<title>expert_4_9_1&#45;&gt;tp_4_9</title>
<path fill="none" stroke="black" d="M5688.59,-7970.18C5647.13,-7957.94 5594.64,-7942.44 5550.93,-7929.53"/>
<polygon fill="black" stroke="black" points="5551.75,-7926.12 5541.17,-7926.65 5549.77,-7932.84 5551.75,-7926.12"/>
</g>
<!-- tp_4_9&#45;&gt;agg_4 -->
<g id="edge458" class="edge">
<title>tp_4_9&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M5364.7,-7887.33C5275.3,-7874.11 5139.93,-7854.09 5016.87,-7835.9"/>
<polygon fill="black" stroke="black" points="5017.31,-7832.43 5006.9,-7834.43 5016.28,-7839.35 5017.31,-7832.43"/>
</g>
<!-- expert_4_10_0 -->
<g id="node317" class="node">
<title>expert_4_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-8014.27 5916.5,-8014.27 5916.5,-7970.27 6193.5,-7970.27 6193.5,-8014.27"/>
<text text-anchor="middle" x="6055" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6055" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 148</text>
<text text-anchor="middle" x="6055" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_10&#45;&gt;expert_4_10_0 -->
<g id="edge460" class="edge">
<title>route_4_10&#45;&gt;expert_4_10_0</title>
<path fill="none" stroke="black" d="M6055,-8049.91C6055,-8041.63 6055,-8032.66 6055,-8024.34"/>
<polygon fill="black" stroke="black" points="6058.5,-8024.27 6055,-8014.27 6051.5,-8024.27 6058.5,-8024.27"/>
</g>
<!-- expert_4_10_1 -->
<g id="node318" class="node">
<title>expert_4_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-8014.27 6211.5,-8014.27 6211.5,-7970.27 6488.5,-7970.27 6488.5,-8014.27"/>
<text text-anchor="middle" x="6350" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6350" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 149</text>
<text text-anchor="middle" x="6350" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_10&#45;&gt;expert_4_10_1 -->
<g id="edge461" class="edge">
<title>route_4_10&#45;&gt;expert_4_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-8053.53C6185.08,-8041.97 6230.51,-8028.55 6268.56,-8017.32"/>
<polygon fill="black" stroke="black" points="6269.97,-8020.55 6278.57,-8014.36 6267.99,-8013.84 6269.97,-8020.55"/>
</g>
<!-- tp_4_10 -->
<g id="node319" class="node">
<title>tp_4_10</title>
<ellipse fill="lightblue" stroke="black" cx="6055" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6055" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 148↔149</text>
<text text-anchor="middle" x="6055" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6055" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_10_0&#45;&gt;tp_4_10 -->
<g id="edge462" class="edge">
<title>expert_4_10_0&#45;&gt;tp_4_10</title>
<path fill="none" stroke="black" d="M6055,-7970.18C6055,-7962.51 6055,-7953.55 6055,-7944.76"/>
<polygon fill="black" stroke="black" points="6058.5,-7944.6 6055,-7934.6 6051.5,-7944.6 6058.5,-7944.6"/>
</g>
<!-- expert_4_10_1&#45;&gt;tp_4_10 -->
<g id="edge463" class="edge">
<title>expert_4_10_1&#45;&gt;tp_4_10</title>
<path fill="none" stroke="black" d="M6278.59,-7970.18C6237.13,-7957.94 6184.64,-7942.44 6140.93,-7929.53"/>
<polygon fill="black" stroke="black" points="6141.75,-7926.12 6131.17,-7926.65 6139.77,-7932.84 6141.75,-7926.12"/>
</g>
<!-- tp_4_10&#45;&gt;agg_4 -->
<g id="edge464" class="edge">
<title>tp_4_10&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M5945.19,-7893.13C5737.46,-7876.06 5281.69,-7838.62 4990.33,-7814.68"/>
<polygon fill="black" stroke="black" points="4990.29,-7811.16 4980.03,-7813.83 4989.71,-7818.14 4990.29,-7811.16"/>
</g>
<!-- expert_4_11_0 -->
<g id="node321" class="node">
<title>expert_4_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-8014.27 6506.5,-8014.27 6506.5,-7970.27 6783.5,-7970.27 6783.5,-8014.27"/>
<text text-anchor="middle" x="6645" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6645" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 150</text>
<text text-anchor="middle" x="6645" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_11&#45;&gt;expert_4_11_0 -->
<g id="edge466" class="edge">
<title>route_4_11&#45;&gt;expert_4_11_0</title>
<path fill="none" stroke="black" d="M6645,-8049.91C6645,-8041.63 6645,-8032.66 6645,-8024.34"/>
<polygon fill="black" stroke="black" points="6648.5,-8024.27 6645,-8014.27 6641.5,-8024.27 6648.5,-8024.27"/>
</g>
<!-- expert_4_11_1 -->
<g id="node322" class="node">
<title>expert_4_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-8014.27 6801.5,-8014.27 6801.5,-7970.27 7078.5,-7970.27 7078.5,-8014.27"/>
<text text-anchor="middle" x="6940" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="6940" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 151</text>
<text text-anchor="middle" x="6940" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_11&#45;&gt;expert_4_11_1 -->
<g id="edge467" class="edge">
<title>route_4_11&#45;&gt;expert_4_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-8053.53C6775.08,-8041.97 6820.51,-8028.55 6858.56,-8017.32"/>
<polygon fill="black" stroke="black" points="6859.97,-8020.55 6868.57,-8014.36 6857.99,-8013.84 6859.97,-8020.55"/>
</g>
<!-- tp_4_11 -->
<g id="node323" class="node">
<title>tp_4_11</title>
<ellipse fill="lightblue" stroke="black" cx="6645" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6645" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 150↔151</text>
<text text-anchor="middle" x="6645" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6645" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_11_0&#45;&gt;tp_4_11 -->
<g id="edge468" class="edge">
<title>expert_4_11_0&#45;&gt;tp_4_11</title>
<path fill="none" stroke="black" d="M6645,-7970.18C6645,-7962.51 6645,-7953.55 6645,-7944.76"/>
<polygon fill="black" stroke="black" points="6648.5,-7944.6 6645,-7934.6 6641.5,-7944.6 6648.5,-7944.6"/>
</g>
<!-- expert_4_11_1&#45;&gt;tp_4_11 -->
<g id="edge469" class="edge">
<title>expert_4_11_1&#45;&gt;tp_4_11</title>
<path fill="none" stroke="black" d="M6868.59,-7970.18C6827.13,-7957.94 6774.64,-7942.44 6730.93,-7929.53"/>
<polygon fill="black" stroke="black" points="6731.75,-7926.12 6721.17,-7926.65 6729.77,-7932.84 6731.75,-7926.12"/>
</g>
<!-- tp_4_11&#45;&gt;agg_4 -->
<g id="edge470" class="edge">
<title>tp_4_11&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M6533.21,-7894.59C6439.03,-7888.29 6300.73,-7879.23 6180,-7872.04 5758.96,-7846.96 5269.09,-7820.99 4979.26,-7805.96"/>
<polygon fill="black" stroke="black" points="4979.2,-7802.46 4969.03,-7805.43 4978.84,-7809.45 4979.2,-7802.46"/>
</g>
<!-- expert_4_12_0 -->
<g id="node325" class="node">
<title>expert_4_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-8014.27 7096.5,-8014.27 7096.5,-7970.27 7373.5,-7970.27 7373.5,-8014.27"/>
<text text-anchor="middle" x="7235" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7235" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 152</text>
<text text-anchor="middle" x="7235" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_12&#45;&gt;expert_4_12_0 -->
<g id="edge472" class="edge">
<title>route_4_12&#45;&gt;expert_4_12_0</title>
<path fill="none" stroke="black" d="M7235,-8049.91C7235,-8041.63 7235,-8032.66 7235,-8024.34"/>
<polygon fill="black" stroke="black" points="7238.5,-8024.27 7235,-8014.27 7231.5,-8024.27 7238.5,-8024.27"/>
</g>
<!-- expert_4_12_1 -->
<g id="node326" class="node">
<title>expert_4_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-8014.27 7391.5,-8014.27 7391.5,-7970.27 7668.5,-7970.27 7668.5,-8014.27"/>
<text text-anchor="middle" x="7530" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7530" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 153</text>
<text text-anchor="middle" x="7530" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_12&#45;&gt;expert_4_12_1 -->
<g id="edge473" class="edge">
<title>route_4_12&#45;&gt;expert_4_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-8053.53C7365.08,-8041.97 7410.51,-8028.55 7448.56,-8017.32"/>
<polygon fill="black" stroke="black" points="7449.97,-8020.55 7458.57,-8014.36 7447.99,-8013.84 7449.97,-8020.55"/>
</g>
<!-- tp_4_12 -->
<g id="node327" class="node">
<title>tp_4_12</title>
<ellipse fill="lightblue" stroke="black" cx="7235" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7235" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 152↔153</text>
<text text-anchor="middle" x="7235" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7235" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_12_0&#45;&gt;tp_4_12 -->
<g id="edge474" class="edge">
<title>expert_4_12_0&#45;&gt;tp_4_12</title>
<path fill="none" stroke="black" d="M7235,-7970.18C7235,-7962.51 7235,-7953.55 7235,-7944.76"/>
<polygon fill="black" stroke="black" points="7238.5,-7944.6 7235,-7934.6 7231.5,-7944.6 7238.5,-7944.6"/>
</g>
<!-- expert_4_12_1&#45;&gt;tp_4_12 -->
<g id="edge475" class="edge">
<title>expert_4_12_1&#45;&gt;tp_4_12</title>
<path fill="none" stroke="black" d="M7458.59,-7970.18C7417.13,-7957.94 7364.64,-7942.44 7320.93,-7929.53"/>
<polygon fill="black" stroke="black" points="7321.75,-7926.12 7311.17,-7926.65 7319.77,-7932.84 7321.75,-7926.12"/>
</g>
<!-- tp_4_12&#45;&gt;agg_4 -->
<g id="edge476" class="edge">
<title>tp_4_12&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M7123.71,-7894.13C7029.54,-7887.54 6890.98,-7878.3 6770,-7872.04 6121.3,-7838.5 5356.04,-7812.54 4972.37,-7800.47"/>
<polygon fill="black" stroke="black" points="4972.36,-7796.97 4962.26,-7800.15 4972.14,-7803.96 4972.36,-7796.97"/>
</g>
<!-- expert_4_13_0 -->
<g id="node329" class="node">
<title>expert_4_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-8014.27 7686.5,-8014.27 7686.5,-7970.27 7963.5,-7970.27 7963.5,-8014.27"/>
<text text-anchor="middle" x="7825" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7825" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 154</text>
<text text-anchor="middle" x="7825" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_13&#45;&gt;expert_4_13_0 -->
<g id="edge478" class="edge">
<title>route_4_13&#45;&gt;expert_4_13_0</title>
<path fill="none" stroke="black" d="M7825,-8049.91C7825,-8041.63 7825,-8032.66 7825,-8024.34"/>
<polygon fill="black" stroke="black" points="7828.5,-8024.27 7825,-8014.27 7821.5,-8024.27 7828.5,-8024.27"/>
</g>
<!-- expert_4_13_1 -->
<g id="node330" class="node">
<title>expert_4_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-8014.27 7981.5,-8014.27 7981.5,-7970.27 8258.5,-7970.27 8258.5,-8014.27"/>
<text text-anchor="middle" x="8120" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8120" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 155</text>
<text text-anchor="middle" x="8120" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_13&#45;&gt;expert_4_13_1 -->
<g id="edge479" class="edge">
<title>route_4_13&#45;&gt;expert_4_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-8053.53C7955.08,-8041.97 8000.51,-8028.55 8038.56,-8017.32"/>
<polygon fill="black" stroke="black" points="8039.97,-8020.55 8048.57,-8014.36 8037.99,-8013.84 8039.97,-8020.55"/>
</g>
<!-- tp_4_13 -->
<g id="node331" class="node">
<title>tp_4_13</title>
<ellipse fill="lightblue" stroke="black" cx="7825" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7825" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 154↔155</text>
<text text-anchor="middle" x="7825" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7825" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_13_0&#45;&gt;tp_4_13 -->
<g id="edge480" class="edge">
<title>expert_4_13_0&#45;&gt;tp_4_13</title>
<path fill="none" stroke="black" d="M7825,-7970.18C7825,-7962.51 7825,-7953.55 7825,-7944.76"/>
<polygon fill="black" stroke="black" points="7828.5,-7944.6 7825,-7934.6 7821.5,-7944.6 7828.5,-7944.6"/>
</g>
<!-- expert_4_13_1&#45;&gt;tp_4_13 -->
<g id="edge481" class="edge">
<title>expert_4_13_1&#45;&gt;tp_4_13</title>
<path fill="none" stroke="black" d="M8048.59,-7970.18C8007.13,-7957.94 7954.64,-7942.44 7910.93,-7929.53"/>
<polygon fill="black" stroke="black" points="7911.75,-7926.12 7901.17,-7926.65 7909.77,-7932.84 7911.75,-7926.12"/>
</g>
<!-- tp_4_13&#45;&gt;agg_4 -->
<g id="edge482" class="edge">
<title>tp_4_13&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M7714.2,-7893.89C7620.02,-7887.13 7481.21,-7877.78 7360,-7872.04 6479.43,-7830.33 5432.09,-7806.64 4968.4,-7797.49"/>
<polygon fill="black" stroke="black" points="4968.3,-7793.98 4958.24,-7797.29 4968.17,-7800.98 4968.3,-7793.98"/>
</g>
<!-- expert_4_14_0 -->
<g id="node333" class="node">
<title>expert_4_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-8014.27 8276.5,-8014.27 8276.5,-7970.27 8553.5,-7970.27 8553.5,-8014.27"/>
<text text-anchor="middle" x="8415" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8415" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 156</text>
<text text-anchor="middle" x="8415" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_14&#45;&gt;expert_4_14_0 -->
<g id="edge484" class="edge">
<title>route_4_14&#45;&gt;expert_4_14_0</title>
<path fill="none" stroke="black" d="M8415,-8049.91C8415,-8041.63 8415,-8032.66 8415,-8024.34"/>
<polygon fill="black" stroke="black" points="8418.5,-8024.27 8415,-8014.27 8411.5,-8024.27 8418.5,-8024.27"/>
</g>
<!-- expert_4_14_1 -->
<g id="node334" class="node">
<title>expert_4_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-8014.27 8571.5,-8014.27 8571.5,-7970.27 8848.5,-7970.27 8848.5,-8014.27"/>
<text text-anchor="middle" x="8710" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8710" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 157</text>
<text text-anchor="middle" x="8710" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_14&#45;&gt;expert_4_14_1 -->
<g id="edge485" class="edge">
<title>route_4_14&#45;&gt;expert_4_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-8053.53C8545.08,-8041.97 8590.51,-8028.55 8628.56,-8017.32"/>
<polygon fill="black" stroke="black" points="8629.97,-8020.55 8638.57,-8014.36 8627.99,-8013.84 8629.97,-8020.55"/>
</g>
<!-- tp_4_14 -->
<g id="node335" class="node">
<title>tp_4_14</title>
<ellipse fill="lightblue" stroke="black" cx="8415" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8415" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 156↔157</text>
<text text-anchor="middle" x="8415" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8415" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_14_0&#45;&gt;tp_4_14 -->
<g id="edge486" class="edge">
<title>expert_4_14_0&#45;&gt;tp_4_14</title>
<path fill="none" stroke="black" d="M8415,-7970.18C8415,-7962.51 8415,-7953.55 8415,-7944.76"/>
<polygon fill="black" stroke="black" points="8418.5,-7944.6 8415,-7934.6 8411.5,-7944.6 8418.5,-7944.6"/>
</g>
<!-- expert_4_14_1&#45;&gt;tp_4_14 -->
<g id="edge487" class="edge">
<title>expert_4_14_1&#45;&gt;tp_4_14</title>
<path fill="none" stroke="black" d="M8638.59,-7970.18C8597.13,-7957.94 8544.64,-7942.44 8500.93,-7929.53"/>
<polygon fill="black" stroke="black" points="8501.75,-7926.12 8491.17,-7926.65 8499.77,-7932.84 8501.75,-7926.12"/>
</g>
<!-- tp_4_14&#45;&gt;agg_4 -->
<g id="edge488" class="edge">
<title>tp_4_14&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M8304.2,-7893.72C8210.04,-7886.86 8071.23,-7877.45 7950,-7872.04 6834.96,-7822.29 5501.42,-7802.11 4966.36,-7795.62"/>
<polygon fill="black" stroke="black" points="4966.25,-7792.12 4956.21,-7795.5 4966.16,-7799.12 4966.25,-7792.12"/>
</g>
<!-- expert_4_15_0 -->
<g id="node337" class="node">
<title>expert_4_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-8014.27 8866.5,-8014.27 8866.5,-7970.27 9143.5,-7970.27 9143.5,-8014.27"/>
<text text-anchor="middle" x="9005" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9005" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 158</text>
<text text-anchor="middle" x="9005" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_15&#45;&gt;expert_4_15_0 -->
<g id="edge490" class="edge">
<title>route_4_15&#45;&gt;expert_4_15_0</title>
<path fill="none" stroke="black" d="M9005,-8049.91C9005,-8041.63 9005,-8032.66 9005,-8024.34"/>
<polygon fill="black" stroke="black" points="9008.5,-8024.27 9005,-8014.27 9001.5,-8024.27 9008.5,-8024.27"/>
</g>
<!-- expert_4_15_1 -->
<g id="node338" class="node">
<title>expert_4_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-8014.27 9161.5,-8014.27 9161.5,-7970.27 9438.5,-7970.27 9438.5,-8014.27"/>
<text text-anchor="middle" x="9300" y="-8005.07" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9300" y="-7995.07" font-family="Times,serif" font-size="9.00">GPU: 159</text>
<text text-anchor="middle" x="9300" y="-7985.07" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-7975.07" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_4_15&#45;&gt;expert_4_15_1 -->
<g id="edge491" class="edge">
<title>route_4_15&#45;&gt;expert_4_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-8053.53C9135.08,-8041.97 9180.51,-8028.55 9218.56,-8017.32"/>
<polygon fill="black" stroke="black" points="9219.97,-8020.55 9228.57,-8014.36 9217.99,-8013.84 9219.97,-8020.55"/>
</g>
<!-- tp_4_15 -->
<g id="node339" class="node">
<title>tp_4_15</title>
<ellipse fill="lightblue" stroke="black" cx="9005" cy="-7903.15" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-7915.95" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9005" y="-7905.95" font-family="Times,serif" font-size="9.00">GPU: 158↔159</text>
<text text-anchor="middle" x="9005" y="-7895.95" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9005" y="-7885.95" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_4_15_0&#45;&gt;tp_4_15 -->
<g id="edge492" class="edge">
<title>expert_4_15_0&#45;&gt;tp_4_15</title>
<path fill="none" stroke="black" d="M9005,-7970.18C9005,-7962.51 9005,-7953.55 9005,-7944.76"/>
<polygon fill="black" stroke="black" points="9008.5,-7944.6 9005,-7934.6 9001.5,-7944.6 9008.5,-7944.6"/>
</g>
<!-- expert_4_15_1&#45;&gt;tp_4_15 -->
<g id="edge493" class="edge">
<title>expert_4_15_1&#45;&gt;tp_4_15</title>
<path fill="none" stroke="black" d="M9228.59,-7970.18C9187.13,-7957.94 9134.64,-7942.44 9090.93,-7929.53"/>
<polygon fill="black" stroke="black" points="9091.75,-7926.12 9081.17,-7926.65 9089.77,-7932.84 9091.75,-7926.12"/>
</g>
<!-- tp_4_15&#45;&gt;agg_4 -->
<g id="edge494" class="edge">
<title>tp_4_15&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M8894.21,-7893.61C8800.04,-7886.67 8661.24,-7877.22 8540,-7872.04 7187.8,-7814.28 5563.99,-7798.39 4964.41,-7794.34"/>
<polygon fill="black" stroke="black" points="4964.38,-7790.84 4954.35,-7794.27 4964.33,-7797.84 4964.38,-7790.84"/>
</g>
<!-- output_4 -->
<g id="node341" class="node">
<title>output_4</title>
<polygon fill="lightgreen" stroke="black" points="4875,-7712.04 4579,-7712.04 4579,-7668.04 4875,-7668.04 4875,-7712.04"/>
<text text-anchor="middle" x="4727" y="-7702.84" font-family="Times,serif" font-size="9.00">Layer 4 Output</text>
<text text-anchor="middle" x="4727" y="-7692.84" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-7682.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4727" y="-7672.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_4&#45;&gt;output_4 -->
<g id="edge495" class="edge">
<title>agg_4&#45;&gt;output_4</title>
<path fill="none" stroke="black" d="M4727,-7747.76C4727,-7739.17 4727,-7730.32 4727,-7722.23"/>
<polygon fill="black" stroke="black" points="4730.5,-7722.12 4727,-7712.12 4723.5,-7722.12 4730.5,-7722.12"/>
</g>
<!-- mha_5 -->
<g id="node342" class="node">
<title>mha_5</title>
<polygon fill="lightgreen" stroke="black" points="4875,-7632.04 4579,-7632.04 4579,-7588.04 4875,-7588.04 4875,-7632.04"/>
<text text-anchor="middle" x="4727" y="-7622.84" font-family="Times,serif" font-size="9.00">MHA L5</text>
<text text-anchor="middle" x="4727" y="-7612.84" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-7602.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-7592.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_4&#45;&gt;mha_5 -->
<g id="edge496" class="edge">
<title>output_4&#45;&gt;mha_5</title>
<path fill="none" stroke="black" d="M4727,-7667.73C4727,-7659.84 4727,-7650.73 4727,-7642.14"/>
<polygon fill="black" stroke="black" points="4730.5,-7642.06 4727,-7632.06 4723.5,-7642.06 4730.5,-7642.06"/>
</g>
<!-- gate_5 -->
<g id="node343" class="node">
<title>gate_5</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-7552.04 4549.92,-7552.04 4427.26,-7464.04 4904.08,-7464.04 5026.74,-7552.04"/>
<text text-anchor="middle" x="4727" y="-7520.84" font-family="Times,serif" font-size="9.00">Gate L5</text>
<text text-anchor="middle" x="4727" y="-7510.84" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-7500.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-7490.84" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_5&#45;&gt;gate_5 -->
<g id="edge497" class="edge">
<title>mha_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M4727,-7587.83C4727,-7580.34 4727,-7571.53 4727,-7562.57"/>
<polygon fill="black" stroke="black" points="4730.5,-7562.45 4727,-7552.45 4723.5,-7562.45 4730.5,-7562.45"/>
</g>
<!-- route_5_0 -->
<g id="node344" class="node">
<title>route_5_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="450" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="450" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="450" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 160,161</text>
<text text-anchor="middle" x="450" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_0 -->
<g id="edge498" class="edge">
<title>gate_5&#45;&gt;route_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4487.09,-7507.08C3876.43,-7506.12 2213.63,-7496.83 830,-7428.04 764.75,-7424.8 693.32,-7419.58 630.17,-7414.39"/>
<polygon fill="black" stroke="black" points="630.36,-7410.89 620.11,-7413.56 629.79,-7417.87 630.36,-7410.89"/>
</g>
<!-- route_5_1 -->
<g id="node348" class="node">
<title>route_5_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1040" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1040" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 162,163</text>
<text text-anchor="middle" x="1040" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_1 -->
<g id="edge504" class="edge">
<title>gate_5&#45;&gt;route_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4485.4,-7505.83C3938.99,-7502.1 2566.53,-7487.12 1420,-7428.04 1354.91,-7424.69 1283.67,-7419.46 1220.63,-7414.29"/>
<polygon fill="black" stroke="black" points="1220.84,-7410.8 1210.59,-7413.46 1220.27,-7417.77 1220.84,-7410.8"/>
</g>
<!-- route_5_2 -->
<g id="node352" class="node">
<title>route_5_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1630" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1630" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 164,165</text>
<text text-anchor="middle" x="1630" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_2 -->
<g id="edge510" class="edge">
<title>gate_5&#45;&gt;route_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4482.82,-7504.03C4006.8,-7497.26 2921.5,-7477.38 2010,-7428.04 1945.08,-7424.53 1874.02,-7419.28 1811.1,-7414.14"/>
<polygon fill="black" stroke="black" points="1811.32,-7410.64 1801.07,-7413.31 1810.75,-7417.62 1811.32,-7410.64"/>
</g>
<!-- route_5_3 -->
<g id="node356" class="node">
<title>route_5_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2220" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2220" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 166,167</text>
<text text-anchor="middle" x="2220" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_3 -->
<g id="edge516" class="edge">
<title>gate_5&#45;&gt;route_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4478.78,-7501.2C4081.71,-7491.09 3279.24,-7467.55 2600,-7428.04 2535.41,-7424.28 2464.73,-7419.01 2402.03,-7413.91"/>
<polygon fill="black" stroke="black" points="2402.29,-7410.42 2392.04,-7413.1 2401.72,-7417.4 2402.29,-7410.42"/>
</g>
<!-- route_5_4 -->
<g id="node360" class="node">
<title>route_5_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2810" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2810" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 168,169</text>
<text text-anchor="middle" x="2810" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_4 -->
<g id="edge522" class="edge">
<title>gate_5&#45;&gt;route_5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4471.91,-7496.1C4166.88,-7482.51 3640.93,-7457.49 3190,-7428.04 3126.04,-7423.86 3056.08,-7418.54 2993.82,-7413.53"/>
<polygon fill="black" stroke="black" points="2993.74,-7410.01 2983.49,-7412.7 2993.18,-7416.99 2993.74,-7410.01"/>
</g>
<!-- route_5_5 -->
<g id="node364" class="node">
<title>route_5_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3400" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3400" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 170,171</text>
<text text-anchor="middle" x="3400" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_5 -->
<g id="edge528" class="edge">
<title>gate_5&#45;&gt;route_5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4456.06,-7484.76C4196.32,-7463.41 3811.23,-7431.74 3584.92,-7413.13"/>
<polygon fill="black" stroke="black" points="3585.18,-7409.64 3574.93,-7412.31 3584.61,-7416.62 3585.18,-7409.64"/>
</g>
<!-- route_5_6 -->
<g id="node368" class="node">
<title>route_5_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3990" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="3990" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 172,173</text>
<text text-anchor="middle" x="3990" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_6 -->
<g id="edge534" class="edge">
<title>gate_5&#45;&gt;route_5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4436.51,-7464.04C4335.8,-7449.12 4226.94,-7433.01 4141.92,-7420.42"/>
<polygon fill="black" stroke="black" points="4142.34,-7416.94 4131.93,-7418.94 4141.31,-7423.87 4142.34,-7416.94"/>
</g>
<!-- route_5_7 -->
<g id="node372" class="node">
<title>route_5_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4518" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4518" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4518" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 174,175</text>
<text text-anchor="middle" x="4518" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4518" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_7 -->
<g id="edge540" class="edge">
<title>gate_5&#45;&gt;route_5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4644.4,-7463.92C4623.91,-7453.22 4602.25,-7441.91 4582.75,-7431.73"/>
<polygon fill="black" stroke="black" points="4584.15,-7428.52 4573.67,-7426.99 4580.91,-7434.72 4584.15,-7428.52"/>
</g>
<!-- route_5_8 -->
<g id="node376" class="node">
<title>route_5_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4938" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4938" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4938" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 176,177</text>
<text text-anchor="middle" x="4938" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4938" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_8 -->
<g id="edge546" class="edge">
<title>gate_5&#45;&gt;route_5_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4810.39,-7463.92C4831.27,-7453.12 4853.36,-7441.7 4873.18,-7431.45"/>
<polygon fill="black" stroke="black" points="4874.84,-7434.53 4882.12,-7426.83 4871.63,-7428.31 4874.84,-7434.53"/>
</g>
<!-- route_5_9 -->
<g id="node380" class="node">
<title>route_5_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5465" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5465" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 178,179</text>
<text text-anchor="middle" x="5465" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_9 -->
<g id="edge552" class="edge">
<title>gate_5&#45;&gt;route_5_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4923.8,-7477.95C5045.76,-7459.91 5200.08,-7437.1 5312.69,-7420.45"/>
<polygon fill="black" stroke="black" points="5313.39,-7423.88 5322.77,-7418.96 5312.37,-7416.96 5313.39,-7423.88"/>
</g>
<!-- route_5_10 -->
<g id="node384" class="node">
<title>route_5_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6055" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6055" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 180,181</text>
<text text-anchor="middle" x="6055" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_10 -->
<g id="edge558" class="edge">
<title>gate_5&#45;&gt;route_5_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4940,-7489.54C5197.37,-7468.4 5626.14,-7433.17 5870.18,-7413.12"/>
<polygon fill="black" stroke="black" points="5870.54,-7416.6 5880.22,-7412.29 5869.96,-7409.62 5870.54,-7416.6"/>
</g>
<!-- route_5_11 -->
<g id="node388" class="node">
<title>route_5_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6645" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6645" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 182,183</text>
<text text-anchor="middle" x="6645" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_11 -->
<g id="edge564" class="edge">
<title>gate_5&#45;&gt;route_5_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4950.94,-7497.49C5250.44,-7484.27 5797.94,-7458.54 6265,-7428.04 6328.96,-7423.87 6398.92,-7418.54 6461.18,-7413.53"/>
<polygon fill="black" stroke="black" points="6461.82,-7416.99 6471.51,-7412.7 6461.26,-7410.01 6461.82,-7416.99"/>
</g>
<!-- route_5_12 -->
<g id="node392" class="node">
<title>route_5_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7235" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7235" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 184,185</text>
<text text-anchor="middle" x="7235" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_12 -->
<g id="edge570" class="edge">
<title>gate_5&#45;&gt;route_5_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4956.64,-7501.68C5346.94,-7491.85 6164.6,-7468.19 6855,-7428.04 6919.59,-7424.29 6990.27,-7419.01 7052.97,-7413.91"/>
<polygon fill="black" stroke="black" points="7053.28,-7417.4 7062.96,-7413.1 7052.71,-7410.42 7053.28,-7417.4"/>
</g>
<!-- route_5_13 -->
<g id="node396" class="node">
<title>route_5_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7825" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7825" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 186,187</text>
<text text-anchor="middle" x="7825" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_13 -->
<g id="edge576" class="edge">
<title>gate_5&#45;&gt;route_5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4960.3,-7504.19C5430.62,-7497.57 6526.09,-7477.77 7445,-7428.04 7509.92,-7424.53 7580.98,-7419.28 7643.9,-7414.14"/>
<polygon fill="black" stroke="black" points="7644.25,-7417.62 7653.93,-7413.31 7643.68,-7410.65 7644.25,-7417.62"/>
</g>
<!-- route_5_14 -->
<g id="node400" class="node">
<title>route_5_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8415" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8415" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 188,189</text>
<text text-anchor="middle" x="8415" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_14 -->
<g id="edge582" class="edge">
<title>gate_5&#45;&gt;route_5_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4962.56,-7505.88C5504.95,-7502.22 6883.82,-7487.35 8035,-7428.04 8100.09,-7424.69 8171.33,-7419.46 8234.37,-7414.29"/>
<polygon fill="black" stroke="black" points="8234.73,-7417.77 8244.41,-7413.46 8234.16,-7410.8 8234.73,-7417.77"/>
</g>
<!-- route_5_15 -->
<g id="node404" class="node">
<title>route_5_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9005" cy="-7396.93" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-7409.73" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9005" y="-7399.73" font-family="Times,serif" font-size="9.00">GPU: 190,191</text>
<text text-anchor="middle" x="9005" y="-7389.73" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-7379.73" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_5&#45;&gt;route_5_15 -->
<g id="edge588" class="edge">
<title>gate_5&#45;&gt;route_5_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4964.19,-7507.09C5572.71,-7506.15 7238.91,-7496.95 8625,-7428.04 8690.25,-7424.8 8761.68,-7419.58 8824.83,-7414.39"/>
<polygon fill="black" stroke="black" points="8825.21,-7417.87 8834.89,-7413.56 8824.64,-7410.89 8825.21,-7417.87"/>
</g>
<!-- expert_5_0_0 -->
<g id="node345" class="node">
<title>expert_5_0_0</title>
<polygon fill="lightgreen" stroke="black" points="293.5,-7329.82 16.5,-7329.82 16.5,-7285.82 293.5,-7285.82 293.5,-7329.82"/>
<text text-anchor="middle" x="155" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="155" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 160</text>
<text text-anchor="middle" x="155" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="155" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_0&#45;&gt;expert_5_0_0 -->
<g id="edge499" class="edge">
<title>route_5_0&#45;&gt;expert_5_0_0</title>
<path fill="none" stroke="black" d="M359.08,-7369.08C319.92,-7357.52 274.49,-7344.1 236.44,-7332.87"/>
<polygon fill="black" stroke="black" points="237.01,-7329.38 226.43,-7329.91 235.03,-7336.1 237.01,-7329.38"/>
</g>
<!-- expert_5_0_1 -->
<g id="node346" class="node">
<title>expert_5_0_1</title>
<polygon fill="lightgreen" stroke="black" points="588.5,-7329.82 311.5,-7329.82 311.5,-7285.82 588.5,-7285.82 588.5,-7329.82"/>
<text text-anchor="middle" x="450" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="450" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 161</text>
<text text-anchor="middle" x="450" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="450" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_0&#45;&gt;expert_5_0_1 -->
<g id="edge500" class="edge">
<title>route_5_0&#45;&gt;expert_5_0_1</title>
<path fill="none" stroke="black" d="M450,-7365.46C450,-7357.18 450,-7348.21 450,-7339.89"/>
<polygon fill="black" stroke="black" points="453.5,-7339.82 450,-7329.82 446.5,-7339.82 453.5,-7339.82"/>
</g>
<!-- tp_5_0 -->
<g id="node347" class="node">
<title>tp_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="450" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="450" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="450" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 160↔161</text>
<text text-anchor="middle" x="450" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="450" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_0_0&#45;&gt;tp_5_0 -->
<g id="edge501" class="edge">
<title>expert_5_0_0&#45;&gt;tp_5_0</title>
<path fill="none" stroke="black" d="M226.41,-7285.73C267.87,-7273.49 320.36,-7257.98 364.07,-7245.08"/>
<polygon fill="black" stroke="black" points="365.23,-7248.39 373.83,-7242.2 363.25,-7241.67 365.23,-7248.39"/>
</g>
<!-- expert_5_0_1&#45;&gt;tp_5_0 -->
<g id="edge502" class="edge">
<title>expert_5_0_1&#45;&gt;tp_5_0</title>
<path fill="none" stroke="black" d="M450,-7285.73C450,-7278.06 450,-7269.1 450,-7260.31"/>
<polygon fill="black" stroke="black" points="453.5,-7260.15 450,-7250.15 446.5,-7260.15 453.5,-7260.15"/>
</g>
<!-- agg_5 -->
<g id="node408" class="node">
<title>agg_5</title>
<polygon fill="lightyellow" stroke="black" points="5008.99,-7151.59 4560.4,-7151.59 4445.01,-7063.59 4893.6,-7063.59 5008.99,-7151.59"/>
<text text-anchor="middle" x="4727" y="-7120.39" font-family="Times,serif" font-size="9.00">Aggregate Experts L5</text>
<text text-anchor="middle" x="4727" y="-7110.39" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-7100.39" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4727" y="-7090.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_5_0&#45;&gt;agg_5 -->
<g id="edge503" class="edge">
<title>tp_5_0&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M560.79,-7209.15C654.96,-7202.22 793.76,-7192.77 915,-7187.59 2270.83,-7129.67 3899.8,-7113.85 4494.92,-7109.85"/>
<polygon fill="black" stroke="black" points="4495.36,-7113.35 4505.33,-7109.78 4495.31,-7106.35 4495.36,-7113.35"/>
</g>
<!-- expert_5_1_0 -->
<g id="node349" class="node">
<title>expert_5_1_0</title>
<polygon fill="lightgreen" stroke="black" points="883.5,-7329.82 606.5,-7329.82 606.5,-7285.82 883.5,-7285.82 883.5,-7329.82"/>
<text text-anchor="middle" x="745" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="745" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 162</text>
<text text-anchor="middle" x="745" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="745" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_1&#45;&gt;expert_5_1_0 -->
<g id="edge505" class="edge">
<title>route_5_1&#45;&gt;expert_5_1_0</title>
<path fill="none" stroke="black" d="M949.08,-7369.08C909.92,-7357.52 864.49,-7344.1 826.44,-7332.87"/>
<polygon fill="black" stroke="black" points="827.01,-7329.38 816.43,-7329.91 825.03,-7336.1 827.01,-7329.38"/>
</g>
<!-- expert_5_1_1 -->
<g id="node350" class="node">
<title>expert_5_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1178.5,-7329.82 901.5,-7329.82 901.5,-7285.82 1178.5,-7285.82 1178.5,-7329.82"/>
<text text-anchor="middle" x="1040" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1040" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 163</text>
<text text-anchor="middle" x="1040" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1040" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_1&#45;&gt;expert_5_1_1 -->
<g id="edge506" class="edge">
<title>route_5_1&#45;&gt;expert_5_1_1</title>
<path fill="none" stroke="black" d="M1040,-7365.46C1040,-7357.18 1040,-7348.21 1040,-7339.89"/>
<polygon fill="black" stroke="black" points="1043.5,-7339.82 1040,-7329.82 1036.5,-7339.82 1043.5,-7339.82"/>
</g>
<!-- tp_5_1 -->
<g id="node351" class="node">
<title>tp_5_1</title>
<ellipse fill="lightblue" stroke="black" cx="1040" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1040" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1040" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 162↔163</text>
<text text-anchor="middle" x="1040" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1040" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_1_0&#45;&gt;tp_5_1 -->
<g id="edge507" class="edge">
<title>expert_5_1_0&#45;&gt;tp_5_1</title>
<path fill="none" stroke="black" d="M816.41,-7285.73C857.87,-7273.49 910.36,-7257.98 954.07,-7245.08"/>
<polygon fill="black" stroke="black" points="955.23,-7248.39 963.83,-7242.2 953.25,-7241.67 955.23,-7248.39"/>
</g>
<!-- expert_5_1_1&#45;&gt;tp_5_1 -->
<g id="edge508" class="edge">
<title>expert_5_1_1&#45;&gt;tp_5_1</title>
<path fill="none" stroke="black" d="M1040,-7285.73C1040,-7278.06 1040,-7269.1 1040,-7260.31"/>
<polygon fill="black" stroke="black" points="1043.5,-7260.15 1040,-7250.15 1036.5,-7260.15 1043.5,-7260.15"/>
</g>
<!-- tp_5_1&#45;&gt;agg_5 -->
<g id="edge509" class="edge">
<title>tp_5_1&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1150.8,-7209.27C1244.96,-7202.41 1383.77,-7193 1505,-7187.59 2625.94,-7137.57 3967.78,-7117.44 4496.63,-7111.07"/>
<polygon fill="black" stroke="black" points="4496.71,-7114.57 4506.67,-7110.95 4496.63,-7107.57 4496.71,-7114.57"/>
</g>
<!-- expert_5_2_0 -->
<g id="node353" class="node">
<title>expert_5_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-7329.82 1196.5,-7329.82 1196.5,-7285.82 1473.5,-7285.82 1473.5,-7329.82"/>
<text text-anchor="middle" x="1335" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1335" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 164</text>
<text text-anchor="middle" x="1335" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1335" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_2&#45;&gt;expert_5_2_0 -->
<g id="edge511" class="edge">
<title>route_5_2&#45;&gt;expert_5_2_0</title>
<path fill="none" stroke="black" d="M1539.08,-7369.08C1499.92,-7357.52 1454.49,-7344.1 1416.44,-7332.87"/>
<polygon fill="black" stroke="black" points="1417.01,-7329.38 1406.43,-7329.91 1415.03,-7336.1 1417.01,-7329.38"/>
</g>
<!-- expert_5_2_1 -->
<g id="node354" class="node">
<title>expert_5_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1768.5,-7329.82 1491.5,-7329.82 1491.5,-7285.82 1768.5,-7285.82 1768.5,-7329.82"/>
<text text-anchor="middle" x="1630" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1630" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 165</text>
<text text-anchor="middle" x="1630" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1630" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_2&#45;&gt;expert_5_2_1 -->
<g id="edge512" class="edge">
<title>route_5_2&#45;&gt;expert_5_2_1</title>
<path fill="none" stroke="black" d="M1630,-7365.46C1630,-7357.18 1630,-7348.21 1630,-7339.89"/>
<polygon fill="black" stroke="black" points="1633.5,-7339.82 1630,-7329.82 1626.5,-7339.82 1633.5,-7339.82"/>
</g>
<!-- tp_5_2 -->
<g id="node355" class="node">
<title>tp_5_2</title>
<ellipse fill="lightblue" stroke="black" cx="1630" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1630" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1630" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 164↔165</text>
<text text-anchor="middle" x="1630" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1630" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_2_0&#45;&gt;tp_5_2 -->
<g id="edge513" class="edge">
<title>expert_5_2_0&#45;&gt;tp_5_2</title>
<path fill="none" stroke="black" d="M1406.41,-7285.73C1447.87,-7273.49 1500.36,-7257.98 1544.07,-7245.08"/>
<polygon fill="black" stroke="black" points="1545.23,-7248.39 1553.83,-7242.2 1543.25,-7241.67 1545.23,-7248.39"/>
</g>
<!-- expert_5_2_1&#45;&gt;tp_5_2 -->
<g id="edge514" class="edge">
<title>expert_5_2_1&#45;&gt;tp_5_2</title>
<path fill="none" stroke="black" d="M1630,-7285.73C1630,-7278.06 1630,-7269.1 1630,-7260.31"/>
<polygon fill="black" stroke="black" points="1633.5,-7260.15 1630,-7250.15 1626.5,-7260.15 1633.5,-7260.15"/>
</g>
<!-- tp_5_2&#45;&gt;agg_5 -->
<g id="edge515" class="edge">
<title>tp_5_2&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M1740.8,-7209.44C1834.98,-7202.68 1973.79,-7193.33 2095,-7187.59 2983.74,-7145.49 4042.42,-7121.74 4498.95,-7112.78"/>
<polygon fill="black" stroke="black" points="4499.03,-7116.28 4508.96,-7112.58 4498.89,-7109.28 4499.03,-7116.28"/>
</g>
<!-- expert_5_3_0 -->
<g id="node357" class="node">
<title>expert_5_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2063.5,-7329.82 1786.5,-7329.82 1786.5,-7285.82 2063.5,-7285.82 2063.5,-7329.82"/>
<text text-anchor="middle" x="1925" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1925" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 166</text>
<text text-anchor="middle" x="1925" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1925" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_3&#45;&gt;expert_5_3_0 -->
<g id="edge517" class="edge">
<title>route_5_3&#45;&gt;expert_5_3_0</title>
<path fill="none" stroke="black" d="M2129.08,-7369.08C2089.92,-7357.52 2044.49,-7344.1 2006.44,-7332.87"/>
<polygon fill="black" stroke="black" points="2007.01,-7329.38 1996.43,-7329.91 2005.03,-7336.1 2007.01,-7329.38"/>
</g>
<!-- expert_5_3_1 -->
<g id="node358" class="node">
<title>expert_5_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2358.5,-7329.82 2081.5,-7329.82 2081.5,-7285.82 2358.5,-7285.82 2358.5,-7329.82"/>
<text text-anchor="middle" x="2220" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2220" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 167</text>
<text text-anchor="middle" x="2220" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2220" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_3&#45;&gt;expert_5_3_1 -->
<g id="edge518" class="edge">
<title>route_5_3&#45;&gt;expert_5_3_1</title>
<path fill="none" stroke="black" d="M2220,-7365.46C2220,-7357.18 2220,-7348.21 2220,-7339.89"/>
<polygon fill="black" stroke="black" points="2223.5,-7339.82 2220,-7329.82 2216.5,-7339.82 2223.5,-7339.82"/>
</g>
<!-- tp_5_3 -->
<g id="node359" class="node">
<title>tp_5_3</title>
<ellipse fill="lightblue" stroke="black" cx="2220" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2220" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2220" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 166↔167</text>
<text text-anchor="middle" x="2220" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2220" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_3_0&#45;&gt;tp_5_3 -->
<g id="edge519" class="edge">
<title>expert_5_3_0&#45;&gt;tp_5_3</title>
<path fill="none" stroke="black" d="M1996.41,-7285.73C2037.87,-7273.49 2090.36,-7257.98 2134.07,-7245.08"/>
<polygon fill="black" stroke="black" points="2135.23,-7248.39 2143.83,-7242.2 2133.25,-7241.67 2135.23,-7248.39"/>
</g>
<!-- expert_5_3_1&#45;&gt;tp_5_3 -->
<g id="edge520" class="edge">
<title>expert_5_3_1&#45;&gt;tp_5_3</title>
<path fill="none" stroke="black" d="M2220,-7285.73C2220,-7278.06 2220,-7269.1 2220,-7260.31"/>
<polygon fill="black" stroke="black" points="2223.5,-7260.15 2220,-7250.15 2216.5,-7260.15 2223.5,-7260.15"/>
</g>
<!-- tp_5_3&#45;&gt;agg_5 -->
<g id="edge521" class="edge">
<title>tp_5_3&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2331.29,-7209.68C2425.46,-7203.09 2564.02,-7193.85 2685,-7187.59 3345.08,-7153.46 4125.88,-7127.16 4502.12,-7115.38"/>
<polygon fill="black" stroke="black" points="4502.42,-7118.87 4512.3,-7115.06 4502.2,-7111.88 4502.42,-7118.87"/>
</g>
<!-- expert_5_4_0 -->
<g id="node361" class="node">
<title>expert_5_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2653.5,-7329.82 2376.5,-7329.82 2376.5,-7285.82 2653.5,-7285.82 2653.5,-7329.82"/>
<text text-anchor="middle" x="2515" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2515" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 168</text>
<text text-anchor="middle" x="2515" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2515" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_4&#45;&gt;expert_5_4_0 -->
<g id="edge523" class="edge">
<title>route_5_4&#45;&gt;expert_5_4_0</title>
<path fill="none" stroke="black" d="M2719.08,-7369.08C2679.92,-7357.52 2634.49,-7344.1 2596.44,-7332.87"/>
<polygon fill="black" stroke="black" points="2597.01,-7329.38 2586.43,-7329.91 2595.03,-7336.1 2597.01,-7329.38"/>
</g>
<!-- expert_5_4_1 -->
<g id="node362" class="node">
<title>expert_5_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2948.5,-7329.82 2671.5,-7329.82 2671.5,-7285.82 2948.5,-7285.82 2948.5,-7329.82"/>
<text text-anchor="middle" x="2810" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2810" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 169</text>
<text text-anchor="middle" x="2810" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2810" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_4&#45;&gt;expert_5_4_1 -->
<g id="edge524" class="edge">
<title>route_5_4&#45;&gt;expert_5_4_1</title>
<path fill="none" stroke="black" d="M2810,-7365.46C2810,-7357.18 2810,-7348.21 2810,-7339.89"/>
<polygon fill="black" stroke="black" points="2813.5,-7339.82 2810,-7329.82 2806.5,-7339.82 2813.5,-7339.82"/>
</g>
<!-- tp_5_4 -->
<g id="node363" class="node">
<title>tp_5_4</title>
<ellipse fill="lightblue" stroke="black" cx="2810" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2810" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2810" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 168↔169</text>
<text text-anchor="middle" x="2810" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2810" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_4_0&#45;&gt;tp_5_4 -->
<g id="edge525" class="edge">
<title>expert_5_4_0&#45;&gt;tp_5_4</title>
<path fill="none" stroke="black" d="M2586.41,-7285.73C2627.87,-7273.49 2680.36,-7257.98 2724.07,-7245.08"/>
<polygon fill="black" stroke="black" points="2725.23,-7248.39 2733.83,-7242.2 2723.25,-7241.67 2725.23,-7248.39"/>
</g>
<!-- expert_5_4_1&#45;&gt;tp_5_4 -->
<g id="edge526" class="edge">
<title>expert_5_4_1&#45;&gt;tp_5_4</title>
<path fill="none" stroke="black" d="M2810,-7285.73C2810,-7278.06 2810,-7269.1 2810,-7260.31"/>
<polygon fill="black" stroke="black" points="2813.5,-7260.15 2810,-7250.15 2806.5,-7260.15 2813.5,-7260.15"/>
</g>
<!-- tp_5_4&#45;&gt;agg_5 -->
<g id="edge527" class="edge">
<title>tp_5_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M2921.79,-7210.14C3015.97,-7203.85 3154.27,-7194.78 3275,-7187.59 3712.09,-7161.55 4223.42,-7134.53 4507.75,-7119.81"/>
<polygon fill="black" stroke="black" points="4507.96,-7123.31 4517.77,-7119.3 4507.6,-7116.32 4507.96,-7123.31"/>
</g>
<!-- expert_5_5_0 -->
<g id="node365" class="node">
<title>expert_5_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3243.5,-7329.82 2966.5,-7329.82 2966.5,-7285.82 3243.5,-7285.82 3243.5,-7329.82"/>
<text text-anchor="middle" x="3105" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3105" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 170</text>
<text text-anchor="middle" x="3105" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3105" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_5&#45;&gt;expert_5_5_0 -->
<g id="edge529" class="edge">
<title>route_5_5&#45;&gt;expert_5_5_0</title>
<path fill="none" stroke="black" d="M3309.08,-7369.08C3269.92,-7357.52 3224.49,-7344.1 3186.44,-7332.87"/>
<polygon fill="black" stroke="black" points="3187.01,-7329.38 3176.43,-7329.91 3185.03,-7336.1 3187.01,-7329.38"/>
</g>
<!-- expert_5_5_1 -->
<g id="node366" class="node">
<title>expert_5_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3538.5,-7329.82 3261.5,-7329.82 3261.5,-7285.82 3538.5,-7285.82 3538.5,-7329.82"/>
<text text-anchor="middle" x="3400" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3400" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 171</text>
<text text-anchor="middle" x="3400" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3400" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_5&#45;&gt;expert_5_5_1 -->
<g id="edge530" class="edge">
<title>route_5_5&#45;&gt;expert_5_5_1</title>
<path fill="none" stroke="black" d="M3400,-7365.46C3400,-7357.18 3400,-7348.21 3400,-7339.89"/>
<polygon fill="black" stroke="black" points="3403.5,-7339.82 3400,-7329.82 3396.5,-7339.82 3403.5,-7339.82"/>
</g>
<!-- tp_5_5 -->
<g id="node367" class="node">
<title>tp_5_5</title>
<ellipse fill="lightblue" stroke="black" cx="3400" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3400" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3400" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 170↔171</text>
<text text-anchor="middle" x="3400" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3400" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_5_0&#45;&gt;tp_5_5 -->
<g id="edge531" class="edge">
<title>expert_5_5_0&#45;&gt;tp_5_5</title>
<path fill="none" stroke="black" d="M3176.41,-7285.73C3217.87,-7273.49 3270.36,-7257.98 3314.07,-7245.08"/>
<polygon fill="black" stroke="black" points="3315.23,-7248.39 3323.83,-7242.2 3313.25,-7241.67 3315.23,-7248.39"/>
</g>
<!-- expert_5_5_1&#45;&gt;tp_5_5 -->
<g id="edge532" class="edge">
<title>expert_5_5_1&#45;&gt;tp_5_5</title>
<path fill="none" stroke="black" d="M3400,-7285.73C3400,-7278.06 3400,-7269.1 3400,-7260.31"/>
<polygon fill="black" stroke="black" points="3403.5,-7260.15 3400,-7250.15 3396.5,-7260.15 3403.5,-7260.15"/>
</g>
<!-- tp_5_5&#45;&gt;agg_5 -->
<g id="edge533" class="edge">
<title>tp_5_5&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M3510.01,-7208.66C3730.49,-7190.53 4229.79,-7149.47 4515.61,-7125.97"/>
<polygon fill="black" stroke="black" points="4516.01,-7129.45 4525.69,-7125.14 4515.44,-7122.48 4516.01,-7129.45"/>
</g>
<!-- expert_5_6_0 -->
<g id="node369" class="node">
<title>expert_5_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3833.5,-7329.82 3556.5,-7329.82 3556.5,-7285.82 3833.5,-7285.82 3833.5,-7329.82"/>
<text text-anchor="middle" x="3695" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3695" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 172</text>
<text text-anchor="middle" x="3695" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3695" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_6&#45;&gt;expert_5_6_0 -->
<g id="edge535" class="edge">
<title>route_5_6&#45;&gt;expert_5_6_0</title>
<path fill="none" stroke="black" d="M3899.08,-7369.08C3859.92,-7357.52 3814.49,-7344.1 3776.44,-7332.87"/>
<polygon fill="black" stroke="black" points="3777.01,-7329.38 3766.43,-7329.91 3775.03,-7336.1 3777.01,-7329.38"/>
</g>
<!-- expert_5_6_1 -->
<g id="node370" class="node">
<title>expert_5_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4128.5,-7329.82 3851.5,-7329.82 3851.5,-7285.82 4128.5,-7285.82 4128.5,-7329.82"/>
<text text-anchor="middle" x="3990" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="3990" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 173</text>
<text text-anchor="middle" x="3990" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3990" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_6&#45;&gt;expert_5_6_1 -->
<g id="edge536" class="edge">
<title>route_5_6&#45;&gt;expert_5_6_1</title>
<path fill="none" stroke="black" d="M3990,-7365.46C3990,-7357.18 3990,-7348.21 3990,-7339.89"/>
<polygon fill="black" stroke="black" points="3993.5,-7339.82 3990,-7329.82 3986.5,-7339.82 3993.5,-7339.82"/>
</g>
<!-- tp_5_6 -->
<g id="node371" class="node">
<title>tp_5_6</title>
<ellipse fill="lightblue" stroke="black" cx="3990" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3990" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3990" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 172↔173</text>
<text text-anchor="middle" x="3990" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3990" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_6_0&#45;&gt;tp_5_6 -->
<g id="edge537" class="edge">
<title>expert_5_6_0&#45;&gt;tp_5_6</title>
<path fill="none" stroke="black" d="M3766.41,-7285.73C3807.87,-7273.49 3860.36,-7257.98 3904.07,-7245.08"/>
<polygon fill="black" stroke="black" points="3905.23,-7248.39 3913.83,-7242.2 3903.25,-7241.67 3905.23,-7248.39"/>
</g>
<!-- expert_5_6_1&#45;&gt;tp_5_6 -->
<g id="edge538" class="edge">
<title>expert_5_6_1&#45;&gt;tp_5_6</title>
<path fill="none" stroke="black" d="M3990,-7285.73C3990,-7278.06 3990,-7269.1 3990,-7260.31"/>
<polygon fill="black" stroke="black" points="3993.5,-7260.15 3990,-7250.15 3986.5,-7260.15 3993.5,-7260.15"/>
</g>
<!-- tp_5_6&#45;&gt;agg_5 -->
<g id="edge539" class="edge">
<title>tp_5_6&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M4090.16,-7202.87C4202.68,-7186.22 4388.1,-7158.77 4529.93,-7137.77"/>
<polygon fill="black" stroke="black" points="4530.68,-7141.19 4540.06,-7136.27 4529.66,-7134.27 4530.68,-7141.19"/>
</g>
<!-- expert_5_7_0 -->
<g id="node373" class="node">
<title>expert_5_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4423.5,-7329.82 4146.5,-7329.82 4146.5,-7285.82 4423.5,-7285.82 4423.5,-7329.82"/>
<text text-anchor="middle" x="4285" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4285" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 174</text>
<text text-anchor="middle" x="4285" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4285" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_7&#45;&gt;expert_5_7_0 -->
<g id="edge541" class="edge">
<title>route_5_7&#45;&gt;expert_5_7_0</title>
<path fill="none" stroke="black" d="M4443.32,-7368.01C4413.66,-7356.92 4379.83,-7344.27 4351.08,-7333.52"/>
<polygon fill="black" stroke="black" points="4352.13,-7330.18 4341.54,-7329.95 4349.68,-7336.73 4352.13,-7330.18"/>
</g>
<!-- expert_5_7_1 -->
<g id="node374" class="node">
<title>expert_5_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4718.5,-7329.82 4441.5,-7329.82 4441.5,-7285.82 4718.5,-7285.82 4718.5,-7329.82"/>
<text text-anchor="middle" x="4580" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4580" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 175</text>
<text text-anchor="middle" x="4580" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_7&#45;&gt;expert_5_7_1 -->
<g id="edge542" class="edge">
<title>route_5_7&#45;&gt;expert_5_7_1</title>
<path fill="none" stroke="black" d="M4539.34,-7365.95C4545.71,-7357 4552.68,-7347.2 4559.03,-7338.28"/>
<polygon fill="black" stroke="black" points="4561.94,-7340.23 4564.88,-7330.06 4556.23,-7336.17 4561.94,-7340.23"/>
</g>
<!-- tp_5_7 -->
<g id="node375" class="node">
<title>tp_5_7</title>
<ellipse fill="lightblue" stroke="black" cx="4580" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4580" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4580" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 174↔175</text>
<text text-anchor="middle" x="4580" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4580" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_7_0&#45;&gt;tp_5_7 -->
<g id="edge543" class="edge">
<title>expert_5_7_0&#45;&gt;tp_5_7</title>
<path fill="none" stroke="black" d="M4356.41,-7285.73C4397.87,-7273.49 4450.36,-7257.98 4494.07,-7245.08"/>
<polygon fill="black" stroke="black" points="4495.23,-7248.39 4503.83,-7242.2 4493.25,-7241.67 4495.23,-7248.39"/>
</g>
<!-- expert_5_7_1&#45;&gt;tp_5_7 -->
<g id="edge544" class="edge">
<title>expert_5_7_1&#45;&gt;tp_5_7</title>
<path fill="none" stroke="black" d="M4580,-7285.73C4580,-7278.06 4580,-7269.1 4580,-7260.31"/>
<polygon fill="black" stroke="black" points="4583.5,-7260.15 4580,-7250.15 4576.5,-7260.15 4583.5,-7260.15"/>
</g>
<!-- tp_5_7&#45;&gt;agg_5 -->
<g id="edge545" class="edge">
<title>tp_5_7&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M4618.24,-7189.32C4631.3,-7179.62 4646.31,-7168.48 4660.93,-7157.63"/>
<polygon fill="black" stroke="black" points="4663.05,-7160.42 4668.99,-7151.65 4658.88,-7154.8 4663.05,-7160.42"/>
</g>
<!-- expert_5_8_0 -->
<g id="node377" class="node">
<title>expert_5_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5013.5,-7329.82 4736.5,-7329.82 4736.5,-7285.82 5013.5,-7285.82 5013.5,-7329.82"/>
<text text-anchor="middle" x="4875" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4875" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 176</text>
<text text-anchor="middle" x="4875" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4875" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_8&#45;&gt;expert_5_8_0 -->
<g id="edge547" class="edge">
<title>route_5_8&#45;&gt;expert_5_8_0</title>
<path fill="none" stroke="black" d="M4916.32,-7365.95C4909.85,-7357 4902.76,-7347.2 4896.31,-7338.28"/>
<polygon fill="black" stroke="black" points="4899.06,-7336.11 4890.36,-7330.06 4893.39,-7340.21 4899.06,-7336.11"/>
</g>
<!-- expert_5_8_1 -->
<g id="node378" class="node">
<title>expert_5_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5308.5,-7329.82 5031.5,-7329.82 5031.5,-7285.82 5308.5,-7285.82 5308.5,-7329.82"/>
<text text-anchor="middle" x="5170" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5170" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 177</text>
<text text-anchor="middle" x="5170" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5170" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_8&#45;&gt;expert_5_8_1 -->
<g id="edge548" class="edge">
<title>route_5_8&#45;&gt;expert_5_8_1</title>
<path fill="none" stroke="black" d="M5012.36,-7368.01C5041.89,-7356.92 5075.58,-7344.27 5104.2,-7333.52"/>
<polygon fill="black" stroke="black" points="5105.57,-7336.75 5113.71,-7329.95 5103.11,-7330.19 5105.57,-7336.75"/>
</g>
<!-- tp_5_8 -->
<g id="node379" class="node">
<title>tp_5_8</title>
<ellipse fill="lightblue" stroke="black" cx="4875" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4875" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4875" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 176↔177</text>
<text text-anchor="middle" x="4875" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4875" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_8_0&#45;&gt;tp_5_8 -->
<g id="edge549" class="edge">
<title>expert_5_8_0&#45;&gt;tp_5_8</title>
<path fill="none" stroke="black" d="M4875,-7285.73C4875,-7278.06 4875,-7269.1 4875,-7260.31"/>
<polygon fill="black" stroke="black" points="4878.5,-7260.15 4875,-7250.15 4871.5,-7260.15 4878.5,-7260.15"/>
</g>
<!-- expert_5_8_1&#45;&gt;tp_5_8 -->
<g id="edge550" class="edge">
<title>expert_5_8_1&#45;&gt;tp_5_8</title>
<path fill="none" stroke="black" d="M5098.59,-7285.73C5057.13,-7273.49 5004.64,-7257.98 4960.93,-7245.08"/>
<polygon fill="black" stroke="black" points="4961.75,-7241.67 4951.17,-7242.2 4959.77,-7248.39 4961.75,-7241.67"/>
</g>
<!-- tp_5_8&#45;&gt;agg_5 -->
<g id="edge551" class="edge">
<title>tp_5_8&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M4836.5,-7189.32C4823.35,-7179.62 4808.24,-7168.48 4793.52,-7157.63"/>
<polygon fill="black" stroke="black" points="4795.53,-7154.77 4785.4,-7151.65 4791.37,-7160.4 4795.53,-7154.77"/>
</g>
<!-- expert_5_9_0 -->
<g id="node381" class="node">
<title>expert_5_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5603.5,-7329.82 5326.5,-7329.82 5326.5,-7285.82 5603.5,-7285.82 5603.5,-7329.82"/>
<text text-anchor="middle" x="5465" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5465" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 178</text>
<text text-anchor="middle" x="5465" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5465" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_9&#45;&gt;expert_5_9_0 -->
<g id="edge553" class="edge">
<title>route_5_9&#45;&gt;expert_5_9_0</title>
<path fill="none" stroke="black" d="M5465,-7365.46C5465,-7357.18 5465,-7348.21 5465,-7339.89"/>
<polygon fill="black" stroke="black" points="5468.5,-7339.82 5465,-7329.82 5461.5,-7339.82 5468.5,-7339.82"/>
</g>
<!-- expert_5_9_1 -->
<g id="node382" class="node">
<title>expert_5_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5898.5,-7329.82 5621.5,-7329.82 5621.5,-7285.82 5898.5,-7285.82 5898.5,-7329.82"/>
<text text-anchor="middle" x="5760" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5760" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 179</text>
<text text-anchor="middle" x="5760" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5760" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_9&#45;&gt;expert_5_9_1 -->
<g id="edge554" class="edge">
<title>route_5_9&#45;&gt;expert_5_9_1</title>
<path fill="none" stroke="black" d="M5555.92,-7369.08C5595.08,-7357.52 5640.51,-7344.1 5678.56,-7332.87"/>
<polygon fill="black" stroke="black" points="5679.97,-7336.1 5688.57,-7329.91 5677.99,-7329.38 5679.97,-7336.1"/>
</g>
<!-- tp_5_9 -->
<g id="node383" class="node">
<title>tp_5_9</title>
<ellipse fill="lightblue" stroke="black" cx="5465" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5465" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5465" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 178↔179</text>
<text text-anchor="middle" x="5465" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5465" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_9_0&#45;&gt;tp_5_9 -->
<g id="edge555" class="edge">
<title>expert_5_9_0&#45;&gt;tp_5_9</title>
<path fill="none" stroke="black" d="M5465,-7285.73C5465,-7278.06 5465,-7269.1 5465,-7260.31"/>
<polygon fill="black" stroke="black" points="5468.5,-7260.15 5465,-7250.15 5461.5,-7260.15 5468.5,-7260.15"/>
</g>
<!-- expert_5_9_1&#45;&gt;tp_5_9 -->
<g id="edge556" class="edge">
<title>expert_5_9_1&#45;&gt;tp_5_9</title>
<path fill="none" stroke="black" d="M5688.59,-7285.73C5647.13,-7273.49 5594.64,-7257.98 5550.93,-7245.08"/>
<polygon fill="black" stroke="black" points="5551.75,-7241.67 5541.17,-7242.2 5549.77,-7248.39 5551.75,-7241.67"/>
</g>
<!-- tp_5_9&#45;&gt;agg_5 -->
<g id="edge557" class="edge">
<title>tp_5_9&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M5364.7,-7202.87C5275.3,-7189.66 5139.93,-7169.64 5016.87,-7151.45"/>
<polygon fill="black" stroke="black" points="5017.31,-7147.98 5006.9,-7149.97 5016.28,-7154.9 5017.31,-7147.98"/>
</g>
<!-- expert_5_10_0 -->
<g id="node385" class="node">
<title>expert_5_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6193.5,-7329.82 5916.5,-7329.82 5916.5,-7285.82 6193.5,-7285.82 6193.5,-7329.82"/>
<text text-anchor="middle" x="6055" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6055" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 180</text>
<text text-anchor="middle" x="6055" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6055" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_10&#45;&gt;expert_5_10_0 -->
<g id="edge559" class="edge">
<title>route_5_10&#45;&gt;expert_5_10_0</title>
<path fill="none" stroke="black" d="M6055,-7365.46C6055,-7357.18 6055,-7348.21 6055,-7339.89"/>
<polygon fill="black" stroke="black" points="6058.5,-7339.82 6055,-7329.82 6051.5,-7339.82 6058.5,-7339.82"/>
</g>
<!-- expert_5_10_1 -->
<g id="node386" class="node">
<title>expert_5_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-7329.82 6211.5,-7329.82 6211.5,-7285.82 6488.5,-7285.82 6488.5,-7329.82"/>
<text text-anchor="middle" x="6350" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6350" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 181</text>
<text text-anchor="middle" x="6350" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6350" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_10&#45;&gt;expert_5_10_1 -->
<g id="edge560" class="edge">
<title>route_5_10&#45;&gt;expert_5_10_1</title>
<path fill="none" stroke="black" d="M6145.92,-7369.08C6185.08,-7357.52 6230.51,-7344.1 6268.56,-7332.87"/>
<polygon fill="black" stroke="black" points="6269.97,-7336.1 6278.57,-7329.91 6267.99,-7329.38 6269.97,-7336.1"/>
</g>
<!-- tp_5_10 -->
<g id="node387" class="node">
<title>tp_5_10</title>
<ellipse fill="lightblue" stroke="black" cx="6055" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6055" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6055" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 180↔181</text>
<text text-anchor="middle" x="6055" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6055" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_10_0&#45;&gt;tp_5_10 -->
<g id="edge561" class="edge">
<title>expert_5_10_0&#45;&gt;tp_5_10</title>
<path fill="none" stroke="black" d="M6055,-7285.73C6055,-7278.06 6055,-7269.1 6055,-7260.31"/>
<polygon fill="black" stroke="black" points="6058.5,-7260.15 6055,-7250.15 6051.5,-7260.15 6058.5,-7260.15"/>
</g>
<!-- expert_5_10_1&#45;&gt;tp_5_10 -->
<g id="edge562" class="edge">
<title>expert_5_10_1&#45;&gt;tp_5_10</title>
<path fill="none" stroke="black" d="M6278.59,-7285.73C6237.13,-7273.49 6184.64,-7257.98 6140.93,-7245.08"/>
<polygon fill="black" stroke="black" points="6141.75,-7241.67 6131.17,-7242.2 6139.77,-7248.39 6141.75,-7241.67"/>
</g>
<!-- tp_5_10&#45;&gt;agg_5 -->
<g id="edge563" class="edge">
<title>tp_5_10&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M5945.19,-7208.68C5737.46,-7191.61 5281.69,-7154.17 4990.33,-7130.23"/>
<polygon fill="black" stroke="black" points="4990.29,-7126.71 4980.03,-7129.38 4989.71,-7133.69 4990.29,-7126.71"/>
</g>
<!-- expert_5_11_0 -->
<g id="node389" class="node">
<title>expert_5_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6783.5,-7329.82 6506.5,-7329.82 6506.5,-7285.82 6783.5,-7285.82 6783.5,-7329.82"/>
<text text-anchor="middle" x="6645" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6645" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 182</text>
<text text-anchor="middle" x="6645" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6645" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_11&#45;&gt;expert_5_11_0 -->
<g id="edge565" class="edge">
<title>route_5_11&#45;&gt;expert_5_11_0</title>
<path fill="none" stroke="black" d="M6645,-7365.46C6645,-7357.18 6645,-7348.21 6645,-7339.89"/>
<polygon fill="black" stroke="black" points="6648.5,-7339.82 6645,-7329.82 6641.5,-7339.82 6648.5,-7339.82"/>
</g>
<!-- expert_5_11_1 -->
<g id="node390" class="node">
<title>expert_5_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7078.5,-7329.82 6801.5,-7329.82 6801.5,-7285.82 7078.5,-7285.82 7078.5,-7329.82"/>
<text text-anchor="middle" x="6940" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="6940" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 183</text>
<text text-anchor="middle" x="6940" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6940" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_11&#45;&gt;expert_5_11_1 -->
<g id="edge566" class="edge">
<title>route_5_11&#45;&gt;expert_5_11_1</title>
<path fill="none" stroke="black" d="M6735.92,-7369.08C6775.08,-7357.52 6820.51,-7344.1 6858.56,-7332.87"/>
<polygon fill="black" stroke="black" points="6859.97,-7336.1 6868.57,-7329.91 6857.99,-7329.38 6859.97,-7336.1"/>
</g>
<!-- tp_5_11 -->
<g id="node391" class="node">
<title>tp_5_11</title>
<ellipse fill="lightblue" stroke="black" cx="6645" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6645" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6645" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 182↔183</text>
<text text-anchor="middle" x="6645" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6645" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_11_0&#45;&gt;tp_5_11 -->
<g id="edge567" class="edge">
<title>expert_5_11_0&#45;&gt;tp_5_11</title>
<path fill="none" stroke="black" d="M6645,-7285.73C6645,-7278.06 6645,-7269.1 6645,-7260.31"/>
<polygon fill="black" stroke="black" points="6648.5,-7260.15 6645,-7250.15 6641.5,-7260.15 6648.5,-7260.15"/>
</g>
<!-- expert_5_11_1&#45;&gt;tp_5_11 -->
<g id="edge568" class="edge">
<title>expert_5_11_1&#45;&gt;tp_5_11</title>
<path fill="none" stroke="black" d="M6868.59,-7285.73C6827.13,-7273.49 6774.64,-7257.98 6730.93,-7245.08"/>
<polygon fill="black" stroke="black" points="6731.75,-7241.67 6721.17,-7242.2 6729.77,-7248.39 6731.75,-7241.67"/>
</g>
<!-- tp_5_11&#45;&gt;agg_5 -->
<g id="edge569" class="edge">
<title>tp_5_11&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M6533.21,-7210.14C6439.03,-7203.84 6300.73,-7194.78 6180,-7187.59 5758.96,-7162.51 5269.09,-7136.54 4979.26,-7121.51"/>
<polygon fill="black" stroke="black" points="4979.2,-7118.01 4969.03,-7120.98 4978.84,-7125 4979.2,-7118.01"/>
</g>
<!-- expert_5_12_0 -->
<g id="node393" class="node">
<title>expert_5_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7373.5,-7329.82 7096.5,-7329.82 7096.5,-7285.82 7373.5,-7285.82 7373.5,-7329.82"/>
<text text-anchor="middle" x="7235" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7235" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 184</text>
<text text-anchor="middle" x="7235" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7235" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_12&#45;&gt;expert_5_12_0 -->
<g id="edge571" class="edge">
<title>route_5_12&#45;&gt;expert_5_12_0</title>
<path fill="none" stroke="black" d="M7235,-7365.46C7235,-7357.18 7235,-7348.21 7235,-7339.89"/>
<polygon fill="black" stroke="black" points="7238.5,-7339.82 7235,-7329.82 7231.5,-7339.82 7238.5,-7339.82"/>
</g>
<!-- expert_5_12_1 -->
<g id="node394" class="node">
<title>expert_5_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7668.5,-7329.82 7391.5,-7329.82 7391.5,-7285.82 7668.5,-7285.82 7668.5,-7329.82"/>
<text text-anchor="middle" x="7530" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7530" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 185</text>
<text text-anchor="middle" x="7530" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7530" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_12&#45;&gt;expert_5_12_1 -->
<g id="edge572" class="edge">
<title>route_5_12&#45;&gt;expert_5_12_1</title>
<path fill="none" stroke="black" d="M7325.92,-7369.08C7365.08,-7357.52 7410.51,-7344.1 7448.56,-7332.87"/>
<polygon fill="black" stroke="black" points="7449.97,-7336.1 7458.57,-7329.91 7447.99,-7329.38 7449.97,-7336.1"/>
</g>
<!-- tp_5_12 -->
<g id="node395" class="node">
<title>tp_5_12</title>
<ellipse fill="lightblue" stroke="black" cx="7235" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7235" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7235" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 184↔185</text>
<text text-anchor="middle" x="7235" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7235" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_12_0&#45;&gt;tp_5_12 -->
<g id="edge573" class="edge">
<title>expert_5_12_0&#45;&gt;tp_5_12</title>
<path fill="none" stroke="black" d="M7235,-7285.73C7235,-7278.06 7235,-7269.1 7235,-7260.31"/>
<polygon fill="black" stroke="black" points="7238.5,-7260.15 7235,-7250.15 7231.5,-7260.15 7238.5,-7260.15"/>
</g>
<!-- expert_5_12_1&#45;&gt;tp_5_12 -->
<g id="edge574" class="edge">
<title>expert_5_12_1&#45;&gt;tp_5_12</title>
<path fill="none" stroke="black" d="M7458.59,-7285.73C7417.13,-7273.49 7364.64,-7257.98 7320.93,-7245.08"/>
<polygon fill="black" stroke="black" points="7321.75,-7241.67 7311.17,-7242.2 7319.77,-7248.39 7321.75,-7241.67"/>
</g>
<!-- tp_5_12&#45;&gt;agg_5 -->
<g id="edge575" class="edge">
<title>tp_5_12&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M7123.71,-7209.68C7029.54,-7203.09 6890.98,-7193.85 6770,-7187.59 6121.3,-7154.05 5356.04,-7128.09 4972.37,-7116.02"/>
<polygon fill="black" stroke="black" points="4972.36,-7112.51 4962.26,-7115.7 4972.14,-7119.51 4972.36,-7112.51"/>
</g>
<!-- expert_5_13_0 -->
<g id="node397" class="node">
<title>expert_5_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7963.5,-7329.82 7686.5,-7329.82 7686.5,-7285.82 7963.5,-7285.82 7963.5,-7329.82"/>
<text text-anchor="middle" x="7825" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7825" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 186</text>
<text text-anchor="middle" x="7825" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7825" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_13&#45;&gt;expert_5_13_0 -->
<g id="edge577" class="edge">
<title>route_5_13&#45;&gt;expert_5_13_0</title>
<path fill="none" stroke="black" d="M7825,-7365.46C7825,-7357.18 7825,-7348.21 7825,-7339.89"/>
<polygon fill="black" stroke="black" points="7828.5,-7339.82 7825,-7329.82 7821.5,-7339.82 7828.5,-7339.82"/>
</g>
<!-- expert_5_13_1 -->
<g id="node398" class="node">
<title>expert_5_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8258.5,-7329.82 7981.5,-7329.82 7981.5,-7285.82 8258.5,-7285.82 8258.5,-7329.82"/>
<text text-anchor="middle" x="8120" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8120" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 187</text>
<text text-anchor="middle" x="8120" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8120" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_13&#45;&gt;expert_5_13_1 -->
<g id="edge578" class="edge">
<title>route_5_13&#45;&gt;expert_5_13_1</title>
<path fill="none" stroke="black" d="M7915.92,-7369.08C7955.08,-7357.52 8000.51,-7344.1 8038.56,-7332.87"/>
<polygon fill="black" stroke="black" points="8039.97,-7336.1 8048.57,-7329.91 8037.99,-7329.38 8039.97,-7336.1"/>
</g>
<!-- tp_5_13 -->
<g id="node399" class="node">
<title>tp_5_13</title>
<ellipse fill="lightblue" stroke="black" cx="7825" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7825" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7825" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 186↔187</text>
<text text-anchor="middle" x="7825" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7825" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_13_0&#45;&gt;tp_5_13 -->
<g id="edge579" class="edge">
<title>expert_5_13_0&#45;&gt;tp_5_13</title>
<path fill="none" stroke="black" d="M7825,-7285.73C7825,-7278.06 7825,-7269.1 7825,-7260.31"/>
<polygon fill="black" stroke="black" points="7828.5,-7260.15 7825,-7250.15 7821.5,-7260.15 7828.5,-7260.15"/>
</g>
<!-- expert_5_13_1&#45;&gt;tp_5_13 -->
<g id="edge580" class="edge">
<title>expert_5_13_1&#45;&gt;tp_5_13</title>
<path fill="none" stroke="black" d="M8048.59,-7285.73C8007.13,-7273.49 7954.64,-7257.98 7910.93,-7245.08"/>
<polygon fill="black" stroke="black" points="7911.75,-7241.67 7901.17,-7242.2 7909.77,-7248.39 7911.75,-7241.67"/>
</g>
<!-- tp_5_13&#45;&gt;agg_5 -->
<g id="edge581" class="edge">
<title>tp_5_13&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M7714.2,-7209.44C7620.02,-7202.68 7481.21,-7193.33 7360,-7187.59 6479.43,-7145.88 5432.09,-7122.19 4968.4,-7113.04"/>
<polygon fill="black" stroke="black" points="4968.3,-7109.53 4958.24,-7112.84 4968.17,-7116.53 4968.3,-7109.53"/>
</g>
<!-- expert_5_14_0 -->
<g id="node401" class="node">
<title>expert_5_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8553.5,-7329.82 8276.5,-7329.82 8276.5,-7285.82 8553.5,-7285.82 8553.5,-7329.82"/>
<text text-anchor="middle" x="8415" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8415" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 188</text>
<text text-anchor="middle" x="8415" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8415" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_14&#45;&gt;expert_5_14_0 -->
<g id="edge583" class="edge">
<title>route_5_14&#45;&gt;expert_5_14_0</title>
<path fill="none" stroke="black" d="M8415,-7365.46C8415,-7357.18 8415,-7348.21 8415,-7339.89"/>
<polygon fill="black" stroke="black" points="8418.5,-7339.82 8415,-7329.82 8411.5,-7339.82 8418.5,-7339.82"/>
</g>
<!-- expert_5_14_1 -->
<g id="node402" class="node">
<title>expert_5_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8848.5,-7329.82 8571.5,-7329.82 8571.5,-7285.82 8848.5,-7285.82 8848.5,-7329.82"/>
<text text-anchor="middle" x="8710" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8710" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 189</text>
<text text-anchor="middle" x="8710" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8710" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_14&#45;&gt;expert_5_14_1 -->
<g id="edge584" class="edge">
<title>route_5_14&#45;&gt;expert_5_14_1</title>
<path fill="none" stroke="black" d="M8505.92,-7369.08C8545.08,-7357.52 8590.51,-7344.1 8628.56,-7332.87"/>
<polygon fill="black" stroke="black" points="8629.97,-7336.1 8638.57,-7329.91 8627.99,-7329.38 8629.97,-7336.1"/>
</g>
<!-- tp_5_14 -->
<g id="node403" class="node">
<title>tp_5_14</title>
<ellipse fill="lightblue" stroke="black" cx="8415" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8415" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8415" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 188↔189</text>
<text text-anchor="middle" x="8415" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8415" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_14_0&#45;&gt;tp_5_14 -->
<g id="edge585" class="edge">
<title>expert_5_14_0&#45;&gt;tp_5_14</title>
<path fill="none" stroke="black" d="M8415,-7285.73C8415,-7278.06 8415,-7269.1 8415,-7260.31"/>
<polygon fill="black" stroke="black" points="8418.5,-7260.15 8415,-7250.15 8411.5,-7260.15 8418.5,-7260.15"/>
</g>
<!-- expert_5_14_1&#45;&gt;tp_5_14 -->
<g id="edge586" class="edge">
<title>expert_5_14_1&#45;&gt;tp_5_14</title>
<path fill="none" stroke="black" d="M8638.59,-7285.73C8597.13,-7273.49 8544.64,-7257.98 8500.93,-7245.08"/>
<polygon fill="black" stroke="black" points="8501.75,-7241.67 8491.17,-7242.2 8499.77,-7248.39 8501.75,-7241.67"/>
</g>
<!-- tp_5_14&#45;&gt;agg_5 -->
<g id="edge587" class="edge">
<title>tp_5_14&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M8304.2,-7209.27C8210.04,-7202.41 8071.23,-7193 7950,-7187.59 6834.96,-7137.84 5501.42,-7117.66 4966.36,-7111.17"/>
<polygon fill="black" stroke="black" points="4966.25,-7107.67 4956.21,-7111.05 4966.16,-7114.67 4966.25,-7107.67"/>
</g>
<!-- expert_5_15_0 -->
<g id="node405" class="node">
<title>expert_5_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9143.5,-7329.82 8866.5,-7329.82 8866.5,-7285.82 9143.5,-7285.82 9143.5,-7329.82"/>
<text text-anchor="middle" x="9005" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9005" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 190</text>
<text text-anchor="middle" x="9005" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9005" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_15&#45;&gt;expert_5_15_0 -->
<g id="edge589" class="edge">
<title>route_5_15&#45;&gt;expert_5_15_0</title>
<path fill="none" stroke="black" d="M9005,-7365.46C9005,-7357.18 9005,-7348.21 9005,-7339.89"/>
<polygon fill="black" stroke="black" points="9008.5,-7339.82 9005,-7329.82 9001.5,-7339.82 9008.5,-7339.82"/>
</g>
<!-- expert_5_15_1 -->
<g id="node406" class="node">
<title>expert_5_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9438.5,-7329.82 9161.5,-7329.82 9161.5,-7285.82 9438.5,-7285.82 9438.5,-7329.82"/>
<text text-anchor="middle" x="9300" y="-7320.62" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9300" y="-7310.62" font-family="Times,serif" font-size="9.00">GPU: 191</text>
<text text-anchor="middle" x="9300" y="-7300.62" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9300" y="-7290.62" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_5_15&#45;&gt;expert_5_15_1 -->
<g id="edge590" class="edge">
<title>route_5_15&#45;&gt;expert_5_15_1</title>
<path fill="none" stroke="black" d="M9095.92,-7369.08C9135.08,-7357.52 9180.51,-7344.1 9218.56,-7332.87"/>
<polygon fill="black" stroke="black" points="9219.97,-7336.1 9228.57,-7329.91 9217.99,-7329.38 9219.97,-7336.1"/>
</g>
<!-- tp_5_15 -->
<g id="node407" class="node">
<title>tp_5_15</title>
<ellipse fill="lightblue" stroke="black" cx="9005" cy="-7218.7" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9005" y="-7231.5" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9005" y="-7221.5" font-family="Times,serif" font-size="9.00">GPU: 190↔191</text>
<text text-anchor="middle" x="9005" y="-7211.5" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9005" y="-7201.5" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_5_15_0&#45;&gt;tp_5_15 -->
<g id="edge591" class="edge">
<title>expert_5_15_0&#45;&gt;tp_5_15</title>
<path fill="none" stroke="black" d="M9005,-7285.73C9005,-7278.06 9005,-7269.1 9005,-7260.31"/>
<polygon fill="black" stroke="black" points="9008.5,-7260.15 9005,-7250.15 9001.5,-7260.15 9008.5,-7260.15"/>
</g>
<!-- expert_5_15_1&#45;&gt;tp_5_15 -->
<g id="edge592" class="edge">
<title>expert_5_15_1&#45;&gt;tp_5_15</title>
<path fill="none" stroke="black" d="M9228.59,-7285.73C9187.13,-7273.49 9134.64,-7257.98 9090.93,-7245.08"/>
<polygon fill="black" stroke="black" points="9091.75,-7241.67 9081.17,-7242.2 9089.77,-7248.39 9091.75,-7241.67"/>
</g>
<!-- tp_5_15&#45;&gt;agg_5 -->
<g id="edge593" class="edge">
<title>tp_5_15&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M8894.21,-7209.15C8800.04,-7202.22 8661.24,-7192.77 8540,-7187.59 7187.8,-7129.83 5563.99,-7113.94 4964.41,-7109.89"/>
<polygon fill="black" stroke="black" points="4964.38,-7106.39 4954.35,-7109.82 4964.33,-7113.39 4964.38,-7106.39"/>
</g>
<!-- output_5 -->
<g id="node409" class="node">
<title>output_5</title>
<polygon fill="lightgreen" stroke="black" points="4875,-7027.59 4579,-7027.59 4579,-6983.59 4875,-6983.59 4875,-7027.59"/>
<text text-anchor="middle" x="4727" y="-7018.39" font-family="Times,serif" font-size="9.00">Layer 5 Output</text>
<text text-anchor="middle" x="4727" y="-7008.39" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-6998.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4727" y="-6988.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_5&#45;&gt;output_5 -->
<g id="edge594" class="edge">
<title>agg_5&#45;&gt;output_5</title>
<path fill="none" stroke="black" d="M4727,-7063.31C4727,-7054.72 4727,-7045.87 4727,-7037.78"/>
<polygon fill="black" stroke="black" points="4730.5,-7037.67 4727,-7027.67 4723.5,-7037.67 4730.5,-7037.67"/>
</g>
<!-- mha_6 -->
<g id="node410" class="node">
<title>mha_6</title>
<polygon fill="lightgreen" stroke="black" points="4875,-6936.59 4579,-6936.59 4579,-6892.59 4875,-6892.59 4875,-6936.59"/>
<text text-anchor="middle" x="4727" y="-6927.39" font-family="Times,serif" font-size="9.00">MHA L6</text>
<text text-anchor="middle" x="4727" y="-6917.39" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-6907.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-6897.39" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_5&#45;&gt;mha_6 -->
<g id="edge595" class="edge">
<title>output_5&#45;&gt;mha_6</title>
<path fill="none" stroke="black" d="M4727,-6983.5C4727,-6972.61 4727,-6959.1 4727,-6947"/>
<polygon fill="black" stroke="black" points="4730.5,-6946.84 4727,-6936.84 4723.5,-6946.84 4730.5,-6946.84"/>
</g>
<!-- gate_6 -->
<g id="node411" class="node">
<title>gate_6</title>
<polygon fill="lightyellow" stroke="black" points="5026.74,-6856.59 4549.92,-6856.59 4427.26,-6768.59 4904.08,-6768.59 5026.74,-6856.59"/>
<text text-anchor="middle" x="4727" y="-6825.39" font-family="Times,serif" font-size="9.00">Gate L6</text>
<text text-anchor="middle" x="4727" y="-6815.39" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4727" y="-6805.39" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4727" y="-6795.39" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_6&#45;&gt;gate_6 -->
<g id="edge596" class="edge">
<title>mha_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M4727,-6892.38C4727,-6884.89 4727,-6876.08 4727,-6867.12"/>
<polygon fill="black" stroke="black" points="4730.5,-6867 4727,-6857 4723.5,-6867 4730.5,-6867"/>
</g>
<!-- route_6_0 -->
<g id="node412" class="node">
<title>route_6_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="473" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="473" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="473" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 192,193</text>
<text text-anchor="middle" x="473" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="473" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_0 -->
<g id="edge597" class="edge">
<title>gate_6&#45;&gt;route_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4487.11,-6811.59C3878.93,-6810.53 2227.41,-6801 853,-6732.59 787.75,-6729.34 716.32,-6724.12 653.17,-6718.93"/>
<polygon fill="black" stroke="black" points="653.36,-6715.44 643.11,-6718.1 652.79,-6722.41 653.36,-6715.44"/>
</g>
<!-- route_6_1 -->
<g id="node416" class="node">
<title>route_6_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1063" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1063" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1063" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 194,195</text>
<text text-anchor="middle" x="1063" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1063" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_1 -->
<g id="edge603" class="edge">
<title>gate_6&#45;&gt;route_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4485.29,-6810.33C3941.49,-6806.48 2580.31,-6791.29 1443,-6732.59 1377.91,-6729.23 1306.67,-6724 1243.63,-6718.84"/>
<polygon fill="black" stroke="black" points="1243.84,-6715.34 1233.59,-6718.01 1243.27,-6722.32 1243.84,-6715.34"/>
</g>
<!-- route_6_2 -->
<g id="node420" class="node">
<title>route_6_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1653" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1653" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1653" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 196,197</text>
<text text-anchor="middle" x="1653" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1653" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_2 -->
<g id="edge609" class="edge">
<title>gate_6&#45;&gt;route_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4482.59,-6808.49C4009.42,-6801.6 2935.32,-6781.54 2033,-6732.59 1968.08,-6729.07 1897.02,-6723.82 1834.1,-6718.68"/>
<polygon fill="black" stroke="black" points="1834.33,-6715.18 1824.07,-6717.85 1833.75,-6722.16 1834.33,-6715.18"/>
</g>
<!-- route_6_3 -->
<g id="node424" class="node">
<title>route_6_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2243" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2243" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2243" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 198,199</text>
<text text-anchor="middle" x="2243" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2243" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_3 -->
<g id="edge615" class="edge">
<title>gate_6&#45;&gt;route_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4478.66,-6805.61C4084.92,-6795.37 3293.3,-6771.72 2623,-6732.59 2558.41,-6728.82 2487.73,-6723.54 2425.03,-6718.45"/>
<polygon fill="black" stroke="black" points="2425.29,-6714.96 2415.04,-6717.63 2424.72,-6721.93 2425.29,-6714.96"/>
</g>
<!-- route_6_4 -->
<g id="node428" class="node">
<title>route_6_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2833" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2833" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2833" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 200,201</text>
<text text-anchor="middle" x="2833" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2833" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_4 -->
<g id="edge621" class="edge">
<title>gate_6&#45;&gt;route_6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4471.39,-6800.36C4170.29,-6786.64 3655.05,-6761.63 3213,-6732.59 3149.04,-6728.39 3079.08,-6723.06 3016.82,-6718.05"/>
<polygon fill="black" stroke="black" points="3016.74,-6714.53 3006.49,-6717.22 3016.18,-6721.51 3016.74,-6714.53"/>
</g>
<!-- route_6_5 -->
<g id="node432" class="node">
<title>route_6_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3423" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3423" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3423" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 202,203</text>
<text text-anchor="middle" x="3423" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3423" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_5 -->
<g id="edge627" class="edge">
<title>gate_6&#45;&gt;route_6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4455.23,-6788.85C4201.06,-6767.58 3828.4,-6736.4 3607.28,-6717.9"/>
<polygon fill="black" stroke="black" points="3607.45,-6714.4 3597.19,-6717.05 3606.86,-6721.38 3607.45,-6714.4"/>
</g>
<!-- route_6_6 -->
<g id="node436" class="node">
<title>route_6_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4013" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4013" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4013" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 204,205</text>
<text text-anchor="middle" x="4013" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4013" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_6 -->
<g id="edge633" class="edge">
<title>gate_6&#45;&gt;route_6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4445.58,-6768.58C4349.14,-6753.85 4244.99,-6737.93 4163.06,-6725.41"/>
<polygon fill="black" stroke="black" points="4163.34,-6721.91 4152.92,-6723.86 4162.28,-6728.83 4163.34,-6721.91"/>
</g>
<!-- route_6_7 -->
<g id="node440" class="node">
<title>route_6_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4529" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4529" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4529" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 206,207</text>
<text text-anchor="middle" x="4529" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4529" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_7 -->
<g id="edge639" class="edge">
<title>gate_6&#45;&gt;route_6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4648.75,-6768.47C4629.42,-6757.82 4609,-6746.56 4590.59,-6736.42"/>
<polygon fill="black" stroke="black" points="4592.18,-6733.3 4581.74,-6731.54 4588.8,-6739.43 4592.18,-6733.3"/>
</g>
<!-- route_6_8 -->
<g id="node444" class="node">
<title>route_6_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4949" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4949" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4949" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 208,209</text>
<text text-anchor="middle" x="4949" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4949" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_8 -->
<g id="edge645" class="edge">
<title>gate_6&#45;&gt;route_6_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4814.74,-6768.47C4836.81,-6757.62 4860.15,-6746.15 4881.08,-6735.86"/>
<polygon fill="black" stroke="black" points="4882.77,-6738.93 4890.2,-6731.38 4879.69,-6732.65 4882.77,-6738.93"/>
</g>
<!-- route_6_9 -->
<g id="node448" class="node">
<title>route_6_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5488" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5488" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5488" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 210,211</text>
<text text-anchor="middle" x="5488" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5488" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_9 -->
<g id="edge651" class="edge">
<title>gate_6&#45;&gt;route_6_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4924.96,-6783.21C5052.37,-6764.94 5215.57,-6741.54 5333.43,-6724.64"/>
<polygon fill="black" stroke="black" points="5334.22,-6728.06 5343.62,-6723.18 5333.22,-6721.13 5334.22,-6728.06"/>
</g>
<!-- route_6_10 -->
<g id="node452" class="node">
<title>route_6_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6078" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6078" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6078" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 212,213</text>
<text text-anchor="middle" x="6078" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6078" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_10 -->
<g id="edge657" class="edge">
<title>gate_6&#45;&gt;route_6_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4940.32,-6794.36C5202.61,-6773.18 5643.48,-6737.57 5892.37,-6717.47"/>
<polygon fill="black" stroke="black" points="5892.93,-6720.94 5902.61,-6716.64 5892.36,-6713.96 5892.93,-6720.94"/>
</g>
<!-- route_6_11 -->
<g id="node456" class="node">
<title>route_6_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6668" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6668" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6668" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 214,215</text>
<text text-anchor="middle" x="6668" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6668" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_11 -->
<g id="edge663" class="edge">
<title>gate_6&#45;&gt;route_6_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4951.04,-6802.26C5254.31,-6789.17 5812.27,-6763.47 6288,-6732.59 6351.97,-6728.44 6421.92,-6723.12 6484.19,-6718.11"/>
<polygon fill="black" stroke="black" points="6484.82,-6721.57 6494.51,-6717.27 6484.26,-6714.59 6484.82,-6721.57"/>
</g>
<!-- route_6_12 -->
<g id="node460" class="node">
<title>route_6_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7258" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7258" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7258" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 216,217</text>
<text text-anchor="middle" x="7258" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7258" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_12 -->
<g id="edge669" class="edge">
<title>gate_6&#45;&gt;route_6_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4956.75,-6806.35C5350.33,-6796.65 6178.74,-6773.12 6878,-6732.59 6942.59,-6728.85 7013.28,-6723.57 7075.97,-6718.48"/>
<polygon fill="black" stroke="black" points="7076.28,-6721.97 7085.96,-6717.66 7075.71,-6714.99 7076.28,-6721.97"/>
</g>
<!-- route_6_13 -->
<g id="node464" class="node">
<title>route_6_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7848" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7848" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7848" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 218,219</text>
<text text-anchor="middle" x="7848" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7848" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_13 -->
<g id="edge675" class="edge">
<title>gate_6&#45;&gt;route_6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4960.46,-6808.82C5433.74,-6802.32 6540.13,-6782.69 7468,-6732.59 7532.92,-6729.09 7603.98,-6723.84 7666.9,-6718.7"/>
<polygon fill="black" stroke="black" points="7667.25,-6722.18 7676.93,-6717.87 7666.68,-6715.2 7667.25,-6722.18"/>
</g>
<!-- route_6_14 -->
<g id="node468" class="node">
<title>route_6_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8438" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8438" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8438" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 220,221</text>
<text text-anchor="middle" x="8438" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8438" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_14 -->
<g id="edge681" class="edge">
<title>gate_6&#45;&gt;route_6_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4962.67,-6810.48C5507.76,-6806.94 6897.73,-6792.28 8058,-6732.59 8123.09,-6729.24 8194.33,-6724.01 8257.37,-6718.85"/>
<polygon fill="black" stroke="black" points="8257.73,-6722.33 8267.41,-6718.02 8257.16,-6715.35 8257.73,-6722.33"/>
</g>
<!-- route_6_15 -->
<g id="node472" class="node">
<title>route_6_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9028" cy="-6701.48" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9028" y="-6714.28" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9028" y="-6704.28" font-family="Times,serif" font-size="9.00">GPU: 222,223</text>
<text text-anchor="middle" x="9028" y="-6694.28" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9028" y="-6684.28" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_6&#45;&gt;route_6_15 -->
<g id="edge687" class="edge">
<title>gate_6&#45;&gt;route_6_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4964.19,-6811.68C5575.14,-6810.85 7252.66,-6801.87 8648,-6732.59 8713.25,-6729.35 8784.68,-6724.13 8847.83,-6718.94"/>
<polygon fill="black" stroke="black" points="8848.21,-6722.42 8857.89,-6718.11 8847.64,-6715.45 8848.21,-6722.42"/>
</g>
<!-- expert_6_0_0 -->
<g id="node413" class="node">
<title>expert_6_0_0</title>
<polygon fill="lightgreen" stroke="black" points="316.5,-6634.37 39.5,-6634.37 39.5,-6590.37 316.5,-6590.37 316.5,-6634.37"/>
<text text-anchor="middle" x="178" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="178" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 192</text>
<text text-anchor="middle" x="178" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="178" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_0&#45;&gt;expert_6_0_0 -->
<g id="edge598" class="edge">
<title>route_6_0&#45;&gt;expert_6_0_0</title>
<path fill="none" stroke="black" d="M382.08,-6673.63C342.92,-6662.07 297.49,-6648.65 259.44,-6637.42"/>
<polygon fill="black" stroke="black" points="260.01,-6633.93 249.43,-6634.46 258.03,-6640.65 260.01,-6633.93"/>
</g>
<!-- expert_6_0_1 -->
<g id="node414" class="node">
<title>expert_6_0_1</title>
<polygon fill="lightgreen" stroke="black" points="611.5,-6634.37 334.5,-6634.37 334.5,-6590.37 611.5,-6590.37 611.5,-6634.37"/>
<text text-anchor="middle" x="473" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="473" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 193</text>
<text text-anchor="middle" x="473" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="473" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_0&#45;&gt;expert_6_0_1 -->
<g id="edge599" class="edge">
<title>route_6_0&#45;&gt;expert_6_0_1</title>
<path fill="none" stroke="black" d="M473,-6670.01C473,-6661.73 473,-6652.76 473,-6644.44"/>
<polygon fill="black" stroke="black" points="476.5,-6644.37 473,-6634.37 469.5,-6644.37 476.5,-6644.37"/>
</g>
<!-- tp_6_0 -->
<g id="node415" class="node">
<title>tp_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="473" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="473" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="473" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 192↔193</text>
<text text-anchor="middle" x="473" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="473" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_0_0&#45;&gt;tp_6_0 -->
<g id="edge600" class="edge">
<title>expert_6_0_0&#45;&gt;tp_6_0</title>
<path fill="none" stroke="black" d="M249.41,-6590.28C290.87,-6578.04 343.36,-6562.53 387.07,-6549.63"/>
<polygon fill="black" stroke="black" points="388.23,-6552.93 396.83,-6546.75 386.25,-6546.22 388.23,-6552.93"/>
</g>
<!-- expert_6_0_1&#45;&gt;tp_6_0 -->
<g id="edge601" class="edge">
<title>expert_6_0_1&#45;&gt;tp_6_0</title>
<path fill="none" stroke="black" d="M473,-6590.28C473,-6582.61 473,-6573.65 473,-6564.86"/>
<polygon fill="black" stroke="black" points="476.5,-6564.7 473,-6554.7 469.5,-6564.7 476.5,-6564.7"/>
</g>
<!-- agg_6 -->
<g id="node476" class="node">
<title>agg_6</title>
<polygon fill="lightyellow" stroke="black" points="5031.99,-6456.14 4583.4,-6456.14 4468.01,-6368.14 4916.6,-6368.14 5031.99,-6456.14"/>
<text text-anchor="middle" x="4750" y="-6424.94" font-family="Times,serif" font-size="9.00">Aggregate Experts L6</text>
<text text-anchor="middle" x="4750" y="-6414.94" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4750" y="-6404.94" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4750" y="-6394.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_6_0&#45;&gt;agg_6 -->
<g id="edge602" class="edge">
<title>tp_6_0&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M583.79,-6513.7C677.96,-6506.77 816.76,-6497.32 938,-6492.14 2293.83,-6434.22 3922.8,-6418.4 4517.92,-6414.4"/>
<polygon fill="black" stroke="black" points="4518.36,-6417.9 4528.33,-6414.33 4518.31,-6410.9 4518.36,-6417.9"/>
</g>
<!-- expert_6_1_0 -->
<g id="node417" class="node">
<title>expert_6_1_0</title>
<polygon fill="lightgreen" stroke="black" points="906.5,-6634.37 629.5,-6634.37 629.5,-6590.37 906.5,-6590.37 906.5,-6634.37"/>
<text text-anchor="middle" x="768" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="768" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 194</text>
<text text-anchor="middle" x="768" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="768" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_1&#45;&gt;expert_6_1_0 -->
<g id="edge604" class="edge">
<title>route_6_1&#45;&gt;expert_6_1_0</title>
<path fill="none" stroke="black" d="M972.08,-6673.63C932.92,-6662.07 887.49,-6648.65 849.44,-6637.42"/>
<polygon fill="black" stroke="black" points="850.01,-6633.93 839.43,-6634.46 848.03,-6640.65 850.01,-6633.93"/>
</g>
<!-- expert_6_1_1 -->
<g id="node418" class="node">
<title>expert_6_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1201.5,-6634.37 924.5,-6634.37 924.5,-6590.37 1201.5,-6590.37 1201.5,-6634.37"/>
<text text-anchor="middle" x="1063" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1063" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 195</text>
<text text-anchor="middle" x="1063" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1063" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_1&#45;&gt;expert_6_1_1 -->
<g id="edge605" class="edge">
<title>route_6_1&#45;&gt;expert_6_1_1</title>
<path fill="none" stroke="black" d="M1063,-6670.01C1063,-6661.73 1063,-6652.76 1063,-6644.44"/>
<polygon fill="black" stroke="black" points="1066.5,-6644.37 1063,-6634.37 1059.5,-6644.37 1066.5,-6644.37"/>
</g>
<!-- tp_6_1 -->
<g id="node419" class="node">
<title>tp_6_1</title>
<ellipse fill="lightblue" stroke="black" cx="1063" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1063" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1063" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 194↔195</text>
<text text-anchor="middle" x="1063" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1063" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_1_0&#45;&gt;tp_6_1 -->
<g id="edge606" class="edge">
<title>expert_6_1_0&#45;&gt;tp_6_1</title>
<path fill="none" stroke="black" d="M839.41,-6590.28C880.87,-6578.04 933.36,-6562.53 977.07,-6549.63"/>
<polygon fill="black" stroke="black" points="978.23,-6552.93 986.83,-6546.75 976.25,-6546.22 978.23,-6552.93"/>
</g>
<!-- expert_6_1_1&#45;&gt;tp_6_1 -->
<g id="edge607" class="edge">
<title>expert_6_1_1&#45;&gt;tp_6_1</title>
<path fill="none" stroke="black" d="M1063,-6590.28C1063,-6582.61 1063,-6573.65 1063,-6564.86"/>
<polygon fill="black" stroke="black" points="1066.5,-6564.7 1063,-6554.7 1059.5,-6564.7 1066.5,-6564.7"/>
</g>
<!-- tp_6_1&#45;&gt;agg_6 -->
<g id="edge608" class="edge">
<title>tp_6_1&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1173.8,-6513.82C1267.96,-6506.96 1406.77,-6497.55 1528,-6492.14 2648.94,-6442.12 3990.78,-6421.99 4519.63,-6415.62"/>
<polygon fill="black" stroke="black" points="4519.71,-6419.11 4529.67,-6415.49 4519.63,-6412.12 4519.71,-6419.11"/>
</g>
<!-- expert_6_2_0 -->
<g id="node421" class="node">
<title>expert_6_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1496.5,-6634.37 1219.5,-6634.37 1219.5,-6590.37 1496.5,-6590.37 1496.5,-6634.37"/>
<text text-anchor="middle" x="1358" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1358" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 196</text>
<text text-anchor="middle" x="1358" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1358" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_2&#45;&gt;expert_6_2_0 -->
<g id="edge610" class="edge">
<title>route_6_2&#45;&gt;expert_6_2_0</title>
<path fill="none" stroke="black" d="M1562.08,-6673.63C1522.92,-6662.07 1477.49,-6648.65 1439.44,-6637.42"/>
<polygon fill="black" stroke="black" points="1440.01,-6633.93 1429.43,-6634.46 1438.03,-6640.65 1440.01,-6633.93"/>
</g>
<!-- expert_6_2_1 -->
<g id="node422" class="node">
<title>expert_6_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1791.5,-6634.37 1514.5,-6634.37 1514.5,-6590.37 1791.5,-6590.37 1791.5,-6634.37"/>
<text text-anchor="middle" x="1653" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1653" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 197</text>
<text text-anchor="middle" x="1653" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1653" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_2&#45;&gt;expert_6_2_1 -->
<g id="edge611" class="edge">
<title>route_6_2&#45;&gt;expert_6_2_1</title>
<path fill="none" stroke="black" d="M1653,-6670.01C1653,-6661.73 1653,-6652.76 1653,-6644.44"/>
<polygon fill="black" stroke="black" points="1656.5,-6644.37 1653,-6634.37 1649.5,-6644.37 1656.5,-6644.37"/>
</g>
<!-- tp_6_2 -->
<g id="node423" class="node">
<title>tp_6_2</title>
<ellipse fill="lightblue" stroke="black" cx="1653" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1653" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1653" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 196↔197</text>
<text text-anchor="middle" x="1653" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1653" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_2_0&#45;&gt;tp_6_2 -->
<g id="edge612" class="edge">
<title>expert_6_2_0&#45;&gt;tp_6_2</title>
<path fill="none" stroke="black" d="M1429.41,-6590.28C1470.87,-6578.04 1523.36,-6562.53 1567.07,-6549.63"/>
<polygon fill="black" stroke="black" points="1568.23,-6552.93 1576.83,-6546.75 1566.25,-6546.22 1568.23,-6552.93"/>
</g>
<!-- expert_6_2_1&#45;&gt;tp_6_2 -->
<g id="edge613" class="edge">
<title>expert_6_2_1&#45;&gt;tp_6_2</title>
<path fill="none" stroke="black" d="M1653,-6590.28C1653,-6582.61 1653,-6573.65 1653,-6564.86"/>
<polygon fill="black" stroke="black" points="1656.5,-6564.7 1653,-6554.7 1649.5,-6564.7 1656.5,-6564.7"/>
</g>
<!-- tp_6_2&#45;&gt;agg_6 -->
<g id="edge614" class="edge">
<title>tp_6_2&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M1763.8,-6513.99C1857.98,-6507.23 1996.79,-6497.88 2118,-6492.14 3006.74,-6450.04 4065.42,-6426.29 4521.95,-6417.33"/>
<polygon fill="black" stroke="black" points="4522.03,-6420.82 4531.96,-6417.13 4521.89,-6413.83 4522.03,-6420.82"/>
</g>
<!-- expert_6_3_0 -->
<g id="node425" class="node">
<title>expert_6_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2086.5,-6634.37 1809.5,-6634.37 1809.5,-6590.37 2086.5,-6590.37 2086.5,-6634.37"/>
<text text-anchor="middle" x="1948" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1948" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 198</text>
<text text-anchor="middle" x="1948" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1948" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_3&#45;&gt;expert_6_3_0 -->
<g id="edge616" class="edge">
<title>route_6_3&#45;&gt;expert_6_3_0</title>
<path fill="none" stroke="black" d="M2152.08,-6673.63C2112.92,-6662.07 2067.49,-6648.65 2029.44,-6637.42"/>
<polygon fill="black" stroke="black" points="2030.01,-6633.93 2019.43,-6634.46 2028.03,-6640.65 2030.01,-6633.93"/>
</g>
<!-- expert_6_3_1 -->
<g id="node426" class="node">
<title>expert_6_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2381.5,-6634.37 2104.5,-6634.37 2104.5,-6590.37 2381.5,-6590.37 2381.5,-6634.37"/>
<text text-anchor="middle" x="2243" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2243" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 199</text>
<text text-anchor="middle" x="2243" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2243" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_3&#45;&gt;expert_6_3_1 -->
<g id="edge617" class="edge">
<title>route_6_3&#45;&gt;expert_6_3_1</title>
<path fill="none" stroke="black" d="M2243,-6670.01C2243,-6661.73 2243,-6652.76 2243,-6644.44"/>
<polygon fill="black" stroke="black" points="2246.5,-6644.37 2243,-6634.37 2239.5,-6644.37 2246.5,-6644.37"/>
</g>
<!-- tp_6_3 -->
<g id="node427" class="node">
<title>tp_6_3</title>
<ellipse fill="lightblue" stroke="black" cx="2243" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2243" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2243" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 198↔199</text>
<text text-anchor="middle" x="2243" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2243" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_3_0&#45;&gt;tp_6_3 -->
<g id="edge618" class="edge">
<title>expert_6_3_0&#45;&gt;tp_6_3</title>
<path fill="none" stroke="black" d="M2019.41,-6590.28C2060.87,-6578.04 2113.36,-6562.53 2157.07,-6549.63"/>
<polygon fill="black" stroke="black" points="2158.23,-6552.93 2166.83,-6546.75 2156.25,-6546.22 2158.23,-6552.93"/>
</g>
<!-- expert_6_3_1&#45;&gt;tp_6_3 -->
<g id="edge619" class="edge">
<title>expert_6_3_1&#45;&gt;tp_6_3</title>
<path fill="none" stroke="black" d="M2243,-6590.28C2243,-6582.61 2243,-6573.65 2243,-6564.86"/>
<polygon fill="black" stroke="black" points="2246.5,-6564.7 2243,-6554.7 2239.5,-6564.7 2246.5,-6564.7"/>
</g>
<!-- tp_6_3&#45;&gt;agg_6 -->
<g id="edge620" class="edge">
<title>tp_6_3&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2354.29,-6514.23C2448.46,-6507.64 2587.02,-6498.4 2708,-6492.14 3368.08,-6458 4148.88,-6431.71 4525.12,-6419.93"/>
<polygon fill="black" stroke="black" points="4525.42,-6423.42 4535.3,-6419.61 4525.2,-6416.42 4525.42,-6423.42"/>
</g>
<!-- expert_6_4_0 -->
<g id="node429" class="node">
<title>expert_6_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2676.5,-6634.37 2399.5,-6634.37 2399.5,-6590.37 2676.5,-6590.37 2676.5,-6634.37"/>
<text text-anchor="middle" x="2538" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2538" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 200</text>
<text text-anchor="middle" x="2538" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2538" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_4&#45;&gt;expert_6_4_0 -->
<g id="edge622" class="edge">
<title>route_6_4&#45;&gt;expert_6_4_0</title>
<path fill="none" stroke="black" d="M2742.08,-6673.63C2702.92,-6662.07 2657.49,-6648.65 2619.44,-6637.42"/>
<polygon fill="black" stroke="black" points="2620.01,-6633.93 2609.43,-6634.46 2618.03,-6640.65 2620.01,-6633.93"/>
</g>
<!-- expert_6_4_1 -->
<g id="node430" class="node">
<title>expert_6_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2971.5,-6634.37 2694.5,-6634.37 2694.5,-6590.37 2971.5,-6590.37 2971.5,-6634.37"/>
<text text-anchor="middle" x="2833" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2833" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 201</text>
<text text-anchor="middle" x="2833" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2833" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_4&#45;&gt;expert_6_4_1 -->
<g id="edge623" class="edge">
<title>route_6_4&#45;&gt;expert_6_4_1</title>
<path fill="none" stroke="black" d="M2833,-6670.01C2833,-6661.73 2833,-6652.76 2833,-6644.44"/>
<polygon fill="black" stroke="black" points="2836.5,-6644.37 2833,-6634.37 2829.5,-6644.37 2836.5,-6644.37"/>
</g>
<!-- tp_6_4 -->
<g id="node431" class="node">
<title>tp_6_4</title>
<ellipse fill="lightblue" stroke="black" cx="2833" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2833" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2833" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 200↔201</text>
<text text-anchor="middle" x="2833" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2833" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_4_0&#45;&gt;tp_6_4 -->
<g id="edge624" class="edge">
<title>expert_6_4_0&#45;&gt;tp_6_4</title>
<path fill="none" stroke="black" d="M2609.41,-6590.28C2650.87,-6578.04 2703.36,-6562.53 2747.07,-6549.63"/>
<polygon fill="black" stroke="black" points="2748.23,-6552.93 2756.83,-6546.75 2746.25,-6546.22 2748.23,-6552.93"/>
</g>
<!-- expert_6_4_1&#45;&gt;tp_6_4 -->
<g id="edge625" class="edge">
<title>expert_6_4_1&#45;&gt;tp_6_4</title>
<path fill="none" stroke="black" d="M2833,-6590.28C2833,-6582.61 2833,-6573.65 2833,-6564.86"/>
<polygon fill="black" stroke="black" points="2836.5,-6564.7 2833,-6554.7 2829.5,-6564.7 2836.5,-6564.7"/>
</g>
<!-- tp_6_4&#45;&gt;agg_6 -->
<g id="edge626" class="edge">
<title>tp_6_4&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M2944.79,-6514.69C3038.97,-6508.39 3177.27,-6499.33 3298,-6492.14 3735.09,-6466.1 4246.42,-6439.08 4530.75,-6424.36"/>
<polygon fill="black" stroke="black" points="4530.96,-6427.86 4540.77,-6423.85 4530.6,-6420.87 4530.96,-6427.86"/>
</g>
<!-- expert_6_5_0 -->
<g id="node433" class="node">
<title>expert_6_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3266.5,-6634.37 2989.5,-6634.37 2989.5,-6590.37 3266.5,-6590.37 3266.5,-6634.37"/>
<text text-anchor="middle" x="3128" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3128" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 202</text>
<text text-anchor="middle" x="3128" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3128" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_5&#45;&gt;expert_6_5_0 -->
<g id="edge628" class="edge">
<title>route_6_5&#45;&gt;expert_6_5_0</title>
<path fill="none" stroke="black" d="M3332.08,-6673.63C3292.92,-6662.07 3247.49,-6648.65 3209.44,-6637.42"/>
<polygon fill="black" stroke="black" points="3210.01,-6633.93 3199.43,-6634.46 3208.03,-6640.65 3210.01,-6633.93"/>
</g>
<!-- expert_6_5_1 -->
<g id="node434" class="node">
<title>expert_6_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3561.5,-6634.37 3284.5,-6634.37 3284.5,-6590.37 3561.5,-6590.37 3561.5,-6634.37"/>
<text text-anchor="middle" x="3423" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3423" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 203</text>
<text text-anchor="middle" x="3423" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3423" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_5&#45;&gt;expert_6_5_1 -->
<g id="edge629" class="edge">
<title>route_6_5&#45;&gt;expert_6_5_1</title>
<path fill="none" stroke="black" d="M3423,-6670.01C3423,-6661.73 3423,-6652.76 3423,-6644.44"/>
<polygon fill="black" stroke="black" points="3426.5,-6644.37 3423,-6634.37 3419.5,-6644.37 3426.5,-6644.37"/>
</g>
<!-- tp_6_5 -->
<g id="node435" class="node">
<title>tp_6_5</title>
<ellipse fill="lightblue" stroke="black" cx="3423" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3423" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3423" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 202↔203</text>
<text text-anchor="middle" x="3423" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3423" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_5_0&#45;&gt;tp_6_5 -->
<g id="edge630" class="edge">
<title>expert_6_5_0&#45;&gt;tp_6_5</title>
<path fill="none" stroke="black" d="M3199.41,-6590.28C3240.87,-6578.04 3293.36,-6562.53 3337.07,-6549.63"/>
<polygon fill="black" stroke="black" points="3338.23,-6552.93 3346.83,-6546.75 3336.25,-6546.22 3338.23,-6552.93"/>
</g>
<!-- expert_6_5_1&#45;&gt;tp_6_5 -->
<g id="edge631" class="edge">
<title>expert_6_5_1&#45;&gt;tp_6_5</title>
<path fill="none" stroke="black" d="M3423,-6590.28C3423,-6582.61 3423,-6573.65 3423,-6564.86"/>
<polygon fill="black" stroke="black" points="3426.5,-6564.7 3423,-6554.7 3419.5,-6564.7 3426.5,-6564.7"/>
</g>
<!-- tp_6_5&#45;&gt;agg_6 -->
<g id="edge632" class="edge">
<title>tp_6_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M3533.01,-6513.21C3753.49,-6495.08 4252.79,-6454.02 4538.61,-6430.52"/>
<polygon fill="black" stroke="black" points="4539.01,-6434 4548.69,-6429.69 4538.44,-6427.02 4539.01,-6434"/>
</g>
<!-- expert_6_6_0 -->
<g id="node437" class="node">
<title>expert_6_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3856.5,-6634.37 3579.5,-6634.37 3579.5,-6590.37 3856.5,-6590.37 3856.5,-6634.37"/>
<text text-anchor="middle" x="3718" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3718" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 204</text>
<text text-anchor="middle" x="3718" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3718" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_6&#45;&gt;expert_6_6_0 -->
<g id="edge634" class="edge">
<title>route_6_6&#45;&gt;expert_6_6_0</title>
<path fill="none" stroke="black" d="M3922.08,-6673.63C3882.92,-6662.07 3837.49,-6648.65 3799.44,-6637.42"/>
<polygon fill="black" stroke="black" points="3800.01,-6633.93 3789.43,-6634.46 3798.03,-6640.65 3800.01,-6633.93"/>
</g>
<!-- expert_6_6_1 -->
<g id="node438" class="node">
<title>expert_6_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4151.5,-6634.37 3874.5,-6634.37 3874.5,-6590.37 4151.5,-6590.37 4151.5,-6634.37"/>
<text text-anchor="middle" x="4013" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4013" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 205</text>
<text text-anchor="middle" x="4013" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4013" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_6&#45;&gt;expert_6_6_1 -->
<g id="edge635" class="edge">
<title>route_6_6&#45;&gt;expert_6_6_1</title>
<path fill="none" stroke="black" d="M4013,-6670.01C4013,-6661.73 4013,-6652.76 4013,-6644.44"/>
<polygon fill="black" stroke="black" points="4016.5,-6644.37 4013,-6634.37 4009.5,-6644.37 4016.5,-6644.37"/>
</g>
<!-- tp_6_6 -->
<g id="node439" class="node">
<title>tp_6_6</title>
<ellipse fill="lightblue" stroke="black" cx="4013" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4013" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4013" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 204↔205</text>
<text text-anchor="middle" x="4013" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4013" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_6_0&#45;&gt;tp_6_6 -->
<g id="edge636" class="edge">
<title>expert_6_6_0&#45;&gt;tp_6_6</title>
<path fill="none" stroke="black" d="M3789.41,-6590.28C3830.87,-6578.04 3883.36,-6562.53 3927.07,-6549.63"/>
<polygon fill="black" stroke="black" points="3928.23,-6552.93 3936.83,-6546.75 3926.25,-6546.22 3928.23,-6552.93"/>
</g>
<!-- expert_6_6_1&#45;&gt;tp_6_6 -->
<g id="edge637" class="edge">
<title>expert_6_6_1&#45;&gt;tp_6_6</title>
<path fill="none" stroke="black" d="M4013,-6590.28C4013,-6582.61 4013,-6573.65 4013,-6564.86"/>
<polygon fill="black" stroke="black" points="4016.5,-6564.7 4013,-6554.7 4009.5,-6564.7 4016.5,-6564.7"/>
</g>
<!-- tp_6_6&#45;&gt;agg_6 -->
<g id="edge638" class="edge">
<title>tp_6_6&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M4113.16,-6507.42C4225.68,-6490.77 4411.1,-6463.31 4552.93,-6442.32"/>
<polygon fill="black" stroke="black" points="4553.68,-6445.74 4563.06,-6440.82 4552.66,-6438.82 4553.68,-6445.74"/>
</g>
<!-- expert_6_7_0 -->
<g id="node441" class="node">
<title>expert_6_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4446.5,-6634.37 4169.5,-6634.37 4169.5,-6590.37 4446.5,-6590.37 4446.5,-6634.37"/>
<text text-anchor="middle" x="4308" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4308" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 206</text>
<text text-anchor="middle" x="4308" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4308" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_7&#45;&gt;expert_6_7_0 -->
<g id="edge640" class="edge">
<title>route_6_7&#45;&gt;expert_6_7_0</title>
<path fill="none" stroke="black" d="M4457.55,-6672.32C4429.58,-6661.29 4397.77,-6648.75 4370.7,-6638.08"/>
<polygon fill="black" stroke="black" points="4371.92,-6634.8 4361.34,-6634.39 4369.35,-6641.31 4371.92,-6634.8"/>
</g>
<!-- expert_6_7_1 -->
<g id="node442" class="node">
<title>expert_6_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4741.5,-6634.37 4464.5,-6634.37 4464.5,-6590.37 4741.5,-6590.37 4741.5,-6634.37"/>
<text text-anchor="middle" x="4603" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4603" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 207</text>
<text text-anchor="middle" x="4603" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4603" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_7&#45;&gt;expert_6_7_1 -->
<g id="edge641" class="edge">
<title>route_6_7&#45;&gt;expert_6_7_1</title>
<path fill="none" stroke="black" d="M4554.47,-6670.5C4562.23,-6661.36 4570.74,-6651.34 4578.44,-6642.28"/>
<polygon fill="black" stroke="black" points="4581.15,-6644.49 4584.96,-6634.61 4575.82,-6639.96 4581.15,-6644.49"/>
</g>
<!-- tp_6_7 -->
<g id="node443" class="node">
<title>tp_6_7</title>
<ellipse fill="lightblue" stroke="black" cx="4603" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4603" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4603" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 206↔207</text>
<text text-anchor="middle" x="4603" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4603" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_7_0&#45;&gt;tp_6_7 -->
<g id="edge642" class="edge">
<title>expert_6_7_0&#45;&gt;tp_6_7</title>
<path fill="none" stroke="black" d="M4379.41,-6590.28C4420.87,-6578.04 4473.36,-6562.53 4517.07,-6549.63"/>
<polygon fill="black" stroke="black" points="4518.23,-6552.93 4526.83,-6546.75 4516.25,-6546.22 4518.23,-6552.93"/>
</g>
<!-- expert_6_7_1&#45;&gt;tp_6_7 -->
<g id="edge643" class="edge">
<title>expert_6_7_1&#45;&gt;tp_6_7</title>
<path fill="none" stroke="black" d="M4603,-6590.28C4603,-6582.61 4603,-6573.65 4603,-6564.86"/>
<polygon fill="black" stroke="black" points="4606.5,-6564.7 4603,-6554.7 4599.5,-6564.7 4606.5,-6564.7"/>
</g>
<!-- tp_6_7&#45;&gt;agg_6 -->
<g id="edge644" class="edge">
<title>tp_6_7&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M4641.24,-6493.87C4654.3,-6484.17 4669.31,-6473.03 4683.93,-6462.18"/>
<polygon fill="black" stroke="black" points="4686.05,-6464.97 4691.99,-6456.2 4681.88,-6459.35 4686.05,-6464.97"/>
</g>
<!-- expert_6_8_0 -->
<g id="node445" class="node">
<title>expert_6_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5036.5,-6634.37 4759.5,-6634.37 4759.5,-6590.37 5036.5,-6590.37 5036.5,-6634.37"/>
<text text-anchor="middle" x="4898" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4898" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 208</text>
<text text-anchor="middle" x="4898" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4898" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_8&#45;&gt;expert_6_8_0 -->
<g id="edge646" class="edge">
<title>route_6_8&#45;&gt;expert_6_8_0</title>
<path fill="none" stroke="black" d="M4931.16,-6670.01C4926.05,-6661.27 4920.48,-6651.76 4915.39,-6643.06"/>
<polygon fill="black" stroke="black" points="4918.37,-6641.23 4910.3,-6634.37 4912.33,-6644.77 4918.37,-6641.23"/>
</g>
<!-- expert_6_8_1 -->
<g id="node446" class="node">
<title>expert_6_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5331.5,-6634.37 5054.5,-6634.37 5054.5,-6590.37 5331.5,-6590.37 5331.5,-6634.37"/>
<text text-anchor="middle" x="5193" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5193" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 209</text>
<text text-anchor="middle" x="5193" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5193" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_8&#45;&gt;expert_6_8_1 -->
<g id="edge647" class="edge">
<title>route_6_8&#45;&gt;expert_6_8_1</title>
<path fill="none" stroke="black" d="M5026.87,-6672.68C5058.21,-6661.49 5094.04,-6648.7 5124.38,-6637.87"/>
<polygon fill="black" stroke="black" points="5125.78,-6641.08 5134.02,-6634.42 5123.43,-6634.49 5125.78,-6641.08"/>
</g>
<!-- tp_6_8 -->
<g id="node447" class="node">
<title>tp_6_8</title>
<ellipse fill="lightblue" stroke="black" cx="4898" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4898" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4898" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 208↔209</text>
<text text-anchor="middle" x="4898" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4898" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_8_0&#45;&gt;tp_6_8 -->
<g id="edge648" class="edge">
<title>expert_6_8_0&#45;&gt;tp_6_8</title>
<path fill="none" stroke="black" d="M4898,-6590.28C4898,-6582.61 4898,-6573.65 4898,-6564.86"/>
<polygon fill="black" stroke="black" points="4901.5,-6564.7 4898,-6554.7 4894.5,-6564.7 4901.5,-6564.7"/>
</g>
<!-- expert_6_8_1&#45;&gt;tp_6_8 -->
<g id="edge649" class="edge">
<title>expert_6_8_1&#45;&gt;tp_6_8</title>
<path fill="none" stroke="black" d="M5121.59,-6590.28C5080.13,-6578.04 5027.64,-6562.53 4983.93,-6549.63"/>
<polygon fill="black" stroke="black" points="4984.75,-6546.22 4974.17,-6546.75 4982.77,-6552.93 4984.75,-6546.22"/>
</g>
<!-- tp_6_8&#45;&gt;agg_6 -->
<g id="edge650" class="edge">
<title>tp_6_8&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M4859.5,-6493.87C4846.35,-6484.17 4831.24,-6473.03 4816.52,-6462.18"/>
<polygon fill="black" stroke="black" points="4818.53,-6459.31 4808.4,-6456.2 4814.37,-6464.95 4818.53,-6459.31"/>
</g>
<!-- expert_6_9_0 -->
<g id="node449" class="node">
<title>expert_6_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5626.5,-6634.37 5349.5,-6634.37 5349.5,-6590.37 5626.5,-6590.37 5626.5,-6634.37"/>
<text text-anchor="middle" x="5488" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5488" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 210</text>
<text text-anchor="middle" x="5488" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5488" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_9&#45;&gt;expert_6_9_0 -->
<g id="edge652" class="edge">
<title>route_6_9&#45;&gt;expert_6_9_0</title>
<path fill="none" stroke="black" d="M5488,-6670.01C5488,-6661.73 5488,-6652.76 5488,-6644.44"/>
<polygon fill="black" stroke="black" points="5491.5,-6644.37 5488,-6634.37 5484.5,-6644.37 5491.5,-6644.37"/>
</g>
<!-- expert_6_9_1 -->
<g id="node450" class="node">
<title>expert_6_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5921.5,-6634.37 5644.5,-6634.37 5644.5,-6590.37 5921.5,-6590.37 5921.5,-6634.37"/>
<text text-anchor="middle" x="5783" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5783" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 211</text>
<text text-anchor="middle" x="5783" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5783" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_9&#45;&gt;expert_6_9_1 -->
<g id="edge653" class="edge">
<title>route_6_9&#45;&gt;expert_6_9_1</title>
<path fill="none" stroke="black" d="M5578.92,-6673.63C5618.08,-6662.07 5663.51,-6648.65 5701.56,-6637.42"/>
<polygon fill="black" stroke="black" points="5702.97,-6640.65 5711.57,-6634.46 5700.99,-6633.93 5702.97,-6640.65"/>
</g>
<!-- tp_6_9 -->
<g id="node451" class="node">
<title>tp_6_9</title>
<ellipse fill="lightblue" stroke="black" cx="5488" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5488" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5488" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 210↔211</text>
<text text-anchor="middle" x="5488" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5488" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_9_0&#45;&gt;tp_6_9 -->
<g id="edge654" class="edge">
<title>expert_6_9_0&#45;&gt;tp_6_9</title>
<path fill="none" stroke="black" d="M5488,-6590.28C5488,-6582.61 5488,-6573.65 5488,-6564.86"/>
<polygon fill="black" stroke="black" points="5491.5,-6564.7 5488,-6554.7 5484.5,-6564.7 5491.5,-6564.7"/>
</g>
<!-- expert_6_9_1&#45;&gt;tp_6_9 -->
<g id="edge655" class="edge">
<title>expert_6_9_1&#45;&gt;tp_6_9</title>
<path fill="none" stroke="black" d="M5711.59,-6590.28C5670.13,-6578.04 5617.64,-6562.53 5573.93,-6549.63"/>
<polygon fill="black" stroke="black" points="5574.75,-6546.22 5564.17,-6546.75 5572.77,-6552.93 5574.75,-6546.22"/>
</g>
<!-- tp_6_9&#45;&gt;agg_6 -->
<g id="edge656" class="edge">
<title>tp_6_9&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M5387.7,-6507.42C5298.3,-6494.21 5162.93,-6474.19 5039.87,-6456"/>
<polygon fill="black" stroke="black" points="5040.31,-6452.52 5029.9,-6454.52 5039.28,-6459.45 5040.31,-6452.52"/>
</g>
<!-- expert_6_10_0 -->
<g id="node453" class="node">
<title>expert_6_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6216.5,-6634.37 5939.5,-6634.37 5939.5,-6590.37 6216.5,-6590.37 6216.5,-6634.37"/>
<text text-anchor="middle" x="6078" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6078" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 212</text>
<text text-anchor="middle" x="6078" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6078" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_10&#45;&gt;expert_6_10_0 -->
<g id="edge658" class="edge">
<title>route_6_10&#45;&gt;expert_6_10_0</title>
<path fill="none" stroke="black" d="M6078,-6670.01C6078,-6661.73 6078,-6652.76 6078,-6644.44"/>
<polygon fill="black" stroke="black" points="6081.5,-6644.37 6078,-6634.37 6074.5,-6644.37 6081.5,-6644.37"/>
</g>
<!-- expert_6_10_1 -->
<g id="node454" class="node">
<title>expert_6_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6511.5,-6634.37 6234.5,-6634.37 6234.5,-6590.37 6511.5,-6590.37 6511.5,-6634.37"/>
<text text-anchor="middle" x="6373" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6373" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 213</text>
<text text-anchor="middle" x="6373" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6373" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_10&#45;&gt;expert_6_10_1 -->
<g id="edge659" class="edge">
<title>route_6_10&#45;&gt;expert_6_10_1</title>
<path fill="none" stroke="black" d="M6168.92,-6673.63C6208.08,-6662.07 6253.51,-6648.65 6291.56,-6637.42"/>
<polygon fill="black" stroke="black" points="6292.97,-6640.65 6301.57,-6634.46 6290.99,-6633.93 6292.97,-6640.65"/>
</g>
<!-- tp_6_10 -->
<g id="node455" class="node">
<title>tp_6_10</title>
<ellipse fill="lightblue" stroke="black" cx="6078" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6078" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6078" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 212↔213</text>
<text text-anchor="middle" x="6078" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6078" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_10_0&#45;&gt;tp_6_10 -->
<g id="edge660" class="edge">
<title>expert_6_10_0&#45;&gt;tp_6_10</title>
<path fill="none" stroke="black" d="M6078,-6590.28C6078,-6582.61 6078,-6573.65 6078,-6564.86"/>
<polygon fill="black" stroke="black" points="6081.5,-6564.7 6078,-6554.7 6074.5,-6564.7 6081.5,-6564.7"/>
</g>
<!-- expert_6_10_1&#45;&gt;tp_6_10 -->
<g id="edge661" class="edge">
<title>expert_6_10_1&#45;&gt;tp_6_10</title>
<path fill="none" stroke="black" d="M6301.59,-6590.28C6260.13,-6578.04 6207.64,-6562.53 6163.93,-6549.63"/>
<polygon fill="black" stroke="black" points="6164.75,-6546.22 6154.17,-6546.75 6162.77,-6552.93 6164.75,-6546.22"/>
</g>
<!-- tp_6_10&#45;&gt;agg_6 -->
<g id="edge662" class="edge">
<title>tp_6_10&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M5968.19,-6513.23C5760.46,-6496.16 5304.69,-6458.72 5013.33,-6434.78"/>
<polygon fill="black" stroke="black" points="5013.29,-6431.26 5003.03,-6433.93 5012.71,-6438.24 5013.29,-6431.26"/>
</g>
<!-- expert_6_11_0 -->
<g id="node457" class="node">
<title>expert_6_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6806.5,-6634.37 6529.5,-6634.37 6529.5,-6590.37 6806.5,-6590.37 6806.5,-6634.37"/>
<text text-anchor="middle" x="6668" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6668" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 214</text>
<text text-anchor="middle" x="6668" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6668" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_11&#45;&gt;expert_6_11_0 -->
<g id="edge664" class="edge">
<title>route_6_11&#45;&gt;expert_6_11_0</title>
<path fill="none" stroke="black" d="M6668,-6670.01C6668,-6661.73 6668,-6652.76 6668,-6644.44"/>
<polygon fill="black" stroke="black" points="6671.5,-6644.37 6668,-6634.37 6664.5,-6644.37 6671.5,-6644.37"/>
</g>
<!-- expert_6_11_1 -->
<g id="node458" class="node">
<title>expert_6_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7101.5,-6634.37 6824.5,-6634.37 6824.5,-6590.37 7101.5,-6590.37 7101.5,-6634.37"/>
<text text-anchor="middle" x="6963" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="6963" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 215</text>
<text text-anchor="middle" x="6963" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6963" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_11&#45;&gt;expert_6_11_1 -->
<g id="edge665" class="edge">
<title>route_6_11&#45;&gt;expert_6_11_1</title>
<path fill="none" stroke="black" d="M6758.92,-6673.63C6798.08,-6662.07 6843.51,-6648.65 6881.56,-6637.42"/>
<polygon fill="black" stroke="black" points="6882.97,-6640.65 6891.57,-6634.46 6880.99,-6633.93 6882.97,-6640.65"/>
</g>
<!-- tp_6_11 -->
<g id="node459" class="node">
<title>tp_6_11</title>
<ellipse fill="lightblue" stroke="black" cx="6668" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6668" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6668" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 214↔215</text>
<text text-anchor="middle" x="6668" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6668" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_11_0&#45;&gt;tp_6_11 -->
<g id="edge666" class="edge">
<title>expert_6_11_0&#45;&gt;tp_6_11</title>
<path fill="none" stroke="black" d="M6668,-6590.28C6668,-6582.61 6668,-6573.65 6668,-6564.86"/>
<polygon fill="black" stroke="black" points="6671.5,-6564.7 6668,-6554.7 6664.5,-6564.7 6671.5,-6564.7"/>
</g>
<!-- expert_6_11_1&#45;&gt;tp_6_11 -->
<g id="edge667" class="edge">
<title>expert_6_11_1&#45;&gt;tp_6_11</title>
<path fill="none" stroke="black" d="M6891.59,-6590.28C6850.13,-6578.04 6797.64,-6562.53 6753.93,-6549.63"/>
<polygon fill="black" stroke="black" points="6754.75,-6546.22 6744.17,-6546.75 6752.77,-6552.93 6754.75,-6546.22"/>
</g>
<!-- tp_6_11&#45;&gt;agg_6 -->
<g id="edge668" class="edge">
<title>tp_6_11&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M6556.21,-6514.69C6462.03,-6508.39 6323.73,-6499.33 6203,-6492.14 5781.96,-6467.06 5292.09,-6441.09 5002.26,-6426.06"/>
<polygon fill="black" stroke="black" points="5002.2,-6422.55 4992.03,-6425.53 5001.84,-6429.55 5002.2,-6422.55"/>
</g>
<!-- expert_6_12_0 -->
<g id="node461" class="node">
<title>expert_6_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7396.5,-6634.37 7119.5,-6634.37 7119.5,-6590.37 7396.5,-6590.37 7396.5,-6634.37"/>
<text text-anchor="middle" x="7258" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7258" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 216</text>
<text text-anchor="middle" x="7258" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7258" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_12&#45;&gt;expert_6_12_0 -->
<g id="edge670" class="edge">
<title>route_6_12&#45;&gt;expert_6_12_0</title>
<path fill="none" stroke="black" d="M7258,-6670.01C7258,-6661.73 7258,-6652.76 7258,-6644.44"/>
<polygon fill="black" stroke="black" points="7261.5,-6644.37 7258,-6634.37 7254.5,-6644.37 7261.5,-6644.37"/>
</g>
<!-- expert_6_12_1 -->
<g id="node462" class="node">
<title>expert_6_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7691.5,-6634.37 7414.5,-6634.37 7414.5,-6590.37 7691.5,-6590.37 7691.5,-6634.37"/>
<text text-anchor="middle" x="7553" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7553" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 217</text>
<text text-anchor="middle" x="7553" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7553" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_12&#45;&gt;expert_6_12_1 -->
<g id="edge671" class="edge">
<title>route_6_12&#45;&gt;expert_6_12_1</title>
<path fill="none" stroke="black" d="M7348.92,-6673.63C7388.08,-6662.07 7433.51,-6648.65 7471.56,-6637.42"/>
<polygon fill="black" stroke="black" points="7472.97,-6640.65 7481.57,-6634.46 7470.99,-6633.93 7472.97,-6640.65"/>
</g>
<!-- tp_6_12 -->
<g id="node463" class="node">
<title>tp_6_12</title>
<ellipse fill="lightblue" stroke="black" cx="7258" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7258" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7258" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 216↔217</text>
<text text-anchor="middle" x="7258" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7258" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_12_0&#45;&gt;tp_6_12 -->
<g id="edge672" class="edge">
<title>expert_6_12_0&#45;&gt;tp_6_12</title>
<path fill="none" stroke="black" d="M7258,-6590.28C7258,-6582.61 7258,-6573.65 7258,-6564.86"/>
<polygon fill="black" stroke="black" points="7261.5,-6564.7 7258,-6554.7 7254.5,-6564.7 7261.5,-6564.7"/>
</g>
<!-- expert_6_12_1&#45;&gt;tp_6_12 -->
<g id="edge673" class="edge">
<title>expert_6_12_1&#45;&gt;tp_6_12</title>
<path fill="none" stroke="black" d="M7481.59,-6590.28C7440.13,-6578.04 7387.64,-6562.53 7343.93,-6549.63"/>
<polygon fill="black" stroke="black" points="7344.75,-6546.22 7334.17,-6546.75 7342.77,-6552.93 7344.75,-6546.22"/>
</g>
<!-- tp_6_12&#45;&gt;agg_6 -->
<g id="edge674" class="edge">
<title>tp_6_12&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M7146.71,-6514.23C7052.54,-6507.64 6913.98,-6498.4 6793,-6492.14 6144.3,-6458.6 5379.04,-6432.64 4995.37,-6420.57"/>
<polygon fill="black" stroke="black" points="4995.36,-6417.06 4985.26,-6420.25 4995.14,-6424.06 4995.36,-6417.06"/>
</g>
<!-- expert_6_13_0 -->
<g id="node465" class="node">
<title>expert_6_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7986.5,-6634.37 7709.5,-6634.37 7709.5,-6590.37 7986.5,-6590.37 7986.5,-6634.37"/>
<text text-anchor="middle" x="7848" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7848" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 218</text>
<text text-anchor="middle" x="7848" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7848" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_13&#45;&gt;expert_6_13_0 -->
<g id="edge676" class="edge">
<title>route_6_13&#45;&gt;expert_6_13_0</title>
<path fill="none" stroke="black" d="M7848,-6670.01C7848,-6661.73 7848,-6652.76 7848,-6644.44"/>
<polygon fill="black" stroke="black" points="7851.5,-6644.37 7848,-6634.37 7844.5,-6644.37 7851.5,-6644.37"/>
</g>
<!-- expert_6_13_1 -->
<g id="node466" class="node">
<title>expert_6_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8281.5,-6634.37 8004.5,-6634.37 8004.5,-6590.37 8281.5,-6590.37 8281.5,-6634.37"/>
<text text-anchor="middle" x="8143" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8143" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 219</text>
<text text-anchor="middle" x="8143" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8143" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_13&#45;&gt;expert_6_13_1 -->
<g id="edge677" class="edge">
<title>route_6_13&#45;&gt;expert_6_13_1</title>
<path fill="none" stroke="black" d="M7938.92,-6673.63C7978.08,-6662.07 8023.51,-6648.65 8061.56,-6637.42"/>
<polygon fill="black" stroke="black" points="8062.97,-6640.65 8071.57,-6634.46 8060.99,-6633.93 8062.97,-6640.65"/>
</g>
<!-- tp_6_13 -->
<g id="node467" class="node">
<title>tp_6_13</title>
<ellipse fill="lightblue" stroke="black" cx="7848" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7848" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7848" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 218↔219</text>
<text text-anchor="middle" x="7848" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7848" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_13_0&#45;&gt;tp_6_13 -->
<g id="edge678" class="edge">
<title>expert_6_13_0&#45;&gt;tp_6_13</title>
<path fill="none" stroke="black" d="M7848,-6590.28C7848,-6582.61 7848,-6573.65 7848,-6564.86"/>
<polygon fill="black" stroke="black" points="7851.5,-6564.7 7848,-6554.7 7844.5,-6564.7 7851.5,-6564.7"/>
</g>
<!-- expert_6_13_1&#45;&gt;tp_6_13 -->
<g id="edge679" class="edge">
<title>expert_6_13_1&#45;&gt;tp_6_13</title>
<path fill="none" stroke="black" d="M8071.59,-6590.28C8030.13,-6578.04 7977.64,-6562.53 7933.93,-6549.63"/>
<polygon fill="black" stroke="black" points="7934.75,-6546.22 7924.17,-6546.75 7932.77,-6552.93 7934.75,-6546.22"/>
</g>
<!-- tp_6_13&#45;&gt;agg_6 -->
<g id="edge680" class="edge">
<title>tp_6_13&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M7737.2,-6513.99C7643.02,-6507.23 7504.21,-6497.88 7383,-6492.14 6502.43,-6450.43 5455.09,-6426.74 4991.4,-6417.58"/>
<polygon fill="black" stroke="black" points="4991.3,-6414.08 4981.24,-6417.38 4991.17,-6421.08 4991.3,-6414.08"/>
</g>
<!-- expert_6_14_0 -->
<g id="node469" class="node">
<title>expert_6_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8576.5,-6634.37 8299.5,-6634.37 8299.5,-6590.37 8576.5,-6590.37 8576.5,-6634.37"/>
<text text-anchor="middle" x="8438" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8438" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 220</text>
<text text-anchor="middle" x="8438" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8438" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_14&#45;&gt;expert_6_14_0 -->
<g id="edge682" class="edge">
<title>route_6_14&#45;&gt;expert_6_14_0</title>
<path fill="none" stroke="black" d="M8438,-6670.01C8438,-6661.73 8438,-6652.76 8438,-6644.44"/>
<polygon fill="black" stroke="black" points="8441.5,-6644.37 8438,-6634.37 8434.5,-6644.37 8441.5,-6644.37"/>
</g>
<!-- expert_6_14_1 -->
<g id="node470" class="node">
<title>expert_6_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8871.5,-6634.37 8594.5,-6634.37 8594.5,-6590.37 8871.5,-6590.37 8871.5,-6634.37"/>
<text text-anchor="middle" x="8733" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8733" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 221</text>
<text text-anchor="middle" x="8733" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8733" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_14&#45;&gt;expert_6_14_1 -->
<g id="edge683" class="edge">
<title>route_6_14&#45;&gt;expert_6_14_1</title>
<path fill="none" stroke="black" d="M8528.92,-6673.63C8568.08,-6662.07 8613.51,-6648.65 8651.56,-6637.42"/>
<polygon fill="black" stroke="black" points="8652.97,-6640.65 8661.57,-6634.46 8650.99,-6633.93 8652.97,-6640.65"/>
</g>
<!-- tp_6_14 -->
<g id="node471" class="node">
<title>tp_6_14</title>
<ellipse fill="lightblue" stroke="black" cx="8438" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8438" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8438" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 220↔221</text>
<text text-anchor="middle" x="8438" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8438" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_14_0&#45;&gt;tp_6_14 -->
<g id="edge684" class="edge">
<title>expert_6_14_0&#45;&gt;tp_6_14</title>
<path fill="none" stroke="black" d="M8438,-6590.28C8438,-6582.61 8438,-6573.65 8438,-6564.86"/>
<polygon fill="black" stroke="black" points="8441.5,-6564.7 8438,-6554.7 8434.5,-6564.7 8441.5,-6564.7"/>
</g>
<!-- expert_6_14_1&#45;&gt;tp_6_14 -->
<g id="edge685" class="edge">
<title>expert_6_14_1&#45;&gt;tp_6_14</title>
<path fill="none" stroke="black" d="M8661.59,-6590.28C8620.13,-6578.04 8567.64,-6562.53 8523.93,-6549.63"/>
<polygon fill="black" stroke="black" points="8524.75,-6546.22 8514.17,-6546.75 8522.77,-6552.93 8524.75,-6546.22"/>
</g>
<!-- tp_6_14&#45;&gt;agg_6 -->
<g id="edge686" class="edge">
<title>tp_6_14&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8327.2,-6513.82C8233.04,-6506.96 8094.23,-6497.55 7973,-6492.14 6857.96,-6442.39 5524.42,-6422.21 4989.36,-6415.72"/>
<polygon fill="black" stroke="black" points="4989.25,-6412.22 4979.21,-6415.6 4989.16,-6419.22 4989.25,-6412.22"/>
</g>
<!-- expert_6_15_0 -->
<g id="node473" class="node">
<title>expert_6_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9166.5,-6634.37 8889.5,-6634.37 8889.5,-6590.37 9166.5,-6590.37 9166.5,-6634.37"/>
<text text-anchor="middle" x="9028" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9028" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 222</text>
<text text-anchor="middle" x="9028" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9028" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_15&#45;&gt;expert_6_15_0 -->
<g id="edge688" class="edge">
<title>route_6_15&#45;&gt;expert_6_15_0</title>
<path fill="none" stroke="black" d="M9028,-6670.01C9028,-6661.73 9028,-6652.76 9028,-6644.44"/>
<polygon fill="black" stroke="black" points="9031.5,-6644.37 9028,-6634.37 9024.5,-6644.37 9031.5,-6644.37"/>
</g>
<!-- expert_6_15_1 -->
<g id="node474" class="node">
<title>expert_6_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9461.5,-6634.37 9184.5,-6634.37 9184.5,-6590.37 9461.5,-6590.37 9461.5,-6634.37"/>
<text text-anchor="middle" x="9323" y="-6625.17" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9323" y="-6615.17" font-family="Times,serif" font-size="9.00">GPU: 223</text>
<text text-anchor="middle" x="9323" y="-6605.17" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9323" y="-6595.17" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_6_15&#45;&gt;expert_6_15_1 -->
<g id="edge689" class="edge">
<title>route_6_15&#45;&gt;expert_6_15_1</title>
<path fill="none" stroke="black" d="M9118.92,-6673.63C9158.08,-6662.07 9203.51,-6648.65 9241.56,-6637.42"/>
<polygon fill="black" stroke="black" points="9242.97,-6640.65 9251.57,-6634.46 9240.99,-6633.93 9242.97,-6640.65"/>
</g>
<!-- tp_6_15 -->
<g id="node475" class="node">
<title>tp_6_15</title>
<ellipse fill="lightblue" stroke="black" cx="9028" cy="-6523.25" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9028" y="-6536.05" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9028" y="-6526.05" font-family="Times,serif" font-size="9.00">GPU: 222↔223</text>
<text text-anchor="middle" x="9028" y="-6516.05" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9028" y="-6506.05" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_6_15_0&#45;&gt;tp_6_15 -->
<g id="edge690" class="edge">
<title>expert_6_15_0&#45;&gt;tp_6_15</title>
<path fill="none" stroke="black" d="M9028,-6590.28C9028,-6582.61 9028,-6573.65 9028,-6564.86"/>
<polygon fill="black" stroke="black" points="9031.5,-6564.7 9028,-6554.7 9024.5,-6564.7 9031.5,-6564.7"/>
</g>
<!-- expert_6_15_1&#45;&gt;tp_6_15 -->
<g id="edge691" class="edge">
<title>expert_6_15_1&#45;&gt;tp_6_15</title>
<path fill="none" stroke="black" d="M9251.59,-6590.28C9210.13,-6578.04 9157.64,-6562.53 9113.93,-6549.63"/>
<polygon fill="black" stroke="black" points="9114.75,-6546.22 9104.17,-6546.75 9112.77,-6552.93 9114.75,-6546.22"/>
</g>
<!-- tp_6_15&#45;&gt;agg_6 -->
<g id="edge692" class="edge">
<title>tp_6_15&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8917.21,-6513.7C8823.04,-6506.77 8684.24,-6497.32 8563,-6492.14 7210.8,-6434.38 5586.99,-6418.49 4987.41,-6414.43"/>
<polygon fill="black" stroke="black" points="4987.38,-6410.93 4977.35,-6414.37 4987.33,-6417.93 4987.38,-6410.93"/>
</g>
<!-- output_6 -->
<g id="node477" class="node">
<title>output_6</title>
<polygon fill="lightgreen" stroke="black" points="4898,-6332.14 4602,-6332.14 4602,-6288.14 4898,-6288.14 4898,-6332.14"/>
<text text-anchor="middle" x="4750" y="-6322.94" font-family="Times,serif" font-size="9.00">Layer 6 Output</text>
<text text-anchor="middle" x="4750" y="-6312.94" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4750" y="-6302.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4750" y="-6292.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_6&#45;&gt;output_6 -->
<g id="edge693" class="edge">
<title>agg_6&#45;&gt;output_6</title>
<path fill="none" stroke="black" d="M4750,-6367.86C4750,-6359.27 4750,-6350.41 4750,-6342.33"/>
<polygon fill="black" stroke="black" points="4753.5,-6342.22 4750,-6332.22 4746.5,-6342.22 4753.5,-6342.22"/>
</g>
<!-- mha_7 -->
<g id="node478" class="node">
<title>mha_7</title>
<polygon fill="lightgreen" stroke="black" points="4898,-6252.14 4602,-6252.14 4602,-6208.14 4898,-6208.14 4898,-6252.14"/>
<text text-anchor="middle" x="4750" y="-6242.94" font-family="Times,serif" font-size="9.00">MHA L7</text>
<text text-anchor="middle" x="4750" y="-6232.94" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4750" y="-6222.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4750" y="-6212.94" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_6&#45;&gt;mha_7 -->
<g id="edge694" class="edge">
<title>output_6&#45;&gt;mha_7</title>
<path fill="none" stroke="black" d="M4750,-6287.83C4750,-6279.94 4750,-6270.82 4750,-6262.24"/>
<polygon fill="black" stroke="black" points="4753.5,-6262.16 4750,-6252.16 4746.5,-6262.16 4753.5,-6262.16"/>
</g>
<!-- gate_7 -->
<g id="node479" class="node">
<title>gate_7</title>
<polygon fill="lightyellow" stroke="black" points="5049.74,-6172.14 4572.92,-6172.14 4450.26,-6084.14 4927.08,-6084.14 5049.74,-6172.14"/>
<text text-anchor="middle" x="4750" y="-6140.94" font-family="Times,serif" font-size="9.00">Gate L7</text>
<text text-anchor="middle" x="4750" y="-6130.94" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4750" y="-6120.94" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4750" y="-6110.94" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_7&#45;&gt;gate_7 -->
<g id="edge695" class="edge">
<title>mha_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M4750,-6207.93C4750,-6200.43 4750,-6191.63 4750,-6182.67"/>
<polygon fill="black" stroke="black" points="4753.5,-6182.55 4750,-6172.55 4746.5,-6182.55 4753.5,-6182.55"/>
</g>
<!-- route_7_0 -->
<g id="node480" class="node">
<title>route_7_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="473" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="473" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="473" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 224,225</text>
<text text-anchor="middle" x="473" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="473" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_0 -->
<g id="edge696" class="edge">
<title>gate_7&#45;&gt;route_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4510.09,-6127.18C3899.43,-6126.22 2236.63,-6116.93 853,-6048.14 787.75,-6044.9 716.32,-6039.68 653.17,-6034.49"/>
<polygon fill="black" stroke="black" points="653.36,-6030.99 643.11,-6033.65 652.79,-6037.97 653.36,-6030.99"/>
</g>
<!-- route_7_1 -->
<g id="node484" class="node">
<title>route_7_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1063" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1063" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1063" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 226,227</text>
<text text-anchor="middle" x="1063" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1063" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_1 -->
<g id="edge702" class="edge">
<title>gate_7&#45;&gt;route_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4508.4,-6125.93C3961.99,-6122.2 2589.53,-6107.22 1443,-6048.14 1377.91,-6044.79 1306.67,-6039.56 1243.63,-6034.39"/>
<polygon fill="black" stroke="black" points="1243.84,-6030.9 1233.59,-6033.56 1243.27,-6037.87 1243.84,-6030.9"/>
</g>
<!-- route_7_2 -->
<g id="node488" class="node">
<title>route_7_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1653" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1653" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1653" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 228,229</text>
<text text-anchor="middle" x="1653" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1653" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_2 -->
<g id="edge708" class="edge">
<title>gate_7&#45;&gt;route_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4505.82,-6124.13C4029.8,-6117.36 2944.5,-6097.48 2033,-6048.14 1968.08,-6044.63 1897.02,-6039.37 1834.1,-6034.24"/>
<polygon fill="black" stroke="black" points="1834.32,-6030.74 1824.07,-6033.41 1833.75,-6037.72 1834.32,-6030.74"/>
</g>
<!-- route_7_3 -->
<g id="node492" class="node">
<title>route_7_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2243" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2243" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2243" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 230,231</text>
<text text-anchor="middle" x="2243" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2243" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_3 -->
<g id="edge714" class="edge">
<title>gate_7&#45;&gt;route_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4501.78,-6121.3C4104.71,-6111.19 3302.24,-6087.65 2623,-6048.14 2558.41,-6044.38 2487.73,-6039.1 2425.03,-6034.01"/>
<polygon fill="black" stroke="black" points="2425.29,-6030.52 2415.04,-6033.2 2424.72,-6037.5 2425.29,-6030.52"/>
</g>
<!-- route_7_4 -->
<g id="node496" class="node">
<title>route_7_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2833" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2833" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2833" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 232,233</text>
<text text-anchor="middle" x="2833" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2833" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_4 -->
<g id="edge720" class="edge">
<title>gate_7&#45;&gt;route_7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4494.91,-6116.2C4189.88,-6102.61 3663.93,-6077.59 3213,-6048.14 3149.04,-6043.96 3079.08,-6038.64 3016.82,-6033.63"/>
<polygon fill="black" stroke="black" points="3016.74,-6030.11 3006.49,-6032.79 3016.18,-6037.09 3016.74,-6030.11"/>
</g>
<!-- route_7_5 -->
<g id="node500" class="node">
<title>route_7_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3423" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3423" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3423" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 234,235</text>
<text text-anchor="middle" x="3423" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3423" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_5 -->
<g id="edge726" class="edge">
<title>gate_7&#45;&gt;route_7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4479.06,-6104.86C4219.32,-6083.5 3834.23,-6051.84 3607.92,-6033.23"/>
<polygon fill="black" stroke="black" points="3608.18,-6029.74 3597.93,-6032.41 3607.61,-6036.72 3608.18,-6029.74"/>
</g>
<!-- route_7_6 -->
<g id="node504" class="node">
<title>route_7_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4013" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4013" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4013" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 236,237</text>
<text text-anchor="middle" x="4013" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4013" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_6 -->
<g id="edge732" class="edge">
<title>gate_7&#45;&gt;route_7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4459.51,-6084.13C4358.8,-6069.22 4249.94,-6053.11 4164.92,-6040.52"/>
<polygon fill="black" stroke="black" points="4165.34,-6037.04 4154.93,-6039.04 4164.31,-6043.97 4165.34,-6037.04"/>
</g>
<!-- route_7_7 -->
<g id="node508" class="node">
<title>route_7_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4541" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4541" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4541" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 238,239</text>
<text text-anchor="middle" x="4541" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4541" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_7 -->
<g id="edge738" class="edge">
<title>gate_7&#45;&gt;route_7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4667.4,-6084.02C4646.91,-6073.32 4625.25,-6062.01 4605.75,-6051.83"/>
<polygon fill="black" stroke="black" points="4607.15,-6048.61 4596.67,-6047.09 4603.91,-6054.82 4607.15,-6048.61"/>
</g>
<!-- route_7_8 -->
<g id="node512" class="node">
<title>route_7_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4961" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4961" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4961" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 240,241</text>
<text text-anchor="middle" x="4961" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4961" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_8 -->
<g id="edge744" class="edge">
<title>gate_7&#45;&gt;route_7_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4833.39,-6084.02C4854.27,-6073.22 4876.36,-6061.8 4896.18,-6051.55"/>
<polygon fill="black" stroke="black" points="4897.84,-6054.63 4905.12,-6046.93 4894.63,-6048.41 4897.84,-6054.63"/>
</g>
<!-- route_7_9 -->
<g id="node516" class="node">
<title>route_7_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5488" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5488" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5488" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 242,243</text>
<text text-anchor="middle" x="5488" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5488" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_9 -->
<g id="edge750" class="edge">
<title>gate_7&#45;&gt;route_7_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4946.8,-6098.04C5068.76,-6080.01 5223.08,-6057.2 5335.69,-6040.55"/>
<polygon fill="black" stroke="black" points="5336.39,-6043.98 5345.77,-6039.06 5335.37,-6037.06 5336.39,-6043.98"/>
</g>
<!-- route_7_10 -->
<g id="node520" class="node">
<title>route_7_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6078" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6078" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6078" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 244,245</text>
<text text-anchor="middle" x="6078" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6078" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_10 -->
<g id="edge756" class="edge">
<title>gate_7&#45;&gt;route_7_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4963,-6109.64C5220.37,-6088.49 5649.14,-6053.26 5893.18,-6033.21"/>
<polygon fill="black" stroke="black" points="5893.54,-6036.7 5903.22,-6032.39 5892.96,-6029.72 5893.54,-6036.7"/>
</g>
<!-- route_7_11 -->
<g id="node524" class="node">
<title>route_7_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6668" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6668" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6668" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 246,247</text>
<text text-anchor="middle" x="6668" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6668" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_11 -->
<g id="edge762" class="edge">
<title>gate_7&#45;&gt;route_7_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4973.94,-6117.59C5273.44,-6104.37 5820.94,-6078.64 6288,-6048.14 6351.96,-6043.96 6421.92,-6038.64 6484.18,-6033.63"/>
<polygon fill="black" stroke="black" points="6484.82,-6037.09 6494.51,-6032.8 6484.26,-6030.11 6484.82,-6037.09"/>
</g>
<!-- route_7_12 -->
<g id="node528" class="node">
<title>route_7_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7258" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7258" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7258" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 248,249</text>
<text text-anchor="middle" x="7258" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7258" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_12 -->
<g id="edge768" class="edge">
<title>gate_7&#45;&gt;route_7_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4979.64,-6121.77C5369.94,-6111.95 6187.6,-6088.29 6878,-6048.14 6942.59,-6044.38 7013.27,-6039.1 7075.97,-6034.01"/>
<polygon fill="black" stroke="black" points="7076.28,-6037.5 7085.96,-6033.2 7075.71,-6030.52 7076.28,-6037.5"/>
</g>
<!-- route_7_13 -->
<g id="node532" class="node">
<title>route_7_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7848" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7848" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7848" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 250,251</text>
<text text-anchor="middle" x="7848" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7848" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_13 -->
<g id="edge774" class="edge">
<title>gate_7&#45;&gt;route_7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4983.3,-6124.29C5453.62,-6117.67 6549.09,-6097.87 7468,-6048.14 7532.92,-6044.63 7603.98,-6039.38 7666.9,-6034.24"/>
<polygon fill="black" stroke="black" points="7667.25,-6037.72 7676.93,-6033.41 7666.68,-6030.74 7667.25,-6037.72"/>
</g>
<!-- route_7_14 -->
<g id="node536" class="node">
<title>route_7_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8438" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8438" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8438" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 252,253</text>
<text text-anchor="middle" x="8438" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8438" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_14 -->
<g id="edge780" class="edge">
<title>gate_7&#45;&gt;route_7_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4985.56,-6125.98C5527.95,-6122.32 6906.82,-6107.45 8058,-6048.14 8123.09,-6044.79 8194.33,-6039.56 8257.37,-6034.39"/>
<polygon fill="black" stroke="black" points="8257.73,-6037.87 8267.41,-6033.56 8257.16,-6030.9 8257.73,-6037.87"/>
</g>
<!-- route_7_15 -->
<g id="node540" class="node">
<title>route_7_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9028" cy="-6017.03" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9028" y="-6029.83" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9028" y="-6019.83" font-family="Times,serif" font-size="9.00">GPU: 254,255</text>
<text text-anchor="middle" x="9028" y="-6009.83" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9028" y="-5999.83" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_7&#45;&gt;route_7_15 -->
<g id="edge786" class="edge">
<title>gate_7&#45;&gt;route_7_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4987.19,-6127.19C5595.71,-6126.25 7261.91,-6117.05 8648,-6048.14 8713.25,-6044.9 8784.68,-6039.68 8847.83,-6034.49"/>
<polygon fill="black" stroke="black" points="8848.21,-6037.97 8857.89,-6033.65 8847.64,-6030.99 8848.21,-6037.97"/>
</g>
<!-- expert_7_0_0 -->
<g id="node481" class="node">
<title>expert_7_0_0</title>
<polygon fill="lightgreen" stroke="black" points="316.5,-5949.92 39.5,-5949.92 39.5,-5905.92 316.5,-5905.92 316.5,-5949.92"/>
<text text-anchor="middle" x="178" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="178" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 224</text>
<text text-anchor="middle" x="178" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="178" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_0&#45;&gt;expert_7_0_0 -->
<g id="edge697" class="edge">
<title>route_7_0&#45;&gt;expert_7_0_0</title>
<path fill="none" stroke="black" d="M382.08,-5989.18C342.92,-5977.62 297.49,-5964.2 259.44,-5952.96"/>
<polygon fill="black" stroke="black" points="260.01,-5949.48 249.43,-5950.01 258.03,-5956.2 260.01,-5949.48"/>
</g>
<!-- expert_7_0_1 -->
<g id="node482" class="node">
<title>expert_7_0_1</title>
<polygon fill="lightgreen" stroke="black" points="611.5,-5949.92 334.5,-5949.92 334.5,-5905.92 611.5,-5905.92 611.5,-5949.92"/>
<text text-anchor="middle" x="473" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="473" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 225</text>
<text text-anchor="middle" x="473" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="473" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_0&#45;&gt;expert_7_0_1 -->
<g id="edge698" class="edge">
<title>route_7_0&#45;&gt;expert_7_0_1</title>
<path fill="none" stroke="black" d="M473,-5985.56C473,-5977.28 473,-5968.31 473,-5959.99"/>
<polygon fill="black" stroke="black" points="476.5,-5959.92 473,-5949.92 469.5,-5959.92 476.5,-5959.92"/>
</g>
<!-- tp_7_0 -->
<g id="node483" class="node">
<title>tp_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="473" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="473" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="473" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 224↔225</text>
<text text-anchor="middle" x="473" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="473" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_0_0&#45;&gt;tp_7_0 -->
<g id="edge699" class="edge">
<title>expert_7_0_0&#45;&gt;tp_7_0</title>
<path fill="none" stroke="black" d="M249.41,-5905.83C290.87,-5893.59 343.36,-5878.08 387.07,-5865.18"/>
<polygon fill="black" stroke="black" points="388.23,-5868.48 396.83,-5862.3 386.25,-5861.77 388.23,-5868.48"/>
</g>
<!-- expert_7_0_1&#45;&gt;tp_7_0 -->
<g id="edge700" class="edge">
<title>expert_7_0_1&#45;&gt;tp_7_0</title>
<path fill="none" stroke="black" d="M473,-5905.83C473,-5898.15 473,-5889.2 473,-5880.41"/>
<polygon fill="black" stroke="black" points="476.5,-5880.25 473,-5870.25 469.5,-5880.25 476.5,-5880.25"/>
</g>
<!-- agg_7 -->
<g id="node544" class="node">
<title>agg_7</title>
<polygon fill="lightyellow" stroke="black" points="4906.99,-5771.69 4458.4,-5771.69 4343.01,-5683.69 4791.6,-5683.69 4906.99,-5771.69"/>
<text text-anchor="middle" x="4625" y="-5740.49" font-family="Times,serif" font-size="9.00">Aggregate Experts L7</text>
<text text-anchor="middle" x="4625" y="-5730.49" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4625" y="-5720.49" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4625" y="-5710.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_7_0&#45;&gt;agg_7 -->
<g id="edge701" class="edge">
<title>tp_7_0&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M583.79,-5829.28C677.96,-5822.35 816.77,-5812.91 938,-5807.69 2244.2,-5751.43 3812.51,-5734.66 4393.68,-5730.17"/>
<polygon fill="black" stroke="black" points="4393.88,-5733.67 4403.85,-5730.1 4393.83,-5726.67 4393.88,-5733.67"/>
</g>
<!-- expert_7_1_0 -->
<g id="node485" class="node">
<title>expert_7_1_0</title>
<polygon fill="lightgreen" stroke="black" points="906.5,-5949.92 629.5,-5949.92 629.5,-5905.92 906.5,-5905.92 906.5,-5949.92"/>
<text text-anchor="middle" x="768" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="768" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 226</text>
<text text-anchor="middle" x="768" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="768" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_1&#45;&gt;expert_7_1_0 -->
<g id="edge703" class="edge">
<title>route_7_1&#45;&gt;expert_7_1_0</title>
<path fill="none" stroke="black" d="M972.08,-5989.18C932.92,-5977.62 887.49,-5964.2 849.44,-5952.96"/>
<polygon fill="black" stroke="black" points="850.01,-5949.48 839.43,-5950.01 848.03,-5956.2 850.01,-5949.48"/>
</g>
<!-- expert_7_1_1 -->
<g id="node486" class="node">
<title>expert_7_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1201.5,-5949.92 924.5,-5949.92 924.5,-5905.92 1201.5,-5905.92 1201.5,-5949.92"/>
<text text-anchor="middle" x="1063" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1063" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 227</text>
<text text-anchor="middle" x="1063" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1063" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_1&#45;&gt;expert_7_1_1 -->
<g id="edge704" class="edge">
<title>route_7_1&#45;&gt;expert_7_1_1</title>
<path fill="none" stroke="black" d="M1063,-5985.56C1063,-5977.28 1063,-5968.31 1063,-5959.99"/>
<polygon fill="black" stroke="black" points="1066.5,-5959.92 1063,-5949.92 1059.5,-5959.92 1066.5,-5959.92"/>
</g>
<!-- tp_7_1 -->
<g id="node487" class="node">
<title>tp_7_1</title>
<ellipse fill="lightblue" stroke="black" cx="1063" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1063" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1063" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 226↔227</text>
<text text-anchor="middle" x="1063" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1063" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_1_0&#45;&gt;tp_7_1 -->
<g id="edge705" class="edge">
<title>expert_7_1_0&#45;&gt;tp_7_1</title>
<path fill="none" stroke="black" d="M839.41,-5905.83C880.87,-5893.59 933.36,-5878.08 977.07,-5865.18"/>
<polygon fill="black" stroke="black" points="978.23,-5868.48 986.83,-5862.3 976.25,-5861.77 978.23,-5868.48"/>
</g>
<!-- expert_7_1_1&#45;&gt;tp_7_1 -->
<g id="edge706" class="edge">
<title>expert_7_1_1&#45;&gt;tp_7_1</title>
<path fill="none" stroke="black" d="M1063,-5905.83C1063,-5898.15 1063,-5889.2 1063,-5880.41"/>
<polygon fill="black" stroke="black" points="1066.5,-5880.25 1063,-5870.25 1059.5,-5880.25 1066.5,-5880.25"/>
</g>
<!-- tp_7_1&#45;&gt;agg_7 -->
<g id="edge707" class="edge">
<title>tp_7_1&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1173.8,-5829.4C1267.97,-5822.56 1406.78,-5813.16 1528,-5807.69 2599.52,-5759.35 3881.03,-5738.38 4395.1,-5731.48"/>
<polygon fill="black" stroke="black" points="4395.28,-5734.97 4405.23,-5731.34 4395.18,-5727.97 4395.28,-5734.97"/>
</g>
<!-- expert_7_2_0 -->
<g id="node489" class="node">
<title>expert_7_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1496.5,-5949.92 1219.5,-5949.92 1219.5,-5905.92 1496.5,-5905.92 1496.5,-5949.92"/>
<text text-anchor="middle" x="1358" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1358" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 228</text>
<text text-anchor="middle" x="1358" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1358" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_2&#45;&gt;expert_7_2_0 -->
<g id="edge709" class="edge">
<title>route_7_2&#45;&gt;expert_7_2_0</title>
<path fill="none" stroke="black" d="M1562.08,-5989.18C1522.92,-5977.62 1477.49,-5964.2 1439.44,-5952.96"/>
<polygon fill="black" stroke="black" points="1440.01,-5949.48 1429.43,-5950.01 1438.03,-5956.2 1440.01,-5949.48"/>
</g>
<!-- expert_7_2_1 -->
<g id="node490" class="node">
<title>expert_7_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1791.5,-5949.92 1514.5,-5949.92 1514.5,-5905.92 1791.5,-5905.92 1791.5,-5949.92"/>
<text text-anchor="middle" x="1653" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1653" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 229</text>
<text text-anchor="middle" x="1653" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1653" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_2&#45;&gt;expert_7_2_1 -->
<g id="edge710" class="edge">
<title>route_7_2&#45;&gt;expert_7_2_1</title>
<path fill="none" stroke="black" d="M1653,-5985.56C1653,-5977.28 1653,-5968.31 1653,-5959.99"/>
<polygon fill="black" stroke="black" points="1656.5,-5959.92 1653,-5949.92 1649.5,-5959.92 1656.5,-5959.92"/>
</g>
<!-- tp_7_2 -->
<g id="node491" class="node">
<title>tp_7_2</title>
<ellipse fill="lightblue" stroke="black" cx="1653" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1653" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1653" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 228↔229</text>
<text text-anchor="middle" x="1653" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1653" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_2_0&#45;&gt;tp_7_2 -->
<g id="edge711" class="edge">
<title>expert_7_2_0&#45;&gt;tp_7_2</title>
<path fill="none" stroke="black" d="M1429.41,-5905.83C1470.87,-5893.59 1523.36,-5878.08 1567.07,-5865.18"/>
<polygon fill="black" stroke="black" points="1568.23,-5868.48 1576.83,-5862.3 1566.25,-5861.77 1568.23,-5868.48"/>
</g>
<!-- expert_7_2_1&#45;&gt;tp_7_2 -->
<g id="edge712" class="edge">
<title>expert_7_2_1&#45;&gt;tp_7_2</title>
<path fill="none" stroke="black" d="M1653,-5905.83C1653,-5898.15 1653,-5889.2 1653,-5880.41"/>
<polygon fill="black" stroke="black" points="1656.5,-5880.25 1653,-5870.25 1649.5,-5880.25 1656.5,-5880.25"/>
</g>
<!-- tp_7_2&#45;&gt;agg_7 -->
<g id="edge713" class="edge">
<title>tp_7_2&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M1763.81,-5829.59C1857.98,-5822.86 1996.79,-5813.52 2118,-5807.69 2957.92,-5767.27 3957.17,-5742.88 4397.48,-5733.33"/>
<polygon fill="black" stroke="black" points="4397.85,-5736.83 4407.77,-5733.11 4397.7,-5729.83 4397.85,-5736.83"/>
</g>
<!-- expert_7_3_0 -->
<g id="node493" class="node">
<title>expert_7_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2086.5,-5949.92 1809.5,-5949.92 1809.5,-5905.92 2086.5,-5905.92 2086.5,-5949.92"/>
<text text-anchor="middle" x="1948" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1948" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 230</text>
<text text-anchor="middle" x="1948" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1948" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_3&#45;&gt;expert_7_3_0 -->
<g id="edge715" class="edge">
<title>route_7_3&#45;&gt;expert_7_3_0</title>
<path fill="none" stroke="black" d="M2152.08,-5989.18C2112.92,-5977.62 2067.49,-5964.2 2029.44,-5952.96"/>
<polygon fill="black" stroke="black" points="2030.01,-5949.48 2019.43,-5950.01 2028.03,-5956.2 2030.01,-5949.48"/>
</g>
<!-- expert_7_3_1 -->
<g id="node494" class="node">
<title>expert_7_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2381.5,-5949.92 2104.5,-5949.92 2104.5,-5905.92 2381.5,-5905.92 2381.5,-5949.92"/>
<text text-anchor="middle" x="2243" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2243" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 231</text>
<text text-anchor="middle" x="2243" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2243" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_3&#45;&gt;expert_7_3_1 -->
<g id="edge716" class="edge">
<title>route_7_3&#45;&gt;expert_7_3_1</title>
<path fill="none" stroke="black" d="M2243,-5985.56C2243,-5977.28 2243,-5968.31 2243,-5959.99"/>
<polygon fill="black" stroke="black" points="2246.5,-5959.92 2243,-5949.92 2239.5,-5959.92 2246.5,-5959.92"/>
</g>
<!-- tp_7_3 -->
<g id="node495" class="node">
<title>tp_7_3</title>
<ellipse fill="lightblue" stroke="black" cx="2243" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2243" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2243" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 230↔231</text>
<text text-anchor="middle" x="2243" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2243" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_3_0&#45;&gt;tp_7_3 -->
<g id="edge717" class="edge">
<title>expert_7_3_0&#45;&gt;tp_7_3</title>
<path fill="none" stroke="black" d="M2019.41,-5905.83C2060.87,-5893.59 2113.36,-5878.08 2157.07,-5865.18"/>
<polygon fill="black" stroke="black" points="2158.23,-5868.48 2166.83,-5862.3 2156.25,-5861.77 2158.23,-5868.48"/>
</g>
<!-- expert_7_3_1&#45;&gt;tp_7_3 -->
<g id="edge718" class="edge">
<title>expert_7_3_1&#45;&gt;tp_7_3</title>
<path fill="none" stroke="black" d="M2243,-5905.83C2243,-5898.15 2243,-5889.2 2243,-5880.41"/>
<polygon fill="black" stroke="black" points="2246.5,-5880.25 2243,-5870.25 2239.5,-5880.25 2246.5,-5880.25"/>
</g>
<!-- tp_7_3&#45;&gt;agg_7 -->
<g id="edge719" class="edge">
<title>tp_7_3&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2354.29,-5829.86C2448.47,-5823.31 2587.02,-5814.1 2708,-5807.69 3320.18,-5775.26 4042.94,-5748.63 4400.87,-5736.22"/>
<polygon fill="black" stroke="black" points="4401.22,-5739.71 4411.1,-5735.86 4400.98,-5732.71 4401.22,-5739.71"/>
</g>
<!-- expert_7_4_0 -->
<g id="node497" class="node">
<title>expert_7_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2676.5,-5949.92 2399.5,-5949.92 2399.5,-5905.92 2676.5,-5905.92 2676.5,-5949.92"/>
<text text-anchor="middle" x="2538" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2538" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 232</text>
<text text-anchor="middle" x="2538" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2538" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_4&#45;&gt;expert_7_4_0 -->
<g id="edge721" class="edge">
<title>route_7_4&#45;&gt;expert_7_4_0</title>
<path fill="none" stroke="black" d="M2742.08,-5989.18C2702.92,-5977.62 2657.49,-5964.2 2619.44,-5952.96"/>
<polygon fill="black" stroke="black" points="2620.01,-5949.48 2609.43,-5950.01 2618.03,-5956.2 2620.01,-5949.48"/>
</g>
<!-- expert_7_4_1 -->
<g id="node498" class="node">
<title>expert_7_4_1</title>
<polygon fill="lightgreen" stroke="black" points="2971.5,-5949.92 2694.5,-5949.92 2694.5,-5905.92 2971.5,-5905.92 2971.5,-5949.92"/>
<text text-anchor="middle" x="2833" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2833" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 233</text>
<text text-anchor="middle" x="2833" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2833" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_4&#45;&gt;expert_7_4_1 -->
<g id="edge722" class="edge">
<title>route_7_4&#45;&gt;expert_7_4_1</title>
<path fill="none" stroke="black" d="M2833,-5985.56C2833,-5977.28 2833,-5968.31 2833,-5959.99"/>
<polygon fill="black" stroke="black" points="2836.5,-5959.92 2833,-5949.92 2829.5,-5959.92 2836.5,-5959.92"/>
</g>
<!-- tp_7_4 -->
<g id="node499" class="node">
<title>tp_7_4</title>
<ellipse fill="lightblue" stroke="black" cx="2833" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2833" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2833" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 232↔233</text>
<text text-anchor="middle" x="2833" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2833" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_4_0&#45;&gt;tp_7_4 -->
<g id="edge723" class="edge">
<title>expert_7_4_0&#45;&gt;tp_7_4</title>
<path fill="none" stroke="black" d="M2609.41,-5905.83C2650.87,-5893.59 2703.36,-5878.08 2747.07,-5865.18"/>
<polygon fill="black" stroke="black" points="2748.23,-5868.48 2756.83,-5862.3 2746.25,-5861.77 2748.23,-5868.48"/>
</g>
<!-- expert_7_4_1&#45;&gt;tp_7_4 -->
<g id="edge724" class="edge">
<title>expert_7_4_1&#45;&gt;tp_7_4</title>
<path fill="none" stroke="black" d="M2833,-5905.83C2833,-5898.15 2833,-5889.2 2833,-5880.41"/>
<polygon fill="black" stroke="black" points="2836.5,-5880.25 2833,-5870.25 2829.5,-5880.25 2836.5,-5880.25"/>
</g>
<!-- tp_7_4&#45;&gt;agg_7 -->
<g id="edge725" class="edge">
<title>tp_7_4&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M2944.8,-5830.4C3038.98,-5824.2 3177.29,-5815.19 3298,-5807.69 3688.88,-5783.4 4144.63,-5756.6 4407.5,-5741.29"/>
<polygon fill="black" stroke="black" points="4407.76,-5744.78 4417.54,-5740.71 4407.36,-5737.79 4407.76,-5744.78"/>
</g>
<!-- expert_7_5_0 -->
<g id="node501" class="node">
<title>expert_7_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3266.5,-5949.92 2989.5,-5949.92 2989.5,-5905.92 3266.5,-5905.92 3266.5,-5949.92"/>
<text text-anchor="middle" x="3128" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3128" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 234</text>
<text text-anchor="middle" x="3128" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3128" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_5&#45;&gt;expert_7_5_0 -->
<g id="edge727" class="edge">
<title>route_7_5&#45;&gt;expert_7_5_0</title>
<path fill="none" stroke="black" d="M3332.08,-5989.18C3292.92,-5977.62 3247.49,-5964.2 3209.44,-5952.96"/>
<polygon fill="black" stroke="black" points="3210.01,-5949.48 3199.43,-5950.01 3208.03,-5956.2 3210.01,-5949.48"/>
</g>
<!-- expert_7_5_1 -->
<g id="node502" class="node">
<title>expert_7_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3561.5,-5949.92 3284.5,-5949.92 3284.5,-5905.92 3561.5,-5905.92 3561.5,-5949.92"/>
<text text-anchor="middle" x="3423" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3423" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 235</text>
<text text-anchor="middle" x="3423" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3423" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_5&#45;&gt;expert_7_5_1 -->
<g id="edge728" class="edge">
<title>route_7_5&#45;&gt;expert_7_5_1</title>
<path fill="none" stroke="black" d="M3423,-5985.56C3423,-5977.28 3423,-5968.31 3423,-5959.99"/>
<polygon fill="black" stroke="black" points="3426.5,-5959.92 3423,-5949.92 3419.5,-5959.92 3426.5,-5959.92"/>
</g>
<!-- tp_7_5 -->
<g id="node503" class="node">
<title>tp_7_5</title>
<ellipse fill="lightblue" stroke="black" cx="3423" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3423" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3423" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 234↔235</text>
<text text-anchor="middle" x="3423" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3423" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_5_0&#45;&gt;tp_7_5 -->
<g id="edge729" class="edge">
<title>expert_7_5_0&#45;&gt;tp_7_5</title>
<path fill="none" stroke="black" d="M3199.41,-5905.83C3240.87,-5893.59 3293.36,-5878.08 3337.07,-5865.18"/>
<polygon fill="black" stroke="black" points="3338.23,-5868.48 3346.83,-5862.3 3336.25,-5861.77 3338.23,-5868.48"/>
</g>
<!-- expert_7_5_1&#45;&gt;tp_7_5 -->
<g id="edge730" class="edge">
<title>expert_7_5_1&#45;&gt;tp_7_5</title>
<path fill="none" stroke="black" d="M3423,-5905.83C3423,-5898.15 3423,-5889.2 3423,-5880.41"/>
<polygon fill="black" stroke="black" points="3426.5,-5880.25 3423,-5870.25 3419.5,-5880.25 3426.5,-5880.25"/>
</g>
<!-- tp_7_5&#45;&gt;agg_7 -->
<g id="edge731" class="edge">
<title>tp_7_5&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M3531.79,-5827.93C3731.1,-5809.83 4157.95,-5771.09 4415.35,-5747.72"/>
<polygon fill="black" stroke="black" points="4415.93,-5751.18 4425.57,-5746.79 4415.3,-5744.21 4415.93,-5751.18"/>
</g>
<!-- expert_7_6_0 -->
<g id="node505" class="node">
<title>expert_7_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3856.5,-5949.92 3579.5,-5949.92 3579.5,-5905.92 3856.5,-5905.92 3856.5,-5949.92"/>
<text text-anchor="middle" x="3718" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3718" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 236</text>
<text text-anchor="middle" x="3718" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3718" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_6&#45;&gt;expert_7_6_0 -->
<g id="edge733" class="edge">
<title>route_7_6&#45;&gt;expert_7_6_0</title>
<path fill="none" stroke="black" d="M3922.08,-5989.18C3882.92,-5977.62 3837.49,-5964.2 3799.44,-5952.96"/>
<polygon fill="black" stroke="black" points="3800.01,-5949.48 3789.43,-5950.01 3798.03,-5956.2 3800.01,-5949.48"/>
</g>
<!-- expert_7_6_1 -->
<g id="node506" class="node">
<title>expert_7_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4151.5,-5949.92 3874.5,-5949.92 3874.5,-5905.92 4151.5,-5905.92 4151.5,-5949.92"/>
<text text-anchor="middle" x="4013" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4013" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 237</text>
<text text-anchor="middle" x="4013" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4013" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_6&#45;&gt;expert_7_6_1 -->
<g id="edge734" class="edge">
<title>route_7_6&#45;&gt;expert_7_6_1</title>
<path fill="none" stroke="black" d="M4013,-5985.56C4013,-5977.28 4013,-5968.31 4013,-5959.99"/>
<polygon fill="black" stroke="black" points="4016.5,-5959.92 4013,-5949.92 4009.5,-5959.92 4016.5,-5959.92"/>
</g>
<!-- tp_7_6 -->
<g id="node507" class="node">
<title>tp_7_6</title>
<ellipse fill="lightblue" stroke="black" cx="4013" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4013" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4013" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 236↔237</text>
<text text-anchor="middle" x="4013" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4013" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_6_0&#45;&gt;tp_7_6 -->
<g id="edge735" class="edge">
<title>expert_7_6_0&#45;&gt;tp_7_6</title>
<path fill="none" stroke="black" d="M3789.41,-5905.83C3830.87,-5893.59 3883.36,-5878.08 3927.07,-5865.18"/>
<polygon fill="black" stroke="black" points="3928.23,-5868.48 3936.83,-5862.3 3926.25,-5861.77 3928.23,-5868.48"/>
</g>
<!-- expert_7_6_1&#45;&gt;tp_7_6 -->
<g id="edge736" class="edge">
<title>expert_7_6_1&#45;&gt;tp_7_6</title>
<path fill="none" stroke="black" d="M4013,-5905.83C4013,-5898.15 4013,-5889.2 4013,-5880.41"/>
<polygon fill="black" stroke="black" points="4016.5,-5880.25 4013,-5870.25 4009.5,-5880.25 4016.5,-5880.25"/>
</g>
<!-- tp_7_6&#45;&gt;agg_7 -->
<g id="edge737" class="edge">
<title>tp_7_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M4107.95,-5820.87C4194.72,-5805.4 4325.62,-5782.06 4434,-5762.74"/>
<polygon fill="black" stroke="black" points="4434.86,-5766.15 4444.09,-5760.94 4433.63,-5759.25 4434.86,-5766.15"/>
</g>
<!-- expert_7_7_0 -->
<g id="node509" class="node">
<title>expert_7_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4446.5,-5949.92 4169.5,-5949.92 4169.5,-5905.92 4446.5,-5905.92 4446.5,-5949.92"/>
<text text-anchor="middle" x="4308" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4308" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 238</text>
<text text-anchor="middle" x="4308" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4308" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_7&#45;&gt;expert_7_7_0 -->
<g id="edge739" class="edge">
<title>route_7_7&#45;&gt;expert_7_7_0</title>
<path fill="none" stroke="black" d="M4466.32,-5988.11C4436.66,-5977.02 4402.83,-5964.37 4374.08,-5953.62"/>
<polygon fill="black" stroke="black" points="4375.13,-5950.28 4364.54,-5950.05 4372.68,-5956.83 4375.13,-5950.28"/>
</g>
<!-- expert_7_7_1 -->
<g id="node510" class="node">
<title>expert_7_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4741.5,-5949.92 4464.5,-5949.92 4464.5,-5905.92 4741.5,-5905.92 4741.5,-5949.92"/>
<text text-anchor="middle" x="4603" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4603" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 239</text>
<text text-anchor="middle" x="4603" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4603" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_7&#45;&gt;expert_7_7_1 -->
<g id="edge740" class="edge">
<title>route_7_7&#45;&gt;expert_7_7_1</title>
<path fill="none" stroke="black" d="M4562.34,-5986.05C4568.71,-5977.1 4575.68,-5967.3 4582.03,-5958.38"/>
<polygon fill="black" stroke="black" points="4584.94,-5960.33 4587.88,-5950.16 4579.23,-5956.27 4584.94,-5960.33"/>
</g>
<!-- tp_7_7 -->
<g id="node511" class="node">
<title>tp_7_7</title>
<ellipse fill="lightblue" stroke="black" cx="4603" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4603" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4603" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 238↔239</text>
<text text-anchor="middle" x="4603" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4603" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_7_0&#45;&gt;tp_7_7 -->
<g id="edge741" class="edge">
<title>expert_7_7_0&#45;&gt;tp_7_7</title>
<path fill="none" stroke="black" d="M4379.41,-5905.83C4420.87,-5893.59 4473.36,-5878.08 4517.07,-5865.18"/>
<polygon fill="black" stroke="black" points="4518.23,-5868.48 4526.83,-5862.3 4516.25,-5861.77 4518.23,-5868.48"/>
</g>
<!-- expert_7_7_1&#45;&gt;tp_7_7 -->
<g id="edge742" class="edge">
<title>expert_7_7_1&#45;&gt;tp_7_7</title>
<path fill="none" stroke="black" d="M4603,-5905.83C4603,-5898.15 4603,-5889.2 4603,-5880.41"/>
<polygon fill="black" stroke="black" points="4606.5,-5880.25 4603,-5870.25 4599.5,-5880.25 4606.5,-5880.25"/>
</g>
<!-- tp_7_7&#45;&gt;agg_7 -->
<g id="edge743" class="edge">
<title>tp_7_7&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M4609.07,-5807.7C4610.7,-5799.63 4612.5,-5790.67 4614.3,-5781.75"/>
<polygon fill="black" stroke="black" points="4617.77,-5782.26 4616.31,-5771.76 4610.91,-5780.88 4617.77,-5782.26"/>
</g>
<!-- expert_7_8_0 -->
<g id="node513" class="node">
<title>expert_7_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5036.5,-5949.92 4759.5,-5949.92 4759.5,-5905.92 5036.5,-5905.92 5036.5,-5949.92"/>
<text text-anchor="middle" x="4898" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4898" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 240</text>
<text text-anchor="middle" x="4898" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4898" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_8&#45;&gt;expert_7_8_0 -->
<g id="edge745" class="edge">
<title>route_7_8&#45;&gt;expert_7_8_0</title>
<path fill="none" stroke="black" d="M4939.32,-5986.05C4932.85,-5977.1 4925.76,-5967.3 4919.31,-5958.38"/>
<polygon fill="black" stroke="black" points="4922.06,-5956.21 4913.36,-5950.16 4916.39,-5960.31 4922.06,-5956.21"/>
</g>
<!-- expert_7_8_1 -->
<g id="node514" class="node">
<title>expert_7_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5331.5,-5949.92 5054.5,-5949.92 5054.5,-5905.92 5331.5,-5905.92 5331.5,-5949.92"/>
<text text-anchor="middle" x="5193" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5193" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 241</text>
<text text-anchor="middle" x="5193" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5193" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_8&#45;&gt;expert_7_8_1 -->
<g id="edge746" class="edge">
<title>route_7_8&#45;&gt;expert_7_8_1</title>
<path fill="none" stroke="black" d="M5035.36,-5988.11C5064.89,-5977.02 5098.58,-5964.37 5127.2,-5953.62"/>
<polygon fill="black" stroke="black" points="5128.57,-5956.84 5136.71,-5950.05 5126.11,-5950.29 5128.57,-5956.84"/>
</g>
<!-- tp_7_8 -->
<g id="node515" class="node">
<title>tp_7_8</title>
<ellipse fill="lightblue" stroke="black" cx="4898" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4898" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4898" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 240↔241</text>
<text text-anchor="middle" x="4898" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4898" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_8_0&#45;&gt;tp_7_8 -->
<g id="edge747" class="edge">
<title>expert_7_8_0&#45;&gt;tp_7_8</title>
<path fill="none" stroke="black" d="M4898,-5905.83C4898,-5898.15 4898,-5889.2 4898,-5880.41"/>
<polygon fill="black" stroke="black" points="4901.5,-5880.25 4898,-5870.25 4894.5,-5880.25 4901.5,-5880.25"/>
</g>
<!-- expert_7_8_1&#45;&gt;tp_7_8 -->
<g id="edge748" class="edge">
<title>expert_7_8_1&#45;&gt;tp_7_8</title>
<path fill="none" stroke="black" d="M5121.59,-5905.83C5080.13,-5893.59 5027.64,-5878.08 4983.93,-5865.18"/>
<polygon fill="black" stroke="black" points="4984.75,-5861.77 4974.17,-5862.3 4982.77,-5868.48 4984.75,-5861.77"/>
</g>
<!-- tp_7_8&#45;&gt;agg_7 -->
<g id="edge749" class="edge">
<title>tp_7_8&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M4835.03,-5812.63C4807.36,-5801.58 4773.96,-5788.23 4742.01,-5775.46"/>
<polygon fill="black" stroke="black" points="4743.19,-5772.16 4732.6,-5771.7 4740.59,-5778.66 4743.19,-5772.16"/>
</g>
<!-- expert_7_9_0 -->
<g id="node517" class="node">
<title>expert_7_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5626.5,-5949.92 5349.5,-5949.92 5349.5,-5905.92 5626.5,-5905.92 5626.5,-5949.92"/>
<text text-anchor="middle" x="5488" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5488" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 242</text>
<text text-anchor="middle" x="5488" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5488" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_9&#45;&gt;expert_7_9_0 -->
<g id="edge751" class="edge">
<title>route_7_9&#45;&gt;expert_7_9_0</title>
<path fill="none" stroke="black" d="M5488,-5985.56C5488,-5977.28 5488,-5968.31 5488,-5959.99"/>
<polygon fill="black" stroke="black" points="5491.5,-5959.92 5488,-5949.92 5484.5,-5959.92 5491.5,-5959.92"/>
</g>
<!-- expert_7_9_1 -->
<g id="node518" class="node">
<title>expert_7_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5921.5,-5949.92 5644.5,-5949.92 5644.5,-5905.92 5921.5,-5905.92 5921.5,-5949.92"/>
<text text-anchor="middle" x="5783" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5783" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 243</text>
<text text-anchor="middle" x="5783" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5783" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_9&#45;&gt;expert_7_9_1 -->
<g id="edge752" class="edge">
<title>route_7_9&#45;&gt;expert_7_9_1</title>
<path fill="none" stroke="black" d="M5578.92,-5989.18C5618.08,-5977.62 5663.51,-5964.2 5701.56,-5952.96"/>
<polygon fill="black" stroke="black" points="5702.97,-5956.2 5711.57,-5950.01 5700.99,-5949.48 5702.97,-5956.2"/>
</g>
<!-- tp_7_9 -->
<g id="node519" class="node">
<title>tp_7_9</title>
<ellipse fill="lightblue" stroke="black" cx="5488" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5488" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5488" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 242↔243</text>
<text text-anchor="middle" x="5488" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5488" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_9_0&#45;&gt;tp_7_9 -->
<g id="edge753" class="edge">
<title>expert_7_9_0&#45;&gt;tp_7_9</title>
<path fill="none" stroke="black" d="M5488,-5905.83C5488,-5898.15 5488,-5889.2 5488,-5880.41"/>
<polygon fill="black" stroke="black" points="5491.5,-5880.25 5488,-5870.25 5484.5,-5880.25 5491.5,-5880.25"/>
</g>
<!-- expert_7_9_1&#45;&gt;tp_7_9 -->
<g id="edge754" class="edge">
<title>expert_7_9_1&#45;&gt;tp_7_9</title>
<path fill="none" stroke="black" d="M5711.59,-5905.83C5670.13,-5893.59 5617.64,-5878.08 5573.93,-5865.18"/>
<polygon fill="black" stroke="black" points="5574.75,-5861.77 5564.17,-5862.3 5572.77,-5868.48 5574.75,-5861.77"/>
</g>
<!-- tp_7_9&#45;&gt;agg_7 -->
<g id="edge755" class="edge">
<title>tp_7_9&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M5384.33,-5824.7C5266.66,-5809.82 5069.79,-5784.93 4905.99,-5764.22"/>
<polygon fill="black" stroke="black" points="4906.11,-5760.7 4895.75,-5762.92 4905.23,-5767.65 4906.11,-5760.7"/>
</g>
<!-- expert_7_10_0 -->
<g id="node521" class="node">
<title>expert_7_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6216.5,-5949.92 5939.5,-5949.92 5939.5,-5905.92 6216.5,-5905.92 6216.5,-5949.92"/>
<text text-anchor="middle" x="6078" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6078" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 244</text>
<text text-anchor="middle" x="6078" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6078" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_10&#45;&gt;expert_7_10_0 -->
<g id="edge757" class="edge">
<title>route_7_10&#45;&gt;expert_7_10_0</title>
<path fill="none" stroke="black" d="M6078,-5985.56C6078,-5977.28 6078,-5968.31 6078,-5959.99"/>
<polygon fill="black" stroke="black" points="6081.5,-5959.92 6078,-5949.92 6074.5,-5959.92 6081.5,-5959.92"/>
</g>
<!-- expert_7_10_1 -->
<g id="node522" class="node">
<title>expert_7_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6511.5,-5949.92 6234.5,-5949.92 6234.5,-5905.92 6511.5,-5905.92 6511.5,-5949.92"/>
<text text-anchor="middle" x="6373" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6373" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 245</text>
<text text-anchor="middle" x="6373" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6373" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_10&#45;&gt;expert_7_10_1 -->
<g id="edge758" class="edge">
<title>route_7_10&#45;&gt;expert_7_10_1</title>
<path fill="none" stroke="black" d="M6168.92,-5989.18C6208.08,-5977.62 6253.51,-5964.2 6291.56,-5952.96"/>
<polygon fill="black" stroke="black" points="6292.97,-5956.2 6301.57,-5950.01 6290.99,-5949.48 6292.97,-5956.2"/>
</g>
<!-- tp_7_10 -->
<g id="node523" class="node">
<title>tp_7_10</title>
<ellipse fill="lightblue" stroke="black" cx="6078" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6078" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6078" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 244↔245</text>
<text text-anchor="middle" x="6078" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6078" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_10_0&#45;&gt;tp_7_10 -->
<g id="edge759" class="edge">
<title>expert_7_10_0&#45;&gt;tp_7_10</title>
<path fill="none" stroke="black" d="M6078,-5905.83C6078,-5898.15 6078,-5889.2 6078,-5880.41"/>
<polygon fill="black" stroke="black" points="6081.5,-5880.25 6078,-5870.25 6074.5,-5880.25 6081.5,-5880.25"/>
</g>
<!-- expert_7_10_1&#45;&gt;tp_7_10 -->
<g id="edge760" class="edge">
<title>expert_7_10_1&#45;&gt;tp_7_10</title>
<path fill="none" stroke="black" d="M6301.59,-5905.83C6260.13,-5893.59 6207.64,-5878.08 6163.93,-5865.18"/>
<polygon fill="black" stroke="black" points="6164.75,-5861.77 6154.17,-5862.3 6162.77,-5868.48 6164.75,-5861.77"/>
</g>
<!-- tp_7_10&#45;&gt;agg_7 -->
<g id="edge761" class="edge">
<title>tp_7_10&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M5967.3,-5829.49C5738.29,-5812.29 5207.13,-5772.4 4885.88,-5748.28"/>
<polygon fill="black" stroke="black" points="4885.72,-5744.76 4875.49,-5747.5 4885.2,-5751.74 4885.72,-5744.76"/>
</g>
<!-- expert_7_11_0 -->
<g id="node525" class="node">
<title>expert_7_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6806.5,-5949.92 6529.5,-5949.92 6529.5,-5905.92 6806.5,-5905.92 6806.5,-5949.92"/>
<text text-anchor="middle" x="6668" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6668" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 246</text>
<text text-anchor="middle" x="6668" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6668" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_11&#45;&gt;expert_7_11_0 -->
<g id="edge763" class="edge">
<title>route_7_11&#45;&gt;expert_7_11_0</title>
<path fill="none" stroke="black" d="M6668,-5985.56C6668,-5977.28 6668,-5968.31 6668,-5959.99"/>
<polygon fill="black" stroke="black" points="6671.5,-5959.92 6668,-5949.92 6664.5,-5959.92 6671.5,-5959.92"/>
</g>
<!-- expert_7_11_1 -->
<g id="node526" class="node">
<title>expert_7_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7101.5,-5949.92 6824.5,-5949.92 6824.5,-5905.92 7101.5,-5905.92 7101.5,-5949.92"/>
<text text-anchor="middle" x="6963" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="6963" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 247</text>
<text text-anchor="middle" x="6963" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6963" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_11&#45;&gt;expert_7_11_1 -->
<g id="edge764" class="edge">
<title>route_7_11&#45;&gt;expert_7_11_1</title>
<path fill="none" stroke="black" d="M6758.92,-5989.18C6798.08,-5977.62 6843.51,-5964.2 6881.56,-5952.96"/>
<polygon fill="black" stroke="black" points="6882.97,-5956.2 6891.57,-5950.01 6880.99,-5949.48 6882.97,-5956.2"/>
</g>
<!-- tp_7_11 -->
<g id="node527" class="node">
<title>tp_7_11</title>
<ellipse fill="lightblue" stroke="black" cx="6668" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6668" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6668" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 246↔247</text>
<text text-anchor="middle" x="6668" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6668" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_11_0&#45;&gt;tp_7_11 -->
<g id="edge765" class="edge">
<title>expert_7_11_0&#45;&gt;tp_7_11</title>
<path fill="none" stroke="black" d="M6668,-5905.83C6668,-5898.15 6668,-5889.2 6668,-5880.41"/>
<polygon fill="black" stroke="black" points="6671.5,-5880.25 6668,-5870.25 6664.5,-5880.25 6671.5,-5880.25"/>
</g>
<!-- expert_7_11_1&#45;&gt;tp_7_11 -->
<g id="edge766" class="edge">
<title>expert_7_11_1&#45;&gt;tp_7_11</title>
<path fill="none" stroke="black" d="M6891.59,-5905.83C6850.13,-5893.59 6797.64,-5878.08 6753.93,-5865.18"/>
<polygon fill="black" stroke="black" points="6754.75,-5861.77 6744.17,-5862.3 6752.77,-5868.48 6754.75,-5861.77"/>
</g>
<!-- tp_7_11&#45;&gt;agg_7 -->
<g id="edge767" class="edge">
<title>tp_7_11&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M6556.22,-5830.1C6462.05,-5823.73 6323.74,-5814.62 6203,-5807.69 5733.99,-5780.76 5186.26,-5754.51 4875.05,-5740.08"/>
<polygon fill="black" stroke="black" points="4875.15,-5736.58 4864.99,-5739.61 4874.82,-5743.57 4875.15,-5736.58"/>
</g>
<!-- expert_7_12_0 -->
<g id="node529" class="node">
<title>expert_7_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7396.5,-5949.92 7119.5,-5949.92 7119.5,-5905.92 7396.5,-5905.92 7396.5,-5949.92"/>
<text text-anchor="middle" x="7258" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7258" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 248</text>
<text text-anchor="middle" x="7258" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7258" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_12&#45;&gt;expert_7_12_0 -->
<g id="edge769" class="edge">
<title>route_7_12&#45;&gt;expert_7_12_0</title>
<path fill="none" stroke="black" d="M7258,-5985.56C7258,-5977.28 7258,-5968.31 7258,-5959.99"/>
<polygon fill="black" stroke="black" points="7261.5,-5959.92 7258,-5949.92 7254.5,-5959.92 7261.5,-5959.92"/>
</g>
<!-- expert_7_12_1 -->
<g id="node530" class="node">
<title>expert_7_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7691.5,-5949.92 7414.5,-5949.92 7414.5,-5905.92 7691.5,-5905.92 7691.5,-5949.92"/>
<text text-anchor="middle" x="7553" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7553" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 249</text>
<text text-anchor="middle" x="7553" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7553" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_12&#45;&gt;expert_7_12_1 -->
<g id="edge770" class="edge">
<title>route_7_12&#45;&gt;expert_7_12_1</title>
<path fill="none" stroke="black" d="M7348.92,-5989.18C7388.08,-5977.62 7433.51,-5964.2 7471.56,-5952.96"/>
<polygon fill="black" stroke="black" points="7472.97,-5956.2 7481.57,-5950.01 7470.99,-5949.48 7472.97,-5956.2"/>
</g>
<!-- tp_7_12 -->
<g id="node531" class="node">
<title>tp_7_12</title>
<ellipse fill="lightblue" stroke="black" cx="7258" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7258" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7258" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 248↔249</text>
<text text-anchor="middle" x="7258" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7258" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_12_0&#45;&gt;tp_7_12 -->
<g id="edge771" class="edge">
<title>expert_7_12_0&#45;&gt;tp_7_12</title>
<path fill="none" stroke="black" d="M7258,-5905.83C7258,-5898.15 7258,-5889.2 7258,-5880.41"/>
<polygon fill="black" stroke="black" points="7261.5,-5880.25 7258,-5870.25 7254.5,-5880.25 7261.5,-5880.25"/>
</g>
<!-- expert_7_12_1&#45;&gt;tp_7_12 -->
<g id="edge772" class="edge">
<title>expert_7_12_1&#45;&gt;tp_7_12</title>
<path fill="none" stroke="black" d="M7481.59,-5905.83C7440.13,-5893.59 7387.64,-5878.08 7343.93,-5865.18"/>
<polygon fill="black" stroke="black" points="7344.75,-5861.77 7334.17,-5862.3 7342.77,-5868.48 7344.75,-5861.77"/>
</g>
<!-- tp_7_12&#45;&gt;agg_7 -->
<g id="edge773" class="edge">
<title>tp_7_12&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M7146.71,-5829.71C7052.54,-5823.07 6913.99,-5813.81 6793,-5807.69 6095.6,-5772.41 5271.22,-5746.79 4869.58,-5735.35"/>
<polygon fill="black" stroke="black" points="4869.39,-5731.84 4859.29,-5735.06 4869.19,-5738.84 4869.39,-5731.84"/>
</g>
<!-- expert_7_13_0 -->
<g id="node533" class="node">
<title>expert_7_13_0</title>
<polygon fill="lightgreen" stroke="black" points="7986.5,-5949.92 7709.5,-5949.92 7709.5,-5905.92 7986.5,-5905.92 7986.5,-5949.92"/>
<text text-anchor="middle" x="7848" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7848" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 250</text>
<text text-anchor="middle" x="7848" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7848" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_13&#45;&gt;expert_7_13_0 -->
<g id="edge775" class="edge">
<title>route_7_13&#45;&gt;expert_7_13_0</title>
<path fill="none" stroke="black" d="M7848,-5985.56C7848,-5977.28 7848,-5968.31 7848,-5959.99"/>
<polygon fill="black" stroke="black" points="7851.5,-5959.92 7848,-5949.92 7844.5,-5959.92 7851.5,-5959.92"/>
</g>
<!-- expert_7_13_1 -->
<g id="node534" class="node">
<title>expert_7_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8281.5,-5949.92 8004.5,-5949.92 8004.5,-5905.92 8281.5,-5905.92 8281.5,-5949.92"/>
<text text-anchor="middle" x="8143" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8143" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 251</text>
<text text-anchor="middle" x="8143" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8143" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_13&#45;&gt;expert_7_13_1 -->
<g id="edge776" class="edge">
<title>route_7_13&#45;&gt;expert_7_13_1</title>
<path fill="none" stroke="black" d="M7938.92,-5989.18C7978.08,-5977.62 8023.51,-5964.2 8061.56,-5952.96"/>
<polygon fill="black" stroke="black" points="8062.97,-5956.2 8071.57,-5950.01 8060.99,-5949.48 8062.97,-5956.2"/>
</g>
<!-- tp_7_13 -->
<g id="node535" class="node">
<title>tp_7_13</title>
<ellipse fill="lightblue" stroke="black" cx="7848" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7848" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7848" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 250↔251</text>
<text text-anchor="middle" x="7848" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7848" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_13_0&#45;&gt;tp_7_13 -->
<g id="edge777" class="edge">
<title>expert_7_13_0&#45;&gt;tp_7_13</title>
<path fill="none" stroke="black" d="M7848,-5905.83C7848,-5898.15 7848,-5889.2 7848,-5880.41"/>
<polygon fill="black" stroke="black" points="7851.5,-5880.25 7848,-5870.25 7844.5,-5880.25 7851.5,-5880.25"/>
</g>
<!-- expert_7_13_1&#45;&gt;tp_7_13 -->
<g id="edge778" class="edge">
<title>expert_7_13_1&#45;&gt;tp_7_13</title>
<path fill="none" stroke="black" d="M8071.59,-5905.83C8030.13,-5893.59 7977.64,-5878.08 7933.93,-5865.18"/>
<polygon fill="black" stroke="black" points="7934.75,-5861.77 7924.17,-5862.3 7932.77,-5868.48 7934.75,-5861.77"/>
</g>
<!-- tp_7_13&#45;&gt;agg_7 -->
<g id="edge779" class="edge">
<title>tp_7_13&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M7737.2,-5829.5C7643.03,-5822.71 7504.22,-5813.35 7383,-5807.69 6452.98,-5764.27 5345.35,-5741.24 4865.91,-5732.67"/>
<polygon fill="black" stroke="black" points="4865.81,-5729.17 4855.75,-5732.49 4865.68,-5736.17 4865.81,-5729.17"/>
</g>
<!-- expert_7_14_0 -->
<g id="node537" class="node">
<title>expert_7_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8576.5,-5949.92 8299.5,-5949.92 8299.5,-5905.92 8576.5,-5905.92 8576.5,-5949.92"/>
<text text-anchor="middle" x="8438" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8438" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 252</text>
<text text-anchor="middle" x="8438" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8438" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_14&#45;&gt;expert_7_14_0 -->
<g id="edge781" class="edge">
<title>route_7_14&#45;&gt;expert_7_14_0</title>
<path fill="none" stroke="black" d="M8438,-5985.56C8438,-5977.28 8438,-5968.31 8438,-5959.99"/>
<polygon fill="black" stroke="black" points="8441.5,-5959.92 8438,-5949.92 8434.5,-5959.92 8441.5,-5959.92"/>
</g>
<!-- expert_7_14_1 -->
<g id="node538" class="node">
<title>expert_7_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8871.5,-5949.92 8594.5,-5949.92 8594.5,-5905.92 8871.5,-5905.92 8871.5,-5949.92"/>
<text text-anchor="middle" x="8733" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8733" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 253</text>
<text text-anchor="middle" x="8733" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8733" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_14&#45;&gt;expert_7_14_1 -->
<g id="edge782" class="edge">
<title>route_7_14&#45;&gt;expert_7_14_1</title>
<path fill="none" stroke="black" d="M8528.92,-5989.18C8568.08,-5977.62 8613.51,-5964.2 8651.56,-5952.96"/>
<polygon fill="black" stroke="black" points="8652.97,-5956.2 8661.57,-5950.01 8650.99,-5949.48 8652.97,-5956.2"/>
</g>
<!-- tp_7_14 -->
<g id="node539" class="node">
<title>tp_7_14</title>
<ellipse fill="lightblue" stroke="black" cx="8438" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8438" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8438" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 252↔253</text>
<text text-anchor="middle" x="8438" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8438" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_14_0&#45;&gt;tp_7_14 -->
<g id="edge783" class="edge">
<title>expert_7_14_0&#45;&gt;tp_7_14</title>
<path fill="none" stroke="black" d="M8438,-5905.83C8438,-5898.15 8438,-5889.2 8438,-5880.41"/>
<polygon fill="black" stroke="black" points="8441.5,-5880.25 8438,-5870.25 8434.5,-5880.25 8441.5,-5880.25"/>
</g>
<!-- expert_7_14_1&#45;&gt;tp_7_14 -->
<g id="edge784" class="edge">
<title>expert_7_14_1&#45;&gt;tp_7_14</title>
<path fill="none" stroke="black" d="M8661.59,-5905.83C8620.13,-5893.59 8567.64,-5878.08 8523.93,-5865.18"/>
<polygon fill="black" stroke="black" points="8524.75,-5861.77 8514.17,-5862.3 8522.77,-5868.48 8524.75,-5861.77"/>
</g>
<!-- tp_7_14&#45;&gt;agg_7 -->
<g id="edge785" class="edge">
<title>tp_7_14&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M8327.2,-5829.34C8233.04,-5822.46 8094.23,-5813.04 7973,-5807.69 6807.57,-5756.23 5412.36,-5736.9 4863.46,-5730.95"/>
<polygon fill="black" stroke="black" points="4863.48,-5727.45 4853.45,-5730.85 4863.41,-5734.45 4863.48,-5727.45"/>
</g>
<!-- expert_7_15_0 -->
<g id="node541" class="node">
<title>expert_7_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9166.5,-5949.92 8889.5,-5949.92 8889.5,-5905.92 9166.5,-5905.92 9166.5,-5949.92"/>
<text text-anchor="middle" x="9028" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9028" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 254</text>
<text text-anchor="middle" x="9028" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9028" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_15&#45;&gt;expert_7_15_0 -->
<g id="edge787" class="edge">
<title>route_7_15&#45;&gt;expert_7_15_0</title>
<path fill="none" stroke="black" d="M9028,-5985.56C9028,-5977.28 9028,-5968.31 9028,-5959.99"/>
<polygon fill="black" stroke="black" points="9031.5,-5959.92 9028,-5949.92 9024.5,-5959.92 9031.5,-5959.92"/>
</g>
<!-- expert_7_15_1 -->
<g id="node542" class="node">
<title>expert_7_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9461.5,-5949.92 9184.5,-5949.92 9184.5,-5905.92 9461.5,-5905.92 9461.5,-5949.92"/>
<text text-anchor="middle" x="9323" y="-5940.72" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9323" y="-5930.72" font-family="Times,serif" font-size="9.00">GPU: 255</text>
<text text-anchor="middle" x="9323" y="-5920.72" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9323" y="-5910.72" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_7_15&#45;&gt;expert_7_15_1 -->
<g id="edge788" class="edge">
<title>route_7_15&#45;&gt;expert_7_15_1</title>
<path fill="none" stroke="black" d="M9118.92,-5989.18C9158.08,-5977.62 9203.51,-5964.2 9241.56,-5952.96"/>
<polygon fill="black" stroke="black" points="9242.97,-5956.2 9251.57,-5950.01 9240.99,-5949.48 9242.97,-5956.2"/>
</g>
<!-- tp_7_15 -->
<g id="node543" class="node">
<title>tp_7_15</title>
<ellipse fill="lightblue" stroke="black" cx="9028" cy="-5838.8" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9028" y="-5851.6" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9028" y="-5841.6" font-family="Times,serif" font-size="9.00">GPU: 254↔255</text>
<text text-anchor="middle" x="9028" y="-5831.6" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9028" y="-5821.6" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_7_15_0&#45;&gt;tp_7_15 -->
<g id="edge789" class="edge">
<title>expert_7_15_0&#45;&gt;tp_7_15</title>
<path fill="none" stroke="black" d="M9028,-5905.83C9028,-5898.15 9028,-5889.2 9028,-5880.41"/>
<polygon fill="black" stroke="black" points="9031.5,-5880.25 9028,-5870.25 9024.5,-5880.25 9031.5,-5880.25"/>
</g>
<!-- expert_7_15_1&#45;&gt;tp_7_15 -->
<g id="edge790" class="edge">
<title>expert_7_15_1&#45;&gt;tp_7_15</title>
<path fill="none" stroke="black" d="M9251.59,-5905.83C9210.13,-5893.59 9157.64,-5878.08 9113.93,-5865.18"/>
<polygon fill="black" stroke="black" points="9114.75,-5861.77 9104.17,-5862.3 9112.77,-5868.48 9114.75,-5861.77"/>
</g>
<!-- tp_7_15&#45;&gt;agg_7 -->
<g id="edge791" class="edge">
<title>tp_7_15&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M8917.21,-5829.23C8823.05,-5822.28 8684.24,-5812.83 8563,-5807.69 7160.53,-5748.24 5475.15,-5733.34 4862.35,-5729.76"/>
<polygon fill="black" stroke="black" points="4862.09,-5726.26 4852.07,-5729.7 4862.05,-5733.26 4862.09,-5726.26"/>
</g>
<!-- output_7 -->
<g id="node545" class="node">
<title>output_7</title>
<polygon fill="lightgreen" stroke="black" points="4773,-5647.69 4477,-5647.69 4477,-5603.69 4773,-5603.69 4773,-5647.69"/>
<text text-anchor="middle" x="4625" y="-5638.49" font-family="Times,serif" font-size="9.00">Layer 7 Output</text>
<text text-anchor="middle" x="4625" y="-5628.49" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4625" y="-5618.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4625" y="-5608.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_7&#45;&gt;output_7 -->
<g id="edge792" class="edge">
<title>agg_7&#45;&gt;output_7</title>
<path fill="none" stroke="black" d="M4625,-5683.41C4625,-5674.82 4625,-5665.96 4625,-5657.87"/>
<polygon fill="black" stroke="black" points="4628.5,-5657.77 4625,-5647.77 4621.5,-5657.77 4628.5,-5657.77"/>
</g>
<!-- mha_8 -->
<g id="node546" class="node">
<title>mha_8</title>
<polygon fill="lightgreen" stroke="black" points="4773,-5556.69 4477,-5556.69 4477,-5512.69 4773,-5512.69 4773,-5556.69"/>
<text text-anchor="middle" x="4625" y="-5547.49" font-family="Times,serif" font-size="9.00">MHA L8</text>
<text text-anchor="middle" x="4625" y="-5537.49" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4625" y="-5527.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4625" y="-5517.49" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_7&#45;&gt;mha_8 -->
<g id="edge793" class="edge">
<title>output_7&#45;&gt;mha_8</title>
<path fill="none" stroke="black" d="M4625,-5603.6C4625,-5592.7 4625,-5579.19 4625,-5567.1"/>
<polygon fill="black" stroke="black" points="4628.5,-5566.94 4625,-5556.94 4621.5,-5566.94 4628.5,-5566.94"/>
</g>
<!-- gate_8 -->
<g id="node547" class="node">
<title>gate_8</title>
<polygon fill="lightyellow" stroke="black" points="4924.74,-5476.69 4447.92,-5476.69 4325.26,-5388.69 4802.08,-5388.69 4924.74,-5476.69"/>
<text text-anchor="middle" x="4625" y="-5445.49" font-family="Times,serif" font-size="9.00">Gate L8</text>
<text text-anchor="middle" x="4625" y="-5435.49" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4625" y="-5425.49" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4625" y="-5415.49" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_8&#45;&gt;gate_8 -->
<g id="edge794" class="edge">
<title>mha_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M4625,-5512.48C4625,-5504.98 4625,-5496.18 4625,-5487.22"/>
<polygon fill="black" stroke="black" points="4628.5,-5487.1 4625,-5477.1 4621.5,-5487.1 4628.5,-5487.1"/>
</g>
<!-- route_8_0 -->
<g id="node548" class="node">
<title>route_8_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="539" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="539" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="539" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 256,257</text>
<text text-anchor="middle" x="539" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="539" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_0 -->
<g id="edge795" class="edge">
<title>gate_8&#45;&gt;route_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4384.74,-5431.37C3794.4,-5429.54 2225.77,-5418.34 919,-5352.69 853.75,-5349.41 782.32,-5344.18 719.17,-5339"/>
<polygon fill="black" stroke="black" points="719.37,-5335.5 709.11,-5338.17 718.79,-5342.48 719.37,-5335.5"/>
</g>
<!-- route_8_1 -->
<g id="node552" class="node">
<title>route_8_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1129" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1129" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1129" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 258,259</text>
<text text-anchor="middle" x="1129" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1129" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_1 -->
<g id="edge801" class="edge">
<title>gate_8&#45;&gt;route_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4382.41,-5429.97C3857.86,-5425.29 2579.01,-5408.61 1509,-5352.69 1443.91,-5349.29 1372.67,-5344.05 1309.64,-5338.89"/>
<polygon fill="black" stroke="black" points="1309.85,-5335.39 1299.59,-5338.06 1309.27,-5342.37 1309.85,-5335.39"/>
</g>
<!-- route_8_2 -->
<g id="node556" class="node">
<title>route_8_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1719" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1719" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1719" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 260,261</text>
<text text-anchor="middle" x="1719" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1719" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_2 -->
<g id="edge807" class="edge">
<title>gate_8&#45;&gt;route_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4379.66,-5427.91C3928.07,-5420.09 2934.93,-5398.86 2099,-5352.69 2034.08,-5349.1 1963.03,-5343.84 1900.1,-5338.7"/>
<polygon fill="black" stroke="black" points="1900.33,-5335.21 1890.08,-5337.88 1899.76,-5342.19 1900.33,-5335.21"/>
</g>
<!-- route_8_3 -->
<g id="node560" class="node">
<title>route_8_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2309" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2309" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2309" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 262,263</text>
<text text-anchor="middle" x="2309" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2309" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_3 -->
<g id="edge813" class="edge">
<title>gate_8&#45;&gt;route_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4375,-5424.55C4005.99,-5413.31 3293.84,-5388.98 2689,-5352.69 2624.57,-5348.82 2554.08,-5343.53 2491.49,-5338.46"/>
<polygon fill="black" stroke="black" points="2491.77,-5334.97 2481.52,-5337.65 2491.2,-5341.95 2491.77,-5334.97"/>
</g>
<!-- route_8_4 -->
<g id="node564" class="node">
<title>route_8_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2899" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2899" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2899" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 264,265</text>
<text text-anchor="middle" x="2899" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2899" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_4 -->
<g id="edge819" class="edge">
<title>gate_8&#45;&gt;route_8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4365.92,-5418.06C4094.82,-5403.43 3656.88,-5378.75 3279,-5352.69 3215.21,-5348.29 3145.44,-5342.92 3083.29,-5337.94"/>
<polygon fill="black" stroke="black" points="3083.23,-5334.43 3072.99,-5337.12 3082.67,-5341.41 3083.23,-5334.43"/>
</g>
<!-- route_8_5 -->
<g id="node568" class="node">
<title>route_8_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3489" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3489" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3489" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 266,267</text>
<text text-anchor="middle" x="3489" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3489" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_5 -->
<g id="edge825" class="edge">
<title>gate_8&#45;&gt;route_8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4347.83,-5405.07C4135.64,-5384.69 3849.3,-5357.18 3666.86,-5339.66"/>
<polygon fill="black" stroke="black" points="3667.19,-5336.18 3656.9,-5338.7 3666.52,-5343.14 3667.19,-5336.18"/>
</g>
<!-- route_8_6 -->
<g id="node572" class="node">
<title>route_8_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4079" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4079" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4079" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 268,269</text>
<text text-anchor="middle" x="4079" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4079" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_6 -->
<g id="edge831" class="edge">
<title>gate_8&#45;&gt;route_8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4409.6,-5388.64C4341.79,-5375.09 4269.02,-5360.55 4209.06,-5348.57"/>
<polygon fill="black" stroke="black" points="4209.66,-5345.12 4199.17,-5346.59 4208.29,-5351.98 4209.66,-5345.12"/>
</g>
<!-- route_8_7 -->
<g id="node576" class="node">
<title>route_8_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4625" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4625" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4625" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 270,271</text>
<text text-anchor="middle" x="4625" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4625" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_7 -->
<g id="edge837" class="edge">
<title>gate_8&#45;&gt;route_8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4625,-5388.57C4625,-5380.19 4625,-5371.44 4625,-5363.14"/>
<polygon fill="black" stroke="black" points="4628.5,-5362.95 4625,-5352.95 4621.5,-5362.95 4628.5,-5362.95"/>
</g>
<!-- route_8_8 -->
<g id="node580" class="node">
<title>route_8_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5045" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5045" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5045" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 272,273</text>
<text text-anchor="middle" x="5045" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5045" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_8 -->
<g id="edge843" class="edge">
<title>gate_8&#45;&gt;route_8_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4790.69,-5388.64C4839.11,-5376.07 4890.82,-5362.63 4934.88,-5351.18"/>
<polygon fill="black" stroke="black" points="4935.94,-5354.52 4944.74,-5348.62 4934.18,-5347.75 4935.94,-5354.52"/>
</g>
<!-- route_8_9 -->
<g id="node584" class="node">
<title>route_8_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5554" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5554" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5554" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 274,275</text>
<text text-anchor="middle" x="5554" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5554" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_9 -->
<g id="edge849" class="edge">
<title>gate_8&#45;&gt;route_8_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4828.87,-5407.74C4996.25,-5388.09 5230.38,-5360.59 5386.84,-5342.21"/>
<polygon fill="black" stroke="black" points="5387.51,-5345.66 5397.04,-5341.01 5386.7,-5338.7 5387.51,-5345.66"/>
</g>
<!-- route_8_10 -->
<g id="node588" class="node">
<title>route_8_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6144" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6144" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6144" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 276,277</text>
<text text-anchor="middle" x="6144" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6144" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_10 -->
<g id="edge855" class="edge">
<title>gate_8&#45;&gt;route_8_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4842.07,-5417.27C5071.28,-5401.9 5443.15,-5376.53 5764,-5352.69 5827.3,-5347.99 5896.51,-5342.58 5958.31,-5337.66"/>
<polygon fill="black" stroke="black" points="5958.87,-5341.13 5968.56,-5336.84 5958.31,-5334.15 5958.87,-5341.13"/>
</g>
<!-- route_8_11 -->
<g id="node592" class="node">
<title>route_8_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6734" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6734" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6734" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 278,279</text>
<text text-anchor="middle" x="6734" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6734" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_11 -->
<g id="edge861" class="edge">
<title>gate_8&#45;&gt;route_8_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4851.01,-5423.77C5181.34,-5411.66 5815.3,-5386.33 6354,-5352.69 6418.13,-5348.68 6488.28,-5343.39 6550.65,-5338.35"/>
<polygon fill="black" stroke="black" points="6551.31,-5341.81 6561,-5337.51 6550.75,-5334.83 6551.31,-5341.81"/>
</g>
<!-- route_8_12 -->
<g id="node596" class="node">
<title>route_8_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7324" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7324" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7324" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 280,281</text>
<text text-anchor="middle" x="7324" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7324" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_12 -->
<g id="edge867" class="edge">
<title>gate_8&#45;&gt;route_8_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4855.97,-5427.26C5273.17,-5418.5 6180.08,-5395.95 6944,-5352.69 7008.76,-5349.02 7079.63,-5343.75 7142.44,-5338.64"/>
<polygon fill="black" stroke="black" points="7142.76,-5342.12 7152.44,-5337.82 7142.19,-5335.15 7142.76,-5342.12"/>
</g>
<!-- route_8_13 -->
<g id="node600" class="node">
<title>route_8_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7914" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7914" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7914" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 282,283</text>
<text text-anchor="middle" x="7914" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7914" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_13 -->
<g id="edge873" class="edge">
<title>gate_8&#45;&gt;route_8_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4858.95,-5429.46C5353.24,-5423.83 6540.12,-5405.53 7534,-5352.69 7599.08,-5349.23 7670.33,-5343.98 7733.36,-5338.82"/>
<polygon fill="black" stroke="black" points="7733.73,-5342.3 7743.4,-5337.99 7733.15,-5335.32 7733.73,-5342.3"/>
</g>
<!-- route_8_14 -->
<g id="node604" class="node">
<title>route_8_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8504" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8504" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8504" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 284,285</text>
<text text-anchor="middle" x="8504" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8504" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_14 -->
<g id="edge879" class="edge">
<title>gate_8&#45;&gt;route_8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4861.18,-5430.96C5425.59,-5428.21 6897.05,-5415.1 8124,-5352.69 8189.25,-5349.37 8260.68,-5344.13 8323.83,-5338.95"/>
<polygon fill="black" stroke="black" points="8324.21,-5342.43 8333.89,-5338.12 8323.63,-5335.46 8324.21,-5342.43"/>
</g>
<!-- route_8_15 -->
<g id="node608" class="node">
<title>route_8_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9094" cy="-5321.58" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9094" y="-5334.38" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9094" y="-5324.38" font-family="Times,serif" font-size="9.00">GPU: 286,287</text>
<text text-anchor="middle" x="9094" y="-5314.38" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9094" y="-5304.38" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_8&#45;&gt;route_8_15 -->
<g id="edge885" class="edge">
<title>gate_8&#45;&gt;route_8_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4862.54,-5432.06C5491.36,-5431.96 7251.34,-5424.71 8714,-5352.69 8779.25,-5349.48 8850.69,-5344.26 8913.83,-5339.07"/>
<polygon fill="black" stroke="black" points="8914.22,-5342.55 8923.89,-5338.24 8913.64,-5335.58 8914.22,-5342.55"/>
</g>
<!-- expert_8_0_0 -->
<g id="node549" class="node">
<title>expert_8_0_0</title>
<polygon fill="lightgreen" stroke="black" points="382.5,-5254.46 105.5,-5254.46 105.5,-5210.46 382.5,-5210.46 382.5,-5254.46"/>
<text text-anchor="middle" x="244" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="244" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 256</text>
<text text-anchor="middle" x="244" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="244" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_0&#45;&gt;expert_8_0_0 -->
<g id="edge796" class="edge">
<title>route_8_0&#45;&gt;expert_8_0_0</title>
<path fill="none" stroke="black" d="M448.08,-5293.73C408.92,-5282.16 363.49,-5268.75 325.44,-5257.51"/>
<polygon fill="black" stroke="black" points="326.01,-5254.03 315.43,-5254.56 324.03,-5260.75 326.01,-5254.03"/>
</g>
<!-- expert_8_0_1 -->
<g id="node550" class="node">
<title>expert_8_0_1</title>
<polygon fill="lightgreen" stroke="black" points="677.5,-5254.46 400.5,-5254.46 400.5,-5210.46 677.5,-5210.46 677.5,-5254.46"/>
<text text-anchor="middle" x="539" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="539" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 257</text>
<text text-anchor="middle" x="539" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="539" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_0&#45;&gt;expert_8_0_1 -->
<g id="edge797" class="edge">
<title>route_8_0&#45;&gt;expert_8_0_1</title>
<path fill="none" stroke="black" d="M539,-5290.11C539,-5281.83 539,-5272.85 539,-5264.54"/>
<polygon fill="black" stroke="black" points="542.5,-5264.47 539,-5254.47 535.5,-5264.47 542.5,-5264.47"/>
</g>
<!-- tp_8_0 -->
<g id="node551" class="node">
<title>tp_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="539" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="539" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="539" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 256↔257</text>
<text text-anchor="middle" x="539" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="539" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_0_0&#45;&gt;tp_8_0 -->
<g id="edge798" class="edge">
<title>expert_8_0_0&#45;&gt;tp_8_0</title>
<path fill="none" stroke="black" d="M315.41,-5210.38C356.87,-5198.13 409.36,-5182.63 453.07,-5169.73"/>
<polygon fill="black" stroke="black" points="454.23,-5173.03 462.83,-5166.84 452.25,-5166.32 454.23,-5173.03"/>
</g>
<!-- expert_8_0_1&#45;&gt;tp_8_0 -->
<g id="edge799" class="edge">
<title>expert_8_0_1&#45;&gt;tp_8_0</title>
<path fill="none" stroke="black" d="M539,-5210.38C539,-5202.7 539,-5193.75 539,-5184.96"/>
<polygon fill="black" stroke="black" points="542.5,-5184.8 539,-5174.8 535.5,-5184.8 542.5,-5184.8"/>
</g>
<!-- agg_8 -->
<g id="node612" class="node">
<title>agg_8</title>
<polygon fill="lightyellow" stroke="black" points="5097.99,-5076.24 4649.4,-5076.24 4534.01,-4988.24 4982.6,-4988.24 5097.99,-5076.24"/>
<text text-anchor="middle" x="4816" y="-5045.04" font-family="Times,serif" font-size="9.00">Aggregate Experts L8</text>
<text text-anchor="middle" x="4816" y="-5035.04" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-5025.04" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4816" y="-5015.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_8_0&#45;&gt;agg_8 -->
<g id="edge800" class="edge">
<title>tp_8_0&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M649.79,-5133.8C743.96,-5126.87 882.76,-5117.42 1004,-5112.24 2359.83,-5054.32 3988.8,-5038.5 4583.92,-5034.5"/>
<polygon fill="black" stroke="black" points="4584.36,-5038 4594.33,-5034.43 4584.31,-5031 4584.36,-5038"/>
</g>
<!-- expert_8_1_0 -->
<g id="node553" class="node">
<title>expert_8_1_0</title>
<polygon fill="lightgreen" stroke="black" points="972.5,-5254.46 695.5,-5254.46 695.5,-5210.46 972.5,-5210.46 972.5,-5254.46"/>
<text text-anchor="middle" x="834" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="834" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 258</text>
<text text-anchor="middle" x="834" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="834" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_1&#45;&gt;expert_8_1_0 -->
<g id="edge802" class="edge">
<title>route_8_1&#45;&gt;expert_8_1_0</title>
<path fill="none" stroke="black" d="M1038.08,-5293.73C998.92,-5282.16 953.49,-5268.75 915.44,-5257.51"/>
<polygon fill="black" stroke="black" points="916.01,-5254.03 905.43,-5254.56 914.03,-5260.75 916.01,-5254.03"/>
</g>
<!-- expert_8_1_1 -->
<g id="node554" class="node">
<title>expert_8_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1267.5,-5254.46 990.5,-5254.46 990.5,-5210.46 1267.5,-5210.46 1267.5,-5254.46"/>
<text text-anchor="middle" x="1129" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1129" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 259</text>
<text text-anchor="middle" x="1129" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1129" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_1&#45;&gt;expert_8_1_1 -->
<g id="edge803" class="edge">
<title>route_8_1&#45;&gt;expert_8_1_1</title>
<path fill="none" stroke="black" d="M1129,-5290.11C1129,-5281.83 1129,-5272.85 1129,-5264.54"/>
<polygon fill="black" stroke="black" points="1132.5,-5264.47 1129,-5254.47 1125.5,-5264.47 1132.5,-5264.47"/>
</g>
<!-- tp_8_1 -->
<g id="node555" class="node">
<title>tp_8_1</title>
<ellipse fill="lightblue" stroke="black" cx="1129" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1129" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1129" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 258↔259</text>
<text text-anchor="middle" x="1129" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1129" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_1_0&#45;&gt;tp_8_1 -->
<g id="edge804" class="edge">
<title>expert_8_1_0&#45;&gt;tp_8_1</title>
<path fill="none" stroke="black" d="M905.41,-5210.38C946.87,-5198.13 999.36,-5182.63 1043.07,-5169.73"/>
<polygon fill="black" stroke="black" points="1044.23,-5173.03 1052.83,-5166.84 1042.25,-5166.32 1044.23,-5173.03"/>
</g>
<!-- expert_8_1_1&#45;&gt;tp_8_1 -->
<g id="edge805" class="edge">
<title>expert_8_1_1&#45;&gt;tp_8_1</title>
<path fill="none" stroke="black" d="M1129,-5210.38C1129,-5202.7 1129,-5193.75 1129,-5184.96"/>
<polygon fill="black" stroke="black" points="1132.5,-5184.8 1129,-5174.8 1125.5,-5184.8 1132.5,-5184.8"/>
</g>
<!-- tp_8_1&#45;&gt;agg_8 -->
<g id="edge806" class="edge">
<title>tp_8_1&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1239.8,-5133.92C1333.96,-5127.06 1472.77,-5117.65 1594,-5112.24 2714.94,-5062.22 4056.78,-5042.09 4585.63,-5035.71"/>
<polygon fill="black" stroke="black" points="4585.71,-5039.21 4595.67,-5035.59 4585.63,-5032.21 4585.71,-5039.21"/>
</g>
<!-- expert_8_2_0 -->
<g id="node557" class="node">
<title>expert_8_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1562.5,-5254.46 1285.5,-5254.46 1285.5,-5210.46 1562.5,-5210.46 1562.5,-5254.46"/>
<text text-anchor="middle" x="1424" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1424" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 260</text>
<text text-anchor="middle" x="1424" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1424" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_2&#45;&gt;expert_8_2_0 -->
<g id="edge808" class="edge">
<title>route_8_2&#45;&gt;expert_8_2_0</title>
<path fill="none" stroke="black" d="M1628.08,-5293.73C1588.92,-5282.16 1543.49,-5268.75 1505.44,-5257.51"/>
<polygon fill="black" stroke="black" points="1506.01,-5254.03 1495.43,-5254.56 1504.03,-5260.75 1506.01,-5254.03"/>
</g>
<!-- expert_8_2_1 -->
<g id="node558" class="node">
<title>expert_8_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1857.5,-5254.46 1580.5,-5254.46 1580.5,-5210.46 1857.5,-5210.46 1857.5,-5254.46"/>
<text text-anchor="middle" x="1719" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1719" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 261</text>
<text text-anchor="middle" x="1719" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1719" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_2&#45;&gt;expert_8_2_1 -->
<g id="edge809" class="edge">
<title>route_8_2&#45;&gt;expert_8_2_1</title>
<path fill="none" stroke="black" d="M1719,-5290.11C1719,-5281.83 1719,-5272.85 1719,-5264.54"/>
<polygon fill="black" stroke="black" points="1722.5,-5264.47 1719,-5254.47 1715.5,-5264.47 1722.5,-5264.47"/>
</g>
<!-- tp_8_2 -->
<g id="node559" class="node">
<title>tp_8_2</title>
<ellipse fill="lightblue" stroke="black" cx="1719" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1719" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1719" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 260↔261</text>
<text text-anchor="middle" x="1719" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1719" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_2_0&#45;&gt;tp_8_2 -->
<g id="edge810" class="edge">
<title>expert_8_2_0&#45;&gt;tp_8_2</title>
<path fill="none" stroke="black" d="M1495.41,-5210.38C1536.87,-5198.13 1589.36,-5182.63 1633.07,-5169.73"/>
<polygon fill="black" stroke="black" points="1634.23,-5173.03 1642.83,-5166.84 1632.25,-5166.32 1634.23,-5173.03"/>
</g>
<!-- expert_8_2_1&#45;&gt;tp_8_2 -->
<g id="edge811" class="edge">
<title>expert_8_2_1&#45;&gt;tp_8_2</title>
<path fill="none" stroke="black" d="M1719,-5210.38C1719,-5202.7 1719,-5193.75 1719,-5184.96"/>
<polygon fill="black" stroke="black" points="1722.5,-5184.8 1719,-5174.8 1715.5,-5184.8 1722.5,-5184.8"/>
</g>
<!-- tp_8_2&#45;&gt;agg_8 -->
<g id="edge812" class="edge">
<title>tp_8_2&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1829.8,-5134.09C1923.98,-5127.33 2062.79,-5117.98 2184,-5112.24 3072.74,-5070.14 4131.42,-5046.39 4587.95,-5037.42"/>
<polygon fill="black" stroke="black" points="4588.03,-5040.92 4597.96,-5037.23 4587.89,-5033.92 4588.03,-5040.92"/>
</g>
<!-- expert_8_3_0 -->
<g id="node561" class="node">
<title>expert_8_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2152.5,-5254.46 1875.5,-5254.46 1875.5,-5210.46 2152.5,-5210.46 2152.5,-5254.46"/>
<text text-anchor="middle" x="2014" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2014" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 262</text>
<text text-anchor="middle" x="2014" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2014" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_3&#45;&gt;expert_8_3_0 -->
<g id="edge814" class="edge">
<title>route_8_3&#45;&gt;expert_8_3_0</title>
<path fill="none" stroke="black" d="M2218.08,-5293.73C2178.92,-5282.16 2133.49,-5268.75 2095.44,-5257.51"/>
<polygon fill="black" stroke="black" points="2096.01,-5254.03 2085.43,-5254.56 2094.03,-5260.75 2096.01,-5254.03"/>
</g>
<!-- expert_8_3_1 -->
<g id="node562" class="node">
<title>expert_8_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2447.5,-5254.46 2170.5,-5254.46 2170.5,-5210.46 2447.5,-5210.46 2447.5,-5254.46"/>
<text text-anchor="middle" x="2309" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2309" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 263</text>
<text text-anchor="middle" x="2309" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2309" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_3&#45;&gt;expert_8_3_1 -->
<g id="edge815" class="edge">
<title>route_8_3&#45;&gt;expert_8_3_1</title>
<path fill="none" stroke="black" d="M2309,-5290.11C2309,-5281.83 2309,-5272.85 2309,-5264.54"/>
<polygon fill="black" stroke="black" points="2312.5,-5264.47 2309,-5254.47 2305.5,-5264.47 2312.5,-5264.47"/>
</g>
<!-- tp_8_3 -->
<g id="node563" class="node">
<title>tp_8_3</title>
<ellipse fill="lightblue" stroke="black" cx="2309" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2309" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2309" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 262↔263</text>
<text text-anchor="middle" x="2309" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2309" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_3_0&#45;&gt;tp_8_3 -->
<g id="edge816" class="edge">
<title>expert_8_3_0&#45;&gt;tp_8_3</title>
<path fill="none" stroke="black" d="M2085.41,-5210.38C2126.87,-5198.13 2179.36,-5182.63 2223.07,-5169.73"/>
<polygon fill="black" stroke="black" points="2224.23,-5173.03 2232.83,-5166.84 2222.25,-5166.32 2224.23,-5173.03"/>
</g>
<!-- expert_8_3_1&#45;&gt;tp_8_3 -->
<g id="edge817" class="edge">
<title>expert_8_3_1&#45;&gt;tp_8_3</title>
<path fill="none" stroke="black" d="M2309,-5210.38C2309,-5202.7 2309,-5193.75 2309,-5184.96"/>
<polygon fill="black" stroke="black" points="2312.5,-5184.8 2309,-5174.8 2305.5,-5184.8 2312.5,-5184.8"/>
</g>
<!-- tp_8_3&#45;&gt;agg_8 -->
<g id="edge818" class="edge">
<title>tp_8_3&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M2420.29,-5134.33C2514.46,-5127.74 2653.02,-5118.5 2774,-5112.24 3434.08,-5078.1 4214.88,-5051.81 4591.12,-5040.03"/>
<polygon fill="black" stroke="black" points="4591.42,-5043.52 4601.3,-5039.71 4591.2,-5036.52 4591.42,-5043.52"/>
</g>
<!-- expert_8_4_0 -->
<g id="node565" class="node">
<title>expert_8_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2742.5,-5254.46 2465.5,-5254.46 2465.5,-5210.46 2742.5,-5210.46 2742.5,-5254.46"/>
<text text-anchor="middle" x="2604" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2604" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 264</text>
<text text-anchor="middle" x="2604" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2604" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_4&#45;&gt;expert_8_4_0 -->
<g id="edge820" class="edge">
<title>route_8_4&#45;&gt;expert_8_4_0</title>
<path fill="none" stroke="black" d="M2808.08,-5293.73C2768.92,-5282.16 2723.49,-5268.75 2685.44,-5257.51"/>
<polygon fill="black" stroke="black" points="2686.01,-5254.03 2675.43,-5254.56 2684.03,-5260.75 2686.01,-5254.03"/>
</g>
<!-- expert_8_4_1 -->
<g id="node566" class="node">
<title>expert_8_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3037.5,-5254.46 2760.5,-5254.46 2760.5,-5210.46 3037.5,-5210.46 3037.5,-5254.46"/>
<text text-anchor="middle" x="2899" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2899" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 265</text>
<text text-anchor="middle" x="2899" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2899" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_4&#45;&gt;expert_8_4_1 -->
<g id="edge821" class="edge">
<title>route_8_4&#45;&gt;expert_8_4_1</title>
<path fill="none" stroke="black" d="M2899,-5290.11C2899,-5281.83 2899,-5272.85 2899,-5264.54"/>
<polygon fill="black" stroke="black" points="2902.5,-5264.47 2899,-5254.47 2895.5,-5264.47 2902.5,-5264.47"/>
</g>
<!-- tp_8_4 -->
<g id="node567" class="node">
<title>tp_8_4</title>
<ellipse fill="lightblue" stroke="black" cx="2899" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2899" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2899" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 264↔265</text>
<text text-anchor="middle" x="2899" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2899" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_4_0&#45;&gt;tp_8_4 -->
<g id="edge822" class="edge">
<title>expert_8_4_0&#45;&gt;tp_8_4</title>
<path fill="none" stroke="black" d="M2675.41,-5210.38C2716.87,-5198.13 2769.36,-5182.63 2813.07,-5169.73"/>
<polygon fill="black" stroke="black" points="2814.23,-5173.03 2822.83,-5166.84 2812.25,-5166.32 2814.23,-5173.03"/>
</g>
<!-- expert_8_4_1&#45;&gt;tp_8_4 -->
<g id="edge823" class="edge">
<title>expert_8_4_1&#45;&gt;tp_8_4</title>
<path fill="none" stroke="black" d="M2899,-5210.38C2899,-5202.7 2899,-5193.75 2899,-5184.96"/>
<polygon fill="black" stroke="black" points="2902.5,-5184.8 2899,-5174.8 2895.5,-5184.8 2902.5,-5184.8"/>
</g>
<!-- tp_8_4&#45;&gt;agg_8 -->
<g id="edge824" class="edge">
<title>tp_8_4&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3010.79,-5134.79C3104.97,-5128.49 3243.27,-5119.43 3364,-5112.24 3801.09,-5086.2 4312.42,-5059.18 4596.75,-5044.46"/>
<polygon fill="black" stroke="black" points="4596.96,-5047.96 4606.77,-5043.94 4596.6,-5040.97 4596.96,-5047.96"/>
</g>
<!-- expert_8_5_0 -->
<g id="node569" class="node">
<title>expert_8_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3332.5,-5254.46 3055.5,-5254.46 3055.5,-5210.46 3332.5,-5210.46 3332.5,-5254.46"/>
<text text-anchor="middle" x="3194" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3194" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 266</text>
<text text-anchor="middle" x="3194" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3194" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_5&#45;&gt;expert_8_5_0 -->
<g id="edge826" class="edge">
<title>route_8_5&#45;&gt;expert_8_5_0</title>
<path fill="none" stroke="black" d="M3398.08,-5293.73C3358.92,-5282.16 3313.49,-5268.75 3275.44,-5257.51"/>
<polygon fill="black" stroke="black" points="3276.01,-5254.03 3265.43,-5254.56 3274.03,-5260.75 3276.01,-5254.03"/>
</g>
<!-- expert_8_5_1 -->
<g id="node570" class="node">
<title>expert_8_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3627.5,-5254.46 3350.5,-5254.46 3350.5,-5210.46 3627.5,-5210.46 3627.5,-5254.46"/>
<text text-anchor="middle" x="3489" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3489" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 267</text>
<text text-anchor="middle" x="3489" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3489" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_5&#45;&gt;expert_8_5_1 -->
<g id="edge827" class="edge">
<title>route_8_5&#45;&gt;expert_8_5_1</title>
<path fill="none" stroke="black" d="M3489,-5290.11C3489,-5281.83 3489,-5272.85 3489,-5264.54"/>
<polygon fill="black" stroke="black" points="3492.5,-5264.47 3489,-5254.47 3485.5,-5264.47 3492.5,-5264.47"/>
</g>
<!-- tp_8_5 -->
<g id="node571" class="node">
<title>tp_8_5</title>
<ellipse fill="lightblue" stroke="black" cx="3489" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3489" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3489" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 266↔267</text>
<text text-anchor="middle" x="3489" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3489" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_5_0&#45;&gt;tp_8_5 -->
<g id="edge828" class="edge">
<title>expert_8_5_0&#45;&gt;tp_8_5</title>
<path fill="none" stroke="black" d="M3265.41,-5210.38C3306.87,-5198.13 3359.36,-5182.63 3403.07,-5169.73"/>
<polygon fill="black" stroke="black" points="3404.23,-5173.03 3412.83,-5166.84 3402.25,-5166.32 3404.23,-5173.03"/>
</g>
<!-- expert_8_5_1&#45;&gt;tp_8_5 -->
<g id="edge829" class="edge">
<title>expert_8_5_1&#45;&gt;tp_8_5</title>
<path fill="none" stroke="black" d="M3489,-5210.38C3489,-5202.7 3489,-5193.75 3489,-5184.96"/>
<polygon fill="black" stroke="black" points="3492.5,-5184.8 3489,-5174.8 3485.5,-5184.8 3492.5,-5184.8"/>
</g>
<!-- tp_8_5&#45;&gt;agg_8 -->
<g id="edge830" class="edge">
<title>tp_8_5&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M3599.01,-5133.31C3819.49,-5115.18 4318.79,-5074.12 4604.61,-5050.62"/>
<polygon fill="black" stroke="black" points="4605.01,-5054.1 4614.69,-5049.79 4604.44,-5047.12 4605.01,-5054.1"/>
</g>
<!-- expert_8_6_0 -->
<g id="node573" class="node">
<title>expert_8_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3922.5,-5254.46 3645.5,-5254.46 3645.5,-5210.46 3922.5,-5210.46 3922.5,-5254.46"/>
<text text-anchor="middle" x="3784" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3784" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 268</text>
<text text-anchor="middle" x="3784" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3784" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_6&#45;&gt;expert_8_6_0 -->
<g id="edge832" class="edge">
<title>route_8_6&#45;&gt;expert_8_6_0</title>
<path fill="none" stroke="black" d="M3988.08,-5293.73C3948.92,-5282.16 3903.49,-5268.75 3865.44,-5257.51"/>
<polygon fill="black" stroke="black" points="3866.01,-5254.03 3855.43,-5254.56 3864.03,-5260.75 3866.01,-5254.03"/>
</g>
<!-- expert_8_6_1 -->
<g id="node574" class="node">
<title>expert_8_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-5254.46 3940.5,-5254.46 3940.5,-5210.46 4217.5,-5210.46 4217.5,-5254.46"/>
<text text-anchor="middle" x="4079" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4079" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 269</text>
<text text-anchor="middle" x="4079" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4079" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_6&#45;&gt;expert_8_6_1 -->
<g id="edge833" class="edge">
<title>route_8_6&#45;&gt;expert_8_6_1</title>
<path fill="none" stroke="black" d="M4079,-5290.11C4079,-5281.83 4079,-5272.85 4079,-5264.54"/>
<polygon fill="black" stroke="black" points="4082.5,-5264.47 4079,-5254.47 4075.5,-5264.47 4082.5,-5264.47"/>
</g>
<!-- tp_8_6 -->
<g id="node575" class="node">
<title>tp_8_6</title>
<ellipse fill="lightblue" stroke="black" cx="4079" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4079" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4079" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 268↔269</text>
<text text-anchor="middle" x="4079" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4079" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_6_0&#45;&gt;tp_8_6 -->
<g id="edge834" class="edge">
<title>expert_8_6_0&#45;&gt;tp_8_6</title>
<path fill="none" stroke="black" d="M3855.41,-5210.38C3896.87,-5198.13 3949.36,-5182.63 3993.07,-5169.73"/>
<polygon fill="black" stroke="black" points="3994.23,-5173.03 4002.83,-5166.84 3992.25,-5166.32 3994.23,-5173.03"/>
</g>
<!-- expert_8_6_1&#45;&gt;tp_8_6 -->
<g id="edge835" class="edge">
<title>expert_8_6_1&#45;&gt;tp_8_6</title>
<path fill="none" stroke="black" d="M4079,-5210.38C4079,-5202.7 4079,-5193.75 4079,-5184.96"/>
<polygon fill="black" stroke="black" points="4082.5,-5184.8 4079,-5174.8 4075.5,-5184.8 4082.5,-5184.8"/>
</g>
<!-- tp_8_6&#45;&gt;agg_8 -->
<g id="edge836" class="edge">
<title>tp_8_6&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M4179.16,-5127.52C4291.68,-5110.86 4477.1,-5083.41 4618.93,-5062.42"/>
<polygon fill="black" stroke="black" points="4619.68,-5065.84 4629.06,-5060.92 4618.66,-5058.92 4619.68,-5065.84"/>
</g>
<!-- expert_8_7_0 -->
<g id="node577" class="node">
<title>expert_8_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4512.5,-5254.46 4235.5,-5254.46 4235.5,-5210.46 4512.5,-5210.46 4512.5,-5254.46"/>
<text text-anchor="middle" x="4374" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4374" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 270</text>
<text text-anchor="middle" x="4374" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4374" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_7&#45;&gt;expert_8_7_0 -->
<g id="edge838" class="edge">
<title>route_8_7&#45;&gt;expert_8_7_0</title>
<path fill="none" stroke="black" d="M4545.24,-5292.89C4512.84,-5281.65 4475.74,-5268.78 4444.37,-5257.89"/>
<polygon fill="black" stroke="black" points="4445.43,-5254.55 4434.84,-5254.58 4443.14,-5261.16 4445.43,-5254.55"/>
</g>
<!-- expert_8_7_1 -->
<g id="node578" class="node">
<title>expert_8_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4807.5,-5254.46 4530.5,-5254.46 4530.5,-5210.46 4807.5,-5210.46 4807.5,-5254.46"/>
<text text-anchor="middle" x="4669" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4669" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 271</text>
<text text-anchor="middle" x="4669" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4669" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_7&#45;&gt;expert_8_7_1 -->
<g id="edge839" class="edge">
<title>route_8_7&#45;&gt;expert_8_7_1</title>
<path fill="none" stroke="black" d="M4640.39,-5290.11C4644.76,-5281.46 4649.51,-5272.06 4653.86,-5263.44"/>
<polygon fill="black" stroke="black" points="4657.01,-5264.97 4658.39,-5254.47 4650.76,-5261.82 4657.01,-5264.97"/>
</g>
<!-- tp_8_7 -->
<g id="node579" class="node">
<title>tp_8_7</title>
<ellipse fill="lightblue" stroke="black" cx="4669" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4669" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4669" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 270↔271</text>
<text text-anchor="middle" x="4669" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4669" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_7_0&#45;&gt;tp_8_7 -->
<g id="edge840" class="edge">
<title>expert_8_7_0&#45;&gt;tp_8_7</title>
<path fill="none" stroke="black" d="M4445.41,-5210.38C4486.87,-5198.13 4539.36,-5182.63 4583.07,-5169.73"/>
<polygon fill="black" stroke="black" points="4584.23,-5173.03 4592.83,-5166.84 4582.25,-5166.32 4584.23,-5173.03"/>
</g>
<!-- expert_8_7_1&#45;&gt;tp_8_7 -->
<g id="edge841" class="edge">
<title>expert_8_7_1&#45;&gt;tp_8_7</title>
<path fill="none" stroke="black" d="M4669,-5210.38C4669,-5202.7 4669,-5193.75 4669,-5184.96"/>
<polygon fill="black" stroke="black" points="4672.5,-5184.8 4669,-5174.8 4665.5,-5184.8 4672.5,-5184.8"/>
</g>
<!-- tp_8_7&#45;&gt;agg_8 -->
<g id="edge842" class="edge">
<title>tp_8_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M4707.24,-5113.97C4720.3,-5104.27 4735.31,-5093.13 4749.93,-5082.28"/>
<polygon fill="black" stroke="black" points="4752.05,-5085.07 4757.99,-5076.3 4747.88,-5079.45 4752.05,-5085.07"/>
</g>
<!-- expert_8_8_0 -->
<g id="node581" class="node">
<title>expert_8_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5102.5,-5254.46 4825.5,-5254.46 4825.5,-5210.46 5102.5,-5210.46 5102.5,-5254.46"/>
<text text-anchor="middle" x="4964" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4964" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 272</text>
<text text-anchor="middle" x="4964" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4964" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_8&#45;&gt;expert_8_8_0 -->
<g id="edge844" class="edge">
<title>route_8_8&#45;&gt;expert_8_8_0</title>
<path fill="none" stroke="black" d="M5017.12,-5290.6C5008.54,-5281.37 4999.12,-5271.24 4990.63,-5262.1"/>
<polygon fill="black" stroke="black" points="4993.12,-5259.64 4983.75,-5254.7 4988,-5264.41 4993.12,-5259.64"/>
</g>
<!-- expert_8_8_1 -->
<g id="node582" class="node">
<title>expert_8_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5397.5,-5254.46 5120.5,-5254.46 5120.5,-5210.46 5397.5,-5210.46 5397.5,-5254.46"/>
<text text-anchor="middle" x="5259" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5259" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 273</text>
<text text-anchor="middle" x="5259" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5259" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_8&#45;&gt;expert_8_8_1 -->
<g id="edge845" class="edge">
<title>route_8_8&#45;&gt;expert_8_8_1</title>
<path fill="none" stroke="black" d="M5114.48,-5292.29C5141.33,-5281.37 5171.78,-5268.97 5197.79,-5258.38"/>
<polygon fill="black" stroke="black" points="5199.21,-5261.58 5207.16,-5254.57 5196.58,-5255.1 5199.21,-5261.58"/>
</g>
<!-- tp_8_8 -->
<g id="node583" class="node">
<title>tp_8_8</title>
<ellipse fill="lightblue" stroke="black" cx="4964" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4964" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4964" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 272↔273</text>
<text text-anchor="middle" x="4964" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4964" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_8_0&#45;&gt;tp_8_8 -->
<g id="edge846" class="edge">
<title>expert_8_8_0&#45;&gt;tp_8_8</title>
<path fill="none" stroke="black" d="M4964,-5210.38C4964,-5202.7 4964,-5193.75 4964,-5184.96"/>
<polygon fill="black" stroke="black" points="4967.5,-5184.8 4964,-5174.8 4960.5,-5184.8 4967.5,-5184.8"/>
</g>
<!-- expert_8_8_1&#45;&gt;tp_8_8 -->
<g id="edge847" class="edge">
<title>expert_8_8_1&#45;&gt;tp_8_8</title>
<path fill="none" stroke="black" d="M5187.59,-5210.38C5146.13,-5198.13 5093.64,-5182.63 5049.93,-5169.73"/>
<polygon fill="black" stroke="black" points="5050.75,-5166.32 5040.17,-5166.84 5048.77,-5173.03 5050.75,-5166.32"/>
</g>
<!-- tp_8_8&#45;&gt;agg_8 -->
<g id="edge848" class="edge">
<title>tp_8_8&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M4925.5,-5113.97C4912.35,-5104.27 4897.24,-5093.13 4882.52,-5082.28"/>
<polygon fill="black" stroke="black" points="4884.53,-5079.41 4874.4,-5076.3 4880.37,-5085.05 4884.53,-5079.41"/>
</g>
<!-- expert_8_9_0 -->
<g id="node585" class="node">
<title>expert_8_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5692.5,-5254.46 5415.5,-5254.46 5415.5,-5210.46 5692.5,-5210.46 5692.5,-5254.46"/>
<text text-anchor="middle" x="5554" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5554" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 274</text>
<text text-anchor="middle" x="5554" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5554" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_9&#45;&gt;expert_8_9_0 -->
<g id="edge850" class="edge">
<title>route_8_9&#45;&gt;expert_8_9_0</title>
<path fill="none" stroke="black" d="M5554,-5290.11C5554,-5281.83 5554,-5272.85 5554,-5264.54"/>
<polygon fill="black" stroke="black" points="5557.5,-5264.47 5554,-5254.47 5550.5,-5264.47 5557.5,-5264.47"/>
</g>
<!-- expert_8_9_1 -->
<g id="node586" class="node">
<title>expert_8_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5987.5,-5254.46 5710.5,-5254.46 5710.5,-5210.46 5987.5,-5210.46 5987.5,-5254.46"/>
<text text-anchor="middle" x="5849" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5849" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 275</text>
<text text-anchor="middle" x="5849" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5849" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_9&#45;&gt;expert_8_9_1 -->
<g id="edge851" class="edge">
<title>route_8_9&#45;&gt;expert_8_9_1</title>
<path fill="none" stroke="black" d="M5644.92,-5293.73C5684.08,-5282.16 5729.51,-5268.75 5767.56,-5257.51"/>
<polygon fill="black" stroke="black" points="5768.97,-5260.75 5777.57,-5254.56 5766.99,-5254.03 5768.97,-5260.75"/>
</g>
<!-- tp_8_9 -->
<g id="node587" class="node">
<title>tp_8_9</title>
<ellipse fill="lightblue" stroke="black" cx="5554" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5554" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5554" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 274↔275</text>
<text text-anchor="middle" x="5554" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5554" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_9_0&#45;&gt;tp_8_9 -->
<g id="edge852" class="edge">
<title>expert_8_9_0&#45;&gt;tp_8_9</title>
<path fill="none" stroke="black" d="M5554,-5210.38C5554,-5202.7 5554,-5193.75 5554,-5184.96"/>
<polygon fill="black" stroke="black" points="5557.5,-5184.8 5554,-5174.8 5550.5,-5184.8 5557.5,-5184.8"/>
</g>
<!-- expert_8_9_1&#45;&gt;tp_8_9 -->
<g id="edge853" class="edge">
<title>expert_8_9_1&#45;&gt;tp_8_9</title>
<path fill="none" stroke="black" d="M5777.59,-5210.38C5736.13,-5198.13 5683.64,-5182.63 5639.93,-5169.73"/>
<polygon fill="black" stroke="black" points="5640.75,-5166.32 5630.17,-5166.84 5638.77,-5173.03 5640.75,-5166.32"/>
</g>
<!-- tp_8_9&#45;&gt;agg_8 -->
<g id="edge854" class="edge">
<title>tp_8_9&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M5453.7,-5127.52C5364.3,-5114.3 5228.93,-5094.29 5105.87,-5076.1"/>
<polygon fill="black" stroke="black" points="5106.31,-5072.62 5095.9,-5074.62 5105.28,-5079.55 5106.31,-5072.62"/>
</g>
<!-- expert_8_10_0 -->
<g id="node589" class="node">
<title>expert_8_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6282.5,-5254.46 6005.5,-5254.46 6005.5,-5210.46 6282.5,-5210.46 6282.5,-5254.46"/>
<text text-anchor="middle" x="6144" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6144" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 276</text>
<text text-anchor="middle" x="6144" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6144" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_10&#45;&gt;expert_8_10_0 -->
<g id="edge856" class="edge">
<title>route_8_10&#45;&gt;expert_8_10_0</title>
<path fill="none" stroke="black" d="M6144,-5290.11C6144,-5281.83 6144,-5272.85 6144,-5264.54"/>
<polygon fill="black" stroke="black" points="6147.5,-5264.47 6144,-5254.47 6140.5,-5264.47 6147.5,-5264.47"/>
</g>
<!-- expert_8_10_1 -->
<g id="node590" class="node">
<title>expert_8_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6577.5,-5254.46 6300.5,-5254.46 6300.5,-5210.46 6577.5,-5210.46 6577.5,-5254.46"/>
<text text-anchor="middle" x="6439" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6439" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 277</text>
<text text-anchor="middle" x="6439" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6439" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_10&#45;&gt;expert_8_10_1 -->
<g id="edge857" class="edge">
<title>route_8_10&#45;&gt;expert_8_10_1</title>
<path fill="none" stroke="black" d="M6234.92,-5293.73C6274.08,-5282.16 6319.51,-5268.75 6357.56,-5257.51"/>
<polygon fill="black" stroke="black" points="6358.97,-5260.75 6367.57,-5254.56 6356.99,-5254.03 6358.97,-5260.75"/>
</g>
<!-- tp_8_10 -->
<g id="node591" class="node">
<title>tp_8_10</title>
<ellipse fill="lightblue" stroke="black" cx="6144" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6144" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6144" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 276↔277</text>
<text text-anchor="middle" x="6144" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6144" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_10_0&#45;&gt;tp_8_10 -->
<g id="edge858" class="edge">
<title>expert_8_10_0&#45;&gt;tp_8_10</title>
<path fill="none" stroke="black" d="M6144,-5210.38C6144,-5202.7 6144,-5193.75 6144,-5184.96"/>
<polygon fill="black" stroke="black" points="6147.5,-5184.8 6144,-5174.8 6140.5,-5184.8 6147.5,-5184.8"/>
</g>
<!-- expert_8_10_1&#45;&gt;tp_8_10 -->
<g id="edge859" class="edge">
<title>expert_8_10_1&#45;&gt;tp_8_10</title>
<path fill="none" stroke="black" d="M6367.59,-5210.38C6326.13,-5198.13 6273.64,-5182.63 6229.93,-5169.73"/>
<polygon fill="black" stroke="black" points="6230.75,-5166.32 6220.17,-5166.84 6228.77,-5173.03 6230.75,-5166.32"/>
</g>
<!-- tp_8_10&#45;&gt;agg_8 -->
<g id="edge860" class="edge">
<title>tp_8_10&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M6034.19,-5133.33C5826.46,-5116.26 5370.69,-5078.81 5079.33,-5054.87"/>
<polygon fill="black" stroke="black" points="5079.29,-5051.36 5069.03,-5054.03 5078.71,-5058.34 5079.29,-5051.36"/>
</g>
<!-- expert_8_11_0 -->
<g id="node593" class="node">
<title>expert_8_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6872.5,-5254.46 6595.5,-5254.46 6595.5,-5210.46 6872.5,-5210.46 6872.5,-5254.46"/>
<text text-anchor="middle" x="6734" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6734" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 278</text>
<text text-anchor="middle" x="6734" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6734" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_11&#45;&gt;expert_8_11_0 -->
<g id="edge862" class="edge">
<title>route_8_11&#45;&gt;expert_8_11_0</title>
<path fill="none" stroke="black" d="M6734,-5290.11C6734,-5281.83 6734,-5272.85 6734,-5264.54"/>
<polygon fill="black" stroke="black" points="6737.5,-5264.47 6734,-5254.47 6730.5,-5264.47 6737.5,-5264.47"/>
</g>
<!-- expert_8_11_1 -->
<g id="node594" class="node">
<title>expert_8_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7167.5,-5254.46 6890.5,-5254.46 6890.5,-5210.46 7167.5,-5210.46 7167.5,-5254.46"/>
<text text-anchor="middle" x="7029" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7029" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 279</text>
<text text-anchor="middle" x="7029" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7029" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_11&#45;&gt;expert_8_11_1 -->
<g id="edge863" class="edge">
<title>route_8_11&#45;&gt;expert_8_11_1</title>
<path fill="none" stroke="black" d="M6824.92,-5293.73C6864.08,-5282.16 6909.51,-5268.75 6947.56,-5257.51"/>
<polygon fill="black" stroke="black" points="6948.97,-5260.75 6957.57,-5254.56 6946.99,-5254.03 6948.97,-5260.75"/>
</g>
<!-- tp_8_11 -->
<g id="node595" class="node">
<title>tp_8_11</title>
<ellipse fill="lightblue" stroke="black" cx="6734" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6734" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6734" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 278↔279</text>
<text text-anchor="middle" x="6734" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6734" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_11_0&#45;&gt;tp_8_11 -->
<g id="edge864" class="edge">
<title>expert_8_11_0&#45;&gt;tp_8_11</title>
<path fill="none" stroke="black" d="M6734,-5210.38C6734,-5202.7 6734,-5193.75 6734,-5184.96"/>
<polygon fill="black" stroke="black" points="6737.5,-5184.8 6734,-5174.8 6730.5,-5184.8 6737.5,-5184.8"/>
</g>
<!-- expert_8_11_1&#45;&gt;tp_8_11 -->
<g id="edge865" class="edge">
<title>expert_8_11_1&#45;&gt;tp_8_11</title>
<path fill="none" stroke="black" d="M6957.59,-5210.38C6916.13,-5198.13 6863.64,-5182.63 6819.93,-5169.73"/>
<polygon fill="black" stroke="black" points="6820.75,-5166.32 6810.17,-5166.84 6818.77,-5173.03 6820.75,-5166.32"/>
</g>
<!-- tp_8_11&#45;&gt;agg_8 -->
<g id="edge866" class="edge">
<title>tp_8_11&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M6622.21,-5134.79C6528.03,-5128.49 6389.73,-5119.43 6269,-5112.24 5847.96,-5087.16 5358.09,-5061.19 5068.26,-5046.16"/>
<polygon fill="black" stroke="black" points="5068.2,-5042.65 5058.03,-5045.63 5067.84,-5049.64 5068.2,-5042.65"/>
</g>
<!-- expert_8_12_0 -->
<g id="node597" class="node">
<title>expert_8_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7462.5,-5254.46 7185.5,-5254.46 7185.5,-5210.46 7462.5,-5210.46 7462.5,-5254.46"/>
<text text-anchor="middle" x="7324" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7324" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 280</text>
<text text-anchor="middle" x="7324" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7324" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_12&#45;&gt;expert_8_12_0 -->
<g id="edge868" class="edge">
<title>route_8_12&#45;&gt;expert_8_12_0</title>
<path fill="none" stroke="black" d="M7324,-5290.11C7324,-5281.83 7324,-5272.85 7324,-5264.54"/>
<polygon fill="black" stroke="black" points="7327.5,-5264.47 7324,-5254.47 7320.5,-5264.47 7327.5,-5264.47"/>
</g>
<!-- expert_8_12_1 -->
<g id="node598" class="node">
<title>expert_8_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7757.5,-5254.46 7480.5,-5254.46 7480.5,-5210.46 7757.5,-5210.46 7757.5,-5254.46"/>
<text text-anchor="middle" x="7619" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7619" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 281</text>
<text text-anchor="middle" x="7619" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7619" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_12&#45;&gt;expert_8_12_1 -->
<g id="edge869" class="edge">
<title>route_8_12&#45;&gt;expert_8_12_1</title>
<path fill="none" stroke="black" d="M7414.92,-5293.73C7454.08,-5282.16 7499.51,-5268.75 7537.56,-5257.51"/>
<polygon fill="black" stroke="black" points="7538.97,-5260.75 7547.57,-5254.56 7536.99,-5254.03 7538.97,-5260.75"/>
</g>
<!-- tp_8_12 -->
<g id="node599" class="node">
<title>tp_8_12</title>
<ellipse fill="lightblue" stroke="black" cx="7324" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7324" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7324" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 280↔281</text>
<text text-anchor="middle" x="7324" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7324" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_12_0&#45;&gt;tp_8_12 -->
<g id="edge870" class="edge">
<title>expert_8_12_0&#45;&gt;tp_8_12</title>
<path fill="none" stroke="black" d="M7324,-5210.38C7324,-5202.7 7324,-5193.75 7324,-5184.96"/>
<polygon fill="black" stroke="black" points="7327.5,-5184.8 7324,-5174.8 7320.5,-5184.8 7327.5,-5184.8"/>
</g>
<!-- expert_8_12_1&#45;&gt;tp_8_12 -->
<g id="edge871" class="edge">
<title>expert_8_12_1&#45;&gt;tp_8_12</title>
<path fill="none" stroke="black" d="M7547.59,-5210.38C7506.13,-5198.13 7453.64,-5182.63 7409.93,-5169.73"/>
<polygon fill="black" stroke="black" points="7410.75,-5166.32 7400.17,-5166.84 7408.77,-5173.03 7410.75,-5166.32"/>
</g>
<!-- tp_8_12&#45;&gt;agg_8 -->
<g id="edge872" class="edge">
<title>tp_8_12&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M7212.71,-5134.33C7118.54,-5127.74 6979.98,-5118.49 6859,-5112.24 6210.3,-5078.7 5445.04,-5052.74 5061.37,-5040.66"/>
<polygon fill="black" stroke="black" points="5061.36,-5037.16 5051.26,-5040.35 5061.14,-5044.16 5061.36,-5037.16"/>
</g>
<!-- expert_8_13_0 -->
<g id="node601" class="node">
<title>expert_8_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8052.5,-5254.46 7775.5,-5254.46 7775.5,-5210.46 8052.5,-5210.46 8052.5,-5254.46"/>
<text text-anchor="middle" x="7914" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7914" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 282</text>
<text text-anchor="middle" x="7914" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7914" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_13&#45;&gt;expert_8_13_0 -->
<g id="edge874" class="edge">
<title>route_8_13&#45;&gt;expert_8_13_0</title>
<path fill="none" stroke="black" d="M7914,-5290.11C7914,-5281.83 7914,-5272.85 7914,-5264.54"/>
<polygon fill="black" stroke="black" points="7917.5,-5264.47 7914,-5254.47 7910.5,-5264.47 7917.5,-5264.47"/>
</g>
<!-- expert_8_13_1 -->
<g id="node602" class="node">
<title>expert_8_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8347.5,-5254.46 8070.5,-5254.46 8070.5,-5210.46 8347.5,-5210.46 8347.5,-5254.46"/>
<text text-anchor="middle" x="8209" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8209" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 283</text>
<text text-anchor="middle" x="8209" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8209" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_13&#45;&gt;expert_8_13_1 -->
<g id="edge875" class="edge">
<title>route_8_13&#45;&gt;expert_8_13_1</title>
<path fill="none" stroke="black" d="M8004.92,-5293.73C8044.08,-5282.16 8089.51,-5268.75 8127.56,-5257.51"/>
<polygon fill="black" stroke="black" points="8128.97,-5260.75 8137.57,-5254.56 8126.99,-5254.03 8128.97,-5260.75"/>
</g>
<!-- tp_8_13 -->
<g id="node603" class="node">
<title>tp_8_13</title>
<ellipse fill="lightblue" stroke="black" cx="7914" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7914" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7914" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 282↔283</text>
<text text-anchor="middle" x="7914" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7914" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_13_0&#45;&gt;tp_8_13 -->
<g id="edge876" class="edge">
<title>expert_8_13_0&#45;&gt;tp_8_13</title>
<path fill="none" stroke="black" d="M7914,-5210.38C7914,-5202.7 7914,-5193.75 7914,-5184.96"/>
<polygon fill="black" stroke="black" points="7917.5,-5184.8 7914,-5174.8 7910.5,-5184.8 7917.5,-5184.8"/>
</g>
<!-- expert_8_13_1&#45;&gt;tp_8_13 -->
<g id="edge877" class="edge">
<title>expert_8_13_1&#45;&gt;tp_8_13</title>
<path fill="none" stroke="black" d="M8137.59,-5210.38C8096.13,-5198.13 8043.64,-5182.63 7999.93,-5169.73"/>
<polygon fill="black" stroke="black" points="8000.75,-5166.32 7990.17,-5166.84 7998.77,-5173.03 8000.75,-5166.32"/>
</g>
<!-- tp_8_13&#45;&gt;agg_8 -->
<g id="edge878" class="edge">
<title>tp_8_13&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M7803.2,-5134.09C7709.02,-5127.33 7570.21,-5117.98 7449,-5112.24 6568.43,-5070.53 5521.09,-5046.84 5057.4,-5037.68"/>
<polygon fill="black" stroke="black" points="5057.3,-5034.18 5047.24,-5037.48 5057.17,-5041.18 5057.3,-5034.18"/>
</g>
<!-- expert_8_14_0 -->
<g id="node605" class="node">
<title>expert_8_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8642.5,-5254.46 8365.5,-5254.46 8365.5,-5210.46 8642.5,-5210.46 8642.5,-5254.46"/>
<text text-anchor="middle" x="8504" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8504" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 284</text>
<text text-anchor="middle" x="8504" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8504" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_14&#45;&gt;expert_8_14_0 -->
<g id="edge880" class="edge">
<title>route_8_14&#45;&gt;expert_8_14_0</title>
<path fill="none" stroke="black" d="M8504,-5290.11C8504,-5281.83 8504,-5272.85 8504,-5264.54"/>
<polygon fill="black" stroke="black" points="8507.5,-5264.47 8504,-5254.47 8500.5,-5264.47 8507.5,-5264.47"/>
</g>
<!-- expert_8_14_1 -->
<g id="node606" class="node">
<title>expert_8_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8937.5,-5254.46 8660.5,-5254.46 8660.5,-5210.46 8937.5,-5210.46 8937.5,-5254.46"/>
<text text-anchor="middle" x="8799" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8799" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 285</text>
<text text-anchor="middle" x="8799" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8799" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_14&#45;&gt;expert_8_14_1 -->
<g id="edge881" class="edge">
<title>route_8_14&#45;&gt;expert_8_14_1</title>
<path fill="none" stroke="black" d="M8594.92,-5293.73C8634.08,-5282.16 8679.51,-5268.75 8717.56,-5257.51"/>
<polygon fill="black" stroke="black" points="8718.97,-5260.75 8727.57,-5254.56 8716.99,-5254.03 8718.97,-5260.75"/>
</g>
<!-- tp_8_14 -->
<g id="node607" class="node">
<title>tp_8_14</title>
<ellipse fill="lightblue" stroke="black" cx="8504" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8504" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8504" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 284↔285</text>
<text text-anchor="middle" x="8504" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8504" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_14_0&#45;&gt;tp_8_14 -->
<g id="edge882" class="edge">
<title>expert_8_14_0&#45;&gt;tp_8_14</title>
<path fill="none" stroke="black" d="M8504,-5210.38C8504,-5202.7 8504,-5193.75 8504,-5184.96"/>
<polygon fill="black" stroke="black" points="8507.5,-5184.8 8504,-5174.8 8500.5,-5184.8 8507.5,-5184.8"/>
</g>
<!-- expert_8_14_1&#45;&gt;tp_8_14 -->
<g id="edge883" class="edge">
<title>expert_8_14_1&#45;&gt;tp_8_14</title>
<path fill="none" stroke="black" d="M8727.59,-5210.38C8686.13,-5198.13 8633.64,-5182.63 8589.93,-5169.73"/>
<polygon fill="black" stroke="black" points="8590.75,-5166.32 8580.17,-5166.84 8588.77,-5173.03 8590.75,-5166.32"/>
</g>
<!-- tp_8_14&#45;&gt;agg_8 -->
<g id="edge884" class="edge">
<title>tp_8_14&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M8393.2,-5133.92C8299.04,-5127.06 8160.23,-5117.65 8039,-5112.24 6923.96,-5062.49 5590.42,-5042.31 5055.36,-5035.82"/>
<polygon fill="black" stroke="black" points="5055.25,-5032.32 5045.21,-5035.7 5055.16,-5039.32 5055.25,-5032.32"/>
</g>
<!-- expert_8_15_0 -->
<g id="node609" class="node">
<title>expert_8_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9232.5,-5254.46 8955.5,-5254.46 8955.5,-5210.46 9232.5,-5210.46 9232.5,-5254.46"/>
<text text-anchor="middle" x="9094" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9094" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 286</text>
<text text-anchor="middle" x="9094" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9094" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_15&#45;&gt;expert_8_15_0 -->
<g id="edge886" class="edge">
<title>route_8_15&#45;&gt;expert_8_15_0</title>
<path fill="none" stroke="black" d="M9094,-5290.11C9094,-5281.83 9094,-5272.85 9094,-5264.54"/>
<polygon fill="black" stroke="black" points="9097.5,-5264.47 9094,-5254.47 9090.5,-5264.47 9097.5,-5264.47"/>
</g>
<!-- expert_8_15_1 -->
<g id="node610" class="node">
<title>expert_8_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9527.5,-5254.46 9250.5,-5254.46 9250.5,-5210.46 9527.5,-5210.46 9527.5,-5254.46"/>
<text text-anchor="middle" x="9389" y="-5245.26" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9389" y="-5235.26" font-family="Times,serif" font-size="9.00">GPU: 287</text>
<text text-anchor="middle" x="9389" y="-5225.26" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9389" y="-5215.26" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_8_15&#45;&gt;expert_8_15_1 -->
<g id="edge887" class="edge">
<title>route_8_15&#45;&gt;expert_8_15_1</title>
<path fill="none" stroke="black" d="M9184.92,-5293.73C9224.08,-5282.16 9269.51,-5268.75 9307.56,-5257.51"/>
<polygon fill="black" stroke="black" points="9308.97,-5260.75 9317.57,-5254.56 9306.99,-5254.03 9308.97,-5260.75"/>
</g>
<!-- tp_8_15 -->
<g id="node611" class="node">
<title>tp_8_15</title>
<ellipse fill="lightblue" stroke="black" cx="9094" cy="-5143.35" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9094" y="-5156.15" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9094" y="-5146.15" font-family="Times,serif" font-size="9.00">GPU: 286↔287</text>
<text text-anchor="middle" x="9094" y="-5136.15" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9094" y="-5126.15" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_8_15_0&#45;&gt;tp_8_15 -->
<g id="edge888" class="edge">
<title>expert_8_15_0&#45;&gt;tp_8_15</title>
<path fill="none" stroke="black" d="M9094,-5210.38C9094,-5202.7 9094,-5193.75 9094,-5184.96"/>
<polygon fill="black" stroke="black" points="9097.5,-5184.8 9094,-5174.8 9090.5,-5184.8 9097.5,-5184.8"/>
</g>
<!-- expert_8_15_1&#45;&gt;tp_8_15 -->
<g id="edge889" class="edge">
<title>expert_8_15_1&#45;&gt;tp_8_15</title>
<path fill="none" stroke="black" d="M9317.59,-5210.38C9276.13,-5198.13 9223.64,-5182.63 9179.93,-5169.73"/>
<polygon fill="black" stroke="black" points="9180.75,-5166.32 9170.17,-5166.84 9178.77,-5173.03 9180.75,-5166.32"/>
</g>
<!-- tp_8_15&#45;&gt;agg_8 -->
<g id="edge890" class="edge">
<title>tp_8_15&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M8983.21,-5133.8C8889.04,-5126.87 8750.24,-5117.42 8629,-5112.24 7276.8,-5054.48 5652.99,-5038.59 5053.41,-5034.53"/>
<polygon fill="black" stroke="black" points="5053.38,-5031.03 5043.35,-5034.47 5053.33,-5038.03 5053.38,-5031.03"/>
</g>
<!-- output_8 -->
<g id="node613" class="node">
<title>output_8</title>
<polygon fill="lightgreen" stroke="black" points="4964,-4952.24 4668,-4952.24 4668,-4908.24 4964,-4908.24 4964,-4952.24"/>
<text text-anchor="middle" x="4816" y="-4943.04" font-family="Times,serif" font-size="9.00">Layer 8 Output</text>
<text text-anchor="middle" x="4816" y="-4933.04" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4923.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4816" y="-4913.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_8&#45;&gt;output_8 -->
<g id="edge891" class="edge">
<title>agg_8&#45;&gt;output_8</title>
<path fill="none" stroke="black" d="M4816,-4987.96C4816,-4979.37 4816,-4970.51 4816,-4962.42"/>
<polygon fill="black" stroke="black" points="4819.5,-4962.32 4816,-4952.32 4812.5,-4962.32 4819.5,-4962.32"/>
</g>
<!-- mha_9 -->
<g id="node614" class="node">
<title>mha_9</title>
<polygon fill="lightgreen" stroke="black" points="4964,-4872.24 4668,-4872.24 4668,-4828.24 4964,-4828.24 4964,-4872.24"/>
<text text-anchor="middle" x="4816" y="-4863.04" font-family="Times,serif" font-size="9.00">MHA L9</text>
<text text-anchor="middle" x="4816" y="-4853.04" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4843.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4816" y="-4833.04" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_8&#45;&gt;mha_9 -->
<g id="edge892" class="edge">
<title>output_8&#45;&gt;mha_9</title>
<path fill="none" stroke="black" d="M4816,-4907.92C4816,-4900.04 4816,-4890.92 4816,-4882.34"/>
<polygon fill="black" stroke="black" points="4819.5,-4882.26 4816,-4872.26 4812.5,-4882.26 4819.5,-4882.26"/>
</g>
<!-- gate_9 -->
<g id="node615" class="node">
<title>gate_9</title>
<polygon fill="lightyellow" stroke="black" points="5115.74,-4792.24 4638.92,-4792.24 4516.26,-4704.24 4993.08,-4704.24 5115.74,-4792.24"/>
<text text-anchor="middle" x="4816" y="-4761.04" font-family="Times,serif" font-size="9.00">Gate L9</text>
<text text-anchor="middle" x="4816" y="-4751.04" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4741.04" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4816" y="-4731.04" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_9&#45;&gt;gate_9 -->
<g id="edge893" class="edge">
<title>mha_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M4816,-4828.03C4816,-4820.53 4816,-4811.73 4816,-4802.76"/>
<polygon fill="black" stroke="black" points="4819.5,-4802.65 4816,-4792.65 4812.5,-4802.65 4819.5,-4802.65"/>
</g>
<!-- route_9_0 -->
<g id="node616" class="node">
<title>route_9_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="539" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="539" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="539" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 288,289</text>
<text text-anchor="middle" x="539" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="539" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_0 -->
<g id="edge894" class="edge">
<title>gate_9&#45;&gt;route_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4576.09,-4747.28C3965.43,-4746.32 2302.63,-4737.03 919,-4668.24 853.75,-4664.99 782.32,-4659.77 719.17,-4654.59"/>
<polygon fill="black" stroke="black" points="719.36,-4651.09 709.11,-4653.75 718.79,-4658.07 719.36,-4651.09"/>
</g>
<!-- route_9_1 -->
<g id="node620" class="node">
<title>route_9_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1129" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1129" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1129" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 290,291</text>
<text text-anchor="middle" x="1129" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1129" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_1 -->
<g id="edge900" class="edge">
<title>gate_9&#45;&gt;route_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4574.4,-4746.03C4027.99,-4742.3 2655.53,-4727.32 1509,-4668.24 1443.91,-4664.89 1372.67,-4659.66 1309.63,-4654.49"/>
<polygon fill="black" stroke="black" points="1309.84,-4650.99 1299.59,-4653.66 1309.27,-4657.97 1309.84,-4650.99"/>
</g>
<!-- route_9_2 -->
<g id="node624" class="node">
<title>route_9_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1719" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1719" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1719" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 292,293</text>
<text text-anchor="middle" x="1719" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1719" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_2 -->
<g id="edge906" class="edge">
<title>gate_9&#45;&gt;route_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4571.82,-4744.23C4095.8,-4737.46 3010.5,-4717.57 2099,-4668.24 2034.08,-4664.72 1963.02,-4659.47 1900.1,-4654.33"/>
<polygon fill="black" stroke="black" points="1900.32,-4650.84 1890.07,-4653.51 1899.75,-4657.82 1900.32,-4650.84"/>
</g>
<!-- route_9_3 -->
<g id="node628" class="node">
<title>route_9_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2309" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2309" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2309" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 294,295</text>
<text text-anchor="middle" x="2309" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2309" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_3 -->
<g id="edge912" class="edge">
<title>gate_9&#45;&gt;route_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4567.78,-4741.4C4170.71,-4731.29 3368.24,-4707.75 2689,-4668.24 2624.41,-4664.48 2553.73,-4659.2 2491.03,-4654.11"/>
<polygon fill="black" stroke="black" points="2491.29,-4650.62 2481.04,-4653.3 2490.72,-4657.6 2491.29,-4650.62"/>
</g>
<!-- route_9_4 -->
<g id="node632" class="node">
<title>route_9_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2899" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2899" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2899" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 296,297</text>
<text text-anchor="middle" x="2899" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2899" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_4 -->
<g id="edge918" class="edge">
<title>gate_9&#45;&gt;route_9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560.91,-4736.29C4255.88,-4722.71 3729.93,-4697.69 3279,-4668.24 3215.04,-4664.06 3145.08,-4658.73 3082.82,-4653.73"/>
<polygon fill="black" stroke="black" points="3082.74,-4650.21 3072.49,-4652.89 3082.18,-4657.19 3082.74,-4650.21"/>
</g>
<!-- route_9_5 -->
<g id="node636" class="node">
<title>route_9_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3489" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3489" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3489" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 298,299</text>
<text text-anchor="middle" x="3489" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3489" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_5 -->
<g id="edge924" class="edge">
<title>gate_9&#45;&gt;route_9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4545.06,-4724.96C4285.32,-4703.6 3900.23,-4671.94 3673.92,-4653.33"/>
<polygon fill="black" stroke="black" points="3674.18,-4649.84 3663.93,-4652.51 3673.61,-4656.82 3674.18,-4649.84"/>
</g>
<!-- route_9_6 -->
<g id="node640" class="node">
<title>route_9_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4079" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4079" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4079" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 300,301</text>
<text text-anchor="middle" x="4079" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4079" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_6 -->
<g id="edge930" class="edge">
<title>gate_9&#45;&gt;route_9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4525.51,-4704.23C4424.8,-4689.32 4315.94,-4673.2 4230.92,-4660.62"/>
<polygon fill="black" stroke="black" points="4231.34,-4657.14 4220.93,-4659.14 4230.31,-4664.07 4231.34,-4657.14"/>
</g>
<!-- route_9_7 -->
<g id="node644" class="node">
<title>route_9_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4607" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4607" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4607" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 302,303</text>
<text text-anchor="middle" x="4607" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4607" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_7 -->
<g id="edge936" class="edge">
<title>gate_9&#45;&gt;route_9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4733.4,-4704.11C4712.91,-4693.42 4691.25,-4682.11 4671.75,-4671.93"/>
<polygon fill="black" stroke="black" points="4673.15,-4668.71 4662.67,-4667.19 4669.91,-4674.92 4673.15,-4668.71"/>
</g>
<!-- route_9_8 -->
<g id="node648" class="node">
<title>route_9_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5027" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5027" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5027" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 304,305</text>
<text text-anchor="middle" x="5027" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5027" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_8 -->
<g id="edge942" class="edge">
<title>gate_9&#45;&gt;route_9_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4899.39,-4704.11C4920.27,-4693.32 4942.36,-4681.9 4962.18,-4671.65"/>
<polygon fill="black" stroke="black" points="4963.84,-4674.73 4971.12,-4667.02 4960.63,-4668.51 4963.84,-4674.73"/>
</g>
<!-- route_9_9 -->
<g id="node652" class="node">
<title>route_9_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5554" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5554" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5554" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 306,307</text>
<text text-anchor="middle" x="5554" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5554" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_9 -->
<g id="edge948" class="edge">
<title>gate_9&#45;&gt;route_9_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5012.8,-4718.14C5134.76,-4700.11 5289.08,-4677.29 5401.69,-4660.64"/>
<polygon fill="black" stroke="black" points="5402.39,-4664.08 5411.77,-4659.15 5401.37,-4657.15 5402.39,-4664.08"/>
</g>
<!-- route_9_10 -->
<g id="node656" class="node">
<title>route_9_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6144" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6144" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6144" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 308,309</text>
<text text-anchor="middle" x="6144" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6144" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_10 -->
<g id="edge954" class="edge">
<title>gate_9&#45;&gt;route_9_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5029,-4729.74C5286.37,-4708.59 5715.14,-4673.36 5959.18,-4653.31"/>
<polygon fill="black" stroke="black" points="5959.54,-4656.79 5969.22,-4652.49 5958.96,-4649.82 5959.54,-4656.79"/>
</g>
<!-- route_9_11 -->
<g id="node660" class="node">
<title>route_9_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6734" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6734" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6734" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 310,311</text>
<text text-anchor="middle" x="6734" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6734" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_11 -->
<g id="edge960" class="edge">
<title>gate_9&#45;&gt;route_9_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5039.94,-4737.69C5339.44,-4724.46 5886.94,-4698.73 6354,-4668.24 6417.96,-4664.06 6487.92,-4658.74 6550.18,-4653.73"/>
<polygon fill="black" stroke="black" points="6550.82,-4657.19 6560.51,-4652.89 6550.26,-4650.21 6550.82,-4657.19"/>
</g>
<!-- route_9_12 -->
<g id="node664" class="node">
<title>route_9_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7324" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7324" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7324" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 312,313</text>
<text text-anchor="middle" x="7324" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7324" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_12 -->
<g id="edge966" class="edge">
<title>gate_9&#45;&gt;route_9_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.64,-4741.87C5435.94,-4732.05 6253.6,-4708.39 6944,-4668.24 7008.59,-4664.48 7079.27,-4659.2 7141.97,-4654.11"/>
<polygon fill="black" stroke="black" points="7142.28,-4657.6 7151.96,-4653.3 7141.71,-4650.62 7142.28,-4657.6"/>
</g>
<!-- route_9_13 -->
<g id="node668" class="node">
<title>route_9_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7914" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7914" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7914" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 314,315</text>
<text text-anchor="middle" x="7914" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7914" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_13 -->
<g id="edge972" class="edge">
<title>gate_9&#45;&gt;route_9_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5049.3,-4744.39C5519.62,-4737.77 6615.09,-4717.97 7534,-4668.24 7598.92,-4664.73 7669.98,-4659.47 7732.9,-4654.34"/>
<polygon fill="black" stroke="black" points="7733.25,-4657.82 7742.93,-4653.51 7732.68,-4650.84 7733.25,-4657.82"/>
</g>
<!-- route_9_14 -->
<g id="node672" class="node">
<title>route_9_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8504" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8504" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8504" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 316,317</text>
<text text-anchor="middle" x="8504" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8504" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_14 -->
<g id="edge978" class="edge">
<title>gate_9&#45;&gt;route_9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5051.56,-4746.07C5593.95,-4742.42 6972.82,-4727.55 8124,-4668.24 8189.09,-4664.89 8260.33,-4659.66 8323.37,-4654.49"/>
<polygon fill="black" stroke="black" points="8323.73,-4657.97 8333.41,-4653.66 8323.16,-4650.99 8323.73,-4657.97"/>
</g>
<!-- route_9_15 -->
<g id="node676" class="node">
<title>route_9_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9094" cy="-4637.13" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9094" y="-4649.93" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9094" y="-4639.93" font-family="Times,serif" font-size="9.00">GPU: 318,319</text>
<text text-anchor="middle" x="9094" y="-4629.93" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9094" y="-4619.93" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_9&#45;&gt;route_9_15 -->
<g id="edge984" class="edge">
<title>gate_9&#45;&gt;route_9_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5053.19,-4747.29C5661.71,-4746.35 7327.91,-4737.14 8714,-4668.24 8779.25,-4665 8850.68,-4659.78 8913.83,-4654.59"/>
<polygon fill="black" stroke="black" points="8914.21,-4658.07 8923.89,-4653.75 8913.64,-4651.09 8914.21,-4658.07"/>
</g>
<!-- expert_9_0_0 -->
<g id="node617" class="node">
<title>expert_9_0_0</title>
<polygon fill="lightgreen" stroke="black" points="382.5,-4570.01 105.5,-4570.01 105.5,-4526.01 382.5,-4526.01 382.5,-4570.01"/>
<text text-anchor="middle" x="244" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="244" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 288</text>
<text text-anchor="middle" x="244" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="244" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_0&#45;&gt;expert_9_0_0 -->
<g id="edge895" class="edge">
<title>route_9_0&#45;&gt;expert_9_0_0</title>
<path fill="none" stroke="black" d="M448.08,-4609.28C408.92,-4597.71 363.49,-4584.3 325.44,-4573.06"/>
<polygon fill="black" stroke="black" points="326.01,-4569.58 315.43,-4570.11 324.03,-4576.3 326.01,-4569.58"/>
</g>
<!-- expert_9_0_1 -->
<g id="node618" class="node">
<title>expert_9_0_1</title>
<polygon fill="lightgreen" stroke="black" points="677.5,-4570.01 400.5,-4570.01 400.5,-4526.01 677.5,-4526.01 677.5,-4570.01"/>
<text text-anchor="middle" x="539" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="539" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 289</text>
<text text-anchor="middle" x="539" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="539" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_0&#45;&gt;expert_9_0_1 -->
<g id="edge896" class="edge">
<title>route_9_0&#45;&gt;expert_9_0_1</title>
<path fill="none" stroke="black" d="M539,-4605.66C539,-4597.38 539,-4588.4 539,-4580.09"/>
<polygon fill="black" stroke="black" points="542.5,-4580.02 539,-4570.02 535.5,-4580.02 542.5,-4580.02"/>
</g>
<!-- tp_9_0 -->
<g id="node619" class="node">
<title>tp_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="539" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="539" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="539" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 288↔289</text>
<text text-anchor="middle" x="539" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="539" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_0_0&#45;&gt;tp_9_0 -->
<g id="edge897" class="edge">
<title>expert_9_0_0&#45;&gt;tp_9_0</title>
<path fill="none" stroke="black" d="M315.41,-4525.93C356.87,-4513.68 409.36,-4498.18 453.07,-4485.27"/>
<polygon fill="black" stroke="black" points="454.23,-4488.58 462.83,-4482.39 452.25,-4481.87 454.23,-4488.58"/>
</g>
<!-- expert_9_0_1&#45;&gt;tp_9_0 -->
<g id="edge898" class="edge">
<title>expert_9_0_1&#45;&gt;tp_9_0</title>
<path fill="none" stroke="black" d="M539,-4525.93C539,-4518.25 539,-4509.3 539,-4500.51"/>
<polygon fill="black" stroke="black" points="542.5,-4500.35 539,-4490.35 535.5,-4500.35 542.5,-4500.35"/>
</g>
<!-- agg_9 -->
<g id="node680" class="node">
<title>agg_9</title>
<polygon fill="lightyellow" stroke="black" points="5097.99,-4391.79 4649.4,-4391.79 4534.01,-4303.79 4982.6,-4303.79 5097.99,-4391.79"/>
<text text-anchor="middle" x="4816" y="-4360.59" font-family="Times,serif" font-size="9.00">Aggregate Experts L9</text>
<text text-anchor="middle" x="4816" y="-4350.59" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4340.59" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4816" y="-4330.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_9_0&#45;&gt;agg_9 -->
<g id="edge899" class="edge">
<title>tp_9_0&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M649.79,-4449.35C743.96,-4442.42 882.76,-4432.97 1004,-4427.79 2359.83,-4369.87 3988.8,-4354.05 4583.92,-4350.05"/>
<polygon fill="black" stroke="black" points="4584.36,-4353.55 4594.33,-4349.98 4584.31,-4346.55 4584.36,-4353.55"/>
</g>
<!-- expert_9_1_0 -->
<g id="node621" class="node">
<title>expert_9_1_0</title>
<polygon fill="lightgreen" stroke="black" points="972.5,-4570.01 695.5,-4570.01 695.5,-4526.01 972.5,-4526.01 972.5,-4570.01"/>
<text text-anchor="middle" x="834" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="834" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 290</text>
<text text-anchor="middle" x="834" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="834" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_1&#45;&gt;expert_9_1_0 -->
<g id="edge901" class="edge">
<title>route_9_1&#45;&gt;expert_9_1_0</title>
<path fill="none" stroke="black" d="M1038.08,-4609.28C998.92,-4597.71 953.49,-4584.3 915.44,-4573.06"/>
<polygon fill="black" stroke="black" points="916.01,-4569.58 905.43,-4570.11 914.03,-4576.3 916.01,-4569.58"/>
</g>
<!-- expert_9_1_1 -->
<g id="node622" class="node">
<title>expert_9_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1267.5,-4570.01 990.5,-4570.01 990.5,-4526.01 1267.5,-4526.01 1267.5,-4570.01"/>
<text text-anchor="middle" x="1129" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1129" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 291</text>
<text text-anchor="middle" x="1129" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1129" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_1&#45;&gt;expert_9_1_1 -->
<g id="edge902" class="edge">
<title>route_9_1&#45;&gt;expert_9_1_1</title>
<path fill="none" stroke="black" d="M1129,-4605.66C1129,-4597.38 1129,-4588.4 1129,-4580.09"/>
<polygon fill="black" stroke="black" points="1132.5,-4580.02 1129,-4570.02 1125.5,-4580.02 1132.5,-4580.02"/>
</g>
<!-- tp_9_1 -->
<g id="node623" class="node">
<title>tp_9_1</title>
<ellipse fill="lightblue" stroke="black" cx="1129" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1129" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1129" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 290↔291</text>
<text text-anchor="middle" x="1129" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1129" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_1_0&#45;&gt;tp_9_1 -->
<g id="edge903" class="edge">
<title>expert_9_1_0&#45;&gt;tp_9_1</title>
<path fill="none" stroke="black" d="M905.41,-4525.93C946.87,-4513.68 999.36,-4498.18 1043.07,-4485.27"/>
<polygon fill="black" stroke="black" points="1044.23,-4488.58 1052.83,-4482.39 1042.25,-4481.87 1044.23,-4488.58"/>
</g>
<!-- expert_9_1_1&#45;&gt;tp_9_1 -->
<g id="edge904" class="edge">
<title>expert_9_1_1&#45;&gt;tp_9_1</title>
<path fill="none" stroke="black" d="M1129,-4525.93C1129,-4518.25 1129,-4509.3 1129,-4500.51"/>
<polygon fill="black" stroke="black" points="1132.5,-4500.35 1129,-4490.35 1125.5,-4500.35 1132.5,-4500.35"/>
</g>
<!-- tp_9_1&#45;&gt;agg_9 -->
<g id="edge905" class="edge">
<title>tp_9_1&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1239.8,-4449.47C1333.96,-4442.61 1472.77,-4433.2 1594,-4427.79 2714.94,-4377.77 4056.78,-4357.64 4585.63,-4351.26"/>
<polygon fill="black" stroke="black" points="4585.71,-4354.76 4595.67,-4351.14 4585.63,-4347.76 4585.71,-4354.76"/>
</g>
<!-- expert_9_2_0 -->
<g id="node625" class="node">
<title>expert_9_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1562.5,-4570.01 1285.5,-4570.01 1285.5,-4526.01 1562.5,-4526.01 1562.5,-4570.01"/>
<text text-anchor="middle" x="1424" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1424" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 292</text>
<text text-anchor="middle" x="1424" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1424" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_2&#45;&gt;expert_9_2_0 -->
<g id="edge907" class="edge">
<title>route_9_2&#45;&gt;expert_9_2_0</title>
<path fill="none" stroke="black" d="M1628.08,-4609.28C1588.92,-4597.71 1543.49,-4584.3 1505.44,-4573.06"/>
<polygon fill="black" stroke="black" points="1506.01,-4569.58 1495.43,-4570.11 1504.03,-4576.3 1506.01,-4569.58"/>
</g>
<!-- expert_9_2_1 -->
<g id="node626" class="node">
<title>expert_9_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1857.5,-4570.01 1580.5,-4570.01 1580.5,-4526.01 1857.5,-4526.01 1857.5,-4570.01"/>
<text text-anchor="middle" x="1719" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1719" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 293</text>
<text text-anchor="middle" x="1719" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1719" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_2&#45;&gt;expert_9_2_1 -->
<g id="edge908" class="edge">
<title>route_9_2&#45;&gt;expert_9_2_1</title>
<path fill="none" stroke="black" d="M1719,-4605.66C1719,-4597.38 1719,-4588.4 1719,-4580.09"/>
<polygon fill="black" stroke="black" points="1722.5,-4580.02 1719,-4570.02 1715.5,-4580.02 1722.5,-4580.02"/>
</g>
<!-- tp_9_2 -->
<g id="node627" class="node">
<title>tp_9_2</title>
<ellipse fill="lightblue" stroke="black" cx="1719" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1719" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1719" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 292↔293</text>
<text text-anchor="middle" x="1719" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1719" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_2_0&#45;&gt;tp_9_2 -->
<g id="edge909" class="edge">
<title>expert_9_2_0&#45;&gt;tp_9_2</title>
<path fill="none" stroke="black" d="M1495.41,-4525.93C1536.87,-4513.68 1589.36,-4498.18 1633.07,-4485.27"/>
<polygon fill="black" stroke="black" points="1634.23,-4488.58 1642.83,-4482.39 1632.25,-4481.87 1634.23,-4488.58"/>
</g>
<!-- expert_9_2_1&#45;&gt;tp_9_2 -->
<g id="edge910" class="edge">
<title>expert_9_2_1&#45;&gt;tp_9_2</title>
<path fill="none" stroke="black" d="M1719,-4525.93C1719,-4518.25 1719,-4509.3 1719,-4500.51"/>
<polygon fill="black" stroke="black" points="1722.5,-4500.35 1719,-4490.35 1715.5,-4500.35 1722.5,-4500.35"/>
</g>
<!-- tp_9_2&#45;&gt;agg_9 -->
<g id="edge911" class="edge">
<title>tp_9_2&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1829.8,-4449.64C1923.98,-4442.88 2062.79,-4433.53 2184,-4427.79 3072.74,-4385.69 4131.42,-4361.94 4587.95,-4352.97"/>
<polygon fill="black" stroke="black" points="4588.03,-4356.47 4597.96,-4352.78 4587.89,-4349.47 4588.03,-4356.47"/>
</g>
<!-- expert_9_3_0 -->
<g id="node629" class="node">
<title>expert_9_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2152.5,-4570.01 1875.5,-4570.01 1875.5,-4526.01 2152.5,-4526.01 2152.5,-4570.01"/>
<text text-anchor="middle" x="2014" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2014" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 294</text>
<text text-anchor="middle" x="2014" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2014" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_3&#45;&gt;expert_9_3_0 -->
<g id="edge913" class="edge">
<title>route_9_3&#45;&gt;expert_9_3_0</title>
<path fill="none" stroke="black" d="M2218.08,-4609.28C2178.92,-4597.71 2133.49,-4584.3 2095.44,-4573.06"/>
<polygon fill="black" stroke="black" points="2096.01,-4569.58 2085.43,-4570.11 2094.03,-4576.3 2096.01,-4569.58"/>
</g>
<!-- expert_9_3_1 -->
<g id="node630" class="node">
<title>expert_9_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2447.5,-4570.01 2170.5,-4570.01 2170.5,-4526.01 2447.5,-4526.01 2447.5,-4570.01"/>
<text text-anchor="middle" x="2309" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2309" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 295</text>
<text text-anchor="middle" x="2309" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2309" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_3&#45;&gt;expert_9_3_1 -->
<g id="edge914" class="edge">
<title>route_9_3&#45;&gt;expert_9_3_1</title>
<path fill="none" stroke="black" d="M2309,-4605.66C2309,-4597.38 2309,-4588.4 2309,-4580.09"/>
<polygon fill="black" stroke="black" points="2312.5,-4580.02 2309,-4570.02 2305.5,-4580.02 2312.5,-4580.02"/>
</g>
<!-- tp_9_3 -->
<g id="node631" class="node">
<title>tp_9_3</title>
<ellipse fill="lightblue" stroke="black" cx="2309" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2309" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2309" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 294↔295</text>
<text text-anchor="middle" x="2309" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2309" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_3_0&#45;&gt;tp_9_3 -->
<g id="edge915" class="edge">
<title>expert_9_3_0&#45;&gt;tp_9_3</title>
<path fill="none" stroke="black" d="M2085.41,-4525.93C2126.87,-4513.68 2179.36,-4498.18 2223.07,-4485.27"/>
<polygon fill="black" stroke="black" points="2224.23,-4488.58 2232.83,-4482.39 2222.25,-4481.87 2224.23,-4488.58"/>
</g>
<!-- expert_9_3_1&#45;&gt;tp_9_3 -->
<g id="edge916" class="edge">
<title>expert_9_3_1&#45;&gt;tp_9_3</title>
<path fill="none" stroke="black" d="M2309,-4525.93C2309,-4518.25 2309,-4509.3 2309,-4500.51"/>
<polygon fill="black" stroke="black" points="2312.5,-4500.35 2309,-4490.35 2305.5,-4500.35 2312.5,-4500.35"/>
</g>
<!-- tp_9_3&#45;&gt;agg_9 -->
<g id="edge917" class="edge">
<title>tp_9_3&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M2420.29,-4449.88C2514.46,-4443.29 2653.02,-4434.04 2774,-4427.79 3434.08,-4393.65 4214.88,-4367.36 4591.12,-4355.58"/>
<polygon fill="black" stroke="black" points="4591.42,-4359.07 4601.3,-4355.26 4591.2,-4352.07 4591.42,-4359.07"/>
</g>
<!-- expert_9_4_0 -->
<g id="node633" class="node">
<title>expert_9_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2742.5,-4570.01 2465.5,-4570.01 2465.5,-4526.01 2742.5,-4526.01 2742.5,-4570.01"/>
<text text-anchor="middle" x="2604" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2604" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 296</text>
<text text-anchor="middle" x="2604" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2604" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_4&#45;&gt;expert_9_4_0 -->
<g id="edge919" class="edge">
<title>route_9_4&#45;&gt;expert_9_4_0</title>
<path fill="none" stroke="black" d="M2808.08,-4609.28C2768.92,-4597.71 2723.49,-4584.3 2685.44,-4573.06"/>
<polygon fill="black" stroke="black" points="2686.01,-4569.58 2675.43,-4570.11 2684.03,-4576.3 2686.01,-4569.58"/>
</g>
<!-- expert_9_4_1 -->
<g id="node634" class="node">
<title>expert_9_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3037.5,-4570.01 2760.5,-4570.01 2760.5,-4526.01 3037.5,-4526.01 3037.5,-4570.01"/>
<text text-anchor="middle" x="2899" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2899" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 297</text>
<text text-anchor="middle" x="2899" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2899" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_4&#45;&gt;expert_9_4_1 -->
<g id="edge920" class="edge">
<title>route_9_4&#45;&gt;expert_9_4_1</title>
<path fill="none" stroke="black" d="M2899,-4605.66C2899,-4597.38 2899,-4588.4 2899,-4580.09"/>
<polygon fill="black" stroke="black" points="2902.5,-4580.02 2899,-4570.02 2895.5,-4580.02 2902.5,-4580.02"/>
</g>
<!-- tp_9_4 -->
<g id="node635" class="node">
<title>tp_9_4</title>
<ellipse fill="lightblue" stroke="black" cx="2899" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2899" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2899" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 296↔297</text>
<text text-anchor="middle" x="2899" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2899" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_4_0&#45;&gt;tp_9_4 -->
<g id="edge921" class="edge">
<title>expert_9_4_0&#45;&gt;tp_9_4</title>
<path fill="none" stroke="black" d="M2675.41,-4525.93C2716.87,-4513.68 2769.36,-4498.18 2813.07,-4485.27"/>
<polygon fill="black" stroke="black" points="2814.23,-4488.58 2822.83,-4482.39 2812.25,-4481.87 2814.23,-4488.58"/>
</g>
<!-- expert_9_4_1&#45;&gt;tp_9_4 -->
<g id="edge922" class="edge">
<title>expert_9_4_1&#45;&gt;tp_9_4</title>
<path fill="none" stroke="black" d="M2899,-4525.93C2899,-4518.25 2899,-4509.3 2899,-4500.51"/>
<polygon fill="black" stroke="black" points="2902.5,-4500.35 2899,-4490.35 2895.5,-4500.35 2902.5,-4500.35"/>
</g>
<!-- tp_9_4&#45;&gt;agg_9 -->
<g id="edge923" class="edge">
<title>tp_9_4&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3010.79,-4450.34C3104.97,-4444.04 3243.27,-4434.98 3364,-4427.79 3801.09,-4401.75 4312.42,-4374.73 4596.75,-4360.01"/>
<polygon fill="black" stroke="black" points="4596.96,-4363.51 4606.77,-4359.49 4596.6,-4356.51 4596.96,-4363.51"/>
</g>
<!-- expert_9_5_0 -->
<g id="node637" class="node">
<title>expert_9_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3332.5,-4570.01 3055.5,-4570.01 3055.5,-4526.01 3332.5,-4526.01 3332.5,-4570.01"/>
<text text-anchor="middle" x="3194" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3194" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 298</text>
<text text-anchor="middle" x="3194" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3194" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_5&#45;&gt;expert_9_5_0 -->
<g id="edge925" class="edge">
<title>route_9_5&#45;&gt;expert_9_5_0</title>
<path fill="none" stroke="black" d="M3398.08,-4609.28C3358.92,-4597.71 3313.49,-4584.3 3275.44,-4573.06"/>
<polygon fill="black" stroke="black" points="3276.01,-4569.58 3265.43,-4570.11 3274.03,-4576.3 3276.01,-4569.58"/>
</g>
<!-- expert_9_5_1 -->
<g id="node638" class="node">
<title>expert_9_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3627.5,-4570.01 3350.5,-4570.01 3350.5,-4526.01 3627.5,-4526.01 3627.5,-4570.01"/>
<text text-anchor="middle" x="3489" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3489" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 299</text>
<text text-anchor="middle" x="3489" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3489" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_5&#45;&gt;expert_9_5_1 -->
<g id="edge926" class="edge">
<title>route_9_5&#45;&gt;expert_9_5_1</title>
<path fill="none" stroke="black" d="M3489,-4605.66C3489,-4597.38 3489,-4588.4 3489,-4580.09"/>
<polygon fill="black" stroke="black" points="3492.5,-4580.02 3489,-4570.02 3485.5,-4580.02 3492.5,-4580.02"/>
</g>
<!-- tp_9_5 -->
<g id="node639" class="node">
<title>tp_9_5</title>
<ellipse fill="lightblue" stroke="black" cx="3489" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3489" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3489" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 298↔299</text>
<text text-anchor="middle" x="3489" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3489" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_5_0&#45;&gt;tp_9_5 -->
<g id="edge927" class="edge">
<title>expert_9_5_0&#45;&gt;tp_9_5</title>
<path fill="none" stroke="black" d="M3265.41,-4525.93C3306.87,-4513.68 3359.36,-4498.18 3403.07,-4485.27"/>
<polygon fill="black" stroke="black" points="3404.23,-4488.58 3412.83,-4482.39 3402.25,-4481.87 3404.23,-4488.58"/>
</g>
<!-- expert_9_5_1&#45;&gt;tp_9_5 -->
<g id="edge928" class="edge">
<title>expert_9_5_1&#45;&gt;tp_9_5</title>
<path fill="none" stroke="black" d="M3489,-4525.93C3489,-4518.25 3489,-4509.3 3489,-4500.51"/>
<polygon fill="black" stroke="black" points="3492.5,-4500.35 3489,-4490.35 3485.5,-4500.35 3492.5,-4500.35"/>
</g>
<!-- tp_9_5&#45;&gt;agg_9 -->
<g id="edge929" class="edge">
<title>tp_9_5&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M3599.01,-4448.86C3819.49,-4430.73 4318.79,-4389.67 4604.61,-4366.17"/>
<polygon fill="black" stroke="black" points="4605.01,-4369.65 4614.69,-4365.34 4604.44,-4362.67 4605.01,-4369.65"/>
</g>
<!-- expert_9_6_0 -->
<g id="node641" class="node">
<title>expert_9_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3922.5,-4570.01 3645.5,-4570.01 3645.5,-4526.01 3922.5,-4526.01 3922.5,-4570.01"/>
<text text-anchor="middle" x="3784" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3784" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 300</text>
<text text-anchor="middle" x="3784" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3784" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_6&#45;&gt;expert_9_6_0 -->
<g id="edge931" class="edge">
<title>route_9_6&#45;&gt;expert_9_6_0</title>
<path fill="none" stroke="black" d="M3988.08,-4609.28C3948.92,-4597.71 3903.49,-4584.3 3865.44,-4573.06"/>
<polygon fill="black" stroke="black" points="3866.01,-4569.58 3855.43,-4570.11 3864.03,-4576.3 3866.01,-4569.58"/>
</g>
<!-- expert_9_6_1 -->
<g id="node642" class="node">
<title>expert_9_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-4570.01 3940.5,-4570.01 3940.5,-4526.01 4217.5,-4526.01 4217.5,-4570.01"/>
<text text-anchor="middle" x="4079" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4079" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 301</text>
<text text-anchor="middle" x="4079" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4079" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_6&#45;&gt;expert_9_6_1 -->
<g id="edge932" class="edge">
<title>route_9_6&#45;&gt;expert_9_6_1</title>
<path fill="none" stroke="black" d="M4079,-4605.66C4079,-4597.38 4079,-4588.4 4079,-4580.09"/>
<polygon fill="black" stroke="black" points="4082.5,-4580.02 4079,-4570.02 4075.5,-4580.02 4082.5,-4580.02"/>
</g>
<!-- tp_9_6 -->
<g id="node643" class="node">
<title>tp_9_6</title>
<ellipse fill="lightblue" stroke="black" cx="4079" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4079" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4079" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 300↔301</text>
<text text-anchor="middle" x="4079" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4079" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_6_0&#45;&gt;tp_9_6 -->
<g id="edge933" class="edge">
<title>expert_9_6_0&#45;&gt;tp_9_6</title>
<path fill="none" stroke="black" d="M3855.41,-4525.93C3896.87,-4513.68 3949.36,-4498.18 3993.07,-4485.27"/>
<polygon fill="black" stroke="black" points="3994.23,-4488.58 4002.83,-4482.39 3992.25,-4481.87 3994.23,-4488.58"/>
</g>
<!-- expert_9_6_1&#45;&gt;tp_9_6 -->
<g id="edge934" class="edge">
<title>expert_9_6_1&#45;&gt;tp_9_6</title>
<path fill="none" stroke="black" d="M4079,-4525.93C4079,-4518.25 4079,-4509.3 4079,-4500.51"/>
<polygon fill="black" stroke="black" points="4082.5,-4500.35 4079,-4490.35 4075.5,-4500.35 4082.5,-4500.35"/>
</g>
<!-- tp_9_6&#45;&gt;agg_9 -->
<g id="edge935" class="edge">
<title>tp_9_6&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M4179.16,-4443.07C4291.68,-4426.41 4477.1,-4398.96 4618.93,-4377.96"/>
<polygon fill="black" stroke="black" points="4619.68,-4381.39 4629.06,-4376.46 4618.66,-4374.47 4619.68,-4381.39"/>
</g>
<!-- expert_9_7_0 -->
<g id="node645" class="node">
<title>expert_9_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4512.5,-4570.01 4235.5,-4570.01 4235.5,-4526.01 4512.5,-4526.01 4512.5,-4570.01"/>
<text text-anchor="middle" x="4374" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4374" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 302</text>
<text text-anchor="middle" x="4374" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4374" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_7&#45;&gt;expert_9_7_0 -->
<g id="edge937" class="edge">
<title>route_9_7&#45;&gt;expert_9_7_0</title>
<path fill="none" stroke="black" d="M4532.32,-4608.2C4502.66,-4597.12 4468.83,-4584.47 4440.08,-4573.72"/>
<polygon fill="black" stroke="black" points="4441.13,-4570.38 4430.54,-4570.15 4438.68,-4576.93 4441.13,-4570.38"/>
</g>
<!-- expert_9_7_1 -->
<g id="node646" class="node">
<title>expert_9_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4807.5,-4570.01 4530.5,-4570.01 4530.5,-4526.01 4807.5,-4526.01 4807.5,-4570.01"/>
<text text-anchor="middle" x="4669" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4669" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 303</text>
<text text-anchor="middle" x="4669" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4669" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_7&#45;&gt;expert_9_7_1 -->
<g id="edge938" class="edge">
<title>route_9_7&#45;&gt;expert_9_7_1</title>
<path fill="none" stroke="black" d="M4628.34,-4606.15C4634.71,-4597.2 4641.68,-4587.39 4648.03,-4578.48"/>
<polygon fill="black" stroke="black" points="4650.94,-4580.43 4653.88,-4570.25 4645.23,-4576.37 4650.94,-4580.43"/>
</g>
<!-- tp_9_7 -->
<g id="node647" class="node">
<title>tp_9_7</title>
<ellipse fill="lightblue" stroke="black" cx="4669" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4669" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4669" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 302↔303</text>
<text text-anchor="middle" x="4669" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4669" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_7_0&#45;&gt;tp_9_7 -->
<g id="edge939" class="edge">
<title>expert_9_7_0&#45;&gt;tp_9_7</title>
<path fill="none" stroke="black" d="M4445.41,-4525.93C4486.87,-4513.68 4539.36,-4498.18 4583.07,-4485.27"/>
<polygon fill="black" stroke="black" points="4584.23,-4488.58 4592.83,-4482.39 4582.25,-4481.87 4584.23,-4488.58"/>
</g>
<!-- expert_9_7_1&#45;&gt;tp_9_7 -->
<g id="edge940" class="edge">
<title>expert_9_7_1&#45;&gt;tp_9_7</title>
<path fill="none" stroke="black" d="M4669,-4525.93C4669,-4518.25 4669,-4509.3 4669,-4500.51"/>
<polygon fill="black" stroke="black" points="4672.5,-4500.35 4669,-4490.35 4665.5,-4500.35 4672.5,-4500.35"/>
</g>
<!-- tp_9_7&#45;&gt;agg_9 -->
<g id="edge941" class="edge">
<title>tp_9_7&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M4707.24,-4429.52C4720.3,-4419.82 4735.31,-4408.68 4749.93,-4397.83"/>
<polygon fill="black" stroke="black" points="4752.05,-4400.62 4757.99,-4391.84 4747.88,-4394.99 4752.05,-4400.62"/>
</g>
<!-- expert_9_8_0 -->
<g id="node649" class="node">
<title>expert_9_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5102.5,-4570.01 4825.5,-4570.01 4825.5,-4526.01 5102.5,-4526.01 5102.5,-4570.01"/>
<text text-anchor="middle" x="4964" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4964" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 304</text>
<text text-anchor="middle" x="4964" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4964" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_8&#45;&gt;expert_9_8_0 -->
<g id="edge943" class="edge">
<title>route_9_8&#45;&gt;expert_9_8_0</title>
<path fill="none" stroke="black" d="M5005.32,-4606.15C4998.85,-4597.2 4991.76,-4587.39 4985.31,-4578.48"/>
<polygon fill="black" stroke="black" points="4988.06,-4576.31 4979.36,-4570.25 4982.39,-4580.41 4988.06,-4576.31"/>
</g>
<!-- expert_9_8_1 -->
<g id="node650" class="node">
<title>expert_9_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5397.5,-4570.01 5120.5,-4570.01 5120.5,-4526.01 5397.5,-4526.01 5397.5,-4570.01"/>
<text text-anchor="middle" x="5259" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5259" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 305</text>
<text text-anchor="middle" x="5259" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5259" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_8&#45;&gt;expert_9_8_1 -->
<g id="edge944" class="edge">
<title>route_9_8&#45;&gt;expert_9_8_1</title>
<path fill="none" stroke="black" d="M5101.36,-4608.2C5130.89,-4597.12 5164.58,-4584.47 5193.2,-4573.72"/>
<polygon fill="black" stroke="black" points="5194.57,-4576.94 5202.71,-4570.15 5192.11,-4570.39 5194.57,-4576.94"/>
</g>
<!-- tp_9_8 -->
<g id="node651" class="node">
<title>tp_9_8</title>
<ellipse fill="lightblue" stroke="black" cx="4964" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4964" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4964" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 304↔305</text>
<text text-anchor="middle" x="4964" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4964" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_8_0&#45;&gt;tp_9_8 -->
<g id="edge945" class="edge">
<title>expert_9_8_0&#45;&gt;tp_9_8</title>
<path fill="none" stroke="black" d="M4964,-4525.93C4964,-4518.25 4964,-4509.3 4964,-4500.51"/>
<polygon fill="black" stroke="black" points="4967.5,-4500.35 4964,-4490.35 4960.5,-4500.35 4967.5,-4500.35"/>
</g>
<!-- expert_9_8_1&#45;&gt;tp_9_8 -->
<g id="edge946" class="edge">
<title>expert_9_8_1&#45;&gt;tp_9_8</title>
<path fill="none" stroke="black" d="M5187.59,-4525.93C5146.13,-4513.68 5093.64,-4498.18 5049.93,-4485.27"/>
<polygon fill="black" stroke="black" points="5050.75,-4481.87 5040.17,-4482.39 5048.77,-4488.58 5050.75,-4481.87"/>
</g>
<!-- tp_9_8&#45;&gt;agg_9 -->
<g id="edge947" class="edge">
<title>tp_9_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M4925.5,-4429.52C4912.35,-4419.82 4897.24,-4408.68 4882.52,-4397.83"/>
<polygon fill="black" stroke="black" points="4884.53,-4394.96 4874.4,-4391.84 4880.37,-4400.6 4884.53,-4394.96"/>
</g>
<!-- expert_9_9_0 -->
<g id="node653" class="node">
<title>expert_9_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5692.5,-4570.01 5415.5,-4570.01 5415.5,-4526.01 5692.5,-4526.01 5692.5,-4570.01"/>
<text text-anchor="middle" x="5554" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5554" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 306</text>
<text text-anchor="middle" x="5554" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5554" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_9&#45;&gt;expert_9_9_0 -->
<g id="edge949" class="edge">
<title>route_9_9&#45;&gt;expert_9_9_0</title>
<path fill="none" stroke="black" d="M5554,-4605.66C5554,-4597.38 5554,-4588.4 5554,-4580.09"/>
<polygon fill="black" stroke="black" points="5557.5,-4580.02 5554,-4570.02 5550.5,-4580.02 5557.5,-4580.02"/>
</g>
<!-- expert_9_9_1 -->
<g id="node654" class="node">
<title>expert_9_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5987.5,-4570.01 5710.5,-4570.01 5710.5,-4526.01 5987.5,-4526.01 5987.5,-4570.01"/>
<text text-anchor="middle" x="5849" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5849" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 307</text>
<text text-anchor="middle" x="5849" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5849" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_9&#45;&gt;expert_9_9_1 -->
<g id="edge950" class="edge">
<title>route_9_9&#45;&gt;expert_9_9_1</title>
<path fill="none" stroke="black" d="M5644.92,-4609.28C5684.08,-4597.71 5729.51,-4584.3 5767.56,-4573.06"/>
<polygon fill="black" stroke="black" points="5768.97,-4576.3 5777.57,-4570.11 5766.99,-4569.58 5768.97,-4576.3"/>
</g>
<!-- tp_9_9 -->
<g id="node655" class="node">
<title>tp_9_9</title>
<ellipse fill="lightblue" stroke="black" cx="5554" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5554" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5554" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 306↔307</text>
<text text-anchor="middle" x="5554" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5554" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_9_0&#45;&gt;tp_9_9 -->
<g id="edge951" class="edge">
<title>expert_9_9_0&#45;&gt;tp_9_9</title>
<path fill="none" stroke="black" d="M5554,-4525.93C5554,-4518.25 5554,-4509.3 5554,-4500.51"/>
<polygon fill="black" stroke="black" points="5557.5,-4500.35 5554,-4490.35 5550.5,-4500.35 5557.5,-4500.35"/>
</g>
<!-- expert_9_9_1&#45;&gt;tp_9_9 -->
<g id="edge952" class="edge">
<title>expert_9_9_1&#45;&gt;tp_9_9</title>
<path fill="none" stroke="black" d="M5777.59,-4525.93C5736.13,-4513.68 5683.64,-4498.18 5639.93,-4485.27"/>
<polygon fill="black" stroke="black" points="5640.75,-4481.87 5630.17,-4482.39 5638.77,-4488.58 5640.75,-4481.87"/>
</g>
<!-- tp_9_9&#45;&gt;agg_9 -->
<g id="edge953" class="edge">
<title>tp_9_9&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M5453.7,-4443.07C5364.3,-4429.85 5228.93,-4409.84 5105.87,-4391.65"/>
<polygon fill="black" stroke="black" points="5106.31,-4388.17 5095.9,-4390.17 5105.28,-4395.1 5106.31,-4388.17"/>
</g>
<!-- expert_9_10_0 -->
<g id="node657" class="node">
<title>expert_9_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6282.5,-4570.01 6005.5,-4570.01 6005.5,-4526.01 6282.5,-4526.01 6282.5,-4570.01"/>
<text text-anchor="middle" x="6144" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6144" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 308</text>
<text text-anchor="middle" x="6144" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6144" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_10&#45;&gt;expert_9_10_0 -->
<g id="edge955" class="edge">
<title>route_9_10&#45;&gt;expert_9_10_0</title>
<path fill="none" stroke="black" d="M6144,-4605.66C6144,-4597.38 6144,-4588.4 6144,-4580.09"/>
<polygon fill="black" stroke="black" points="6147.5,-4580.02 6144,-4570.02 6140.5,-4580.02 6147.5,-4580.02"/>
</g>
<!-- expert_9_10_1 -->
<g id="node658" class="node">
<title>expert_9_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6577.5,-4570.01 6300.5,-4570.01 6300.5,-4526.01 6577.5,-4526.01 6577.5,-4570.01"/>
<text text-anchor="middle" x="6439" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6439" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 309</text>
<text text-anchor="middle" x="6439" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6439" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_10&#45;&gt;expert_9_10_1 -->
<g id="edge956" class="edge">
<title>route_9_10&#45;&gt;expert_9_10_1</title>
<path fill="none" stroke="black" d="M6234.92,-4609.28C6274.08,-4597.71 6319.51,-4584.3 6357.56,-4573.06"/>
<polygon fill="black" stroke="black" points="6358.97,-4576.3 6367.57,-4570.11 6356.99,-4569.58 6358.97,-4576.3"/>
</g>
<!-- tp_9_10 -->
<g id="node659" class="node">
<title>tp_9_10</title>
<ellipse fill="lightblue" stroke="black" cx="6144" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6144" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6144" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 308↔309</text>
<text text-anchor="middle" x="6144" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6144" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_10_0&#45;&gt;tp_9_10 -->
<g id="edge957" class="edge">
<title>expert_9_10_0&#45;&gt;tp_9_10</title>
<path fill="none" stroke="black" d="M6144,-4525.93C6144,-4518.25 6144,-4509.3 6144,-4500.51"/>
<polygon fill="black" stroke="black" points="6147.5,-4500.35 6144,-4490.35 6140.5,-4500.35 6147.5,-4500.35"/>
</g>
<!-- expert_9_10_1&#45;&gt;tp_9_10 -->
<g id="edge958" class="edge">
<title>expert_9_10_1&#45;&gt;tp_9_10</title>
<path fill="none" stroke="black" d="M6367.59,-4525.93C6326.13,-4513.68 6273.64,-4498.18 6229.93,-4485.27"/>
<polygon fill="black" stroke="black" points="6230.75,-4481.87 6220.17,-4482.39 6228.77,-4488.58 6230.75,-4481.87"/>
</g>
<!-- tp_9_10&#45;&gt;agg_9 -->
<g id="edge959" class="edge">
<title>tp_9_10&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M6034.19,-4448.88C5826.46,-4431.81 5370.69,-4394.36 5079.33,-4370.42"/>
<polygon fill="black" stroke="black" points="5079.29,-4366.91 5069.03,-4369.58 5078.71,-4373.89 5079.29,-4366.91"/>
</g>
<!-- expert_9_11_0 -->
<g id="node661" class="node">
<title>expert_9_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6872.5,-4570.01 6595.5,-4570.01 6595.5,-4526.01 6872.5,-4526.01 6872.5,-4570.01"/>
<text text-anchor="middle" x="6734" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6734" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 310</text>
<text text-anchor="middle" x="6734" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6734" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_11&#45;&gt;expert_9_11_0 -->
<g id="edge961" class="edge">
<title>route_9_11&#45;&gt;expert_9_11_0</title>
<path fill="none" stroke="black" d="M6734,-4605.66C6734,-4597.38 6734,-4588.4 6734,-4580.09"/>
<polygon fill="black" stroke="black" points="6737.5,-4580.02 6734,-4570.02 6730.5,-4580.02 6737.5,-4580.02"/>
</g>
<!-- expert_9_11_1 -->
<g id="node662" class="node">
<title>expert_9_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7167.5,-4570.01 6890.5,-4570.01 6890.5,-4526.01 7167.5,-4526.01 7167.5,-4570.01"/>
<text text-anchor="middle" x="7029" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7029" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 311</text>
<text text-anchor="middle" x="7029" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7029" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_11&#45;&gt;expert_9_11_1 -->
<g id="edge962" class="edge">
<title>route_9_11&#45;&gt;expert_9_11_1</title>
<path fill="none" stroke="black" d="M6824.92,-4609.28C6864.08,-4597.71 6909.51,-4584.3 6947.56,-4573.06"/>
<polygon fill="black" stroke="black" points="6948.97,-4576.3 6957.57,-4570.11 6946.99,-4569.58 6948.97,-4576.3"/>
</g>
<!-- tp_9_11 -->
<g id="node663" class="node">
<title>tp_9_11</title>
<ellipse fill="lightblue" stroke="black" cx="6734" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6734" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6734" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 310↔311</text>
<text text-anchor="middle" x="6734" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6734" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_11_0&#45;&gt;tp_9_11 -->
<g id="edge963" class="edge">
<title>expert_9_11_0&#45;&gt;tp_9_11</title>
<path fill="none" stroke="black" d="M6734,-4525.93C6734,-4518.25 6734,-4509.3 6734,-4500.51"/>
<polygon fill="black" stroke="black" points="6737.5,-4500.35 6734,-4490.35 6730.5,-4500.35 6737.5,-4500.35"/>
</g>
<!-- expert_9_11_1&#45;&gt;tp_9_11 -->
<g id="edge964" class="edge">
<title>expert_9_11_1&#45;&gt;tp_9_11</title>
<path fill="none" stroke="black" d="M6957.59,-4525.93C6916.13,-4513.68 6863.64,-4498.18 6819.93,-4485.27"/>
<polygon fill="black" stroke="black" points="6820.75,-4481.87 6810.17,-4482.39 6818.77,-4488.58 6820.75,-4481.87"/>
</g>
<!-- tp_9_11&#45;&gt;agg_9 -->
<g id="edge965" class="edge">
<title>tp_9_11&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M6622.21,-4450.34C6528.03,-4444.04 6389.73,-4434.98 6269,-4427.79 5847.96,-4402.71 5358.09,-4376.74 5068.26,-4361.71"/>
<polygon fill="black" stroke="black" points="5068.2,-4358.2 5058.03,-4361.18 5067.84,-4365.19 5068.2,-4358.2"/>
</g>
<!-- expert_9_12_0 -->
<g id="node665" class="node">
<title>expert_9_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7462.5,-4570.01 7185.5,-4570.01 7185.5,-4526.01 7462.5,-4526.01 7462.5,-4570.01"/>
<text text-anchor="middle" x="7324" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7324" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 312</text>
<text text-anchor="middle" x="7324" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7324" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_12&#45;&gt;expert_9_12_0 -->
<g id="edge967" class="edge">
<title>route_9_12&#45;&gt;expert_9_12_0</title>
<path fill="none" stroke="black" d="M7324,-4605.66C7324,-4597.38 7324,-4588.4 7324,-4580.09"/>
<polygon fill="black" stroke="black" points="7327.5,-4580.02 7324,-4570.02 7320.5,-4580.02 7327.5,-4580.02"/>
</g>
<!-- expert_9_12_1 -->
<g id="node666" class="node">
<title>expert_9_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7757.5,-4570.01 7480.5,-4570.01 7480.5,-4526.01 7757.5,-4526.01 7757.5,-4570.01"/>
<text text-anchor="middle" x="7619" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7619" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 313</text>
<text text-anchor="middle" x="7619" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7619" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_12&#45;&gt;expert_9_12_1 -->
<g id="edge968" class="edge">
<title>route_9_12&#45;&gt;expert_9_12_1</title>
<path fill="none" stroke="black" d="M7414.92,-4609.28C7454.08,-4597.71 7499.51,-4584.3 7537.56,-4573.06"/>
<polygon fill="black" stroke="black" points="7538.97,-4576.3 7547.57,-4570.11 7536.99,-4569.58 7538.97,-4576.3"/>
</g>
<!-- tp_9_12 -->
<g id="node667" class="node">
<title>tp_9_12</title>
<ellipse fill="lightblue" stroke="black" cx="7324" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7324" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7324" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 312↔313</text>
<text text-anchor="middle" x="7324" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7324" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_12_0&#45;&gt;tp_9_12 -->
<g id="edge969" class="edge">
<title>expert_9_12_0&#45;&gt;tp_9_12</title>
<path fill="none" stroke="black" d="M7324,-4525.93C7324,-4518.25 7324,-4509.3 7324,-4500.51"/>
<polygon fill="black" stroke="black" points="7327.5,-4500.35 7324,-4490.35 7320.5,-4500.35 7327.5,-4500.35"/>
</g>
<!-- expert_9_12_1&#45;&gt;tp_9_12 -->
<g id="edge970" class="edge">
<title>expert_9_12_1&#45;&gt;tp_9_12</title>
<path fill="none" stroke="black" d="M7547.59,-4525.93C7506.13,-4513.68 7453.64,-4498.18 7409.93,-4485.27"/>
<polygon fill="black" stroke="black" points="7410.75,-4481.87 7400.17,-4482.39 7408.77,-4488.58 7410.75,-4481.87"/>
</g>
<!-- tp_9_12&#45;&gt;agg_9 -->
<g id="edge971" class="edge">
<title>tp_9_12&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M7212.71,-4449.88C7118.54,-4443.28 6979.98,-4434.04 6859,-4427.79 6210.3,-4394.25 5445.04,-4368.29 5061.37,-4356.21"/>
<polygon fill="black" stroke="black" points="5061.36,-4352.71 5051.26,-4355.9 5061.14,-4359.71 5061.36,-4352.71"/>
</g>
<!-- expert_9_13_0 -->
<g id="node669" class="node">
<title>expert_9_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8052.5,-4570.01 7775.5,-4570.01 7775.5,-4526.01 8052.5,-4526.01 8052.5,-4570.01"/>
<text text-anchor="middle" x="7914" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7914" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 314</text>
<text text-anchor="middle" x="7914" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7914" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_13&#45;&gt;expert_9_13_0 -->
<g id="edge973" class="edge">
<title>route_9_13&#45;&gt;expert_9_13_0</title>
<path fill="none" stroke="black" d="M7914,-4605.66C7914,-4597.38 7914,-4588.4 7914,-4580.09"/>
<polygon fill="black" stroke="black" points="7917.5,-4580.02 7914,-4570.02 7910.5,-4580.02 7917.5,-4580.02"/>
</g>
<!-- expert_9_13_1 -->
<g id="node670" class="node">
<title>expert_9_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8347.5,-4570.01 8070.5,-4570.01 8070.5,-4526.01 8347.5,-4526.01 8347.5,-4570.01"/>
<text text-anchor="middle" x="8209" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8209" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 315</text>
<text text-anchor="middle" x="8209" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8209" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_13&#45;&gt;expert_9_13_1 -->
<g id="edge974" class="edge">
<title>route_9_13&#45;&gt;expert_9_13_1</title>
<path fill="none" stroke="black" d="M8004.92,-4609.28C8044.08,-4597.71 8089.51,-4584.3 8127.56,-4573.06"/>
<polygon fill="black" stroke="black" points="8128.97,-4576.3 8137.57,-4570.11 8126.99,-4569.58 8128.97,-4576.3"/>
</g>
<!-- tp_9_13 -->
<g id="node671" class="node">
<title>tp_9_13</title>
<ellipse fill="lightblue" stroke="black" cx="7914" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7914" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7914" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 314↔315</text>
<text text-anchor="middle" x="7914" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7914" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_13_0&#45;&gt;tp_9_13 -->
<g id="edge975" class="edge">
<title>expert_9_13_0&#45;&gt;tp_9_13</title>
<path fill="none" stroke="black" d="M7914,-4525.93C7914,-4518.25 7914,-4509.3 7914,-4500.51"/>
<polygon fill="black" stroke="black" points="7917.5,-4500.35 7914,-4490.35 7910.5,-4500.35 7917.5,-4500.35"/>
</g>
<!-- expert_9_13_1&#45;&gt;tp_9_13 -->
<g id="edge976" class="edge">
<title>expert_9_13_1&#45;&gt;tp_9_13</title>
<path fill="none" stroke="black" d="M8137.59,-4525.93C8096.13,-4513.68 8043.64,-4498.18 7999.93,-4485.27"/>
<polygon fill="black" stroke="black" points="8000.75,-4481.87 7990.17,-4482.39 7998.77,-4488.58 8000.75,-4481.87"/>
</g>
<!-- tp_9_13&#45;&gt;agg_9 -->
<g id="edge977" class="edge">
<title>tp_9_13&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M7803.2,-4449.64C7709.02,-4442.88 7570.21,-4433.53 7449,-4427.79 6568.43,-4386.08 5521.09,-4362.39 5057.4,-4353.23"/>
<polygon fill="black" stroke="black" points="5057.3,-4349.73 5047.24,-4353.03 5057.17,-4356.73 5057.3,-4349.73"/>
</g>
<!-- expert_9_14_0 -->
<g id="node673" class="node">
<title>expert_9_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8642.5,-4570.01 8365.5,-4570.01 8365.5,-4526.01 8642.5,-4526.01 8642.5,-4570.01"/>
<text text-anchor="middle" x="8504" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8504" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 316</text>
<text text-anchor="middle" x="8504" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8504" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_14&#45;&gt;expert_9_14_0 -->
<g id="edge979" class="edge">
<title>route_9_14&#45;&gt;expert_9_14_0</title>
<path fill="none" stroke="black" d="M8504,-4605.66C8504,-4597.38 8504,-4588.4 8504,-4580.09"/>
<polygon fill="black" stroke="black" points="8507.5,-4580.02 8504,-4570.02 8500.5,-4580.02 8507.5,-4580.02"/>
</g>
<!-- expert_9_14_1 -->
<g id="node674" class="node">
<title>expert_9_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8937.5,-4570.01 8660.5,-4570.01 8660.5,-4526.01 8937.5,-4526.01 8937.5,-4570.01"/>
<text text-anchor="middle" x="8799" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8799" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 317</text>
<text text-anchor="middle" x="8799" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8799" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_14&#45;&gt;expert_9_14_1 -->
<g id="edge980" class="edge">
<title>route_9_14&#45;&gt;expert_9_14_1</title>
<path fill="none" stroke="black" d="M8594.92,-4609.28C8634.08,-4597.71 8679.51,-4584.3 8717.56,-4573.06"/>
<polygon fill="black" stroke="black" points="8718.97,-4576.3 8727.57,-4570.11 8716.99,-4569.58 8718.97,-4576.3"/>
</g>
<!-- tp_9_14 -->
<g id="node675" class="node">
<title>tp_9_14</title>
<ellipse fill="lightblue" stroke="black" cx="8504" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8504" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8504" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 316↔317</text>
<text text-anchor="middle" x="8504" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8504" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_14_0&#45;&gt;tp_9_14 -->
<g id="edge981" class="edge">
<title>expert_9_14_0&#45;&gt;tp_9_14</title>
<path fill="none" stroke="black" d="M8504,-4525.93C8504,-4518.25 8504,-4509.3 8504,-4500.51"/>
<polygon fill="black" stroke="black" points="8507.5,-4500.35 8504,-4490.35 8500.5,-4500.35 8507.5,-4500.35"/>
</g>
<!-- expert_9_14_1&#45;&gt;tp_9_14 -->
<g id="edge982" class="edge">
<title>expert_9_14_1&#45;&gt;tp_9_14</title>
<path fill="none" stroke="black" d="M8727.59,-4525.93C8686.13,-4513.68 8633.64,-4498.18 8589.93,-4485.27"/>
<polygon fill="black" stroke="black" points="8590.75,-4481.87 8580.17,-4482.39 8588.77,-4488.58 8590.75,-4481.87"/>
</g>
<!-- tp_9_14&#45;&gt;agg_9 -->
<g id="edge983" class="edge">
<title>tp_9_14&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M8393.2,-4449.47C8299.04,-4442.61 8160.23,-4433.2 8039,-4427.79 6923.96,-4378.04 5590.42,-4357.86 5055.36,-4351.37"/>
<polygon fill="black" stroke="black" points="5055.25,-4347.87 5045.21,-4351.25 5055.16,-4354.87 5055.25,-4347.87"/>
</g>
<!-- expert_9_15_0 -->
<g id="node677" class="node">
<title>expert_9_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9232.5,-4570.01 8955.5,-4570.01 8955.5,-4526.01 9232.5,-4526.01 9232.5,-4570.01"/>
<text text-anchor="middle" x="9094" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9094" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 318</text>
<text text-anchor="middle" x="9094" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9094" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_15&#45;&gt;expert_9_15_0 -->
<g id="edge985" class="edge">
<title>route_9_15&#45;&gt;expert_9_15_0</title>
<path fill="none" stroke="black" d="M9094,-4605.66C9094,-4597.38 9094,-4588.4 9094,-4580.09"/>
<polygon fill="black" stroke="black" points="9097.5,-4580.02 9094,-4570.02 9090.5,-4580.02 9097.5,-4580.02"/>
</g>
<!-- expert_9_15_1 -->
<g id="node678" class="node">
<title>expert_9_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9527.5,-4570.01 9250.5,-4570.01 9250.5,-4526.01 9527.5,-4526.01 9527.5,-4570.01"/>
<text text-anchor="middle" x="9389" y="-4560.81" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9389" y="-4550.81" font-family="Times,serif" font-size="9.00">GPU: 319</text>
<text text-anchor="middle" x="9389" y="-4540.81" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9389" y="-4530.81" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_9_15&#45;&gt;expert_9_15_1 -->
<g id="edge986" class="edge">
<title>route_9_15&#45;&gt;expert_9_15_1</title>
<path fill="none" stroke="black" d="M9184.92,-4609.28C9224.08,-4597.71 9269.51,-4584.3 9307.56,-4573.06"/>
<polygon fill="black" stroke="black" points="9308.97,-4576.3 9317.57,-4570.11 9306.99,-4569.58 9308.97,-4576.3"/>
</g>
<!-- tp_9_15 -->
<g id="node679" class="node">
<title>tp_9_15</title>
<ellipse fill="lightblue" stroke="black" cx="9094" cy="-4458.9" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9094" y="-4471.7" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9094" y="-4461.7" font-family="Times,serif" font-size="9.00">GPU: 318↔319</text>
<text text-anchor="middle" x="9094" y="-4451.7" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9094" y="-4441.7" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_9_15_0&#45;&gt;tp_9_15 -->
<g id="edge987" class="edge">
<title>expert_9_15_0&#45;&gt;tp_9_15</title>
<path fill="none" stroke="black" d="M9094,-4525.93C9094,-4518.25 9094,-4509.3 9094,-4500.51"/>
<polygon fill="black" stroke="black" points="9097.5,-4500.35 9094,-4490.35 9090.5,-4500.35 9097.5,-4500.35"/>
</g>
<!-- expert_9_15_1&#45;&gt;tp_9_15 -->
<g id="edge988" class="edge">
<title>expert_9_15_1&#45;&gt;tp_9_15</title>
<path fill="none" stroke="black" d="M9317.59,-4525.93C9276.13,-4513.68 9223.64,-4498.18 9179.93,-4485.27"/>
<polygon fill="black" stroke="black" points="9180.75,-4481.87 9170.17,-4482.39 9178.77,-4488.58 9180.75,-4481.87"/>
</g>
<!-- tp_9_15&#45;&gt;agg_9 -->
<g id="edge989" class="edge">
<title>tp_9_15&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M8983.21,-4449.35C8889.04,-4442.42 8750.24,-4432.97 8629,-4427.79 7276.8,-4370.03 5652.99,-4354.14 5053.41,-4350.08"/>
<polygon fill="black" stroke="black" points="5053.38,-4346.58 5043.35,-4350.01 5053.33,-4353.58 5053.38,-4346.58"/>
</g>
<!-- output_9 -->
<g id="node681" class="node">
<title>output_9</title>
<polygon fill="lightgreen" stroke="black" points="4964,-4267.79 4668,-4267.79 4668,-4223.79 4964,-4223.79 4964,-4267.79"/>
<text text-anchor="middle" x="4816" y="-4258.59" font-family="Times,serif" font-size="9.00">Layer 9 Output</text>
<text text-anchor="middle" x="4816" y="-4248.59" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4238.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4816" y="-4228.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_9&#45;&gt;output_9 -->
<g id="edge990" class="edge">
<title>agg_9&#45;&gt;output_9</title>
<path fill="none" stroke="black" d="M4816,-4303.51C4816,-4294.92 4816,-4286.06 4816,-4277.97"/>
<polygon fill="black" stroke="black" points="4819.5,-4277.87 4816,-4267.87 4812.5,-4277.87 4819.5,-4277.87"/>
</g>
<!-- mha_10 -->
<g id="node682" class="node">
<title>mha_10</title>
<polygon fill="lightgreen" stroke="black" points="4964,-4176.79 4668,-4176.79 4668,-4132.79 4964,-4132.79 4964,-4176.79"/>
<text text-anchor="middle" x="4816" y="-4167.59" font-family="Times,serif" font-size="9.00">MHA L10</text>
<text text-anchor="middle" x="4816" y="-4157.59" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4147.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4816" y="-4137.59" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_9&#45;&gt;mha_10 -->
<g id="edge991" class="edge">
<title>output_9&#45;&gt;mha_10</title>
<path fill="none" stroke="black" d="M4816,-4223.7C4816,-4212.8 4816,-4199.29 4816,-4187.2"/>
<polygon fill="black" stroke="black" points="4819.5,-4187.04 4816,-4177.04 4812.5,-4187.04 4819.5,-4187.04"/>
</g>
<!-- gate_10 -->
<g id="node683" class="node">
<title>gate_10</title>
<polygon fill="lightyellow" stroke="black" points="5115.74,-4096.79 4638.92,-4096.79 4516.26,-4008.79 4993.08,-4008.79 5115.74,-4096.79"/>
<text text-anchor="middle" x="4816" y="-4065.59" font-family="Times,serif" font-size="9.00">Gate L10</text>
<text text-anchor="middle" x="4816" y="-4055.59" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4816" y="-4045.59" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4816" y="-4035.59" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_10&#45;&gt;gate_10 -->
<g id="edge992" class="edge">
<title>mha_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M4816,-4132.58C4816,-4125.08 4816,-4116.27 4816,-4107.31"/>
<polygon fill="black" stroke="black" points="4819.5,-4107.19 4816,-4097.2 4812.5,-4107.2 4819.5,-4107.19"/>
</g>
<!-- route_10_0 -->
<g id="node684" class="node">
<title>route_10_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="512" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="512" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="512" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 320,321</text>
<text text-anchor="middle" x="512" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="512" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_0 -->
<g id="edge993" class="edge">
<title>gate_10&#45;&gt;route_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4576.11,-4051.88C3962.6,-4051.03 2286.49,-4042.02 892,-3972.79 826.75,-3969.55 755.32,-3964.33 692.17,-3959.14"/>
<polygon fill="black" stroke="black" points="692.36,-3955.64 682.11,-3958.31 691.79,-3962.62 692.36,-3955.64"/>
</g>
<!-- route_10_1 -->
<g id="node688" class="node">
<title>route_10_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1102" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1102" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1102" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 322,323</text>
<text text-anchor="middle" x="1102" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1102" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_1 -->
<g id="edge999" class="edge">
<title>gate_10&#45;&gt;route_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4574.49,-4050.65C4025.02,-4047.05 2639.34,-4032.31 1482,-3972.79 1416.91,-3969.44 1345.67,-3964.21 1282.63,-3959.05"/>
<polygon fill="black" stroke="black" points="1282.84,-3955.55 1272.59,-3958.22 1282.27,-3962.53 1282.84,-3955.55"/>
</g>
<!-- route_10_2 -->
<g id="node692" class="node">
<title>route_10_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1692" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1692" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1692" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 324,325</text>
<text text-anchor="middle" x="1692" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1692" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_2 -->
<g id="edge1005" class="edge">
<title>gate_10&#45;&gt;route_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4571.72,-4048.88C4092.18,-4042.25 2994.04,-4022.56 2072,-3972.79 2007.08,-3969.28 1936.02,-3964.03 1873.1,-3958.89"/>
<polygon fill="black" stroke="black" points="1873.32,-3955.4 1863.07,-3958.07 1872.75,-3962.38 1873.32,-3955.4"/>
</g>
<!-- route_10_3 -->
<g id="node696" class="node">
<title>route_10_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2282" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2282" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2282" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 326,327</text>
<text text-anchor="middle" x="2282" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2282" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_3 -->
<g id="edge1011" class="edge">
<title>gate_10&#45;&gt;route_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4567.9,-4046.11C4166.94,-4036.16 3351.73,-4012.75 2662,-3972.79 2597.41,-3969.05 2526.72,-3963.77 2464.03,-3958.68"/>
<polygon fill="black" stroke="black" points="2464.29,-3955.19 2454.03,-3957.86 2463.72,-3962.16 2464.29,-3955.19"/>
</g>
<!-- route_10_4 -->
<g id="node700" class="node">
<title>route_10_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2872" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2872" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2872" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 328,329</text>
<text text-anchor="middle" x="2872" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2872" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_4 -->
<g id="edge1017" class="edge">
<title>gate_10&#45;&gt;route_10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4561.23,-4041.16C4251.57,-4027.73 3713.22,-4002.7 3252,-3972.79 3188.03,-3968.64 3118.08,-3963.32 3055.81,-3958.31"/>
<polygon fill="black" stroke="black" points="3055.74,-3954.79 3045.49,-3957.47 3055.18,-3961.77 3055.74,-3954.79"/>
</g>
<!-- route_10_5 -->
<g id="node704" class="node">
<title>route_10_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3462" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3462" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 330,331</text>
<text text-anchor="middle" x="3462" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3462" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_5 -->
<g id="edge1023" class="edge">
<title>gate_10&#45;&gt;route_10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4545.66,-4030C4279.55,-4008.56 3880.26,-3976.38 3647.95,-3957.66"/>
<polygon fill="black" stroke="black" points="3647.95,-3954.15 3637.7,-3956.83 3647.39,-3961.13 3647.95,-3954.15"/>
</g>
<!-- route_10_6 -->
<g id="node708" class="node">
<title>route_10_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4052" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4052" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4052" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 332,333</text>
<text text-anchor="middle" x="4052" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4052" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_6 -->
<g id="edge1029" class="edge">
<title>gate_10&#45;&gt;route_10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4516.51,-4009.02C4410.41,-3993.86 4295.39,-3977.44 4206.34,-3964.72"/>
<polygon fill="black" stroke="black" points="4206.84,-3961.25 4196.44,-3963.3 4205.85,-3968.18 4206.84,-3961.25"/>
</g>
<!-- route_10_7 -->
<g id="node712" class="node">
<title>route_10_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4579" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4579" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4579" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 334,335</text>
<text text-anchor="middle" x="4579" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4579" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_7 -->
<g id="edge1035" class="edge">
<title>gate_10&#45;&gt;route_10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4722.33,-4008.66C4698.45,-3997.67 4673.16,-3986.03 4650.58,-3975.63"/>
<polygon fill="black" stroke="black" points="4651.96,-3972.41 4641.41,-3971.41 4649.03,-3978.77 4651.96,-3972.41"/>
</g>
<!-- route_10_8 -->
<g id="node716" class="node">
<title>route_10_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4999" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4999" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="4999" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 336,337</text>
<text text-anchor="middle" x="4999" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4999" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_8 -->
<g id="edge1041" class="edge">
<title>gate_10&#45;&gt;route_10_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4888.33,-4008.66C4905.94,-3998.16 4924.54,-3987.07 4941.36,-3977.04"/>
<polygon fill="black" stroke="black" points="4943.19,-3980.03 4949.99,-3971.9 4939.6,-3974.01 4943.19,-3980.03"/>
</g>
<!-- route_10_9 -->
<g id="node720" class="node">
<title>route_10_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5527" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5527" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5527" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 338,339</text>
<text text-anchor="middle" x="5527" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5527" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_9 -->
<g id="edge1047" class="edge">
<title>gate_10&#45;&gt;route_10_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5011.69,-4021.76C5127.08,-4004.05 5270.83,-3981.99 5377.16,-3965.67"/>
<polygon fill="black" stroke="black" points="5377.98,-3969.09 5387.33,-3964.11 5376.92,-3962.17 5377.98,-3969.09"/>
</g>
<!-- route_10_10 -->
<g id="node724" class="node">
<title>route_10_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6117" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6117" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6117" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 340,341</text>
<text text-anchor="middle" x="6117" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6117" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_10 -->
<g id="edge1053" class="edge">
<title>gate_10&#45;&gt;route_10_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5028.29,-4033.98C5279.73,-4012.9 5694.45,-3978.11 5932.88,-3958.12"/>
<polygon fill="black" stroke="black" points="5933.37,-3961.59 5943.05,-3957.26 5932.79,-3954.61 5933.37,-3961.59"/>
</g>
<!-- route_10_11 -->
<g id="node728" class="node">
<title>route_10_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6707" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6707" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6707" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 342,343</text>
<text text-anchor="middle" x="6707" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6707" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_11 -->
<g id="edge1059" class="edge">
<title>gate_10&#45;&gt;route_10_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5039.48,-4041.98C5334.47,-4028.61 5869.93,-4002.84 6327,-3972.79 6390.96,-3968.58 6460.92,-3963.25 6523.18,-3958.24"/>
<polygon fill="black" stroke="black" points="6523.82,-3961.7 6533.51,-3957.41 6523.26,-3954.72 6523.82,-3961.7"/>
</g>
<!-- route_10_12 -->
<g id="node732" class="node">
<title>route_10_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7297" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7297" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7297" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 344,345</text>
<text text-anchor="middle" x="7297" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7297" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_12 -->
<g id="edge1065" class="edge">
<title>gate_10&#45;&gt;route_10_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5045.43,-4046.28C5431.85,-4036.3 6236.95,-4012.5 6917,-3972.79 6981.59,-3969.02 7052.27,-3963.73 7114.97,-3958.64"/>
<polygon fill="black" stroke="black" points="7115.28,-3962.13 7124.96,-3957.83 7114.71,-3955.15 7115.28,-3962.13"/>
</g>
<!-- route_10_13 -->
<g id="node736" class="node">
<title>route_10_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7887" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7887" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7887" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 346,347</text>
<text text-anchor="middle" x="7887" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7887" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_13 -->
<g id="edge1071" class="edge">
<title>gate_10&#45;&gt;route_10_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5049.23,-4048.84C5516.11,-4042.08 6598.68,-4022.08 7507,-3972.79 7571.92,-3969.26 7642.98,-3964.01 7705.9,-3958.87"/>
<polygon fill="black" stroke="black" points="7706.25,-3962.36 7715.93,-3958.05 7705.67,-3955.38 7706.25,-3962.36"/>
</g>
<!-- route_10_14 -->
<g id="node740" class="node">
<title>route_10_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8477" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8477" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8477" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 348,349</text>
<text text-anchor="middle" x="8477" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8477" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_14 -->
<g id="edge1077" class="edge">
<title>gate_10&#45;&gt;route_10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5051.4,-4050.56C5590.58,-4046.77 6956.46,-4031.66 8097,-3972.79 8162.09,-3969.43 8233.33,-3964.2 8296.37,-3959.03"/>
<polygon fill="black" stroke="black" points="8296.73,-3962.51 8306.41,-3958.2 8296.16,-3955.54 8296.73,-3962.51"/>
</g>
<!-- route_10_15 -->
<g id="node744" class="node">
<title>route_10_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9067" cy="-3941.68" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9067" y="-3954.48" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9067" y="-3944.48" font-family="Times,serif" font-size="9.00">GPU: 350,351</text>
<text text-anchor="middle" x="9067" y="-3934.48" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9067" y="-3924.48" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_10&#45;&gt;route_10_15 -->
<g id="edge1083" class="edge">
<title>gate_10&#45;&gt;route_10_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5053.2,-4051.79C5658.88,-4050.73 7311.77,-4041.25 8687,-3972.79 8752.25,-3969.54 8823.68,-3964.32 8886.83,-3959.13"/>
<polygon fill="black" stroke="black" points="8887.21,-3962.61 8896.89,-3958.3 8886.64,-3955.63 8887.21,-3962.61"/>
</g>
<!-- expert_10_0_0 -->
<g id="node685" class="node">
<title>expert_10_0_0</title>
<polygon fill="lightgreen" stroke="black" points="355.5,-3874.56 78.5,-3874.56 78.5,-3830.56 355.5,-3830.56 355.5,-3874.56"/>
<text text-anchor="middle" x="217" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="217" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 320</text>
<text text-anchor="middle" x="217" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="217" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_0&#45;&gt;expert_10_0_0 -->
<g id="edge994" class="edge">
<title>route_10_0&#45;&gt;expert_10_0_0</title>
<path fill="none" stroke="black" d="M421.08,-3913.83C381.92,-3902.26 336.49,-3888.85 298.44,-3877.61"/>
<polygon fill="black" stroke="black" points="299.01,-3874.13 288.43,-3874.66 297.03,-3880.84 299.01,-3874.13"/>
</g>
<!-- expert_10_0_1 -->
<g id="node686" class="node">
<title>expert_10_0_1</title>
<polygon fill="lightgreen" stroke="black" points="650.5,-3874.56 373.5,-3874.56 373.5,-3830.56 650.5,-3830.56 650.5,-3874.56"/>
<text text-anchor="middle" x="512" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="512" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 321</text>
<text text-anchor="middle" x="512" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="512" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_0&#45;&gt;expert_10_0_1 -->
<g id="edge995" class="edge">
<title>route_10_0&#45;&gt;expert_10_0_1</title>
<path fill="none" stroke="black" d="M512,-3910.21C512,-3901.93 512,-3892.95 512,-3884.64"/>
<polygon fill="black" stroke="black" points="515.5,-3884.57 512,-3874.57 508.5,-3884.57 515.5,-3884.57"/>
</g>
<!-- tp_10_0 -->
<g id="node687" class="node">
<title>tp_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="512" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="512" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="512" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 320↔321</text>
<text text-anchor="middle" x="512" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="512" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_0_0&#45;&gt;tp_10_0 -->
<g id="edge996" class="edge">
<title>expert_10_0_0&#45;&gt;tp_10_0</title>
<path fill="none" stroke="black" d="M288.41,-3830.48C329.87,-3818.23 382.36,-3802.73 426.07,-3789.82"/>
<polygon fill="black" stroke="black" points="427.23,-3793.13 435.83,-3786.94 425.25,-3786.42 427.23,-3793.13"/>
</g>
<!-- expert_10_0_1&#45;&gt;tp_10_0 -->
<g id="edge997" class="edge">
<title>expert_10_0_1&#45;&gt;tp_10_0</title>
<path fill="none" stroke="black" d="M512,-3830.48C512,-3822.8 512,-3813.85 512,-3805.06"/>
<polygon fill="black" stroke="black" points="515.5,-3804.89 512,-3794.89 508.5,-3804.89 515.5,-3804.89"/>
</g>
<!-- agg_10 -->
<g id="node748" class="node">
<title>agg_10</title>
<polygon fill="lightyellow" stroke="black" points="5070.99,-3696.34 4622.4,-3696.34 4507.01,-3608.34 4955.6,-3608.34 5070.99,-3696.34"/>
<text text-anchor="middle" x="4789" y="-3665.14" font-family="Times,serif" font-size="9.00">Aggregate Experts L10</text>
<text text-anchor="middle" x="4789" y="-3655.14" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4789" y="-3645.14" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4789" y="-3635.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_10_0&#45;&gt;agg_10 -->
<g id="edge998" class="edge">
<title>tp_10_0&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M622.79,-3753.9C716.96,-3746.96 855.76,-3737.52 977,-3732.34 2332.83,-3674.42 3961.8,-3658.6 4556.92,-3654.6"/>
<polygon fill="black" stroke="black" points="4557.36,-3658.09 4567.33,-3654.53 4557.31,-3651.09 4557.36,-3658.09"/>
</g>
<!-- expert_10_1_0 -->
<g id="node689" class="node">
<title>expert_10_1_0</title>
<polygon fill="lightgreen" stroke="black" points="945.5,-3874.56 668.5,-3874.56 668.5,-3830.56 945.5,-3830.56 945.5,-3874.56"/>
<text text-anchor="middle" x="807" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="807" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 322</text>
<text text-anchor="middle" x="807" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="807" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_1&#45;&gt;expert_10_1_0 -->
<g id="edge1000" class="edge">
<title>route_10_1&#45;&gt;expert_10_1_0</title>
<path fill="none" stroke="black" d="M1011.08,-3913.83C971.92,-3902.26 926.49,-3888.85 888.44,-3877.61"/>
<polygon fill="black" stroke="black" points="889.01,-3874.13 878.43,-3874.66 887.03,-3880.84 889.01,-3874.13"/>
</g>
<!-- expert_10_1_1 -->
<g id="node690" class="node">
<title>expert_10_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1240.5,-3874.56 963.5,-3874.56 963.5,-3830.56 1240.5,-3830.56 1240.5,-3874.56"/>
<text text-anchor="middle" x="1102" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1102" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 323</text>
<text text-anchor="middle" x="1102" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1102" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_1&#45;&gt;expert_10_1_1 -->
<g id="edge1001" class="edge">
<title>route_10_1&#45;&gt;expert_10_1_1</title>
<path fill="none" stroke="black" d="M1102,-3910.21C1102,-3901.93 1102,-3892.95 1102,-3884.64"/>
<polygon fill="black" stroke="black" points="1105.5,-3884.57 1102,-3874.57 1098.5,-3884.57 1105.5,-3884.57"/>
</g>
<!-- tp_10_1 -->
<g id="node691" class="node">
<title>tp_10_1</title>
<ellipse fill="lightblue" stroke="black" cx="1102" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1102" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1102" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 322↔323</text>
<text text-anchor="middle" x="1102" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1102" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_1_0&#45;&gt;tp_10_1 -->
<g id="edge1002" class="edge">
<title>expert_10_1_0&#45;&gt;tp_10_1</title>
<path fill="none" stroke="black" d="M878.41,-3830.48C919.87,-3818.23 972.36,-3802.73 1016.07,-3789.82"/>
<polygon fill="black" stroke="black" points="1017.23,-3793.13 1025.83,-3786.94 1015.25,-3786.42 1017.23,-3793.13"/>
</g>
<!-- expert_10_1_1&#45;&gt;tp_10_1 -->
<g id="edge1003" class="edge">
<title>expert_10_1_1&#45;&gt;tp_10_1</title>
<path fill="none" stroke="black" d="M1102,-3830.48C1102,-3822.8 1102,-3813.85 1102,-3805.06"/>
<polygon fill="black" stroke="black" points="1105.5,-3804.89 1102,-3794.89 1098.5,-3804.89 1105.5,-3804.89"/>
</g>
<!-- tp_10_1&#45;&gt;agg_10 -->
<g id="edge1004" class="edge">
<title>tp_10_1&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1212.8,-3754.02C1306.96,-3747.16 1445.77,-3737.75 1567,-3732.34 2687.94,-3682.32 4029.78,-3662.19 4558.63,-3655.81"/>
<polygon fill="black" stroke="black" points="4558.71,-3659.31 4568.67,-3655.69 4558.63,-3652.31 4558.71,-3659.31"/>
</g>
<!-- expert_10_2_0 -->
<g id="node693" class="node">
<title>expert_10_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1535.5,-3874.56 1258.5,-3874.56 1258.5,-3830.56 1535.5,-3830.56 1535.5,-3874.56"/>
<text text-anchor="middle" x="1397" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1397" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 324</text>
<text text-anchor="middle" x="1397" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1397" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_2&#45;&gt;expert_10_2_0 -->
<g id="edge1006" class="edge">
<title>route_10_2&#45;&gt;expert_10_2_0</title>
<path fill="none" stroke="black" d="M1601.08,-3913.83C1561.92,-3902.26 1516.49,-3888.85 1478.44,-3877.61"/>
<polygon fill="black" stroke="black" points="1479.01,-3874.13 1468.43,-3874.66 1477.03,-3880.84 1479.01,-3874.13"/>
</g>
<!-- expert_10_2_1 -->
<g id="node694" class="node">
<title>expert_10_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1830.5,-3874.56 1553.5,-3874.56 1553.5,-3830.56 1830.5,-3830.56 1830.5,-3874.56"/>
<text text-anchor="middle" x="1692" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1692" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 325</text>
<text text-anchor="middle" x="1692" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1692" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_2&#45;&gt;expert_10_2_1 -->
<g id="edge1007" class="edge">
<title>route_10_2&#45;&gt;expert_10_2_1</title>
<path fill="none" stroke="black" d="M1692,-3910.21C1692,-3901.93 1692,-3892.95 1692,-3884.64"/>
<polygon fill="black" stroke="black" points="1695.5,-3884.57 1692,-3874.57 1688.5,-3884.57 1695.5,-3884.57"/>
</g>
<!-- tp_10_2 -->
<g id="node695" class="node">
<title>tp_10_2</title>
<ellipse fill="lightblue" stroke="black" cx="1692" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1692" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1692" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 324↔325</text>
<text text-anchor="middle" x="1692" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1692" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_2_0&#45;&gt;tp_10_2 -->
<g id="edge1008" class="edge">
<title>expert_10_2_0&#45;&gt;tp_10_2</title>
<path fill="none" stroke="black" d="M1468.41,-3830.48C1509.87,-3818.23 1562.36,-3802.73 1606.07,-3789.82"/>
<polygon fill="black" stroke="black" points="1607.23,-3793.13 1615.83,-3786.94 1605.25,-3786.42 1607.23,-3793.13"/>
</g>
<!-- expert_10_2_1&#45;&gt;tp_10_2 -->
<g id="edge1009" class="edge">
<title>expert_10_2_1&#45;&gt;tp_10_2</title>
<path fill="none" stroke="black" d="M1692,-3830.48C1692,-3822.8 1692,-3813.85 1692,-3805.06"/>
<polygon fill="black" stroke="black" points="1695.5,-3804.89 1692,-3794.89 1688.5,-3804.89 1695.5,-3804.89"/>
</g>
<!-- tp_10_2&#45;&gt;agg_10 -->
<g id="edge1010" class="edge">
<title>tp_10_2&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1802.8,-3754.19C1896.98,-3747.43 2035.79,-3738.08 2157,-3732.34 3045.74,-3690.24 4104.42,-3666.49 4560.95,-3657.52"/>
<polygon fill="black" stroke="black" points="4561.03,-3661.02 4570.96,-3657.33 4560.89,-3654.02 4561.03,-3661.02"/>
</g>
<!-- expert_10_3_0 -->
<g id="node697" class="node">
<title>expert_10_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2125.5,-3874.56 1848.5,-3874.56 1848.5,-3830.56 2125.5,-3830.56 2125.5,-3874.56"/>
<text text-anchor="middle" x="1987" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1987" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 326</text>
<text text-anchor="middle" x="1987" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1987" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_3&#45;&gt;expert_10_3_0 -->
<g id="edge1012" class="edge">
<title>route_10_3&#45;&gt;expert_10_3_0</title>
<path fill="none" stroke="black" d="M2191.08,-3913.83C2151.92,-3902.26 2106.49,-3888.85 2068.44,-3877.61"/>
<polygon fill="black" stroke="black" points="2069.01,-3874.13 2058.43,-3874.66 2067.03,-3880.84 2069.01,-3874.13"/>
</g>
<!-- expert_10_3_1 -->
<g id="node698" class="node">
<title>expert_10_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2420.5,-3874.56 2143.5,-3874.56 2143.5,-3830.56 2420.5,-3830.56 2420.5,-3874.56"/>
<text text-anchor="middle" x="2282" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2282" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 327</text>
<text text-anchor="middle" x="2282" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2282" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_3&#45;&gt;expert_10_3_1 -->
<g id="edge1013" class="edge">
<title>route_10_3&#45;&gt;expert_10_3_1</title>
<path fill="none" stroke="black" d="M2282,-3910.21C2282,-3901.93 2282,-3892.95 2282,-3884.64"/>
<polygon fill="black" stroke="black" points="2285.5,-3884.57 2282,-3874.57 2278.5,-3884.57 2285.5,-3884.57"/>
</g>
<!-- tp_10_3 -->
<g id="node699" class="node">
<title>tp_10_3</title>
<ellipse fill="lightblue" stroke="black" cx="2282" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2282" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2282" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 326↔327</text>
<text text-anchor="middle" x="2282" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2282" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_3_0&#45;&gt;tp_10_3 -->
<g id="edge1014" class="edge">
<title>expert_10_3_0&#45;&gt;tp_10_3</title>
<path fill="none" stroke="black" d="M2058.41,-3830.48C2099.87,-3818.23 2152.36,-3802.73 2196.07,-3789.82"/>
<polygon fill="black" stroke="black" points="2197.23,-3793.13 2205.83,-3786.94 2195.25,-3786.42 2197.23,-3793.13"/>
</g>
<!-- expert_10_3_1&#45;&gt;tp_10_3 -->
<g id="edge1015" class="edge">
<title>expert_10_3_1&#45;&gt;tp_10_3</title>
<path fill="none" stroke="black" d="M2282,-3830.48C2282,-3822.8 2282,-3813.85 2282,-3805.06"/>
<polygon fill="black" stroke="black" points="2285.5,-3804.89 2282,-3794.89 2278.5,-3804.89 2285.5,-3804.89"/>
</g>
<!-- tp_10_3&#45;&gt;agg_10 -->
<g id="edge1016" class="edge">
<title>tp_10_3&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2393.29,-3754.43C2487.46,-3747.83 2626.02,-3738.59 2747,-3732.34 3407.08,-3698.2 4187.88,-3671.91 4564.12,-3660.13"/>
<polygon fill="black" stroke="black" points="4564.42,-3663.62 4574.3,-3659.81 4564.2,-3656.62 4564.42,-3663.62"/>
</g>
<!-- expert_10_4_0 -->
<g id="node701" class="node">
<title>expert_10_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2715.5,-3874.56 2438.5,-3874.56 2438.5,-3830.56 2715.5,-3830.56 2715.5,-3874.56"/>
<text text-anchor="middle" x="2577" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2577" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 328</text>
<text text-anchor="middle" x="2577" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2577" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_4&#45;&gt;expert_10_4_0 -->
<g id="edge1018" class="edge">
<title>route_10_4&#45;&gt;expert_10_4_0</title>
<path fill="none" stroke="black" d="M2781.08,-3913.83C2741.92,-3902.26 2696.49,-3888.85 2658.44,-3877.61"/>
<polygon fill="black" stroke="black" points="2659.01,-3874.13 2648.43,-3874.66 2657.03,-3880.84 2659.01,-3874.13"/>
</g>
<!-- expert_10_4_1 -->
<g id="node702" class="node">
<title>expert_10_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3010.5,-3874.56 2733.5,-3874.56 2733.5,-3830.56 3010.5,-3830.56 3010.5,-3874.56"/>
<text text-anchor="middle" x="2872" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2872" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 329</text>
<text text-anchor="middle" x="2872" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2872" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_4&#45;&gt;expert_10_4_1 -->
<g id="edge1019" class="edge">
<title>route_10_4&#45;&gt;expert_10_4_1</title>
<path fill="none" stroke="black" d="M2872,-3910.21C2872,-3901.93 2872,-3892.95 2872,-3884.64"/>
<polygon fill="black" stroke="black" points="2875.5,-3884.57 2872,-3874.57 2868.5,-3884.57 2875.5,-3884.57"/>
</g>
<!-- tp_10_4 -->
<g id="node703" class="node">
<title>tp_10_4</title>
<ellipse fill="lightblue" stroke="black" cx="2872" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2872" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2872" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 328↔329</text>
<text text-anchor="middle" x="2872" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2872" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_4_0&#45;&gt;tp_10_4 -->
<g id="edge1020" class="edge">
<title>expert_10_4_0&#45;&gt;tp_10_4</title>
<path fill="none" stroke="black" d="M2648.41,-3830.48C2689.87,-3818.23 2742.36,-3802.73 2786.07,-3789.82"/>
<polygon fill="black" stroke="black" points="2787.23,-3793.13 2795.83,-3786.94 2785.25,-3786.42 2787.23,-3793.13"/>
</g>
<!-- expert_10_4_1&#45;&gt;tp_10_4 -->
<g id="edge1021" class="edge">
<title>expert_10_4_1&#45;&gt;tp_10_4</title>
<path fill="none" stroke="black" d="M2872,-3830.48C2872,-3822.8 2872,-3813.85 2872,-3805.06"/>
<polygon fill="black" stroke="black" points="2875.5,-3804.89 2872,-3794.89 2868.5,-3804.89 2875.5,-3804.89"/>
</g>
<!-- tp_10_4&#45;&gt;agg_10 -->
<g id="edge1022" class="edge">
<title>tp_10_4&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M2983.79,-3754.89C3077.97,-3748.59 3216.27,-3739.53 3337,-3732.34 3774.09,-3706.29 4285.42,-3679.28 4569.75,-3664.56"/>
<polygon fill="black" stroke="black" points="4569.96,-3668.05 4579.77,-3664.04 4569.6,-3661.06 4569.96,-3668.05"/>
</g>
<!-- expert_10_5_0 -->
<g id="node705" class="node">
<title>expert_10_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3305.5,-3874.56 3028.5,-3874.56 3028.5,-3830.56 3305.5,-3830.56 3305.5,-3874.56"/>
<text text-anchor="middle" x="3167" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3167" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 330</text>
<text text-anchor="middle" x="3167" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3167" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_5&#45;&gt;expert_10_5_0 -->
<g id="edge1024" class="edge">
<title>route_10_5&#45;&gt;expert_10_5_0</title>
<path fill="none" stroke="black" d="M3371.08,-3913.83C3331.92,-3902.26 3286.49,-3888.85 3248.44,-3877.61"/>
<polygon fill="black" stroke="black" points="3249.01,-3874.13 3238.43,-3874.66 3247.03,-3880.84 3249.01,-3874.13"/>
</g>
<!-- expert_10_5_1 -->
<g id="node706" class="node">
<title>expert_10_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3600.5,-3874.56 3323.5,-3874.56 3323.5,-3830.56 3600.5,-3830.56 3600.5,-3874.56"/>
<text text-anchor="middle" x="3462" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3462" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 331</text>
<text text-anchor="middle" x="3462" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3462" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_5&#45;&gt;expert_10_5_1 -->
<g id="edge1025" class="edge">
<title>route_10_5&#45;&gt;expert_10_5_1</title>
<path fill="none" stroke="black" d="M3462,-3910.21C3462,-3901.93 3462,-3892.95 3462,-3884.64"/>
<polygon fill="black" stroke="black" points="3465.5,-3884.57 3462,-3874.57 3458.5,-3884.57 3465.5,-3884.57"/>
</g>
<!-- tp_10_5 -->
<g id="node707" class="node">
<title>tp_10_5</title>
<ellipse fill="lightblue" stroke="black" cx="3462" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3462" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 330↔331</text>
<text text-anchor="middle" x="3462" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3462" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_5_0&#45;&gt;tp_10_5 -->
<g id="edge1026" class="edge">
<title>expert_10_5_0&#45;&gt;tp_10_5</title>
<path fill="none" stroke="black" d="M3238.41,-3830.48C3279.87,-3818.23 3332.36,-3802.73 3376.07,-3789.82"/>
<polygon fill="black" stroke="black" points="3377.23,-3793.13 3385.83,-3786.94 3375.25,-3786.42 3377.23,-3793.13"/>
</g>
<!-- expert_10_5_1&#45;&gt;tp_10_5 -->
<g id="edge1027" class="edge">
<title>expert_10_5_1&#45;&gt;tp_10_5</title>
<path fill="none" stroke="black" d="M3462,-3830.48C3462,-3822.8 3462,-3813.85 3462,-3805.06"/>
<polygon fill="black" stroke="black" points="3465.5,-3804.89 3462,-3794.89 3458.5,-3804.89 3465.5,-3804.89"/>
</g>
<!-- tp_10_5&#45;&gt;agg_10 -->
<g id="edge1028" class="edge">
<title>tp_10_5&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M3572.01,-3753.4C3792.49,-3735.28 4291.79,-3694.22 4577.61,-3670.72"/>
<polygon fill="black" stroke="black" points="4578.01,-3674.2 4587.69,-3669.89 4577.44,-3667.22 4578.01,-3674.2"/>
</g>
<!-- expert_10_6_0 -->
<g id="node709" class="node">
<title>expert_10_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3895.5,-3874.56 3618.5,-3874.56 3618.5,-3830.56 3895.5,-3830.56 3895.5,-3874.56"/>
<text text-anchor="middle" x="3757" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3757" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 332</text>
<text text-anchor="middle" x="3757" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3757" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_6&#45;&gt;expert_10_6_0 -->
<g id="edge1030" class="edge">
<title>route_10_6&#45;&gt;expert_10_6_0</title>
<path fill="none" stroke="black" d="M3961.08,-3913.83C3921.92,-3902.26 3876.49,-3888.85 3838.44,-3877.61"/>
<polygon fill="black" stroke="black" points="3839.01,-3874.13 3828.43,-3874.66 3837.03,-3880.84 3839.01,-3874.13"/>
</g>
<!-- expert_10_6_1 -->
<g id="node710" class="node">
<title>expert_10_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4190.5,-3874.56 3913.5,-3874.56 3913.5,-3830.56 4190.5,-3830.56 4190.5,-3874.56"/>
<text text-anchor="middle" x="4052" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4052" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 333</text>
<text text-anchor="middle" x="4052" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4052" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_6&#45;&gt;expert_10_6_1 -->
<g id="edge1031" class="edge">
<title>route_10_6&#45;&gt;expert_10_6_1</title>
<path fill="none" stroke="black" d="M4052,-3910.21C4052,-3901.93 4052,-3892.95 4052,-3884.64"/>
<polygon fill="black" stroke="black" points="4055.5,-3884.57 4052,-3874.57 4048.5,-3884.57 4055.5,-3884.57"/>
</g>
<!-- tp_10_6 -->
<g id="node711" class="node">
<title>tp_10_6</title>
<ellipse fill="lightblue" stroke="black" cx="4052" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4052" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4052" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 332↔333</text>
<text text-anchor="middle" x="4052" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4052" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_6_0&#45;&gt;tp_10_6 -->
<g id="edge1032" class="edge">
<title>expert_10_6_0&#45;&gt;tp_10_6</title>
<path fill="none" stroke="black" d="M3828.41,-3830.48C3869.87,-3818.23 3922.36,-3802.73 3966.07,-3789.82"/>
<polygon fill="black" stroke="black" points="3967.23,-3793.13 3975.83,-3786.94 3965.25,-3786.42 3967.23,-3793.13"/>
</g>
<!-- expert_10_6_1&#45;&gt;tp_10_6 -->
<g id="edge1033" class="edge">
<title>expert_10_6_1&#45;&gt;tp_10_6</title>
<path fill="none" stroke="black" d="M4052,-3830.48C4052,-3822.8 4052,-3813.85 4052,-3805.06"/>
<polygon fill="black" stroke="black" points="4055.5,-3804.89 4052,-3794.89 4048.5,-3804.89 4055.5,-3804.89"/>
</g>
<!-- tp_10_6&#45;&gt;agg_10 -->
<g id="edge1034" class="edge">
<title>tp_10_6&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M4152.16,-3747.62C4264.68,-3730.96 4450.1,-3703.51 4591.93,-3682.51"/>
<polygon fill="black" stroke="black" points="4592.68,-3685.94 4602.06,-3681.01 4591.66,-3679.02 4592.68,-3685.94"/>
</g>
<!-- expert_10_7_0 -->
<g id="node713" class="node">
<title>expert_10_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4485.5,-3874.56 4208.5,-3874.56 4208.5,-3830.56 4485.5,-3830.56 4485.5,-3874.56"/>
<text text-anchor="middle" x="4347" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4347" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 334</text>
<text text-anchor="middle" x="4347" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4347" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_7&#45;&gt;expert_10_7_0 -->
<g id="edge1036" class="edge">
<title>route_10_7&#45;&gt;expert_10_7_0</title>
<path fill="none" stroke="black" d="M4504.64,-3912.75C4475.11,-3901.66 4441.42,-3889.02 4412.8,-3878.27"/>
<polygon fill="black" stroke="black" points="4413.89,-3874.94 4403.29,-3874.7 4411.43,-3881.49 4413.89,-3874.94"/>
</g>
<!-- expert_10_7_1 -->
<g id="node714" class="node">
<title>expert_10_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4780.5,-3874.56 4503.5,-3874.56 4503.5,-3830.56 4780.5,-3830.56 4780.5,-3874.56"/>
<text text-anchor="middle" x="4642" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4642" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 335</text>
<text text-anchor="middle" x="4642" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4642" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_7&#45;&gt;expert_10_7_1 -->
<g id="edge1037" class="edge">
<title>route_10_7&#45;&gt;expert_10_7_1</title>
<path fill="none" stroke="black" d="M4600.68,-3910.7C4607.15,-3901.74 4614.24,-3891.94 4620.69,-3883.03"/>
<polygon fill="black" stroke="black" points="4623.61,-3884.96 4626.64,-3874.8 4617.94,-3880.86 4623.61,-3884.96"/>
</g>
<!-- tp_10_7 -->
<g id="node715" class="node">
<title>tp_10_7</title>
<ellipse fill="lightblue" stroke="black" cx="4642" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4642" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4642" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 334↔335</text>
<text text-anchor="middle" x="4642" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4642" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_7_0&#45;&gt;tp_10_7 -->
<g id="edge1038" class="edge">
<title>expert_10_7_0&#45;&gt;tp_10_7</title>
<path fill="none" stroke="black" d="M4418.41,-3830.48C4459.87,-3818.23 4512.36,-3802.73 4556.07,-3789.82"/>
<polygon fill="black" stroke="black" points="4557.23,-3793.13 4565.83,-3786.94 4555.25,-3786.42 4557.23,-3793.13"/>
</g>
<!-- expert_10_7_1&#45;&gt;tp_10_7 -->
<g id="edge1039" class="edge">
<title>expert_10_7_1&#45;&gt;tp_10_7</title>
<path fill="none" stroke="black" d="M4642,-3830.48C4642,-3822.8 4642,-3813.85 4642,-3805.06"/>
<polygon fill="black" stroke="black" points="4645.5,-3804.89 4642,-3794.89 4638.5,-3804.89 4645.5,-3804.89"/>
</g>
<!-- tp_10_7&#45;&gt;agg_10 -->
<g id="edge1040" class="edge">
<title>tp_10_7&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M4680.24,-3734.07C4693.3,-3724.37 4708.31,-3713.23 4722.93,-3702.38"/>
<polygon fill="black" stroke="black" points="4725.05,-3705.16 4730.99,-3696.39 4720.88,-3699.54 4725.05,-3705.16"/>
</g>
<!-- expert_10_8_0 -->
<g id="node717" class="node">
<title>expert_10_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5075.5,-3874.56 4798.5,-3874.56 4798.5,-3830.56 5075.5,-3830.56 5075.5,-3874.56"/>
<text text-anchor="middle" x="4937" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4937" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 336</text>
<text text-anchor="middle" x="4937" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4937" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_8&#45;&gt;expert_10_8_0 -->
<g id="edge1042" class="edge">
<title>route_10_8&#45;&gt;expert_10_8_0</title>
<path fill="none" stroke="black" d="M4977.66,-3910.7C4971.29,-3901.74 4964.32,-3891.94 4957.97,-3883.03"/>
<polygon fill="black" stroke="black" points="4960.77,-3880.92 4952.12,-3874.8 4955.06,-3884.98 4960.77,-3880.92"/>
</g>
<!-- expert_10_8_1 -->
<g id="node718" class="node">
<title>expert_10_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5370.5,-3874.56 5093.5,-3874.56 5093.5,-3830.56 5370.5,-3830.56 5370.5,-3874.56"/>
<text text-anchor="middle" x="5232" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5232" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 337</text>
<text text-anchor="middle" x="5232" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5232" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_8&#45;&gt;expert_10_8_1 -->
<g id="edge1043" class="edge">
<title>route_10_8&#45;&gt;expert_10_8_1</title>
<path fill="none" stroke="black" d="M5073.68,-3912.75C5103.34,-3901.66 5137.17,-3889.02 5165.92,-3878.27"/>
<polygon fill="black" stroke="black" points="5167.32,-3881.48 5175.46,-3874.7 5164.87,-3874.92 5167.32,-3881.48"/>
</g>
<!-- tp_10_8 -->
<g id="node719" class="node">
<title>tp_10_8</title>
<ellipse fill="lightblue" stroke="black" cx="4937" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4937" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4937" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 336↔337</text>
<text text-anchor="middle" x="4937" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4937" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_8_0&#45;&gt;tp_10_8 -->
<g id="edge1044" class="edge">
<title>expert_10_8_0&#45;&gt;tp_10_8</title>
<path fill="none" stroke="black" d="M4937,-3830.48C4937,-3822.8 4937,-3813.85 4937,-3805.06"/>
<polygon fill="black" stroke="black" points="4940.5,-3804.89 4937,-3794.89 4933.5,-3804.89 4940.5,-3804.89"/>
</g>
<!-- expert_10_8_1&#45;&gt;tp_10_8 -->
<g id="edge1045" class="edge">
<title>expert_10_8_1&#45;&gt;tp_10_8</title>
<path fill="none" stroke="black" d="M5160.59,-3830.48C5119.13,-3818.23 5066.64,-3802.73 5022.93,-3789.82"/>
<polygon fill="black" stroke="black" points="5023.75,-3786.42 5013.17,-3786.94 5021.77,-3793.13 5023.75,-3786.42"/>
</g>
<!-- tp_10_8&#45;&gt;agg_10 -->
<g id="edge1046" class="edge">
<title>tp_10_8&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M4898.5,-3734.07C4885.35,-3724.37 4870.24,-3713.23 4855.52,-3702.38"/>
<polygon fill="black" stroke="black" points="4857.53,-3699.51 4847.4,-3696.39 4853.37,-3705.15 4857.53,-3699.51"/>
</g>
<!-- expert_10_9_0 -->
<g id="node721" class="node">
<title>expert_10_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-3874.56 5388.5,-3874.56 5388.5,-3830.56 5665.5,-3830.56 5665.5,-3874.56"/>
<text text-anchor="middle" x="5527" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5527" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 338</text>
<text text-anchor="middle" x="5527" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5527" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_9&#45;&gt;expert_10_9_0 -->
<g id="edge1048" class="edge">
<title>route_10_9&#45;&gt;expert_10_9_0</title>
<path fill="none" stroke="black" d="M5527,-3910.21C5527,-3901.93 5527,-3892.95 5527,-3884.64"/>
<polygon fill="black" stroke="black" points="5530.5,-3884.57 5527,-3874.57 5523.5,-3884.57 5530.5,-3884.57"/>
</g>
<!-- expert_10_9_1 -->
<g id="node722" class="node">
<title>expert_10_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5960.5,-3874.56 5683.5,-3874.56 5683.5,-3830.56 5960.5,-3830.56 5960.5,-3874.56"/>
<text text-anchor="middle" x="5822" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5822" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 339</text>
<text text-anchor="middle" x="5822" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5822" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_9&#45;&gt;expert_10_9_1 -->
<g id="edge1049" class="edge">
<title>route_10_9&#45;&gt;expert_10_9_1</title>
<path fill="none" stroke="black" d="M5617.92,-3913.83C5657.08,-3902.26 5702.51,-3888.85 5740.56,-3877.61"/>
<polygon fill="black" stroke="black" points="5741.97,-3880.84 5750.57,-3874.66 5739.99,-3874.13 5741.97,-3880.84"/>
</g>
<!-- tp_10_9 -->
<g id="node723" class="node">
<title>tp_10_9</title>
<ellipse fill="lightblue" stroke="black" cx="5527" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5527" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5527" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 338↔339</text>
<text text-anchor="middle" x="5527" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5527" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_9_0&#45;&gt;tp_10_9 -->
<g id="edge1050" class="edge">
<title>expert_10_9_0&#45;&gt;tp_10_9</title>
<path fill="none" stroke="black" d="M5527,-3830.48C5527,-3822.8 5527,-3813.85 5527,-3805.06"/>
<polygon fill="black" stroke="black" points="5530.5,-3804.89 5527,-3794.89 5523.5,-3804.89 5530.5,-3804.89"/>
</g>
<!-- expert_10_9_1&#45;&gt;tp_10_9 -->
<g id="edge1051" class="edge">
<title>expert_10_9_1&#45;&gt;tp_10_9</title>
<path fill="none" stroke="black" d="M5750.59,-3830.48C5709.13,-3818.23 5656.64,-3802.73 5612.93,-3789.82"/>
<polygon fill="black" stroke="black" points="5613.75,-3786.42 5603.17,-3786.94 5611.77,-3793.13 5613.75,-3786.42"/>
</g>
<!-- tp_10_9&#45;&gt;agg_10 -->
<g id="edge1052" class="edge">
<title>tp_10_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M5426.7,-3747.62C5337.3,-3734.4 5201.93,-3714.39 5078.87,-3696.19"/>
<polygon fill="black" stroke="black" points="5079.31,-3692.72 5068.9,-3694.72 5078.28,-3699.65 5079.31,-3692.72"/>
</g>
<!-- expert_10_10_0 -->
<g id="node725" class="node">
<title>expert_10_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6255.5,-3874.56 5978.5,-3874.56 5978.5,-3830.56 6255.5,-3830.56 6255.5,-3874.56"/>
<text text-anchor="middle" x="6117" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6117" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 340</text>
<text text-anchor="middle" x="6117" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6117" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_10&#45;&gt;expert_10_10_0 -->
<g id="edge1054" class="edge">
<title>route_10_10&#45;&gt;expert_10_10_0</title>
<path fill="none" stroke="black" d="M6117,-3910.21C6117,-3901.93 6117,-3892.95 6117,-3884.64"/>
<polygon fill="black" stroke="black" points="6120.5,-3884.57 6117,-3874.57 6113.5,-3884.57 6120.5,-3884.57"/>
</g>
<!-- expert_10_10_1 -->
<g id="node726" class="node">
<title>expert_10_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6550.5,-3874.56 6273.5,-3874.56 6273.5,-3830.56 6550.5,-3830.56 6550.5,-3874.56"/>
<text text-anchor="middle" x="6412" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6412" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 341</text>
<text text-anchor="middle" x="6412" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6412" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_10&#45;&gt;expert_10_10_1 -->
<g id="edge1055" class="edge">
<title>route_10_10&#45;&gt;expert_10_10_1</title>
<path fill="none" stroke="black" d="M6207.92,-3913.83C6247.08,-3902.26 6292.51,-3888.85 6330.56,-3877.61"/>
<polygon fill="black" stroke="black" points="6331.97,-3880.84 6340.57,-3874.66 6329.99,-3874.13 6331.97,-3880.84"/>
</g>
<!-- tp_10_10 -->
<g id="node727" class="node">
<title>tp_10_10</title>
<ellipse fill="lightblue" stroke="black" cx="6117" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6117" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6117" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 340↔341</text>
<text text-anchor="middle" x="6117" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6117" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_10_0&#45;&gt;tp_10_10 -->
<g id="edge1056" class="edge">
<title>expert_10_10_0&#45;&gt;tp_10_10</title>
<path fill="none" stroke="black" d="M6117,-3830.48C6117,-3822.8 6117,-3813.85 6117,-3805.06"/>
<polygon fill="black" stroke="black" points="6120.5,-3804.89 6117,-3794.89 6113.5,-3804.89 6120.5,-3804.89"/>
</g>
<!-- expert_10_10_1&#45;&gt;tp_10_10 -->
<g id="edge1057" class="edge">
<title>expert_10_10_1&#45;&gt;tp_10_10</title>
<path fill="none" stroke="black" d="M6340.59,-3830.48C6299.13,-3818.23 6246.64,-3802.73 6202.93,-3789.82"/>
<polygon fill="black" stroke="black" points="6203.75,-3786.42 6193.17,-3786.94 6201.77,-3793.13 6203.75,-3786.42"/>
</g>
<!-- tp_10_10&#45;&gt;agg_10 -->
<g id="edge1058" class="edge">
<title>tp_10_10&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M6007.19,-3753.43C5799.46,-3736.36 5343.69,-3698.91 5052.33,-3674.97"/>
<polygon fill="black" stroke="black" points="5052.29,-3671.46 5042.03,-3674.13 5051.71,-3678.43 5052.29,-3671.46"/>
</g>
<!-- expert_10_11_0 -->
<g id="node729" class="node">
<title>expert_10_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6845.5,-3874.56 6568.5,-3874.56 6568.5,-3830.56 6845.5,-3830.56 6845.5,-3874.56"/>
<text text-anchor="middle" x="6707" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6707" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 342</text>
<text text-anchor="middle" x="6707" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6707" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_11&#45;&gt;expert_10_11_0 -->
<g id="edge1060" class="edge">
<title>route_10_11&#45;&gt;expert_10_11_0</title>
<path fill="none" stroke="black" d="M6707,-3910.21C6707,-3901.93 6707,-3892.95 6707,-3884.64"/>
<polygon fill="black" stroke="black" points="6710.5,-3884.57 6707,-3874.57 6703.5,-3884.57 6710.5,-3884.57"/>
</g>
<!-- expert_10_11_1 -->
<g id="node730" class="node">
<title>expert_10_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7140.5,-3874.56 6863.5,-3874.56 6863.5,-3830.56 7140.5,-3830.56 7140.5,-3874.56"/>
<text text-anchor="middle" x="7002" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7002" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 343</text>
<text text-anchor="middle" x="7002" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7002" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_11&#45;&gt;expert_10_11_1 -->
<g id="edge1061" class="edge">
<title>route_10_11&#45;&gt;expert_10_11_1</title>
<path fill="none" stroke="black" d="M6797.92,-3913.83C6837.08,-3902.26 6882.51,-3888.85 6920.56,-3877.61"/>
<polygon fill="black" stroke="black" points="6921.97,-3880.84 6930.57,-3874.66 6919.99,-3874.13 6921.97,-3880.84"/>
</g>
<!-- tp_10_11 -->
<g id="node731" class="node">
<title>tp_10_11</title>
<ellipse fill="lightblue" stroke="black" cx="6707" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6707" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6707" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 342↔343</text>
<text text-anchor="middle" x="6707" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6707" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_11_0&#45;&gt;tp_10_11 -->
<g id="edge1062" class="edge">
<title>expert_10_11_0&#45;&gt;tp_10_11</title>
<path fill="none" stroke="black" d="M6707,-3830.48C6707,-3822.8 6707,-3813.85 6707,-3805.06"/>
<polygon fill="black" stroke="black" points="6710.5,-3804.89 6707,-3794.89 6703.5,-3804.89 6710.5,-3804.89"/>
</g>
<!-- expert_10_11_1&#45;&gt;tp_10_11 -->
<g id="edge1063" class="edge">
<title>expert_10_11_1&#45;&gt;tp_10_11</title>
<path fill="none" stroke="black" d="M6930.59,-3830.48C6889.13,-3818.23 6836.64,-3802.73 6792.93,-3789.82"/>
<polygon fill="black" stroke="black" points="6793.75,-3786.42 6783.17,-3786.94 6791.77,-3793.13 6793.75,-3786.42"/>
</g>
<!-- tp_10_11&#45;&gt;agg_10 -->
<g id="edge1064" class="edge">
<title>tp_10_11&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M6595.21,-3754.88C6501.03,-3748.59 6362.73,-3739.53 6242,-3732.34 5820.96,-3707.26 5331.09,-3681.29 5041.26,-3666.26"/>
<polygon fill="black" stroke="black" points="5041.2,-3662.75 5031.03,-3665.73 5040.84,-3669.74 5041.2,-3662.75"/>
</g>
<!-- expert_10_12_0 -->
<g id="node733" class="node">
<title>expert_10_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7435.5,-3874.56 7158.5,-3874.56 7158.5,-3830.56 7435.5,-3830.56 7435.5,-3874.56"/>
<text text-anchor="middle" x="7297" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7297" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 344</text>
<text text-anchor="middle" x="7297" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7297" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_12&#45;&gt;expert_10_12_0 -->
<g id="edge1066" class="edge">
<title>route_10_12&#45;&gt;expert_10_12_0</title>
<path fill="none" stroke="black" d="M7297,-3910.21C7297,-3901.93 7297,-3892.95 7297,-3884.64"/>
<polygon fill="black" stroke="black" points="7300.5,-3884.57 7297,-3874.57 7293.5,-3884.57 7300.5,-3884.57"/>
</g>
<!-- expert_10_12_1 -->
<g id="node734" class="node">
<title>expert_10_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7730.5,-3874.56 7453.5,-3874.56 7453.5,-3830.56 7730.5,-3830.56 7730.5,-3874.56"/>
<text text-anchor="middle" x="7592" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7592" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 345</text>
<text text-anchor="middle" x="7592" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7592" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_12&#45;&gt;expert_10_12_1 -->
<g id="edge1067" class="edge">
<title>route_10_12&#45;&gt;expert_10_12_1</title>
<path fill="none" stroke="black" d="M7387.92,-3913.83C7427.08,-3902.26 7472.51,-3888.85 7510.56,-3877.61"/>
<polygon fill="black" stroke="black" points="7511.97,-3880.84 7520.57,-3874.66 7509.99,-3874.13 7511.97,-3880.84"/>
</g>
<!-- tp_10_12 -->
<g id="node735" class="node">
<title>tp_10_12</title>
<ellipse fill="lightblue" stroke="black" cx="7297" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7297" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7297" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 344↔345</text>
<text text-anchor="middle" x="7297" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7297" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_12_0&#45;&gt;tp_10_12 -->
<g id="edge1068" class="edge">
<title>expert_10_12_0&#45;&gt;tp_10_12</title>
<path fill="none" stroke="black" d="M7297,-3830.48C7297,-3822.8 7297,-3813.85 7297,-3805.06"/>
<polygon fill="black" stroke="black" points="7300.5,-3804.89 7297,-3794.89 7293.5,-3804.89 7300.5,-3804.89"/>
</g>
<!-- expert_10_12_1&#45;&gt;tp_10_12 -->
<g id="edge1069" class="edge">
<title>expert_10_12_1&#45;&gt;tp_10_12</title>
<path fill="none" stroke="black" d="M7520.59,-3830.48C7479.13,-3818.23 7426.64,-3802.73 7382.93,-3789.82"/>
<polygon fill="black" stroke="black" points="7383.75,-3786.42 7373.17,-3786.94 7381.77,-3793.13 7383.75,-3786.42"/>
</g>
<!-- tp_10_12&#45;&gt;agg_10 -->
<g id="edge1070" class="edge">
<title>tp_10_12&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M7185.71,-3754.43C7091.54,-3747.83 6952.98,-3738.59 6832,-3732.34 6183.3,-3698.8 5418.04,-3672.84 5034.37,-3660.76"/>
<polygon fill="black" stroke="black" points="5034.36,-3657.26 5024.26,-3660.44 5034.14,-3664.26 5034.36,-3657.26"/>
</g>
<!-- expert_10_13_0 -->
<g id="node737" class="node">
<title>expert_10_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8025.5,-3874.56 7748.5,-3874.56 7748.5,-3830.56 8025.5,-3830.56 8025.5,-3874.56"/>
<text text-anchor="middle" x="7887" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7887" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 346</text>
<text text-anchor="middle" x="7887" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7887" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_13&#45;&gt;expert_10_13_0 -->
<g id="edge1072" class="edge">
<title>route_10_13&#45;&gt;expert_10_13_0</title>
<path fill="none" stroke="black" d="M7887,-3910.21C7887,-3901.93 7887,-3892.95 7887,-3884.64"/>
<polygon fill="black" stroke="black" points="7890.5,-3884.57 7887,-3874.57 7883.5,-3884.57 7890.5,-3884.57"/>
</g>
<!-- expert_10_13_1 -->
<g id="node738" class="node">
<title>expert_10_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8320.5,-3874.56 8043.5,-3874.56 8043.5,-3830.56 8320.5,-3830.56 8320.5,-3874.56"/>
<text text-anchor="middle" x="8182" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8182" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 347</text>
<text text-anchor="middle" x="8182" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8182" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_13&#45;&gt;expert_10_13_1 -->
<g id="edge1073" class="edge">
<title>route_10_13&#45;&gt;expert_10_13_1</title>
<path fill="none" stroke="black" d="M7977.92,-3913.83C8017.08,-3902.26 8062.51,-3888.85 8100.56,-3877.61"/>
<polygon fill="black" stroke="black" points="8101.97,-3880.84 8110.57,-3874.66 8099.99,-3874.13 8101.97,-3880.84"/>
</g>
<!-- tp_10_13 -->
<g id="node739" class="node">
<title>tp_10_13</title>
<ellipse fill="lightblue" stroke="black" cx="7887" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7887" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7887" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 346↔347</text>
<text text-anchor="middle" x="7887" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7887" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_13_0&#45;&gt;tp_10_13 -->
<g id="edge1074" class="edge">
<title>expert_10_13_0&#45;&gt;tp_10_13</title>
<path fill="none" stroke="black" d="M7887,-3830.48C7887,-3822.8 7887,-3813.85 7887,-3805.06"/>
<polygon fill="black" stroke="black" points="7890.5,-3804.89 7887,-3794.89 7883.5,-3804.89 7890.5,-3804.89"/>
</g>
<!-- expert_10_13_1&#45;&gt;tp_10_13 -->
<g id="edge1075" class="edge">
<title>expert_10_13_1&#45;&gt;tp_10_13</title>
<path fill="none" stroke="black" d="M8110.59,-3830.48C8069.13,-3818.23 8016.64,-3802.73 7972.93,-3789.82"/>
<polygon fill="black" stroke="black" points="7973.75,-3786.42 7963.17,-3786.94 7971.77,-3793.13 7973.75,-3786.42"/>
</g>
<!-- tp_10_13&#45;&gt;agg_10 -->
<g id="edge1076" class="edge">
<title>tp_10_13&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M7776.2,-3754.19C7682.02,-3747.43 7543.21,-3738.08 7422,-3732.34 6541.43,-3690.63 5494.09,-3666.94 5030.4,-3657.78"/>
<polygon fill="black" stroke="black" points="5030.3,-3654.28 5020.24,-3657.58 5030.17,-3661.28 5030.3,-3654.28"/>
</g>
<!-- expert_10_14_0 -->
<g id="node741" class="node">
<title>expert_10_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8615.5,-3874.56 8338.5,-3874.56 8338.5,-3830.56 8615.5,-3830.56 8615.5,-3874.56"/>
<text text-anchor="middle" x="8477" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8477" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 348</text>
<text text-anchor="middle" x="8477" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8477" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_14&#45;&gt;expert_10_14_0 -->
<g id="edge1078" class="edge">
<title>route_10_14&#45;&gt;expert_10_14_0</title>
<path fill="none" stroke="black" d="M8477,-3910.21C8477,-3901.93 8477,-3892.95 8477,-3884.64"/>
<polygon fill="black" stroke="black" points="8480.5,-3884.57 8477,-3874.57 8473.5,-3884.57 8480.5,-3884.57"/>
</g>
<!-- expert_10_14_1 -->
<g id="node742" class="node">
<title>expert_10_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8910.5,-3874.56 8633.5,-3874.56 8633.5,-3830.56 8910.5,-3830.56 8910.5,-3874.56"/>
<text text-anchor="middle" x="8772" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8772" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 349</text>
<text text-anchor="middle" x="8772" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8772" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_14&#45;&gt;expert_10_14_1 -->
<g id="edge1079" class="edge">
<title>route_10_14&#45;&gt;expert_10_14_1</title>
<path fill="none" stroke="black" d="M8567.92,-3913.83C8607.08,-3902.26 8652.51,-3888.85 8690.56,-3877.61"/>
<polygon fill="black" stroke="black" points="8691.97,-3880.84 8700.57,-3874.66 8689.99,-3874.13 8691.97,-3880.84"/>
</g>
<!-- tp_10_14 -->
<g id="node743" class="node">
<title>tp_10_14</title>
<ellipse fill="lightblue" stroke="black" cx="8477" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8477" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8477" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 348↔349</text>
<text text-anchor="middle" x="8477" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8477" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_14_0&#45;&gt;tp_10_14 -->
<g id="edge1080" class="edge">
<title>expert_10_14_0&#45;&gt;tp_10_14</title>
<path fill="none" stroke="black" d="M8477,-3830.48C8477,-3822.8 8477,-3813.85 8477,-3805.06"/>
<polygon fill="black" stroke="black" points="8480.5,-3804.89 8477,-3794.89 8473.5,-3804.89 8480.5,-3804.89"/>
</g>
<!-- expert_10_14_1&#45;&gt;tp_10_14 -->
<g id="edge1081" class="edge">
<title>expert_10_14_1&#45;&gt;tp_10_14</title>
<path fill="none" stroke="black" d="M8700.59,-3830.48C8659.13,-3818.23 8606.64,-3802.73 8562.93,-3789.82"/>
<polygon fill="black" stroke="black" points="8563.75,-3786.42 8553.17,-3786.94 8561.77,-3793.13 8563.75,-3786.42"/>
</g>
<!-- tp_10_14&#45;&gt;agg_10 -->
<g id="edge1082" class="edge">
<title>tp_10_14&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M8366.2,-3754.02C8272.04,-3747.15 8133.23,-3737.75 8012,-3732.34 6896.96,-3682.59 5563.42,-3662.41 5028.36,-3655.92"/>
<polygon fill="black" stroke="black" points="5028.25,-3652.42 5018.21,-3655.8 5028.16,-3659.42 5028.25,-3652.42"/>
</g>
<!-- expert_10_15_0 -->
<g id="node745" class="node">
<title>expert_10_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9205.5,-3874.56 8928.5,-3874.56 8928.5,-3830.56 9205.5,-3830.56 9205.5,-3874.56"/>
<text text-anchor="middle" x="9067" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9067" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 350</text>
<text text-anchor="middle" x="9067" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9067" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_15&#45;&gt;expert_10_15_0 -->
<g id="edge1084" class="edge">
<title>route_10_15&#45;&gt;expert_10_15_0</title>
<path fill="none" stroke="black" d="M9067,-3910.21C9067,-3901.93 9067,-3892.95 9067,-3884.64"/>
<polygon fill="black" stroke="black" points="9070.5,-3884.57 9067,-3874.57 9063.5,-3884.57 9070.5,-3884.57"/>
</g>
<!-- expert_10_15_1 -->
<g id="node746" class="node">
<title>expert_10_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9500.5,-3874.56 9223.5,-3874.56 9223.5,-3830.56 9500.5,-3830.56 9500.5,-3874.56"/>
<text text-anchor="middle" x="9362" y="-3865.36" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9362" y="-3855.36" font-family="Times,serif" font-size="9.00">GPU: 351</text>
<text text-anchor="middle" x="9362" y="-3845.36" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9362" y="-3835.36" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_10_15&#45;&gt;expert_10_15_1 -->
<g id="edge1085" class="edge">
<title>route_10_15&#45;&gt;expert_10_15_1</title>
<path fill="none" stroke="black" d="M9157.92,-3913.83C9197.08,-3902.26 9242.51,-3888.85 9280.56,-3877.61"/>
<polygon fill="black" stroke="black" points="9281.97,-3880.84 9290.57,-3874.66 9279.99,-3874.13 9281.97,-3880.84"/>
</g>
<!-- tp_10_15 -->
<g id="node747" class="node">
<title>tp_10_15</title>
<ellipse fill="lightblue" stroke="black" cx="9067" cy="-3763.45" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9067" y="-3776.25" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9067" y="-3766.25" font-family="Times,serif" font-size="9.00">GPU: 350↔351</text>
<text text-anchor="middle" x="9067" y="-3756.25" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9067" y="-3746.25" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_10_15_0&#45;&gt;tp_10_15 -->
<g id="edge1086" class="edge">
<title>expert_10_15_0&#45;&gt;tp_10_15</title>
<path fill="none" stroke="black" d="M9067,-3830.48C9067,-3822.8 9067,-3813.85 9067,-3805.06"/>
<polygon fill="black" stroke="black" points="9070.5,-3804.89 9067,-3794.89 9063.5,-3804.89 9070.5,-3804.89"/>
</g>
<!-- expert_10_15_1&#45;&gt;tp_10_15 -->
<g id="edge1087" class="edge">
<title>expert_10_15_1&#45;&gt;tp_10_15</title>
<path fill="none" stroke="black" d="M9290.59,-3830.48C9249.13,-3818.23 9196.64,-3802.73 9152.93,-3789.82"/>
<polygon fill="black" stroke="black" points="9153.75,-3786.42 9143.17,-3786.94 9151.77,-3793.13 9153.75,-3786.42"/>
</g>
<!-- tp_10_15&#45;&gt;agg_10 -->
<g id="edge1088" class="edge">
<title>tp_10_15&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M8956.21,-3753.9C8862.04,-3746.96 8723.24,-3737.52 8602,-3732.34 7249.8,-3674.57 5625.99,-3658.69 5026.41,-3654.63"/>
<polygon fill="black" stroke="black" points="5026.38,-3651.13 5016.35,-3654.56 5026.33,-3658.13 5026.38,-3651.13"/>
</g>
<!-- output_10 -->
<g id="node749" class="node">
<title>output_10</title>
<polygon fill="lightgreen" stroke="black" points="4937,-3572.34 4641,-3572.34 4641,-3528.34 4937,-3528.34 4937,-3572.34"/>
<text text-anchor="middle" x="4789" y="-3563.14" font-family="Times,serif" font-size="9.00">Layer 10 Output</text>
<text text-anchor="middle" x="4789" y="-3553.14" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4789" y="-3543.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4789" y="-3533.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_10&#45;&gt;output_10 -->
<g id="edge1089" class="edge">
<title>agg_10&#45;&gt;output_10</title>
<path fill="none" stroke="black" d="M4789,-3608.06C4789,-3599.47 4789,-3590.61 4789,-3582.52"/>
<polygon fill="black" stroke="black" points="4792.5,-3582.42 4789,-3572.42 4785.5,-3582.42 4792.5,-3582.42"/>
</g>
<!-- mha_11 -->
<g id="node750" class="node">
<title>mha_11</title>
<polygon fill="lightgreen" stroke="black" points="4937,-3492.34 4641,-3492.34 4641,-3448.34 4937,-3448.34 4937,-3492.34"/>
<text text-anchor="middle" x="4789" y="-3483.14" font-family="Times,serif" font-size="9.00">MHA L11</text>
<text text-anchor="middle" x="4789" y="-3473.14" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4789" y="-3463.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4789" y="-3453.14" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_10&#45;&gt;mha_11 -->
<g id="edge1090" class="edge">
<title>output_10&#45;&gt;mha_11</title>
<path fill="none" stroke="black" d="M4789,-3528.02C4789,-3520.13 4789,-3511.02 4789,-3502.44"/>
<polygon fill="black" stroke="black" points="4792.5,-3502.36 4789,-3492.36 4785.5,-3502.36 4792.5,-3502.36"/>
</g>
<!-- gate_11 -->
<g id="node751" class="node">
<title>gate_11</title>
<polygon fill="lightyellow" stroke="black" points="5088.74,-3412.34 4611.92,-3412.34 4489.26,-3324.34 4966.08,-3324.34 5088.74,-3412.34"/>
<text text-anchor="middle" x="4789" y="-3381.14" font-family="Times,serif" font-size="9.00">Gate L11</text>
<text text-anchor="middle" x="4789" y="-3371.14" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4789" y="-3361.14" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4789" y="-3351.14" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_11&#45;&gt;gate_11 -->
<g id="edge1091" class="edge">
<title>mha_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M4789,-3448.13C4789,-3440.63 4789,-3431.82 4789,-3422.86"/>
<polygon fill="black" stroke="black" points="4792.5,-3422.74 4789,-3412.74 4785.5,-3422.74 4792.5,-3422.74"/>
</g>
<!-- route_11_0 -->
<g id="node752" class="node">
<title>route_11_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="512" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="512" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="512" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 352,353</text>
<text text-anchor="middle" x="512" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="512" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_0 -->
<g id="edge1092" class="edge">
<title>gate_11&#45;&gt;route_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4549.09,-3367.38C3938.43,-3366.42 2275.63,-3357.12 892,-3288.34 826.75,-3285.09 755.32,-3279.87 692.17,-3274.68"/>
<polygon fill="black" stroke="black" points="692.36,-3271.19 682.11,-3273.85 691.79,-3278.16 692.36,-3271.19"/>
</g>
<!-- route_11_1 -->
<g id="node756" class="node">
<title>route_11_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1102" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1102" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1102" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 354,355</text>
<text text-anchor="middle" x="1102" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1102" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_1 -->
<g id="edge1098" class="edge">
<title>gate_11&#45;&gt;route_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4547.4,-3366.13C4000.99,-3362.4 2628.53,-3347.41 1482,-3288.34 1416.91,-3284.98 1345.67,-3279.75 1282.63,-3274.59"/>
<polygon fill="black" stroke="black" points="1282.84,-3271.09 1272.59,-3273.76 1282.27,-3278.07 1282.84,-3271.09"/>
</g>
<!-- route_11_2 -->
<g id="node760" class="node">
<title>route_11_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1692" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1692" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1692" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 356,357</text>
<text text-anchor="middle" x="1692" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1692" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_2 -->
<g id="edge1104" class="edge">
<title>gate_11&#45;&gt;route_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4544.82,-3364.33C4068.8,-3357.56 2983.5,-3337.67 2072,-3288.34 2007.08,-3284.82 1936.02,-3279.57 1873.1,-3274.43"/>
<polygon fill="black" stroke="black" points="1873.32,-3270.94 1863.07,-3273.61 1872.75,-3277.92 1873.32,-3270.94"/>
</g>
<!-- route_11_3 -->
<g id="node764" class="node">
<title>route_11_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2282" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2282" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2282" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 358,359</text>
<text text-anchor="middle" x="2282" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2282" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_3 -->
<g id="edge1110" class="edge">
<title>gate_11&#45;&gt;route_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4540.78,-3361.5C4143.71,-3351.39 3341.24,-3327.85 2662,-3288.34 2597.41,-3284.58 2526.73,-3279.3 2464.03,-3274.21"/>
<polygon fill="black" stroke="black" points="2464.29,-3270.72 2454.04,-3273.39 2463.72,-3277.7 2464.29,-3270.72"/>
</g>
<!-- route_11_4 -->
<g id="node768" class="node">
<title>route_11_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2872" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2872" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2872" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 360,361</text>
<text text-anchor="middle" x="2872" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2872" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_4 -->
<g id="edge1116" class="edge">
<title>gate_11&#45;&gt;route_11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4533.91,-3356.39C4228.88,-3342.8 3702.93,-3317.79 3252,-3288.34 3188.04,-3284.16 3118.08,-3278.83 3055.82,-3273.82"/>
<polygon fill="black" stroke="black" points="3055.74,-3270.31 3045.49,-3272.99 3055.18,-3277.28 3055.74,-3270.31"/>
</g>
<!-- route_11_5 -->
<g id="node772" class="node">
<title>route_11_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3462" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3462" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 362,363</text>
<text text-anchor="middle" x="3462" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3462" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_5 -->
<g id="edge1122" class="edge">
<title>gate_11&#45;&gt;route_11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4518.06,-3345.06C4258.32,-3323.7 3873.23,-3292.04 3646.92,-3273.43"/>
<polygon fill="black" stroke="black" points="3647.18,-3269.94 3636.93,-3272.61 3646.61,-3276.92 3647.18,-3269.94"/>
</g>
<!-- route_11_6 -->
<g id="node776" class="node">
<title>route_11_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4052" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4052" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4052" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 364,365</text>
<text text-anchor="middle" x="4052" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4052" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_6 -->
<g id="edge1128" class="edge">
<title>gate_11&#45;&gt;route_11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4498.51,-3324.33C4397.8,-3309.42 4288.94,-3293.3 4203.92,-3280.72"/>
<polygon fill="black" stroke="black" points="4204.34,-3277.24 4193.93,-3279.24 4203.31,-3284.16 4204.34,-3277.24"/>
</g>
<!-- route_11_7 -->
<g id="node780" class="node">
<title>route_11_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4580" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4580" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4580" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 366,367</text>
<text text-anchor="middle" x="4580" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4580" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_7 -->
<g id="edge1134" class="edge">
<title>gate_11&#45;&gt;route_11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4706.4,-3324.21C4685.91,-3313.52 4664.25,-3302.21 4644.75,-3292.03"/>
<polygon fill="black" stroke="black" points="4646.15,-3288.81 4635.67,-3287.29 4642.91,-3295.02 4646.15,-3288.81"/>
</g>
<!-- route_11_8 -->
<g id="node784" class="node">
<title>route_11_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5000" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5000" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5000" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 368,369</text>
<text text-anchor="middle" x="5000" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5000" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_8 -->
<g id="edge1140" class="edge">
<title>gate_11&#45;&gt;route_11_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4872.39,-3324.21C4893.27,-3313.42 4915.36,-3302 4935.18,-3291.74"/>
<polygon fill="black" stroke="black" points="4936.84,-3294.82 4944.12,-3287.12 4933.63,-3288.61 4936.84,-3294.82"/>
</g>
<!-- route_11_9 -->
<g id="node788" class="node">
<title>route_11_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5527" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5527" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5527" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 370,371</text>
<text text-anchor="middle" x="5527" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5527" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_9 -->
<g id="edge1146" class="edge">
<title>gate_11&#45;&gt;route_11_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4985.8,-3338.24C5107.76,-3320.21 5262.08,-3297.39 5374.69,-3280.74"/>
<polygon fill="black" stroke="black" points="5375.39,-3284.18 5384.77,-3279.25 5374.37,-3277.25 5375.39,-3284.18"/>
</g>
<!-- route_11_10 -->
<g id="node792" class="node">
<title>route_11_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6117" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6117" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6117" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 372,373</text>
<text text-anchor="middle" x="6117" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6117" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_10 -->
<g id="edge1152" class="edge">
<title>gate_11&#45;&gt;route_11_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5002,-3349.84C5259.37,-3328.69 5688.14,-3293.46 5932.18,-3273.41"/>
<polygon fill="black" stroke="black" points="5932.54,-3276.89 5942.22,-3272.59 5931.96,-3269.92 5932.54,-3276.89"/>
</g>
<!-- route_11_11 -->
<g id="node796" class="node">
<title>route_11_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6707" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6707" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6707" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 374,375</text>
<text text-anchor="middle" x="6707" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6707" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_11 -->
<g id="edge1158" class="edge">
<title>gate_11&#45;&gt;route_11_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5012.94,-3357.79C5312.44,-3344.56 5859.94,-3318.83 6327,-3288.34 6390.96,-3284.16 6460.92,-3278.83 6523.18,-3273.83"/>
<polygon fill="black" stroke="black" points="6523.82,-3277.29 6533.51,-3272.99 6523.26,-3270.31 6523.82,-3277.29"/>
</g>
<!-- route_11_12 -->
<g id="node800" class="node">
<title>route_11_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7297" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7297" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7297" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 376,377</text>
<text text-anchor="middle" x="7297" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7297" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_12 -->
<g id="edge1164" class="edge">
<title>gate_11&#45;&gt;route_11_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5018.64,-3361.97C5408.94,-3352.14 6226.6,-3328.49 6917,-3288.34 6981.59,-3284.58 7052.27,-3279.3 7114.97,-3274.21"/>
<polygon fill="black" stroke="black" points="7115.28,-3277.7 7124.96,-3273.39 7114.71,-3270.72 7115.28,-3277.7"/>
</g>
<!-- route_11_13 -->
<g id="node804" class="node">
<title>route_11_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7887" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7887" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7887" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 378,379</text>
<text text-anchor="middle" x="7887" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7887" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_13 -->
<g id="edge1170" class="edge">
<title>gate_11&#45;&gt;route_11_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5022.3,-3364.49C5492.62,-3357.87 6588.09,-3338.07 7507,-3288.34 7571.92,-3284.82 7642.98,-3279.57 7705.9,-3274.43"/>
<polygon fill="black" stroke="black" points="7706.25,-3277.92 7715.93,-3273.61 7705.68,-3270.94 7706.25,-3277.92"/>
</g>
<!-- route_11_14 -->
<g id="node808" class="node">
<title>route_11_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8477" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8477" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8477" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 380,381</text>
<text text-anchor="middle" x="8477" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8477" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_14 -->
<g id="edge1176" class="edge">
<title>gate_11&#45;&gt;route_11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5024.56,-3366.17C5566.95,-3362.52 6945.82,-3347.65 8097,-3288.34 8162.09,-3284.98 8233.33,-3279.75 8296.37,-3274.59"/>
<polygon fill="black" stroke="black" points="8296.73,-3278.07 8306.41,-3273.76 8296.16,-3271.09 8296.73,-3278.07"/>
</g>
<!-- route_11_15 -->
<g id="node812" class="node">
<title>route_11_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9067" cy="-3257.22" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9067" y="-3270.02" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9067" y="-3260.02" font-family="Times,serif" font-size="9.00">GPU: 382,383</text>
<text text-anchor="middle" x="9067" y="-3250.02" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9067" y="-3240.02" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_11&#45;&gt;route_11_15 -->
<g id="edge1182" class="edge">
<title>gate_11&#45;&gt;route_11_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5026.19,-3367.38C5634.71,-3366.45 7300.91,-3357.24 8687,-3288.34 8752.25,-3285.09 8823.68,-3279.87 8886.83,-3274.68"/>
<polygon fill="black" stroke="black" points="8887.21,-3278.16 8896.89,-3273.85 8886.64,-3271.19 8887.21,-3278.16"/>
</g>
<!-- expert_11_0_0 -->
<g id="node753" class="node">
<title>expert_11_0_0</title>
<polygon fill="lightgreen" stroke="black" points="355.5,-3190.11 78.5,-3190.11 78.5,-3146.11 355.5,-3146.11 355.5,-3190.11"/>
<text text-anchor="middle" x="217" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="217" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 352</text>
<text text-anchor="middle" x="217" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="217" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_0&#45;&gt;expert_11_0_0 -->
<g id="edge1093" class="edge">
<title>route_11_0&#45;&gt;expert_11_0_0</title>
<path fill="none" stroke="black" d="M421.08,-3229.38C381.92,-3217.81 336.49,-3204.4 298.44,-3193.16"/>
<polygon fill="black" stroke="black" points="299.01,-3189.68 288.43,-3190.2 297.03,-3196.39 299.01,-3189.68"/>
</g>
<!-- expert_11_0_1 -->
<g id="node754" class="node">
<title>expert_11_0_1</title>
<polygon fill="lightgreen" stroke="black" points="650.5,-3190.11 373.5,-3190.11 373.5,-3146.11 650.5,-3146.11 650.5,-3190.11"/>
<text text-anchor="middle" x="512" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="512" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 353</text>
<text text-anchor="middle" x="512" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="512" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_0&#45;&gt;expert_11_0_1 -->
<g id="edge1094" class="edge">
<title>route_11_0&#45;&gt;expert_11_0_1</title>
<path fill="none" stroke="black" d="M512,-3225.76C512,-3217.48 512,-3208.5 512,-3200.19"/>
<polygon fill="black" stroke="black" points="515.5,-3200.12 512,-3190.12 508.5,-3200.12 515.5,-3200.12"/>
</g>
<!-- tp_11_0 -->
<g id="node755" class="node">
<title>tp_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="512" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="512" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="512" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 352↔353</text>
<text text-anchor="middle" x="512" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="512" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_0_0&#45;&gt;tp_11_0 -->
<g id="edge1095" class="edge">
<title>expert_11_0_0&#45;&gt;tp_11_0</title>
<path fill="none" stroke="black" d="M288.41,-3146.02C329.87,-3133.78 382.36,-3118.28 426.07,-3105.37"/>
<polygon fill="black" stroke="black" points="427.23,-3108.68 435.83,-3102.49 425.25,-3101.97 427.23,-3108.68"/>
</g>
<!-- expert_11_0_1&#45;&gt;tp_11_0 -->
<g id="edge1096" class="edge">
<title>expert_11_0_1&#45;&gt;tp_11_0</title>
<path fill="none" stroke="black" d="M512,-3146.02C512,-3138.35 512,-3129.4 512,-3120.61"/>
<polygon fill="black" stroke="black" points="515.5,-3120.44 512,-3110.44 508.5,-3120.44 515.5,-3120.44"/>
</g>
<!-- agg_11 -->
<g id="node816" class="node">
<title>agg_11</title>
<polygon fill="lightyellow" stroke="black" points="4959.99,-3011.89 4511.4,-3011.89 4396.01,-2923.89 4844.6,-2923.89 4959.99,-3011.89"/>
<text text-anchor="middle" x="4678" y="-2980.69" font-family="Times,serif" font-size="9.00">Aggregate Experts L11</text>
<text text-anchor="middle" x="4678" y="-2970.69" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4678" y="-2960.69" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4678" y="-2950.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_11_0&#45;&gt;agg_11 -->
<g id="edge1097" class="edge">
<title>tp_11_0&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M622.79,-3069.47C716.96,-3062.55 855.76,-3053.1 977,-3047.89 2288.76,-2991.44 3863.86,-2974.77 4446.6,-2970.34"/>
<polygon fill="black" stroke="black" points="4446.83,-2973.84 4456.8,-2970.27 4446.77,-2966.84 4446.83,-2973.84"/>
</g>
<!-- expert_11_1_0 -->
<g id="node757" class="node">
<title>expert_11_1_0</title>
<polygon fill="lightgreen" stroke="black" points="945.5,-3190.11 668.5,-3190.11 668.5,-3146.11 945.5,-3146.11 945.5,-3190.11"/>
<text text-anchor="middle" x="807" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="807" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 354</text>
<text text-anchor="middle" x="807" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="807" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_1&#45;&gt;expert_11_1_0 -->
<g id="edge1099" class="edge">
<title>route_11_1&#45;&gt;expert_11_1_0</title>
<path fill="none" stroke="black" d="M1011.08,-3229.38C971.92,-3217.81 926.49,-3204.4 888.44,-3193.16"/>
<polygon fill="black" stroke="black" points="889.01,-3189.68 878.43,-3190.2 887.03,-3196.39 889.01,-3189.68"/>
</g>
<!-- expert_11_1_1 -->
<g id="node758" class="node">
<title>expert_11_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1240.5,-3190.11 963.5,-3190.11 963.5,-3146.11 1240.5,-3146.11 1240.5,-3190.11"/>
<text text-anchor="middle" x="1102" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1102" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 355</text>
<text text-anchor="middle" x="1102" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1102" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_1&#45;&gt;expert_11_1_1 -->
<g id="edge1100" class="edge">
<title>route_11_1&#45;&gt;expert_11_1_1</title>
<path fill="none" stroke="black" d="M1102,-3225.76C1102,-3217.48 1102,-3208.5 1102,-3200.19"/>
<polygon fill="black" stroke="black" points="1105.5,-3200.12 1102,-3190.12 1098.5,-3200.12 1105.5,-3200.12"/>
</g>
<!-- tp_11_1 -->
<g id="node759" class="node">
<title>tp_11_1</title>
<ellipse fill="lightblue" stroke="black" cx="1102" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1102" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1102" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 354↔355</text>
<text text-anchor="middle" x="1102" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1102" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_1_0&#45;&gt;tp_11_1 -->
<g id="edge1101" class="edge">
<title>expert_11_1_0&#45;&gt;tp_11_1</title>
<path fill="none" stroke="black" d="M878.41,-3146.02C919.87,-3133.78 972.36,-3118.28 1016.07,-3105.37"/>
<polygon fill="black" stroke="black" points="1017.23,-3108.68 1025.83,-3102.49 1015.25,-3101.97 1017.23,-3108.68"/>
</g>
<!-- expert_11_1_1&#45;&gt;tp_11_1 -->
<g id="edge1102" class="edge">
<title>expert_11_1_1&#45;&gt;tp_11_1</title>
<path fill="none" stroke="black" d="M1102,-3146.02C1102,-3138.35 1102,-3129.4 1102,-3120.61"/>
<polygon fill="black" stroke="black" points="1105.5,-3120.44 1102,-3110.44 1098.5,-3120.44 1105.5,-3120.44"/>
</g>
<!-- tp_11_1&#45;&gt;agg_11 -->
<g id="edge1103" class="edge">
<title>tp_11_1&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1212.8,-3069.6C1306.97,-3062.75 1445.78,-3053.35 1567,-3047.89 2644.04,-2999.36 3932.27,-2978.48 4448.02,-2971.64"/>
<polygon fill="black" stroke="black" points="4448.23,-2975.13 4458.19,-2971.5 4448.14,-2968.14 4448.23,-2975.13"/>
</g>
<!-- expert_11_2_0 -->
<g id="node761" class="node">
<title>expert_11_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1535.5,-3190.11 1258.5,-3190.11 1258.5,-3146.11 1535.5,-3146.11 1535.5,-3190.11"/>
<text text-anchor="middle" x="1397" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1397" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 356</text>
<text text-anchor="middle" x="1397" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1397" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_2&#45;&gt;expert_11_2_0 -->
<g id="edge1105" class="edge">
<title>route_11_2&#45;&gt;expert_11_2_0</title>
<path fill="none" stroke="black" d="M1601.08,-3229.38C1561.92,-3217.81 1516.49,-3204.4 1478.44,-3193.16"/>
<polygon fill="black" stroke="black" points="1479.01,-3189.68 1468.43,-3190.2 1477.03,-3196.39 1479.01,-3189.68"/>
</g>
<!-- expert_11_2_1 -->
<g id="node762" class="node">
<title>expert_11_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1830.5,-3190.11 1553.5,-3190.11 1553.5,-3146.11 1830.5,-3146.11 1830.5,-3190.11"/>
<text text-anchor="middle" x="1692" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1692" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 357</text>
<text text-anchor="middle" x="1692" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1692" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_2&#45;&gt;expert_11_2_1 -->
<g id="edge1106" class="edge">
<title>route_11_2&#45;&gt;expert_11_2_1</title>
<path fill="none" stroke="black" d="M1692,-3225.76C1692,-3217.48 1692,-3208.5 1692,-3200.19"/>
<polygon fill="black" stroke="black" points="1695.5,-3200.12 1692,-3190.12 1688.5,-3200.12 1695.5,-3200.12"/>
</g>
<!-- tp_11_2 -->
<g id="node763" class="node">
<title>tp_11_2</title>
<ellipse fill="lightblue" stroke="black" cx="1692" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1692" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1692" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 356↔357</text>
<text text-anchor="middle" x="1692" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1692" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_2_0&#45;&gt;tp_11_2 -->
<g id="edge1107" class="edge">
<title>expert_11_2_0&#45;&gt;tp_11_2</title>
<path fill="none" stroke="black" d="M1468.41,-3146.02C1509.87,-3133.78 1562.36,-3118.28 1606.07,-3105.37"/>
<polygon fill="black" stroke="black" points="1607.23,-3108.68 1615.83,-3102.49 1605.25,-3101.97 1607.23,-3108.68"/>
</g>
<!-- expert_11_2_1&#45;&gt;tp_11_2 -->
<g id="edge1108" class="edge">
<title>expert_11_2_1&#45;&gt;tp_11_2</title>
<path fill="none" stroke="black" d="M1692,-3146.02C1692,-3138.35 1692,-3129.4 1692,-3120.61"/>
<polygon fill="black" stroke="black" points="1695.5,-3120.44 1692,-3110.44 1688.5,-3120.44 1695.5,-3120.44"/>
</g>
<!-- tp_11_2&#45;&gt;agg_11 -->
<g id="edge1109" class="edge">
<title>tp_11_2&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1802.81,-3069.78C1896.98,-3063.05 2035.79,-3053.71 2157,-3047.89 3002.36,-3007.28 4008.23,-2982.96 4450.38,-2973.48"/>
<polygon fill="black" stroke="black" points="4450.48,-2976.98 4460.4,-2973.26 4450.33,-2969.98 4450.48,-2976.98"/>
</g>
<!-- expert_11_3_0 -->
<g id="node765" class="node">
<title>expert_11_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2125.5,-3190.11 1848.5,-3190.11 1848.5,-3146.11 2125.5,-3146.11 2125.5,-3190.11"/>
<text text-anchor="middle" x="1987" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1987" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 358</text>
<text text-anchor="middle" x="1987" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1987" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_3&#45;&gt;expert_11_3_0 -->
<g id="edge1111" class="edge">
<title>route_11_3&#45;&gt;expert_11_3_0</title>
<path fill="none" stroke="black" d="M2191.08,-3229.38C2151.92,-3217.81 2106.49,-3204.4 2068.44,-3193.16"/>
<polygon fill="black" stroke="black" points="2069.01,-3189.68 2058.43,-3190.2 2067.03,-3196.39 2069.01,-3189.68"/>
</g>
<!-- expert_11_3_1 -->
<g id="node766" class="node">
<title>expert_11_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2420.5,-3190.11 2143.5,-3190.11 2143.5,-3146.11 2420.5,-3146.11 2420.5,-3190.11"/>
<text text-anchor="middle" x="2282" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2282" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 359</text>
<text text-anchor="middle" x="2282" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2282" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_3&#45;&gt;expert_11_3_1 -->
<g id="edge1112" class="edge">
<title>route_11_3&#45;&gt;expert_11_3_1</title>
<path fill="none" stroke="black" d="M2282,-3225.76C2282,-3217.48 2282,-3208.5 2282,-3200.19"/>
<polygon fill="black" stroke="black" points="2285.5,-3200.12 2282,-3190.12 2278.5,-3200.12 2285.5,-3200.12"/>
</g>
<!-- tp_11_3 -->
<g id="node767" class="node">
<title>tp_11_3</title>
<ellipse fill="lightblue" stroke="black" cx="2282" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2282" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2282" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 358↔359</text>
<text text-anchor="middle" x="2282" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2282" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_3_0&#45;&gt;tp_11_3 -->
<g id="edge1113" class="edge">
<title>expert_11_3_0&#45;&gt;tp_11_3</title>
<path fill="none" stroke="black" d="M2058.41,-3146.02C2099.87,-3133.78 2152.36,-3118.28 2196.07,-3105.37"/>
<polygon fill="black" stroke="black" points="2197.23,-3108.68 2205.83,-3102.49 2195.25,-3101.97 2197.23,-3108.68"/>
</g>
<!-- expert_11_3_1&#45;&gt;tp_11_3 -->
<g id="edge1114" class="edge">
<title>expert_11_3_1&#45;&gt;tp_11_3</title>
<path fill="none" stroke="black" d="M2282,-3146.02C2282,-3138.35 2282,-3129.4 2282,-3120.61"/>
<polygon fill="black" stroke="black" points="2285.5,-3120.44 2282,-3110.44 2278.5,-3120.44 2285.5,-3120.44"/>
</g>
<!-- tp_11_3&#45;&gt;agg_11 -->
<g id="edge1115" class="edge">
<title>tp_11_3&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2393.29,-3070.05C2487.47,-3063.5 2626.02,-3054.28 2747,-3047.89 3364.63,-3015.26 4094,-2988.66 4453.96,-2976.32"/>
<polygon fill="black" stroke="black" points="4454.1,-2979.82 4463.97,-2975.98 4453.86,-2972.82 4454.1,-2979.82"/>
</g>
<!-- expert_11_4_0 -->
<g id="node769" class="node">
<title>expert_11_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2715.5,-3190.11 2438.5,-3190.11 2438.5,-3146.11 2715.5,-3146.11 2715.5,-3190.11"/>
<text text-anchor="middle" x="2577" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2577" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 360</text>
<text text-anchor="middle" x="2577" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2577" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_4&#45;&gt;expert_11_4_0 -->
<g id="edge1117" class="edge">
<title>route_11_4&#45;&gt;expert_11_4_0</title>
<path fill="none" stroke="black" d="M2781.08,-3229.38C2741.92,-3217.81 2696.49,-3204.4 2658.44,-3193.16"/>
<polygon fill="black" stroke="black" points="2659.01,-3189.68 2648.43,-3190.2 2657.03,-3196.39 2659.01,-3189.68"/>
</g>
<!-- expert_11_4_1 -->
<g id="node770" class="node">
<title>expert_11_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3010.5,-3190.11 2733.5,-3190.11 2733.5,-3146.11 3010.5,-3146.11 3010.5,-3190.11"/>
<text text-anchor="middle" x="2872" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2872" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 361</text>
<text text-anchor="middle" x="2872" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2872" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_4&#45;&gt;expert_11_4_1 -->
<g id="edge1118" class="edge">
<title>route_11_4&#45;&gt;expert_11_4_1</title>
<path fill="none" stroke="black" d="M2872,-3225.76C2872,-3217.48 2872,-3208.5 2872,-3200.19"/>
<polygon fill="black" stroke="black" points="2875.5,-3200.12 2872,-3190.12 2868.5,-3200.12 2875.5,-3200.12"/>
</g>
<!-- tp_11_4 -->
<g id="node771" class="node">
<title>tp_11_4</title>
<ellipse fill="lightblue" stroke="black" cx="2872" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2872" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2872" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 360↔361</text>
<text text-anchor="middle" x="2872" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2872" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_4_0&#45;&gt;tp_11_4 -->
<g id="edge1119" class="edge">
<title>expert_11_4_0&#45;&gt;tp_11_4</title>
<path fill="none" stroke="black" d="M2648.41,-3146.02C2689.87,-3133.78 2742.36,-3118.28 2786.07,-3105.37"/>
<polygon fill="black" stroke="black" points="2787.23,-3108.68 2795.83,-3102.49 2785.25,-3101.97 2787.23,-3108.68"/>
</g>
<!-- expert_11_4_1&#45;&gt;tp_11_4 -->
<g id="edge1120" class="edge">
<title>expert_11_4_1&#45;&gt;tp_11_4</title>
<path fill="none" stroke="black" d="M2872,-3146.02C2872,-3138.35 2872,-3129.4 2872,-3120.61"/>
<polygon fill="black" stroke="black" points="2875.5,-3120.44 2872,-3110.44 2868.5,-3120.44 2875.5,-3120.44"/>
</g>
<!-- tp_11_4&#45;&gt;agg_11 -->
<g id="edge1121" class="edge">
<title>tp_11_4&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M2983.8,-3070.58C3077.98,-3064.37 3216.29,-3055.35 3337,-3047.89 3733,-3023.4 4194.9,-2996.57 4460.23,-2981.33"/>
<polygon fill="black" stroke="black" points="4460.58,-2984.81 4470.36,-2980.74 4460.18,-2977.82 4460.58,-2984.81"/>
</g>
<!-- expert_11_5_0 -->
<g id="node773" class="node">
<title>expert_11_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3305.5,-3190.11 3028.5,-3190.11 3028.5,-3146.11 3305.5,-3146.11 3305.5,-3190.11"/>
<text text-anchor="middle" x="3167" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3167" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 362</text>
<text text-anchor="middle" x="3167" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3167" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_5&#45;&gt;expert_11_5_0 -->
<g id="edge1123" class="edge">
<title>route_11_5&#45;&gt;expert_11_5_0</title>
<path fill="none" stroke="black" d="M3371.08,-3229.38C3331.92,-3217.81 3286.49,-3204.4 3248.44,-3193.16"/>
<polygon fill="black" stroke="black" points="3249.01,-3189.68 3238.43,-3190.2 3247.03,-3196.39 3249.01,-3189.68"/>
</g>
<!-- expert_11_5_1 -->
<g id="node774" class="node">
<title>expert_11_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3600.5,-3190.11 3323.5,-3190.11 3323.5,-3146.11 3600.5,-3146.11 3600.5,-3190.11"/>
<text text-anchor="middle" x="3462" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3462" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 363</text>
<text text-anchor="middle" x="3462" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3462" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_5&#45;&gt;expert_11_5_1 -->
<g id="edge1124" class="edge">
<title>route_11_5&#45;&gt;expert_11_5_1</title>
<path fill="none" stroke="black" d="M3462,-3225.76C3462,-3217.48 3462,-3208.5 3462,-3200.19"/>
<polygon fill="black" stroke="black" points="3465.5,-3200.12 3462,-3190.12 3458.5,-3200.12 3465.5,-3200.12"/>
</g>
<!-- tp_11_5 -->
<g id="node775" class="node">
<title>tp_11_5</title>
<ellipse fill="lightblue" stroke="black" cx="3462" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3462" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3462" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 362↔363</text>
<text text-anchor="middle" x="3462" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3462" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_5_0&#45;&gt;tp_11_5 -->
<g id="edge1125" class="edge">
<title>expert_11_5_0&#45;&gt;tp_11_5</title>
<path fill="none" stroke="black" d="M3238.41,-3146.02C3279.87,-3133.78 3332.36,-3118.28 3376.07,-3105.37"/>
<polygon fill="black" stroke="black" points="3377.23,-3108.68 3385.83,-3102.49 3375.25,-3101.97 3377.23,-3108.68"/>
</g>
<!-- expert_11_5_1&#45;&gt;tp_11_5 -->
<g id="edge1126" class="edge">
<title>expert_11_5_1&#45;&gt;tp_11_5</title>
<path fill="none" stroke="black" d="M3462,-3146.02C3462,-3138.35 3462,-3129.4 3462,-3120.61"/>
<polygon fill="black" stroke="black" points="3465.5,-3120.44 3462,-3110.44 3458.5,-3120.44 3465.5,-3120.44"/>
</g>
<!-- tp_11_5&#45;&gt;agg_11 -->
<g id="edge1127" class="edge">
<title>tp_11_5&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M3570.98,-3068.22C3772.78,-3050.11 4207.76,-3011.08 4468.35,-2987.7"/>
<polygon fill="black" stroke="black" points="4468.67,-2991.18 4478.32,-2986.8 4468.05,-2984.21 4468.67,-2991.18"/>
</g>
<!-- expert_11_6_0 -->
<g id="node777" class="node">
<title>expert_11_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3895.5,-3190.11 3618.5,-3190.11 3618.5,-3146.11 3895.5,-3146.11 3895.5,-3190.11"/>
<text text-anchor="middle" x="3757" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3757" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 364</text>
<text text-anchor="middle" x="3757" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3757" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_6&#45;&gt;expert_11_6_0 -->
<g id="edge1129" class="edge">
<title>route_11_6&#45;&gt;expert_11_6_0</title>
<path fill="none" stroke="black" d="M3961.08,-3229.38C3921.92,-3217.81 3876.49,-3204.4 3838.44,-3193.16"/>
<polygon fill="black" stroke="black" points="3839.01,-3189.68 3828.43,-3190.2 3837.03,-3196.39 3839.01,-3189.68"/>
</g>
<!-- expert_11_6_1 -->
<g id="node778" class="node">
<title>expert_11_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4190.5,-3190.11 3913.5,-3190.11 3913.5,-3146.11 4190.5,-3146.11 4190.5,-3190.11"/>
<text text-anchor="middle" x="4052" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4052" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 365</text>
<text text-anchor="middle" x="4052" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4052" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_6&#45;&gt;expert_11_6_1 -->
<g id="edge1130" class="edge">
<title>route_11_6&#45;&gt;expert_11_6_1</title>
<path fill="none" stroke="black" d="M4052,-3225.76C4052,-3217.48 4052,-3208.5 4052,-3200.19"/>
<polygon fill="black" stroke="black" points="4055.5,-3200.12 4052,-3190.12 4048.5,-3200.12 4055.5,-3200.12"/>
</g>
<!-- tp_11_6 -->
<g id="node779" class="node">
<title>tp_11_6</title>
<ellipse fill="lightblue" stroke="black" cx="4052" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4052" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4052" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 364↔365</text>
<text text-anchor="middle" x="4052" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4052" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_6_0&#45;&gt;tp_11_6 -->
<g id="edge1131" class="edge">
<title>expert_11_6_0&#45;&gt;tp_11_6</title>
<path fill="none" stroke="black" d="M3828.41,-3146.02C3869.87,-3133.78 3922.36,-3118.28 3966.07,-3105.37"/>
<polygon fill="black" stroke="black" points="3967.23,-3108.68 3975.83,-3102.49 3965.25,-3101.97 3967.23,-3108.68"/>
</g>
<!-- expert_11_6_1&#45;&gt;tp_11_6 -->
<g id="edge1132" class="edge">
<title>expert_11_6_1&#45;&gt;tp_11_6</title>
<path fill="none" stroke="black" d="M4052,-3146.02C4052,-3138.35 4052,-3129.4 4052,-3120.61"/>
<polygon fill="black" stroke="black" points="4055.5,-3120.44 4052,-3110.44 4048.5,-3120.44 4055.5,-3120.44"/>
</g>
<!-- tp_11_6&#45;&gt;agg_11 -->
<g id="edge1133" class="edge">
<title>tp_11_6&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M4147.76,-3061.31C4237.44,-3045.68 4374.08,-3021.86 4486.19,-3002.32"/>
<polygon fill="black" stroke="black" points="4487.02,-3005.73 4496.27,-3000.56 4485.81,-2998.83 4487.02,-3005.73"/>
</g>
<!-- expert_11_7_0 -->
<g id="node781" class="node">
<title>expert_11_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4485.5,-3190.11 4208.5,-3190.11 4208.5,-3146.11 4485.5,-3146.11 4485.5,-3190.11"/>
<text text-anchor="middle" x="4347" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4347" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 366</text>
<text text-anchor="middle" x="4347" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4347" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_7&#45;&gt;expert_11_7_0 -->
<g id="edge1135" class="edge">
<title>route_11_7&#45;&gt;expert_11_7_0</title>
<path fill="none" stroke="black" d="M4505.32,-3228.3C4475.66,-3217.21 4441.83,-3204.57 4413.08,-3193.82"/>
<polygon fill="black" stroke="black" points="4414.13,-3190.47 4403.54,-3190.25 4411.68,-3197.03 4414.13,-3190.47"/>
</g>
<!-- expert_11_7_1 -->
<g id="node782" class="node">
<title>expert_11_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4780.5,-3190.11 4503.5,-3190.11 4503.5,-3146.11 4780.5,-3146.11 4780.5,-3190.11"/>
<text text-anchor="middle" x="4642" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4642" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 367</text>
<text text-anchor="middle" x="4642" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4642" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_7&#45;&gt;expert_11_7_1 -->
<g id="edge1136" class="edge">
<title>route_11_7&#45;&gt;expert_11_7_1</title>
<path fill="none" stroke="black" d="M4601.34,-3226.25C4607.71,-3217.29 4614.68,-3207.49 4621.03,-3198.58"/>
<polygon fill="black" stroke="black" points="4623.94,-3200.53 4626.88,-3190.35 4618.23,-3196.47 4623.94,-3200.53"/>
</g>
<!-- tp_11_7 -->
<g id="node783" class="node">
<title>tp_11_7</title>
<ellipse fill="lightblue" stroke="black" cx="4642" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4642" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4642" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 366↔367</text>
<text text-anchor="middle" x="4642" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4642" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_7_0&#45;&gt;tp_11_7 -->
<g id="edge1137" class="edge">
<title>expert_11_7_0&#45;&gt;tp_11_7</title>
<path fill="none" stroke="black" d="M4418.41,-3146.02C4459.87,-3133.78 4512.36,-3118.28 4556.07,-3105.37"/>
<polygon fill="black" stroke="black" points="4557.23,-3108.68 4565.83,-3102.49 4555.25,-3101.97 4557.23,-3108.68"/>
</g>
<!-- expert_11_7_1&#45;&gt;tp_11_7 -->
<g id="edge1138" class="edge">
<title>expert_11_7_1&#45;&gt;tp_11_7</title>
<path fill="none" stroke="black" d="M4642,-3146.02C4642,-3138.35 4642,-3129.4 4642,-3120.61"/>
<polygon fill="black" stroke="black" points="4645.5,-3120.44 4642,-3110.44 4638.5,-3120.44 4645.5,-3120.44"/>
</g>
<!-- tp_11_7&#45;&gt;agg_11 -->
<g id="edge1139" class="edge">
<title>tp_11_7&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M4651.93,-3047.89C4654.62,-3039.74 4657.62,-3030.67 4660.59,-3021.66"/>
<polygon fill="black" stroke="black" points="4663.98,-3022.55 4663.79,-3011.96 4657.33,-3020.36 4663.98,-3022.55"/>
</g>
<!-- expert_11_8_0 -->
<g id="node785" class="node">
<title>expert_11_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5075.5,-3190.11 4798.5,-3190.11 4798.5,-3146.11 5075.5,-3146.11 5075.5,-3190.11"/>
<text text-anchor="middle" x="4937" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4937" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 368</text>
<text text-anchor="middle" x="4937" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4937" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_8&#45;&gt;expert_11_8_0 -->
<g id="edge1141" class="edge">
<title>route_11_8&#45;&gt;expert_11_8_0</title>
<path fill="none" stroke="black" d="M4978.32,-3226.25C4971.85,-3217.29 4964.76,-3207.49 4958.31,-3198.58"/>
<polygon fill="black" stroke="black" points="4961.06,-3196.4 4952.36,-3190.35 4955.39,-3200.51 4961.06,-3196.4"/>
</g>
<!-- expert_11_8_1 -->
<g id="node786" class="node">
<title>expert_11_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5370.5,-3190.11 5093.5,-3190.11 5093.5,-3146.11 5370.5,-3146.11 5370.5,-3190.11"/>
<text text-anchor="middle" x="5232" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5232" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 369</text>
<text text-anchor="middle" x="5232" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5232" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_8&#45;&gt;expert_11_8_1 -->
<g id="edge1142" class="edge">
<title>route_11_8&#45;&gt;expert_11_8_1</title>
<path fill="none" stroke="black" d="M5074.36,-3228.3C5103.89,-3217.21 5137.58,-3204.57 5166.2,-3193.82"/>
<polygon fill="black" stroke="black" points="5167.57,-3197.04 5175.71,-3190.25 5165.11,-3190.49 5167.57,-3197.04"/>
</g>
<!-- tp_11_8 -->
<g id="node787" class="node">
<title>tp_11_8</title>
<ellipse fill="lightblue" stroke="black" cx="4937" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4937" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4937" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 368↔369</text>
<text text-anchor="middle" x="4937" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4937" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_8_0&#45;&gt;tp_11_8 -->
<g id="edge1143" class="edge">
<title>expert_11_8_0&#45;&gt;tp_11_8</title>
<path fill="none" stroke="black" d="M4937,-3146.02C4937,-3138.35 4937,-3129.4 4937,-3120.61"/>
<polygon fill="black" stroke="black" points="4940.5,-3120.44 4937,-3110.44 4933.5,-3120.44 4940.5,-3120.44"/>
</g>
<!-- expert_11_8_1&#45;&gt;tp_11_8 -->
<g id="edge1144" class="edge">
<title>expert_11_8_1&#45;&gt;tp_11_8</title>
<path fill="none" stroke="black" d="M5160.59,-3146.02C5119.13,-3133.78 5066.64,-3118.28 5022.93,-3105.37"/>
<polygon fill="black" stroke="black" points="5023.75,-3101.97 5013.17,-3102.49 5021.77,-3108.68 5023.75,-3101.97"/>
</g>
<!-- tp_11_8&#45;&gt;agg_11 -->
<g id="edge1145" class="edge">
<title>tp_11_8&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M4876.28,-3052.42C4850.44,-3041.53 4819.46,-3028.48 4789.75,-3015.96"/>
<polygon fill="black" stroke="black" points="4790.73,-3012.58 4780.15,-3011.92 4788.01,-3019.03 4790.73,-3012.58"/>
</g>
<!-- expert_11_9_0 -->
<g id="node789" class="node">
<title>expert_11_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5665.5,-3190.11 5388.5,-3190.11 5388.5,-3146.11 5665.5,-3146.11 5665.5,-3190.11"/>
<text text-anchor="middle" x="5527" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5527" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 370</text>
<text text-anchor="middle" x="5527" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5527" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_9&#45;&gt;expert_11_9_0 -->
<g id="edge1147" class="edge">
<title>route_11_9&#45;&gt;expert_11_9_0</title>
<path fill="none" stroke="black" d="M5527,-3225.76C5527,-3217.48 5527,-3208.5 5527,-3200.19"/>
<polygon fill="black" stroke="black" points="5530.5,-3200.12 5527,-3190.12 5523.5,-3200.12 5530.5,-3200.12"/>
</g>
<!-- expert_11_9_1 -->
<g id="node790" class="node">
<title>expert_11_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5960.5,-3190.11 5683.5,-3190.11 5683.5,-3146.11 5960.5,-3146.11 5960.5,-3190.11"/>
<text text-anchor="middle" x="5822" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5822" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 371</text>
<text text-anchor="middle" x="5822" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5822" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_9&#45;&gt;expert_11_9_1 -->
<g id="edge1148" class="edge">
<title>route_11_9&#45;&gt;expert_11_9_1</title>
<path fill="none" stroke="black" d="M5617.92,-3229.38C5657.08,-3217.81 5702.51,-3204.4 5740.56,-3193.16"/>
<polygon fill="black" stroke="black" points="5741.97,-3196.39 5750.57,-3190.2 5739.99,-3189.68 5741.97,-3196.39"/>
</g>
<!-- tp_11_9 -->
<g id="node791" class="node">
<title>tp_11_9</title>
<ellipse fill="lightblue" stroke="black" cx="5527" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5527" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5527" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 370↔371</text>
<text text-anchor="middle" x="5527" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5527" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_9_0&#45;&gt;tp_11_9 -->
<g id="edge1149" class="edge">
<title>expert_11_9_0&#45;&gt;tp_11_9</title>
<path fill="none" stroke="black" d="M5527,-3146.02C5527,-3138.35 5527,-3129.4 5527,-3120.61"/>
<polygon fill="black" stroke="black" points="5530.5,-3120.44 5527,-3110.44 5523.5,-3120.44 5530.5,-3120.44"/>
</g>
<!-- expert_11_9_1&#45;&gt;tp_11_9 -->
<g id="edge1150" class="edge">
<title>expert_11_9_1&#45;&gt;tp_11_9</title>
<path fill="none" stroke="black" d="M5750.59,-3146.02C5709.13,-3133.78 5656.64,-3118.28 5612.93,-3105.37"/>
<polygon fill="black" stroke="black" points="5613.75,-3101.97 5603.17,-3102.49 5611.77,-3108.68 5613.75,-3101.97"/>
</g>
<!-- tp_11_9&#45;&gt;agg_11 -->
<g id="edge1151" class="edge">
<title>tp_11_9&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M5423.74,-3064.73C5309.04,-3049.99 5118.97,-3025.56 4959.43,-3005.06"/>
<polygon fill="black" stroke="black" points="4959.82,-3001.58 4949.45,-3003.77 4958.93,-3008.52 4959.82,-3001.58"/>
</g>
<!-- expert_11_10_0 -->
<g id="node793" class="node">
<title>expert_11_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6255.5,-3190.11 5978.5,-3190.11 5978.5,-3146.11 6255.5,-3146.11 6255.5,-3190.11"/>
<text text-anchor="middle" x="6117" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6117" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 372</text>
<text text-anchor="middle" x="6117" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6117" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_10&#45;&gt;expert_11_10_0 -->
<g id="edge1153" class="edge">
<title>route_11_10&#45;&gt;expert_11_10_0</title>
<path fill="none" stroke="black" d="M6117,-3225.76C6117,-3217.48 6117,-3208.5 6117,-3200.19"/>
<polygon fill="black" stroke="black" points="6120.5,-3200.12 6117,-3190.12 6113.5,-3200.12 6120.5,-3200.12"/>
</g>
<!-- expert_11_10_1 -->
<g id="node794" class="node">
<title>expert_11_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6550.5,-3190.11 6273.5,-3190.11 6273.5,-3146.11 6550.5,-3146.11 6550.5,-3190.11"/>
<text text-anchor="middle" x="6412" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6412" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 373</text>
<text text-anchor="middle" x="6412" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6412" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_10&#45;&gt;expert_11_10_1 -->
<g id="edge1154" class="edge">
<title>route_11_10&#45;&gt;expert_11_10_1</title>
<path fill="none" stroke="black" d="M6207.92,-3229.38C6247.08,-3217.81 6292.51,-3204.4 6330.56,-3193.16"/>
<polygon fill="black" stroke="black" points="6331.97,-3196.39 6340.57,-3190.2 6329.99,-3189.68 6331.97,-3196.39"/>
</g>
<!-- tp_11_10 -->
<g id="node795" class="node">
<title>tp_11_10</title>
<ellipse fill="lightblue" stroke="black" cx="6117" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6117" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6117" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 372↔373</text>
<text text-anchor="middle" x="6117" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6117" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_10_0&#45;&gt;tp_11_10 -->
<g id="edge1155" class="edge">
<title>expert_11_10_0&#45;&gt;tp_11_10</title>
<path fill="none" stroke="black" d="M6117,-3146.02C6117,-3138.35 6117,-3129.4 6117,-3120.61"/>
<polygon fill="black" stroke="black" points="6120.5,-3120.44 6117,-3110.44 6113.5,-3120.44 6120.5,-3120.44"/>
</g>
<!-- expert_11_10_1&#45;&gt;tp_11_10 -->
<g id="edge1156" class="edge">
<title>expert_11_10_1&#45;&gt;tp_11_10</title>
<path fill="none" stroke="black" d="M6340.59,-3146.02C6299.13,-3133.78 6246.64,-3118.28 6202.93,-3105.37"/>
<polygon fill="black" stroke="black" points="6203.75,-3101.97 6193.17,-3102.49 6201.77,-3108.68 6203.75,-3101.97"/>
</g>
<!-- tp_11_10&#45;&gt;agg_11 -->
<g id="edge1157" class="edge">
<title>tp_11_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M6006.18,-3069.6C5779.34,-3052.4 5256.75,-3012.77 4938.9,-2988.67"/>
<polygon fill="black" stroke="black" points="4938.85,-2985.16 4928.62,-2987.89 4938.33,-2992.14 4938.85,-2985.16"/>
</g>
<!-- expert_11_11_0 -->
<g id="node797" class="node">
<title>expert_11_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6845.5,-3190.11 6568.5,-3190.11 6568.5,-3146.11 6845.5,-3146.11 6845.5,-3190.11"/>
<text text-anchor="middle" x="6707" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6707" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 374</text>
<text text-anchor="middle" x="6707" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6707" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_11&#45;&gt;expert_11_11_0 -->
<g id="edge1159" class="edge">
<title>route_11_11&#45;&gt;expert_11_11_0</title>
<path fill="none" stroke="black" d="M6707,-3225.76C6707,-3217.48 6707,-3208.5 6707,-3200.19"/>
<polygon fill="black" stroke="black" points="6710.5,-3200.12 6707,-3190.12 6703.5,-3200.12 6710.5,-3200.12"/>
</g>
<!-- expert_11_11_1 -->
<g id="node798" class="node">
<title>expert_11_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7140.5,-3190.11 6863.5,-3190.11 6863.5,-3146.11 7140.5,-3146.11 7140.5,-3190.11"/>
<text text-anchor="middle" x="7002" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7002" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 375</text>
<text text-anchor="middle" x="7002" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7002" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_11&#45;&gt;expert_11_11_1 -->
<g id="edge1160" class="edge">
<title>route_11_11&#45;&gt;expert_11_11_1</title>
<path fill="none" stroke="black" d="M6797.92,-3229.38C6837.08,-3217.81 6882.51,-3204.4 6920.56,-3193.16"/>
<polygon fill="black" stroke="black" points="6921.97,-3196.39 6930.57,-3190.2 6919.99,-3189.68 6921.97,-3196.39"/>
</g>
<!-- tp_11_11 -->
<g id="node799" class="node">
<title>tp_11_11</title>
<ellipse fill="lightblue" stroke="black" cx="6707" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6707" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6707" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 374↔375</text>
<text text-anchor="middle" x="6707" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6707" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_11_0&#45;&gt;tp_11_11 -->
<g id="edge1161" class="edge">
<title>expert_11_11_0&#45;&gt;tp_11_11</title>
<path fill="none" stroke="black" d="M6707,-3146.02C6707,-3138.35 6707,-3129.4 6707,-3120.61"/>
<polygon fill="black" stroke="black" points="6710.5,-3120.44 6707,-3110.44 6703.5,-3120.44 6710.5,-3120.44"/>
</g>
<!-- expert_11_11_1&#45;&gt;tp_11_11 -->
<g id="edge1162" class="edge">
<title>expert_11_11_1&#45;&gt;tp_11_11</title>
<path fill="none" stroke="black" d="M6930.59,-3146.02C6889.13,-3133.78 6836.64,-3118.28 6792.93,-3105.37"/>
<polygon fill="black" stroke="black" points="6793.75,-3101.97 6783.17,-3102.49 6791.77,-3108.68 6793.75,-3101.97"/>
</g>
<!-- tp_11_11&#45;&gt;agg_11 -->
<g id="edge1163" class="edge">
<title>tp_11_11&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M6595.22,-3070.31C6501.04,-3063.95 6362.74,-3054.85 6242,-3047.89 5778.55,-3021.18 5237.55,-2994.95 4928.63,-2980.45"/>
<polygon fill="black" stroke="black" points="4928.35,-2976.93 4918.19,-2979.96 4928.02,-2983.92 4928.35,-2976.93"/>
</g>
<!-- expert_11_12_0 -->
<g id="node801" class="node">
<title>expert_11_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7435.5,-3190.11 7158.5,-3190.11 7158.5,-3146.11 7435.5,-3146.11 7435.5,-3190.11"/>
<text text-anchor="middle" x="7297" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7297" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 376</text>
<text text-anchor="middle" x="7297" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7297" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_12&#45;&gt;expert_11_12_0 -->
<g id="edge1165" class="edge">
<title>route_11_12&#45;&gt;expert_11_12_0</title>
<path fill="none" stroke="black" d="M7297,-3225.76C7297,-3217.48 7297,-3208.5 7297,-3200.19"/>
<polygon fill="black" stroke="black" points="7300.5,-3200.12 7297,-3190.12 7293.5,-3200.12 7300.5,-3200.12"/>
</g>
<!-- expert_11_12_1 -->
<g id="node802" class="node">
<title>expert_11_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7730.5,-3190.11 7453.5,-3190.11 7453.5,-3146.11 7730.5,-3146.11 7730.5,-3190.11"/>
<text text-anchor="middle" x="7592" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7592" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 377</text>
<text text-anchor="middle" x="7592" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7592" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_12&#45;&gt;expert_11_12_1 -->
<g id="edge1166" class="edge">
<title>route_11_12&#45;&gt;expert_11_12_1</title>
<path fill="none" stroke="black" d="M7387.92,-3229.38C7427.08,-3217.81 7472.51,-3204.4 7510.56,-3193.16"/>
<polygon fill="black" stroke="black" points="7511.97,-3196.39 7520.57,-3190.2 7509.99,-3189.68 7511.97,-3196.39"/>
</g>
<!-- tp_11_12 -->
<g id="node803" class="node">
<title>tp_11_12</title>
<ellipse fill="lightblue" stroke="black" cx="7297" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7297" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7297" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 376↔377</text>
<text text-anchor="middle" x="7297" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7297" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_12_0&#45;&gt;tp_11_12 -->
<g id="edge1167" class="edge">
<title>expert_11_12_0&#45;&gt;tp_11_12</title>
<path fill="none" stroke="black" d="M7297,-3146.02C7297,-3138.35 7297,-3129.4 7297,-3120.61"/>
<polygon fill="black" stroke="black" points="7300.5,-3120.44 7297,-3110.44 7293.5,-3120.44 7300.5,-3120.44"/>
</g>
<!-- expert_11_12_1&#45;&gt;tp_11_12 -->
<g id="edge1168" class="edge">
<title>expert_11_12_1&#45;&gt;tp_11_12</title>
<path fill="none" stroke="black" d="M7520.59,-3146.02C7479.13,-3133.78 7426.64,-3118.28 7382.93,-3105.37"/>
<polygon fill="black" stroke="black" points="7383.75,-3101.97 7373.17,-3102.49 7381.77,-3108.68 7383.75,-3101.97"/>
</g>
<!-- tp_11_12&#45;&gt;agg_11 -->
<g id="edge1169" class="edge">
<title>tp_11_12&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M7185.71,-3069.91C7091.54,-3063.28 6952.99,-3054.02 6832,-3047.89 6140.02,-3012.8 5322.24,-2987.14 4922.6,-2975.63"/>
<polygon fill="black" stroke="black" points="4922.46,-2972.12 4912.37,-2975.33 4922.26,-2979.12 4922.46,-2972.12"/>
</g>
<!-- expert_11_13_0 -->
<g id="node805" class="node">
<title>expert_11_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8025.5,-3190.11 7748.5,-3190.11 7748.5,-3146.11 8025.5,-3146.11 8025.5,-3190.11"/>
<text text-anchor="middle" x="7887" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7887" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 378</text>
<text text-anchor="middle" x="7887" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7887" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_13&#45;&gt;expert_11_13_0 -->
<g id="edge1171" class="edge">
<title>route_11_13&#45;&gt;expert_11_13_0</title>
<path fill="none" stroke="black" d="M7887,-3225.76C7887,-3217.48 7887,-3208.5 7887,-3200.19"/>
<polygon fill="black" stroke="black" points="7890.5,-3200.12 7887,-3190.12 7883.5,-3200.12 7890.5,-3200.12"/>
</g>
<!-- expert_11_13_1 -->
<g id="node806" class="node">
<title>expert_11_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8320.5,-3190.11 8043.5,-3190.11 8043.5,-3146.11 8320.5,-3146.11 8320.5,-3190.11"/>
<text text-anchor="middle" x="8182" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8182" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 379</text>
<text text-anchor="middle" x="8182" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8182" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_13&#45;&gt;expert_11_13_1 -->
<g id="edge1172" class="edge">
<title>route_11_13&#45;&gt;expert_11_13_1</title>
<path fill="none" stroke="black" d="M7977.92,-3229.38C8017.08,-3217.81 8062.51,-3204.4 8100.56,-3193.16"/>
<polygon fill="black" stroke="black" points="8101.97,-3196.39 8110.57,-3190.2 8099.99,-3189.68 8101.97,-3196.39"/>
</g>
<!-- tp_11_13 -->
<g id="node807" class="node">
<title>tp_11_13</title>
<ellipse fill="lightblue" stroke="black" cx="7887" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7887" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7887" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 378↔379</text>
<text text-anchor="middle" x="7887" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7887" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_13_0&#45;&gt;tp_11_13 -->
<g id="edge1173" class="edge">
<title>expert_11_13_0&#45;&gt;tp_11_13</title>
<path fill="none" stroke="black" d="M7887,-3146.02C7887,-3138.35 7887,-3129.4 7887,-3120.61"/>
<polygon fill="black" stroke="black" points="7890.5,-3120.44 7887,-3110.44 7883.5,-3120.44 7890.5,-3120.44"/>
</g>
<!-- expert_11_13_1&#45;&gt;tp_11_13 -->
<g id="edge1174" class="edge">
<title>expert_11_13_1&#45;&gt;tp_11_13</title>
<path fill="none" stroke="black" d="M8110.59,-3146.02C8069.13,-3133.78 8016.64,-3118.28 7972.93,-3105.37"/>
<polygon fill="black" stroke="black" points="7973.75,-3101.97 7963.17,-3102.49 7971.77,-3108.68 7973.75,-3101.97"/>
</g>
<!-- tp_11_13&#45;&gt;agg_11 -->
<g id="edge1175" class="edge">
<title>tp_11_13&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M7776.2,-3069.7C7682.03,-3062.92 7543.21,-3053.55 7422,-3047.89 6497.58,-3004.66 5396.81,-2981.56 4919.06,-2972.92"/>
<polygon fill="black" stroke="black" points="4918.99,-2969.42 4908.93,-2972.74 4918.87,-2976.42 4918.99,-2969.42"/>
</g>
<!-- expert_11_14_0 -->
<g id="node809" class="node">
<title>expert_11_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8615.5,-3190.11 8338.5,-3190.11 8338.5,-3146.11 8615.5,-3146.11 8615.5,-3190.11"/>
<text text-anchor="middle" x="8477" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8477" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 380</text>
<text text-anchor="middle" x="8477" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8477" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_14&#45;&gt;expert_11_14_0 -->
<g id="edge1177" class="edge">
<title>route_11_14&#45;&gt;expert_11_14_0</title>
<path fill="none" stroke="black" d="M8477,-3225.76C8477,-3217.48 8477,-3208.5 8477,-3200.19"/>
<polygon fill="black" stroke="black" points="8480.5,-3200.12 8477,-3190.12 8473.5,-3200.12 8480.5,-3200.12"/>
</g>
<!-- expert_11_14_1 -->
<g id="node810" class="node">
<title>expert_11_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8910.5,-3190.11 8633.5,-3190.11 8633.5,-3146.11 8910.5,-3146.11 8910.5,-3190.11"/>
<text text-anchor="middle" x="8772" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8772" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 381</text>
<text text-anchor="middle" x="8772" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8772" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_14&#45;&gt;expert_11_14_1 -->
<g id="edge1178" class="edge">
<title>route_11_14&#45;&gt;expert_11_14_1</title>
<path fill="none" stroke="black" d="M8567.92,-3229.38C8607.08,-3217.81 8652.51,-3204.4 8690.56,-3193.16"/>
<polygon fill="black" stroke="black" points="8691.97,-3196.39 8700.57,-3190.2 8689.99,-3189.68 8691.97,-3196.39"/>
</g>
<!-- tp_11_14 -->
<g id="node811" class="node">
<title>tp_11_14</title>
<ellipse fill="lightblue" stroke="black" cx="8477" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8477" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8477" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 380↔381</text>
<text text-anchor="middle" x="8477" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8477" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_14_0&#45;&gt;tp_11_14 -->
<g id="edge1179" class="edge">
<title>expert_11_14_0&#45;&gt;tp_11_14</title>
<path fill="none" stroke="black" d="M8477,-3146.02C8477,-3138.35 8477,-3129.4 8477,-3120.61"/>
<polygon fill="black" stroke="black" points="8480.5,-3120.44 8477,-3110.44 8473.5,-3120.44 8480.5,-3120.44"/>
</g>
<!-- expert_11_14_1&#45;&gt;tp_11_14 -->
<g id="edge1180" class="edge">
<title>expert_11_14_1&#45;&gt;tp_11_14</title>
<path fill="none" stroke="black" d="M8700.59,-3146.02C8659.13,-3133.78 8606.64,-3118.28 8562.93,-3105.37"/>
<polygon fill="black" stroke="black" points="8563.75,-3101.97 8553.17,-3102.49 8561.77,-3108.68 8563.75,-3101.97"/>
</g>
<!-- tp_11_14&#45;&gt;agg_11 -->
<g id="edge1181" class="edge">
<title>tp_11_14&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M8366.2,-3069.54C8272.04,-3062.66 8133.23,-3053.25 8012,-3047.89 6852.45,-2996.62 5464.47,-2977.2 4916.88,-2971.19"/>
<polygon fill="black" stroke="black" points="4916.53,-2967.69 4906.49,-2971.08 4916.45,-2974.68 4916.53,-2967.69"/>
</g>
<!-- expert_11_15_0 -->
<g id="node813" class="node">
<title>expert_11_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9205.5,-3190.11 8928.5,-3190.11 8928.5,-3146.11 9205.5,-3146.11 9205.5,-3190.11"/>
<text text-anchor="middle" x="9067" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9067" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 382</text>
<text text-anchor="middle" x="9067" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9067" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_15&#45;&gt;expert_11_15_0 -->
<g id="edge1183" class="edge">
<title>route_11_15&#45;&gt;expert_11_15_0</title>
<path fill="none" stroke="black" d="M9067,-3225.76C9067,-3217.48 9067,-3208.5 9067,-3200.19"/>
<polygon fill="black" stroke="black" points="9070.5,-3200.12 9067,-3190.12 9063.5,-3200.12 9070.5,-3200.12"/>
</g>
<!-- expert_11_15_1 -->
<g id="node814" class="node">
<title>expert_11_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9500.5,-3190.11 9223.5,-3190.11 9223.5,-3146.11 9500.5,-3146.11 9500.5,-3190.11"/>
<text text-anchor="middle" x="9362" y="-3180.91" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9362" y="-3170.91" font-family="Times,serif" font-size="9.00">GPU: 383</text>
<text text-anchor="middle" x="9362" y="-3160.91" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9362" y="-3150.91" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_11_15&#45;&gt;expert_11_15_1 -->
<g id="edge1184" class="edge">
<title>route_11_15&#45;&gt;expert_11_15_1</title>
<path fill="none" stroke="black" d="M9157.92,-3229.38C9197.08,-3217.81 9242.51,-3204.4 9280.56,-3193.16"/>
<polygon fill="black" stroke="black" points="9281.97,-3196.39 9290.57,-3190.2 9279.99,-3189.68 9281.97,-3196.39"/>
</g>
<!-- tp_11_15 -->
<g id="node815" class="node">
<title>tp_11_15</title>
<ellipse fill="lightblue" stroke="black" cx="9067" cy="-3079" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9067" y="-3091.8" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9067" y="-3081.8" font-family="Times,serif" font-size="9.00">GPU: 382↔383</text>
<text text-anchor="middle" x="9067" y="-3071.8" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9067" y="-3061.8" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_11_15_0&#45;&gt;tp_11_15 -->
<g id="edge1185" class="edge">
<title>expert_11_15_0&#45;&gt;tp_11_15</title>
<path fill="none" stroke="black" d="M9067,-3146.02C9067,-3138.35 9067,-3129.4 9067,-3120.61"/>
<polygon fill="black" stroke="black" points="9070.5,-3120.44 9067,-3110.44 9063.5,-3120.44 9070.5,-3120.44"/>
</g>
<!-- expert_11_15_1&#45;&gt;tp_11_15 -->
<g id="edge1186" class="edge">
<title>expert_11_15_1&#45;&gt;tp_11_15</title>
<path fill="none" stroke="black" d="M9290.59,-3146.02C9249.13,-3133.78 9196.64,-3118.28 9152.93,-3105.37"/>
<polygon fill="black" stroke="black" points="9153.75,-3101.97 9143.17,-3102.49 9151.77,-3108.68 9153.75,-3101.97"/>
</g>
<!-- tp_11_15&#45;&gt;agg_11 -->
<g id="edge1187" class="edge">
<title>tp_11_15&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M8956.21,-3069.43C8862.05,-3062.48 8723.24,-3053.03 8602,-3047.89 7205.15,-2988.63 5526.65,-2973.61 4915.34,-2969.98"/>
<polygon fill="black" stroke="black" points="4915.1,-2966.48 4905.08,-2969.92 4915.06,-2973.48 4915.1,-2966.48"/>
</g>
<!-- output_11 -->
<g id="node817" class="node">
<title>output_11</title>
<polygon fill="lightgreen" stroke="black" points="4826,-2887.89 4530,-2887.89 4530,-2843.89 4826,-2843.89 4826,-2887.89"/>
<text text-anchor="middle" x="4678" y="-2878.69" font-family="Times,serif" font-size="9.00">Layer 11 Output</text>
<text text-anchor="middle" x="4678" y="-2868.69" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4678" y="-2858.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4678" y="-2848.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_11&#45;&gt;output_11 -->
<g id="edge1188" class="edge">
<title>agg_11&#45;&gt;output_11</title>
<path fill="none" stroke="black" d="M4678,-2923.61C4678,-2915.02 4678,-2906.16 4678,-2898.07"/>
<polygon fill="black" stroke="black" points="4681.5,-2897.97 4678,-2887.97 4674.5,-2897.97 4681.5,-2897.97"/>
</g>
<!-- mha_12 -->
<g id="node818" class="node">
<title>mha_12</title>
<polygon fill="lightgreen" stroke="black" points="4826,-2796.89 4530,-2796.89 4530,-2752.89 4826,-2752.89 4826,-2796.89"/>
<text text-anchor="middle" x="4678" y="-2787.69" font-family="Times,serif" font-size="9.00">MHA L12</text>
<text text-anchor="middle" x="4678" y="-2777.69" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4678" y="-2767.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4678" y="-2757.69" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_11&#45;&gt;mha_12 -->
<g id="edge1189" class="edge">
<title>output_11&#45;&gt;mha_12</title>
<path fill="none" stroke="black" d="M4678,-2843.79C4678,-2832.9 4678,-2819.39 4678,-2807.3"/>
<polygon fill="black" stroke="black" points="4681.5,-2807.14 4678,-2797.14 4674.5,-2807.14 4681.5,-2807.14"/>
</g>
<!-- gate_12 -->
<g id="node819" class="node">
<title>gate_12</title>
<polygon fill="lightyellow" stroke="black" points="4977.74,-2716.89 4500.92,-2716.89 4378.26,-2628.89 4855.08,-2628.89 4977.74,-2716.89"/>
<text text-anchor="middle" x="4678" y="-2685.69" font-family="Times,serif" font-size="9.00">Gate L12</text>
<text text-anchor="middle" x="4678" y="-2675.69" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4678" y="-2665.69" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4678" y="-2655.69" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_12&#45;&gt;gate_12 -->
<g id="edge1190" class="edge">
<title>mha_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M4678,-2752.68C4678,-2745.18 4678,-2736.37 4678,-2727.41"/>
<polygon fill="black" stroke="black" points="4681.5,-2727.29 4678,-2717.29 4674.5,-2727.29 4681.5,-2727.29"/>
</g>
<!-- route_12_0 -->
<g id="node820" class="node">
<title>route_12_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="554" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="554" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="554" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 384,385</text>
<text text-anchor="middle" x="554" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="554" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_0 -->
<g id="edge1191" class="edge">
<title>gate_12&#45;&gt;route_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4437.74,-2671.64C3843.27,-2669.99 2255.99,-2659.16 934,-2592.89 868.75,-2589.62 797.32,-2584.39 734.17,-2579.2"/>
<polygon fill="black" stroke="black" points="734.37,-2575.71 724.11,-2578.37 733.79,-2582.68 734.37,-2575.71"/>
</g>
<!-- route_12_1 -->
<g id="node824" class="node">
<title>route_12_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1144" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1144" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1144" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 386,387</text>
<text text-anchor="middle" x="1144" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1144" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_1 -->
<g id="edge1197" class="edge">
<title>gate_12&#45;&gt;route_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4435.46,-2670.27C3906.41,-2665.78 2609.11,-2649.43 1524,-2592.89 1458.91,-2589.49 1387.67,-2584.26 1324.63,-2579.09"/>
<polygon fill="black" stroke="black" points="1324.84,-2575.6 1314.59,-2578.27 1324.27,-2582.58 1324.84,-2575.6"/>
</g>
<!-- route_12_2 -->
<g id="node828" class="node">
<title>route_12_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1734" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1734" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1734" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 388,389</text>
<text text-anchor="middle" x="1734" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1734" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_2 -->
<g id="edge1203" class="edge">
<title>gate_12&#45;&gt;route_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4433,-2668.27C3976.53,-2660.66 2965,-2639.69 2114,-2592.89 2049.08,-2589.32 1978.02,-2584.05 1915.1,-2578.92"/>
<polygon fill="black" stroke="black" points="1915.33,-2575.43 1905.08,-2578.1 1914.76,-2582.4 1915.33,-2575.43"/>
</g>
<!-- route_12_3 -->
<g id="node832" class="node">
<title>route_12_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2324" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2324" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2324" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 390,391</text>
<text text-anchor="middle" x="2324" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2324" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_3 -->
<g id="edge1209" class="edge">
<title>gate_12&#45;&gt;route_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4428.55,-2665.03C4053.89,-2654.02 3323.7,-2629.83 2704,-2592.89 2639.41,-2589.04 2568.73,-2583.73 2506.03,-2578.65"/>
<polygon fill="black" stroke="black" points="2506.29,-2575.16 2496.04,-2577.84 2505.73,-2582.14 2506.29,-2575.16"/>
</g>
<!-- route_12_4 -->
<g id="node836" class="node">
<title>route_12_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2914" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2914" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2914" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 392,393</text>
<text text-anchor="middle" x="2914" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2914" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_4 -->
<g id="edge1215" class="edge">
<title>gate_12&#45;&gt;route_12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4419.95,-2658.86C4141.89,-2644.43 3686.43,-2619.63 3294,-2592.89 3230.21,-2588.54 3160.43,-2583.18 3098.29,-2578.2"/>
<polygon fill="black" stroke="black" points="3098.23,-2574.68 3087.98,-2577.37 3097.67,-2581.66 3098.23,-2574.68"/>
</g>
<!-- route_12_5 -->
<g id="node840" class="node">
<title>route_12_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3504" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3504" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3504" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 394,395</text>
<text text-anchor="middle" x="3504" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3504" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_5 -->
<g id="edge1221" class="edge">
<title>gate_12&#45;&gt;route_12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4402.38,-2646.27C4180.48,-2625.65 3875.03,-2597.26 3683.61,-2579.47"/>
<polygon fill="black" stroke="black" points="3683.73,-2575.96 3673.45,-2578.52 3683.08,-2582.93 3683.73,-2575.96"/>
</g>
<!-- route_12_6 -->
<g id="node844" class="node">
<title>route_12_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4094" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4094" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4094" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 396,397</text>
<text text-anchor="middle" x="4094" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4094" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_6 -->
<g id="edge1227" class="edge">
<title>gate_12&#45;&gt;route_12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4447.61,-2628.84C4373.57,-2615.01 4294,-2600.14 4229.12,-2588.02"/>
<polygon fill="black" stroke="black" points="4229.72,-2584.57 4219.25,-2586.17 4228.43,-2591.45 4229.72,-2584.57"/>
</g>
<!-- route_12_7 -->
<g id="node848" class="node">
<title>route_12_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4645" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4645" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4645" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 398,399</text>
<text text-anchor="middle" x="4645" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4645" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_7 -->
<g id="edge1233" class="edge">
<title>gate_12&#45;&gt;route_12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4664.96,-2628.76C4662.37,-2620.2 4659.66,-2611.24 4657.1,-2602.79"/>
<polygon fill="black" stroke="black" points="4660.43,-2601.71 4654.19,-2593.15 4653.73,-2603.73 4660.43,-2601.71"/>
</g>
<!-- route_12_8 -->
<g id="node852" class="node">
<title>route_12_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5065" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5065" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5065" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 400,401</text>
<text text-anchor="middle" x="5065" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5065" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_8 -->
<g id="edge1239" class="edge">
<title>gate_12&#45;&gt;route_12_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4830.67,-2628.84C4874.42,-2616.51 4921.08,-2603.35 4961.16,-2592.05"/>
<polygon fill="black" stroke="black" points="4962.26,-2595.38 4970.93,-2589.3 4960.36,-2588.64 4962.26,-2595.38"/>
</g>
<!-- route_12_9 -->
<g id="node856" class="node">
<title>route_12_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5569" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5569" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5569" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 402,403</text>
<text text-anchor="middle" x="5569" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5569" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_9 -->
<g id="edge1245" class="edge">
<title>gate_12&#45;&gt;route_12_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4880.46,-2647.09C5038.95,-2627.68 5256.58,-2601.03 5404.45,-2582.92"/>
<polygon fill="black" stroke="black" points="5405.03,-2586.38 5414.53,-2581.69 5404.18,-2579.43 5405.03,-2586.38"/>
</g>
<!-- route_12_10 -->
<g id="node860" class="node">
<title>route_12_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6159" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6159" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6159" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 404,405</text>
<text text-anchor="middle" x="6159" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6159" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_10 -->
<g id="edge1251" class="edge">
<title>gate_12&#45;&gt;route_12_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4894.26,-2656.85C5116.29,-2641.29 5471.82,-2616.08 5779,-2592.89 5842.29,-2588.11 5911.5,-2582.68 5973.3,-2577.77"/>
<polygon fill="black" stroke="black" points="5973.86,-2581.23 5983.55,-2576.95 5973.31,-2574.26 5973.86,-2581.23"/>
</g>
<!-- route_12_11 -->
<g id="node864" class="node">
<title>route_12_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6749" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6749" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6749" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 406,407</text>
<text text-anchor="middle" x="6749" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6749" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_11 -->
<g id="edge1257" class="edge">
<title>gate_12&#45;&gt;route_12_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4903.78,-2663.67C5228.14,-2651.33 5844.7,-2625.9 6369,-2592.89 6433.13,-2588.85 6503.28,-2583.54 6565.65,-2578.51"/>
<polygon fill="black" stroke="black" points="6566.31,-2581.97 6575.99,-2577.67 6565.74,-2574.99 6566.31,-2581.97"/>
</g>
<!-- route_12_12 -->
<g id="node868" class="node">
<title>route_12_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7339" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7339" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7339" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 408,409</text>
<text text-anchor="middle" x="7339" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7339" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_12 -->
<g id="edge1263" class="edge">
<title>gate_12&#45;&gt;route_12_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4908.84,-2667.28C5320.83,-2658.31 6209.82,-2635.52 6959,-2592.89 7023.76,-2589.2 7094.62,-2583.92 7157.43,-2578.81"/>
<polygon fill="black" stroke="black" points="7157.76,-2582.3 7167.44,-2578 7157.19,-2575.32 7157.76,-2582.3"/>
</g>
<!-- route_12_13 -->
<g id="node872" class="node">
<title>route_12_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7929" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7929" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7929" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 410,411</text>
<text text-anchor="middle" x="7929" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7929" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_13 -->
<g id="edge1269" class="edge">
<title>gate_12&#45;&gt;route_12_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4912.15,-2669.53C5401.92,-2663.7 6570.28,-2645.1 7549,-2592.89 7613.92,-2589.42 7684.98,-2584.18 7747.9,-2579.04"/>
<polygon fill="black" stroke="black" points="7748.25,-2582.52 7757.93,-2578.22 7747.68,-2575.55 7748.25,-2582.52"/>
</g>
<!-- route_12_14 -->
<g id="node876" class="node">
<title>route_12_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8519" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8519" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8519" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 412,413</text>
<text text-anchor="middle" x="8519" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8519" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_14 -->
<g id="edge1275" class="edge">
<title>gate_12&#45;&gt;route_12_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4913.95,-2671.07C5473.94,-2668.15 6927.07,-2654.69 8139,-2592.89 8204.25,-2589.56 8275.68,-2584.32 8338.82,-2579.14"/>
<polygon fill="black" stroke="black" points="8339.21,-2582.62 8348.89,-2578.31 8338.63,-2575.64 8339.21,-2582.62"/>
</g>
<!-- route_12_15 -->
<g id="node880" class="node">
<title>route_12_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9109" cy="-2561.77" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9109" y="-2574.57" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9109" y="-2564.57" font-family="Times,serif" font-size="9.00">GPU: 414,415</text>
<text text-anchor="middle" x="9109" y="-2554.57" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9109" y="-2544.57" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_12&#45;&gt;route_12_15 -->
<g id="edge1281" class="edge">
<title>gate_12&#45;&gt;route_12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4915.6,-2672.19C5540.53,-2671.93 7281.69,-2664.28 8729,-2592.89 8794.25,-2589.67 8865.69,-2584.45 8928.83,-2579.26"/>
<polygon fill="black" stroke="black" points="8929.21,-2582.74 8938.89,-2578.43 8928.64,-2575.77 8929.21,-2582.74"/>
</g>
<!-- expert_12_0_0 -->
<g id="node821" class="node">
<title>expert_12_0_0</title>
<polygon fill="lightgreen" stroke="black" points="397.5,-2494.66 120.5,-2494.66 120.5,-2450.66 397.5,-2450.66 397.5,-2494.66"/>
<text text-anchor="middle" x="259" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="259" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 384</text>
<text text-anchor="middle" x="259" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="259" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_0&#45;&gt;expert_12_0_0 -->
<g id="edge1192" class="edge">
<title>route_12_0&#45;&gt;expert_12_0_0</title>
<path fill="none" stroke="black" d="M463.08,-2533.93C423.92,-2522.36 378.49,-2508.94 340.44,-2497.71"/>
<polygon fill="black" stroke="black" points="341.01,-2494.23 330.43,-2494.75 339.03,-2500.94 341.01,-2494.23"/>
</g>
<!-- expert_12_0_1 -->
<g id="node822" class="node">
<title>expert_12_0_1</title>
<polygon fill="lightgreen" stroke="black" points="692.5,-2494.66 415.5,-2494.66 415.5,-2450.66 692.5,-2450.66 692.5,-2494.66"/>
<text text-anchor="middle" x="554" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="554" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 385</text>
<text text-anchor="middle" x="554" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="554" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_0&#45;&gt;expert_12_0_1 -->
<g id="edge1193" class="edge">
<title>route_12_0&#45;&gt;expert_12_0_1</title>
<path fill="none" stroke="black" d="M554,-2530.31C554,-2522.03 554,-2513.05 554,-2504.74"/>
<polygon fill="black" stroke="black" points="557.5,-2504.67 554,-2494.67 550.5,-2504.67 557.5,-2504.67"/>
</g>
<!-- tp_12_0 -->
<g id="node823" class="node">
<title>tp_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="554" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="554" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="554" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 384↔385</text>
<text text-anchor="middle" x="554" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="554" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_0_0&#45;&gt;tp_12_0 -->
<g id="edge1194" class="edge">
<title>expert_12_0_0&#45;&gt;tp_12_0</title>
<path fill="none" stroke="black" d="M330.41,-2450.57C371.87,-2438.33 424.36,-2422.83 468.07,-2409.92"/>
<polygon fill="black" stroke="black" points="469.23,-2413.23 477.83,-2407.04 467.25,-2406.52 469.23,-2413.23"/>
</g>
<!-- expert_12_0_1&#45;&gt;tp_12_0 -->
<g id="edge1195" class="edge">
<title>expert_12_0_1&#45;&gt;tp_12_0</title>
<path fill="none" stroke="black" d="M554,-2450.57C554,-2442.9 554,-2433.95 554,-2425.15"/>
<polygon fill="black" stroke="black" points="557.5,-2424.99 554,-2414.99 550.5,-2424.99 557.5,-2424.99"/>
</g>
<!-- agg_12 -->
<g id="node884" class="node">
<title>agg_12</title>
<polygon fill="lightyellow" stroke="black" points="5112.99,-2316.44 4664.4,-2316.44 4549.01,-2228.44 4997.6,-2228.44 5112.99,-2316.44"/>
<text text-anchor="middle" x="4831" y="-2285.24" font-family="Times,serif" font-size="9.00">Aggregate Experts L12</text>
<text text-anchor="middle" x="4831" y="-2275.24" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-2265.24" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4831" y="-2255.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_12_0&#45;&gt;agg_12 -->
<g id="edge1196" class="edge">
<title>tp_12_0&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M664.79,-2374C758.96,-2367.06 897.76,-2357.61 1019,-2352.44 2374.83,-2294.51 4003.8,-2278.7 4598.92,-2274.7"/>
<polygon fill="black" stroke="black" points="4599.36,-2278.19 4609.33,-2274.63 4599.31,-2271.19 4599.36,-2278.19"/>
</g>
<!-- expert_12_1_0 -->
<g id="node825" class="node">
<title>expert_12_1_0</title>
<polygon fill="lightgreen" stroke="black" points="987.5,-2494.66 710.5,-2494.66 710.5,-2450.66 987.5,-2450.66 987.5,-2494.66"/>
<text text-anchor="middle" x="849" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="849" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 386</text>
<text text-anchor="middle" x="849" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="849" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_1&#45;&gt;expert_12_1_0 -->
<g id="edge1198" class="edge">
<title>route_12_1&#45;&gt;expert_12_1_0</title>
<path fill="none" stroke="black" d="M1053.08,-2533.93C1013.92,-2522.36 968.49,-2508.94 930.44,-2497.71"/>
<polygon fill="black" stroke="black" points="931.01,-2494.23 920.43,-2494.75 929.03,-2500.94 931.01,-2494.23"/>
</g>
<!-- expert_12_1_1 -->
<g id="node826" class="node">
<title>expert_12_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1282.5,-2494.66 1005.5,-2494.66 1005.5,-2450.66 1282.5,-2450.66 1282.5,-2494.66"/>
<text text-anchor="middle" x="1144" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1144" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 387</text>
<text text-anchor="middle" x="1144" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1144" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_1&#45;&gt;expert_12_1_1 -->
<g id="edge1199" class="edge">
<title>route_12_1&#45;&gt;expert_12_1_1</title>
<path fill="none" stroke="black" d="M1144,-2530.31C1144,-2522.03 1144,-2513.05 1144,-2504.74"/>
<polygon fill="black" stroke="black" points="1147.5,-2504.67 1144,-2494.67 1140.5,-2504.67 1147.5,-2504.67"/>
</g>
<!-- tp_12_1 -->
<g id="node827" class="node">
<title>tp_12_1</title>
<ellipse fill="lightblue" stroke="black" cx="1144" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1144" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1144" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 386↔387</text>
<text text-anchor="middle" x="1144" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1144" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_1_0&#45;&gt;tp_12_1 -->
<g id="edge1200" class="edge">
<title>expert_12_1_0&#45;&gt;tp_12_1</title>
<path fill="none" stroke="black" d="M920.41,-2450.57C961.87,-2438.33 1014.36,-2422.83 1058.07,-2409.92"/>
<polygon fill="black" stroke="black" points="1059.23,-2413.23 1067.83,-2407.04 1057.25,-2406.52 1059.23,-2413.23"/>
</g>
<!-- expert_12_1_1&#45;&gt;tp_12_1 -->
<g id="edge1201" class="edge">
<title>expert_12_1_1&#45;&gt;tp_12_1</title>
<path fill="none" stroke="black" d="M1144,-2450.57C1144,-2442.9 1144,-2433.95 1144,-2425.15"/>
<polygon fill="black" stroke="black" points="1147.5,-2424.99 1144,-2414.99 1140.5,-2424.99 1147.5,-2424.99"/>
</g>
<!-- tp_12_1&#45;&gt;agg_12 -->
<g id="edge1202" class="edge">
<title>tp_12_1&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1254.8,-2374.12C1348.96,-2367.25 1487.77,-2357.84 1609,-2352.44 2729.94,-2302.42 4071.78,-2282.29 4600.63,-2275.91"/>
<polygon fill="black" stroke="black" points="4600.71,-2279.41 4610.67,-2275.79 4600.63,-2272.41 4600.71,-2279.41"/>
</g>
<!-- expert_12_2_0 -->
<g id="node829" class="node">
<title>expert_12_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1577.5,-2494.66 1300.5,-2494.66 1300.5,-2450.66 1577.5,-2450.66 1577.5,-2494.66"/>
<text text-anchor="middle" x="1439" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1439" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 388</text>
<text text-anchor="middle" x="1439" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1439" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_2&#45;&gt;expert_12_2_0 -->
<g id="edge1204" class="edge">
<title>route_12_2&#45;&gt;expert_12_2_0</title>
<path fill="none" stroke="black" d="M1643.08,-2533.93C1603.92,-2522.36 1558.49,-2508.94 1520.44,-2497.71"/>
<polygon fill="black" stroke="black" points="1521.01,-2494.23 1510.43,-2494.75 1519.03,-2500.94 1521.01,-2494.23"/>
</g>
<!-- expert_12_2_1 -->
<g id="node830" class="node">
<title>expert_12_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1872.5,-2494.66 1595.5,-2494.66 1595.5,-2450.66 1872.5,-2450.66 1872.5,-2494.66"/>
<text text-anchor="middle" x="1734" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1734" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 389</text>
<text text-anchor="middle" x="1734" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1734" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_2&#45;&gt;expert_12_2_1 -->
<g id="edge1205" class="edge">
<title>route_12_2&#45;&gt;expert_12_2_1</title>
<path fill="none" stroke="black" d="M1734,-2530.31C1734,-2522.03 1734,-2513.05 1734,-2504.74"/>
<polygon fill="black" stroke="black" points="1737.5,-2504.67 1734,-2494.67 1730.5,-2504.67 1737.5,-2504.67"/>
</g>
<!-- tp_12_2 -->
<g id="node831" class="node">
<title>tp_12_2</title>
<ellipse fill="lightblue" stroke="black" cx="1734" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1734" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1734" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 388↔389</text>
<text text-anchor="middle" x="1734" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1734" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_2_0&#45;&gt;tp_12_2 -->
<g id="edge1206" class="edge">
<title>expert_12_2_0&#45;&gt;tp_12_2</title>
<path fill="none" stroke="black" d="M1510.41,-2450.57C1551.87,-2438.33 1604.36,-2422.83 1648.07,-2409.92"/>
<polygon fill="black" stroke="black" points="1649.23,-2413.23 1657.83,-2407.04 1647.25,-2406.52 1649.23,-2413.23"/>
</g>
<!-- expert_12_2_1&#45;&gt;tp_12_2 -->
<g id="edge1207" class="edge">
<title>expert_12_2_1&#45;&gt;tp_12_2</title>
<path fill="none" stroke="black" d="M1734,-2450.57C1734,-2442.9 1734,-2433.95 1734,-2425.15"/>
<polygon fill="black" stroke="black" points="1737.5,-2424.99 1734,-2414.99 1730.5,-2424.99 1737.5,-2424.99"/>
</g>
<!-- tp_12_2&#45;&gt;agg_12 -->
<g id="edge1208" class="edge">
<title>tp_12_2&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1844.8,-2374.29C1938.98,-2367.53 2077.79,-2358.18 2199,-2352.44 3087.74,-2310.33 4146.42,-2286.59 4602.95,-2277.62"/>
<polygon fill="black" stroke="black" points="4603.03,-2281.12 4612.96,-2277.42 4602.89,-2274.12 4603.03,-2281.12"/>
</g>
<!-- expert_12_3_0 -->
<g id="node833" class="node">
<title>expert_12_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2167.5,-2494.66 1890.5,-2494.66 1890.5,-2450.66 2167.5,-2450.66 2167.5,-2494.66"/>
<text text-anchor="middle" x="2029" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2029" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 390</text>
<text text-anchor="middle" x="2029" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2029" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_3&#45;&gt;expert_12_3_0 -->
<g id="edge1210" class="edge">
<title>route_12_3&#45;&gt;expert_12_3_0</title>
<path fill="none" stroke="black" d="M2233.08,-2533.93C2193.92,-2522.36 2148.49,-2508.94 2110.44,-2497.71"/>
<polygon fill="black" stroke="black" points="2111.01,-2494.23 2100.43,-2494.75 2109.03,-2500.94 2111.01,-2494.23"/>
</g>
<!-- expert_12_3_1 -->
<g id="node834" class="node">
<title>expert_12_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2462.5,-2494.66 2185.5,-2494.66 2185.5,-2450.66 2462.5,-2450.66 2462.5,-2494.66"/>
<text text-anchor="middle" x="2324" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2324" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 391</text>
<text text-anchor="middle" x="2324" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2324" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_3&#45;&gt;expert_12_3_1 -->
<g id="edge1211" class="edge">
<title>route_12_3&#45;&gt;expert_12_3_1</title>
<path fill="none" stroke="black" d="M2324,-2530.31C2324,-2522.03 2324,-2513.05 2324,-2504.74"/>
<polygon fill="black" stroke="black" points="2327.5,-2504.67 2324,-2494.67 2320.5,-2504.67 2327.5,-2504.67"/>
</g>
<!-- tp_12_3 -->
<g id="node835" class="node">
<title>tp_12_3</title>
<ellipse fill="lightblue" stroke="black" cx="2324" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2324" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2324" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 390↔391</text>
<text text-anchor="middle" x="2324" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2324" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_3_0&#45;&gt;tp_12_3 -->
<g id="edge1212" class="edge">
<title>expert_12_3_0&#45;&gt;tp_12_3</title>
<path fill="none" stroke="black" d="M2100.41,-2450.57C2141.87,-2438.33 2194.36,-2422.83 2238.07,-2409.92"/>
<polygon fill="black" stroke="black" points="2239.23,-2413.23 2247.83,-2407.04 2237.25,-2406.52 2239.23,-2413.23"/>
</g>
<!-- expert_12_3_1&#45;&gt;tp_12_3 -->
<g id="edge1213" class="edge">
<title>expert_12_3_1&#45;&gt;tp_12_3</title>
<path fill="none" stroke="black" d="M2324,-2450.57C2324,-2442.9 2324,-2433.95 2324,-2425.15"/>
<polygon fill="black" stroke="black" points="2327.5,-2424.99 2324,-2414.99 2320.5,-2424.99 2327.5,-2424.99"/>
</g>
<!-- tp_12_3&#45;&gt;agg_12 -->
<g id="edge1214" class="edge">
<title>tp_12_3&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M2435.29,-2374.53C2529.46,-2367.93 2668.02,-2358.69 2789,-2352.44 3449.08,-2318.3 4229.88,-2292.01 4606.12,-2280.22"/>
<polygon fill="black" stroke="black" points="4606.42,-2283.72 4616.3,-2279.91 4606.2,-2276.72 4606.42,-2283.72"/>
</g>
<!-- expert_12_4_0 -->
<g id="node837" class="node">
<title>expert_12_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2757.5,-2494.66 2480.5,-2494.66 2480.5,-2450.66 2757.5,-2450.66 2757.5,-2494.66"/>
<text text-anchor="middle" x="2619" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2619" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 392</text>
<text text-anchor="middle" x="2619" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2619" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_4&#45;&gt;expert_12_4_0 -->
<g id="edge1216" class="edge">
<title>route_12_4&#45;&gt;expert_12_4_0</title>
<path fill="none" stroke="black" d="M2823.08,-2533.93C2783.92,-2522.36 2738.49,-2508.94 2700.44,-2497.71"/>
<polygon fill="black" stroke="black" points="2701.01,-2494.23 2690.43,-2494.75 2699.03,-2500.94 2701.01,-2494.23"/>
</g>
<!-- expert_12_4_1 -->
<g id="node838" class="node">
<title>expert_12_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3052.5,-2494.66 2775.5,-2494.66 2775.5,-2450.66 3052.5,-2450.66 3052.5,-2494.66"/>
<text text-anchor="middle" x="2914" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2914" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 393</text>
<text text-anchor="middle" x="2914" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2914" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_4&#45;&gt;expert_12_4_1 -->
<g id="edge1217" class="edge">
<title>route_12_4&#45;&gt;expert_12_4_1</title>
<path fill="none" stroke="black" d="M2914,-2530.31C2914,-2522.03 2914,-2513.05 2914,-2504.74"/>
<polygon fill="black" stroke="black" points="2917.5,-2504.67 2914,-2494.67 2910.5,-2504.67 2917.5,-2504.67"/>
</g>
<!-- tp_12_4 -->
<g id="node839" class="node">
<title>tp_12_4</title>
<ellipse fill="lightblue" stroke="black" cx="2914" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2914" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2914" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 392↔393</text>
<text text-anchor="middle" x="2914" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2914" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_4_0&#45;&gt;tp_12_4 -->
<g id="edge1218" class="edge">
<title>expert_12_4_0&#45;&gt;tp_12_4</title>
<path fill="none" stroke="black" d="M2690.41,-2450.57C2731.87,-2438.33 2784.36,-2422.83 2828.07,-2409.92"/>
<polygon fill="black" stroke="black" points="2829.23,-2413.23 2837.83,-2407.04 2827.25,-2406.52 2829.23,-2413.23"/>
</g>
<!-- expert_12_4_1&#45;&gt;tp_12_4 -->
<g id="edge1219" class="edge">
<title>expert_12_4_1&#45;&gt;tp_12_4</title>
<path fill="none" stroke="black" d="M2914,-2450.57C2914,-2442.9 2914,-2433.95 2914,-2425.15"/>
<polygon fill="black" stroke="black" points="2917.5,-2424.99 2914,-2414.99 2910.5,-2424.99 2917.5,-2424.99"/>
</g>
<!-- tp_12_4&#45;&gt;agg_12 -->
<g id="edge1220" class="edge">
<title>tp_12_4&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3025.79,-2374.98C3119.97,-2368.69 3258.27,-2359.63 3379,-2352.44 3816.09,-2326.39 4327.42,-2299.38 4611.75,-2284.66"/>
<polygon fill="black" stroke="black" points="4611.96,-2288.15 4621.77,-2284.14 4611.6,-2281.16 4611.96,-2288.15"/>
</g>
<!-- expert_12_5_0 -->
<g id="node841" class="node">
<title>expert_12_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3347.5,-2494.66 3070.5,-2494.66 3070.5,-2450.66 3347.5,-2450.66 3347.5,-2494.66"/>
<text text-anchor="middle" x="3209" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3209" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 394</text>
<text text-anchor="middle" x="3209" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3209" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_5&#45;&gt;expert_12_5_0 -->
<g id="edge1222" class="edge">
<title>route_12_5&#45;&gt;expert_12_5_0</title>
<path fill="none" stroke="black" d="M3413.08,-2533.93C3373.92,-2522.36 3328.49,-2508.94 3290.44,-2497.71"/>
<polygon fill="black" stroke="black" points="3291.01,-2494.23 3280.43,-2494.75 3289.03,-2500.94 3291.01,-2494.23"/>
</g>
<!-- expert_12_5_1 -->
<g id="node842" class="node">
<title>expert_12_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3642.5,-2494.66 3365.5,-2494.66 3365.5,-2450.66 3642.5,-2450.66 3642.5,-2494.66"/>
<text text-anchor="middle" x="3504" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3504" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 395</text>
<text text-anchor="middle" x="3504" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3504" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_5&#45;&gt;expert_12_5_1 -->
<g id="edge1223" class="edge">
<title>route_12_5&#45;&gt;expert_12_5_1</title>
<path fill="none" stroke="black" d="M3504,-2530.31C3504,-2522.03 3504,-2513.05 3504,-2504.74"/>
<polygon fill="black" stroke="black" points="3507.5,-2504.67 3504,-2494.67 3500.5,-2504.67 3507.5,-2504.67"/>
</g>
<!-- tp_12_5 -->
<g id="node843" class="node">
<title>tp_12_5</title>
<ellipse fill="lightblue" stroke="black" cx="3504" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3504" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3504" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 394↔395</text>
<text text-anchor="middle" x="3504" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3504" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_5_0&#45;&gt;tp_12_5 -->
<g id="edge1224" class="edge">
<title>expert_12_5_0&#45;&gt;tp_12_5</title>
<path fill="none" stroke="black" d="M3280.41,-2450.57C3321.87,-2438.33 3374.36,-2422.83 3418.07,-2409.92"/>
<polygon fill="black" stroke="black" points="3419.23,-2413.23 3427.83,-2407.04 3417.25,-2406.52 3419.23,-2413.23"/>
</g>
<!-- expert_12_5_1&#45;&gt;tp_12_5 -->
<g id="edge1225" class="edge">
<title>expert_12_5_1&#45;&gt;tp_12_5</title>
<path fill="none" stroke="black" d="M3504,-2450.57C3504,-2442.9 3504,-2433.95 3504,-2425.15"/>
<polygon fill="black" stroke="black" points="3507.5,-2424.99 3504,-2414.99 3500.5,-2424.99 3507.5,-2424.99"/>
</g>
<!-- tp_12_5&#45;&gt;agg_12 -->
<g id="edge1226" class="edge">
<title>tp_12_5&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3614.01,-2373.5C3834.49,-2355.37 4333.79,-2314.32 4619.61,-2290.82"/>
<polygon fill="black" stroke="black" points="4620.01,-2294.3 4629.69,-2289.99 4619.44,-2287.32 4620.01,-2294.3"/>
</g>
<!-- expert_12_6_0 -->
<g id="node845" class="node">
<title>expert_12_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3937.5,-2494.66 3660.5,-2494.66 3660.5,-2450.66 3937.5,-2450.66 3937.5,-2494.66"/>
<text text-anchor="middle" x="3799" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3799" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 396</text>
<text text-anchor="middle" x="3799" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3799" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_6&#45;&gt;expert_12_6_0 -->
<g id="edge1228" class="edge">
<title>route_12_6&#45;&gt;expert_12_6_0</title>
<path fill="none" stroke="black" d="M4003.08,-2533.93C3963.92,-2522.36 3918.49,-2508.94 3880.44,-2497.71"/>
<polygon fill="black" stroke="black" points="3881.01,-2494.23 3870.43,-2494.75 3879.03,-2500.94 3881.01,-2494.23"/>
</g>
<!-- expert_12_6_1 -->
<g id="node846" class="node">
<title>expert_12_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4232.5,-2494.66 3955.5,-2494.66 3955.5,-2450.66 4232.5,-2450.66 4232.5,-2494.66"/>
<text text-anchor="middle" x="4094" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4094" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 397</text>
<text text-anchor="middle" x="4094" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4094" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_6&#45;&gt;expert_12_6_1 -->
<g id="edge1229" class="edge">
<title>route_12_6&#45;&gt;expert_12_6_1</title>
<path fill="none" stroke="black" d="M4094,-2530.31C4094,-2522.03 4094,-2513.05 4094,-2504.74"/>
<polygon fill="black" stroke="black" points="4097.5,-2504.67 4094,-2494.67 4090.5,-2504.67 4097.5,-2504.67"/>
</g>
<!-- tp_12_6 -->
<g id="node847" class="node">
<title>tp_12_6</title>
<ellipse fill="lightblue" stroke="black" cx="4094" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4094" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4094" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 396↔397</text>
<text text-anchor="middle" x="4094" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4094" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_6_0&#45;&gt;tp_12_6 -->
<g id="edge1230" class="edge">
<title>expert_12_6_0&#45;&gt;tp_12_6</title>
<path fill="none" stroke="black" d="M3870.41,-2450.57C3911.87,-2438.33 3964.36,-2422.83 4008.07,-2409.92"/>
<polygon fill="black" stroke="black" points="4009.23,-2413.23 4017.83,-2407.04 4007.25,-2406.52 4009.23,-2413.23"/>
</g>
<!-- expert_12_6_1&#45;&gt;tp_12_6 -->
<g id="edge1231" class="edge">
<title>expert_12_6_1&#45;&gt;tp_12_6</title>
<path fill="none" stroke="black" d="M4094,-2450.57C4094,-2442.9 4094,-2433.95 4094,-2425.15"/>
<polygon fill="black" stroke="black" points="4097.5,-2424.99 4094,-2414.99 4090.5,-2424.99 4097.5,-2424.99"/>
</g>
<!-- tp_12_6&#45;&gt;agg_12 -->
<g id="edge1232" class="edge">
<title>tp_12_6&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M4194.16,-2367.72C4306.68,-2351.06 4492.1,-2323.61 4633.93,-2302.61"/>
<polygon fill="black" stroke="black" points="4634.68,-2306.04 4644.06,-2301.11 4633.66,-2299.11 4634.68,-2306.04"/>
</g>
<!-- expert_12_7_0 -->
<g id="node849" class="node">
<title>expert_12_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4527.5,-2494.66 4250.5,-2494.66 4250.5,-2450.66 4527.5,-2450.66 4527.5,-2494.66"/>
<text text-anchor="middle" x="4389" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4389" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 398</text>
<text text-anchor="middle" x="4389" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4389" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_7&#45;&gt;expert_12_7_0 -->
<g id="edge1234" class="edge">
<title>route_12_7&#45;&gt;expert_12_7_0</title>
<path fill="none" stroke="black" d="M4564,-2533.21C4530.81,-2521.92 4492.73,-2508.96 4460.58,-2498.02"/>
<polygon fill="black" stroke="black" points="4461.4,-2494.6 4450.81,-2494.69 4459.15,-2501.23 4461.4,-2494.6"/>
</g>
<!-- expert_12_7_1 -->
<g id="node850" class="node">
<title>expert_12_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4822.5,-2494.66 4545.5,-2494.66 4545.5,-2450.66 4822.5,-2450.66 4822.5,-2494.66"/>
<text text-anchor="middle" x="4684" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4684" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 399</text>
<text text-anchor="middle" x="4684" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4684" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_7&#45;&gt;expert_12_7_1 -->
<g id="edge1235" class="edge">
<title>route_12_7&#45;&gt;expert_12_7_1</title>
<path fill="none" stroke="black" d="M4658.64,-2530.31C4662.47,-2521.75 4666.63,-2512.45 4670.46,-2503.91"/>
<polygon fill="black" stroke="black" points="4673.7,-2505.22 4674.6,-2494.67 4667.32,-2502.36 4673.7,-2505.22"/>
</g>
<!-- tp_12_7 -->
<g id="node851" class="node">
<title>tp_12_7</title>
<ellipse fill="lightblue" stroke="black" cx="4684" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4684" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4684" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 398↔399</text>
<text text-anchor="middle" x="4684" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4684" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_7_0&#45;&gt;tp_12_7 -->
<g id="edge1236" class="edge">
<title>expert_12_7_0&#45;&gt;tp_12_7</title>
<path fill="none" stroke="black" d="M4460.41,-2450.57C4501.87,-2438.33 4554.36,-2422.83 4598.07,-2409.92"/>
<polygon fill="black" stroke="black" points="4599.23,-2413.23 4607.83,-2407.04 4597.25,-2406.52 4599.23,-2413.23"/>
</g>
<!-- expert_12_7_1&#45;&gt;tp_12_7 -->
<g id="edge1237" class="edge">
<title>expert_12_7_1&#45;&gt;tp_12_7</title>
<path fill="none" stroke="black" d="M4684,-2450.57C4684,-2442.9 4684,-2433.95 4684,-2425.15"/>
<polygon fill="black" stroke="black" points="4687.5,-2424.99 4684,-2414.99 4680.5,-2424.99 4687.5,-2424.99"/>
</g>
<!-- tp_12_7&#45;&gt;agg_12 -->
<g id="edge1238" class="edge">
<title>tp_12_7&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M4722.24,-2354.17C4735.3,-2344.47 4750.31,-2333.33 4764.93,-2322.48"/>
<polygon fill="black" stroke="black" points="4767.05,-2325.26 4772.99,-2316.49 4762.88,-2319.64 4767.05,-2325.26"/>
</g>
<!-- expert_12_8_0 -->
<g id="node853" class="node">
<title>expert_12_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5117.5,-2494.66 4840.5,-2494.66 4840.5,-2450.66 5117.5,-2450.66 5117.5,-2494.66"/>
<text text-anchor="middle" x="4979" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4979" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 400</text>
<text text-anchor="middle" x="4979" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4979" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_8&#45;&gt;expert_12_8_0 -->
<g id="edge1240" class="edge">
<title>route_12_8&#45;&gt;expert_12_8_0</title>
<path fill="none" stroke="black" d="M5035.4,-2530.79C5026.2,-2521.47 5016.09,-2511.23 5007,-2502.03"/>
<polygon fill="black" stroke="black" points="5009.49,-2499.56 4999.97,-2494.9 5004.5,-2504.48 5009.49,-2499.56"/>
</g>
<!-- expert_12_8_1 -->
<g id="node854" class="node">
<title>expert_12_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5412.5,-2494.66 5135.5,-2494.66 5135.5,-2450.66 5412.5,-2450.66 5412.5,-2494.66"/>
<text text-anchor="middle" x="5274" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5274" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 401</text>
<text text-anchor="middle" x="5274" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5274" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_8&#45;&gt;expert_12_8_1 -->
<g id="edge1241" class="edge">
<title>route_12_8&#45;&gt;expert_12_8_1</title>
<path fill="none" stroke="black" d="M5132.86,-2532.49C5158.96,-2521.61 5188.56,-2509.27 5213.89,-2498.72"/>
<polygon fill="black" stroke="black" points="5215.48,-2501.84 5223.37,-2494.76 5212.79,-2495.38 5215.48,-2501.84"/>
</g>
<!-- tp_12_8 -->
<g id="node855" class="node">
<title>tp_12_8</title>
<ellipse fill="lightblue" stroke="black" cx="4979" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4979" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4979" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 400↔401</text>
<text text-anchor="middle" x="4979" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4979" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_8_0&#45;&gt;tp_12_8 -->
<g id="edge1242" class="edge">
<title>expert_12_8_0&#45;&gt;tp_12_8</title>
<path fill="none" stroke="black" d="M4979,-2450.57C4979,-2442.9 4979,-2433.95 4979,-2425.15"/>
<polygon fill="black" stroke="black" points="4982.5,-2424.99 4979,-2414.99 4975.5,-2424.99 4982.5,-2424.99"/>
</g>
<!-- expert_12_8_1&#45;&gt;tp_12_8 -->
<g id="edge1243" class="edge">
<title>expert_12_8_1&#45;&gt;tp_12_8</title>
<path fill="none" stroke="black" d="M5202.59,-2450.57C5161.13,-2438.33 5108.64,-2422.83 5064.93,-2409.92"/>
<polygon fill="black" stroke="black" points="5065.75,-2406.52 5055.17,-2407.04 5063.77,-2413.23 5065.75,-2406.52"/>
</g>
<!-- tp_12_8&#45;&gt;agg_12 -->
<g id="edge1244" class="edge">
<title>tp_12_8&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M4940.5,-2354.17C4927.35,-2344.47 4912.24,-2333.33 4897.52,-2322.48"/>
<polygon fill="black" stroke="black" points="4899.53,-2319.61 4889.4,-2316.49 4895.37,-2325.24 4899.53,-2319.61"/>
</g>
<!-- expert_12_9_0 -->
<g id="node857" class="node">
<title>expert_12_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-2494.66 5430.5,-2494.66 5430.5,-2450.66 5707.5,-2450.66 5707.5,-2494.66"/>
<text text-anchor="middle" x="5569" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5569" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 402</text>
<text text-anchor="middle" x="5569" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5569" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_9&#45;&gt;expert_12_9_0 -->
<g id="edge1246" class="edge">
<title>route_12_9&#45;&gt;expert_12_9_0</title>
<path fill="none" stroke="black" d="M5569,-2530.31C5569,-2522.03 5569,-2513.05 5569,-2504.74"/>
<polygon fill="black" stroke="black" points="5572.5,-2504.67 5569,-2494.67 5565.5,-2504.67 5572.5,-2504.67"/>
</g>
<!-- expert_12_9_1 -->
<g id="node858" class="node">
<title>expert_12_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6002.5,-2494.66 5725.5,-2494.66 5725.5,-2450.66 6002.5,-2450.66 6002.5,-2494.66"/>
<text text-anchor="middle" x="5864" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5864" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 403</text>
<text text-anchor="middle" x="5864" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5864" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_9&#45;&gt;expert_12_9_1 -->
<g id="edge1247" class="edge">
<title>route_12_9&#45;&gt;expert_12_9_1</title>
<path fill="none" stroke="black" d="M5659.92,-2533.93C5699.08,-2522.36 5744.51,-2508.94 5782.56,-2497.71"/>
<polygon fill="black" stroke="black" points="5783.97,-2500.94 5792.57,-2494.75 5781.99,-2494.23 5783.97,-2500.94"/>
</g>
<!-- tp_12_9 -->
<g id="node859" class="node">
<title>tp_12_9</title>
<ellipse fill="lightblue" stroke="black" cx="5569" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5569" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5569" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 402↔403</text>
<text text-anchor="middle" x="5569" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5569" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_9_0&#45;&gt;tp_12_9 -->
<g id="edge1248" class="edge">
<title>expert_12_9_0&#45;&gt;tp_12_9</title>
<path fill="none" stroke="black" d="M5569,-2450.57C5569,-2442.9 5569,-2433.95 5569,-2425.15"/>
<polygon fill="black" stroke="black" points="5572.5,-2424.99 5569,-2414.99 5565.5,-2424.99 5572.5,-2424.99"/>
</g>
<!-- expert_12_9_1&#45;&gt;tp_12_9 -->
<g id="edge1249" class="edge">
<title>expert_12_9_1&#45;&gt;tp_12_9</title>
<path fill="none" stroke="black" d="M5792.59,-2450.57C5751.13,-2438.33 5698.64,-2422.83 5654.93,-2409.92"/>
<polygon fill="black" stroke="black" points="5655.75,-2406.52 5645.17,-2407.04 5653.77,-2413.23 5655.75,-2406.52"/>
</g>
<!-- tp_12_9&#45;&gt;agg_12 -->
<g id="edge1250" class="edge">
<title>tp_12_9&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M5468.7,-2367.72C5379.3,-2354.5 5243.93,-2334.49 5120.87,-2316.29"/>
<polygon fill="black" stroke="black" points="5121.31,-2312.82 5110.9,-2314.82 5120.28,-2319.74 5121.31,-2312.82"/>
</g>
<!-- expert_12_10_0 -->
<g id="node861" class="node">
<title>expert_12_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6297.5,-2494.66 6020.5,-2494.66 6020.5,-2450.66 6297.5,-2450.66 6297.5,-2494.66"/>
<text text-anchor="middle" x="6159" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6159" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 404</text>
<text text-anchor="middle" x="6159" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6159" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_10&#45;&gt;expert_12_10_0 -->
<g id="edge1252" class="edge">
<title>route_12_10&#45;&gt;expert_12_10_0</title>
<path fill="none" stroke="black" d="M6159,-2530.31C6159,-2522.03 6159,-2513.05 6159,-2504.74"/>
<polygon fill="black" stroke="black" points="6162.5,-2504.67 6159,-2494.67 6155.5,-2504.67 6162.5,-2504.67"/>
</g>
<!-- expert_12_10_1 -->
<g id="node862" class="node">
<title>expert_12_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6592.5,-2494.66 6315.5,-2494.66 6315.5,-2450.66 6592.5,-2450.66 6592.5,-2494.66"/>
<text text-anchor="middle" x="6454" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6454" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 405</text>
<text text-anchor="middle" x="6454" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6454" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_10&#45;&gt;expert_12_10_1 -->
<g id="edge1253" class="edge">
<title>route_12_10&#45;&gt;expert_12_10_1</title>
<path fill="none" stroke="black" d="M6249.92,-2533.93C6289.08,-2522.36 6334.51,-2508.94 6372.56,-2497.71"/>
<polygon fill="black" stroke="black" points="6373.97,-2500.94 6382.57,-2494.75 6371.99,-2494.23 6373.97,-2500.94"/>
</g>
<!-- tp_12_10 -->
<g id="node863" class="node">
<title>tp_12_10</title>
<ellipse fill="lightblue" stroke="black" cx="6159" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6159" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6159" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 404↔405</text>
<text text-anchor="middle" x="6159" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6159" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_10_0&#45;&gt;tp_12_10 -->
<g id="edge1254" class="edge">
<title>expert_12_10_0&#45;&gt;tp_12_10</title>
<path fill="none" stroke="black" d="M6159,-2450.57C6159,-2442.9 6159,-2433.95 6159,-2425.15"/>
<polygon fill="black" stroke="black" points="6162.5,-2424.99 6159,-2414.99 6155.5,-2424.99 6162.5,-2424.99"/>
</g>
<!-- expert_12_10_1&#45;&gt;tp_12_10 -->
<g id="edge1255" class="edge">
<title>expert_12_10_1&#45;&gt;tp_12_10</title>
<path fill="none" stroke="black" d="M6382.59,-2450.57C6341.13,-2438.33 6288.64,-2422.83 6244.93,-2409.92"/>
<polygon fill="black" stroke="black" points="6245.75,-2406.52 6235.17,-2407.04 6243.77,-2413.23 6245.75,-2406.52"/>
</g>
<!-- tp_12_10&#45;&gt;agg_12 -->
<g id="edge1256" class="edge">
<title>tp_12_10&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M6049.19,-2373.53C5841.46,-2356.46 5385.69,-2319.01 5094.33,-2295.07"/>
<polygon fill="black" stroke="black" points="5094.29,-2291.56 5084.03,-2294.23 5093.71,-2298.53 5094.29,-2291.56"/>
</g>
<!-- expert_12_11_0 -->
<g id="node865" class="node">
<title>expert_12_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6887.5,-2494.66 6610.5,-2494.66 6610.5,-2450.66 6887.5,-2450.66 6887.5,-2494.66"/>
<text text-anchor="middle" x="6749" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6749" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 406</text>
<text text-anchor="middle" x="6749" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6749" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_11&#45;&gt;expert_12_11_0 -->
<g id="edge1258" class="edge">
<title>route_12_11&#45;&gt;expert_12_11_0</title>
<path fill="none" stroke="black" d="M6749,-2530.31C6749,-2522.03 6749,-2513.05 6749,-2504.74"/>
<polygon fill="black" stroke="black" points="6752.5,-2504.67 6749,-2494.67 6745.5,-2504.67 6752.5,-2504.67"/>
</g>
<!-- expert_12_11_1 -->
<g id="node866" class="node">
<title>expert_12_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7182.5,-2494.66 6905.5,-2494.66 6905.5,-2450.66 7182.5,-2450.66 7182.5,-2494.66"/>
<text text-anchor="middle" x="7044" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7044" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 407</text>
<text text-anchor="middle" x="7044" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7044" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_11&#45;&gt;expert_12_11_1 -->
<g id="edge1259" class="edge">
<title>route_12_11&#45;&gt;expert_12_11_1</title>
<path fill="none" stroke="black" d="M6839.92,-2533.93C6879.08,-2522.36 6924.51,-2508.94 6962.56,-2497.71"/>
<polygon fill="black" stroke="black" points="6963.97,-2500.94 6972.57,-2494.75 6961.99,-2494.23 6963.97,-2500.94"/>
</g>
<!-- tp_12_11 -->
<g id="node867" class="node">
<title>tp_12_11</title>
<ellipse fill="lightblue" stroke="black" cx="6749" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6749" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6749" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 406↔407</text>
<text text-anchor="middle" x="6749" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6749" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_11_0&#45;&gt;tp_12_11 -->
<g id="edge1260" class="edge">
<title>expert_12_11_0&#45;&gt;tp_12_11</title>
<path fill="none" stroke="black" d="M6749,-2450.57C6749,-2442.9 6749,-2433.95 6749,-2425.15"/>
<polygon fill="black" stroke="black" points="6752.5,-2424.99 6749,-2414.99 6745.5,-2424.99 6752.5,-2424.99"/>
</g>
<!-- expert_12_11_1&#45;&gt;tp_12_11 -->
<g id="edge1261" class="edge">
<title>expert_12_11_1&#45;&gt;tp_12_11</title>
<path fill="none" stroke="black" d="M6972.59,-2450.57C6931.13,-2438.33 6878.64,-2422.83 6834.93,-2409.92"/>
<polygon fill="black" stroke="black" points="6835.75,-2406.52 6825.17,-2407.04 6833.77,-2413.23 6835.75,-2406.52"/>
</g>
<!-- tp_12_11&#45;&gt;agg_12 -->
<g id="edge1262" class="edge">
<title>tp_12_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M6637.21,-2374.98C6543.03,-2368.69 6404.73,-2359.63 6284,-2352.44 5862.96,-2327.36 5373.09,-2301.39 5083.26,-2286.36"/>
<polygon fill="black" stroke="black" points="5083.2,-2282.85 5073.03,-2285.83 5082.84,-2289.84 5083.2,-2282.85"/>
</g>
<!-- expert_12_12_0 -->
<g id="node869" class="node">
<title>expert_12_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7477.5,-2494.66 7200.5,-2494.66 7200.5,-2450.66 7477.5,-2450.66 7477.5,-2494.66"/>
<text text-anchor="middle" x="7339" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7339" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 408</text>
<text text-anchor="middle" x="7339" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7339" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_12&#45;&gt;expert_12_12_0 -->
<g id="edge1264" class="edge">
<title>route_12_12&#45;&gt;expert_12_12_0</title>
<path fill="none" stroke="black" d="M7339,-2530.31C7339,-2522.03 7339,-2513.05 7339,-2504.74"/>
<polygon fill="black" stroke="black" points="7342.5,-2504.67 7339,-2494.67 7335.5,-2504.67 7342.5,-2504.67"/>
</g>
<!-- expert_12_12_1 -->
<g id="node870" class="node">
<title>expert_12_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7772.5,-2494.66 7495.5,-2494.66 7495.5,-2450.66 7772.5,-2450.66 7772.5,-2494.66"/>
<text text-anchor="middle" x="7634" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7634" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 409</text>
<text text-anchor="middle" x="7634" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7634" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_12&#45;&gt;expert_12_12_1 -->
<g id="edge1265" class="edge">
<title>route_12_12&#45;&gt;expert_12_12_1</title>
<path fill="none" stroke="black" d="M7429.92,-2533.93C7469.08,-2522.36 7514.51,-2508.94 7552.56,-2497.71"/>
<polygon fill="black" stroke="black" points="7553.97,-2500.94 7562.57,-2494.75 7551.99,-2494.23 7553.97,-2500.94"/>
</g>
<!-- tp_12_12 -->
<g id="node871" class="node">
<title>tp_12_12</title>
<ellipse fill="lightblue" stroke="black" cx="7339" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7339" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7339" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 408↔409</text>
<text text-anchor="middle" x="7339" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7339" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_12_0&#45;&gt;tp_12_12 -->
<g id="edge1266" class="edge">
<title>expert_12_12_0&#45;&gt;tp_12_12</title>
<path fill="none" stroke="black" d="M7339,-2450.57C7339,-2442.9 7339,-2433.95 7339,-2425.15"/>
<polygon fill="black" stroke="black" points="7342.5,-2424.99 7339,-2414.99 7335.5,-2424.99 7342.5,-2424.99"/>
</g>
<!-- expert_12_12_1&#45;&gt;tp_12_12 -->
<g id="edge1267" class="edge">
<title>expert_12_12_1&#45;&gt;tp_12_12</title>
<path fill="none" stroke="black" d="M7562.59,-2450.57C7521.13,-2438.33 7468.64,-2422.83 7424.93,-2409.92"/>
<polygon fill="black" stroke="black" points="7425.75,-2406.52 7415.17,-2407.04 7423.77,-2413.23 7425.75,-2406.52"/>
</g>
<!-- tp_12_12&#45;&gt;agg_12 -->
<g id="edge1268" class="edge">
<title>tp_12_12&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M7227.71,-2374.53C7133.54,-2367.93 6994.98,-2358.69 6874,-2352.44 6225.3,-2318.89 5460.04,-2292.94 5076.37,-2280.86"/>
<polygon fill="black" stroke="black" points="5076.36,-2277.36 5066.26,-2280.54 5076.14,-2284.36 5076.36,-2277.36"/>
</g>
<!-- expert_12_13_0 -->
<g id="node873" class="node">
<title>expert_12_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8067.5,-2494.66 7790.5,-2494.66 7790.5,-2450.66 8067.5,-2450.66 8067.5,-2494.66"/>
<text text-anchor="middle" x="7929" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7929" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 410</text>
<text text-anchor="middle" x="7929" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7929" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_13&#45;&gt;expert_12_13_0 -->
<g id="edge1270" class="edge">
<title>route_12_13&#45;&gt;expert_12_13_0</title>
<path fill="none" stroke="black" d="M7929,-2530.31C7929,-2522.03 7929,-2513.05 7929,-2504.74"/>
<polygon fill="black" stroke="black" points="7932.5,-2504.67 7929,-2494.67 7925.5,-2504.67 7932.5,-2504.67"/>
</g>
<!-- expert_12_13_1 -->
<g id="node874" class="node">
<title>expert_12_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8362.5,-2494.66 8085.5,-2494.66 8085.5,-2450.66 8362.5,-2450.66 8362.5,-2494.66"/>
<text text-anchor="middle" x="8224" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8224" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 411</text>
<text text-anchor="middle" x="8224" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8224" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_13&#45;&gt;expert_12_13_1 -->
<g id="edge1271" class="edge">
<title>route_12_13&#45;&gt;expert_12_13_1</title>
<path fill="none" stroke="black" d="M8019.92,-2533.93C8059.08,-2522.36 8104.51,-2508.94 8142.56,-2497.71"/>
<polygon fill="black" stroke="black" points="8143.97,-2500.94 8152.57,-2494.75 8141.99,-2494.23 8143.97,-2500.94"/>
</g>
<!-- tp_12_13 -->
<g id="node875" class="node">
<title>tp_12_13</title>
<ellipse fill="lightblue" stroke="black" cx="7929" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7929" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7929" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 410↔411</text>
<text text-anchor="middle" x="7929" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7929" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_13_0&#45;&gt;tp_12_13 -->
<g id="edge1272" class="edge">
<title>expert_12_13_0&#45;&gt;tp_12_13</title>
<path fill="none" stroke="black" d="M7929,-2450.57C7929,-2442.9 7929,-2433.95 7929,-2425.15"/>
<polygon fill="black" stroke="black" points="7932.5,-2424.99 7929,-2414.99 7925.5,-2424.99 7932.5,-2424.99"/>
</g>
<!-- expert_12_13_1&#45;&gt;tp_12_13 -->
<g id="edge1273" class="edge">
<title>expert_12_13_1&#45;&gt;tp_12_13</title>
<path fill="none" stroke="black" d="M8152.59,-2450.57C8111.13,-2438.33 8058.64,-2422.83 8014.93,-2409.92"/>
<polygon fill="black" stroke="black" points="8015.75,-2406.52 8005.17,-2407.04 8013.77,-2413.23 8015.75,-2406.52"/>
</g>
<!-- tp_12_13&#45;&gt;agg_12 -->
<g id="edge1274" class="edge">
<title>tp_12_13&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M7818.2,-2374.29C7724.02,-2367.53 7585.21,-2358.18 7464,-2352.44 6583.43,-2310.73 5536.09,-2287.04 5072.4,-2277.88"/>
<polygon fill="black" stroke="black" points="5072.3,-2274.38 5062.24,-2277.68 5072.17,-2281.38 5072.3,-2274.38"/>
</g>
<!-- expert_12_14_0 -->
<g id="node877" class="node">
<title>expert_12_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8657.5,-2494.66 8380.5,-2494.66 8380.5,-2450.66 8657.5,-2450.66 8657.5,-2494.66"/>
<text text-anchor="middle" x="8519" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8519" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 412</text>
<text text-anchor="middle" x="8519" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8519" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_14&#45;&gt;expert_12_14_0 -->
<g id="edge1276" class="edge">
<title>route_12_14&#45;&gt;expert_12_14_0</title>
<path fill="none" stroke="black" d="M8519,-2530.31C8519,-2522.03 8519,-2513.05 8519,-2504.74"/>
<polygon fill="black" stroke="black" points="8522.5,-2504.67 8519,-2494.67 8515.5,-2504.67 8522.5,-2504.67"/>
</g>
<!-- expert_12_14_1 -->
<g id="node878" class="node">
<title>expert_12_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8952.5,-2494.66 8675.5,-2494.66 8675.5,-2450.66 8952.5,-2450.66 8952.5,-2494.66"/>
<text text-anchor="middle" x="8814" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8814" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 413</text>
<text text-anchor="middle" x="8814" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8814" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_14&#45;&gt;expert_12_14_1 -->
<g id="edge1277" class="edge">
<title>route_12_14&#45;&gt;expert_12_14_1</title>
<path fill="none" stroke="black" d="M8609.92,-2533.93C8649.08,-2522.36 8694.51,-2508.94 8732.56,-2497.71"/>
<polygon fill="black" stroke="black" points="8733.97,-2500.94 8742.57,-2494.75 8731.99,-2494.23 8733.97,-2500.94"/>
</g>
<!-- tp_12_14 -->
<g id="node879" class="node">
<title>tp_12_14</title>
<ellipse fill="lightblue" stroke="black" cx="8519" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8519" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8519" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 412↔413</text>
<text text-anchor="middle" x="8519" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8519" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_14_0&#45;&gt;tp_12_14 -->
<g id="edge1278" class="edge">
<title>expert_12_14_0&#45;&gt;tp_12_14</title>
<path fill="none" stroke="black" d="M8519,-2450.57C8519,-2442.9 8519,-2433.95 8519,-2425.15"/>
<polygon fill="black" stroke="black" points="8522.5,-2424.99 8519,-2414.99 8515.5,-2424.99 8522.5,-2424.99"/>
</g>
<!-- expert_12_14_1&#45;&gt;tp_12_14 -->
<g id="edge1279" class="edge">
<title>expert_12_14_1&#45;&gt;tp_12_14</title>
<path fill="none" stroke="black" d="M8742.59,-2450.57C8701.13,-2438.33 8648.64,-2422.83 8604.93,-2409.92"/>
<polygon fill="black" stroke="black" points="8605.75,-2406.52 8595.17,-2407.04 8603.77,-2413.23 8605.75,-2406.52"/>
</g>
<!-- tp_12_14&#45;&gt;agg_12 -->
<g id="edge1280" class="edge">
<title>tp_12_14&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M8408.2,-2374.12C8314.04,-2367.25 8175.23,-2357.84 8054,-2352.44 6938.96,-2302.69 5605.42,-2282.51 5070.36,-2276.02"/>
<polygon fill="black" stroke="black" points="5070.25,-2272.52 5060.21,-2275.89 5070.16,-2279.51 5070.25,-2272.52"/>
</g>
<!-- expert_12_15_0 -->
<g id="node881" class="node">
<title>expert_12_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9247.5,-2494.66 8970.5,-2494.66 8970.5,-2450.66 9247.5,-2450.66 9247.5,-2494.66"/>
<text text-anchor="middle" x="9109" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9109" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 414</text>
<text text-anchor="middle" x="9109" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9109" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_15&#45;&gt;expert_12_15_0 -->
<g id="edge1282" class="edge">
<title>route_12_15&#45;&gt;expert_12_15_0</title>
<path fill="none" stroke="black" d="M9109,-2530.31C9109,-2522.03 9109,-2513.05 9109,-2504.74"/>
<polygon fill="black" stroke="black" points="9112.5,-2504.67 9109,-2494.67 9105.5,-2504.67 9112.5,-2504.67"/>
</g>
<!-- expert_12_15_1 -->
<g id="node882" class="node">
<title>expert_12_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9542.5,-2494.66 9265.5,-2494.66 9265.5,-2450.66 9542.5,-2450.66 9542.5,-2494.66"/>
<text text-anchor="middle" x="9404" y="-2485.46" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9404" y="-2475.46" font-family="Times,serif" font-size="9.00">GPU: 415</text>
<text text-anchor="middle" x="9404" y="-2465.46" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9404" y="-2455.46" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_12_15&#45;&gt;expert_12_15_1 -->
<g id="edge1283" class="edge">
<title>route_12_15&#45;&gt;expert_12_15_1</title>
<path fill="none" stroke="black" d="M9199.92,-2533.93C9239.08,-2522.36 9284.51,-2508.94 9322.56,-2497.71"/>
<polygon fill="black" stroke="black" points="9323.97,-2500.94 9332.57,-2494.75 9321.99,-2494.23 9323.97,-2500.94"/>
</g>
<!-- tp_12_15 -->
<g id="node883" class="node">
<title>tp_12_15</title>
<ellipse fill="lightblue" stroke="black" cx="9109" cy="-2383.55" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9109" y="-2396.35" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9109" y="-2386.35" font-family="Times,serif" font-size="9.00">GPU: 414↔415</text>
<text text-anchor="middle" x="9109" y="-2376.35" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9109" y="-2366.35" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_12_15_0&#45;&gt;tp_12_15 -->
<g id="edge1284" class="edge">
<title>expert_12_15_0&#45;&gt;tp_12_15</title>
<path fill="none" stroke="black" d="M9109,-2450.57C9109,-2442.9 9109,-2433.95 9109,-2425.15"/>
<polygon fill="black" stroke="black" points="9112.5,-2424.99 9109,-2414.99 9105.5,-2424.99 9112.5,-2424.99"/>
</g>
<!-- expert_12_15_1&#45;&gt;tp_12_15 -->
<g id="edge1285" class="edge">
<title>expert_12_15_1&#45;&gt;tp_12_15</title>
<path fill="none" stroke="black" d="M9332.59,-2450.57C9291.13,-2438.33 9238.64,-2422.83 9194.93,-2409.92"/>
<polygon fill="black" stroke="black" points="9195.75,-2406.52 9185.17,-2407.04 9193.77,-2413.23 9195.75,-2406.52"/>
</g>
<!-- tp_12_15&#45;&gt;agg_12 -->
<g id="edge1286" class="edge">
<title>tp_12_15&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M8998.21,-2374C8904.04,-2367.06 8765.24,-2357.61 8644,-2352.44 7291.8,-2294.67 5667.99,-2278.79 5068.41,-2274.73"/>
<polygon fill="black" stroke="black" points="5068.38,-2271.23 5058.35,-2274.66 5068.33,-2278.23 5068.38,-2271.23"/>
</g>
<!-- output_12 -->
<g id="node885" class="node">
<title>output_12</title>
<polygon fill="lightgreen" stroke="black" points="4979,-2192.44 4683,-2192.44 4683,-2148.44 4979,-2148.44 4979,-2192.44"/>
<text text-anchor="middle" x="4831" y="-2183.24" font-family="Times,serif" font-size="9.00">Layer 12 Output</text>
<text text-anchor="middle" x="4831" y="-2173.24" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-2163.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4831" y="-2153.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_12&#45;&gt;output_12 -->
<g id="edge1287" class="edge">
<title>agg_12&#45;&gt;output_12</title>
<path fill="none" stroke="black" d="M4831,-2228.16C4831,-2219.57 4831,-2210.71 4831,-2202.62"/>
<polygon fill="black" stroke="black" points="4834.5,-2202.52 4831,-2192.52 4827.5,-2202.52 4834.5,-2202.52"/>
</g>
<!-- mha_13 -->
<g id="node886" class="node">
<title>mha_13</title>
<polygon fill="lightgreen" stroke="black" points="4979,-2112.44 4683,-2112.44 4683,-2068.44 4979,-2068.44 4979,-2112.44"/>
<text text-anchor="middle" x="4831" y="-2103.24" font-family="Times,serif" font-size="9.00">MHA L13</text>
<text text-anchor="middle" x="4831" y="-2093.24" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-2083.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4831" y="-2073.24" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_12&#45;&gt;mha_13 -->
<g id="edge1288" class="edge">
<title>output_12&#45;&gt;mha_13</title>
<path fill="none" stroke="black" d="M4831,-2148.12C4831,-2140.23 4831,-2131.12 4831,-2122.54"/>
<polygon fill="black" stroke="black" points="4834.5,-2122.45 4831,-2112.45 4827.5,-2122.45 4834.5,-2122.45"/>
</g>
<!-- gate_13 -->
<g id="node887" class="node">
<title>gate_13</title>
<polygon fill="lightyellow" stroke="black" points="5130.74,-2032.44 4653.92,-2032.44 4531.26,-1944.44 5008.08,-1944.44 5130.74,-2032.44"/>
<text text-anchor="middle" x="4831" y="-2001.24" font-family="Times,serif" font-size="9.00">Gate L13</text>
<text text-anchor="middle" x="4831" y="-1991.24" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-1981.24" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4831" y="-1971.24" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_13&#45;&gt;gate_13 -->
<g id="edge1289" class="edge">
<title>mha_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M4831,-2068.23C4831,-2060.73 4831,-2051.92 4831,-2042.96"/>
<polygon fill="black" stroke="black" points="4834.5,-2042.84 4831,-2032.84 4827.5,-2042.84 4834.5,-2042.84"/>
</g>
<!-- route_13_0 -->
<g id="node888" class="node">
<title>route_13_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="554" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="554" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="554" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 416,417</text>
<text text-anchor="middle" x="554" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="554" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_0 -->
<g id="edge1290" class="edge">
<title>gate_13&#45;&gt;route_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4591.09,-1987.48C3980.43,-1986.51 2317.63,-1977.22 934,-1908.44 868.75,-1905.19 797.32,-1899.97 734.17,-1894.78"/>
<polygon fill="black" stroke="black" points="734.36,-1891.29 724.11,-1893.95 733.79,-1898.26 734.36,-1891.29"/>
</g>
<!-- route_13_1 -->
<g id="node892" class="node">
<title>route_13_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1144" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1144" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1144" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 418,419</text>
<text text-anchor="middle" x="1144" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1144" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_1 -->
<g id="edge1296" class="edge">
<title>gate_13&#45;&gt;route_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4589.4,-1986.23C4042.99,-1982.5 2670.53,-1967.51 1524,-1908.44 1458.91,-1905.08 1387.67,-1899.85 1324.63,-1894.69"/>
<polygon fill="black" stroke="black" points="1324.84,-1891.19 1314.59,-1893.86 1324.27,-1898.17 1324.84,-1891.19"/>
</g>
<!-- route_13_2 -->
<g id="node896" class="node">
<title>route_13_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1734" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1734" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1734" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 420,421</text>
<text text-anchor="middle" x="1734" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1734" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_2 -->
<g id="edge1302" class="edge">
<title>gate_13&#45;&gt;route_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4586.82,-1984.43C4110.8,-1977.65 3025.5,-1957.77 2114,-1908.44 2049.08,-1904.92 1978.02,-1899.67 1915.1,-1894.53"/>
<polygon fill="black" stroke="black" points="1915.32,-1891.04 1905.07,-1893.71 1914.75,-1898.02 1915.32,-1891.04"/>
</g>
<!-- route_13_3 -->
<g id="node900" class="node">
<title>route_13_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2324" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2324" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2324" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 422,423</text>
<text text-anchor="middle" x="2324" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2324" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_3 -->
<g id="edge1308" class="edge">
<title>gate_13&#45;&gt;route_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.78,-1981.59C4185.71,-1971.49 3383.24,-1947.95 2704,-1908.44 2639.41,-1904.68 2568.73,-1899.4 2506.03,-1894.31"/>
<polygon fill="black" stroke="black" points="2506.29,-1890.82 2496.04,-1893.49 2505.72,-1897.79 2506.29,-1890.82"/>
</g>
<!-- route_13_4 -->
<g id="node904" class="node">
<title>route_13_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2914" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2914" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2914" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 424,425</text>
<text text-anchor="middle" x="2914" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2914" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_4 -->
<g id="edge1314" class="edge">
<title>gate_13&#45;&gt;route_13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4575.91,-1976.49C4270.88,-1962.9 3744.93,-1937.89 3294,-1908.44 3230.04,-1904.26 3160.08,-1898.93 3097.82,-1893.92"/>
<polygon fill="black" stroke="black" points="3097.74,-1890.41 3087.49,-1893.09 3097.18,-1897.38 3097.74,-1890.41"/>
</g>
<!-- route_13_5 -->
<g id="node908" class="node">
<title>route_13_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3504" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3504" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3504" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 426,427</text>
<text text-anchor="middle" x="3504" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3504" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_5 -->
<g id="edge1320" class="edge">
<title>gate_13&#45;&gt;route_13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560.06,-1965.16C4300.32,-1943.8 3915.23,-1912.14 3688.92,-1893.53"/>
<polygon fill="black" stroke="black" points="3689.18,-1890.04 3678.93,-1892.71 3688.61,-1897.01 3689.18,-1890.04"/>
</g>
<!-- route_13_6 -->
<g id="node912" class="node">
<title>route_13_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4094" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4094" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4094" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 428,429</text>
<text text-anchor="middle" x="4094" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4094" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_6 -->
<g id="edge1326" class="edge">
<title>gate_13&#45;&gt;route_13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4540.51,-1944.43C4439.8,-1929.52 4330.94,-1913.4 4245.92,-1900.81"/>
<polygon fill="black" stroke="black" points="4246.34,-1897.34 4235.93,-1899.34 4245.31,-1904.26 4246.34,-1897.34"/>
</g>
<!-- route_13_7 -->
<g id="node916" class="node">
<title>route_13_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4622" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4622" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4622" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 430,431</text>
<text text-anchor="middle" x="4622" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4622" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_7 -->
<g id="edge1332" class="edge">
<title>gate_13&#45;&gt;route_13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4748.4,-1944.31C4727.91,-1933.62 4706.25,-1922.31 4686.75,-1912.13"/>
<polygon fill="black" stroke="black" points="4688.15,-1908.91 4677.67,-1907.38 4684.91,-1915.11 4688.15,-1908.91"/>
</g>
<!-- route_13_8 -->
<g id="node920" class="node">
<title>route_13_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5042" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5042" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5042" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 432,433</text>
<text text-anchor="middle" x="5042" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5042" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_8 -->
<g id="edge1338" class="edge">
<title>gate_13&#45;&gt;route_13_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4914.39,-1944.31C4935.27,-1933.52 4957.36,-1922.09 4977.18,-1911.84"/>
<polygon fill="black" stroke="black" points="4978.84,-1914.92 4986.12,-1907.22 4975.63,-1908.71 4978.84,-1914.92"/>
</g>
<!-- route_13_9 -->
<g id="node924" class="node">
<title>route_13_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5569" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5569" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5569" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 434,435</text>
<text text-anchor="middle" x="5569" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5569" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_9 -->
<g id="edge1344" class="edge">
<title>gate_13&#45;&gt;route_13_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.8,-1958.34C5149.76,-1940.31 5304.08,-1917.49 5416.69,-1900.84"/>
<polygon fill="black" stroke="black" points="5417.39,-1904.28 5426.77,-1899.35 5416.37,-1897.35 5417.39,-1904.28"/>
</g>
<!-- route_13_10 -->
<g id="node928" class="node">
<title>route_13_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6159" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6159" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6159" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 436,437</text>
<text text-anchor="middle" x="6159" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6159" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_10 -->
<g id="edge1350" class="edge">
<title>gate_13&#45;&gt;route_13_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5044,-1969.94C5301.37,-1948.79 5730.14,-1913.56 5974.18,-1893.51"/>
<polygon fill="black" stroke="black" points="5974.54,-1896.99 5984.22,-1892.68 5973.96,-1890.01 5974.54,-1896.99"/>
</g>
<!-- route_13_11 -->
<g id="node932" class="node">
<title>route_13_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6749" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6749" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6749" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 438,439</text>
<text text-anchor="middle" x="6749" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6749" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_11 -->
<g id="edge1356" class="edge">
<title>gate_13&#45;&gt;route_13_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5054.94,-1977.88C5354.44,-1964.66 5901.94,-1938.93 6369,-1908.44 6432.96,-1904.26 6502.92,-1898.93 6565.18,-1893.92"/>
<polygon fill="black" stroke="black" points="6565.82,-1897.38 6575.51,-1893.09 6565.26,-1890.41 6565.82,-1897.38"/>
</g>
<!-- route_13_12 -->
<g id="node936" class="node">
<title>route_13_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7339" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7339" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7339" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 440,441</text>
<text text-anchor="middle" x="7339" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7339" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_12 -->
<g id="edge1362" class="edge">
<title>gate_13&#45;&gt;route_13_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5060.64,-1982.07C5450.94,-1972.24 6268.6,-1948.59 6959,-1908.44 7023.59,-1904.68 7094.27,-1899.4 7156.97,-1894.31"/>
<polygon fill="black" stroke="black" points="7157.28,-1897.79 7166.96,-1893.49 7156.71,-1890.82 7157.28,-1897.79"/>
</g>
<!-- route_13_13 -->
<g id="node940" class="node">
<title>route_13_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7929" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7929" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7929" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 442,443</text>
<text text-anchor="middle" x="7929" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7929" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_13 -->
<g id="edge1368" class="edge">
<title>gate_13&#45;&gt;route_13_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.3,-1984.58C5534.62,-1977.97 6630.09,-1958.17 7549,-1908.44 7613.92,-1904.92 7684.98,-1899.67 7747.9,-1894.53"/>
<polygon fill="black" stroke="black" points="7748.25,-1898.02 7757.93,-1893.71 7747.68,-1891.04 7748.25,-1898.02"/>
</g>
<!-- route_13_14 -->
<g id="node944" class="node">
<title>route_13_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8519" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8519" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8519" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 444,445</text>
<text text-anchor="middle" x="8519" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8519" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_14 -->
<g id="edge1374" class="edge">
<title>gate_13&#45;&gt;route_13_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5066.56,-1986.27C5608.95,-1982.62 6987.82,-1967.75 8139,-1908.44 8204.09,-1905.08 8275.33,-1899.85 8338.37,-1894.69"/>
<polygon fill="black" stroke="black" points="8338.73,-1898.17 8348.41,-1893.86 8338.16,-1891.19 8338.73,-1898.17"/>
</g>
<!-- route_13_15 -->
<g id="node948" class="node">
<title>route_13_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9109" cy="-1877.32" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9109" y="-1890.12" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9109" y="-1880.12" font-family="Times,serif" font-size="9.00">GPU: 446,447</text>
<text text-anchor="middle" x="9109" y="-1870.12" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9109" y="-1860.12" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_13&#45;&gt;route_13_15 -->
<g id="edge1380" class="edge">
<title>gate_13&#45;&gt;route_13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5068.19,-1987.48C5676.71,-1986.55 7342.91,-1977.34 8729,-1908.44 8794.25,-1905.19 8865.68,-1899.97 8928.83,-1894.78"/>
<polygon fill="black" stroke="black" points="8929.21,-1898.26 8938.89,-1893.95 8928.64,-1891.29 8929.21,-1898.26"/>
</g>
<!-- expert_13_0_0 -->
<g id="node889" class="node">
<title>expert_13_0_0</title>
<polygon fill="lightgreen" stroke="black" points="397.5,-1810.21 120.5,-1810.21 120.5,-1766.21 397.5,-1766.21 397.5,-1810.21"/>
<text text-anchor="middle" x="259" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="259" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 416</text>
<text text-anchor="middle" x="259" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="259" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_0&#45;&gt;expert_13_0_0 -->
<g id="edge1291" class="edge">
<title>route_13_0&#45;&gt;expert_13_0_0</title>
<path fill="none" stroke="black" d="M463.08,-1849.48C423.92,-1837.91 378.49,-1824.49 340.44,-1813.26"/>
<polygon fill="black" stroke="black" points="341.01,-1809.78 330.43,-1810.3 339.03,-1816.49 341.01,-1809.78"/>
</g>
<!-- expert_13_0_1 -->
<g id="node890" class="node">
<title>expert_13_0_1</title>
<polygon fill="lightgreen" stroke="black" points="692.5,-1810.21 415.5,-1810.21 415.5,-1766.21 692.5,-1766.21 692.5,-1810.21"/>
<text text-anchor="middle" x="554" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="554" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 417</text>
<text text-anchor="middle" x="554" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="554" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_0&#45;&gt;expert_13_0_1 -->
<g id="edge1292" class="edge">
<title>route_13_0&#45;&gt;expert_13_0_1</title>
<path fill="none" stroke="black" d="M554,-1845.86C554,-1837.58 554,-1828.6 554,-1820.29"/>
<polygon fill="black" stroke="black" points="557.5,-1820.21 554,-1810.21 550.5,-1820.21 557.5,-1820.21"/>
</g>
<!-- tp_13_0 -->
<g id="node891" class="node">
<title>tp_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="554" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="554" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="554" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 416↔417</text>
<text text-anchor="middle" x="554" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="554" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_0_0&#45;&gt;tp_13_0 -->
<g id="edge1293" class="edge">
<title>expert_13_0_0&#45;&gt;tp_13_0</title>
<path fill="none" stroke="black" d="M330.41,-1766.12C371.87,-1753.88 424.36,-1738.38 468.07,-1725.47"/>
<polygon fill="black" stroke="black" points="469.23,-1728.78 477.83,-1722.59 467.25,-1722.07 469.23,-1728.78"/>
</g>
<!-- expert_13_0_1&#45;&gt;tp_13_0 -->
<g id="edge1294" class="edge">
<title>expert_13_0_1&#45;&gt;tp_13_0</title>
<path fill="none" stroke="black" d="M554,-1766.12C554,-1758.45 554,-1749.5 554,-1740.7"/>
<polygon fill="black" stroke="black" points="557.5,-1740.54 554,-1730.54 550.5,-1740.54 557.5,-1740.54"/>
</g>
<!-- agg_13 -->
<g id="node952" class="node">
<title>agg_13</title>
<polygon fill="lightyellow" stroke="black" points="5112.99,-1631.98 4664.4,-1631.98 4549.01,-1543.98 4997.6,-1543.98 5112.99,-1631.98"/>
<text text-anchor="middle" x="4831" y="-1600.78" font-family="Times,serif" font-size="9.00">Aggregate Experts L13</text>
<text text-anchor="middle" x="4831" y="-1590.78" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-1580.78" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4831" y="-1570.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_13_0&#45;&gt;agg_13 -->
<g id="edge1295" class="edge">
<title>tp_13_0&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M664.79,-1689.55C758.96,-1682.61 897.76,-1673.16 1019,-1667.98 2374.83,-1610.06 4003.8,-1594.25 4598.92,-1590.25"/>
<polygon fill="black" stroke="black" points="4599.36,-1593.74 4609.33,-1590.18 4599.31,-1586.74 4599.36,-1593.74"/>
</g>
<!-- expert_13_1_0 -->
<g id="node893" class="node">
<title>expert_13_1_0</title>
<polygon fill="lightgreen" stroke="black" points="987.5,-1810.21 710.5,-1810.21 710.5,-1766.21 987.5,-1766.21 987.5,-1810.21"/>
<text text-anchor="middle" x="849" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="849" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 418</text>
<text text-anchor="middle" x="849" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="849" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_1&#45;&gt;expert_13_1_0 -->
<g id="edge1297" class="edge">
<title>route_13_1&#45;&gt;expert_13_1_0</title>
<path fill="none" stroke="black" d="M1053.08,-1849.48C1013.92,-1837.91 968.49,-1824.49 930.44,-1813.26"/>
<polygon fill="black" stroke="black" points="931.01,-1809.78 920.43,-1810.3 929.03,-1816.49 931.01,-1809.78"/>
</g>
<!-- expert_13_1_1 -->
<g id="node894" class="node">
<title>expert_13_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1282.5,-1810.21 1005.5,-1810.21 1005.5,-1766.21 1282.5,-1766.21 1282.5,-1810.21"/>
<text text-anchor="middle" x="1144" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1144" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 419</text>
<text text-anchor="middle" x="1144" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1144" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_1&#45;&gt;expert_13_1_1 -->
<g id="edge1298" class="edge">
<title>route_13_1&#45;&gt;expert_13_1_1</title>
<path fill="none" stroke="black" d="M1144,-1845.86C1144,-1837.58 1144,-1828.6 1144,-1820.29"/>
<polygon fill="black" stroke="black" points="1147.5,-1820.21 1144,-1810.21 1140.5,-1820.21 1147.5,-1820.21"/>
</g>
<!-- tp_13_1 -->
<g id="node895" class="node">
<title>tp_13_1</title>
<ellipse fill="lightblue" stroke="black" cx="1144" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1144" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1144" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 418↔419</text>
<text text-anchor="middle" x="1144" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1144" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_1_0&#45;&gt;tp_13_1 -->
<g id="edge1299" class="edge">
<title>expert_13_1_0&#45;&gt;tp_13_1</title>
<path fill="none" stroke="black" d="M920.41,-1766.12C961.87,-1753.88 1014.36,-1738.38 1058.07,-1725.47"/>
<polygon fill="black" stroke="black" points="1059.23,-1728.78 1067.83,-1722.59 1057.25,-1722.07 1059.23,-1728.78"/>
</g>
<!-- expert_13_1_1&#45;&gt;tp_13_1 -->
<g id="edge1300" class="edge">
<title>expert_13_1_1&#45;&gt;tp_13_1</title>
<path fill="none" stroke="black" d="M1144,-1766.12C1144,-1758.45 1144,-1749.5 1144,-1740.7"/>
<polygon fill="black" stroke="black" points="1147.5,-1740.54 1144,-1730.54 1140.5,-1740.54 1147.5,-1740.54"/>
</g>
<!-- tp_13_1&#45;&gt;agg_13 -->
<g id="edge1301" class="edge">
<title>tp_13_1&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1254.8,-1689.67C1348.96,-1682.8 1487.77,-1673.39 1609,-1667.98 2729.94,-1617.97 4071.78,-1597.84 4600.63,-1591.46"/>
<polygon fill="black" stroke="black" points="4600.71,-1594.96 4610.67,-1591.34 4600.63,-1587.96 4600.71,-1594.96"/>
</g>
<!-- expert_13_2_0 -->
<g id="node897" class="node">
<title>expert_13_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1577.5,-1810.21 1300.5,-1810.21 1300.5,-1766.21 1577.5,-1766.21 1577.5,-1810.21"/>
<text text-anchor="middle" x="1439" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1439" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 420</text>
<text text-anchor="middle" x="1439" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1439" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_2&#45;&gt;expert_13_2_0 -->
<g id="edge1303" class="edge">
<title>route_13_2&#45;&gt;expert_13_2_0</title>
<path fill="none" stroke="black" d="M1643.08,-1849.48C1603.92,-1837.91 1558.49,-1824.49 1520.44,-1813.26"/>
<polygon fill="black" stroke="black" points="1521.01,-1809.78 1510.43,-1810.3 1519.03,-1816.49 1521.01,-1809.78"/>
</g>
<!-- expert_13_2_1 -->
<g id="node898" class="node">
<title>expert_13_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1872.5,-1810.21 1595.5,-1810.21 1595.5,-1766.21 1872.5,-1766.21 1872.5,-1810.21"/>
<text text-anchor="middle" x="1734" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1734" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 421</text>
<text text-anchor="middle" x="1734" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1734" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_2&#45;&gt;expert_13_2_1 -->
<g id="edge1304" class="edge">
<title>route_13_2&#45;&gt;expert_13_2_1</title>
<path fill="none" stroke="black" d="M1734,-1845.86C1734,-1837.58 1734,-1828.6 1734,-1820.29"/>
<polygon fill="black" stroke="black" points="1737.5,-1820.21 1734,-1810.21 1730.5,-1820.21 1737.5,-1820.21"/>
</g>
<!-- tp_13_2 -->
<g id="node899" class="node">
<title>tp_13_2</title>
<ellipse fill="lightblue" stroke="black" cx="1734" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1734" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1734" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 420↔421</text>
<text text-anchor="middle" x="1734" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1734" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_2_0&#45;&gt;tp_13_2 -->
<g id="edge1305" class="edge">
<title>expert_13_2_0&#45;&gt;tp_13_2</title>
<path fill="none" stroke="black" d="M1510.41,-1766.12C1551.87,-1753.88 1604.36,-1738.38 1648.07,-1725.47"/>
<polygon fill="black" stroke="black" points="1649.23,-1728.78 1657.83,-1722.59 1647.25,-1722.07 1649.23,-1728.78"/>
</g>
<!-- expert_13_2_1&#45;&gt;tp_13_2 -->
<g id="edge1306" class="edge">
<title>expert_13_2_1&#45;&gt;tp_13_2</title>
<path fill="none" stroke="black" d="M1734,-1766.12C1734,-1758.45 1734,-1749.5 1734,-1740.7"/>
<polygon fill="black" stroke="black" points="1737.5,-1740.54 1734,-1730.54 1730.5,-1740.54 1737.5,-1740.54"/>
</g>
<!-- tp_13_2&#45;&gt;agg_13 -->
<g id="edge1307" class="edge">
<title>tp_13_2&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1844.8,-1689.84C1938.98,-1683.08 2077.79,-1673.73 2199,-1667.98 3087.74,-1625.88 4146.42,-1602.14 4602.95,-1593.17"/>
<polygon fill="black" stroke="black" points="4603.03,-1596.67 4612.96,-1592.97 4602.89,-1589.67 4603.03,-1596.67"/>
</g>
<!-- expert_13_3_0 -->
<g id="node901" class="node">
<title>expert_13_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2167.5,-1810.21 1890.5,-1810.21 1890.5,-1766.21 2167.5,-1766.21 2167.5,-1810.21"/>
<text text-anchor="middle" x="2029" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="2029" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 422</text>
<text text-anchor="middle" x="2029" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2029" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_3&#45;&gt;expert_13_3_0 -->
<g id="edge1309" class="edge">
<title>route_13_3&#45;&gt;expert_13_3_0</title>
<path fill="none" stroke="black" d="M2233.08,-1849.48C2193.92,-1837.91 2148.49,-1824.49 2110.44,-1813.26"/>
<polygon fill="black" stroke="black" points="2111.01,-1809.78 2100.43,-1810.3 2109.03,-1816.49 2111.01,-1809.78"/>
</g>
<!-- expert_13_3_1 -->
<g id="node902" class="node">
<title>expert_13_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2462.5,-1810.21 2185.5,-1810.21 2185.5,-1766.21 2462.5,-1766.21 2462.5,-1810.21"/>
<text text-anchor="middle" x="2324" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2324" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 423</text>
<text text-anchor="middle" x="2324" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2324" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_3&#45;&gt;expert_13_3_1 -->
<g id="edge1310" class="edge">
<title>route_13_3&#45;&gt;expert_13_3_1</title>
<path fill="none" stroke="black" d="M2324,-1845.86C2324,-1837.58 2324,-1828.6 2324,-1820.29"/>
<polygon fill="black" stroke="black" points="2327.5,-1820.21 2324,-1810.21 2320.5,-1820.21 2327.5,-1820.21"/>
</g>
<!-- tp_13_3 -->
<g id="node903" class="node">
<title>tp_13_3</title>
<ellipse fill="lightblue" stroke="black" cx="2324" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2324" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2324" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 422↔423</text>
<text text-anchor="middle" x="2324" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2324" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_3_0&#45;&gt;tp_13_3 -->
<g id="edge1311" class="edge">
<title>expert_13_3_0&#45;&gt;tp_13_3</title>
<path fill="none" stroke="black" d="M2100.41,-1766.12C2141.87,-1753.88 2194.36,-1738.38 2238.07,-1725.47"/>
<polygon fill="black" stroke="black" points="2239.23,-1728.78 2247.83,-1722.59 2237.25,-1722.07 2239.23,-1728.78"/>
</g>
<!-- expert_13_3_1&#45;&gt;tp_13_3 -->
<g id="edge1312" class="edge">
<title>expert_13_3_1&#45;&gt;tp_13_3</title>
<path fill="none" stroke="black" d="M2324,-1766.12C2324,-1758.45 2324,-1749.5 2324,-1740.7"/>
<polygon fill="black" stroke="black" points="2327.5,-1740.54 2324,-1730.54 2320.5,-1740.54 2327.5,-1740.54"/>
</g>
<!-- tp_13_3&#45;&gt;agg_13 -->
<g id="edge1313" class="edge">
<title>tp_13_3&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M2435.29,-1690.08C2529.46,-1683.48 2668.02,-1674.24 2789,-1667.98 3449.08,-1633.85 4229.88,-1607.56 4606.12,-1595.77"/>
<polygon fill="black" stroke="black" points="4606.42,-1599.27 4616.3,-1595.45 4606.2,-1592.27 4606.42,-1599.27"/>
</g>
<!-- expert_13_4_0 -->
<g id="node905" class="node">
<title>expert_13_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2757.5,-1810.21 2480.5,-1810.21 2480.5,-1766.21 2757.5,-1766.21 2757.5,-1810.21"/>
<text text-anchor="middle" x="2619" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2619" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 424</text>
<text text-anchor="middle" x="2619" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2619" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_4&#45;&gt;expert_13_4_0 -->
<g id="edge1315" class="edge">
<title>route_13_4&#45;&gt;expert_13_4_0</title>
<path fill="none" stroke="black" d="M2823.08,-1849.48C2783.92,-1837.91 2738.49,-1824.49 2700.44,-1813.26"/>
<polygon fill="black" stroke="black" points="2701.01,-1809.78 2690.43,-1810.3 2699.03,-1816.49 2701.01,-1809.78"/>
</g>
<!-- expert_13_4_1 -->
<g id="node906" class="node">
<title>expert_13_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3052.5,-1810.21 2775.5,-1810.21 2775.5,-1766.21 3052.5,-1766.21 3052.5,-1810.21"/>
<text text-anchor="middle" x="2914" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2914" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 425</text>
<text text-anchor="middle" x="2914" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2914" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_4&#45;&gt;expert_13_4_1 -->
<g id="edge1316" class="edge">
<title>route_13_4&#45;&gt;expert_13_4_1</title>
<path fill="none" stroke="black" d="M2914,-1845.86C2914,-1837.58 2914,-1828.6 2914,-1820.29"/>
<polygon fill="black" stroke="black" points="2917.5,-1820.21 2914,-1810.21 2910.5,-1820.21 2917.5,-1820.21"/>
</g>
<!-- tp_13_4 -->
<g id="node907" class="node">
<title>tp_13_4</title>
<ellipse fill="lightblue" stroke="black" cx="2914" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2914" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2914" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 424↔425</text>
<text text-anchor="middle" x="2914" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2914" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_4_0&#45;&gt;tp_13_4 -->
<g id="edge1317" class="edge">
<title>expert_13_4_0&#45;&gt;tp_13_4</title>
<path fill="none" stroke="black" d="M2690.41,-1766.12C2731.87,-1753.88 2784.36,-1738.38 2828.07,-1725.47"/>
<polygon fill="black" stroke="black" points="2829.23,-1728.78 2837.83,-1722.59 2827.25,-1722.07 2829.23,-1728.78"/>
</g>
<!-- expert_13_4_1&#45;&gt;tp_13_4 -->
<g id="edge1318" class="edge">
<title>expert_13_4_1&#45;&gt;tp_13_4</title>
<path fill="none" stroke="black" d="M2914,-1766.12C2914,-1758.45 2914,-1749.5 2914,-1740.7"/>
<polygon fill="black" stroke="black" points="2917.5,-1740.54 2914,-1730.54 2910.5,-1740.54 2917.5,-1740.54"/>
</g>
<!-- tp_13_4&#45;&gt;agg_13 -->
<g id="edge1319" class="edge">
<title>tp_13_4&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3025.79,-1690.53C3119.97,-1684.24 3258.27,-1675.18 3379,-1667.98 3816.09,-1641.94 4327.42,-1614.93 4611.75,-1600.21"/>
<polygon fill="black" stroke="black" points="4611.96,-1603.7 4621.77,-1599.69 4611.6,-1596.71 4611.96,-1603.7"/>
</g>
<!-- expert_13_5_0 -->
<g id="node909" class="node">
<title>expert_13_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3347.5,-1810.21 3070.5,-1810.21 3070.5,-1766.21 3347.5,-1766.21 3347.5,-1810.21"/>
<text text-anchor="middle" x="3209" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3209" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 426</text>
<text text-anchor="middle" x="3209" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3209" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_5&#45;&gt;expert_13_5_0 -->
<g id="edge1321" class="edge">
<title>route_13_5&#45;&gt;expert_13_5_0</title>
<path fill="none" stroke="black" d="M3413.08,-1849.48C3373.92,-1837.91 3328.49,-1824.49 3290.44,-1813.26"/>
<polygon fill="black" stroke="black" points="3291.01,-1809.78 3280.43,-1810.3 3289.03,-1816.49 3291.01,-1809.78"/>
</g>
<!-- expert_13_5_1 -->
<g id="node910" class="node">
<title>expert_13_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3642.5,-1810.21 3365.5,-1810.21 3365.5,-1766.21 3642.5,-1766.21 3642.5,-1810.21"/>
<text text-anchor="middle" x="3504" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3504" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 427</text>
<text text-anchor="middle" x="3504" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3504" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_5&#45;&gt;expert_13_5_1 -->
<g id="edge1322" class="edge">
<title>route_13_5&#45;&gt;expert_13_5_1</title>
<path fill="none" stroke="black" d="M3504,-1845.86C3504,-1837.58 3504,-1828.6 3504,-1820.29"/>
<polygon fill="black" stroke="black" points="3507.5,-1820.21 3504,-1810.21 3500.5,-1820.21 3507.5,-1820.21"/>
</g>
<!-- tp_13_5 -->
<g id="node911" class="node">
<title>tp_13_5</title>
<ellipse fill="lightblue" stroke="black" cx="3504" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3504" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3504" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 426↔427</text>
<text text-anchor="middle" x="3504" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3504" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_5_0&#45;&gt;tp_13_5 -->
<g id="edge1323" class="edge">
<title>expert_13_5_0&#45;&gt;tp_13_5</title>
<path fill="none" stroke="black" d="M3280.41,-1766.12C3321.87,-1753.88 3374.36,-1738.38 3418.07,-1725.47"/>
<polygon fill="black" stroke="black" points="3419.23,-1728.78 3427.83,-1722.59 3417.25,-1722.07 3419.23,-1728.78"/>
</g>
<!-- expert_13_5_1&#45;&gt;tp_13_5 -->
<g id="edge1324" class="edge">
<title>expert_13_5_1&#45;&gt;tp_13_5</title>
<path fill="none" stroke="black" d="M3504,-1766.12C3504,-1758.45 3504,-1749.5 3504,-1740.7"/>
<polygon fill="black" stroke="black" points="3507.5,-1740.54 3504,-1730.54 3500.5,-1740.54 3507.5,-1740.54"/>
</g>
<!-- tp_13_5&#45;&gt;agg_13 -->
<g id="edge1325" class="edge">
<title>tp_13_5&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3614.01,-1689.05C3834.49,-1670.92 4333.79,-1629.87 4619.61,-1606.37"/>
<polygon fill="black" stroke="black" points="4620.01,-1609.85 4629.69,-1605.54 4619.44,-1602.87 4620.01,-1609.85"/>
</g>
<!-- expert_13_6_0 -->
<g id="node913" class="node">
<title>expert_13_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3937.5,-1810.21 3660.5,-1810.21 3660.5,-1766.21 3937.5,-1766.21 3937.5,-1810.21"/>
<text text-anchor="middle" x="3799" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3799" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 428</text>
<text text-anchor="middle" x="3799" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3799" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_6&#45;&gt;expert_13_6_0 -->
<g id="edge1327" class="edge">
<title>route_13_6&#45;&gt;expert_13_6_0</title>
<path fill="none" stroke="black" d="M4003.08,-1849.48C3963.92,-1837.91 3918.49,-1824.49 3880.44,-1813.26"/>
<polygon fill="black" stroke="black" points="3881.01,-1809.78 3870.43,-1810.3 3879.03,-1816.49 3881.01,-1809.78"/>
</g>
<!-- expert_13_6_1 -->
<g id="node914" class="node">
<title>expert_13_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4232.5,-1810.21 3955.5,-1810.21 3955.5,-1766.21 4232.5,-1766.21 4232.5,-1810.21"/>
<text text-anchor="middle" x="4094" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4094" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 429</text>
<text text-anchor="middle" x="4094" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4094" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_6&#45;&gt;expert_13_6_1 -->
<g id="edge1328" class="edge">
<title>route_13_6&#45;&gt;expert_13_6_1</title>
<path fill="none" stroke="black" d="M4094,-1845.86C4094,-1837.58 4094,-1828.6 4094,-1820.29"/>
<polygon fill="black" stroke="black" points="4097.5,-1820.21 4094,-1810.21 4090.5,-1820.21 4097.5,-1820.21"/>
</g>
<!-- tp_13_6 -->
<g id="node915" class="node">
<title>tp_13_6</title>
<ellipse fill="lightblue" stroke="black" cx="4094" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4094" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4094" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 428↔429</text>
<text text-anchor="middle" x="4094" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4094" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_6_0&#45;&gt;tp_13_6 -->
<g id="edge1329" class="edge">
<title>expert_13_6_0&#45;&gt;tp_13_6</title>
<path fill="none" stroke="black" d="M3870.41,-1766.12C3911.87,-1753.88 3964.36,-1738.38 4008.07,-1725.47"/>
<polygon fill="black" stroke="black" points="4009.23,-1728.78 4017.83,-1722.59 4007.25,-1722.07 4009.23,-1728.78"/>
</g>
<!-- expert_13_6_1&#45;&gt;tp_13_6 -->
<g id="edge1330" class="edge">
<title>expert_13_6_1&#45;&gt;tp_13_6</title>
<path fill="none" stroke="black" d="M4094,-1766.12C4094,-1758.45 4094,-1749.5 4094,-1740.7"/>
<polygon fill="black" stroke="black" points="4097.5,-1740.54 4094,-1730.54 4090.5,-1740.54 4097.5,-1740.54"/>
</g>
<!-- tp_13_6&#45;&gt;agg_13 -->
<g id="edge1331" class="edge">
<title>tp_13_6&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M4194.16,-1683.27C4306.68,-1666.61 4492.1,-1639.16 4633.93,-1618.16"/>
<polygon fill="black" stroke="black" points="4634.68,-1621.59 4644.06,-1616.66 4633.66,-1614.66 4634.68,-1621.59"/>
</g>
<!-- expert_13_7_0 -->
<g id="node917" class="node">
<title>expert_13_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4527.5,-1810.21 4250.5,-1810.21 4250.5,-1766.21 4527.5,-1766.21 4527.5,-1810.21"/>
<text text-anchor="middle" x="4389" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4389" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 430</text>
<text text-anchor="middle" x="4389" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4389" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_7&#45;&gt;expert_13_7_0 -->
<g id="edge1333" class="edge">
<title>route_13_7&#45;&gt;expert_13_7_0</title>
<path fill="none" stroke="black" d="M4547.32,-1848.4C4517.66,-1837.31 4483.83,-1824.66 4455.08,-1813.92"/>
<polygon fill="black" stroke="black" points="4456.13,-1810.57 4445.54,-1810.35 4453.68,-1817.13 4456.13,-1810.57"/>
</g>
<!-- expert_13_7_1 -->
<g id="node918" class="node">
<title>expert_13_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4822.5,-1810.21 4545.5,-1810.21 4545.5,-1766.21 4822.5,-1766.21 4822.5,-1810.21"/>
<text text-anchor="middle" x="4684" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4684" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 431</text>
<text text-anchor="middle" x="4684" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4684" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_7&#45;&gt;expert_13_7_1 -->
<g id="edge1334" class="edge">
<title>route_13_7&#45;&gt;expert_13_7_1</title>
<path fill="none" stroke="black" d="M4643.34,-1846.34C4649.71,-1837.39 4656.68,-1827.59 4663.03,-1818.67"/>
<polygon fill="black" stroke="black" points="4665.94,-1820.63 4668.88,-1810.45 4660.23,-1816.57 4665.94,-1820.63"/>
</g>
<!-- tp_13_7 -->
<g id="node919" class="node">
<title>tp_13_7</title>
<ellipse fill="lightblue" stroke="black" cx="4684" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4684" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4684" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 430↔431</text>
<text text-anchor="middle" x="4684" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4684" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_7_0&#45;&gt;tp_13_7 -->
<g id="edge1335" class="edge">
<title>expert_13_7_0&#45;&gt;tp_13_7</title>
<path fill="none" stroke="black" d="M4460.41,-1766.12C4501.87,-1753.88 4554.36,-1738.38 4598.07,-1725.47"/>
<polygon fill="black" stroke="black" points="4599.23,-1728.78 4607.83,-1722.59 4597.25,-1722.07 4599.23,-1728.78"/>
</g>
<!-- expert_13_7_1&#45;&gt;tp_13_7 -->
<g id="edge1336" class="edge">
<title>expert_13_7_1&#45;&gt;tp_13_7</title>
<path fill="none" stroke="black" d="M4684,-1766.12C4684,-1758.45 4684,-1749.5 4684,-1740.7"/>
<polygon fill="black" stroke="black" points="4687.5,-1740.54 4684,-1730.54 4680.5,-1740.54 4687.5,-1740.54"/>
</g>
<!-- tp_13_7&#45;&gt;agg_13 -->
<g id="edge1337" class="edge">
<title>tp_13_7&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M4722.24,-1669.71C4735.3,-1660.02 4750.31,-1648.88 4764.93,-1638.03"/>
<polygon fill="black" stroke="black" points="4767.05,-1640.81 4772.99,-1632.04 4762.88,-1635.19 4767.05,-1640.81"/>
</g>
<!-- expert_13_8_0 -->
<g id="node921" class="node">
<title>expert_13_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5117.5,-1810.21 4840.5,-1810.21 4840.5,-1766.21 5117.5,-1766.21 5117.5,-1810.21"/>
<text text-anchor="middle" x="4979" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4979" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 432</text>
<text text-anchor="middle" x="4979" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4979" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_8&#45;&gt;expert_13_8_0 -->
<g id="edge1339" class="edge">
<title>route_13_8&#45;&gt;expert_13_8_0</title>
<path fill="none" stroke="black" d="M5020.32,-1846.34C5013.85,-1837.39 5006.76,-1827.59 5000.31,-1818.67"/>
<polygon fill="black" stroke="black" points="5003.06,-1816.5 4994.36,-1810.45 4997.39,-1820.6 5003.06,-1816.5"/>
</g>
<!-- expert_13_8_1 -->
<g id="node922" class="node">
<title>expert_13_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5412.5,-1810.21 5135.5,-1810.21 5135.5,-1766.21 5412.5,-1766.21 5412.5,-1810.21"/>
<text text-anchor="middle" x="5274" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5274" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 433</text>
<text text-anchor="middle" x="5274" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5274" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_8&#45;&gt;expert_13_8_1 -->
<g id="edge1340" class="edge">
<title>route_13_8&#45;&gt;expert_13_8_1</title>
<path fill="none" stroke="black" d="M5116.36,-1848.4C5145.89,-1837.31 5179.58,-1824.66 5208.2,-1813.92"/>
<polygon fill="black" stroke="black" points="5209.57,-1817.14 5217.71,-1810.35 5207.11,-1810.59 5209.57,-1817.14"/>
</g>
<!-- tp_13_8 -->
<g id="node923" class="node">
<title>tp_13_8</title>
<ellipse fill="lightblue" stroke="black" cx="4979" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4979" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4979" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 432↔433</text>
<text text-anchor="middle" x="4979" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4979" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_8_0&#45;&gt;tp_13_8 -->
<g id="edge1341" class="edge">
<title>expert_13_8_0&#45;&gt;tp_13_8</title>
<path fill="none" stroke="black" d="M4979,-1766.12C4979,-1758.45 4979,-1749.5 4979,-1740.7"/>
<polygon fill="black" stroke="black" points="4982.5,-1740.54 4979,-1730.54 4975.5,-1740.54 4982.5,-1740.54"/>
</g>
<!-- expert_13_8_1&#45;&gt;tp_13_8 -->
<g id="edge1342" class="edge">
<title>expert_13_8_1&#45;&gt;tp_13_8</title>
<path fill="none" stroke="black" d="M5202.59,-1766.12C5161.13,-1753.88 5108.64,-1738.38 5064.93,-1725.47"/>
<polygon fill="black" stroke="black" points="5065.75,-1722.07 5055.17,-1722.59 5063.77,-1728.78 5065.75,-1722.07"/>
</g>
<!-- tp_13_8&#45;&gt;agg_13 -->
<g id="edge1343" class="edge">
<title>tp_13_8&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M4940.5,-1669.71C4927.35,-1660.02 4912.24,-1648.88 4897.52,-1638.03"/>
<polygon fill="black" stroke="black" points="4899.53,-1635.16 4889.4,-1632.04 4895.37,-1640.79 4899.53,-1635.16"/>
</g>
<!-- expert_13_9_0 -->
<g id="node925" class="node">
<title>expert_13_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5707.5,-1810.21 5430.5,-1810.21 5430.5,-1766.21 5707.5,-1766.21 5707.5,-1810.21"/>
<text text-anchor="middle" x="5569" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5569" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 434</text>
<text text-anchor="middle" x="5569" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5569" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_9&#45;&gt;expert_13_9_0 -->
<g id="edge1345" class="edge">
<title>route_13_9&#45;&gt;expert_13_9_0</title>
<path fill="none" stroke="black" d="M5569,-1845.86C5569,-1837.58 5569,-1828.6 5569,-1820.29"/>
<polygon fill="black" stroke="black" points="5572.5,-1820.21 5569,-1810.21 5565.5,-1820.21 5572.5,-1820.21"/>
</g>
<!-- expert_13_9_1 -->
<g id="node926" class="node">
<title>expert_13_9_1</title>
<polygon fill="lightgreen" stroke="black" points="6002.5,-1810.21 5725.5,-1810.21 5725.5,-1766.21 6002.5,-1766.21 6002.5,-1810.21"/>
<text text-anchor="middle" x="5864" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5864" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 435</text>
<text text-anchor="middle" x="5864" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5864" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_9&#45;&gt;expert_13_9_1 -->
<g id="edge1346" class="edge">
<title>route_13_9&#45;&gt;expert_13_9_1</title>
<path fill="none" stroke="black" d="M5659.92,-1849.48C5699.08,-1837.91 5744.51,-1824.49 5782.56,-1813.26"/>
<polygon fill="black" stroke="black" points="5783.97,-1816.49 5792.57,-1810.3 5781.99,-1809.78 5783.97,-1816.49"/>
</g>
<!-- tp_13_9 -->
<g id="node927" class="node">
<title>tp_13_9</title>
<ellipse fill="lightblue" stroke="black" cx="5569" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5569" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5569" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 434↔435</text>
<text text-anchor="middle" x="5569" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5569" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_9_0&#45;&gt;tp_13_9 -->
<g id="edge1347" class="edge">
<title>expert_13_9_0&#45;&gt;tp_13_9</title>
<path fill="none" stroke="black" d="M5569,-1766.12C5569,-1758.45 5569,-1749.5 5569,-1740.7"/>
<polygon fill="black" stroke="black" points="5572.5,-1740.54 5569,-1730.54 5565.5,-1740.54 5572.5,-1740.54"/>
</g>
<!-- expert_13_9_1&#45;&gt;tp_13_9 -->
<g id="edge1348" class="edge">
<title>expert_13_9_1&#45;&gt;tp_13_9</title>
<path fill="none" stroke="black" d="M5792.59,-1766.12C5751.13,-1753.88 5698.64,-1738.38 5654.93,-1725.47"/>
<polygon fill="black" stroke="black" points="5655.75,-1722.07 5645.17,-1722.59 5653.77,-1728.78 5655.75,-1722.07"/>
</g>
<!-- tp_13_9&#45;&gt;agg_13 -->
<g id="edge1349" class="edge">
<title>tp_13_9&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M5468.7,-1683.27C5379.3,-1670.05 5243.93,-1650.04 5120.87,-1631.84"/>
<polygon fill="black" stroke="black" points="5121.31,-1628.37 5110.9,-1630.37 5120.28,-1635.29 5121.31,-1628.37"/>
</g>
<!-- expert_13_10_0 -->
<g id="node929" class="node">
<title>expert_13_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6297.5,-1810.21 6020.5,-1810.21 6020.5,-1766.21 6297.5,-1766.21 6297.5,-1810.21"/>
<text text-anchor="middle" x="6159" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6159" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 436</text>
<text text-anchor="middle" x="6159" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6159" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_10&#45;&gt;expert_13_10_0 -->
<g id="edge1351" class="edge">
<title>route_13_10&#45;&gt;expert_13_10_0</title>
<path fill="none" stroke="black" d="M6159,-1845.86C6159,-1837.58 6159,-1828.6 6159,-1820.29"/>
<polygon fill="black" stroke="black" points="6162.5,-1820.21 6159,-1810.21 6155.5,-1820.21 6162.5,-1820.21"/>
</g>
<!-- expert_13_10_1 -->
<g id="node930" class="node">
<title>expert_13_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6592.5,-1810.21 6315.5,-1810.21 6315.5,-1766.21 6592.5,-1766.21 6592.5,-1810.21"/>
<text text-anchor="middle" x="6454" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6454" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 437</text>
<text text-anchor="middle" x="6454" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6454" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_10&#45;&gt;expert_13_10_1 -->
<g id="edge1352" class="edge">
<title>route_13_10&#45;&gt;expert_13_10_1</title>
<path fill="none" stroke="black" d="M6249.92,-1849.48C6289.08,-1837.91 6334.51,-1824.49 6372.56,-1813.26"/>
<polygon fill="black" stroke="black" points="6373.97,-1816.49 6382.57,-1810.3 6371.99,-1809.78 6373.97,-1816.49"/>
</g>
<!-- tp_13_10 -->
<g id="node931" class="node">
<title>tp_13_10</title>
<ellipse fill="lightblue" stroke="black" cx="6159" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6159" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6159" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 436↔437</text>
<text text-anchor="middle" x="6159" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6159" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_10_0&#45;&gt;tp_13_10 -->
<g id="edge1353" class="edge">
<title>expert_13_10_0&#45;&gt;tp_13_10</title>
<path fill="none" stroke="black" d="M6159,-1766.12C6159,-1758.45 6159,-1749.5 6159,-1740.7"/>
<polygon fill="black" stroke="black" points="6162.5,-1740.54 6159,-1730.54 6155.5,-1740.54 6162.5,-1740.54"/>
</g>
<!-- expert_13_10_1&#45;&gt;tp_13_10 -->
<g id="edge1354" class="edge">
<title>expert_13_10_1&#45;&gt;tp_13_10</title>
<path fill="none" stroke="black" d="M6382.59,-1766.12C6341.13,-1753.88 6288.64,-1738.38 6244.93,-1725.47"/>
<polygon fill="black" stroke="black" points="6245.75,-1722.07 6235.17,-1722.59 6243.77,-1728.78 6245.75,-1722.07"/>
</g>
<!-- tp_13_10&#45;&gt;agg_13 -->
<g id="edge1355" class="edge">
<title>tp_13_10&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M6049.19,-1689.08C5841.46,-1672.01 5385.69,-1634.56 5094.33,-1610.62"/>
<polygon fill="black" stroke="black" points="5094.29,-1607.11 5084.03,-1609.77 5093.71,-1614.08 5094.29,-1607.11"/>
</g>
<!-- expert_13_11_0 -->
<g id="node933" class="node">
<title>expert_13_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6887.5,-1810.21 6610.5,-1810.21 6610.5,-1766.21 6887.5,-1766.21 6887.5,-1810.21"/>
<text text-anchor="middle" x="6749" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6749" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 438</text>
<text text-anchor="middle" x="6749" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6749" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_11&#45;&gt;expert_13_11_0 -->
<g id="edge1357" class="edge">
<title>route_13_11&#45;&gt;expert_13_11_0</title>
<path fill="none" stroke="black" d="M6749,-1845.86C6749,-1837.58 6749,-1828.6 6749,-1820.29"/>
<polygon fill="black" stroke="black" points="6752.5,-1820.21 6749,-1810.21 6745.5,-1820.21 6752.5,-1820.21"/>
</g>
<!-- expert_13_11_1 -->
<g id="node934" class="node">
<title>expert_13_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7182.5,-1810.21 6905.5,-1810.21 6905.5,-1766.21 7182.5,-1766.21 7182.5,-1810.21"/>
<text text-anchor="middle" x="7044" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7044" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 439</text>
<text text-anchor="middle" x="7044" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7044" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_11&#45;&gt;expert_13_11_1 -->
<g id="edge1358" class="edge">
<title>route_13_11&#45;&gt;expert_13_11_1</title>
<path fill="none" stroke="black" d="M6839.92,-1849.48C6879.08,-1837.91 6924.51,-1824.49 6962.56,-1813.26"/>
<polygon fill="black" stroke="black" points="6963.97,-1816.49 6972.57,-1810.3 6961.99,-1809.78 6963.97,-1816.49"/>
</g>
<!-- tp_13_11 -->
<g id="node935" class="node">
<title>tp_13_11</title>
<ellipse fill="lightblue" stroke="black" cx="6749" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6749" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6749" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 438↔439</text>
<text text-anchor="middle" x="6749" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6749" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_11_0&#45;&gt;tp_13_11 -->
<g id="edge1359" class="edge">
<title>expert_13_11_0&#45;&gt;tp_13_11</title>
<path fill="none" stroke="black" d="M6749,-1766.12C6749,-1758.45 6749,-1749.5 6749,-1740.7"/>
<polygon fill="black" stroke="black" points="6752.5,-1740.54 6749,-1730.54 6745.5,-1740.54 6752.5,-1740.54"/>
</g>
<!-- expert_13_11_1&#45;&gt;tp_13_11 -->
<g id="edge1360" class="edge">
<title>expert_13_11_1&#45;&gt;tp_13_11</title>
<path fill="none" stroke="black" d="M6972.59,-1766.12C6931.13,-1753.88 6878.64,-1738.38 6834.93,-1725.47"/>
<polygon fill="black" stroke="black" points="6835.75,-1722.07 6825.17,-1722.59 6833.77,-1728.78 6835.75,-1722.07"/>
</g>
<!-- tp_13_11&#45;&gt;agg_13 -->
<g id="edge1361" class="edge">
<title>tp_13_11&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M6637.21,-1690.53C6543.03,-1684.24 6404.73,-1675.18 6284,-1667.98 5862.96,-1642.91 5373.09,-1616.94 5083.26,-1601.91"/>
<polygon fill="black" stroke="black" points="5083.2,-1598.4 5073.03,-1601.38 5082.84,-1605.39 5083.2,-1598.4"/>
</g>
<!-- expert_13_12_0 -->
<g id="node937" class="node">
<title>expert_13_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7477.5,-1810.21 7200.5,-1810.21 7200.5,-1766.21 7477.5,-1766.21 7477.5,-1810.21"/>
<text text-anchor="middle" x="7339" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7339" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 440</text>
<text text-anchor="middle" x="7339" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7339" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_12&#45;&gt;expert_13_12_0 -->
<g id="edge1363" class="edge">
<title>route_13_12&#45;&gt;expert_13_12_0</title>
<path fill="none" stroke="black" d="M7339,-1845.86C7339,-1837.58 7339,-1828.6 7339,-1820.29"/>
<polygon fill="black" stroke="black" points="7342.5,-1820.21 7339,-1810.21 7335.5,-1820.21 7342.5,-1820.21"/>
</g>
<!-- expert_13_12_1 -->
<g id="node938" class="node">
<title>expert_13_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7772.5,-1810.21 7495.5,-1810.21 7495.5,-1766.21 7772.5,-1766.21 7772.5,-1810.21"/>
<text text-anchor="middle" x="7634" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7634" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 441</text>
<text text-anchor="middle" x="7634" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7634" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_12&#45;&gt;expert_13_12_1 -->
<g id="edge1364" class="edge">
<title>route_13_12&#45;&gt;expert_13_12_1</title>
<path fill="none" stroke="black" d="M7429.92,-1849.48C7469.08,-1837.91 7514.51,-1824.49 7552.56,-1813.26"/>
<polygon fill="black" stroke="black" points="7553.97,-1816.49 7562.57,-1810.3 7551.99,-1809.78 7553.97,-1816.49"/>
</g>
<!-- tp_13_12 -->
<g id="node939" class="node">
<title>tp_13_12</title>
<ellipse fill="lightblue" stroke="black" cx="7339" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7339" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7339" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 440↔441</text>
<text text-anchor="middle" x="7339" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7339" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_12_0&#45;&gt;tp_13_12 -->
<g id="edge1365" class="edge">
<title>expert_13_12_0&#45;&gt;tp_13_12</title>
<path fill="none" stroke="black" d="M7339,-1766.12C7339,-1758.45 7339,-1749.5 7339,-1740.7"/>
<polygon fill="black" stroke="black" points="7342.5,-1740.54 7339,-1730.54 7335.5,-1740.54 7342.5,-1740.54"/>
</g>
<!-- expert_13_12_1&#45;&gt;tp_13_12 -->
<g id="edge1366" class="edge">
<title>expert_13_12_1&#45;&gt;tp_13_12</title>
<path fill="none" stroke="black" d="M7562.59,-1766.12C7521.13,-1753.88 7468.64,-1738.38 7424.93,-1725.47"/>
<polygon fill="black" stroke="black" points="7425.75,-1722.07 7415.17,-1722.59 7423.77,-1728.78 7425.75,-1722.07"/>
</g>
<!-- tp_13_12&#45;&gt;agg_13 -->
<g id="edge1367" class="edge">
<title>tp_13_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M7227.71,-1690.07C7133.54,-1683.48 6994.98,-1674.24 6874,-1667.98 6225.3,-1634.44 5460.04,-1608.49 5076.37,-1596.41"/>
<polygon fill="black" stroke="black" points="5076.36,-1592.91 5066.26,-1596.09 5076.14,-1599.9 5076.36,-1592.91"/>
</g>
<!-- expert_13_13_0 -->
<g id="node941" class="node">
<title>expert_13_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8067.5,-1810.21 7790.5,-1810.21 7790.5,-1766.21 8067.5,-1766.21 8067.5,-1810.21"/>
<text text-anchor="middle" x="7929" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7929" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 442</text>
<text text-anchor="middle" x="7929" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7929" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_13&#45;&gt;expert_13_13_0 -->
<g id="edge1369" class="edge">
<title>route_13_13&#45;&gt;expert_13_13_0</title>
<path fill="none" stroke="black" d="M7929,-1845.86C7929,-1837.58 7929,-1828.6 7929,-1820.29"/>
<polygon fill="black" stroke="black" points="7932.5,-1820.21 7929,-1810.21 7925.5,-1820.21 7932.5,-1820.21"/>
</g>
<!-- expert_13_13_1 -->
<g id="node942" class="node">
<title>expert_13_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8362.5,-1810.21 8085.5,-1810.21 8085.5,-1766.21 8362.5,-1766.21 8362.5,-1810.21"/>
<text text-anchor="middle" x="8224" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8224" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 443</text>
<text text-anchor="middle" x="8224" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8224" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_13&#45;&gt;expert_13_13_1 -->
<g id="edge1370" class="edge">
<title>route_13_13&#45;&gt;expert_13_13_1</title>
<path fill="none" stroke="black" d="M8019.92,-1849.48C8059.08,-1837.91 8104.51,-1824.49 8142.56,-1813.26"/>
<polygon fill="black" stroke="black" points="8143.97,-1816.49 8152.57,-1810.3 8141.99,-1809.78 8143.97,-1816.49"/>
</g>
<!-- tp_13_13 -->
<g id="node943" class="node">
<title>tp_13_13</title>
<ellipse fill="lightblue" stroke="black" cx="7929" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7929" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7929" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 442↔443</text>
<text text-anchor="middle" x="7929" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7929" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_13_0&#45;&gt;tp_13_13 -->
<g id="edge1371" class="edge">
<title>expert_13_13_0&#45;&gt;tp_13_13</title>
<path fill="none" stroke="black" d="M7929,-1766.12C7929,-1758.45 7929,-1749.5 7929,-1740.7"/>
<polygon fill="black" stroke="black" points="7932.5,-1740.54 7929,-1730.54 7925.5,-1740.54 7932.5,-1740.54"/>
</g>
<!-- expert_13_13_1&#45;&gt;tp_13_13 -->
<g id="edge1372" class="edge">
<title>expert_13_13_1&#45;&gt;tp_13_13</title>
<path fill="none" stroke="black" d="M8152.59,-1766.12C8111.13,-1753.88 8058.64,-1738.38 8014.93,-1725.47"/>
<polygon fill="black" stroke="black" points="8015.75,-1722.07 8005.17,-1722.59 8013.77,-1728.78 8015.75,-1722.07"/>
</g>
<!-- tp_13_13&#45;&gt;agg_13 -->
<g id="edge1373" class="edge">
<title>tp_13_13&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M7818.2,-1689.84C7724.02,-1683.08 7585.21,-1673.73 7464,-1667.98 6583.43,-1626.27 5536.09,-1602.59 5072.4,-1593.43"/>
<polygon fill="black" stroke="black" points="5072.3,-1589.93 5062.24,-1593.23 5072.17,-1596.93 5072.3,-1589.93"/>
</g>
<!-- expert_13_14_0 -->
<g id="node945" class="node">
<title>expert_13_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8657.5,-1810.21 8380.5,-1810.21 8380.5,-1766.21 8657.5,-1766.21 8657.5,-1810.21"/>
<text text-anchor="middle" x="8519" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8519" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 444</text>
<text text-anchor="middle" x="8519" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8519" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_14&#45;&gt;expert_13_14_0 -->
<g id="edge1375" class="edge">
<title>route_13_14&#45;&gt;expert_13_14_0</title>
<path fill="none" stroke="black" d="M8519,-1845.86C8519,-1837.58 8519,-1828.6 8519,-1820.29"/>
<polygon fill="black" stroke="black" points="8522.5,-1820.21 8519,-1810.21 8515.5,-1820.21 8522.5,-1820.21"/>
</g>
<!-- expert_13_14_1 -->
<g id="node946" class="node">
<title>expert_13_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8952.5,-1810.21 8675.5,-1810.21 8675.5,-1766.21 8952.5,-1766.21 8952.5,-1810.21"/>
<text text-anchor="middle" x="8814" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8814" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 445</text>
<text text-anchor="middle" x="8814" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8814" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_14&#45;&gt;expert_13_14_1 -->
<g id="edge1376" class="edge">
<title>route_13_14&#45;&gt;expert_13_14_1</title>
<path fill="none" stroke="black" d="M8609.92,-1849.48C8649.08,-1837.91 8694.51,-1824.49 8732.56,-1813.26"/>
<polygon fill="black" stroke="black" points="8733.97,-1816.49 8742.57,-1810.3 8731.99,-1809.78 8733.97,-1816.49"/>
</g>
<!-- tp_13_14 -->
<g id="node947" class="node">
<title>tp_13_14</title>
<ellipse fill="lightblue" stroke="black" cx="8519" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8519" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8519" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 444↔445</text>
<text text-anchor="middle" x="8519" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8519" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_14_0&#45;&gt;tp_13_14 -->
<g id="edge1377" class="edge">
<title>expert_13_14_0&#45;&gt;tp_13_14</title>
<path fill="none" stroke="black" d="M8519,-1766.12C8519,-1758.45 8519,-1749.5 8519,-1740.7"/>
<polygon fill="black" stroke="black" points="8522.5,-1740.54 8519,-1730.54 8515.5,-1740.54 8522.5,-1740.54"/>
</g>
<!-- expert_13_14_1&#45;&gt;tp_13_14 -->
<g id="edge1378" class="edge">
<title>expert_13_14_1&#45;&gt;tp_13_14</title>
<path fill="none" stroke="black" d="M8742.59,-1766.12C8701.13,-1753.88 8648.64,-1738.38 8604.93,-1725.47"/>
<polygon fill="black" stroke="black" points="8605.75,-1722.07 8595.17,-1722.59 8603.77,-1728.78 8605.75,-1722.07"/>
</g>
<!-- tp_13_14&#45;&gt;agg_13 -->
<g id="edge1379" class="edge">
<title>tp_13_14&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M8408.2,-1689.67C8314.04,-1682.8 8175.23,-1673.39 8054,-1667.98 6938.96,-1618.24 5605.42,-1598.06 5070.36,-1591.57"/>
<polygon fill="black" stroke="black" points="5070.25,-1588.06 5060.21,-1591.44 5070.16,-1595.06 5070.25,-1588.06"/>
</g>
<!-- expert_13_15_0 -->
<g id="node949" class="node">
<title>expert_13_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9247.5,-1810.21 8970.5,-1810.21 8970.5,-1766.21 9247.5,-1766.21 9247.5,-1810.21"/>
<text text-anchor="middle" x="9109" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9109" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 446</text>
<text text-anchor="middle" x="9109" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9109" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_15&#45;&gt;expert_13_15_0 -->
<g id="edge1381" class="edge">
<title>route_13_15&#45;&gt;expert_13_15_0</title>
<path fill="none" stroke="black" d="M9109,-1845.86C9109,-1837.58 9109,-1828.6 9109,-1820.29"/>
<polygon fill="black" stroke="black" points="9112.5,-1820.21 9109,-1810.21 9105.5,-1820.21 9112.5,-1820.21"/>
</g>
<!-- expert_13_15_1 -->
<g id="node950" class="node">
<title>expert_13_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9542.5,-1810.21 9265.5,-1810.21 9265.5,-1766.21 9542.5,-1766.21 9542.5,-1810.21"/>
<text text-anchor="middle" x="9404" y="-1801.01" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9404" y="-1791.01" font-family="Times,serif" font-size="9.00">GPU: 447</text>
<text text-anchor="middle" x="9404" y="-1781.01" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9404" y="-1771.01" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_13_15&#45;&gt;expert_13_15_1 -->
<g id="edge1382" class="edge">
<title>route_13_15&#45;&gt;expert_13_15_1</title>
<path fill="none" stroke="black" d="M9199.92,-1849.48C9239.08,-1837.91 9284.51,-1824.49 9322.56,-1813.26"/>
<polygon fill="black" stroke="black" points="9323.97,-1816.49 9332.57,-1810.3 9321.99,-1809.78 9323.97,-1816.49"/>
</g>
<!-- tp_13_15 -->
<g id="node951" class="node">
<title>tp_13_15</title>
<ellipse fill="lightblue" stroke="black" cx="9109" cy="-1699.1" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9109" y="-1711.9" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9109" y="-1701.9" font-family="Times,serif" font-size="9.00">GPU: 446↔447</text>
<text text-anchor="middle" x="9109" y="-1691.9" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9109" y="-1681.9" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_13_15_0&#45;&gt;tp_13_15 -->
<g id="edge1383" class="edge">
<title>expert_13_15_0&#45;&gt;tp_13_15</title>
<path fill="none" stroke="black" d="M9109,-1766.12C9109,-1758.45 9109,-1749.5 9109,-1740.7"/>
<polygon fill="black" stroke="black" points="9112.5,-1740.54 9109,-1730.54 9105.5,-1740.54 9112.5,-1740.54"/>
</g>
<!-- expert_13_15_1&#45;&gt;tp_13_15 -->
<g id="edge1384" class="edge">
<title>expert_13_15_1&#45;&gt;tp_13_15</title>
<path fill="none" stroke="black" d="M9332.59,-1766.12C9291.13,-1753.88 9238.64,-1738.38 9194.93,-1725.47"/>
<polygon fill="black" stroke="black" points="9195.75,-1722.07 9185.17,-1722.59 9193.77,-1728.78 9195.75,-1722.07"/>
</g>
<!-- tp_13_15&#45;&gt;agg_13 -->
<g id="edge1385" class="edge">
<title>tp_13_15&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M8998.21,-1689.55C8904.04,-1682.61 8765.24,-1673.16 8644,-1667.98 7291.8,-1610.22 5667.99,-1594.34 5068.41,-1590.28"/>
<polygon fill="black" stroke="black" points="5068.38,-1586.78 5058.35,-1590.21 5068.33,-1593.78 5068.38,-1586.78"/>
</g>
<!-- output_13 -->
<g id="node953" class="node">
<title>output_13</title>
<polygon fill="lightgreen" stroke="black" points="4979,-1507.98 4683,-1507.98 4683,-1463.98 4979,-1463.98 4979,-1507.98"/>
<text text-anchor="middle" x="4831" y="-1498.78" font-family="Times,serif" font-size="9.00">Layer 13 Output</text>
<text text-anchor="middle" x="4831" y="-1488.78" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-1478.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4831" y="-1468.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_13&#45;&gt;output_13 -->
<g id="edge1386" class="edge">
<title>agg_13&#45;&gt;output_13</title>
<path fill="none" stroke="black" d="M4831,-1543.7C4831,-1535.12 4831,-1526.26 4831,-1518.17"/>
<polygon fill="black" stroke="black" points="4834.5,-1518.07 4831,-1508.07 4827.5,-1518.07 4834.5,-1518.07"/>
</g>
<!-- mha_14 -->
<g id="node954" class="node">
<title>mha_14</title>
<polygon fill="lightgreen" stroke="black" points="4979,-1416.98 4683,-1416.98 4683,-1372.98 4979,-1372.98 4979,-1416.98"/>
<text text-anchor="middle" x="4831" y="-1407.78" font-family="Times,serif" font-size="9.00">MHA L14</text>
<text text-anchor="middle" x="4831" y="-1397.78" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-1387.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4831" y="-1377.78" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_13&#45;&gt;mha_14 -->
<g id="edge1387" class="edge">
<title>output_13&#45;&gt;mha_14</title>
<path fill="none" stroke="black" d="M4831,-1463.89C4831,-1453 4831,-1439.49 4831,-1427.4"/>
<polygon fill="black" stroke="black" points="4834.5,-1427.23 4831,-1417.23 4827.5,-1427.23 4834.5,-1427.23"/>
</g>
<!-- gate_14 -->
<g id="node955" class="node">
<title>gate_14</title>
<polygon fill="lightyellow" stroke="black" points="5130.74,-1336.98 4653.92,-1336.98 4531.26,-1248.98 5008.08,-1248.98 5130.74,-1336.98"/>
<text text-anchor="middle" x="4831" y="-1305.78" font-family="Times,serif" font-size="9.00">Gate L14</text>
<text text-anchor="middle" x="4831" y="-1295.78" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4831" y="-1285.78" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4831" y="-1275.78" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_14&#45;&gt;gate_14 -->
<g id="edge1388" class="edge">
<title>mha_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M4831,-1372.78C4831,-1365.28 4831,-1356.47 4831,-1347.51"/>
<polygon fill="black" stroke="black" points="4834.5,-1347.39 4831,-1337.39 4827.5,-1347.39 4834.5,-1347.39"/>
</g>
<!-- route_14_0 -->
<g id="node956" class="node">
<title>route_14_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="517" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="517" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="517" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 448,449</text>
<text text-anchor="middle" x="517" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="517" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_0 -->
<g id="edge1389" class="edge">
<title>gate_14&#45;&gt;route_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4591.06,-1292.09C3976.46,-1291.29 2295.47,-1282.38 897,-1212.98 831.75,-1209.75 760.32,-1204.53 697.17,-1199.34"/>
<polygon fill="black" stroke="black" points="697.36,-1195.84 687.11,-1198.51 696.79,-1202.82 697.36,-1195.84"/>
</g>
<!-- route_14_1 -->
<g id="node960" class="node">
<title>route_14_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1107" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1107" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1107" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 450,451</text>
<text text-anchor="middle" x="1107" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1107" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_1 -->
<g id="edge1395" class="edge">
<title>gate_14&#45;&gt;route_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4589.54,-1290.87C4038.95,-1287.32 2648.35,-1272.67 1487,-1212.98 1421.91,-1209.64 1350.67,-1204.41 1287.63,-1199.24"/>
<polygon fill="black" stroke="black" points="1287.84,-1195.75 1277.59,-1198.42 1287.27,-1202.73 1287.84,-1195.75"/>
</g>
<!-- route_14_2 -->
<g id="node964" class="node">
<title>route_14_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1697" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1697" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1697" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 452,453</text>
<text text-anchor="middle" x="1697" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1697" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_2 -->
<g id="edge1401" class="edge">
<title>gate_14&#45;&gt;route_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4586.76,-1289.11C4105.96,-1282.53 3003,-1262.92 2077,-1212.98 2012.08,-1209.48 1941.02,-1204.23 1878.1,-1199.1"/>
<polygon fill="black" stroke="black" points="1878.32,-1195.6 1868.07,-1198.27 1877.75,-1202.58 1878.32,-1195.6"/>
</g>
<!-- route_14_3 -->
<g id="node968" class="node">
<title>route_14_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2287" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2287" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2287" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 454,455</text>
<text text-anchor="middle" x="2287" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2287" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_3 -->
<g id="edge1407" class="edge">
<title>gate_14&#45;&gt;route_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4582.97,-1286.36C4180.59,-1276.47 3360.63,-1253.11 2667,-1212.98 2602.41,-1209.25 2531.72,-1203.97 2469.03,-1198.88"/>
<polygon fill="black" stroke="black" points="2469.29,-1195.39 2459.03,-1198.07 2468.72,-1202.37 2469.29,-1195.39"/>
</g>
<!-- route_14_4 -->
<g id="node972" class="node">
<title>route_14_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2877" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2877" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2877" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 456,457</text>
<text text-anchor="middle" x="2877" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2877" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_4 -->
<g id="edge1413" class="edge">
<title>gate_14&#45;&gt;route_14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4576.31,-1281.47C4264.95,-1268.09 3722.02,-1243.07 3257,-1212.98 3193.03,-1208.85 3123.07,-1203.53 3060.81,-1198.52"/>
<polygon fill="black" stroke="black" points="3060.74,-1195 3050.49,-1197.68 3060.17,-1201.98 3060.74,-1195"/>
</g>
<!-- route_14_5 -->
<g id="node976" class="node">
<title>route_14_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3467" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3467" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3467" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 458,459</text>
<text text-anchor="middle" x="3467" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3467" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_5 -->
<g id="edge1419" class="edge">
<title>gate_14&#45;&gt;route_14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4560.7,-1270.36C4292.15,-1248.88 3887.49,-1216.51 3653.05,-1197.76"/>
<polygon fill="black" stroke="black" points="3653.3,-1194.26 3643.06,-1196.96 3652.74,-1201.24 3653.3,-1194.26"/>
</g>
<!-- route_14_6 -->
<g id="node980" class="node">
<title>route_14_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4057" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4057" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4057" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 460,461</text>
<text text-anchor="middle" x="4057" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4057" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_6 -->
<g id="edge1425" class="edge">
<title>gate_14&#45;&gt;route_14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4532.31,-1249.88C4423.07,-1234.48 4303.92,-1217.68 4212.24,-1204.76"/>
<polygon fill="black" stroke="black" points="4212.72,-1201.29 4202.33,-1203.36 4211.74,-1208.22 4212.72,-1201.29"/>
</g>
<!-- route_14_7 -->
<g id="node984" class="node">
<title>route_14_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4584" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4584" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4584" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 462,463</text>
<text text-anchor="middle" x="4584" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4584" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_7 -->
<g id="edge1431" class="edge">
<title>gate_14&#45;&gt;route_14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4733.38,-1248.86C4708.26,-1237.76 4681.65,-1226.01 4657.95,-1215.54"/>
<polygon fill="black" stroke="black" points="4659.24,-1212.28 4648.68,-1211.44 4656.41,-1218.69 4659.24,-1212.28"/>
</g>
<!-- route_14_8 -->
<g id="node988" class="node">
<title>route_14_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5004" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5004" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5004" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 464,465</text>
<text text-anchor="middle" x="5004" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5004" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_8 -->
<g id="edge1437" class="edge">
<title>gate_14&#45;&gt;route_14_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4899.37,-1248.86C4915.79,-1238.51 4933.12,-1227.58 4948.85,-1217.66"/>
<polygon fill="black" stroke="black" points="4950.81,-1220.56 4957.4,-1212.26 4947.08,-1214.63 4950.81,-1220.56"/>
</g>
<!-- route_14_9 -->
<g id="node992" class="node">
<title>route_14_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5532" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5532" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5532" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 466,467</text>
<text text-anchor="middle" x="5532" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5532" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_9 -->
<g id="edge1443" class="edge">
<title>gate_14&#45;&gt;route_14_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5025.8,-1261.66C5138.94,-1244.05 5279.24,-1222.22 5383.42,-1206"/>
<polygon fill="black" stroke="black" points="5384.04,-1209.44 5393.39,-1204.45 5382.97,-1202.53 5384.04,-1209.44"/>
</g>
<!-- route_14_10 -->
<g id="node996" class="node">
<title>route_14_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6122" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6122" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6122" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 468,469</text>
<text text-anchor="middle" x="6122" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6122" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_10 -->
<g id="edge1449" class="edge">
<title>gate_14&#45;&gt;route_14_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5043.1,-1274.06C5292.29,-1253 5701.63,-1218.4 5937.98,-1198.43"/>
<polygon fill="black" stroke="black" points="5938.39,-1201.9 5948.05,-1197.57 5937.8,-1194.93 5938.39,-1201.9"/>
</g>
<!-- route_14_11 -->
<g id="node1000" class="node">
<title>route_14_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6712" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6712" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 470,471</text>
<text text-anchor="middle" x="6712" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6712" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_11 -->
<g id="edge1455" class="edge">
<title>gate_14&#45;&gt;route_14_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5054.26,-1282.08C5347.56,-1268.65 5878.6,-1242.88 6332,-1212.98 6395.96,-1208.77 6465.92,-1203.43 6528.18,-1198.43"/>
<polygon fill="black" stroke="black" points="6528.82,-1201.89 6538.51,-1197.59 6528.26,-1194.91 6528.82,-1201.89"/>
</g>
<!-- route_14_12 -->
<g id="node1004" class="node">
<title>route_14_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7302" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7302" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7302" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 472,473</text>
<text text-anchor="middle" x="7302" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7302" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_12 -->
<g id="edge1461" class="edge">
<title>gate_14&#45;&gt;route_14_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5060.5,-1286.42C5445.53,-1276.38 6245.87,-1252.53 6922,-1212.98 6986.59,-1209.21 7057.27,-1203.92 7119.97,-1198.83"/>
<polygon fill="black" stroke="black" points="7120.28,-1202.32 7129.96,-1198.02 7119.71,-1195.34 7120.28,-1202.32"/>
</g>
<!-- route_14_13 -->
<g id="node1008" class="node">
<title>route_14_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7892" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7892" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7892" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 474,475</text>
<text text-anchor="middle" x="7892" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7892" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_13 -->
<g id="edge1467" class="edge">
<title>gate_14&#45;&gt;route_14_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5064.26,-1289C5529.89,-1282.19 6607.64,-1262.11 7512,-1212.98 7576.92,-1209.46 7647.98,-1204.2 7710.9,-1199.07"/>
<polygon fill="black" stroke="black" points="7711.25,-1202.55 7720.93,-1198.24 7710.67,-1195.57 7711.25,-1202.55"/>
</g>
<!-- route_14_14 -->
<g id="node1012" class="node">
<title>route_14_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8482" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8482" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8482" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 476,477</text>
<text text-anchor="middle" x="8482" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8482" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_14 -->
<g id="edge1473" class="edge">
<title>gate_14&#45;&gt;route_14_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5066.44,-1290.73C5604.49,-1286.9 6965.47,-1271.7 8102,-1212.98 8167.09,-1209.62 8238.33,-1204.39 8301.37,-1199.23"/>
<polygon fill="black" stroke="black" points="8301.73,-1202.71 8311.41,-1198.4 8301.16,-1195.73 8301.73,-1202.71"/>
</g>
<!-- route_14_15 -->
<g id="node1016" class="node">
<title>route_14_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9072" cy="-1181.87" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9072" y="-1194.67" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9072" y="-1184.67" font-family="Times,serif" font-size="9.00">GPU: 478,479</text>
<text text-anchor="middle" x="9072" y="-1174.67" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9072" y="-1164.67" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_14&#45;&gt;route_14_15 -->
<g id="edge1479" class="edge">
<title>gate_14&#45;&gt;route_14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5068.14,-1291.97C5672.71,-1290.87 7320.74,-1281.29 8692,-1212.98 8757.25,-1209.73 8828.68,-1204.51 8891.83,-1199.32"/>
<polygon fill="black" stroke="black" points="8892.21,-1202.8 8901.89,-1198.49 8891.64,-1195.83 8892.21,-1202.8"/>
</g>
<!-- expert_14_0_0 -->
<g id="node957" class="node">
<title>expert_14_0_0</title>
<polygon fill="lightgreen" stroke="black" points="360.5,-1114.76 83.5,-1114.76 83.5,-1070.76 360.5,-1070.76 360.5,-1114.76"/>
<text text-anchor="middle" x="222" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="222" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 448</text>
<text text-anchor="middle" x="222" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="222" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_0&#45;&gt;expert_14_0_0 -->
<g id="edge1390" class="edge">
<title>route_14_0&#45;&gt;expert_14_0_0</title>
<path fill="none" stroke="black" d="M426.08,-1154.02C386.92,-1142.46 341.49,-1129.04 303.44,-1117.81"/>
<polygon fill="black" stroke="black" points="304.01,-1114.33 293.43,-1114.85 302.03,-1121.04 304.01,-1114.33"/>
</g>
<!-- expert_14_0_1 -->
<g id="node958" class="node">
<title>expert_14_0_1</title>
<polygon fill="lightgreen" stroke="black" points="655.5,-1114.76 378.5,-1114.76 378.5,-1070.76 655.5,-1070.76 655.5,-1114.76"/>
<text text-anchor="middle" x="517" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="517" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 449</text>
<text text-anchor="middle" x="517" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="517" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_0&#45;&gt;expert_14_0_1 -->
<g id="edge1391" class="edge">
<title>route_14_0&#45;&gt;expert_14_0_1</title>
<path fill="none" stroke="black" d="M517,-1150.4C517,-1142.12 517,-1133.15 517,-1124.84"/>
<polygon fill="black" stroke="black" points="520.5,-1124.76 517,-1114.76 513.5,-1124.76 520.5,-1124.76"/>
</g>
<!-- tp_14_0 -->
<g id="node959" class="node">
<title>tp_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="517" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="517" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="517" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 448↔449</text>
<text text-anchor="middle" x="517" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="517" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_0_0&#45;&gt;tp_14_0 -->
<g id="edge1392" class="edge">
<title>expert_14_0_0&#45;&gt;tp_14_0</title>
<path fill="none" stroke="black" d="M293.41,-1070.67C334.87,-1058.43 387.36,-1042.93 431.07,-1030.02"/>
<polygon fill="black" stroke="black" points="432.23,-1033.33 440.83,-1027.14 430.25,-1026.62 432.23,-1033.33"/>
</g>
<!-- expert_14_0_1&#45;&gt;tp_14_0 -->
<g id="edge1393" class="edge">
<title>expert_14_0_1&#45;&gt;tp_14_0</title>
<path fill="none" stroke="black" d="M517,-1070.67C517,-1063 517,-1054.05 517,-1045.25"/>
<polygon fill="black" stroke="black" points="520.5,-1045.09 517,-1035.09 513.5,-1045.09 520.5,-1045.09"/>
</g>
<!-- agg_14 -->
<g id="node1020" class="node">
<title>agg_14</title>
<polygon fill="lightyellow" stroke="black" points="5075.99,-936.53 4627.4,-936.53 4512.01,-848.53 4960.6,-848.53 5075.99,-936.53"/>
<text text-anchor="middle" x="4794" y="-905.33" font-family="Times,serif" font-size="9.00">Aggregate Experts L14</text>
<text text-anchor="middle" x="4794" y="-895.33" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-885.33" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4794" y="-875.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_14_0&#45;&gt;agg_14 -->
<g id="edge1394" class="edge">
<title>tp_14_0&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M627.79,-994.1C721.96,-987.16 860.76,-977.71 982,-972.53 2337.83,-914.61 3966.8,-898.8 4561.92,-894.79"/>
<polygon fill="black" stroke="black" points="4562.36,-898.29 4572.33,-894.72 4562.31,-891.29 4562.36,-898.29"/>
</g>
<!-- expert_14_1_0 -->
<g id="node961" class="node">
<title>expert_14_1_0</title>
<polygon fill="lightgreen" stroke="black" points="950.5,-1114.76 673.5,-1114.76 673.5,-1070.76 950.5,-1070.76 950.5,-1114.76"/>
<text text-anchor="middle" x="812" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="812" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 450</text>
<text text-anchor="middle" x="812" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="812" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_1&#45;&gt;expert_14_1_0 -->
<g id="edge1396" class="edge">
<title>route_14_1&#45;&gt;expert_14_1_0</title>
<path fill="none" stroke="black" d="M1016.08,-1154.02C976.92,-1142.46 931.49,-1129.04 893.44,-1117.81"/>
<polygon fill="black" stroke="black" points="894.01,-1114.33 883.43,-1114.85 892.03,-1121.04 894.01,-1114.33"/>
</g>
<!-- expert_14_1_1 -->
<g id="node962" class="node">
<title>expert_14_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1245.5,-1114.76 968.5,-1114.76 968.5,-1070.76 1245.5,-1070.76 1245.5,-1114.76"/>
<text text-anchor="middle" x="1107" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1107" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 451</text>
<text text-anchor="middle" x="1107" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1107" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_1&#45;&gt;expert_14_1_1 -->
<g id="edge1397" class="edge">
<title>route_14_1&#45;&gt;expert_14_1_1</title>
<path fill="none" stroke="black" d="M1107,-1150.4C1107,-1142.12 1107,-1133.15 1107,-1124.84"/>
<polygon fill="black" stroke="black" points="1110.5,-1124.76 1107,-1114.76 1103.5,-1124.76 1110.5,-1124.76"/>
</g>
<!-- tp_14_1 -->
<g id="node963" class="node">
<title>tp_14_1</title>
<ellipse fill="lightblue" stroke="black" cx="1107" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1107" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1107" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 450↔451</text>
<text text-anchor="middle" x="1107" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1107" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_1_0&#45;&gt;tp_14_1 -->
<g id="edge1398" class="edge">
<title>expert_14_1_0&#45;&gt;tp_14_1</title>
<path fill="none" stroke="black" d="M883.41,-1070.67C924.87,-1058.43 977.36,-1042.93 1021.07,-1030.02"/>
<polygon fill="black" stroke="black" points="1022.23,-1033.33 1030.83,-1027.14 1020.25,-1026.62 1022.23,-1033.33"/>
</g>
<!-- expert_14_1_1&#45;&gt;tp_14_1 -->
<g id="edge1399" class="edge">
<title>expert_14_1_1&#45;&gt;tp_14_1</title>
<path fill="none" stroke="black" d="M1107,-1070.67C1107,-1063 1107,-1054.05 1107,-1045.25"/>
<polygon fill="black" stroke="black" points="1110.5,-1045.09 1107,-1035.09 1103.5,-1045.09 1110.5,-1045.09"/>
</g>
<!-- tp_14_1&#45;&gt;agg_14 -->
<g id="edge1400" class="edge">
<title>tp_14_1&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1217.8,-994.22C1311.96,-987.35 1450.77,-977.94 1572,-972.53 2692.94,-922.52 4034.78,-902.38 4563.63,-896.01"/>
<polygon fill="black" stroke="black" points="4563.71,-899.51 4573.67,-895.89 4563.63,-892.51 4563.71,-899.51"/>
</g>
<!-- expert_14_2_0 -->
<g id="node965" class="node">
<title>expert_14_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1540.5,-1114.76 1263.5,-1114.76 1263.5,-1070.76 1540.5,-1070.76 1540.5,-1114.76"/>
<text text-anchor="middle" x="1402" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1402" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 452</text>
<text text-anchor="middle" x="1402" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1402" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_2&#45;&gt;expert_14_2_0 -->
<g id="edge1402" class="edge">
<title>route_14_2&#45;&gt;expert_14_2_0</title>
<path fill="none" stroke="black" d="M1606.08,-1154.02C1566.92,-1142.46 1521.49,-1129.04 1483.44,-1117.81"/>
<polygon fill="black" stroke="black" points="1484.01,-1114.33 1473.43,-1114.85 1482.03,-1121.04 1484.01,-1114.33"/>
</g>
<!-- expert_14_2_1 -->
<g id="node966" class="node">
<title>expert_14_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1835.5,-1114.76 1558.5,-1114.76 1558.5,-1070.76 1835.5,-1070.76 1835.5,-1114.76"/>
<text text-anchor="middle" x="1697" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1697" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 453</text>
<text text-anchor="middle" x="1697" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1697" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_2&#45;&gt;expert_14_2_1 -->
<g id="edge1403" class="edge">
<title>route_14_2&#45;&gt;expert_14_2_1</title>
<path fill="none" stroke="black" d="M1697,-1150.4C1697,-1142.12 1697,-1133.15 1697,-1124.84"/>
<polygon fill="black" stroke="black" points="1700.5,-1124.76 1697,-1114.76 1693.5,-1124.76 1700.5,-1124.76"/>
</g>
<!-- tp_14_2 -->
<g id="node967" class="node">
<title>tp_14_2</title>
<ellipse fill="lightblue" stroke="black" cx="1697" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1697" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1697" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 452↔453</text>
<text text-anchor="middle" x="1697" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1697" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_2_0&#45;&gt;tp_14_2 -->
<g id="edge1404" class="edge">
<title>expert_14_2_0&#45;&gt;tp_14_2</title>
<path fill="none" stroke="black" d="M1473.41,-1070.67C1514.87,-1058.43 1567.36,-1042.93 1611.07,-1030.02"/>
<polygon fill="black" stroke="black" points="1612.23,-1033.33 1620.83,-1027.14 1610.25,-1026.62 1612.23,-1033.33"/>
</g>
<!-- expert_14_2_1&#45;&gt;tp_14_2 -->
<g id="edge1405" class="edge">
<title>expert_14_2_1&#45;&gt;tp_14_2</title>
<path fill="none" stroke="black" d="M1697,-1070.67C1697,-1063 1697,-1054.05 1697,-1045.25"/>
<polygon fill="black" stroke="black" points="1700.5,-1045.09 1697,-1035.09 1693.5,-1045.09 1700.5,-1045.09"/>
</g>
<!-- tp_14_2&#45;&gt;agg_14 -->
<g id="edge1406" class="edge">
<title>tp_14_2&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1807.8,-994.39C1901.98,-987.63 2040.79,-978.28 2162,-972.53 3050.74,-930.43 4109.42,-906.69 4565.95,-897.72"/>
<polygon fill="black" stroke="black" points="4566.03,-901.22 4575.96,-897.52 4565.89,-894.22 4566.03,-901.22"/>
</g>
<!-- expert_14_3_0 -->
<g id="node969" class="node">
<title>expert_14_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2130.5,-1114.76 1853.5,-1114.76 1853.5,-1070.76 2130.5,-1070.76 2130.5,-1114.76"/>
<text text-anchor="middle" x="1992" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1992" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 454</text>
<text text-anchor="middle" x="1992" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1992" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_3&#45;&gt;expert_14_3_0 -->
<g id="edge1408" class="edge">
<title>route_14_3&#45;&gt;expert_14_3_0</title>
<path fill="none" stroke="black" d="M2196.08,-1154.02C2156.92,-1142.46 2111.49,-1129.04 2073.44,-1117.81"/>
<polygon fill="black" stroke="black" points="2074.01,-1114.33 2063.43,-1114.85 2072.03,-1121.04 2074.01,-1114.33"/>
</g>
<!-- expert_14_3_1 -->
<g id="node970" class="node">
<title>expert_14_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2425.5,-1114.76 2148.5,-1114.76 2148.5,-1070.76 2425.5,-1070.76 2425.5,-1114.76"/>
<text text-anchor="middle" x="2287" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2287" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 455</text>
<text text-anchor="middle" x="2287" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2287" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_3&#45;&gt;expert_14_3_1 -->
<g id="edge1409" class="edge">
<title>route_14_3&#45;&gt;expert_14_3_1</title>
<path fill="none" stroke="black" d="M2287,-1150.4C2287,-1142.12 2287,-1133.15 2287,-1124.84"/>
<polygon fill="black" stroke="black" points="2290.5,-1124.76 2287,-1114.76 2283.5,-1124.76 2290.5,-1124.76"/>
</g>
<!-- tp_14_3 -->
<g id="node971" class="node">
<title>tp_14_3</title>
<ellipse fill="lightblue" stroke="black" cx="2287" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2287" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2287" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 454↔455</text>
<text text-anchor="middle" x="2287" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2287" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_3_0&#45;&gt;tp_14_3 -->
<g id="edge1410" class="edge">
<title>expert_14_3_0&#45;&gt;tp_14_3</title>
<path fill="none" stroke="black" d="M2063.41,-1070.67C2104.87,-1058.43 2157.36,-1042.93 2201.07,-1030.02"/>
<polygon fill="black" stroke="black" points="2202.23,-1033.33 2210.83,-1027.14 2200.25,-1026.62 2202.23,-1033.33"/>
</g>
<!-- expert_14_3_1&#45;&gt;tp_14_3 -->
<g id="edge1411" class="edge">
<title>expert_14_3_1&#45;&gt;tp_14_3</title>
<path fill="none" stroke="black" d="M2287,-1070.67C2287,-1063 2287,-1054.05 2287,-1045.25"/>
<polygon fill="black" stroke="black" points="2290.5,-1045.09 2287,-1035.09 2283.5,-1045.09 2290.5,-1045.09"/>
</g>
<!-- tp_14_3&#45;&gt;agg_14 -->
<g id="edge1412" class="edge">
<title>tp_14_3&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2398.29,-994.62C2492.46,-988.03 2631.02,-978.79 2752,-972.53 3412.08,-938.4 4192.88,-912.11 4569.12,-900.32"/>
<polygon fill="black" stroke="black" points="4569.42,-903.81 4579.3,-900 4569.2,-896.82 4569.42,-903.81"/>
</g>
<!-- expert_14_4_0 -->
<g id="node973" class="node">
<title>expert_14_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2720.5,-1114.76 2443.5,-1114.76 2443.5,-1070.76 2720.5,-1070.76 2720.5,-1114.76"/>
<text text-anchor="middle" x="2582" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2582" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 456</text>
<text text-anchor="middle" x="2582" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2582" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_4&#45;&gt;expert_14_4_0 -->
<g id="edge1414" class="edge">
<title>route_14_4&#45;&gt;expert_14_4_0</title>
<path fill="none" stroke="black" d="M2786.08,-1154.02C2746.92,-1142.46 2701.49,-1129.04 2663.44,-1117.81"/>
<polygon fill="black" stroke="black" points="2664.01,-1114.33 2653.43,-1114.85 2662.03,-1121.04 2664.01,-1114.33"/>
</g>
<!-- expert_14_4_1 -->
<g id="node974" class="node">
<title>expert_14_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3015.5,-1114.76 2738.5,-1114.76 2738.5,-1070.76 3015.5,-1070.76 3015.5,-1114.76"/>
<text text-anchor="middle" x="2877" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2877" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 457</text>
<text text-anchor="middle" x="2877" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2877" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_4&#45;&gt;expert_14_4_1 -->
<g id="edge1415" class="edge">
<title>route_14_4&#45;&gt;expert_14_4_1</title>
<path fill="none" stroke="black" d="M2877,-1150.4C2877,-1142.12 2877,-1133.15 2877,-1124.84"/>
<polygon fill="black" stroke="black" points="2880.5,-1124.76 2877,-1114.76 2873.5,-1124.76 2880.5,-1124.76"/>
</g>
<!-- tp_14_4 -->
<g id="node975" class="node">
<title>tp_14_4</title>
<ellipse fill="lightblue" stroke="black" cx="2877" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2877" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2877" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 456↔457</text>
<text text-anchor="middle" x="2877" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2877" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_4_0&#45;&gt;tp_14_4 -->
<g id="edge1416" class="edge">
<title>expert_14_4_0&#45;&gt;tp_14_4</title>
<path fill="none" stroke="black" d="M2653.41,-1070.67C2694.87,-1058.43 2747.36,-1042.93 2791.07,-1030.02"/>
<polygon fill="black" stroke="black" points="2792.23,-1033.33 2800.83,-1027.14 2790.25,-1026.62 2792.23,-1033.33"/>
</g>
<!-- expert_14_4_1&#45;&gt;tp_14_4 -->
<g id="edge1417" class="edge">
<title>expert_14_4_1&#45;&gt;tp_14_4</title>
<path fill="none" stroke="black" d="M2877,-1070.67C2877,-1063 2877,-1054.05 2877,-1045.25"/>
<polygon fill="black" stroke="black" points="2880.5,-1045.09 2877,-1035.09 2873.5,-1045.09 2880.5,-1045.09"/>
</g>
<!-- tp_14_4&#45;&gt;agg_14 -->
<g id="edge1418" class="edge">
<title>tp_14_4&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2988.79,-995.08C3082.97,-988.79 3221.27,-979.73 3342,-972.53 3779.09,-946.49 4290.42,-919.47 4574.75,-904.76"/>
<polygon fill="black" stroke="black" points="4574.96,-908.25 4584.77,-904.24 4574.6,-901.26 4574.96,-908.25"/>
</g>
<!-- expert_14_5_0 -->
<g id="node977" class="node">
<title>expert_14_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3310.5,-1114.76 3033.5,-1114.76 3033.5,-1070.76 3310.5,-1070.76 3310.5,-1114.76"/>
<text text-anchor="middle" x="3172" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3172" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 458</text>
<text text-anchor="middle" x="3172" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3172" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_5&#45;&gt;expert_14_5_0 -->
<g id="edge1420" class="edge">
<title>route_14_5&#45;&gt;expert_14_5_0</title>
<path fill="none" stroke="black" d="M3376.08,-1154.02C3336.92,-1142.46 3291.49,-1129.04 3253.44,-1117.81"/>
<polygon fill="black" stroke="black" points="3254.01,-1114.33 3243.43,-1114.85 3252.03,-1121.04 3254.01,-1114.33"/>
</g>
<!-- expert_14_5_1 -->
<g id="node978" class="node">
<title>expert_14_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3605.5,-1114.76 3328.5,-1114.76 3328.5,-1070.76 3605.5,-1070.76 3605.5,-1114.76"/>
<text text-anchor="middle" x="3467" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3467" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 459</text>
<text text-anchor="middle" x="3467" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3467" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_5&#45;&gt;expert_14_5_1 -->
<g id="edge1421" class="edge">
<title>route_14_5&#45;&gt;expert_14_5_1</title>
<path fill="none" stroke="black" d="M3467,-1150.4C3467,-1142.12 3467,-1133.15 3467,-1124.84"/>
<polygon fill="black" stroke="black" points="3470.5,-1124.76 3467,-1114.76 3463.5,-1124.76 3470.5,-1124.76"/>
</g>
<!-- tp_14_5 -->
<g id="node979" class="node">
<title>tp_14_5</title>
<ellipse fill="lightblue" stroke="black" cx="3467" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3467" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3467" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 458↔459</text>
<text text-anchor="middle" x="3467" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3467" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_5_0&#45;&gt;tp_14_5 -->
<g id="edge1422" class="edge">
<title>expert_14_5_0&#45;&gt;tp_14_5</title>
<path fill="none" stroke="black" d="M3243.41,-1070.67C3284.87,-1058.43 3337.36,-1042.93 3381.07,-1030.02"/>
<polygon fill="black" stroke="black" points="3382.23,-1033.33 3390.83,-1027.14 3380.25,-1026.62 3382.23,-1033.33"/>
</g>
<!-- expert_14_5_1&#45;&gt;tp_14_5 -->
<g id="edge1423" class="edge">
<title>expert_14_5_1&#45;&gt;tp_14_5</title>
<path fill="none" stroke="black" d="M3467,-1070.67C3467,-1063 3467,-1054.05 3467,-1045.25"/>
<polygon fill="black" stroke="black" points="3470.5,-1045.09 3467,-1035.09 3463.5,-1045.09 3470.5,-1045.09"/>
</g>
<!-- tp_14_5&#45;&gt;agg_14 -->
<g id="edge1424" class="edge">
<title>tp_14_5&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M3577.01,-993.6C3797.49,-975.47 4296.79,-934.42 4582.61,-910.92"/>
<polygon fill="black" stroke="black" points="4583.01,-914.39 4592.69,-910.09 4582.44,-907.42 4583.01,-914.39"/>
</g>
<!-- expert_14_6_0 -->
<g id="node981" class="node">
<title>expert_14_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3900.5,-1114.76 3623.5,-1114.76 3623.5,-1070.76 3900.5,-1070.76 3900.5,-1114.76"/>
<text text-anchor="middle" x="3762" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3762" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 460</text>
<text text-anchor="middle" x="3762" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3762" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_6&#45;&gt;expert_14_6_0 -->
<g id="edge1426" class="edge">
<title>route_14_6&#45;&gt;expert_14_6_0</title>
<path fill="none" stroke="black" d="M3966.08,-1154.02C3926.92,-1142.46 3881.49,-1129.04 3843.44,-1117.81"/>
<polygon fill="black" stroke="black" points="3844.01,-1114.33 3833.43,-1114.85 3842.03,-1121.04 3844.01,-1114.33"/>
</g>
<!-- expert_14_6_1 -->
<g id="node982" class="node">
<title>expert_14_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4195.5,-1114.76 3918.5,-1114.76 3918.5,-1070.76 4195.5,-1070.76 4195.5,-1114.76"/>
<text text-anchor="middle" x="4057" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4057" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 461</text>
<text text-anchor="middle" x="4057" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4057" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_6&#45;&gt;expert_14_6_1 -->
<g id="edge1427" class="edge">
<title>route_14_6&#45;&gt;expert_14_6_1</title>
<path fill="none" stroke="black" d="M4057,-1150.4C4057,-1142.12 4057,-1133.15 4057,-1124.84"/>
<polygon fill="black" stroke="black" points="4060.5,-1124.76 4057,-1114.76 4053.5,-1124.76 4060.5,-1124.76"/>
</g>
<!-- tp_14_6 -->
<g id="node983" class="node">
<title>tp_14_6</title>
<ellipse fill="lightblue" stroke="black" cx="4057" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4057" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4057" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 460↔461</text>
<text text-anchor="middle" x="4057" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4057" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_6_0&#45;&gt;tp_14_6 -->
<g id="edge1428" class="edge">
<title>expert_14_6_0&#45;&gt;tp_14_6</title>
<path fill="none" stroke="black" d="M3833.41,-1070.67C3874.87,-1058.43 3927.36,-1042.93 3971.07,-1030.02"/>
<polygon fill="black" stroke="black" points="3972.23,-1033.33 3980.83,-1027.14 3970.25,-1026.62 3972.23,-1033.33"/>
</g>
<!-- expert_14_6_1&#45;&gt;tp_14_6 -->
<g id="edge1429" class="edge">
<title>expert_14_6_1&#45;&gt;tp_14_6</title>
<path fill="none" stroke="black" d="M4057,-1070.67C4057,-1063 4057,-1054.05 4057,-1045.25"/>
<polygon fill="black" stroke="black" points="4060.5,-1045.09 4057,-1035.09 4053.5,-1045.09 4060.5,-1045.09"/>
</g>
<!-- tp_14_6&#45;&gt;agg_14 -->
<g id="edge1430" class="edge">
<title>tp_14_6&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M4157.16,-987.82C4269.68,-971.16 4455.1,-943.71 4596.93,-922.71"/>
<polygon fill="black" stroke="black" points="4597.68,-926.14 4607.06,-921.21 4596.66,-919.21 4597.68,-926.14"/>
</g>
<!-- expert_14_7_0 -->
<g id="node985" class="node">
<title>expert_14_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4490.5,-1114.76 4213.5,-1114.76 4213.5,-1070.76 4490.5,-1070.76 4490.5,-1114.76"/>
<text text-anchor="middle" x="4352" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4352" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 462</text>
<text text-anchor="middle" x="4352" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4352" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_7&#45;&gt;expert_14_7_0 -->
<g id="edge1432" class="edge">
<title>route_14_7&#45;&gt;expert_14_7_0</title>
<path fill="none" stroke="black" d="M4509.64,-1152.95C4480.11,-1141.86 4446.42,-1129.21 4417.8,-1118.46"/>
<polygon fill="black" stroke="black" points="4418.89,-1115.14 4408.29,-1114.9 4416.43,-1121.69 4418.89,-1115.14"/>
</g>
<!-- expert_14_7_1 -->
<g id="node986" class="node">
<title>expert_14_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4785.5,-1114.76 4508.5,-1114.76 4508.5,-1070.76 4785.5,-1070.76 4785.5,-1114.76"/>
<text text-anchor="middle" x="4647" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4647" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 463</text>
<text text-anchor="middle" x="4647" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4647" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_7&#45;&gt;expert_14_7_1 -->
<g id="edge1433" class="edge">
<title>route_14_7&#45;&gt;expert_14_7_1</title>
<path fill="none" stroke="black" d="M4605.68,-1150.89C4612.15,-1141.94 4619.24,-1132.14 4625.69,-1123.22"/>
<polygon fill="black" stroke="black" points="4628.61,-1125.15 4631.64,-1115 4622.94,-1121.05 4628.61,-1125.15"/>
</g>
<!-- tp_14_7 -->
<g id="node987" class="node">
<title>tp_14_7</title>
<ellipse fill="lightblue" stroke="black" cx="4647" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4647" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4647" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 462↔463</text>
<text text-anchor="middle" x="4647" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4647" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_7_0&#45;&gt;tp_14_7 -->
<g id="edge1434" class="edge">
<title>expert_14_7_0&#45;&gt;tp_14_7</title>
<path fill="none" stroke="black" d="M4423.41,-1070.67C4464.87,-1058.43 4517.36,-1042.93 4561.07,-1030.02"/>
<polygon fill="black" stroke="black" points="4562.23,-1033.33 4570.83,-1027.14 4560.25,-1026.62 4562.23,-1033.33"/>
</g>
<!-- expert_14_7_1&#45;&gt;tp_14_7 -->
<g id="edge1435" class="edge">
<title>expert_14_7_1&#45;&gt;tp_14_7</title>
<path fill="none" stroke="black" d="M4647,-1070.67C4647,-1063 4647,-1054.05 4647,-1045.25"/>
<polygon fill="black" stroke="black" points="4650.5,-1045.09 4647,-1035.09 4643.5,-1045.09 4650.5,-1045.09"/>
</g>
<!-- tp_14_7&#45;&gt;agg_14 -->
<g id="edge1436" class="edge">
<title>tp_14_7&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M4685.24,-974.26C4698.3,-964.57 4713.31,-953.42 4727.93,-942.58"/>
<polygon fill="black" stroke="black" points="4730.05,-945.36 4735.99,-936.59 4725.88,-939.74 4730.05,-945.36"/>
</g>
<!-- expert_14_8_0 -->
<g id="node989" class="node">
<title>expert_14_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5080.5,-1114.76 4803.5,-1114.76 4803.5,-1070.76 5080.5,-1070.76 5080.5,-1114.76"/>
<text text-anchor="middle" x="4942" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4942" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 464</text>
<text text-anchor="middle" x="4942" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4942" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_8&#45;&gt;expert_14_8_0 -->
<g id="edge1438" class="edge">
<title>route_14_8&#45;&gt;expert_14_8_0</title>
<path fill="none" stroke="black" d="M4982.66,-1150.89C4976.29,-1141.94 4969.32,-1132.14 4962.97,-1123.22"/>
<polygon fill="black" stroke="black" points="4965.77,-1121.12 4957.12,-1115 4960.06,-1125.18 4965.77,-1121.12"/>
</g>
<!-- expert_14_8_1 -->
<g id="node990" class="node">
<title>expert_14_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5375.5,-1114.76 5098.5,-1114.76 5098.5,-1070.76 5375.5,-1070.76 5375.5,-1114.76"/>
<text text-anchor="middle" x="5237" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5237" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 465</text>
<text text-anchor="middle" x="5237" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5237" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_8&#45;&gt;expert_14_8_1 -->
<g id="edge1439" class="edge">
<title>route_14_8&#45;&gt;expert_14_8_1</title>
<path fill="none" stroke="black" d="M5078.68,-1152.95C5108.34,-1141.86 5142.17,-1129.21 5170.92,-1118.46"/>
<polygon fill="black" stroke="black" points="5172.32,-1121.68 5180.46,-1114.9 5169.87,-1115.12 5172.32,-1121.68"/>
</g>
<!-- tp_14_8 -->
<g id="node991" class="node">
<title>tp_14_8</title>
<ellipse fill="lightblue" stroke="black" cx="4942" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4942" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4942" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 464↔465</text>
<text text-anchor="middle" x="4942" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4942" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_8_0&#45;&gt;tp_14_8 -->
<g id="edge1440" class="edge">
<title>expert_14_8_0&#45;&gt;tp_14_8</title>
<path fill="none" stroke="black" d="M4942,-1070.67C4942,-1063 4942,-1054.05 4942,-1045.25"/>
<polygon fill="black" stroke="black" points="4945.5,-1045.09 4942,-1035.09 4938.5,-1045.09 4945.5,-1045.09"/>
</g>
<!-- expert_14_8_1&#45;&gt;tp_14_8 -->
<g id="edge1441" class="edge">
<title>expert_14_8_1&#45;&gt;tp_14_8</title>
<path fill="none" stroke="black" d="M5165.59,-1070.67C5124.13,-1058.43 5071.64,-1042.93 5027.93,-1030.02"/>
<polygon fill="black" stroke="black" points="5028.75,-1026.62 5018.17,-1027.14 5026.77,-1033.33 5028.75,-1026.62"/>
</g>
<!-- tp_14_8&#45;&gt;agg_14 -->
<g id="edge1442" class="edge">
<title>tp_14_8&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M4903.5,-974.26C4890.35,-964.57 4875.24,-953.42 4860.52,-942.58"/>
<polygon fill="black" stroke="black" points="4862.53,-939.71 4852.4,-936.59 4858.37,-945.34 4862.53,-939.71"/>
</g>
<!-- expert_14_9_0 -->
<g id="node993" class="node">
<title>expert_14_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5670.5,-1114.76 5393.5,-1114.76 5393.5,-1070.76 5670.5,-1070.76 5670.5,-1114.76"/>
<text text-anchor="middle" x="5532" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5532" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 466</text>
<text text-anchor="middle" x="5532" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5532" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_9&#45;&gt;expert_14_9_0 -->
<g id="edge1444" class="edge">
<title>route_14_9&#45;&gt;expert_14_9_0</title>
<path fill="none" stroke="black" d="M5532,-1150.4C5532,-1142.12 5532,-1133.15 5532,-1124.84"/>
<polygon fill="black" stroke="black" points="5535.5,-1124.76 5532,-1114.76 5528.5,-1124.76 5535.5,-1124.76"/>
</g>
<!-- expert_14_9_1 -->
<g id="node994" class="node">
<title>expert_14_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5965.5,-1114.76 5688.5,-1114.76 5688.5,-1070.76 5965.5,-1070.76 5965.5,-1114.76"/>
<text text-anchor="middle" x="5827" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5827" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 467</text>
<text text-anchor="middle" x="5827" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5827" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_9&#45;&gt;expert_14_9_1 -->
<g id="edge1445" class="edge">
<title>route_14_9&#45;&gt;expert_14_9_1</title>
<path fill="none" stroke="black" d="M5622.92,-1154.02C5662.08,-1142.46 5707.51,-1129.04 5745.56,-1117.81"/>
<polygon fill="black" stroke="black" points="5746.97,-1121.04 5755.57,-1114.85 5744.99,-1114.33 5746.97,-1121.04"/>
</g>
<!-- tp_14_9 -->
<g id="node995" class="node">
<title>tp_14_9</title>
<ellipse fill="lightblue" stroke="black" cx="5532" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5532" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5532" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 466↔467</text>
<text text-anchor="middle" x="5532" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5532" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_9_0&#45;&gt;tp_14_9 -->
<g id="edge1446" class="edge">
<title>expert_14_9_0&#45;&gt;tp_14_9</title>
<path fill="none" stroke="black" d="M5532,-1070.67C5532,-1063 5532,-1054.05 5532,-1045.25"/>
<polygon fill="black" stroke="black" points="5535.5,-1045.09 5532,-1035.09 5528.5,-1045.09 5535.5,-1045.09"/>
</g>
<!-- expert_14_9_1&#45;&gt;tp_14_9 -->
<g id="edge1447" class="edge">
<title>expert_14_9_1&#45;&gt;tp_14_9</title>
<path fill="none" stroke="black" d="M5755.59,-1070.67C5714.13,-1058.43 5661.64,-1042.93 5617.93,-1030.02"/>
<polygon fill="black" stroke="black" points="5618.75,-1026.62 5608.17,-1027.14 5616.77,-1033.33 5618.75,-1026.62"/>
</g>
<!-- tp_14_9&#45;&gt;agg_14 -->
<g id="edge1448" class="edge">
<title>tp_14_9&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M5431.7,-987.82C5342.3,-974.6 5206.93,-954.58 5083.87,-936.39"/>
<polygon fill="black" stroke="black" points="5084.31,-932.92 5073.9,-934.92 5083.28,-939.84 5084.31,-932.92"/>
</g>
<!-- expert_14_10_0 -->
<g id="node997" class="node">
<title>expert_14_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6260.5,-1114.76 5983.5,-1114.76 5983.5,-1070.76 6260.5,-1070.76 6260.5,-1114.76"/>
<text text-anchor="middle" x="6122" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6122" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 468</text>
<text text-anchor="middle" x="6122" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6122" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_10&#45;&gt;expert_14_10_0 -->
<g id="edge1450" class="edge">
<title>route_14_10&#45;&gt;expert_14_10_0</title>
<path fill="none" stroke="black" d="M6122,-1150.4C6122,-1142.12 6122,-1133.15 6122,-1124.84"/>
<polygon fill="black" stroke="black" points="6125.5,-1124.76 6122,-1114.76 6118.5,-1124.76 6125.5,-1124.76"/>
</g>
<!-- expert_14_10_1 -->
<g id="node998" class="node">
<title>expert_14_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6555.5,-1114.76 6278.5,-1114.76 6278.5,-1070.76 6555.5,-1070.76 6555.5,-1114.76"/>
<text text-anchor="middle" x="6417" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6417" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 469</text>
<text text-anchor="middle" x="6417" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6417" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_10&#45;&gt;expert_14_10_1 -->
<g id="edge1451" class="edge">
<title>route_14_10&#45;&gt;expert_14_10_1</title>
<path fill="none" stroke="black" d="M6212.92,-1154.02C6252.08,-1142.46 6297.51,-1129.04 6335.56,-1117.81"/>
<polygon fill="black" stroke="black" points="6336.97,-1121.04 6345.57,-1114.85 6334.99,-1114.33 6336.97,-1121.04"/>
</g>
<!-- tp_14_10 -->
<g id="node999" class="node">
<title>tp_14_10</title>
<ellipse fill="lightblue" stroke="black" cx="6122" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6122" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6122" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 468↔469</text>
<text text-anchor="middle" x="6122" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6122" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_10_0&#45;&gt;tp_14_10 -->
<g id="edge1452" class="edge">
<title>expert_14_10_0&#45;&gt;tp_14_10</title>
<path fill="none" stroke="black" d="M6122,-1070.67C6122,-1063 6122,-1054.05 6122,-1045.25"/>
<polygon fill="black" stroke="black" points="6125.5,-1045.09 6122,-1035.09 6118.5,-1045.09 6125.5,-1045.09"/>
</g>
<!-- expert_14_10_1&#45;&gt;tp_14_10 -->
<g id="edge1453" class="edge">
<title>expert_14_10_1&#45;&gt;tp_14_10</title>
<path fill="none" stroke="black" d="M6345.59,-1070.67C6304.13,-1058.43 6251.64,-1042.93 6207.93,-1030.02"/>
<polygon fill="black" stroke="black" points="6208.75,-1026.62 6198.17,-1027.14 6206.77,-1033.33 6208.75,-1026.62"/>
</g>
<!-- tp_14_10&#45;&gt;agg_14 -->
<g id="edge1454" class="edge">
<title>tp_14_10&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M6012.19,-993.62C5804.46,-976.56 5348.69,-939.11 5057.33,-915.17"/>
<polygon fill="black" stroke="black" points="5057.29,-911.65 5047.03,-914.32 5056.71,-918.63 5057.29,-911.65"/>
</g>
<!-- expert_14_11_0 -->
<g id="node1001" class="node">
<title>expert_14_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6850.5,-1114.76 6573.5,-1114.76 6573.5,-1070.76 6850.5,-1070.76 6850.5,-1114.76"/>
<text text-anchor="middle" x="6712" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6712" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 470</text>
<text text-anchor="middle" x="6712" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6712" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_11&#45;&gt;expert_14_11_0 -->
<g id="edge1456" class="edge">
<title>route_14_11&#45;&gt;expert_14_11_0</title>
<path fill="none" stroke="black" d="M6712,-1150.4C6712,-1142.12 6712,-1133.15 6712,-1124.84"/>
<polygon fill="black" stroke="black" points="6715.5,-1124.76 6712,-1114.76 6708.5,-1124.76 6715.5,-1124.76"/>
</g>
<!-- expert_14_11_1 -->
<g id="node1002" class="node">
<title>expert_14_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7145.5,-1114.76 6868.5,-1114.76 6868.5,-1070.76 7145.5,-1070.76 7145.5,-1114.76"/>
<text text-anchor="middle" x="7007" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7007" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 471</text>
<text text-anchor="middle" x="7007" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7007" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_11&#45;&gt;expert_14_11_1 -->
<g id="edge1457" class="edge">
<title>route_14_11&#45;&gt;expert_14_11_1</title>
<path fill="none" stroke="black" d="M6802.92,-1154.02C6842.08,-1142.46 6887.51,-1129.04 6925.56,-1117.81"/>
<polygon fill="black" stroke="black" points="6926.97,-1121.04 6935.57,-1114.85 6924.99,-1114.33 6926.97,-1121.04"/>
</g>
<!-- tp_14_11 -->
<g id="node1003" class="node">
<title>tp_14_11</title>
<ellipse fill="lightblue" stroke="black" cx="6712" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6712" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 470↔471</text>
<text text-anchor="middle" x="6712" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6712" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_11_0&#45;&gt;tp_14_11 -->
<g id="edge1458" class="edge">
<title>expert_14_11_0&#45;&gt;tp_14_11</title>
<path fill="none" stroke="black" d="M6712,-1070.67C6712,-1063 6712,-1054.05 6712,-1045.25"/>
<polygon fill="black" stroke="black" points="6715.5,-1045.09 6712,-1035.09 6708.5,-1045.09 6715.5,-1045.09"/>
</g>
<!-- expert_14_11_1&#45;&gt;tp_14_11 -->
<g id="edge1459" class="edge">
<title>expert_14_11_1&#45;&gt;tp_14_11</title>
<path fill="none" stroke="black" d="M6935.59,-1070.67C6894.13,-1058.43 6841.64,-1042.93 6797.93,-1030.02"/>
<polygon fill="black" stroke="black" points="6798.75,-1026.62 6788.17,-1027.14 6796.77,-1033.33 6798.75,-1026.62"/>
</g>
<!-- tp_14_11&#45;&gt;agg_14 -->
<g id="edge1460" class="edge">
<title>tp_14_11&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M6600.21,-995.08C6506.03,-988.79 6367.73,-979.73 6247,-972.53 5825.96,-947.46 5336.09,-921.49 5046.26,-906.46"/>
<polygon fill="black" stroke="black" points="5046.2,-902.95 5036.03,-905.93 5045.84,-909.94 5046.2,-902.95"/>
</g>
<!-- expert_14_12_0 -->
<g id="node1005" class="node">
<title>expert_14_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7440.5,-1114.76 7163.5,-1114.76 7163.5,-1070.76 7440.5,-1070.76 7440.5,-1114.76"/>
<text text-anchor="middle" x="7302" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7302" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 472</text>
<text text-anchor="middle" x="7302" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7302" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_12&#45;&gt;expert_14_12_0 -->
<g id="edge1462" class="edge">
<title>route_14_12&#45;&gt;expert_14_12_0</title>
<path fill="none" stroke="black" d="M7302,-1150.4C7302,-1142.12 7302,-1133.15 7302,-1124.84"/>
<polygon fill="black" stroke="black" points="7305.5,-1124.76 7302,-1114.76 7298.5,-1124.76 7305.5,-1124.76"/>
</g>
<!-- expert_14_12_1 -->
<g id="node1006" class="node">
<title>expert_14_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7735.5,-1114.76 7458.5,-1114.76 7458.5,-1070.76 7735.5,-1070.76 7735.5,-1114.76"/>
<text text-anchor="middle" x="7597" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7597" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 473</text>
<text text-anchor="middle" x="7597" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7597" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_12&#45;&gt;expert_14_12_1 -->
<g id="edge1463" class="edge">
<title>route_14_12&#45;&gt;expert_14_12_1</title>
<path fill="none" stroke="black" d="M7392.92,-1154.02C7432.08,-1142.46 7477.51,-1129.04 7515.56,-1117.81"/>
<polygon fill="black" stroke="black" points="7516.97,-1121.04 7525.57,-1114.85 7514.99,-1114.33 7516.97,-1121.04"/>
</g>
<!-- tp_14_12 -->
<g id="node1007" class="node">
<title>tp_14_12</title>
<ellipse fill="lightblue" stroke="black" cx="7302" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7302" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7302" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 472↔473</text>
<text text-anchor="middle" x="7302" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7302" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_12_0&#45;&gt;tp_14_12 -->
<g id="edge1464" class="edge">
<title>expert_14_12_0&#45;&gt;tp_14_12</title>
<path fill="none" stroke="black" d="M7302,-1070.67C7302,-1063 7302,-1054.05 7302,-1045.25"/>
<polygon fill="black" stroke="black" points="7305.5,-1045.09 7302,-1035.09 7298.5,-1045.09 7305.5,-1045.09"/>
</g>
<!-- expert_14_12_1&#45;&gt;tp_14_12 -->
<g id="edge1465" class="edge">
<title>expert_14_12_1&#45;&gt;tp_14_12</title>
<path fill="none" stroke="black" d="M7525.59,-1070.67C7484.13,-1058.43 7431.64,-1042.93 7387.93,-1030.02"/>
<polygon fill="black" stroke="black" points="7388.75,-1026.62 7378.17,-1027.14 7386.77,-1033.33 7388.75,-1026.62"/>
</g>
<!-- tp_14_12&#45;&gt;agg_14 -->
<g id="edge1466" class="edge">
<title>tp_14_12&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M7190.71,-994.62C7096.54,-988.03 6957.98,-978.79 6837,-972.53 6188.3,-938.99 5423.04,-913.04 5039.37,-900.96"/>
<polygon fill="black" stroke="black" points="5039.36,-897.46 5029.26,-900.64 5039.14,-904.45 5039.36,-897.46"/>
</g>
<!-- expert_14_13_0 -->
<g id="node1009" class="node">
<title>expert_14_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8030.5,-1114.76 7753.5,-1114.76 7753.5,-1070.76 8030.5,-1070.76 8030.5,-1114.76"/>
<text text-anchor="middle" x="7892" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7892" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 474</text>
<text text-anchor="middle" x="7892" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7892" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_13&#45;&gt;expert_14_13_0 -->
<g id="edge1468" class="edge">
<title>route_14_13&#45;&gt;expert_14_13_0</title>
<path fill="none" stroke="black" d="M7892,-1150.4C7892,-1142.12 7892,-1133.15 7892,-1124.84"/>
<polygon fill="black" stroke="black" points="7895.5,-1124.76 7892,-1114.76 7888.5,-1124.76 7895.5,-1124.76"/>
</g>
<!-- expert_14_13_1 -->
<g id="node1010" class="node">
<title>expert_14_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8325.5,-1114.76 8048.5,-1114.76 8048.5,-1070.76 8325.5,-1070.76 8325.5,-1114.76"/>
<text text-anchor="middle" x="8187" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8187" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 475</text>
<text text-anchor="middle" x="8187" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8187" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_13&#45;&gt;expert_14_13_1 -->
<g id="edge1469" class="edge">
<title>route_14_13&#45;&gt;expert_14_13_1</title>
<path fill="none" stroke="black" d="M7982.92,-1154.02C8022.08,-1142.46 8067.51,-1129.04 8105.56,-1117.81"/>
<polygon fill="black" stroke="black" points="8106.97,-1121.04 8115.57,-1114.85 8104.99,-1114.33 8106.97,-1121.04"/>
</g>
<!-- tp_14_13 -->
<g id="node1011" class="node">
<title>tp_14_13</title>
<ellipse fill="lightblue" stroke="black" cx="7892" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7892" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7892" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 474↔475</text>
<text text-anchor="middle" x="7892" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7892" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_13_0&#45;&gt;tp_14_13 -->
<g id="edge1470" class="edge">
<title>expert_14_13_0&#45;&gt;tp_14_13</title>
<path fill="none" stroke="black" d="M7892,-1070.67C7892,-1063 7892,-1054.05 7892,-1045.25"/>
<polygon fill="black" stroke="black" points="7895.5,-1045.09 7892,-1035.09 7888.5,-1045.09 7895.5,-1045.09"/>
</g>
<!-- expert_14_13_1&#45;&gt;tp_14_13 -->
<g id="edge1471" class="edge">
<title>expert_14_13_1&#45;&gt;tp_14_13</title>
<path fill="none" stroke="black" d="M8115.59,-1070.67C8074.13,-1058.43 8021.64,-1042.93 7977.93,-1030.02"/>
<polygon fill="black" stroke="black" points="7978.75,-1026.62 7968.17,-1027.14 7976.77,-1033.33 7978.75,-1026.62"/>
</g>
<!-- tp_14_13&#45;&gt;agg_14 -->
<g id="edge1472" class="edge">
<title>tp_14_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M7781.2,-994.39C7687.02,-987.63 7548.21,-978.28 7427,-972.53 6546.43,-930.82 5499.09,-907.14 5035.4,-897.98"/>
<polygon fill="black" stroke="black" points="5035.3,-894.48 5025.24,-897.78 5035.17,-901.47 5035.3,-894.48"/>
</g>
<!-- expert_14_14_0 -->
<g id="node1013" class="node">
<title>expert_14_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8620.5,-1114.76 8343.5,-1114.76 8343.5,-1070.76 8620.5,-1070.76 8620.5,-1114.76"/>
<text text-anchor="middle" x="8482" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8482" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 476</text>
<text text-anchor="middle" x="8482" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8482" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_14&#45;&gt;expert_14_14_0 -->
<g id="edge1474" class="edge">
<title>route_14_14&#45;&gt;expert_14_14_0</title>
<path fill="none" stroke="black" d="M8482,-1150.4C8482,-1142.12 8482,-1133.15 8482,-1124.84"/>
<polygon fill="black" stroke="black" points="8485.5,-1124.76 8482,-1114.76 8478.5,-1124.76 8485.5,-1124.76"/>
</g>
<!-- expert_14_14_1 -->
<g id="node1014" class="node">
<title>expert_14_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8915.5,-1114.76 8638.5,-1114.76 8638.5,-1070.76 8915.5,-1070.76 8915.5,-1114.76"/>
<text text-anchor="middle" x="8777" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8777" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 477</text>
<text text-anchor="middle" x="8777" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8777" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_14&#45;&gt;expert_14_14_1 -->
<g id="edge1475" class="edge">
<title>route_14_14&#45;&gt;expert_14_14_1</title>
<path fill="none" stroke="black" d="M8572.92,-1154.02C8612.08,-1142.46 8657.51,-1129.04 8695.56,-1117.81"/>
<polygon fill="black" stroke="black" points="8696.97,-1121.04 8705.57,-1114.85 8694.99,-1114.33 8696.97,-1121.04"/>
</g>
<!-- tp_14_14 -->
<g id="node1015" class="node">
<title>tp_14_14</title>
<ellipse fill="lightblue" stroke="black" cx="8482" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8482" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8482" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 476↔477</text>
<text text-anchor="middle" x="8482" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8482" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_14_0&#45;&gt;tp_14_14 -->
<g id="edge1476" class="edge">
<title>expert_14_14_0&#45;&gt;tp_14_14</title>
<path fill="none" stroke="black" d="M8482,-1070.67C8482,-1063 8482,-1054.05 8482,-1045.25"/>
<polygon fill="black" stroke="black" points="8485.5,-1045.09 8482,-1035.09 8478.5,-1045.09 8485.5,-1045.09"/>
</g>
<!-- expert_14_14_1&#45;&gt;tp_14_14 -->
<g id="edge1477" class="edge">
<title>expert_14_14_1&#45;&gt;tp_14_14</title>
<path fill="none" stroke="black" d="M8705.59,-1070.67C8664.13,-1058.43 8611.64,-1042.93 8567.93,-1030.02"/>
<polygon fill="black" stroke="black" points="8568.75,-1026.62 8558.17,-1027.14 8566.77,-1033.33 8568.75,-1026.62"/>
</g>
<!-- tp_14_14&#45;&gt;agg_14 -->
<g id="edge1478" class="edge">
<title>tp_14_14&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M8371.2,-994.22C8277.04,-987.35 8138.23,-977.94 8017,-972.53 6901.96,-922.78 5568.42,-902.61 5033.36,-896.12"/>
<polygon fill="black" stroke="black" points="5033.25,-892.61 5023.21,-895.99 5033.16,-899.61 5033.25,-892.61"/>
</g>
<!-- expert_14_15_0 -->
<g id="node1017" class="node">
<title>expert_14_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9210.5,-1114.76 8933.5,-1114.76 8933.5,-1070.76 9210.5,-1070.76 9210.5,-1114.76"/>
<text text-anchor="middle" x="9072" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9072" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 478</text>
<text text-anchor="middle" x="9072" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9072" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_15&#45;&gt;expert_14_15_0 -->
<g id="edge1480" class="edge">
<title>route_14_15&#45;&gt;expert_14_15_0</title>
<path fill="none" stroke="black" d="M9072,-1150.4C9072,-1142.12 9072,-1133.15 9072,-1124.84"/>
<polygon fill="black" stroke="black" points="9075.5,-1124.76 9072,-1114.76 9068.5,-1124.76 9075.5,-1124.76"/>
</g>
<!-- expert_14_15_1 -->
<g id="node1018" class="node">
<title>expert_14_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9505.5,-1114.76 9228.5,-1114.76 9228.5,-1070.76 9505.5,-1070.76 9505.5,-1114.76"/>
<text text-anchor="middle" x="9367" y="-1105.56" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9367" y="-1095.56" font-family="Times,serif" font-size="9.00">GPU: 479</text>
<text text-anchor="middle" x="9367" y="-1085.56" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9367" y="-1075.56" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_14_15&#45;&gt;expert_14_15_1 -->
<g id="edge1481" class="edge">
<title>route_14_15&#45;&gt;expert_14_15_1</title>
<path fill="none" stroke="black" d="M9162.92,-1154.02C9202.08,-1142.46 9247.51,-1129.04 9285.56,-1117.81"/>
<polygon fill="black" stroke="black" points="9286.97,-1121.04 9295.57,-1114.85 9284.99,-1114.33 9286.97,-1121.04"/>
</g>
<!-- tp_14_15 -->
<g id="node1019" class="node">
<title>tp_14_15</title>
<ellipse fill="lightblue" stroke="black" cx="9072" cy="-1003.65" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9072" y="-1016.45" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9072" y="-1006.45" font-family="Times,serif" font-size="9.00">GPU: 478↔479</text>
<text text-anchor="middle" x="9072" y="-996.45" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9072" y="-986.45" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_14_15_0&#45;&gt;tp_14_15 -->
<g id="edge1482" class="edge">
<title>expert_14_15_0&#45;&gt;tp_14_15</title>
<path fill="none" stroke="black" d="M9072,-1070.67C9072,-1063 9072,-1054.05 9072,-1045.25"/>
<polygon fill="black" stroke="black" points="9075.5,-1045.09 9072,-1035.09 9068.5,-1045.09 9075.5,-1045.09"/>
</g>
<!-- expert_14_15_1&#45;&gt;tp_14_15 -->
<g id="edge1483" class="edge">
<title>expert_14_15_1&#45;&gt;tp_14_15</title>
<path fill="none" stroke="black" d="M9295.59,-1070.67C9254.13,-1058.43 9201.64,-1042.93 9157.93,-1030.02"/>
<polygon fill="black" stroke="black" points="9158.75,-1026.62 9148.17,-1027.14 9156.77,-1033.33 9158.75,-1026.62"/>
</g>
<!-- tp_14_15&#45;&gt;agg_14 -->
<g id="edge1484" class="edge">
<title>tp_14_15&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M8961.21,-994.1C8867.04,-987.16 8728.24,-977.71 8607,-972.53 7254.8,-914.77 5630.99,-898.89 5031.41,-894.83"/>
<polygon fill="black" stroke="black" points="5031.38,-891.33 5021.35,-894.76 5031.33,-898.33 5031.38,-891.33"/>
</g>
<!-- output_14 -->
<g id="node1021" class="node">
<title>output_14</title>
<polygon fill="lightgreen" stroke="black" points="4942,-812.53 4646,-812.53 4646,-768.53 4942,-768.53 4942,-812.53"/>
<text text-anchor="middle" x="4794" y="-803.33" font-family="Times,serif" font-size="9.00">Layer 14 Output</text>
<text text-anchor="middle" x="4794" y="-793.33" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-783.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4794" y="-773.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_14&#45;&gt;output_14 -->
<g id="edge1485" class="edge">
<title>agg_14&#45;&gt;output_14</title>
<path fill="none" stroke="black" d="M4794,-848.25C4794,-839.67 4794,-830.81 4794,-822.72"/>
<polygon fill="black" stroke="black" points="4797.5,-822.62 4794,-812.62 4790.5,-822.62 4797.5,-822.62"/>
</g>
<!-- mha_15 -->
<g id="node1022" class="node">
<title>mha_15</title>
<polygon fill="lightgreen" stroke="black" points="4942,-732.53 4646,-732.53 4646,-688.53 4942,-688.53 4942,-732.53"/>
<text text-anchor="middle" x="4794" y="-723.33" font-family="Times,serif" font-size="9.00">MHA L15</text>
<text text-anchor="middle" x="4794" y="-713.33" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-703.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4794" y="-693.33" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_14&#45;&gt;mha_15 -->
<g id="edge1486" class="edge">
<title>output_14&#45;&gt;mha_15</title>
<path fill="none" stroke="black" d="M4794,-768.22C4794,-760.33 4794,-751.22 4794,-742.64"/>
<polygon fill="black" stroke="black" points="4797.5,-742.55 4794,-732.55 4790.5,-742.55 4797.5,-742.55"/>
</g>
<!-- gate_15 -->
<g id="node1023" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="5093.74,-652.53 4616.92,-652.53 4494.26,-564.53 4971.08,-564.53 5093.74,-652.53"/>
<text text-anchor="middle" x="4794" y="-621.33" font-family="Times,serif" font-size="9.00">Gate L15</text>
<text text-anchor="middle" x="4794" y="-611.33" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-601.33" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4794" y="-591.33" font-family="Times,serif" font-size="9.00">Output: routing_decisions</text>
</g>
<!-- mha_15&#45;&gt;gate_15 -->
<g id="edge1487" class="edge">
<title>mha_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M4794,-688.33C4794,-680.83 4794,-672.02 4794,-663.06"/>
<polygon fill="black" stroke="black" points="4797.5,-662.94 4794,-652.94 4790.5,-662.94 4797.5,-662.94"/>
</g>
<!-- route_15_0 -->
<g id="node1024" class="node">
<title>route_15_0</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="517" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="517" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 0</text>
<text text-anchor="middle" x="517" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 480,481</text>
<text text-anchor="middle" x="517" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="517" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_0 -->
<g id="edge1488" class="edge">
<title>gate_15&#45;&gt;route_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4554.09,-607.57C3943.43,-606.61 2280.63,-597.32 897,-528.53 831.75,-525.29 760.32,-520.07 697.17,-514.88"/>
<polygon fill="black" stroke="black" points="697.36,-511.38 687.11,-514.05 696.79,-518.36 697.36,-511.38"/>
</g>
<!-- route_15_1 -->
<g id="node1028" class="node">
<title>route_15_1</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1107" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1107" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 1</text>
<text text-anchor="middle" x="1107" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 482,483</text>
<text text-anchor="middle" x="1107" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1107" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_1 -->
<g id="edge1494" class="edge">
<title>gate_15&#45;&gt;route_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4552.4,-606.33C4005.99,-602.6 2633.53,-587.61 1487,-528.53 1421.91,-525.18 1350.67,-519.95 1287.63,-514.78"/>
<polygon fill="black" stroke="black" points="1287.84,-511.29 1277.59,-513.96 1287.27,-518.27 1287.84,-511.29"/>
</g>
<!-- route_15_2 -->
<g id="node1032" class="node">
<title>route_15_2</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="1697" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="1697" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 2</text>
<text text-anchor="middle" x="1697" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 484,485</text>
<text text-anchor="middle" x="1697" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1697" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_2 -->
<g id="edge1500" class="edge">
<title>gate_15&#45;&gt;route_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4549.82,-604.53C4073.8,-597.75 2988.5,-577.87 2077,-528.53 2012.08,-525.02 1941.02,-519.77 1878.1,-514.63"/>
<polygon fill="black" stroke="black" points="1878.32,-511.14 1868.07,-513.81 1877.75,-518.11 1878.32,-511.14"/>
</g>
<!-- route_15_3 -->
<g id="node1036" class="node">
<title>route_15_3</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2287" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2287" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 3</text>
<text text-anchor="middle" x="2287" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 486,487</text>
<text text-anchor="middle" x="2287" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2287" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_3 -->
<g id="edge1506" class="edge">
<title>gate_15&#45;&gt;route_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4545.78,-601.69C4148.71,-591.59 3346.24,-568.04 2667,-528.53 2602.41,-524.78 2531.73,-519.5 2469.03,-514.41"/>
<polygon fill="black" stroke="black" points="2469.29,-510.92 2459.04,-513.59 2468.72,-517.89 2469.29,-510.92"/>
</g>
<!-- route_15_4 -->
<g id="node1040" class="node">
<title>route_15_4</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="2877" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="2877" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 4</text>
<text text-anchor="middle" x="2877" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 488,489</text>
<text text-anchor="middle" x="2877" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2877" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_4 -->
<g id="edge1512" class="edge">
<title>gate_15&#45;&gt;route_15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4538.91,-596.59C4233.88,-583 3707.93,-557.98 3257,-528.53 3193.04,-524.36 3123.08,-519.03 3060.82,-514.02"/>
<polygon fill="black" stroke="black" points="3060.74,-510.5 3050.49,-513.19 3060.18,-517.48 3060.74,-510.5"/>
</g>
<!-- route_15_5 -->
<g id="node1044" class="node">
<title>route_15_5</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="3467" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="3467" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 5</text>
<text text-anchor="middle" x="3467" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 490,491</text>
<text text-anchor="middle" x="3467" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3467" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_5 -->
<g id="edge1518" class="edge">
<title>gate_15&#45;&gt;route_15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4523.06,-585.26C4263.32,-563.9 3878.23,-532.24 3651.92,-513.63"/>
<polygon fill="black" stroke="black" points="3652.18,-510.14 3641.93,-512.81 3651.61,-517.11 3652.18,-510.14"/>
</g>
<!-- route_15_6 -->
<g id="node1048" class="node">
<title>route_15_6</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4057" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4057" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 6</text>
<text text-anchor="middle" x="4057" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 492,493</text>
<text text-anchor="middle" x="4057" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4057" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_6 -->
<g id="edge1524" class="edge">
<title>gate_15&#45;&gt;route_15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4503.51,-564.53C4402.8,-549.62 4293.94,-533.5 4208.92,-520.91"/>
<polygon fill="black" stroke="black" points="4209.34,-517.44 4198.93,-519.43 4208.31,-524.36 4209.34,-517.44"/>
</g>
<!-- route_15_7 -->
<g id="node1052" class="node">
<title>route_15_7</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="4585" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="4585" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 7</text>
<text text-anchor="middle" x="4585" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 494,495</text>
<text text-anchor="middle" x="4585" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4585" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_7 -->
<g id="edge1530" class="edge">
<title>gate_15&#45;&gt;route_15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4711.4,-564.41C4690.91,-553.71 4669.25,-542.4 4649.75,-532.23"/>
<polygon fill="black" stroke="black" points="4651.15,-529.01 4640.67,-527.48 4647.91,-535.21 4651.15,-529.01"/>
</g>
<!-- route_15_8 -->
<g id="node1056" class="node">
<title>route_15_8</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5005" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5005" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 8</text>
<text text-anchor="middle" x="5005" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 496,497</text>
<text text-anchor="middle" x="5005" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5005" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_8 -->
<g id="edge1536" class="edge">
<title>gate_15&#45;&gt;route_15_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4877.39,-564.41C4898.27,-553.61 4920.36,-542.19 4940.18,-531.94"/>
<polygon fill="black" stroke="black" points="4941.84,-535.02 4949.12,-527.32 4938.63,-528.8 4941.84,-535.02"/>
</g>
<!-- route_15_9 -->
<g id="node1060" class="node">
<title>route_15_9</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="5532" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="5532" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 9</text>
<text text-anchor="middle" x="5532" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 498,499</text>
<text text-anchor="middle" x="5532" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5532" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_9 -->
<g id="edge1542" class="edge">
<title>gate_15&#45;&gt;route_15_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4990.8,-578.44C5112.76,-560.41 5267.08,-537.59 5379.69,-520.94"/>
<polygon fill="black" stroke="black" points="5380.39,-524.37 5389.77,-519.45 5379.37,-517.45 5380.39,-524.37"/>
</g>
<!-- route_15_10 -->
<g id="node1064" class="node">
<title>route_15_10</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6122" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6122" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 10</text>
<text text-anchor="middle" x="6122" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 500,501</text>
<text text-anchor="middle" x="6122" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6122" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_10 -->
<g id="edge1548" class="edge">
<title>gate_15&#45;&gt;route_15_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5007,-590.03C5264.37,-568.89 5693.14,-533.66 5937.18,-513.61"/>
<polygon fill="black" stroke="black" points="5937.54,-517.09 5947.22,-512.78 5936.96,-510.11 5937.54,-517.09"/>
</g>
<!-- route_15_11 -->
<g id="node1068" class="node">
<title>route_15_11</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="6712" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 11</text>
<text text-anchor="middle" x="6712" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 502,503</text>
<text text-anchor="middle" x="6712" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6712" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_11 -->
<g id="edge1554" class="edge">
<title>gate_15&#45;&gt;route_15_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5017.94,-597.98C5317.44,-584.76 5864.94,-559.03 6332,-528.53 6395.96,-524.36 6465.92,-519.03 6528.18,-514.02"/>
<polygon fill="black" stroke="black" points="6528.82,-517.48 6538.51,-513.19 6528.26,-510.5 6528.82,-517.48"/>
</g>
<!-- route_15_12 -->
<g id="node1072" class="node">
<title>route_15_12</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7302" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7302" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 12</text>
<text text-anchor="middle" x="7302" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 504,505</text>
<text text-anchor="middle" x="7302" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7302" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_12 -->
<g id="edge1560" class="edge">
<title>gate_15&#45;&gt;route_15_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5023.64,-602.17C5413.94,-592.34 6231.6,-568.69 6922,-528.53 6986.59,-524.78 7057.27,-519.5 7119.97,-514.41"/>
<polygon fill="black" stroke="black" points="7120.28,-517.89 7129.96,-513.59 7119.71,-510.92 7120.28,-517.89"/>
</g>
<!-- route_15_13 -->
<g id="node1076" class="node">
<title>route_15_13</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="7892" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="7892" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 13</text>
<text text-anchor="middle" x="7892" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 506,507</text>
<text text-anchor="middle" x="7892" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7892" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_13 -->
<g id="edge1566" class="edge">
<title>gate_15&#45;&gt;route_15_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5027.3,-604.68C5497.62,-598.07 6593.09,-578.27 7512,-528.53 7576.92,-525.02 7647.98,-519.77 7710.9,-514.63"/>
<polygon fill="black" stroke="black" points="7711.25,-518.11 7720.93,-513.81 7710.68,-511.14 7711.25,-518.11"/>
</g>
<!-- route_15_14 -->
<g id="node1080" class="node">
<title>route_15_14</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="8482" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="8482" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 14</text>
<text text-anchor="middle" x="8482" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 508,509</text>
<text text-anchor="middle" x="8482" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8482" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_14 -->
<g id="edge1572" class="edge">
<title>gate_15&#45;&gt;route_15_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5029.56,-606.37C5571.95,-602.71 6950.82,-587.85 8102,-528.53 8167.09,-525.18 8238.33,-519.95 8301.37,-514.78"/>
<polygon fill="black" stroke="black" points="8301.73,-518.27 8311.41,-513.96 8301.16,-511.29 8301.73,-518.27"/>
</g>
<!-- route_15_15 -->
<g id="node1084" class="node">
<title>route_15_15</title>
<ellipse fill="lightblue" stroke="black" stroke-dasharray="5,2" cx="9072" cy="-497.42" rx="200.64" ry="31.23"/>
<text text-anchor="middle" x="9072" y="-510.22" font-family="Times,serif" font-size="9.00">Route to Expert 15</text>
<text text-anchor="middle" x="9072" y="-500.22" font-family="Times,serif" font-size="9.00">GPU: 510,511</text>
<text text-anchor="middle" x="9072" y="-490.22" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9072" y="-480.22" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
</g>
<!-- gate_15&#45;&gt;route_15_15 -->
<g id="edge1578" class="edge">
<title>gate_15&#45;&gt;route_15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5031.19,-607.58C5639.71,-606.65 7305.91,-597.44 8692,-528.53 8757.25,-525.29 8828.68,-520.07 8891.83,-514.88"/>
<polygon fill="black" stroke="black" points="8892.21,-518.36 8901.89,-514.05 8891.64,-511.38 8892.21,-518.36"/>
</g>
<!-- expert_15_0_0 -->
<g id="node1025" class="node">
<title>expert_15_0_0</title>
<polygon fill="lightgreen" stroke="black" points="360.5,-430.31 83.5,-430.31 83.5,-386.31 360.5,-386.31 360.5,-430.31"/>
<text text-anchor="middle" x="222" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;0</text>
<text text-anchor="middle" x="222" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 480</text>
<text text-anchor="middle" x="222" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="222" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_0&#45;&gt;expert_15_0_0 -->
<g id="edge1489" class="edge">
<title>route_15_0&#45;&gt;expert_15_0_0</title>
<path fill="none" stroke="black" d="M426.08,-469.57C386.92,-458.01 341.49,-444.59 303.44,-433.36"/>
<polygon fill="black" stroke="black" points="304.01,-429.88 293.43,-430.4 302.03,-436.59 304.01,-429.88"/>
</g>
<!-- expert_15_0_1 -->
<g id="node1026" class="node">
<title>expert_15_0_1</title>
<polygon fill="lightgreen" stroke="black" points="655.5,-430.31 378.5,-430.31 378.5,-386.31 655.5,-386.31 655.5,-430.31"/>
<text text-anchor="middle" x="517" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 0 TP&#45;1</text>
<text text-anchor="middle" x="517" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 481</text>
<text text-anchor="middle" x="517" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="517" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_0&#45;&gt;expert_15_0_1 -->
<g id="edge1490" class="edge">
<title>route_15_0&#45;&gt;expert_15_0_1</title>
<path fill="none" stroke="black" d="M517,-465.95C517,-457.67 517,-448.7 517,-440.39"/>
<polygon fill="black" stroke="black" points="520.5,-440.31 517,-430.31 513.5,-440.31 520.5,-440.31"/>
</g>
<!-- tp_15_0 -->
<g id="node1027" class="node">
<title>tp_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="517" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="517" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="517" y="-322" font-family="Times,serif" font-size="9.00">GPU: 480↔481</text>
<text text-anchor="middle" x="517" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="517" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_0_0&#45;&gt;tp_15_0 -->
<g id="edge1491" class="edge">
<title>expert_15_0_0&#45;&gt;tp_15_0</title>
<path fill="none" stroke="black" d="M293.41,-386.22C334.87,-373.98 387.36,-358.48 431.07,-345.57"/>
<polygon fill="black" stroke="black" points="432.23,-348.88 440.83,-342.69 430.25,-342.16 432.23,-348.88"/>
</g>
<!-- expert_15_0_1&#45;&gt;tp_15_0 -->
<g id="edge1492" class="edge">
<title>expert_15_0_1&#45;&gt;tp_15_0</title>
<path fill="none" stroke="black" d="M517,-386.22C517,-378.55 517,-369.59 517,-360.8"/>
<polygon fill="black" stroke="black" points="520.5,-360.64 517,-350.64 513.5,-360.64 520.5,-360.64"/>
</g>
<!-- agg_15 -->
<g id="node1088" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="5075.99,-252.08 4627.4,-252.08 4512.01,-164.08 4960.6,-164.08 5075.99,-252.08"/>
<text text-anchor="middle" x="4794" y="-220.88" font-family="Times,serif" font-size="9.00">Aggregate Experts L15</text>
<text text-anchor="middle" x="4794" y="-210.88" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-200.88" font-family="Times,serif" font-size="9.00">Input: 16 expert outputs</text>
<text text-anchor="middle" x="4794" y="-190.88" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, hidden=1024]</text>
</g>
<!-- tp_15_0&#45;&gt;agg_15 -->
<g id="edge1493" class="edge">
<title>tp_15_0&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M627.79,-309.65C721.96,-302.71 860.76,-293.26 982,-288.08 2337.83,-230.16 3966.8,-214.35 4561.92,-210.34"/>
<polygon fill="black" stroke="black" points="4562.36,-213.84 4572.33,-210.27 4562.31,-206.84 4562.36,-213.84"/>
</g>
<!-- expert_15_1_0 -->
<g id="node1029" class="node">
<title>expert_15_1_0</title>
<polygon fill="lightgreen" stroke="black" points="950.5,-430.31 673.5,-430.31 673.5,-386.31 950.5,-386.31 950.5,-430.31"/>
<text text-anchor="middle" x="812" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;0</text>
<text text-anchor="middle" x="812" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 482</text>
<text text-anchor="middle" x="812" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="812" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_1&#45;&gt;expert_15_1_0 -->
<g id="edge1495" class="edge">
<title>route_15_1&#45;&gt;expert_15_1_0</title>
<path fill="none" stroke="black" d="M1016.08,-469.57C976.92,-458.01 931.49,-444.59 893.44,-433.36"/>
<polygon fill="black" stroke="black" points="894.01,-429.88 883.43,-430.4 892.03,-436.59 894.01,-429.88"/>
</g>
<!-- expert_15_1_1 -->
<g id="node1030" class="node">
<title>expert_15_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1245.5,-430.31 968.5,-430.31 968.5,-386.31 1245.5,-386.31 1245.5,-430.31"/>
<text text-anchor="middle" x="1107" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 1 TP&#45;1</text>
<text text-anchor="middle" x="1107" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 483</text>
<text text-anchor="middle" x="1107" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1107" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_1&#45;&gt;expert_15_1_1 -->
<g id="edge1496" class="edge">
<title>route_15_1&#45;&gt;expert_15_1_1</title>
<path fill="none" stroke="black" d="M1107,-465.95C1107,-457.67 1107,-448.7 1107,-440.39"/>
<polygon fill="black" stroke="black" points="1110.5,-440.31 1107,-430.31 1103.5,-440.31 1110.5,-440.31"/>
</g>
<!-- tp_15_1 -->
<g id="node1031" class="node">
<title>tp_15_1</title>
<ellipse fill="lightblue" stroke="black" cx="1107" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1107" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1107" y="-322" font-family="Times,serif" font-size="9.00">GPU: 482↔483</text>
<text text-anchor="middle" x="1107" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1107" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_1_0&#45;&gt;tp_15_1 -->
<g id="edge1497" class="edge">
<title>expert_15_1_0&#45;&gt;tp_15_1</title>
<path fill="none" stroke="black" d="M883.41,-386.22C924.87,-373.98 977.36,-358.48 1021.07,-345.57"/>
<polygon fill="black" stroke="black" points="1022.23,-348.88 1030.83,-342.69 1020.25,-342.16 1022.23,-348.88"/>
</g>
<!-- expert_15_1_1&#45;&gt;tp_15_1 -->
<g id="edge1498" class="edge">
<title>expert_15_1_1&#45;&gt;tp_15_1</title>
<path fill="none" stroke="black" d="M1107,-386.22C1107,-378.55 1107,-369.59 1107,-360.8"/>
<polygon fill="black" stroke="black" points="1110.5,-360.64 1107,-350.64 1103.5,-360.64 1110.5,-360.64"/>
</g>
<!-- tp_15_1&#45;&gt;agg_15 -->
<g id="edge1499" class="edge">
<title>tp_15_1&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1217.8,-309.77C1311.96,-302.9 1450.77,-293.49 1572,-288.08 2692.94,-238.07 4034.78,-217.93 4563.63,-211.56"/>
<polygon fill="black" stroke="black" points="4563.71,-215.06 4573.67,-211.44 4563.63,-208.06 4563.71,-215.06"/>
</g>
<!-- expert_15_2_0 -->
<g id="node1033" class="node">
<title>expert_15_2_0</title>
<polygon fill="lightgreen" stroke="black" points="1540.5,-430.31 1263.5,-430.31 1263.5,-386.31 1540.5,-386.31 1540.5,-430.31"/>
<text text-anchor="middle" x="1402" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;0</text>
<text text-anchor="middle" x="1402" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 484</text>
<text text-anchor="middle" x="1402" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1402" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_2&#45;&gt;expert_15_2_0 -->
<g id="edge1501" class="edge">
<title>route_15_2&#45;&gt;expert_15_2_0</title>
<path fill="none" stroke="black" d="M1606.08,-469.57C1566.92,-458.01 1521.49,-444.59 1483.44,-433.36"/>
<polygon fill="black" stroke="black" points="1484.01,-429.88 1473.43,-430.4 1482.03,-436.59 1484.01,-429.88"/>
</g>
<!-- expert_15_2_1 -->
<g id="node1034" class="node">
<title>expert_15_2_1</title>
<polygon fill="lightgreen" stroke="black" points="1835.5,-430.31 1558.5,-430.31 1558.5,-386.31 1835.5,-386.31 1835.5,-430.31"/>
<text text-anchor="middle" x="1697" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 2 TP&#45;1</text>
<text text-anchor="middle" x="1697" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 485</text>
<text text-anchor="middle" x="1697" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1697" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_2&#45;&gt;expert_15_2_1 -->
<g id="edge1502" class="edge">
<title>route_15_2&#45;&gt;expert_15_2_1</title>
<path fill="none" stroke="black" d="M1697,-465.95C1697,-457.67 1697,-448.7 1697,-440.39"/>
<polygon fill="black" stroke="black" points="1700.5,-440.31 1697,-430.31 1693.5,-440.31 1700.5,-440.31"/>
</g>
<!-- tp_15_2 -->
<g id="node1035" class="node">
<title>tp_15_2</title>
<ellipse fill="lightblue" stroke="black" cx="1697" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="1697" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1697" y="-322" font-family="Times,serif" font-size="9.00">GPU: 484↔485</text>
<text text-anchor="middle" x="1697" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="1697" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_2_0&#45;&gt;tp_15_2 -->
<g id="edge1503" class="edge">
<title>expert_15_2_0&#45;&gt;tp_15_2</title>
<path fill="none" stroke="black" d="M1473.41,-386.22C1514.87,-373.98 1567.36,-358.48 1611.07,-345.57"/>
<polygon fill="black" stroke="black" points="1612.23,-348.88 1620.83,-342.69 1610.25,-342.16 1612.23,-348.88"/>
</g>
<!-- expert_15_2_1&#45;&gt;tp_15_2 -->
<g id="edge1504" class="edge">
<title>expert_15_2_1&#45;&gt;tp_15_2</title>
<path fill="none" stroke="black" d="M1697,-386.22C1697,-378.55 1697,-369.59 1697,-360.8"/>
<polygon fill="black" stroke="black" points="1700.5,-360.64 1697,-350.64 1693.5,-360.64 1700.5,-360.64"/>
</g>
<!-- tp_15_2&#45;&gt;agg_15 -->
<g id="edge1505" class="edge">
<title>tp_15_2&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1807.8,-309.94C1901.98,-303.18 2040.79,-293.83 2162,-288.08 3050.74,-245.98 4109.42,-222.23 4565.95,-213.27"/>
<polygon fill="black" stroke="black" points="4566.03,-216.77 4575.96,-213.07 4565.89,-209.77 4566.03,-216.77"/>
</g>
<!-- expert_15_3_0 -->
<g id="node1037" class="node">
<title>expert_15_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2130.5,-430.31 1853.5,-430.31 1853.5,-386.31 2130.5,-386.31 2130.5,-430.31"/>
<text text-anchor="middle" x="1992" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;0</text>
<text text-anchor="middle" x="1992" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 486</text>
<text text-anchor="middle" x="1992" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="1992" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_3&#45;&gt;expert_15_3_0 -->
<g id="edge1507" class="edge">
<title>route_15_3&#45;&gt;expert_15_3_0</title>
<path fill="none" stroke="black" d="M2196.08,-469.57C2156.92,-458.01 2111.49,-444.59 2073.44,-433.36"/>
<polygon fill="black" stroke="black" points="2074.01,-429.88 2063.43,-430.4 2072.03,-436.59 2074.01,-429.88"/>
</g>
<!-- expert_15_3_1 -->
<g id="node1038" class="node">
<title>expert_15_3_1</title>
<polygon fill="lightgreen" stroke="black" points="2425.5,-430.31 2148.5,-430.31 2148.5,-386.31 2425.5,-386.31 2425.5,-430.31"/>
<text text-anchor="middle" x="2287" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 3 TP&#45;1</text>
<text text-anchor="middle" x="2287" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 487</text>
<text text-anchor="middle" x="2287" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2287" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_3&#45;&gt;expert_15_3_1 -->
<g id="edge1508" class="edge">
<title>route_15_3&#45;&gt;expert_15_3_1</title>
<path fill="none" stroke="black" d="M2287,-465.95C2287,-457.67 2287,-448.7 2287,-440.39"/>
<polygon fill="black" stroke="black" points="2290.5,-440.31 2287,-430.31 2283.5,-440.31 2290.5,-440.31"/>
</g>
<!-- tp_15_3 -->
<g id="node1039" class="node">
<title>tp_15_3</title>
<ellipse fill="lightblue" stroke="black" cx="2287" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2287" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2287" y="-322" font-family="Times,serif" font-size="9.00">GPU: 486↔487</text>
<text text-anchor="middle" x="2287" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2287" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_3_0&#45;&gt;tp_15_3 -->
<g id="edge1509" class="edge">
<title>expert_15_3_0&#45;&gt;tp_15_3</title>
<path fill="none" stroke="black" d="M2063.41,-386.22C2104.87,-373.98 2157.36,-358.48 2201.07,-345.57"/>
<polygon fill="black" stroke="black" points="2202.23,-348.88 2210.83,-342.69 2200.25,-342.16 2202.23,-348.88"/>
</g>
<!-- expert_15_3_1&#45;&gt;tp_15_3 -->
<g id="edge1510" class="edge">
<title>expert_15_3_1&#45;&gt;tp_15_3</title>
<path fill="none" stroke="black" d="M2287,-386.22C2287,-378.55 2287,-369.59 2287,-360.8"/>
<polygon fill="black" stroke="black" points="2290.5,-360.64 2287,-350.64 2283.5,-360.64 2290.5,-360.64"/>
</g>
<!-- tp_15_3&#45;&gt;agg_15 -->
<g id="edge1511" class="edge">
<title>tp_15_3&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2398.29,-310.17C2492.46,-303.58 2631.02,-294.34 2752,-288.08 3412.08,-253.95 4192.88,-227.66 4569.12,-215.87"/>
<polygon fill="black" stroke="black" points="4569.42,-219.36 4579.3,-215.55 4569.2,-212.37 4569.42,-219.36"/>
</g>
<!-- expert_15_4_0 -->
<g id="node1041" class="node">
<title>expert_15_4_0</title>
<polygon fill="lightgreen" stroke="black" points="2720.5,-430.31 2443.5,-430.31 2443.5,-386.31 2720.5,-386.31 2720.5,-430.31"/>
<text text-anchor="middle" x="2582" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;0</text>
<text text-anchor="middle" x="2582" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 488</text>
<text text-anchor="middle" x="2582" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2582" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_4&#45;&gt;expert_15_4_0 -->
<g id="edge1513" class="edge">
<title>route_15_4&#45;&gt;expert_15_4_0</title>
<path fill="none" stroke="black" d="M2786.08,-469.57C2746.92,-458.01 2701.49,-444.59 2663.44,-433.36"/>
<polygon fill="black" stroke="black" points="2664.01,-429.88 2653.43,-430.4 2662.03,-436.59 2664.01,-429.88"/>
</g>
<!-- expert_15_4_1 -->
<g id="node1042" class="node">
<title>expert_15_4_1</title>
<polygon fill="lightgreen" stroke="black" points="3015.5,-430.31 2738.5,-430.31 2738.5,-386.31 3015.5,-386.31 3015.5,-430.31"/>
<text text-anchor="middle" x="2877" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 4 TP&#45;1</text>
<text text-anchor="middle" x="2877" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 489</text>
<text text-anchor="middle" x="2877" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="2877" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_4&#45;&gt;expert_15_4_1 -->
<g id="edge1514" class="edge">
<title>route_15_4&#45;&gt;expert_15_4_1</title>
<path fill="none" stroke="black" d="M2877,-465.95C2877,-457.67 2877,-448.7 2877,-440.39"/>
<polygon fill="black" stroke="black" points="2880.5,-440.31 2877,-430.31 2873.5,-440.31 2880.5,-440.31"/>
</g>
<!-- tp_15_4 -->
<g id="node1043" class="node">
<title>tp_15_4</title>
<ellipse fill="lightblue" stroke="black" cx="2877" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="2877" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="2877" y="-322" font-family="Times,serif" font-size="9.00">GPU: 488↔489</text>
<text text-anchor="middle" x="2877" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="2877" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_4_0&#45;&gt;tp_15_4 -->
<g id="edge1515" class="edge">
<title>expert_15_4_0&#45;&gt;tp_15_4</title>
<path fill="none" stroke="black" d="M2653.41,-386.22C2694.87,-373.98 2747.36,-358.48 2791.07,-345.57"/>
<polygon fill="black" stroke="black" points="2792.23,-348.88 2800.83,-342.69 2790.25,-342.16 2792.23,-348.88"/>
</g>
<!-- expert_15_4_1&#45;&gt;tp_15_4 -->
<g id="edge1516" class="edge">
<title>expert_15_4_1&#45;&gt;tp_15_4</title>
<path fill="none" stroke="black" d="M2877,-386.22C2877,-378.55 2877,-369.59 2877,-360.8"/>
<polygon fill="black" stroke="black" points="2880.5,-360.64 2877,-350.64 2873.5,-360.64 2880.5,-360.64"/>
</g>
<!-- tp_15_4&#45;&gt;agg_15 -->
<g id="edge1517" class="edge">
<title>tp_15_4&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M2988.79,-310.63C3082.97,-304.34 3221.27,-295.28 3342,-288.08 3779.09,-262.04 4290.42,-235.02 4574.75,-220.31"/>
<polygon fill="black" stroke="black" points="4574.96,-223.8 4584.77,-219.79 4574.6,-216.81 4574.96,-223.8"/>
</g>
<!-- expert_15_5_0 -->
<g id="node1045" class="node">
<title>expert_15_5_0</title>
<polygon fill="lightgreen" stroke="black" points="3310.5,-430.31 3033.5,-430.31 3033.5,-386.31 3310.5,-386.31 3310.5,-430.31"/>
<text text-anchor="middle" x="3172" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;0</text>
<text text-anchor="middle" x="3172" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 490</text>
<text text-anchor="middle" x="3172" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3172" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_5&#45;&gt;expert_15_5_0 -->
<g id="edge1519" class="edge">
<title>route_15_5&#45;&gt;expert_15_5_0</title>
<path fill="none" stroke="black" d="M3376.08,-469.57C3336.92,-458.01 3291.49,-444.59 3253.44,-433.36"/>
<polygon fill="black" stroke="black" points="3254.01,-429.88 3243.43,-430.4 3252.03,-436.59 3254.01,-429.88"/>
</g>
<!-- expert_15_5_1 -->
<g id="node1046" class="node">
<title>expert_15_5_1</title>
<polygon fill="lightgreen" stroke="black" points="3605.5,-430.31 3328.5,-430.31 3328.5,-386.31 3605.5,-386.31 3605.5,-430.31"/>
<text text-anchor="middle" x="3467" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 5 TP&#45;1</text>
<text text-anchor="middle" x="3467" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 491</text>
<text text-anchor="middle" x="3467" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3467" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_5&#45;&gt;expert_15_5_1 -->
<g id="edge1520" class="edge">
<title>route_15_5&#45;&gt;expert_15_5_1</title>
<path fill="none" stroke="black" d="M3467,-465.95C3467,-457.67 3467,-448.7 3467,-440.39"/>
<polygon fill="black" stroke="black" points="3470.5,-440.31 3467,-430.31 3463.5,-440.31 3470.5,-440.31"/>
</g>
<!-- tp_15_5 -->
<g id="node1047" class="node">
<title>tp_15_5</title>
<ellipse fill="lightblue" stroke="black" cx="3467" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="3467" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3467" y="-322" font-family="Times,serif" font-size="9.00">GPU: 490↔491</text>
<text text-anchor="middle" x="3467" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="3467" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_5_0&#45;&gt;tp_15_5 -->
<g id="edge1521" class="edge">
<title>expert_15_5_0&#45;&gt;tp_15_5</title>
<path fill="none" stroke="black" d="M3243.41,-386.22C3284.87,-373.98 3337.36,-358.48 3381.07,-345.57"/>
<polygon fill="black" stroke="black" points="3382.23,-348.88 3390.83,-342.69 3380.25,-342.16 3382.23,-348.88"/>
</g>
<!-- expert_15_5_1&#45;&gt;tp_15_5 -->
<g id="edge1522" class="edge">
<title>expert_15_5_1&#45;&gt;tp_15_5</title>
<path fill="none" stroke="black" d="M3467,-386.22C3467,-378.55 3467,-369.59 3467,-360.8"/>
<polygon fill="black" stroke="black" points="3470.5,-360.64 3467,-350.64 3463.5,-360.64 3470.5,-360.64"/>
</g>
<!-- tp_15_5&#45;&gt;agg_15 -->
<g id="edge1523" class="edge">
<title>tp_15_5&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M3577.01,-309.15C3797.49,-291.02 4296.79,-249.97 4582.61,-226.46"/>
<polygon fill="black" stroke="black" points="4583.01,-229.94 4592.69,-225.64 4582.44,-222.97 4583.01,-229.94"/>
</g>
<!-- expert_15_6_0 -->
<g id="node1049" class="node">
<title>expert_15_6_0</title>
<polygon fill="lightgreen" stroke="black" points="3900.5,-430.31 3623.5,-430.31 3623.5,-386.31 3900.5,-386.31 3900.5,-430.31"/>
<text text-anchor="middle" x="3762" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;0</text>
<text text-anchor="middle" x="3762" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 492</text>
<text text-anchor="middle" x="3762" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="3762" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_6&#45;&gt;expert_15_6_0 -->
<g id="edge1525" class="edge">
<title>route_15_6&#45;&gt;expert_15_6_0</title>
<path fill="none" stroke="black" d="M3966.08,-469.57C3926.92,-458.01 3881.49,-444.59 3843.44,-433.36"/>
<polygon fill="black" stroke="black" points="3844.01,-429.88 3833.43,-430.4 3842.03,-436.59 3844.01,-429.88"/>
</g>
<!-- expert_15_6_1 -->
<g id="node1050" class="node">
<title>expert_15_6_1</title>
<polygon fill="lightgreen" stroke="black" points="4195.5,-430.31 3918.5,-430.31 3918.5,-386.31 4195.5,-386.31 4195.5,-430.31"/>
<text text-anchor="middle" x="4057" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 6 TP&#45;1</text>
<text text-anchor="middle" x="4057" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 493</text>
<text text-anchor="middle" x="4057" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4057" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_6&#45;&gt;expert_15_6_1 -->
<g id="edge1526" class="edge">
<title>route_15_6&#45;&gt;expert_15_6_1</title>
<path fill="none" stroke="black" d="M4057,-465.95C4057,-457.67 4057,-448.7 4057,-440.39"/>
<polygon fill="black" stroke="black" points="4060.5,-440.31 4057,-430.31 4053.5,-440.31 4060.5,-440.31"/>
</g>
<!-- tp_15_6 -->
<g id="node1051" class="node">
<title>tp_15_6</title>
<ellipse fill="lightblue" stroke="black" cx="4057" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4057" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4057" y="-322" font-family="Times,serif" font-size="9.00">GPU: 492↔493</text>
<text text-anchor="middle" x="4057" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4057" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_6_0&#45;&gt;tp_15_6 -->
<g id="edge1527" class="edge">
<title>expert_15_6_0&#45;&gt;tp_15_6</title>
<path fill="none" stroke="black" d="M3833.41,-386.22C3874.87,-373.98 3927.36,-358.48 3971.07,-345.57"/>
<polygon fill="black" stroke="black" points="3972.23,-348.88 3980.83,-342.69 3970.25,-342.16 3972.23,-348.88"/>
</g>
<!-- expert_15_6_1&#45;&gt;tp_15_6 -->
<g id="edge1528" class="edge">
<title>expert_15_6_1&#45;&gt;tp_15_6</title>
<path fill="none" stroke="black" d="M4057,-386.22C4057,-378.55 4057,-369.59 4057,-360.8"/>
<polygon fill="black" stroke="black" points="4060.5,-360.64 4057,-350.64 4053.5,-360.64 4060.5,-360.64"/>
</g>
<!-- tp_15_6&#45;&gt;agg_15 -->
<g id="edge1529" class="edge">
<title>tp_15_6&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M4157.16,-303.37C4269.68,-286.71 4455.1,-259.26 4596.93,-238.26"/>
<polygon fill="black" stroke="black" points="4597.68,-241.69 4607.06,-236.76 4596.66,-234.76 4597.68,-241.69"/>
</g>
<!-- expert_15_7_0 -->
<g id="node1053" class="node">
<title>expert_15_7_0</title>
<polygon fill="lightgreen" stroke="black" points="4490.5,-430.31 4213.5,-430.31 4213.5,-386.31 4490.5,-386.31 4490.5,-430.31"/>
<text text-anchor="middle" x="4352" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;0</text>
<text text-anchor="middle" x="4352" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 494</text>
<text text-anchor="middle" x="4352" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4352" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_7&#45;&gt;expert_15_7_0 -->
<g id="edge1531" class="edge">
<title>route_15_7&#45;&gt;expert_15_7_0</title>
<path fill="none" stroke="black" d="M4510.32,-468.5C4480.66,-457.41 4446.83,-444.76 4418.08,-434.01"/>
<polygon fill="black" stroke="black" points="4419.13,-430.67 4408.54,-430.45 4416.68,-437.23 4419.13,-430.67"/>
</g>
<!-- expert_15_7_1 -->
<g id="node1054" class="node">
<title>expert_15_7_1</title>
<polygon fill="lightgreen" stroke="black" points="4785.5,-430.31 4508.5,-430.31 4508.5,-386.31 4785.5,-386.31 4785.5,-430.31"/>
<text text-anchor="middle" x="4647" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 7 TP&#45;1</text>
<text text-anchor="middle" x="4647" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 495</text>
<text text-anchor="middle" x="4647" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4647" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_7&#45;&gt;expert_15_7_1 -->
<g id="edge1532" class="edge">
<title>route_15_7&#45;&gt;expert_15_7_1</title>
<path fill="none" stroke="black" d="M4606.34,-466.44C4612.71,-457.49 4619.68,-447.69 4626.03,-438.77"/>
<polygon fill="black" stroke="black" points="4628.94,-440.73 4631.88,-430.55 4623.23,-436.67 4628.94,-440.73"/>
</g>
<!-- tp_15_7 -->
<g id="node1055" class="node">
<title>tp_15_7</title>
<ellipse fill="lightblue" stroke="black" cx="4647" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4647" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4647" y="-322" font-family="Times,serif" font-size="9.00">GPU: 494↔495</text>
<text text-anchor="middle" x="4647" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4647" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_7_0&#45;&gt;tp_15_7 -->
<g id="edge1533" class="edge">
<title>expert_15_7_0&#45;&gt;tp_15_7</title>
<path fill="none" stroke="black" d="M4423.41,-386.22C4464.87,-373.98 4517.36,-358.48 4561.07,-345.57"/>
<polygon fill="black" stroke="black" points="4562.23,-348.88 4570.83,-342.69 4560.25,-342.16 4562.23,-348.88"/>
</g>
<!-- expert_15_7_1&#45;&gt;tp_15_7 -->
<g id="edge1534" class="edge">
<title>expert_15_7_1&#45;&gt;tp_15_7</title>
<path fill="none" stroke="black" d="M4647,-386.22C4647,-378.55 4647,-369.59 4647,-360.8"/>
<polygon fill="black" stroke="black" points="4650.5,-360.64 4647,-350.64 4643.5,-360.64 4650.5,-360.64"/>
</g>
<!-- tp_15_7&#45;&gt;agg_15 -->
<g id="edge1535" class="edge">
<title>tp_15_7&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M4685.24,-289.81C4698.3,-280.12 4713.31,-268.97 4727.93,-258.13"/>
<polygon fill="black" stroke="black" points="4730.05,-260.91 4735.99,-252.14 4725.88,-255.29 4730.05,-260.91"/>
</g>
<!-- expert_15_8_0 -->
<g id="node1057" class="node">
<title>expert_15_8_0</title>
<polygon fill="lightgreen" stroke="black" points="5080.5,-430.31 4803.5,-430.31 4803.5,-386.31 5080.5,-386.31 5080.5,-430.31"/>
<text text-anchor="middle" x="4942" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;0</text>
<text text-anchor="middle" x="4942" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 496</text>
<text text-anchor="middle" x="4942" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4942" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_8&#45;&gt;expert_15_8_0 -->
<g id="edge1537" class="edge">
<title>route_15_8&#45;&gt;expert_15_8_0</title>
<path fill="none" stroke="black" d="M4983.32,-466.44C4976.85,-457.49 4969.76,-447.69 4963.31,-438.77"/>
<polygon fill="black" stroke="black" points="4966.06,-436.6 4957.36,-430.55 4960.39,-440.7 4966.06,-436.6"/>
</g>
<!-- expert_15_8_1 -->
<g id="node1058" class="node">
<title>expert_15_8_1</title>
<polygon fill="lightgreen" stroke="black" points="5375.5,-430.31 5098.5,-430.31 5098.5,-386.31 5375.5,-386.31 5375.5,-430.31"/>
<text text-anchor="middle" x="5237" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 8 TP&#45;1</text>
<text text-anchor="middle" x="5237" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 497</text>
<text text-anchor="middle" x="5237" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5237" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_8&#45;&gt;expert_15_8_1 -->
<g id="edge1538" class="edge">
<title>route_15_8&#45;&gt;expert_15_8_1</title>
<path fill="none" stroke="black" d="M5079.36,-468.5C5108.89,-457.41 5142.58,-444.76 5171.2,-434.01"/>
<polygon fill="black" stroke="black" points="5172.57,-437.24 5180.71,-430.45 5170.11,-430.69 5172.57,-437.24"/>
</g>
<!-- tp_15_8 -->
<g id="node1059" class="node">
<title>tp_15_8</title>
<ellipse fill="lightblue" stroke="black" cx="4942" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="4942" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4942" y="-322" font-family="Times,serif" font-size="9.00">GPU: 496↔497</text>
<text text-anchor="middle" x="4942" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="4942" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_8_0&#45;&gt;tp_15_8 -->
<g id="edge1539" class="edge">
<title>expert_15_8_0&#45;&gt;tp_15_8</title>
<path fill="none" stroke="black" d="M4942,-386.22C4942,-378.55 4942,-369.59 4942,-360.8"/>
<polygon fill="black" stroke="black" points="4945.5,-360.64 4942,-350.64 4938.5,-360.64 4945.5,-360.64"/>
</g>
<!-- expert_15_8_1&#45;&gt;tp_15_8 -->
<g id="edge1540" class="edge">
<title>expert_15_8_1&#45;&gt;tp_15_8</title>
<path fill="none" stroke="black" d="M5165.59,-386.22C5124.13,-373.98 5071.64,-358.48 5027.93,-345.57"/>
<polygon fill="black" stroke="black" points="5028.75,-342.16 5018.17,-342.69 5026.77,-348.88 5028.75,-342.16"/>
</g>
<!-- tp_15_8&#45;&gt;agg_15 -->
<g id="edge1541" class="edge">
<title>tp_15_8&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M4903.5,-289.81C4890.35,-280.12 4875.24,-268.97 4860.52,-258.13"/>
<polygon fill="black" stroke="black" points="4862.53,-255.26 4852.4,-252.14 4858.37,-260.89 4862.53,-255.26"/>
</g>
<!-- expert_15_9_0 -->
<g id="node1061" class="node">
<title>expert_15_9_0</title>
<polygon fill="lightgreen" stroke="black" points="5670.5,-430.31 5393.5,-430.31 5393.5,-386.31 5670.5,-386.31 5670.5,-430.31"/>
<text text-anchor="middle" x="5532" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;0</text>
<text text-anchor="middle" x="5532" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 498</text>
<text text-anchor="middle" x="5532" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5532" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_9&#45;&gt;expert_15_9_0 -->
<g id="edge1543" class="edge">
<title>route_15_9&#45;&gt;expert_15_9_0</title>
<path fill="none" stroke="black" d="M5532,-465.95C5532,-457.67 5532,-448.7 5532,-440.39"/>
<polygon fill="black" stroke="black" points="5535.5,-440.31 5532,-430.31 5528.5,-440.31 5535.5,-440.31"/>
</g>
<!-- expert_15_9_1 -->
<g id="node1062" class="node">
<title>expert_15_9_1</title>
<polygon fill="lightgreen" stroke="black" points="5965.5,-430.31 5688.5,-430.31 5688.5,-386.31 5965.5,-386.31 5965.5,-430.31"/>
<text text-anchor="middle" x="5827" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 9 TP&#45;1</text>
<text text-anchor="middle" x="5827" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 499</text>
<text text-anchor="middle" x="5827" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="5827" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_9&#45;&gt;expert_15_9_1 -->
<g id="edge1544" class="edge">
<title>route_15_9&#45;&gt;expert_15_9_1</title>
<path fill="none" stroke="black" d="M5622.92,-469.57C5662.08,-458.01 5707.51,-444.59 5745.56,-433.36"/>
<polygon fill="black" stroke="black" points="5746.97,-436.59 5755.57,-430.4 5744.99,-429.88 5746.97,-436.59"/>
</g>
<!-- tp_15_9 -->
<g id="node1063" class="node">
<title>tp_15_9</title>
<ellipse fill="lightblue" stroke="black" cx="5532" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="5532" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5532" y="-322" font-family="Times,serif" font-size="9.00">GPU: 498↔499</text>
<text text-anchor="middle" x="5532" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="5532" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_9_0&#45;&gt;tp_15_9 -->
<g id="edge1545" class="edge">
<title>expert_15_9_0&#45;&gt;tp_15_9</title>
<path fill="none" stroke="black" d="M5532,-386.22C5532,-378.55 5532,-369.59 5532,-360.8"/>
<polygon fill="black" stroke="black" points="5535.5,-360.64 5532,-350.64 5528.5,-360.64 5535.5,-360.64"/>
</g>
<!-- expert_15_9_1&#45;&gt;tp_15_9 -->
<g id="edge1546" class="edge">
<title>expert_15_9_1&#45;&gt;tp_15_9</title>
<path fill="none" stroke="black" d="M5755.59,-386.22C5714.13,-373.98 5661.64,-358.48 5617.93,-345.57"/>
<polygon fill="black" stroke="black" points="5618.75,-342.16 5608.17,-342.69 5616.77,-348.88 5618.75,-342.16"/>
</g>
<!-- tp_15_9&#45;&gt;agg_15 -->
<g id="edge1547" class="edge">
<title>tp_15_9&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M5431.7,-303.37C5342.3,-290.15 5206.93,-270.13 5083.87,-251.94"/>
<polygon fill="black" stroke="black" points="5084.31,-248.47 5073.9,-250.47 5083.28,-255.39 5084.31,-248.47"/>
</g>
<!-- expert_15_10_0 -->
<g id="node1065" class="node">
<title>expert_15_10_0</title>
<polygon fill="lightgreen" stroke="black" points="6260.5,-430.31 5983.5,-430.31 5983.5,-386.31 6260.5,-386.31 6260.5,-430.31"/>
<text text-anchor="middle" x="6122" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;0</text>
<text text-anchor="middle" x="6122" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 500</text>
<text text-anchor="middle" x="6122" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6122" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_10&#45;&gt;expert_15_10_0 -->
<g id="edge1549" class="edge">
<title>route_15_10&#45;&gt;expert_15_10_0</title>
<path fill="none" stroke="black" d="M6122,-465.95C6122,-457.67 6122,-448.7 6122,-440.39"/>
<polygon fill="black" stroke="black" points="6125.5,-440.31 6122,-430.31 6118.5,-440.31 6125.5,-440.31"/>
</g>
<!-- expert_15_10_1 -->
<g id="node1066" class="node">
<title>expert_15_10_1</title>
<polygon fill="lightgreen" stroke="black" points="6555.5,-430.31 6278.5,-430.31 6278.5,-386.31 6555.5,-386.31 6555.5,-430.31"/>
<text text-anchor="middle" x="6417" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 10 TP&#45;1</text>
<text text-anchor="middle" x="6417" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 501</text>
<text text-anchor="middle" x="6417" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6417" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_10&#45;&gt;expert_15_10_1 -->
<g id="edge1550" class="edge">
<title>route_15_10&#45;&gt;expert_15_10_1</title>
<path fill="none" stroke="black" d="M6212.92,-469.57C6252.08,-458.01 6297.51,-444.59 6335.56,-433.36"/>
<polygon fill="black" stroke="black" points="6336.97,-436.59 6345.57,-430.4 6334.99,-429.88 6336.97,-436.59"/>
</g>
<!-- tp_15_10 -->
<g id="node1067" class="node">
<title>tp_15_10</title>
<ellipse fill="lightblue" stroke="black" cx="6122" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6122" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6122" y="-322" font-family="Times,serif" font-size="9.00">GPU: 500↔501</text>
<text text-anchor="middle" x="6122" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6122" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_10_0&#45;&gt;tp_15_10 -->
<g id="edge1551" class="edge">
<title>expert_15_10_0&#45;&gt;tp_15_10</title>
<path fill="none" stroke="black" d="M6122,-386.22C6122,-378.55 6122,-369.59 6122,-360.8"/>
<polygon fill="black" stroke="black" points="6125.5,-360.64 6122,-350.64 6118.5,-360.64 6125.5,-360.64"/>
</g>
<!-- expert_15_10_1&#45;&gt;tp_15_10 -->
<g id="edge1552" class="edge">
<title>expert_15_10_1&#45;&gt;tp_15_10</title>
<path fill="none" stroke="black" d="M6345.59,-386.22C6304.13,-373.98 6251.64,-358.48 6207.93,-345.57"/>
<polygon fill="black" stroke="black" points="6208.75,-342.16 6198.17,-342.69 6206.77,-348.88 6208.75,-342.16"/>
</g>
<!-- tp_15_10&#45;&gt;agg_15 -->
<g id="edge1553" class="edge">
<title>tp_15_10&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M6012.19,-309.17C5804.46,-292.11 5348.69,-254.66 5057.33,-230.72"/>
<polygon fill="black" stroke="black" points="5057.29,-227.2 5047.03,-229.87 5056.71,-234.18 5057.29,-227.2"/>
</g>
<!-- expert_15_11_0 -->
<g id="node1069" class="node">
<title>expert_15_11_0</title>
<polygon fill="lightgreen" stroke="black" points="6850.5,-430.31 6573.5,-430.31 6573.5,-386.31 6850.5,-386.31 6850.5,-430.31"/>
<text text-anchor="middle" x="6712" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;0</text>
<text text-anchor="middle" x="6712" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 502</text>
<text text-anchor="middle" x="6712" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="6712" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_11&#45;&gt;expert_15_11_0 -->
<g id="edge1555" class="edge">
<title>route_15_11&#45;&gt;expert_15_11_0</title>
<path fill="none" stroke="black" d="M6712,-465.95C6712,-457.67 6712,-448.7 6712,-440.39"/>
<polygon fill="black" stroke="black" points="6715.5,-440.31 6712,-430.31 6708.5,-440.31 6715.5,-440.31"/>
</g>
<!-- expert_15_11_1 -->
<g id="node1070" class="node">
<title>expert_15_11_1</title>
<polygon fill="lightgreen" stroke="black" points="7145.5,-430.31 6868.5,-430.31 6868.5,-386.31 7145.5,-386.31 7145.5,-430.31"/>
<text text-anchor="middle" x="7007" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 11 TP&#45;1</text>
<text text-anchor="middle" x="7007" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 503</text>
<text text-anchor="middle" x="7007" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7007" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_11&#45;&gt;expert_15_11_1 -->
<g id="edge1556" class="edge">
<title>route_15_11&#45;&gt;expert_15_11_1</title>
<path fill="none" stroke="black" d="M6802.92,-469.57C6842.08,-458.01 6887.51,-444.59 6925.56,-433.36"/>
<polygon fill="black" stroke="black" points="6926.97,-436.59 6935.57,-430.4 6924.99,-429.88 6926.97,-436.59"/>
</g>
<!-- tp_15_11 -->
<g id="node1071" class="node">
<title>tp_15_11</title>
<ellipse fill="lightblue" stroke="black" cx="6712" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="6712" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="6712" y="-322" font-family="Times,serif" font-size="9.00">GPU: 502↔503</text>
<text text-anchor="middle" x="6712" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="6712" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_11_0&#45;&gt;tp_15_11 -->
<g id="edge1557" class="edge">
<title>expert_15_11_0&#45;&gt;tp_15_11</title>
<path fill="none" stroke="black" d="M6712,-386.22C6712,-378.55 6712,-369.59 6712,-360.8"/>
<polygon fill="black" stroke="black" points="6715.5,-360.64 6712,-350.64 6708.5,-360.64 6715.5,-360.64"/>
</g>
<!-- expert_15_11_1&#45;&gt;tp_15_11 -->
<g id="edge1558" class="edge">
<title>expert_15_11_1&#45;&gt;tp_15_11</title>
<path fill="none" stroke="black" d="M6935.59,-386.22C6894.13,-373.98 6841.64,-358.48 6797.93,-345.57"/>
<polygon fill="black" stroke="black" points="6798.75,-342.16 6788.17,-342.69 6796.77,-348.88 6798.75,-342.16"/>
</g>
<!-- tp_15_11&#45;&gt;agg_15 -->
<g id="edge1559" class="edge">
<title>tp_15_11&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M6600.21,-310.63C6506.03,-304.34 6367.73,-295.27 6247,-288.08 5825.96,-263.01 5336.09,-237.04 5046.26,-222.01"/>
<polygon fill="black" stroke="black" points="5046.2,-218.5 5036.03,-221.47 5045.84,-225.49 5046.2,-218.5"/>
</g>
<!-- expert_15_12_0 -->
<g id="node1073" class="node">
<title>expert_15_12_0</title>
<polygon fill="lightgreen" stroke="black" points="7440.5,-430.31 7163.5,-430.31 7163.5,-386.31 7440.5,-386.31 7440.5,-430.31"/>
<text text-anchor="middle" x="7302" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;0</text>
<text text-anchor="middle" x="7302" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 504</text>
<text text-anchor="middle" x="7302" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7302" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_12&#45;&gt;expert_15_12_0 -->
<g id="edge1561" class="edge">
<title>route_15_12&#45;&gt;expert_15_12_0</title>
<path fill="none" stroke="black" d="M7302,-465.95C7302,-457.67 7302,-448.7 7302,-440.39"/>
<polygon fill="black" stroke="black" points="7305.5,-440.31 7302,-430.31 7298.5,-440.31 7305.5,-440.31"/>
</g>
<!-- expert_15_12_1 -->
<g id="node1074" class="node">
<title>expert_15_12_1</title>
<polygon fill="lightgreen" stroke="black" points="7735.5,-430.31 7458.5,-430.31 7458.5,-386.31 7735.5,-386.31 7735.5,-430.31"/>
<text text-anchor="middle" x="7597" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 12 TP&#45;1</text>
<text text-anchor="middle" x="7597" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 505</text>
<text text-anchor="middle" x="7597" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7597" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_12&#45;&gt;expert_15_12_1 -->
<g id="edge1562" class="edge">
<title>route_15_12&#45;&gt;expert_15_12_1</title>
<path fill="none" stroke="black" d="M7392.92,-469.57C7432.08,-458.01 7477.51,-444.59 7515.56,-433.36"/>
<polygon fill="black" stroke="black" points="7516.97,-436.59 7525.57,-430.4 7514.99,-429.88 7516.97,-436.59"/>
</g>
<!-- tp_15_12 -->
<g id="node1075" class="node">
<title>tp_15_12</title>
<ellipse fill="lightblue" stroke="black" cx="7302" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7302" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7302" y="-322" font-family="Times,serif" font-size="9.00">GPU: 504↔505</text>
<text text-anchor="middle" x="7302" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7302" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_12_0&#45;&gt;tp_15_12 -->
<g id="edge1563" class="edge">
<title>expert_15_12_0&#45;&gt;tp_15_12</title>
<path fill="none" stroke="black" d="M7302,-386.22C7302,-378.55 7302,-369.59 7302,-360.8"/>
<polygon fill="black" stroke="black" points="7305.5,-360.64 7302,-350.64 7298.5,-360.64 7305.5,-360.64"/>
</g>
<!-- expert_15_12_1&#45;&gt;tp_15_12 -->
<g id="edge1564" class="edge">
<title>expert_15_12_1&#45;&gt;tp_15_12</title>
<path fill="none" stroke="black" d="M7525.59,-386.22C7484.13,-373.98 7431.64,-358.48 7387.93,-345.57"/>
<polygon fill="black" stroke="black" points="7388.75,-342.16 7378.17,-342.69 7386.77,-348.88 7388.75,-342.16"/>
</g>
<!-- tp_15_12&#45;&gt;agg_15 -->
<g id="edge1565" class="edge">
<title>tp_15_12&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M7190.71,-310.17C7096.54,-303.58 6957.98,-294.34 6837,-288.08 6188.3,-254.54 5423.04,-228.58 5039.37,-216.51"/>
<polygon fill="black" stroke="black" points="5039.36,-213.01 5029.26,-216.19 5039.14,-220 5039.36,-213.01"/>
</g>
<!-- expert_15_13_0 -->
<g id="node1077" class="node">
<title>expert_15_13_0</title>
<polygon fill="lightgreen" stroke="black" points="8030.5,-430.31 7753.5,-430.31 7753.5,-386.31 8030.5,-386.31 8030.5,-430.31"/>
<text text-anchor="middle" x="7892" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;0</text>
<text text-anchor="middle" x="7892" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 506</text>
<text text-anchor="middle" x="7892" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="7892" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_13&#45;&gt;expert_15_13_0 -->
<g id="edge1567" class="edge">
<title>route_15_13&#45;&gt;expert_15_13_0</title>
<path fill="none" stroke="black" d="M7892,-465.95C7892,-457.67 7892,-448.7 7892,-440.39"/>
<polygon fill="black" stroke="black" points="7895.5,-440.31 7892,-430.31 7888.5,-440.31 7895.5,-440.31"/>
</g>
<!-- expert_15_13_1 -->
<g id="node1078" class="node">
<title>expert_15_13_1</title>
<polygon fill="lightgreen" stroke="black" points="8325.5,-430.31 8048.5,-430.31 8048.5,-386.31 8325.5,-386.31 8325.5,-430.31"/>
<text text-anchor="middle" x="8187" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 13 TP&#45;1</text>
<text text-anchor="middle" x="8187" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 507</text>
<text text-anchor="middle" x="8187" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8187" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_13&#45;&gt;expert_15_13_1 -->
<g id="edge1568" class="edge">
<title>route_15_13&#45;&gt;expert_15_13_1</title>
<path fill="none" stroke="black" d="M7982.92,-469.57C8022.08,-458.01 8067.51,-444.59 8105.56,-433.36"/>
<polygon fill="black" stroke="black" points="8106.97,-436.59 8115.57,-430.4 8104.99,-429.88 8106.97,-436.59"/>
</g>
<!-- tp_15_13 -->
<g id="node1079" class="node">
<title>tp_15_13</title>
<ellipse fill="lightblue" stroke="black" cx="7892" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="7892" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7892" y="-322" font-family="Times,serif" font-size="9.00">GPU: 506↔507</text>
<text text-anchor="middle" x="7892" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="7892" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_13_0&#45;&gt;tp_15_13 -->
<g id="edge1569" class="edge">
<title>expert_15_13_0&#45;&gt;tp_15_13</title>
<path fill="none" stroke="black" d="M7892,-386.22C7892,-378.55 7892,-369.59 7892,-360.8"/>
<polygon fill="black" stroke="black" points="7895.5,-360.64 7892,-350.64 7888.5,-360.64 7895.5,-360.64"/>
</g>
<!-- expert_15_13_1&#45;&gt;tp_15_13 -->
<g id="edge1570" class="edge">
<title>expert_15_13_1&#45;&gt;tp_15_13</title>
<path fill="none" stroke="black" d="M8115.59,-386.22C8074.13,-373.98 8021.64,-358.48 7977.93,-345.57"/>
<polygon fill="black" stroke="black" points="7978.75,-342.16 7968.17,-342.69 7976.77,-348.88 7978.75,-342.16"/>
</g>
<!-- tp_15_13&#45;&gt;agg_15 -->
<g id="edge1571" class="edge">
<title>tp_15_13&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M7781.2,-309.94C7687.02,-303.18 7548.21,-293.82 7427,-288.08 6546.43,-246.37 5499.09,-222.69 5035.4,-213.53"/>
<polygon fill="black" stroke="black" points="5035.3,-210.03 5025.24,-213.33 5035.17,-217.02 5035.3,-210.03"/>
</g>
<!-- expert_15_14_0 -->
<g id="node1081" class="node">
<title>expert_15_14_0</title>
<polygon fill="lightgreen" stroke="black" points="8620.5,-430.31 8343.5,-430.31 8343.5,-386.31 8620.5,-386.31 8620.5,-430.31"/>
<text text-anchor="middle" x="8482" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;0</text>
<text text-anchor="middle" x="8482" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 508</text>
<text text-anchor="middle" x="8482" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8482" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_14&#45;&gt;expert_15_14_0 -->
<g id="edge1573" class="edge">
<title>route_15_14&#45;&gt;expert_15_14_0</title>
<path fill="none" stroke="black" d="M8482,-465.95C8482,-457.67 8482,-448.7 8482,-440.39"/>
<polygon fill="black" stroke="black" points="8485.5,-440.31 8482,-430.31 8478.5,-440.31 8485.5,-440.31"/>
</g>
<!-- expert_15_14_1 -->
<g id="node1082" class="node">
<title>expert_15_14_1</title>
<polygon fill="lightgreen" stroke="black" points="8915.5,-430.31 8638.5,-430.31 8638.5,-386.31 8915.5,-386.31 8915.5,-430.31"/>
<text text-anchor="middle" x="8777" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 14 TP&#45;1</text>
<text text-anchor="middle" x="8777" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 509</text>
<text text-anchor="middle" x="8777" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="8777" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_14&#45;&gt;expert_15_14_1 -->
<g id="edge1574" class="edge">
<title>route_15_14&#45;&gt;expert_15_14_1</title>
<path fill="none" stroke="black" d="M8572.92,-469.57C8612.08,-458.01 8657.51,-444.59 8695.56,-433.36"/>
<polygon fill="black" stroke="black" points="8696.97,-436.59 8705.57,-430.4 8694.99,-429.88 8696.97,-436.59"/>
</g>
<!-- tp_15_14 -->
<g id="node1083" class="node">
<title>tp_15_14</title>
<ellipse fill="lightblue" stroke="black" cx="8482" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="8482" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="8482" y="-322" font-family="Times,serif" font-size="9.00">GPU: 508↔509</text>
<text text-anchor="middle" x="8482" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="8482" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_14_0&#45;&gt;tp_15_14 -->
<g id="edge1575" class="edge">
<title>expert_15_14_0&#45;&gt;tp_15_14</title>
<path fill="none" stroke="black" d="M8482,-386.22C8482,-378.55 8482,-369.59 8482,-360.8"/>
<polygon fill="black" stroke="black" points="8485.5,-360.64 8482,-350.64 8478.5,-360.64 8485.5,-360.64"/>
</g>
<!-- expert_15_14_1&#45;&gt;tp_15_14 -->
<g id="edge1576" class="edge">
<title>expert_15_14_1&#45;&gt;tp_15_14</title>
<path fill="none" stroke="black" d="M8705.59,-386.22C8664.13,-373.98 8611.64,-358.48 8567.93,-345.57"/>
<polygon fill="black" stroke="black" points="8568.75,-342.16 8558.17,-342.69 8566.77,-348.88 8568.75,-342.16"/>
</g>
<!-- tp_15_14&#45;&gt;agg_15 -->
<g id="edge1577" class="edge">
<title>tp_15_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M8371.2,-309.77C8277.04,-302.9 8138.23,-293.49 8017,-288.08 6901.96,-238.33 5568.42,-218.15 5033.36,-211.66"/>
<polygon fill="black" stroke="black" points="5033.25,-208.16 5023.21,-211.54 5033.16,-215.16 5033.25,-208.16"/>
</g>
<!-- expert_15_15_0 -->
<g id="node1085" class="node">
<title>expert_15_15_0</title>
<polygon fill="lightgreen" stroke="black" points="9210.5,-430.31 8933.5,-430.31 8933.5,-386.31 9210.5,-386.31 9210.5,-430.31"/>
<text text-anchor="middle" x="9072" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;0</text>
<text text-anchor="middle" x="9072" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 510</text>
<text text-anchor="middle" x="9072" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9072" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_15&#45;&gt;expert_15_15_0 -->
<g id="edge1579" class="edge">
<title>route_15_15&#45;&gt;expert_15_15_0</title>
<path fill="none" stroke="black" d="M9072,-465.95C9072,-457.67 9072,-448.7 9072,-440.39"/>
<polygon fill="black" stroke="black" points="9075.5,-440.31 9072,-430.31 9068.5,-440.31 9075.5,-440.31"/>
</g>
<!-- expert_15_15_1 -->
<g id="node1086" class="node">
<title>expert_15_15_1</title>
<polygon fill="lightgreen" stroke="black" points="9505.5,-430.31 9228.5,-430.31 9228.5,-386.31 9505.5,-386.31 9505.5,-430.31"/>
<text text-anchor="middle" x="9367" y="-421.11" font-family="Times,serif" font-size="9.00">Expert 15 TP&#45;1</text>
<text text-anchor="middle" x="9367" y="-411.11" font-family="Times,serif" font-size="9.00">GPU: 511</text>
<text text-anchor="middle" x="9367" y="-401.11" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=640, heads=16, d_k=32]</text>
<text text-anchor="middle" x="9367" y="-391.11" font-family="Times,serif" font-size="9.00">Output: expert_out[hidden=512]</text>
</g>
<!-- route_15_15&#45;&gt;expert_15_15_1 -->
<g id="edge1580" class="edge">
<title>route_15_15&#45;&gt;expert_15_15_1</title>
<path fill="none" stroke="black" d="M9162.92,-469.57C9202.08,-458.01 9247.51,-444.59 9285.56,-433.36"/>
<polygon fill="black" stroke="black" points="9286.97,-436.59 9295.57,-430.4 9284.99,-429.88 9286.97,-436.59"/>
</g>
<!-- tp_15_15 -->
<g id="node1087" class="node">
<title>tp_15_15</title>
<ellipse fill="lightblue" stroke="black" cx="9072" cy="-319.2" rx="115.93" ry="31.23"/>
<text text-anchor="middle" x="9072" y="-332" font-family="Times,serif" font-size="9.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9072" y="-322" font-family="Times,serif" font-size="9.00">GPU: 510↔511</text>
<text text-anchor="middle" x="9072" y="-312" font-family="Times,serif" font-size="9.00">Input: expert_out[hidden=512]</text>
<text text-anchor="middle" x="9072" y="-302" font-family="Times,serif" font-size="9.00">Output: expert_full[hidden=1024]</text>
</g>
<!-- expert_15_15_0&#45;&gt;tp_15_15 -->
<g id="edge1581" class="edge">
<title>expert_15_15_0&#45;&gt;tp_15_15</title>
<path fill="none" stroke="black" d="M9072,-386.22C9072,-378.55 9072,-369.59 9072,-360.8"/>
<polygon fill="black" stroke="black" points="9075.5,-360.64 9072,-350.64 9068.5,-360.64 9075.5,-360.64"/>
</g>
<!-- expert_15_15_1&#45;&gt;tp_15_15 -->
<g id="edge1582" class="edge">
<title>expert_15_15_1&#45;&gt;tp_15_15</title>
<path fill="none" stroke="black" d="M9295.59,-386.22C9254.13,-373.98 9201.64,-358.48 9157.93,-345.57"/>
<polygon fill="black" stroke="black" points="9158.75,-342.16 9148.17,-342.69 9156.77,-348.88 9158.75,-342.16"/>
</g>
<!-- tp_15_15&#45;&gt;agg_15 -->
<g id="edge1583" class="edge">
<title>tp_15_15&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M8961.21,-309.65C8867.04,-302.71 8728.24,-293.26 8607,-288.08 7254.8,-230.32 5630.99,-214.43 5031.41,-210.38"/>
<polygon fill="black" stroke="black" points="5031.38,-206.88 5021.35,-210.31 5031.33,-213.88 5031.38,-206.88"/>
</g>
<!-- output_15 -->
<g id="node1089" class="node">
<title>output_15</title>
<polygon fill="lightgreen" stroke="black" points="4942,-128.08 4646,-128.08 4646,-84.08 4942,-84.08 4942,-128.08"/>
<text text-anchor="middle" x="4794" y="-118.88" font-family="Times,serif" font-size="9.00">Layer 15 Output</text>
<text text-anchor="middle" x="4794" y="-108.88" font-family="Times,serif" font-size="9.00">GPU: 0&#45;511</text>
<text text-anchor="middle" x="4794" y="-98.88" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, hidden=1024]</text>
<text text-anchor="middle" x="4794" y="-88.88" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- agg_15&#45;&gt;output_15 -->
<g id="edge1584" class="edge">
<title>agg_15&#45;&gt;output_15</title>
<path fill="none" stroke="black" d="M4794,-163.8C4794,-155.22 4794,-146.36 4794,-138.27"/>
<polygon fill="black" stroke="black" points="4797.5,-138.17 4794,-128.17 4790.5,-138.17 4797.5,-138.17"/>
</g>
<!-- final_output -->
<g id="node1090" class="node">
<title>final_output</title>
<ellipse fill="lightblue" stroke="black" cx="4794" cy="-24.04" rx="209.11" ry="24.08"/>
<text text-anchor="middle" x="4794" y="-31.84" font-family="Times,serif" font-size="9.00">Final Output</text>
<text text-anchor="middle" x="4794" y="-21.84" font-family="Times,serif" font-size="9.00">Input: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
<text text-anchor="middle" x="4794" y="-11.84" font-family="Times,serif" font-size="9.00">Output: [batch_size=128, seq_len=10240, heads=16, d_k=32]</text>
</g>
<!-- output_15&#45;&gt;final_output -->
<g id="edge1585" class="edge">
<title>output_15&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M4794,-84.05C4794,-76.22 4794,-67.11 4794,-58.44"/>
<polygon fill="black" stroke="black" points="4797.5,-58.18 4794,-48.18 4790.5,-58.18 4797.5,-58.18"/>
</g>
</g>
</svg>
